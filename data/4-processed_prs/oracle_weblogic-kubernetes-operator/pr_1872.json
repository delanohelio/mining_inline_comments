{"pr_number": 1872, "pr_title": "log rotation enhancements and doc", "pr_createdAt": "2020-08-14T20:53:52Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872", "timeline": [{"oid": "b741fa2b005ec59f4a254f4632e48bae354a35d4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b741fa2b005ec59f4a254f4632e48bae354a35d4", "message": "Add log rotation for NM .out/.log, enhance log rotation for introspector .out, and document log rotation for WLS .out and .log.", "committedDate": "2020-08-14T20:50:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ0NzIxNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471447215", "bodyText": "WebLogic servers -> WebLogic Servers (Because WebLogic Server is a legal product name, it should always be capitalized)\nIn your previous sentence, \"...rotation behavior for WebLogic domains and servers,\" I recommend that you re-write it as \"...rotation behavior for WebLogic Servers and domains.\"", "author": "rosemarymarano", "createdAt": "2020-08-17T12:34:19Z", "path": "docs-source/content/userguide/managing-domains/_index.md", "diffHunk": "@@ -132,3 +134,65 @@ The operator let's you initiate scaling of clusters in various ways:\n * [Using the operator's REST APIs]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#calling-the-operators-rest-scale-api\" >}})\n * [Using WLDF policies]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-wldf-policy-rule-and-script-action-to-call-the-operators-rest-scale-api\" >}})\n * [Using a Prometheus action]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-prometheus-alert-action-to-call-the-operators-rest-scale-api\" >}})\n+\n+### Log files\n+\n+The operator can automatically override WebLogic domain, server, and introspector `.log` and `.out` locations.\n+This occurs if the Domain `logHomeEnabled` field is explicitly set to `true`, or if `logHomeEnabled` isn't set\n+and `domainHomeSourceType` is set to `PersistentVolume`.  When overriding, the log location will be the location specified by the `logHome` setting.\n+\n+If you want to fine tune the `.log` and `.out` rotation behavior for WebLogic domains and servers, then\n+you can update the related `Log MBean` in your WebLogic configuration. Alternatively, for WebLogic\n+servers, you can set corresponding system properties in `JAVA_OPTIONS`:", "originalCommit": "b741fa2b005ec59f4a254f4632e48bae354a35d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTcxOTQ5MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471719491", "bodyText": "fixed", "author": "tbarnes-us", "createdAt": "2020-08-17T19:10:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ0NzIxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ0NzU5Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471447597", "bodyText": "off-line -> offline (adj) (adv) One word. Note no hyphen.", "author": "rosemarymarano", "createdAt": "2020-08-17T12:35:07Z", "path": "docs-source/content/userguide/managing-domains/_index.md", "diffHunk": "@@ -132,3 +134,65 @@ The operator let's you initiate scaling of clusters in various ways:\n * [Using the operator's REST APIs]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#calling-the-operators-rest-scale-api\" >}})\n * [Using WLDF policies]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-wldf-policy-rule-and-script-action-to-call-the-operators-rest-scale-api\" >}})\n * [Using a Prometheus action]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-prometheus-alert-action-to-call-the-operators-rest-scale-api\" >}})\n+\n+### Log files\n+\n+The operator can automatically override WebLogic domain, server, and introspector `.log` and `.out` locations.\n+This occurs if the Domain `logHomeEnabled` field is explicitly set to `true`, or if `logHomeEnabled` isn't set\n+and `domainHomeSourceType` is set to `PersistentVolume`.  When overriding, the log location will be the location specified by the `logHome` setting.\n+\n+If you want to fine tune the `.log` and `.out` rotation behavior for WebLogic domains and servers, then\n+you can update the related `Log MBean` in your WebLogic configuration. Alternatively, for WebLogic\n+servers, you can set corresponding system properties in `JAVA_OPTIONS`:\n+\n+- Here are some WLST off-line examples for creating and accessing commonly tuned Log MBeans:", "originalCommit": "b741fa2b005ec59f4a254f4632e48bae354a35d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTcxOTU2MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471719560", "bodyText": "fixed", "author": "tbarnes-us", "createdAt": "2020-08-17T19:10:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ0NzU5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ0ODAzMQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471448031", "bodyText": "Here is WLST off-line for commonly tuned Log MBean attributes: -> Here are some WLST offline (command settings OR examples) for commonly tuned Log MBean attributes:", "author": "rosemarymarano", "createdAt": "2020-08-17T12:35:57Z", "path": "docs-source/content/userguide/managing-domains/_index.md", "diffHunk": "@@ -132,3 +134,65 @@ The operator let's you initiate scaling of clusters in various ways:\n * [Using the operator's REST APIs]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#calling-the-operators-rest-scale-api\" >}})\n * [Using WLDF policies]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-wldf-policy-rule-and-script-action-to-call-the-operators-rest-scale-api\" >}})\n * [Using a Prometheus action]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-prometheus-alert-action-to-call-the-operators-rest-scale-api\" >}})\n+\n+### Log files\n+\n+The operator can automatically override WebLogic domain, server, and introspector `.log` and `.out` locations.\n+This occurs if the Domain `logHomeEnabled` field is explicitly set to `true`, or if `logHomeEnabled` isn't set\n+and `domainHomeSourceType` is set to `PersistentVolume`.  When overriding, the log location will be the location specified by the `logHome` setting.\n+\n+If you want to fine tune the `.log` and `.out` rotation behavior for WebLogic domains and servers, then\n+you can update the related `Log MBean` in your WebLogic configuration. Alternatively, for WebLogic\n+servers, you can set corresponding system properties in `JAVA_OPTIONS`:\n+\n+- Here are some WLST off-line examples for creating and accessing commonly tuned Log MBeans:\n+\n+  ```bash\n+  # domain log\n+  cd('/')\n+  create(dname,'Log')\n+  cd('/Log/' + dname);\n+  \n+  # configured server log for a server named 'sname'\n+  cd('/Servers/' + sname)\n+  create(sname, 'Log')\n+  cd('/Servers/' + sname + '/Log/' + sname)\n+  \n+  # templated (dynamic) server log for a template named 'tname'\n+  cd('/ServerTemplates/' + tname)\n+  create(tname,'Log')\n+  cd('/ServerTemplates/' + tname + '/Log/' + tname)\n+  ```\n+\n+- Here is WLST off-line for commonly tuned Log MBean attributes:", "originalCommit": "b741fa2b005ec59f4a254f4632e48bae354a35d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTcxOTYxMg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471719612", "bodyText": "fixed", "author": "tbarnes-us", "createdAt": "2020-08-17T19:11:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ0ODAzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ1MTE0MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471451141", "bodyText": "WebLogic server -> WebLogic Server", "author": "rosemarymarano", "createdAt": "2020-08-17T12:41:51Z", "path": "docs-source/content/userguide/managing-domains/_index.md", "diffHunk": "@@ -132,3 +134,65 @@ The operator let's you initiate scaling of clusters in various ways:\n * [Using the operator's REST APIs]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#calling-the-operators-rest-scale-api\" >}})\n * [Using WLDF policies]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-wldf-policy-rule-and-script-action-to-call-the-operators-rest-scale-api\" >}})\n * [Using a Prometheus action]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-prometheus-alert-action-to-call-the-operators-rest-scale-api\" >}})\n+\n+### Log files\n+\n+The operator can automatically override WebLogic domain, server, and introspector `.log` and `.out` locations.\n+This occurs if the Domain `logHomeEnabled` field is explicitly set to `true`, or if `logHomeEnabled` isn't set\n+and `domainHomeSourceType` is set to `PersistentVolume`.  When overriding, the log location will be the location specified by the `logHome` setting.\n+\n+If you want to fine tune the `.log` and `.out` rotation behavior for WebLogic domains and servers, then\n+you can update the related `Log MBean` in your WebLogic configuration. Alternatively, for WebLogic\n+servers, you can set corresponding system properties in `JAVA_OPTIONS`:\n+\n+- Here are some WLST off-line examples for creating and accessing commonly tuned Log MBeans:\n+\n+  ```bash\n+  # domain log\n+  cd('/')\n+  create(dname,'Log')\n+  cd('/Log/' + dname);\n+  \n+  # configured server log for a server named 'sname'\n+  cd('/Servers/' + sname)\n+  create(sname, 'Log')\n+  cd('/Servers/' + sname + '/Log/' + sname)\n+  \n+  # templated (dynamic) server log for a template named 'tname'\n+  cd('/ServerTemplates/' + tname)\n+  create(tname,'Log')\n+  cd('/ServerTemplates/' + tname + '/Log/' + tname)\n+  ```\n+\n+- Here is WLST off-line for commonly tuned Log MBean attributes:\n+\n+  ```bash\n+  # minimum log file size before rotation in kilobytes\n+  set('FileMinSize', 1000)\n+  \n+  # maximum number of rotated files\n+  set('FileCount', 10)\n+  \n+  # set to true to rotate file every time on startup (instead of append)\n+  set('RotateLogOnStartup', 'true')\n+  ```\n+\n+- Here are the defaults for commonly tuned Log MBean attributes:\n+\n+  | Log MBean Attribute | Production Mode Default | Development Mode Default |\n+  | --------- | ----------------------- | ------------------------ |\n+  | FileMinSize (in kilobytes) | 5000 | 500 |\n+  | FileCount | 100 | 7 |\n+  | RotateLogOnStartup | false | true |\n+\n+- For WebLogic server `.log` and `.out` files (including both dynamic and configured servers), you can alternatively", "originalCommit": "b741fa2b005ec59f4a254f4632e48bae354a35d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTcxOTg1Mg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471719852", "bodyText": "fixed", "author": "tbarnes-us", "createdAt": "2020-08-17T19:11:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ1MTE0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ1MjA0MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471452041", "bodyText": "WebLogic servers -> WebLogic Servers", "author": "rosemarymarano", "createdAt": "2020-08-17T12:43:34Z", "path": "docs-source/content/userguide/managing-domains/_index.md", "diffHunk": "@@ -132,3 +134,65 @@ The operator let's you initiate scaling of clusters in various ways:\n * [Using the operator's REST APIs]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#calling-the-operators-rest-scale-api\" >}})\n * [Using WLDF policies]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-wldf-policy-rule-and-script-action-to-call-the-operators-rest-scale-api\" >}})\n * [Using a Prometheus action]({{< relref \"/userguide/managing-domains/domain-lifecycle/scaling#using-a-prometheus-alert-action-to-call-the-operators-rest-scale-api\" >}})\n+\n+### Log files\n+\n+The operator can automatically override WebLogic domain, server, and introspector `.log` and `.out` locations.\n+This occurs if the Domain `logHomeEnabled` field is explicitly set to `true`, or if `logHomeEnabled` isn't set\n+and `domainHomeSourceType` is set to `PersistentVolume`.  When overriding, the log location will be the location specified by the `logHome` setting.\n+\n+If you want to fine tune the `.log` and `.out` rotation behavior for WebLogic domains and servers, then\n+you can update the related `Log MBean` in your WebLogic configuration. Alternatively, for WebLogic\n+servers, you can set corresponding system properties in `JAVA_OPTIONS`:\n+\n+- Here are some WLST off-line examples for creating and accessing commonly tuned Log MBeans:\n+\n+  ```bash\n+  # domain log\n+  cd('/')\n+  create(dname,'Log')\n+  cd('/Log/' + dname);\n+  \n+  # configured server log for a server named 'sname'\n+  cd('/Servers/' + sname)\n+  create(sname, 'Log')\n+  cd('/Servers/' + sname + '/Log/' + sname)\n+  \n+  # templated (dynamic) server log for a template named 'tname'\n+  cd('/ServerTemplates/' + tname)\n+  create(tname,'Log')\n+  cd('/ServerTemplates/' + tname + '/Log/' + tname)\n+  ```\n+\n+- Here is WLST off-line for commonly tuned Log MBean attributes:\n+\n+  ```bash\n+  # minimum log file size before rotation in kilobytes\n+  set('FileMinSize', 1000)\n+  \n+  # maximum number of rotated files\n+  set('FileCount', 10)\n+  \n+  # set to true to rotate file every time on startup (instead of append)\n+  set('RotateLogOnStartup', 'true')\n+  ```\n+\n+- Here are the defaults for commonly tuned Log MBean attributes:\n+\n+  | Log MBean Attribute | Production Mode Default | Development Mode Default |\n+  | --------- | ----------------------- | ------------------------ |\n+  | FileMinSize (in kilobytes) | 5000 | 500 |\n+  | FileCount | 100 | 7 |\n+  | RotateLogOnStartup | false | true |\n+\n+- For WebLogic server `.log` and `.out` files (including both dynamic and configured servers), you can alternatively\n+set logging attributes using system properties that start with `weblogic.log.`\n+and that end with the corresponding Log MBean attribute name. \n+\n+  For example, you can include `-Dweblogic.log.FileMinSize=1000 -Dweblogic.log.FileCount=10 -Dweblogic.log.RotateLogOnStartup=true` in `domain.spec.serverPod.env.name.JAVA_OPTIONS` to set the behavior for all WebLogic servers in your domain. For information about setting `JAVA_OPTIONS`, see [Domain resource]({{< relref \"/userguide/managing-domains/domain-resource/_index.md#jvm-memory-and-java-option-environment-variables\" >}}).", "originalCommit": "b741fa2b005ec59f4a254f4632e48bae354a35d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTcxOTY3Mg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1872#discussion_r471719672", "bodyText": "fixed", "author": "tbarnes-us", "createdAt": "2020-08-17T19:11:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ1MjA0MQ=="}], "type": "inlineReview"}, {"oid": "4d5df0130ddcb71ff9de811cb9024c903b82326a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4d5df0130ddcb71ff9de811cb9024c903b82326a", "message": "minor doc edits", "committedDate": "2020-08-17T19:09:59Z", "type": "commit"}]}