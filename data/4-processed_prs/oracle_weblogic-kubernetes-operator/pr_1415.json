{"pr_number": 1415, "pr_title": "Model in image schema", "pr_createdAt": "2020-01-31T19:25:38Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415", "timeline": [{"oid": "602b0ba24db82f55534eff3ffe68ef7d23301503", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/602b0ba24db82f55534eff3ffe68ef7d23301503", "message": "Merge remote-tracking branch 'origin/develop' into model-in-image-schema", "committedDate": "2020-01-28T14:47:47Z", "type": "commit"}, {"oid": "5cfa491d345285e35c612a3c5f1b44fb73771e9e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5cfa491d345285e35c612a3c5f1b44fb73771e9e", "message": "Schema updates in progress", "committedDate": "2020-01-28T23:17:34Z", "type": "commit"}, {"oid": "83469289bbe26d60239d46925b02bd12286545ff", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/83469289bbe26d60239d46925b02bd12286545ff", "message": "Next set of schema updates", "committedDate": "2020-01-30T20:34:20Z", "type": "commit"}, {"oid": "f967a3bfbe0070716eb31ecd68489246fd484df8", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f967a3bfbe0070716eb31ecd68489246fd484df8", "message": "Work in progress", "committedDate": "2020-01-30T22:11:27Z", "type": "commit"}, {"oid": "f629f8bbe08945ccf351cb5c47607b4936083d27", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f629f8bbe08945ccf351cb5c47607b4936083d27", "message": "Move final model schema items", "committedDate": "2020-01-31T17:24:20Z", "type": "commit"}, {"oid": "62e2b2dfc60558c7d9fbf28b8c8a302de92c24ee", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/62e2b2dfc60558c7d9fbf28b8c8a302de92c24ee", "message": "Update docs, tests, and samples", "committedDate": "2020-01-31T18:04:57Z", "type": "commit"}, {"oid": "7f719150ad295b4e211c78a46ced6796ebc7ae34", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7f719150ad295b4e211c78a46ced6796ebc7ae34", "message": "Update model-in-image domain template", "committedDate": "2020-01-31T19:09:06Z", "type": "commit"}, {"oid": "f4e02c04b36ee24cb221d358728f279e117d1e97", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f4e02c04b36ee24cb221d358728f279e117d1e97", "message": "Merge remote-tracking branch 'origin/model-in-image' into model-in-image-schema", "committedDate": "2020-01-31T19:29:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcxMjM4MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r373712380", "bodyText": "For deprecated fields, it looks like it'd be helpful to update its description to include the location of the field that replaces it...", "author": "tbarnes-us", "createdAt": "2020-01-31T22:24:49Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -200,11 +213,12 @@\n       \"description\": \"DomainSpec is a description of a domain.\",\n       \"type\": \"object\",\n       \"properties\": {\n-        \"keepJRFSchema\": {\n-          \"description\": \"Keep JRF schema between lifecycle updates\",\n-          \"type\": \"boolean\"\n+        \"configuration\": {\n+          \"description\": \"Models and overrides affecting the WebLogic domain configuration\",\n+          \"$ref\": \"#/definitions/Configuration\"\n         },\n         \"configOverrideSecrets\": {\n+          \"deprecated\": \"true\",\n           \"description\": \"A list of names of the secrets for optional WebLogic configuration overrides.\",", "originalCommit": "f4e02c04b36ee24cb221d358728f279e117d1e97", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcxMzIxOQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r373713219", "bodyText": "remove space between pass and phrase", "author": "tbarnes-us", "createdAt": "2020-01-31T22:27:21Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -484,6 +476,69 @@\n       \"type\": \"object\",\n       \"properties\": {}\n     },\n+    \"Model\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"encryptionSecret\": {\n+          \"description\": \"WDT encryption key pass phrase secret.\",", "originalCommit": "f4e02c04b36ee24cb221d358728f279e117d1e97", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcxMzcxNA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r373713714", "bodyText": "is Image --> is Image or FromModel\n(the default image won't have the WDT binaries)", "author": "tbarnes-us", "createdAt": "2020-01-31T22:29:07Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -20,32 +20,26 @@ DomainSpec is a description of a domain.\n | `clusters` | array of [Cluster](#cluster) | Configuration for the clusters. |\n | `configOverrides` | string | The name of the config map for optional WebLogic configuration overrides. |\n | `configOverrideSecrets` | array of string | A list of names of the secrets for optional WebLogic configuration overrides. |\n+| `configuration` | [Configuration](#configuration) | Models and overrides affecting the WebLogic domain configuration |\n | `dataHome` | string | An optional, in-pod location for data storage of default and custom file stores. If dataHome is not specified or its value is either not set or empty (e.g. dataHome: \"\") then the data storage directories are determined from the WebLogic domain home configuration. |\n-| `domainHome` | string | The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeInImage is false. Defaults to /u01/oracle/user_projects/domains/ if domainHomeInImage is true. |\n-| `domainHomeInImage` | Boolean | True if this domain's home is defined in the Docker image for the domain. Defaults to true. |\n+| `domainHome` | string | The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeSourceType is not Image. Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image. |\n+| `domainHomeInImage` | Boolean | Deprecated. Use domainHomeSourceType instead. True if this domain's home is defined in the Docker image for the domain. Defaults to true. |\n+| `domainHomeSourceType` | string | Domain home source type: Legal values: Image, PersistentVolume, FromModel. Defaults to Image unless configuration.model is provided and then defaults to FromModel. |\n | `domainUID` | string | Domain unique identifier. Must be unique across the Kubernetes cluster. Not required. Defaults to the value of metadata.name. |\n | `experimental` | [Experimental](#experimental) | Experimental feature configurations. |\n-| `image` | string | The WebLogic Docker image; required when domainHomeInImage is true; otherwise, defaults to container-registry.oracle.com/middleware/weblogic:12.2.1.3. |\n+| `image` | string | The WebLogic Docker image; required when domainHomeSourceType is Image; otherwise, defaults to container-registry.oracle.com/middleware/weblogic:12.2.1.3. |", "originalCommit": "f4e02c04b36ee24cb221d358728f279e117d1e97", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcxNDM0NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r373714344", "bodyText": "I'm thinking secrets should be moved up one level as they're shared by both MII and overrides.   Starting discussion in slack.", "author": "tbarnes-us", "createdAt": "2020-01-31T22:31:20Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -193,6 +194,24 @@ ServerPod describes the configuration for a Kubernetes pod for a server.\n | `annotations` | Map | The annotations to be attached to generated resources. |\n | `labels` | Map | The labels to be attached to generated resources. The label names must not start with 'weblogic.'. |\n \n+### Model\n+\n+| Name | Type | Description |\n+| --- | --- | --- |\n+| `configMapName` | string | WDT config map name |\n+| `domainType` | string | WDT domain type: Legal values: WLS, RestrictedJRF, JRF |\n+| `encryptionSecret` | [Secret Reference](k8s1.13.5.md#secret-reference) | WDT encryption key pass phrase secret. |\n+| `opss` | [Opss](#opss) | Configuration for OPSS based security |\n+| `rollbackIfRequireStart` | Boolean | Rollback dynamic changes if the updates requires restart |\n+| `useOnlineUpdate` | Boolean | Use online update during lifecycle changes |\n+\n+### Overrides\n+\n+| Name | Type | Description |\n+| --- | --- | --- |\n+| `configMapName` | string | The name of the config map for WebLogic configuration overrides. |\n+| `secrets` | array of string | A list of names of the secrets for WebLogic configuration overrides. |", "originalCommit": "f4e02c04b36ee24cb221d358728f279e117d1e97", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcxNjQzNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r373716435", "bodyText": "I have a pending pull with a heavily updated README that conflicts.  See https://github.com/oracle/weblogic-kubernetes-operator/pull/1413/files", "author": "tbarnes-us", "createdAt": "2020-01-31T22:38:45Z", "path": "kubernetes/samples/scripts/create-weblogic-domain/model-in-image/README.md", "diffHunk": "@@ -120,7 +120,9 @@ It is helpful to understand the following high-level flow before running the sam\n    - If you models reference Kubernetes secrets, then include the following keys to the domain resource yaml file as needed:\n    \n      ```\n-     configOverrideSecrets: [my-secret, my-other-secret]\n+     configuration:\n+       overrides:\n+         secrets: [my-secret, my-other-secret]\n      ```\n \n    - In addition, specify the domain type in the domain resource yaml attribute. Valid values are `WLS`, `JRF`, and `RestrictedJRF`.", "originalCommit": "f4e02c04b36ee24cb221d358728f279e117d1e97", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "483d19afa73504f5076a7f2d1c9eb38cef3ac4f8", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/483d19afa73504f5076a7f2d1c9eb38cef3ac4f8", "message": "Remove unneeded fields", "committedDate": "2020-02-03T17:24:06Z", "type": "commit"}, {"oid": "be3999a38476c93ecdf910304af7ea0ccb244a59", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/be3999a38476c93ecdf910304af7ea0ccb244a59", "message": "Merge remote-tracking branch 'origin/model-in-image' into model-in-image-schema", "committedDate": "2020-02-04T21:17:31Z", "type": "commit"}, {"oid": "0081fbab1b17baab6e995fa3b5e5503c4b0b9841", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0081fbab1b17baab6e995fa3b5e5503c4b0b9841", "message": "Some more moves", "committedDate": "2020-02-05T15:07:58Z", "type": "commit"}, {"oid": "d7393c1edcd5f71ef64a0ac2be570f63f3e5b7c5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d7393c1edcd5f71ef64a0ac2be570f63f3e5b7c5", "message": "Doc updates", "committedDate": "2020-02-05T15:18:16Z", "type": "commit"}, {"oid": "5b92147bd03b0dbb8ea91e9b40331d3c070f455f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5b92147bd03b0dbb8ea91e9b40331d3c070f455f", "message": "More schema and doc updates", "committedDate": "2020-02-05T16:33:41Z", "type": "commit"}, {"oid": "0ae1559486ba4adefce2517949b28174410d2f73", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0ae1559486ba4adefce2517949b28174410d2f73", "message": "Review comments", "committedDate": "2020-02-05T17:51:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQyMjM1OQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375422359", "bodyText": "I might be wrong, but I think in other places you mentioned the default it simply says 'defaults to Image'.  My preference would be to keep things simple and make the default Image regardless of whether the (optional) model config map is supplied instead of changing the doc.  Not a very strong preference, but we've been bitten by dynamic default patterns enough that I'm wary of them -- some end-users find them to be subtle, plus they IMO, they make a given domain resource less self-documenting.", "author": "tbarnes-us", "createdAt": "2020-02-05T18:13:00Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -223,18 +252,23 @@\n           \"description\": \"Experimental feature configurations.\",\n           \"$ref\": \"#/definitions/Experimental\"\n         },\n-        \"opssWalletSecret\": {\n-          \"description\": \"opss key passphrase.\",\n-          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"\n-        },\n         \"serverService\": {\n           \"description\": \"Customization affecting ClusterIP Kubernetes services for WebLogic Server instances.\",\n           \"$ref\": \"#/definitions/ServerService\"\n         },\n         \"domainHome\": {\n-          \"description\": \"The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeInImage is false. Defaults to /u01/oracle/user_projects/domains/ if domainHomeInImage is true.\",\n+          \"description\": \"The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeSourceType is not Image. Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image.\",\n           \"type\": \"string\"\n         },\n+        \"domainHomeSourceType\": {\n+          \"description\": \"Domain home source type: Legal values: Image, PersistentVolume, FromModel. Defaults to Image unless configuration.model is provided and then defaults to FromModel.\",", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQyMzA1NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375423055", "bodyText": "Add:  Default is WLS.", "author": "tbarnes-us", "createdAt": "2020-02-05T18:14:17Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -484,6 +487,41 @@\n       \"type\": \"object\",\n       \"properties\": {}\n     },\n+    \"Model\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"encryptionSecret\": {\n+          \"description\": \"WDT encryption key passphrase secret.\",\n+          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"\n+        },\n+        \"domainType\": {\n+          \"description\": \"WDT domain type: Legal values: WLS, RestrictedJRF, JRF\",", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQyNDQ3NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375424475", "bodyText": "Add 'Required when WDT model files are encrypted.'", "author": "tbarnes-us", "createdAt": "2020-02-05T18:16:55Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -484,6 +487,41 @@\n       \"type\": \"object\",\n       \"properties\": {}\n     },\n+    \"Model\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"encryptionSecret\": {\n+          \"description\": \"WDT encryption key passphrase secret.\",", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQyNjA2OQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375426069", "bodyText": "Add 'Required when WDT model files are encrypted.'", "author": "tbarnes-us", "createdAt": "2020-02-05T18:20:07Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -484,6 +487,41 @@\n       \"type\": \"object\",\n       \"properties\": {}\n     },\n+    \"Model\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"encryptionSecret\": {\n+          \"description\": \"WDT encryption key passphrase secret.\",", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQyODA1OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375428058", "bodyText": "For each deprecated element in the schema definition, can the description be updated to include the name of the replacement field?", "author": "tbarnes-us", "createdAt": "2020-02-05T18:23:55Z", "path": "docs/domains/index.html", "diffHunk": "@@ -1120,11 +1144,12 @@\n       \"description\": \"DomainSpec is a description of a domain.\",\n       \"type\": \"object\",\n       \"properties\": {\n-        \"keepJRFSchema\": {\n-          \"description\": \"Keep JRF schema between lifecycle updates\",\n-          \"type\": \"boolean\"\n+        \"configuration\": {\n+          \"description\": \"Models and overrides affecting the WebLogic domain configuration\",\n+          \"$ref\": \"#/definitions/Configuration\"\n         },\n         \"configOverrideSecrets\": {\n+          \"deprecated\": \"true\",\n           \"description\": \"A list of names of the secrets for optional WebLogic configuration overrides.\",", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQyOTEwNg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375429106", "bodyText": "Ah - I see you already did this in other places, but missed this one...", "author": "tbarnes-us", "createdAt": "2020-02-05T18:26:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQyODA1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQyODQ3OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375428478", "bodyText": "Same comment as above - maybe just default to Image instead of having a dynamically changing default.", "author": "tbarnes-us", "createdAt": "2020-02-05T18:24:47Z", "path": "docs/domains/index.html", "diffHunk": "@@ -1147,18 +1172,23 @@\n           \"description\": \"Experimental feature configurations.\",\n           \"$ref\": \"#/definitions/Experimental\"\n         },\n-        \"opssWalletSecret\": {\n-          \"description\": \"opss key passphrase.\",\n-          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"\n-        },\n         \"serverService\": {\n           \"description\": \"Customization affecting ClusterIP Kubernetes services for WebLogic Server instances.\",\n           \"$ref\": \"#/definitions/ServerService\"\n         },\n         \"domainHome\": {\n-          \"description\": \"The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeInImage is false. Defaults to /u01/oracle/user_projects/domains/ if domainHomeInImage is true.\",\n+          \"description\": \"The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeSourceType is not Image. Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image.\",\n           \"type\": \"string\"\n         },\n+        \"domainHomeSourceType\": {\n+          \"description\": \"Domain home source type: Legal values: Image, PersistentVolume, FromModel. Defaults to Image unless configuration.model is provided and then defaults to FromModel.\",", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzMDE0NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375430145", "bodyText": "configMapName --> configMap?   This would match the naming pattern used for other attributes like 'keyWalletConfigMap' and 'overridesConfigMap'.", "author": "tbarnes-us", "createdAt": "2020-02-05T18:28:05Z", "path": "docs/domains/index.html", "diffHunk": "@@ -1404,6 +1407,41 @@\n       \"type\": \"object\",\n       \"properties\": {}\n     },\n+    \"Model\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"encryptionSecret\": {\n+          \"description\": \"WDT encryption key passphrase secret.\",\n+          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"\n+        },\n+        \"domainType\": {\n+          \"description\": \"WDT domain type: Legal values: WLS, RestrictedJRF, JRF\",\n+          \"type\": \"string\",\n+          \"enum\": [\n+            \"WLS\",\n+            \"RestrictedJRF\",\n+            \"JRF\"\n+          ]\n+        },\n+        \"configMapName\": {", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzMjU0Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375432543", "bodyText": "I think it's likely that the encryptionSecret setting will be very rarely used and overally not very useful for model-in-image purposes -- so maybe move it to the end so it's not the first thing people see? Similarly, maybe move it to the last element in the java schema code too.\nAlso, please add sentence 'Required when WDT model files are encrypted.\"   (The reason it's rare is that the encryption is there to hide things like passwords, but, in Kubernetes land, passwords will come from macros that reference secrets.)", "author": "tbarnes-us", "createdAt": "2020-02-05T18:32:44Z", "path": "kubernetes/crd/domain-crd.yaml", "diffHunk": "@@ -26,10 +26,63 @@ spec:\n           type: object\n           description: DomainSpec is a description of a domain.\n           properties:\n+            configuration:\n+              type: object\n+              description: Models and overrides affecting the WebLogic domain configuration\n+              properties:\n+                opss:\n+                  type: object\n+                  description: Configuration for OPSS based security\n+                  properties:\n+                    keyWalletConfigMap:\n+                      type: string\n+                      description: The name of the config map containing the OPSS\n+                        key wallet file\n+                    walletSecret:\n+                      type: object\n+                      description: Secret containing OPSS key passphrase.\n+                      properties:\n+                        name:\n+                          type: string\n+                        namespace:\n+                          type: string\n+                model:\n+                  type: object\n+                  description: Model in image model files and properties\n+                  properties:\n+                    encryptionSecret:", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODUwMzU4Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378503587", "bodyText": "These files are auto-generated.  I think we have them sorted alphabetically, but I can check.  Either way, let's adjust (if we need to) in another PR.", "author": "rjeberhard", "createdAt": "2020-02-12T20:47:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzMjU0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzMzg0OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375433848", "bodyText": "Update this description if you agree to make this a static default instead of a dynamic default.", "author": "tbarnes-us", "createdAt": "2020-02-05T18:35:35Z", "path": "kubernetes/crd/domain-crd.yaml", "diffHunk": "@@ -91,9 +136,18 @@ spec:\n             domainHome:\n               type: string\n               description: The folder for the WebLogic Domain. Not required. Defaults\n-                to /shared/domains/domains/domainUID if domainHomeInImage is false.\n-                Defaults to /u01/oracle/user_projects/domains/ if domainHomeInImage\n-                is true.\n+                to /shared/domains/domains/domainUID if domainHomeSourceType is not\n+                Image. Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType\n+                is Image.\n+            domainHomeSourceType:\n+              type: string\n+              description: 'Domain home source type: Legal values: Image, PersistentVolume,\n+                FromModel. Defaults to Image unless configuration.model is provided\n+                and then defaults to FromModel.'", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzNzMzMQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375437331", "bodyText": "Related question:  If a 'domainHomeInImage' is explicitly set (to true or false) AND domainHomeSourceType is also set, I assume the latter takes precedence?    And if domainHomeSourceType is not set, then domainHomeInImage takes precedence (if not set or true, it's domain-in-mage, if false it's domain-in-pv)...", "author": "tbarnes-us", "createdAt": "2020-02-05T18:42:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzMzg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ0MTMxNA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375441314", "bodyText": "If you agree to make this aa static default, and my assumptions about handling the deprecated old field are correct, then the description should end with something like \"Defaults to FromImage if the deprecated attribute modelInImage is either not set or explicitly set to 'true'.  Defaults to PersistentVolume if the deprecated attribute modelInImage is explicitly set to 'false'.\"", "author": "tbarnes-us", "createdAt": "2020-02-05T18:50:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzMzg0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ0Mjk3Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375442977", "bodyText": "Change sentence to:  Set domainHomeInImage to FromModel.", "author": "tbarnes-us", "createdAt": "2020-02-05T18:53:10Z", "path": "kubernetes/samples/scripts/create-weblogic-domain/model-in-image/README.md", "diffHunk": "@@ -86,32 +86,39 @@ It is helpful to understand the following high-level flow before running the sam\n \n 6. Update domain resource yaml file attributes:\n \n-   - Set `domainHomeInImage` to true.\n+   - ```domainHomeSourceType``` must set to FromModel in the domain resource yaml file", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ0NjAzOA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375446038", "bodyText": "Please update this description and related descriptions elsewhere to make it clear that we currently only use the opss settings if domain source type is 'FromModel'.   We'll need to add support for Image and PV cases later (and probably very soon since support for re-using key/wallet is critical even in the non-Model case), but I assume that's not a blocking goal for the model-in-image project.  The Image and PV cases should have a tracking JIRA.", "author": "tbarnes-us", "createdAt": "2020-02-05T18:59:16Z", "path": "kubernetes/samples/scripts/create-weblogic-domain/model-in-image/k8s-domain.yaml.template", "diffHunk": "@@ -90,42 +83,31 @@ spec:\n     replicas: 2\n   # The number of managed servers to start for unlisted clusters\n   # replicas: 1\n-  \n-  # Optional configmap for additional models and variable files\n-  wdtConfigMap : domain1-wdt-config-map\n-\n-  # user model-in-image online update or not (default is false)\n-  #useOnlineUpdate: \"true\"\n-\n-  #\n-  # For life cycle online update, if it is set to true it will cancel the update and error out\n-  # default is false if not set\n-  #\n-  #rollbackIfRequireStart: true\n \n-  #\n-  # The wdt domain type for model in image case.\n-  # Valid values are 'WLS', 'JRF', and 'RestrictedJRF'\n-  #\n-  wdtDomainType: \"@@DOMTYPE@@\"\n+  configuration:\n+    secrets: [ sample-domain1-rcu-access ]\n \n-  #\n-  #\n-  # Keep jrf schema between updates. If not set, defaults to true.\n-  #\n-  #keepJRFSchema: \"true\"\n+    model:\n+      #\n+      # Optional configmap for additional models and variable files\n+      #\n+      configMapName: wdt-config-map\n \n-  #\n-  # k8 secret name for the opss extract wallet.  It contains the key passphrase used to extract the\n-  # opss wallet and optional key ewallet.p12 containing the base64 encoded opss wallet\n-  #\n-  #\n-  #opssWalletSecret:\n-  #  name: sample-domain1-opss-key-passphrase-secret\n+      #\n+      # wdt domain type for model in image case\n+      # Valid WDT_DOMAIN_TYPE_VALUES are 'WLS', 'JRF', and 'RestrictedJRF'\n+      #\n+      domainType: \"@@DOMTYPE@@\"\n \n-  #\n-  # Use this if the wdt model is encrypted\n-  #\n-  #wdtEncryptionPassPhrase:\n-  #  name: wdt-encrypt-passphrase-secret\n+    #opss:\n+      #\n+      # k8 secret name for the opss extract wallet.  It contains the key passphrase used to extract the\n+      # opss wallet and optional key ewallet.p12 containing the base64 encoded opss wallet", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODUxNDU0Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378514546", "bodyText": "Let's handle this later as this template is only for model in image.", "author": "rjeberhard", "createdAt": "2020-02-12T21:11:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ0NjAzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ0Nzk1MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375447951", "bodyText": "Now a secret and renamed to   walletFileSecret", "author": "tbarnes-us", "createdAt": "2020-02-05T19:02:59Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -193,6 +196,21 @@ ServerPod describes the configuration for a Kubernetes pod for a server.\n | `annotations` | Map | The annotations to be attached to generated resources. |\n | `labels` | Map | The labels to be attached to generated resources. The label names must not start with 'weblogic.'. |\n \n+### Model\n+\n+| Name | Type | Description |\n+| --- | --- | --- |\n+| `configMapName` | string | WDT config map name |\n+| `domainType` | string | WDT domain type: Legal values: WLS, RestrictedJRF, JRF |\n+| `encryptionSecret` | [Secret Reference](k8s1.13.5.md#secret-reference) | WDT encryption key passphrase secret. |\n+\n+### Opss\n+\n+| Name | Type | Description |\n+| --- | --- | --- |\n+| `keyWalletConfigMap` | string | The name of the config map containing the OPSS key wallet file |", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ1MjUzMA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375452530", "bodyText": "I think we agreed to change this to walletFileSecret and walletPasswordSecret per slack thread https://proddev-paas-fmw.slack.com/archives/CKFA73SNM/p1580504991015300", "author": "tbarnes-us", "createdAt": "2020-02-05T19:12:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ0Nzk1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ1MTkwNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375451905", "bodyText": "I think we agreed to change this to walletFileSecret and walletPasswordSecret per slack thread https://proddev-paas-fmw.slack.com/archives/CKFA73SNM/p1580504991015300", "author": "tbarnes-us", "createdAt": "2020-02-05T19:10:59Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -484,6 +487,41 @@\n       \"type\": \"object\",\n       \"properties\": {}\n     },\n+    \"Model\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"encryptionSecret\": {\n+          \"description\": \"WDT encryption key passphrase secret.\",\n+          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"\n+        },\n+        \"domainType\": {\n+          \"description\": \"WDT domain type: Legal values: WLS, RestrictedJRF, JRF\",\n+          \"type\": \"string\",\n+          \"enum\": [\n+            \"WLS\",\n+            \"RestrictedJRF\",\n+            \"JRF\"\n+          ]\n+        },\n+        \"configMapName\": {\n+          \"description\": \"WDT config map name\",\n+          \"type\": \"string\"\n+        }\n+      }\n+    },\n+    \"Opss\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"keyWalletConfigMap\": {\n+          \"description\": \"The name of the config map containing the OPSS key wallet file\",\n+          \"type\": \"string\"\n+        },\n+        \"walletSecret\": {\n+          \"description\": \"Secret containing OPSS key passphrase.\",\n+          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ1MzIxNA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375453214", "bodyText": "I think we agreed to change this to walletFileSecret and walletPasswordSecret per slack thread https://proddev-paas-fmw.slack.com/archives/CKFA73SNM/p1580504991015300", "author": "tbarnes-us", "createdAt": "2020-02-05T19:13:21Z", "path": "docs/domains/index.html", "diffHunk": "@@ -1404,6 +1407,41 @@\n       \"type\": \"object\",\n       \"properties\": {}\n     },\n+    \"Model\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"encryptionSecret\": {\n+          \"description\": \"WDT encryption key passphrase secret.\",\n+          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"\n+        },\n+        \"domainType\": {\n+          \"description\": \"WDT domain type: Legal values: WLS, RestrictedJRF, JRF\",\n+          \"type\": \"string\",\n+          \"enum\": [\n+            \"WLS\",\n+            \"RestrictedJRF\",\n+            \"JRF\"\n+          ]\n+        },\n+        \"configMapName\": {\n+          \"description\": \"WDT config map name\",\n+          \"type\": \"string\"\n+        }\n+      }\n+    },\n+    \"Opss\": {\n+      \"type\": \"object\",\n+      \"properties\": {\n+        \"keyWalletConfigMap\": {\n+          \"description\": \"The name of the config map containing the OPSS key wallet file\",\n+          \"type\": \"string\"\n+        },\n+        \"walletSecret\": {\n+          \"description\": \"Secret containing OPSS key passphrase.\",\n+          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ1NDU4Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375454583", "bodyText": "I think we agreed to change this to walletFileSecret and walletPasswordSecret per slack thread https://proddev-paas-fmw.slack.com/archives/CKFA73SNM/p1580504991015300  - like other secrets both should just refer to the Name (be of type string) - unless you think it's important to have a namespace prop for secrets?  If so, then all secret references should have a namespace, not just this one...", "author": "tbarnes-us", "createdAt": "2020-02-05T19:15:57Z", "path": "kubernetes/crd/domain-crd.yaml", "diffHunk": "@@ -26,10 +26,63 @@ spec:\n           type: object\n           description: DomainSpec is a description of a domain.\n           properties:\n+            configuration:\n+              type: object\n+              description: Models and overrides affecting the WebLogic domain configuration\n+              properties:\n+                opss:\n+                  type: object\n+                  description: Configuration for OPSS based security\n+                  properties:\n+                    keyWalletConfigMap:\n+                      type: string\n+                      description: The name of the config map containing the OPSS\n+                        key wallet file\n+                    walletSecret:", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ1NTA1NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375455054", "bodyText": "I think we agreed to change this to walletFileSecret and walletPasswordSecret per slack thread https://proddev-paas-fmw.slack.com/archives/CKFA73SNM/p1580504991015300", "author": "tbarnes-us", "createdAt": "2020-02-05T19:16:46Z", "path": "kubernetes/samples/scripts/create-weblogic-domain/model-in-image/README.md", "diffHunk": "@@ -430,7 +437,7 @@ To allow model-in-image to access the RCU database and OPSS wallet, it's necessa\n | `create_opss_key_secret.sh` | Defines secret `sample-domain1-opss-key-passphrase-secret` with `passphrase=welcome1` |\n | `create_rcu_access_secret.sh` | Defines secret `sample-domain1-rcu-access` with appropriate values for attributes `rcu_prefix`, `rcu_schema_password`, `rcu_admin_password`,  and `rcu_db_conn_string` |\n | `model1.yaml.jrf` | Populates the `domainInfo -> RCUDbInfo` stanza `rcu_prefix`, `rcu_schema_password`, `rcu_admin_password`,  and `rcu_db_conn_string` attributes by referencing their locations in the `sample-domain1-rcu-access` secret. |\n-| `k8s-domain.yaml.template` | Ensures the domain mounts the OPSS key secret by setting the domain resource `opssWalletSecret` attribute to `sample-domain1-rcu-access`, and ensures the domain mounts the RCU access secret `sample-domain1-rcu-access` for reference by WDT model macros by setting the domain resource `configOverridesSecrets` attribute. |\n+| `k8s-domain.yaml.template` | Ensures the domain mounts the OPSS key secret by setting the domain resource `configuration.opss.walletSecret` attribute to `sample-domain1-rcu-access`, and ensures the domain mounts the RCU access secret `sample-domain1-rcu-access` for reference by WDT model macros by setting the domain resource `configuration.secrets` attribute. |\n ", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ1NzEwNQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r375457105", "bodyText": "I think we agreed to change this to walletFileSecret and walletPasswordSecret per slack thread https://proddev-paas-fmw.slack.com/archives/CKFA73SNM/p1580504991015300, so we'll need to env vars OPSS_WALLET_FILE_SECRET_NAME and OPSS_WALLET_PASSWORD_SECRET_NAME.   Also Johnny's RCU code will eventially need to change to look in the right locations and use the right env vars to get these values.    Finally, the expected attribute within each secret will be 'walletFile' and 'walletPassword' respectively.", "author": "tbarnes-us", "createdAt": "2020-02-05T19:20:36Z", "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/JobHelper.java", "diffHunk": "@@ -249,12 +249,8 @@ private String getAsServiceName() {\n       addEnvVar(vars, IntrospectorJobEnvVars.NAMESPACE, getNamespace());\n       addEnvVar(vars, IntrospectorJobEnvVars.INTROSPECT_HOME, getIntrospectHome());\n       addEnvVar(vars, IntrospectorJobEnvVars.CREDENTIALS_SECRET_NAME, getWebLogicCredentialsSecretName());\n-      addEnvVar(vars, IntrospectorJobEnvVars.OPSS_WALLET_SECRET_NAME, getOpssWalletSecretName());\n-      addEnvVar(vars, IntrospectorJobEnvVars.WDT_ENCRYPTION_PASSPHRASE_NAME, getWdtEncryptPassPhraseName());\n-      addEnvVar(vars, IntrospectorJobEnvVars.ROLLBACK_IF_REQUIRE_RESTART,\n-          Boolean.toString(isRollBackIfRequireRestart()));\n-      addEnvVar(vars, IntrospectorJobEnvVars.USE_ONLINE_UPDATE, Boolean.toString(isUseOnlineUpdate()));\n-      addEnvVar(vars, IntrospectorJobEnvVars.KEEP_JRF_SCHEMA, Boolean.toString(isKeepJrfSchema()));\n+      addEnvVar(vars, IntrospectorJobEnvVars.OPSS_KEY_SECRET_NAME, getOpssWalletSecretName());", "originalCommit": "0ae1559486ba4adefce2517949b28174410d2f73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5e59c31626a29adfcab73fca3398d596e26f5383", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5e59c31626a29adfcab73fca3398d596e26f5383", "message": "Merge remote-tracking branch 'origin/model-in-image' into model-in-image-schema", "committedDate": "2020-02-07T15:42:13Z", "type": "commit"}, {"oid": "82be30844193aab8993d5abfc5e0ed1a583e524c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/82be30844193aab8993d5abfc5e0ed1a583e524c", "message": "last schema name changes", "committedDate": "2020-02-12T19:13:55Z", "type": "commit"}, {"oid": "caf39a64c946720572972670501ae88826323f9f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/caf39a64c946720572972670501ae88826323f9f", "message": "Missing file", "committedDate": "2020-02-12T19:18:07Z", "type": "commit"}, {"oid": "342be352512afff752d26408f13d760cf6954149", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/342be352512afff752d26408f13d760cf6954149", "message": "More doc updates", "committedDate": "2020-02-12T20:10:11Z", "type": "commit"}, {"oid": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5d01315afc31bcbb84a763cd79de7d0df36b10f0", "message": "Missed file", "committedDate": "2020-02-12T20:13:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU0NTEzMg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378545132", "bodyText": "The looks incorrect.  Today, the 'logHome' defaults to overriding iff on PV.   We should continue that behavior as we don't need/want to override unless there's a PV that has the new log file location available.\nSo \"and domainHomeSourceType is set to PersistentVolume or FromModel. \" should be \"and domainHomeSourceType is set to PersistentVolume.\"\n(Plus make sure the java implementation only changes the defaulting for PV domain source type...)", "author": "tbarnes-us", "createdAt": "2020-02-12T22:17:00Z", "path": "docs-source/content/userguide/managing-domains/_index.md", "diffHunk": "@@ -33,9 +33,9 @@ Please be aware of the following important considerations for WebLogic domains r\n   in the ***Security*** section.\n   {{% /notice %}}\n \n-* _Log File Locations:_ The operator can automatically override WebLogic domain and server log locations using situational\n+* _Log File Locations:_ The operator can automatically override WebLogic domain and server log locations using\n   configuration overrides.  This occurs if the domain resource `logHomeEnabled` field is explicitly set to `true`, or if `logHomeEnabled` isn't set\n-  and `domainHomeInImage` is explicitly set to `false`.   When overriding, the log location will be the location specified by the `logHome` setting.\n+  and `domainHomeSourceType` is set to `PersistentVolume` or `FromModel`.   When overriding, the log location will be the location specified by the `logHome` setting.", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkzNTgzMA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378935830", "bodyText": "What's the default behavior if domainHomeSourceType is FromModel and without setting logHomeEnabled?  It failed validation if logHomeEnabled is not set.\n{\n\"timeInMillis\" : \"1581607100108\"\n\"body\" : \"\"\n\"code\" : \"\"\n\"timestamp\" : \"02-13-2020T15:18:20.108+0000\"\n\"domainUID\" : \"domain1\"\n\"fiber\" : \"engine-operator-thread-6-fiber-27\"\n\"message\" : \"Domain domain1 is not valid: No volume mount contains path for log home '/shared/logs/domain1'\"\n\"class\" : \"oracle.kubernetes.operator.helpers.DomainValidationSteps$DomainValidationStep\"\n\"exception\" : \"\"\n\"thread\" : \"23\"\n\"level\" : \"SEVERE\"\n\"headers\" : \"{}\"\n\"method\" : \"apply\"\n}", "author": "jshum2479", "createdAt": "2020-02-13T15:32:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU0NTEzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTAyOTQyMw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r379029423", "bodyText": "Johnny, this validation will go away once I make the change to isLogHomeEnabled() recommended by Tom.", "author": "rjeberhard", "createdAt": "2020-02-13T18:07:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU0NTEzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU0NjY5MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378546691", "bodyText": "As per previous comment, remove \"or FromModel\".", "author": "tbarnes-us", "createdAt": "2020-02-12T22:20:44Z", "path": "docs-source/content/userguide/managing-domains/domain-resource.md", "diffHunk": "@@ -61,17 +61,17 @@ The domain resource `spec` section contains elements for configuring the domain\n Elements related to domain identification, Docker image, and domain home:\n \n * `domainUID`: The domain unique identifier. Must be unique across the Kubernetes cluster. Not required. Defaults to the value of `metadata.name`.\n-* `image`: The WebLogic Docker image. Required when `domainHomeInImage` is true; otherwise, defaults to `container-registry.oracle.com/middleware/weblogic:12.2.1.3`.\n+* `image`: The WebLogic Docker image. Required when `domainHomeSourceType` is `Image`; otherwise, defaults to `container-registry.oracle.com/middleware/weblogic:12.2.1.3`.\n * `imagePullPolicy`: The image pull policy for the WebLogic Docker image. Legal values are `Always`, `Never` and `IfNotPresent`. Defaults to `Always` if image ends in `:latest`; `IfNotPresent` otherwise.\n * `imagePullSecrets`: A list of image pull secrets for the WebLogic Docker image.\n * `domainHome`: The folder for the WebLogic domain. Not required. Defaults to `/shared/domains/domains/domainUID` if `domainHomeInImage` is false. Defaults to `/u01/oracle/user_projects/domains/` if `domainHomeInImage` is true.\n-* `domainHomeInImage`: True if this domain's home is defined in the Docker image for the domain. Defaults to true.\n+* `domainHomeSourceType`: The source for the domain home. Legal values are `Image`, `PersistentVolume`, and `FromModel`. Defaults to `Image`.\n \n Elements related to logging:\n \n * `includeServerOutInPodLog`: If true (the default), the server `.out` file will be included in the pod's stdout.\n * `logHome`: The in-pod name of the directory in which to store the domain, Node Manager, server logs, and server `.out` files.\n-* `logHomeEnabled`: Specifies whether the log home folder is enabled. Not required. Defaults to true if `domainHomeInImage` is false. Defaults to false if `domainHomeInImage` is true.\n+* `logHomeEnabled`: Specifies whether the log home folder is enabled. Not required. Defaults to true if `domainHomeSourceType` is `PersistentVolume` or `FromModel`.", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU0ODE2OQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378548169", "bodyText": "Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image.\", --> Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image or FromModel.\",", "author": "tbarnes-us", "createdAt": "2020-02-12T22:24:12Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -223,18 +252,23 @@\n           \"description\": \"Experimental feature configurations.\",\n           \"$ref\": \"#/definitions/Experimental\"\n         },\n-        \"opssWalletSecret\": {\n-          \"description\": \"opss key passphrase.\",\n-          \"$ref\": \"https://github.com/garethr/kubernetes-json-schema/blob/master/v1.13.5/_definitions.json#/definitions/io.k8s.api.core.v1.SecretReference\"\n-        },\n         \"serverService\": {\n           \"description\": \"Customization affecting ClusterIP Kubernetes services for WebLogic Server instances.\",\n           \"$ref\": \"#/definitions/ServerService\"\n         },\n         \"domainHome\": {\n-          \"description\": \"The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeInImage is false. Defaults to /u01/oracle/user_projects/domains/ if domainHomeInImage is true.\",\n+          \"description\": \"The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeSourceType is not Image. Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image.\",", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU0ODg0MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378548841", "bodyText": "Pretty sure - we should verify with Johnny.", "author": "tbarnes-us", "createdAt": "2020-02-12T22:25:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU0ODE2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU2NzQzNg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378567436", "bodyText": "Change:\nDefault for PV remains same as before.\nDefault for Image remains same as before.\nDefault for From Model is:  /u01/domains/DOMAIN_NAME", "author": "tbarnes-us", "createdAt": "2020-02-12T23:13:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU0ODE2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1MDU2Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378550567", "bodyText": "is Image --> is Image or FromModel.  ?", "author": "tbarnes-us", "createdAt": "2020-02-12T22:29:47Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -18,34 +18,28 @@ DomainSpec is a description of a domain.\n | --- | --- | --- |\n | `adminServer` | [Admin Server](#admin-server) | Configuration for the Administration Server. |\n | `clusters` | array of [Cluster](#cluster) | Configuration for the clusters. |\n-| `configOverrides` | string | The name of the config map for optional WebLogic configuration overrides. |\n-| `configOverrideSecrets` | array of string | A list of names of the secrets for optional WebLogic configuration overrides. |\n+| `configOverrides` | string | Deprecated. Use configuration.overridesConfigMap instead. Ignored if configuration.overridesConfigMap is specified. The name of the config map for optional WebLogic configuration overrides. |\n+| `configOverrideSecrets` | array of string | Deprecated. Use configuration.secrets instead. Ignored if configuration.secrets is specified. A list of names of the secrets for optional WebLogic configuration overrides. |\n+| `configuration` | [Configuration](#configuration) | Models and overrides affecting the WebLogic domain configuration. |\n | `dataHome` | string | An optional, in-pod location for data storage of default and custom file stores. If dataHome is not specified or its value is either not set or empty (e.g. dataHome: \"\") then the data storage directories are determined from the WebLogic domain home configuration. |\n-| `domainHome` | string | The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeInImage is false. Defaults to /u01/oracle/user_projects/domains/ if domainHomeInImage is true. |\n-| `domainHomeInImage` | Boolean | True if this domain's home is defined in the Docker image for the domain. Defaults to true. |\n+| `domainHome` | string | The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeSourceType is not Image. Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image. |", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1MTUzMw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378551533", "bodyText": "is Image. --> is Image or FromModel.", "author": "tbarnes-us", "createdAt": "2020-02-12T22:32:06Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -18,34 +18,28 @@ DomainSpec is a description of a domain.\n | --- | --- | --- |\n | `adminServer` | [Admin Server](#admin-server) | Configuration for the Administration Server. |\n | `clusters` | array of [Cluster](#cluster) | Configuration for the clusters. |\n-| `configOverrides` | string | The name of the config map for optional WebLogic configuration overrides. |\n-| `configOverrideSecrets` | array of string | A list of names of the secrets for optional WebLogic configuration overrides. |\n+| `configOverrides` | string | Deprecated. Use configuration.overridesConfigMap instead. Ignored if configuration.overridesConfigMap is specified. The name of the config map for optional WebLogic configuration overrides. |\n+| `configOverrideSecrets` | array of string | Deprecated. Use configuration.secrets instead. Ignored if configuration.secrets is specified. A list of names of the secrets for optional WebLogic configuration overrides. |\n+| `configuration` | [Configuration](#configuration) | Models and overrides affecting the WebLogic domain configuration. |\n | `dataHome` | string | An optional, in-pod location for data storage of default and custom file stores. If dataHome is not specified or its value is either not set or empty (e.g. dataHome: \"\") then the data storage directories are determined from the WebLogic domain home configuration. |\n-| `domainHome` | string | The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeInImage is false. Defaults to /u01/oracle/user_projects/domains/ if domainHomeInImage is true. |\n-| `domainHomeInImage` | Boolean | True if this domain's home is defined in the Docker image for the domain. Defaults to true. |\n+| `domainHome` | string | The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeSourceType is not Image. Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image. |\n+| `domainHomeInImage` | Boolean | Deprecated. Use domainHomeSourceType instead. Ignored if domainHomeSourceType is specified. True indicates that the domain home file system is contained in the Docker image specified by the image field. False indicates that the domain home file system is located on a persistent volume. |\n+| `domainHomeSourceType` | string | Domain home file system source type: Legal values: Image, PersistentVolume, FromModel. Image indicates that the domain home file system is contained in the Docker image specified by the image field. PersistentVolume indicates that the domain home file system is located on a persistent volume.  FromModel indicates that the domain home file system will be created and managed by the operator based on a WDT domain model. If this field is specified it overrides the value of domainHomeInImage. If both fields are unspecified then domainHomeSourceType defaults to Image. |\n | `domainUID` | string | Domain unique identifier. Must be unique across the Kubernetes cluster. Not required. Defaults to the value of metadata.name. |\n | `experimental` | [Experimental](#experimental) | Experimental feature configurations. |\n-| `image` | string | The WebLogic Docker image; required when domainHomeInImage is true; otherwise, defaults to container-registry.oracle.com/middleware/weblogic:12.2.1.3. |\n+| `image` | string | The WebLogic Docker image; required when domainHomeSourceType is Image or FromModel; otherwise, defaults to container-registry.oracle.com/middleware/weblogic:12.2.1.3. |\n | `imagePullPolicy` | string | The image pull policy for the WebLogic Docker image. Legal values are Always, Never and IfNotPresent. Defaults to Always if image ends in :latest, IfNotPresent otherwise. |\n | `imagePullSecrets` | array of [Local Object Reference](k8s1.13.5.md#local-object-reference) | A list of image pull secrets for the WebLogic Docker image. |\n | `includeServerOutInPodLog` | Boolean | If true (the default), the server .out file will be included in the pod's stdout. |\n-| `keepJrfSchema` | Boolean | Keep JRF schema between lifecycle updates |\n | `logHome` | string | The in-pod name of the directory in which to store the domain, node manager, server logs, and server  *.out files |\n-| `logHomeEnabled` | Boolean | Specified whether the log home folder is enabled. Not required. Defaults to true if domainHomeInImage is false. Defaults to false if domainHomeInImage is true.  |\n+| `logHomeEnabled` | Boolean | Specified whether the log home folder is enabled. Not required. Defaults to true if domainHomeSourceType is not Image. Defaults to false if domainHomeSourceType is Image.  |", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1MzI5OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378553298", "bodyText": "This does not need to be required, even if FromModel.\nChange wording to something like \"Optional WDT config map, only used if domainHomeSourceType is FromModel.\"", "author": "tbarnes-us", "createdAt": "2020-02-12T22:36:33Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -193,6 +196,21 @@ ServerPod describes the configuration for a Kubernetes pod for a server.\n | `annotations` | Map | The annotations to be attached to generated resources. |\n | `labels` | Map | The labels to be attached to generated resources. The label names must not start with 'weblogic.'. |\n \n+### Model\n+\n+| Name | Type | Description |\n+| --- | --- | --- |\n+| `configMap` | string | WDT config map name. Required. |", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1MzQ1NQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378553455", "bodyText": "Also, please change corresponding java so that this field is no longer required.", "author": "tbarnes-us", "createdAt": "2020-02-12T22:36:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1MzI5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1MzkzMQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378553931", "bodyText": "What is an '(k8s1.13.5.md#secret-reference)', simply a secret name?  Can we support just putting a secret name here?", "author": "tbarnes-us", "createdAt": "2020-02-12T22:38:07Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -193,6 +196,21 @@ ServerPod describes the configuration for a Kubernetes pod for a server.\n | `annotations` | Map | The annotations to be attached to generated resources. |\n | `labels` | Map | The labels to be attached to generated resources. The label names must not start with 'weblogic.'. |\n \n+### Model\n+\n+| Name | Type | Description |\n+| --- | --- | --- |\n+| `configMap` | string | WDT config map name. Required. |\n+| `domainType` | string | WDT domain type: Legal values: WLS, RestrictedJRF, JRF. Defaults to WLS. |\n+| `encryptionSecret` | [Secret Reference](k8s1.13.5.md#secret-reference) | WDT encryption key passphrase secret. Required when WDT model files are encrypted. |", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU2ODYwNA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378568604", "bodyText": "Change to just a string.", "author": "tbarnes-us", "createdAt": "2020-02-12T23:17:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1MzkzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1NDA0NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378554044", "bodyText": "What is an '(k8s1.13.5.md#secret-reference)', simply a secret name? Can we support just putting a secret name here?", "author": "tbarnes-us", "createdAt": "2020-02-12T22:38:25Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -193,6 +196,21 @@ ServerPod describes the configuration for a Kubernetes pod for a server.\n | `annotations` | Map | The annotations to be attached to generated resources. |\n | `labels` | Map | The labels to be attached to generated resources. The label names must not start with 'weblogic.'. |\n \n+### Model\n+\n+| Name | Type | Description |\n+| --- | --- | --- |\n+| `configMap` | string | WDT config map name. Required. |\n+| `domainType` | string | WDT domain type: Legal values: WLS, RestrictedJRF, JRF. Defaults to WLS. |\n+| `encryptionSecret` | [Secret Reference](k8s1.13.5.md#secret-reference) | WDT encryption key passphrase secret. Required when WDT model files are encrypted. |\n+\n+### Opss\n+\n+| Name | Type | Description |\n+| --- | --- | --- |\n+| `walletFileSecret` | [Secret Reference](k8s1.13.5.md#secret-reference) | Secret containing the OPSS key wallet file. |\n+| `walletPasswordSecret` | [Secret Reference](k8s1.13.5.md#secret-reference) | Secret containing OPSS key passphrase. |", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU2ODY3Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378568673", "bodyText": "Change to just a string.", "author": "tbarnes-us", "createdAt": "2020-02-12T23:17:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODU1NDA0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk0MDUwNA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r378940504", "bodyText": "Needs to be domain1-wdt-config-map", "author": "jshum2479", "createdAt": "2020-02-13T15:39:49Z", "path": "kubernetes/samples/scripts/create-weblogic-domain/model-in-image/k8s-domain.yaml.template", "diffHunk": "@@ -90,42 +83,33 @@ spec:\n     replicas: 2\n   # The number of managed servers to start for unlisted clusters\n   # replicas: 1\n-  \n-  # Optional configmap for additional models and variable files\n-  wdtConfigMap : domain1-wdt-config-map\n-\n-  # user model-in-image online update or not (default is false)\n-  #useOnlineUpdate: \"true\"\n-\n-  #\n-  # For life cycle online update, if it is set to true it will cancel the update and error out\n-  # default is false if not set\n-  #\n-  #rollbackIfRequireStart: true\n \n-  #\n-  # The wdt domain type for model in image case.\n-  # Valid values are 'WLS', 'JRF', and 'RestrictedJRF'\n-  #\n-  wdtDomainType: \"@@DOMTYPE@@\"\n+  configuration:\n+    secrets: [ sample-domain1-rcu-access ]\n \n-  #\n-  #\n-  # Keep jrf schema between updates. If not set, defaults to true.\n-  #\n-  #keepJRFSchema: \"true\"\n+    model:\n+      #\n+      # Optional configmap for additional models and variable files\n+      #\n+      configMap: wdt-config-map", "originalCommit": "5d01315afc31bcbb84a763cd79de7d0df36b10f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e56eb503b99fd89b57421e632370284587e610d5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e56eb503b99fd89b57421e632370284587e610d5", "message": "Review comments", "committedDate": "2020-02-13T19:01:50Z", "type": "commit"}, {"oid": "37647c1429b47e3ff073eddfb7d1c86eb377a942", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/37647c1429b47e3ff073eddfb7d1c86eb377a942", "message": "Merge remote-tracking branch 'origin/model-in-image' into model-in-image-schema", "committedDate": "2020-02-13T19:13:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTA4Mjk1OQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r379082959", "bodyText": "Fix domainHome description to reflect the new default for FromModel.", "author": "tbarnes-us", "createdAt": "2020-02-13T19:50:21Z", "path": "docs-source/content/userguide/managing-domains/_index.md", "diffHunk": "@@ -18,10 +18,10 @@ description: \"Important considerations for WebLogic domains in Kubernetes.\"\n \n Please be aware of the following important considerations for WebLogic domains running in Kubernetes:\n \n-* _Domain Home Location:_ The WebLogic domain home location is determined by the domain resource `domainHome` if set; otherwise, a default location is determined by the `domainHomeInImage` setting. If a domain resource `domainHome` field is not set\n-  and `domainHomeInImage` is `true` (the default), then the operator will\n+* _Domain Home Location:_ The WebLogic domain home location is determined by the domain resource `domainHome`, if specified; otherwise, a default location is determined by the `domainHomeSourceType` setting. If the domain resource `domainHome` field is not specified\n+  and `domainHomeSourceType` is `Image` (the default), then the operator will\n   assume that the domain home is a directory under `/u01/oracle/user_projects/domains/` and report an error if no domain is found\n-  or more than one domain is found.  If a domain resource `domainHome` field is not set and `domainHomeInImage` is `false`, then the operator will\n+  or more than one domain is found.  If the domain resource `domainHome` field is not specified and `domainHomeSourceType` is `PersistentVolume` or `FromModel`, then the operator will", "originalCommit": "37647c1429b47e3ff073eddfb7d1c86eb377a942", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTA4Mzk2MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r379083960", "bodyText": "Update text to reflect new defaults (one for each source type).", "author": "tbarnes-us", "createdAt": "2020-02-13T19:52:18Z", "path": "docs-source/content/userguide/managing-domains/domain-resource.md", "diffHunk": "@@ -61,17 +61,17 @@ The domain resource `spec` section contains elements for configuring the domain\n Elements related to domain identification, Docker image, and domain home:\n \n * `domainUID`: The domain unique identifier. Must be unique across the Kubernetes cluster. Not required. Defaults to the value of `metadata.name`.\n-* `image`: The WebLogic Docker image. Required when `domainHomeInImage` is true; otherwise, defaults to `container-registry.oracle.com/middleware/weblogic:12.2.1.3`.\n+* `image`: The WebLogic Docker image. Required when `domainHomeSourceType` is `Image`; otherwise, defaults to `container-registry.oracle.com/middleware/weblogic:12.2.1.3`.\n * `imagePullPolicy`: The image pull policy for the WebLogic Docker image. Legal values are `Always`, `Never` and `IfNotPresent`. Defaults to `Always` if image ends in `:latest`; `IfNotPresent` otherwise.\n * `imagePullSecrets`: A list of image pull secrets for the WebLogic Docker image.\n * `domainHome`: The folder for the WebLogic domain. Not required. Defaults to `/shared/domains/domains/domainUID` if `domainHomeInImage` is false. Defaults to `/u01/oracle/user_projects/domains/` if `domainHomeInImage` is true.", "originalCommit": "37647c1429b47e3ff073eddfb7d1c86eb377a942", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTA4NTk4Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r379085983", "bodyText": "Optional.  The logHome description could be updated to reflect its defaulting behavior.", "author": "tbarnes-us", "createdAt": "2020-02-13T19:56:22Z", "path": "docs/domains/Domain.json", "diffHunk": "@@ -243,22 +277,10 @@\n           \"description\": \"Configuration for the Administration Server.\",\n           \"$ref\": \"#/definitions/AdminServer\"\n         },\n-        \"useOnlineUpdate\": {\n-          \"description\": \"Use Online update during lifecycle changes\",\n-          \"type\": \"boolean\"\n-        },\n-        \"rollbackIfRequireStart\": {\n-          \"description\": \"Rollback dynamic changes if the updates require restart\",\n-          \"type\": \"boolean\"\n-        },\n         \"logHome\": {\n           \"description\": \"The in-pod name of the directory in which to store the domain, node manager, server logs, and server  *.out files\",", "originalCommit": "37647c1429b47e3ff073eddfb7d1c86eb377a942", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTA4NzI1OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1415#discussion_r379087258", "bodyText": "Add description of defaulting behavior.", "author": "tbarnes-us", "createdAt": "2020-02-13T19:58:59Z", "path": "docs/domains/Domain.md", "diffHunk": "@@ -18,34 +18,28 @@ DomainSpec is a description of a domain.\n | --- | --- | --- |\n | `adminServer` | [Admin Server](#admin-server) | Configuration for the Administration Server. |\n | `clusters` | array of [Cluster](#cluster) | Configuration for the clusters. |\n-| `configOverrides` | string | The name of the config map for optional WebLogic configuration overrides. |\n-| `configOverrideSecrets` | array of string | A list of names of the secrets for optional WebLogic configuration overrides. |\n+| `configOverrides` | string | Deprecated. Use configuration.overridesConfigMap instead. Ignored if configuration.overridesConfigMap is specified. The name of the config map for optional WebLogic configuration overrides. |\n+| `configOverrideSecrets` | array of string | Deprecated. Use configuration.secrets instead. Ignored if configuration.secrets is specified. A list of names of the secrets for optional WebLogic configuration overrides. |\n+| `configuration` | [Configuration](#configuration) | Models and overrides affecting the WebLogic domain configuration. |\n | `dataHome` | string | An optional, in-pod location for data storage of default and custom file stores. If dataHome is not specified or its value is either not set or empty (e.g. dataHome: \"\") then the data storage directories are determined from the WebLogic domain home configuration. |\n-| `domainHome` | string | The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/domainUID if domainHomeInImage is false. Defaults to /u01/oracle/user_projects/domains/ if domainHomeInImage is true. |\n-| `domainHomeInImage` | Boolean | True if this domain's home is defined in the Docker image for the domain. Defaults to true. |\n+| `domainHome` | string | The folder for the WebLogic Domain. Not required. Defaults to /shared/domains/domains/<domainUID> if domainHomeSourceType is PersistentVolume. Defaults to /u01/oracle/user_projects/domains/ if domainHomeSourceType is Image. Defaults to /u01/domains/<domainUID> if domainHomeSourceType is FromModel. |\n+| `domainHomeInImage` | Boolean | Deprecated. Use domainHomeSourceType instead. Ignored if domainHomeSourceType is specified. True indicates that the domain home file system is contained in the Docker image specified by the image field. False indicates that the domain home file system is located on a persistent volume. |\n+| `domainHomeSourceType` | string | Domain home file system source type: Legal values: Image, PersistentVolume, FromModel. Image indicates that the domain home file system is contained in the Docker image specified by the image field. PersistentVolume indicates that the domain home file system is located on a persistent volume.  FromModel indicates that the domain home file system will be created and managed by the operator based on a WDT domain model. If this field is specified it overrides the value of domainHomeInImage. If both fields are unspecified then domainHomeSourceType defaults to Image. |\n | `domainUID` | string | Domain unique identifier. Must be unique across the Kubernetes cluster. Not required. Defaults to the value of metadata.name. |\n | `experimental` | [Experimental](#experimental) | Experimental feature configurations. |\n-| `image` | string | The WebLogic Docker image; required when domainHomeInImage is true; otherwise, defaults to container-registry.oracle.com/middleware/weblogic:12.2.1.3. |\n+| `image` | string | The WebLogic Docker image; required when domainHomeSourceType is Image or FromModel; otherwise, defaults to container-registry.oracle.com/middleware/weblogic:12.2.1.3. |\n | `imagePullPolicy` | string | The image pull policy for the WebLogic Docker image. Legal values are Always, Never and IfNotPresent. Defaults to Always if image ends in :latest, IfNotPresent otherwise. |\n | `imagePullSecrets` | array of [Local Object Reference](k8s1.13.5.md#local-object-reference) | A list of image pull secrets for the WebLogic Docker image. |\n | `includeServerOutInPodLog` | Boolean | If true (the default), the server .out file will be included in the pod's stdout. |\n-| `keepJrfSchema` | Boolean | Keep JRF schema between lifecycle updates |\n | `logHome` | string | The in-pod name of the directory in which to store the domain, node manager, server logs, and server  *.out files |", "originalCommit": "37647c1429b47e3ff073eddfb7d1c86eb377a942", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "29aa333ed3df78ccc08f94155cfd3df22bc25928", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/29aa333ed3df78ccc08f94155cfd3df22bc25928", "message": "Clarify some more defaults", "committedDate": "2020-02-13T21:31:07Z", "type": "commit"}]}