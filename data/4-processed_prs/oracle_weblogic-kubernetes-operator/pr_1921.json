{"pr_number": 1921, "pr_title": "OWLS-84517: Scaling failed when setting Dedicated to true", "pr_createdAt": "2020-09-15T05:21:56Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1921", "timeline": [{"oid": "0831b7dc808c0de8fee3a45060eb03eb1e50960a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0831b7dc808c0de8fee3a45060eb03eb1e50960a", "message": "Rest authentication of requests should use namespace scope for Dedicated selection strategy", "committedDate": "2020-09-15T05:03:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODkwNjc3MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1921#discussion_r488906770", "bodyText": "It is bad practice to leave a println in your tests. I assume you needed this for debugging and forgot to remove it?", "author": "russgold", "createdAt": "2020-09-15T19:14:57Z", "path": "operator/src/test/java/oracle/kubernetes/operator/helpers/AuthenticationProxyTest.java", "diffHunk": "@@ -0,0 +1,72 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.kubernetes.operator.helpers;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import com.meterware.simplestub.Memento;\n+import com.meterware.simplestub.StaticStubSupport;\n+import oracle.kubernetes.operator.helpers.AuthorizationProxy.Scope;\n+import oracle.kubernetes.utils.TestUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+import static org.hamcrest.Matchers.equalTo;\n+import static org.hamcrest.junit.MatcherAssert.assertThat;\n+\n+public class AuthenticationProxyTest {\n+\n+  private final List<Memento> mementos = new ArrayList<>();\n+  private final KubernetesTestSupport testSupport = new KubernetesTestSupport();\n+  private final AuthorizationProxyStub authorizationProxyStub = new AuthorizationProxyStub();\n+\n+  /**\n+   * Setup test.\n+   * @throws Exception on failure\n+   */\n+  @Before\n+  public void setUp() throws Exception {\n+    mementos.add(TestUtils.silenceOperatorLogger());\n+    mementos.add(testSupport.install());\n+    mementos.add(\n+        StaticStubSupport.install(AuthenticationProxy.class, \"authorizationProxy\", authorizationProxyStub));\n+  }\n+\n+  @After\n+  public void tearDown() {\n+    mementos.forEach(Memento::revert);\n+  }\n+\n+  @Test\n+  public void verify_authorizationScope_isCluster_whenNamespaceIsNull() {\n+    AuthenticationProxy authorizationProxy = new AuthenticationProxy();\n+    authorizationProxy.check(\"\", \"\", null);\n+    assertThat(authorizationProxyStub.scope, equalTo(Scope.cluster));\n+  }\n+\n+  @Test\n+  public void verify_authorizationScope_isNamespace_whenNamespaceIsDefined() {\n+    AuthenticationProxy authorizationProxy = new AuthenticationProxy();\n+    authorizationProxy.check(\"\", \"\", \"NS\");\n+    assertThat(authorizationProxyStub.scope, equalTo(Scope.namespace));\n+  }\n+\n+  private class AuthorizationProxyStub extends AuthorizationProxy {\n+    Scope scope;\n+\n+    public boolean check(\n+        String principal,\n+        Operation operation,\n+        Resource resource,\n+        String resourceName,\n+        Scope scope,\n+        String namespaceName) {\n+      this.scope = scope;\n+      System.out.println(\"AuthorizationProxyStub.check scope: \" + scope);", "originalCommit": "0831b7dc808c0de8fee3a45060eb03eb1e50960a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "176fdbf517f967a8eeb5bd3d38669fe09ac8ff08", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/176fdbf517f967a8eeb5bd3d38669fe09ac8ff08", "message": "remove System.out.println from unit test", "committedDate": "2020-09-15T21:00:42Z", "type": "commit"}]}