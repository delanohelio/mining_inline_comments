{"pr_number": 1382, "pr_title": "Nm mem args", "pr_createdAt": "2020-01-07T18:19:05Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1382", "timeline": [{"oid": "fb479c163d34ad095d68776dd9b0e74859e9125d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fb479c163d34ad095d68776dd9b0e74859e9125d", "message": "set -Djava.security.egd=file:/dev/./urandom for Node Manager, if not defined", "committedDate": "2020-01-07T06:21:54Z", "type": "commit"}, {"oid": "25936f6fe5923604db0ce44684a870448ca67bb9", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/25936f6fe5923604db0ce44684a870448ca67bb9", "message": "update user guide to include defaulting information about java security property", "committedDate": "2020-01-07T17:51:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NTEyMQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1382#discussion_r363895121", "bodyText": "It's my understanding that urandom isn't considered to be the most secure option for all situations, so we should provide a way to setup the NM without it.   Instead of appending urandom if it's missing, how about making the default for NODEMGR_MEM_ARGS \"-Xms64m -Xmx100m -Djava.security.egd=file:/dev/./urandom\"?  Plus updating the doc above to accordingly?", "author": "tbarnes-us", "createdAt": "2020-01-07T18:48:28Z", "path": "operator/src/main/resources/scripts/startNodeManager.sh", "diffHunk": "@@ -299,6 +299,13 @@ if [ -z \"${NODEMGR_MEM_ARGS}\" ]; then\n   NODEMGR_MEM_ARGS=\"-Xms64m -Xmx100m\"\n fi\n \n+# If not already defined, set 'java.security.egd' option to /dev/urandom for\n+# Node Manager JVM for low entropy.  Speeds up boot process of Node Manager.\n+if [[ ! \"${NODEMGR_MEM_ARGS}\" =~ .*urandom* ]]\n+then\n+  NODEMGR_MEM_ARGS=\"${NODEMGR_MEM_ARGS} -Djava.security.egd=file:/dev/./urandom \"", "originalCommit": "25936f6fe5923604db0ce44684a870448ca67bb9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkyNTI2OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1382#discussion_r363925268", "bodyText": "Instead of searching for 'urandom' specifically, should we search for 'java.security.egd' security property is specified and set to 'urandom' if the security property isn't set?", "author": "lennyphan", "createdAt": "2020-01-07T20:00:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkyODY3MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1382#discussion_r363928670", "bodyText": "Why not simply remove the new if statement, and include urandom in the NODEMGR_MEM_ARGS default that's initialized at line 299?", "author": "tbarnes-us", "createdAt": "2020-01-07T20:08:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkzMTg5OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1382#discussion_r363931898", "bodyText": "I was thinking about the case where NODEMGR_MEM_ARGS is specified but doesn't define 'java.security.egd'.  Thus, we would boot Node Manager without any security random generator specified.", "author": "lennyphan", "createdAt": "2020-01-07T20:16:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkzNTMyOQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1382#discussion_r363935329", "bodyText": "I think we don't need worry about that as long as we clearly document that customizing NODEMGR_MEM_ARGS implicitly remove's the NM's (often helpful) urandom. It becomes the admin's responsibility to specifically set it when they customize NM mem args.  This is very similar to the approach that we're already taking for the WLS command line arguments - you can see we document this just a few lines above in the same documentation.", "author": "tbarnes-us", "createdAt": "2020-01-07T20:25:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkzNzc4OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1382#discussion_r363937788", "bodyText": "Sounds good.  Thanks for the valuable feedback.  Will finish the changes and document.", "author": "lennyphan", "createdAt": "2020-01-07T20:32:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDMzNjY3Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1382#discussion_r364336673", "bodyText": "The changes look good to me.", "author": "tbarnes-us", "createdAt": "2020-01-08T16:55:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5NTEyMQ=="}], "type": "inlineReview"}, {"oid": "24f6a7a60ec36dc72a4356dd8efa909098c22263", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/24f6a7a60ec36dc72a4356dd8efa909098c22263", "message": "default memory and Java security values if NODEMGR_MEM_ARGS environment variable not defined", "committedDate": "2020-01-07T22:16:49Z", "type": "commit"}]}