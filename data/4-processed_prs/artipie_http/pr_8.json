{"pr_number": 8, "pr_title": "Unit test for takes request", "pr_createdAt": "2020-02-03T15:03:03Z", "pr_url": "https://github.com/artipie/http/pull/8", "timeline": [{"oid": "0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "url": "https://github.com/artipie/http/commit/0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "message": "#6 - unit test for takes request", "committedDate": "2020-02-03T14:57:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2MzgxOA==", "url": "https://github.com/artipie/http/pull/8#discussion_r374163818", "bodyText": "@g4s8 is optional true equivalent to scope provided?", "author": "amihaiemil", "createdAt": "2020-02-03T15:22:46Z", "path": "pom.xml", "diffHunk": "@@ -12,19 +12,38 @@\n     <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n     <maven.compiler.source>11</maven.compiler.source>\n     <maven.compiler.target>11</maven.compiler.target>\n+    <junit-platform.version>5.4.2</junit-platform.version>\n   </properties>\n   <dependencies>\n     <dependency>\n       <groupId>org.takes</groupId>\n       <artifactId>takes</artifactId>\n       <version>1.19</version>\n-      <scope>provided</scope>\n+      <optional>true</optional>", "originalCommit": "0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE3MTE5MA==", "url": "https://github.com/artipie/http/pull/8#discussion_r374171190", "bodyText": "@amihaiemil no, optional means that this dependency will not be resolved transitively. It's needed for tests.", "author": "g4s8", "createdAt": "2020-02-03T15:34:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2MzgxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE3NDgwOQ==", "url": "https://github.com/artipie/http/pull/8#discussion_r374174809", "bodyText": "@g4s8 but I think scope provided is ok for tests as well, or?  Maven will only ommit the dependency at package-time.", "author": "amihaiemil", "createdAt": "2020-02-03T15:40:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2MzgxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NTc0Mg==", "url": "https://github.com/artipie/http/pull/8#discussion_r374165742", "bodyText": "@g4s8 According to this documentation: https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages\nThe term Status line applies to a Response, not a Request. For Request the term is Start line.\nCan you rename the test?", "author": "amihaiemil", "createdAt": "2020-02-03T15:25:47Z", "path": "src/test/java/com/artipie/http/tk/TkRequestTest.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.tk;\n+\n+import org.hamcrest.MatcherAssert;\n+import org.hamcrest.Matchers;\n+import org.junit.jupiter.api.Test;\n+import org.takes.rq.RqFake;\n+import org.takes.rq.RqWithHeader;\n+\n+/**\n+ * Test case for {@link TkRequest}.\n+ * @since 0.1\n+ */\n+final class TkRequestTest {\n+    @Test\n+    void readsStatusLine() throws Exception {", "originalCommit": "0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NjA3Mw==", "url": "https://github.com/artipie/http/pull/8#discussion_r374166073", "bodyText": "@g4s8 Is the line() method from Takes or from our interface? If it's on our side, I would name it startLine()", "author": "amihaiemil", "createdAt": "2020-02-03T15:26:16Z", "path": "src/test/java/com/artipie/http/tk/TkRequestTest.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.tk;\n+\n+import org.hamcrest.MatcherAssert;\n+import org.hamcrest.Matchers;\n+import org.junit.jupiter.api.Test;\n+import org.takes.rq.RqFake;\n+import org.takes.rq.RqWithHeader;\n+\n+/**\n+ * Test case for {@link TkRequest}.\n+ * @since 0.1\n+ */\n+final class TkRequestTest {\n+    @Test\n+    void readsStatusLine() throws Exception {\n+        MatcherAssert.assertThat(\n+            new TkRequest(new RqFake(\"PUT\")).line(),", "originalCommit": "0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE3OTM3Ng==", "url": "https://github.com/artipie/http/pull/8#discussion_r374179376", "bodyText": "@amihaiemil it's line() from com.artipie.http.Request. The javadoc explains that this is a request line from HTTP request. And javadoc has a link to https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html", "author": "g4s8", "createdAt": "2020-02-03T15:48:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NjA3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NjUzNA==", "url": "https://github.com/artipie/http/pull/8#discussion_r374166534", "bodyText": "@g4s8 The start line should also contain the HTTP version like HTTP/1.1 (according to the same Mozzila Docu)", "author": "amihaiemil", "createdAt": "2020-02-03T15:27:00Z", "path": "src/test/java/com/artipie/http/tk/TkRequestTest.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.tk;\n+\n+import org.hamcrest.MatcherAssert;\n+import org.hamcrest.Matchers;\n+import org.junit.jupiter.api.Test;\n+import org.takes.rq.RqFake;\n+import org.takes.rq.RqWithHeader;\n+\n+/**\n+ * Test case for {@link TkRequest}.\n+ * @since 0.1\n+ */\n+final class TkRequestTest {\n+    @Test\n+    void readsStatusLine() throws Exception {\n+        MatcherAssert.assertThat(\n+            new TkRequest(new RqFake(\"PUT\")).line(),\n+            Matchers.equalTo(\"PUT /\")", "originalCommit": "0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE5NjM2MQ==", "url": "https://github.com/artipie/http/pull/8#discussion_r374196361", "bodyText": "@amihaiemil it's bug in takes, see yegor256/takes#1024", "author": "g4s8", "createdAt": "2020-02-03T16:16:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NjUzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NzAyNQ==", "url": "https://github.com/artipie/http/pull/8#discussion_r374167025", "bodyText": "@g4s8 This matcher is confusing. You assert that it should contain host and www.example.com, but these 2 strings are not specified above, where you instantiate the Request", "author": "amihaiemil", "createdAt": "2020-02-03T15:27:49Z", "path": "src/test/java/com/artipie/http/tk/TkRequestTest.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.tk;\n+\n+import org.hamcrest.MatcherAssert;\n+import org.hamcrest.Matchers;\n+import org.junit.jupiter.api.Test;\n+import org.takes.rq.RqFake;\n+import org.takes.rq.RqWithHeader;\n+\n+/**\n+ * Test case for {@link TkRequest}.\n+ * @since 0.1\n+ */\n+final class TkRequestTest {\n+    @Test\n+    void readsStatusLine() throws Exception {\n+        MatcherAssert.assertThat(\n+            new TkRequest(new RqFake(\"PUT\")).line(),\n+            Matchers.equalTo(\"PUT /\")\n+        );\n+    }\n+\n+    @Test\n+    void readsHeasers() throws Exception {\n+        MatcherAssert.assertThat(\n+            new TkRequest(\n+                new RqWithHeader(\n+                    new RqWithHeader(new RqFake(), \"X-Test\", \"1\"), \"X-Test\", \"2\"\n+                )\n+            ).headers(),\n+            Matchers.allOf(\n+                Matchers.aMapWithSize(2),\n+                Matchers.hasEntry(\n+                    Matchers.containsStringIgnoringCase(\"host\"),\n+                    Matchers.containsInAnyOrder(\"www.example.com\")\n+                ),", "originalCommit": "0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NzQ5NQ==", "url": "https://github.com/artipie/http/pull/8#discussion_r374167495", "bodyText": "@g4s8 It would be nice to have a test which verifies the behaviour of the method when there are no headers set. Will it return null, an empty list, or will it throw an exception?", "author": "amihaiemil", "createdAt": "2020-02-03T15:28:35Z", "path": "src/test/java/com/artipie/http/tk/TkRequestTest.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.tk;\n+\n+import org.hamcrest.MatcherAssert;\n+import org.hamcrest.Matchers;\n+import org.junit.jupiter.api.Test;\n+import org.takes.rq.RqFake;\n+import org.takes.rq.RqWithHeader;\n+\n+/**\n+ * Test case for {@link TkRequest}.\n+ * @since 0.1\n+ */\n+final class TkRequestTest {\n+    @Test\n+    void readsStatusLine() throws Exception {\n+        MatcherAssert.assertThat(\n+            new TkRequest(new RqFake(\"PUT\")).line(),\n+            Matchers.equalTo(\"PUT /\")\n+        );\n+    }\n+\n+    @Test\n+    void readsHeasers() throws Exception {", "originalCommit": "0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NzcyOA==", "url": "https://github.com/artipie/http/pull/8#discussion_r374167728", "bodyText": "@g4s8 You added tests for start line and headers. How about a test for the body of the request?", "author": "amihaiemil", "createdAt": "2020-02-03T15:28:56Z", "path": "src/test/java/com/artipie/http/tk/TkRequestTest.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * MIT License\n+ *\n+ * Copyright (c) 2020 Artipie\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in all\n+ * copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n+ * SOFTWARE.\n+ */\n+\n+package com.artipie.http.tk;\n+\n+import org.hamcrest.MatcherAssert;\n+import org.hamcrest.Matchers;\n+import org.junit.jupiter.api.Test;\n+import org.takes.rq.RqFake;\n+import org.takes.rq.RqWithHeader;\n+\n+/**\n+ * Test case for {@link TkRequest}.\n+ * @since 0.1\n+ */\n+final class TkRequestTest {\n+    @Test\n+    void readsStatusLine() throws Exception {\n+        MatcherAssert.assertThat(\n+            new TkRequest(new RqFake(\"PUT\")).line(),\n+            Matchers.equalTo(\"PUT /\")\n+        );\n+    }\n+\n+    @Test\n+    void readsHeasers() throws Exception {\n+        MatcherAssert.assertThat(\n+            new TkRequest(\n+                new RqWithHeader(\n+                    new RqWithHeader(new RqFake(), \"X-Test\", \"1\"), \"X-Test\", \"2\"\n+                )\n+            ).headers(),\n+            Matchers.allOf(\n+                Matchers.aMapWithSize(2),\n+                Matchers.hasEntry(\n+                    Matchers.containsStringIgnoringCase(\"host\"),\n+                    Matchers.containsInAnyOrder(\"www.example.com\")\n+                ),\n+                Matchers.hasEntry(\n+                    Matchers.containsStringIgnoringCase(\"X-Test\"),\n+                    Matchers.containsInAnyOrder(\"1\", \"2\")\n+                )\n+            )\n+        );\n+    }\n+}", "originalCommit": "0b62c1c1d8f34ae93c957548d6b67a86f4786ab6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIwMDY5Mg==", "url": "https://github.com/artipie/http/pull/8#discussion_r374200692", "bodyText": "@amihaiemil it will be done in  #7", "author": "g4s8", "createdAt": "2020-02-03T16:23:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE2NzcyOA=="}], "type": "inlineReview"}, {"oid": "c94dbee5e50917e50279895a465a504cc93ed9ce", "url": "https://github.com/artipie/http/commit/c94dbee5e50917e50279895a465a504cc93ed9ce", "message": "#6 - (cr) review fixes", "committedDate": "2020-02-03T16:19:24Z", "type": "commit"}]}