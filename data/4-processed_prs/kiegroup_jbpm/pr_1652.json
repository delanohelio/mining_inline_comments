{"pr_number": 1652, "pr_title": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business\u2026", "pr_createdAt": "2020-05-15T15:22:06Z", "pr_url": "https://github.com/kiegroup/jbpm/pull/1652", "timeline": [{"oid": "8e9ad1645d4b05ea969dca85c595ec4303bc7caf", "url": "https://github.com/kiegroup/jbpm/commit/8e9ad1645d4b05ea969dca85c595ec4303bc7caf", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-05-18T15:04:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzczNTM2Mg==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r427735362", "bodyText": "\"<<\" - error", "author": "tsurdilo", "createdAt": "2020-05-20T04:32:16Z", "path": "jbpm-workitems/jbpm-workitems-archetype/src/main/resources/archetype-resources/pom.xml", "diffHunk": "@@ -155,7 +169,143 @@\n           </execution>\n         </executions>\n       </plugin>\n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-compiler-plugin</artifactId>\n+        <version>3.8.1</version>\n+        <configuration>\n+          <annotationProcessors>\n+            <annotationProcessor>org.jbpm.process.workitem.core.util.WidProcessor</annotationProcessor>\n+          </annotationProcessors>\n+          <compilerArgs>\n+            <arg>-AwidName=${project.artifactId}</arg>\n+            <arg>-AgenerateTemplates=true</arg>\n+            <arg>-AgenerateWids=true</arg>\n+            <arg>-AwidsResources=${project.artifactId}.wid:widtemplate.st</arg>\n+            <arg>-AtemplateResources=kie-deployment-descriptor.xml:kie-ddtemplate.st,serviceinfo.json:serviceinfo.st,repoindex.html:repoindex.part,index.html:indextemplate.st,${project.artifactId}.bpmn2:defaultprocess.st</arg>\n+          </compilerArgs>\n+        </configuration>\n+      </plugin>\n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-assembly-plugin</artifactId>\n+        <version>3.3.0</version>\n+        <configuration>\n+          <!-- root module has no assembly so ignore it -->\n+          <ignoreMissingDescriptor>true</ignoreMissingDescriptor>\n+          <descriptors>\n+            <descriptor>${project.basedir}/assembly/assembly.xml</descriptor>\n+          </descriptors>\n+          <archive>\n+            <addMavenDescriptor>false</addMavenDescriptor>\n+          </archive>\n+        </configuration>\n+        <executions>\n+          <execution>\n+            <phase>package</phase>\n+            <goals>\n+              <goal>single</goal>\n+            </goals>\n+            <configuration>\n+              <appendAssemblyId>false</appendAssemblyId>\n+            </configuration>\n+          </execution>\n+        </executions>\n+      </plugin>\n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-failsafe-plugin</artifactId>\n+        <version>3.0.0-M4</version>\n+        <executions>\n+          <execution>\n+            <id>integration-test-execution</id>\n+            <phase>verify</phase>\n+            <goals>\n+              <goal>integration-test</goal>\n+              <goal>verify</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n+        <configuration>\n+          <systemPropertyVariables>\n+            <groupId>${project.groupId}</groupId>\n+            <artifactId>${project.artifactId}</artifactId>\n+            <version>${project.version}</version>\n+            <builddir>${project.build.directory}</builddir>\n+          </systemPropertyVariables>\n+          <failIfNoTests>false</failIfNoTests>\n+          <test>${it.test}</test>\n+          <includes>\n+            <include>**/*IntegrationTest.java</include>\n+          </includes>\n+          <argLine>${failsafe.arg.line}</argLine>\n+        </configuration>\n+      </plugin>\n+      <plugin>\n+        <groupId>org.commonjava.maven.plugins</groupId>\n+        <artifactId>project-sources-maven-plugin</artifactId>\n+        <version>1.1</version>\n+        <executions>\n+          <execution>\n+            <id>project-sources</id>\n+            <goals>\n+              <goal>archive</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n+      </plugin>\n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-source-plugin</artifactId>\n+        <version>3.2.0</version>\n+        <<executions>", "originalCommit": "8e9ad1645d4b05ea969dca85c595ec4303bc7caf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3a7ca66ad4be25c74752361643ab622f1f5ab11a", "url": "https://github.com/kiegroup/jbpm/commit/3a7ca66ad4be25c74752361643ab622f1f5ab11a", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-05-20T10:21:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r430869996", "bodyText": "IMO we should rely on a BOM here for the dependency version management, so that users end up with our well-known combination of dependencies.", "author": "jstastny-cz", "createdAt": "2020-05-27T05:45:48Z", "path": "jbpm-workitems/jbpm-workitems-archetype/src/main/resources/archetype-resources/pom.xml", "diffHunk": "@@ -3,74 +3,87 @@\n     xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"\n     xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n   <modelVersion>4.0.0</modelVersion>\n-  <parent>\n-    <groupId>org.jbpm.contrib</groupId>\n-    <artifactId>workitems</artifactId>\n-    <version>${archetypeVersion}</version>\n-  </parent>\n \n-  <artifactId>${rootArtifactId}</artifactId>\n-  <name>${rootArtifactId}</name>\n+  <groupId>${groupId}</groupId>\n+  <artifactId>${artifactId}</artifactId>\n+  <name>${artifactId}</name>\n+  <version>${version}</version>\n   <description>Workitem Desciption</description>\n   <organization>\n     <name>organization</name>\n   </organization>\n-\n+  <properties>", "originalCommit": "3a7ca66ad4be25c74752361643ab622f1f5ab11a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg5NjMzNA==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r430896334", "bodyText": "Do you mean like this https://github.com/kiegroup/jbpm/pull/1652/files#diff-2783c2b62f84d175147d71379e38a18eR8?\nif the service task has the parent pom, it can't upload into BC. You can see comments of https://issues.redhat.com/browse/RHPAM-2889\nSo I create two archetype project, the first one rely on our parent pom . The last one do not have it.", "author": "bxf12315", "createdAt": "2020-05-27T06:57:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkwMjc2Mg==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r430902762", "bodyText": "if this archetype is strictly for jbpm it should use jbpm-bom [1] and kie-bom [2]", "author": "mareknovotny", "createdAt": "2020-05-27T07:12:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk4NDI2MA==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r430984260", "bodyText": "jbpm-pom have a parent pom(jboss-parent),if the archetype dependent on it, It It will cause https://issues.redhat.com/browse/RHPAM-2889. so I create a new archetype to avoid it.", "author": "bxf12315", "createdAt": "2020-05-27T09:31:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk5MDg5OA==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r430990898", "bodyText": "The problem was the distributionManagement definition in the jboss-parent, right? If you use the BOM just for importing in the dependencyManagement section the issue should not appear IMO.", "author": "jstastny-cz", "createdAt": "2020-05-27T09:42:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAxMDQxMQ==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r431010411", "bodyText": "you can define empty distributionManagement there or avoid it completely but that will require more content in pom.xml of the generated project by archetype", "author": "mareknovotny", "createdAt": "2020-05-27T10:17:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAxNzYwNA==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r431017604", "bodyText": "I don't mind having this parent-less archetype to be honest, just the version management should rely on BOMs.", "author": "jstastny-cz", "createdAt": "2020-05-27T10:30:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NzkyNg==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r431047926", "bodyText": "you can define empty distributionManagement there or avoid it completely but that will require more content in pom.xml of the generated project by archetype\n\nI think maybe use empty distributionManagement will work, I will take a try.", "author": "bxf12315", "createdAt": "2020-05-27T11:30:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA2NjkwMw==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r431066903", "bodyText": "you can define empty distributionManagement there or avoid it completely but that will require more content in pom.xml of the generated project by archetype\n\n@mareknovotny I define empty distributionManagement, but it not work.\n[1] will get all parent pom's distributionManagement.\n@jstastny-cz @mareknovotny In the PR, It has two archetype,jbpm-workitems-repository-archetype rely on kie-parent. This Archetype allows you to easily start building a new jBPM Workitem and easily be contributed to the workitem repository.\nanother is jbpm-workitems-archetype,it is not related to kie-parent. It just allows users to easily create new workItem.\nYou can see Tihomir's comment on the issue[2].\n[1] https://github.com/kiegroup/appformer/blob/dfff1ac7ed5bc865dd442c71fa6a403aecef2061/uberfire-m2repo-editor/uberfire-m2repo-editor-backend/src/main/java/org/guvnor/m2repo/backend/server/repositories/DistributionManagementArtifactRepository.java#L149\n[2] https://issues.redhat.com/browse/JBPM-8995", "author": "bxf12315", "createdAt": "2020-05-27T12:08:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDg2OTk5Ng=="}], "type": "inlineReview"}, {"oid": "c65d9ec7819c80d7783e4dbcf68a90e614e8eed9", "url": "https://github.com/kiegroup/jbpm/commit/c65d9ec7819c80d7783e4dbcf68a90e614e8eed9", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-05-29T01:58:44Z", "type": "forcePushed"}, {"oid": "8f853cc05fcc2bc71697db2dc8b4daf8526417c8", "url": "https://github.com/kiegroup/jbpm/commit/8f853cc05fcc2bc71697db2dc8b4daf8526417c8", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-05-29T07:42:32Z", "type": "forcePushed"}, {"oid": "6f5e96272c757ac8427688b5ca1be170c44ba33e", "url": "https://github.com/kiegroup/jbpm/commit/6f5e96272c757ac8427688b5ca1be170c44ba33e", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-01T14:15:32Z", "type": "forcePushed"}, {"oid": "1b8a108d89c237101546b3df5eb29b9c0fbddf92", "url": "https://github.com/kiegroup/jbpm/commit/1b8a108d89c237101546b3df5eb29b9c0fbddf92", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-01T14:53:31Z", "type": "forcePushed"}, {"oid": "49245ef0d89d314903593bf0ca986846e4dfb00d", "url": "https://github.com/kiegroup/jbpm/commit/49245ef0d89d314903593bf0ca986846e4dfb00d", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-01T15:04:43Z", "type": "forcePushed"}, {"oid": "d11c4c0db131b749286fd000a5c68b7d6f9e39a3", "url": "https://github.com/kiegroup/jbpm/commit/d11c4c0db131b749286fd000a5c68b7d6f9e39a3", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-02T00:08:08Z", "type": "forcePushed"}, {"oid": "719794e5cd98387f85ab6efb47d2f73904bf450d", "url": "https://github.com/kiegroup/jbpm/commit/719794e5cd98387f85ab6efb47d2f73904bf450d", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-02T02:09:55Z", "type": "forcePushed"}, {"oid": "5653c02cb21a2ce4ba2d03bacb3b2584f183be72", "url": "https://github.com/kiegroup/jbpm/commit/5653c02cb21a2ce4ba2d03bacb3b2584f183be72", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-02T11:37:58Z", "type": "forcePushed"}, {"oid": "74552836f97f38c1f8b0962bc8bad87bf3fa7a22", "url": "https://github.com/kiegroup/jbpm/commit/74552836f97f38c1f8b0962bc8bad87bf3fa7a22", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-02T13:46:41Z", "type": "forcePushed"}, {"oid": "544929904ad65a19499f4be274b9ac942e128b2d", "url": "https://github.com/kiegroup/jbpm/commit/544929904ad65a19499f4be274b9ac942e128b2d", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-03T15:43:44Z", "type": "forcePushed"}, {"oid": "6597ba1267a6c2d82fb52859db68098745238e67", "url": "https://github.com/kiegroup/jbpm/commit/6597ba1267a6c2d82fb52859db68098745238e67", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-05T04:18:56Z", "type": "forcePushed"}, {"oid": "0df32694542ebadd0f5cc20093e2f6f7572848b6", "url": "https://github.com/kiegroup/jbpm/commit/0df32694542ebadd0f5cc20093e2f6f7572848b6", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-05T06:10:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYyNTg4Nw==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r436625887", "bodyText": "can we use ${version.org.kie} here instead? Tobe in sync with the plugin config.", "author": "jstastny-cz", "createdAt": "2020-06-08T11:25:21Z", "path": "jbpm-workitems/jbpm-workitems-archetype/src/main/resources/archetype-resources/pom.xml", "diffHunk": "@@ -66,58 +67,25 @@\n     <dependency>\n       <groupId>org.slf4j</groupId>\n       <artifactId>slf4j-api</artifactId>\n+      <scope>provided</scope>\n     </dependency>\n \n     <dependency>\n-      <groupId>${project.groupId}</groupId>\n+      <groupId>org.jbpm.contrib</groupId>\n       <artifactId>template-resources</artifactId>\n       <scope>provided</scope>\n+      <version>${archetypeVersion}</version>", "originalCommit": "0df32694542ebadd0f5cc20093e2f6f7572848b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjcyOTUzNA==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r436729534", "bodyText": "can we use ${version.org.kie} here instead? Tobe in sync with the plugin config.\n\nI don\u2019t think it\u2019s necessary, the version needs algin to archetype's version not kie's version.", "author": "bxf12315", "createdAt": "2020-06-08T14:00:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYyNTg4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE1ODE4OA==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r437158188", "bodyText": "Look in the plugins section below, there you have <resourceBundle>org.jbpm.contrib:template-resources:${version.org.kie}</resourceBundle> so we're actually depending on the ${version.org.kie} defined in parent. So align this one way or the other.", "author": "jstastny-cz", "createdAt": "2020-06-09T06:07:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYyNTg4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE3NzQwOA==", "url": "https://github.com/kiegroup/jbpm/pull/1652#discussion_r437177408", "bodyText": "done", "author": "bxf12315", "createdAt": "2020-06-09T06:56:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYyNTg4Nw=="}], "type": "inlineReview"}, {"oid": "e313f16f49980c8771988c72181120202729eaae", "url": "https://github.com/kiegroup/jbpm/commit/e313f16f49980c8771988c72181120202729eaae", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-09T06:56:03Z", "type": "commit"}, {"oid": "e313f16f49980c8771988c72181120202729eaae", "url": "https://github.com/kiegroup/jbpm/commit/e313f16f49980c8771988c72181120202729eaae", "message": "[JBPM-9156] WorkItemHandler archetype can't be uploaded into business-central", "committedDate": "2020-06-09T06:56:03Z", "type": "forcePushed"}]}