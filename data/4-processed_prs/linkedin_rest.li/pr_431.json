{"pr_number": 431, "pr_title": "Fix task caching issue by using the output file to decide if models and spec are equivalent.", "pr_createdAt": "2020-10-01T10:31:25Z", "pr_url": "https://github.com/linkedin/rest.li/pull/431", "timeline": [{"oid": "2cf2f5bb0dded572808e469d7bcf53d38ad79401", "url": "https://github.com/linkedin/rest.li/commit/2cf2f5bb0dded572808e469d7bcf53d38ad79401", "message": "Fix task caching issue by using the output file to decide if models and\nspec are equivalent.\n\nUsing the property from the task doesn't work when the task is loaded\nfrom cache. The right solution is to read the summary file which\ncontains the compatibility check report.", "committedDate": "2020-10-01T09:34:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1MjM1NQ==", "url": "https://github.com/linkedin/rest.li/pull/431#discussion_r498152355", "bodyText": "maybe at least logging whether the task is successful?\nPersonally I prefer to log all executed, skipped uptodate status.", "author": "junchuanwang", "createdAt": "2020-10-01T10:47:53Z", "path": "gradle-plugins/src/main/java/com/linkedin/pegasus/gradle/PegasusPlugin.java", "diffHunk": "@@ -1374,58 +1373,21 @@ protected void configureRestModelGeneration(Project project, SourceSet sourceSet\n             task.setSuffix(IDL_FILE_SUFFIX);\n \n             task.onlyIf(t ->\n-            {\n-              project.getLogger().info(\n-                  \"SKIP_IDL: {}\\n\" +\n-                  \"IDL_NO_PUBLISH: {}\\n\" +\n-                  \"SNAPSHOT_NO_PUBLISH: {}\\n\" +\n-                  \"checkRestModelTask:\" +\n-                  \" Executed: {}\" +\n-                  \", Not Skipped: {}\" +\n-                  \", No Failure: {}\" +\n-                  \", Is Not Equivalent: {}\\n\" +\n-                  \"checkIdlTask:\" +\n-                  \" Executed: {}\" +\n-                  \", Not Skipped: {}\" +\n-                  \", No Failure: {}\" +\n-                  \", Is Not Equivalent: {}\\n\" +\n-                  \"checkSnapshotTask:\" +\n-                  \" Executed: {}\" +\n-                  \", Not Skipped: {}\" +\n-                  \", No Failure: {}\" +\n-                  \", Is RestSpec Not Equivalent: {}\\n\",\n-                  isPropertyTrue(project, SKIP_IDL_CHECK),\n-                  isPropertyTrue(project, IDL_NO_PUBLISH),\n-                  isPropertyTrue(project, SNAPSHOT_NO_PUBLISH),\n-                  checkRestModelTask.getState().getExecuted(),\n-                  !checkRestModelTask.getState().getSkipped(),\n-                  checkRestModelTask.getState().getFailure() == null,\n-                  !checkRestModelTask.isEquivalent(),\n-                  checkIdlTask.getState().getExecuted(),\n-                  !checkIdlTask.getState().getSkipped(),\n-                  checkIdlTask.getState().getFailure() == null,\n-                  !checkIdlTask.isEquivalent(),\n-                  checkSnapshotTask.getState().getExecuted(),\n-                  !checkSnapshotTask.getState().getSkipped(),\n-                  checkSnapshotTask.getState().getFailure() == null,\n-                  !checkSnapshotTask.isEquivalent());\n-\n-              return !isPropertyTrue(project, IDL_NO_PUBLISH) &&\n-              (\n-                (\n-                   isPropertyTrue(project, SKIP_IDL_CHECK) &&\n-                   isTaskSuccessful(checkSnapshotTask) &&\n-                   !(checkSnapshotTask.isRestSpecEquivalent())\n-                ) ||\n-                (\n-                   !isPropertyTrue(project, SKIP_IDL_CHECK) &&\n-                   (\n-                      (isTaskSuccessful(checkRestModelTask) && !(checkRestModelTask.isRestSpecEquivalent())) ||\n-                      (isTaskSuccessful(checkIdlTask) && !(checkIdlTask.isEquivalent()))\n-                   )\n-                )\n-              );\n-            });\n+                    !isPropertyTrue(project, IDL_NO_PUBLISH) &&", "originalCommit": "2cf2f5bb0dded572808e469d7bcf53d38ad79401", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1NDk0Mw==", "url": "https://github.com/linkedin/rest.li/pull/431#discussion_r498154943", "bodyText": "Gradle already logs all these details.", "author": "karthikbalasub", "createdAt": "2020-10-01T10:53:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1MjM1NQ=="}], "type": "inlineReview"}, {"oid": "feca672451d8aebe5252e04fefef14825dbda9bf", "url": "https://github.com/linkedin/rest.li/commit/feca672451d8aebe5252e04fefef14825dbda9bf", "message": "Update changelog.", "committedDate": "2020-10-01T19:00:29Z", "type": "commit"}, {"oid": "c2bd2975b27f06c2361bdc4730e2b5ca4f6b0f08", "url": "https://github.com/linkedin/rest.li/commit/c2bd2975b27f06c2361bdc4730e2b5ca4f6b0f08", "message": "Merge branch 'master' into bug/task-cache", "committedDate": "2020-10-01T19:47:54Z", "type": "commit"}]}