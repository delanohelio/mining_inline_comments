{"pr_number": 1029, "pr_title": "Utils documentation", "pr_createdAt": "2020-07-06T14:30:35Z", "pr_url": "https://github.com/AthenZ/athenz/pull/1029", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI2MzIzNg==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r450263236", "bodyText": "Links didn't work for Parameters and examples as the id wasn't recognized. Solved it by using HTML headers (h3 is equivalent to ###)", "author": "OferLevi85", "createdAt": "2020-07-06T14:32:33Z", "path": "docs/zms_client.md", "diffHunk": "@@ -220,7 +223,7 @@ following zms-cli command:\n \n     $ zms-cli -d <domain> add-group-role <role> <member> [<member> ...]\n \n-### Parameters\n+<h3 id=\"parameters-1\">Parameters</h3>", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI2MzYzNQ==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r450263635", "bodyText": "Saw we removed references to Bouncer a couple of months ago so I removed it from here too", "author": "OferLevi85", "createdAt": "2020-07-06T14:33:07Z", "path": "docs/data_model.md", "diffHunk": "@@ -58,7 +58,7 @@ decentralized authorization, and how to set up role-based authorization.\n * Policy - a set of assertions that govern usage of resources\n * Assertion - a quadruple of &lt;effect, role, action, resource&gt;\n * Principal - an authenticated user or service that assumes one or more roles\n-* User - a user identity that is authenticate by a particular authority like Bouncer\n+* User - a user identity that is authenticate by a particular authority", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDI2NTIyMw==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r450265223", "bodyText": "Noticed that all the utilities are part of the same package in bintray - athenz-utils.\nI copied the \"Getting Software\" and \"Preqreuisites\" parts from the ZMS Util guide to all relevant docs.", "author": "OferLevi85", "createdAt": "2020-07-06T14:35:15Z", "path": "docs/zms_svctoken.md", "diffHunk": "@@ -0,0 +1,60 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+\n+## Overview\n+----------\n+\n+ZMS Service Token Client utility generates service tokens\n+based on given private key and service details.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZMS Service Token Client utility binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEzOTI5MA==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456139290", "bodyText": "remove this line.", "author": "havetisyan", "createdAt": "2020-07-16T23:47:05Z", "path": "docs/zts_accesstoken.md", "diffHunk": "@@ -0,0 +1,62 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+## Overview\n+----------\n+\n+ZTS OAuth2 Access Token Client application in Go to request an access token from\n+ZTS Server for the given identity to access a role in a provider domain.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZTS OAuth2 Access Token Client binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)\n+\n+```shell\n+$ tar xvfz athenz-utils-X.Y-bin.tar.gz\n+```\n+\n+## Prerequisites\n+----------------\n+\n+Before you can use the ZMS client utility, you need to have\n+asked the Athenz administrators to create your top level domain.\n+\n+## Usage\n+--------\n+\n+An access token from ZTS service can be fetched using either Service Identity x.509 certificates\n+or service ntokens.\n+\n+The optional `expire-time` argument specifies how long the access\n+token should be valid for. The value must be specified in minutes. The\n+default if no value is specified is 120 minutes.\n+\n+The optional `roles` argument requests an access token for the given roles\n+only (comma separated) as opposed to all the roles the service identity has\n+access to in the requested domain.\n+\n+The optional `service` argument requests an id token for the given service.\n+The full `domain.service` value will be set as the audience for the id token.\n+\n+### Using Athenz Identity X.509 Certificates\n+\n+```\n+$ zts-accesstoken -domain <domain> [-roles <roles>] [-service <service>] -svc-key-file <private-key-file> -svc-cert-file <service-cert-file> -zts <ZTS url> [-expire-time <expire-time-in-mins>]\n+```\n+\n+### Using NToken from a given file\n+\n+```\n+$ zts-accesstoken -domain <domain> [-roles <roles>] [-service <service>] -ntoken-file <ntoken-file> -hdr Athenz-Principal-Auth -zts <ZTS url> [-expire-time <expire-time-in-mins>]\n+```\n+\n+Only on-prem ZTS instance supports service ntokens and the `hdr` argument must be set ", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEzOTM5NA==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456139394", "bodyText": "authenticate should be authenticated", "author": "havetisyan", "createdAt": "2020-07-16T23:47:28Z", "path": "docs/data_model.md", "diffHunk": "@@ -58,7 +58,7 @@ decentralized authorization, and how to set up role-based authorization.\n * Policy - a set of assertions that govern usage of resources\n * Assertion - a quadruple of &lt;effect, role, action, resource&gt;\n * Principal - an authenticated user or service that assumes one or more roles\n-* User - a user identity that is authenticate by a particular authority like Bouncer\n+* User - a user identity that is authenticate by a particular authority", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEzOTc2MA==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456139760", "bodyText": "ZMS Client utility -> ZMS Service Token utility", "author": "havetisyan", "createdAt": "2020-07-16T23:48:47Z", "path": "docs/zms_svctoken.md", "diffHunk": "@@ -0,0 +1,60 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+\n+## Overview\n+----------\n+\n+ZMS Service Token Client utility generates service tokens\n+based on given private key and service details.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZMS Service Token Client utility binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)\n+\n+```shell\n+$ tar xvfz athenz-utils-X.Y-bin.tar.gz\n+```\n+\n+## Prerequisites\n+----------------\n+\n+Before you can use the ZMS client utility, you need to have", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEzOTg4Mw==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456139883", "bodyText": "ZMS Client -> ZTS AccessToken", "author": "havetisyan", "createdAt": "2020-07-16T23:49:06Z", "path": "docs/zts_accesstoken.md", "diffHunk": "@@ -0,0 +1,62 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+## Overview\n+----------\n+\n+ZTS OAuth2 Access Token Client application in Go to request an access token from\n+ZTS Server for the given identity to access a role in a provider domain.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZTS OAuth2 Access Token Client binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)\n+\n+```shell\n+$ tar xvfz athenz-utils-X.Y-bin.tar.gz\n+```\n+\n+## Prerequisites\n+----------------\n+\n+Before you can use the ZMS client utility, you need to have", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEzOTk4MA==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456139980", "bodyText": "ZMS Client -> ZTS RoleCertificate", "author": "havetisyan", "createdAt": "2020-07-16T23:49:25Z", "path": "docs/zts_rolecert.md", "diffHunk": "@@ -0,0 +1,45 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+## Overview\n+----------\n+\n+ZTS Role Certificate Client utility uses Athenz Service\n+Identity certificate to request a X509 Certificate for the requested\n+role from ZTS Server. Once ZTS validates the service identity certificate,\n+it will issue a new 30-day X509 Certificate for the role. Unlike access tokens,\n+role certificates are issued for a given role only.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZTS Role Certificate Client utility binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)\n+\n+```shell\n+$ tar xvfz athenz-utils-X.Y-bin.tar.gz\n+```\n+\n+## Prerequisites\n+----------------\n+\n+Before you can use the ZMS client utility, you need to have", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0MzM4OQ==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456143389", "bodyText": "ZMS Client -> ZTS RoleToken", "author": "havetisyan", "createdAt": "2020-07-17T00:00:23Z", "path": "docs/zts_roletoken.md", "diffHunk": "@@ -0,0 +1,71 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+## Overview\n+----------\n+\n+ZTS Role Token Client utility requests a role token from\n+ZTS Server for the given identity to process a request against a provider domain.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZTS Role Token Client utility binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)\n+\n+```shell\n+$ tar xvfz athenz-utils-X.Y-bin.tar.gz\n+```\n+\n+## Prerequisites\n+----------------\n+\n+Before you can use the ZMS client utility, you need to have", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0MzU2Nw==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456143567", "bodyText": "remove line reference to on-prem ZTS", "author": "havetisyan", "createdAt": "2020-07-17T00:00:51Z", "path": "docs/zts_roletoken.md", "diffHunk": "@@ -0,0 +1,71 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+## Overview\n+----------\n+\n+ZTS Role Token Client utility requests a role token from\n+ZTS Server for the given identity to process a request against a provider domain.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZTS Role Token Client utility binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)\n+\n+```shell\n+$ tar xvfz athenz-utils-X.Y-bin.tar.gz\n+```\n+\n+## Prerequisites\n+----------------\n+\n+Before you can use the ZMS client utility, you need to have\n+asked the Athenz administrators to create your top level domain.\n+\n+## Usage\n+--------\n+\n+A role token from ZTS service can be fetched using either Service Identity x.509 certificates\n+or service ntokens.\n+\n+The optional `expire-time` argument specifies how long the role\n+token should be valid for. The value must be specified in minutes. The\n+default if no value is specified is 120 minutes.\n+\n+The optional `role` argument requests a role token for the given role\n+only as opposed to all the roles the service identity has access to\n+in the requested domain.\n+\n+The role token returned must be cached and re-used by the client before\n+it expires.\n+\n+### Using Athenz Identity X.509 Certificates\n+\n+```\n+$ zts-roletoken -domain <domain> [-role <role>] -svc-key-file <private-key-file> -svc-cert-file <service-cert-file> -zts https://zts-server.athenzcompany.com:4443/zts/v1 [-expire-time <expire-time-in-mins>]\n+```\n+\n+### Using NToken from command line\n+\n+```\n+$ zts-roletoken -domain <domain> [-role <role>] -ntoken <ntoken> -hdr Athenz-Principal-Auth -zts https://zts-server.athenzcompany.com:4443/zts/v1 [-expire-time <expire-time-in-mins>]\n+```\n+\n+Only on-prem ZTS instance supports service ntokens and the `hdr` argument must be set ", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0MzY0Mw==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456143643", "bodyText": "remove this line referencing on-prem ZTS", "author": "havetisyan", "createdAt": "2020-07-17T00:01:09Z", "path": "docs/zts_roletoken.md", "diffHunk": "@@ -0,0 +1,71 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+## Overview\n+----------\n+\n+ZTS Role Token Client utility requests a role token from\n+ZTS Server for the given identity to process a request against a provider domain.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZTS Role Token Client utility binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)\n+\n+```shell\n+$ tar xvfz athenz-utils-X.Y-bin.tar.gz\n+```\n+\n+## Prerequisites\n+----------------\n+\n+Before you can use the ZMS client utility, you need to have\n+asked the Athenz administrators to create your top level domain.\n+\n+## Usage\n+--------\n+\n+A role token from ZTS service can be fetched using either Service Identity x.509 certificates\n+or service ntokens.\n+\n+The optional `expire-time` argument specifies how long the role\n+token should be valid for. The value must be specified in minutes. The\n+default if no value is specified is 120 minutes.\n+\n+The optional `role` argument requests a role token for the given role\n+only as opposed to all the roles the service identity has access to\n+in the requested domain.\n+\n+The role token returned must be cached and re-used by the client before\n+it expires.\n+\n+### Using Athenz Identity X.509 Certificates\n+\n+```\n+$ zts-roletoken -domain <domain> [-role <role>] -svc-key-file <private-key-file> -svc-cert-file <service-cert-file> -zts https://zts-server.athenzcompany.com:4443/zts/v1 [-expire-time <expire-time-in-mins>]\n+```\n+\n+### Using NToken from command line\n+\n+```\n+$ zts-roletoken -domain <domain> [-role <role>] -ntoken <ntoken> -hdr Athenz-Principal-Auth -zts https://zts-server.athenzcompany.com:4443/zts/v1 [-expire-time <expire-time-in-mins>]\n+```\n+\n+Only on-prem ZTS instance supports service ntokens and the `hdr` argument must be set \n+to `Athenz-Principal-Auth`.\n+The service identity ntoken can be obtained by using the [zms-svctoken](zms_svctoken.md) utility.\n+\n+### Using NToken from a given file\n+\n+```\n+$ zts-roletoken -domain <domain> [-role <role>] -ntoken-file <ntoken-file> -hdr Athenz-Principal-Auth -zts https://zts-server.athenzcompany.com:4443/zts/v1 [-expire-time <expire-time-in-mins>]\n+```\n+Only on-prem ZTS instance supports service ntokens and the `hdr` argument must be set ", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0Mzc1Ng==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456143756", "bodyText": "remove the last section \"in on-prem ZTS environment only\"", "author": "havetisyan", "createdAt": "2020-07-17T00:01:35Z", "path": "docs/zts_svccert.md", "diffHunk": "@@ -0,0 +1,56 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+## Overview\n+----------\n+\n+ZTS TLS Certificate utility provides a service identity x.509 certificate\n+based on registered service's ntoken in on-prem ZTS environment only.", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0MzkyMQ==", "url": "https://github.com/AthenZ/athenz/pull/1029#discussion_r456143921", "bodyText": "ZMS client -> ZTS ServiceCertificate", "author": "havetisyan", "createdAt": "2020-07-17T00:02:09Z", "path": "docs/zts_svccert.md", "diffHunk": "@@ -0,0 +1,56 @@\n+* [Overview](#overview)\n+* [Getting Software](#getting-software)\n+* [Prerequisites](#prerequisites)\n+* [Usage](#usage)\n+\n+## Overview\n+----------\n+\n+ZTS TLS Certificate utility provides a service identity x.509 certificate\n+based on registered service's ntoken in on-prem ZTS environment only.\n+\n+## Getting Software\n+-------------------\n+\n+Download latest ZTS TLS Certificate utility binary release from Bintray - click\n+on the `Files` tab, choose the latest version directory and then\n+download the `athenz-utils-<latest-version>-bin.tar.gz` file::\n+\n+[ ![Download](https://api.bintray.com/packages/yahoo/maven/athenz-utils/images/download.svg) ](https://bintray.com/yahoo/maven/athenz-utils/_latestVersion)\n+\n+```shell\n+$ tar xvfz athenz-utils-X.Y-bin.tar.gz\n+```\n+\n+## Prerequisites\n+----------------\n+\n+Before you can use the ZMS client utility, you need to have", "originalCommit": "101dff5f96b9288c4b2b154ab6c4e14bd4ac3c63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6b925e3889c1ac3ab032f6ed66c6491b0490c84a", "url": "https://github.com/AthenZ/athenz/commit/6b925e3889c1ac3ab032f6ed66c6491b0490c84a", "message": "Utils documentation", "committedDate": "2020-07-21T11:37:26Z", "type": "commit"}, {"oid": "6b925e3889c1ac3ab032f6ed66c6491b0490c84a", "url": "https://github.com/AthenZ/athenz/commit/6b925e3889c1ac3ab032f6ed66c6491b0490c84a", "message": "Utils documentation", "committedDate": "2020-07-21T11:37:26Z", "type": "forcePushed"}]}