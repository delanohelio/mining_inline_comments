{"pr_number": 1590, "pr_title": "Document MySQL lack of rate limiting support", "pr_createdAt": "2020-03-17T16:55:45Z", "pr_url": "https://github.com/Netflix/conductor/pull/1590", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY4OTIwMg==", "url": "https://github.com/Netflix/conductor/pull/1590#discussion_r394689202", "bodyText": "@scarlac Thanks for pointing this out and updating the documentation accordingly. The implementation of the RateLimitingDAO is provided in the redis-persistence module only and is not available with other persistence layers. Could you please modify this documentation accordingly.", "author": "apanicker-nflx", "createdAt": "2020-03-18T23:06:42Z", "path": "docs/docs/configuration/taskdef.md", "diffHunk": "@@ -68,7 +68,8 @@ If you have 1000 task executions waiting in the queue, and 1000 workers polling\n * `rateLimitPerFrequency`defines the number of Tasks that can be given to Workers per given \"frequency window\".  \n **Example:**  \n Let's set `rateLimitFrequencyInSeconds = 5`, and `rateLimitPerFrequency = 12`. This means, our frequency window is of 5 seconds duration, and for each frequency window, Conductor would only give 12 tasks to workers. So, in a given minute, Conductor would only give 12*(60/5) = 144 tasks to workers irrespective of the number of workers that are polling for the task.  \n-Note that unlike `concurrentExecLimit`, rate limiting doesn't take into account tasks already in progress/completed. Even if all the previous tasks are executed within 1 sec, or would take a few days, the new tasks are still given to workers at configured frequency, 144 tasks per minute in above example.\n+Note that unlike `concurrentExecLimit`, rate limiting doesn't take into account tasks already in progress/completed. Even if all the previous tasks are executed within 1 sec, or would take a few days, the new tasks are still given to workers at configured frequency, 144 tasks per minute in above example.   \n+Note: MySQL does not currently support `rateLimitPerFrequency` and `rateLimitFrequencyInSeconds`. Please use `concurrentExecLimit` instead.", "originalCommit": "085565ec1b268c0d67722d5cc3551e7f13ae9d05", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5MDk5Mw==", "url": "https://github.com/Netflix/conductor/pull/1590#discussion_r394690993", "bodyText": "@apanicker-nflx Changed the wording. How does this sound?", "author": "scarlac", "createdAt": "2020-03-18T23:12:20Z", "path": "docs/docs/configuration/taskdef.md", "diffHunk": "@@ -68,7 +68,9 @@ If you have 1000 task executions waiting in the queue, and 1000 workers polling\n * `rateLimitPerFrequency`defines the number of Tasks that can be given to Workers per given \"frequency window\".  \n **Example:**  \n Let's set `rateLimitFrequencyInSeconds = 5`, and `rateLimitPerFrequency = 12`. This means, our frequency window is of 5 seconds duration, and for each frequency window, Conductor would only give 12 tasks to workers. So, in a given minute, Conductor would only give 12*(60/5) = 144 tasks to workers irrespective of the number of workers that are polling for the task.  \n-Note that unlike `concurrentExecLimit`, rate limiting doesn't take into account tasks already in progress/completed. Even if all the previous tasks are executed within 1 sec, or would take a few days, the new tasks are still given to workers at configured frequency, 144 tasks per minute in above example.\n+Note that unlike `concurrentExecLimit`, rate limiting doesn't take into account tasks already in progress/completed. Even if all the previous tasks are executed within 1 sec, or would take a few days, the new tasks are still given to workers at configured frequency, 144 tasks per minute in above example.   \n+The implementation of the RateLimitingDAO is provided in the redis-persistence module only and is not available with other persistence layers.\n+Note: Rate limiting is only supported for the Redis-persistence module and is not available with other persistence layers. Consider using `concurrentExecLimit` instead if you are using a different persistence module.", "originalCommit": "61975fcd10c79cc6e52a429cfe52a2f5536932d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcyOTQ4OA==", "url": "https://github.com/Netflix/conductor/pull/1590#discussion_r394729488", "bodyText": "Looks like lines 72 and 73 are identical. Was this intentional?", "author": "apanicker-nflx", "createdAt": "2020-03-19T01:01:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5MDk5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcyOTc0Mw==", "url": "https://github.com/Netflix/conductor/pull/1590#discussion_r394729743", "bodyText": "Also, the usage of concurrentExecLimit is slightly different as compared to rate limiting as explained in line 71. Not sure if we want to suggest this as a workaround.", "author": "apanicker-nflx", "createdAt": "2020-03-19T01:02:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5MDk5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgwNTQ4Mg==", "url": "https://github.com/Netflix/conductor/pull/1590#discussion_r394805482", "bodyText": "Def not intentional. Will fix tomorrow. Will remove the reference to concurrentExecLimit. Can users expect it to work for all persistence modules?", "author": "scarlac", "createdAt": "2020-03-19T05:57:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5MDk5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTE3OTQ1NA==", "url": "https://github.com/Netflix/conductor/pull/1590#discussion_r395179454", "bodyText": "The concurrentExecLimit functionality is currently implemented in all the persistence modules and should work correctly.\nFor rate limiting however, this feature may not be possible to be implemented in all the persistence layers, this was the primary motivation behind extracting this out of the ExecutionDAO and moving this into its own RateLimitingDAO. This enables users to implement the rate limiting functionality as needed, even using a custom rate limiter that may already be deployed in their environments.", "author": "apanicker-nflx", "createdAt": "2020-03-19T16:59:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5MDk5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTQ0MDk4Nw==", "url": "https://github.com/Netflix/conductor/pull/1590#discussion_r395440987", "bodyText": "@apanicker-nflx There we go. How's that?", "author": "scarlac", "createdAt": "2020-03-20T05:07:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5MDk5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTc2NzY3NQ==", "url": "https://github.com/Netflix/conductor/pull/1590#discussion_r395767675", "bodyText": "Awesome, thanks a lot.", "author": "apanicker-nflx", "createdAt": "2020-03-20T16:53:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5MDk5Mw=="}], "type": "inlineReview"}, {"oid": "6cdf444f2c8830b886f76d0308aa104e31de378c", "url": "https://github.com/Netflix/conductor/commit/6cdf444f2c8830b886f76d0308aa104e31de378c", "message": "Document MySQL lack of rate limiting support", "committedDate": "2020-03-20T05:08:37Z", "type": "commit"}, {"oid": "6cdf444f2c8830b886f76d0308aa104e31de378c", "url": "https://github.com/Netflix/conductor/commit/6cdf444f2c8830b886f76d0308aa104e31de378c", "message": "Document MySQL lack of rate limiting support", "committedDate": "2020-03-20T05:08:37Z", "type": "forcePushed"}]}