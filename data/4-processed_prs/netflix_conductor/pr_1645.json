{"pr_number": 1645, "pr_title": "Make the task definition optional for the DO_WHILE task", "pr_createdAt": "2020-04-15T21:30:57Z", "pr_url": "https://github.com/Netflix/conductor/pull/1645", "timeline": [{"oid": "eee3ce6f80e9838843a3f2dd3908e443c87ff4d0", "url": "https://github.com/Netflix/conductor/commit/eee3ce6f80e9838843a3f2dd3908e443c87ff4d0", "message": "make task definition optional for DO_WHILE task", "committedDate": "2020-04-15T21:28:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNTM2Mw==", "url": "https://github.com/Netflix/conductor/pull/1645#discussion_r409315363", "bodyText": "I think this change will break DO_WHILE task. We are forming an input array using parametersUtils and for that task definition is needed. Please test with sample DO_WHILE task which uses variables in loop condition and that variables are fed through task's input.", "author": "manan164", "createdAt": "2020-04-16T06:38:33Z", "path": "core/src/main/java/com/netflix/conductor/core/execution/tasks/DoWhile.java", "diffHunk": "@@ -127,7 +129,13 @@ boolean markLoopTaskSuccess(Task task) {\n \n \t@VisibleForTesting\n \tboolean getEvaluatedCondition(Workflow workflow, Task task, WorkflowExecutor workflowExecutor) throws ScriptException {\n-\t\tTaskDef taskDefinition = workflowExecutor.getTaskDefinition(task);\n+\t\tTaskDef taskDefinition = null;", "originalCommit": "eee3ce6f80e9838843a3f2dd3908e443c87ff4d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ2ODY1OA==", "url": "https://github.com/Netflix/conductor/pull/1645#discussion_r409468658", "bodyText": "@manan164 this seems to work fine. the ParameterUtils.getTaskInputV2() method checks for the existence of taskDefinition and works fine if there isn't one. My change does not stop you from having a TaskDef; it just makes it optional. Maybe I am missing something. I did try with a loop condition that uses a variable from task input and the task has no task def and it works as expected. I also added a test case with no task def and it passes.", "author": "rickfish", "createdAt": "2020-04-16T11:00:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMxNTM2Mw=="}], "type": "inlineReview"}, {"oid": "4d3bb92eeb66a298d9daef220ebd9e71a0c8a455", "url": "https://github.com/Netflix/conductor/commit/4d3bb92eeb66a298d9daef220ebd9e71a0c8a455", "message": "add test case for do_while task without task definition", "committedDate": "2020-04-16T10:57:41Z", "type": "commit"}]}