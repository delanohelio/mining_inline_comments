{"pr_number": 2334, "pr_title": "fix #2317 Add examples to deprecation notes of processors", "pr_createdAt": "2020-08-17T11:31:14Z", "pr_url": "https://github.com/reactor/reactor-core/pull/2334", "timeline": [{"oid": "201f09887f1f10cc07a2b1c5ad6d34463aa4a248", "url": "https://github.com/reactor/reactor-core/commit/201f09887f1f10cc07a2b1c5ad6d34463aa4a248", "message": "fix #2317 deprecate note with example for processors", "committedDate": "2020-08-17T11:26:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjE1NTY4MA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472155680", "bodyText": "I think Sinks.empty() isn't a valid replacement for DirectProcessor since it can only signal error or complete.\nAlthough I am not sure what would be the replacement :D Let me have a look and get back to you...", "author": "bsideup", "createdAt": "2020-08-18T12:47:36Z", "path": "reactor-core/src/main/java/reactor/core/publisher/DirectProcessor.java", "diffHunk": "@@ -79,7 +79,8 @@\n  * </p>\n  *\n  * @param <T> the input and output value type\n- * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+ * @deprecated To be removed in 3.5, prefer clear cut usage of {@link Sinks}:\n+ * <pre>Sinks.empty();</pre> for example.", "originalCommit": "201f09887f1f10cc07a2b1c5ad6d34463aa4a248", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjE2NzIyOQ==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472167229", "bodyText": "I wasn't sure neither, thanks for your help \ud83d\ude05", "author": "aneveu", "createdAt": "2020-08-18T12:59:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjE1NTY4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjIxMDExMQ==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472210111", "bodyText": "DirectProcessor is Sinks.many().multicast().onBackpressureError()", "author": "simonbasle", "createdAt": "2020-08-18T13:47:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjE1NTY4MA=="}], "type": "inlineReview"}, {"oid": "a6a163b4f45de245026dd59b3047eeffb0dadbe4", "url": "https://github.com/reactor/reactor-core/commit/a6a163b4f45de245026dd59b3047eeffb0dadbe4", "message": "fix DirectProcessor following code review", "committedDate": "2020-08-18T13:55:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI2ODYwOA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472268608", "bodyText": "Consider also mentioning that EmitterProcessor was/is blocking on emitNext, while with the new API one can use tryEmitNext + while with parkNanos or similar waiting strategy to achieve the same", "author": "bsideup", "createdAt": "2020-08-18T15:06:01Z", "path": "reactor-core/src/main/java/reactor/core/publisher/EmitterProcessor.java", "diffHunk": "@@ -51,7 +51,8 @@\n  * @param <T> the input and output value type\n  *\n  * @author Stephane Maldini\n- * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+ * @deprecated To be removed in 3.5. Prefer clear cut usage of {@link Sinks}:", "originalCommit": "a6a163b4f45de245026dd59b3047eeffb0dadbe4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI2OTEwOA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472269108", "bodyText": "@simonbasle I need your opinion on this one", "author": "bsideup", "createdAt": "2020-08-18T15:06:43Z", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxProcessor.java", "diffHunk": "@@ -226,7 +226,12 @@ public Context currentContext() {\n \t * </ul>\n \t *\n \t * @return a serializing {@link FluxSink}\n-\t * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+\t * @deprecated To be removed in 3.5, prefer clear cut usage of {@link Sinks}:\n+\t * <pre>\n+\t *     final Sinks.Many<String> sink = Sinks.many().replay().latest();", "originalCommit": "a6a163b4f45de245026dd59b3047eeffb0dadbe4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMzMTY3OA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472331678", "bodyText": "since there is no \"flavor\" to the sink method itself (it is driven by the concrete implementation on which it is called), I'd remove the mention of any specific full builder and just say usage of {@code Sinks} through the {@link Sinks#many()} spec (and remove the pre block)", "author": "simonbasle", "createdAt": "2020-08-18T16:38:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI2OTEwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMzMTc5OA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472331798", "bodyText": "same as above", "author": "simonbasle", "createdAt": "2020-08-18T16:38:20Z", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxProcessor.java", "diffHunk": "@@ -252,7 +257,12 @@ public Context currentContext() {\n \t * for the\n \t * available strategies\n \t * @return a serializing {@link FluxSink}\n-\t * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+\t * @deprecated To be removed in 3.5, prefer clear cut usage of {@link Sinks}:", "originalCommit": "a6a163b4f45de245026dd59b3047eeffb0dadbe4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMzMjM3NA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472332374", "bodyText": "consider just mentioning Sinks.many().unicast() rather than giving a more precise example?", "author": "simonbasle", "createdAt": "2020-08-18T16:39:13Z", "path": "reactor-core/src/main/java/reactor/core/publisher/UnicastProcessor.java", "diffHunk": "@@ -84,7 +84,8 @@\n  * </p>\n  *\n  * @param <T> the input and output type\n- * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+ * @deprecated to be removed in 3.5, prefer clear cut usage of {@link Sinks}:\n+ * <pre>Sinks.many().unicast().onBackpressureBuffer()</pre> for example.", "originalCommit": "a6a163b4f45de245026dd59b3047eeffb0dadbe4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMzMjgyOA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472332828", "bodyText": "consider just mentioning Sinks.many().replay() rather than giving a more precise example?", "author": "simonbasle", "createdAt": "2020-08-18T16:39:57Z", "path": "reactor-core/src/main/java/reactor/core/publisher/ReplayProcessor.java", "diffHunk": "@@ -48,7 +48,8 @@\n  * <p>\n  *\n  * @param <T> the value type\n- * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+ * @deprecated To be removed in 3.5, prefer clear cut usage of {@link Sinks}:\n+ * <pre>Sinks.many().replay().all()</pre> or <pre>Sinks.many().replay().latest()</pre> for example.", "originalCommit": "a6a163b4f45de245026dd59b3047eeffb0dadbe4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMzMzcyNA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472333724", "bodyText": "rather than \"for example\": variations of Sinks.many().multicast().onBackpressureBuffer() (since the only other alternative IIRC is onBackpressureError(), which is the DirectProcessor)", "author": "simonbasle", "createdAt": "2020-08-18T16:41:14Z", "path": "reactor-core/src/main/java/reactor/core/publisher/EmitterProcessor.java", "diffHunk": "@@ -51,7 +51,8 @@\n  * @param <T> the input and output value type\n  *\n  * @author Stephane Maldini\n- * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+ * @deprecated To be removed in 3.5. Prefer clear cut usage of {@link Sinks}:\n+ * <pre>Sinks.many().multicast().onBackpressureBuffer();</pre> for example.", "originalCommit": "a6a163b4f45de245026dd59b3047eeffb0dadbe4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMzNDA4Nw==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r472334087", "bodyText": "remove the for example, onBackpressureError() is the one and only way to get a DirectProcessor.", "author": "simonbasle", "createdAt": "2020-08-18T16:41:44Z", "path": "reactor-core/src/main/java/reactor/core/publisher/DirectProcessor.java", "diffHunk": "@@ -79,7 +79,8 @@\n  * </p>\n  *\n  * @param <T> the input and output value type\n- * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+ * @deprecated To be removed in 3.5, prefer clear cut usage of {@link Sinks}:\n+ * <pre>Sinks.many().multicast().onBackpressureError();</pre> for example.", "originalCommit": "a6a163b4f45de245026dd59b3047eeffb0dadbe4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a9bf71dbc3e6532905f31d88aa6f04c34079bd9f", "url": "https://github.com/reactor/reactor-core/commit/a9bf71dbc3e6532905f31d88aa6f04c34079bd9f", "message": "code review", "committedDate": "2020-08-19T13:07:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc4MDQ5OA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r473780498", "bodyText": "huh?", "author": "bsideup", "createdAt": "2020-08-20T08:52:01Z", "path": "reactor-core/src/main/java/reactor/core/publisher/DirectProcessor.java", "diffHunk": "@@ -59,7 +59,7 @@\n  * </p>\n  *\n  * </br>\n- * </br>\n+ * </br>`", "originalCommit": "a9bf71dbc3e6532905f31d88aa6f04c34079bd9f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA1NTgzMQ==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r474055831", "bodyText": "cat contribution \ud83d\ude3c", "author": "aneveu", "createdAt": "2020-08-20T15:07:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc4MDQ5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc4MzQ2NA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r473783464", "bodyText": "xWhile? :)\nWDYT about something like:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * with the {@link Sinks} API by calling {@link Sinks#many()#tryEmitNext(T)} and one of the xWhile method.\n          \n          \n            \n             * with the {@link Sinks} API by calling {@link Sinks#many()#tryEmitNext(T)} and retrying, e.g.:\n          \n          \n            \n             * <pre><code>while (sink.tryEmitNext(v).hasFailed()) LockSupport.parkNanos(10);</code></pre>", "author": "bsideup", "createdAt": "2020-08-20T08:55:15Z", "path": "reactor-core/src/main/java/reactor/core/publisher/EmitterProcessor.java", "diffHunk": "@@ -51,7 +52,11 @@\n  * @param <T> the input and output value type\n  *\n  * @author Stephane Maldini\n- * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+ * @deprecated To be removed in 3.5. Prefer clear cut usage of {@link Sinks} through\n+ * variations of <pre><code>Sinks.many().multicast().onBackpressureBuffer()</code></pre>.\n+ *\n+ * This processor is blocking on {@link EmitterProcessor#emitNext(T)}. This behaviour can be implemented\n+ * with the {@link Sinks} API by calling {@link Sinks#many()#tryEmitNext(T)} and one of the xWhile method.", "originalCommit": "a9bf71dbc3e6532905f31d88aa6f04c34079bd9f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA1MjkzMw==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r474052933", "bodyText": "yeeah I wasn't sure about how to express it, thanks for your suggestion!", "author": "aneveu", "createdAt": "2020-08-20T15:03:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc4MzQ2NA=="}], "type": "inlineReview"}, {"oid": "5b8dd7b69a28f11d7e2dfadda7eca00ca86c3c00", "url": "https://github.com/reactor/reactor-core/commit/5b8dd7b69a28f11d7e2dfadda7eca00ca86c3c00", "message": "fix DirectProcessor documentation following latest code review", "committedDate": "2020-08-20T15:08:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA3MTE0Nw==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r481071147", "bodyText": "nitpick: generally in javadocs oneliners like that are added through a {@code xxx} tag rather than html <pre><code>.", "author": "simonbasle", "createdAt": "2020-09-01T11:35:28Z", "path": "reactor-core/src/main/java/reactor/core/publisher/DirectProcessor.java", "diffHunk": "@@ -80,7 +80,7 @@\n  *\n  * @param <T> the input and output value type\n  * @deprecated To be removed in 3.5, prefer clear cut usage of {@link Sinks}:\n- * <pre>Sinks.many().multicast().onBackpressureError();</pre> for example.\n+ * <pre><code>Sinks.many().multicast().onBackpressureError();</code></pre>.", "originalCommit": "5b8dd7b69a28f11d7e2dfadda7eca00ca86c3c00", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg4NTQ1NA==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r482885454", "bodyText": "actually, now that I've looked into the actual rendering the blocks make it add a newline, which is kinda good. I'll just edit the PR to remove the dot at the end (which also causes a newline, less desirable)", "author": "simonbasle", "createdAt": "2020-09-03T10:48:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA3MTE0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA3Mjc3Nw==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r481072777", "bodyText": "this one I'd keep as a <pre><code> indeed, but maybe add newlines and indentation for readability?", "author": "simonbasle", "createdAt": "2020-09-01T11:38:44Z", "path": "reactor-core/src/main/java/reactor/core/publisher/EmitterProcessor.java", "diffHunk": "@@ -51,7 +52,14 @@\n  * @param <T> the input and output value type\n  *\n  * @author Stephane Maldini\n- * @deprecated Prefer clear cut usage of {@link Sinks}, to be removed in 3.5\n+ * @deprecated To be removed in 3.5. Prefer clear cut usage of {@link Sinks} through\n+ * variations of <pre><code>Sinks.many().multicast().onBackpressureBuffer()</code></pre>.\n+ *\n+ * This processor is blocking on {@link EmitterProcessor#emitNext(T)}. This behaviour can be implemented\n+ * with the {@link Sinks} API by calling {@link Sinks#many()#tryEmitNext(T)} and retrying, e.g.:\n+ *  <pre><code>", "originalCommit": "5b8dd7b69a28f11d7e2dfadda7eca00ca86c3c00", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg4OTc5Nw==", "url": "https://github.com/reactor/reactor-core/pull/2334#discussion_r482889797", "bodyText": "working on it. using <pre>{@code ...}</pre> seems to be the best solution here (see https://reflectoring.io/howto-format-code-snippets-in-javadoc/)", "author": "simonbasle", "createdAt": "2020-09-03T10:56:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTA3Mjc3Nw=="}], "type": "inlineReview"}, {"oid": "b3bce7bfb949c73ac3443c03929ceabd513ad156", "url": "https://github.com/reactor/reactor-core/commit/b3bce7bfb949c73ac3443c03929ceabd513ad156", "message": "Polish code snippets and add links as well", "committedDate": "2020-09-03T12:01:36Z", "type": "commit"}]}