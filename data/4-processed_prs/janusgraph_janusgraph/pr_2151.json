{"pr_number": 2151, "pr_title": "fix serializer issues", "pr_createdAt": "2020-06-28T03:36:39Z", "pr_url": "https://github.com/JanusGraph/janusgraph/pull/2151", "timeline": [{"oid": "47f74f2be9f570e4681040d569b29a30614063de", "url": "https://github.com/JanusGraph/janusgraph/commit/47f74f2be9f570e4681040d569b29a30614063de", "message": "fix serializer issues\nwhen user set accept application/vnd.gremlin-v2.0+json it throws org.apache.tinkerpop.gremlin.driver.ser.GraphSONMessageSerializerGremlinV2d0 cannot be cast to org.apache.tinkerpop.gremlin.driver.ser.MessageTextSerializer\norg.apache.tinkerpop.gremlin.driver.ser.GraphSONMessageSerializerGremlinV2d0 didn't implements org.apache.tinkerpop.gremlin.driver.ser.MessageTextSerializer\n\nSigned-off-by: Hon <George-Hon@outlook.com>", "committedDate": "2020-06-28T00:59:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI1NTc0Ng==", "url": "https://github.com/JanusGraph/janusgraph/pull/2151#discussion_r447255746", "bodyText": "Wouldn't be the correct way to add both like GraphSONMessageSerializerGremlinV1d0 and GraphSONMessageSerializerV1d0?", "author": "farodin91", "createdAt": "2020-06-29T21:09:53Z", "path": "janusgraph-dist/src/assembly/static/conf/gremlin-server/gremlin-server-berkeleyje-es.yaml", "diffHunk": "@@ -33,7 +33,7 @@ serializers:\n     - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV1d0, config: { ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }}\n     - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoLiteMessageSerializerV1d0, config: {ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }}\n     - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV1d0, config: { serializeResultToString: true }}\n-    - { className: org.apache.tinkerpop.gremlin.driver.ser.GraphSONMessageSerializerGremlinV2d0, config: { ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }}", "originalCommit": "47f74f2be9f570e4681040d569b29a30614063de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzMzODc2Mg==", "url": "https://github.com/JanusGraph/janusgraph/pull/2151#discussion_r447338762", "bodyText": "I'm not sure, because in GraphSONMessageSerializerGremlinV1d0  GraphSONMapper's typeInfo is TypeInfo.PARTIAL_TYPES,but in GraphSONMessageSerializerV1d0 the typeInfo is TypeInfo.NO_TYPES, i don\u2019t know what\u2019s the difference,may need to be fully tested,so i didn't modify it.", "author": "GeorgeHon", "createdAt": "2020-06-30T00:37:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI1NTc0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ0NTM5Mw==", "url": "https://github.com/JanusGraph/janusgraph/pull/2151#discussion_r447445393", "bodyText": "You could check that you don't get the exception, if you just add the new line and no other changes.", "author": "farodin91", "createdAt": "2020-06-30T06:42:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI1NTc0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzU3NzkyMQ==", "url": "https://github.com/JanusGraph/janusgraph/pull/2151#discussion_r447577921", "bodyText": "I have checked the problem, i also try test  change GraphSONMessageSerializerGremlinV1d0 to GraphSONMessageSerializerV1d0, but it didn't workers with v2\u3001v3 because GraphSONMessageSerializerGremlinV1d0 couldn't accept  application/vnd.gremlin-v3.0+json ,it only accept application/json", "author": "GeorgeHon", "createdAt": "2020-06-30T10:24:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI1NTc0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkyMDc5Mw==", "url": "https://github.com/JanusGraph/janusgraph/pull/2151#discussion_r447920793", "bodyText": "Sorry, my idea was to add both following instead of replacement.\n - { className: org.apache.tinkerpop.gremlin.driver.ser.GraphSONMessageSerializerGremlinV2d0, config: { ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }}\n - { className: org.apache.tinkerpop.gremlin.driver.ser.GraphSONMessageSerializerV2d0, config: { ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }}", "author": "farodin91", "createdAt": "2020-06-30T19:14:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI1NTc0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU4NDQ5NA==", "url": "https://github.com/JanusGraph/janusgraph/pull/2151#discussion_r451584494", "bodyText": "could you tell me the reason\uff1f", "author": "GeorgeHon", "createdAt": "2020-07-08T14:22:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI1NTc0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDEyMDY0Nw==", "url": "https://github.com/JanusGraph/janusgraph/pull/2151#discussion_r454120647", "bodyText": "It seems so that you cannot configure both.", "author": "farodin91", "createdAt": "2020-07-14T06:00:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI1NTc0Ng=="}], "type": "inlineReview"}]}