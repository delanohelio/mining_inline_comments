{"pr_number": 6542, "pr_title": "Added JSON and Readme for workflows", "pr_createdAt": "2020-04-06T20:00:37Z", "pr_url": "https://github.com/broadinstitute/gatk/pull/6542", "timeline": [{"oid": "e44e7125823ed92b521f936c1d994a9bdfcd34d8", "url": "https://github.com/broadinstitute/gatk/commit/e44e7125823ed92b521f936c1d994a9bdfcd34d8", "message": "added json with resources for pathseq and m2", "committedDate": "2020-04-06T19:43:04Z", "type": "commit"}, {"oid": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "url": "https://github.com/broadinstitute/gatk/commit/87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "message": "add readme for cnn wdl", "committedDate": "2020-04-06T19:48:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzMjIzNw==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405532237", "bodyText": "takes -> take\nGATKs -> GATK's\nMaybe instead of \"This repo\", \"This directory\"?  Or \"Here are workflows that...\"\ncomma after \"which\"", "author": "ldgauthier", "createdAt": "2020-04-08T13:39:28Z", "path": "scripts/cnn_variant_wdl/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# gatk4-cnn-variant-filter\n+\n+### Purpose :\n+This repo provides workflows that takes advantage of GATKs CNN tool which is a deep learning ", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzMzQ5OQ==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405533499", "bodyText": "This link still works, but is it going to move to the new website?", "author": "ldgauthier", "createdAt": "2020-04-08T13:41:13Z", "path": "scripts/cnn_variant_wdl/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# gatk4-cnn-variant-filter\n+\n+### Purpose :\n+This repo provides workflows that takes advantage of GATKs CNN tool which is a deep learning \n+approach to filter variants based on Convolutional Neural Networks. \n+\n+Please read the following discussion to learn more about the CNN tool: [Deep Learning in GATK4](https://gatkforums.broadinstitute.org/gatk/discussion/10996/deep-learning-in-gatk4).", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcwNjQwOA==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405706408", "bodyText": "I talked to Bhanu and the education team and they suggested to use a git repo where they uploaded all the old blog/discussion posts. Since this is a blog post and not a article, they plan on moving it to the new site later.\nhttps://github.com/broadinstitute/gatk-docs/blob/3333b5aacfd3c48a87b60047395e1febc98c21f9/blog-2012-to-2019/2017-12-21-Deep_learning_in_GATK4.md", "author": "bshifaw", "createdAt": "2020-04-08T17:51:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzMzQ5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzNDM0OQ==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405534349", "bodyText": "CNNVariant -> CNNScoreVariants\nWe have a default model based on Illumina exomes and genomes if none is specified", "author": "ldgauthier", "createdAt": "2020-04-08T13:42:27Z", "path": "scripts/cnn_variant_wdl/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# gatk4-cnn-variant-filter\n+\n+### Purpose :\n+This repo provides workflows that takes advantage of GATKs CNN tool which is a deep learning \n+approach to filter variants based on Convolutional Neural Networks. \n+\n+Please read the following discussion to learn more about the CNN tool: [Deep Learning in GATK4](https://gatkforums.broadinstitute.org/gatk/discussion/10996/deep-learning-in-gatk4).\n+\n+### cram2filtered.wdl\n+This workflow takes an input CRAM/BAM to call variants with HaplotypeCaller\n+then filters the calls with the CNNVariant neural net tool using the filtering model specified.", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzNTQwNQ==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405535405", "bodyText": "Correct keys are CNN_1D and CNN_2D", "author": "ldgauthier", "createdAt": "2020-04-08T13:43:55Z", "path": "scripts/cnn_variant_wdl/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# gatk4-cnn-variant-filter\n+\n+### Purpose :\n+This repo provides workflows that takes advantage of GATKs CNN tool which is a deep learning \n+approach to filter variants based on Convolutional Neural Networks. \n+\n+Please read the following discussion to learn more about the CNN tool: [Deep Learning in GATK4](https://gatkforums.broadinstitute.org/gatk/discussion/10996/deep-learning-in-gatk4).\n+\n+### cram2filtered.wdl\n+This workflow takes an input CRAM/BAM to call variants with HaplotypeCaller\n+then filters the calls with the CNNVariant neural net tool using the filtering model specified.\n+\n+The site-level scores are added to the `INFO` field of the VCF. The architecture arguments,\n+`info_key` and `tensor_type` arguments MUST be in agreement (e.g. 2D models must have\n+`tensor_type` of `read_tensor` and `info_key` of `CNN_2D`, 1D models have `tensor_type` of\n+`reference` and `info_key` of `CNN_1D`). The `INFO` field key will be `1D_CNN` or `2D_CNN`", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzNTY0Ng==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405535646", "bodyText": "\"like TO test\"", "author": "ldgauthier", "createdAt": "2020-04-08T13:44:12Z", "path": "scripts/cnn_variant_wdl/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# gatk4-cnn-variant-filter\n+\n+### Purpose :\n+This repo provides workflows that takes advantage of GATKs CNN tool which is a deep learning \n+approach to filter variants based on Convolutional Neural Networks. \n+\n+Please read the following discussion to learn more about the CNN tool: [Deep Learning in GATK4](https://gatkforums.broadinstitute.org/gatk/discussion/10996/deep-learning-in-gatk4).\n+\n+### cram2filtered.wdl\n+This workflow takes an input CRAM/BAM to call variants with HaplotypeCaller\n+then filters the calls with the CNNVariant neural net tool using the filtering model specified.\n+\n+The site-level scores are added to the `INFO` field of the VCF. The architecture arguments,\n+`info_key` and `tensor_type` arguments MUST be in agreement (e.g. 2D models must have\n+`tensor_type` of `read_tensor` and `info_key` of `CNN_2D`, 1D models have `tensor_type` of\n+`reference` and `info_key` of `CNN_1D`). The `INFO` field key will be `1D_CNN` or `2D_CNN`\n+depending on the neural net architecture used for inference. The architecture arguments\n+specify pre-trained networks. New networks can be trained by the GATK tools: CNNVariantWriteTensors \n+and CNNVariantTrain. The CRAM could be generated by the [single-sample pipeline](https://github.com/gatk-workflows/gatk4-data-processing/blob/master/processing-for-variant-discovery-gatk4.wdl).\n+If you would like test the workflow on a more representative example file, use the following ", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzNjM4OQ==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405536389", "bodyText": "Is it worth citing specific use cases, like for custom panels , non-human, or non-Illumina sequencing?", "author": "ldgauthier", "createdAt": "2020-04-08T13:45:16Z", "path": "scripts/cnn_variant_wdl/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# gatk4-cnn-variant-filter\n+\n+### Purpose :\n+This repo provides workflows that takes advantage of GATKs CNN tool which is a deep learning \n+approach to filter variants based on Convolutional Neural Networks. \n+\n+Please read the following discussion to learn more about the CNN tool: [Deep Learning in GATK4](https://gatkforums.broadinstitute.org/gatk/discussion/10996/deep-learning-in-gatk4).\n+\n+### cram2filtered.wdl\n+This workflow takes an input CRAM/BAM to call variants with HaplotypeCaller\n+then filters the calls with the CNNVariant neural net tool using the filtering model specified.\n+\n+The site-level scores are added to the `INFO` field of the VCF. The architecture arguments,\n+`info_key` and `tensor_type` arguments MUST be in agreement (e.g. 2D models must have\n+`tensor_type` of `read_tensor` and `info_key` of `CNN_2D`, 1D models have `tensor_type` of\n+`reference` and `info_key` of `CNN_1D`). The `INFO` field key will be `1D_CNN` or `2D_CNN`\n+depending on the neural net architecture used for inference. The architecture arguments\n+specify pre-trained networks. New networks can be trained by the GATK tools: CNNVariantWriteTensors \n+and CNNVariantTrain. The CRAM could be generated by the [single-sample pipeline](https://github.com/gatk-workflows/gatk4-data-processing/blob/master/processing-for-variant-discovery-gatk4.wdl).\n+If you would like test the workflow on a more representative example file, use the following \n+CRAM file as input and change the scatter count from 4 to 200: gs://gatk-best-practices/cnn-h38/NA12878_NA12878_IntraRun_1_SM-G947Y_v1.cram.\n+\n+#### Requirements/expectations :\n+ - CRAM/BAM\n+ - BAM Index (if input is BAM) \n+\n+#### Output :\n+ - Filtered VCF and its index. \n+\n+### cram2model.wdl\n+This **optional** workflow is for advanced users who would like to train a CNN model for filtering variants. ", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzNjkwNw==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405536907", "bodyText": "GATK forum link needs updating", "author": "ldgauthier", "createdAt": "2020-04-08T13:45:58Z", "path": "scripts/cnn_variant_wdl/README.md", "diffHunk": "@@ -0,0 +1,68 @@\n+# gatk4-cnn-variant-filter\n+\n+### Purpose :\n+This repo provides workflows that takes advantage of GATKs CNN tool which is a deep learning \n+approach to filter variants based on Convolutional Neural Networks. \n+\n+Please read the following discussion to learn more about the CNN tool: [Deep Learning in GATK4](https://gatkforums.broadinstitute.org/gatk/discussion/10996/deep-learning-in-gatk4).\n+\n+### cram2filtered.wdl\n+This workflow takes an input CRAM/BAM to call variants with HaplotypeCaller\n+then filters the calls with the CNNVariant neural net tool using the filtering model specified.\n+\n+The site-level scores are added to the `INFO` field of the VCF. The architecture arguments,\n+`info_key` and `tensor_type` arguments MUST be in agreement (e.g. 2D models must have\n+`tensor_type` of `read_tensor` and `info_key` of `CNN_2D`, 1D models have `tensor_type` of\n+`reference` and `info_key` of `CNN_1D`). The `INFO` field key will be `1D_CNN` or `2D_CNN`\n+depending on the neural net architecture used for inference. The architecture arguments\n+specify pre-trained networks. New networks can be trained by the GATK tools: CNNVariantWriteTensors \n+and CNNVariantTrain. The CRAM could be generated by the [single-sample pipeline](https://github.com/gatk-workflows/gatk4-data-processing/blob/master/processing-for-variant-discovery-gatk4.wdl).\n+If you would like test the workflow on a more representative example file, use the following \n+CRAM file as input and change the scatter count from 4 to 200: gs://gatk-best-practices/cnn-h38/NA12878_NA12878_IntraRun_1_SM-G947Y_v1.cram.\n+\n+#### Requirements/expectations :\n+ - CRAM/BAM\n+ - BAM Index (if input is BAM) \n+\n+#### Output :\n+ - Filtered VCF and its index. \n+\n+### cram2model.wdl\n+This **optional** workflow is for advanced users who would like to train a CNN model for filtering variants. \n+\n+#### Requirements/expectations :\n+ - CRAM\n+ - Truth VCF and its index\n+ - Truth Confidence Interval Bed\n+\n+#### Output :\n+ - Model HD5\n+ - Model JSON\n+ - Model Plots PNG\n+\n+### run_happy.wdl\n+This **optional** evaluation and plotting workflow runs a filtering model against truth data (e.g. [NIST Genomes in a Bottle](https://github.com/genome-in-a-bottle/giab_latest_release), [Synthic Diploid Truth Set](https://github.com/lh3/CHM-eval/releases) ) and plots the accuracy.\n+\n+#### Requirements/expectations :\n+ - File of VCF Files\n+ - Truth VCF and its index\n+ - Truth Confidence Interval Bed\n+\n+#### Output :\n+ - Evaluation summary\n+ - Plots\n+\n+### Important Notes :\n+- Runtime parameters are optimized for Broad's Google Cloud Platform implementation.\n+- For help running workflows on the Google Cloud Platform or locally please\n+view the following tutorial [(How to) Execute Workflows from the gatk-workflows Git Organization](https://gatk.broadinstitute.org/hc/en-us/articles/360035530952).\n+- Please visit the [User Guide](https://gatk.broadinstitute.org/hc/en-us/categories/360002310591) site for further documentation on our workflows and tools.\n+\n+### Contact Us :\n+- The following material is provided by the Data Science Platforum group at the Broad Institute. Please direct any questions or concerns to one of our forum sites : [GATK](https://gatk.broadinstitute.org/hc/en-us/community/topics) or [Terra](https://support.terra.bio/hc/en-us/community/topics/360000500432).", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU4OTQyNg==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405589426", "bodyText": "This should be the correct link, are you having trouble using it?", "author": "bshifaw", "createdAt": "2020-04-08T14:57:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzNjkwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ0NzQ5MA==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r406447490", "bodyText": "That does seem to work, but aren't the other links at software.broadinstitute.org/gatk or something like that?", "author": "ldgauthier", "createdAt": "2020-04-09T20:06:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzNjkwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4NDA0NQ==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r407484045", "bodyText": "I believe that is the old link. Even now when i use the \"software.broadinstitute.org/gatk\" i get redirected to \"https://gatk.broadinstitute.org/hc/en-us\"", "author": "bshifaw", "createdAt": "2020-04-13T13:42:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzNjkwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzOTIxOA==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405539218", "bodyText": "@bshifaw  -- @mwalker174 has some changes in PR for PathSeq, so maybe hold off on this PR until those go in so we can make sure everything is up to date.", "author": "ldgauthier", "createdAt": "2020-04-08T13:49:09Z", "path": "scripts/pathseq/wdl/pathseq_pipeline_template.json", "diffHunk": "@@ -1,19 +1,41 @@\n {\n-  \"PathSeqPipelineWorkflow.sample_name\": \"sample\",\n-  \"PathSeqPipelineWorkflow.input_bam\": \"gs://my-bucket/sample.bam\",\n+  \"##_COMMENT1\": \"Inputs\",\n+  \"PathSeqPipelineWorkflow.sample_name\": \"NA12878_24RG_med.hg380.7chicken0.3\",\n+  \"PathSeqPipelineWorkflow.input_bam\": \"gs://gatk-best-practices/pathseq/contaminated-bam/NA12878_24RG_med.hg380.7chicken0.3.bam\",\n \n-  \"PathSeqPipelineWorkflow.is_host_aligned\": false,\n-  \"PathSeqPipelineWorkflow.min_clipped_read_length\": 60,\n-  \"PathSeqPipelineWorkflow.filter_duplicates\": true,\n+  \"##_COMMENT1\": \"Reference and Resources\",\n+  \"PathSeqPipelineWorkflow.kmer_file\": \"gs://gatk-best-practices/pathseq/resources/pathseq_host.bfi\",\n+  \"PathSeqPipelineWorkflow.microbe_bwa_image\": \"gs://gatk-best-practices/pathseq/resources/meats.fa.img\",\n+  \"PathSeqPipelineWorkflow.microbe_fasta\": \"gs://gatk-best-practices/pathseq/resources/meats.fa\",\n+  \"PathSeqPipelineWorkflow.microbe_fasta_dict\": \"gs://gatk-best-practices/pathseq/resources/meats.dict\",\n+  \"PathSeqPipelineWorkflow.filter_bwa_image\": \"gs://gatk-best-practices/pathseq/resources/pathseq_host.fa.img\",\n+  \"PathSeqPipelineWorkflow.taxonomy_file\": \"gs://gatk-best-practices/pathseq/resources/meats.min2k.db\",\n+  \"PathSeqPipelineWorkflow.is_host_aligned\": \"false\",\n+\n+  \"##_COMMENT1\": \"Docker\",\n+  \"PathSeqPipelineWorkflow.gatk_docker_override\": \"broadinstitute/gatk:4.0.11.0\",", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU0MDAwOQ==", "url": "https://github.com/broadinstitute/gatk/pull/6542#discussion_r405540009", "bodyText": "I'm not the best person to review M2 inputs -- maybe @fleharty or @takutosato ?  (I don't want to bother David.)", "author": "ldgauthier", "createdAt": "2020-04-08T13:50:14Z", "path": "scripts/m2_cromwell_tests/mutect2.inputs.json", "diffHunk": "@@ -0,0 +1,28 @@\n+{\n+  \"Mutect2.gatk_docker\": \"broadinstitute/gatk:4.1.4.1\",\n+\n+  \"Mutect2.intervals\": \"gs://gatk-best-practices/somatic-b37/whole_exome_agilent_1.1_refseq_plus_3_boosters.Homo_sapiens_assembly19.baits.interval_list\",\n+  \"Mutect2.scatter_count\": 50,\n+  \"Mutect2.m2_extra_args\": \"--downsampling-stride 20 --max-reads-per-alignment-start 6 --max-suspicious-reads-per-alignment-start 6\",\n+  \"Mutect2.filter_funcotations\": \"True\",\n+  \"Mutect2.funco_reference_version\": \"hg19\",\n+  \"Mutect2.funco_data_sources_tar_gz\": \"gs://broad-public-datasets/funcotator/funcotator_dataSources.v1.6.20190124s.tar.gz\",\n+  \"Mutect2.funco_transcript_selection_list\": \"gs://broad-public-datasets/funcotator/transcriptList.exact_uniprot_matches.AKT1_CRLF2_FGFR1.txt\",\n+\n+  \"Mutect2.ref_fasta\": \"gs://gatk-best-practices/somatic-b37/Homo_sapiens_assembly19.fasta\",\n+  \"Mutect2.ref_dict\": \"gs://gatk-best-practices/somatic-b37/Homo_sapiens_assembly19.dict\",\n+  \"Mutect2.ref_fai\": \"gs://gatk-best-practices/somatic-b37/Homo_sapiens_assembly19.fasta.fai\",\n+  \"Mutect2.normal_reads\": \"gs://gatk-best-practices/somatic-b37/HCC1143_normal.bam\",\n+  \"Mutect2.normal_reads_index\": \"gs://gatk-best-practices/somatic-b37/HCC1143_normal.bai\",\n+  \"Mutect2.tumor_reads\": \"gs://gatk-best-practices/somatic-b37/HCC1143.bam\",\n+  \"Mutect2.tumor_reads_index\": \"gs://gatk-best-practices/somatic-b37/HCC1143.bai\",\n+\n+  \"Mutect2.pon\": \"gs://gatk-best-practices/somatic-b37/Mutect2-exome-panel.vcf\",\n+  \"Mutect2.pon_idx\": \"gs://gatk-best-practices/somatic-b37/Mutect2-exome-panel.vcf.idx\",\n+  \"Mutect2.gnomad\": \"gs://gatk-best-practices/somatic-b37/af-only-gnomad.raw.sites.vcf\",\n+  \"Mutect2.gnomad_idx\": \"gs://gatk-best-practices/somatic-b37/af-only-gnomad.raw.sites.vcf.idx\",\n+  \"Mutect2.variants_for_contamination\": \"gs://gatk-best-practices/somatic-b37/small_exac_common_3.vcf\",\n+  \"Mutect2.variants_for_contamination_idx\": \"gs://gatk-best-practices/somatic-b37/small_exac_common_3.vcf.idx\",\n+  \"Mutect2.realignment_index_bundle\": \"gs://gatk-test-data/mutect2/Homo_sapiens_assembly38.index_bundle\"\n+\n+}", "originalCommit": "87af67259301ac559f40d7ef8cba07fd9dc1b2e8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "78d6a5df4a729a3ebffeb55218a22f1f1dab5131", "url": "https://github.com/broadinstitute/gatk/commit/78d6a5df4a729a3ebffeb55218a22f1f1dab5131", "message": "reverted changes to pathseq json", "committedDate": "2020-04-08T14:21:03Z", "type": "commit"}, {"oid": "846729f44d05b050303f3c659cdd4b0410947134", "url": "https://github.com/broadinstitute/gatk/commit/846729f44d05b050303f3c659cdd4b0410947134", "message": "minor ReadMe corrections", "committedDate": "2020-04-08T14:55:07Z", "type": "commit"}, {"oid": "9bce592d1870f248e3c4f279d09cfa54d205f3ab", "url": "https://github.com/broadinstitute/gatk/commit/9bce592d1870f248e3c4f279d09cfa54d205f3ab", "message": "updated blog link in Readme", "committedDate": "2020-04-08T17:54:54Z", "type": "commit"}]}