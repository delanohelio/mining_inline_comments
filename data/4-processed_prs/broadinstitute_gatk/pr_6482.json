{"pr_number": 6482, "pr_title": "Exposed maximum copy ratio and point size for CNV plotting tools.", "pr_createdAt": "2020-03-03T19:36:54Z", "pr_url": "https://github.com/broadinstitute/gatk/pull/6482", "timeline": [{"oid": "fd648115b2670c3834e43d2a4d762adb280e8de8", "url": "https://github.com/broadinstitute/gatk/commit/fd648115b2670c3834e43d2a4d762adb280e8de8", "message": "Exposed maximum copy ratio and point size for CNV plotting tools.", "committedDate": "2020-03-03T19:38:58Z", "type": "forcePushed"}, {"oid": "387e0a7292f78489b7d8e25de13563a858202cf9", "url": "https://github.com/broadinstitute/gatk/commit/387e0a7292f78489b7d8e25de13563a858202cf9", "message": "Exposed maximum copy ratio and point size for CNV plotting tools.", "committedDate": "2020-03-03T20:00:51Z", "type": "forcePushed"}, {"oid": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "url": "https://github.com/broadinstitute/gatk/commit/8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "message": "Exposed maximum copy ratio and point size for CNV plotting tools.", "committedDate": "2020-03-31T17:24:15Z", "type": "commit"}, {"oid": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "url": "https://github.com/broadinstitute/gatk/commit/8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "message": "Exposed maximum copy ratio and point size for CNV plotting tools.", "committedDate": "2020-03-31T17:24:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg0MTMwOQ==", "url": "https://github.com/broadinstitute/gatk/pull/6482#discussion_r413841309", "bodyText": "Why does this StandardArgumentDefinitions us \"--\" but the next one for OUTPUT_SHORT_NAME uses only \"-\".", "author": "fleharty", "createdAt": "2020-04-23T14:25:13Z", "path": "src/test/java/org/broadinstitute/hellbender/tools/copynumber/plotting/PlotDenoisedCopyRatiosIntegrationTest.java", "diffHunk": "@@ -62,13 +49,44 @@ public void testPlotting() {\n         Assert.assertEquals(scaledDeltaMAD, (standardizedMAD - denoisedMAD) / standardizedMAD);\n     }\n \n+    //checks that output files with reasonable file sizes are generated, but correctness of output is not checked\n+    @Test(groups = \"R\")\n+    public void testPlotting() {\n+        final File outputDir = createTempDir(\"testDir\");\n+        final String[] arguments = {\n+                \"--\" + CopyNumberStandardArgument.STANDARDIZED_COPY_RATIOS_FILE_LONG_NAME, STANDARDIZED_COPY_RATIOS_FILE.getAbsolutePath(),\n+                \"--\" + CopyNumberStandardArgument.DENOISED_COPY_RATIOS_FILE_LONG_NAME, DENOISED_COPY_RATIOS_FILE.getAbsolutePath(),\n+                \"--\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_FILE.getAbsolutePath(),\n+                \"-\" + StandardArgumentDefinitions.OUTPUT_SHORT_NAME, outputDir.getAbsolutePath(),\n+                \"--\" + CopyNumberStandardArgument.OUTPUT_PREFIX_LONG_NAME, OUTPUT_PREFIX\n+        };\n+        runCommandLine(arguments);\n+        assertFilesCreated(outputDir);\n+    }\n+\n+    //checks that output files with reasonable file sizes are generated, but correctness of output is not checked\n+    @Test(groups = \"R\")\n+    public void testPlottingInfiniteMaximumCopyRatio() {\n+        final File outputDir = createTempDir(\"testDir\");\n+        final String[] arguments = {\n+                \"--\" + CopyNumberStandardArgument.STANDARDIZED_COPY_RATIOS_FILE_LONG_NAME, STANDARDIZED_COPY_RATIOS_FILE.getAbsolutePath(),\n+                \"--\" + CopyNumberStandardArgument.DENOISED_COPY_RATIOS_FILE_LONG_NAME, DENOISED_COPY_RATIOS_FILE.getAbsolutePath(),\n+                \"--\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_FILE.getAbsolutePath(),\n+                \"--\" + PlottingUtils.MAXIMUM_COPY_RATIO_LONG_NAME, \"Infinity\",\n+                \"-\" + StandardArgumentDefinitions.OUTPUT_SHORT_NAME, outputDir.getAbsolutePath(),\n+                \"--\" + CopyNumberStandardArgument.OUTPUT_PREFIX_LONG_NAME, OUTPUT_PREFIX\n+        };\n+        runCommandLine(arguments);\n+        assertFilesCreated(outputDir);\n+    }\n+\n     @Test(expectedExceptions = IllegalArgumentException.class)\n     public void testMinimumContigLength() {\n         final File outputDir = createTempDir(\"testDir\");\n         final String[] arguments = {\n                 \"--\" + CopyNumberStandardArgument.STANDARDIZED_COPY_RATIOS_FILE_LONG_NAME, STANDARDIZED_COPY_RATIOS_FILE.getAbsolutePath(),\n                 \"--\" + CopyNumberStandardArgument.DENOISED_COPY_RATIOS_FILE_LONG_NAME, DENOISED_COPY_RATIOS_FILE.getAbsolutePath(),\n-                \"-\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_WITH_NO_CONTIGS_ABOVE_MINIMUM_LENGTH_FILE.getAbsolutePath(),\n+                \"--\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_WITH_NO_CONTIGS_ABOVE_MINIMUM_LENGTH_FILE.getAbsolutePath(),", "originalCommit": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg1MjgxOQ==", "url": "https://github.com/broadinstitute/gatk/pull/6482#discussion_r413852819", "bodyText": "Short names use -, long names use --.  It just happens that the short and long names for sequence dictionary are the same for the CNV plotting tools, but this line of code would've broken if that was ever changed.", "author": "samuelklee", "createdAt": "2020-04-23T14:38:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg0MTMwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg0MTg1Ng==", "url": "https://github.com/broadinstitute/gatk/pull/6482#discussion_r413841856", "bodyText": "Do StandardArgumentDefinitions use \"-\" or \"--\"?", "author": "fleharty", "createdAt": "2020-04-23T14:25:49Z", "path": "src/test/java/org/broadinstitute/hellbender/tools/copynumber/plotting/PlotDenoisedCopyRatiosIntegrationTest.java", "diffHunk": "@@ -81,7 +99,7 @@ public void testNonExistentStandardizedFile() {\n         final String[] arguments = {\n                 \"--\" + CopyNumberStandardArgument.STANDARDIZED_COPY_RATIOS_FILE_LONG_NAME, \"Non-existent-file\",\n                 \"--\" + CopyNumberStandardArgument.DENOISED_COPY_RATIOS_FILE_LONG_NAME, DENOISED_COPY_RATIOS_FILE.getAbsolutePath(),\n-                \"-\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_FILE.getAbsolutePath(),\n+                \"--\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_FILE.getAbsolutePath(),", "originalCommit": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}