{"pr_number": 1660, "pr_title": "Narrow/low profile quirk", "pr_createdAt": "2020-02-10T22:41:13Z", "pr_url": "https://github.com/MegaMek/megamek/pull/1660", "timeline": [{"oid": "d44272fff8c3e58ab30014c849fcff9f57ef896a", "url": "https://github.com/MegaMek/megamek/commit/d44272fff8c3e58ab30014c849fcff9f57ef896a", "message": "new report message", "committedDate": "2020-02-02T03:19:39Z", "type": "commit"}, {"oid": "60bde69b84558a758016a776698f8a848e68c213", "url": "https://github.com/MegaMek/megamek/commit/60bde69b84558a758016a776698f8a848e68c213", "message": "Merge branch 'master' of https://github.com/MegaMek/megamek into narrow_low_profile_quirk", "committedDate": "2020-02-02T03:19:46Z", "type": "commit"}, {"oid": "c14d2632eecffd51d1920d4f3e59213d4231a64c", "url": "https://github.com/MegaMek/megamek/commit/c14d2632eecffd51d1920d4f3e59213d4231a64c", "message": "consolidate glancing blow logic for standard attacks", "committedDate": "2020-02-02T15:06:08Z", "type": "commit"}, {"oid": "24729a75865e64fb74a4cbdd2f36100889394b23", "url": "https://github.com/MegaMek/megamek/commit/24729a75865e64fb74a4cbdd2f36100889394b23", "message": "Merge branch 'master' of https://github.com/MegaMek/megamek into narrow_low_profile_quirk", "committedDate": "2020-02-04T02:29:42Z", "type": "commit"}, {"oid": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "url": "https://github.com/MegaMek/megamek/commit/1d786d2d9eae8f1641021314d7add8245ffe8c27", "message": "additional handlers", "committedDate": "2020-02-05T02:17:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzczOTcxMg==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377739712", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T16:15:35Z", "path": "megamek/src/megamek/common/weapons/LRMSwarmHandler.java", "diffHunk": "@@ -348,10 +337,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgxNDA3MQ==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377814071", "bodyText": "Should be rounded up for conventional infantry.", "author": "neoancient", "createdAt": "2020-02-11T18:22:55Z", "path": "megamek/src/megamek/common/weapons/PPCHandler.java", "diffHunk": "@@ -128,9 +128,8 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        \n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgxNTY5Ng==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377815696", "bodyText": "This is against conventional infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T18:25:42Z", "path": "megamek/src/megamek/common/weapons/SRMFragHandler.java", "diffHunk": "@@ -71,9 +71,8 @@ protected int calcDamagePerHit() {\n             if (bDirect) {\n                 toReturn += toHit.getMoS() / 3;\n             }\n-            if (bGlancing) {\n-                toReturn = (int) Math.floor(toReturn / 2.0);\n-            }\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgxNjEwOQ==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377816109", "bodyText": "Infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T18:26:27Z", "path": "megamek/src/megamek/common/weapons/SRMHandler.java", "diffHunk": "@@ -60,10 +60,10 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgxNjY0Ng==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377816646", "bodyText": "Infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T18:27:27Z", "path": "megamek/src/megamek/common/weapons/SRMTandemChargeHandler.java", "diffHunk": "@@ -195,9 +195,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n+\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzMjEwOA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377832108", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T18:55:35Z", "path": "megamek/src/megamek/common/weapons/battlearmor/BALBXHandler.java", "diffHunk": "@@ -51,10 +51,8 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\r\n                     ((Infantry) target).isMechanized(),\r\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\r\n-            if (bGlancing) {\r\n-                toReturn /= 2;\r\n-            }\r\n-            return (int) Math.floor(toReturn);\r\n+            toReturn = applyGlancingBlowModifier(toReturn, false);\r", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNDQxMA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377834410", "bodyText": "Round up for conventional infantry.", "author": "neoancient", "createdAt": "2020-02-11T18:59:47Z", "path": "megamek/src/megamek/common/weapons/ACWeaponHandler.java", "diffHunk": "@@ -70,9 +70,7 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNTQwMA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377835400", "bodyText": "Round up for conventional infantry.", "author": "neoancient", "createdAt": "2020-02-11T19:01:34Z", "path": "megamek/src/megamek/common/weapons/ArtilleryCannonWeaponHandler.java", "diffHunk": "@@ -271,17 +271,13 @@ public boolean handle(IGame.Phase phase, Vector<Report> vPhaseReport) {\n      */\n     @Override\n     protected int calcDamagePerHit() {\n-        float toReturn = wtype.getDamage();\n+        double toReturn = wtype.getDamage();\n         // area effect damage is double\n         if ((target instanceof Infantry) && !(target instanceof BattleArmor)) {\n             toReturn /= 0.5;\n         }\n \n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n-\n-        // System.err.println(\"Attack is doing \" + toReturn + \" damage.\");\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNTY3MQ==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377835671", "bodyText": "Round up for conventional infantry.", "author": "neoancient", "createdAt": "2020-02-11T19:02:04Z", "path": "megamek/src/megamek/common/weapons/ArtilleryWeaponIndirectFireHandler.java", "diffHunk": "@@ -497,11 +497,7 @@ protected int calcDamagePerHit() {\n             toReturn /= 0.5;\n         }\n \n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n-\n-        // System.err.println(\"Attack is doing \" + toReturn + \" damage.\");\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNzIyNw==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377837227", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T19:04:52Z", "path": "megamek/src/megamek/common/weapons/ATMHandler.java", "diffHunk": "@@ -83,9 +83,7 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzNzg4OQ==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377837889", "bodyText": "Round up for conventional infantry.", "author": "neoancient", "createdAt": "2020-02-11T19:06:05Z", "path": "megamek/src/megamek/common/weapons/ChemicalLaserHandler.java", "diffHunk": "@@ -88,9 +88,8 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg0Mjc2NA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377842764", "bodyText": "Round up for conventional infantry.", "author": "neoancient", "createdAt": "2020-02-11T19:15:02Z", "path": "megamek/src/megamek/common/weapons/EnergyWeaponHandler.java", "diffHunk": "@@ -92,10 +92,8 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n-\n+        \n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg0NDU3Ng==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377844576", "bodyText": "Round up for conventional infantry, down for other units.", "author": "neoancient", "createdAt": "2020-02-11T19:18:16Z", "path": "megamek/src/megamek/common/weapons/HyperLaserHandler.java", "diffHunk": "@@ -138,10 +138,8 @@ protected int calcDamagePerHit() {\n \r\n         }\r\n \r\n-        if (bGlancing) {\r\n-            toReturn = (int) Math.floor(toReturn / 2.0);\r\n-        }\r\n-        return (int) Math.ceil(toReturn);\r\n+        toReturn = applyGlancingBlowModifier(toReturn, true);\r", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg0NTIwMw==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377845203", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T19:19:24Z", "path": "megamek/src/megamek/common/weapons/LBXHandler.java", "diffHunk": "@@ -65,10 +65,8 @@ protected int calcDamagePerHit() {\n                     WeaponType.WEAPON_CLUSTER_BALLISTIC,\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1MzQyOA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377853428", "bodyText": "I think the comment on \"partial streak missiles\" refers to iATMs firing either as streak missiles (direct fire) or as cluster weapons (indirect fire). I would say that when firing as streak they are unaffected by glancing blows, but in the case of indirect fire they would get the damage reduction (since attacks against conventional infantry don't use the cluster table).\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        if (streakInactive()) {\n          \n          \n            \n                            toReturn = applyGlancingBlowModifier(toReturn, true);\n          \n          \n            \n                        }", "author": "neoancient", "createdAt": "2020-02-11T19:34:51Z", "path": "megamek/src/megamek/common/weapons/CLIATMHandler.java", "diffHunk": "@@ -95,11 +95,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2; // Is this correct for partial streak missiles??\n-                // it seems as if this only affects infantry -\n-                // I'm going to ignore this.\n-            }\n+            \n+            // some question here about \"partial streak missiles\"\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NDk5MA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377854990", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                            toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T19:37:46Z", "path": "megamek/src/megamek/common/weapons/MekMortarHandler.java", "diffHunk": "@@ -122,10 +122,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NTUyMg==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377855522", "bodyText": "Conventional infantry target\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                            toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T19:38:45Z", "path": "megamek/src/megamek/common/weapons/MGHandler.java", "diffHunk": "@@ -83,18 +82,16 @@ protected int calcDamagePerHit() {\n                         wtype.getInfantryDamageClass(),\n                         ((Infantry) target).isMechanized(),\n                         toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-                if (bGlancing) {\n-                    toReturn = (int) Math.floor(toReturn / 2.0);\n-                }\n+                \n+                toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NTk4NA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377855984", "bodyText": "Conventional infantry should be rounded up.", "author": "neoancient", "createdAt": "2020-02-11T19:39:37Z", "path": "megamek/src/megamek/common/weapons/NarcExplosiveHandler.java", "diffHunk": "@@ -133,9 +133,7 @@ protected int calcDamagePerHit() {\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n             toReturn = Math.ceil(toReturn);\n         }\n-        if (bGlancing) {\n-            return (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NjMwMg==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377856302", "bodyText": "Conventional infantry should be rounded up.", "author": "neoancient", "createdAt": "2020-02-11T19:40:21Z", "path": "megamek/src/megamek/common/weapons/PlasmaCannonHandler.java", "diffHunk": "@@ -296,9 +296,7 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1NzI2MA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377857260", "bodyText": "Conventional infantry should be rounded up.", "author": "neoancient", "createdAt": "2020-02-11T19:42:07Z", "path": "megamek/src/megamek/common/weapons/PulseLaserWeaponHandler.java", "diffHunk": "@@ -89,9 +89,8 @@ protected int calcDamagePerHit() {\n         } else if (bDirect) {\n             toReturn = Math.min(toReturn + (toHit.getMoS() / 3), toReturn * 2);\n         }\n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        \n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1ODA5Ng==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377858096", "bodyText": "Conventional infantry should be rounded up.", "author": "neoancient", "createdAt": "2020-02-11T19:43:47Z", "path": "megamek/src/megamek/common/weapons/RifleWeaponHandler.java", "diffHunk": "@@ -87,9 +87,7 @@ protected int calcDamagePerHit() {\n             }\n         }\n \n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1ODUyNA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377858524", "bodyText": "This is against conventional infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T19:44:31Z", "path": "megamek/src/megamek/common/weapons/SRMDeadFireHandler.java", "diffHunk": "@@ -66,10 +66,9 @@ protected int calcDamagePerHit() {\n                     wtype.getInfantryDamageClass(),\n                     ((Infantry) target).isMechanized(),\n                     toHit.getThruBldg() != null, ae.getId(), calcDmgPerHitReport);\n-            if (bGlancing) {\n-                toReturn /= 2;\n-            }\n-            return (int) Math.floor(toReturn);\n+            \n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg2MDMyMA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377860320", "bodyText": "Round up against conventional infantry", "author": "neoancient", "createdAt": "2020-02-11T19:47:54Z", "path": "megamek/src/megamek/common/weapons/VariableSpeedPulseLaserWeaponHandler.java", "diffHunk": "@@ -104,9 +104,7 @@ protected int calcDamagePerHit() {\n \n         }\n \n-        if (bGlancing) {\n-            toReturn = (int) Math.floor(toReturn / 2.0);\n-        }\n+        toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg2MDc5MA==", "url": "https://github.com/MegaMek/megamek/pull/1660#discussion_r377860790", "bodyText": "This is against infantry\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, false);\n          \n          \n            \n                        toReturn = applyGlancingBlowModifier(toReturn, true);", "author": "neoancient", "createdAt": "2020-02-11T19:48:48Z", "path": "megamek/src/megamek/common/weapons/VehicleFlamerHandler.java", "diffHunk": "@@ -128,9 +128,8 @@ protected int calcDamagePerHit() {\n             if (((Entity) target).hasAbility(OptionsConstants.MD_PAIN_SHUNT)) {\n                 toReturn /= 2;\n             }\n-            if (bGlancing) {\n-                toReturn = Math.ceil(toReturn / 2.0);\n-            }\n+\n+            toReturn = applyGlancingBlowModifier(toReturn, false);", "originalCommit": "1d786d2d9eae8f1641021314d7add8245ffe8c27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bb7b39db8c68411d92cf9d52be324431483827ee", "url": "https://github.com/MegaMek/megamek/commit/bb7b39db8c68411d92cf9d52be324431483827ee", "message": "code review changes", "committedDate": "2020-02-12T01:57:41Z", "type": "commit"}, {"oid": "e86e8601295b8a650f977adb9d458b9e0c72c3c5", "url": "https://github.com/MegaMek/megamek/commit/e86e8601295b8a650f977adb9d458b9e0c72c3c5", "message": "Merge branch 'master' of https://github.com/MegaMek/megamek into narrow_low_profile_quirk", "committedDate": "2020-02-12T01:57:58Z", "type": "commit"}, {"oid": "fc5db5015f0534dbe1ead753b4d17d0aceb50a5c", "url": "https://github.com/MegaMek/megamek/commit/fc5db5015f0534dbe1ead753b4d17d0aceb50a5c", "message": "fix arithmetic; eliminate to-hit penalty", "committedDate": "2020-02-13T01:46:49Z", "type": "commit"}]}