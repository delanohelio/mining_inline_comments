{"pr_number": 1966, "pr_title": "Fix hex shift when changing tileset theme", "pr_createdAt": "2020-05-20T17:35:12Z", "pr_url": "https://github.com/MegaMek/megamek/pull/1966", "timeline": [{"oid": "a8b5b5cc26343c17ec65ceacf1748fa6f5185c8f", "url": "https://github.com/MegaMek/megamek/commit/a8b5b5cc26343c17ec65ceacf1748fa6f5185c8f", "message": "Fix hex shift when changing tileset theme.", "committedDate": "2020-05-20T17:27:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE5MzMyOQ==", "url": "https://github.com/MegaMek/megamek/pull/1966#discussion_r428193329", "bodyText": "Why make the change here instead of just fixing the allBoardHexes() erroneous null return and replacing it with Collections.emptyList() (the return value of ArrayList can be swapped to List without issue)", "author": "Windchild292", "createdAt": "2020-05-20T17:41:55Z", "path": "megamek/src/megamek/client/ui/swing/boardview/BoardView1.java", "diffHunk": "@@ -6661,16 +6663,20 @@ public void changeTheme() {\n \n         if (selectedTheme == null) {\n             return;\n-\n-        } else if (selectedTheme.equals(\"(Original Theme)\")) {\n-            for (Coords c: allBoardHexes()) {\n+        }\n+        final List<Coords> allCoords = allBoardHexes();\n+        if (allCoords == null) {\n+            return;\n+        }\n+        if (selectedTheme.equals(\"(Original Theme)\")) {\n+            for (Coords c: allCoords) {\n                 IHex hex = board.getHex(c);\n                 hex.resetTheme();\n                 board.setHex(c, hex);\n             }\n \n         } else {\n-            for (Coords c: allBoardHexes()) {\n+            for (Coords c: allCoords) {", "originalCommit": "a8b5b5cc26343c17ec65ceacf1748fa6f5185c8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIxMDA3Mw==", "url": "https://github.com/MegaMek/megamek/pull/1966#discussion_r428210073", "bodyText": "Unknown whether allBoardHexes() is used elsewhere and what effects that may have (e.g. other places may depend on it being null).", "author": "NickAragua", "createdAt": "2020-05-20T18:10:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE5MzMyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIxMDE0Mw==", "url": "https://github.com/MegaMek/megamek/pull/1966#discussion_r428210143", "bodyText": "Yes, that would be better.", "author": "neoancient", "createdAt": "2020-05-20T18:10:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE5MzMyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIyMzg5MQ==", "url": "https://github.com/MegaMek/megamek/pull/1966#discussion_r428223891", "bodyText": "It's used in one other place which also fails to check for a null return value.", "author": "neoancient", "createdAt": "2020-05-20T18:32:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE5MzMyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIyODQ4MQ==", "url": "https://github.com/MegaMek/megamek/pull/1966#discussion_r428228481", "bodyText": "More bugs fixed = better.", "author": "NickAragua", "createdAt": "2020-05-20T18:38:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE5MzMyOQ=="}], "type": "inlineReview"}, {"oid": "40baf3a3370311bbaadb704edfd4f4d556a127ee", "url": "https://github.com/MegaMek/megamek/commit/40baf3a3370311bbaadb704edfd4f4d556a127ee", "message": "Improve null protection.", "committedDate": "2020-05-20T18:33:29Z", "type": "commit"}, {"oid": "e9a58c2ba86451c2a9c3cd5f46472ae9025664f4", "url": "https://github.com/MegaMek/megamek/commit/e9a58c2ba86451c2a9c3cd5f46472ae9025664f4", "message": "Cleanup in BoardView1::allBoardHexes", "committedDate": "2020-05-20T18:39:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIzMzgzMA==", "url": "https://github.com/MegaMek/megamek/pull/1966#discussion_r428233830", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 *  @return a list of {@ink Coords} of all hexes on the board.\n          \n          \n            \n                 *  @return a list of {@link Coords} of all hexes on the board.", "author": "Windchild292", "createdAt": "2020-05-20T18:45:55Z", "path": "megamek/src/megamek/client/ui/swing/boardview/BoardView1.java", "diffHunk": "@@ -1459,25 +1445,27 @@ private void renderDonut(Graphics2D g, Coords coords, int radius) {\n             drawHexBorder(g, p, Color.PINK, 0, 6);\n         }\n     }\n+\n     /**\n-     *  Returns a list of Coords of all hexes on the board.\n-     *  Returns ONLY hexes where board.getHex != null.\n+     *  @return a list of {@ink Coords} of all hexes on the board.", "originalCommit": "e9a58c2ba86451c2a9c3cd5f46472ae9025664f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIzNjc5NA==", "url": "https://github.com/MegaMek/megamek/pull/1966#discussion_r428236794", "bodyText": "My fingers are tripping over themselves today.", "author": "neoancient", "createdAt": "2020-05-20T18:51:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIzMzgzMA=="}], "type": "inlineReview"}, {"oid": "5917c05565b7e83dde2ed3dce21b8ab6081be906", "url": "https://github.com/MegaMek/megamek/commit/5917c05565b7e83dde2ed3dce21b8ab6081be906", "message": "Update megamek/src/megamek/client/ui/swing/boardview/BoardView1.java\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>", "committedDate": "2020-05-20T18:51:19Z", "type": "commit"}]}