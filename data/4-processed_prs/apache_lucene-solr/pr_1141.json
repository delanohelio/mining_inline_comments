{"pr_number": 1141, "pr_title": "SOLR-14147 change the Security manager to default to true.", "pr_createdAt": "2020-01-04T09:15:22Z", "pr_url": "https://github.com/apache/lucene-solr/pull/1141", "timeline": [{"oid": "75776d84d79abac4989c731610e9cc5c58e5908b", "url": "https://github.com/apache/lucene-solr/commit/75776d84d79abac4989c731610e9cc5c58e5908b", "message": "change the Security manager to default.", "committedDate": "2020-01-04T09:11:45Z", "type": "commit"}, {"oid": "5b2ef8daebf9c656f0631e949a32c2df7b821c32", "url": "https://github.com/apache/lucene-solr/commit/5b2ef8daebf9c656f0631e949a32c2df7b821c32", "message": "update the ref-guide.", "committedDate": "2020-01-04T09:23:05Z", "type": "commit"}, {"oid": "41c91d9e4a87aa2149c34fa533c7396f030e78b2", "url": "https://github.com/apache/lucene-solr/commit/41c91d9e4a87aa2149c34fa533c7396f030e78b2", "message": "uncomment init scripts update changes.", "committedDate": "2020-01-04T18:34:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA2NzI0NA==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363067244", "bodyText": "We shouldn't put uncommented values in these files. After all, it says at the very top of the file:\n\nThe default shipped state of this file is completely commented.\n\nInstead, lets fix the actual defaults for the scripts. It just means if the environment variable is not set, we want to set it to true. Here is an example that does that for a different change, but demonstrates the idea: https://issues.apache.org/jira/secure/attachment/12989428/SOLR-14142.patch", "author": "rmuir", "createdAt": "2020-01-05T03:29:55Z", "path": "solr/bin/solr.in.sh", "diffHunk": "@@ -229,4 +229,4 @@\n # Runtime properties are passed to the security policy file (server/etc/security.policy)\n # You can also tweak via standard JDK files such as ~/.java.policy, see https://s.apache.org/java8policy\n # This is experimental! It may not work at all with Hadoop/HDFS features.\n-#SOLR_SECURITY_MANAGER_ENABLED=false\n+SOLR_SECURITY_MANAGER_ENABLED=true", "originalCommit": "41c91d9e4a87aa2149c34fa533c7396f030e78b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NzQ0NQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363077445", "bodyText": "Thanks @rmuir for the information. I can roll back one commit to get back to there. I started with it, after reading the file and then uncommented this morning.\nI think that maybe we can try to make this functionality more apparent to readers through a simple clause, which I will add to the PR for the top of file, in the same paragraph.", "author": "MarcusSorealheis", "createdAt": "2020-01-05T08:32:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA2NzI0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzExNjAyMA==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363116020", "bodyText": "The added comment is wrong. Take a look at the patch I linked to again.", "author": "rmuir", "createdAt": "2020-01-05T20:48:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA2NzI0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzEyMzE4Mw==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363123183", "bodyText": "got it. I think I understand.", "author": "MarcusSorealheis", "createdAt": "2020-01-05T22:56:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA2NzI0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA2NzI1OQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363067259", "bodyText": "I think we want to remove this whole section from this documentation page. If we fix the default here, then it is one less step the user has to worry about. Can we find a better place to document this hadoop stuff?", "author": "rmuir", "createdAt": "2020-01-05T03:30:43Z", "path": "solr/solr-ref-guide/src/securing-solr.adoc", "diffHunk": "@@ -97,4 +97,4 @@ It is also strongly recommended that Solr listen to only those network interface\n \n == Enable Security Manager\n \n-Solr can run in a Java Security Manager sandbox by setting `SOLR_SECURITY_MANAGER_ENABLED=true` via environment variable or in `solr.in.sh`/`solr.in.cmd`. This feature is incompatible with Hadoop.\n+Solr runs in a Java Security Manager sandbox by default. Since this feature is incompatible with Hadoop, you can disable it by setting `SOLR_SECURITY_MANAGER_ENABLED=false` via environment variable or in `solr.in.sh`/`solr.in.cmd` if you are running Solr with Hadoop.", "originalCommit": "41c91d9e4a87aa2149c34fa533c7396f030e78b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3NzQwOQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363077409", "bodyText": "I will take a look and add it to the PR. Since the default is true, I do agree that the Hadoop bit should be on its own. This comment makes me want to test to see if the security manager is still incompatible with Hadoop. I don't know enough of the history to know if it should or should not work.", "author": "MarcusSorealheis", "createdAt": "2020-01-05T08:31:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA2NzI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3ODQyMg==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363078422", "bodyText": "I need to conduct a variety of tests before writing a definitive statement, e.g. will or will not work, about its functionality anywhere in the docs to ensure the information is accurate. Even if I experience some success, I will still include that it may not work based on the previous docs. I will also maybe consult one of the committers  involved in HDFS or (you included) for guidance on what to test or if it will not work for sure for reasons beyond my scope of knowledge at this time.", "author": "MarcusSorealheis", "createdAt": "2020-01-05T08:52:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA2NzI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA3ODc0OA==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363078748", "bodyText": "We could something about the Solr Security Manager here: https://github.com/apache/lucene-solr/blob/master/solr/solr-ref-guide/src/hadoop-authentication-plugin.adoc if you agree it is appropriate. Some changes between Java 8 and 11 lead me to believe that some behavior could have changed as it pertains to Solr on HDFS. Unfortunately, I have no evidence to support that assertion and I need to seek it out.", "author": "MarcusSorealheis", "createdAt": "2020-01-05T08:59:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA2NzI1OQ=="}], "type": "inlineReview"}, {"oid": "1b9212898d8652756c1614e3d7254a5480bf3145", "url": "https://github.com/apache/lucene-solr/commit/1b9212898d8652756c1614e3d7254a5480bf3145", "message": "changed the ref guide and re-commented file.", "committedDate": "2020-01-05T08:37:33Z", "type": "commit"}, {"oid": "6b4bd6649c4175d7395145283e8a25e8d28ec4b3", "url": "https://github.com/apache/lucene-solr/commit/6b4bd6649c4175d7395145283e8a25e8d28ec4b3", "message": "remove added comment.", "committedDate": "2020-01-05T22:33:40Z", "type": "commit"}, {"oid": "c20c47d906a15fa08f6f229bfeb2bd4676907ebe", "url": "https://github.com/apache/lucene-solr/commit/c20c47d906a15fa08f6f229bfeb2bd4676907ebe", "message": "modified shell script.", "committedDate": "2020-01-05T23:00:48Z", "type": "commit"}, {"oid": "886d938caab7bafc41e42b869d09c5a832782257", "url": "https://github.com/apache/lucene-solr/commit/886d938caab7bafc41e42b869d09c5a832782257", "message": "removed comment in windows file.\n\nSigned-off-by: marcussorealheis <marcuseagan@gmail.com>", "committedDate": "2020-01-05T23:18:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzEzMjQ4OA==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363132488", "bodyText": "I think we may prefer the bashism of if [ \"${SOLR_SECURITY_MANAGER_ENABLED:-true}\" == \"true\" ] for consistency elsewhere in the script. it makes it clear that if its undefined, it will default to true.\nthe windows file solr.cmd needs to be changed too. Currently this pull request doesn't change anything for windows. for windows CMD, I think it is clearest to just put a IF NOT DEFINED before the check. see that linked patch for an example.", "author": "rmuir", "createdAt": "2020-01-06T01:21:09Z", "path": "solr/bin/solr", "diffHunk": "@@ -2084,14 +2084,14 @@ else\n   REMOTE_JMX_OPTS=()\n fi\n \n-# Enable java security manager (limiting filesystem access and other things)\n-if [ \"$SOLR_SECURITY_MANAGER_ENABLED\" == \"true\" ]; then\n+# Disable java security manager (allowing filesystem access and other things)\n+if [ \"$SOLR_SECURITY_MANAGER_ENABLED\" == \"false\" ]; then", "originalCommit": "886d938caab7bafc41e42b869d09c5a832782257", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU0OTUzNA==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r363549534", "bodyText": "should be resolved?", "author": "MarcusSorealheis", "createdAt": "2020-01-07T00:49:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzEzMjQ4OA=="}], "type": "inlineReview"}, {"oid": "95cd376ea639fbb09b002d9428fb3ceef47d91e6", "url": "https://github.com/apache/lucene-solr/commit/95cd376ea639fbb09b002d9428fb3ceef47d91e6", "message": "bashism and fix windows", "committedDate": "2020-01-06T02:19:54Z", "type": "commit"}, {"oid": "fcf334f394d88bab0c26566afc7cc40ca4d251ca", "url": "https://github.com/apache/lucene-solr/commit/fcf334f394d88bab0c26566afc7cc40ca4d251ca", "message": "remove space\n\nSigned-off-by: marcussorealheis <marcuseagan@gmail.com>", "committedDate": "2020-01-06T05:06:37Z", "type": "commit"}, {"oid": "409390ff6fcfa5032ce367d7bc0aada531a4d31f", "url": "https://github.com/apache/lucene-solr/commit/409390ff6fcfa5032ce367d7bc0aada531a4d31f", "message": "typo.", "committedDate": "2020-01-06T05:18:05Z", "type": "commit"}, {"oid": "f59a78b98357bba6326f5c641ac2e03a610dcd8b", "url": "https://github.com/apache/lucene-solr/commit/f59a78b98357bba6326f5c641ac2e03a610dcd8b", "message": "Merge branch 'master' into SOLR-14147_enable_security_man_default", "committedDate": "2020-01-09T21:31:10Z", "type": "commit"}, {"oid": "e71eec100069eae28510b81537af0536f5267b03", "url": "https://github.com/apache/lucene-solr/commit/e71eec100069eae28510b81537af0536f5267b03", "message": "Merge branch 'master' into SOLR-14147_enable_security_man_default", "committedDate": "2020-01-13T22:09:18Z", "type": "commit"}, {"oid": "50814e31e041bb0a3943b728f197eb7177ea6041", "url": "https://github.com/apache/lucene-solr/commit/50814e31e041bb0a3943b728f197eb7177ea6041", "message": "Merge branch 'master' into SOLR-14147_enable_security_man_default", "committedDate": "2020-01-21T09:28:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1MzI1OQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r373753259", "bodyText": "i think these are just formatting differences, can we nuke them?", "author": "rmuir", "createdAt": "2020-02-01T02:59:54Z", "path": "solr/bin/solr.cmd", "diffHunk": "@@ -1190,12 +1190,11 @@ IF \"%ENABLE_REMOTE_JMX_OPTS%\"==\"true\" (\n REM Enable java security manager by default (limiting filesystem access and other things)\n IF NOT DEFINED SOLR_SECURITY_MANAGER_ENABLED (\n   set SOLR_SECURITY_MANAGER_ENABLED=true && set SECURITY_MANAGER_OPTS=-Djava.security.manager ^\n--Djava.security.policy=\"%SOLR_SERVER_DIR%\\etc\\security.policy\" ^\n--Djava.security.properties=\"%SOLR_SERVER_DIR%\\etc\\security.properties\" ^\n--Dsolr.internal.network.permission=*\n+    -Djava.security.policy=\"%SOLR_SERVER_DIR%\\etc\\security.policy\" ^\n+    -Djava.security.properties=\"%SOLR_SERVER_DIR%\\etc\\security.properties\" ^\n+    -Dsolr.internal.network.permission=*", "originalCommit": "50814e31e041bb0a3943b728f197eb7177ea6041", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1MzUwMA==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r373753500", "bodyText": "I think this logic may be reversed. It is true (or unset, in which case it defaults to true), we want to enable the thing. It can be seen from looking quickly at the admin UI at system properties, to determine if you correctly enabled this setting. you will see java.security.manager flag set in the system properties part of the admin UI.", "author": "rmuir", "createdAt": "2020-02-01T03:04:22Z", "path": "solr/bin/solr", "diffHunk": "@@ -2086,14 +2086,14 @@ else\n   REMOTE_JMX_OPTS=()\n fi\n \n-# Enable java security manager (limiting filesystem access and other things)\n-if [ \"$SOLR_SECURITY_MANAGER_ENABLED\" == \"true\" ]; then\n+# Disable java security manager (allowing filesystem access and other things)\n+if [ \"${SOLR_SECURITY_MANAGER_ENABLED:-true}\" == \"true\" ]; then", "originalCommit": "50814e31e041bb0a3943b728f197eb7177ea6041", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1MzU5NA==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r373753594", "bodyText": "to keep the .cmd logic simple, we may just want to set the environment variable, if it is not already set. It limits the changes to what we want to do (changing the default) with just a simple if-statement. And we can avoid wrestling with any of the other parts of this CMD file :)", "author": "rmuir", "createdAt": "2020-02-01T03:06:26Z", "path": "solr/bin/solr.cmd", "diffHunk": "@@ -1187,12 +1187,12 @@ IF \"%ENABLE_REMOTE_JMX_OPTS%\"==\"true\" (\n   set REMOTE_JMX_OPTS=\n )\n \n-REM Enable java security manager (limiting filesystem access and other things)\n-IF \"%SOLR_SECURITY_MANAGER_ENABLED%\"==\"true\" (\n-  set SECURITY_MANAGER_OPTS=-Djava.security.manager ^\n--Djava.security.policy=\"%SOLR_SERVER_DIR%\\etc\\security.policy\" ^\n--Djava.security.properties=\"%SOLR_SERVER_DIR%\\etc\\security.properties\" ^\n--Dsolr.internal.network.permission=*\n+REM Enable java security manager by default (limiting filesystem access and other things)\n+IF NOT DEFINED SOLR_SECURITY_MANAGER_ENABLED (", "originalCommit": "50814e31e041bb0a3943b728f197eb7177ea6041", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1NjM2NQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r373756365", "bodyText": "Thanks @rmuir I'll make the resolutions.", "author": "MarcusSorealheis", "createdAt": "2020-02-01T04:11:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1MzU5NA=="}], "type": "inlineReview"}, {"oid": "242e83e039552e4d33bbd6627e3bc38d46a157fa", "url": "https://github.com/apache/lucene-solr/commit/242e83e039552e4d33bbd6627e3bc38d46a157fa", "message": "merge", "committedDate": "2020-02-01T04:29:15Z", "type": "commit"}, {"oid": "7a6511430b6c10d60b01e0069d8611e18f3bf624", "url": "https://github.com/apache/lucene-solr/commit/7a6511430b6c10d60b01e0069d8611e18f3bf624", "message": "Merge branch 'SOLR-14147_enable_security_man_default' of github.com:MarcusSorealheis/lucene-solr into SOLR-14147_enable_security_man_default\n\n* 'SOLR-14147_enable_security_man_default' of github.com:MarcusSorealheis/lucene-solr:\n  typo.\n  remove space\n  bashism and fix windows\n  removed comment in windows file.", "committedDate": "2020-02-01T04:29:38Z", "type": "commit"}, {"oid": "c566bf9367eff552a45a6c24d9574d6823b78c17", "url": "https://github.com/apache/lucene-solr/commit/c566bf9367eff552a45a6c24d9574d6823b78c17", "message": "removed formatting issue.", "committedDate": "2020-02-01T04:38:00Z", "type": "commit"}, {"oid": "f8aa51874c512b51e9775d8ae0cc9a6f7f444f61", "url": "https://github.com/apache/lucene-solr/commit/f8aa51874c512b51e9775d8ae0cc9a6f7f444f61", "message": "simplify.", "committedDate": "2020-02-01T04:51:23Z", "type": "commit"}, {"oid": "b863cc0b1af7cc3c1e794d3b9cf08cf1d79b6a5e", "url": "https://github.com/apache/lucene-solr/commit/b863cc0b1af7cc3c1e794d3b9cf08cf1d79b6a5e", "message": "fix shell script", "committedDate": "2020-02-01T05:40:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc4NDQwMQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r373784401", "bodyText": "Sorry, maybe my comment was confusing, this logic is not correct. we need two \"IF\".\nWe don't need to change anything about the existing logic, but we need to introduce a new IF above it to set the default. something like this:\nREM Enable by default (if the variable is not set by the user, we set it to true)\nIF NOT DEFINED SOLR_SECURITY_MANAGER_ENABLED(\n  set SOLR_SECURITY_MANAGER_ENABLED=true\n)\n...\nREM Existing logic in master (Unchanged)\nIF \"%SOLR_SECURITY_MANAGER_ENABLED%\"==\"true\" (\n ...", "author": "rmuir", "createdAt": "2020-02-01T15:03:50Z", "path": "solr/bin/solr.cmd", "diffHunk": "@@ -1187,8 +1187,8 @@ IF \"%ENABLE_REMOTE_JMX_OPTS%\"==\"true\" (\n   set REMOTE_JMX_OPTS=\n )\n \n-REM Enable java security manager (limiting filesystem access and other things)\n-IF \"%SOLR_SECURITY_MANAGER_ENABLED%\"==\"true\" (\n+REM Enable java security manager by default (limiting filesystem access and other things)\n+IF NOT DEFINED SOLR_SECURITY_MANAGER_ENABLED (", "originalCommit": "b863cc0b1af7cc3c1e794d3b9cf08cf1d79b6a5e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc4NDU5NQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r373784595", "bodyText": "as a matter of style/consistency i would reverse this so we are comparing with \"true\", and change the comment back to \"Enable\" from \"Disable\". I think it is easier on the brain to think about positives (not the negatives).\nso something like this pseudocode:\n# Enable java security manager (limiting filesystem access and other things)\nif [ \"$SOLR_SECURITY_MANAGER_ENABLED:-true\" == \"true\" ]; then\n  SECURITY_MANAGER_OPTS=('-Djava.security.manager' \\\n    \"-Djava.security.policy=${SOLR_SERVER_DIR}/etc/security.policy\" \\\n    \"-Djava.security.properties=${SOLR_SERVER_DIR}/etc/security.properties\" \\\n    '-Dsolr.internal.network.permission=*')\nelse\n  SECURITY_MANAGER_OPTS=()\nfi\n\nEssentially the same as existing logic, we just add the :-true so that if the variable is not set by the user in any way, we default its value to true.", "author": "rmuir", "createdAt": "2020-02-01T15:08:02Z", "path": "solr/bin/solr", "diffHunk": "@@ -2086,14 +2086,14 @@ else\n   REMOTE_JMX_OPTS=()\n fi\n \n-# Enable java security manager (limiting filesystem access and other things)\n-if [ \"$SOLR_SECURITY_MANAGER_ENABLED\" == \"true\" ]; then\n+# Disable java security manager (allowing filesystem access and other things)\n+if [ \"${SOLR_SECURITY_MANAGER_ENABLED:-true}\" == \"false\" ]; then", "originalCommit": "b863cc0b1af7cc3c1e794d3b9cf08cf1d79b6a5e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7dfd37eb83e0651cbbeabb3f17d001465b28f8f1", "url": "https://github.com/apache/lucene-solr/commit/7dfd37eb83e0651cbbeabb3f17d001465b28f8f1", "message": "simplify unix and fix other.", "committedDate": "2020-02-04T06:43:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDczOTE1MA==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r374739150", "bodyText": "I think there may have been an issue with merging here. I see a lot of this network-related content duplicated now.", "author": "rmuir", "createdAt": "2020-02-04T15:26:07Z", "path": "solr/solr-ref-guide/src/securing-solr.adoc", "diffHunk": "@@ -95,6 +94,15 @@ It is also strongly recommended that Solr listen to only those network interface\n  ----\n // end::security-network-binding-1[]\n \n-== Enable Security Manager\n+// tag::security-network-binding-1[]\n+Administrators should consider their security setup carefully as an important step in moving to production.  Solr provides a number of features out of the box to meet the security needs of users: authentication and authorization can be configured using a range of security plugins, privacy can be bolstered by enabling SSL/TLS, and (in SolrCloud) ZooKeeper data can be protected with ACL rules to prevent unauthorized reads and writes.\n+\n+Even if these measures or others are taken, it is strongly recommended that Solr always be protected by a firewall.  Solr is not designed to be exposed on the open internet.\n \n-Solr can run in a Java Security Manager sandbox by setting `SOLR_SECURITY_MANAGER_ENABLED=true` via environment variable or in `solr.in.sh`/`solr.in.cmd`. This feature is incompatible with Hadoop.\n+It is also strongly recommended that Solr listen to only those network interfaces that are strictly required.  To prevent administrators from unintentionally exposing Solr more broadly, Solr only listens on the loopback interface (\"127.0.0.1\") by default.  Most deployments will need to change this value to something less restrictive so that it can be reached from other boxes.  This can be done by setting a `SOLR_JETTY_HOST` value in your environment's \"include script\" (`solr.in.sh` or `solr.in.cmd`):\n+\n+[source,bash]\n+ ----\n+ SOLR_JETTY_HOST=\"0.0.0.0\"\n+ ----\n+// end::security-network-binding-1[]", "originalCommit": "7dfd37eb83e0651cbbeabb3f17d001465b28f8f1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDk3ODI0Nw==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r374978247", "bodyText": "This is fixed.", "author": "MarcusSorealheis", "createdAt": "2020-02-04T23:15:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDczOTE1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc0Nzg3Nw==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r374747877", "bodyText": "I suggest to reword this slightly in the first sentence to a more generic description: \"... now runs with java security manager enabled by default\". This way users know what it does (even if they don't know that configuration parameter).\nFor the second sentence, I would tweak wording from \"disable this feature via...\" to \"set   SOLR_SECURITY_MANAGER_ENABLED=false via...\". It matches the actual variable name and gives them the little snippet they need, in case they need to do it.", "author": "rmuir", "createdAt": "2020-02-04T15:39:27Z", "path": "solr/CHANGES.txt", "diffHunk": "@@ -81,7 +81,9 @@ Upgrade Notes\n * SOLR-13985: Solr's Jetty now binds to localhost network interface by default for better out of the box security.\n   Administrators that need Solr exposed more broadly can change the SOLR_JETTY_HOST property in their Solr include\n   (solr.in.sh/solr.in.cmd) file. (Jason Gerlowski, David Smiley, Robert Muir)\n-  \n+\n+* SOLR-14147: Solr now runs with the SOLR_SECURITY_MANAGER enabled by default. Administrators that need to run Solr with Hadoop will need to disable this feature via environment variable or in one of the Solr init scripts. Other features in Solr could also break. (Robert Muir, marcussorealheis) ", "originalCommit": "7dfd37eb83e0651cbbeabb3f17d001465b28f8f1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg1MDc3MQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r374850771", "bodyText": "good point. I like that feedback", "author": "MarcusSorealheis", "createdAt": "2020-02-04T18:39:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc0Nzg3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDkzNzU2Nw==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r374937567", "bodyText": "Made the changes here.", "author": "MarcusSorealheis", "createdAt": "2020-02-04T21:38:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc0Nzg3Nw=="}], "type": "inlineReview"}, {"oid": "e55b65e70c07e1044d51f8170a473ec99d35805b", "url": "https://github.com/apache/lucene-solr/commit/e55b65e70c07e1044d51f8170a473ec99d35805b", "message": "improving documentation.", "committedDate": "2020-02-04T18:43:35Z", "type": "commit"}, {"oid": "b1c516b28778b134b235c521edf5c3ae38b4166b", "url": "https://github.com/apache/lucene-solr/commit/b1c516b28778b134b235c521edf5c3ae38b4166b", "message": "merge issues resolved.", "committedDate": "2020-02-04T21:41:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTAwODMwMQ==", "url": "https://github.com/apache/lucene-solr/pull/1141#discussion_r375008301", "bodyText": "i think wording 'in the environment' may work better than 'as an argument to the start command'? From doing development work, I always think of the term \"arguments\" being strongly associated with program's parameters placed after the command (e.g. argc/argv in C, args[] in java, etc), but doing this won't work with these scripts.", "author": "rmuir", "createdAt": "2020-02-05T00:59:03Z", "path": "solr/CHANGES.txt", "diffHunk": "@@ -81,7 +81,9 @@ Upgrade Notes\n * SOLR-13985: Solr's Jetty now binds to localhost network interface by default for better out of the box security.\n   Administrators that need Solr exposed more broadly can change the SOLR_JETTY_HOST property in their Solr include\n   (solr.in.sh/solr.in.cmd) file. (Jason Gerlowski, David Smiley, Robert Muir)\n-  \n+\n+* SOLR-14147: Solr now runs with the java security manager enabled by default. Administrators that need to run Solr with Hadoop will need to disable this feature by setting SOLR_SECURITY_MANAGER=false as an argument to the start command or in one of the Solr init scripts. Other features in Solr could also break. (Robert Muir, marcussorealheis) ", "originalCommit": "b1c516b28778b134b235c521edf5c3ae38b4166b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ba6ccfc220412b3abfc78272fbea0486e1f79315", "url": "https://github.com/apache/lucene-solr/commit/ba6ccfc220412b3abfc78272fbea0486e1f79315", "message": "fixed README", "committedDate": "2020-02-05T20:11:42Z", "type": "commit"}]}