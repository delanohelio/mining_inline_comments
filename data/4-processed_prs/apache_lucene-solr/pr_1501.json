{"pr_number": 1501, "pr_title": "SOLR-13289: Add Refguide changes", "pr_createdAt": "2020-05-08T22:04:53Z", "pr_url": "https://github.com/apache/lucene-solr/pull/1501", "timeline": [{"oid": "3e34ce99a11eebc5df8d93cf92e0b0dd5f9ff7aa", "url": "https://github.com/apache/lucene-solr/commit/3e34ce99a11eebc5df8d93cf92e0b0dd5f9ff7aa", "message": "SOLR-13289: Add Refguide changes", "committedDate": "2020-05-08T22:27:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUzOTAxNA==", "url": "https://github.com/apache/lucene-solr/pull/1501#discussion_r422539014", "bodyText": "Wouldn't \"minNumFoundExact\" be a better parameter name because it aligns with the \"numFound\" that we expose?  I searched for \"hits\" in Solr string literals and the ref guide.  It's not used much; more often refers to cache hits.", "author": "dsmiley", "createdAt": "2020-05-09T19:55:53Z", "path": "solr/solr-ref-guide/src/common-query-parameters.adoc", "diffHunk": "@@ -361,3 +361,42 @@ This is what happens if a similar request is sent that adds `echoParams=all` to\n   }\n }\n ----\n+\n+== minExactHits Parameter", "originalCommit": "3e34ce99a11eebc5df8d93cf92e0b0dd5f9ff7aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIxNTY3Mw==", "url": "https://github.com/apache/lucene-solr/pull/1501#discussion_r423215673", "bodyText": "Yes, I think that makes sense", "author": "tflobbe", "createdAt": "2020-05-11T17:53:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUzOTAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODk3NDQ5Nw==", "url": "https://github.com/apache/lucene-solr/pull/1501#discussion_r428974497", "bodyText": "Discussed in https://issues.apache.org/jira/browse/SOLR-13289", "author": "tflobbe", "createdAt": "2020-05-21T23:54:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUzOTAxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUzOTUyNw==", "url": "https://github.com/apache/lucene-solr/pull/1501#discussion_r422539527", "bodyText": "didn't we agree on \"numFoundExact\" ?", "author": "dsmiley", "createdAt": "2020-05-09T20:00:34Z", "path": "solr/solr-ref-guide/src/common-query-parameters.adoc", "diffHunk": "@@ -361,3 +361,42 @@ This is what happens if a similar request is sent that adds `echoParams=all` to\n   }\n }\n ----\n+\n+== minExactHits Parameter\n+When this parameter is used, Solr will count the number of hits accurately at least until this value. After that, Solr can skip over documents that don't have a score high enough to enter in the top N. This can greatly improve performance o search queries. On the other hand, when this parameter is used, the `numFound` may not be exact, and may instead be an approximation.\n+The `numFoundExact` boolean attribute is included in all responses, indicating if the `numFound` value is exact or an approximation. If it's an approximation, the real number of hits for the query is guaranteed to be greater or equal `numFound`.\n+\n+More about approximate document counting and `minExactHits`:\n+* The documents returned in the response are guaranteed to be the docs with the top scores. This parameter will not skip documents that are to be returned in the response, it will only skip counting docs that, while they match the query, their score is low enough to not be in the top N.\n+* Providing `minExactHits` doesn't guarantee that Solr will use approximate hit counting (and thus, provide the speedup). Some types of queries, or other parameters (like if facets are requested) will require accurate counting. The value of `numFoundExact` indicates if the approximation was used or not.\n+* Approximate counting can only be used when sorting by `score desc` first (which is the default sort in Solr). Other fields can be used after `score desc`, but if any other type of sorting is used before score, then the approximation won't be applied.\n+* When doing distributed queries across multiple shards, each shard will accurately count hits until `minExactHits` (which means the query could be hitting `numShards * minExactHits` docs and `numFound` in the response would still be accurate)  \n+For example:\n+\n+[source,text]\n+q=quick brown fox&minExactHits=100&rows=10\n+\n+[source,json]\n+----\n+\"response\": {\n+    \"numFound\": 153,\n+    \"start\": 0,\n+    \"hitCountExact\": false,", "originalCommit": "3e34ce99a11eebc5df8d93cf92e0b0dd5f9ff7aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIxNTU4NQ==", "url": "https://github.com/apache/lucene-solr/pull/1501#discussion_r423215585", "bodyText": "Ah, right, I copied from the Jira issue and forgot to update", "author": "tflobbe", "createdAt": "2020-05-11T17:53:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjUzOTUyNw=="}], "type": "inlineReview"}, {"oid": "42cbe1bc9adbed65dc8f406d3b1ddc5c7a3ff6c6", "url": "https://github.com/apache/lucene-solr/commit/42cbe1bc9adbed65dc8f406d3b1ddc5c7a3ff6c6", "message": "SOLR-13289: Add Refguide changes", "committedDate": "2020-05-21T23:43:29Z", "type": "commit"}, {"oid": "8a055e6904e2f2715ee70d54d60eb222fccb15d0", "url": "https://github.com/apache/lucene-solr/commit/8a055e6904e2f2715ee70d54d60eb222fccb15d0", "message": "hitCountExact -> numFoundExact", "committedDate": "2020-05-21T23:43:29Z", "type": "commit"}, {"oid": "b91233bd7bf2bf1063230963df4c89b2645d1794", "url": "https://github.com/apache/lucene-solr/commit/b91233bd7bf2bf1063230963df4c89b2645d1794", "message": "minExactHits -> minExactCount", "committedDate": "2020-05-21T23:50:46Z", "type": "forcePushed"}, {"oid": "f188a96eda513e8354aab4f77d35e30bf527e726", "url": "https://github.com/apache/lucene-solr/commit/f188a96eda513e8354aab4f77d35e30bf527e726", "message": "minExactHits -> minExactCount", "committedDate": "2020-05-21T23:52:56Z", "type": "commit"}, {"oid": "f188a96eda513e8354aab4f77d35e30bf527e726", "url": "https://github.com/apache/lucene-solr/commit/f188a96eda513e8354aab4f77d35e30bf527e726", "message": "minExactHits -> minExactCount", "committedDate": "2020-05-21T23:52:56Z", "type": "forcePushed"}]}