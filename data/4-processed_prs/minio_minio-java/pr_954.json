{"pr_number": 954, "pr_title": "Implement Args builder for getObject API", "pr_createdAt": "2020-05-26T15:00:22Z", "pr_url": "https://github.com/minio/minio-java/pull/954", "timeline": [{"oid": "dee8e9e897b4a7877b37113dd0354c49c2860a8c", "url": "https://github.com/minio/minio-java/commit/dee8e9e897b4a7877b37113dd0354c49c2860a8c", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - fileName (String)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SseObjectArgs`\nthat supports the `sse` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `getObjectFile` for downloading the\nobject, which internally uses `getObject`.\n\nAlso enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.", "committedDate": "2020-05-27T11:25:07Z", "type": "forcePushed"}, {"oid": "cce8edd0f3d9fbf3d2eae86d943188d3308485e7", "url": "https://github.com/minio/minio-java/commit/cce8edd0f3d9fbf3d2eae86d943188d3308485e7", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - fileName (String)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SseObjectArgs`\nthat supports the `sse` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `getObjectFile` for downloading the\nobject, which internally uses `getObject`.\n\nAlso enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.", "committedDate": "2020-05-27T11:31:06Z", "type": "forcePushed"}, {"oid": "c1ffd4d7b4e625863b8a478970e50d51888d16f4", "url": "https://github.com/minio/minio-java/commit/c1ffd4d7b4e625863b8a478970e50d51888d16f4", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - fileName (String)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SsecObjectArgs`\nthat supports the `ssec` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `getObjectFile` for downloading the\nobject, which internally uses `getObject`.\n\nAlso enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.", "committedDate": "2020-05-27T11:44:24Z", "type": "forcePushed"}, {"oid": "06825683923d77b204d8bff070a224d57261409e", "url": "https://github.com/minio/minio-java/commit/06825683923d77b204d8bff070a224d57261409e", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - fileName (String)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SsecObjectArgs`\nthat supports the `ssec` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `getObjectFile` for downloading the\nobject, which internally uses `getObject`.\n\nAlso,\n\n- Enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.\n- Moved the class `ServerSideEncryptionWithCustomerKey` outside of\n`ServerSideEncryption` and made it into a standalone class.", "committedDate": "2020-05-28T06:00:17Z", "type": "forcePushed"}, {"oid": "411b17d955b14cee3751fb7f43af5a021f2aebd2", "url": "https://github.com/minio/minio-java/commit/411b17d955b14cee3751fb7f43af5a021f2aebd2", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - fileName (String)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SsecObjectArgs`\nthat supports the `ssec` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `downloadObject` for downloading the\nobject, which internally uses `getObject`.\n\nAlso,\n\n- Enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.\n- Moved the class `ServerSideEncryptionWithCustomerKey` outside of\n`ServerSideEncryption` and made it into a standalone class.", "committedDate": "2020-05-28T11:43:31Z", "type": "forcePushed"}, {"oid": "f8b7cc4c0a2d949abdc4edb6ed31dc98b9ce8e15", "url": "https://github.com/minio/minio-java/commit/f8b7cc4c0a2d949abdc4edb6ed31dc98b9ce8e15", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - fileName (String)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SsecObjectArgs`\nthat supports the `ssec` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `downloadObject` for downloading the\nobject, which internally uses `getObject`.\n\nAlso,\n\n- Enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.\n- Moved the class `ServerSideEncryptionWithCustomerKey` outside of\n`ServerSideEncryption` and made it into a standalone class.", "committedDate": "2020-05-28T11:53:22Z", "type": "forcePushed"}, {"oid": "4ca8a00165d54c2c22a77701c89d78fd2d608562", "url": "https://github.com/minio/minio-java/commit/4ca8a00165d54c2c22a77701c89d78fd2d608562", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - fileName (String)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SsecObjectArgs`\nthat supports the `ssec` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `downloadObject` for downloading the\nobject, which internally uses `getObject`. And created a separate args\nclass `DownloadObjectArgs` for it.\n\nAlso,\n\n- Enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.\n- Moved the class `ServerSideEncryptionWithCustomerKey` outside of\n`ServerSideEncryption` and made it into a standalone class.", "committedDate": "2020-05-28T18:05:35Z", "type": "forcePushed"}, {"oid": "7ac6acf1850f1c9d92f21b2abfbd024fedc80844", "url": "https://github.com/minio/minio-java/commit/7ac6acf1850f1c9d92f21b2abfbd024fedc80844", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SsecObjectArgs`\nthat supports the `ssec` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `downloadObject` for downloading the\nobject, which internally uses `getObject`. And created a separate args\nclass `DownloadObjectArgs` for it.\n\nAlso,\n\n- Enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.\n- Moved the class `ServerSideEncryptionWithCustomerKey` outside of\n`ServerSideEncryption` and made it into a standalone class.", "committedDate": "2020-05-28T18:23:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1MTA3NQ==", "url": "https://github.com/minio/minio-java/pull/954#discussion_r432251075", "bodyText": "This is still ssec. You could revert this change.", "author": "balamurugana", "createdAt": "2020-05-29T04:37:01Z", "path": "api/src/main/java/io/minio/MinioClient.java", "diffHunk": "@@ -1626,7 +1626,7 @@ public ObjectStat statObject(String bucketName, String objectName)\n    *\n    * <pre>Example:{@code\n    * ObjectStat objectStat =\n-   *     minioClient.statObject(\"my-bucketname\", \"my-objectname\", ssec);\n+   *     minioClient.statObject(\"my-bucketname\", \"my-objectname\", sse);", "originalCommit": "7ac6acf1850f1c9d92f21b2abfbd024fedc80844", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM4NzU2OA==", "url": "https://github.com/minio/minio-java/pull/954#discussion_r432387568", "bodyText": "Will revert", "author": "anjalshireesh", "createdAt": "2020-05-29T10:09:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1MTA3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1MTQ3NA==", "url": "https://github.com/minio/minio-java/pull/954#discussion_r432251474", "bodyText": "Is it a good idea to have this check inside checkArgs()?", "author": "balamurugana", "createdAt": "2020-05-29T04:38:47Z", "path": "api/src/main/java/io/minio/MinioClient.java", "diffHunk": "@@ -1713,7 +1714,7 @@ public ObjectStat statObject(StatObjectArgs args)\n           InternalException, InvalidBucketNameException, InvalidKeyException,\n           InvalidResponseException, IOException, NoSuchAlgorithmException, XmlParserException {\n     checkArgs(args);\n-    checkReadRequestSse(args.ssec());\n+    args.validateSsec(baseUrl);", "originalCommit": "7ac6acf1850f1c9d92f21b2abfbd024fedc80844", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM4ODU3Nw==", "url": "https://github.com/minio/minio-java/pull/954#discussion_r432388577", "bodyText": "checkArgs accepts the base class BaseArgs, so the validateSsec() method which is defined in SsecObjectArgs won't be available there.", "author": "anjalshireesh", "createdAt": "2020-05-29T10:11:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1MTQ3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1MjAxNA==", "url": "https://github.com/minio/minio-java/pull/954#discussion_r432252014", "bodyText": "Are these constants still needed?", "author": "balamurugana", "createdAt": "2020-05-29T04:41:12Z", "path": "api/src/main/java/io/minio/SsecObjectArgs.java", "diffHunk": "@@ -0,0 +1,49 @@\n+/*\n+ * MinIO Java SDK for Amazon S3 Compatible Cloud Storage, (C) 2020 MinIO, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.minio;\n+\n+import okhttp3.HttpUrl;\n+\n+public abstract class SsecObjectArgs extends ObjectArgs {\n+  protected ServerSideEncryptionCustomerKey ssec;\n+  public static final int TYPE_READ = 0;\n+  public static final int TYPE_WRITE = 1;", "originalCommit": "7ac6acf1850f1c9d92f21b2abfbd024fedc80844", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM4OTI5OQ==", "url": "https://github.com/minio/minio-java/pull/954#discussion_r432389299", "bodyText": "Not required! Thanks, will remove.", "author": "anjalshireesh", "createdAt": "2020-05-29T10:13:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1MjAxNA=="}], "type": "inlineReview"}, {"oid": "81c40c1834673d54ceddc1f9c722d329d8aea73f", "url": "https://github.com/minio/minio-java/commit/81c40c1834673d54ceddc1f9c722d329d8aea73f", "message": "Implement Args builder for getObject API\n\nNew Argument class: `GetObjectArgs`\n\nArguments supported:\n - offset (Long)\n - length (Long)\n - ssec (ServerSideEncryptionWithCustomerKey)\n\nSince there are multiple APIs / args classes that need sse as an\nargument, introduced an intermediate abstract class `SsecObjectArgs`\nthat supports the `ssec` argument, and provides common logic related to\nit e.g. validations.\n\nSince the return type of the methods that support downloading the\nobject as a file is `void`, we cannot name it same as `getObject`. So\nintroduced a new method called `downloadObject` for downloading the\nobject, which internally uses `getObject`. And created a separate args\nclass `DownloadObjectArgs` for it.\n\nAlso,\n\n- Enhanced the method `FunctionalTest#handleException` to support\nlogging of the arguments as well.\n- Moved the class `ServerSideEncryptionWithCustomerKey` outside of\n`ServerSideEncryption` and made it into a standalone class.", "committedDate": "2020-05-29T09:41:30Z", "type": "commit"}, {"oid": "b0802f5f27c181b9f0c4c54c03a9d0bf138d2200", "url": "https://github.com/minio/minio-java/commit/b0802f5f27c181b9f0c4c54c03a9d0bf138d2200", "message": "Incorporate review comments\n\n- Change `sse` to `ssec` in javadoc comments on stateObject\n- Remove unused static variables from `SsecObjectArgs`", "committedDate": "2020-05-29T10:17:00Z", "type": "commit"}, {"oid": "b0802f5f27c181b9f0c4c54c03a9d0bf138d2200", "url": "https://github.com/minio/minio-java/commit/b0802f5f27c181b9f0c4c54c03a9d0bf138d2200", "message": "Incorporate review comments\n\n- Change `sse` to `ssec` in javadoc comments on stateObject\n- Remove unused static variables from `SsecObjectArgs`", "committedDate": "2020-05-29T10:17:00Z", "type": "forcePushed"}]}