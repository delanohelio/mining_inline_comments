{"pr_number": 5413, "pr_title": "[TE] alerts search and pagination endpoint", "pr_createdAt": "2020-05-19T18:49:11Z", "pr_url": "https://github.com/apache/pinot/pull/5413", "timeline": [{"oid": "dc2e563ba91554146a577e36aabb28c79d707360", "url": "https://github.com/apache/pinot/commit/dc2e563ba91554146a577e36aabb28c79d707360", "message": "[TE] alerts search and pagination endpoint", "committedDate": "2020-05-19T18:47:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY5MzUyOA==", "url": "https://github.com/apache/pinot/pull/5413#discussion_r427693528", "bodyText": "I understand that we might not need ordering by other columns. Could we pass these as parameters in case we need to do it?", "author": "vincentchenjl", "createdAt": "2020-05-20T01:38:32Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/datalayer/util/SqlQueryBuilder.java", "diffHunk": "@@ -338,6 +338,46 @@ public PreparedStatement createFindByParamsStatement(Connection connection,\n     return prepareStatement;\n   }\n \n+  public PreparedStatement createfindByParamsStatementWithLimit(Connection connection,\n+      Class<? extends AbstractEntity> entityClass, Predicate predicate, Long limit, Long offset) throws Exception {\n+    String tableName = entityMappingHolder.tableToEntityNameMap.inverse().get(entityClass.getSimpleName());\n+    BiMap<String, String> entityNameToDBNameMapping =\n+        entityMappingHolder.columnMappingPerTable.get(tableName).inverse();\n+    StringBuilder sqlBuilder = new StringBuilder(\"SELECT * FROM \" + tableName);\n+    StringBuilder whereClause = new StringBuilder(\" WHERE \");\n+    List<Pair<String, Object>> parametersList = new ArrayList<>();\n+    generateWhereClause(entityNameToDBNameMapping, predicate, parametersList, whereClause);\n+    sqlBuilder.append(whereClause.toString());\n+    sqlBuilder.append(\" ORDER BY id DESC\");", "originalCommit": "dc2e563ba91554146a577e36aabb28c79d707360", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODI4ODEzMA==", "url": "https://github.com/apache/pinot/pull/5413#discussion_r428288130", "bodyText": "Good point. I plan to add this and add the \"SORT BY\" functionality in the endpoint in a separate PR if needed.", "author": "jihaozh", "createdAt": "2020-05-20T20:28:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY5MzUyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODI5NDMxNw==", "url": "https://github.com/apache/pinot/pull/5413#discussion_r428294317", "bodyText": "Why we need to order by other columns? id is unique.", "author": "xiaohui-sun", "createdAt": "2020-05-20T20:40:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY5MzUyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMxMDg0Mw==", "url": "https://github.com/apache/pinot/pull/5413#discussion_r428310843", "bodyText": "Yes. the id should be good enough for this. Unless we want to sort the result by other columns like names, etc.", "author": "jihaozh", "createdAt": "2020-05-20T21:13:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY5MzUyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMxMTUzNg==", "url": "https://github.com/apache/pinot/pull/5413#discussion_r428311536", "bodyText": "sort by id desc would be a good default since it will show the latest created alerts in the first page by default.", "author": "xiaohui-sun", "createdAt": "2020-05-20T21:15:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY5MzUyOA=="}], "type": "inlineReview"}]}