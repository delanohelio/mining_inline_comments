{"pr_number": 6192, "pr_title": "Reduce number of sql queries from 10k to 500 in pinot-integration-tests module", "pr_createdAt": "2020-10-26T22:22:42Z", "pr_url": "https://github.com/apache/pinot/pull/6192", "timeline": [{"oid": "dfb7fdeb912fbf771b8cfe6dc475da4d32fdc1ed", "url": "https://github.com/apache/pinot/commit/dfb7fdeb912fbf771b8cfe6dc475da4d32fdc1ed", "message": "Reduce number of sql queries from 10k to 500 in pinot-integration-tests module", "committedDate": "2020-10-27T03:52:00Z", "type": "commit"}, {"oid": "dfb7fdeb912fbf771b8cfe6dc475da4d32fdc1ed", "url": "https://github.com/apache/pinot/commit/dfb7fdeb912fbf771b8cfe6dc475da4d32fdc1ed", "message": "Reduce number of sql queries from 10k to 500 in pinot-integration-tests module", "committedDate": "2020-10-27T03:52:00Z", "type": "forcePushed"}, {"oid": "fe3ca033ac194795d2aa48fbfb1f7cd7227e6ea1", "url": "https://github.com/apache/pinot/commit/fe3ca033ac194795d2aa48fbfb1f7cd7227e6ea1", "message": "Decorate sql queries", "committedDate": "2020-10-27T17:42:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxNzQzMQ==", "url": "https://github.com/apache/pinot/pull/6192#discussion_r513817431", "bodyText": "Can you add the issue number here? thanks", "author": "mcvsubbu", "createdAt": "2020-10-28T23:17:27Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/integration/tests/ClusterIntegrationTestUtils.java", "diffHunk": "@@ -859,7 +859,9 @@ static void testSqlQuery(String pinotQuery, String brokerUrl, org.apache.pinot.c\n     BrokerRequest brokerRequest =\n         PinotQueryParserFactory.get(CommonConstants.Broker.Request.SQL).compileToBrokerRequest(pinotQuery);\n     if (isSelectionQuery(brokerRequest)) { // selection\n-      // TODO: compare results for selection queries, w/o order by\n+      // TODO: 1. compare results for selection queries, w/o order by.\n+      //       2. validate values of multi-value columns.\n+      //       3. remove the restriction that order by column has to be in selection clause.", "originalCommit": "fe3ca033ac194795d2aa48fbfb1f7cd7227e6ea1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxOTU5Ng==", "url": "https://github.com/apache/pinot/pull/6192#discussion_r513819596", "bodyText": "I can add the issue number in the commit.", "author": "jackjlli", "createdAt": "2020-10-28T23:23:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxNzQzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxODA1MQ==", "url": "https://github.com/apache/pinot/pull/6192#discussion_r513818051", "bodyText": "Why not make this \"sql\"? We will phase out pql anyway, so we can start doing this via sql all ths time?", "author": "mcvsubbu", "createdAt": "2020-10-28T23:19:19Z", "path": "pinot-integration-tests/src/test/java/org/apache/pinot/integration/tests/BaseClusterIntegrationTest.java", "diffHunk": "@@ -478,7 +479,8 @@ protected void stopKafka() {\n    */\n   protected long getCurrentCountStarResult()\n       throws Exception {\n-    return getPinotConnection().execute(\"SELECT COUNT(*) FROM \" + getTableName()).getResultSet(0).getLong(0);\n+    return getPinotConnection().execute(new Request(\"pql\", \"SELECT COUNT(*) FROM \" + getTableName())).getResultSet(0)", "originalCommit": "fe3ca033ac194795d2aa48fbfb1f7cd7227e6ea1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxOTE5NQ==", "url": "https://github.com/apache/pinot/pull/6192#discussion_r513819195", "bodyText": "Ah ok, looks like this is deprecated.", "author": "mcvsubbu", "createdAt": "2020-10-28T23:22:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgxODA1MQ=="}], "type": "inlineReview"}]}