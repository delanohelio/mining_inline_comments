{"pr_number": 5006, "pr_title": "Add FieldConfig to encapsulate a column's encoding and indexing info", "pr_createdAt": "2020-01-23T08:22:04Z", "pr_url": "https://github.com/apache/pinot/pull/5006", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MzI3MA==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r369983270", "bodyText": "what is @ Null, is it suppose to be @ Nullable?", "author": "kishoreg", "createdAt": "2020-01-23T08:29:11Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/config/TableConfig.java", "diffHunk": "@@ -82,7 +88,8 @@ public TableConfig() {\n   private TableConfig(String tableName, TableType tableType, SegmentsValidationAndRetentionConfig validationConfig,\n       TenantConfig tenantConfig, IndexingConfig indexingConfig, TableCustomConfig customConfig,\n       @Nullable QuotaConfig quotaConfig, @Nullable TableTaskConfig taskConfig, @Nullable RoutingConfig routingConfig,\n-      @Nullable Map<InstancePartitionsType, InstanceAssignmentConfig> instanceAssignmentConfigMap) {\n+      @Nullable Map<InstancePartitionsType, InstanceAssignmentConfig> instanceAssignmentConfigMap,\n+      @Null List<FieldConfig> fieldConfigList) {", "originalCommit": "1fe6f9baec4c22093ccc14315a1ea9e2ab91c932", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4NDUzMA==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r369984530", "bodyText": "Yes that was a typo.", "author": "siddharthteotia", "createdAt": "2020-01-23T08:32:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MzI3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NzcyNA==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370277724", "bodyText": "Should we use dictionary encoding by default?", "author": "Jackie-Jiang", "createdAt": "2020-01-23T18:17:07Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/config/FieldConfig.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.common.config;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.Properties;\n+import javax.annotation.Nullable;\n+\n+\n+public class FieldConfig extends BaseJsonConfig {\n+  private String _name;\n+  private EncodingType _encodingType;\n+  private IndexType _indexType;\n+  private Properties _properties;\n+\n+  @JsonCreator\n+  FieldConfig (@JsonProperty(value = \"name\", required = true) String name,\n+      @JsonProperty(value = \"encodingType\") @Nullable EncodingType encodingType,\n+      @JsonProperty(value = \"indexType\") @Nullable IndexType indexType,\n+      @JsonProperty(value = \"properties\") @Nullable Properties properties) {\n+    _name = name;\n+    _encodingType = encodingType;\n+    _indexType = indexType;\n+    _properties = properties;\n+  }\n+\n+  // If null, we will create raw forward index", "originalCommit": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEyNTg0OA==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r376125848", "bodyText": "Yes. Done", "author": "siddharthteotia", "createdAt": "2020-02-06T22:49:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3NzcyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3OTI4MA==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370279280", "bodyText": "Make them final?", "author": "Jackie-Jiang", "createdAt": "2020-01-23T18:20:07Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/config/FieldConfig.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.common.config;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.Properties;\n+import javax.annotation.Nullable;\n+\n+\n+public class FieldConfig extends BaseJsonConfig {\n+  private String _name;", "originalCommit": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEyNTgzMQ==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r376125831", "bodyText": "Done", "author": "siddharthteotia", "createdAt": "2020-02-06T22:49:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3OTI4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3OTk2MA==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370279960", "bodyText": "public?\nAlso need to reformat", "author": "Jackie-Jiang", "createdAt": "2020-01-23T18:21:34Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/config/FieldConfig.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.common.config;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.Properties;\n+import javax.annotation.Nullable;\n+\n+\n+public class FieldConfig extends BaseJsonConfig {\n+  private String _name;\n+  private EncodingType _encodingType;\n+  private IndexType _indexType;\n+  private Properties _properties;\n+\n+  @JsonCreator\n+  FieldConfig (@JsonProperty(value = \"name\", required = true) String name,", "originalCommit": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEyNTgwNQ==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r376125805", "bodyText": "done", "author": "siddharthteotia", "createdAt": "2020-02-06T22:49:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI3OTk2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyNDc0Mg==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370324742", "bodyText": "Equivalent to childConfigNode.isContainerNode()", "author": "Jackie-Jiang", "createdAt": "2020-01-23T19:57:28Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/config/TableConfig.java", "diffHunk": "@@ -157,7 +168,7 @@ public static TableConfig fromJsonConfig(JsonNode jsonConfig)\n     if (childConfigNode == null || childConfigNode.isNull()) {\n       return null;\n     }\n-    if (childConfigNode.isObject()) {\n+    if (childConfigNode.isObject() || childConfigNode instanceof ArrayNode) {", "originalCommit": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEyNTc5NA==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r376125794", "bodyText": "Done", "author": "siddharthteotia", "createdAt": "2020-02-06T22:49:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyNDc0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyNDgwMg==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370324802", "bodyText": "Same here", "author": "Jackie-Jiang", "createdAt": "2020-01-23T19:57:37Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/config/TableConfig.java", "diffHunk": "@@ -177,7 +188,7 @@ public static TableConfig fromJsonConfig(JsonNode jsonConfig)\n     if (childConfigNode == null || childConfigNode.isNull()) {\n       return null;\n     }\n-    if (childConfigNode.isObject()) {\n+    if (childConfigNode.isObject() || childConfigNode instanceof ArrayNode) {", "originalCommit": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEyNTc3OA==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r376125778", "bodyText": "Done", "author": "siddharthteotia", "createdAt": "2020-02-06T22:49:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMyNDgwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0ODE5MQ==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r370348191", "bodyText": "I don't think we need the functionalities provided by Properties class, maybe Map<String, String> is enough?", "author": "Jackie-Jiang", "createdAt": "2020-01-23T20:52:47Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/config/FieldConfig.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.pinot.common.config;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.Properties;\n+import javax.annotation.Nullable;\n+\n+\n+public class FieldConfig extends BaseJsonConfig {\n+  private String _name;\n+  private EncodingType _encodingType;\n+  private IndexType _indexType;\n+  private Properties _properties;", "originalCommit": "4bf43a575fe8b6abb31c70763e2f2906bd7b28c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjEyNTc2Ng==", "url": "https://github.com/apache/pinot/pull/5006#discussion_r376125766", "bodyText": "Yes, Map<String, String> is enough. Properties is more for saving to file.", "author": "siddharthteotia", "createdAt": "2020-02-06T22:49:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0ODE5MQ=="}], "type": "inlineReview"}, {"oid": "c061a9ec888584ab2bcb5a45d11340603791ce38", "url": "https://github.com/apache/pinot/commit/c061a9ec888584ab2bcb5a45d11340603791ce38", "message": "Add FieldConfig. TableConfig can take a list of FieldConfig\nto encapsulate storage, indexing and any other information for a field.", "committedDate": "2020-02-06T01:11:20Z", "type": "commit"}, {"oid": "c061a9ec888584ab2bcb5a45d11340603791ce38", "url": "https://github.com/apache/pinot/commit/c061a9ec888584ab2bcb5a45d11340603791ce38", "message": "Add FieldConfig. TableConfig can take a list of FieldConfig\nto encapsulate storage, indexing and any other information for a field.", "committedDate": "2020-02-06T01:11:20Z", "type": "forcePushed"}]}