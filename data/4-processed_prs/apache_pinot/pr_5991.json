{"pr_number": 5991, "pr_title": "[TE] Moved interfaces and datalayer to a new thirdeye-spi module.", "pr_createdAt": "2020-09-09T18:19:06Z", "pr_url": "https://github.com/apache/pinot/pull/5991", "timeline": [{"oid": "7e6782d1cea65820664e8284e29716f48f03d437", "url": "https://github.com/apache/pinot/commit/7e6782d1cea65820664e8284e29716f48f03d437", "message": "[TE] Moved interfaces and datalayer to a new thirdeye-spi module.\n\nThe spi module is intended to be the parent module for all downstream thirdeye consumers. This is part of a multi-phase module refactor.", "committedDate": "2020-09-09T18:24:40Z", "type": "commit"}, {"oid": "8562b017f665c4ebd6dfeb8df7133dab188333c9", "url": "https://github.com/apache/pinot/commit/8562b017f665c4ebd6dfeb8df7133dab188333c9", "message": "[TE] Moving constants from DataFrameUtils to DataFrame", "committedDate": "2020-09-09T18:24:40Z", "type": "commit"}, {"oid": "266ce905a85a7d7f8989500f825227ff4da55731", "url": "https://github.com/apache/pinot/commit/266ce905a85a7d7f8989500f825227ff4da55731", "message": "[TE] Moved more classes to spi. Removed shallow dependencies", "committedDate": "2020-09-09T18:24:40Z", "type": "commit"}, {"oid": "38eca72a4ece77345960536552ca496ecf876887", "url": "https://github.com/apache/pinot/commit/38eca72a4ece77345960536552ca496ecf876887", "message": "[TE] Fixed all compilation errors in thirdeye-spi", "committedDate": "2020-09-09T18:24:40Z", "type": "commit"}, {"oid": "be2d1e1b0ef78906e861cd21c4c056b764dc6dea", "url": "https://github.com/apache/pinot/commit/be2d1e1b0ef78906e861cd21c4c056b764dc6dea", "message": "[TE] Deleting unused class", "committedDate": "2020-09-09T18:24:40Z", "type": "commit"}, {"oid": "be2d1e1b0ef78906e861cd21c4c056b764dc6dea", "url": "https://github.com/apache/pinot/commit/be2d1e1b0ef78906e861cd21c4c056b764dc6dea", "message": "[TE] Deleting unused class", "committedDate": "2020-09-09T18:24:40Z", "type": "forcePushed"}, {"oid": "5e7e04e54663a87b2dbb68d8d1fd0f3cde98e551", "url": "https://github.com/apache/pinot/commit/5e7e04e54663a87b2dbb68d8d1fd0f3cde98e551", "message": "[TE] Created thirdeye-spi\n\nBuild fixes.", "committedDate": "2020-09-09T18:47:02Z", "type": "commit"}, {"oid": "a37c3544d5008be5b32508e23375bc6883aa6796", "url": "https://github.com/apache/pinot/commit/a37c3544d5008be5b32508e23375bc6883aa6796", "message": "[TE] Created thirdeye-spi\n\nBuild fixes.", "committedDate": "2020-09-09T19:03:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU3ODMxOA==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486578318", "bodyText": "You can use StringUtils from the commons.lang3?", "author": "akshayrai", "createdAt": "2020-09-10T19:17:20Z", "path": "thirdeye/thirdeye-spi/src/main/java/org/apache/pinot/thirdeye/datalayer/pojo/AlertConfigBean.java", "diffHunk": "@@ -211,7 +211,7 @@ public String toString() {\n     String properties;\n \n     public String getType() {\n-      if (StringUtil.isBlank(type)) {\n+      if (isBlank(type)) {", "originalCommit": "a37c3544d5008be5b32508e23375bc6883aa6796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY5MjQ5Mg==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486692492", "bodyText": "Thanks. I'll replace it.", "author": "suvodeep-pyne", "createdAt": "2020-09-10T23:43:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU3ODMxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4MDE1Mw==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486580153", "bodyText": "Why move this?", "author": "akshayrai", "createdAt": "2020-09-10T19:20:39Z", "path": "thirdeye/thirdeye-spi/src/main/java/org/apache/pinot/thirdeye/datalayer/dto/AlertSnapshotDTO.java", "diffHunk": "@@ -80,48 +75,6 @@ public void setSnapshot(Multimap<String, AnomalyNotifiedStatus> snapshot) {\n     }\n   }\n \n-  public void updateSnapshot(DateTime alertTime, List<MergedAnomalyResultDTO> alertedAnomalies) {", "originalCommit": "a37c3544d5008be5b32508e23375bc6883aa6796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY5MDgyNQ==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486690825", "bodyText": "primarily to disentangle the code. This class used to depend on a Resource! And this method is used in a single place.", "author": "suvodeep-pyne", "createdAt": "2020-09-10T23:37:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4MDE1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4MTU5MQ==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486581591", "bodyText": "Can you move these classes instead of deleting and recreating a new one?", "author": "akshayrai", "createdAt": "2020-09-10T19:23:33Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/datalayer/dto/OnlineDetectionDataDTO.java", "diffHunk": "@@ -1,6 +0,0 @@\n-package org.apache.pinot.thirdeye.datalayer.dto;", "originalCommit": "a37c3544d5008be5b32508e23375bc6883aa6796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY5MTA3NQ==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486691075", "bodyText": "This is all done by Intellij. Some of these classes also had code changes which resulted in it showing up as create/delete instead of move. But as such all the classes were git \"moved\".", "author": "suvodeep-pyne", "createdAt": "2020-09-10T23:38:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4MTU5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4NDE3MA==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486584170", "bodyText": "I think this is needed for the travis build!\n+@vincentchenjl  FYI", "author": "akshayrai", "createdAt": "2020-09-10T19:28:37Z", "path": "thirdeye/pom.xml", "diffHunk": "@@ -22,17 +22,18 @@\n   <modelVersion>4.0.0</modelVersion>\n   <groupId>org.apache.pinot.thirdeye</groupId>\n   <artifactId>thirdeye</artifactId>\n-  <version>${revision}${sha1}</version>", "originalCommit": "a37c3544d5008be5b32508e23375bc6883aa6796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY5MTU4MA==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486691580", "bodyText": "I'll restore this. This has nothing to do with the current refactor.\nBut it seems like the build worked fine. As such haven't really found versions to be used in TE. Also, the docker images uses its own versioning.\nI made these changes initially just to make IntelliJ happy. There seems to be a bug when using properties in parent   section. https://youtrack.jetbrains.com/issue/IDEA-179451", "author": "suvodeep-pyne", "createdAt": "2020-09-10T23:40:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4NDE3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4NTAyOA==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486585028", "bodyText": "Why lower the version? Shouldn't this be 2.0.0?", "author": "akshayrai", "createdAt": "2020-09-10T19:30:18Z", "path": "thirdeye/pom.xml", "diffHunk": "@@ -22,17 +22,18 @@\n   <modelVersion>4.0.0</modelVersion>\n   <groupId>org.apache.pinot.thirdeye</groupId>\n   <artifactId>thirdeye</artifactId>\n-  <version>${revision}${sha1}</version>\n+  <version>0.1.0-SNAPSHOT</version>\n   <packaging>pom</packaging>\n   <name>thirdeye</name>\n \n   <modules>\n     <module>thirdeye-frontend</module>\n+    <module>thirdeye-spi</module>\n     <module>thirdeye-pinot</module>\n   </modules>\n \n   <properties>\n-    <revision>1.0.0</revision>\n+    <revision>0.1.0</revision>", "originalCommit": "a37c3544d5008be5b32508e23375bc6883aa6796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY5MjAwNg==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486692006", "bodyText": "I'm restoring the version changes. I think this will be driven more from a marketing standpoint. Calling it 2.0 simply raises expectations when we are not providing any additional functionality.", "author": "suvodeep-pyne", "createdAt": "2020-09-10T23:41:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4NTAyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4NjMwOA==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486586308", "bodyText": "Wouldn't it be better to define this at the respective levels? These are not required across all the modules right!", "author": "akshayrai", "createdAt": "2020-09-10T19:32:34Z", "path": "thirdeye/pom.xml", "diffHunk": "@@ -543,6 +550,17 @@\n         <artifactId>log4j-slf4j-impl</artifactId>\n         <version>${log4j2.version}</version>\n       </dependency>\n+      <dependency>\n+        <groupId>org.apache.commons</groupId>\n+        <artifactId>commons-lang3</artifactId>\n+        <version>${commons-lang3.version}</version>\n+      </dependency>\n+      <dependency>\n+        <groupId>org.apache.commons</groupId>\n+        <artifactId>commons-math</artifactId>\n+        <version>2.1</version>\n+      </dependency>", "originalCommit": "a37c3544d5008be5b32508e23375bc6883aa6796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY5MjQ0Nw==", "url": "https://github.com/apache/pinot/pull/5991#discussion_r486692447", "bodyText": "It is defined in this manner even in pinot. Didn't want to change the existing convention. As such I find maven to be extremely verbose. But I do agree and want to simplify the dependencies. I'm already working on that in a separate branch. But I'm keeping this unchanged in this PR since it is already huge!", "author": "suvodeep-pyne", "createdAt": "2020-09-10T23:43:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4NjMwOA=="}], "type": "inlineReview"}, {"oid": "861d7e8d176f3f11a307fe1ae71d1c6e79d0ccb5", "url": "https://github.com/apache/pinot/commit/861d7e8d176f3f11a307fe1ae71d1c6e79d0ccb5", "message": "[TE] Refactor. Using StringUtils from commons-lang3", "committedDate": "2020-09-10T23:47:16Z", "type": "commit"}, {"oid": "42dd22bd5f966b5cc7793db52169796058855562", "url": "https://github.com/apache/pinot/commit/42dd22bd5f966b5cc7793db52169796058855562", "message": "[TE] Restoring version in pom files", "committedDate": "2020-09-10T23:47:47Z", "type": "commit"}]}