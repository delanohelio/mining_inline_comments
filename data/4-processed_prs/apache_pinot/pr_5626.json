{"pr_number": 5626, "pr_title": "[TE] alert search - search by both metrics and datasets", "pr_createdAt": "2020-06-26T18:58:27Z", "pr_url": "https://github.com/apache/pinot/pull/5626", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQxNDcyNA==", "url": "https://github.com/apache/pinot/pull/5626#discussion_r446414724", "bodyText": "Can we have comments somewhere to make it clear that we are using AND or OR relationship between filters?", "author": "vincentchenjl", "createdAt": "2020-06-26T21:19:03Z", "path": "thirdeye/thirdeye-pinot/src/main/java/org/apache/pinot/thirdeye/dashboard/resources/v2/alerts/AlertSearcher.java", "diffHunk": "@@ -194,15 +194,23 @@ public AlertSearcher() {\n     Set<Long> metricIds = new HashSet<>();\n     if (!searchFilter.getMetrics().isEmpty()) {\n       for (String metric : searchFilter.getMetrics()) {\n-        metricIds =\n-            this.metricDAO.findByMetricName(metric).stream().map(AbstractDTO::getId).collect(Collectors.toSet());\n+        metricIds.addAll(\n+            this.metricDAO.findByMetricName(metric).stream().map(AbstractDTO::getId).collect(Collectors.toSet()));\n       }\n     }\n \n     if (!searchFilter.getDatasets().isEmpty()) {\n+      Set<Long> metricIdsFromDataset = new HashSet<>();\n       for (String dataset : searchFilter.getDatasets()) {\n-        metricIds.retainAll(\n-            this.metricDAO.findByDataset(dataset).stream().map(AbstractDTO::getId).collect(Collectors.toSet()));\n+        metricIdsFromDataset.addAll(this.metricDAO.findByPredicate(Predicate.LIKE(\"dataset\", \"%\" + dataset + \"%\"))", "originalCommit": "b426baad2f209af14041167d569bb3e92871ea32", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzI5OTU5OA==", "url": "https://github.com/apache/pinot/pull/5626#discussion_r447299598", "bodyText": "sure. added the comments", "author": "jihaozh", "createdAt": "2020-06-29T22:39:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQxNDcyNA=="}], "type": "inlineReview"}, {"oid": "346af797ddcd513c5feecdf2d66f356c30e692d6", "url": "https://github.com/apache/pinot/commit/346af797ddcd513c5feecdf2d66f356c30e692d6", "message": "[TE] alert search - allow search by both metrics and datasets", "committedDate": "2020-06-29T21:32:40Z", "type": "commit"}, {"oid": "e86005847a155b066bcc0eeb4b158f142b193a51", "url": "https://github.com/apache/pinot/commit/e86005847a155b066bcc0eeb4b158f142b193a51", "message": "address comments", "committedDate": "2020-06-29T22:35:34Z", "type": "forcePushed"}, {"oid": "b77685baa56f0aeb5a0804b27e7084799c7e58e3", "url": "https://github.com/apache/pinot/commit/b77685baa56f0aeb5a0804b27e7084799c7e58e3", "message": "address comments", "committedDate": "2020-06-29T22:38:19Z", "type": "commit"}, {"oid": "b77685baa56f0aeb5a0804b27e7084799c7e58e3", "url": "https://github.com/apache/pinot/commit/b77685baa56f0aeb5a0804b27e7084799c7e58e3", "message": "address comments", "committedDate": "2020-06-29T22:38:19Z", "type": "forcePushed"}]}