{"pr_number": 6037, "pr_title": "Add list of allowed tables for emitting table level metrics", "pr_createdAt": "2020-09-19T01:43:59Z", "pr_url": "https://github.com/apache/pinot/pull/6037", "timeline": [{"oid": "0be2770e2b0b7d7d61216bae2051e60743551f74", "url": "https://github.com/apache/pinot/commit/0be2770e2b0b7d7d61216bae2051e60743551f74", "message": "Add whitelist for emitting table level metrics", "committedDate": "2020-09-19T01:16:03Z", "type": "commit"}, {"oid": "11cfe3eff1f4aa66b2706376f5ccd30efebc0fe2", "url": "https://github.com/apache/pinot/commit/11cfe3eff1f4aa66b2706376f5ccd30efebc0fe2", "message": "Change default value in AbstractMetrics", "committedDate": "2020-09-19T01:47:13Z", "type": "commit"}, {"oid": "3386e2d7bac7b51c6d2e45ad042f7eafac75e8d9", "url": "https://github.com/apache/pinot/commit/3386e2d7bac7b51c6d2e45ad042f7eafac75e8d9", "message": "Minor changes in comments", "committedDate": "2020-09-19T02:09:52Z", "type": "commit"}, {"oid": "86fab4ded8219a28be52a9da433d8a42d49bf6a6", "url": "https://github.com/apache/pinot/commit/86fab4ded8219a28be52a9da433d8a42d49bf6a6", "message": "whitelist tables -> allowed tables", "committedDate": "2020-09-19T02:32:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk1NDQxMQ==", "url": "https://github.com/apache/pinot/pull/6037#discussion_r492954411", "bodyText": "thanks for changing this name", "author": "mcvsubbu", "createdAt": "2020-09-22T18:40:07Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/metrics/AbstractMetrics.java", "diffHunk": "@@ -47,21 +53,36 @@\n \n   private final Map<String, AtomicLong> _gaugeValues = new ConcurrentHashMap<String, AtomicLong>();\n \n-  protected final boolean _global;\n+  private final boolean _isTableLevelMetricsEnabled;", "originalCommit": "86fab4ded8219a28be52a9da433d8a42d49bf6a6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk1OTkyMQ==", "url": "https://github.com/apache/pinot/pull/6037#discussion_r492959921", "bodyText": "I think you are trying to keep the new configs you introduced in the same place. It is unfortunate that we don't have a BrokerConf (as yet), but let us keep the server-specific configs in the ServerConf file instead of moving that up to common constants.", "author": "mcvsubbu", "createdAt": "2020-09-22T18:49:27Z", "path": "pinot-common/src/main/java/org/apache/pinot/common/utils/CommonConstants.java", "diffHunk": "@@ -279,7 +281,10 @@\n     }\n \n     public static final String DEFAULT_METRICS_PREFIX = \"pinot.server.\";\n-    public static final boolean DEFAULT_METRICS_GLOBAL_ENABLED = false;\n+    public static final String CONFIG_OF_ENABLE_TABLE_LEVEL_METRICS = \"pinot.server.enableTableLevelMetrics\";", "originalCommit": "86fab4ded8219a28be52a9da433d8a42d49bf6a6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAxOTc0NA==", "url": "https://github.com/apache/pinot/pull/6037#discussion_r493019744", "bodyText": "Other than keeping similar config in one place, there's also this todo in server conf: TODO: Replace with constants in CommonConstants.\nHaving said that the main reason to move to CommonConstant is that in the existing code, the default value for enabling table level metrics is defined in two places: ServerConf and CommonConstants. ServerConf lives in pinot-broker module and CommonConstant in pinot-common. Both are needed as ServerConf is used in ServerInstance defined in pinot-broker module and CommonConstant is used in ServerMetrics which is defined in pinot-common module.\nHaving it only defined in CommonConstant removes this duplicity.", "author": "sajjad-moradi", "createdAt": "2020-09-22T20:40:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk1OTkyMQ=="}], "type": "inlineReview"}]}