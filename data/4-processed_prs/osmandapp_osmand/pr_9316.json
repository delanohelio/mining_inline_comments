{"pr_number": 9316, "pr_title": "Add offset to OSM notes shape", "pr_createdAt": "2020-06-25T11:24:56Z", "pr_url": "https://github.com/osmandapp/OsmAnd/pull/9316", "timeline": [{"oid": "ec9f46f23379b85bba8eb766ebc6d23c8b8ec222", "url": "https://github.com/osmandapp/OsmAnd/commit/ec9f46f23379b85bba8eb766ebc6d23c8b8ec222", "message": "Add offset to shape", "committedDate": "2020-06-25T11:21:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUzMDU2OA==", "url": "https://github.com/osmandapp/OsmAnd/pull/9316#discussion_r445530568", "bodyText": "This is correct code and the change in this file should be reverted", "author": "vshcherb", "createdAt": "2020-06-25T12:47:51Z", "path": "OsmAnd/src/net/osmand/plus/osmedit/OsmBugsLayer.java", "diffHunk": "@@ -157,8 +157,9 @@ public void onPrepareBufferImage(Canvas canvas, RotatedTileBox tileBox, DrawSett\n \t\t\t\t\t}\n \t\t\t\t\tPointImageDrawable pointImageDrawable = PointImageDrawable.getOrCreate(activity,", "originalCommit": "ec9f46f23379b85bba8eb766ebc6d23c8b8ec222", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUzMTU5Mg==", "url": "https://github.com/osmandapp/OsmAnd/pull/9316#discussion_r445531592", "bodyText": "enum should be used with ==\nBad code, it should be used int offsetY = background.getOffset&(...)", "author": "vshcherb", "createdAt": "2020-06-25T12:49:37Z", "path": "OsmAnd/src/net/osmand/plus/views/ContextMenuLayer.java", "diffHunk": "@@ -233,14 +233,19 @@ public void onDraw(Canvas canvas, RotatedTileBox box, DrawSettings nightMode) {\n \t\t\tint x = (int) box.getPixXFromLatLon(latLon.getLatitude(), latLon.getLongitude());\n \t\t\tint y = (int) box.getPixYFromLatLon(latLon.getLatitude(), latLon.getLongitude());\n \t\t\tBitmap pressedBitmapSmall = getBackground(pressedLatLonSmall.get(latLon), true);\n-\t\t\tRect destRect = getIconDestinationRect(x, y, pressedBitmapSmall.getWidth(), pressedBitmapSmall.getHeight(), scale);\n+\t\t\tRect destRect = getIconDestinationRect(\n+\t\t\t\t\tx, y, pressedBitmapSmall.getWidth(), pressedBitmapSmall.getHeight(), scale);\n \t\t\tcanvas.drawBitmap(pressedBitmapSmall, null, destRect, paint);\n \t\t}\n \t\tfor (LatLon latLon : pressedLatLonFull.keySet()) {\n \t\t\tint x = (int) box.getPixXFromLatLon(latLon.getLatitude(), latLon.getLongitude());\n \t\t\tint y = (int) box.getPixYFromLatLon(latLon.getLatitude(), latLon.getLongitude());\n-\t\t\tBitmap pressedBitmap = getBackground(pressedLatLonFull.get(latLon), false);\n-\t\t\tRect destRect = getIconDestinationRect(x, y, pressedBitmap.getWidth(), pressedBitmap.getHeight(), scale);\n+\n+\t\t\tBackgroundType background = pressedLatLonFull.get(latLon);\n+\t\t\tBitmap pressedBitmap = getBackground(background, false);\n+\t\t\tint offsetY = BackgroundType.COMMENT.equals(background) ? pressedBitmap.getHeight() / 2 : 0;", "originalCommit": "ec9f46f23379b85bba8eb766ebc6d23c8b8ec222", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}