{"pr_number": 9290, "pr_title": "Fix PointImageDrawable vector to bitmap", "pr_createdAt": "2020-06-22T14:59:07Z", "pr_url": "https://github.com/osmandapp/OsmAnd/pull/9290", "timeline": [{"oid": "31dbe2c69a71523e280cb76d44bd31d2abc2d08a", "url": "https://github.com/osmandapp/OsmAnd/commit/31dbe2c69a71523e280cb76d44bd31d2abc2d08a", "message": "Fix vector to bitmap", "committedDate": "2020-06-22T14:57:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDExNjIyOQ==", "url": "https://github.com/osmandapp/OsmAnd/pull/9290#discussion_r444116229", "bodyText": "\u041f\u043e\u0447\u0435\u043c\u0443 \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u044b \u0432\u043d\u0443\u0442\u0440\u0438 \u043c\u0435\u0442\u043e\u0434\u0430???", "author": "vshcherb", "createdAt": "2020-06-23T10:15:00Z", "path": "OsmAnd/src/net/osmand/plus/base/PointImageDrawable.java", "diffHunk": "@@ -166,37 +170,51 @@ public void drawBitmap(@NonNull Canvas canvas, Rect bs, Bitmap bitmap, Paint pai\n \t}\n \n \tpublic void drawPoint(Canvas canvas, float x, float y, float scale, boolean history) {\n-\t\tif(scale != this.scale || this.favsize == 0) {\n-\t\t\tthis.scale = scale;\n-\t\t\tint pixels = (int) (dp_12_px * DEFAULT_SIZE_ON_MAP_DP / 12.0);\n-\t\t\tthis.favsize = Math.round(scale *  pixels / ICON_SIZE_VECTOR_PX) * ICON_SIZE_VECTOR_PX;\n-\t\t\tthis.backsize = (int) (scale *  getIntrinsicWidth());\n-\t\t}\n+\t\tsetScale(scale);\n \t\tthis.history = history;\n-\t\tRect rect = new Rect(0, 0, backsize , backsize );\n-\t\trect.offset((int) x - backsize / 2, (int) y - backsize / 2);\n+\t\tRect rect = new Rect(0, 0, backSize, backSize);\n+\t\trect.offset((int) x - backSize / 2, (int) y - backSize / 2);\n \t\tsetBounds(rect);\n-\t\tint offsetX = rect.centerX() - favsize / 2;\n-\t\tint offsetY = rect.centerY() - favsize / 2;\n-\t\tfavIcon.setBounds(offsetX, offsetY, (int) (offsetX + favsize),\n-\t\t\t\toffsetY + favsize);\n \t\tdraw(canvas);\n \t}\n \n+\tprivate void setScale(float scale) {\n+\t\tif (scale != this.scale || this.mapIconSize == 0) {\n+\t\t\tint DEFAULT_SIZE_ON_MAP_DP = 16;", "originalCommit": "31dbe2c69a71523e280cb76d44bd31d2abc2d08a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3035239e24c2ded8c446936280021925bdba3126", "url": "https://github.com/osmandapp/OsmAnd/commit/3035239e24c2ded8c446936280021925bdba3126", "message": "Fix constant", "committedDate": "2020-06-23T10:26:57Z", "type": "commit"}]}