{"pr_number": 4967, "pr_title": "B g fix", "pr_createdAt": "2020-08-28T17:11:07Z", "pr_url": "https://github.com/palantir/atlasdb/pull/4967", "timeline": [{"oid": "0fccc58c4a4dd64169942e458bf2e2b0169c554a", "url": "https://github.com/palantir/atlasdb/commit/0fccc58c4a4dd64169942e458bf2e2b0169c554a", "message": "Rate limit greening node's attempts to become leader", "committedDate": "2020-08-28T17:05:27Z", "type": "commit"}, {"oid": "566b6afab8366e48b0d783cf04a49d4b1132b370", "url": "https://github.com/palantir/atlasdb/commit/566b6afab8366e48b0d783cf04a49d4b1132b370", "message": "Remove", "committedDate": "2020-08-28T17:07:22Z", "type": "commit"}, {"oid": "997ee85cddb4f434bd8105a59c5b927d4940ed08", "url": "https://github.com/palantir/atlasdb/commit/997ee85cddb4f434bd8105a59c5b927d4940ed08", "message": "Add generated changelog entries", "committedDate": "2020-08-28T17:07:22Z", "type": "commit"}, {"oid": "4e4c7b53ef0ed12dfd74cb93d3d92f6f52ec8919", "url": "https://github.com/palantir/atlasdb/commit/4e4c7b53ef0ed12dfd74cb93d3d92f6f52ec8919", "message": "Fix", "committedDate": "2020-09-03T15:33:35Z", "type": "commit"}, {"oid": "e20c68b177127b1cfaf3bcbe0edc960f9267ca86", "url": "https://github.com/palantir/atlasdb/commit/e20c68b177127b1cfaf3bcbe0edc960f9267ca86", "message": "Merge branch 'b-g-fix' of github.com:palantir/atlasdb into b-g-fix", "committedDate": "2020-09-03T15:33:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzA3MTIyNQ==", "url": "https://github.com/palantir/atlasdb/pull/4967#discussion_r483071225", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                () -> greeningNodeShouldBecomeLeaderRateLimiter.tryAcquire());\n          \n          \n            \n                                greeningNodeShouldBecomeLeaderRateLimiter::tryAcquire);", "author": "jeremyk-91", "createdAt": "2020-09-03T15:35:02Z", "path": "leader-election-impl/src/main/java/com/palantir/paxos/SingleLeaderPinger.java", "diffHunk": "@@ -139,7 +142,10 @@ private LeaderPingResult actuallyPingLeaderWithUuid(\n             multiplexingCompletionService.submit(leader, pingEndpoint);\n             Future<Map.Entry<LeaderPingerContext<PingableLeader>, PingResult>> pingFuture\n                     = multiplexingCompletionService.poll(leaderPingResponseWait.toMillis(), TimeUnit.MILLISECONDS);\n-            return getLeaderPingResult(uuid, pingFuture, timeLockVersion);\n+            return getLeaderPingResult(uuid,\n+                    pingFuture,\n+                    timeLockVersion,\n+                    () -> greeningNodeShouldBecomeLeaderRateLimiter.tryAcquire());", "originalCommit": "e20c68b177127b1cfaf3bcbe0edc960f9267ca86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7a44cadd701a560fa80ff944ed907d72c757e09a", "url": "https://github.com/palantir/atlasdb/commit/7a44cadd701a560fa80ff944ed907d72c757e09a", "message": "Address comments", "committedDate": "2020-09-03T15:36:37Z", "type": "commit"}, {"oid": "fa5cc6aae86429789ff531d3eaa0c9a80bfb5b1f", "url": "https://github.com/palantir/atlasdb/commit/fa5cc6aae86429789ff531d3eaa0c9a80bfb5b1f", "message": "Add generated changelog entries", "committedDate": "2020-09-03T15:36:37Z", "type": "commit"}, {"oid": "85bd65eea25e94d530456bd1e7c864f046178892", "url": "https://github.com/palantir/atlasdb/commit/85bd65eea25e94d530456bd1e7c864f046178892", "message": "Add generated changelog entries", "committedDate": "2020-09-03T15:36:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzA3NTQ2OQ==", "url": "https://github.com/palantir/atlasdb/pull/4967#discussion_r483075469", "bodyText": "nit: I'd add why this was previously bad", "author": "jeremyk-91", "createdAt": "2020-09-03T15:41:15Z", "path": "changelog/@unreleased/pr-4967.v2.yml", "diffHunk": "@@ -0,0 +1,5 @@\n+type: improvement\n+improvement:\n+  description: A greening node's attempts to gain leadership are now rate limited.", "originalCommit": "7a44cadd701a560fa80ff944ed907d72c757e09a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}