{"pr_number": 4946, "pr_title": "Make PingResult java serializable", "pr_createdAt": "2020-08-14T13:34:33Z", "pr_url": "https://github.com/palantir/atlasdb/pull/4946", "timeline": [{"oid": "0bc6f784dc1fccb657d3b103d1efecde26b83916", "url": "https://github.com/palantir/atlasdb/commit/0bc6f784dc1fccb657d3b103d1efecde26b83916", "message": "Make PingResult java serializable", "committedDate": "2020-08-14T13:33:14Z", "type": "commit"}, {"oid": "92bfde3a2f0537972bf8da1f2296d7b91cc2598d", "url": "https://github.com/palantir/atlasdb/commit/92bfde3a2f0537972bf8da1f2296d7b91cc2598d", "message": "Add generated changelog entries", "committedDate": "2020-08-14T13:33:14Z", "type": "commit"}, {"oid": "511af06b8752dedaaa5f73deac6cdc2673ebb848", "url": "https://github.com/palantir/atlasdb/commit/511af06b8752dedaaa5f73deac6cdc2673ebb848", "message": "Test", "committedDate": "2020-08-14T15:10:36Z", "type": "commit"}, {"oid": "afaec9a96d2b78d230b8ac38e0335b397cb1cb73", "url": "https://github.com/palantir/atlasdb/commit/afaec9a96d2b78d230b8ac38e0335b397cb1cb73", "message": "Merge branch 'pingv2_fix' of github.com:palantir/atlasdb into pingv2_fix", "committedDate": "2020-08-14T15:11:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDcyNDA5MA==", "url": "https://github.com/palantir/atlasdb/pull/4946#discussion_r470724090", "bodyText": "Please use try-with-resources:\ntry (FileOutputStream fileOut = new FileOutputStream(...); \n        <same for ObjectOutputStream>) {\n   ...\n}", "author": "jeremyk-91", "createdAt": "2020-08-14T16:19:38Z", "path": "leader-election-impl/src/test/java/com/palantir/leader/PingResultTest.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * (c) Copyright 2020 Palantir Technologies Inc. All rights reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.palantir.leader;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import java.io.FileInputStream;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+import java.io.ObjectInputStream;\n+import java.io.ObjectOutputStream;\n+import java.util.Optional;\n+\n+import org.junit.Test;\n+\n+import com.palantir.sls.versions.OrderableSlsVersion;\n+\n+public class PingResultTest {\n+    @Test\n+    public void pingResultIsJavaSerializable() throws IOException, ClassNotFoundException {\n+        OrderableSlsVersion timeLockVersion = OrderableSlsVersion.valueOf(\"0.0.0\");\n+        PingResult pr = PingResult.builder().timeLockVersion(timeLockVersion)\n+                .isLeader(true).build();\n+        FileOutputStream fileOut = new FileOutputStream(\"test.ser\");\n+        ObjectOutputStream out = new ObjectOutputStream(fileOut);\n+        out.writeObject(pr);", "originalCommit": "afaec9a96d2b78d230b8ac38e0335b397cb1cb73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDcyNDE5Mg==", "url": "https://github.com/palantir/atlasdb/pull/4946#discussion_r470724192", "bodyText": "nit: Can we use a temporary folder so the file isn't lying around?", "author": "jeremyk-91", "createdAt": "2020-08-14T16:19:53Z", "path": "leader-election-impl/src/test/java/com/palantir/leader/PingResultTest.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * (c) Copyright 2020 Palantir Technologies Inc. All rights reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.palantir.leader;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import java.io.FileInputStream;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+import java.io.ObjectInputStream;\n+import java.io.ObjectOutputStream;\n+import java.util.Optional;\n+\n+import org.junit.Test;\n+\n+import com.palantir.sls.versions.OrderableSlsVersion;\n+\n+public class PingResultTest {\n+    @Test\n+    public void pingResultIsJavaSerializable() throws IOException, ClassNotFoundException {\n+        OrderableSlsVersion timeLockVersion = OrderableSlsVersion.valueOf(\"0.0.0\");\n+        PingResult pr = PingResult.builder().timeLockVersion(timeLockVersion)\n+                .isLeader(true).build();\n+        FileOutputStream fileOut = new FileOutputStream(\"test.ser\");\n+        ObjectOutputStream out = new ObjectOutputStream(fileOut);\n+        out.writeObject(pr);\n+        out.close();\n+        fileOut.close();", "originalCommit": "afaec9a96d2b78d230b8ac38e0335b397cb1cb73", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a1465c0a86cfde87289fe98b83b29bf952005463", "url": "https://github.com/palantir/atlasdb/commit/a1465c0a86cfde87289fe98b83b29bf952005463", "message": "Fix", "committedDate": "2020-08-14T16:27:47Z", "type": "commit"}, {"oid": "0ca294ac70696c25efe96616f52b9bfa71f2365d", "url": "https://github.com/palantir/atlasdb/commit/0ca294ac70696c25efe96616f52b9bfa71f2365d", "message": "clean", "committedDate": "2020-08-14T16:30:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDczMDYyNA==", "url": "https://github.com/palantir/atlasdb/pull/4946#discussion_r470730624", "bodyText": "note: if this was production code, you'd probably want to minimise the scopes of out and in. I'm fine with this for tests.", "author": "jeremyk-91", "createdAt": "2020-08-14T16:32:28Z", "path": "leader-election-impl/src/test/java/com/palantir/leader/PingResultTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * (c) Copyright 2020 Palantir Technologies Inc. All rights reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.palantir.leader;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+import java.io.ObjectInputStream;\n+import java.io.ObjectOutputStream;\n+import java.util.Optional;\n+\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TemporaryFolder;\n+\n+import com.palantir.sls.versions.OrderableSlsVersion;\n+\n+public class PingResultTest {\n+\n+    @Rule\n+    public TemporaryFolder tempFolder = new TemporaryFolder();\n+\n+    @Test\n+    public void pingResultIsJavaSerializable() throws IOException, ClassNotFoundException {\n+        OrderableSlsVersion timeLockVersion = OrderableSlsVersion.valueOf(\"0.27.0\");\n+        PingResult pr = PingResult.builder().timeLockVersion(timeLockVersion)\n+                .isLeader(true).build();\n+\n+        File file = tempFolder.newFile();\n+        try (ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(file));\n+                ObjectInputStream in = new ObjectInputStream(new FileInputStream(file))) {\n+            out.writeObject(pr);", "originalCommit": "0ca294ac70696c25efe96616f52b9bfa71f2365d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9e61902e5f1fbd1b0774aa5d73247a96deea948b", "url": "https://github.com/palantir/atlasdb/commit/9e61902e5f1fbd1b0774aa5d73247a96deea948b", "message": "clean", "committedDate": "2020-08-14T16:33:37Z", "type": "commit"}]}