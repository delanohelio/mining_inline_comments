{"pr_number": 4778, "pr_title": "[Dialogue] Part 6: Road to Multitenancy", "pr_createdAt": "2020-05-14T19:33:04Z", "pr_url": "https://github.com/palantir/atlasdb/pull/4778", "timeline": [{"oid": "284616f4b76a31332c2c51753de87a5ab2f9240f", "url": "https://github.com/palantir/atlasdb/commit/284616f4b76a31332c2c51753de87a5ab2f9240f", "message": "Wiring through TMs", "committedDate": "2020-05-14T17:18:43Z", "type": "commit"}, {"oid": "a66dc04020f5c3e4071241f572e82b74b3dbf7bd", "url": "https://github.com/palantir/atlasdb/commit/a66dc04020f5c3e4071241f572e82b74b3dbf7bd", "message": "Finish off", "committedDate": "2020-05-14T19:00:42Z", "type": "commit"}, {"oid": "cd590a9e88368910913454955a6784b00b4c197f", "url": "https://github.com/palantir/atlasdb/commit/cd590a9e88368910913454955a6784b00b4c197f", "message": ":hocho", "committedDate": "2020-05-14T19:03:22Z", "type": "commit"}, {"oid": "4e04ae0da49018f658eedbc8536b6aa205739a7f", "url": "https://github.com/palantir/atlasdb/commit/4e04ae0da49018f658eedbc8536b6aa205739a7f", "message": "Fix console", "committedDate": "2020-05-14T19:10:14Z", "type": "commit"}, {"oid": "0782fbbe1f8f9d0065d24cbd4983432f53392335", "url": "https://github.com/palantir/atlasdb/commit/0782fbbe1f8f9d0065d24cbd4983432f53392335", "message": "bleh", "committedDate": "2020-05-14T19:46:14Z", "type": "commit"}, {"oid": "f44df3d5c6be770064324fc38439673c5b251aa8", "url": "https://github.com/palantir/atlasdb/commit/f44df3d5c6be770064324fc38439673c5b251aa8", "message": "Add generated changelog entries", "committedDate": "2020-05-14T19:46:14Z", "type": "commit"}, {"oid": "d4eefbdecf2505f3f5513fa2fbd1d112fa16f9d6", "url": "https://github.com/palantir/atlasdb/commit/d4eefbdecf2505f3f5513fa2fbd1d112fa16f9d6", "message": "Add generated changelog entries", "committedDate": "2020-05-14T19:46:14Z", "type": "commit"}, {"oid": "b82607b3fb68536fff223b3268eb0373387351ac", "url": "https://github.com/palantir/atlasdb/commit/b82607b3fb68536fff223b3268eb0373387351ac", "message": "Add generated changelog entries", "committedDate": "2020-05-14T19:46:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY0NTk3NQ==", "url": "https://github.com/palantir/atlasdb/pull/4778#discussion_r425645975", "bodyText": "AtlasDbConfig is the wrong place, this should really be in TransactionManagers (and mark the method as 'deprecated').", "author": "j-baker", "createdAt": "2020-05-15T08:27:25Z", "path": "atlasdb-config/src/main/java/com/palantir/atlasdb/config/AtlasDbConfig.java", "diffHunk": "@@ -271,6 +272,16 @@ public int getDefaultLockTimeoutSeconds() {\n      */\n     public abstract Optional<TimestampCache> timestampCache();\n \n+    /**\n+     * If set, a {@link com.palantir.dialogue.clients.DialogueClients.ReloadingFactory} that a\n+     * {@link com.palantir.atlasdb.transaction.api.TransactionManager} based on this configuration should use.\n+     * This may be useful for ensuring that connection pools are shared between multitenant services, for instance.\n+     *\n+     * WARNING: Providing reloading factories to multiple distinct TimeLock servers may result in undefined\n+     * behaviour.\n+     */\n+    public abstract Optional<DialogueClients.ReloadingFactory> reloadingFactory();", "originalCommit": "d4eefbdecf2505f3f5513fa2fbd1d112fa16f9d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY0NjY1OQ==", "url": "https://github.com/palantir/atlasdb/pull/4778#discussion_r425646659", "bodyText": "AtlasDbConfig is json deserializable, this cannot actually be json deserialized to.", "author": "j-baker", "createdAt": "2020-05-15T08:28:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY0NTk3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY4NzM2NQ==", "url": "https://github.com/palantir/atlasdb/pull/4778#discussion_r425687365", "bodyText": "Hmm, yeah it did feel like a better TransactionManagers fit, though I originally dumped it in AtlasDbConfig because the shared timestamp cache is there. I\u2019ll move this across", "author": "jeremyk-91", "createdAt": "2020-05-15T09:42:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY0NTk3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY0NzIzOA==", "url": "https://github.com/palantir/atlasdb/pull/4778#discussion_r425647238", "bodyText": "Please don't use 'multitenant' in this context, the noun is already 'taken' so it's likely to be confusing.", "author": "j-baker", "createdAt": "2020-05-15T08:29:36Z", "path": "changelog/@unreleased/pr-4778.v2.yml", "diffHunk": "@@ -0,0 +1,8 @@\n+type: improvement\n+improvement:\n+  description: AtlasDB now allows users to pass in a `DialogueClients.ReloadingFactory`\n+    in install configuration. This is likely to be useful for multitenant users of", "originalCommit": "d4eefbdecf2505f3f5513fa2fbd1d112fa16f9d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a632169ff0d68750784e7ca31f6484a717d4c59a", "url": "https://github.com/palantir/atlasdb/commit/a632169ff0d68750784e7ca31f6484a717d4c59a", "message": "shift config block to TMs", "committedDate": "2020-05-15T11:22:11Z", "type": "commit"}, {"oid": "bfb9325fd66a9a7dda6784d25989c1da8966c610", "url": "https://github.com/palantir/atlasdb/commit/bfb9325fd66a9a7dda6784d25989c1da8966c610", "message": "Merge branch 'jkong/path-to-multitenancy' of github.com:palantir/atlasdb into jkong/path-to-multitenancy", "committedDate": "2020-05-15T11:22:45Z", "type": "commit"}, {"oid": "7579f60a4f990e4fd97fb187a9773dec6f66dcb0", "url": "https://github.com/palantir/atlasdb/commit/7579f60a4f990e4fd97fb187a9773dec6f66dcb0", "message": "Merge branch 'develop' into jkong/path-to-multitenancy", "committedDate": "2020-05-15T11:33:51Z", "type": "commit"}, {"oid": "8601feda5b0579618a539f9cea5f167abf982a51", "url": "https://github.com/palantir/atlasdb/commit/8601feda5b0579618a539f9cea5f167abf982a51", "message": "unused crap", "committedDate": "2020-05-15T11:37:59Z", "type": "commit"}, {"oid": "f42b0f0228654a082b88cde6c9a2a2d9803b2615", "url": "https://github.com/palantir/atlasdb/commit/f42b0f0228654a082b88cde6c9a2a2d9803b2615", "message": "More unused things", "committedDate": "2020-05-15T12:32:39Z", "type": "commit"}, {"oid": "d0cff2472ba00b2cc6c10331e97c720ea0783e6a", "url": "https://github.com/palantir/atlasdb/commit/d0cff2472ba00b2cc6c10331e97c720ea0783e6a", "message": "Add generated changelog entries", "committedDate": "2020-05-15T12:32:39Z", "type": "commit"}, {"oid": "4fd92f0ce7894ca413a24357fbfd14f4a07a5677", "url": "https://github.com/palantir/atlasdb/commit/4fd92f0ce7894ca413a24357fbfd14f4a07a5677", "message": "Add generated changelog entries", "committedDate": "2020-05-15T12:32:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgxOTIxMA==", "url": "https://github.com/palantir/atlasdb/pull/4778#discussion_r425819210", "bodyText": "\ud83d\udd2a", "author": "gmaretic", "createdAt": "2020-05-15T13:56:08Z", "path": "changelog/@unreleased/pr-4778.v2.yml", "diffHunk": "@@ -0,0 +1,8 @@\n+type: improvement\n+improvement:\n+  description: AtlasDB now allows users to pass in a `DialogueClients.ReloadingFactory`\n+    in install configuration. This is likely to be useful for AtlasDB-Proxy, which", "originalCommit": "f42b0f0228654a082b88cde6c9a2a2d9803b2615", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "998692e0252ee65e018ac3499b6d20f1d9bbfea2", "url": "https://github.com/palantir/atlasdb/commit/998692e0252ee65e018ac3499b6d20f1d9bbfea2", "message": "Update TransactionManagers.java", "committedDate": "2020-05-18T07:33:09Z", "type": "commit"}]}