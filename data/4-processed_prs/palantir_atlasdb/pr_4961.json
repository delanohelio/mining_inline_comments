{"pr_number": 4961, "pr_title": "[LW] Fixes, 4: Register lockwatches eagerly", "pr_createdAt": "2020-08-24T13:15:24Z", "pr_url": "https://github.com/palantir/atlasdb/pull/4961", "timeline": [{"oid": "c39673eb53b03836af9ccabd57eb57b54798595b", "url": "https://github.com/palantir/atlasdb/commit/c39673eb53b03836af9ccabd57eb57b54798595b", "message": "register watches early", "committedDate": "2020-08-24T13:13:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMwNzk5Ng==", "url": "https://github.com/palantir/atlasdb/pull/4961#discussion_r476307996", "bodyText": "I think this works, everything is nice and threadsafe anyway.", "author": "jkozlowski", "createdAt": "2020-08-25T09:23:54Z", "path": "atlasdb-impl-shared/src/main/java/com/palantir/atlasdb/keyvalue/api/watch/LockWatchManagerImpl.java", "diffHunk": "@@ -72,6 +72,7 @@ public void close() {\n     @Override\n     public void registerWatches(Set<LockWatchReferences.LockWatchReference> newLockWatches) {\n         lockWatchReferences.addAll(newLockWatches);\n+        registerWatchesWithTimelock();", "originalCommit": "c39673eb53b03836af9ccabd57eb57b54798595b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}