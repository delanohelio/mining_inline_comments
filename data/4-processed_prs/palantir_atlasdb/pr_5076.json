{"pr_number": 5076, "pr_title": "[TS] Tune sweepdelay metrics", "pr_createdAt": "2020-10-22T16:57:07Z", "pr_url": "https://github.com/palantir/atlasdb/pull/5076", "timeline": [{"oid": "bb9f1663daaeb798638c591f4da9a20689dd20a8", "url": "https://github.com/palantir/atlasdb/commit/bb9f1663daaeb798638c591f4da9a20689dd20a8", "message": "Update sweepdelay metrics only with successful runs", "committedDate": "2020-10-22T16:45:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQ2OTAxOA==", "url": "https://github.com/palantir/atlasdb/pull/5076#discussion_r510469018", "bodyText": "Do we have tests for the case where sweepDelayMetricsUpdater is updated to not INITIAL_DELAY?", "author": "sudiksha27", "createdAt": "2020-10-22T21:29:44Z", "path": "atlasdb-impl-shared/src/test/java/com/palantir/atlasdb/sweep/queue/SweepDelayTest.java", "diffHunk": "@@ -60,28 +60,32 @@ public void configurationAboveDefaultMaximumIsRespected() {\n \n     @Test\n     public void unableToAcquireShardReturnsMaxPause() {\n+        delay.getNextPause(SUCCESS);\n         assertThat(delay.getNextPause(SweepIterationResults.unableToAcquireShard()))\n                 .isEqualTo(DEFAULT_MAX_PAUSE_MILLIS);\n-        assertThat(metrics).hasValue(DEFAULT_MAX_PAUSE_MILLIS);\n+        assertThat(metrics).hasValue(INITIAL_DELAY);\n     }", "originalCommit": "bb9f1663daaeb798638c591f4da9a20689dd20a8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}