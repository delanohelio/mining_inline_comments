{"pr_number": 428, "pr_title": "KOGITO-3725: Enable Travels and Visas tests", "pr_createdAt": "2020-10-29T12:24:30Z", "pr_url": "https://github.com/kiegroup/kogito-examples/pull/428", "timeline": [{"oid": "01ba5da50d03cbed3169a185d401150ea5ac6d53", "url": "https://github.com/kiegroup/kogito-examples/commit/01ba5da50d03cbed3169a185d401150ea5ac6d53", "message": "KOGITO-3725: Enable Travels and Visas tests", "committedDate": "2020-10-29T12:25:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIxODY3OQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/428#discussion_r514218679", "bodyText": "This issue was already fixed and the app works without this dependency. Removing it.", "author": "Sgitario", "createdAt": "2020-10-29T12:26:55Z", "path": "kogito-travel-agency/extended/visas/pom.xml", "diffHunk": "@@ -70,11 +70,6 @@\n       <groupId>org.kie.kogito</groupId>\n       <artifactId>process-management-addon</artifactId>\n     </dependency>\n-    <!-- Needed because of this: https://github.com/quarkusio/quarkus/issues/7809 . Adding the resteasy extension does not fix it. -->", "originalCommit": "01ba5da50d03cbed3169a185d401150ea5ac6d53", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIxODc5Mw==", "url": "https://github.com/kiegroup/kogito-examples/pull/428#discussion_r514218793", "bodyText": "This issue was already fixed and the app works without this dependency. Removing it.", "author": "Sgitario", "createdAt": "2020-10-29T12:27:07Z", "path": "kogito-travel-agency/extended/travels/pom.xml", "diffHunk": "@@ -89,13 +93,9 @@\n       <scope>test</scope>\n     </dependency>\n     <dependency>\n-      <groupId>io.quarkus</groupId>\n-      <artifactId>quarkus-smallrye-openapi</artifactId>\n-    </dependency>\n-    <!-- Needed because of this: https://github.com/quarkusio/quarkus/issues/7809 . Adding the resteasy extension does not fix it. -->", "originalCommit": "01ba5da50d03cbed3169a185d401150ea5ac6d53", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIxOTU5OQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/428#discussion_r514219599", "bodyText": "@ricardozanini this is a workaround I had to add because of the changes in kiegroup/kogito-runtimes#779.\nI think we should raise a ticket so users don't have to add this workaround to implement integration tests.", "author": "Sgitario", "createdAt": "2020-10-29T12:28:35Z", "path": "pom.xml", "diffHunk": "@@ -384,6 +384,28 @@\n           <artifactId>spring-boot-maven-plugin</artifactId>\n           <version>${springboot.version}</version>\n         </plugin>\n+        <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+          <artifactId>maven-resources-plugin</artifactId>\n+          <version>2.5</version>\n+          <executions>\n+            <execution>\n+              <id>add-it-resources</id>\n+              <phase>pre-integration-test</phase>\n+              <goals>\n+                <goal>copy-resources</goal>\n+              </goals>\n+              <configuration>\n+                <outputDirectory>${project.build.directory}/test-run/META-INF</outputDirectory>\n+                <resources>\n+                  <resource>\n+                    <directory>target/classes/META-INF</directory>\n+                  </resource>\n+                </resources>\n+              </configuration>\n+            </execution>\n+          </executions>\n+        </plugin>", "originalCommit": "01ba5da50d03cbed3169a185d401150ea5ac6d53", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM5Mjc4OA==", "url": "https://github.com/kiegroup/kogito-examples/pull/428#discussion_r514392788", "bodyText": "@Sgitario this one maybe? https://issues.redhat.com/browse/KOGITO-3406\nCould you take a look, maybe raising a new ticket or detailing this one?", "author": "ricardozanini", "createdAt": "2020-10-29T16:23:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIxOTU5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIyMDg2MA==", "url": "https://github.com/kiegroup/kogito-examples/pull/428#discussion_r514220860", "bodyText": "Setting the topic as broadcast fixed the below issue:\n2020-10-28 09:10:15,066 ERROR [io.sma.rea.mes.kafka] (main) SRMSG18217: Unable to read a record from Kafka topics '[visasresponses]': java.lang.IllegalStateException: This processor allows only a single Subscriber\n    at io.smallrye.mutiny.vertx.MultiReadStream.subscribe(MultiReadStream.java:62)\n    at io.smallrye.mutiny.operators.AbstractMulti.subscribe(AbstractMulti.java:24)\n    at io.smallrye.mutiny.groups.MultiSubscribe.withSubscriber(MultiSubscribe.java:69)\n    at io.smallrye.mutiny.operators.multi.MultiOnFailureInvoke.subscribe(MultiOnFailureInvoke.java:29)\n    at io.smallrye.mutiny.operators.AbstractMulti.subscribe(AbstractMulti.java:31)\n    at io.smallrye.mutiny.context.ContextPropagationMultiInterceptor$ContextPropagationMulti$1.run(ContextPropagationMultiInterceptor.java:57)", "author": "Sgitario", "createdAt": "2020-10-29T12:30:38Z", "path": "kogito-travel-agency/extended/travels/src/test/resources/application.properties", "diffHunk": "@@ -10,17 +10,18 @@ kogito.service.url=http://localhost:8080\n kogito.dataindex.http.url=http://localhost:8180\n kogito.dataindex.ws.url=ws://localhost:8180\n \n+#Infinispan\n quarkus.infinispan-client.server-list=localhost:11222\n-#quarkus.infinispan-client.server-list=kogito-infinispan:11222\n-quarkus.infinispan-client.auth-username= \n-quarkus.infinispan-client.auth-password= \n-quarkus.infinispan-client.sasl-mechanism=\n+quarkus.infinispan-client.use-auth=true\n+quarkus.infinispan-client.auth-username=admin\n+quarkus.infinispan-client.auth-password=admin\n \n kafka.bootstrap.servers=localhost:9092\n \n #mp.messaging.incoming.kogito_incoming_stream.bootstrap.servers=localhost:9092\n mp.messaging.incoming.kogito_incoming_stream.connector=smallrye-kafka\n mp.messaging.incoming.kogito_incoming_stream.topic=visasresponses\n+mp.messaging.incoming.kogito_incoming_stream.broadcast=true", "originalCommit": "01ba5da50d03cbed3169a185d401150ea5ac6d53", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0MjMwMA==", "url": "https://github.com/kiegroup/kogito-examples/pull/428#discussion_r514242300", "bodyText": "nice! I have addressed this by attaching a broadcast programmatically in kiegroup/kogito-runtimes#854 so then we'll be able to remove this", "author": "evacchi", "createdAt": "2020-10-29T13:05:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIyMDg2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0ODE4NQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/428#discussion_r514248185", "bodyText": "Thanks @evacchi ! I've removed my changes and made this PR to depend on yours.", "author": "Sgitario", "createdAt": "2020-10-29T13:14:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIyMDg2MA=="}], "type": "inlineReview"}, {"oid": "5062d4156c28d6e6bca76be381221b5867a4bdaf", "url": "https://github.com/kiegroup/kogito-examples/commit/5062d4156c28d6e6bca76be381221b5867a4bdaf", "message": "KOGITO-3725: Enable Travels and Visas tests", "committedDate": "2020-10-29T13:14:08Z", "type": "commit"}, {"oid": "5062d4156c28d6e6bca76be381221b5867a4bdaf", "url": "https://github.com/kiegroup/kogito-examples/commit/5062d4156c28d6e6bca76be381221b5867a4bdaf", "message": "KOGITO-3725: Enable Travels and Visas tests", "committedDate": "2020-10-29T13:14:08Z", "type": "forcePushed"}]}