{"pr_number": 448, "pr_title": "[KOGITO-3642] - SW Example with Events, REST Functions and RuleUnits", "pr_createdAt": "2020-11-10T21:41:43Z", "pr_url": "https://github.com/kiegroup/kogito-examples/pull/448", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjc3NDM0Ng==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r522774346", "bodyText": "typo in file name \"onbording\" should be \"onboarding\"", "author": "evacchi", "createdAt": "2020-11-13T08:13:09Z", "path": "serverless-workflow-functions-events-quarkus/src/main/resources/onbording.sw.json", "diffHunk": "@@ -0,0 +1,73 @@\n+{", "originalCommit": "c89b5e510f01b8c29fc24a59478ff53584683746", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDgwOTg0MQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r524809841", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <version>1.0.0-SNAPSHOT</version>\n          \n          \n            \n                <version>2.0.0-SNAPSHOT</version>", "author": "cristianonicolai", "createdAt": "2020-11-17T00:41:02Z", "path": "serverless-workflow-functions-events-quarkus/pom.xml", "diffHunk": "@@ -0,0 +1,142 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <parent>\n+    <artifactId>kogito-examples</artifactId>\n+    <groupId>org.kie.kogito</groupId>\n+    <version>1.0.0-SNAPSHOT</version>", "originalCommit": "c89b5e510f01b8c29fc24a59478ff53584683746", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDgxNDgwMQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r524814801", "bodyText": "On a local test I got the following error:\nAppointmentResourceTest.verifySchedulePatientAppointment:75  Expected: a value equal to or greater than <Tue Nov 17 10:50:11 AEST 2020> but: <Tue Nov 17 01:50:00 AEST 2020> was less than <Tue Nov 17 10:50:11 AEST 2020>\nI would suggest to use java.time API, ex LocalDateTime instead of plain Dates as it makes this calculations a lot more consistent.", "author": "cristianonicolai", "createdAt": "2020-11-17T00:56:13Z", "path": "serverless-workflow-functions-events-quarkus/src/main/java/org/acme/sw/onboarding/services/ScheduleService.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/**\n+ *  Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *        http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package org.acme.sw.onboarding.services;\n+\n+import java.util.ArrayList;\n+import java.util.Calendar;\n+import java.util.Comparator;\n+import java.util.Date;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.concurrent.ConcurrentHashMap;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+\n+import org.acme.sw.onboarding.model.Appointment;\n+import org.acme.sw.onboarding.model.Patient;\n+\n+@ApplicationScoped\n+public class ScheduleService {\n+\n+    public final static int FIRST_HOUR_MORNING = 9;\n+\n+    /*\n+    Our doctors can attend one patient per day only :)\n+    */\n+    private final Map<String, List<Date>> schedule;\n+\n+    public ScheduleService() {\n+        this.schedule = new ConcurrentHashMap<>();\n+    }\n+\n+    /*\n+    In a real world scenario this can get far more complex, we should have a transactions and sync access to the schedule.\n+    We don't want to mess with our doctors schedule, right? :)\n+    To make it simple and less error prone, we are using a simple Map to hold our data.\n+     */\n+    public Appointment createAppointment(final Patient patient) {\n+        final Appointment appointment = new Appointment();\n+        final String doctorId = patient.getAssignedDoctor().getId();\n+        appointment.setPatient(patient);\n+        // better case scenario we set an appointment today an hour from now :)\n+        appointment.setDate(this.addOneHour(new Date()));\n+        appointment.setDoctor(patient.getAssignedDoctor());\n+\n+        // let's find room for our patient\n+        if (this.schedule.get(doctorId) != null) {\n+            final Optional<Date> lastDate = this.schedule.get(doctorId).stream().max(Comparator.nullsFirst(Comparator.naturalOrder()));\n+            appointment.setDate(this.addOneDayFirstHourInMorning(lastDate.orElseThrow(IllegalStateException::new)));\n+        } else { // this doctor hasn't been set an appointment yet\n+            this.schedule.put(doctorId, new ArrayList<>());\n+        }\n+        this.schedule.get(doctorId).add(appointment.getDate());\n+\n+        return appointment;\n+    }\n+\n+    private Date addOneHour(final Date targetDate) {\n+        final Calendar calendar = Calendar.getInstance();", "originalCommit": "c89b5e510f01b8c29fc24a59478ff53584683746", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI2Mzk5MA==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r525263990", "bodyText": "LOL, why did I use Calendar? Brain farts...", "author": "ricardozanini", "createdAt": "2020-11-17T15:43:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDgxNDgwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDgyMDAwMg==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r524820002", "bodyText": "@ricardozanini would be nice to also have the CURL command example here so people can simply copy and execute, like https://github.com/kiegroup/kogito-examples/tree/stable/kogito-travel-agency/extended/travels#post-travels", "author": "cristianonicolai", "createdAt": "2020-11-17T01:11:39Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,101 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{", "originalCommit": "c89b5e510f01b8c29fc24a59478ff53584683746", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA0ODk2MA==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r525048960", "bodyText": "This is just an extreme nitpick, but I'd leave out any reference to the gender here: it doesn't seem relevant for the example and it's a slippery topic.", "author": "mariofusco", "createdAt": "2020-11-17T10:32:44Z", "path": "serverless-workflow-functions-events-quarkus/src/main/java/org/acme/sw/onboarding/model/Gender.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/**\n+ *  Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *        http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package org.acme.sw.onboarding.model;\n+\n+import com.fasterxml.jackson.annotation.JsonCreator;\n+import com.fasterxml.jackson.annotation.JsonValue;\n+\n+public enum Gender {", "originalCommit": "c89b5e510f01b8c29fc24a59478ff53584683746", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA1NzkzNg==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r525057936", "bodyText": "In general using no-loop is a drl-smell. I didn't give it a run, but it shouldn't be necessary in this case because property reactivity should avoid the loop. Even if I'm wrong on this you could better avoid any possible loop by adding the condition assignedDoctor == null to the patients. Actually I believe that you should add this condition regardless to avoid that a rule will overwrite the doctor assigned by another formerly fired rule.", "author": "mariofusco", "createdAt": "2020-11-17T10:46:42Z", "path": "serverless-workflow-functions-events-quarkus/src/main/resources/org/acme/sw/onboarding/queries/doctor_assignment.drl", "diffHunk": "@@ -0,0 +1,40 @@\n+package org.acme.sw.onboarding.queries;\n+unit AssignmentUnit;\n+\n+import org.acme.sw.onboarding.model.Doctor;\n+import org.acme.sw.onboarding.model.Patient;\n+import org.acme.sw.onboarding.model.SymptomSpecialty;\n+import org.acme.sw.onboarding.helpers.CalendarHelper;\n+import java.util.Collections;\n+\n+rule PatientIsAChild no-loop", "originalCommit": "c89b5e510f01b8c29fc24a59478ff53584683746", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA2NzgyOA==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r525067828", "bodyText": "I'm afraid you're misusing salience here (or at least I want to be sure that we're on the same page on this). I guess you wanted to enforce that a kid will be assigned to a pediatric regardless of his disease. You're actually obtaining this result but in a quite \"unconventional\" way. What it's happening here (see also the former comment) is that other rules may fire before of this but regardless of it this rule (which has the lowest salience) will eventually fire (for a kid) as the last one overwriting any other assigned doctor. What I'd do to obtain the same result would be giving this rule the highest possible salience (in a business domain related sense this is the most relevant/important rule and it is counter-intuitive that you're giving the lowest salience to it) and adding the condition assignedDoctor == null to other rules. Finally note that implicitly the rules are considered having decreasing salience in a drl file (unless you don't override this behaviour explicitly using the salience attribute as you're doing here) so if you follow my suggestion you could completely remove the salience attributes from all the rules.", "author": "mariofusco", "createdAt": "2020-11-17T11:02:34Z", "path": "serverless-workflow-functions-events-quarkus/src/main/resources/org/acme/sw/onboarding/queries/doctor_assignment.drl", "diffHunk": "@@ -0,0 +1,40 @@\n+package org.acme.sw.onboarding.queries;\n+unit AssignmentUnit;\n+\n+import org.acme.sw.onboarding.model.Doctor;\n+import org.acme.sw.onboarding.model.Patient;\n+import org.acme.sw.onboarding.model.SymptomSpecialty;\n+import org.acme.sw.onboarding.helpers.CalendarHelper;\n+import java.util.Collections;\n+\n+rule PatientIsAChild no-loop\n+    salience 1", "originalCommit": "c89b5e510f01b8c29fc24a59478ff53584683746", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5260b5a21b23c76ca89dc5f1a22d690d2db605a8", "url": "https://github.com/kiegroup/kogito-examples/commit/5260b5a21b23c76ca89dc5f1a22d690d2db605a8", "message": "[KOGITO-3642] - SW Example with Events, REST Functions and RuleUnits\n\nSigned-off-by: Ricardo Zanini <zanini@redhat.com>", "committedDate": "2020-11-17T15:27:42Z", "type": "commit"}, {"oid": "917787600e183af38d6e3ffc61dfdff67623dc03", "url": "https://github.com/kiegroup/kogito-examples/commit/917787600e183af38d6e3ffc61dfdff67623dc03", "message": "modified example", "committedDate": "2020-11-17T15:27:42Z", "type": "commit"}, {"oid": "c1ad1d9345ea1dcee487da8a0be0255390bda31f", "url": "https://github.com/kiegroup/kogito-examples/commit/c1ad1d9345ea1dcee487da8a0be0255390bda31f", "message": "proper assertion in plain test", "committedDate": "2020-11-17T15:27:42Z", "type": "commit"}, {"oid": "c7e05138910e20edeebf47ec5284abc5a6ec7bff", "url": "https://github.com/kiegroup/kogito-examples/commit/c7e05138910e20edeebf47ec5284abc5a6ec7bff", "message": "Merging everything together\n\nSigned-off-by: Ricardo Zanini <zanini@redhat.com>", "committedDate": "2020-11-17T15:27:42Z", "type": "commit"}, {"oid": "326529c126244f7b141aff3d0ee65c2f31f67701", "url": "https://github.com/kiegroup/kogito-examples/commit/326529c126244f7b141aff3d0ee65c2f31f67701", "message": "Wrapping up and finishing the example implementation\n\nSigned-off-by: Ricardo Zanini <zanini@redhat.com>", "committedDate": "2020-11-17T15:27:42Z", "type": "commit"}, {"oid": "c0bac48cd772ed7b9c3a826441ecb3accf8e5a57", "url": "https://github.com/kiegroup/kogito-examples/commit/c0bac48cd772ed7b9c3a826441ecb3accf8e5a57", "message": "Fixing license header", "committedDate": "2020-11-17T15:27:42Z", "type": "commit"}, {"oid": "dc625ce19a2c9e7de31009ab540fc7b16cf35efb", "url": "https://github.com/kiegroup/kogito-examples/commit/dc625ce19a2c9e7de31009ab540fc7b16cf35efb", "message": "Documenting like a boss\n\nSigned-off-by: Ricardo Zanini <zanini@redhat.com>", "committedDate": "2020-11-17T15:27:42Z", "type": "commit"}, {"oid": "d67dad6eff8e708fc30348c6beccf4056127e6a9", "url": "https://github.com/kiegroup/kogito-examples/commit/d67dad6eff8e708fc30348c6beccf4056127e6a9", "message": "Incorporating rules suggestions\n\nSigned-off-by: Ricardo Zanini <zanini@redhat.com>", "committedDate": "2020-11-17T15:27:42Z", "type": "commit"}, {"oid": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "url": "https://github.com/kiegroup/kogito-examples/commit/bca0879b8314d5d5923a24a50e0d9c8a23853d09", "message": "Fixing dates, updating documentation\n\nSigned-off-by: Ricardo Zanini <zanini@redhat.com>", "committedDate": "2020-11-17T16:01:35Z", "type": "commit"}, {"oid": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "url": "https://github.com/kiegroup/kogito-examples/commit/bca0879b8314d5d5923a24a50e0d9c8a23853d09", "message": "Fixing dates, updating documentation\n\nSigned-off-by: Ricardo Zanini <zanini@redhat.com>", "committedDate": "2020-11-17T16:01:35Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2ODM4Nw==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526268387", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Or you can use CURL and set the CloudEvents parameters in the request headers:\n          \n          \n            \n            Or you can use cURL and set the CloudEvents parameters in the request headers:", "author": "radtriste", "createdAt": "2020-11-18T17:23:16Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2ODc4MQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526268781", "bodyText": "generating a new ID for they ???", "author": "radtriste", "createdAt": "2020-11-18T17:23:50Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2OTEwMQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526269101", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n          \n          \n            \n            2. `AssignDoctorToPatient` will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n          \n      \n    \n    \n  \n\nfor consistency in phrasing", "author": "radtriste", "createdAt": "2020-11-18T17:24:19Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) ", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2OTQzMw==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526269433", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n          \n          \n            \n            to determine to which doctor this patient should be assigned, based on their symptoms or general characteristics (children always go to Pediatrics, for example)", "author": "radtriste", "createdAt": "2020-11-18T17:24:45Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI2OTgwNQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526269805", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned\n          \n          \n            \n            3. `SchedulePatientAppointment` will find a time slot for this patient based on the agenda of the assigned doctor", "author": "radtriste", "createdAt": "2020-11-18T17:25:16Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n+3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3MDM4Mg==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526270382", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Also, there's the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/\n          \n          \n            \n            Also, there is the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/", "author": "radtriste", "createdAt": "2020-11-18T17:26:04Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n+3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned\n+\n+After executing the workflow, the appointments' data can be fetched using the `/onboarding/schedule/appointment` endpoint.\n+\n+There's a nice web interface for you to try the example available in the root url (http://localhost:8080 for local environments):\n+\n+![](imgs/web_ui.png)\n+\n+Enter the data into the provided form to see the example in action! Date of Birth must be in `YYYY-MM-DD` format.\n+\n+Also, there's the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3MTA1OA==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526271058", "bodyText": "thinking that now, with https://quarkus.io/guides/building-native-image#container-runtime, you don't need Gradle installed anymore if you have Docker/Podman ;)", "author": "radtriste", "createdAt": "2020-11-18T17:26:59Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n+3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned\n+\n+After executing the workflow, the appointments' data can be fetched using the `/onboarding/schedule/appointment` endpoint.\n+\n+There's a nice web interface for you to try the example available in the root url (http://localhost:8080 for local environments):\n+\n+![](imgs/web_ui.png)\n+\n+Enter the data into the provided form to see the example in action! Date of Birth must be in `YYYY-MM-DD` format.\n+\n+Also, there's the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/\n+\n+## Installing and Running\n+\n+### Prerequisites\n+ \n+You will need:\n+  - Java 11+ installed\n+  - Environment variable JAVA_HOME set accordingly\n+  - Maven 3.6.2+ installed\n+\n+When using native image compilation, you will also need: \n+  - [GraalVm](https://www.graalvm.org/downloads/) 20.2.0+ installed\n+  - Environment variable GRAALVM_HOME set accordingly\n+  - Note that GraalVM native image compilation typically requires other packages (glibc-devel, zlib-devel and gcc) to be installed too.  You also need 'native-image' installed in GraalVM (using 'gu install native-image'). Please refer to [GraalVM installation documentation](https://www.graalvm.org/docs/reference-manual/aot-compilation/#prerequisites) for more details.", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjMxNzE5Mw==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526317193", "bodyText": "Well, I believe we need to rephrase all the other examples as well! \ud83d\ude13", "author": "ricardozanini", "createdAt": "2020-11-18T18:15:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3MTA1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3MjEzMg==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526272132", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Use `curl` to send the CloudEvent through HTTP to the application:\n          \n          \n            \n            Use `curl` command to send the CloudEvent through HTTP to the application:", "author": "radtriste", "createdAt": "2020-11-18T17:28:32Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n+3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned\n+\n+After executing the workflow, the appointments' data can be fetched using the `/onboarding/schedule/appointment` endpoint.\n+\n+There's a nice web interface for you to try the example available in the root url (http://localhost:8080 for local environments):\n+\n+![](imgs/web_ui.png)\n+\n+Enter the data into the provided form to see the example in action! Date of Birth must be in `YYYY-MM-DD` format.\n+\n+Also, there's the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/\n+\n+## Installing and Running\n+\n+### Prerequisites\n+ \n+You will need:\n+  - Java 11+ installed\n+  - Environment variable JAVA_HOME set accordingly\n+  - Maven 3.6.2+ installed\n+\n+When using native image compilation, you will also need: \n+  - [GraalVm](https://www.graalvm.org/downloads/) 20.2.0+ installed\n+  - Environment variable GRAALVM_HOME set accordingly\n+  - Note that GraalVM native image compilation typically requires other packages (glibc-devel, zlib-devel and gcc) to be installed too.  You also need 'native-image' installed in GraalVM (using 'gu install native-image'). Please refer to [GraalVM installation documentation](https://www.graalvm.org/docs/reference-manual/aot-compilation/#prerequisites) for more details.\n+\n+### Compile and Run in Local Dev Mode\n+\n+```text\n+mvn clean package quarkus:dev    \n+```\n+\n+Use `curl` to send the CloudEvent through HTTP to the application:", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3MjI4NQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526272285", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In the application log, you will see something like:\n          \n          \n            \n            In the application's log, you will see something like:", "author": "radtriste", "createdAt": "2020-11-18T17:28:46Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n+3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned\n+\n+After executing the workflow, the appointments' data can be fetched using the `/onboarding/schedule/appointment` endpoint.\n+\n+There's a nice web interface for you to try the example available in the root url (http://localhost:8080 for local environments):\n+\n+![](imgs/web_ui.png)\n+\n+Enter the data into the provided form to see the example in action! Date of Birth must be in `YYYY-MM-DD` format.\n+\n+Also, there's the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/\n+\n+## Installing and Running\n+\n+### Prerequisites\n+ \n+You will need:\n+  - Java 11+ installed\n+  - Environment variable JAVA_HOME set accordingly\n+  - Maven 3.6.2+ installed\n+\n+When using native image compilation, you will also need: \n+  - [GraalVm](https://www.graalvm.org/downloads/) 20.2.0+ installed\n+  - Environment variable GRAALVM_HOME set accordingly\n+  - Note that GraalVM native image compilation typically requires other packages (glibc-devel, zlib-devel and gcc) to be installed too.  You also need 'native-image' installed in GraalVM (using 'gu install native-image'). Please refer to [GraalVM installation documentation](https://www.graalvm.org/docs/reference-manual/aot-compilation/#prerequisites) for more details.\n+\n+### Compile and Run in Local Dev Mode\n+\n+```text\n+mvn clean package quarkus:dev    \n+```\n+\n+Use `curl` to send the CloudEvent through HTTP to the application:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+In the application log, you will see something like:", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3MzE2NA==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526273164", "bodyText": "See comment above", "author": "radtriste", "createdAt": "2020-11-18T17:29:24Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n+3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned\n+\n+After executing the workflow, the appointments' data can be fetched using the `/onboarding/schedule/appointment` endpoint.\n+\n+There's a nice web interface for you to try the example available in the root url (http://localhost:8080 for local environments):\n+\n+![](imgs/web_ui.png)\n+\n+Enter the data into the provided form to see the example in action! Date of Birth must be in `YYYY-MM-DD` format.\n+\n+Also, there's the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/\n+\n+## Installing and Running\n+\n+### Prerequisites\n+ \n+You will need:\n+  - Java 11+ installed\n+  - Environment variable JAVA_HOME set accordingly\n+  - Maven 3.6.2+ installed\n+\n+When using native image compilation, you will also need: \n+  - [GraalVm](https://www.graalvm.org/downloads/) 20.2.0+ installed\n+  - Environment variable GRAALVM_HOME set accordingly\n+  - Note that GraalVM native image compilation typically requires other packages (glibc-devel, zlib-devel and gcc) to be installed too.  You also need 'native-image' installed in GraalVM (using 'gu install native-image'). Please refer to [GraalVM installation documentation](https://www.graalvm.org/docs/reference-manual/aot-compilation/#prerequisites) for more details.\n+\n+### Compile and Run in Local Dev Mode\n+\n+```text\n+mvn clean package quarkus:dev    \n+```\n+\n+Use `curl` to send the CloudEvent through HTTP to the application:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+In the application log, you will see something like:\n+\n+```log\n+2020-11-17 12:51:11,581 DEBUG [org.acm.sw.onb.res.PatientResource] (executor-thread-198) Received patient to store in the internal in memory database: Patient{name='Mick', id='null', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,581 DEBUG [org.acm.sw.onb.res.PatientResource] (executor-thread-198) Patient has been stored in the internal memory: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,600 DEBUG [org.acm.sw.onb.res.AppointmentResource] (executor-thread-198) Receive patient to schedule appointments: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,600 DEBUG [org.acm.sw.onb.res.AppointmentResource] (executor-thread-198) Processed patient: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+```\n+\n+Then query the appointments' resource to see the assigned doctor:\n+\n+```shell script\n+$ curl http://localhost:8080/onboarding/schedule/appointment | jq '.'\n+\n+[\n+  {\n+    \"doctor\": {\n+      \"id\": \"8293dc94-2386-11eb-adc1-0242ac120002\",\n+      \"name\": \"Maria Mind\",\n+      \"specialty\": \"Neurology\"\n+    },\n+    \"patient\": {\n+      \"name\": \"Mick\",\n+      \"id\": \"5560ed3d-becb-4f35-8c6a-2816338bf8fd\",\n+      \"symptoms\": [\n+        \"seizures\"\n+      ],\n+      \"dateOfBirth\": \"1983-08-15\",\n+      \"assignedDoctor\": {\n+        \"id\": \"8293dc94-2386-11eb-adc1-0242ac120002\",\n+        \"name\": \"Maria Mind\",\n+        \"specialty\": \"Neurology\"\n+      }\n+    },\n+    \"date\": \"2020-11-18 09:00\"\n+  }\n+]\n+```\n+\n+_**Note:** Please make sure you have [jq](https://stedolan.github.io/jq/download/) installed in your system to see the formatted output._\n+\n+### Compile and Run in JVM mode\n+\n+```text\n+mvn clean package \n+java -jar target/serverless-workflow-functions-quarkus-runner.jar   \n+```\n+\n+or on windows\n+\n+```text\n+mvn clean package\n+java -jar target\\serverless-workflow-functions-quarkus-runner.jar\n+```\n+\n+### Compile and Run using Local Native Image\n+Note that this requires GRAALVM_HOME to point to a valid GraalVM installation", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3MzY3NQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526273675", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In the [`operator`](operator) directory you'll find the custom resources needed to deploy this example on OpenShift or Kubernetes with the [Kogito Operator](https://docs.jboss.org/kogito/release/latest/html_single/#chap_kogito-deploying-on-openshift).\n          \n          \n            \n            In the [`operator`](operator) directory you can find the custom resources needed to deploy this example on OpenShift or Kubernetes with the [Kogito Operator](https://docs.jboss.org/kogito/release/latest/html_single/#chap_kogito-deploying-on-openshift).", "author": "radtriste", "createdAt": "2020-11-18T17:29:46Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n+3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned\n+\n+After executing the workflow, the appointments' data can be fetched using the `/onboarding/schedule/appointment` endpoint.\n+\n+There's a nice web interface for you to try the example available in the root url (http://localhost:8080 for local environments):\n+\n+![](imgs/web_ui.png)\n+\n+Enter the data into the provided form to see the example in action! Date of Birth must be in `YYYY-MM-DD` format.\n+\n+Also, there's the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/\n+\n+## Installing and Running\n+\n+### Prerequisites\n+ \n+You will need:\n+  - Java 11+ installed\n+  - Environment variable JAVA_HOME set accordingly\n+  - Maven 3.6.2+ installed\n+\n+When using native image compilation, you will also need: \n+  - [GraalVm](https://www.graalvm.org/downloads/) 20.2.0+ installed\n+  - Environment variable GRAALVM_HOME set accordingly\n+  - Note that GraalVM native image compilation typically requires other packages (glibc-devel, zlib-devel and gcc) to be installed too.  You also need 'native-image' installed in GraalVM (using 'gu install native-image'). Please refer to [GraalVM installation documentation](https://www.graalvm.org/docs/reference-manual/aot-compilation/#prerequisites) for more details.\n+\n+### Compile and Run in Local Dev Mode\n+\n+```text\n+mvn clean package quarkus:dev    \n+```\n+\n+Use `curl` to send the CloudEvent through HTTP to the application:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+In the application log, you will see something like:\n+\n+```log\n+2020-11-17 12:51:11,581 DEBUG [org.acm.sw.onb.res.PatientResource] (executor-thread-198) Received patient to store in the internal in memory database: Patient{name='Mick', id='null', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,581 DEBUG [org.acm.sw.onb.res.PatientResource] (executor-thread-198) Patient has been stored in the internal memory: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,600 DEBUG [org.acm.sw.onb.res.AppointmentResource] (executor-thread-198) Receive patient to schedule appointments: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,600 DEBUG [org.acm.sw.onb.res.AppointmentResource] (executor-thread-198) Processed patient: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+```\n+\n+Then query the appointments' resource to see the assigned doctor:\n+\n+```shell script\n+$ curl http://localhost:8080/onboarding/schedule/appointment | jq '.'\n+\n+[\n+  {\n+    \"doctor\": {\n+      \"id\": \"8293dc94-2386-11eb-adc1-0242ac120002\",\n+      \"name\": \"Maria Mind\",\n+      \"specialty\": \"Neurology\"\n+    },\n+    \"patient\": {\n+      \"name\": \"Mick\",\n+      \"id\": \"5560ed3d-becb-4f35-8c6a-2816338bf8fd\",\n+      \"symptoms\": [\n+        \"seizures\"\n+      ],\n+      \"dateOfBirth\": \"1983-08-15\",\n+      \"assignedDoctor\": {\n+        \"id\": \"8293dc94-2386-11eb-adc1-0242ac120002\",\n+        \"name\": \"Maria Mind\",\n+        \"specialty\": \"Neurology\"\n+      }\n+    },\n+    \"date\": \"2020-11-18 09:00\"\n+  }\n+]\n+```\n+\n+_**Note:** Please make sure you have [jq](https://stedolan.github.io/jq/download/) installed in your system to see the formatted output._\n+\n+### Compile and Run in JVM mode\n+\n+```text\n+mvn clean package \n+java -jar target/serverless-workflow-functions-quarkus-runner.jar   \n+```\n+\n+or on windows\n+\n+```text\n+mvn clean package\n+java -jar target\\serverless-workflow-functions-quarkus-runner.jar\n+```\n+\n+### Compile and Run using Local Native Image\n+Note that this requires GRAALVM_HOME to point to a valid GraalVM installation\n+\n+```text\n+mvn clean package -Pnative\n+```\n+  \n+To run the generated native executable, generated in `target/`, execute\n+\n+```text\n+./target/serverless-workflow-functions-quarkus-runner.jar\n+```\n+\n+## Deploying with Kogito Operator\n+\n+In the [`operator`](operator) directory you'll find the custom resources needed to deploy this example on OpenShift or Kubernetes with the [Kogito Operator](https://docs.jboss.org/kogito/release/latest/html_single/#chap_kogito-deploying-on-openshift).", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjI3NTYyOA==", "url": "https://github.com/kiegroup/kogito-examples/pull/448#discussion_r526275628", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            \n          \n          \n            \n            Don't forget to replace the `<namespace>` placeholder in yaml files", "author": "radtriste", "createdAt": "2020-11-18T17:31:12Z", "path": "serverless-workflow-functions-events-quarkus/README.md", "diffHunk": "@@ -0,0 +1,167 @@\n+# Kogito Serverless Workflow - Patient Onboarding\n+\n+## Description\n+\n+In this example we will see how to use the [Serverless Workflow specification](https://github.com/serverlessworkflow/specification)\n+implementation on Kogito to orchestrate a sequence of REST calls in an Event-Driven architecture.\n+\n+This use case is about onboarding a new patient in a hospital, and based on their symptom, the \n+application will assign to the right expert. \n+\n+The workflow starts with a CloudEvent informing a new patient entry:\n+\n+```json\n+{\n+   \"id\":\"12345\",\n+   \"source\":\"/hospital/entry\",\n+   \"specversion\":\"1.0\",\n+   \"type\":\"new.patient.events\",\n+   \"data\":{\n+      \"name\":\"John\",\n+      \"dateOfBirth\":\"2017-08-15\",\n+      \"symptoms\":[\n+         \"seizures\"\n+      ]\n+   }\n+}\n+```\n+\n+Or you can use CURL and set the CloudEvents parameters in the request headers:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+The [workflow](src/main/resources/onbording.sw.json) will then call a sequence of REST services:\n+\n+1. `StoreNewPatient` will store the patient in the internal database for later processing, generating a new ID for they\n+2. `AssignDoctorToPatient` service will run a set of [rules](https://docs.jboss.org/kogito/release/latest/html_single/#con-drl-rule-units_drl-rules) \n+to determine which doctor this patient should be assigned based on their symptoms or general characteristics (children always go to Pediatrics, for example)\n+3. `SchedulePatientAppointment` will find a schedule for this patient based on the agenda of the doctor assigned\n+\n+After executing the workflow, the appointments' data can be fetched using the `/onboarding/schedule/appointment` endpoint.\n+\n+There's a nice web interface for you to try the example available in the root url (http://localhost:8080 for local environments):\n+\n+![](imgs/web_ui.png)\n+\n+Enter the data into the provided form to see the example in action! Date of Birth must be in `YYYY-MM-DD` format.\n+\n+Also, there's the Swagger UI that can also be used to explore the APIs in this example: http://localhost:8080/swagger-ui/\n+\n+## Installing and Running\n+\n+### Prerequisites\n+ \n+You will need:\n+  - Java 11+ installed\n+  - Environment variable JAVA_HOME set accordingly\n+  - Maven 3.6.2+ installed\n+\n+When using native image compilation, you will also need: \n+  - [GraalVm](https://www.graalvm.org/downloads/) 20.2.0+ installed\n+  - Environment variable GRAALVM_HOME set accordingly\n+  - Note that GraalVM native image compilation typically requires other packages (glibc-devel, zlib-devel and gcc) to be installed too.  You also need 'native-image' installed in GraalVM (using 'gu install native-image'). Please refer to [GraalVM installation documentation](https://www.graalvm.org/docs/reference-manual/aot-compilation/#prerequisites) for more details.\n+\n+### Compile and Run in Local Dev Mode\n+\n+```text\n+mvn clean package quarkus:dev    \n+```\n+\n+Use `curl` to send the CloudEvent through HTTP to the application:\n+\n+```shell script\n+$ curl -X POST \\\n+      -H \"content-type: application/json\"  \\\n+      -H \"ce-specversion: 1.0\"  \\\n+      -H \"ce-source: /hospital/entry\"  \\\n+      -H \"ce-type: new.patients.events\"  \\\n+      -H \"ce-id: 12346\"  \\\n+      -d \"{ \\\"name\\\": \\\"Mick\\\", \\\"dateOfBirth\\\": \\\"1983-08-15\\\", \\\"symptoms\\\":[\\\"seizures\\\"]}\" \\\n+  http://localhost:8080\n+```\n+\n+In the application log, you will see something like:\n+\n+```log\n+2020-11-17 12:51:11,581 DEBUG [org.acm.sw.onb.res.PatientResource] (executor-thread-198) Received patient to store in the internal in memory database: Patient{name='Mick', id='null', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,581 DEBUG [org.acm.sw.onb.res.PatientResource] (executor-thread-198) Patient has been stored in the internal memory: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,600 DEBUG [org.acm.sw.onb.res.AppointmentResource] (executor-thread-198) Receive patient to schedule appointments: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+2020-11-17 12:51:11,600 DEBUG [org.acm.sw.onb.res.AppointmentResource] (executor-thread-198) Processed patient: Patient{name='Mick', id='5560ed3d-becb-4f35-8c6a-2816338bf8fd', symptoms=[seizures], dateOfBirth=1983-08-15}\n+```\n+\n+Then query the appointments' resource to see the assigned doctor:\n+\n+```shell script\n+$ curl http://localhost:8080/onboarding/schedule/appointment | jq '.'\n+\n+[\n+  {\n+    \"doctor\": {\n+      \"id\": \"8293dc94-2386-11eb-adc1-0242ac120002\",\n+      \"name\": \"Maria Mind\",\n+      \"specialty\": \"Neurology\"\n+    },\n+    \"patient\": {\n+      \"name\": \"Mick\",\n+      \"id\": \"5560ed3d-becb-4f35-8c6a-2816338bf8fd\",\n+      \"symptoms\": [\n+        \"seizures\"\n+      ],\n+      \"dateOfBirth\": \"1983-08-15\",\n+      \"assignedDoctor\": {\n+        \"id\": \"8293dc94-2386-11eb-adc1-0242ac120002\",\n+        \"name\": \"Maria Mind\",\n+        \"specialty\": \"Neurology\"\n+      }\n+    },\n+    \"date\": \"2020-11-18 09:00\"\n+  }\n+]\n+```\n+\n+_**Note:** Please make sure you have [jq](https://stedolan.github.io/jq/download/) installed in your system to see the formatted output._\n+\n+### Compile and Run in JVM mode\n+\n+```text\n+mvn clean package \n+java -jar target/serverless-workflow-functions-quarkus-runner.jar   \n+```\n+\n+or on windows\n+\n+```text\n+mvn clean package\n+java -jar target\\serverless-workflow-functions-quarkus-runner.jar\n+```\n+\n+### Compile and Run using Local Native Image\n+Note that this requires GRAALVM_HOME to point to a valid GraalVM installation\n+\n+```text\n+mvn clean package -Pnative\n+```\n+  \n+To run the generated native executable, generated in `target/`, execute\n+\n+```text\n+./target/serverless-workflow-functions-quarkus-runner.jar\n+```\n+\n+## Deploying with Kogito Operator\n+\n+In the [`operator`](operator) directory you'll find the custom resources needed to deploy this example on OpenShift or Kubernetes with the [Kogito Operator](https://docs.jboss.org/kogito/release/latest/html_single/#chap_kogito-deploying-on-openshift).\n+", "originalCommit": "bca0879b8314d5d5923a24a50e0d9c8a23853d09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c4ff49e03222ed7dbac01e7183dac994d7cd1fd1", "url": "https://github.com/kiegroup/kogito-examples/commit/c4ff49e03222ed7dbac01e7183dac994d7cd1fd1", "message": "Apply suggestions from code review\n\nCo-authored-by: Tristan Radisson <tristan.radisson@gmail.com>", "committedDate": "2020-11-18T18:17:21Z", "type": "commit"}, {"oid": "5468ee2785ee755f9a8b6fd3ed91ea6f8c2e30e4", "url": "https://github.com/kiegroup/kogito-examples/commit/5468ee2785ee755f9a8b6fd3ed91ea6f8c2e30e4", "message": "removing nosense", "committedDate": "2020-11-18T18:19:26Z", "type": "commit"}]}