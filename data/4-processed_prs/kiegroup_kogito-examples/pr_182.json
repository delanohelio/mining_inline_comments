{"pr_number": 182, "pr_title": "KOGITO-1696: Set quarkus default ports to avoid conflicts", "pr_createdAt": "2020-04-03T13:44:20Z", "pr_url": "https://github.com/kiegroup/kogito-examples/pull/182", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg0NjE3OA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r403846178", "bodyText": "is quarkus.http.host actually needed? Default to 0.0.0.0 should be ok", "author": "cristianonicolai", "createdAt": "2020-04-06T06:00:55Z", "path": "onboarding-example/hr/pom.xml", "diffHunk": "@@ -49,10 +49,20 @@\n     <plugins>\n       <plugin>\n         <artifactId>maven-surefire-plugin</artifactId>\n+        <configuration>\n+          <systemProperties>\n+            <java.util.logging.manager>org.jboss.logmanager.LogManager</java.util.logging.manager>\n+            <quarkus.http.test-port>8081</quarkus.http.test-port>\n+          </systemProperties>\n+        </configuration>\n       </plugin>\n       <plugin>\n         <groupId>io.quarkus</groupId>\n         <artifactId>quarkus-maven-plugin</artifactId>\n+        <configuration>\n+          <debug>false</debug>\n+          <jvmArgs>-Dquarkus.http.port=8081 -Dquarkus.http.host=localhost</jvmArgs>", "originalCommit": "a055793673b35c28a9d304c0d25a815088ef49d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg1NDY0MQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r404854641", "bodyText": "good point, fixed", "author": "jomarko", "createdAt": "2020-04-07T14:29:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg0NjE3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r403882568", "bodyText": "Why do we need to set the port on surefire plugin ?\nthe tests on the different projects are executed in parallel ?", "author": "radtriste", "createdAt": "2020-04-06T07:31:40Z", "path": "onboarding-example/hr/pom.xml", "diffHunk": "@@ -49,10 +49,20 @@\n     <plugins>\n       <plugin>\n         <artifactId>maven-surefire-plugin</artifactId>\n+        <configuration>\n+          <systemProperties>\n+            <java.util.logging.manager>org.jboss.logmanager.LogManager</java.util.logging.manager>\n+            <quarkus.http.test-port>8081</quarkus.http.test-port>", "originalCommit": "a055793673b35c28a9d304c0d25a815088ef49d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg1NTkxNA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r404855914", "bodyText": "tests by default run 8081, but as we have three modules and one of them uses 8081 for real app it caused conflicts, this way each app uses same port for real app and tests so conflict shouldn't happen", "author": "jomarko", "createdAt": "2020-04-07T14:31:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg1NjQ0OA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r404856448", "bodyText": "@radtriste please let me know my message above makes sense", "author": "jomarko", "createdAt": "2020-04-07T14:32:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg2MDg5NA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r404860894", "bodyText": "my question would be: why do we have a conflict during the tests ?", "author": "radtriste", "createdAt": "2020-04-07T14:38:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg4MzU5NQ==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r404883595", "bodyText": "ok, let me try to explain\nbefore my changes\n\nI started module hr using mvn clean package quarkus:dev\ntests started on 8081, finished, dev mode remained active on 8080\nI started module payroll using mvn clean package quarkus:dev\ntests started on 8081, finished, dev mode failed because 8080 is used by hr\n\nwith my changes the conflict doesn't happen\nIs my usage wrong? I mean I followed command for starting modules from readme\nif that is the case please let e know I thikn we can then update readme files.", "author": "jomarko", "createdAt": "2020-04-07T15:06:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg5NjExOA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r404896118", "bodyText": "ah now I get it. so you just want the test and the app to be on the same port.\nCouldn't we just put directly the quarkus.http.port into src/main/resources/application.properties file from each project instead ?\nwe then would not need to set the port here or ? I think that file would be taken both by maven plugin when starting the app and during the test.", "author": "radtriste", "createdAt": "2020-04-07T15:22:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI0NjU1OA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r405246558", "bodyText": "+1 to add to application.properties", "author": "cristianonicolai", "createdAt": "2020-04-08T04:07:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI5Mjc4Mg==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r405292782", "bodyText": "@radtriste @cristianonicolai thank you for application.properties advice. I like this way! so I applied.\nHowever still needed to distinguish quarkus.http.port and quarkus.http.test-port, without quarkus.http.test-port tests always tried to use 8081 regardless quarkus.http.port value.", "author": "jomarko", "createdAt": "2020-04-08T06:44:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMwMzE0MA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r405303140", "bodyText": "@jomarko that's fine to also define the test-port but just bump with +1, as that helps running the tests without shutting down the app if running. I've done similar approach in Data Index, see: https://github.com/kiegroup/kogito-apps/blob/master/data-index/data-index-service/src/main/resources/application.properties#L11", "author": "cristianonicolai", "createdAt": "2020-04-08T07:08:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMyMTAyMA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r405321020", "bodyText": "@cristianonicolai good point, applied", "author": "jomarko", "createdAt": "2020-04-08T07:43:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMyNTE5MA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r405325190", "bodyText": "sorry for being a PITA but could we put the quarkus.http.test-port property into src/test/resources/application.properties ?", "author": "radtriste", "createdAt": "2020-04-08T07:50:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMyODQ5OA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r405328498", "bodyText": "@radtriste sure", "author": "jomarko", "createdAt": "2020-04-08T07:55:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTMzMTYzNw==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r405331637", "bodyText": "changes are pushed", "author": "jomarko", "createdAt": "2020-04-08T08:01:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTM1NzI0NA==", "url": "https://github.com/kiegroup/kogito-examples/pull/182#discussion_r405357244", "bodyText": "rebased", "author": "jomarko", "createdAt": "2020-04-08T08:43:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg4MjU2OA=="}], "type": "inlineReview"}, {"oid": "4dcdba72df241f327a052fc9497417dd1eb24549", "url": "https://github.com/kiegroup/kogito-examples/commit/4dcdba72df241f327a052fc9497417dd1eb24549", "message": "Use application.properties for port configuration", "committedDate": "2020-04-08T06:40:57Z", "type": "forcePushed"}, {"oid": "a1caa8fbe840c461a453d70d5d486477c8ce49d1", "url": "https://github.com/kiegroup/kogito-examples/commit/a1caa8fbe840c461a453d70d5d486477c8ce49d1", "message": "KOGITO-1696: Set quarkus default ports to avoid conflicts\n\nSet quarkus default ports for particular modules to avoid conflicts when running all modules\n- hr : 8081\n- payroll : 8082\n- onboarding : 8080\n\nFor more details see https://issues.redhat.com/browse/KOGITO-1696", "committedDate": "2020-04-08T08:38:55Z", "type": "commit"}, {"oid": "126dbf101ba78bd20b5e3f85b105d6c28f8156be", "url": "https://github.com/kiegroup/kogito-examples/commit/126dbf101ba78bd20b5e3f85b105d6c28f8156be", "message": "Peer review - do not re-declare default host", "committedDate": "2020-04-08T08:38:55Z", "type": "commit"}, {"oid": "c6b28126d2e6c289244bac3503373a0fda357986", "url": "https://github.com/kiegroup/kogito-examples/commit/c6b28126d2e6c289244bac3503373a0fda357986", "message": "Use application.properties for port configuration", "committedDate": "2020-04-08T08:40:14Z", "type": "commit"}, {"oid": "b14e286ed3389ea56b7465d55efdb3f87093b455", "url": "https://github.com/kiegroup/kogito-examples/commit/b14e286ed3389ea56b7465d55efdb3f87093b455", "message": "Offset ports and correct READMEs", "committedDate": "2020-04-08T08:40:46Z", "type": "commit"}, {"oid": "41e0d6f717a56c4a0e0ee38aeb274602a2cfd9b5", "url": "https://github.com/kiegroup/kogito-examples/commit/41e0d6f717a56c4a0e0ee38aeb274602a2cfd9b5", "message": "Split main and test application.properties", "committedDate": "2020-04-08T08:40:46Z", "type": "commit"}, {"oid": "41e0d6f717a56c4a0e0ee38aeb274602a2cfd9b5", "url": "https://github.com/kiegroup/kogito-examples/commit/41e0d6f717a56c4a0e0ee38aeb274602a2cfd9b5", "message": "Split main and test application.properties", "committedDate": "2020-04-08T08:40:46Z", "type": "forcePushed"}]}