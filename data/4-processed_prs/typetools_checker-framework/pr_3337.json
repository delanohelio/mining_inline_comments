{"pr_number": 3337, "pr_title": "Aliasing: test constructor declarations", "pr_createdAt": "2020-05-28T17:41:12Z", "pr_url": "https://github.com/typetools/checker-framework/pull/3337", "timeline": [{"oid": "fd536c4de755dc1c53adbca9ad2b684e9b39a055", "url": "https://github.com/typetools/checker-framework/commit/fd536c4de755dc1c53adbca9ad2b684e9b39a055", "message": "Fix for feature request #3313 in Aliasing Checker", "committedDate": "2020-05-28T06:30:02Z", "type": "commit"}, {"oid": "60354d3223c28321300e69e286014808322c7229", "url": "https://github.com/typetools/checker-framework/commit/60354d3223c28321300e69e286014808322c7229", "message": "FIx for leak in constructor in Aliasing Checker", "committedDate": "2020-05-28T06:47:37Z", "type": "commit"}, {"oid": "7794ac9d44dc5a829da591a2598f4739b301981d", "url": "https://github.com/typetools/checker-framework/commit/7794ac9d44dc5a829da591a2598f4739b301981d", "message": "Fix for unique.leaked warning on constructors (Feature request #3313) using .astub files, with test cases", "committedDate": "2020-05-28T16:23:41Z", "type": "commit"}, {"oid": "579d38555ffc4880dba9c18d537b255b1bb23306", "url": "https://github.com/typetools/checker-framework/commit/579d38555ffc4880dba9c18d537b255b1bb23306", "message": "Adding new line at end of file", "committedDate": "2020-05-28T18:30:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcxMzk4NQ==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r434713985", "bodyText": "Why is this annotation being added in a jdk.astub file rather than in the annotated JDK, https://github.com/typetools/jdk?", "author": "mernst", "createdAt": "2020-06-03T16:51:27Z", "path": "framework/src/main/java/org/checkerframework/common/aliasing/jdk.astub", "diffHunk": "@@ -0,0 +1,7 @@\n+import org.checkerframework.common.aliasing.qual.*;\n+\n+package java.lang;\n+\n+class Object {\n+    @Unique Object();", "originalCommit": "579d38555ffc4880dba9c18d537b255b1bb23306", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI2Mzk0Ng==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r436263946", "bodyText": "I added an .astub file to limit my changes to the Aliasing Checker directory itself and not disturb the workings of the other checkers. However, I have made changes in the annotated JDK and the resulting code still fixes the issue. It passed through all the checker tests but gives a \"build failed for target 'run-test'\" error in the build_jdk11u test when using Azure pipeline (not sure why).\nPull request : typetools/jdk#52", "author": "aditya3434", "createdAt": "2020-06-06T12:12:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcxMzk4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM4NTIzMg==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r436385232", "bodyText": "You should link related PRs from the PR descriptions, so that it is immediately clear that PRs need to be merged together.\nYou should remove this jdk.astub file from this PR now, as the changes from the related PR should be picked-up automatically.\nMake the one suggested update in the jdk project and let's see whether the build just needs to re-run.", "author": "wmdietl", "createdAt": "2020-06-07T17:36:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcxMzk4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU5Njc4MA==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r437596780", "bodyText": "I have removed the jdk.astub file from this PR and provided the link for the PR in description which needs to be merged together.", "author": "aditya3434", "createdAt": "2020-06-09T17:24:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDcxMzk4NQ=="}], "type": "inlineReview"}, {"oid": "8b2cd51eb983c99b6e8ab2521544e95608150497", "url": "https://github.com/typetools/checker-framework/commit/8b2cd51eb983c99b6e8ab2521544e95608150497", "message": "Merge ../checker-framework-branch-master into 3313-leak-in-constructor-error-fix", "committedDate": "2020-06-03T16:53:57Z", "type": "commit"}, {"oid": "22462e0c3106a97353ababcbcb9c547d061f9809", "url": "https://github.com/typetools/checker-framework/commit/22462e0c3106a97353ababcbcb9c547d061f9809", "message": "Fix for feature request #3313 in Aliasing Checker", "committedDate": "2020-06-05T10:48:41Z", "type": "commit"}, {"oid": "017082b1f6ac5598dfe80fad535acccebde22901", "url": "https://github.com/typetools/checker-framework/commit/017082b1f6ac5598dfe80fad535acccebde22901", "message": "Revert \"Fix for feature request #3313 in Aliasing Checker\"\n\nThis reverts commit fd536c4de755dc1c53adbca9ad2b684e9b39a055.", "committedDate": "2020-06-05T10:48:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIwMTIyMA==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r436201220", "bodyText": "How about adding a top-level class around these two classes that has the same name as the file?", "author": "wmdietl", "createdAt": "2020-06-05T23:07:43Z", "path": "framework/tests/aliasing/UniqueConstructorTest.java", "diffHunk": "@@ -0,0 +1,16 @@\n+import org.checkerframework.common.aliasing.qual.Unique;\n+\n+class ParentUniqueClass {", "originalCommit": "8b2cd51eb983c99b6e8ab2521544e95608150497", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI2MzAzOA==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r436263038", "bodyText": "I have added a top-level class around these two classes (with the same name) in my latest commit.", "author": "aditya3434", "createdAt": "2020-06-06T11:59:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIwMTIyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIwMTQ0NQ==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r436201445", "bodyText": "Can you add another subclass that does raise an error?", "author": "wmdietl", "createdAt": "2020-06-05T23:08:53Z", "path": "framework/tests/aliasing/UniqueConstructorTest.java", "diffHunk": "@@ -0,0 +1,16 @@\n+import org.checkerframework.common.aliasing.qual.Unique;\n+\n+class ParentUniqueClass {\n+\n+    // No need for @SuppressWarnings()\n+    @Unique ParentUniqueClass() {\n+        // Doesn't raise unique.leaked error since it's a parent class (top of heirarchy)\n+    }\n+}\n+\n+class ChildUniqueClass extends ParentUniqueClass {\n+\n+    @Unique ChildUniqueClass() {", "originalCommit": "8b2cd51eb983c99b6e8ab2521544e95608150497", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI2MzEwNQ==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r436263105", "bodyText": "In my latest commit, the ChildUniqueClass will raise an error since the ParentClass is not @unique.", "author": "aditya3434", "createdAt": "2020-06-06T12:00:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIwMTQ0NQ=="}], "type": "inlineReview"}, {"oid": "e97e1a75d968ba21746cdcbfa46de854c61bf4be", "url": "https://github.com/typetools/checker-framework/commit/e97e1a75d968ba21746cdcbfa46de854c61bf4be", "message": "Modifying test case", "committedDate": "2020-06-06T08:24:33Z", "type": "commit"}, {"oid": "8dd57dc8552f224f6f0f793bf09aa8774287563d", "url": "https://github.com/typetools/checker-framework/commit/8dd57dc8552f224f6f0f793bf09aa8774287563d", "message": "Merge branch 'master' into 3313-leak-in-constructor-error-fix", "committedDate": "2020-06-06T08:34:17Z", "type": "commit"}, {"oid": "cf8e5aeca18ce97dad46fef86b74cc2e4643f377", "url": "https://github.com/typetools/checker-framework/commit/cf8e5aeca18ce97dad46fef86b74cc2e4643f377", "message": "Modifying test case", "committedDate": "2020-06-06T08:38:45Z", "type": "commit"}, {"oid": "d9186500184273bb508da6a5cc8558621a8754aa", "url": "https://github.com/typetools/checker-framework/commit/d9186500184273bb508da6a5cc8558621a8754aa", "message": "Deleting jdk.astub file in Aliasing Checker", "committedDate": "2020-06-08T14:02:16Z", "type": "commit"}, {"oid": "97ff12d4b6dbfbfcb62d7d52815f1c90ea6900b9", "url": "https://github.com/typetools/checker-framework/commit/97ff12d4b6dbfbfcb62d7d52815f1c90ea6900b9", "message": "Fix for feature request #3313 in Aliasing Checker", "committedDate": "2020-06-11T07:53:26Z", "type": "commit"}, {"oid": "629a1a971c44ee9e2b268854f3767b91b28c2da0", "url": "https://github.com/typetools/checker-framework/commit/629a1a971c44ee9e2b268854f3767b91b28c2da0", "message": "Revert \"Fix for feature request #3313 in Aliasing Checker\"\n\nThis reverts commit fd536c4de755dc1c53adbca9ad2b684e9b39a055.", "committedDate": "2020-06-11T07:53:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQzNTY5Ng==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r440435696", "bodyText": "We had discussed earlier having one top-level class. You reverted that and again have multiple top-level classes.", "author": "wmdietl", "createdAt": "2020-06-15T20:43:56Z", "path": "framework/tests/aliasing/UniqueConstructorTest.java", "diffHunk": "@@ -0,0 +1,24 @@\n+import org.checkerframework.common.aliasing.qual.Unique;\n+\n+public class UniqueConstructorTest {", "originalCommit": "d9186500184273bb508da6a5cc8558621a8754aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgwMDk5OA==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r440800998", "bodyText": "Sorry for misunderstanding. I thought that we were discussing about the inheritance hierarchy (Parent extends UniqueConstructorTest and Child extends Parent, making UniqueConstructorTest the \"top\" level class). I have committed the required changes.", "author": "aditya3434", "createdAt": "2020-06-16T12:10:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQzNTY5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQzNTk4OQ==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r440435989", "bodyText": "That comment should be combined with the one in the body, where you give the reason why no warning is required.", "author": "wmdietl", "createdAt": "2020-06-15T20:44:32Z", "path": "framework/tests/aliasing/UniqueConstructorTest.java", "diffHunk": "@@ -0,0 +1,24 @@\n+import org.checkerframework.common.aliasing.qual.Unique;\n+\n+public class UniqueConstructorTest {\n+    // No need for @SuppressWarnings()", "originalCommit": "d9186500184273bb508da6a5cc8558621a8754aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgwMTM1OA==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r440801358", "bodyText": "I have combined the comment with the one in the body.", "author": "aditya3434", "createdAt": "2020-06-16T12:11:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQzNTk4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQzNjEyNg==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r440436126", "bodyText": "What does top parent class mean?", "author": "wmdietl", "createdAt": "2020-06-15T20:44:51Z", "path": "framework/tests/aliasing/UniqueConstructorTest.java", "diffHunk": "@@ -0,0 +1,24 @@\n+import org.checkerframework.common.aliasing.qual.Unique;\n+\n+public class UniqueConstructorTest {\n+    // No need for @SuppressWarnings()\n+    @Unique UniqueConstructorTest() {\n+        // Doesn't raise unique.leaked error since it's a top parent class (@Unique Object subclass", "originalCommit": "d9186500184273bb508da6a5cc8558621a8754aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgwNDI3MQ==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r440804271", "bodyText": "The Parent class extends UniqueConstructorTest and the Child class extends the parent class. Hence, I referred to the UniqueConstructorTest class as the \"top parent class\" (not related to the Parent class in the code) in the inheritance hierarchy. Since, it explicitly doesn't extend any class, it extends java.lang.Object class by default.", "author": "aditya3434", "createdAt": "2020-06-16T12:17:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQzNjEyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQzNjQ0Nw==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r440436447", "bodyText": "non-unique", "author": "wmdietl", "createdAt": "2020-06-15T20:45:31Z", "path": "framework/tests/aliasing/UniqueConstructorTest.java", "diffHunk": "@@ -0,0 +1,24 @@\n+import org.checkerframework.common.aliasing.qual.Unique;\n+\n+public class UniqueConstructorTest {\n+    // No need for @SuppressWarnings()\n+    @Unique UniqueConstructorTest() {\n+        // Doesn't raise unique.leaked error since it's a top parent class (@Unique Object subclass\n+        // by default)\n+    }\n+}\n+\n+class ParentClass extends UniqueConstructorTest {\n+\n+    ParentClass() {\n+        // Doesn't raise unique.leaked error since it's a non unique class with a unique parent", "originalCommit": "d9186500184273bb508da6a5cc8558621a8754aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDgwMjE5Nw==", "url": "https://github.com/typetools/checker-framework/pull/3337#discussion_r440802197", "bodyText": "I have made the correction in the comment", "author": "aditya3434", "createdAt": "2020-06-16T12:12:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQzNjQ0Nw=="}], "type": "inlineReview"}, {"oid": "9b0fd9c4ff6ff8b42a429673499d05c4c382093d", "url": "https://github.com/typetools/checker-framework/commit/9b0fd9c4ff6ff8b42a429673499d05c4c382093d", "message": "Modifying test case", "committedDate": "2020-06-16T11:13:26Z", "type": "commit"}, {"oid": "25b602a276a6d40e8510aeab62e952b6a1c2b44e", "url": "https://github.com/typetools/checker-framework/commit/25b602a276a6d40e8510aeab62e952b6a1c2b44e", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-06-16T11:49:22Z", "type": "commit"}, {"oid": "cacacc1b082ec120e89a84e166be6e11968dfd3b", "url": "https://github.com/typetools/checker-framework/commit/cacacc1b082ec120e89a84e166be6e11968dfd3b", "message": "Merge branch 'master' into 3313-leak-in-constructor-error-fix", "committedDate": "2020-06-16T12:20:47Z", "type": "commit"}, {"oid": "eb424fd817490cc389323adf5d721d39b0ad8533", "url": "https://github.com/typetools/checker-framework/commit/eb424fd817490cc389323adf5d721d39b0ad8533", "message": "Fix for feature request #3313 in Aliasing Checker", "committedDate": "2020-06-17T16:20:58Z", "type": "commit"}, {"oid": "c3240948aa8891c016b04e627e15f0505cfaf18f", "url": "https://github.com/typetools/checker-framework/commit/c3240948aa8891c016b04e627e15f0505cfaf18f", "message": "Revert \"Fix for feature request #3313 in Aliasing Checker\"\n\nThis reverts commit fd536c4de755dc1c53adbca9ad2b684e9b39a055.", "committedDate": "2020-06-17T16:20:58Z", "type": "commit"}, {"oid": "941cab0d71c66e682d99347b2604d104331d34b8", "url": "https://github.com/typetools/checker-framework/commit/941cab0d71c66e682d99347b2604d104331d34b8", "message": "Fix for feature request #3313 in Aliasing Checker", "committedDate": "2020-06-17T16:20:58Z", "type": "commit"}, {"oid": "d71f60820a8e44e21b9f1cc542cb798958006dc3", "url": "https://github.com/typetools/checker-framework/commit/d71f60820a8e44e21b9f1cc542cb798958006dc3", "message": "Revert \"Fix for feature request #3313 in Aliasing Checker\"\n\nThis reverts commit fd536c4de755dc1c53adbca9ad2b684e9b39a055.", "committedDate": "2020-06-17T16:20:58Z", "type": "commit"}, {"oid": "53a6c12b02f9cbde8742bf4e1f69f2139eed1b94", "url": "https://github.com/typetools/checker-framework/commit/53a6c12b02f9cbde8742bf4e1f69f2139eed1b94", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-06-19T16:01:19Z", "type": "commit"}, {"oid": "21f91a837a3205595898903782b9973fcbbf82dd", "url": "https://github.com/typetools/checker-framework/commit/21f91a837a3205595898903782b9973fcbbf82dd", "message": "Fix comments", "committedDate": "2020-06-23T18:21:57Z", "type": "commit"}, {"oid": "c692aec6b185961d76041db1a659a7342a74614c", "url": "https://github.com/typetools/checker-framework/commit/c692aec6b185961d76041db1a659a7342a74614c", "message": "Merge ../checker-framework-branch-master into 3313-leak-in-constructor-error-fix", "committedDate": "2020-06-24T20:54:51Z", "type": "commit"}, {"oid": "4bfe4454601a203c236f0940f442830f26cf0977", "url": "https://github.com/typetools/checker-framework/commit/4bfe4454601a203c236f0940f442830f26cf0977", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-06-26T12:35:52Z", "type": "commit"}, {"oid": "7b431cb47345898536df0a580e60f8342b3f4bc4", "url": "https://github.com/typetools/checker-framework/commit/7b431cb47345898536df0a580e60f8342b3f4bc4", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-06-26T15:01:27Z", "type": "commit"}, {"oid": "995522cebe09329be8ef87e8a027767ba35061fd", "url": "https://github.com/typetools/checker-framework/commit/995522cebe09329be8ef87e8a027767ba35061fd", "message": "Merge branch 'master' into 3313-leak-in-constructor-error-fix", "committedDate": "2020-06-26T15:02:53Z", "type": "commit"}, {"oid": "5abefa5b196671a1ed17dc4affa1a3aa3f8673c8", "url": "https://github.com/typetools/checker-framework/commit/5abefa5b196671a1ed17dc4affa1a3aa3f8673c8", "message": "Merge branch '3313-leak-in-constructor-error-fix' of https://github.com/aditya3434/checker-framework into 3313-leak-in-constructor-error-fix", "committedDate": "2020-06-26T15:06:04Z", "type": "commit"}]}