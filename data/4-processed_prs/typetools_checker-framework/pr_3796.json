{"pr_number": 3796, "pr_title": "Add task to run JSpecify tests", "pr_createdAt": "2020-10-17T20:03:17Z", "pr_url": "https://github.com/typetools/checker-framework/pull/3796", "timeline": [{"oid": "081cc8970c7545e263fdcabf0d7b8e0735404d16", "url": "https://github.com/typetools/checker-framework/commit/081cc8970c7545e263fdcabf0d7b8e0735404d16", "message": "Tweaks to test infrastructure", "committedDate": "2020-10-17T00:29:04Z", "type": "commit"}, {"oid": "b0b75495480a7dd709a42ae9e0765dfc7520b964", "url": "https://github.com/typetools/checker-framework/commit/b0b75495480a7dd709a42ae9e0765dfc7520b964", "message": "JSpecify tests", "committedDate": "2020-10-17T02:51:03Z", "type": "commit"}, {"oid": "864f5c3b6e2dc7470e70408f1ea9a5a305c663e5", "url": "https://github.com/typetools/checker-framework/commit/864f5c3b6e2dc7470e70408f1ea9a5a305c663e5", "message": "Javadoc fixes", "committedDate": "2020-10-17T05:21:43Z", "type": "commit"}, {"oid": "779c83e13a37953adb30b05ef19af8c504ef2d86", "url": "https://github.com/typetools/checker-framework/commit/779c83e13a37953adb30b05ef19af8c504ef2d86", "message": "Disable assertion that directory with test files exists", "committedDate": "2020-10-17T05:31:09Z", "type": "commit"}, {"oid": "ac6f01457c91067946ff7df83103d51621f1a2a7", "url": "https://github.com/typetools/checker-framework/commit/ac6f01457c91067946ff7df83103d51621f1a2a7", "message": "Merge ../checker-framework-fork-mernst-branch-tests into jspecify-tests", "committedDate": "2020-10-17T05:34:04Z", "type": "commit"}, {"oid": "51d8f32bfb9e14ea48d974e84e833da8c840f824", "url": "https://github.com/typetools/checker-framework/commit/51d8f32bfb9e14ea48d974e84e833da8c840f824", "message": "Disable JSpecify tests by default", "committedDate": "2020-10-17T14:54:14Z", "type": "commit"}, {"oid": "85ef16cda9cb9fbeef5317a596edf5e269a151ee", "url": "https://github.com/typetools/checker-framework/commit/85ef16cda9cb9fbeef5317a596edf5e269a151ee", "message": "Remove one instance of duplicate code", "committedDate": "2020-10-17T16:10:25Z", "type": "commit"}, {"oid": "3c73f23957e671e37bfbb30c534779b9a05b657b", "url": "https://github.com/typetools/checker-framework/commit/3c73f23957e671e37bfbb30c534779b9a05b657b", "message": "Fix test for JDK version", "committedDate": "2020-10-17T19:30:13Z", "type": "commit"}, {"oid": "44d94bfe2b8473564a4410b325ea772f3efb1e0a", "url": "https://github.com/typetools/checker-framework/commit/44d94bfe2b8473564a4410b325ea772f3efb1e0a", "message": "Merge ../checker-framework-branch-master into jspecify-tests", "committedDate": "2020-10-17T19:35:22Z", "type": "commit"}, {"oid": "4324bd367cf4890e19a4cf26149cd378d979780e", "url": "https://github.com/typetools/checker-framework/commit/4324bd367cf4890e19a4cf26149cd378d979780e", "message": "Fix cut-and-paste typo", "committedDate": "2020-10-17T19:36:43Z", "type": "commit"}, {"oid": "1623e61b5cdf55a4de62f2083126c547bbc20a2a", "url": "https://github.com/typetools/checker-framework/commit/1623e61b5cdf55a4de62f2083126c547bbc20a2a", "message": "Issue error if cannot find java", "committedDate": "2020-10-17T19:38:42Z", "type": "commit"}, {"oid": "4314d799f7721969a4bce172c59e6f2597adddf4", "url": "https://github.com/typetools/checker-framework/commit/4314d799f7721969a4bce172c59e6f2597adddf4", "message": "Tweaks", "committedDate": "2020-10-17T19:48:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg4NzQ4Ng==", "url": "https://github.com/typetools/checker-framework/pull/3796#discussion_r507887486", "bodyText": "The exclude takes a file path, not a class name.", "author": "smillst", "createdAt": "2020-10-19T16:25:36Z", "path": "checker/build.gradle", "diffHunk": "@@ -247,6 +247,15 @@ task jtregJdk11Tests(dependsOn: ':downloadJtreg', group: 'Verification') {\n     }\n }\n \n+// JSpecify tests are excluded by default.  To run them:\n+// ./gradlew NullnessJspecifySamplesTest\n+test {\n+    // The fully-qualified name does not work.  I'm not sure why.", "originalCommit": "4314d799f7721969a4bce172c59e6f2597adddf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg4ODE1Nw==", "url": "https://github.com/typetools/checker-framework/pull/3796#discussion_r507888157", "bodyText": "You also need to have jspecify installed in a sibling directory.", "author": "smillst", "createdAt": "2020-10-19T16:26:36Z", "path": "checker/src/test/java/org/checkerframework/checker/test/junit/NullnessJspecifySamplesTest.java", "diffHunk": "@@ -0,0 +1,133 @@\n+package org.checkerframework.checker.test.junit;\n+\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import org.checkerframework.framework.test.CheckerFrameworkPerDirectoryTest;\n+import org.checkerframework.framework.test.TypecheckResult;\n+import org.checkerframework.framework.test.diagnostics.DiagnosticKind;\n+import org.checkerframework.framework.test.diagnostics.TestDiagnostic;\n+import org.checkerframework.javacutil.BugInCF;\n+import org.junit.runners.Parameterized.Parameters;\n+\n+/**\n+ * JUnit tests for the Nullness Checker -- test the Jspecify samples. To run this test:", "originalCommit": "4314d799f7721969a4bce172c59e6f2597adddf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg5MTEyNA==", "url": "https://github.com/typetools/checker-framework/pull/3796#discussion_r507891124", "bodyText": "This should be \"../../../jspecify/samples\".", "author": "smillst", "createdAt": "2020-10-19T16:31:07Z", "path": "checker/src/test/java/org/checkerframework/checker/test/junit/NullnessJspecifySamplesTest.java", "diffHunk": "@@ -0,0 +1,133 @@\n+package org.checkerframework.checker.test.junit;\n+\n+import java.io.File;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import org.checkerframework.framework.test.CheckerFrameworkPerDirectoryTest;\n+import org.checkerframework.framework.test.TypecheckResult;\n+import org.checkerframework.framework.test.diagnostics.DiagnosticKind;\n+import org.checkerframework.framework.test.diagnostics.TestDiagnostic;\n+import org.checkerframework.javacutil.BugInCF;\n+import org.junit.runners.Parameterized.Parameters;\n+\n+/**\n+ * JUnit tests for the Nullness Checker -- test the Jspecify samples. To run this test:\n+ *\n+ * <pre>{@code\n+ * ./gradlew :checker:NullnessJspecifySamples\n+ * }</pre>\n+ */\n+public class NullnessJspecifySamplesTest extends CheckerFrameworkPerDirectoryTest {\n+\n+    /**\n+     * Create a NullnessJspecifySamplesTest.\n+     *\n+     * @param testFiles the files containing test code, which will be type-checked\n+     */\n+    public NullnessJspecifySamplesTest(List<File> testFiles) {\n+        super(\n+                testFiles,\n+                org.checkerframework.checker.nullness.NullnessChecker.class,\n+                \"nullness\",", "originalCommit": "4314d799f7721969a4bce172c59e6f2597adddf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "61985e92b13591d4fcacaf4e09d35e143eeb5ae3", "url": "https://github.com/typetools/checker-framework/commit/61985e92b13591d4fcacaf4e09d35e143eeb5ae3", "message": "Address code review feedback", "committedDate": "2020-10-19T17:51:01Z", "type": "commit"}, {"oid": "2870237bc917daa4e459ec2e746d361181f270fd", "url": "https://github.com/typetools/checker-framework/commit/2870237bc917daa4e459ec2e746d361181f270fd", "message": "Fix glob", "committedDate": "2020-10-19T18:25:51Z", "type": "commit"}, {"oid": "6b36619dff75d7634881ddaee9f813068caabe8e", "url": "https://github.com/typetools/checker-framework/commit/6b36619dff75d7634881ddaee9f813068caabe8e", "message": "Tweak glob", "committedDate": "2020-10-19T18:54:31Z", "type": "commit"}, {"oid": "4598b4d19017bb8eeff570ccdf22271c3417dba6", "url": "https://github.com/typetools/checker-framework/commit/4598b4d19017bb8eeff570ccdf22271c3417dba6", "message": "Prefix the glob", "committedDate": "2020-10-19T20:44:37Z", "type": "commit"}, {"oid": "1ac7e8f31bd6d373c0618ac8634be7b67ef886eb", "url": "https://github.com/typetools/checker-framework/commit/1ac7e8f31bd6d373c0618ac8634be7b67ef886eb", "message": "Tweak the lovely glob", "committedDate": "2020-10-19T22:09:14Z", "type": "commit"}]}