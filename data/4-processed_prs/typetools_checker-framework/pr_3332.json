{"pr_number": 3332, "pr_title": "Add Annotation File Utilities as an included build.", "pr_createdAt": "2020-05-27T16:02:16Z", "pr_url": "https://github.com/typetools/checker-framework/pull/3332", "timeline": [{"oid": "d5d6c30f2db026b9bb1d7b04374a95e7af2b9ab9", "url": "https://github.com/typetools/checker-framework/commit/d5d6c30f2db026b9bb1d7b04374a95e7af2b9ab9", "message": "Use AFU in local Maven repo.", "committedDate": "2020-05-26T20:05:54Z", "type": "commit"}, {"oid": "d36247f25382a858105d5b11d5a1154c30fd7a20", "url": "https://github.com/typetools/checker-framework/commit/d36247f25382a858105d5b11d5a1154c30fd7a20", "message": "Add Guava dependency.", "committedDate": "2020-05-26T21:34:24Z", "type": "commit"}, {"oid": "14c5af9ed7d20d5e4cf58c4a9bc5bbfdf27400ff", "url": "https://github.com/typetools/checker-framework/commit/14c5af9ed7d20d5e4cf58c4a9bc5bbfdf27400ff", "message": "Merge remote-tracking branch 'origin/master' into maven", "committedDate": "2020-05-27T16:39:33Z", "type": "commit"}, {"oid": "a9a2ecdebda2564b596ba5dd9707264a2da04294", "url": "https://github.com/typetools/checker-framework/commit/a9a2ecdebda2564b596ba5dd9707264a2da04294", "message": "Fix dependencies.", "committedDate": "2020-05-27T16:50:19Z", "type": "commit"}, {"oid": "f4ad474f127adf76a4b0b7ff51a59896f17f1fb4", "url": "https://github.com/typetools/checker-framework/commit/f4ad474f127adf76a4b0b7ff51a59896f17f1fb4", "message": "Don't require installing AFU to local repository.", "committedDate": "2020-05-27T20:04:24Z", "type": "commit"}, {"oid": "7fa264708b95411b1455317c448ec6adee8ea7cb", "url": "https://github.com/typetools/checker-framework/commit/7fa264708b95411b1455317c448ec6adee8ea7cb", "message": "AFU version number doesn't matter.", "committedDate": "2020-05-27T20:12:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjEyNTI0Nw==", "url": "https://github.com/typetools/checker-framework/pull/3332#discussion_r432125247", "bodyText": "spacing", "author": "smillst", "createdAt": "2020-05-28T21:09:59Z", "path": "settings.gradle", "diffHunk": "@@ -6,4 +6,10 @@ include 'framework'\n include 'checker-qual'\n include 'checker-qual-android'\n include 'framework-test'\n-\n+includeBuild ('../annotation-tools/annotation-file-utilities'){\n+    if(!file('../annotation-tools/annotation-file-utilities').exists()) {", "originalCommit": "7fa264708b95411b1455317c448ec6adee8ea7cb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c15e004556506a474bd81b1574a3ce8e2fd85f6c", "url": "https://github.com/typetools/checker-framework/commit/c15e004556506a474bd81b1574a3ce8e2fd85f6c", "message": "Fix spacing", "committedDate": "2020-05-28T21:42:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjEzOTQ0OQ==", "url": "https://github.com/typetools/checker-framework/pull/3332#discussion_r432139449", "bodyText": "This seems to be a bug in how the annotated version of Guava was made.  I don't understand it yet.\nIn the meanwhile, can you try the workaround used in AFU, which is to add a dependency on error_prone_annotations?", "author": "mernst", "createdAt": "2020-05-28T21:39:34Z", "path": "framework/build.gradle", "diffHunk": "@@ -25,12 +25,24 @@ dependencies {\n     implementation project(':dataflow')\n     implementation project(':javacutil')\n     implementation files(\"${stubparserJar}\")\n-    implementation files(\"${afuJar}\")\n+    // AFU is an \"includedBuild\" imported in checker-framework/settings.gradle, so the version number doesn't matter.\n+    // https://docs.gradle.org/current/userguide/composite_builds.html#settings_defined_composite\n+    implementation('org.checkerframework:annotation-file-utilities:*') {\n+        exclude group: 'com.google', module: 'javac'\n+    }\n     implementation project(':checker-qual')\n-    // As of 2019/12/16, the version of reflection-util in the Annotation\n-    // File Utilities takes priority over this version, in the fat jar\n-    // file. :-( So update it and re-build it locally when updating this.\n     implementation 'org.plumelib:reflection-util:0.2.2'\n+    implementation 'org.plumelib:plume-util:1.1.4'\n+\n+    // TODO: The annotated version of Guava gives an error:\n+    // org.checkerframework.annotatedlib/guava/.../guava-28.2-jre.jar(/com/google/common/collect/ImmutableCollection.class):\n+    // warning: Cannot find annotation method 'value()' in type 'DoNotMock': class file for com.google.errorprone.annotations.DoNotMock not found", "originalCommit": "7fa264708b95411b1455317c448ec6adee8ea7cb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a088ef6f956c2e8aa999573fea3c5865c42341a1", "url": "https://github.com/typetools/checker-framework/commit/a088ef6f956c2e8aa999573fea3c5865c42341a1", "message": "Merge remote-tracking branch 'origin/master' into maven", "committedDate": "2020-05-29T16:55:02Z", "type": "commit"}, {"oid": "a12eff940ab177a4fb84014111cd094eb1e3e0ff", "url": "https://github.com/typetools/checker-framework/commit/a12eff940ab177a4fb84014111cd094eb1e3e0ff", "message": "Fix Guava dependendency.", "committedDate": "2020-05-29T17:07:27Z", "type": "commit"}]}