{"pr_number": 1310, "pr_title": "KYLIN-4621 Avoid annoying log message when build cube and query", "pr_createdAt": "2020-07-08T02:27:27Z", "pr_url": "https://github.com/apache/kylin/pull/1310", "timeline": [{"oid": "48f793505614c0556f286f492a41f3b6fb3b2fc5", "url": "https://github.com/apache/kylin/commit/48f793505614c0556f286f492a41f3b6fb3b2fc5", "message": "KYLIN-4621 Avoid annoying log message when build cube and query", "committedDate": "2020-07-08T02:28:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwODY4NQ==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r451408685", "bodyText": "I am not really sure, but I want to ask why not write log into a file?", "author": "hit-lacus", "createdAt": "2020-07-08T09:28:11Z", "path": "build/conf/kylin-parquet-log4j.properties", "diffHunk": "@@ -0,0 +1,31 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#  \n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#  \n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+#\n+\n+\n+#overall config\n+log4j.rootLogger=WARN,hdfs,stdout\n+log4j.logger.org.apache.kylin=DEBUG\n+log4j.logger.org.springframework=WARN\n+log4j.logger.org.springframework.security=WARN\n+log4j.logger.org.apache.spark=WARN\n+log4j.logger.org.apache.spark.ContextCleaner=WARN\n+\n+log4j.appender.stdout=org.apache.log4j.ConsoleAppender", "originalCommit": "48f793505614c0556f286f492a41f3b6fb3b2fc5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk3NjU3MA==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r451976570", "bodyText": "This log4j configuration file is used for Spark job. If the job is submitted to yarn. The normal file appender cannot be used.\nWe need to extend a new appender by ourselves to let the log of spark job(both driver and executor) write into HDFS which can be realized in the future.\nKylin submit a spark job by a command executor client. It will gather the output of spark job and save into kylin.log  .", "author": "RupengWang", "createdAt": "2020-07-09T05:44:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwODY4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYyNjg5Nw==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r452626897", "bodyText": "OK", "author": "hit-lacus", "createdAt": "2020-07-10T05:18:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwODY4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwODk1NA==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r451408954", "bodyText": "What is hdfs?", "author": "hit-lacus", "createdAt": "2020-07-08T09:28:37Z", "path": "build/conf/kylin-parquet-log4j.properties", "diffHunk": "@@ -0,0 +1,31 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#  \n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#  \n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+#\n+\n+\n+#overall config\n+log4j.rootLogger=WARN,hdfs,stdout", "originalCommit": "48f793505614c0556f286f492a41f3b6fb3b2fc5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk3NjQ2MA==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r451976460", "bodyText": "Sorry, it means nothing, I will delete it.", "author": "RupengWang", "createdAt": "2020-07-09T05:44:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQwODk1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQxMDU0Ng==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r451410546", "bodyText": "In which case did $KYLIN_HOME/server/conf exists?", "author": "hit-lacus", "createdAt": "2020-07-08T09:31:19Z", "path": "core-common/src/main/java/org/apache/kylin/common/KylinConfigBase.java", "diffHunk": "@@ -2712,6 +2714,22 @@ public boolean isSparkEngineEnabled() {\n         return Boolean.parseBoolean(getOptional(\"kylin.query.spark-engine.enabled\", \"true\"));\n     }\n \n+    public String getLogSparkPropertiesFile() {\n+        return getLogPropertyFile(\"kylin-parquet-log4j.properties\");\n+    }\n+\n+    private String getLogPropertyFile(String filename) {\n+        String parentFolder;\n+        if (isDevEnv()) {\n+            parentFolder = Paths.get(getKylinHomeWithoutWarn(), \"build\", \"conf\").toString();\n+        } else if (Files.exists(Paths.get(getKylinHomeWithoutWarn(), \"conf\", filename))) {\n+            parentFolder = Paths.get(getKylinHomeWithoutWarn(), \"conf\").toString();\n+        } else {\n+            parentFolder = Paths.get(getKylinHomeWithoutWarn(), \"server\", \"conf\").toString();", "originalCommit": "48f793505614c0556f286f492a41f3b6fb3b2fc5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "992797fe4ef0a5d94cabe3690480692bdb17be59", "url": "https://github.com/apache/kylin/commit/992797fe4ef0a5d94cabe3690480692bdb17be59", "message": "KYLIN-4621 Avoid annoying log message when build cube and query", "committedDate": "2020-07-09T05:45:31Z", "type": "forcePushed"}, {"oid": "0064043292b1af84e655074c294f5c73d6f07392", "url": "https://github.com/apache/kylin/commit/0064043292b1af84e655074c294f5c73d6f07392", "message": "KYLIN-4621 Avoid annoying log message when build cube and query", "committedDate": "2020-07-09T06:06:23Z", "type": "forcePushed"}, {"oid": "dd3d5144ede51e386d75841a09d0d93ed1a18614", "url": "https://github.com/apache/kylin/commit/dd3d5144ede51e386d75841a09d0d93ed1a18614", "message": "KYLIN-4621 Avoid annoying log message when build cube and query", "committedDate": "2020-07-09T06:11:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMwNjM4Nw==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r452306387", "bodyText": "should default is info?", "author": "bigxiaochu", "createdAt": "2020-07-09T15:32:29Z", "path": "build/conf/kylin-parquet-log4j.properties", "diffHunk": "@@ -0,0 +1,31 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#  \n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#  \n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+#\n+\n+\n+#overall config\n+log4j.rootLogger=WARN,stdout\n+log4j.logger.org.apache.kylin=DEBUG", "originalCommit": "dd3d5144ede51e386d75841a09d0d93ed1a18614", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMwODY1MQ==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r452308651", "bodyText": "why not INFO for default\uff1f", "author": "bigxiaochu", "createdAt": "2020-07-09T15:35:44Z", "path": "build/conf/kylin-server-log4j.properties", "diffHunk": "@@ -38,6 +38,7 @@ log4j.rootLogger=INFO\n log4j.logger.org.apache.kylin=DEBUG,file", "originalCommit": "dd3d5144ede51e386d75841a09d0d93ed1a18614", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYyNjgwOA==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r452626808", "bodyText": "When user met some exceptions, they can find more detail which maybe helpful for cause analysis .", "author": "hit-lacus", "createdAt": "2020-07-10T05:18:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMwODY1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjc4NTE1Mg==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r452785152", "bodyText": "When user met some exceptions, they can find more detail which maybe helpful for cause analysis .\n\nIf some logs are needed for default, they should use log.info .\nDDEBUG  is only needed by  test or debug problem\u3002", "author": "bigxiaochu", "createdAt": "2020-07-10T11:25:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMwODY1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMwOTA1NQ==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r452309055", "bodyText": "same\uff0c why not info\uff1f", "author": "bigxiaochu", "createdAt": "2020-07-09T15:36:19Z", "path": "build/conf/kylin-tools-log4j.properties", "diffHunk": "@@ -35,4 +35,7 @@ log4j.appender.stderr.layout.ConversionPattern=%d{ISO8601} %-5p [%t] %c{2}:%L :\n #log4j.logger.org.apache.hadoop=ERROR\n log4j.logger.org.apache.kylin=DEBUG", "originalCommit": "dd3d5144ede51e386d75841a09d0d93ed1a18614", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMxMDc5MA==", "url": "https://github.com/apache/kylin/pull/1310#discussion_r452310790", "bodyText": "remove diff\uff1f", "author": "bigxiaochu", "createdAt": "2020-07-09T15:38:55Z", "path": "core-common/src/main/resources/kylin-defaults.properties", "diffHunk": "@@ -345,6 +346,7 @@ kylin.engine.spark-conf-mergedict.spark.memory.fraction=0.2\n kylin.query.spark-conf.spark.executor.cores=5\n kylin.query.spark-conf.spark.executor.instances=4\n \n+", "originalCommit": "dd3d5144ede51e386d75841a09d0d93ed1a18614", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a7a52f6bf677a80d0da8db9c77f2d418787a155f", "url": "https://github.com/apache/kylin/commit/a7a52f6bf677a80d0da8db9c77f2d418787a155f", "message": "KYLIN-4621 Avoid annoying log message when build cube and query", "committedDate": "2020-07-10T06:11:09Z", "type": "forcePushed"}, {"oid": "1abbbeea5ed07444387d08dd7736b124472a6c11", "url": "https://github.com/apache/kylin/commit/1abbbeea5ed07444387d08dd7736b124472a6c11", "message": "KYLIN-4621 Avoid annoying log message when build cube and query", "committedDate": "2020-07-10T10:18:18Z", "type": "commit"}, {"oid": "1abbbeea5ed07444387d08dd7736b124472a6c11", "url": "https://github.com/apache/kylin/commit/1abbbeea5ed07444387d08dd7736b124472a6c11", "message": "KYLIN-4621 Avoid annoying log message when build cube and query", "committedDate": "2020-07-10T10:18:18Z", "type": "forcePushed"}]}