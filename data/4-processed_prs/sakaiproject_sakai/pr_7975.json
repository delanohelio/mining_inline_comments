{"pr_number": 7975, "pr_title": "SAK-43319 Fixed various grade types in Grader.", "pr_createdAt": "2020-03-04T17:08:27Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/7975", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE2Nzk3OQ==", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388167979", "bodyText": "Please, remove this. Thanks!", "author": "jesusmmp", "createdAt": "2020-03-05T09:23:38Z", "path": "assignment/tool/pom.xml", "diffHunk": "@@ -36,10 +36,10 @@\n             <groupId>${project.groupId}</groupId>\n             <artifactId>sakai-assignment-api</artifactId>\n         </dependency>\n-        <dependency>\n+        <!--dependency>", "originalCommit": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE2ODg5Mw==", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388168893", "bodyText": "will do!", "author": "adrianfish", "createdAt": "2020-03-05T09:25:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE2Nzk3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDA0Nw==", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388170047", "bodyText": "Spacing...", "author": "jesusmmp", "createdAt": "2020-03-05T09:27:13Z", "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "diffHunk": "@@ -427,11 +427,18 @@ public AssignmentSubmission gradeSubmission(AssignmentSubmission submission, Str\n \n             String siteId = (String) options.get(\"siteId\");\n \n+            Map<String, String> rubricsParams\n+                = options.entrySet().stream().filter(e -> e.getKey().startsWith(\"rbcs\"))\n+                    .collect(Collectors.toMap(e -> e.getKey(), e -> (String) e.getValue()));\n+\n             // Persist the rubric evaluations\n-            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId())){\n+            if (!rubricsParams.isEmpty()) {\n+            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId(), siteId)){", "originalCommit": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDgzMQ==", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388170831", "bodyText": "good spot, forgot that.", "author": "adrianfish", "createdAt": "2020-03-05T09:28:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDA0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODE3MDE5MA==", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388170190", "bodyText": "Please, remove this. Thanks!", "author": "jesusmmp", "createdAt": "2020-03-05T09:27:29Z", "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentToolUtils.java", "diffHunk": "@@ -427,11 +427,18 @@ public AssignmentSubmission gradeSubmission(AssignmentSubmission submission, Str\n \n             String siteId = (String) options.get(\"siteId\");\n \n+            Map<String, String> rubricsParams\n+                = options.entrySet().stream().filter(e -> e.getKey().startsWith(\"rbcs\"))\n+                    .collect(Collectors.toMap(e -> e.getKey(), e -> (String) e.getValue()));\n+\n             // Persist the rubric evaluations\n-            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId())){\n+            if (!rubricsParams.isEmpty()) {\n+            if (rubricsService.hasAssociatedRubric(RubricsConstants.RBCS_TOOL_ASSIGNMENT, submission.getAssignment().getId(), siteId)){\n+                /*", "originalCommit": "ce36b0ea3bec4562fd6b395a29b716d220a1a1f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "292de9ec1745c57bb0c0d99ff291284785700a6a", "url": "https://github.com/sakaiproject/sakai/commit/292de9ec1745c57bb0c0d99ff291284785700a6a", "message": "SAK-43319 Fixed various grade types in Grader.\n\nhttps://jira.sakaiproject.org/browse/SAK-43319\n\nReusing Assignments i18n bundle\n\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker", "committedDate": "2020-03-05T10:57:05Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODI0NTIzMQ==", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388245231", "bodyText": "Please @adrianfish, could you remove 429, 431 and 438?. Thanks!", "author": "jesusmmp", "createdAt": "2020-03-05T11:50:28Z", "path": "webcomponents/tool/src/main/frontend/grader/sakai-grader.js", "diffHunk": "@@ -386,43 +420,51 @@ class SakaiGrader extends gradableDataMixin(SakaiElement) {\n       height: height,\n       startupFocus: true,\n     });\n-    editor.on(\"change\", () => this.modified = true);\n+    editor.on(\"change\", () => this.modified = true );\n     return editor;\n   }\n \n   toggleInlineFeedback(e, cancelling) {\n \n-    if (!this.inlineFeedbackMode) {\n-      this.inlineFeedbackMode = true;\n+    //if (!this.inlineFeedbackMode) {", "originalCommit": "292de9ec1745c57bb0c0d99ff291284785700a6a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODI0NTQwNQ==", "url": "https://github.com/sakaiproject/sakai/pull/7975#discussion_r388245405", "bodyText": "Please, remove this one too. Thanks", "author": "jesusmmp", "createdAt": "2020-03-05T11:50:51Z", "path": "webcomponents/tool/src/main/frontend/grader/sakai-grader.js", "diffHunk": "@@ -170,6 +191,9 @@ class SakaiGrader extends gradableDataMixin(SakaiElement) {\n   renderSaved() {\n     return html`<span class=\"saved fa fa-check-circle\" title=\"${this.i18n[\"saved_successfully\"]}\" style=\"display: ${this.saved ? \"inline\" : \"none\"};\"></span>`;\n   }\n+            //<a href=\"javascript:;\" id=\"grader-rubric-link\" @click=${this.toggleRubric} title=\"${this.assignmentsI18n[\"grading_rubric\"]}\">", "originalCommit": "292de9ec1745c57bb0c0d99ff291284785700a6a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff", "url": "https://github.com/sakaiproject/sakai/commit/bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff", "message": "SAK-43319 Fixed various grade types in Grader.\n\nhttps://jira.sakaiproject.org/browse/SAK-43319\n\nReusing Assignments i18n bundle\n\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker", "committedDate": "2020-03-05T12:31:26Z", "type": "commit"}, {"oid": "bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff", "url": "https://github.com/sakaiproject/sakai/commit/bb2e6ff4d2e892d136c2969f57fc85ccd746d5ff", "message": "SAK-43319 Fixed various grade types in Grader.\n\nhttps://jira.sakaiproject.org/browse/SAK-43319\n\nReusing Assignments i18n bundle\n\ndialog feedback working ok\ninline feedback working\nprivate notes and cancel working better\nrubric saving working\nAdded rubric grader button\nfixed date picker", "committedDate": "2020-03-05T12:31:26Z", "type": "forcePushed"}]}