{"pr_number": 8307, "pr_title": "SAK-43826: Rubrics - Support weighted criterions", "pr_createdAt": "2020-06-22T10:20:16Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8307", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ1OTg4NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443459885", "bodyText": "Looks like there's a label missing for this input. That makes it hard for people using screen readers or voice control to use the input.", "author": "accesslint", "createdAt": "2020-06-22T10:20:25Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">\n+                      ${this.validWeight ? html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\">\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </label>\n+                        <input\n+                          id=\"weight_input_${c.id}\"\n+                          data-criterion-id=\"${c.id}\"\n+                          type=\"text\"\n+                          class=\"form-control\"\n+                          placeholder=\"0.0\"\n+                          style=\"max-width: 60px; text-align: center;margin-right: 5px;\"\n+                          @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                          value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        >", "originalCommit": "a6e02f5cfe515e25a0bc967c4e4ded6ca501ce7b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "url": "https://github.com/sakaiproject/sakai/commit/c9ef00a78aaaf72dff0e9f18d44f638946954e76", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-22T10:25:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2ODUzOA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443468538", "bodyText": "Wrong indentation", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:37:16Z", "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/Criterion.java", "diffHunk": "@@ -72,6 +72,7 @@\n \n     @Lob\n     private String description;\n+\tprivate double weight;", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2ODU5OA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443468598", "bodyText": "Wrong indentation", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:37:24Z", "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/Rubric.java", "diffHunk": "@@ -70,6 +70,7 @@\n \n     private String title;\n     private String description;\n+\tprivate boolean weighted;", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2ODcxMg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443468712", "bodyText": "Wrong indentation", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:37:39Z", "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/projections/InlineCriterion.java", "diffHunk": "@@ -32,14 +32,16 @@\n import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n \n @Projection(name = \"inlineCriterion\", types = { Criterion.class })\n-@JsonPropertyOrder({\"id\", \"title\", \"description\", \"metadata\", \"ratings\"})\n+@JsonPropertyOrder({\"id\", \"title\", \"weight\", \"description\", \"metadata\", \"ratings\"})\n public interface InlineCriterion {\n \n     Long getId();\n \n     String getTitle();\n \n     String getDescription();\n+\t\n+\tdouble getWeight();", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTE0OQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469149", "bodyText": "Wrong indentation", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:38:39Z", "path": "rubrics/api/src/main/java/org/sakaiproject/rubrics/logic/model/projections/InlineRubric.java", "diffHunk": "@@ -33,14 +33,16 @@\n import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n \n @Projection(name = \"inlineRubric\", types = { Rubric.class })\n-@JsonPropertyOrder({\"id\", \"title\", \"description\", \"metadata\", \"criterions\"})\n+@JsonPropertyOrder({\"id\", \"title\", \"description\", \"weighted\", \"metadata\", \"criterions\"})\n public interface InlineRubric {\n \n     Long getId();\n \n     String getTitle();\n \n     String getDescription();\n+\t\n+\tboolean getWeighted();", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTUwNw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469507", "bodyText": "Can we use classes instead of direct styles?", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:39:27Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -24,6 +24,19 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n               <div tabindex=\"0\" class=\"criterion-detail\">\n                 <h4 class=\"criterion-title\">${c.title}</h4>\n                 <p>${c.description}</p>\n+                ${this.weighted ?\n+                  html`\n+                    <div style=\"margin-bottom: -5px;margin-top: 5px;display: flex;align-items: center;flex-wrap:wrap\">", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTU2Nw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469567", "bodyText": "Can we use classes instead of direct styles?", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:39:34Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -24,6 +24,19 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n               <div tabindex=\"0\" class=\"criterion-detail\">\n                 <h4 class=\"criterion-title\">${c.title}</h4>\n                 <p>${c.description}</p>\n+                ${this.weighted ?\n+                  html`\n+                    <div style=\"margin-bottom: -5px;margin-top: 5px;display: flex;align-items: center;flex-wrap:wrap\">\n+                        <span style=\"font-size: 12px;margin-right: 8px;\">", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTY1Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469656", "bodyText": "Can we use classes instead of direct styles?", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:39:47Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTY5MA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469690", "bodyText": "Can we use classes instead of direct styles?", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:39:52Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">\n+                      ${this.validWeight ? html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" for=\"weight_input_${c.id}\">", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTczNw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469737", "bodyText": "Can we use classes instead of direct styles?", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:40:00Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">\n+                      ${this.validWeight ? html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" for=\"weight_input_${c.id}\">\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </label>\n+                        <input\n+                          id=\"weight_input_${c.id}\"\n+                          data-criterion-id=\"${c.id}\"\n+                          type=\"text\"\n+                          class=\"form-control\"\n+                          placeholder=\"0.0\"\n+                          style=\"max-width: 60px; text-align: center;margin-right: 5px;\"\n+                          @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                          value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        >\n+                        <span class=\"control-label\" style=\"font-size: 12px;\">%</span>\n+                      ` : html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" title=\"${tr(\"total_weight_wrong\")}\">\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </label>\n+                        <input\n+                          id=\"weight_input_${c.id}\"\n+                          data-criterion-id=\"${c.id}\"\n+                          type=\"text\"\n+                          class=\"form-control\"\n+                          placeholder=\"0.0\"\n+                          style=\"max-width: 60px; text-align: center;margin-right: 5px;\"", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2OTc5Nw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443469797", "bodyText": "Can we use classes instead of direct styles?", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:40:08Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,43 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline\">\n+                    <div class=\"form-group input-group-sm\" style=\"display: flex;flex-direction: row;align-items: center;flex-wrap: wrap;margin-top: 10px;margin-bottom: -5px;\">\n+                      ${this.validWeight ? html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" for=\"weight_input_${c.id}\">\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </label>\n+                        <input\n+                          id=\"weight_input_${c.id}\"\n+                          data-criterion-id=\"${c.id}\"\n+                          type=\"text\"\n+                          class=\"form-control\"\n+                          placeholder=\"0.0\"\n+                          style=\"max-width: 60px; text-align: center;margin-right: 5px;\"\n+                          @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                          value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        >\n+                        <span class=\"control-label\" style=\"font-size: 12px;\">%</span>\n+                      ` : html`\n+                        <label class=\"control-label\" style=\"margin: 0;font-weight: inherit;margin-right: 5px;\" title=\"${tr(\"total_weight_wrong\")}\">", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ3MDM0NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443470345", "bodyText": "Wrong indentation", "author": "bgarciaentornos", "createdAt": "2020-06-22T10:41:21Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +188,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;\n+    return function() {\n+      var self = this,\n+          args = arguments;", "originalCommit": "c9ef00a78aaaf72dff0e9f18d44f638946954e76", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "411195b90190297170173fbd1ce774d276edb689", "url": "https://github.com/sakaiproject/sakai/commit/411195b90190297170173fbd1ce774d276edb689", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-22T11:53:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzUxMzkwOQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r443513909", "bodyText": "I guess once is enough! ;)", "author": "bgarciaentornos", "createdAt": "2020-06-22T12:12:38Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyNjAwMw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444826003", "bodyText": "Small thing. Can we have spaces after the selector in our css? Makes it a bit easier to read,", "author": "adrianfish", "createdAt": "2020-06-24T11:26:08Z", "path": "library/src/morpheus-master/sass/modules/tool/rubrics/_rubrics.scss", "diffHunk": "@@ -322,6 +322,47 @@\n                 color: $rubrics-crit-item-title-color;\n             }\n         }\n+        .criterion-weight{", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxNzAwMA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446017000", "bodyText": "Done", "author": "brdebr", "createdAt": "2020-06-26T07:33:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyNjAwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyNjUzNg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444826536", "bodyText": "Typo there. I know the word's one of those really weird English words ... :)", "author": "adrianfish", "createdAt": "2020-06-24T11:27:17Z", "path": "rubrics/api/src/main/bundle/rubrics.properties", "diffHunk": "@@ -42,6 +47,8 @@ modified=Modified\n actions=Actions\n share=Share {}\n share_label=Share\n+weighted_label=Weigthed", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyODA4NA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444828084", "bodyText": "Can just use double quotes here.\n: \"\"", "author": "adrianfish", "createdAt": "2020-06-24T11:30:26Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -24,6 +24,19 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n               <div tabindex=\"0\" class=\"criterion-detail\">\n                 <h4 class=\"criterion-title\">${c.title}</h4>\n                 <p>${c.description}</p>\n+                ${this.weighted ?\n+                  html`\n+                    <div class=\"criterion-weight\">\n+                        <span>\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </span>\n+                        <span>${c.weight}</span>\n+                        <span>\n+                          %\n+                        </span>\n+                    </div>`\n+                  : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyODY5Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444828696", "bodyText": "Same. no template needed here, just double quotes.", "author": "adrianfish", "createdAt": "2020-06-24T11:31:40Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -32,7 +45,17 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n                     <div tabindex=\"0\" title=\"${tr(\"rating_title\")}: ${r.title}. ${tr(\"rating_description\")}: ${r.description}. ${tr(\"point_value\")}: ${r.points.toLocaleString(this.locale)}\" class=\"rating-item\" id=\"rating_item_${r.id}\" on-save-ratings=\"saveRatings\" @on-delete-rating=\"${this.deleteCriterionRating}\">\n                       <h5 class=\"criterion-item-title\">${r.title}</h5>\n                       <p>${r.description}</p>\n-                      <span class=\"points\">${r.points.toLocaleString(this.locale)} ${tr(\"points\")}</span>\n+                      <span class=\"points\">\n+                        ${this.weighted && r.points > 0 ?\n+                          html`\n+                            <b>\n+                              (${(r.points * (c.weight / 100)).toFixed(2)})\n+                            </b>`\n+                          : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyOTIzMw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444829233", "bodyText": "You don't need the type here, just weighted: Boolean, etc. I know you're copying the pattern, but you don't need the extra chars.", "author": "adrianfish", "createdAt": "2020-06-24T11:32:56Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -16,6 +16,9 @@ export class SakaiRubricCriteria extends RubricsElement {\n     return {\n       token: { type: String },\n       rubricId: { attribute: \"rubric-id\", type: String },\n+      weighted: { type: Boolean },\n+      totalWeight: { type: String },\n+      validWeight: { type: Boolean },", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyOTY3Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444829676", "bodyText": "Just double quotes needed here.", "author": "adrianfish", "createdAt": "2020-06-24T11:33:55Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline weight-field\">\n+                    <div class=\"form-group input-group-sm\">\n+                      <label\n+                          for=\"weight_input_${c.id}\"\n+                          class=\"control-label\"\n+                          title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"\n+                      >\n+                        <sr-lang key=\"weight\">Weight</sr-lang>\n+                      </label>\n+                      <input\n+                        id=\"weight_input_${c.id}\"\n+                        data-criterion-id=\"${c.id}\"\n+                        type=\"text\"\n+                        class=\"form-control\"\n+                        placeholder=\"0.0\"\n+                        @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                        value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"\n+                      >\n+                      <span class=\"control-label\"\n+                          title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"\n+                      >\n+                        %\n+                      </span>\n+                    </div>\n+                </div>` : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyOTg0Mg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444829842", "bodyText": "double quotes", "author": "adrianfish", "createdAt": "2020-06-24T11:34:19Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -95,11 +126,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n         </div>\n       `)}\n       </div>\n+      ${this.weighted ? html`\n+        <br>\n+        <div class=\"total-weight\">\n+          <span class=\"control-label\">${tr('total_weight', [this.totalWeight])}</span>\n+        </div>`\n+        : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMTExNw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444831117", "bodyText": "You need to be consistent with the html bit here. I'd put the html on the same line as the ?", "author": "adrianfish", "createdAt": "2020-06-24T11:36:47Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria-readonly.js", "diffHunk": "@@ -24,6 +24,19 @@ export class SakaiRubricCriteriaReadonly extends RubricsElement {\n               <div tabindex=\"0\" class=\"criterion-detail\">\n                 <h4 class=\"criterion-title\">${c.title}</h4>\n                 <p>${c.description}</p>\n+                ${this.weighted ?\n+                  html`", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMjIxOA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444832218", "bodyText": "try and stick to the same kind of quotes. I use doubles - in future I think we'll all be using the backtick `, but not yet.", "author": "adrianfish", "createdAt": "2020-06-24T11:39:06Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline weight-field\">\n+                    <div class=\"form-group input-group-sm\">\n+                      <label\n+                          for=\"weight_input_${c.id}\"\n+                          class=\"control-label\"\n+                          title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"\n+                      >\n+                        <sr-lang key=\"weight\">Weight</sr-lang>\n+                      </label>\n+                      <input\n+                        id=\"weight_input_${c.id}\"\n+                        data-criterion-id=\"${c.id}\"\n+                        type=\"text\"\n+                        class=\"form-control\"\n+                        placeholder=\"0.0\"\n+                        @input=\"${this.debounce(this.emitWeightChanged, 500)}\"\n+                        value=\"${c.weight.toLocaleString(this.locale)}\"\n+                        title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMjM5Mg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444832392", "bodyText": "Try and stick to double quotes", "author": "adrianfish", "createdAt": "2020-06-24T11:39:26Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -58,6 +61,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n             <p>\n               ${c.description}\n             </p>\n+            ${this.weighted ? html`\n+                <div class=\"form-inline weight-field\">\n+                    <div class=\"form-group input-group-sm\">\n+                      <label\n+                          for=\"weight_input_${c.id}\"\n+                          class=\"control-label\"\n+                          title=\"${!this.validWeight ? tr(\"total_weight_wrong\") : ''}\"", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMjcwNw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444832707", "bodyText": "Just double quotes needed, no html template tag.", "author": "adrianfish", "createdAt": "2020-06-24T11:40:07Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -95,11 +126,34 @@ export class SakaiRubricCriteria extends RubricsElement {\n         </div>\n       `)}\n       </div>\n+      ${this.weighted ? html`\n+        <br>\n+        <div class=\"total-weight\">\n+          <span class=\"control-label\">${tr('total_weight', [this.totalWeight])}</span>\n+        </div>`\n+        : html``\n+      }\n       <br>\n-      <button class=\"add-criterion\" @click=\"${this.createCriterion}\">\n-        <span tabindex=\"0\" role=\"button\" class=\"add fa fa-plus\"></span>\n-        <sr-lang key=\"add_criterion\">Add Criterion</sr-lang>\n-      </button>\n+      <div>\n+        ${this.weighted ? html`\n+          <button class=\"save-weights\" @click=\"${this.saveWeights}\" ?disabled=\"${!this.validWeight}\">\n+            <span tabindex=\"0\" role=\"button\" class=\"add fa fa-save\"></span>\n+            <sr-lang key=\"save_weights\">Save Weights</sr-lang>\n+          </button>`\n+          : html``\n+        }\n+        <button class=\"add-criterion\" @click=\"${this.createCriterion}\">\n+          <span tabindex=\"0\" role=\"button\" class=\"add fa fa-plus\"></span>\n+          <sr-lang key=\"add_criterion\">Add Criterion</sr-lang>\n+        </button>\n+      </div>\n+      ${this.weighted ? html`\n+        <br>\n+        <div class=\"save-success has-success\" style=\"display:none;\">\n+          <span class=\"control-label\">${tr(\"saved_successfully\")}</span>\n+        </div>`\n+        : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNDAxMg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444834012", "bodyText": "Most of the rubrics code has a newline after the function name.", "author": "adrianfish", "createdAt": "2020-06-24T11:42:49Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +185,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNDk1MA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444834950", "bodyText": "Make this function a lambda and you don't need the var self = this line. This is the surrounding function's scope.", "author": "adrianfish", "createdAt": "2020-06-24T11:44:44Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +185,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;\n+    return function() {\n+      var self = this,\n+          args = arguments;\n+      clearTimeout(timer);\n+      timer = setTimeout(function() {", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxNzY1Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446017656", "bodyText": "Done", "author": "brdebr", "createdAt": "2020-06-26T07:35:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNDk1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNTczOA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444835738", "bodyText": "Just out of curiosity, why do you need this debounce function? Why do you need to pull functions out of the normal render cycle?", "author": "adrianfish", "createdAt": "2020-06-24T11:46:15Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -131,6 +185,18 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.dispatchEvent(new SharingChangeEvent());\n   }\n \n+  debounce(fn, delay) {\n+    var timer = null;\n+    return function() {\n+      var self = this,\n+          args = arguments;\n+      clearTimeout(timer);\n+      timer = setTimeout(function() {\n+        fn.apply(self, args);\n+      }, delay);\n+    };\n+  }", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxODg0Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446018846", "bodyText": "Mostly for UX and to don't modify the DOM at each key press.", "author": "brdebr", "createdAt": "2020-06-26T07:37:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNTczOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNjMzMQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444836331", "bodyText": "space after the function name and before the brace", "author": "adrianfish", "createdAt": "2020-06-24T11:47:26Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criteria.js", "diffHunk": "@@ -192,6 +258,24 @@ export class SakaiRubricCriteria extends RubricsElement {\n     this.criteriaMap.delete(e.detail.id);\n     this.requestUpdate();\n     this.letShareKnow();\n+    this.dispatchEvent(new CustomEvent('refresh-total-weight', { detail: { criteria: this.criteria } }));\n+  }\n+\n+  emitWeightChanged(e){", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNjkzMQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444836931", "bodyText": "weighted: Boolean will do it.", "author": "adrianfish", "createdAt": "2020-06-24T11:48:33Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -6,7 +6,7 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n   static get properties() {\n \n     return {\n-      criteria: { type: Array },\n+      criteria: { type: Array }, weighted: { type: Boolean }", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzA2MQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837061", "bodyText": "bring html onto same line as ?", "author": "adrianfish", "createdAt": "2020-06-24T11:48:50Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -19,6 +19,19 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n             <div class=\"criterion-detail\">\n               <h4 class=\"criterion-title\">${c.title}</h4>\n               <p>${c.description}</p>\n+              ${this.weighted ?\n+                html`", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzE2Mw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837163", "bodyText": "Just double quotes will do the job", "author": "adrianfish", "createdAt": "2020-06-24T11:49:02Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -19,6 +19,19 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n             <div class=\"criterion-detail\">\n               <h4 class=\"criterion-title\">${c.title}</h4>\n               <p>${c.description}</p>\n+              ${this.weighted ?\n+                html`\n+                  <div class=\"criterion-weight\">\n+                      <span>\n+                        <sr-lang key=\"weight\">Weight</sr-lang>\n+                      </span>\n+                      <span>${c.weight}</span>\n+                      <span>\n+                        %\n+                      </span>\n+                  </div>`\n+                : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzI5Mg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837292", "bodyText": "bring html onto the same line as ?", "author": "adrianfish", "createdAt": "2020-06-24T11:49:18Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -30,7 +43,15 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n                       <p>${r.description}</p>\n                     </div>\n                     <span class=\"points\">\n-                      ${r.points.toLocaleString(this.locale)} <sr-lang key=\"points\">Points</sr-lang>\n+                      ${this.weighted && r.points > 0 ?\n+                        html`", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzM3Mw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837373", "bodyText": "double quotes", "author": "adrianfish", "createdAt": "2020-06-24T11:49:27Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-preview.js", "diffHunk": "@@ -30,7 +43,15 @@ export class SakaiRubricCriterionPreview extends RubricsElement {\n                       <p>${r.description}</p>\n                     </div>\n                     <span class=\"points\">\n-                      ${r.points.toLocaleString(this.locale)} <sr-lang key=\"points\">Points</sr-lang>\n+                      ${this.weighted && r.points > 0 ?\n+                        html`\n+                          <b>\n+                            (${(r.points * (c.weight / 100)).toFixed(2)})\n+                          </b>`\n+                        : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzY0Mw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837643", "bodyText": "Just weighted: Boolean", "author": "adrianfish", "createdAt": "2020-06-24T11:49:58Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -14,6 +14,7 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n       evaluationDetails: { attribute: \"evaluation-details\", type: Array },\n       preview: Boolean,\n       entityId: { attribute: \"entity-id\", type: String },\n+      weighted: { type: Boolean }", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzNzkzNA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444837934", "bodyText": "html on same line as ?", "author": "adrianfish", "createdAt": "2020-06-24T11:50:33Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -56,6 +57,19 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n             <div class=\"criterion-detail\">\n               <h4 class=\"criterion-title\">${c.title}</h4>\n               <p>${c.description}</p>\n+              ${this.weighted ?\n+                  html`", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzODA4MQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444838081", "bodyText": "double quotes only needed", "author": "adrianfish", "createdAt": "2020-06-24T11:50:50Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -56,6 +57,19 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n             <div class=\"criterion-detail\">\n               <h4 class=\"criterion-title\">${c.title}</h4>\n               <p>${c.description}</p>\n+              ${this.weighted ?\n+                  html`\n+                    <div class=\"criterion-weight\">\n+                        <span>\n+                          <sr-lang key=\"weight\">Weight</sr-lang>\n+                        </span>\n+                        <span>${c.weight}</span>\n+                        <span>\n+                          %\n+                        </span>\n+                    </div>`\n+                  : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzODQyNQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444838425", "bodyText": "html on same line as ?", "author": "adrianfish", "createdAt": "2020-06-24T11:51:30Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -64,7 +78,17 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n                   <div class=\"rating-item student ${r.selected ? \"selected\" : \"\"}\" id=\"rating-item-${r.id}\">\n                     <h5 class=\"criterion-item-title\">${r.title}</h5>\n                     <p>${r.description}</p>\n-                    <span class=\"points\">${r.points.toLocaleString(this.locale)} Points</span>\n+                    <span class=\"points\">\n+                      ${this.weighted && r.points > 0 ?\n+                        html`", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzODc3NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444838775", "bodyText": "double quotes", "author": "adrianfish", "createdAt": "2020-06-24T11:52:13Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-criterion-student.js", "diffHunk": "@@ -64,7 +78,17 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n                   <div class=\"rating-item student ${r.selected ? \"selected\" : \"\"}\" id=\"rating-item-${r.id}\">\n                     <h5 class=\"criterion-item-title\">${r.title}</h5>\n                     <p>${r.description}</p>\n-                    <span class=\"points\">${r.points.toLocaleString(this.locale)} Points</span>\n+                    <span class=\"points\">\n+                      ${this.weighted && r.points > 0 ?\n+                        html`\n+                          <b>\n+                            (${(r.points * (c.weight / 100)).toFixed(2)})\n+                          </b>`\n+                        : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzOTQxMg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444839412", "bodyText": "Use double quotes here, no html needed.", "author": "adrianfish", "createdAt": "2020-06-24T11:53:31Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -70,6 +70,19 @@ export class SakaiRubricGrading extends RubricsElement {\n           <div class=\"criterion-detail\">\n             <h4 class=\"criterion-title\">${c.title}</h4>\n             <p>${c.description}</p>\n+            ${this.rubric.weighted ?\n+              html`\n+                <div class=\"criterion-weight\">\n+                    <span>\n+                      <sr-lang key=\"weight\">Weight</sr-lang>\n+                    </span>\n+                    <span>${c.weight}</span>\n+                    <span>\n+                      %\n+                    </span>\n+                </div>`\n+              : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzOTYzNQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444839635", "bodyText": "is % universal across locales?", "author": "adrianfish", "createdAt": "2020-06-24T11:53:59Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -70,6 +70,19 @@ export class SakaiRubricGrading extends RubricsElement {\n           <div class=\"criterion-detail\">\n             <h4 class=\"criterion-title\">${c.title}</h4>\n             <p>${c.description}</p>\n+            ${this.rubric.weighted ?\n+              html`\n+                <div class=\"criterion-weight\">\n+                    <span>\n+                      <sr-lang key=\"weight\">Weight</sr-lang>\n+                    </span>\n+                    <span>${c.weight}</span>\n+                    <span>\n+                      %", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxOTUwOQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446019509", "bodyText": "I think so, but just in case I added it as a translation key.", "author": "brdebr", "createdAt": "2020-06-26T07:39:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzOTYzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzOTc0Nw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444839747", "bodyText": "html on same line as ?", "author": "adrianfish", "createdAt": "2020-06-24T11:54:15Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -70,6 +70,19 @@ export class SakaiRubricGrading extends RubricsElement {\n           <div class=\"criterion-detail\">\n             <h4 class=\"criterion-title\">${c.title}</h4>\n             <p>${c.description}</p>\n+            ${this.rubric.weighted ?\n+              html`", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MDA2Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444840066", "bodyText": "formatting needed here, space after if, space before {", "author": "adrianfish", "createdAt": "2020-06-24T11:54:52Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -270,9 +293,15 @@ export class SakaiRubricGrading extends RubricsElement {\n       var ratingElements = this.querySelectorAll(`#criterion_row_${criterion.id} .rating-item`);\n       ratingElements.forEach(i => i.classList.remove('selected'));\n       clickedRatingElement.classList.add(\"selected\");\n-      criterion.selectedvalue = rating.points;\n+      var auxPoints;\n+      if(this.rubric.weighted){", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MDE1MA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444840150", "bodyText": "formatting", "author": "adrianfish", "createdAt": "2020-06-24T11:55:02Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-grading.js", "diffHunk": "@@ -270,9 +293,15 @@ export class SakaiRubricGrading extends RubricsElement {\n       var ratingElements = this.querySelectorAll(`#criterion_row_${criterion.id} .rating-item`);\n       ratingElements.forEach(i => i.classList.remove('selected'));\n       clickedRatingElement.classList.add(\"selected\");\n-      criterion.selectedvalue = rating.points;\n+      var auxPoints;\n+      if(this.rubric.weighted){\n+        auxPoints = (rating.points * (criterion.weight / 100)).toFixed(2);\n+      }else{", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MDY1NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444840655", "bodyText": "You don't need the quotes around the expression here.", "author": "adrianfish", "createdAt": "2020-06-24T11:56:03Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-preview.js", "diffHunk": "@@ -47,6 +47,7 @@ export class SakaiRubricPreview extends RubricsElement {\n         token=\"${this.token}\"\n         criteria=\"${JSON.stringify(this.rubric.criterions)}\"\n         gradeFieldId=\"${this.gradeFieldId}\"\n+        ?weighted=\"${this.rubric.weighted}\"", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MDkxNg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444840916", "bodyText": "no quotes needed around the boolean attribute expression", "author": "adrianfish", "createdAt": "2020-06-24T11:56:36Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric-readonly.js", "diffHunk": "@@ -49,7 +49,7 @@ export class SakaiRubricReadonly extends RubricsElement {\n \n       <div class=\"collapse-details\" role=\"tabpanel\" aria-labelledby=\"rubric_toggle_${this.rubric.id}\" id=\"collapse_shared_${this.rubric.id}\">\n         <div class=\"rubric-details style-scope sakai-rubric\">\n-          <sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\"></sakai-rubric-criteria-readonly>\n+          <sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\" ?weighted=\"${this.rubric.weighted}\"></sakai-rubric-criteria-readonly>", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MTg2OQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444841869", "bodyText": "You don't need the type bit on these new props, unless you actually expect to use them as attributes. If they are attributes you need to make sure the attribute id weighted-icon and total-weight, otherwise you're going against the html spec.", "author": "adrianfish", "createdAt": "2020-06-24T11:58:39Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -28,7 +32,7 @@ export class SakaiRubric extends RubricsElement {\n   }\n \n   static get properties() {\n-    return { rubric: {type: Object}, token: { type: String } , shareIcon: { type: String }};\n+    return { rubric: {type: Object}, token: { type: String } , shareIcon: { type: String } , weightedIcon: { type: String } , totalWeight: { type: String } , validWeight: { type: Boolean } };", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAxOTcxNg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446019716", "bodyText": "Done", "author": "brdebr", "createdAt": "2020-06-26T07:39:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MTg2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjAwNw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842007", "bodyText": "typo here", "author": "adrianfish", "createdAt": "2020-06-24T11:58:56Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -46,14 +50,15 @@ export class SakaiRubric extends RubricsElement {\n     this._rubric = newValue;\n     if (!this._rubric.criterions) this._rubric.criterions = [];\n     this.updateRubricConfig.url = `/rubrics-service/rest/rubrics/${newValue.id}?projection=inlineRubric`;\n+    this.handleWeighLink();", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjM1Nw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842357", "bodyText": "html on same line as ?", "author": "adrianfish", "createdAt": "2020-06-24T11:59:33Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -78,6 +83,20 @@ export class SakaiRubric extends RubricsElement {\n         <div class=\"hidden-xs\"><sakai-rubric-modified-date modified=\"${this.rubric.metadata.modified}\"></sakai-rubric-modified-date></div>\n \n         <div class=\"actions\">\n+          ${!this.rubric.metadata.locked ?\n+            html`", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjQ1Nw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842457", "bodyText": "double quotes", "author": "adrianfish", "createdAt": "2020-06-24T11:59:42Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -78,6 +83,20 @@ export class SakaiRubric extends RubricsElement {\n         <div class=\"hidden-xs\"><sakai-rubric-modified-date modified=\"${this.rubric.metadata.modified}\"></sakai-rubric-modified-date></div>\n \n         <div class=\"actions\">\n+          ${!this.rubric.metadata.locked ?\n+            html`\n+            <div class=\"action-container\">\n+              <span class=\"hidden-sm hidden-xs sr-only\">\n+                ${this.rubric.weighted ?\n+                  html`<sr-lang key=\"weighted_label\">weighted_label</sr-lang>`\n+                  :\n+                  html`<sr-lang key=\"standard_label\">standard_label</sr-lang>`\n+                }\n+              </span>\n+              <span role=\"button\" title=\"${this.weightLabel}\" tabindex=\"0\" class=\"weighted fa ${this.weightedIcon}\" @click=\"${this.weightedChange}\"></span>\n+            </div>`\n+          : html``", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjcyMQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842721", "bodyText": "no doubles needed here", "author": "adrianfish", "createdAt": "2020-06-24T12:00:09Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -108,9 +127,26 @@ export class SakaiRubric extends RubricsElement {\n       <div class=\"collapse-details\" role=\"tabpanel\" aria-labelledby=\"rubric_toggle_${this.rubric.id}\" id=\"collapse_${this.rubric.id}\">\n         <div class=\"rubric-details style-scope sakai-rubric\">\n           ${this.rubric.metadata.locked ?\n-            html`<sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\" token=\"${this.token}\"></sakai-rubric-criteria-readonly>`\n+            html`\n+              <sakai-rubric-criteria-readonly\n+                criteria=\"${JSON.stringify(this.rubric.criterions)}\"\n+                token=\"${this.token}\"\n+                ?weighted=\"${this.rubric.weighted}\"", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MjgzMw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444842833", "bodyText": "html on the same line as the ?", "author": "adrianfish", "createdAt": "2020-06-24T12:00:22Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -108,9 +127,26 @@ export class SakaiRubric extends RubricsElement {\n       <div class=\"collapse-details\" role=\"tabpanel\" aria-labelledby=\"rubric_toggle_${this.rubric.id}\" id=\"collapse_${this.rubric.id}\">\n         <div class=\"rubric-details style-scope sakai-rubric\">\n           ${this.rubric.metadata.locked ?\n-            html`<sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\" token=\"${this.token}\"></sakai-rubric-criteria-readonly>`\n+            html`", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MzAzMw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444843033", "bodyText": "no doubles needed here.", "author": "adrianfish", "createdAt": "2020-06-24T12:00:47Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -108,9 +127,26 @@ export class SakaiRubric extends RubricsElement {\n       <div class=\"collapse-details\" role=\"tabpanel\" aria-labelledby=\"rubric_toggle_${this.rubric.id}\" id=\"collapse_${this.rubric.id}\">\n         <div class=\"rubric-details style-scope sakai-rubric\">\n           ${this.rubric.metadata.locked ?\n-            html`<sakai-rubric-criteria-readonly criteria=\"${JSON.stringify(this.rubric.criterions)}\" token=\"${this.token}\"></sakai-rubric-criteria-readonly>`\n+            html`\n+              <sakai-rubric-criteria-readonly\n+                criteria=\"${JSON.stringify(this.rubric.criterions)}\"\n+                token=\"${this.token}\"\n+                ?weighted=\"${this.rubric.weighted}\"\n+              />`\n             :\n-            html`<sakai-rubric-criteria rubric-id=\"${this.rubric.id}\" criteria=\"${JSON.stringify(this.rubric.criterions)}\" token=\"${this.token}\"></sakai-rubric-criteria>`\n+            html`\n+              <sakai-rubric-criteria\n+                rubric-id=\"${this.rubric.id}\"\n+                criteria=\"${JSON.stringify(this.rubric.criterions)}\"\n+                token=\"${this.token}\"\n+                @criterion-created=\"${this.handleCriterionCreated}\"\n+                @save-weights=\"${this.handleSaveWeights}\"\n+                @weight-changed=\"${this.handleCriterionWeightChange}\"\n+                @refresh-total-weight=\"${this.handleRefreshTotalWeight}\"\n+                ?weighted=\"${this.rubric.weighted}\"", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MzIzMw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444843233", "bodyText": "could you add a newline after the function name?", "author": "adrianfish", "createdAt": "2020-06-24T12:01:13Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MzgyMA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444843820", "bodyText": "newline after the function name.", "author": "adrianfish", "createdAt": "2020-06-24T12:02:20Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NDQ2MQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444844461", "bodyText": "I'd prefer you to use vanilla js here. We're trying to not use jquery unless it offers a massive advantage.", "author": "adrianfish", "createdAt": "2020-06-24T12:03:36Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMDAzOQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446020039", "bodyText": "Done", "author": "brdebr", "createdAt": "2020-06-26T07:40:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NDQ2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NDgyNQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444844825", "bodyText": "I like a newline after the { in multiline lambdas. It helps with clarity.", "author": "adrianfish", "createdAt": "2020-06-24T12:04:27Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NjAwMg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444846002", "bodyText": "use  lambdas here to avoid the _this = this, or self = this pattern.", "author": "adrianfish", "createdAt": "2020-06-24T12:06:50Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMDEzOQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446020139", "bodyText": "Done", "author": "brdebr", "createdAt": "2020-06-26T07:40:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NjAwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NjQyNA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444846424", "bodyText": "use lambdas", "author": "adrianfish", "createdAt": "2020-06-24T12:07:42Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NjU5Mg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444846592", "bodyText": "formatting", "author": "adrianfish", "createdAt": "2020-06-24T12:08:01Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NzI3NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444847275", "bodyText": "could you not use this.updateComplete.then( () => here instead of these timeouts?", "author": "adrianfish", "createdAt": "2020-06-24T12:09:23Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMTk1Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446021956", "bodyText": "I think that would make it appear/disappear instantly, instead of having a wait time so the user can see the success message.", "author": "brdebr", "createdAt": "2020-06-26T07:44:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NzI3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NzczNQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444847735", "bodyText": "if you don't intend this to change, use const ?", "author": "adrianfish", "createdAt": "2020-06-24T12:10:14Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMjA5Mw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446022093", "bodyText": "Done", "author": "brdebr", "createdAt": "2020-06-26T07:44:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0NzczNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0ODE0Mw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444848143", "bodyText": "This should be handled in lit-element via a class property.", "author": "adrianfish", "createdAt": "2020-06-24T12:11:04Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);\n+\n+    if (total == 100) {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').removeClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').removeClass('has-error');", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMjE0Mg==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446022142", "bodyText": "Done", "author": "brdebr", "createdAt": "2020-06-26T07:44:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0ODE0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0OTk3OA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444849978", "bodyText": "This stuff should be handled by lit-element. All you need to do is set a property on your class and the render should add the class. All this manipulation of the dom using selectors is a big lit-element anti pattern.", "author": "adrianfish", "createdAt": "2020-06-24T12:14:51Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);\n+\n+    if (total == 100) {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').removeClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').removeClass('has-error');\n+      this.validWeight = true;\n+    } else {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').addClass('has-error');", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMjIzNA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446022234", "bodyText": "Done", "author": "brdebr", "createdAt": "2020-06-26T07:45:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0OTk3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MDk4MQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444850981", "bodyText": "If you can avoid modding the dom outside of lit-element, you should. Could you just add a property to the class that controls the addition of this class?", "author": "adrianfish", "createdAt": "2020-06-24T12:16:47Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -162,6 +200,94 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleCriterionCreated(e) {\n+    var data = e.detail;\n+    this.rubric.criterions.push(data.criterion);\n+  }\n+\n+  handleSaveWeights(e) {\n+    var _this = this;\n+    $(`[rubric-id=${this.rubric.id}]`).find('.save-weights').prop('disabled', true);\n+    this.rubric.criterions.forEach(cr => {\n+      cr.weight = parseFloat(cr.weight);\n+      $.ajax({\n+        url: `/rubrics-service/rest/criterions/${cr.id}`,\n+        headers: { \"authorization\": this.token },\n+        method: \"PATCH\",\n+        contentType: \"application/json\",\n+        data: JSON.stringify({ weight: cr.weight })\n+      }).done(data => {\n+        $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeIn('100');\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-weights').prop('disabled', false);\n+        }, 1000);\n+        setTimeout(function () {\n+          $(`[rubric-id=${_this.rubric.id}]`).find('.save-success').fadeOut('100');\n+        }, 5000);\n+        this.requestUpdate();\n+      }).fail((jqXHR, error, message) => {\n+        console.log(error);console.log(message);\n+      });\n+    });\n+  }\n+\n+  handleCriterionWeightChange(e){\n+    var payload = e.detail;\n+\n+    this.rubric.criterions = payload.criteria;\n+    var criterionModified = this.rubric.criterions.find(el => el.id === payload.criterionId);\n+    var oldValue = criterionModified.weight;\n+    var criterionId = criterionModified.id;\n+\n+    payload.value = payload.value.toLocaleString(this.locale);\n+    criterionModified.weight = payload.value;\n+    if (oldValue === payload.value) {\n+      return;\n+    }\n+\n+    var total = this.rubric.criterions.reduce((acc, el) => acc + parseFloat(el.weight.toLocaleString(this.locale)), 0);\n+\n+    if (total == 100) {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').removeClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').removeClass('has-error');\n+      this.validWeight = true;\n+    } else {\n+      $(`[rubric-id=${this.rubric.id}]`).find('.criterion-detail .form-group').addClass('has-error');\n+      $(`[rubric-id=${this.rubric.id}]`).find('.total-weight').addClass('has-error');", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTI1OA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851258", "bodyText": "Typo, and a few formatting issues.", "author": "adrianfish", "createdAt": "2020-06-24T12:17:20Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -170,6 +296,16 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleWeighLink(){", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTM5Mw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851393", "bodyText": "spaces after if and before {", "author": "adrianfish", "createdAt": "2020-06-24T12:17:34Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -170,6 +296,16 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleWeighLink(){\n+    if(this.rubric.weighted){", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTUxOA==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851518", "bodyText": "spaces after } and before {", "author": "adrianfish", "createdAt": "2020-06-24T12:17:48Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -170,6 +296,16 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleWeighLink(){\n+    if(this.rubric.weighted){\n+      this.weightedIcon = 'fa-percent'\n+      this.weightLabel = tr(\"weighted_label\")\n+    }else{", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTY1NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851655", "bodyText": "try and stick to double quotes.", "author": "adrianfish", "createdAt": "2020-06-24T12:18:02Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -170,6 +296,16 @@ export class SakaiRubric extends RubricsElement {\n     this.updateRubric();\n   }\n \n+  handleWeighLink(){\n+    if(this.rubric.weighted){\n+      this.weightedIcon = 'fa-percent'\n+      this.weightLabel = tr(\"weighted_label\")\n+    }else{\n+      this.weightedIcon = 'fa-hashtag'", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1MTc0MQ==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r444851741", "bodyText": "typo", "author": "adrianfish", "createdAt": "2020-06-24T12:18:15Z", "path": "rubrics/tool/src/main/frontend/webcomponents/js/sakai-rubric.js", "diffHunk": "@@ -190,6 +326,7 @@ export class SakaiRubric extends RubricsElement {\n \n       this.rubric = data;\n       this.dispatchEvent(new SharingChangeEvent());\n+      this.handleWeighLink();", "originalCommit": "411195b90190297170173fbd1ce774d276edb689", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dc24d56701a9479fc650625d7781f767c0fe7f03", "url": "https://github.com/sakaiproject/sakai/commit/dc24d56701a9479fc650625d7781f767c0fe7f03", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-25T16:02:59Z", "type": "forcePushed"}, {"oid": "5cd35a21326b83e73c2f2ab6b78d437bf5672b1f", "url": "https://github.com/sakaiproject/sakai/commit/5cd35a21326b83e73c2f2ab6b78d437bf5672b1f", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-26T07:00:58Z", "type": "forcePushed"}, {"oid": "2c03db6af698c1d6ef7bbbe6d030f611f0b575e1", "url": "https://github.com/sakaiproject/sakai/commit/2c03db6af698c1d6ef7bbbe6d030f611f0b575e1", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-26T07:18:03Z", "type": "forcePushed"}, {"oid": "214c4c9e5f6557b60a236e530564673ae2bc8c2b", "url": "https://github.com/sakaiproject/sakai/commit/214c4c9e5f6557b60a236e530564673ae2bc8c2b", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-26T07:26:59Z", "type": "forcePushed"}, {"oid": "1a6ef5f5ba6c38f2e6862150a6ee24a4c14e788b", "url": "https://github.com/sakaiproject/sakai/commit/1a6ef5f5ba6c38f2e6862150a6ee24a4c14e788b", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-29T06:11:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4OTA4Nw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446889087", "bodyText": "Move the html onto the same line as your ? ?", "author": "adrianfish", "createdAt": "2020-06-29T11:10:48Z", "path": "webcomponents/tool/src/main/frontend/js/rubrics/sakai-rubric-criterion-student.js", "diffHunk": "@@ -64,7 +77,17 @@ export class SakaiRubricCriterionStudent extends RubricsElement {\n                   <div class=\"rating-item student ${r.selected ? \"selected\" : \"\"}\" id=\"rating-item-${r.id}\">\n                     <h5 class=\"criterion-item-title\">${r.title}</h5>\n                     <p>${r.description}</p>\n-                    <span class=\"points\">${r.points.toLocaleString(this.locale)} Points</span>\n+                    <span class=\"points\">\n+                      ${this.weighted && r.points > 0 ?\n+                        html`", "originalCommit": "1a6ef5f5ba6c38f2e6862150a6ee24a4c14e788b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjkxNzEyNw==", "url": "https://github.com/sakaiproject/sakai/pull/8307#discussion_r446917127", "bodyText": "Done, missed that one \ud83d\ude05", "author": "brdebr", "createdAt": "2020-06-29T12:03:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4OTA4Nw=="}], "type": "inlineReview"}, {"oid": "f758402ade93acc9bf41117f4201b2fe22204955", "url": "https://github.com/sakaiproject/sakai/commit/f758402ade93acc9bf41117f4201b2fe22204955", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-29T11:54:47Z", "type": "commit"}, {"oid": "f758402ade93acc9bf41117f4201b2fe22204955", "url": "https://github.com/sakaiproject/sakai/commit/f758402ade93acc9bf41117f4201b2fe22204955", "message": "SAK-43826: Rubrics - Support weighted criterions", "committedDate": "2020-06-29T11:54:47Z", "type": "forcePushed"}]}