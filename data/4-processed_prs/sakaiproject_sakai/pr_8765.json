{"pr_number": 8765, "pr_title": "SAK-44587 Site creation date not being saved", "pr_createdAt": "2020-11-02T13:08:02Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8765", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3NDk0Mg==", "url": "https://github.com/sakaiproject/sakai/pull/8765#discussion_r515974942", "bodyText": "I'd just set this up in a variable, rather than passing the time service into the velocity render. We want to make these templates simpler, dumber, in the end.", "author": "adrianfish", "createdAt": "2020-11-02T13:36:08Z", "path": "site-manage/site-manage-tool/tool/src/webapp/vm/sitesetup/chef_site-list.vm", "diffHunk": "@@ -248,9 +248,7 @@\n \t\t\t\t\t\t\t\t\t#end\n \t\t\t\t\t\t\t\t</td>\n \t\t\t\t\t\t\t\t<td headers=\"createdOn\">\n-\t\t\t\t\t\t\t\t\t#set($createdTime=\"\")\n-\t\t\t\t\t\t\t\t\t#set($createdTime = $!site.getCreatedTime())\n-\t\t\t\t\t\t\t\t\t$!createdTime.toStringLocalFull()\n+\t\t\t\t\t\t\t\t\t#if ($site.CreatedDate) $userTimeService.dateTimeFormat($site.CreatedDate, $tlang.Locale, 2) #end", "originalCommit": "4539417e26fb596d60bf34aafaaad20295980109", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3ODQ4Mg==", "url": "https://github.com/sakaiproject/sakai/pull/8765#discussion_r515978482", "bodyText": "It's a site list.", "author": "bgarciaentornos", "createdAt": "2020-11-02T13:42:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3NDk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk4ODA4OA==", "url": "https://github.com/sakaiproject/sakai/pull/8765#discussion_r515988088", "bodyText": "I see the issue. It just seems nasty passing services into the template render, but I see what you mean.", "author": "adrianfish", "createdAt": "2020-11-02T13:57:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3NDk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE0ODc3Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8765#discussion_r516148776", "bodyText": "I agree with Adrian about passing services into the template renderer it should be considered last resort as there are implications for doing this that are not apparent.\nThe best approach would be to create a PageBean that contains all the data need by the template Renderer.\nHowever given that's a lot of work and out of scope this change seems reasonable.", "author": "ern", "createdAt": "2020-11-02T17:43:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3NDk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5MjE3NA==", "url": "https://github.com/sakaiproject/sakai/pull/8765#discussion_r516492174", "bodyText": "Yeah, I understand and agree with that view but in this case I feel like this was the way to go. Plus I also saw it on similar places.", "author": "bgarciaentornos", "createdAt": "2020-11-03T08:28:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3NDk0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3NTU3MQ==", "url": "https://github.com/sakaiproject/sakai/pull/8765#discussion_r515975571", "bodyText": "I'd compute the actual value and pass that as a variable.", "author": "adrianfish", "createdAt": "2020-11-02T13:37:13Z", "path": "site-manage/site-manage-tool/tool/src/java/org/sakaiproject/site/tool/SiteAction.java", "diffHunk": "@@ -1323,6 +1323,7 @@ public String buildMainPanelContext(VelocityPortlet portlet,\n \t\t\tboolean inShortcut) {\n \t\tcontext.put(\"tlang\", rb);\n \t\tcontext.put(\"clang\", cfgRb);\n+\t\tcontext.put(\"userTimeService\", userTimeService);", "originalCommit": "4539417e26fb596d60bf34aafaaad20295980109", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3NjEzMg==", "url": "https://github.com/sakaiproject/sakai/pull/8765#discussion_r515976132", "bodyText": "return m_createdTime != null ? new Date(m_createdTime.toEpochMilli()) : null;", "author": "adrianfish", "createdAt": "2020-11-02T13:38:15Z", "path": "kernel/kernel-impl/src/main/java/org/sakaiproject/site/impl/BaseSite.java", "diffHunk": "@@ -837,7 +837,7 @@ public User getModifiedBy()\n \tpublic Date getCreatedDate() {\n \t\tDate date = null;\n \t\tif (m_createdTime != null) {\n-\t\t\tnew Date(m_createdTime.toEpochMilli());\n+\t\t\tdate = new Date(m_createdTime.toEpochMilli());", "originalCommit": "4539417e26fb596d60bf34aafaaad20295980109", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQ5MTczNw==", "url": "https://github.com/sakaiproject/sakai/pull/8765#discussion_r516491737", "bodyText": "Have pushed this change and also applied it to other method", "author": "bgarciaentornos", "createdAt": "2020-11-03T08:27:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTk3NjEzMg=="}], "type": "inlineReview"}, {"oid": "69068e96ff22a51e13b7021efc648156ed02ccba", "url": "https://github.com/sakaiproject/sakai/commit/69068e96ff22a51e13b7021efc648156ed02ccba", "message": "SAK-44587 Site creation date not being saved", "committedDate": "2020-11-03T08:26:17Z", "type": "commit"}, {"oid": "69068e96ff22a51e13b7021efc648156ed02ccba", "url": "https://github.com/sakaiproject/sakai/commit/69068e96ff22a51e13b7021efc648156ed02ccba", "message": "SAK-44587 Site creation date not being saved", "committedDate": "2020-11-03T08:26:17Z", "type": "forcePushed"}]}