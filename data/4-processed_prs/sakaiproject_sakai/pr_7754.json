{"pr_number": 7754, "pr_title": "SAK-40813 Assignment extension feature", "pr_createdAt": "2020-01-09T18:50:45Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/7754", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDkwNDM2Ng==", "url": "https://github.com/sakaiproject/sakai/pull/7754#discussion_r364904366", "bodyText": "Looks like there's a label missing for this input. That makes it hard for people using screen readers or voice control to use the input.", "author": "accesslint", "createdAt": "2020-01-09T18:50:51Z", "path": "assignment/tool/src/webapp/vm/assignment/chef_assignments_instructor_grading_submission.vm", "diffHunk": "@@ -680,7 +680,55 @@\n             #else\n                 #set($resubmitStyle=\"display:none\")\n             #end\n-            <div class=\"form-group\" id=\"tempAllowRes\" #if ($submissionType == 4) style=\"display:none\"#end>\n+  ##decide whether to show the Extension options\n+            #if($!displayExtensionOptions && $submissionType != 4)\n+                #set($extensionStyle=\"display:block\")\n+                #set($resubmitVisibility=\"display:none\")\n+            #else\n+                #set($extensionStyle=\"display:none\")\n+                #if($submissionType != 4)\n+                    #set($resubmitVisibility=\"display:block\")\n+                #else\n+                    #set($resubmitVisibility=\"display:none\")\n+                #end\n+            #end\n+\n+            <div class=\"form-group\" id=\"allowExtensionForm\" style=\"$extensionStyle\">\n+                <input type=\"checkbox\" id=\"allowExtensionToggle\" name=\"allowExtensionToggle\"\n+                    #if($extensionCloseTime && $submissionType != 4)\n+                       checked=\"checked\"\n+                    #end\n+                    onclick=\"if(checked){document.getElementById('allowExtensionTime').style.display = 'block';ASN.resizeFrame();}else{document.getElementById('allowExtensionTime').style.display = 'none';}\"\n+                />\n+                <label for=\"allowExtensionToggle\" >$tlang.getString(\"allowExtension\")</label>\n+                <label class=\"text-warning\" >$tlang.getString(\"allowExtensionCaption\")</label>\n+                <div id=\"allowExtensionTime\"\n+                    #if($extensionCloseTime && $submissionType != 4)\n+                        style=\"display: block\"\n+                    #else\n+                        style=\"display: none\"\n+                    #end\n+                >\n+                    <label >$tlang.getString(\"gen.acesubunt\")</label>\n+                    <input type=\"text\" id=\"allowExtensionDate\" name=\"allowExtensionDate\" class=\"datepicker\" value=\"\"/>", "originalCommit": "2f9db210721b8708d5b0c2113129d11960584518", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "22fdcdc735581888bef494a2ab278e452b512453", "url": "https://github.com/sakaiproject/sakai/commit/22fdcdc735581888bef494a2ab278e452b512453", "message": "SAKAI-4831 Modifications to assignment extension feature for sakai 20/21\n\nSlight changes to make assignment extension feature build and deploy in 20/21.", "committedDate": "2020-01-09T19:09:29Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIzMzMzNw==", "url": "https://github.com/sakaiproject/sakai/pull/7754#discussion_r397233337", "bodyText": "Is it possible to add the AssignmentConstants.ALLOW_EXTENSION_CLOSETIME as a parameter vs adding to the session state?\nWere try avoid adding anything new to the session state, as it's a bad pattern.", "author": "ern", "createdAt": "2020-03-24T15:16:34Z", "path": "assignment/tool/src/java/org/sakaiproject/assignment/tool/AssignmentAction.java", "diffHunk": "@@ -13366,6 +13426,34 @@ public void doModel_answer(RunData data) {\n         }\n     }\n \n+    private void assignment_extension_option_into_context(Context context, SessionState state){\n+        String allowExtensionTimeString = null;\n+        if (state.getAttribute(AssignmentConstants.ALLOW_EXTENSION_CLOSETIME) != null){\n+            allowExtensionTimeString = (String) state.getAttribute(AssignmentConstants.ALLOW_EXTENSION_CLOSETIME);\n+            Instant extensionCloseTime = Instant.ofEpochMilli(Long.parseLong(allowExtensionTimeString));\n+            context.put(\"extensionCloseTime\", assignmentService.getUsersLocalDateTimeString(extensionCloseTime));\n+        }\n+        putTimePropertiesInContext(context, state, \"Extension\", ALLOW_EXTENSION_CLOSEMONTH, ALLOW_EXTENSION_CLOSEDAY, ALLOW_EXTENSION_CLOSEYEAR, ALLOW_EXTENSION_CLOSEHOUR, ALLOW_EXTENSION_CLOSEMIN);\n+    }\n+\n+    private void assignment_extension_option_into_state(Assignment a, AssignmentSubmission s, SessionState state){", "originalCommit": "22fdcdc735581888bef494a2ab278e452b512453", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3MDU5Nw==", "url": "https://github.com/sakaiproject/sakai/pull/7754#discussion_r399370597", "bodyText": "Sorry, missed this message. I'm sure this doesn't need to be added to the session state. Myself or Joe will take a look at this as soon as possible.", "author": "davidpbauer", "createdAt": "2020-03-27T16:00:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIzMzMzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQxMDAzMw==", "url": "https://github.com/sakaiproject/sakai/pull/7754#discussion_r410410033", "bodyText": "Hey Earle. I finally got around to taking a look at this today. It looks like the extension feature was written to match the existing pattern that resubmission uses. Would it make sense to leave this as it's written and open a new ticket to refactor both?", "author": "davidpbauer", "createdAt": "2020-04-17T18:52:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIzMzMzNw=="}, {"id": "PRRC_kwDOAbQ-jc4q1QLn", "url": "https://github.com/sakaiproject/sakai/pull/7754#discussion_r718602983", "bodyText": "yep", "author": "ern", "createdAt": "2021-09-29T14:52:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIzMzMzNw=="}], "type": "inlineReview"}, {"oid": "d1ff349ead3644d180a1911b872c4d4a8b5634d9", "url": "https://github.com/sakaiproject/sakai/commit/d1ff349ead3644d180a1911b872c4d4a8b5634d9", "message": "SAKAI-4831 Modifications to assignment extension feature for sakai 20/21\n\nSlight changes to make assignment extension feature build and deploy in 20/21.", "committedDate": "2020-09-23T10:52:32Z", "type": "forcePushed"}, {"oid": "2636206803672be2240c796f8a298ccf834f2b8d", "url": "https://github.com/sakaiproject/sakai/commit/2636206803672be2240c796f8a298ccf834f2b8d", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over.", "committedDate": "2020-09-23T11:12:45Z", "type": "forcePushed"}, {"oid": "04cf375655e5c005a34052778311d0627367f779", "url": "https://github.com/sakaiproject/sakai/commit/04cf375655e5c005a34052778311d0627367f779", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over.", "committedDate": "2021-09-29T15:05:24Z", "type": "forcePushed"}, {"oid": "b31383767c9e789610f113fdc60786cd4ec91888", "url": "https://github.com/sakaiproject/sakai/commit/b31383767c9e789610f113fdc60786cd4ec91888", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over.", "committedDate": "2021-09-30T15:49:25Z", "type": "commit"}, {"oid": "b31383767c9e789610f113fdc60786cd4ec91888", "url": "https://github.com/sakaiproject/sakai/commit/b31383767c9e789610f113fdc60786cd4ec91888", "message": "SAK-40813 Add assignment extension feature\n\nThis feature allows an instructor to provide a new accept until date for\na student that did not submit an assignment in time. This new date only\napplies for one submission by the student. After that, the normal resubmission\nprocess takes over.", "committedDate": "2021-09-30T15:49:25Z", "type": "forcePushed"}]}