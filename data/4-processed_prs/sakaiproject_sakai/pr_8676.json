{"pr_number": 8676, "pr_title": "SAK-29425 forums > add percent read and num authored to individual statistics UI", "pr_createdAt": "2020-10-09T20:53:19Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8676", "timeline": [{"oid": "3d26e0a0e814f759d7a3849d2afd0031bb5f3087", "url": "https://github.com/sakaiproject/sakai/commit/3d26e0a0e814f759d7a3849d2afd0031bb5f3087", "message": "SAK-29425 forums > add percent read and num authored to individual statistics UI", "committedDate": "2020-10-09T20:52:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY2NjQ5MQ==", "url": "https://github.com/sakaiproject/sakai/pull/8676#discussion_r502666491", "bodyText": "This can be reduced to 1 line:\ntotalPosts = studentAuthoredStats.stream().map( (pair) -> ((Long) pair[1]).intValue() ).reduce( totalPosts, Integer::sum );\nHowever, I'm not sure if it's more or less readable.", "author": "bjones86", "createdAt": "2020-10-09T20:54:04Z", "path": "msgcntr/messageforums-app/src/java/org/sakaiproject/tool/messageforums/ui/MessageForumStatisticsBean.java", "diffHunk": "@@ -3112,4 +3112,17 @@ private boolean isUseAnonymousId(Topic topic)\n \t\t// Condenses to:\n \t\treturn topic.getPostAnonymous() && (!topic.getRevealIDsToRoles() || !uiPermissionsManager.isIdentifyAnonAuthors((DiscussionTopic) topic));\n \t}\n+\n+    public int getPercentRead()\n+    {\n+        int totalPosts = 0;\n+        List<Object[]> studentAuthoredStats = messageManager.findAuthoredMessageCountForAllStudents();\n+        for (Object[] pair : studentAuthoredStats)\n+        {\n+            totalPosts += ((Long) pair[1]).intValue();\n+        }", "originalCommit": "3d26e0a0e814f759d7a3849d2afd0031bb5f3087", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2NjAzMQ==", "url": "https://github.com/sakaiproject/sakai/pull/8676#discussion_r504166031", "bodyText": "These <span>'s are probably better to have in the JSP. Let me know if I should refactor.", "author": "bjones86", "createdAt": "2020-10-13T18:19:53Z", "path": "msgcntr/messageforums-api/src/bundle/org/sakaiproject/api/app/messagecenter/bundle/Messages.properties", "diffHunk": "@@ -100,6 +100,8 @@ stat_sort_by_date=Sort by Date\n stat_byUser=by User\n stat_byTopic=by Topic\n stat_totalMessages=Total Messages\n+stat_percent_read=<span class=\"statsTally\">Percent Read:</span> {0}%\n+stat_num_authored=<span class=\"statsTally\">Messages Authored:</span> {0}", "originalCommit": "3d26e0a0e814f759d7a3849d2afd0031bb5f3087", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2NzUyOA==", "url": "https://github.com/sakaiproject/sakai/pull/8676#discussion_r504167528", "bodyText": "this just smells like it can blow up, no?", "author": "ottenhoff", "createdAt": "2020-10-13T18:22:39Z", "path": "msgcntr/messageforums-app/src/java/org/sakaiproject/tool/messageforums/ui/MessageForumStatisticsBean.java", "diffHunk": "@@ -3112,4 +3112,17 @@ private boolean isUseAnonymousId(Topic topic)\n \t\t// Condenses to:\n \t\treturn topic.getPostAnonymous() && (!topic.getRevealIDsToRoles() || !uiPermissionsManager.isIdentifyAnonAuthors((DiscussionTopic) topic));\n \t}\n+\n+    public int getPercentRead()\n+    {\n+        int totalPosts = 0;\n+        List<Object[]> studentAuthoredStats = messageManager.findAuthoredMessageCountForAllStudents();\n+        for (Object[] pair : studentAuthoredStats)\n+        {\n+            totalPosts += ((Long) pair[1]).intValue();", "originalCommit": "3d26e0a0e814f759d7a3849d2afd0031bb5f3087", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE3ODk2OQ==", "url": "https://github.com/sakaiproject/sakai/pull/8676#discussion_r504178969", "bodyText": "I've tested it for both users that have read some, and those who have read none: no explosions.\nIt's certainly not how I would have coded findAuthoredMessageCountForAllStudents(), but it does seem to gaurantee zeros instead of nulls.", "author": "bjones86", "createdAt": "2020-10-13T18:43:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2NzUyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE4MDc3NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8676#discussion_r504180775", "bodyText": "ok not sure how but ok !", "author": "ottenhoff", "createdAt": "2020-10-13T18:46:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE2NzUyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE4MTYxMg==", "url": "https://github.com/sakaiproject/sakai/pull/8676#discussion_r504181612", "bodyText": "can just use #666 instead ? it's widely used in in other files", "author": "ottenhoff", "createdAt": "2020-10-13T18:48:21Z", "path": "library/src/morpheus-master/sass/modules/tool/forums/_forums.scss", "diffHunk": "@@ -295,4 +295,9 @@\n \t\t\tmargin: 0 $standard-space $standard-space 0;\n \t\t}\n \t}\n+\n+\t.statsTally {\n+\t\tcolor: #655f62;", "originalCommit": "3d26e0a0e814f759d7a3849d2afd0031bb5f3087", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a6e9aefc1db3f06d958c05579c17227aa98e02d2", "url": "https://github.com/sakaiproject/sakai/commit/a6e9aefc1db3f06d958c05579c17227aa98e02d2", "message": "Update _forums.scss", "committedDate": "2020-10-13T18:50:33Z", "type": "commit"}]}