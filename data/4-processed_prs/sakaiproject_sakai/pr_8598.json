{"pr_number": 8598, "pr_title": "SAK-39751 - Add getLong method to ServerConfigurationService", "pr_createdAt": "2020-09-20T19:16:47Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8598", "timeline": [{"oid": "09495ea5133b26f14c7a884a562211ab8e6b2216", "url": "https://github.com/sakaiproject/sakai/commit/09495ea5133b26f14c7a884a562211ab8e6b2216", "message": "SAK-39751 - Add getLong method to ServerConfigurationService", "committedDate": "2020-09-20T19:13:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcwNDE5Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8598#discussion_r492704196", "bodyText": "This method can just be \"return NumberUtils.toLong(getString(name), dflt);\". It will handle NumberFormatException also.", "author": "plukasew", "createdAt": "2020-09-22T12:47:00Z", "path": "kernel/kernel-impl/src/main/java/org/sakaiproject/component/impl/BasicConfigurationService.java", "diffHunk": "@@ -625,6 +625,18 @@ protected int dereferenceConfig() {\n         return rv;\n     }\n \n+    /**\n+     * {@inheritDoc}\n+     */\n+    public long getLong(String name, long dflt)\n+    {\n+        String value = getString(name);\n+\n+        if (StringUtils.isEmpty(value)) return dflt;\n+\n+        return Long.parseLong(value);", "originalCommit": "09495ea5133b26f14c7a884a562211ab8e6b2216", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA0NTIwMQ==", "url": "https://github.com/sakaiproject/sakai/pull/8598#discussion_r493045201", "bodyText": "Thanks, I was just re-using the existing pattern and didn't put much thought into improving this. NumberUtils here would probably reduce more code.", "author": "jonespm", "createdAt": "2020-09-22T21:30:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcwNDE5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcwNzY1OQ==", "url": "https://github.com/sakaiproject/sakai/pull/8598#discussion_r492707659", "bodyText": "defaultvalue is a Long already so you can just cast directly to Long: this.getLong(name, (Long) defaultValue);", "author": "plukasew", "createdAt": "2020-09-22T12:52:22Z", "path": "kernel/kernel-impl/src/main/java/org/sakaiproject/component/impl/BasicConfigurationService.java", "diffHunk": "@@ -1093,9 +1105,16 @@ protected ConfigItemImpl findConfigItem(String name, Object defaultValue) {\n             }\n         } else {\n             if (defaultValue instanceof Number) {\n-                int num = ((Number) defaultValue).intValue();\n-                int intValue = this.getInt(name, num);\n-                returnValue = (T) Integer.valueOf(intValue);\n+                if (defaultValue instanceof Long) {\n+                    long num = ((Number) defaultValue).longValue();\n+                    long longValue = this.getLong(name, num);", "originalCommit": "09495ea5133b26f14c7a884a562211ab8e6b2216", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA1MjY2OA==", "url": "https://github.com/sakaiproject/sakai/pull/8598#discussion_r493052668", "bodyText": "Thanks!", "author": "jonespm", "createdAt": "2020-09-22T21:47:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjcwNzY1OQ=="}], "type": "inlineReview"}, {"oid": "5b7a5cfab4868370b10a96c5f5bbdb2a4dec4a81", "url": "https://github.com/sakaiproject/sakai/commit/5b7a5cfab4868370b10a96c5f5bbdb2a4dec4a81", "message": "Simplifying methods using NumberUtils\nUpdating mock\nUpdating number of values in test", "committedDate": "2020-09-22T21:45:19Z", "type": "commit"}, {"oid": "e7530c1e527eebc4c0901e823442a9c32a1dfe9d", "url": "https://github.com/sakaiproject/sakai/commit/e7530c1e527eebc4c0901e823442a9c32a1dfe9d", "message": "defaultvalue is a Long already so you can just cast directly to Long: this.getLong(name, (Long) defaultValue);", "committedDate": "2020-09-22T21:48:30Z", "type": "commit"}]}