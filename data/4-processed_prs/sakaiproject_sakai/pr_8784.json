{"pr_number": 8784, "pr_title": "SAK-44611 Forums: Rubric icon does not appear from ELFinder links", "pr_createdAt": "2020-11-05T11:55:04Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8784", "timeline": [{"oid": "7490a0c45bd380cefeaa6e89afb796ae487d0f1d", "url": "https://github.com/sakaiproject/sakai/commit/7490a0c45bd380cefeaa6e89afb796ae487d0f1d", "message": "SAK-44611 Forums: Rubric icon does not appear from ELFinder links", "committedDate": "2020-11-05T12:54:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkyMzA1NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8784#discussion_r518923055", "bodyText": "You can simplify this with:\nthis.locale = (window.top?.portal?.locale || window.top?.sakai?.locale?.userLocale || \"en-US\").replace(\"_\", \"-\");", "author": "adrianfish", "createdAt": "2020-11-06T18:16:03Z", "path": "webcomponents/tool/src/main/frontend/js/rubrics/rubrics-element.js", "diffHunk": "@@ -6,7 +6,7 @@ class RubricsElement extends SakaiElement {\n \n     super();\n \n-    this.locale = window.portal ? window.portal.locale : window.top.portal.locale;\n+    this.locale = window.portal ? window.portal.locale : window.top.portal ? window.top.portal.locale : window.top.sakai.locale.userLocale.replace(\"_\",\"-\");", "originalCommit": "7490a0c45bd380cefeaa6e89afb796ae487d0f1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY0OTQyOA==", "url": "https://github.com/sakaiproject/sakai/pull/8784#discussion_r532649428", "bodyText": "What that line means is:\nif we have window.top.portal.locale, use it, else, if we have window.top.sakai.locale, use that, else use en-US. Then replace _ with - on whatever we end with.", "author": "adrianfish", "createdAt": "2020-11-30T14:46:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkyMzA1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQzMzA0MA==", "url": "https://github.com/sakaiproject/sakai/pull/8784#discussion_r535433040", "bodyText": "Thanks for the suggestion @adrianfish , I've just uploaded the changes.", "author": "josecebe", "createdAt": "2020-12-03T17:23:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkyMzA1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQzNDQ5OQ==", "url": "https://github.com/sakaiproject/sakai/pull/8784#discussion_r535434499", "bodyText": "this is probably out of scope for this JIRA, but there is no guarantee we are window.top!!!!!", "author": "ottenhoff", "createdAt": "2020-12-03T17:25:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODkyMzA1NQ=="}], "type": "inlineReview"}, {"oid": "a8d50414700214c9e3a3857485536c9284f03a86", "url": "https://github.com/sakaiproject/sakai/commit/a8d50414700214c9e3a3857485536c9284f03a86", "message": "SAK-44611 Forums: Rubric icon does not appear from ELFinder links", "committedDate": "2020-12-03T17:21:36Z", "type": "commit"}, {"oid": "a8d50414700214c9e3a3857485536c9284f03a86", "url": "https://github.com/sakaiproject/sakai/commit/a8d50414700214c9e3a3857485536c9284f03a86", "message": "SAK-44611 Forums: Rubric icon does not appear from ELFinder links", "committedDate": "2020-12-03T17:21:36Z", "type": "forcePushed"}]}