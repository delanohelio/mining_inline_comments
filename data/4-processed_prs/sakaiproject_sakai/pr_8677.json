{"pr_number": 8677, "pr_title": "SAK-44410 Unboundid - add options for setHealthCheckIntervalMillis an\u2026", "pr_createdAt": "2020-10-10T01:34:46Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8677", "timeline": [{"oid": "ea9827a4b2b94b489cdd286568ca2bab12fba592", "url": "https://github.com/sakaiproject/sakai/commit/ea9827a4b2b94b489cdd286568ca2bab12fba592", "message": "SAK-44410 Unboundid - add options for setHealthCheckIntervalMillis and setHealthCheck", "committedDate": "2020-10-10T01:33:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM0MTA2Nw==", "url": "https://github.com/sakaiproject/sakai/pull/8677#discussion_r503341067", "bodyText": "this looks good. can you be more definitive with this sentence (\"may not\")? what happens if this is unset?", "author": "ottenhoff", "createdAt": "2020-10-12T14:38:16Z", "path": "providers/component/src/webapp/WEB-INF/unboundid-ldap.xml", "diffHunk": "@@ -144,6 +144,30 @@\n \t\t\t<value>false</value>\n \t\t</property -->\n \n+\t\t<!-- Specifies the length of time in milliseconds between periodic background\n+\t\t\thealth checks against the available connections in this pool.\n+\t\t\tRequires healthCheckMappings's invokeForBackgroundChecks to be set to true\n+\t\t\tDefaults to 60000L -->\n+\t\t<!-- property name=\"healthCheckIntervalMillis\">\n+\t\t\t<value>60000</value>\n+\t\t</property -->\n+\n+\t\t<!-- Provides mapping to create an LDAP connection pool health check implementation\n+\t\t\tthat may be used to check the health of the associated server by verifying that\n+\t\t\ta specified entry can be retrieved in an acceptable period of time\n+\t\t\tDefaults to null (invokes the Unboundid defaut implementation, which may not do any checks) -->", "originalCommit": "ea9827a4b2b94b489cdd286568ca2bab12fba592", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzYyMTc3Ng==", "url": "https://github.com/sakaiproject/sakai/pull/8677#discussion_r503621776", "bodyText": "done.  I rechecked the LDAPConnectionPoolHealthCheck class in UnboundId's 4.0.12 source code and the default health check methods mostly do:\n// No processing is performed in this default implementation.\nand the only method that does something, ensureConnectionValidAfterException(), only throws an error if the connection is bad.", "author": "austin48", "createdAt": "2020-10-13T01:50:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM0MTA2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNzA5Mw==", "url": "https://github.com/sakaiproject/sakai/pull/8677#discussion_r503427093", "bodyText": "please remove the useless javadoc\nYou could also use @getter and @Setter to remove this boiler plate all together", "author": "ern", "createdAt": "2020-10-12T17:08:38Z", "path": "providers/unboundid/src/java/org/sakaiproject/unboundid/UnboundidDirectoryProvider.java", "diffHunk": "@@ -1219,6 +1239,36 @@ public void setRetryFailedOperationsDueToInvalidConnections(boolean retryFailedO\n \t\tthis.retryFailedOperationsDueToInvalidConnections = retryFailedOperationsDueToInvalidConnections;\n \t}\n \n+\t/**\n+\t * {@inheritDoc}\n+\t */\n+\tpublic long getHealthCheckIntervalMillis() {\n+\t\treturn healthCheckIntervalMillis;\n+\t}\n+\n+\t/**\n+\t * {@inheritDoc}\n+\t */\n+\tpublic void setHealthCheckIntervalMillis(long healthCheckIntervalMillis) {\n+\t\tthis.healthCheckIntervalMillis = healthCheckIntervalMillis;\n+\t}\n+\n+\t/**\n+\t * {@inheritDoc}\n+\t */\n+\tpublic Map<String, String> getHealthCheckMappings()\n+\t{\n+\t\treturn healthCheckMappings;\n+\t}\n+\n+\t/**\n+\t * {@inheritDoc}\n+\t */\n+\tpublic void setHealthCheckMappings(Map<String, String> healthCheckMappings)\n+\t{\n+\t\tthis.healthCheckMappings = healthCheckMappings;\n+\t}\n+", "originalCommit": "ea9827a4b2b94b489cdd286568ca2bab12fba592", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzYyMTg5Mg==", "url": "https://github.com/sakaiproject/sakai/pull/8677#discussion_r503621892", "bodyText": "done.  javadoc is removed", "author": "austin48", "createdAt": "2020-10-13T01:51:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNzA5Mw=="}], "type": "inlineReview"}, {"oid": "3422a47c6b395022b643f33066a794ac3f16786f", "url": "https://github.com/sakaiproject/sakai/commit/3422a47c6b395022b643f33066a794ac3f16786f", "message": "SAK-44410 Unboundid - add options for setHealthCheckIntervalMillis and setHealthCheck\n\nclean up comments", "committedDate": "2020-10-13T01:47:31Z", "type": "commit"}]}