{"pr_number": 55, "pr_title": "Initial work towards using OpenTelemetry API directly from instrumentation", "pr_createdAt": "2020-01-14T22:03:29Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/55", "timeline": [{"oid": "10db16359cbf218779d8a7ea1e9d672819d8d844", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/10db16359cbf218779d8a7ea1e9d672819d8d844", "message": "Deprecate Agent API", "committedDate": "2020-01-15T22:44:29Z", "type": "commit"}, {"oid": "4cc0b13793db2cef1e404cd273ffd40bec69425b", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/4cc0b13793db2cef1e404cd273ffd40bec69425b", "message": "Rename setTag to setAttribute", "committedDate": "2020-01-15T22:44:29Z", "type": "commit"}, {"oid": "7c98a5c02f36a700e68cc7205fc466e0b9778a22", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/7c98a5c02f36a700e68cc7205fc466e0b9778a22", "message": "Update elasticsearch", "committedDate": "2020-01-15T22:53:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE2ODQxNA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/55#discussion_r367168414", "bodyText": "Consider applying this in a single io.opentelemetry rule but applying exclusions: https://imperceptiblethoughts.com/shadow/configuration/relocation/#filtering-relocation", "author": "tylerbenson", "createdAt": "2020-01-15T23:55:33Z", "path": "java-agent/instrumentation/instrumentation.gradle", "diffHunk": "@@ -89,5 +89,13 @@ shadowJar {\n     exclude(project(':trace-api'))\n     exclude(project(':java-agent:opentelemetry-sdk'))\n   }\n+\n+  // relocate OpenTelemetry API usage\n+  relocate \"io.opentelemetry.OpenTelemetry\", \"io.opentelemetry.auto.shaded.io.opentelemetry.OpenTelemetry\"\n+  relocate \"io.opentelemetry.context\", \"io.opentelemetry.auto.shaded.io.opentelemetry.context\"\n+  relocate \"io.opentelemetry.distributedcontext\", \"io.opentelemetry.auto.shaded.io.opentelemetry.distributedcontext\"\n+  relocate \"io.opentelemetry.internal\", \"io.opentelemetry.auto.shaded.io.opentelemetry.internal\"\n+  relocate \"io.opentelemetry.metrics\", \"io.opentelemetry.auto.shaded.io.opentelemetry.metrics\"\n+  relocate \"io.opentelemetry.trace\", \"io.opentelemetry.auto.shaded.io.opentelemetry.trace\"", "originalCommit": "fcc3e006e2083426d87ea2a76bceaef1a2325b4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE4Nzk5Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/55#discussion_r367187993", "bodyText": "Oh, this looks nice!\nUnfortunately, it's not working for me, I tried:\n  relocate('io.opentelemetry', 'io.opentelemetry.auto.shaded.io.opentelemetry') {\n    exclude 'io.opentelemetry.auto.*'\n  }\n\nand\n  relocate('io.opentelemetry', 'io.opentelemetry.auto.shaded.io.opentelemetry') {\n    exclude 'io.opentelemetry.auto.**'\n  }\n\nand\n  relocate('io.opentelemetry', 'io.opentelemetry.auto.shaded.io.opentelemetry') {\n    exclude 'io.opentelemetry.auto'\n  }", "author": "trask", "createdAt": "2020-01-16T01:14:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE2ODQxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY4NjI0OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/55#discussion_r367686249", "bodyText": "See johnrengelman/shadow#539 \ud83d\ude04", "author": "trask", "createdAt": "2020-01-16T22:37:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE2ODQxNA=="}], "type": "inlineReview"}, {"oid": "3e24fa893e775394ab442064a6010e75abacfa94", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3e24fa893e775394ab442064a6010e75abacfa94", "message": "Update base decorators", "committedDate": "2020-01-16T00:47:07Z", "type": "commit"}, {"oid": "a7899937928a6fde549f10046e3f8e3115129006", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a7899937928a6fde549f10046e3f8e3115129006", "message": "Temp: exclude base decorators from code coverage", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "1c44629f3477d7a130f18cab1146747669dfcea8", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/1c44629f3477d7a130f18cab1146747669dfcea8", "message": "Shade OpenTelemetry usage in instrumentation", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "aa5df5b84aab701afff857b15a4ae29ad88a0654", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/aa5df5b84aab701afff857b15a4ae29ad88a0654", "message": "Add SpanScopePair", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "96de8f78a8dc4265b3a372dfc697668e8cf1a3e1", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/96de8f78a8dc4265b3a372dfc697668e8cf1a3e1", "message": "Update google-http-client", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "840b98f174c0875f7f54947e314a9ec2f39e6511", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/840b98f174c0875f7f54947e314a9ec2f39e6511", "message": "Update akka-http", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "d31dac6bd01a9c8a6e0b996bfa8dc53cf5982f58", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/d31dac6bd01a9c8a6e0b996bfa8dc53cf5982f58", "message": "Update apache-httpasyncclient", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "7d277caf5d61f2b71eec4b8feb559fbc04fa227e", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/7d277caf5d61f2b71eec4b8feb559fbc04fa227e", "message": "Update apache-httpclient", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "d0450bab123607d2f466d9a9b7318f2baf1a2b7d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/d0450bab123607d2f466d9a9b7318f2baf1a2b7d", "message": "Update aws-java-sdk-1.11.0", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "95647639f9c501a7604cb2d8adb13d6e8466771e", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/95647639f9c501a7604cb2d8adb13d6e8466771e", "message": "Update couchbase-2.0 and rxjava friends", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "026fedede25f59beb57525ebda276f652d193cd3", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/026fedede25f59beb57525ebda276f652d193cd3", "message": "Update couchbase-2.6", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "893fbe8b7976baf019eccd0a2bb623d7c7df3410", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/893fbe8b7976baf019eccd0a2bb623d7c7df3410", "message": "Update datastax-cassandra", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "8a923b066fe87b5a58729e5bd797e00c39633eb7", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/8a923b066fe87b5a58729e5bd797e00c39633eb7", "message": "Update dropwizard", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "fa5f274a3c2586d2d60c475c1a43f02fc45548af", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/fa5f274a3c2586d2d60c475c1a43f02fc45548af", "message": "Update elasticsearch", "committedDate": "2020-01-16T00:47:08Z", "type": "commit"}, {"oid": "fa5f274a3c2586d2d60c475c1a43f02fc45548af", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/fa5f274a3c2586d2d60c475c1a43f02fc45548af", "message": "Update elasticsearch", "committedDate": "2020-01-16T00:47:08Z", "type": "forcePushed"}]}