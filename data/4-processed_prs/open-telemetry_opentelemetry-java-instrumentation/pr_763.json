{"pr_number": 763, "pr_title": "Add tests to spring-boot-autoconfigure", "pr_createdAt": "2020-07-23T00:11:49Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/763", "timeline": [{"oid": "6d4da27b7b2e7ad4ed4604e638a30fcbe10b2e79", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/6d4da27b7b2e7ad4ed4604e638a30fcbe10b2e79", "message": "add tests to springboot-autoconfigure", "committedDate": "2020-07-23T00:12:20Z", "type": "commit"}, {"oid": "6b2e05491e37c41f10eb65e553e5a5e2a8d1767a", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/6b2e05491e37c41f10eb65e553e5a5e2a8d1767a", "message": "Update WebMVCFilterAutoConfigurationTest.java", "committedDate": "2020-07-23T00:12:20Z", "type": "commit"}, {"oid": "2a9db3f962593f56b8bcadab53e58bd5b08c0bb6", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/2a9db3f962593f56b8bcadab53e58bd5b08c0bb6", "message": "fixed tracer autoconfiguration tests, added missing bean test case, and added java docs", "committedDate": "2020-07-23T00:12:20Z", "type": "commit"}, {"oid": "155280deee1aeada818710ba9dad58052825404a", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/155280deee1aeada818710ba9dad58052825404a", "message": "fixed test names and added is missing tests", "committedDate": "2020-07-23T00:12:21Z", "type": "commit"}, {"oid": "0ba63820e74e232d995ee151afb8ca5e42f67f99", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/0ba63820e74e232d995ee151afb8ca5e42f67f99", "message": "fix inject mocks", "committedDate": "2020-07-23T00:12:21Z", "type": "forcePushed"}, {"oid": "632792ccafbef90d3f98413cfd8dc4626644d685", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/632792ccafbef90d3f98413cfd8dc4626644d685", "message": "re-run tests", "committedDate": "2020-07-23T02:41:46Z", "type": "commit"}, {"oid": "632792ccafbef90d3f98413cfd8dc4626644d685", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/632792ccafbef90d3f98413cfd8dc4626644d685", "message": "re-run tests", "committedDate": "2020-07-23T02:41:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI5NjIyNA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/763#discussion_r461296224", "bodyText": "did you mean to call this multiple times?", "author": "trask", "createdAt": "2020-07-28T03:30:58Z", "path": "instrumentation-core/spring/spring-boot-autoconfigure/src/test/java/io/opentelemetry/instrumentation/spring/autoconfigure/httpclients/webclient/WebClientBeanPostProcessorTest.java", "diffHunk": "@@ -0,0 +1,101 @@\n+/*\n+ * Copyright The OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.instrumentation.spring.autoconfigure.httpclients.webclient;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertTrue;\n+\n+import io.opentelemetry.instrumentation.springwebflux.client.WebClientTracingFilter;\n+import io.opentelemetry.trace.Tracer;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import org.mockito.junit.MockitoJUnitRunner;\n+import org.springframework.web.reactive.function.client.WebClient;\n+\n+/** Spring bean post processor test {@link WebClientBeanPostProcessor} */\n+@RunWith(MockitoJUnitRunner.class)\n+public class WebClientBeanPostProcessorTest {\n+\n+  @Mock Tracer tracer;\n+\n+  WebClientBeanPostProcessor webClientBeanPostProcessor = new WebClientBeanPostProcessor(tracer);\n+\n+  @Test\n+  public void\n+      should_return_object_if_processed_bean_is_NOT_of_type_WebClient_or_WebClientBuilder() {\n+    assertEquals(\n+        webClientBeanPostProcessor\n+            .postProcessAfterInitialization(new Object(), \"testObject\")\n+            .getClass(),\n+        Object.class);\n+  }\n+\n+  @Test\n+  public void should_return_web_client_if_processed_bean_is_of_type_WebClient() {\n+    WebClient webClient = WebClient.create();\n+\n+    assertTrue(\n+        webClientBeanPostProcessor.postProcessAfterInitialization(webClient, \"testWebClient\")\n+            instanceof WebClient);\n+  }\n+\n+  @Test\n+  public void should_return_WebClientBuilder_if_processed_bean_is_of_type_WebClientBuilder() {\n+    WebClient.Builder webClientBuilder = WebClient.builder();\n+\n+    assertTrue(\n+        webClientBeanPostProcessor.postProcessAfterInitialization(\n+                webClientBuilder, \"testWebClientBuilder\")\n+            instanceof WebClient.Builder);\n+  }\n+\n+  @Test\n+  public void should_add_ONE_exchange_filter_to_WebClient() {\n+    WebClient webClient = WebClient.create();\n+    Object processedWebClient =\n+        webClientBeanPostProcessor.postProcessAfterInitialization(webClient, \"testWebClient\");", "originalCommit": "632792ccafbef90d3f98413cfd8dc4626644d685", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc4OTI1OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/763#discussion_r461789259", "bodyText": "It wouldn't make sense to call webClientBeanPostProcessor.postProcessAfterInitialization multiple times since it returns a new WebClient object. I changed the name of the test from should_add_ONE_exchange_filter_to_WebClient to should_add_exchange_filter_to_WebClient", "author": "mabdinur", "createdAt": "2020-07-28T18:33:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTI5NjIyNA=="}], "type": "inlineReview"}, {"oid": "be7c69079672ea5a817f4f73ba9253f53862867f", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/be7c69079672ea5a817f4f73ba9253f53862867f", "message": "Update WebClientBeanPostProcessorTest.java", "committedDate": "2020-07-28T18:31:09Z", "type": "commit"}]}