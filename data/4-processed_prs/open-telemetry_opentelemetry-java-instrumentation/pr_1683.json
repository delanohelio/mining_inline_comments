{"pr_number": 1683, "pr_title": "Fix dependencies for testLatestDeps to work in Struts2", "pr_createdAt": "2020-11-18T14:45:34Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1683", "timeline": [{"oid": "1250e92b3f017a12f2912e7ea3e1b17536988b14", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/1250e92b3f017a12f2912e7ea3e1b17536988b14", "message": "Fix dependencies for testLatestDeps to work.", "committedDate": "2020-11-18T14:43:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY3MDgyMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1683#discussion_r526670821", "bodyText": "Why changing these dependencies' declarations?", "author": "iNikem", "createdAt": "2020-11-19T08:20:56Z", "path": "instrumentation/struts-2.3/javaagent/struts-2.3-javaagent.gradle", "diffHunk": "@@ -11,13 +11,17 @@ muzzle {\n dependencies {\n   library group: 'org.apache.struts', name: 'struts2-core', version: '2.3.20'\n \n-  testImplementation(project(':testing-common')) {\n-    exclude group: 'org.eclipse.jetty', module: 'jetty-server'\n-  }\n-  testLibrary group: 'org.eclipse.jetty', name: 'jetty-server', version: '8.0.0.v20110901'\n-  testLibrary group: 'org.eclipse.jetty', name: 'jetty-servlet', version: '8.0.0.v20110901'\n-  testLibrary group: 'javax.servlet', name: 'javax.servlet-api', version: '3.0.1'\n-  testLibrary group: 'javax.servlet', name: 'jsp-api', version: '2.0'\n+  // There was no 2.4 version at all.\n+  // In version 2.5 Struts Servlet Filter entry point was relocated.\n+  // This Servlet Filter is relevant only in setting up the test app and it is not used in\n+  // instrumentation. So fixing Struts library version for the test.\n+  latestDepTestLibrary group: 'org.apache.struts', name: 'struts2-core', version: '2.3.+'\n+\n+  testImplementation(project(':testing-common'))\n+  testImplementation group: 'org.eclipse.jetty', name: 'jetty-server', version: '8.0.0.v20110901'\n+  testImplementation group: 'org.eclipse.jetty', name: 'jetty-servlet', version: '8.0.0.v20110901'\n+  testRuntime group: 'javax.servlet', name: 'javax.servlet-api', version: '3.0.1'", "originalCommit": "1250e92b3f017a12f2912e7ea3e1b17536988b14", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY3MzEwMw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1683#discussion_r526673103", "bodyText": "Because I read the doc and these dependencies are not the libraries in the sense of library/testLibrary configuration. They are only for running the test and have nothing to do with instrumentation logic and I don't want them to be upgraded behind the scenes to the latest version.", "author": "vovencij", "createdAt": "2020-11-19T08:24:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjY3MDgyMQ=="}], "type": "inlineReview"}]}