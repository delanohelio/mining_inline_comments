{"pr_number": 674, "pr_title": "Zipkin, Jaeger: use standard exporter configuration from OpenTelemetry Java SDK", "pr_createdAt": "2020-07-13T04:01:22Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674", "timeline": [{"oid": "eccc2c71f9b7c9d2eb4f988c283b4a96bf2bef2a", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/eccc2c71f9b7c9d2eb4f988c283b4a96bf2bef2a", "message": "#531 Zipkin, Jaeger: use standard exporter configuration from OpenTelemetry Java SDK\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-07-13T04:00:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyMzM2Nw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r453423367", "bodyText": "I forgot about this, I think we need to force OkHttpSender here due to #375 (comment)", "author": "trask", "createdAt": "2020-07-13T04:04:43Z", "path": "auto-exporters/zipkin/src/main/java/io/opentelemetry/auto/exporters/zipkin/ZipkinExporterFactory.java", "diffHunk": "@@ -23,19 +23,12 @@\n import zipkin2.reporter.okhttp3.OkHttpSender;\n \n public class ZipkinExporterFactory implements SpanExporterFactory {\n-  private static final String ZIPKIN_ENDPOINT = \"zipkin.endpoint\";\n-  private static final String DEFAULT_ZIPKIN_ENDPOINT = \"http://localhost:9411/api/v2/spans\";\n-\n-  private static final String ZIPKIN_SERVICE_NAME = \"zipkin.service.name\";\n-  private static final String DEFAULT_ZIPKIN_SERVICE_NAME = \"(unknown service)\";\n \n   @Override\n   public SpanExporter fromConfig(Config config) {\n-    final String zipkinEndpoint = config.getString(ZIPKIN_ENDPOINT, DEFAULT_ZIPKIN_ENDPOINT);\n-    final String serviceName = config.getString(ZIPKIN_SERVICE_NAME, DEFAULT_ZIPKIN_SERVICE_NAME);\n     return ZipkinSpanExporter.newBuilder()\n-        .setSender(OkHttpSender.create(zipkinEndpoint))", "originalCommit": "eccc2c71f9b7c9d2eb4f988c283b4a96bf2bef2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQzMDcxNQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r453430715", "bodyText": "ok, trying to set it.", "author": "malafeev", "createdAt": "2020-07-13T04:39:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyMzM2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQzMTI5MA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r453431290", "bodyText": "Anyways except for when the JAR size is extremely limited, Zipkin always recommends using OkHttp in production since performance is way better.", "author": "anuraaga", "createdAt": "2020-07-13T04:42:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyMzM2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQzMzIxMw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r453433213", "bodyText": "I opened open-telemetry/opentelemetry-java#1409 to change the default upstream, so we don't have to override it in the future", "author": "trask", "createdAt": "2020-07-13T04:51:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyMzM2Nw=="}], "type": "inlineReview"}, {"oid": "6c45e19828c6c1a7e4e81db18ad5f433cbd6d14b", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/6c45e19828c6c1a7e4e81db18ad5f433cbd6d14b", "message": "#531 remove unused import\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-07-13T04:08:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNjI3NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r453426275", "bodyText": "Wrong format of System property name", "author": "iNikem", "createdAt": "2020-07-13T04:18:17Z", "path": "README.md", "diffHunk": "@@ -57,17 +57,17 @@ only supports gRPC as its communications protocol.\n | System property                  | Environment variable             | Purpose                                                              |\n |----------------------------------|----------------------------------|----------------------------------------------------------------------|\n | ota.exporter=jaeger              | OTA_EXPORTER=jaeger              | To select Jaeger exporter                                            |\n-| ota.exporter.jaeger.endpoint     | OTA_EXPORTER_JAEGER_ENDPOINT     | The Jaeger endpoint to connect to. Currently only gRPC is supported. |\n-| ota.exporter.jaeger.service.name | OTA_EXPORTER_JAEGER_SERVICE_NAME | The service name of this JVM instance                                |\n+| JAEGER_ENDPOINT                  | JAEGER_ENDPOINT                  | The Jaeger endpoint to connect to. Currently only gRPC is supported. |", "originalCommit": "6c45e19828c6c1a7e4e81db18ad5f433cbd6d14b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNzA5MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r453427091", "bodyText": "Yes and no \ud83d\ude04. It's an issue upstream. Should get fixed by open-telemetry/opentelemetry-java#1408.", "author": "trask", "createdAt": "2020-07-13T04:22:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNjI3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyOTA4NA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r453429084", "bodyText": "yes, but it comes from otel-java: https://github.com/open-telemetry/opentelemetry-java/blob/master/exporters/jaeger/src/main/java/io/opentelemetry/exporters/jaeger/JaegerGrpcSpanExporter.java#L41", "author": "malafeev", "createdAt": "2020-07-13T04:31:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNjI3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEyMjI1NA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r463122254", "bodyText": "The environment var JAEGER_SERVICE_NAME must be OTEL_JAEGER_SERVICE_NAME to work for me in 0.7.0-SNAPSHOT (current master head). In 0.5.0 it was OTA_EXPORTER_JAEGER_SERVICE_NAME, in 0.6.0 only JAEGER_SERVICE_NAME.\nI'm a little bit confused... what is really expected? \ud83d\ude38", "author": "flecno", "createdAt": "2020-07-30T16:29:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNjI3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEyOTY5MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r463129691", "bodyText": "it makes sense to have documented it in otel-java and here add a link to it, although link also can be broken in next release...", "author": "malafeev", "createdAt": "2020-07-30T16:42:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNjI3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE5NDA3NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r463194075", "bodyText": "hey @flecno! does this PR answer your question: #830", "author": "trask", "createdAt": "2020-07-30T18:35:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNjI3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc2NTQ5Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/674#discussion_r463765493", "bodyText": "Yes, thank you!", "author": "flecno", "createdAt": "2020-07-31T18:27:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzQyNjI3NQ=="}], "type": "inlineReview"}, {"oid": "85b63de06ce9f3f528a2761af07373939d61b435", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/85b63de06ce9f3f528a2761af07373939d61b435", "message": "#531 use OkHttpSender for zipkin exporter\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-07-13T04:39:13Z", "type": "commit"}]}