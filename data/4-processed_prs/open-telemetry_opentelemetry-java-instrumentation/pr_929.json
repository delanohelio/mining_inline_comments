{"pr_number": 929, "pr_title": "Fix WithSpan annotation instrumentation", "pr_createdAt": "2020-08-08T20:24:58Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/929", "timeline": [{"oid": "f6051739ddbcd58d6aab523af4db4161fec7f3a2", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/f6051739ddbcd58d6aab523af4db4161fec7f3a2", "message": "Fix WithSpan annotation instrumentation", "committedDate": "2020-08-08T20:24:12Z", "type": "commit"}, {"oid": "92f0c0e93dc4bb65f5b5e430eb7faf9e9aca007b", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/92f0c0e93dc4bb65f5b5e430eb7faf9e9aca007b", "message": "Merge remote-tracking branch 'upstream/master' into fix-with-span", "committedDate": "2020-08-09T03:37:08Z", "type": "commit"}, {"oid": "e42534c44a9f9bcbf7a3d629112b8aa6ac4f848d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/e42534c44a9f9bcbf7a3d629112b8aa6ac4f848d", "message": "fixmerge", "committedDate": "2020-08-09T03:37:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUzNTcwMg==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/929#discussion_r467535702", "bodyText": "Just to confirm this means our unit tests can catch the issue in the future?", "author": "anuraaga", "createdAt": "2020-08-09T04:45:21Z", "path": "opentelemetry-auto-annotations-beta-shaded-for-instrumenting/opentelemetry-auto-annotations-beta-shaded-for-instrumenting.gradle", "diffHunk": "@@ -0,0 +1,17 @@\n+plugins {\n+  id \"com.github.johnrengelman.shadow\"\n+}\n+\n+apply from: \"$rootDir/gradle/java.gradle\"\n+\n+dependencies {\n+  implementation deps.opentelemetryAutoAnnotations\n+}\n+\n+// OpenTelemetry Auto Annotations shaded so that it can be used in opentelemetry-api-beta\n+// instrumentation, and then its usage can be unshaded after OpenTelemetry API is shaded", "originalCommit": "e42534c44a9f9bcbf7a3d629112b8aa6ac4f848d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUzNjQxMA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/929#discussion_r467536410", "bodyText": "unfortunately, no, this was needed for the fix. currently at least we have to rely on smoke tests to catch shading-related problems. probably we should create a whole smoke test around instrumentation OpenTelemetry API, since that instrumentation is shading-fragile. i will open issue........ (a couple min later) oh ya, i have an issue already for that: #298 \ud83d\ude04", "author": "trask", "createdAt": "2020-08-09T04:56:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUzNTcwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUzNTczNA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/929#discussion_r467535734", "bodyText": "Good change", "author": "anuraaga", "createdAt": "2020-08-09T04:46:03Z", "path": "smoke-tests/springboot/src/main/java/io/opentelemetry/smoketest/springboot/controller/WebController.java", "diffHunk": "@@ -16,13 +16,19 @@\n \n package io.opentelemetry.smoketest.springboot.controller;\n \n+import io.opentelemetry.extensions.auto.annotations.WithSpan;\n import org.springframework.web.bind.annotation.RequestMapping;\n import org.springframework.web.bind.annotation.RestController;\n \n @RestController\n public class WebController {\n   @RequestMapping(\"/greeting\")\n   public String greeting() {\n-    return \"Sup Dawg\";", "originalCommit": "e42534c44a9f9bcbf7a3d629112b8aa6ac4f848d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "af0f3f54165939820215da48852ed8bd220cc2ce", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/af0f3f54165939820215da48852ed8bd220cc2ce", "message": "Merge remote-tracking branch 'upstream/master' into fix-with-span", "committedDate": "2020-08-09T18:18:31Z", "type": "commit"}]}