{"pr_number": 1325, "pr_title": "fix and/or ignore spotbugs errors", "pr_createdAt": "2020-10-05T09:55:45Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTUxNTU5OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325#discussion_r499515599", "bodyText": "We should fix it instead of silencing. The correct way is to pass Callable, as HttpServerTest#controller expects. Which now means just lambda.", "author": "iNikem", "createdAt": "2020-10-05T11:03:22Z", "path": "gradle/spotbugs-exclude.xml", "diffHunk": "@@ -0,0 +1,52 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<FindBugsFilter>\n+  <Match>\n+    <Class name=\"io.opentelemetry.instrumentation.auto.jdbc.normalizer.SimpleCharStream\"/>\n+    <Not>\n+      <Bug code=\"DM_DEFAULT_ENCODING\"/> <!-- ignore default encoding for auto-genned class -->\n+    </Not>\n+  </Match>\n+\n+  <Match>\n+    <Class name=\"io.opentelemetry.auto.util.gc.GCUtils\"/>\n+    <Not>\n+      <Bug code=\"DM_GC\"/> <!-- forced GC only used in testing -->\n+    </Not>\n+  </Match>\n+\n+  <Match>\n+    <Class name=\"~muzzle\\.TestClasses.*\"/>\n+    <Not>\n+      <Bug code=\"MS_SHOULD_BE_FINAL\"/> <!-- final field warnings can be ignored for this test class -->\n+    </Not>\n+  </Match>\n+\n+  <Match>\n+    <Class name=\"~HttpServletResponseTest\\$.*\"/>\n+    <Not>\n+      <Bug code=\"SE_INNER_CLASS\"/> <!-- inner class serialization warning can be ignored for testing purposes -->\n+    </Not>\n+  </Match>\n+\n+  <Match>\n+    <Class name=\"~HttpServletTest\\$.*\"/>\n+    <Not>\n+      <Bug code=\"SE_INNER_CLASS\"/> <!-- inner class serialization warning can be ignored for testing purposes -->\n+    </Not>\n+  </Match>\n+\n+  <Match>\n+    <Class name=\"~SpymemcachedTest\\$.*\"/>\n+    <Not>\n+      <Bug code=\"SE_INNER_CLASS\"/> <!-- inner class serialization warning can be ignored for testing purposes -->\n+    </Not>\n+  </Match>\n+\n+  <Match>\n+    <Class name=\"~TestServlets.*\"/>", "originalCommit": "0b5af13c8e0b01f03bd93a2c7a3cb5f45936317f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTUxNjYxMA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325#discussion_r499516610", "bodyText": "Can we instead ignore this rule? I think @trask will object, but why static final variable MUST be in uppercase?", "author": "iNikem", "createdAt": "2020-10-05T11:05:25Z", "path": "smoke-tests/src/test/groovy/io/opentelemetry/smoketest/SmokeTest.groovy", "diffHunk": "@@ -46,7 +46,7 @@ abstract class SmokeTest extends Specification {\n \n   private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper()\n \n-  protected static OkHttpClient client = OkHttpUtils.client()\n+  protected static final OkHttpClient CLIENT = OkHttpUtils.client()", "originalCommit": "0b5af13c8e0b01f03bd93a2c7a3cb5f45936317f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTUyODc2MA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325#discussion_r499528760", "bodyText": "spotBugs actually doesn't complain about the uppercase, just the missing final declaration. As for the uppercase, I believe it's  a JLS convention for constants, but given the naming exception done for loggers, I don't see why it cannot be the same here - just possibly, have to look out for other static analysis checkers complaining about it ;)", "author": "imavroukakis", "createdAt": "2020-10-05T11:28:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTUxNjYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU2OTg0Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325#discussion_r499569846", "bodyText": "I don't think JLS has any naming conventions. Has it?", "author": "iNikem", "createdAt": "2020-10-05T12:44:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTUxNjYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwMjE2MA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325#discussion_r499602160", "bodyText": "https://docs.oracle.com/javase/specs/jls/se11/html/jls-6.html look for \"Constant Names\" section.\nEmphasis, mine.\n\nThe names of constants in interface types should be, and final variables of class types may conventionally be, a sequence of one or more words, acronyms, or abbreviations, all uppercase\n\nThe capitalisation could have been a misrepresentation though, and the intent may have been to use them for primitives, but it somehow stuck for everything", "author": "imavroukakis", "createdAt": "2020-10-05T13:34:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTUxNjYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc5Mjg3NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325#discussion_r499792875", "bodyText": "Can we instead ignore this rule? I think @trask will object, but why static final variable MUST be in uppercase?\n\nI do not object \ud83d\ude02\nstatic final variables should only be uppercase if they are constants, see https://google.github.io/styleguide/javaguide.html#s5.2.4-constant-names for \"what is a constant\"", "author": "trask", "createdAt": "2020-10-05T18:32:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTUxNjYxMA=="}], "type": "inlineReview"}, {"oid": "32e229aaf08dd6fedcb96be1d2fa2184e6bb4b35", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/32e229aaf08dd6fedcb96be1d2fa2184e6bb4b35", "message": "fix and/or ignore spotbugs errors", "committedDate": "2020-10-05T11:50:10Z", "type": "commit"}, {"oid": "a346dd09a930cce5d135ac53aaf8186d5346d2b8", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a346dd09a930cce5d135ac53aaf8186d5346d2b8", "message": "fix GrpcHelper and TestServlets warning\n\n* GrpcHelper: methodName should not be set in the span if null\n* GrpcHelper: fix warnings instead of hiding by using Callable", "committedDate": "2020-10-05T11:50:11Z", "type": "commit"}, {"oid": "bd9cf5de1c7bedf24d2f63a19193e1b1b4ddd62d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/bd9cf5de1c7bedf24d2f63a19193e1b1b4ddd62d", "message": "lowercase client", "committedDate": "2020-10-05T11:50:11Z", "type": "commit"}, {"oid": "bd9cf5de1c7bedf24d2f63a19193e1b1b4ddd62d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/bd9cf5de1c7bedf24d2f63a19193e1b1b4ddd62d", "message": "lowercase client", "committedDate": "2020-10-05T11:50:11Z", "type": "forcePushed"}, {"oid": "63f6dcd910d5fced43220c701291e9dc2e0de050", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/63f6dcd910d5fced43220c701291e9dc2e0de050", "message": "renames agent ConfigBuilder", "committedDate": "2020-10-05T15:03:37Z", "type": "commit"}, {"oid": "3b439de4416bac1b7aaa74b77813f311e09c58b4", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/3b439de4416bac1b7aaa74b77813f311e09c58b4", "message": "fix incorrect patterns", "committedDate": "2020-10-05T15:04:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0NDM2OA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325#discussion_r499744368", "bodyText": "Really minor: you can now import ConfigBuilder", "author": "mateuszrzeszutek", "createdAt": "2020-10-05T17:02:21Z", "path": "javaagent-tooling/src/main/java/io/opentelemetry/javaagent/tooling/config/AgentConfigBuilder.java", "diffHunk": "@@ -12,12 +12,12 @@\n import java.util.Map;\n import java.util.Properties;\n \n-public final class ConfigBuilder\n-    extends io.opentelemetry.sdk.common.export.ConfigBuilder<ConfigBuilder> {\n+public final class AgentConfigBuilder\n+    extends io.opentelemetry.sdk.common.export.ConfigBuilder<AgentConfigBuilder> {", "originalCommit": "3b439de4416bac1b7aaa74b77813f311e09c58b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4OTcxNg==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/1325#discussion_r499789716", "bodyText": "good point, let's keep it clean.", "author": "imavroukakis", "createdAt": "2020-10-05T18:26:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0NDM2OA=="}], "type": "inlineReview"}, {"oid": "336e449cea6b182ac46e54a8b5958ecd44edc07e", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/336e449cea6b182ac46e54a8b5958ecd44edc07e", "message": "normalize ConfigBuilder import", "committedDate": "2020-10-05T18:28:50Z", "type": "commit"}, {"oid": "5324166ea992d4c78d1b9e6675e8fbb148b12401", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/5324166ea992d4c78d1b9e6675e8fbb148b12401", "message": "restore Groovy closures to fix build", "committedDate": "2020-10-06T08:28:04Z", "type": "commit"}, {"oid": "8c3bcf6ce13d52fd07cc3df98d80da9e967ae8e7", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/8c3bcf6ce13d52fd07cc3df98d80da9e967ae8e7", "message": "replace groovy closure with Callable", "committedDate": "2020-10-06T09:00:41Z", "type": "commit"}, {"oid": "15425ad2b0a26daaf68c682022d448cb9ab6e6c9", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/15425ad2b0a26daaf68c682022d448cb9ab6e6c9", "message": "codenarc insists on uppercase for psf", "committedDate": "2020-10-06T11:36:05Z", "type": "commit"}, {"oid": "c23d919187573dafedf7c7258cc12716f82de24d", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/c23d919187573dafedf7c7258cc12716f82de24d", "message": "spotless fixes", "committedDate": "2020-10-06T12:23:06Z", "type": "commit"}]}