{"pr_number": 549, "pr_title": "[KOGITO-2074] rework Kogito code generation for scaffolding", "pr_createdAt": "2020-06-08T17:21:35Z", "pr_url": "https://github.com/kiegroup/kogito-runtimes/pull/549", "timeline": [{"oid": "5d9ca9add596bac0dd02b979f6e3b62e1d906e3f", "url": "https://github.com/kiegroup/kogito-runtimes/commit/5d9ca9add596bac0dd02b979f6e3b62e1d906e3f", "message": "[KOGITO-2074] rework Kogito code generation for scaffolding", "committedDate": "2020-06-10T13:45:45Z", "type": "commit"}, {"oid": "29419e8fd5e3f1885512d3784233acabc4c10109", "url": "https://github.com/kiegroup/kogito-runtimes/commit/29419e8fd5e3f1885512d3784233acabc4c10109", "message": "wip", "committedDate": "2020-06-10T13:45:45Z", "type": "commit"}, {"oid": "6b7639489d899086a0a2ce16372f9cc4f58e900f", "url": "https://github.com/kiegroup/kogito-runtimes/commit/6b7639489d899086a0a2ce16372f9cc4f58e900f", "message": "rm prop", "committedDate": "2020-06-10T13:45:45Z", "type": "commit"}, {"oid": "ebe34db62d8340c9483db09cb3502e5cb5e14adc", "url": "https://github.com/kiegroup/kogito-runtimes/commit/ebe34db62d8340c9483db09cb3502e5cb5e14adc", "message": "fix pom", "committedDate": "2020-06-10T13:45:45Z", "type": "commit"}, {"oid": "ebe34db62d8340c9483db09cb3502e5cb5e14adc", "url": "https://github.com/kiegroup/kogito-runtimes/commit/ebe34db62d8340c9483db09cb3502e5cb5e14adc", "message": "fix pom", "committedDate": "2020-06-10T13:45:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM3ODc5OA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438378798", "bodyText": "What is the reason to use invoker here? To run Maven with different properties/goals?\nAlso for springboot integration tests which are already there (done as #515) I don't see different properties, just custom settings.xml, what is it for?", "author": "MarianMacik", "createdAt": "2020-06-10T20:07:15Z", "path": "integration-tests/integration-tests-kogito-plugin/pom.xml", "diffHunk": "@@ -0,0 +1,41 @@\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <modelVersion>4.0.0</modelVersion>\n+  <parent>\n+    <groupId>org.kie.kogito</groupId>\n+    <artifactId>integration-tests</artifactId>\n+    <version>8.0.0-SNAPSHOT</version>\n+  </parent>\n+  <artifactId>integration-tests-kogito-plugin</artifactId>\n+  \n+  <dependencies>\n+  <dependency> <!-- make this IT module to depend on the plugin for Maven reactor build intention -->\n+    <groupId>org.kie.kogito</groupId>\n+    <artifactId>kogito-maven-plugin</artifactId>\n+    <version>${project.version}</version>\n+  </dependency>\n+  </dependencies>\n+  \n+  <build>\n+    <plugins>\n+      <plugin>\n+        <artifactId>maven-invoker-plugin</artifactId>\n+        <configuration>\n+          <streamLogs>true</streamLogs>\n+          <cloneProjectsTo>${project.build.directory}/it</cloneProjectsTo>\n+          <settingsFile>src/it/settings.xml</settingsFile>\n+          <localRepositoryPath>${project.build.directory}/local-repo</localRepositoryPath>\n+          <postBuildHookScript>verify</postBuildHookScript> <!-- no extension required -->", "originalCommit": "ebe34db62d8340c9483db09cb3502e5cb5e14adc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYxNTA0OQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438615049", "bodyText": "What is the reason to use invoker here? To run Maven with different properties/goals?\n\nit's to run the Kogito Maven plug-in in the in-tree version. Otherwise it will download it from nexus, resolving to an older snapshot.\nnot sure about the other questions, @mariofusco ?", "author": "evacchi", "createdAt": "2020-06-11T08:09:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM3ODc5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODc4OTE3Mw==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438789173", "bodyText": "@evacchi Can this be achieved just by leaving the version of the plugin set to <version>${project.version}</version> as we already do? We run it with disabled snapshot updates so I presume it would use the snapshot which was just built anyway as with other artifacts, or not?", "author": "MarianMacik", "createdAt": "2020-06-11T13:38:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM3ODc5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM4MzkyMA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438383920", "bodyText": "Where is this property specified?", "author": "MarianMacik", "createdAt": "2020-06-10T20:17:52Z", "path": "integration-tests/integration-tests-kogito-plugin/src/it/settings.xml", "diffHunk": "@@ -0,0 +1,37 @@\n+<settings xmlns=\"http://maven.apache.org/SETTINGS/1.0.0\"\n+  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+  xsi:schemaLocation=\"http://maven.apache.org/SETTINGS/1.0.0\n+                      https://maven.apache.org/xsd/settings-1.0.0.xsd\">\n+    <profiles>\n+        <profile>\n+        <id>it-repo</id>\n+        <activation>\n+            <activeByDefault>true</activeByDefault>\n+        </activation>\n+        <repositories>\n+            <repository>\n+            <id>local.central</id>\n+            <url>@localRepositoryUrl@</url>", "originalCommit": "ebe34db62d8340c9483db09cb3502e5cb5e14adc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU5MDI5MQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438590291", "bodyText": "That's just to make maven happy if I remove the property, it fails with\n[INFO] [ERROR] Error executing Maven.\n[INFO] [ERROR] 2 problems were encountered while building the effective settings\n[INFO] [ERROR] 'profiles.profile[it-repo].repositories.repository.url' for local.central is missing @ /home/mfusco/workspace/kogito/kogito-runtimes/integration-tests/integration-tests-kogito-plugin/target/it/interpolated-settings.xml\n[INFO] [ERROR] 'profiles.profile[it-repo].pluginRepositories.pluginRepository.url' for local.central is missing @ /home/mfusco/workspace/kogito/kogito-runtimes/integration-tests/integration-tests-kogito-plugin/target/it/interpolated-settings.xml", "author": "mariofusco", "createdAt": "2020-06-11T07:19:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM4MzkyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYxNDQyMA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438614420", "bodyText": "@MarianMacik this is necessary for invoker to use the local .m2, otherwise it hits Maven Central", "author": "evacchi", "createdAt": "2020-06-11T08:08:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM4MzkyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODc4MDcwNQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438780705", "bodyText": "Thanks.", "author": "MarianMacik", "createdAt": "2020-06-11T13:29:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM4MzkyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM4OTA3NA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438389074", "bodyText": "Shouldn't we call this generatedCustomizableSourcesDir to be in line with GenerateModelMojo?", "author": "MarianMacik", "createdAt": "2020-06-10T20:28:01Z", "path": "kogito-quarkus-extension/deployment/src/main/java/org/kie/kogito/quarkus/deployment/KogitoAssetsProcessor.java", "diffHunk": "@@ -70,9 +70,9 @@\n \n public class KogitoAssetsProcessor {\n \n-    private static final String generatedResourcesDir = System.getProperty(\"kogito.codegen.sources.directory\", \"target/generated-resources/kogito\");\n-    private static final String generatedSourcesDir = System.getProperty(\"kogito.codegen.resources.directory\", \"target/generated-sources/kogito/\");\n-    private static final String generatedRestSourcesDir = System.getProperty(\"kogito.codegen.rest.directory\", \"target/generated-sources/kogito/\");\n+    private static final String generatedResourcesDir = System.getProperty(\"kogito.codegen.resources.directory\", \"target/generated-resources/kogito\");\n+    private static final String generatedSourcesDir = \"target/generated-sources/kogito/\";\n+    private static final String generatedRestSourcesDir = System.getProperty(\"kogito.codegen.sources.directory\", \"target/generated-sources/kogito/\");", "originalCommit": "ebe34db62d8340c9483db09cb3502e5cb5e14adc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM5MDI4OA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/549#discussion_r438390288", "bodyText": "Don't we want to add this as another parameter to GenerateModelMojo?", "author": "MarianMacik", "createdAt": "2020-06-10T20:30:22Z", "path": "kogito-quarkus-extension/deployment/src/main/java/org/kie/kogito/quarkus/deployment/KogitoAssetsProcessor.java", "diffHunk": "@@ -70,9 +70,9 @@\n \n public class KogitoAssetsProcessor {\n \n-    private static final String generatedResourcesDir = System.getProperty(\"kogito.codegen.sources.directory\", \"target/generated-resources/kogito\");\n-    private static final String generatedSourcesDir = System.getProperty(\"kogito.codegen.resources.directory\", \"target/generated-sources/kogito/\");\n-    private static final String generatedRestSourcesDir = System.getProperty(\"kogito.codegen.rest.directory\", \"target/generated-sources/kogito/\");\n+    private static final String generatedResourcesDir = System.getProperty(\"kogito.codegen.resources.directory\", \"target/generated-resources/kogito\");", "originalCommit": "ebe34db62d8340c9483db09cb3502e5cb5e14adc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a19125f6814ace805401bc60ae70396d92c650c7", "url": "https://github.com/kiegroup/kogito-runtimes/commit/a19125f6814ace805401bc60ae70396d92c650c7", "message": "[KOGITO-2074] prevent jacoco inspection on generated Application class", "committedDate": "2020-06-11T07:23:05Z", "type": "commit"}, {"oid": "015eae7f737177df3fdbfef2e4f0778a9ec79f93", "url": "https://github.com/kiegroup/kogito-runtimes/commit/015eae7f737177df3fdbfef2e4f0778a9ec79f93", "message": "[KOGITO-2074] prevent jacoco inspection on generated Application class", "committedDate": "2020-06-11T08:27:57Z", "type": "commit"}]}