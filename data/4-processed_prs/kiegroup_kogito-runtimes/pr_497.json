{"pr_number": 497, "pr_title": "KOGITO-2136 Add integration tests to archetypes", "pr_createdAt": "2020-05-08T14:39:02Z", "pr_url": "https://github.com/kiegroup/kogito-runtimes/pull/497", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjc4NDQ4Mg==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r422784482", "bodyText": "@evacchi this will be removed once #493 is merged and also would suggest doing the upgrade on a separated PR?", "author": "cristianonicolai", "createdAt": "2020-05-11T05:13:00Z", "path": "archetypes/kogito-quarkus-archetype/pom.xml", "diffHunk": "@@ -17,11 +17,12 @@\n \n   <properties>\n     <!-- override for archetype: remove when kogito-apps are upgraded -->", "originalCommit": "8aeff17d20d6287330ac15d0f10bdd37f117a1e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg2MDQxNw==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r422860417", "bodyText": "+1 to have upgrade to 1.4.2.Final in another PR", "author": "radtriste", "createdAt": "2020-05-11T08:10:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjc4NDQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzAyODY5OA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r423028698", "bodyText": "@cristianonicolai sure just wanted to make sure it worked, i'll revert that", "author": "evacchi", "createdAt": "2020-05-11T13:13:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjc4NDQ4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjkxNzg1OQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r422917859", "bodyText": "can you link to quarkus issue explaining the workaround in comments ?\nquarkusio/quarkus#9162", "author": "radtriste", "createdAt": "2020-05-11T09:45:38Z", "path": "archetypes/kogito-quarkus-archetype/pom.xml", "diffHunk": "@@ -17,11 +17,12 @@\n \n   <properties>\n     <!-- override for archetype: remove when kogito-apps are upgraded -->\n-    <version.io.quarkus>1.4.1.Final</version.io.quarkus>\n+    <version.io.quarkus>1.4.2.Final</version.io.quarkus>\n   </properties>\n \n   <build>\n-\n+    <!-- default directory (test-classes) confuses @QuarkusTest -->", "originalCommit": "8aeff17d20d6287330ac15d0f10bdd37f117a1e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzAyOTAwNg==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r423029006", "bodyText": "good point, sure will do", "author": "evacchi", "createdAt": "2020-05-11T13:13:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjkxNzg1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg5MDE3NQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r423890175", "bodyText": "Please also include src/test/resources.", "author": "MarianMacik", "createdAt": "2020-05-12T16:58:20Z", "path": "archetypes/kogito-quarkus-archetype/src/main/resources/META-INF/maven/archetype-metadata.xml", "diffHunk": "@@ -33,6 +33,10 @@ under the License.\n     <fileSet filtered=\"true\" packaged=\"true\">\n       <directory>src/main/java</directory>\n     </fileSet>\n+    <fileSet filtered=\"true\" packaged=\"true\">\n+      <directory>src/test/java</directory>\n+    </fileSet>\n+", "originalCommit": "6c161db16ed1c922341ba77c13824e18822f34a4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDI2MDA2Nw==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r424260067", "bodyText": "that's unnecessary because there is no in src/main/resources/archetype-resources/src/test (this is the config of the archetype)", "author": "evacchi", "createdAt": "2020-05-13T08:23:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg5MDE3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg5NTk4OQ==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r423895989", "bodyText": "I played with it a little bit and it seems that unless you specify statusCode(200), it will keep passing as for example Quarkus will return 404 and HTML body when I change the endpoint or delete a bpmn. When I change the matcher to nullValue() then it is complaining that id contains Resource not found but expected is null, which is weird as id is not even on the page. I will probably file an issue for that.", "author": "MarianMacik", "createdAt": "2020-05-12T17:07:41Z", "path": "archetypes/kogito-quarkus-archetype/src/main/resources/archetype-resources/src/test/java/GreetingsTest.java", "diffHunk": "@@ -0,0 +1,27 @@\n+package ${package};\n+\n+import io.quarkus.test.junit.QuarkusTest;\n+import io.restassured.http.ContentType;\n+import org.junit.jupiter.api.Test;\n+\n+import java.util.UUID;\n+\n+import static io.restassured.RestAssured.given;\n+import static org.hamcrest.CoreMatchers.*;\n+\n+@QuarkusTest\n+public class GreetingsTest {\n+\n+    @Test\n+    public void testHelloEndpoint() {\n+        given()\n+            .contentType(ContentType.JSON)\n+            .accept(ContentType.JSON)\n+            .body(\"{}\")\n+        .when()\n+            .post(\"/greetings\")\n+        .then()\n+            .body(\"id\", notNullValue());    ", "originalCommit": "6c161db16ed1c922341ba77c13824e18822f34a4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzg5NjQ3OA==", "url": "https://github.com/kiegroup/kogito-runtimes/pull/497#discussion_r423896478", "bodyText": "Same here, we can also include src/test/resources.", "author": "MarianMacik", "createdAt": "2020-05-12T17:08:31Z", "path": "archetypes/kogito-springboot-archetype/src/main/resources/META-INF/maven/archetype-metadata.xml", "diffHunk": "@@ -33,6 +33,9 @@ under the License.\n     <fileSet filtered=\"true\" packaged=\"true\">\n       <directory>src/main/java</directory>\n     </fileSet>\n+    <fileSet filtered=\"true\" packaged=\"true\">\n+      <directory>src/test/java</directory>\n+    </fileSet>", "originalCommit": "6c161db16ed1c922341ba77c13824e18822f34a4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ab59a0c55a15ae9d3aaa2ea2aac9e435644be290", "url": "https://github.com/kiegroup/kogito-runtimes/commit/ab59a0c55a15ae9d3aaa2ea2aac9e435644be290", "message": "example IT test", "committedDate": "2020-05-13T09:40:22Z", "type": "commit"}, {"oid": "3a36a485cb9d0ec4c478d1b8121f739da20f2adf", "url": "https://github.com/kiegroup/kogito-runtimes/commit/3a36a485cb9d0ec4c478d1b8121f739da20f2adf", "message": "add tests", "committedDate": "2020-05-13T09:41:37Z", "type": "commit"}, {"oid": "d45b08dca0565e622a1ae6f3b2d385006a735e66", "url": "https://github.com/kiegroup/kogito-runtimes/commit/d45b08dca0565e622a1ae6f3b2d385006a735e66", "message": "springboot", "committedDate": "2020-05-13T09:41:46Z", "type": "commit"}, {"oid": "6a18ffec08a0c7278b539d03b7637c50c1ce3ead", "url": "https://github.com/kiegroup/kogito-runtimes/commit/6a18ffec08a0c7278b539d03b7637c50c1ce3ead", "message": "fix annotation", "committedDate": "2020-05-13T09:41:46Z", "type": "commit"}, {"oid": "75afd18633689b4d55da5c19d07d49525c769e4c", "url": "https://github.com/kiegroup/kogito-runtimes/commit/75afd18633689b4d55da5c19d07d49525c769e4c", "message": "add rest assured for spring", "committedDate": "2020-05-13T09:41:46Z", "type": "commit"}, {"oid": "5f63a8292fb1698ec782bab93753780b00555df8", "url": "https://github.com/kiegroup/kogito-runtimes/commit/5f63a8292fb1698ec782bab93753780b00555df8", "message": "comments", "committedDate": "2020-05-13T09:42:20Z", "type": "commit"}, {"oid": "5a4236a20e0f9813fc4242d00d81902d7ff12d74", "url": "https://github.com/kiegroup/kogito-runtimes/commit/5a4236a20e0f9813fc4242d00d81902d7ff12d74", "message": "fix tests", "committedDate": "2020-05-13T09:42:24Z", "type": "commit"}, {"oid": "e8ccb0be6a8d7b6b4687c2f65bc31f4400efee0b", "url": "https://github.com/kiegroup/kogito-runtimes/commit/e8ccb0be6a8d7b6b4687c2f65bc31f4400efee0b", "message": "create test/resources", "committedDate": "2020-05-13T09:42:24Z", "type": "commit"}, {"oid": "e8ccb0be6a8d7b6b4687c2f65bc31f4400efee0b", "url": "https://github.com/kiegroup/kogito-runtimes/commit/e8ccb0be6a8d7b6b4687c2f65bc31f4400efee0b", "message": "create test/resources", "committedDate": "2020-05-13T09:42:24Z", "type": "forcePushed"}]}