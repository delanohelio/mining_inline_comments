{"pr_number": 787, "pr_title": "Document dynamic topic names", "pr_createdAt": "2020-10-02T14:37:46Z", "pr_url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/787", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk0Mzk5MA==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/787#discussion_r498943990", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Sometimes it is desirable to dynamically select the destination of a message, in this case you should not configure the name of the topic inside your application configuration file,\n          \n          \n            \n            Sometimes it is desirable to select the destination of a message dynamically.\n          \n          \n            \n            In this case, you should not configure the address inside your application configuration file, but instead, use the outbound metadata to set the address.```", "author": "cescoffier", "createdAt": "2020-10-02T17:06:51Z", "path": "documentation/src/main/doc/modules/amqp/pages/outbound.adoc", "diffHunk": "@@ -65,7 +65,19 @@ For example, you can configure the address, subjects, properties:\n include::example$outbound/AmqpOutboundMetadataExample.java[tag=code]\n ----\n \n-NOTE: To be able to override the address per message, the connector is using an _anonymous sender_.\n+=== Dynamic topic names\n+\n+Sometimes it is desirable to dynamically select the destination of a message, in this case you should not configure the name of the topic inside your application configuration file,", "originalCommit": "d96dd846593ebbca076f8c6a54f93150317c8d24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk0NDIxNA==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/787#discussion_r498944214", "bodyText": "To be removed, part of my suggestion above.", "author": "cescoffier", "createdAt": "2020-10-02T17:07:19Z", "path": "documentation/src/main/doc/modules/amqp/pages/outbound.adoc", "diffHunk": "@@ -65,7 +65,19 @@ For example, you can configure the address, subjects, properties:\n include::example$outbound/AmqpOutboundMetadataExample.java[tag=code]\n ----\n \n-NOTE: To be able to override the address per message, the connector is using an _anonymous sender_.\n+=== Dynamic topic names\n+\n+Sometimes it is desirable to dynamically select the destination of a message, in this case you should not configure the name of the topic inside your application configuration file,\n+but instead use the outbound metadata to set the name of the topic.", "originalCommit": "d96dd846593ebbca076f8c6a54f93150317c8d24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk0NDUwNg==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/787#discussion_r498944506", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            For example, you can route to a dynamic topic based on the incoming message:\n          \n          \n            \n            For example, you can send to a dynamic address based on the incoming message:", "author": "cescoffier", "createdAt": "2020-10-02T17:07:55Z", "path": "documentation/src/main/doc/modules/amqp/pages/outbound.adoc", "diffHunk": "@@ -65,7 +65,19 @@ For example, you can configure the address, subjects, properties:\n include::example$outbound/AmqpOutboundMetadataExample.java[tag=code]\n ----\n \n-NOTE: To be able to override the address per message, the connector is using an _anonymous sender_.\n+=== Dynamic topic names\n+\n+Sometimes it is desirable to dynamically select the destination of a message, in this case you should not configure the name of the topic inside your application configuration file,\n+but instead use the outbound metadata to set the name of the topic.\n+\n+For example, you can route to a dynamic topic based on the incoming message:", "originalCommit": "d96dd846593ebbca076f8c6a54f93150317c8d24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk0NDcwOQ==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/787#discussion_r498944709", "bodyText": "don't use topic for AMQP. Use address instead.", "author": "cescoffier", "createdAt": "2020-10-02T17:08:23Z", "path": "documentation/src/main/doc/modules/amqp/examples/outbound/AmqpOutboundDynamicTopicExample.java", "diffHunk": "@@ -0,0 +1,25 @@\n+package outbound;\n+\n+import io.smallrye.reactive.messaging.amqp.OutgoingAmqpMetadata;\n+import org.eclipse.microprofile.reactive.messaging.Message;\n+\n+public class AmqpOutboundDynamicTopicExample {\n+    public Message<Double> metadata(Message<Double> incoming) {\n+\n+        // tag::code[]\n+        String topicName = selectTopicFromIncommingMessage(incoming);\n+        OutgoingAmqpMetadata metadata = OutgoingAmqpMetadata.builder()\n+            .withAddress(topicName)", "originalCommit": "d96dd846593ebbca076f8c6a54f93150317c8d24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk0NTQxOA==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/787#discussion_r498945418", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Sometimes it is desirable to dynamically select the destination of a message, in this case you should not configure the name of the topic inside your application configuration file,\n          \n          \n            \n            Sometimes it is desirable to select the destination of a message dynamically. In this case, you should not configure the topic inside your application configuration file, but instead, use the outbound metadata to set the name of the topic.```", "author": "cescoffier", "createdAt": "2020-10-02T17:09:47Z", "path": "documentation/src/main/doc/modules/kafka/pages/outbound.adoc", "diffHunk": "@@ -79,6 +79,19 @@ For example, you can configure the topic directly in the message, or add Kafka h\n include::example$outbound/KafkaOutboundMetadataExample.java[tag=code]\n ----\n \n+=== Dynamic topic names\n+\n+Sometimes it is desirable to dynamically select the destination of a message, in this case you should not configure the name of the topic inside your application configuration file,", "originalCommit": "d96dd846593ebbca076f8c6a54f93150317c8d24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk0NTUzNQ==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/787#discussion_r498945535", "bodyText": "to be removed, part of my suggestion above.", "author": "cescoffier", "createdAt": "2020-10-02T17:09:59Z", "path": "documentation/src/main/doc/modules/kafka/pages/outbound.adoc", "diffHunk": "@@ -79,6 +79,19 @@ For example, you can configure the topic directly in the message, or add Kafka h\n include::example$outbound/KafkaOutboundMetadataExample.java[tag=code]\n ----\n \n+=== Dynamic topic names\n+\n+Sometimes it is desirable to dynamically select the destination of a message, in this case you should not configure the name of the topic inside your application configuration file,\n+but instead use the outbound metadata to set the name of the topic.", "originalCommit": "d96dd846593ebbca076f8c6a54f93150317c8d24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk0NTc2NQ==", "url": "https://github.com/smallrye/smallrye-reactive-messaging/pull/787#discussion_r498945765", "bodyText": "Hum... there is no such a thing in the Kafka world :-) ... yet", "author": "cescoffier", "createdAt": "2020-10-02T17:10:29Z", "path": "documentation/src/main/doc/modules/kafka/pages/outbound.adoc", "diffHunk": "@@ -79,6 +79,19 @@ For example, you can configure the topic directly in the message, or add Kafka h\n include::example$outbound/KafkaOutboundMetadataExample.java[tag=code]\n ----\n \n+=== Dynamic topic names\n+\n+Sometimes it is desirable to dynamically select the destination of a message, in this case you should not configure the name of the topic inside your application configuration file,\n+but instead use the outbound metadata to set the name of the topic.\n+\n+For example, you can route to a dynamic topic based on the incoming message:\n+\n+[source, java]\n+----\n+include::example$outbound/AmqpOutboundDynamicTopicExample.java[tag=code]\n+----\n+\n+NOTE: To be able to set the address per message, the connector is using an _anonymous sender_.", "originalCommit": "d96dd846593ebbca076f8c6a54f93150317c8d24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "15effe831c3abd728fcc9d82d9ab5a2840267f2a", "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/15effe831c3abd728fcc9d82d9ab5a2840267f2a", "message": "Document AMQP dynamic topic names", "committedDate": "2020-10-05T07:22:47Z", "type": "forcePushed"}, {"oid": "2e7b71ea14676bbadcd94c94a7fc855a6775737c", "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/2e7b71ea14676bbadcd94c94a7fc855a6775737c", "message": "Document Kafka dynamic topic names", "committedDate": "2020-10-05T08:41:35Z", "type": "commit"}, {"oid": "16ac22c120b14831a39aa6d658dbec85f666c1db", "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/16ac22c120b14831a39aa6d658dbec85f666c1db", "message": "Document AMQP dynamic topic names", "committedDate": "2020-10-05T08:41:35Z", "type": "commit"}, {"oid": "16ac22c120b14831a39aa6d658dbec85f666c1db", "url": "https://github.com/smallrye/smallrye-reactive-messaging/commit/16ac22c120b14831a39aa6d658dbec85f666c1db", "message": "Document AMQP dynamic topic names", "committedDate": "2020-10-05T08:41:35Z", "type": "forcePushed"}]}