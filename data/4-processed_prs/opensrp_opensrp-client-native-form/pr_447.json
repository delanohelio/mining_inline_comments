{"pr_number": 447, "pr_title": "Testing Tuesday", "pr_createdAt": "2020-07-07T09:04:05Z", "pr_url": "https://github.com/opensrp/opensrp-client-native-form/pull/447", "timeline": [{"oid": "ba4e5c4f07afdcbd6d5f761391466c34482b551d", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/ba4e5c4f07afdcbd6d5f761391466c34482b551d", "message": ":heavy_check_mark: update tests", "committedDate": "2020-07-07T09:01:24Z", "type": "commit"}, {"oid": "ec517c7f0fe50e89c26df27f19349adb09820961", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/ec517c7f0fe50e89c26df27f19349adb09820961", "message": "Merge branch 'master' of github.com:OpenSRP/opensrp-client-native-form into feature/testing_tuesday", "committedDate": "2020-07-07T09:04:52Z", "type": "commit"}, {"oid": "9b79d278f83268b7350434ddc21c4b2d2f25021f", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/9b79d278f83268b7350434ddc21c4b2d2f25021f", "message": ":heavy_check_mark: add basic rdt tests", "committedDate": "2020-07-07T09:28:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc0MzEwNg==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/447#discussion_r450743106", "bodyText": "Are these necessary?", "author": "bennsimon", "createdAt": "2020-07-07T09:47:53Z", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/BasicRDTCaptureFactoryTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package com.vijay.jsonwizard.widgets;\n+\n+import android.view.View;\n+\n+import com.vijay.jsonwizard.BaseTest;\n+import com.vijay.jsonwizard.activities.JsonFormActivity;\n+import com.vijay.jsonwizard.fragments.JsonFormFragment;\n+import com.vijay.jsonwizard.interfaces.CommonListener;\n+\n+import org.json.JSONObject;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.Mock;\n+import org.mockito.Mockito;\n+import org.mockito.MockitoAnnotations;\n+\n+import java.util.List;\n+import java.util.Set;\n+\n+public class BasicRDTCaptureFactoryTest extends BaseTest {\n+    private BasicRDTCaptureFactory factory;\n+    @Mock\n+    private JsonFormActivity context;\n+    @Mock\n+    private JsonFormFragment formFragment;\n+    @Mock\n+    private CommonListener listener;\n+    @Mock\n+    private View rootLayout;\n+\n+    @Before\n+    public void setUp() {\n+        MockitoAnnotations.initMocks(this);\n+        factory = new BasicRDTCaptureFactory();\n+    }\n+\n+    @Test\n+    public void testRDTCaptureFactoryInstantiatesViewsCorrectly() throws Exception {\n+        String rdtCaptureString = \"{\\\"key\\\":\\\"rdt_capture\\\",\\\"openmrs_entity_parent\\\":\\\"\\\",\\\"openmrs_entity\\\":\\\"\\\",\\\"openmrs_entity_id\\\":\\\"\\\",\\\"type\\\":\\\"rdt_capture\\\",\\\"calculation\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-calculation-rules.yml\\\"}}},\\\"relevance\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-relevance-rules.yml\\\"}}},\\\"constraints\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-constraints-rules.yml\\\"}}}}\";\n+        JSONObject rdtCapture = new JSONObject(rdtCaptureString);\n+        Assert.assertNotNull(rdtCapture);\n+\n+        Assert.assertNotNull(factory);", "originalCommit": "9b79d278f83268b7350434ddc21c4b2d2f25021f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc0MzQyNQ==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/447#discussion_r450743425", "bodyText": "Is this necessary", "author": "bennsimon", "createdAt": "2020-07-07T09:48:27Z", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/BasicRDTCaptureFactoryTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package com.vijay.jsonwizard.widgets;\n+\n+import android.view.View;\n+\n+import com.vijay.jsonwizard.BaseTest;\n+import com.vijay.jsonwizard.activities.JsonFormActivity;\n+import com.vijay.jsonwizard.fragments.JsonFormFragment;\n+import com.vijay.jsonwizard.interfaces.CommonListener;\n+\n+import org.json.JSONObject;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.Mock;\n+import org.mockito.Mockito;\n+import org.mockito.MockitoAnnotations;\n+\n+import java.util.List;\n+import java.util.Set;\n+\n+public class BasicRDTCaptureFactoryTest extends BaseTest {\n+    private BasicRDTCaptureFactory factory;\n+    @Mock\n+    private JsonFormActivity context;\n+    @Mock\n+    private JsonFormFragment formFragment;\n+    @Mock\n+    private CommonListener listener;\n+    @Mock\n+    private View rootLayout;\n+\n+    @Before\n+    public void setUp() {\n+        MockitoAnnotations.initMocks(this);\n+        factory = new BasicRDTCaptureFactory();\n+    }\n+\n+    @Test\n+    public void testRDTCaptureFactoryInstantiatesViewsCorrectly() throws Exception {\n+        String rdtCaptureString = \"{\\\"key\\\":\\\"rdt_capture\\\",\\\"openmrs_entity_parent\\\":\\\"\\\",\\\"openmrs_entity\\\":\\\"\\\",\\\"openmrs_entity_id\\\":\\\"\\\",\\\"type\\\":\\\"rdt_capture\\\",\\\"calculation\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-calculation-rules.yml\\\"}}},\\\"relevance\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-relevance-rules.yml\\\"}}},\\\"constraints\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-constraints-rules.yml\\\"}}}}\";\n+        JSONObject rdtCapture = new JSONObject(rdtCaptureString);\n+        Assert.assertNotNull(rdtCapture);\n+\n+        Assert.assertNotNull(factory);\n+        BasicRDTCaptureFactory factorySpy = Mockito.spy(factory);\n+        Assert.assertNotNull(factorySpy);\n+\n+        Mockito.doReturn(rootLayout).when(factorySpy).getRootLayout(context);\n+        Mockito.doReturn(false).when(factorySpy).isPermissionGiven();\n+\n+        List<View> viewList = factorySpy.getViewsFromJson(\"RandomStepName\", context, formFragment, rdtCapture, listener);\n+        Assert.assertNotNull(viewList);\n+        Assert.assertEquals(viewList.size(), 1);\n+    }\n+\n+    @Test\n+    public void testGetCustomTranslatableWidgetFields() {\n+        Assert.assertNotNull(factory);", "originalCommit": "9b79d278f83268b7350434ddc21c4b2d2f25021f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc0MzY0Mw==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/447#discussion_r450743643", "bodyText": "Are these necessary?", "author": "bennsimon", "createdAt": "2020-07-07T09:48:46Z", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/NumberSelectorFactoryTest.java", "diffHunk": "@@ -1,17 +1,66 @@\n package com.vijay.jsonwizard.widgets;\n \n+import android.content.res.Resources;\n+import android.view.View;\n+import android.widget.LinearLayout;\n+\n import com.vijay.jsonwizard.BaseTest;\n+import com.vijay.jsonwizard.activities.JsonFormActivity;\n+import com.vijay.jsonwizard.fragments.JsonFormFragment;\n+import com.vijay.jsonwizard.interfaces.CommonListener;\n+import com.vijay.jsonwizard.views.CustomTextView;\n \n+import org.json.JSONObject;\n import org.junit.Assert;\n import org.junit.Before;\n import org.junit.Test;\n+import org.mockito.ArgumentMatchers;\n+import org.mockito.Mock;\n import org.mockito.Mockito;\n import org.mockito.MockitoAnnotations;\n \n+import java.util.List;\n+import java.util.Set;\n+\n public class NumberSelectorFactoryTest extends BaseTest {\n+    private NumberSelectorFactory factory;\n+    @Mock\n+    private JsonFormActivity context;\n+    @Mock\n+    private JsonFormFragment formFragment;\n+    @Mock\n+    private CommonListener listener;\n+    @Mock\n+    private LinearLayout rootLayout;\n+    @Mock\n+    private CustomTextView customTextView;\n+    @Mock\n+    private Resources resources;\n+\n     @Before\n     public void setUp() {\n         MockitoAnnotations.initMocks(this);\n+        factory = new NumberSelectorFactory();\n+    }\n+\n+    @Test\n+    public void testNumberSelectorFactoryInstantiatesViewsCorrectly() throws Exception {\n+        String numberSelectorFactoryString = \"{\\\"key\\\":\\\"user_form\\\",\\\"openmrs_entity_parent\\\":\\\"\\\",\\\"openmrs_entity\\\":\\\"\\\",\\\"openmrs_entity_id\\\":\\\"\\\",\\\"type\\\":\\\"numbers_selector\\\",\\\"number_of_selectors\\\":\\\"5\\\",\\\"start_number\\\":\\\"1\\\",\\\"max_value\\\":\\\"15\\\",\\\"text_size\\\":\\\"16px\\\",\\\"text_color\\\":\\\"#000000\\\",\\\"selected_text_color\\\":\\\"#ffffff\\\",\\\"v_required\\\":{\\\"value\\\":true},\\\"calculation\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-calculation-rules.yml\\\"}}},\\\"relevance\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-relevance-rules.yml\\\"}}},\\\"constraints\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-constraints-rules.yml\\\"}}}}\";\n+        JSONObject numberSelectorObject = new JSONObject(numberSelectorFactoryString);\n+        Assert.assertNotNull(numberSelectorFactoryString);\n+\n+        Assert.assertNotNull(factory);", "originalCommit": "9b79d278f83268b7350434ddc21c4b2d2f25021f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc0NDAzMw==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/447#discussion_r450744033", "bodyText": "its supposed to be the other way round", "author": "bennsimon", "createdAt": "2020-07-07T09:49:27Z", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/NumberSelectorFactoryTest.java", "diffHunk": "@@ -1,17 +1,66 @@\n package com.vijay.jsonwizard.widgets;\n \n+import android.content.res.Resources;\n+import android.view.View;\n+import android.widget.LinearLayout;\n+\n import com.vijay.jsonwizard.BaseTest;\n+import com.vijay.jsonwizard.activities.JsonFormActivity;\n+import com.vijay.jsonwizard.fragments.JsonFormFragment;\n+import com.vijay.jsonwizard.interfaces.CommonListener;\n+import com.vijay.jsonwizard.views.CustomTextView;\n \n+import org.json.JSONObject;\n import org.junit.Assert;\n import org.junit.Before;\n import org.junit.Test;\n+import org.mockito.ArgumentMatchers;\n+import org.mockito.Mock;\n import org.mockito.Mockito;\n import org.mockito.MockitoAnnotations;\n \n+import java.util.List;\n+import java.util.Set;\n+\n public class NumberSelectorFactoryTest extends BaseTest {\n+    private NumberSelectorFactory factory;\n+    @Mock\n+    private JsonFormActivity context;\n+    @Mock\n+    private JsonFormFragment formFragment;\n+    @Mock\n+    private CommonListener listener;\n+    @Mock\n+    private LinearLayout rootLayout;\n+    @Mock\n+    private CustomTextView customTextView;\n+    @Mock\n+    private Resources resources;\n+\n     @Before\n     public void setUp() {\n         MockitoAnnotations.initMocks(this);\n+        factory = new NumberSelectorFactory();\n+    }\n+\n+    @Test\n+    public void testNumberSelectorFactoryInstantiatesViewsCorrectly() throws Exception {\n+        String numberSelectorFactoryString = \"{\\\"key\\\":\\\"user_form\\\",\\\"openmrs_entity_parent\\\":\\\"\\\",\\\"openmrs_entity\\\":\\\"\\\",\\\"openmrs_entity_id\\\":\\\"\\\",\\\"type\\\":\\\"numbers_selector\\\",\\\"number_of_selectors\\\":\\\"5\\\",\\\"start_number\\\":\\\"1\\\",\\\"max_value\\\":\\\"15\\\",\\\"text_size\\\":\\\"16px\\\",\\\"text_color\\\":\\\"#000000\\\",\\\"selected_text_color\\\":\\\"#ffffff\\\",\\\"v_required\\\":{\\\"value\\\":true},\\\"calculation\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-calculation-rules.yml\\\"}}},\\\"relevance\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-relevance-rules.yml\\\"}}},\\\"constraints\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-constraints-rules.yml\\\"}}}}\";\n+        JSONObject numberSelectorObject = new JSONObject(numberSelectorFactoryString);\n+        Assert.assertNotNull(numberSelectorFactoryString);\n+\n+        Assert.assertNotNull(factory);\n+        NumberSelectorFactory factorySpy = Mockito.spy(factory);\n+        Assert.assertNotNull(factorySpy);\n+\n+        Mockito.doReturn(rootLayout).when(factorySpy).getRootLayout(context);\n+        Mockito.doReturn(customTextView).when(factorySpy).getCustomTextView(ArgumentMatchers.eq(context), ArgumentMatchers.eq(numberSelectorObject), ArgumentMatchers.anyInt(), ArgumentMatchers.anyInt());\n+        Mockito.doReturn(resources).when(context).getResources();\n+        Mockito.doReturn(\"2\").when(customTextView).getText();\n+\n+        List<View> viewList = factorySpy.getViewsFromJson(\"RandomStepName\", context, formFragment, numberSelectorObject, listener);\n+        Assert.assertNotNull(viewList);\n+        Assert.assertEquals(viewList.size(), 1);", "originalCommit": "9b79d278f83268b7350434ddc21c4b2d2f25021f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc0NDM1Mg==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/447#discussion_r450744352", "bodyText": "its supposed to be the other way round", "author": "bennsimon", "createdAt": "2020-07-07T09:49:55Z", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/BasicRDTCaptureFactoryTest.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package com.vijay.jsonwizard.widgets;\n+\n+import android.view.View;\n+\n+import com.vijay.jsonwizard.BaseTest;\n+import com.vijay.jsonwizard.activities.JsonFormActivity;\n+import com.vijay.jsonwizard.fragments.JsonFormFragment;\n+import com.vijay.jsonwizard.interfaces.CommonListener;\n+\n+import org.json.JSONObject;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.mockito.Mock;\n+import org.mockito.Mockito;\n+import org.mockito.MockitoAnnotations;\n+\n+import java.util.List;\n+import java.util.Set;\n+\n+public class BasicRDTCaptureFactoryTest extends BaseTest {\n+    private BasicRDTCaptureFactory factory;\n+    @Mock\n+    private JsonFormActivity context;\n+    @Mock\n+    private JsonFormFragment formFragment;\n+    @Mock\n+    private CommonListener listener;\n+    @Mock\n+    private View rootLayout;\n+\n+    @Before\n+    public void setUp() {\n+        MockitoAnnotations.initMocks(this);\n+        factory = new BasicRDTCaptureFactory();\n+    }\n+\n+    @Test\n+    public void testRDTCaptureFactoryInstantiatesViewsCorrectly() throws Exception {\n+        String rdtCaptureString = \"{\\\"key\\\":\\\"rdt_capture\\\",\\\"openmrs_entity_parent\\\":\\\"\\\",\\\"openmrs_entity\\\":\\\"\\\",\\\"openmrs_entity_id\\\":\\\"\\\",\\\"type\\\":\\\"rdt_capture\\\",\\\"calculation\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-calculation-rules.yml\\\"}}},\\\"relevance\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-relevance-rules.yml\\\"}}},\\\"constraints\\\":{\\\"rules-engine\\\":{\\\"ex-rules\\\":{\\\"rules-file\\\":\\\"sample-constraints-rules.yml\\\"}}}}\";\n+        JSONObject rdtCapture = new JSONObject(rdtCaptureString);\n+        Assert.assertNotNull(rdtCapture);\n+\n+        Assert.assertNotNull(factory);\n+        BasicRDTCaptureFactory factorySpy = Mockito.spy(factory);\n+        Assert.assertNotNull(factorySpy);\n+\n+        Mockito.doReturn(rootLayout).when(factorySpy).getRootLayout(context);\n+        Mockito.doReturn(false).when(factorySpy).isPermissionGiven();\n+\n+        List<View> viewList = factorySpy.getViewsFromJson(\"RandomStepName\", context, formFragment, rdtCapture, listener);\n+        Assert.assertNotNull(viewList);\n+        Assert.assertEquals(viewList.size(), 1);", "originalCommit": "9b79d278f83268b7350434ddc21c4b2d2f25021f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "df2a25d53e42f0ef817aa70c761890eca515c772", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/df2a25d53e42f0ef817aa70c761890eca515c772", "message": ":ok_hand: code review requests fix", "committedDate": "2020-07-07T11:25:09Z", "type": "commit"}]}