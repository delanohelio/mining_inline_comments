{"pr_number": 1984, "pr_title": "Switch to GitHub Actions", "pr_createdAt": "2020-11-30T17:06:35Z", "pr_url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984", "timeline": [{"oid": "2fa7e306bd1af527151e1138e0f3c8217f2646d8", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/2fa7e306bd1af527151e1138e0f3c8217f2646d8", "message": "Switch to GitHub Actions", "committedDate": "2020-11-30T17:04:20Z", "type": "commit"}, {"oid": "51cd95e4bb93b4f2a8e8bf5c7699e90dc00004df", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/51cd95e4bb93b4f2a8e8bf5c7699e90dc00004df", "message": "Update Badge", "committedDate": "2020-11-30T17:08:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA1MjM4MA==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984#discussion_r534052380", "bodyText": "The idea is to \"deconstruct\" the test.sh script (now deleted) into several steps in ci.yml? Is my undersetanding correct?", "author": "fgalan", "createdAt": "2020-12-02T10:19:29Z", "path": ".github/workflows/ci.yml", "diffHunk": "@@ -0,0 +1,62 @@\n+name: CI\n+'on':\n+  push:\n+    branches:\n+      - master\n+  pull_request:\n+    branches:\n+      - master\n+jobs:\n+  # lint-dockerfile:\n+  #   name: Lint Dockerfile\n+  #   runs-on: ubuntu-latest\n+  #   steps:\n+  #     - name: Git checkout\n+  #       uses: actions/checkout@v2\n+  #     - name: Run Hadolint Dockerfile Linter (Common)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-common\n+  #     - name: Run Hadolint Dockerfile Linter (NGSI)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-ngsi\n+  #     - name: Run Hadolint Dockerfile Linter (NGSI-LD)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-ngsi-ld\n+  #     - name: Run Hadolint Dockerfile Linter (Twitter)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-twitter\n+  \n+  unit-test:\n+    name: Unit Tests\n+    runs-on: ubuntu-latest\n+    steps:", "originalCommit": "51cd95e4bb93b4f2a8e8bf5c7699e90dc00004df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE3MjEzMA==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984#discussion_r534172130", "bodyText": "Yes, the return code from each runstep is the equivalent of each test", "author": "jason-fox", "createdAt": "2020-12-02T13:38:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA1MjM4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDIyNTI3Ng==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984#discussion_r534225276", "bodyText": "Thanks for the clarifications. Side comments provided. NTC regarding this one.", "author": "fgalan", "createdAt": "2020-12-02T14:49:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA1MjM4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA1MzQyNQ==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984#discussion_r534053425", "bodyText": "As in telefonicaid/fiware-sth-comet#550, I'd suggest:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              # lint-dockerfile:\n          \n          \n            \n              # FIXME: hadolint won't work since the docker file has not been updated.\n          \n          \n            \n              # lint-dockerfile:", "author": "fgalan", "createdAt": "2020-12-02T10:20:56Z", "path": ".github/workflows/ci.yml", "diffHunk": "@@ -0,0 +1,62 @@\n+name: CI\n+'on':\n+  push:\n+    branches:\n+      - master\n+  pull_request:\n+    branches:\n+      - master\n+jobs:\n+  # lint-dockerfile:", "originalCommit": "51cd95e4bb93b4f2a8e8bf5c7699e90dc00004df", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA2MDA1NQ==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984#discussion_r534060055", "bodyText": "In a similar line to https://github.com/telefonicaid/perseo-core/pull/167/files#r534058833, Java 9, 10 and 11 should be included here, although in commented form (with the same remark used in travis: FIXME: something in the current build (pom.xml?) precludes Java>8 to work).", "author": "fgalan", "createdAt": "2020-12-02T10:30:35Z", "path": ".github/workflows/ci.yml", "diffHunk": "@@ -0,0 +1,62 @@\n+name: CI\n+'on':\n+  push:\n+    branches:\n+      - master\n+  pull_request:\n+    branches:\n+      - master\n+jobs:\n+  # lint-dockerfile:\n+  #   name: Lint Dockerfile\n+  #   runs-on: ubuntu-latest\n+  #   steps:\n+  #     - name: Git checkout\n+  #       uses: actions/checkout@v2\n+  #     - name: Run Hadolint Dockerfile Linter (Common)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-common\n+  #     - name: Run Hadolint Dockerfile Linter (NGSI)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-ngsi\n+  #     - name: Run Hadolint Dockerfile Linter (NGSI-LD)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-ngsi-ld\n+  #     - name: Run Hadolint Dockerfile Linter (Twitter)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-twitter\n+  \n+  unit-test:\n+    name: Unit Tests\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: Git checkout\n+        uses: actions/checkout@v2\n+      - name: Use Java 8\n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: 8", "originalCommit": "51cd95e4bb93b4f2a8e8bf5c7699e90dc00004df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE3MTIxNQ==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984#discussion_r534171215", "bodyText": "Fixed 616a437", "author": "jason-fox", "createdAt": "2020-12-02T13:36:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA2MDA1NQ=="}], "type": "inlineReview"}, {"oid": "e3650030aa8e56b9a2d428493882c1ff7b07e7dd", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/e3650030aa8e56b9a2d428493882c1ff7b07e7dd", "message": "Update .github/workflows/ci.yml\n\nCo-authored-by: Ferm\u00edn Gal\u00e1n M\u00e1rquez <fgalan@users.noreply.github.com>", "committedDate": "2020-12-02T13:28:04Z", "type": "commit"}, {"oid": "616a437f93e723ec39554fb8c1f1728642ef474c", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/616a437f93e723ec39554fb8c1f1728642ef474c", "message": "Add Java Matrix", "committedDate": "2020-12-02T13:36:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDIyMzI4OA==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984#discussion_r534223288", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n                      # Build and install cygnus-common, this is necessary because it is a dependency for cygnus-ngsi and others\n          \n      \n    \n    \n  \n\n(It comes from old test.sh)", "author": "fgalan", "createdAt": "2020-12-02T14:46:41Z", "path": ".github/workflows/ci.yml", "diffHunk": "@@ -0,0 +1,71 @@\n+name: CI\n+'on':\n+  push:\n+    branches:\n+      - master\n+  pull_request:\n+    branches:\n+      - master\n+jobs:\n+  # FIXME: hadolint won't work since the docker file has not been updated.\n+  # lint-dockerfile:\n+  #   name: Lint Dockerfile\n+  #   runs-on: ubuntu-latest\n+  #   steps:\n+  #     - name: Git checkout\n+  #       uses: actions/checkout@v2\n+  #     - name: Run Hadolint Dockerfile Linter (Common)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-common\n+  #     - name: Run Hadolint Dockerfile Linter (NGSI)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-ngsi\n+  #     - name: Run Hadolint Dockerfile Linter (NGSI-LD)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-ngsi-ld\n+  #     - name: Run Hadolint Dockerfile Linter (Twitter)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-twitter\n+  \n+  unit-test:\n+    name: Unit Tests\n+    runs-on: ubuntu-latest\n+    strategy:\n+      matrix:\n+        java-version:\n+          - 8\n+        # FIXME: something in the current build (pom.xml?) precludes Java>8 to work).\n+        #  - 9\n+        #  - 10\n+        #  - 11\n+    steps:\n+      - name: Git checkout\n+        uses: actions/checkout@v2\n+      - name: 'Use Java ${{ matrix.java-version }}'\n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: '${{ matrix.java-version }}'\n+      - name: 'cygnus-common Unit Tests (Java ${{ matrix.java-version }})'\n+        run: |\n+          cd \"${GITHUB_WORKSPACE}\"/cygnus-common\n+          mvn -q test\n+", "originalCommit": "616a437f93e723ec39554fb8c1f1728642ef474c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDIyNDU2OA==", "url": "https://github.com/telefonicaid/fiware-cygnus/pull/1984#discussion_r534224568", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  - name: 'cygnus-ngsi-ld Unit Tests (Java ${{ matrix.java-version }})'\n          \n          \n            \n                    run: |\n          \n          \n            \n                      cd \"${GITHUB_WORKSPACE}\"/cygnus-ngsi-ld\n          \n          \n            \n                      mvn -q test\n          \n          \n            \n                  - name: 'cygnus-ngsi-ld Unit Tests (Java ${{ matrix.java-version }})'\n          \n          \n            \n                    run: |\n          \n          \n            \n                      cd \"${GITHUB_WORKSPACE}\"/cygnus-ngsi-ld\n          \n          \n            \n                      mvn -q test\n          \n          \n            \n                  # FIXME: placeholder for future cygnus-twitter tests    \n          \n          \n            \n                  #- name: 'cygnus-twitter Unit Tests (Java ${{ matrix.java-version }})'\n          \n          \n            \n                  #  run: |\n          \n          \n            \n                  #    cd \"${GITHUB_WORKSPACE}\"/cygnus-twitter\n          \n          \n            \n                  #    mvn -q test", "author": "fgalan", "createdAt": "2020-12-02T14:48:21Z", "path": ".github/workflows/ci.yml", "diffHunk": "@@ -0,0 +1,71 @@\n+name: CI\n+'on':\n+  push:\n+    branches:\n+      - master\n+  pull_request:\n+    branches:\n+      - master\n+jobs:\n+  # FIXME: hadolint won't work since the docker file has not been updated.\n+  # lint-dockerfile:\n+  #   name: Lint Dockerfile\n+  #   runs-on: ubuntu-latest\n+  #   steps:\n+  #     - name: Git checkout\n+  #       uses: actions/checkout@v2\n+  #     - name: Run Hadolint Dockerfile Linter (Common)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-common\n+  #     - name: Run Hadolint Dockerfile Linter (NGSI)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-ngsi\n+  #     - name: Run Hadolint Dockerfile Linter (NGSI-LD)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-ngsi-ld\n+  #     - name: Run Hadolint Dockerfile Linter (Twitter)\n+  #       uses: burdzwastaken/hadolint-action@master\n+  #       env:\n+  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+  #         HADOLINT_ACTION_DOCKERFILE_FOLDER: docker/cygnus-twitter\n+  \n+  unit-test:\n+    name: Unit Tests\n+    runs-on: ubuntu-latest\n+    strategy:\n+      matrix:\n+        java-version:\n+          - 8\n+        # FIXME: something in the current build (pom.xml?) precludes Java>8 to work).\n+        #  - 9\n+        #  - 10\n+        #  - 11\n+    steps:\n+      - name: Git checkout\n+        uses: actions/checkout@v2\n+      - name: 'Use Java ${{ matrix.java-version }}'\n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: '${{ matrix.java-version }}'\n+      - name: 'cygnus-common Unit Tests (Java ${{ matrix.java-version }})'\n+        run: |\n+          cd \"${GITHUB_WORKSPACE}\"/cygnus-common\n+          mvn -q test\n+\n+          mvn -q clean compile exec:exec assembly:single\n+          VERSION=$(cat pom.xml | grep version | sed -n '1p' | sed -ne '/<version>/s#\\s*<[^>]*>\\s*##gp' | sed 's/ //g')\n+          mvn -q install:install-file -Dfile=target/cygnus-common-$VERSION-jar-with-dependencies.jar -DgroupId=com.telefonica.iot -DartifactId=cygnus-common -Dversion=$VERSION -Dpackaging=jar -DgeneratePom=true\n+      - name: 'cygnus-ngsi Unit Tests (Java ${{ matrix.java-version }})'\n+        run: |\n+          cd \"${GITHUB_WORKSPACE}\"/cygnus-ngsi\n+          mvn -q test\n+      - name: 'cygnus-ngsi-ld Unit Tests (Java ${{ matrix.java-version }})'\n+        run: |\n+          cd \"${GITHUB_WORKSPACE}\"/cygnus-ngsi-ld\n+          mvn -q test", "originalCommit": "616a437f93e723ec39554fb8c1f1728642ef474c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8c5013fea39927961fc62b0874ba15aaedafc9e1", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/8c5013fea39927961fc62b0874ba15aaedafc9e1", "message": "Update .github/workflows/ci.yml\n\nCo-authored-by: Ferm\u00edn Gal\u00e1n M\u00e1rquez <fgalan@users.noreply.github.com>", "committedDate": "2020-12-02T15:02:23Z", "type": "commit"}, {"oid": "ee4892e172564522fcfeed163561fa3b9ecea1b6", "url": "https://github.com/telefonicaid/fiware-cygnus/commit/ee4892e172564522fcfeed163561fa3b9ecea1b6", "message": "Update .github/workflows/ci.yml\n\nCo-authored-by: Ferm\u00edn Gal\u00e1n M\u00e1rquez <fgalan@users.noreply.github.com>", "committedDate": "2020-12-02T15:02:58Z", "type": "commit"}]}