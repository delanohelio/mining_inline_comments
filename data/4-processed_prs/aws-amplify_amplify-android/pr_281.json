{"pr_number": 281, "pr_title": "[testutils] Add synchronous storage and mobile client to testutils", "pr_createdAt": "2020-02-26T01:00:33Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/281", "timeline": [{"oid": "fcbc67305b5b9715d8aaa8bbeaa45b530bb3fe2c", "url": "https://github.com/aws-amplify/amplify-android/commit/fcbc67305b5b9715d8aaa8bbeaa45b530bb3fe2c", "message": "Re-organized testutils package to prevent overcrowding it", "committedDate": "2020-02-26T21:47:46Z", "type": "commit"}, {"oid": "fcbc67305b5b9715d8aaa8bbeaa45b530bb3fe2c", "url": "https://github.com/aws-amplify/amplify-android/commit/fcbc67305b5b9715d8aaa8bbeaa45b530bb3fe2c", "message": "Re-organized testutils package to prevent overcrowding it", "committedDate": "2020-02-26T21:47:46Z", "type": "forcePushed"}, {"oid": "1170e27cbf21231b5cf0eaae243dd18521d7ebeb", "url": "https://github.com/aws-amplify/amplify-android/commit/1170e27cbf21231b5cf0eaae243dd18521d7ebeb", "message": "Add synchronous mobile client and storage", "committedDate": "2020-02-26T22:21:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ1Mzg2MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/281#discussion_r385453860", "bodyText": "There is an existing class called TestMobileClient (I think) and this is supposed to be a rename and iteration on top of that existing file", "author": "jamesonwilliams", "createdAt": "2020-02-28T00:50:44Z", "path": "testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousMobileClient.java", "diffHunk": "@@ -0,0 +1,223 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.testutils.sync;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.test.core.app.ApplicationProvider;\n+\n+import com.amplifyframework.core.Consumer;\n+import com.amplifyframework.testutils.Await;\n+\n+import com.amazonaws.mobile.client.AWSMobileClient;\n+import com.amazonaws.mobile.client.Callback;\n+import com.amazonaws.mobile.client.UserStateDetails;\n+import com.amazonaws.mobile.client.results.SignInResult;\n+import com.amazonaws.mobile.config.AWSConfiguration;\n+\n+import java.util.Objects;\n+\n+/**\n+ * A wrapper around the {@link AWSMobileClient} which turns its asynchronous methods\n+ * into synchronous ones.\n+ */\n+@SuppressWarnings(\"unused\")\n+public final class SynchronousMobileClient {", "originalCommit": "1170e27cbf21231b5cf0eaae243dd18521d7ebeb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk3MTE2OA==", "url": "https://github.com/aws-amplify/amplify-android/pull/281#discussion_r385971168", "bodyText": "https://github.com/aws-amplify/amplify-android/blob/master/aws-api/src/androidTest/java/com/amplifyframework/api/aws/TestAWSMobileClient.java\nIs this what you are referring to? I believe SynchronousMobileClient class is more extensive and it should replace the old TestAWSMobileClient in other categories", "author": "raphkim", "createdAt": "2020-02-28T23:43:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ1Mzg2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk3NjQ1Mg==", "url": "https://github.com/aws-amplify/amplify-android/pull/281#discussion_r385976452", "bodyText": "Oops I misunderstood your intent. Removing that file and replacing its usage with the new SynchronousMobileClient now", "author": "raphkim", "createdAt": "2020-02-29T00:08:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ1Mzg2MA=="}], "type": "inlineReview"}, {"oid": "ea5e60c1c47a6a4691bd9ff526a7b8bc5dbc0ab9", "url": "https://github.com/aws-amplify/amplify-android/commit/ea5e60c1c47a6a4691bd9ff526a7b8bc5dbc0ab9", "message": "Replace old iteration", "committedDate": "2020-02-29T00:11:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk4MDIxNQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/281#discussion_r385980215", "bodyText": "If you have a sync package, this should probably go there too, since that\u2019s what this util is all about", "author": "jamesonwilliams", "createdAt": "2020-02-29T00:29:32Z", "path": "testutils/src/main/java/com/amplifyframework/testutils/sync/SynchronousDataStore.java", "diffHunk": "@@ -13,14 +13,15 @@\n  * permissions and limitations under the License.\n  */\n \n-package com.amplifyframework.testutils;\n+package com.amplifyframework.testutils.sync;\n \n import androidx.annotation.NonNull;\n \n import com.amplifyframework.core.Amplify;\n import com.amplifyframework.core.model.Model;\n import com.amplifyframework.datastore.DataStoreException;\n import com.amplifyframework.datastore.DataStoreItemChange;\n+import com.amplifyframework.testutils.Await;", "originalCommit": "ea5e60c1c47a6a4691bd9ff526a7b8bc5dbc0ab9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk4MTA3MA==", "url": "https://github.com/aws-amplify/amplify-android/pull/281#discussion_r385981070", "bodyText": "I considered Await as almost a primitive tool used by the the items inside sync package, so I didn't want to group it in there. I feel like things like Await, Latch, and Sleep all basic building blocks of test utilities, so they should probably be just stay where they are. Wasn't sure what to do with the rest.", "author": "raphkim", "createdAt": "2020-02-29T00:34:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk4MDIxNQ=="}], "type": "inlineReview"}]}