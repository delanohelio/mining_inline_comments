{"pr_number": 457, "pr_title": "Update Auth Session to Final Design", "pr_createdAt": "2020-05-13T20:57:48Z", "pr_url": "https://github.com/aws-amplify/amplify-android/pull/457", "timeline": [{"oid": "7f0effd04def036105db1be83e97c6bbdabb230c", "url": "https://github.com/aws-amplify/amplify-android/commit/7f0effd04def036105db1be83e97c6bbdabb230c", "message": "Auth Category to Staging Branch [Do Not Merge To Master] (#330)\n\n* Initial commit\r\n\r\n* Fixes checkstyle\r\n\r\n* Raise minSdkVersion to 16 (#327)\r\n\r\nGiven the vanishingly small number of ICS users according to Google's\r\nDistribution Dashboard and our own log analysis and industry trends\r\n(Google Play Services supports API Level 16+, for example), we are\r\ndropping support for API Level 15.\r\n\r\n* Updated dependencies\r\n\r\n* Update the plugin key for analytics to match one generated by the cli and update configuration method (#328)\r\n\r\n* Updates Javadocs\r\n\r\n* Addresses PR feedback\r\n\r\n* Added hashCode, toString, and equals methods\r\n\r\n* Addresses round 2 of PR comments\r\n\r\nCo-authored-by: John Pignata <john@pignata.com>\r\nCo-authored-by: Roshan Kumar <roskumr@amazon.com>", "committedDate": "2020-04-02T15:42:26Z", "type": "commit"}, {"oid": "3d0314e82be7e66ad13c87a5b0968830fab568c9", "url": "https://github.com/aws-amplify/amplify-android/commit/3d0314e82be7e66ad13c87a5b0968830fab568c9", "message": "Merge branch 'AuthCategory' of https://github.com/aws-amplify/amplify-android into AuthCategory", "committedDate": "2020-04-02T17:01:57Z", "type": "commit"}, {"oid": "4c8a89d3174d18c03e38678e9dddb498dafd22a8", "url": "https://github.com/aws-amplify/amplify-android/commit/4c8a89d3174d18c03e38678e9dddb498dafd22a8", "message": "Ddaudeli/auth category (#344)\n\n* Adds readme for user acceptance\r\n\r\n* Updates readme", "committedDate": "2020-04-02T18:40:00Z", "type": "commit"}, {"oid": "26206ad52989b5e040a819220365549490be4598", "url": "https://github.com/aws-amplify/amplify-android/commit/26206ad52989b5e040a819220365549490be4598", "message": "Merge remote-tracking branch 'origin/master' into AuthCategory", "committedDate": "2020-04-08T18:33:17Z", "type": "commit"}, {"oid": "c9d62e9ba5edf9cff601ff0c4d7cebdf02001437", "url": "https://github.com/aws-amplify/amplify-android/commit/c9d62e9ba5edf9cff601ff0c4d7cebdf02001437", "message": "Sign In and Fetch Session (#368)\n\n* Adds readme for user acceptance\r\n\r\n* Updates readme\r\n\r\n* Sign In and Fetch Session\r\n\r\n* Addresses PR comments\r\n\r\n* One more fix", "committedDate": "2020-04-09T17:22:52Z", "type": "commit"}, {"oid": "7444e9941b92721d5c36be1f9ebb8eea60484074", "url": "https://github.com/aws-amplify/amplify-android/commit/7444e9941b92721d5c36be1f9ebb8eea60484074", "message": "Merge remote-tracking branch 'origin/master' into AuthCategory", "committedDate": "2020-04-16T15:32:04Z", "type": "commit"}, {"oid": "3865231fd3ab73272f8974d3038abaeb7ac14380", "url": "https://github.com/aws-amplify/amplify-android/commit/3865231fd3ab73272f8974d3038abaeb7ac14380", "message": "Adds confirmSignIn (#382)", "committedDate": "2020-04-17T13:43:40Z", "type": "commit"}, {"oid": "3721ce58d280fd4f907b4d9a2ea3bcd01e95b043", "url": "https://github.com/aws-amplify/amplify-android/commit/3721ce58d280fd4f907b4d9a2ea3bcd01e95b043", "message": "Adds forgotPassword/confirmForgotPassword (#383)", "committedDate": "2020-04-17T20:20:53Z", "type": "commit"}, {"oid": "01cb673651c515904ed282c47dcba16b31e39604", "url": "https://github.com/aws-amplify/amplify-android/commit/01cb673651c515904ed282c47dcba16b31e39604", "message": "Adds social sign in (#386)", "committedDate": "2020-04-21T18:34:59Z", "type": "commit"}, {"oid": "e7f0382c7937fd683b6587ebc9f57ce8601063dd", "url": "https://github.com/aws-amplify/amplify-android/commit/e7f0382c7937fd683b6587ebc9f57ce8601063dd", "message": "Update README.md", "committedDate": "2020-04-21T18:58:54Z", "type": "commit"}, {"oid": "0fb6ea4ae706acb76cacba145e7ce5374a313a12", "url": "https://github.com/aws-amplify/amplify-android/commit/0fb6ea4ae706acb76cacba145e7ce5374a313a12", "message": "Merge remote-tracking branch 'origin/master' into AuthCategory", "committedDate": "2020-04-22T19:39:38Z", "type": "commit"}, {"oid": "9fdd4d2ed1fb5469f20a4ed781deb8cd0d35407e", "url": "https://github.com/aws-amplify/amplify-android/commit/9fdd4d2ed1fb5469f20a4ed781deb8cd0d35407e", "message": "Merge branch 'AuthCategory' of https://github.com/aws-amplify/amplify-android into AuthCategory", "committedDate": "2020-04-22T19:39:51Z", "type": "commit"}, {"oid": "1eddef05ac7f72b4cd5e864e8d49cae403f0d034", "url": "https://github.com/aws-amplify/amplify-android/commit/1eddef05ac7f72b4cd5e864e8d49cae403f0d034", "message": "Adds getCurrentUser and changePassword (#393)\n\n* Adds social sign in\r\n\r\n* Adds getCurrentUser and changePassword\r\n\r\n* Initial addressing of PR comments\r\n\r\n* Additional PR feedback addressed\r\n\r\n* Removes unused variable", "committedDate": "2020-04-29T18:20:36Z", "type": "commit"}, {"oid": "20c7b172b850f5597bf307ace9568d86e4f62e3f", "url": "https://github.com/aws-amplify/amplify-android/commit/20c7b172b850f5597bf307ace9568d86e4f62e3f", "message": "Auth Sign In/Sign Up Options Updates (#417)\n\n* Update options objects to meet design review\r\n\r\n* Minor fix to builder constructor\r\n\r\n* Addresses PR feedback", "committedDate": "2020-05-01T20:07:45Z", "type": "commit"}, {"oid": "c2276d17baca6b2535f01f8ca023dcbfe759289e", "url": "https://github.com/aws-amplify/amplify-android/commit/c2276d17baca6b2535f01f8ca023dcbfe759289e", "message": "Merge remote-tracking branch 'origin/master' into AuthCategory", "committedDate": "2020-05-08T17:41:41Z", "type": "commit"}, {"oid": "ef1cb65afcb3fd9e30f744222c574ecf80ed3da9", "url": "https://github.com/aws-amplify/amplify-android/commit/ef1cb65afcb3fd9e30f744222c574ecf80ed3da9", "message": "Merge remote-tracking branch 'origin/master' into AuthCategory", "committedDate": "2020-05-11T13:35:34Z", "type": "commit"}, {"oid": "6c174706f15b8071b3f34ae2c90cab10195ef67b", "url": "https://github.com/aws-amplify/amplify-android/commit/6c174706f15b8071b3f34ae2c90cab10195ef67b", "message": "Refactors methods to match design and adds unit tests (#433)\n\n* Refactors methods to design and adds unit tests\r\n\r\n* Adds NonNull/Nullable annotation\r\n\r\n* Corrects minor spacing\r\n\r\n* Addresses PR comment\r\n\r\n* Round 2 of PR feedback\r\n\r\n* Adds additional JavaDocs to meet new rule\r\n\r\n* Updates Javadocs", "committedDate": "2020-05-11T14:08:06Z", "type": "commit"}, {"oid": "3a394838d90c534919202003c0860f437bf1b534", "url": "https://github.com/aws-amplify/amplify-android/commit/3a394838d90c534919202003c0860f437bf1b534", "message": "Fetch auth session method updated", "committedDate": "2020-05-13T12:45:07Z", "type": "commit"}, {"oid": "5f5f9746f0a57438ea86ab3f803ed0507943d3d9", "url": "https://github.com/aws-amplify/amplify-android/commit/5f5f9746f0a57438ea86ab3f803ed0507943d3d9", "message": "Merge remote-tracking branch 'origin/master' into ddaudeli/fetchAuthSession", "committedDate": "2020-05-13T16:51:32Z", "type": "commit"}, {"oid": "e1b352d988ea77e5faea12b69cf78eb792721154", "url": "https://github.com/aws-amplify/amplify-android/commit/e1b352d988ea77e5faea12b69cf78eb792721154", "message": "Adds unit tests", "committedDate": "2020-05-13T20:54:04Z", "type": "commit"}, {"oid": "74a67c87c4428947c0ca4195e3564ba76d783d43", "url": "https://github.com/aws-amplify/amplify-android/commit/74a67c87c4428947c0ca4195e3564ba76d783d43", "message": "Re-remove User Acceptance Readme", "committedDate": "2020-05-13T21:00:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0MzIxMg==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425343212", "bodyText": "maybe use a private static method to return this like how you return pre-determined failed sessions in MobileClientSessionAdapter? It is very nested at the moment.", "author": "raphkim", "createdAt": "2020-05-14T18:22:48Z", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthPlugin.java", "diffHunk": "@@ -376,29 +369,25 @@ public void fetchAuthSession(\n             awsMobileClient.currentUserState(new Callback<UserStateDetails>() {\n                 @Override\n                 public void onResult(UserStateDetails result) {\n-                    UserState state = result.getUserState();\n-\n-                    switch (state) {\n+                    switch (result.getUserState()) {\n                         case SIGNED_OUT:\n-                        case SIGNED_OUT_USER_POOLS_TOKENS_INVALID:\n+                        case GUEST:\n+                            MobileClientSessionAdapter.fetchSignedOutSession(awsMobileClient, onSuccess);\n+                            break;\n                         case SIGNED_OUT_FEDERATED_TOKENS_INVALID:\n+                        case SIGNED_OUT_USER_POOLS_TOKENS_INVALID:\n                             onSuccess.accept(\n-                                AWSCognitoAuthSession.builder().isSignedIn(false).build()\n+                                    new AWSCognitoAuthSession(\n+                                            true,\n+                                            AuthSessionResult.failure(new AuthException.SessionExpiredException()),\n+                                            AuthSessionResult.failure(new AuthException.SessionExpiredException()),\n+                                            AuthSessionResult.failure(new AuthException.SessionExpiredException()),\n+                                            AuthSessionResult.failure(new AuthException.SessionExpiredException())\n+                                    )", "originalCommit": "74a67c87c4428947c0ca4195e3564ba76d783d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwNzg5Mg==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425407892", "bodyText": "Alright, sure.", "author": "TrekSoft", "createdAt": "2020-05-14T20:22:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0MzIxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NDk5NQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425344995", "bodyText": "is this the username or is it another auto-generated ID?", "author": "raphkim", "createdAt": "2020-05-14T18:25:56Z", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthSession.java", "diffHunk": "@@ -16,104 +16,81 @@\n package com.amplifyframework.auth.cognito;\n \n import androidx.annotation.NonNull;\n-import androidx.annotation.Nullable;\n import androidx.core.util.ObjectsCompat;\n \n import com.amplifyframework.auth.AuthSession;\n+import com.amplifyframework.auth.result.AuthSessionResult;\n \n import com.amazonaws.auth.AWSCredentials;\n import com.amazonaws.auth.AWSCredentialsProvider;\n \n+import java.util.Objects;\n+\n /**\n  * Cognito extension of AuthSession containing AWS Cognito specific tokens.\n  */\n public final class AWSCognitoAuthSession extends AuthSession implements AWSCredentialsProvider {\n-    private final AWSCredentials awsCredentials;\n-    private final String userSub;\n-    private final String identityId;\n-    private final String accessToken;\n-    private final String idToken;\n-    private final String refreshToken;\n+    private final AuthSessionResult<String> identityId;\n+    private final AuthSessionResult<AWSCredentials> awsCredentials;\n+    private final AuthSessionResult<String> userSub;\n+    private final AuthSessionResult<AWSCognitoUserPoolTokens> userPoolTokens;\n \n-    private AWSCognitoAuthSession(\n+    /**\n+     * Cognito extension of AuthSession containing AWS Cognito specific tokens.\n+     * @param isSignedIn Are you currently in a signed in state (an AuthN indicator to be technical)\n+     * @param awsCredentials The credentials which come from Identity Pool\n+     * @param userSub The id which comes from User Pools", "originalCommit": "74a67c87c4428947c0ca4195e3564ba76d783d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwODExMA==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425408110", "bodyText": "This is the user pools user id - which is really the only ID for a user which is a legit ID in Cognito.", "author": "TrekSoft", "createdAt": "2020-05-14T20:23:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0NDk5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4NjQ2OQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425386469", "bodyText": "I like that they are all @NonNull now :)", "author": "raphkim", "createdAt": "2020-05-14T19:42:22Z", "path": "aws-auth-cognito/src/main/java/com/amplifyframework/auth/cognito/AWSCognitoAuthSession.java", "diffHunk": "@@ -16,104 +16,81 @@\n package com.amplifyframework.auth.cognito;\n \n import androidx.annotation.NonNull;\n-import androidx.annotation.Nullable;\n import androidx.core.util.ObjectsCompat;\n \n import com.amplifyframework.auth.AuthSession;\n+import com.amplifyframework.auth.result.AuthSessionResult;\n \n import com.amazonaws.auth.AWSCredentials;\n import com.amazonaws.auth.AWSCredentialsProvider;\n \n+import java.util.Objects;\n+\n /**\n  * Cognito extension of AuthSession containing AWS Cognito specific tokens.\n  */\n public final class AWSCognitoAuthSession extends AuthSession implements AWSCredentialsProvider {\n-    private final AWSCredentials awsCredentials;\n-    private final String userSub;\n-    private final String identityId;\n-    private final String accessToken;\n-    private final String idToken;\n-    private final String refreshToken;\n+    private final AuthSessionResult<String> identityId;\n+    private final AuthSessionResult<AWSCredentials> awsCredentials;\n+    private final AuthSessionResult<String> userSub;\n+    private final AuthSessionResult<AWSCognitoUserPoolTokens> userPoolTokens;\n \n-    private AWSCognitoAuthSession(\n+    /**\n+     * Cognito extension of AuthSession containing AWS Cognito specific tokens.\n+     * @param isSignedIn Are you currently in a signed in state (an AuthN indicator to be technical)\n+     * @param awsCredentials The credentials which come from Identity Pool\n+     * @param userSub The id which comes from User Pools\n+     * @param identityId The id which comes from Identity Pools\n+     * @param userPoolTokens The tokens which come from User Pools (access, id, refresh tokens)\n+     */\n+    public AWSCognitoAuthSession(\n             boolean isSignedIn,\n-            AWSCredentials awsCredentials,\n-            String userSub,\n-            String identityId,\n-            String accessToken,\n-            String idToken,\n-            String refreshToken\n+            @NonNull AuthSessionResult<String> identityId,\n+            @NonNull AuthSessionResult<AWSCredentials> awsCredentials,\n+            @NonNull AuthSessionResult<String> userSub,\n+            @NonNull AuthSessionResult<AWSCognitoUserPoolTokens> userPoolTokens\n     ) {\n         super(isSignedIn);\n-        this.awsCredentials = awsCredentials;\n-        this.userSub = userSub;\n-        this.identityId = identityId;\n-        this.accessToken = accessToken;\n-        this.idToken = idToken;\n-        this.refreshToken = refreshToken;\n+        this.identityId = Objects.requireNonNull(identityId);\n+        this.awsCredentials = Objects.requireNonNull(awsCredentials);\n+        this.userSub = Objects.requireNonNull(userSub);\n+        this.userPoolTokens = Objects.requireNonNull(userPoolTokens);\n     }\n \n     /**\n-     * AWS Credentials from Identity Pools.\n-     * @return AWS Credentials from Identity Pools.\n+     * The credentials which come from Identity Pool.\n+     * @return the credentials which come from Identity Pool\n      */\n-    @Nullable\n-    public AWSCredentials getAWSCredentials() {\n+    @NonNull", "originalCommit": "74a67c87c4428947c0ca4195e3564ba76d783d43", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5MDYyNA==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425390624", "bodyText": "obj == null is redundant and it can be removed", "author": "raphkim", "createdAt": "2020-05-14T19:50:08Z", "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSessionResult.java", "diffHunk": "@@ -0,0 +1,133 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.result;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.core.util.ObjectsCompat;\n+\n+import com.amplifyframework.auth.AuthException;\n+\n+/**\n+ * Wraps a session value which could have had an error even though the method fetching it had a success callback.\n+ * @param <T> The type of data this result wraps.\n+ */\n+public final class AuthSessionResult<T> {\n+    private final T value;\n+    private final AuthException error;\n+    private final Type type;\n+\n+    private AuthSessionResult(T value, AuthException error, Type type) {\n+        this.value = value;\n+        this.error = error;\n+        this.type = type;\n+    }\n+\n+    /**\n+     * Create a result object for a successful session value fetch operation.\n+     * @param value The value successfully retrieved.\n+     * @param <T> The type of value this stores.\n+     * @return A new result object for the successfully retrieved value.\n+     */\n+    public static <T> AuthSessionResult<T> success(T value) {\n+        return new AuthSessionResult<>(value, null, Type.SUCCESS);\n+    }\n+\n+    /**\n+     * Create a result object for a failed value fetch operation.\n+     * @param error The error describing what went wrong while trying to fetch the value.\n+     * @param <T> The type of value attempting to be retrieved.\n+     * @return A new result object for the unsuccessfully retrieved value.\n+     */\n+    public static <T> AuthSessionResult<T> failure(AuthException error) {\n+        return new AuthSessionResult<>(null, error, Type.FAILURE);\n+    }\n+\n+    /**\n+     * Returns the value which was successfully retrieved.\n+     * @return the value which was successfully retrieved.\n+     */\n+    @Nullable\n+    public T getValue() {\n+        return value;\n+    }\n+\n+    /**\n+     * Returns the error describing what went wrong while attempting to retrieve the value.\n+     * @return the error describing what went wrong while attempting to retrieve the value.\n+     */\n+    @Nullable\n+    public AuthException getError() {\n+        return error;\n+    }\n+\n+    /**\n+     * Returns the type of result this was - whether it was successful or a failure. Useful for switch statements.\n+     * @return the type of result this was - whether it was successful or a failure.\n+     */\n+    @NonNull\n+    public Type getType() {\n+        return type;\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return ObjectsCompat.hash(\n+                getValue(),\n+                getError(),\n+                getType()\n+        );\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (this == obj) {\n+            return true;\n+        } else if (obj == null || !(obj instanceof AuthSessionResult<?>)) {", "originalCommit": "74a67c87c4428947c0ca4195e3564ba76d783d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwODUwNQ==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425408505", "bodyText": "This was the auto generated code by the IDE so planning to leave it as is.", "author": "TrekSoft", "createdAt": "2020-05-14T20:24:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5MDYyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5MzU3NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425393574", "bodyText": "is it always either-or situation? Is it possible to have partial result, where both result & non-blocking error are returned?\nAlso, can't this be represented with a simple boolean isSuccessful or something? Otherwise, maybe we can rename to Status or State instead? AuthSessionResult#getType() seems very vague, and gives off feeling that authentication is categorized into multiple types of operation.", "author": "raphkim", "createdAt": "2020-05-14T19:55:24Z", "path": "core/src/main/java/com/amplifyframework/auth/result/AuthSessionResult.java", "diffHunk": "@@ -0,0 +1,133 @@\n+/*\n+ * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\").\n+ * You may not use this file except in compliance with the License.\n+ * A copy of the License is located at\n+ *\n+ *  http://aws.amazon.com/apache2.0\n+ *\n+ * or in the \"license\" file accompanying this file. This file is distributed\n+ * on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ * express or implied. See the License for the specific language governing\n+ * permissions and limitations under the License.\n+ */\n+\n+package com.amplifyframework.auth.result;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import androidx.core.util.ObjectsCompat;\n+\n+import com.amplifyframework.auth.AuthException;\n+\n+/**\n+ * Wraps a session value which could have had an error even though the method fetching it had a success callback.\n+ * @param <T> The type of data this result wraps.\n+ */\n+public final class AuthSessionResult<T> {\n+    private final T value;\n+    private final AuthException error;\n+    private final Type type;\n+\n+    private AuthSessionResult(T value, AuthException error, Type type) {\n+        this.value = value;\n+        this.error = error;\n+        this.type = type;\n+    }\n+\n+    /**\n+     * Create a result object for a successful session value fetch operation.\n+     * @param value The value successfully retrieved.\n+     * @param <T> The type of value this stores.\n+     * @return A new result object for the successfully retrieved value.\n+     */\n+    public static <T> AuthSessionResult<T> success(T value) {\n+        return new AuthSessionResult<>(value, null, Type.SUCCESS);\n+    }\n+\n+    /**\n+     * Create a result object for a failed value fetch operation.\n+     * @param error The error describing what went wrong while trying to fetch the value.\n+     * @param <T> The type of value attempting to be retrieved.\n+     * @return A new result object for the unsuccessfully retrieved value.\n+     */\n+    public static <T> AuthSessionResult<T> failure(AuthException error) {\n+        return new AuthSessionResult<>(null, error, Type.FAILURE);\n+    }\n+\n+    /**\n+     * Returns the value which was successfully retrieved.\n+     * @return the value which was successfully retrieved.\n+     */\n+    @Nullable\n+    public T getValue() {\n+        return value;\n+    }\n+\n+    /**\n+     * Returns the error describing what went wrong while attempting to retrieve the value.\n+     * @return the error describing what went wrong while attempting to retrieve the value.\n+     */\n+    @Nullable\n+    public AuthException getError() {\n+        return error;\n+    }\n+\n+    /**\n+     * Returns the type of result this was - whether it was successful or a failure. Useful for switch statements.\n+     * @return the type of result this was - whether it was successful or a failure.\n+     */\n+    @NonNull\n+    public Type getType() {\n+        return type;\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return ObjectsCompat.hash(\n+                getValue(),\n+                getError(),\n+                getType()\n+        );\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (this == obj) {\n+            return true;\n+        } else if (obj == null || !(obj instanceof AuthSessionResult<?>)) {\n+            return false;\n+        } else {\n+            AuthSessionResult<?> authSessionResult = (AuthSessionResult<?>) obj;\n+            return ObjectsCompat.equals(getValue(), authSessionResult.getValue()) &&\n+                    ObjectsCompat.equals(getError(), authSessionResult.getError()) &&\n+                    ObjectsCompat.equals(getType(), authSessionResult.getType());\n+        }\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return \"AuthSessionResult{\" +\n+                \"value=\" + getValue() +\n+                \", error=\" + getError() +\n+                \", type=\" + getType() +\n+                '}';\n+    }\n+\n+    /**\n+     * The type of result this was - whether it was successful or a failure.\n+     */\n+    public enum Type {\n+        /**\n+         * Fetch value operation was successful.\n+         * You can retrieve the result with {@link #getValue()}.\n+         */\n+        SUCCESS,\n+        /**\n+         * Fetch value operation failed.\n+         * You can retrieve the exception explaining what went wrong with {@link #getError()}.\n+         */\n+        FAILURE\n+    }", "originalCommit": "74a67c87c4428947c0ca4195e3564ba76d783d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwOTExNg==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425409116", "bodyText": "Yeah it is always either or - basically it's designed the way it is to mirror the Swift result object: https://www.swiftbysundell.com/articles/the-power-of-result-types-in-swift/\nAlso mirrors the design Jameson did for an object like this on Android with a getType method.", "author": "TrekSoft", "createdAt": "2020-05-14T20:25:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5MzU3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQzMTkwNw==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425431907", "bodyText": "I guess using a specific enum to represent the state over boolean is fine, and it's not unprecedented as you mention. But I think we should still strive for a clearer name especially for customer-exposed data structures like this. Also, Status is what I'm leaning towards as the name, similarly to this.", "author": "raphkim", "createdAt": "2020-05-14T21:09:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5MzU3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2MTc0Nw==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425861747", "bodyText": "Discussed offline that the idea of type in the context of request makes sense since there are static success/failure type results vs. state which reflects it could change and that this was the naming decision Jameson went with in mocking out the class: https://gist.github.com/jamesonwilliams/b15b8888c2e759d575c59fb1567ea32f", "author": "TrekSoft", "createdAt": "2020-05-15T15:00:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5MzU3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5NTAzMA==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425395030", "bodyText": "Ooh are we bringing back category sub-exceptions? I liked the design, but all of our other categories don't have them at the moment right?", "author": "raphkim", "createdAt": "2020-05-14T19:57:59Z", "path": "core/src/main/java/com/amplifyframework/auth/AuthException.java", "diffHunk": "@@ -51,4 +51,144 @@ public AuthException(\n     ) {\n         super(message, recoverySuggestion);\n     }\n+\n+    /**\n+     * Auth exception caused by the user being signed out.\n+     */\n+    public static class SignedOutException extends AuthException {", "originalCommit": "74a67c87c4428947c0ca4195e3564ba76d783d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwOTQ0NA==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425409444", "bodyText": "Yeah we need to discuss this as a team for adding to the other categories but for now, added this because it was super necessary for Auth.", "author": "TrekSoft", "createdAt": "2020-05-14T20:25:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5NTAzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5NTU1Mg==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425395552", "bodyText": "AuthException -> AmplifyException", "author": "raphkim", "createdAt": "2020-05-14T19:59:01Z", "path": "core/src/main/java/com/amplifyframework/AmplifyException.java", "diffHunk": "@@ -78,4 +79,48 @@ public AmplifyException(\n     public final String getRecoverySuggestion() {\n         return recoverySuggestion;\n     }\n+\n+    /**\n+     * If any child classes override this method, they should be sure to include the recoverySuggestion, message, and\n+     * cause in their hash.\n+     */\n+    @Override\n+    public int hashCode() {\n+        return ObjectsCompat.hash(\n+                getRecoverySuggestion(),\n+                getMessage(),\n+                getCause()\n+        );\n+    }\n+\n+    /**\n+     * If any child classes override this method, they should be sure to include the recoverySuggestion, message, and\n+     * cause in their equality check.\n+     */\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (this == obj) {\n+            return true;\n+        } else if (obj == null || !(obj instanceof AmplifyException)) {\n+            return false;\n+        } else {\n+            AmplifyException amplifyException = (AmplifyException) obj;\n+            return ObjectsCompat.equals(getRecoverySuggestion(), amplifyException.getRecoverySuggestion()) &&\n+                    ObjectsCompat.equals(getMessage(), amplifyException.getMessage()) &&\n+                    ObjectsCompat.equals(getCause(), amplifyException.getCause());\n+        }\n+    }\n+\n+    /**\n+     * If any child classes override this method, they should be sure to include the recoverySuggestion, message, and\n+     * cause in their returned string.\n+     */\n+    @Override\n+    public String toString() {\n+        return \"AuthException {\" +", "originalCommit": "74a67c87c4428947c0ca4195e3564ba76d783d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwOTUzOA==", "url": "https://github.com/aws-amplify/amplify-android/pull/457#discussion_r425409538", "bodyText": "Ah, nice catch - thanks.", "author": "TrekSoft", "createdAt": "2020-05-14T20:25:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM5NTU1Mg=="}], "type": "inlineReview"}, {"oid": "f2c709002ec0a2ebf3de358bef2c69f638ff200b", "url": "https://github.com/aws-amplify/amplify-android/commit/f2c709002ec0a2ebf3de358bef2c69f638ff200b", "message": "Addresses PR feedback", "committedDate": "2020-05-14T20:57:10Z", "type": "commit"}]}