{"pr_number": 1022, "pr_title": "FINERACT-822 enable UnnecessaryDefaultInEnumSwitch error", "pr_createdAt": "2020-06-10T02:41:30Z", "pr_url": "https://github.com/apache/fineract/pull/1022", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA0OTMzNg==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r439049336", "bodyText": "wait... wat ??  By doing this, it will ALWAYS throw, no? This will completely break. @awasum please help..", "author": "vorburger", "createdAt": "2020-06-11T20:21:22Z", "path": "fineract-provider/src/main/java/org/apache/fineract/adhocquery/service/AdHocScheduledJobRunnerServiceImpl.java", "diffHunk": "@@ -88,10 +88,8 @@ public void generateClientSchedule() {\n                                 next = start.plusDays((int) (long) adhoc.getReportRunEvery());\n                                 run = Days.daysBetween(start, end).getDays() >= adhoc.getReportRunEvery();\n                                 break;\n-                            default:\n-                                throw new IllegalStateException();\n                         }\n-\n+                        throw new IllegalStateException();", "originalCommit": "ed3fd6680be800374b01727283ab57d42bfb3e46", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ5OTk3NQ==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r439499975", "bodyText": "@percyashu ..Maybe remove this exception? and put it back in the default case inside the } on line 91 above?\nAlso if you want to add a default step, you need to check the ReportRunFrequency.fromId(adhoc.getReportRunFrequency() method from line 70 above and see how many different cases needs to be treated, then try to handle them all. Do we absolutely need a default case in all implementations of Switch statement?\nAs seen here: https://errorprone.info/bugpattern/UnnecessaryDefaultInEnumSwitch, dont put a default statement if all the cases have been handled. Maybe skip it? Will that throw an error?\nOr given that ReportRunFrequency is an enum and we/Fineract is already handling all the 5 cases here, we can just throw a new AdHocScheduledJobFrequencyException() error here as default case with a message like \"Correct Frequency not specified, Check the API docs\"... @vorburger  @ptuomola your take?", "author": "awasum", "createdAt": "2020-06-12T15:49:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA0OTMzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1NjA2Mg==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r439856062", "bodyText": "Isn't this ErrorProne check specifically highlighting switch statements where the default case is never used, because we are already handling all the cases specifically? Given that, wouldn't the right solution just be to remove the default including the throw, and not add anything?", "author": "ptuomola", "createdAt": "2020-06-14T18:30:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA0OTMzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM3MTEyMA==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r440371120", "bodyText": "@ptuomola I thought so to but it requires a return.\n@vorburger I thought if the case is not found, switch default is used with exception thrown and if case is not found and no default then switch is not executed then exception is thrown. That's why I did it like this. Just undid what I did and added a suppressedwarning", "author": "percyashu", "createdAt": "2020-06-15T18:38:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA0OTMzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1NjEwMA==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r439856100", "bodyText": "Same here - shouldn't we just remove the default case altogether, not add anything back?", "author": "ptuomola", "createdAt": "2020-06-14T18:31:22Z", "path": "fineract-provider/src/main/java/org/apache/fineract/infrastructure/documentmanagement/contentrepository/ContentRepositoryUtils.java", "diffHunk": "@@ -55,9 +55,8 @@ public static ImageMIMEtype fromFileExtension(ImageFileExtension fileExtension)\n                     return ImageMIMEtype.JPEG;\n                 case PNG:\n                     return ImageMIMEtype.PNG;\n-                default:\n-                    throw new IllegalArgumentException();\n             }\n+            throw new IllegalArgumentException();", "originalCommit": "ed3fd6680be800374b01727283ab57d42bfb3e46", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c03879eef3caf2c0b2b1e16f507cd14bba70f949", "url": "https://github.com/apache/fineract/commit/c03879eef3caf2c0b2b1e16f507cd14bba70f949", "message": "FINERACT-822 enable UnnecessaryDefaultInEnumSwitch error", "committedDate": "2020-06-15T14:14:37Z", "type": "forcePushed"}, {"oid": "d1af44c79408fcfcd59ffd5c7736f2c259d57294", "url": "https://github.com/apache/fineract/commit/d1af44c79408fcfcd59ffd5c7736f2c259d57294", "message": "FINERACT-822 enable UnnecessaryDefaultInEnumSwitch error", "committedDate": "2020-06-15T15:16:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM1ODI2NA==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r440358264", "bodyText": "Is this being removed (not moved) intentional?", "author": "vorburger", "createdAt": "2020-06-15T18:14:35Z", "path": "fineract-provider/build.gradle", "diffHunk": "@@ -338,7 +338,6 @@ tasks.withType(JavaCompile) {\n                 \"ClassCanBeStatic\",\n                 \"SameNameButDifferent\",\n                 \"StringSplitter\",\n-                \"ImmutableEnumChecker\",", "originalCommit": "d1af44c79408fcfcd59ffd5c7736f2c259d57294", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM2NTQxMw==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r440365413", "bodyText": "It was moved to the error list in a previous PR.  Don't know how it is here (maybe during merge) so I just removed it", "author": "percyashu", "createdAt": "2020-06-15T18:27:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM1ODI2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjExNzI5OQ==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r442117299", "bodyText": "If you have suppressed this check..Do we still need this default?", "author": "awasum", "createdAt": "2020-06-18T10:09:07Z", "path": "fineract-provider/src/main/java/org/apache/fineract/adhocquery/service/AdHocScheduledJobRunnerServiceImpl.java", "diffHunk": "@@ -87,9 +88,8 @@ public void generateClientSchedule() {\n                                 run = Days.daysBetween(start, end).getDays() >= adhoc.getReportRunEvery();\n                             break;\n                             default:\n-                                throw new IllegalStateException();\n+                                throw new IllegalArgumentException();", "originalCommit": "d1af44c79408fcfcd59ffd5c7736f2c259d57294", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEyMTg0NA==", "url": "https://github.com/apache/fineract/pull/1022#discussion_r443121844", "bodyText": "Was my mistake wasn't not suppose to change the exception will revert it. Yeah we need it because Error prone thinks it is not necessary since all cases are specified.", "author": "percyashu", "createdAt": "2020-06-20T10:55:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjExNzI5OQ=="}], "type": "inlineReview"}, {"oid": "ab711ae085b45ae2518d812f7bcd43132cbe15a2", "url": "https://github.com/apache/fineract/commit/ab711ae085b45ae2518d812f7bcd43132cbe15a2", "message": "FINERACT-822 enable UnnecessaryDefaultInEnumSwitch error", "committedDate": "2020-06-20T11:07:46Z", "type": "commit"}, {"oid": "ab711ae085b45ae2518d812f7bcd43132cbe15a2", "url": "https://github.com/apache/fineract/commit/ab711ae085b45ae2518d812f7bcd43132cbe15a2", "message": "FINERACT-822 enable UnnecessaryDefaultInEnumSwitch error", "committedDate": "2020-06-20T11:07:46Z", "type": "forcePushed"}]}