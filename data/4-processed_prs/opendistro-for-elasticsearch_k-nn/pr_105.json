{"pr_number": 105, "pr_title": "Library build task", "pr_createdAt": "2020-05-06T19:32:24Z", "pr_url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/105", "timeline": [{"oid": "b9608f3156c81143fff9ed5733f80e8fb763aa37", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/b9608f3156c81143fff9ed5733f80e8fb763aa37", "message": "added buildJniLib task", "committedDate": "2020-05-06T18:18:20Z", "type": "commit"}, {"oid": "34226cf8a731e3f2c26cd6b492b1859706d0598f", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/34226cf8a731e3f2c26cd6b492b1859706d0598f", "message": "modifify library build logic", "committedDate": "2020-05-06T19:30:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTA0MjQ3MQ==", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/105#discussion_r421042471", "bodyText": "why not club this to one task\ntask buildJniLib(type:Exec) {\nworkingDir 'jni'\ncommandLine 'cmake', '.'\ncommandLine 'make'\n}", "author": "vamshin", "createdAt": "2020-05-06T19:35:22Z", "path": "build.gradle", "diffHunk": "@@ -109,13 +109,26 @@ thirdPartyAudit.enabled = false\n def es_tmp_dir = rootProject.file('build/private/es_tmp').absoluteFile\n es_tmp_dir.mkdirs()\n \n+task cmakeJniLib(type:Exec) {\n+    workingDir 'jni'\n+    commandLine 'cmake', '.'\n+}\n+\n+task buildJniLib(type:Exec) {\n+    dependsOn cmakeJniLib\n+    workingDir 'jni'\n+    commandLine 'make'\n+}\n+", "originalCommit": "34226cf8a731e3f2c26cd6b492b1859706d0598f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTA1OTY1OQ==", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/pull/105#discussion_r421059659", "bodyText": "The following syntax does not work. commandLine 'cmake', '.' is overridden with commandLine 'make'.\ntask buildJniLib(type:Exec) {\nworkingDir 'jni'\ncommandLine 'cmake', '.'\ncommandLine 'make'\n}\n\nAdditionally, having 2 separate tasks allows a user to just run the cmake task if they want.", "author": "jmazanec15", "createdAt": "2020-05-06T20:06:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTA0MjQ3MQ=="}], "type": "inlineReview"}, {"oid": "33ba8c793d4bcb326ba2ad762ecb019227037a3c", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/33ba8c793d4bcb326ba2ad762ecb019227037a3c", "message": "add JNI Lib directory log message", "committedDate": "2020-05-06T20:14:39Z", "type": "commit"}, {"oid": "24931921ebfc6641043d57c7f0721b3721f4bdb0", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/24931921ebfc6641043d57c7f0721b3721f4bdb0", "message": "added condition to buildJniLib", "committedDate": "2020-05-06T20:19:06Z", "type": "commit"}, {"oid": "b3ce22c1e911450f07914377a2e08299148ad0ed", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/b3ce22c1e911450f07914377a2e08299148ad0ed", "message": "add dependency on buildJniLib", "committedDate": "2020-05-06T20:28:45Z", "type": "commit"}, {"oid": "fe42d4524b2a94ae537b06a93bf3d7733d21fc53", "url": "https://github.com/opendistro-for-elasticsearch/k-NN/commit/fe42d4524b2a94ae537b06a93bf3d7733d21fc53", "message": "update when to depend on buildJNI task", "committedDate": "2020-05-06T20:56:09Z", "type": "commit"}]}