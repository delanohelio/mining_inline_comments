{"pr_number": 1344, "pr_title": "Add SLF4J extension", "pr_createdAt": "2020-03-18T08:29:09Z", "pr_url": "https://github.com/alibaba/Sentinel/pull/1344", "timeline": [{"oid": "ff4e7d58c8ff1aa8a8468f452fcfe5d3194c6e15", "url": "https://github.com/alibaba/Sentinel/commit/ff4e7d58c8ff1aa8a8468f452fcfe5d3194c6e15", "message": "Merge pull request #1 from alibaba/master\n\nupdate", "committedDate": "2019-02-12T07:01:24Z", "type": "commit"}, {"oid": "1a3510fc332b27b95e233b949d4cee62730628c1", "url": "https://github.com/alibaba/Sentinel/commit/1a3510fc332b27b95e233b949d4cee62730628c1", "message": "Merge branch 'master' of github.com:wavesZh/Sentinel", "committedDate": "2019-04-20T02:32:32Z", "type": "commit"}, {"oid": "380fd936c46d492fbcc12d231bf2cbb18d0e4fd5", "url": "https://github.com/alibaba/Sentinel/commit/380fd936c46d492fbcc12d231bf2cbb18d0e4fd5", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2019-08-08T13:55:32Z", "type": "commit"}, {"oid": "f451f4f4a315caa413037ed32957e6726afa32c0", "url": "https://github.com/alibaba/Sentinel/commit/f451f4f4a315caa413037ed32957e6726afa32c0", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2019-08-14T02:47:20Z", "type": "commit"}, {"oid": "41201d09aceed2f69c410ccb41cb990c1e03314b", "url": "https://github.com/alibaba/Sentinel/commit/41201d09aceed2f69c410ccb41cb990c1e03314b", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2019-08-15T06:13:22Z", "type": "commit"}, {"oid": "77fb92268857142ef453bb3ac26115672519ceda", "url": "https://github.com/alibaba/Sentinel/commit/77fb92268857142ef453bb3ac26115672519ceda", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2019-09-20T01:35:43Z", "type": "commit"}, {"oid": "6e176f93809bd2cfdd53d27fb92d8aeaedd9295c", "url": "https://github.com/alibaba/Sentinel/commit/6e176f93809bd2cfdd53d27fb92d8aeaedd9295c", "message": "Merge branch 'master' of github.com:wavesZh/Sentinel", "committedDate": "2020-03-06T10:26:28Z", "type": "commit"}, {"oid": "57fc6d0d6e40c6c10842d51e55959146cee2e08a", "url": "https://github.com/alibaba/Sentinel/commit/57fc6d0d6e40c6c10842d51e55959146cee2e08a", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-03-16T06:36:21Z", "type": "commit"}, {"oid": "761ce348ae9ef910b4a85fedb0668b767934763d", "url": "https://github.com/alibaba/Sentinel/commit/761ce348ae9ef910b4a85fedb0668b767934763d", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-03-17T02:11:31Z", "type": "commit"}, {"oid": "331359c72416a4ea11dbb4bc15834238364eb582", "url": "https://github.com/alibaba/Sentinel/commit/331359c72416a4ea11dbb4bc15834238364eb582", "message": "add logging extension for SLF4J", "committedDate": "2020-03-18T08:21:07Z", "type": "commit"}, {"oid": "0d9c07cd4612bd650074836169b2c179a02e72bc", "url": "https://github.com/alibaba/Sentinel/commit/0d9c07cd4612bd650074836169b2c179a02e72bc", "message": "Merge remote-tracking branch 'upstream/master' into slf4j-extension", "committedDate": "2020-03-18T08:22:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE4Mjg5NA==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394182894", "bodyText": "Could you please add the license header?", "author": "sczyh30", "createdAt": "2020-03-18T08:43:29Z", "path": "sentinel-extension/sentinel-logging-extension-slf4j/src/main/java/com/alibaba/csp/sentinel/logging/slf4j/CommandCenterLogLogger.java", "diffHunk": "@@ -0,0 +1,66 @@\n+package com.alibaba.csp.sentinel.logging.slf4j;", "originalCommit": "0d9c07cd4612bd650074836169b2c179a02e72bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIwNDczMQ==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394204731", "bodyText": "added", "author": "wavesZh", "createdAt": "2020-03-18T09:22:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE4Mjg5NA=="}], "type": "inlineReview"}, {"oid": "6936d7c4803aa6f1a5cf0e59bdff366746cb4fb1", "url": "https://github.com/alibaba/Sentinel/commit/6936d7c4803aa6f1a5cf0e59bdff366746cb4fb1", "message": "add license header", "committedDate": "2020-03-18T09:21:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyMjYwNQ==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394222605", "bodyText": "Maybe we can just call it sentinel-logging-slf4j for short.\nAnd is it necessary to create a new module in the same level as sentinel-extension called sentinel-logging? Thus some common logic can be put into a package like sentinel-logging-common maybe. Just a proposal and @sczyh30  you can comment it here.", "author": "jasonjoo2010", "createdAt": "2020-03-18T09:52:06Z", "path": "sentinel-extension/pom.xml", "diffHunk": "@@ -22,6 +22,7 @@\n         <module>sentinel-datasource-spring-cloud-config</module>\n         <module>sentinel-datasource-consul</module>\n         <module>sentinel-datasource-etcd</module>\n+        <module>sentinel-logging-extension-slf4j</module>", "originalCommit": "6936d7c4803aa6f1a5cf0e59bdff366746cb4fb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1MTIyMw==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394251223", "bodyText": "Good idea.", "author": "sczyh30", "createdAt": "2020-03-18T10:40:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyMjYwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1NjE4OA==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394256188", "bodyText": "Things change a lot.\nSo for summary the only undetermined point is:\n\nWhether we should create a new module for integrations of logging.\n\nComing to README.md my opinion is making it simple which is enough. But i am okay if you have different viewpoint.", "author": "jasonjoo2010", "createdAt": "2020-03-18T10:48:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyMjYwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNDY4MA==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394224680", "bodyText": "Coming to the usage we may not force user to introduce both of them because:\n\nUser should have already had a configured slf4j logging system and just want sentinel's logs merged into.\nThis module should depend on it obviously.", "author": "jasonjoo2010", "createdAt": "2020-03-18T09:55:26Z", "path": "sentinel-extension/sentinel-logging-extension-slf4j/README.md", "diffHunk": "@@ -0,0 +1,49 @@\n+# Sentinel Logging Extension SLF4J\n+\n+To use Sentinel Logging Extension SLF4J with Log4j2, you should add the following dependency firstly:\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-logging-extension-slf4j</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+<dependency>\n+    <groupId>org.slf4j</groupId>\n+    <artifactId>slf4j-api</artifactId>\n+    <version>${slf4j.version}</version>\n+</dependency>", "originalCommit": "6936d7c4803aa6f1a5cf0e59bdff366746cb4fb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNTUyNg==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394225526", "bodyText": "... and surely i am not sure whether we should provide some guidances on how to integrate slf4j over log4j2.", "author": "jasonjoo2010", "createdAt": "2020-03-18T09:56:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNDY4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1Mzc3Mg==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394253772", "bodyText": "Coming to the usage we may not force user to introduce both of them because:\n\nUser should have already had a configured slf4j logging system and just want sentinel's logs merged into.\n\n\nI mark the slf4j dependence with socpe \"provided\" in pom.xml. The dependence should be providered by user\n\n... and surely i am not sure whether we should provide some guidances on how to integrate slf4j over log4j2.\n\nIn README.md i provider the loging's configuration just want to emphasize:\n\nAnd you can add Sentinel's Loggers that it name is sentinelRecordLogger or sentinelCommandCenterLogger for your needs", "author": "wavesZh", "createdAt": "2020-03-18T10:44:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNDY4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNjY4MQ==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394226681", "bodyText": "Same reason as above we only do integration on slf4j-api but not slf4j over log4j2.", "author": "jasonjoo2010", "createdAt": "2020-03-18T09:58:32Z", "path": "sentinel-extension/sentinel-logging-extension-slf4j/pom.xml", "diffHunk": "@@ -0,0 +1,60 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>sentinel-parent</artifactId>\n+        <groupId>com.alibaba.csp</groupId>\n+        <version>1.7.2-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>sentinel-logging-extension-slf4j</artifactId>\n+    <packaging>jar</packaging>\n+\n+    <properties>\n+        <java.source.version>1.7</java.source.version>\n+        <java.target.version>1.7</java.target.version>\n+        <slf4j.version>1.7.25</slf4j.version>\n+        <log4j2.version>2.12.1</log4j2.version>\n+    </properties>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>com.alibaba.csp</groupId>\n+            <artifactId>sentinel-transport-common</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.slf4j</groupId>\n+            <artifactId>slf4j-api</artifactId>\n+            <version>${slf4j.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.logging.log4j</groupId>\n+            <artifactId>log4j-core</artifactId>\n+            <version>${log4j2.version}</version>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.logging.log4j</groupId>\n+            <artifactId>log4j-slf4j-impl</artifactId>", "originalCommit": "6936d7c4803aa6f1a5cf0e59bdff366746cb4fb1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNzU4OA==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394227588", "bodyText": "It should not exist", "author": "jasonjoo2010", "createdAt": "2020-03-18T09:59:55Z", "path": "sentinel-extension/sentinel-logging-extension-slf4j/src/test/resources/log4j2.xml", "diffHunk": "@@ -0,0 +1,25 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n+<Configuration>\n+    <Appenders>\n+        <Console name=\"Console\" target=\"SYSTEM_OUT\">\n+            <PatternLayout pattern=\"%-5level %logger - %msg%n\"/>\n+        </Console>\n+        <File name=\"FILE\" fileName=\"sentinel-record.log\" append=\"false\">\n+            <PatternLayout pattern=\"%-5level %logger - %msg%n\"/>", "originalCommit": "6936d7c4803aa6f1a5cf0e59bdff366746cb4fb1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0NjI0OQ==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394246249", "bodyText": "It's just for test. Should I change another test mode?", "author": "wavesZh", "createdAt": "2020-03-18T10:31:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNzU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1MDIyNQ==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394250225", "bodyText": "It's just for test. Should I change another test mode?\n\nOh i am sorry for that i misunderstand it.\nAnd the other question is why sentinel-transport-common is introduced in?", "author": "jasonjoo2010", "createdAt": "2020-03-18T10:38:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNzU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI1MzU1NQ==", "url": "https://github.com/alibaba/Sentinel/pull/1344#discussion_r394253555", "bodyText": "It's just for test. Should I change another test mode?\n\nOh i am sorry for that i misunderstand it.\nAnd the other question is why sentinel-transport-common is introduced in?\n\nI checked changes of recent commits and found that CommonLogCenter has been moved into transport-common package. So I will be okay on it. But this change is a little wired maybe we had better split them into different service interfaces.", "author": "jasonjoo2010", "createdAt": "2020-03-18T10:43:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNzU4OA=="}], "type": "inlineReview"}]}