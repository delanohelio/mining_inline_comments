{"pr_number": 1617, "pr_title": "Fix #1573: Support customized origin parser in Apache Dubbo 2.7.x adapter", "pr_createdAt": "2020-07-17T10:26:41Z", "pr_url": "https://github.com/alibaba/Sentinel/pull/1617", "timeline": [{"oid": "cbf3d221c1443b3c5d426149232ac1813505a9a5", "url": "https://github.com/alibaba/Sentinel/commit/cbf3d221c1443b3c5d426149232ac1813505a9a5", "message": "fix #1573", "committedDate": "2020-07-16T09:28:52Z", "type": "commit"}, {"oid": "0bbf5fa88985a6e7a81fc6a1b955ec8b896a9eff", "url": "https://github.com/alibaba/Sentinel/commit/0bbf5fa88985a6e7a81fc6a1b955ec8b896a9eff", "message": "Refer to the previous scheme and optimize the configuration", "committedDate": "2020-07-17T10:19:08Z", "type": "commit"}, {"oid": "95b755fb65bbbacffae7b82fa523f9d5aca34798", "url": "https://github.com/alibaba/Sentinel/commit/95b755fb65bbbacffae7b82fa523f9d5aca34798", "message": "Polish Dubbo 2.7.x adapter", "committedDate": "2020-07-20T02:00:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY3NzExOA==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r461677118", "bodyText": "originParse seems a typo, adding Since 1.8.0 can help user who use old verison.\nMaybe the document can refer to #1572", "author": "cdfive", "createdAt": "2020-07-28T15:35:09Z", "path": "sentinel-adapter/sentinel-apache-dubbo-adapter/README.md", "diffHunk": "@@ -65,4 +65,10 @@ flow control, degrade or system load protection. You can implement your own `Dub\n and then register to `DubboFallbackRegistry`. If no fallback is configured, Sentinel will wrap the `BlockException`\n then directly throw it out.\n \n-Besides, we can also leverage [Dubbo mock mechanism](http://dubbo.apache.org/en-us/docs/user/demos/local-mock.html) to provide fallback implementation of degraded Dubbo services.\n\\ No newline at end of file\n+Besides, we can also leverage [Dubbo mock mechanism](http://dubbo.apache.org/en-us/docs/user/demos/local-mock.html) to provide fallback implementation of degraded Dubbo services.\n+\n+## Global dubbo provider origin parse\n+\n+Sentinel Dubbo Adapter supports global origin parse for provider.\n+You can implement your own `DubboOriginParser` interface\n+and then register to `DubboAdapterGlobalConfig`. If no originParse is configured, Sentinel will user dubbo url property application.", "originalCommit": "95b755fb65bbbacffae7b82fa523f9d5aca34798", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg0MDg5MQ==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r462840891", "bodyText": "Ok, this piece is really my incomplete consideration, thank you for correcting, and it has been fixed", "author": "JiangZian", "createdAt": "2020-07-30T08:37:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY3NzExOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY3OTIxMw==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r461679213", "bodyText": "getMethodResourceName has prefix configuration function, interfaceResouceName may also need this, and getInterfaceResourceName can be added.Also refer to PR of dubbo-adaptor of 2.6.", "author": "cdfive", "createdAt": "2020-07-28T15:38:12Z", "path": "sentinel-adapter/sentinel-apache-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/DubboUtils.java", "diffHunk": "@@ -57,20 +57,20 @@ public static String getResourceName(Invoker<?> invoker, Invocation invocation,\n         return buf.toString();\n     }\n \n-    public static String getResourceName(Invoker<?> invoker, Invocation invocation, String prefix) {\n+    public static String getMethodResourceName(Invoker<?> invoker, Invocation invocation, String prefix) {\n         if (StringUtil.isNotBlank(prefix)) {\n             return new StringBuilder(64)\n                     .append(prefix)\n-                    .append(getResourceName(invoker, invocation, DubboConfig.getDubboInterfaceGroupAndVersionEnabled()))\n+                    .append(getMethodResourceName(invoker, invocation, DubboAdapterGlobalConfig.getDubboInterfaceGroupAndVersionEnabled()))\n                     .toString();\n         } else {\n-            return getResourceName(invoker, invocation, DubboConfig.getDubboInterfaceGroupAndVersionEnabled());\n+            return getMethodResourceName(invoker, invocation, DubboAdapterGlobalConfig.getDubboInterfaceGroupAndVersionEnabled());\n         }\n     }", "originalCommit": "95b755fb65bbbacffae7b82fa523f9d5aca34798", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg0MDc4Ng==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r462840786", "bodyText": "Ok, this piece is really my incomplete consideration, thank you for correcting, and it has been fixed", "author": "JiangZian", "createdAt": "2020-07-30T08:37:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY3OTIxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODYzMDg0NQ==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r468630845", "bodyText": "So modest, very nice work! \ud83d\udc4d", "author": "cdfive", "createdAt": "2020-08-11T14:36:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY3OTIxMw=="}], "type": "inlineReview"}, {"oid": "ce8cd6e43d79eb3744f1a49dd90b1893dbd85a25", "url": "https://github.com/alibaba/Sentinel/commit/ce8cd6e43d79eb3744f1a49dd90b1893dbd85a25", "message": "add interfaceResouceName with prefix and useGroupAndVersion configuration function", "committedDate": "2020-07-30T08:28:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODYyMzAzMg==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r468623032", "bodyText": "A unused import.", "author": "cdfive", "createdAt": "2020-08-11T14:25:19Z", "path": "sentinel-adapter/sentinel-apache-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParser.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n+\n+import com.alibaba.csp.sentinel.context.Context;", "originalCommit": "ce8cd6e43d79eb3744f1a49dd90b1893dbd85a25", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODk1NDk5Nw==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r468954997", "bodyText": "Thank you for your correcting. I have fixed this problem after you pointed it out", "author": "JiangZian", "createdAt": "2020-08-12T01:34:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODYyMzAzMg=="}], "type": "inlineReview"}, {"oid": "82355873033fafe2c8403c8025b347ea8895ea37", "url": "https://github.com/alibaba/Sentinel/commit/82355873033fafe2c8403c8025b347ea8895ea37", "message": "fix a unused import", "committedDate": "2020-08-12T01:23:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDM4OTcyOQ==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r470389729", "bodyText": "If redirect registry related logic to DubboAdapterGlobalConfig:\n\nThese static internal variables should be removed.\nThis legacy registry should be marked as deprecated and add more comments.", "author": "jasonjoo2010", "createdAt": "2020-08-14T03:29:27Z", "path": "sentinel-adapter/sentinel-apache-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/fallback/DubboFallbackRegistry.java", "diffHunk": "@@ -33,21 +34,21 @@\n     private static volatile DubboFallback providerFallback = new DefaultDubboFallback();", "originalCommit": "82355873033fafe2c8403c8025b347ea8895ea37", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE5ODM2Ng==", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r471198366", "bodyText": "Thinks, I have deleted this static internal variables", "author": "JiangZian", "createdAt": "2020-08-17T02:12:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDM4OTcyOQ=="}], "type": "inlineReview"}, {"oid": "549d35a4336a341ab515576a896dc51882ff8715", "url": "https://github.com/alibaba/Sentinel/commit/549d35a4336a341ab515576a896dc51882ff8715", "message": "Get rid of unwanted dependencies", "committedDate": "2020-08-17T02:06:25Z", "type": "commit"}]}