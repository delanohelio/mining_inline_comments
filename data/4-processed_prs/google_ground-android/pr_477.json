{"pr_number": 477, "pr_title": "[Code refactor] Simplify handling of window insets", "pr_createdAt": "2020-05-24T15:20:09Z", "pr_url": "https://github.com/google/ground-android/pull/477", "timeline": [{"oid": "bea1ee7a493e16b46fbddd19cfcbc39fa4a94b0e", "url": "https://github.com/google/ground-android/commit/bea1ee7a493e16b46fbddd19cfcbc39fa4a94b0e", "message": "Remove manual inset addition in map container views\n\n - Cleanup fragment\n - Separate MapView from remaining and add fitsSystemWindows to keep them within the limits", "committedDate": "2020-05-24T07:48:47Z", "type": "commit"}, {"oid": "264137dbbf14a77cce7181c44c56168ae4e90760", "url": "https://github.com/google/ground-android/commit/264137dbbf14a77cce7181c44c56168ae4e90760", "message": "Flatten view hierarchy", "committedDate": "2020-05-24T08:20:53Z", "type": "commit"}, {"oid": "6fd35a6528f4f36ebe3ee183183a4f1c19a1e79c", "url": "https://github.com/google/ground-android/commit/6fd35a6528f4f36ebe3ee183183a4f1c19a1e79c", "message": "Move StatusBarScrim to MainActivity", "committedDate": "2020-05-24T13:21:59Z", "type": "commit"}, {"oid": "d87d30e941b62b447a63d4d102035930691e7317", "url": "https://github.com/google/ground-android/commit/d87d30e941b62b447a63d4d102035930691e7317", "message": "Fix OfflineAreas fragment", "committedDate": "2020-05-24T14:13:38Z", "type": "commit"}, {"oid": "e463b91fb11a8eaf785f4deabeaabbe175b86e9a", "url": "https://github.com/google/ground-android/commit/e463b91fb11a8eaf785f4deabeaabbe175b86e9a", "message": "Fix offline area selector fragment", "committedDate": "2020-05-24T14:58:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NTM0Nw==", "url": "https://github.com/google/ground-android/pull/477#discussion_r429655347", "bodyText": "\"Feature\" has a special meaning in Ground - perhaps better to say \"Placeholder\" here?", "author": "gino-m", "createdAt": "2020-05-24T16:57:36Z", "path": "gnd/src/main/res/layout/map_container_frag.xml", "diffHunk": "@@ -32,90 +32,96 @@\n     android:layout_width=\"match_parent\"\n     android:layout_height=\"match_parent\">\n \n+    <!-- Feature holder for map implementation -->", "originalCommit": "bea1ee7a493e16b46fbddd19cfcbc39fa4a94b0e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NTY2OA==", "url": "https://github.com/google/ground-android/pull/477#discussion_r429655668", "bodyText": "I could never get this to work; nicely done!", "author": "gino-m", "createdAt": "2020-05-24T17:01:52Z", "path": "gnd/src/main/res/layout/map_container_frag.xml", "diffHunk": "@@ -32,90 +32,96 @@\n     android:layout_width=\"match_parent\"\n     android:layout_height=\"match_parent\">\n \n+    <!-- Feature holder for map implementation -->\n+    <FrameLayout\n+      android:id=\"@+id/map\"\n+      android:layout_width=\"match_parent\"\n+      android:layout_height=\"match_parent\" />\n \n-    <RelativeLayout\n-      android:id=\"@+id/map_layout\"\n+    <FrameLayout\n       android:layout_width=\"match_parent\"\n       android:layout_height=\"match_parent\"\n-      android:layout_gravity=\"center\"\n-      android:gravity=\"center\"\n-      app:layout_behavior=\"com.google.android.gnd.ui.home.mapcontainer.MapLayoutBehavior\">\n+      android:fitsSystemWindows=\"true\">", "originalCommit": "bea1ee7a493e16b46fbddd19cfcbc39fa4a94b0e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY3MDY4MQ==", "url": "https://github.com/google/ground-android/pull/477#discussion_r429670681", "bodyText": "I have read in Romain Guy's blog that flat hierarchy views are better because they consume less resources and are rendered quickly. So, that was one of my motivation too.", "author": "shobhitagarwal1612", "createdAt": "2020-05-24T20:09:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NTY2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NjE4Mw==", "url": "https://github.com/google/ground-android/pull/477#discussion_r429656183", "bodyText": "Not a major issue, esp. if it saves us code complexity, but the system inset areas shows as grey instead of blue in Offline areas now:\n\nBefore:\n\nIdeal would be as in the expanded feature sheet:\n\nIf it's not easy to fix, this is really a P3 UI tweak that can be punted.", "author": "gino-m", "createdAt": "2020-05-24T17:07:49Z", "path": "gnd/src/main/res/layout/offline_areas_frag.xml", "diffHunk": "@@ -20,56 +20,51 @@\n   xmlns:app=\"http://schemas.android.com/apk/res-auto\">\n \n   <data>\n-\n     <variable\n       name=\"viewModel\"\n       type=\"com.google.android.gnd.ui.offlinearea.OfflineAreasViewModel\" />\n   </data>\n \n-  <LinearLayout\n+  <androidx.constraintlayout.widget.ConstraintLayout\n     android:layout_width=\"match_parent\"\n     android:layout_height=\"match_parent\"\n-    android:orientation=\"vertical\">\n+    android:fitsSystemWindows=\"true\">", "originalCommit": "d87d30e941b62b447a63d4d102035930691e7317", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY3MDExMw==", "url": "https://github.com/google/ground-android/pull/477#discussion_r429670113", "bodyText": "It was like that because of hardcoded padding. After fixing that, it is showing the same status bar scrim as the home screen.\nTo fix it system-wide, I am thinking about using colors (with alpha value) in the status_bar_scrim of MainActivity. It would be the dark shade of the toolbar. (In a separate PR)", "author": "shobhitagarwal1612", "createdAt": "2020-05-24T20:00:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NjE4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ2NTg2Mg==", "url": "https://github.com/google/ground-android/pull/477#discussion_r431465862", "bodyText": "Great, I think that's sufficient. Thanks for the fix!", "author": "gino-m", "createdAt": "2020-05-27T21:56:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTY1NjE4Mw=="}], "type": "inlineReview"}, {"oid": "7e91cd7896c996f3dbeeaa675c2d13a455512a83", "url": "https://github.com/google/ground-android/commit/7e91cd7896c996f3dbeeaa675c2d13a455512a83", "message": "Merge branch 'master' into issue-476", "committedDate": "2020-05-24T19:50:50Z", "type": "commit"}, {"oid": "db1dad1f6fd2945aeff2d6ee5fcce3d484fa5c69", "url": "https://github.com/google/ground-android/commit/db1dad1f6fd2945aeff2d6ee5fcce3d484fa5c69", "message": "Update comment", "committedDate": "2020-05-24T20:06:35Z", "type": "commit"}, {"oid": "3040999c52daea85d89a0eeb8ad10c4ac9359726", "url": "https://github.com/google/ground-android/commit/3040999c52daea85d89a0eeb8ad10c4ac9359726", "message": "Merge branch 'master' into issue-476\n\n# Conflicts:\n#\tgnd/src/main/res/layout/home_screen_frag.xml\n#\tgnd/src/main/res/layout/offline_areas_frag.xml", "committedDate": "2020-05-26T20:15:02Z", "type": "commit"}, {"oid": "b99decc9379e05e0ab611dbdd133d13d5bfca91d", "url": "https://github.com/google/ground-android/commit/b99decc9379e05e0ab611dbdd133d13d5bfca91d", "message": "Merge branch 'master' into issue-476\n\n# Conflicts:\n#\tgnd/src/main/java/com/google/android/gnd/MainActivity.java", "committedDate": "2020-05-28T06:20:21Z", "type": "commit"}, {"oid": "ef0b936ce425fb0f8b9ff946f5300c11ed46f9d9", "url": "https://github.com/google/ground-android/commit/ef0b936ce425fb0f8b9ff946f5300c11ed46f9d9", "message": "Fix settings activity", "committedDate": "2020-05-28T06:49:21Z", "type": "commit"}, {"oid": "e337d54e9c7bfbc87c5878cf348438bd395bc045", "url": "https://github.com/google/ground-android/commit/e337d54e9c7bfbc87c5878cf348438bd395bc045", "message": "Add status bar scrim to settings activity", "committedDate": "2020-05-28T07:22:31Z", "type": "commit"}, {"oid": "41601854defd437a5634f6dbb23d3c82c714ecfa", "url": "https://github.com/google/ground-android/commit/41601854defd437a5634f6dbb23d3c82c714ecfa", "message": "Convert to local variable", "committedDate": "2020-05-28T08:42:35Z", "type": "commit"}]}