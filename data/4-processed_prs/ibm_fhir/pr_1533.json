{"pr_number": 1533, "pr_title": "doc: fhir operation framework", "pr_createdAt": "2020-09-29T18:30:25Z", "pr_url": "https://github.com/IBM/FHIR/pull/1533", "timeline": [{"oid": "eb4b962610925dc52ec3810e36e07aaee6c88015", "url": "https://github.com/IBM/FHIR/commit/eb4b962610925dc52ec3810e36e07aaee6c88015", "message": "doc: fhir operation framework\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-29T18:29:24Z", "type": "commit"}, {"oid": "ca671e9facd92090bdbee9713297054f14e12d6e", "url": "https://github.com/IBM/FHIR/commit/ca671e9facd92090bdbee9713297054f14e12d6e", "message": "doc: fhir operation framework single response parameter\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-29T18:38:26Z", "type": "commit"}, {"oid": "806da23b055f01a27b1cf22bc4a21398cfa68fb4", "url": "https://github.com/IBM/FHIR/commit/806da23b055f01a27b1cf22bc4a21398cfa68fb4", "message": "Update FHIROperationFramework.md\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-30T19:58:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY3ODQzNg==", "url": "https://github.com/IBM/FHIR/pull/1533#discussion_r499678436", "bodyText": "I noticed the spec itself calls this \"lightweight\" but IMHO we should remove such value statements from the technical docs (similar to avoiding terms like \"simply do X\" or \"merely do Y\").", "author": "lmsurpre", "createdAt": "2020-10-05T15:19:10Z", "path": "docs/src/pages/guides/FHIROperationFramework.md", "diffHunk": "@@ -0,0 +1,348 @@\n+---\n+layout: default\n+title: IBM FHIR Server - Extended Operations Framework\n+date:  2020-09-29\n+---\n+\n+# IBM FHIR Server - Extended Operations Framework\n+\n+The HL7 FHIR Specification describes a [light weight framework](https://www.hl7.org/fhir/r4/operations.html) of extended operations for the REST API.", "originalCommit": "806da23b055f01a27b1cf22bc4a21398cfa68fb4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY5MjY5Ng==", "url": "https://github.com/IBM/FHIR/pull/1533#discussion_r499692696", "bodyText": "sure", "author": "prb112", "createdAt": "2020-10-05T15:39:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY3ODQzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY4MDIyMw==", "url": "https://github.com/IBM/FHIR/pull/1533#discussion_r499680223", "bodyText": "wondering if these should have our default base path in there.  e.g. https://my-server.com/fhir-server/api/v4", "author": "lmsurpre", "createdAt": "2020-10-05T15:21:40Z", "path": "docs/src/pages/guides/FHIROperationFramework.md", "diffHunk": "@@ -0,0 +1,348 @@\n+---\n+layout: default\n+title: IBM FHIR Server - Extended Operations Framework\n+date:  2020-09-29\n+---\n+\n+# IBM FHIR Server - Extended Operations Framework\n+\n+The HL7 FHIR Specification describes a [light weight framework](https://www.hl7.org/fhir/r4/operations.html) of extended operations for the REST API.\n+\n+This framework defines REST endpoints at the Base Server (System), scoped to specific resources (Type) and scoped to specific instances. \n+- **System** - https://my-server.com/v4/$convert - Convert from one format to another\n+- **Type** - https://my-server.com/v4/Patient/$export - Retrieve all the data from the Patient compartment\n+- **Instance** - https://my-server.com/v4/Patient/1-2-3-4/$export - Retrieve a specific Patient data from the Patient compartment data", "originalCommit": "806da23b055f01a27b1cf22bc4a21398cfa68fb4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY4MTEyMQ==", "url": "https://github.com/IBM/FHIR/pull/1533#discussion_r499681121", "bodyText": "as -> is ?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Each Operation per [the specification](https://www.hl7.org/fhir/r4/operations.html#defining) as an [OperationDefinition](https://www.hl7.org/fhir/r4/operationdefinition.html) Resource.\n          \n          \n            \n            Each Operation per [the specification](https://www.hl7.org/fhir/r4/operations.html#defining) is an [OperationDefinition](https://www.hl7.org/fhir/r4/operationdefinition.html) Resource.\n          \n      \n    \n    \n  \n\nor could be more verbose and say \"is defined by\"", "author": "lmsurpre", "createdAt": "2020-10-05T15:22:59Z", "path": "docs/src/pages/guides/FHIROperationFramework.md", "diffHunk": "@@ -0,0 +1,348 @@\n+---\n+layout: default\n+title: IBM FHIR Server - Extended Operations Framework\n+date:  2020-09-29\n+---\n+\n+# IBM FHIR Server - Extended Operations Framework\n+\n+The HL7 FHIR Specification describes a [light weight framework](https://www.hl7.org/fhir/r4/operations.html) of extended operations for the REST API.\n+\n+This framework defines REST endpoints at the Base Server (System), scoped to specific resources (Type) and scoped to specific instances. \n+- **System** - https://my-server.com/v4/$convert - Convert from one format to another\n+- **Type** - https://my-server.com/v4/Patient/$export - Retrieve all the data from the Patient compartment\n+- **Instance** - https://my-server.com/v4/Patient/1-2-3-4/$export - Retrieve a specific Patient data from the Patient compartment data\n+\n+A list of operations supported by the IBM FHIR Server is listed at https://ibm.github.io/FHIR/Conformance/#extended-operations\n+\n+## Calling an Operation\n+There are two types of operation invocation requests: \n+- Complex (via POST)\n+  - All operations can be invoked by passing a Parameters resource instance in the body of the request.\n+  - For operations with no input parameters, no body is required.\n+  - For operations with a single input parameter named \u201cresource\u201d, the Parameters wrapper can be omitted.\n+- Simple (via GET)\n+  - Only simple input parameters (i.e. no complex datatypes like \u2018Identifier\u2019 or \u2018Reference\u2019), operations can be invoked via HTTP GET by passing the parameters in the URL.\n+\n+### Example: Complex\n+\n+*Request*\n+\n+``` sh\n+curl --location --request POST 'https://localhost:9443/fhir-server/api/v4/Patient/$validate' \\\n+--header 'Authorization: Basic CHANGEME' \\\n+--header 'Content-Type: application/json' \\\n+--data-raw '{\n+ \"resourceType\": \"Parameters\",\n+ \"parameter\": [\n+  {\n+   \"name\": \"resource\",\n+   \"resource\": {\n+    \"resourceType\": \"Patient\",\n+    \"id\": \"example\",\n+    \"name\": [\n+     {\n+      \"use\": \"official\",\n+      \"family\": \"Chalmers\",\n+      \"given\": [\n+       \"Peter\",\n+       \"James\"\n+      ]\n+     }\n+    ]\n+   }\n+  }\n+ ],\n+ \"meta\": {\n+  \"tag\": [\n+   {\n+    \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActReason\",\n+    \"code\": \"HTEST\",\n+    \"display\": \"test health data\"\n+   }\n+  ]\n+ }\n+}'\n+```\n+\n+*Response*\n+``` json\n+{\n+  \"resourceType\": \"OperationOutcome\",\n+  \"id\": \"NoError\",\n+  \"text\": {\n+    \"status\": \"additional\",\n+    \"div\": \"<div xmlns=\\\"http://www.w3.org/1999/xhtml\\\"><p>No error</p></div>\"\n+  },\n+  \"issue\": [\n+    {\n+      \"severity\": \"warning\",\n+      \"code\": \"invariant\",\n+      \"details\": {\n+        \"text\": \"dom-6: A resource should have narrative for robust management\"\n+      },\n+      \"expression\": [\n+        \"Patient\"\n+      ]\n+    }\n+  ]\n+}\n+```\n+\n+### Example: Simple\n+\n+*Request*\n+``` sh \n+curl --location --request GET 'https://localhost:9443/fhir-server/api/v4/$healthcheck' \\\n+--header 'Authorization: Basic CHANGEME' \\\n+--header 'Content-Type: application/json'\n+```\n+\n+*Response* \n+``` json \n+{\n+  \"resourceType\": \"OperationOutcome\",\n+  \"issue\": [\n+    {\n+      \"severity\": \"information\",\n+      \"code\": \"informational\",\n+      \"details\": {\n+        \"text\": \"All OK\"\n+      }\n+    }\n+  ]\n+}\n+```\n+\n+## Inspecting a FHIR Server\u2019s Capability Statement (Operations)\n+Each FHIR server is expected to have a Capability Statement outlining the System, Type and Instance operations, and advertising them via the metadata endpoint. \n+\n+To check the Type and Instance operations, you can check using this curl/jq command. \n+\n+`curl -k --location --request GET 'https://localhost:9443/fhir-server/api/v4/metadata' | jq -r '.rest[].resource[].operation[].name' | sort -u`\n+\n+```\n+apply\n+closure\n+convert\n+document\n+expand\n+export\n+lookup\n+subsumes\n+translate\n+validate\n+validate-code\n+```\n+\n+To check the System Level operations, you can check using this curl/jq command. \n+\n+`curl -k --location --request GET 'https://localhost:9443/fhir-server/api/v4/metadata' | jq -r '.rest[].operation[].name'`\n+\n+``` \n+bulkdata-status\n+closure\n+convert\n+export\n+healthcheck\n+hello\n+import\n+```\n+\n+# The Specification in More Detail \n+\n+Each Operation per [the specification](https://www.hl7.org/fhir/r4/operations.html#defining) as an [OperationDefinition](https://www.hl7.org/fhir/r4/operationdefinition.html) Resource.", "originalCommit": "806da23b055f01a27b1cf22bc4a21398cfa68fb4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY4MTg3MA==", "url": "https://github.com/IBM/FHIR/pull/1533#discussion_r499681870", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              - The *code* is used in the CapabilitiesStatement.\n          \n          \n            \n              - The *code* is used in the CapabilityStatement.", "author": "lmsurpre", "createdAt": "2020-10-05T15:24:04Z", "path": "docs/src/pages/guides/FHIROperationFramework.md", "diffHunk": "@@ -0,0 +1,348 @@\n+---\n+layout: default\n+title: IBM FHIR Server - Extended Operations Framework\n+date:  2020-09-29\n+---\n+\n+# IBM FHIR Server - Extended Operations Framework\n+\n+The HL7 FHIR Specification describes a [light weight framework](https://www.hl7.org/fhir/r4/operations.html) of extended operations for the REST API.\n+\n+This framework defines REST endpoints at the Base Server (System), scoped to specific resources (Type) and scoped to specific instances. \n+- **System** - https://my-server.com/v4/$convert - Convert from one format to another\n+- **Type** - https://my-server.com/v4/Patient/$export - Retrieve all the data from the Patient compartment\n+- **Instance** - https://my-server.com/v4/Patient/1-2-3-4/$export - Retrieve a specific Patient data from the Patient compartment data\n+\n+A list of operations supported by the IBM FHIR Server is listed at https://ibm.github.io/FHIR/Conformance/#extended-operations\n+\n+## Calling an Operation\n+There are two types of operation invocation requests: \n+- Complex (via POST)\n+  - All operations can be invoked by passing a Parameters resource instance in the body of the request.\n+  - For operations with no input parameters, no body is required.\n+  - For operations with a single input parameter named \u201cresource\u201d, the Parameters wrapper can be omitted.\n+- Simple (via GET)\n+  - Only simple input parameters (i.e. no complex datatypes like \u2018Identifier\u2019 or \u2018Reference\u2019), operations can be invoked via HTTP GET by passing the parameters in the URL.\n+\n+### Example: Complex\n+\n+*Request*\n+\n+``` sh\n+curl --location --request POST 'https://localhost:9443/fhir-server/api/v4/Patient/$validate' \\\n+--header 'Authorization: Basic CHANGEME' \\\n+--header 'Content-Type: application/json' \\\n+--data-raw '{\n+ \"resourceType\": \"Parameters\",\n+ \"parameter\": [\n+  {\n+   \"name\": \"resource\",\n+   \"resource\": {\n+    \"resourceType\": \"Patient\",\n+    \"id\": \"example\",\n+    \"name\": [\n+     {\n+      \"use\": \"official\",\n+      \"family\": \"Chalmers\",\n+      \"given\": [\n+       \"Peter\",\n+       \"James\"\n+      ]\n+     }\n+    ]\n+   }\n+  }\n+ ],\n+ \"meta\": {\n+  \"tag\": [\n+   {\n+    \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActReason\",\n+    \"code\": \"HTEST\",\n+    \"display\": \"test health data\"\n+   }\n+  ]\n+ }\n+}'\n+```\n+\n+*Response*\n+``` json\n+{\n+  \"resourceType\": \"OperationOutcome\",\n+  \"id\": \"NoError\",\n+  \"text\": {\n+    \"status\": \"additional\",\n+    \"div\": \"<div xmlns=\\\"http://www.w3.org/1999/xhtml\\\"><p>No error</p></div>\"\n+  },\n+  \"issue\": [\n+    {\n+      \"severity\": \"warning\",\n+      \"code\": \"invariant\",\n+      \"details\": {\n+        \"text\": \"dom-6: A resource should have narrative for robust management\"\n+      },\n+      \"expression\": [\n+        \"Patient\"\n+      ]\n+    }\n+  ]\n+}\n+```\n+\n+### Example: Simple\n+\n+*Request*\n+``` sh \n+curl --location --request GET 'https://localhost:9443/fhir-server/api/v4/$healthcheck' \\\n+--header 'Authorization: Basic CHANGEME' \\\n+--header 'Content-Type: application/json'\n+```\n+\n+*Response* \n+``` json \n+{\n+  \"resourceType\": \"OperationOutcome\",\n+  \"issue\": [\n+    {\n+      \"severity\": \"information\",\n+      \"code\": \"informational\",\n+      \"details\": {\n+        \"text\": \"All OK\"\n+      }\n+    }\n+  ]\n+}\n+```\n+\n+## Inspecting a FHIR Server\u2019s Capability Statement (Operations)\n+Each FHIR server is expected to have a Capability Statement outlining the System, Type and Instance operations, and advertising them via the metadata endpoint. \n+\n+To check the Type and Instance operations, you can check using this curl/jq command. \n+\n+`curl -k --location --request GET 'https://localhost:9443/fhir-server/api/v4/metadata' | jq -r '.rest[].resource[].operation[].name' | sort -u`\n+\n+```\n+apply\n+closure\n+convert\n+document\n+expand\n+export\n+lookup\n+subsumes\n+translate\n+validate\n+validate-code\n+```\n+\n+To check the System Level operations, you can check using this curl/jq command. \n+\n+`curl -k --location --request GET 'https://localhost:9443/fhir-server/api/v4/metadata' | jq -r '.rest[].operation[].name'`\n+\n+``` \n+bulkdata-status\n+closure\n+convert\n+export\n+healthcheck\n+hello\n+import\n+```\n+\n+# The Specification in More Detail \n+\n+Each Operation per [the specification](https://www.hl7.org/fhir/r4/operations.html#defining) as an [OperationDefinition](https://www.hl7.org/fhir/r4/operationdefinition.html) Resource.\n+\n+The elements needed are: \n+- Unique Name of the Operation - `OperationDefinition.name`\n+  - For instance, `\"name\": \"import\"`\n+- Code used to activate the Operation - `OperationDefinition.code`\n+  - For instance, `\"code\": \"import\"`\n+  - The *code* is used in the CapabilitiesStatement.", "originalCommit": "806da23b055f01a27b1cf22bc4a21398cfa68fb4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "127f83f108e6bac54543c5bc53e860403a8ecab9", "url": "https://github.com/IBM/FHIR/commit/127f83f108e6bac54543c5bc53e860403a8ecab9", "message": "Update docs/src/pages/guides/FHIROperationFramework.md\r\n\r\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>\n\nCo-authored-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-10-05T15:35:17Z", "type": "commit"}, {"oid": "faf3b30b2ad728498a35c5b1705ec19ea82b6845", "url": "https://github.com/IBM/FHIR/commit/faf3b30b2ad728498a35c5b1705ec19ea82b6845", "message": "Update docs/src/pages/guides/FHIROperationFramework.md\r\n\r\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>\n\nCo-authored-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-10-05T15:35:25Z", "type": "commit"}, {"oid": "aa8e55a8702d4c54624ed8ec2547064434545078", "url": "https://github.com/IBM/FHIR/commit/aa8e55a8702d4c54624ed8ec2547064434545078", "message": "fix: code review pointed out some optimal phrasing and fixes\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-10-05T15:40:03Z", "type": "commit"}]}