{"pr_number": 1556, "pr_title": "issue #1315 - instantiates field represents the registered capabilities", "pr_createdAt": "2020-10-05T14:54:23Z", "pr_url": "https://github.com/IBM/FHIR/pull/1556", "timeline": [{"oid": "f47f16f170b0d9d73faafca2e00e50703730c082", "url": "https://github.com/IBM/FHIR/commit/f47f16f170b0d9d73faafca2e00e50703730c082", "message": "#issue 1315 - instantiates field represents the registered capabilities\n\nSigned-off-by: Troy Biesterfeld <tbieste@us.ibm.com>", "committedDate": "2020-10-05T14:56:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2NTYxMg==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499665612", "bodyText": "let's keep the prior format for readability", "author": "prb112", "createdAt": "2020-10-05T15:01:08Z", "path": "fhir-server/src/main/java/com/ibm/fhir/server/resources/Capabilities.java", "diffHunk": "@@ -266,25 +258,14 @@ private CapabilityStatement buildCapabilityStatement() throws Exception {\n             log.log(Level.WARNING, \"Unexpected error while reading server transaction mode setting\", t);\n         }\n \n-        CapabilityStatement.Rest.Security.Builder securityBuilder = CapabilityStatement.Rest.Security.builder()\n-                .cors(com.ibm.fhir.model.type.Boolean.of(fhirConfig.getBooleanProperty(FHIRConfiguration.PROPERTY_SECURITY_CORS, true)));\n-\n+        CapabilityStatement.Rest.Security.Builder securityBuilder =\n+                CapabilityStatement.Rest.Security.builder().cors(com.ibm.fhir.model.type.Boolean.of(fhirConfig.getBooleanProperty(FHIRConfiguration.PROPERTY_SECURITY_CORS, true)));\n \n         if (fhirConfig.getBooleanProperty(FHIRConfiguration.PROPERTY_SECURITY_BASIC_ENABLED, false)) {\n-            securityBuilder.service(CodeableConcept.builder()\n-                .coding(Coding.builder()\n-                    .code(Code.of(\"Basic\"))\n-                    .system(Uri.of(\"http://terminology.hl7.org/CodeSystem/restful-security-service\"))\n-                    .build())\n-                .build());\n+            securityBuilder.service(CodeableConcept.builder().coding(Coding.builder().code(Code.of(\"Basic\")).system(Uri.of(\"http://terminology.hl7.org/CodeSystem/restful-security-service\")).build()).build());\n         }\n         if (fhirConfig.getBooleanProperty(FHIRConfiguration.PROPERTY_SECURITY_CERT_ENABLED, false)) {\n-            securityBuilder.service(CodeableConcept.builder()\n-                .coding(Coding.builder()\n-                    .code(Code.of(\"Certificates\"))\n-                    .system(Uri.of(\"http://terminology.hl7.org/CodeSystem/restful-security-service\"))\n-                    .build())\n-                .build());\n+            securityBuilder.service(CodeableConcept.builder().coding(Coding.builder().code(Code.of(\"Certificates\")).system(Uri.of(\"http://terminology.hl7.org/CodeSystem/restful-security-service\")).build()).build());", "originalCommit": "f47f16f170b0d9d73faafca2e00e50703730c082", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY4MTA4Mg==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499681082", "bodyText": "Fixed.", "author": "tbieste", "createdAt": "2020-10-05T15:22:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2NTYxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2Nzg0OA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499667848", "bodyText": "Note, we also support import, which is not listed here, and we've jammed into the capability statement.", "author": "prb112", "createdAt": "2020-10-05T15:04:17Z", "path": "operation/fhir-operation-bulkdata/src/main/resources/hl7/fhir/uv/bulkdata/package/CapabilityStatement-bulk-data.json", "diffHunk": "@@ -0,0 +1 @@\n+{\"resourceType\":\"CapabilityStatement\",\"id\":\"bulk-data\",\"text\":{\"status\":\"generated\",\"div\":\"<div xmlns=\\\"http://www.w3.org/1999/xhtml\\\"><h2>BulkDataIGCapabilityStatement</h2><div><p>This Section describes the expected capabilities of a FHIR Bulk Data Server actor which is responsible for providing responses to the queries submitted by the FHIR Bulk Data Requestors. The complete list of FHIR profiles, RESTful operations, and search parameters supported by FHIR Bulk Data Servers are defined. Systems implementing this capability statement should meet the requirements set by the <a href=\\\"https://fhir.org/ig/HL7/bulk-data/\\\">Bulk Data Implementation Guide</a>. FHIR Bulk Data Clients have the option of choosing from this list to access necessary data based on their local use cases and other contextual requirements.</p>\\n</div><table><tr><td>Mode</td><td>SERVER</td></tr><tr><td>Description</td><td>The Bulk Data (Flat FHIR) Server **SHOULD**:\\n\\n1. Export data from a FHIR server whether or not it is associated with a patient. This supports use cases like backing up a server or exporting terminology data by restricting the resources returned using the _type parameter.\\n1. Obtain data on all patients listed in a single FHIR Group Resource. If a FHIR server supports Group-level data export, it SHOULD support reading and searching for Group resource. This enables clients to discover available groups based on stable characteristics such as Group.identifier. Note: How these groups are defined is implementation specific for each FHIR system. For example, a payer may send a healthcare institution a roster file that can be imported into their EHR to create or update a FHIR group. Group membership could be based upon explicit attributes of the patient, such as: age, sex or a particular condition such as PTSD or Chronic Opioid use, or on more complex attributes, such as a recent inpatient discharge or membership in the population used to calculate a quality measure. FHIR-based group management is out of scope for the current version of this implementation guide.\\n1. Export data from a FHIR server for all data associated with patients. This supports use cases like transmitting all data about patients or clinical care between systems.</td></tr><tr><td>Transaction</td><td></td></tr><tr><td>System History</td><td></td></tr><tr><td>System Search</td><td></td></tr></table><table><tr><th><b>Resource Type</b></th><th><b>Profile</b></th><th><b title=\\\"GET a resource (read interaction)\\\">Read</b></th><th><b title=\\\"GET all set of resources of the type (search interaction)\\\">Search</b></th><th><b title=\\\"PUT a new resource version (update interaction)\\\">Update</b></th><th><b title=\\\"POST a new resource (create interaction)\\\">Create</b></th></tr></table></div>\"},\"url\":\"http://hl7.org/fhir/uv/bulkdata/CapabilityStatement/bulk-data\",\"version\":\"1.0.0\",\"name\":\"BulkDataIGCapabilityStatement\",\"title\":\"FHIR Bulk Data Export (Flat FHIR) Implementation Guide CapabilityStatement\",\"status\":\"active\",\"experimental\":false,\"date\":\"2019-06-04T10:00:00+10:00\",\"publisher\":\"SMART Health IT\",\"contact\":[{\"name\":\"Ricky Sahu\",\"telecom\":[{\"system\":\"email\",\"value\":\"ricky@1up.health\"}]},{\"name\":\"Dan Gottlieb\",\"telecom\":[{\"system\":\"email\",\"value\":\"daniel.gottlieb@childrens.harvard.edu\"}]},{\"name\":\"Josh Mandel\",\"telecom\":[{\"system\":\"email\",\"value\":\"joshua.mandel@childrens.harvard.edu\"}]},{\"name\":\"Vlad Ignatov\",\"telecom\":[{\"system\":\"email\",\"value\":\"Vladimir.Ignatov@childrens.harvard.edu\"}]}],\"description\":\"This Section describes the expected capabilities of a FHIR Bulk Data Server actor which is responsible for providing responses to the queries submitted by the FHIR Bulk Data Requestors. The complete list of FHIR profiles, RESTful operations, and search parameters supported by FHIR Bulk Data Servers are defined. Systems implementing this capability statement should meet the requirements set by the [Bulk Data Implementation Guide](https://fhir.org/ig/HL7/bulk-data/). FHIR Bulk Data Clients have the option of choosing from this list to access necessary data based on their local use cases and other contextual requirements.\",\"jurisdiction\":[{\"coding\":[{\"system\":\"http://unstats.un.org/unsd/methods/m49/m49.htm\",\"code\":\"001\",\"display\":\"World\"}]}],\"kind\":\"requirements\",\"fhirVersion\":\"4.0.0\",\"format\":[\"json\"],\"patchFormat\":[\"application/json-patch+json\"],\"implementationGuide\":[\"http://hl7.org/fhir/uv/bulkdata/ImplementationGuide/ig\"],\"rest\":[{\"mode\":\"server\",\"documentation\":\"The Bulk Data (Flat FHIR) Server **SHOULD**:\\n\\n1. Export data from a FHIR server whether or not it is associated with a patient. This supports use cases like backing up a server or exporting terminology data by restricting the resources returned using the _type parameter.\\n1. Obtain data on all patients listed in a single FHIR Group Resource. If a FHIR server supports Group-level data export, it SHOULD support reading and searching for Group resource. This enables clients to discover available groups based on stable characteristics such as Group.identifier. Note: How these groups are defined is implementation specific for each FHIR system. For example, a payer may send a healthcare institution a roster file that can be imported into their EHR to create or update a FHIR group. Group membership could be based upon explicit attributes of the patient, such as: age, sex or a particular condition such as PTSD or Chronic Opioid use, or on more complex attributes, such as a recent inpatient discharge or membership in the population used to calculate a quality measure. FHIR-based group management is out of scope for the current version of this implementation guide.\\n1. Export data from a FHIR server for all data associated with patients. This supports use cases like transmitting all data about patients or clinical care between systems.\",\"security\":{\"description\":\"1. See the [Authorization Guide](authorization/index.html) section for requirements and recommendations.\\n1. This specification describes requirements for requesting an access token\\n        through the use of an OAuth 2.0 client credentials flow, with a [JWT\\n        assertion](https://tools.ietf.org/html/rfc7523) as the\\n        client's authentication mechanism.\"},\"operation\":[{\"extension\":[{\"url\":\"http://hl7.org/fhir/StructureDefinition/capabilitystatement-expectation\",\"valueCode\":\"SHOULD\"}],\"name\":\"export\",\"definition\":\"OperationDefinition/BulkDataExport\"},{\"extension\":[{\"url\":\"http://hl7.org/fhir/StructureDefinition/capabilitystatement-expectation\",\"valueCode\":\"SHOULD\"}],\"name\":\"patient-export\",\"definition\":\"OperationDefinition/PatientLevelExport\"},{\"extension\":[{\"url\":\"http://hl7.org/fhir/StructureDefinition/capabilitystatement-expectation\",\"valueCode\":\"SHOULD\"}],\"name\":\"group-export\",\"definition\":\"OperationDefinition/GroupLevelExport\"}]}]}", "originalCommit": "f47f16f170b0d9d73faafca2e00e50703730c082", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY4MjU0NQ==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499682545", "bodyText": "Are you suggesting an update to the capability statement?  Only its URL is externalized via the metadata operation.", "author": "tbieste", "createdAt": "2020-10-05T15:25:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2Nzg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4NDk2MQ==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499784961", "bodyText": "I'm just warning that we have one more operation in case we need to create a custom capability statement for this case.", "author": "prb112", "createdAt": "2020-10-05T18:17:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2Nzg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc4ODQxOA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499788418", "bodyText": "I think $import is at the System level and Bulk Status is at the System Level, I think this doesn'timpact it.  Right?", "author": "prb112", "createdAt": "2020-10-05T18:24:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2Nzg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgzNjQyNA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499836424", "bodyText": "Right, the bulkdata Capability Statement only mentions export.  Import is additional functionality not mentioned by the bulkdata Capability Statement.", "author": "tbieste", "createdAt": "2020-10-05T19:55:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2Nzg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgzOTYyOQ==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499839629", "bodyText": "Right - to clarify, I'm just making sure that it is still listed in the metadata", "author": "prb112", "createdAt": "2020-10-05T20:01:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2Nzg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg0MzEyOA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499843128", "bodyText": "Yes, this does not change the values returned in the CapabilityStatement.rest.operation field, which is where the import operation is described.", "author": "tbieste", "createdAt": "2020-10-05T20:08:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2Nzg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg1MjUwNA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r499852504", "bodyText": "great \ud83d\udc4d", "author": "prb112", "createdAt": "2020-10-05T20:26:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY2Nzg0OA=="}], "type": "inlineReview"}, {"oid": "66c020aeae99ac1d5b05182d36999a62d6b27ea5", "url": "https://github.com/IBM/FHIR/commit/66c020aeae99ac1d5b05182d36999a62d6b27ea5", "message": "#issue 1315 - instantiates field represents the registered capabilities\n\nSigned-off-by: Troy Biesterfeld <tbieste@us.ibm.com>", "committedDate": "2020-10-05T15:18:22Z", "type": "forcePushed"}, {"oid": "17ed7314cd79d966273abe2f5bcfff14f32c0140", "url": "https://github.com/IBM/FHIR/commit/17ed7314cd79d966273abe2f5bcfff14f32c0140", "message": "issue #1315 - instantiates field represents the registered capabilities\n\nSigned-off-by: Troy Biesterfeld <tbieste@us.ibm.com>", "committedDate": "2020-10-05T15:31:31Z", "type": "forcePushed"}, {"oid": "90874ba27f8969296c82041d7658acc6107f8732", "url": "https://github.com/IBM/FHIR/commit/90874ba27f8969296c82041d7658acc6107f8732", "message": "issue #1315 - instantiates field represents the registered capabilities\n\nSigned-off-by: Troy Biesterfeld <tbieste@us.ibm.com>", "committedDate": "2020-10-06T15:45:56Z", "type": "commit"}, {"oid": "bce40161653ee1073ee876da87d830ad1ce2b10f", "url": "https://github.com/IBM/FHIR/commit/bce40161653ee1073ee876da87d830ad1ce2b10f", "message": "issue #1315 - Update bulkdata to version 1.0.1\n\nSigned-off-by: Troy Biesterfeld <tbieste@us.ibm.com>", "committedDate": "2020-10-06T16:42:07Z", "type": "commit"}, {"oid": "bce40161653ee1073ee876da87d830ad1ce2b10f", "url": "https://github.com/IBM/FHIR/commit/bce40161653ee1073ee876da87d830ad1ce2b10f", "message": "issue #1315 - Update bulkdata to version 1.0.1\n\nSigned-off-by: Troy Biesterfeld <tbieste@us.ibm.com>", "committedDate": "2020-10-06T16:42:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTM5Nw==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r500695397", "bodyText": "what are these for?", "author": "lmsurpre", "createdAt": "2020-10-07T02:07:11Z", "path": "fhir-server/src/main/java/com/ibm/fhir/server/resources/Capabilities.java", "diffHunk": "@@ -91,6 +92,8 @@\n     private static final String FHIR_SERVER_NAME = \"IBM FHIR Server\";\n     private static final String FHIR_COPYRIGHT = \"(C) Copyright IBM Corporation 2016, 2020\";\n     private static final String EXTENSION_URL = \"http://ibm.com/fhir/extension\";\n+    private static final String BASE_CAPABILITY_URL = \"http://hl7.org/fhir/CapabilityStatement/base\";\n+    private static final String BASE_2_CAPABILITY_URL = \"http://hl7.org/fhir/CapabilityStatement/base2\";", "originalCommit": "bce40161653ee1073ee876da87d830ad1ce2b10f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE1MDE0Mw==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r501150143", "bodyText": "The FHIR registry includes these two capability statements:\n/fhir-registry/src/main/resources/hl7/fhir/core/package/CapabilityStatement-base.json\n/fhir-registry/src/main/resources/hl7/fhir/core/package/CapabilityStatement-base2.json\nSince they seemed related to the base FHIR spec and have experimental = true, I wasn't sure they should be included in \"instantiates\".", "author": "tbieste", "createdAt": "2020-10-07T16:30:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTM5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjA0MjE3Mg==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r502042172", "bodyText": "interesting.  i agree we should exclude them.  i wonder whether they should truly be in the registry at all.\n@JohnTimm thoughts?", "author": "lmsurpre", "createdAt": "2020-10-08T22:14:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTM5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjA0MzUxOA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r502043518", "bodyText": "if we don't here from john by the morning, I think we should just add a comment (either here or where I just suggested it below) and merge this one in time for 4.4.1", "author": "lmsurpre", "createdAt": "2020-10-08T22:18:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTM5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTc3MA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r500695770", "bodyText": "i'm disappointed the removed these from the OperationDefinition.  I think we want to continue supporting these...we might want to add it back in :-(", "author": "lmsurpre", "createdAt": "2020-10-07T02:08:30Z", "path": "operation/fhir-operation-bulkdata/src/main/resources/OperationDefinition-group-export.json", "diffHunk": "@@ -83,14 +83,6 @@\n       \"max\": \"1\",\n       \"documentation\": \"A string of comma-delimited FHIR resource types. Only resources of the specified resource types(s) SHOULD be included in the response. If this parameter is omitted, the server SHOULD return all supported resources within the scope of the client authorization. For non-system-level requests, the Patient Compartment SHOULD be used as a point of reference for recommended resources to be returned as well as other resources outside of the patient compartment that are helpful in interpreting the patient data such as Organization and Practitioner. Resource references MAY be relative URIs with the format <resource type>/<id>, or absolute URIs with the same structure rooted in the base URI for the server from which the export was performed. References will be resolved looking for a resource with the specified type and id within the file set. Note: Implementations MAY limit the resources returned to specific subsets of FHIR, such as those defined in the Argonaut Implementation Guide.\",\n       \"type\": \"string\"\n-    },\n-    {\n-      \"name\": \"_typeFilter\",\n-      \"use\": \"in\",\n-      \"min\": 0,\n-      \"max\": \"1\",\n-      \"documentation\": \"A string of comma-delimited type filters.\",\n-      \"type\": \"string\"", "originalCommit": "bce40161653ee1073ee876da87d830ad1ce2b10f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE1NTM3OA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r501155378", "bodyText": "Adding back in.", "author": "tbieste", "createdAt": "2020-10-07T16:38:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTc3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTgwOA==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r500695808", "bodyText": "i'm disappointed the removed these from the OperationDefinition.  I think we want to continue supporting these...we might want to add it back in :-(", "author": "lmsurpre", "createdAt": "2020-10-07T02:08:37Z", "path": "operation/fhir-operation-bulkdata/src/main/resources/OperationDefinition-patient-export.json", "diffHunk": "@@ -83,14 +83,6 @@\n       \"max\": \"1\",\n       \"documentation\": \"A string of comma-delimited FHIR resource types. Only resources of the specified resource types(s) SHOULD be included in the response. If this parameter is omitted, the server SHOULD return all supported resources within the scope of the client authorization. For non-system-level requests, the Patient Compartment SHOULD be used as a point of reference for recommended resources to be returned as well as other resources outside of the patient compartment that are helpful in interpreting the patient data such as Organization and Practitioner. Resource references MAY be relative URIs with the format <resource type>/<id>, or absolute URIs with the same structure rooted in the base URI for the server from which the export was performed. References will be resolved looking for a resource with the specified type and id within the file set. Note: Implementations MAY limit the resources returned to specific subsets of FHIR, such as those defined in the Argonaut Implementation Guide.\",\n       \"type\": \"string\"\n-    },\n-    {\n-      \"name\": \"_typeFilter\",\n-      \"use\": \"in\",\n-      \"min\": 0,\n-      \"max\": \"1\",\n-      \"documentation\": \"A string of comma-delimited type filters.\",\n-      \"type\": \"string\"", "originalCommit": "bce40161653ee1073ee876da87d830ad1ce2b10f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE1NjU3NQ==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r501156575", "bodyText": "Adding back in.", "author": "tbieste", "createdAt": "2020-10-07T16:40:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTgwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTgzMQ==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r500695831", "bodyText": "i'm disappointed the removed these from the OperationDefinition.  I think we want to continue supporting these...we might want to add it back in :-(", "author": "lmsurpre", "createdAt": "2020-10-07T02:08:43Z", "path": "operation/fhir-operation-bulkdata/src/main/resources/export.json", "diffHunk": "@@ -81,15 +81,6 @@\n       \"max\": \"1\",\n       \"documentation\": \"A string of comma-delimited FHIR resource types. Only resources of the specified resource types(s) SHOULD be included in the response. If this parameter is omitted, the server SHOULD return all supported resources within the scope of the client authorization. Resource references MAY be relative URIs with the format <resource type>/<id>, or absolute URIs with the same structure rooted in the base URI for the server from which the export was performed. References will be resolved looking for a resource with the specified type and id within the file set. Note: Implementations MAY limit the resources returned to specific subsets of FHIR, such as those defined in the Argonaut Implementation Guide.\",\n       \"type\": \"string\"\n-    },\n-    {\n-      \"name\": \"_typeFilter\",\n-      \"use\": \"in\",\n-      \"min\": 0,\n-      \"max\": \"1\",\n-      \"documentation\": \"A string of comma-delimited type filters.\",\n-      \"type\": \"string\"\n-    }    ", "originalCommit": "bce40161653ee1073ee876da87d830ad1ce2b10f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk1NzgxMg==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r500957812", "bodyText": "yes - let's add back in", "author": "prb112", "createdAt": "2020-10-07T12:06:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTgzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE1NzcyNw==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r501157727", "bodyText": "Adding back in.", "author": "tbieste", "createdAt": "2020-10-07T16:41:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY5NTgzMQ=="}], "type": "inlineReview"}, {"oid": "e9b967b498dacae0b448785ba4dd0623a5c3d95d", "url": "https://github.com/IBM/FHIR/commit/e9b967b498dacae0b448785ba4dd0623a5c3d95d", "message": "issue #1315 - Updates after code review\n\nSigned-off-by: Troy Biesterfeld <tbieste@us.ibm.com>", "committedDate": "2020-10-07T16:43:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjA0Mjg0NQ==", "url": "https://github.com/IBM/FHIR/pull/1556#discussion_r502042845", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (url != null && !BASE_CAPABILITY_URL.equals(url) && !BASE_2_CAPABILITY_URL.equals(url)) {\n          \n          \n            \n                            // BASE_CAPABILITY_URL and BASE_2_CAPABILITY_URL come from the core spec and shouldn't be advertised\n          \n          \n            \n                            if (url != null && !BASE_CAPABILITY_URL.equals(url) && !BASE_2_CAPABILITY_URL.equals(url)) {", "author": "lmsurpre", "createdAt": "2020-10-08T22:16:41Z", "path": "fhir-server/src/main/java/com/ibm/fhir/server/resources/Capabilities.java", "diffHunk": "@@ -380,6 +383,32 @@ private CapabilityStatement buildCapabilityStatement() throws Exception {\n         return conformance;\n     }\n \n+    /**\n+     * Builds the list of canonicals for the instantiates field based on the capability statements (except FHIR core)\n+     * found in the FHIR registry.\n+     * \n+     * @return list of canonicals\n+     */\n+    private List<Canonical> buildInstantiates() {\n+        Collection<CapabilityStatement> registeredCapabilities = FHIRRegistry.getInstance().getResources(CapabilityStatement.class);\n+\n+        List<Canonical> instantiates = new ArrayList<>();\n+        for (CapabilityStatement registeredCapability : registeredCapabilities) {\n+            if (registeredCapability != null && registeredCapability.getUrl() != null) {\n+                String url = registeredCapability.getUrl().getValue();\n+                if (url != null && !BASE_CAPABILITY_URL.equals(url) && !BASE_2_CAPABILITY_URL.equals(url)) {", "originalCommit": "e9b967b498dacae0b448785ba4dd0623a5c3d95d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dd0fca48ed17fa356a4d3d4c7976b26e119d00c6", "url": "https://github.com/IBM/FHIR/commit/dd0fca48ed17fa356a4d3d4c7976b26e119d00c6", "message": "Update fhir-server/src/main/java/com/ibm/fhir/server/resources/Capabilities.java\r\n\r\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>\n\nCo-authored-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-10-09T14:16:38Z", "type": "commit"}]}