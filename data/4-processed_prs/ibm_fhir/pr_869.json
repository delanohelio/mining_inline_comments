{"pr_number": 869, "pr_title": "issue #664 #884 conditional delete multiple match support and config for disabling bulk export public access", "pr_createdAt": "2020-03-30T18:30:15Z", "pr_url": "https://github.com/IBM/FHIR/pull/869", "timeline": [{"oid": "c1bc05640eb576b6463ed47c1986b84420ab1b81", "url": "https://github.com/IBM/FHIR/commit/c1bc05640eb576b6463ed47c1986b84420ab1b81", "message": "Merge pull request #868 from IBM/issue-664\n\nIssue 664 - sync with master", "committedDate": "2020-03-30T18:15:14Z", "type": "commit"}, {"oid": "8ec11924798594357a2603d7c09b4135fcd200f9", "url": "https://github.com/IBM/FHIR/commit/8ec11924798594357a2603d7c09b4135fcd200f9", "message": "issue #664 conditional multiple delete support\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>", "committedDate": "2020-03-30T18:28:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ0MjQzMA==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r400442430", "bodyText": "this is the only real change in this file, all the others are just formats like removing empty spaces at the line ends.", "author": "albertwang-ibm", "createdAt": "2020-03-30T19:31:52Z", "path": "fhir-server-test/src/test/java/com/ibm/fhir/server/test/BundleTest.java", "diffHunk": "@@ -2209,8 +2209,7 @@ public void testBatchConditionalDeletes() throws Exception {\n         assertResponseBundle(responseBundle, BundleType.BATCH_RESPONSE, 4);\n         assertGoodGetResponse(responseBundle.getEntry().get(0), Status.OK.getStatusCode(), HTTPReturnPreference.MINIMAL);\n         assertGoodGetResponse(responseBundle.getEntry().get(1), Status.NO_CONTENT.getStatusCode(), HTTPReturnPreference.MINIMAL);\n-        assertBadResponse(responseBundle.getEntry().get(2), Status.PRECONDITION_FAILED.getStatusCode(),\n-                \"returned multiple matches\");\n+        assertGoodGetResponse(responseBundle.getEntry().get(2), Status.NO_CONTENT.getStatusCode(), HTTPReturnPreference.MINIMAL);", "originalCommit": "8ec11924798594357a2603d7c09b4135fcd200f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "27e7f1ab2797531f384a51a5ebe23f5c256848de", "url": "https://github.com/IBM/FHIR/commit/27e7f1ab2797531f384a51a5ebe23f5c256848de", "message": "issue #664 add config for conditional delete\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>", "committedDate": "2020-04-01T13:55:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgxODUwNQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401818505", "bodyText": "should it be a 412 to be more consistent with the fhir spec?", "author": "lmsurpre", "createdAt": "2020-04-01T18:22:18Z", "path": "fhir-server-test/src/test/java/com/ibm/fhir/server/test/BundleTest.java", "diffHunk": "@@ -2209,8 +2209,22 @@ public void testBatchConditionalDeletes() throws Exception {\n         assertResponseBundle(responseBundle, BundleType.BATCH_RESPONSE, 4);\n         assertGoodGetResponse(responseBundle.getEntry().get(0), Status.OK.getStatusCode(), HTTPReturnPreference.MINIMAL);\n         assertGoodGetResponse(responseBundle.getEntry().get(1), Status.NO_CONTENT.getStatusCode(), HTTPReturnPreference.MINIMAL);\n-        assertBadResponse(responseBundle.getEntry().get(2), Status.PRECONDITION_FAILED.getStatusCode(),\n-                \"returned multiple matches\");\n+\n+        // A search that results in multiple matches:\n+        // (1) if matches > FHIRConstants.FHIR_CONDITIONAL_DELETE_MAX_NUMBER_DEFAULT, then result in a 400 status code.", "originalCommit": "27e7f1ab2797531f384a51a5ebe23f5c256848de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMjM1MQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401822351", "bodyText": "Multiple matches: A server may choose to delete all the matching resources, or it may choose to return a 412 Precondition Failed error indicating the client's criteria were not selective enough. A server indicates whether it can delete multiple resources in its Capability Statement (.rest.resource.conditionalDelete)", "author": "lmsurpre", "createdAt": "2020-04-01T18:28:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgxODUwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1MzQ2OQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401953469", "bodyText": "I choose not to use 412 just because I thought 412 means we don't support multiple matches at all. but we does support. anyway, I'm ok to change to use 412 instead.", "author": "albertwang-ibm", "createdAt": "2020-04-01T22:45:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgxODUwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk3NTYyMA==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401975620", "bodyText": "done", "author": "albertwang-ibm", "createdAt": "2020-04-01T23:52:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgxODUwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMjk1Mg==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401822952", "bodyText": "should it be a 412 to be more consistent with the fhir spec?", "author": "lmsurpre", "createdAt": "2020-04-01T18:29:41Z", "path": "fhir-server-test/src/test/java/com/ibm/fhir/server/test/DeleteTest.java", "diffHunk": "@@ -430,17 +435,31 @@ public void testConditionalDeleteResource() throws Exception {\n         } else {\n             assertResponse(response.getResponse(), Response.Status.METHOD_NOT_ALLOWED.getStatusCode());\n         }\n-        \n-        // A search that results in multiple matches should result in a 412 status code.\n+\n+        // A search that results in multiple matches:\n+        // (1) if matches > FHIRConstants.FHIR_CONDITIONAL_DELETE_MAX_NUMBER_DEFAULT, then result in a 400 status code.", "originalCommit": "27e7f1ab2797531f384a51a5ebe23f5c256848de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1MzU5Mg==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401953592", "bodyText": "yes, I'm Ok to change to use 412.", "author": "albertwang-ibm", "createdAt": "2020-04-01T22:45:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMjk1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk3NTY1Mw==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401975653", "bodyText": "done", "author": "albertwang-ibm", "createdAt": "2020-04-01T23:52:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMjk1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMzg0MA==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401823840", "bodyText": "because you use FHIRConfigHelper to look up the value of the config property, I think this means it is both tenant-specific and dynamic\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |`fhirServer/core/conditionalDeleteMaxNumber`|N|N|\n          \n          \n            \n            |`fhirServer/core/conditionalDeleteMaxNumber`|Y|Y|", "author": "lmsurpre", "createdAt": "2020-04-01T18:31:12Z", "path": "docs/src/pages/guides/FHIRServerUsersGuide.md", "diffHunk": "@@ -1420,6 +1422,7 @@ must restart the server for that change to take effect.\n |`fhirServer/core/defaultHandling`|Y|Y|\n |`fhirServer/core/allowClientHandlingPref`|Y|Y|\n |`fhirServer/core/checkReferenceTypes`|N|N|\n+|`fhirServer/core/conditionalDeleteMaxNumber`|N|N|", "originalCommit": "27e7f1ab2797531f384a51a5ebe23f5c256848de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1Mzg1Mg==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401953852", "bodyText": "good catch, actually I was not sure about this.", "author": "albertwang-ibm", "createdAt": "2020-04-01T22:46:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMzg0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk3NTcyNQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401975725", "bodyText": "done", "author": "albertwang-ibm", "createdAt": "2020-04-01T23:52:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMzg0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMzk4NQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401823985", "bodyText": "because you use FHIRConfigHelper to look it up, I think this means it is tenant-specific", "author": "lmsurpre", "createdAt": "2020-04-01T18:31:29Z", "path": "fhir-server/src/main/java/com/ibm/fhir/server/util/FHIRRestHelper.java", "diffHunk": "@@ -499,26 +503,28 @@ public FHIRRestOperationResponse doDelete(String type, String id, String searchQ\n             // resource to be deleted. Otherwise, we'll use the id value to identify the resource\n             // to be deleted.\n             Resource resourceToDelete = null;\n+            Bundle responseBundle = null;\n+\n             if (searchQueryString != null) {\n+                int searchPageSize = FHIRConfigHelper.getIntProperty(FHIRConfiguration.PROPERTY_CONDITIONAL_DELETE_MAX_NUMBER, FHIRConstants.FHIR_CONDITIONAL_DELETE_MAX_NUMBER_DEFAULT);", "originalCommit": "27e7f1ab2797531f384a51a5ebe23f5c256848de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk1OTM5NQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r401959395", "bodyText": "yes, I agree. just was a little bit confused about the document.", "author": "albertwang-ibm", "createdAt": "2020-04-01T23:01:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgyMzk4NQ=="}], "type": "inlineReview"}, {"oid": "4601fb2e8e99fdbf31a5af5cfef637749a579d90", "url": "https://github.com/IBM/FHIR/commit/4601fb2e8e99fdbf31a5af5cfef637749a579d90", "message": "issue #664 updates per review comments\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>", "committedDate": "2020-04-01T23:51:46Z", "type": "commit"}, {"oid": "7ed5b894b0315298eff762129b0e39551be438fd", "url": "https://github.com/IBM/FHIR/commit/7ed5b894b0315298eff762129b0e39551be438fd", "message": "issue #884 add config to disable public access for export\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>", "committedDate": "2020-04-02T01:24:34Z", "type": "commit"}, {"oid": "45c9225519841c2905f62134698740401f1dd613", "url": "https://github.com/IBM/FHIR/commit/45c9225519841c2905f62134698740401f1dd613", "message": "issue #884 minor update\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>", "committedDate": "2020-04-02T01:29:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMjgyOQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402012829", "bodyText": "Is this the part that you mentioned only works on Amazon S3 and not COS?  Or that's something else?", "author": "lmsurpre", "createdAt": "2020-04-02T02:11:33Z", "path": "fhir-bulkimportexport-webapp/src/main/java/com/ibm/fhir/bulkexport/system/ChunkWriter.java", "diffHunk": "@@ -154,11 +158,18 @@ private void pushFhirJsonsToCos(InputStream in, int dataLength) throws Exception\n             if (cosBucketPathPrefix != null && cosBucketPathPrefix.trim().length() > 0) {\n                 itemName = cosBucketPathPrefix + \"/\" + ResourceTypes.get(chunkData.getIndexOfCurrentResourceType())\n                             + \"_\" + chunkData.getPartNum() + \".ndjson\";\n+                if (isExportPublic) {\n+                    // Set expiration time to 2 hours(7200 seconds).\n+                    metadata.setExpirationTime(Date.from(Instant.now().plusSeconds(7200)));", "originalCommit": "45c9225519841c2905f62134698740401f1dd613", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI5NzQxNg==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402297416", "bodyText": "yes, correct. IBM COS doesn't support object level expiration time, it only supports bucket level with policy setting which is well documented in IBM COS document, but IBM COS doesn't complaint if you set it even though it doesn't take effect at all.\nI have moved the codes into a separated if (isExportPublic) to avoid confusing - the old codes worked for S3 without any problem which I verified using my Amazon acount and also verified it didn't work in IBM COS;  I think this is because the meta object was really used only when cosClient.putObject is called later, I moved it just for the purpose of avoiding confusing of why do we change the meta after the request is created with the meta as a parameter.  and still, it works for S3 only.", "author": "albertwang-ibm", "createdAt": "2020-04-02T13:06:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMjgyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMzMDU3Nw==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402330577", "bodyText": "Thanks for the explanation...mind adding a quick comment in the code to indicate that IBM COS doesn't honor this (but also doesn't fail on it)?", "author": "lmsurpre", "createdAt": "2020-04-02T13:53:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMjgyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM1MTM2NA==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402351364", "bodyText": "sure, good point!", "author": "albertwang-ibm", "createdAt": "2020-04-02T14:21:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMjgyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM1OTMzNg==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402359336", "bodyText": "done", "author": "albertwang-ibm", "createdAt": "2020-04-02T14:31:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMjgyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMzE2MA==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402013160", "bodyText": "does \"cos\" cover all S3-compatible object stores or just the IBM Cloud one?", "author": "lmsurpre", "createdAt": "2020-04-02T02:12:49Z", "path": "docs/src/pages/guides/FHIRServerUsersGuide.md", "diffHunk": "@@ -1368,6 +1327,22 @@ This section contains reference information about each of the configuration prop\n |`fhirServer/audit/serviceProperties/geoState`|string|The Geo State configure for CADF audit logging service.|\n |`fhirServer/audit/serviceProperties/geoCounty`|string|The Geo Country configure for CADF audit logging service.|\n |`fhirServer/search/useBoundingRadius`|boolean|True, the bounding area is a Radius, else the bounding area is a box.|\n+|`fhirServer/bulkdata/applicationName`| string|Fixed value, always set to fhir-bulkimportexport-webapp |\n+|`fhirServer/bulkdata/moduleName`|string| Fixed value, always set to fhir-bulkimportexport.war |\n+|`fhirServer/bulkdata/jobParameters/cos.bucket.name`|string|Object store bucket name |\n+|`fhirServer/bulkdata/jobParameters/cos.location`|Object store location |\n+|`fhirServer/bulkdata/jobParameters/cos.endpointurl`| Object store end point url |\n+|`fhirServer/bulkdata/jobParameters/credential.ibm`| If use IBM credential, \"Y\" or \"N\" |\n+|`fhirServer/bulkdata/jobParameters/cos.api.key`|string|API key for accessing IBM COS |\n+|`fhirServer/bulkdata/jobParameters/cos.srvinst.id`|string|Service instance Id for accessing IBM COS |\n+|`fhirServer/bulkdata/implementation_type`|string|\"cos\" or \"dummy\" which matches the desired bulk operation implementation type |", "originalCommit": "45c9225519841c2905f62134698740401f1dd613", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjI5ODgzMQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402298831", "bodyText": "I think the answer is all, let me change the description a little bit.\nIBM COS client SDK is forked from Amazon S3 SDK.", "author": "albertwang-ibm", "createdAt": "2020-04-02T13:08:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMzE2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMwODIwMQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402308201", "bodyText": "done", "author": "albertwang-ibm", "createdAt": "2020-04-02T13:23:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMzE2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMzMzAxNQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402333015", "bodyText": "I think we should say this in the \"description\" column of this row. Something like this:\n\nUse \"cos\" for any S3-compatible object store", "author": "lmsurpre", "createdAt": "2020-04-02T13:56:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMzE2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM1ODA1Ng==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402358056", "bodyText": "en, interesting, seems my change doesn't show up here. I changed to \"  \"cos\" (Any Amazon S3-compatible object stores including IBM COS) or \"dummy\" which matches the desired bulk operation implementation type \".     but I do think your description is better, let me change to it.", "author": "albertwang-ibm", "createdAt": "2020-04-02T14:29:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMzE2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM1OTEzMg==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402359132", "bodyText": "done", "author": "albertwang-ibm", "createdAt": "2020-04-02T14:31:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxMzE2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxNTA5Ng==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402015096", "bodyText": "I agree its best to move these to the reference table in section 5; good call", "author": "lmsurpre", "createdAt": "2020-04-02T02:20:25Z", "path": "docs/src/pages/guides/FHIRServerUsersGuide.md", "diffHunk": "@@ -1143,50 +1143,7 @@ The *fhir-bulkimportexport-webapp* module is a wrapper for the whole BulkData we\n     </webApplication>\n ```\n \n-BulkData web application writes the exported FHIR resources to an IBM Cloud Object Storage (COS) or Amazon S3 bucket, as configured in the per-tenant bulkdata.json configuration file. The bulkdata.json file is stored in the tenant configuration directory of each fhir-server instance. The following is a bulkdata.json which is configured to export the FHIR resources into fhir-bulkdata-sample bucket of IBM COS:\n-\n-```json\n-{\n-  \"applicationName\": \"fhir-bulkimportexport-webapp\",\n-  \"moduleName\": \"fhir-bulkimportexport.war\",\n-  \"jobParameters\": {\n-    \"cos.bucket.name\": \"fhir-bulkdata-sample\",\n-    \"cos.location\": \"us\",\n-    \"cos.endpointurl\": \"https://s3.us-south.cloud-object-storage.appdomain.cloud\",\n-    \"cos.credential.ibm\": \"Y\",\n-    \"cos.api.key\": \"xxxxxxxxxxxxxxxxxxxxxxx\",\n-    \"cos.srvinst.id\": \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\",\n-  },\n-  \"implementation_type\": \"cos\",\n-  \"batch-uri\": \"https://localhost:9443/ibm/api/batch/jobinstances\",\n-  \"batch-user\": \"fhiradmin\",\n-  \"batch-user-password\": \"xxxxxxxxxxxx\",\n-  \"batch-truststore\" : \"resources/security/fhirTruststore.jks\",\n-  \"batch-truststore-password\" : \"xxxxxxxxxxxx\",\n-  \"serverHostname\" : \"localhost:9443\",\n-  \"contextRoot\" : \"/fhir-server/api/v4\"\n-}\n-```\n-The following configured parameters are:\n-\n-|Parameter Name   | Description|\n-|--------------| ------------|\n-|`applicationName`| fixed value, always set to fhir-bulkimportexport-webapp |\n-|`moduleName`| fixed value, always set to fhir-bulkimportexport.war |\n-|`jobParameters.cos.bucket.name`| object store bucket name |\n-|`jobParameters.cos.location`| object store location |\n-|`jobParameters.cos.endpointurl`| object store end point url |\n-|`jobParameters.credential.ibm`| if use IBM credential |\n-|`jobParameters.cos.api.key`| api key for accessing IBM COS |\n-|`jobParameters.cos.srvinst.id`| service instance Id for accessing IBM COS |\n-|`implementation_type`| cos or dummy which matches the desired bulk operation implementation type |\n-|`batch-uri`| the URL to access the FHIR server hosting the batch web application |\n-|`batch-user`| user for submitting JavaBatch job |\n-|`batch-user-password`| password for above batch user |\n-|`batch-truststore`| trust store for JavaBatch job submission |\n-|`batch-truststore-password`| password for above trust store |\n-|`serverHostname`| host name part of the server generated polling location url |\n-|`contextRoot`| context root part of the server generated polling location url |", "originalCommit": "45c9225519841c2905f62134698740401f1dd613", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxNTY0NA==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402015644", "bodyText": "I agree this content is outdated; now the config data exists in fhir-server-config.json instead of a separate bulkdata.json.\nHowever, I think maybe we should leave a sample config here just to illustrate the properties (and refer to section 5 for the full list of properties).", "author": "lmsurpre", "createdAt": "2020-04-02T02:22:50Z", "path": "docs/src/pages/guides/FHIRServerUsersGuide.md", "diffHunk": "@@ -1143,50 +1143,7 @@ The *fhir-bulkimportexport-webapp* module is a wrapper for the whole BulkData we\n     </webApplication>\n ```\n \n-BulkData web application writes the exported FHIR resources to an IBM Cloud Object Storage (COS) or Amazon S3 bucket, as configured in the per-tenant bulkdata.json configuration file. The bulkdata.json file is stored in the tenant configuration directory of each fhir-server instance. The following is a bulkdata.json which is configured to export the FHIR resources into fhir-bulkdata-sample bucket of IBM COS:\n-\n-```json\n-{\n-  \"applicationName\": \"fhir-bulkimportexport-webapp\",\n-  \"moduleName\": \"fhir-bulkimportexport.war\",\n-  \"jobParameters\": {\n-    \"cos.bucket.name\": \"fhir-bulkdata-sample\",\n-    \"cos.location\": \"us\",\n-    \"cos.endpointurl\": \"https://s3.us-south.cloud-object-storage.appdomain.cloud\",\n-    \"cos.credential.ibm\": \"Y\",\n-    \"cos.api.key\": \"xxxxxxxxxxxxxxxxxxxxxxx\",\n-    \"cos.srvinst.id\": \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\",\n-  },\n-  \"implementation_type\": \"cos\",\n-  \"batch-uri\": \"https://localhost:9443/ibm/api/batch/jobinstances\",\n-  \"batch-user\": \"fhiradmin\",\n-  \"batch-user-password\": \"xxxxxxxxxxxx\",\n-  \"batch-truststore\" : \"resources/security/fhirTruststore.jks\",\n-  \"batch-truststore-password\" : \"xxxxxxxxxxxx\",\n-  \"serverHostname\" : \"localhost:9443\",\n-  \"contextRoot\" : \"/fhir-server/api/v4\"\n-}\n-```", "originalCommit": "45c9225519841c2905f62134698740401f1dd613", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMwMjM4NQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402302385", "bodyText": "good point, let me add one", "author": "albertwang-ibm", "createdAt": "2020-04-02T13:14:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxNTY0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMwODA2Nw==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402308067", "bodyText": "done", "author": "albertwang-ibm", "createdAt": "2020-04-02T13:23:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAxNTY0NA=="}], "type": "inlineReview"}, {"oid": "30cdf062affb37c0910ef231446d825a3bba8001", "url": "https://github.com/IBM/FHIR/commit/30cdf062affb37c0910ef231446d825a3bba8001", "message": "issue #884 minor updates to document\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>", "committedDate": "2020-04-02T13:22:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMzNDE2NQ==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402334165", "bodyText": "Should we add the other bulkdata properties here too?  Do any of them have a \"default value\"?", "author": "lmsurpre", "createdAt": "2020-04-02T13:58:00Z", "path": "docs/src/pages/guides/FHIRServerUsersGuide.md", "diffHunk": "@@ -1399,6 +1375,7 @@ This section contains reference information about each of the configuration prop\n |`fhirServer/audit/serviceProperties/geoCity`|Dallas|\n |`fhirServer/audit/serviceProperties/geoState`|TX|\n |`fhirServer/audit/serviceProperties/geoCounty`|US|\n+|`fhirServer/bulkdata/isExportPublic`|true|", "originalCommit": "45c9225519841c2905f62134698740401f1dd613", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM1NTIxMA==", "url": "https://github.com/IBM/FHIR/pull/869#discussion_r402355210", "bodyText": "The others are either with fixed values, or bucket configuration or password or encryption key, so I didn't add them here.", "author": "albertwang-ibm", "createdAt": "2020-04-02T14:26:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMzNDE2NQ=="}], "type": "inlineReview"}, {"oid": "f88676f2b9a6cbf78656f6a038e0e005bf3523a3", "url": "https://github.com/IBM/FHIR/commit/f88676f2b9a6cbf78656f6a038e0e005bf3523a3", "message": "issue #884 minor updates\n\nSigned-off-by: Albert Wang <xuwang@us.ibm.com>", "committedDate": "2020-04-02T14:30:51Z", "type": "commit"}]}