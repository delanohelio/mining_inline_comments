{"pr_number": 585, "pr_title": "issue #564 and #584 - package fhir-swagger-generator as executable jar", "pr_createdAt": "2020-01-13T19:13:18Z", "pr_url": "https://github.com/IBM/FHIR/pull/585", "timeline": [{"oid": "74aeef1abafa1e0aed5223c0ce24c61addcabe21", "url": "https://github.com/IBM/FHIR/commit/74aeef1abafa1e0aed5223c0ce24c61addcabe21", "message": "issue #564 - package fhir-swagger-generator as executable jar\n\nPreviously, this package really only worked from the development\nenvironment. Now, its possible to download and execute the jar file\ndirectly.\n\nI also updated fhir-openapi with the updated openapi.json (based on the\nnew order of data types coming from ModelSupport).\n\nI also updated the Usage docs in fhir-swagger-generator/README.\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-13T19:12:48Z", "type": "commit"}, {"oid": "bc9d46d0cc44d2ec6d2d7f210b3aa85b3fd79a89", "url": "https://github.com/IBM/FHIR/commit/bc9d46d0cc44d2ec6d2d7f210b3aa85b3fd79a89", "message": "Remove jakarta.json-api dependency\n\nWhile generating the shaded jar, I noticed warnings for overlapping\nclass names between `jakarta.json` and `jakarta.json-api`.\n\nOriginally, we had `jakarta.json-api` depdencies so that we can use the\napplicaiton server's javax.json instead of shipping our own, but now\nthere is a mix of both.\n\nTo resolve, I removed all traces of `jakarta.json-api` since we weren't\neven using it right (it should have been \"provided\" scope and not\n\"compile\" scope).\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-13T19:34:42Z", "type": "commit"}, {"oid": "0c2e14f10e6259259283f53807be8d4d1e83788e", "url": "https://github.com/IBM/FHIR/commit/0c2e14f10e6259259283f53807be8d4d1e83788e", "message": "issue #584 - specify charset for the swagger/openapi JsonWriter\n\nThis should force it to use UTF-8.\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-13T19:55:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk5OTUyNw==", "url": "https://github.com/IBM/FHIR/pull/585#discussion_r365999527", "bodyText": "please update copyright year", "author": "prb112", "createdAt": "2020-01-13T19:58:31Z", "path": "fhir-config/src/test/java/com/ibm/fhir/config/test/FHIRConfigHelperTest.java", "diffHunk": "@@ -22,7 +22,6 @@\n import com.ibm.fhir.config.FHIRConfigHelper;\n import com.ibm.fhir.config.FHIRConfiguration;\n import com.ibm.fhir.config.FHIRRequestContext;\n-import com.ibm.fhir.config.PropertyGroup;\n \n public class FHIRConfigHelperTest {", "originalCommit": "0c2e14f10e6259259283f53807be8d4d1e83788e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxMTU5OQ==", "url": "https://github.com/IBM/FHIR/pull/585#discussion_r366011599", "bodyText": "done", "author": "lmsurpre", "createdAt": "2020-01-13T20:28:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk5OTUyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAwMTExMw==", "url": "https://github.com/IBM/FHIR/pull/585#discussion_r366001113", "bodyText": "Have you tried a build with java9?\nper http://repo1.maven.org/maven2/org/glassfish/json/1.1.6/json-1.1.6.pom\n\n[9,)\n\nYou'll end up with lots of modules.\napi\nimpl\njaxrs\njaxrs-1x\ntests\ngf\ndemos\nbundles\nit's worth double checking instead of embedding the 'extra' jars everytime.", "author": "prb112", "createdAt": "2020-01-13T20:02:16Z", "path": "fhir-config/pom.xml", "diffHunk": "@@ -17,19 +17,14 @@\n             <version>${project.version}</version>\n         </dependency>\n         <dependency>\n-            <groupId>jakarta.json</groupId>\n-            <artifactId>jakarta.json-api</artifactId>\n+            <groupId>org.glassfish</groupId>\n+            <artifactId>jakarta.json</artifactId>", "originalCommit": "0c2e14f10e6259259283f53807be8d4d1e83788e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAwNjExMg==", "url": "https://github.com/IBM/FHIR/pull/585#discussion_r366006112", "bodyText": "I'm building with openjdk 11.0.5, but with a target of Java 8 thanks to the maven-compile-plugin.\nAnyway, I think those extra dependencies you're looking at are all in the dependencyManagement section.\n[INFO] --- maven-dependency-plugin:2.8:tree (default-cli) @ fhir-config ---\n[INFO] com.ibm.fhir:fhir-config:jar:4.0.0-SNAPSHOT\n[INFO] +- com.ibm.fhir:fhir-core:jar:4.0.0-SNAPSHOT:compile\n[INFO] +- org.glassfish:jakarta.json:jar:1.1.5:compile\n[INFO] +- org.testng:testng:jar:6.14.3:test\n[INFO] |  +- com.beust:jcommander:jar:1.72:test\n[INFO] |  \\- org.apache-extras.beanshell:bsh:jar:2.0b6:test\n[INFO] \\- com.google.code.gson:gson:jar:2.8.1:compile", "author": "lmsurpre", "createdAt": "2020-01-13T20:14:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAwMTExMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxNjM2Mg==", "url": "https://github.com/IBM/FHIR/pull/585#discussion_r366016362", "bodyText": "never mind, now i see what you're talking about.  there's a profile section in their pom:\n<profile>\n  <id>jdk9-all</id>\n  <activation>\n    <jdk>[9,)</jdk>\n  </activation>\n  <modules>\n    <module>api</module>\n    <module>impl</module>\n    <module>jaxrs</module>\n    <module>jaxrs-1x</module>\n    <module>tests</module>\n    <module>gf</module>\n    <module>demos</module>\n    <module>bundles</module>\n  </modules>\n</profile>\n\nstill, i'm not sure how it relates to our usage.  we already have quite a few 'compile' dependencies on this module and i don't see any ways of asking for specific sub-modules from maven.", "author": "lmsurpre", "createdAt": "2020-01-13T20:39:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAwMTExMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxNzM1MQ==", "url": "https://github.com/IBM/FHIR/pull/585#discussion_r366017351", "bodyText": "it's active with java9.  just worth us thinking about...", "author": "prb112", "createdAt": "2020-01-13T20:42:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAwMTExMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAwMTc4Ng==", "url": "https://github.com/IBM/FHIR/pull/585#discussion_r366001786", "bodyText": "Looks good", "author": "prb112", "createdAt": "2020-01-13T20:03:50Z", "path": "fhir-swagger-generator/src/main/java/com/ibm/fhir/swagger/generator/FHIRSwaggerGenerator.java", "diffHunk": "@@ -169,8 +172,8 @@ public static void main(String[] args) throws Exception {\n                 config.put(JsonGenerator.PRETTY_PRINTING, true);\n                 JsonWriterFactory factory = Json.createWriterFactory(config);\n \n-                File outFile = new File(\"./src/main/resources/swagger/\" + resourceClassName + \"-swagger.json\");\n-                try (JsonWriter writer = factory.createWriter(new FileWriter(outFile))) {\n+                File outFile = new File(OUTDIR + File.separator +  resourceClassName + \"-swagger.json\");\n+                try (JsonWriter writer = factory.createWriter(new FileOutputStream(outFile), StandardCharsets.UTF_8)) {", "originalCommit": "0c2e14f10e6259259283f53807be8d4d1e83788e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAwMjAwNw==", "url": "https://github.com/IBM/FHIR/pull/585#discussion_r366002007", "bodyText": "Looks Good", "author": "prb112", "createdAt": "2020-01-13T20:04:24Z", "path": "fhir-swagger-generator/src/main/java/com/ibm/fhir/openapi/generator/FHIROpenApiGenerator.java", "diffHunk": "@@ -462,8 +466,8 @@ private static void generateBatchTransactionOpenApi(Filter filter) throws Except\n         config.put(JsonGenerator.PRETTY_PRINTING, true);\n         JsonWriterFactory factory = Json.createWriterFactory(config);\n         \n-        File outFile = new File(\"./src/main/resources/swagger/batch-swagger.json\");\n-        try (JsonWriter writer = factory.createWriter(new FileWriter(outFile))) {\n+        File outFile = new File(OUTDIR + File.separator + \"batch-swagger.json\");\n+        try (JsonWriter writer = factory.createWriter(new FileOutputStream(outFile), StandardCharsets.UTF_8)) {", "originalCommit": "0c2e14f10e6259259283f53807be8d4d1e83788e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "149f1e30fd607f21cac2a34e679822efaadbffcb", "url": "https://github.com/IBM/FHIR/commit/149f1e30fd607f21cac2a34e679822efaadbffcb", "message": "update copyright statements\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-13T20:26:55Z", "type": "commit"}]}