{"pr_number": 648, "pr_title": "use fhirserver for db username instead of fhiruser", "pr_createdAt": "2020-01-28T20:51:36Z", "pr_url": "https://github.com/IBM/FHIR/pull/648", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA0OTY4Nw==", "url": "https://github.com/IBM/FHIR/pull/648#discussion_r372049687", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ```\n          \n      \n    \n    \n  \n\nOn Windows use %VERSION%", "author": "prb112", "createdAt": "2020-01-28T20:53:41Z", "path": "fhir-persistence-schema/README.md", "diffHunk": "@@ -1,58 +1,37 @@\n # IBM FHIR Server - fhir-persistence-schema\n \n-Builds and manages the multi-tenant FHIR R4 RDBMS schema (Db2). Includes Derby support for use in unit tests.\n+Builds and manages the multi-tenant FHIR R4 RDBMS schema (Db2). Includes Derby support for use in tests.\n \n-This module is built into two different jar files. The default jar is included with the IBM FHIR Server web application and is used\n-for bootstrapping Apache Derby databases (if configured). There is also an executable command line interface (cli) version of this jar that packages this module with all of its dependencies.\n+This module is built into two different jar files. The default jar is included with the IBM FHIR Server web application and is used for bootstrapping Apache Derby databases (if configured). There is also an executable command line interface (cli) version of this jar that packages this module with all of its dependencies.\n \n-This module is built into two different jar files. The executable command line interface (cli) version of this module is can also be downloaded directly from [JFrog Bintray](https://bintray.com/ibm-watson-health/ibm-fhir-server-releases/fhir-persistence-schema#files/com/ibm/fhir/fhir-persistence-schema) or is available from the Releases tab.\n+The executable command line interface (cli) version of this module can be downloaded from the project [Releases tab](https://github.com/IBM/FHIR/releases).\n \n-The cli jar is included in the FHIR Server distribution zip but \n+## Getting started\n+### Creating the database\n \n-## Execute the fhir-persistence-schema command line interface (CLI)\n-\n-1 - Execute the corresponding command, where VERSION is the version of the fhir-persistence-schema cli jar that you are using, and SCHEMA_COMMAND is the documented schema command you are using.\n-\n-*Linux/Mac*  \n-\n-```\n-VERSION=4.0.0-SNAPSHOT\n-java -jar ./fhir-persistence-schema-${VERSION}-cli.jar SCHEMA_COMMAND\n-```\n-\n-*Windows*\n-\n-```\n-set VERSION=4.0.0-SNAPSHOT\n-java -jar ./fhir-persistence-schema-%VERSION%-cli.jar SCHEMA_COMMAND\n-```\n+To create the Db2 database and database user, use the following commands:\n \n-## Creating the database\n-\n-To create the database and database user, please use the following command.\n-\n-``` shell \n-useradd fhiruser\n+``` shell\n+useradd fhirserver\n su - db2inst1 -c \"db2 CREATE DB FHIRDB using codeset UTF-8 territory us PAGESIZE 32768\"\n-su - db2inst1 -c \"db2 \\\"connect to fhirdb\\\" && db2 \\\"grant connect on database TO USER fhiruser\\\"\"\n+su - db2inst1 -c \"db2 \\\"connect to fhirdb\\\" && db2 \\\"grant connect on database TO USER fhirserver\\\"\"\n ```\n \n-## Printing the schema\n+### Printing the schema\n \n To print the schema DDL for review, execute `com.ibm.fhir.schema.app.SchemaPrinter`:\n \n-``` shell \n+``` shell\n java -cp ./fhir-persistence-schema-${VERSION}-cli.jar com.ibm.fhir.schema.app.SchemaPrinter [--to-file]\n ```\n \n-Without to-file, the output is the current System.out; else it's schema.sql, grants.sql, and stored-procedures.sql of the current directory.\n+With `--to-file` it outputs to `./schema.sql`, `./grants.sql`, and `./stored-procedures.sql`; otherwise to System.out.\n \n-\n-## Deploy and manage the schema with `com.ibm.fhir.schema.app.Main` \n+## Execute the fhir-persistence-schema command line interface (CLI)\n \n To deploy and manage the schema on a target database, the `fhir-persistence-schema` project includes a Main class that can parallelize the schema updates.\n \n-``` shell \n+``` shell\n java -jar ./fhir-persistence-schema-${VERSION}-cli.jar [OPTIONS]\n ```", "originalCommit": "e5101d0328f0bfcbcb39a54b2c1c03cea34a162d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA1MDIwMw==", "url": "https://github.com/IBM/FHIR/pull/648#discussion_r372050203", "bodyText": "may also need to specify where the VERSION comes from", "author": "prb112", "createdAt": "2020-01-28T20:54:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA0OTY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA1MDIzNA==", "url": "https://github.com/IBM/FHIR/pull/648#discussion_r372050234", "bodyText": "I also thought to just make it ./fhir-persistence-schema-*-cli.jar like we just did in our script...then its platform-neutral, right?", "author": "lmsurpre", "createdAt": "2020-01-28T20:54:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA0OTY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA5MzAzMw==", "url": "https://github.com/IBM/FHIR/pull/648#discussion_r372093033", "bodyText": "added a note to replace version with the version", "author": "lmsurpre", "createdAt": "2020-01-28T22:24:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA0OTY4Nw=="}], "type": "inlineReview"}, {"oid": "61b75475b52ad629949e336f5c396d97e83ad11f", "url": "https://github.com/IBM/FHIR/commit/61b75475b52ad629949e336f5c396d97e83ad11f", "message": "use fhirserver for db username instead of fhiruser\n\nalso adjusted fhir-persistence-schema around a bit\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-28T21:03:54Z", "type": "forcePushed"}, {"oid": "09a96d2fae9556d51af72a78375a676db79dae2c", "url": "https://github.com/IBM/FHIR/commit/09a96d2fae9556d51af72a78375a676db79dae2c", "message": "use fhirserver for db username instead of fhiruser\n\nalso adjusted fhir-persistence-schema around a bit\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-28T21:05:58Z", "type": "commit"}, {"oid": "09a96d2fae9556d51af72a78375a676db79dae2c", "url": "https://github.com/IBM/FHIR/commit/09a96d2fae9556d51af72a78375a676db79dae2c", "message": "use fhirserver for db username instead of fhiruser\n\nalso adjusted fhir-persistence-schema around a bit\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-28T21:05:58Z", "type": "forcePushed"}, {"oid": "68b0b41959212640ae1b59b26f2bcef2d955364f", "url": "https://github.com/IBM/FHIR/commit/68b0b41959212640ae1b59b26f2bcef2d955364f", "message": "add information about the connection properties\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-28T21:37:59Z", "type": "commit"}, {"oid": "68b0b41959212640ae1b59b26f2bcef2d955364f", "url": "https://github.com/IBM/FHIR/commit/68b0b41959212640ae1b59b26f2bcef2d955364f", "message": "add information about the connection properties\n\nSigned-off-by: Lee Surprenant <lmsurpre@us.ibm.com>", "committedDate": "2020-01-28T21:37:59Z", "type": "forcePushed"}]}