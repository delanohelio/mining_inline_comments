{"pr_number": 629, "pr_title": "Incorporate and Improve test coverage in the build/site #248", "pr_createdAt": "2020-01-23T18:17:49Z", "pr_url": "https://github.com/IBM/FHIR/pull/629", "timeline": [{"oid": "c6abc7d7eda034839de9c13206df9d577f6270bf", "url": "https://github.com/IBM/FHIR/commit/c6abc7d7eda034839de9c13206df9d577f6270bf", "message": "Incorporate and Improve test coverage in the build/site #248\n\n- Add Examples to increase Test Coverage\n\t- parameters-contactdetail.[json/xml]\n\t- basic-type.[json/xml]\n- Add coverage for get method tests\n- Update fhir-parent to use the latest jacoco plugin\n- Increase code coverage of fhir-config\n- Update fhir-model to remove unused FHIRUtil method\n- Add a switch to turn on/off codecov.io\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-01-23T18:13:34Z", "type": "commit"}, {"oid": "456b782612cfa84e64d2286db7b1728dda849e70", "url": "https://github.com/IBM/FHIR/commit/456b782612cfa84e64d2286db7b1728dda849e70", "message": "Incorporate and Improve test coverage in the build/site #248\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-01-23T19:24:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMDUwMQ==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370330501", "bodyText": "Is this really useful?", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:10:53Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.XML).generate(resource, writer);\n+                    String outXML = writer.toString();\n+                    assertNotNull(outXML);\n+                    assertFalse(outXML.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outXML.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.XML).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    public void runMethods(Object resource, Method[] methods) throws Exception {\n+        for (Method method : methods) {\n+            if (method.getName().startsWith(\"get\")) {\n+                method.invoke(resource);\n+                assertTrue(true);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0MDcxMQ==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370340711", "bodyText": "Yes, it's related to exercising the test framework.", "author": "prb112", "createdAt": "2020-01-23T20:35:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMDUwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMTI1Ng==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370331256", "bodyText": "do we really want to print them out always?", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:12:38Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.XML).generate(resource, writer);\n+                    String outXML = writer.toString();\n+                    assertNotNull(outXML);\n+                    assertFalse(outXML.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outXML.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.XML).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    public void runMethods(Object resource, Method[] methods) throws Exception {\n+        for (Method method : methods) {\n+            if (method.getName().startsWith(\"get\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"hashCode\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"equals\")) {\n+                method.invoke(resource, resource);\n+                assertTrue(true);\n+\n+                String x = \"BAD\";\n+                method.invoke(resource, x);\n+                assertTrue(true);\n+                \n+                if (resource instanceof Resource) {\n+                    Resource r = (Resource) resource; \n+                    Resource r2 = r.toBuilder().build(); \n+                    assertTrue(r.equals(r2));\n+                }\n+            }\n+\n+            if (method.getName().equals(\"hasChildren\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+        }\n+    }\n+\n+    public void buildTestForUncoveredTypes() throws Exception {\n+        List<Extension> extensions = new ArrayList<>();\n+        extensions.add(buildBase64Binary());\n+        extensions.add(buildBooleanTrue());\n+        extensions.add(buildCanonical());\n+        extensions.add(buildId());\n+        extensions.add(buildContactDetail());\n+        extensions.add(buildCount());\n+        extensions.add(buildDistance());\n+        extensions.add(buildMoneyQuantity());\n+\n+        CodeableConcept code = CodeableConcept.builder().id(\"1-2-3-4\").text(string(\"Demo\")).build();\n+        Basic basic = Basic.builder().code(code).extension(extensions).build();\n+\n+        try (StringWriter writer = new StringWriter()) {\n+            FHIRGenerator.generator(Format.XML).generate(basic, writer);\n+\n+            String out = writer.toString();\n+            assertNotNull(out);\n+            assertFalse(out.isEmpty());\n+            System.out.println(out);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0MDU1Ng==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370340556", "bodyText": "this only builds a test.  The corresponding content is in fhir-examples", "author": "prb112", "createdAt": "2020-01-23T20:34:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMTI1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMTM5OA==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370331398", "bodyText": "do we really want to print them out always?", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:13:01Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.XML).generate(resource, writer);\n+                    String outXML = writer.toString();\n+                    assertNotNull(outXML);\n+                    assertFalse(outXML.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outXML.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.XML).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    public void runMethods(Object resource, Method[] methods) throws Exception {\n+        for (Method method : methods) {\n+            if (method.getName().startsWith(\"get\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"hashCode\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"equals\")) {\n+                method.invoke(resource, resource);\n+                assertTrue(true);\n+\n+                String x = \"BAD\";\n+                method.invoke(resource, x);\n+                assertTrue(true);\n+                \n+                if (resource instanceof Resource) {\n+                    Resource r = (Resource) resource; \n+                    Resource r2 = r.toBuilder().build(); \n+                    assertTrue(r.equals(r2));\n+                }\n+            }\n+\n+            if (method.getName().equals(\"hasChildren\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+        }\n+    }\n+\n+    public void buildTestForUncoveredTypes() throws Exception {\n+        List<Extension> extensions = new ArrayList<>();\n+        extensions.add(buildBase64Binary());\n+        extensions.add(buildBooleanTrue());\n+        extensions.add(buildCanonical());\n+        extensions.add(buildId());\n+        extensions.add(buildContactDetail());\n+        extensions.add(buildCount());\n+        extensions.add(buildDistance());\n+        extensions.add(buildMoneyQuantity());\n+\n+        CodeableConcept code = CodeableConcept.builder().id(\"1-2-3-4\").text(string(\"Demo\")).build();\n+        Basic basic = Basic.builder().code(code).extension(extensions).build();\n+\n+        try (StringWriter writer = new StringWriter()) {\n+            FHIRGenerator.generator(Format.XML).generate(basic, writer);\n+\n+            String out = writer.toString();\n+            assertNotNull(out);\n+            assertFalse(out.isEmpty());\n+            System.out.println(out);\n+\n+            try (ByteArrayInputStream in = new ByteArrayInputStream(out.getBytes())) {\n+                Basic basicParsed = FHIRParser.parser(Format.XML).parse(in).as(Basic.class);\n+                assertNotNull(basicParsed);\n+                assertTrue(true);\n+            }\n+        }\n+\n+        try (StringWriter writer = new StringWriter()) {\n+            FHIRGenerator.generator(Format.JSON).generate(basic, writer);\n+\n+            String out = writer.toString();\n+            assertNotNull(out);\n+            assertFalse(out.isEmpty());\n+            System.out.println(out);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0MDQwMA==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370340400", "bodyText": "Yes.  that's right.  it's an invocation, and asserts true as a pattern.", "author": "prb112", "createdAt": "2020-01-23T20:34:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMTM5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMTgwOA==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370331808", "bodyText": "not sure why assertTrue(true) which is always pass here ...", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:14:03Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.XML).generate(resource, writer);\n+                    String outXML = writer.toString();\n+                    assertNotNull(outXML);\n+                    assertFalse(outXML.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outXML.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.XML).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    public void runMethods(Object resource, Method[] methods) throws Exception {\n+        for (Method method : methods) {\n+            if (method.getName().startsWith(\"get\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"hashCode\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"equals\")) {\n+                method.invoke(resource, resource);\n+                assertTrue(true);\n+\n+                String x = \"BAD\";\n+                method.invoke(resource, x);\n+                assertTrue(true);\n+                \n+                if (resource instanceof Resource) {\n+                    Resource r = (Resource) resource; \n+                    Resource r2 = r.toBuilder().build(); \n+                    assertTrue(r.equals(r2));\n+                }\n+            }\n+\n+            if (method.getName().equals(\"hasChildren\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+        }\n+    }\n+\n+    public void buildTestForUncoveredTypes() throws Exception {\n+        List<Extension> extensions = new ArrayList<>();\n+        extensions.add(buildBase64Binary());\n+        extensions.add(buildBooleanTrue());\n+        extensions.add(buildCanonical());\n+        extensions.add(buildId());\n+        extensions.add(buildContactDetail());\n+        extensions.add(buildCount());\n+        extensions.add(buildDistance());\n+        extensions.add(buildMoneyQuantity());\n+\n+        CodeableConcept code = CodeableConcept.builder().id(\"1-2-3-4\").text(string(\"Demo\")).build();\n+        Basic basic = Basic.builder().code(code).extension(extensions).build();\n+\n+        try (StringWriter writer = new StringWriter()) {\n+            FHIRGenerator.generator(Format.XML).generate(basic, writer);\n+\n+            String out = writer.toString();\n+            assertNotNull(out);\n+            assertFalse(out.isEmpty());\n+            System.out.println(out);\n+\n+            try (ByteArrayInputStream in = new ByteArrayInputStream(out.getBytes())) {\n+                Basic basicParsed = FHIRParser.parser(Format.XML).parse(in).as(Basic.class);\n+                assertNotNull(basicParsed);\n+                assertTrue(true);\n+            }\n+        }\n+\n+        try (StringWriter writer = new StringWriter()) {\n+            FHIRGenerator.generator(Format.JSON).generate(basic, writer);\n+\n+            String out = writer.toString();\n+            assertNotNull(out);\n+            assertFalse(out.isEmpty());\n+            System.out.println(out);\n+\n+            try (ByteArrayInputStream in = new ByteArrayInputStream(out.getBytes())) {\n+                Basic basicParsed = FHIRParser.parser(Format.JSON).parse(in).as(Basic.class);\n+                assertNotNull(basicParsed);\n+                assertTrue(true);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0MDQyOA==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370340428", "bodyText": "Yes.  that's right.  it's an invocation, and asserts true as a pattern.", "author": "prb112", "createdAt": "2020-01-23T20:34:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMTgwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0OTI4MA==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370349280", "bodyText": "These are used just to generate test data.", "author": "prb112", "createdAt": "2020-01-23T20:55:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMTgwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMjA3NQ==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370332075", "bodyText": "does this always pass?", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:14:41Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.XML).generate(resource, writer);\n+                    String outXML = writer.toString();\n+                    assertNotNull(outXML);\n+                    assertFalse(outXML.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outXML.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.XML).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    public void runMethods(Object resource, Method[] methods) throws Exception {\n+        for (Method method : methods) {\n+            if (method.getName().startsWith(\"get\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"hashCode\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"equals\")) {\n+                method.invoke(resource, resource);\n+                assertTrue(true);\n+\n+                String x = \"BAD\";\n+                method.invoke(resource, x);\n+                assertTrue(true);\n+                \n+                if (resource instanceof Resource) {\n+                    Resource r = (Resource) resource; \n+                    Resource r2 = r.toBuilder().build(); \n+                    assertTrue(r.equals(r2));\n+                }\n+            }\n+\n+            if (method.getName().equals(\"hasChildren\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+        }\n+    }\n+\n+    public void buildTestForUncoveredTypes() throws Exception {\n+        List<Extension> extensions = new ArrayList<>();\n+        extensions.add(buildBase64Binary());\n+        extensions.add(buildBooleanTrue());\n+        extensions.add(buildCanonical());\n+        extensions.add(buildId());\n+        extensions.add(buildContactDetail());\n+        extensions.add(buildCount());\n+        extensions.add(buildDistance());\n+        extensions.add(buildMoneyQuantity());\n+\n+        CodeableConcept code = CodeableConcept.builder().id(\"1-2-3-4\").text(string(\"Demo\")).build();\n+        Basic basic = Basic.builder().code(code).extension(extensions).build();\n+\n+        try (StringWriter writer = new StringWriter()) {\n+            FHIRGenerator.generator(Format.XML).generate(basic, writer);\n+\n+            String out = writer.toString();\n+            assertNotNull(out);\n+            assertFalse(out.isEmpty());\n+            System.out.println(out);\n+\n+            try (ByteArrayInputStream in = new ByteArrayInputStream(out.getBytes())) {\n+                Basic basicParsed = FHIRParser.parser(Format.XML).parse(in).as(Basic.class);\n+                assertNotNull(basicParsed);\n+                assertTrue(true);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0MDE2Nw==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370340167", "bodyText": "Yes, I ran with ALL", "author": "prb112", "createdAt": "2020-01-23T20:33:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMjA3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMjczNQ==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370332735", "bodyText": "always true?", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:16:12Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0MDA2NA==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370340064", "bodyText": "Yes.  that's right.  it's an invocation, and asserts true as a pattern.", "author": "prb112", "createdAt": "2020-01-23T20:33:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMjczNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMjgzMQ==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370332831", "bodyText": "always true?", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:16:25Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.XML).generate(resource, writer);\n+                    String outXML = writer.toString();\n+                    assertNotNull(outXML);\n+                    assertFalse(outXML.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outXML.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.XML).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0MDA0Mw==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370340043", "bodyText": "Yes.  that's right.  it's an invocation, and asserts true as a pattern.", "author": "prb112", "createdAt": "2020-01-23T20:33:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMjgzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMzEyNQ==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370333125", "bodyText": "always true?", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:17:04Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.XML).generate(resource, writer);\n+                    String outXML = writer.toString();\n+                    assertNotNull(outXML);\n+                    assertFalse(outXML.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outXML.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.XML).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    public void runMethods(Object resource, Method[] methods) throws Exception {\n+        for (Method method : methods) {\n+            if (method.getName().startsWith(\"get\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"hashCode\")) {\n+                method.invoke(resource);\n+                assertTrue(true);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0MDAxMg==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370340012", "bodyText": "Yes.  that's right.  it's an invocation, and asserts true as a pattern.", "author": "prb112", "createdAt": "2020-01-23T20:33:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMzEyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMzM2OQ==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370333369", "bodyText": "always true?", "author": "albertwang-ibm", "createdAt": "2020-01-23T20:17:38Z", "path": "fhir-model/src/test/java/com/ibm/fhir/model/test/ResourceCoverageTest.java", "diffHunk": "@@ -0,0 +1,260 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.model.test;\n+\n+import static com.ibm.fhir.model.type.String.string;\n+import static org.testng.Assert.assertFalse;\n+import static org.testng.Assert.assertNotNull;\n+import static org.testng.Assert.assertTrue;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.StringWriter;\n+import java.lang.reflect.Method;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import org.testng.annotations.Test;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.generator.FHIRGenerator;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.resource.Basic;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.model.type.Base64Binary;\n+import com.ibm.fhir.model.type.CodeableConcept;\n+import com.ibm.fhir.model.type.ContactDetail;\n+import com.ibm.fhir.model.type.ContactPoint;\n+import com.ibm.fhir.model.type.Count;\n+import com.ibm.fhir.model.type.Decimal;\n+import com.ibm.fhir.model.type.Distance;\n+import com.ibm.fhir.model.type.Extension;\n+import com.ibm.fhir.model.type.MoneyQuantity;\n+import com.ibm.fhir.model.type.code.ContactPointUse;\n+import com.ibm.fhir.model.type.code.QuantityComparator;\n+import com.ibm.fhir.model.type.code.ResourceType;\n+import com.ibm.fhir.model.type.code.ResourceType.ValueSet;\n+\n+/**\n+ * This class exercises the getters in the resource package.\n+ */\n+public class ResourceCoverageTest {\n+\n+    public static byte[] PAYLOAD = \"THIS IS A FAKE PAYLOAD\".getBytes();\n+\n+    public static Extension buildBooleanTrue() {\n+        return Extension.builder().url(\"https://extension-Boolean\")\n+                .value(com.ibm.fhir.model.type.Boolean.builder().value(\"TRUE\").build()).build();\n+    }\n+\n+    public static Extension buildBase64Binary() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildId() {\n+        return Extension.builder().url(\"https://extension-base64\")\n+                .value(Base64Binary.builder().value(PAYLOAD).build()).build();\n+    }\n+\n+    public static Extension buildCanonical() {\n+        return Extension.builder().url(\"https://extension-Canonical\")\n+                .value(com.ibm.fhir.model.type.Canonical.builder().value(\"https://mycanonical\").build())\n+                .build();\n+    }\n+\n+    public static Extension buildContactDetail() {\n+        return Extension.builder().url(\"https://extension-ContactDetail\")\n+                .value(ContactDetail.builder().name(string(\"Patient P\"))\n+                        .telecom(ContactPoint.builder().use(ContactPointUse.HOME)\n+                                .value(string(\"1-111-111-1111\")).build())\n+                        .build())\n+                .build();\n+    }\n+\n+    private static Extension buildCount() {\n+        Count count =\n+                Count.builder().comparator(QuantityComparator.GREATER_OR_EQUALS).value(Decimal.of(\"10.0\"))\n+                        .unit(string(\"kg\")).build();\n+        return Extension.builder().url(\"https://extension-Count\").value(count).build();\n+    }\n+\n+    private static Extension buildDistance() {\n+        Distance distance = Distance.builder().unit(string(\"km\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-Distance\")\n+                .value(distance).build();\n+    }\n+\n+    private static Extension buildMoneyQuantity() {\n+        MoneyQuantity moneyQuantity = MoneyQuantity.builder().unit(string(\"$\")).value(Decimal.of(\"10.0\")).build();\n+        return Extension.builder().url(\"https://extension-MoneyQuantity\")\n+                .value(moneyQuantity).build();\n+    }\n+\n+    @Test\n+    public void testResources() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"json/ibm/complete-mock/\" + valueSet.value() + \"-1.json\");\n+                Method[] methods = resource.getClass().getMethods();\n+                runMethods(resource, methods);\n+                Class<?>[] clzs = resource.getClass().getClasses();\n+                for (Class<?> clz : clzs) {\n+\n+                    if (!SKIP.contains(clz.getSimpleName())) {\n+                        Method m = resource.getClass().getMethod(\"get\" + clz.getSimpleName());\n+                        Object o = m.invoke(resource);\n+                        if (o.getClass().getSimpleName().contains(\"List\")) {\n+                            @SuppressWarnings(\"unchecked\")\n+                            List<Object> os = ((List<Object>) o);\n+                            if (!os.isEmpty()) {\n+                                runMethods(os.get(0), clz.getMethods());\n+                            }\n+                        } else if (!o.getClass().getSimpleName().contains(\"Class\")) {\n+                            runMethods(o, clz.getMethods());\n+                        }\n+                    }\n+                }\n+            }\n+        }\n+    }\n+    \n+    @Test\n+    public void testResourcesWithXml() throws Exception {\n+        List<String> SKIP = Arrays.asList(\"DomainResource\", \"Resource\", \"Builder\");\n+        ValueSet[] values = ResourceType.ValueSet.values();\n+        for (ValueSet valueSet : values) {\n+            if (!SKIP.contains(valueSet.value())) {\n+                Resource resource =\n+                        TestUtil.readExampleResource(\"xml/ibm/complete-mock/\" + valueSet.value() + \"-1.xml\");\n+\n+                Resource.Builder builder = resource.toBuilder();\n+                Method[] methods = builder.getClass().getMethods();\n+                for(Method method : methods) {\n+                    if (method.getName().equals(\"extension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                    \n+                    if (method.getName().equals(\"modifierExtension\") && method.toString().contains(\"java.util.Collection\")) {\n+                        List<Extension> extensions = Arrays.asList(buildBooleanTrue());\n+                        builder = (Resource.Builder) method.invoke(builder, extensions);\n+                    }\n+                }\n+                resource = builder.build();\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.JSON).generate(resource, writer);\n+                    String outJson = writer.toString();\n+                    assertNotNull(outJson);\n+                    assertFalse(outJson.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outJson.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.JSON).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+                \n+                try (StringWriter writer = new StringWriter()) {\n+                    FHIRGenerator.generator(Format.XML).generate(resource, writer);\n+                    String outXML = writer.toString();\n+                    assertNotNull(outXML);\n+                    assertFalse(outXML.isEmpty());\n+                    \n+                    try (ByteArrayInputStream in = new ByteArrayInputStream(outXML.getBytes())) {\n+                        Resource resource2 = FHIRParser.parser(Format.XML).parse(in).as(Resource.class);\n+                        assertNotNull(resource2);\n+                        assertTrue(true);\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    public void runMethods(Object resource, Method[] methods) throws Exception {\n+        for (Method method : methods) {\n+            if (method.getName().startsWith(\"get\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"hashCode\")) {\n+                method.invoke(resource);\n+                assertTrue(true);\n+            }\n+\n+            if (method.getName().equals(\"equals\")) {\n+                method.invoke(resource, resource);\n+                assertTrue(true);\n+\n+                String x = \"BAD\";\n+                method.invoke(resource, x);\n+                assertTrue(true);\n+                \n+                if (resource instanceof Resource) {\n+                    Resource r = (Resource) resource; \n+                    Resource r2 = r.toBuilder().build(); \n+                    assertTrue(r.equals(r2));\n+                }\n+            }\n+\n+            if (method.getName().equals(\"hasChildren\")) {\n+                method.invoke(resource);\n+                assertTrue(true);", "originalCommit": "456b782612cfa84e64d2286db7b1728dda849e70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzOTk4NQ==", "url": "https://github.com/IBM/FHIR/pull/629#discussion_r370339985", "bodyText": "Yes.  that's right.  it's an invocation, and asserts true as a pattern.", "author": "prb112", "createdAt": "2020-01-23T20:33:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzMzM2OQ=="}], "type": "inlineReview"}, {"oid": "2aea28fe9f589b82a933e8d2b70ec64b2432e08a", "url": "https://github.com/IBM/FHIR/commit/2aea28fe9f589b82a933e8d2b70ec64b2432e08a", "message": "Incorporate and Improve test coverage in the build/site #248\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-01-25T01:09:55Z", "type": "commit"}]}