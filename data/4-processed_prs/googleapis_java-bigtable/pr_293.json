{"pr_number": 293, "pr_title": "fix: set x-goog-api-client as internal header", "pr_createdAt": "2020-05-08T21:31:09Z", "pr_url": "https://github.com/googleapis/java-bigtable/pull/293", "timeline": [{"oid": "ee3fd425c9899284ee1a04920c7d8e47d2d47dae", "url": "https://github.com/googleapis/java-bigtable/commit/ee3fd425c9899284ee1a04920c7d8e47d2d47dae", "message": "fix: set x-goog-api-client as internal header", "committedDate": "2020-05-08T21:30:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjM4NzAxOA==", "url": "https://github.com/googleapis/java-bigtable/pull/293#discussion_r422387018", "bodyText": "I dont love this:\n\nwe shouldnt test things in setup()...it should only setup the environment for the test\nI dont think enforcing that header provider is unset is appropriate.\n\nI think it would be better to set a static header provider here and test that it doesnt clobber the other headers instead", "author": "igorbernstein2", "createdAt": "2020-05-08T21:35:58Z", "path": "google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/data/v2/stub/HeadersTest.java", "diffHunk": "@@ -104,6 +105,11 @@ public void setUp() throws Exception {\n                 .setElementCountThreshold(1L)\n                 .build());\n \n+    // getInternalHeaderProvider is a protected method so we can't call it, instead ensure that\n+    // headers were not set here. the test will assert the full header later on\n+    if (!(settings.stubSettings().getHeaderProvider() instanceof NoHeaderProvider)) {\n+      throw new AssertionError(\"header provider should not be set\");\n+    }", "originalCommit": "ee3fd425c9899284ee1a04920c7d8e47d2d47dae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2e68125a23ce495a0a82ba2b874c22e953255958", "url": "https://github.com/googleapis/java-bigtable/commit/2e68125a23ce495a0a82ba2b874c22e953255958", "message": "review feedback", "committedDate": "2020-05-08T21:44:14Z", "type": "commit"}]}