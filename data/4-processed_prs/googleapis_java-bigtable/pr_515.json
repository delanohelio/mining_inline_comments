{"pr_number": 515, "pr_title": "feat: allow restore backup to different instance", "pr_createdAt": "2020-11-05T18:58:27Z", "pr_url": "https://github.com/googleapis/java-bigtable/pull/515", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg5NjU0Ng==", "url": "https://github.com/googleapis/java-bigtable/pull/515#discussion_r518896546", "bodyText": "what are your thoughts on renaming sourceInstanceId to destinationInstanceId, or targetInstanceId? 'source' is a little confusing to me", "author": "kolea2", "createdAt": "2020-11-06T17:26:01Z", "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/admin/v2/models/RestoreTableRequest.java", "diffHunk": "@@ -20,24 +20,47 @@\n import com.google.common.base.Objects;\n import com.google.common.base.Preconditions;\n import javax.annotation.Nonnull;\n+import javax.annotation.Nullable;\n \n /** Fluent wrapper for {@link com.google.bigtable.admin.v2.RestoreTableRequest} */\n public final class RestoreTableRequest {\n   private final com.google.bigtable.admin.v2.RestoreTableRequest.Builder requestBuilder =\n       com.google.bigtable.admin.v2.RestoreTableRequest.newBuilder();\n-  private final String backupId;\n-  private final String clusterId;\n+  private final String sourceBackupId;\n+  private final String sourceClusterId;\n+  private final String sourceInstanceId;\n \n-  public static RestoreTableRequest of(String clusterId, String backupId) {\n-    RestoreTableRequest request = new RestoreTableRequest(clusterId, backupId);\n+  /**\n+   * Create a {@link RestoreTableRequest} object. It assumes the source backup locates in the same\n+   * instance as the destination table. To restore a table from a backup in another instance, use\n+   * {@link #of(String, String, String) of} method.\n+   */\n+  public static RestoreTableRequest of(String sourceClusterId, String sourceBackupId) {\n+    RestoreTableRequest request = new RestoreTableRequest(null, sourceClusterId, sourceBackupId);\n     return request;\n   }\n \n-  private RestoreTableRequest(String clusterId, String backupId) {\n-    Preconditions.checkNotNull(clusterId);\n-    Preconditions.checkNotNull(backupId);\n-    this.backupId = backupId;\n-    this.clusterId = clusterId;\n+  /**\n+   * Create a {@link RestoreTableRequest} object. It assumes the source backup locates in the same\n+   * instance as the destination table. To restore a table from a backup in another instance, use\n+   * {@link #of(String, String, String) of} method.\n+   */\n+  public static RestoreTableRequest of(\n+      String sourceInstanceId, String sourceClusterId, String sourceBackupId) {", "originalCommit": "8146fb3cde20ac206d939050820db73b1238c6e2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDIwNTMxMw==", "url": "https://github.com/googleapis/java-bigtable/pull/515#discussion_r520205313", "bodyText": "ignore - I misunderstood the usage here", "author": "kolea2", "createdAt": "2020-11-10T00:21:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg5NjU0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg5Njk2Ng==", "url": "https://github.com/googleapis/java-bigtable/pull/515#discussion_r518896966", "bodyText": "FYI, this will need to be rebased when #498 is merged", "author": "kolea2", "createdAt": "2020-11-06T17:26:44Z", "path": "google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/admin/v2/it/BigtableBackupIT.java", "diffHunk": "@@ -360,6 +362,55 @@ public void backupIamTest() throws InterruptedException {\n     assertThat(permissions).hasSize(4);\n   }\n \n+  @Test", "originalCommit": "8146fb3cde20ac206d939050820db73b1238c6e2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1ODYzMDQ2NA==", "url": "https://github.com/googleapis/java-bigtable/pull/515#discussion_r558630464", "bodyText": "Rebase the test code.", "author": "liubonan", "createdAt": "2021-01-15T22:44:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg5Njk2Ng=="}], "type": "inlineReview"}, {"oid": "d23bb2074ae308f20861317020a26173e7b7a0a9", "url": "https://github.com/googleapis/java-bigtable/commit/d23bb2074ae308f20861317020a26173e7b7a0a9", "message": "feat: allow restore backup to different instance", "committedDate": "2021-01-20T20:02:40Z", "type": "forcePushed"}, {"oid": "effb896ed4e2fdb49f646549ba0c800e189e2a8f", "url": "https://github.com/googleapis/java-bigtable/commit/effb896ed4e2fdb49f646549ba0c800e189e2a8f", "message": "feat: allow restore backup to different instance", "committedDate": "2021-01-20T20:08:11Z", "type": "forcePushed"}, {"oid": "042ed7619bbdb061e36e0f91a3019b813f366827", "url": "https://github.com/googleapis/java-bigtable/commit/042ed7619bbdb061e36e0f91a3019b813f366827", "message": "feat: allow restore backup to different instance", "committedDate": "2021-01-20T20:09:27Z", "type": "commit"}, {"oid": "042ed7619bbdb061e36e0f91a3019b813f366827", "url": "https://github.com/googleapis/java-bigtable/commit/042ed7619bbdb061e36e0f91a3019b813f366827", "message": "feat: allow restore backup to different instance", "committedDate": "2021-01-20T20:09:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTU4MjA2Nw==", "url": "https://github.com/googleapis/java-bigtable/pull/515#discussion_r621582067", "bodyText": "nit: this javadoc needs updating", "author": "kolea2", "createdAt": "2021-04-27T20:36:52Z", "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/admin/v2/models/RestoreTableRequest.java", "diffHunk": "@@ -20,24 +20,47 @@\n import com.google.common.base.Objects;\n import com.google.common.base.Preconditions;\n import javax.annotation.Nonnull;\n+import javax.annotation.Nullable;\n \n /** Fluent wrapper for {@link com.google.bigtable.admin.v2.RestoreTableRequest} */\n public final class RestoreTableRequest {\n   private final com.google.bigtable.admin.v2.RestoreTableRequest.Builder requestBuilder =\n       com.google.bigtable.admin.v2.RestoreTableRequest.newBuilder();\n-  private final String backupId;\n-  private final String clusterId;\n+  private final String sourceBackupId;\n+  private final String sourceClusterId;\n+  private final String sourceInstanceId;\n \n-  public static RestoreTableRequest of(String clusterId, String backupId) {\n-    RestoreTableRequest request = new RestoreTableRequest(clusterId, backupId);\n+  /**\n+   * Create a {@link RestoreTableRequest} object. It assumes the source backup locates in the same\n+   * instance as the destination table. To restore a table from a backup in another instance, use\n+   * {@link #of(String, String, String) of} method.\n+   */\n+  public static RestoreTableRequest of(String sourceClusterId, String sourceBackupId) {\n+    RestoreTableRequest request = new RestoreTableRequest(null, sourceClusterId, sourceBackupId);\n     return request;\n   }\n \n-  private RestoreTableRequest(String clusterId, String backupId) {\n-    Preconditions.checkNotNull(clusterId);\n-    Preconditions.checkNotNull(backupId);\n-    this.backupId = backupId;\n-    this.clusterId = clusterId;\n+  /**\n+   * Create a {@link RestoreTableRequest} object. It assumes the source backup locates in the same", "originalCommit": "042ed7619bbdb061e36e0f91a3019b813f366827", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTU4MjQwOQ==", "url": "https://github.com/googleapis/java-bigtable/pull/515#discussion_r621582409", "bodyText": "the variables in the test are target.... Should these be renamed?", "author": "kolea2", "createdAt": "2021-04-27T20:37:25Z", "path": "google-cloud-bigtable/src/main/java/com/google/cloud/bigtable/admin/v2/models/RestoreTableRequest.java", "diffHunk": "@@ -20,24 +20,47 @@\n import com.google.common.base.Objects;\n import com.google.common.base.Preconditions;\n import javax.annotation.Nonnull;\n+import javax.annotation.Nullable;\n \n /** Fluent wrapper for {@link com.google.bigtable.admin.v2.RestoreTableRequest} */\n public final class RestoreTableRequest {\n   private final com.google.bigtable.admin.v2.RestoreTableRequest.Builder requestBuilder =\n       com.google.bigtable.admin.v2.RestoreTableRequest.newBuilder();\n-  private final String backupId;\n-  private final String clusterId;\n+  private final String sourceBackupId;\n+  private final String sourceClusterId;\n+  private final String sourceInstanceId;\n \n-  public static RestoreTableRequest of(String clusterId, String backupId) {\n-    RestoreTableRequest request = new RestoreTableRequest(clusterId, backupId);\n+  /**\n+   * Create a {@link RestoreTableRequest} object. It assumes the source backup locates in the same\n+   * instance as the destination table. To restore a table from a backup in another instance, use\n+   * {@link #of(String, String, String) of} method.\n+   */\n+  public static RestoreTableRequest of(String sourceClusterId, String sourceBackupId) {\n+    RestoreTableRequest request = new RestoreTableRequest(null, sourceClusterId, sourceBackupId);\n     return request;\n   }\n \n-  private RestoreTableRequest(String clusterId, String backupId) {\n-    Preconditions.checkNotNull(clusterId);\n-    Preconditions.checkNotNull(backupId);\n-    this.backupId = backupId;\n-    this.clusterId = clusterId;\n+  /**\n+   * Create a {@link RestoreTableRequest} object. It assumes the source backup locates in the same\n+   * instance as the destination table. To restore a table from a backup in another instance, use\n+   * {@link #of(String, String, String) of} method.\n+   */\n+  public static RestoreTableRequest of(\n+      String sourceInstanceId, String sourceClusterId, String sourceBackupId) {", "originalCommit": "042ed7619bbdb061e36e0f91a3019b813f366827", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTY0MjI5MA==", "url": "https://github.com/googleapis/java-bigtable/pull/515#discussion_r621642290", "bodyText": "Update the test case to make it clear that RestoreTable is destination-centric.", "author": "liubonan", "createdAt": "2021-04-27T22:16:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTU4MjQwOQ=="}], "type": "inlineReview"}, {"oid": "ef66710cb2416dfd68cd9a854b02998a87daa193", "url": "https://github.com/googleapis/java-bigtable/commit/ef66710cb2416dfd68cd9a854b02998a87daa193", "message": "Address comments in the PR.\n\nChange-Id: I3a2bb866d660cc5b6abb5a57b344dfc019c8cdf0", "committedDate": "2021-04-27T22:14:49Z", "type": "commit"}, {"oid": "8495075fb0de85c2c4652b2a41d1bf9c0f6a6500", "url": "https://github.com/googleapis/java-bigtable/commit/8495075fb0de85c2c4652b2a41d1bf9c0f6a6500", "message": "Merge branch 'master' of https://github.com/googleapis/java-bigtable\n\nChange-Id: I9d75b3c7135223e0f56266e797201a96efcc86a7", "committedDate": "2021-04-29T17:41:45Z", "type": "commit"}, {"oid": "b168074b6731e61c1dc12c83e24ed491b5342ee2", "url": "https://github.com/googleapis/java-bigtable/commit/b168074b6731e61c1dc12c83e24ed491b5342ee2", "message": "Improve unit test coverage for RestoreTableRequest.\n\nChange-Id: I65a08bcfcdef49478925037066d865e0963b4374", "committedDate": "2021-04-29T18:25:45Z", "type": "commit"}]}