{"pr_number": 2490, "pr_title": "Fix CorfuTable values() API that incorrectly deduplicates on return.", "pr_createdAt": "2020-03-26T18:51:48Z", "pr_url": "https://github.com/CorfuDB/CorfuDB/pull/2490", "timeline": [{"oid": "e165f908531693965e8ad5c9e3052fa1d2734cfd", "url": "https://github.com/CorfuDB/CorfuDB/commit/e165f908531693965e8ad5c9e3052fa1d2734cfd", "message": "Fix CorfuTable values() API that incorrectly deduplicates on return.\n\nCorfuTable values() API is inherited from Java Map interface, which\nis not supposed to perform deduplication on return. If CorfuTable\ncontains duplicates in values, the current values() API would return\nless values than expected. This patch fixes the API to return an\nimmutable list instead of a set.", "committedDate": "2020-03-31T22:04:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAyNzI4NA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2490#discussion_r402027284", "bodyText": "please replace by\nreturn ImmutableList.copyOf(mainMap.values());", "author": "xnull", "createdAt": "2020-04-02T03:09:33Z", "path": "runtime/src/main/java/org/corfudb/runtime/collections/CorfuTable.java", "diffHunk": "@@ -473,7 +474,7 @@ public void clear() {\n     public @Nonnull Collection<V> values() {\n         return mainMap.values()\n                 .stream()\n-                .collect(ImmutableSet.toImmutableSet());\n+                .collect(ImmutableList.toImmutableList());", "originalCommit": "e165f908531693965e8ad5c9e3052fa1d2734cfd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY3MTU1MQ==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2490#discussion_r407671551", "bodyText": "Done.", "author": "WenbinZhu", "createdAt": "2020-04-13T19:31:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjAyNzI4NA=="}], "type": "inlineReview"}, {"oid": "379f102312fbf08b9647a65ccc88f9e66cbf40d9", "url": "https://github.com/CorfuDB/CorfuDB/commit/379f102312fbf08b9647a65ccc88f9e66cbf40d9", "message": "Fix CorfuTable values() API that incorrectly deduplicates on return.\n\nCorfuTable values() API is inherited from Java Map interface, which\nis not supposed to perform deduplication on return. If CorfuTable\ncontains duplicates in values, the current values() API would return\nless values than expected. This patch fixes the API to return an\nimmutable list instead of a set.", "committedDate": "2020-04-13T19:30:45Z", "type": "commit"}, {"oid": "379f102312fbf08b9647a65ccc88f9e66cbf40d9", "url": "https://github.com/CorfuDB/CorfuDB/commit/379f102312fbf08b9647a65ccc88f9e66cbf40d9", "message": "Fix CorfuTable values() API that incorrectly deduplicates on return.\n\nCorfuTable values() API is inherited from Java Map interface, which\nis not supposed to perform deduplication on return. If CorfuTable\ncontains duplicates in values, the current values() API would return\nless values than expected. This patch fixes the API to return an\nimmutable list instead of a set.", "committedDate": "2020-04-13T19:30:45Z", "type": "forcePushed"}]}