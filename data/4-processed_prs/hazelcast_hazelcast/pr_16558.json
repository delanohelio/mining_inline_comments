{"pr_number": 16558, "pr_title": "Fix clusterViewListener Leak", "pr_createdAt": "2020-01-24T14:19:07Z", "pr_url": "https://github.com/hazelcast/hazelcast/pull/16558", "timeline": [{"oid": "893ea6c789ff44a9b6803d9dd330061a0160a110", "url": "https://github.com/hazelcast/hazelcast/commit/893ea6c789ff44a9b6803d9dd330061a0160a110", "message": "Fix clusterViewListener Leak\n\nIf connection closes while registering listener, we can get\nCancelledKeyException from initial push operation. Since we can\nnot add the necessary DestroyAction it was causing the leak.\n\nAdded catch and ignore for CancelledKeyException to avoid the problem.\n\nfixes https://github.com/hazelcast/hazelcast/issues/16482", "committedDate": "2020-01-24T14:11:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDY3NDEwMA==", "url": "https://github.com/hazelcast/hazelcast/pull/16558#discussion_r370674100", "bodyText": "Why are we also catching the exception here ? I get the reasoning of doing it on the register listener part but not here", "author": "mdumandag", "createdAt": "2020-01-24T14:53:43Z", "path": "hazelcast/src/main/java/com/hazelcast/client/impl/ClusterViewListenerService.java", "diffHunk": "@@ -87,7 +89,17 @@ private void sendToListeningEndpoints(ClientMessage clientMessage) {\n             ClientMessage message = clientMessage.copyWithNewCorrelationId(correlationId);\n             ClientEndpoint clientEndpoint = entry.getKey();\n             Connection connection = clientEndpoint.getConnection();\n+            write(message, connection);", "originalCommit": "893ea6c789ff44a9b6803d9dd330061a0160a110", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDgxMDA1NQ==", "url": "https://github.com/hazelcast/hazelcast/pull/16558#discussion_r370810055", "bodyText": "If we don't catch exception for one endpoint, we can not send events to other healthy endpoints", "author": "sancar", "createdAt": "2020-01-24T19:42:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDY3NDEwMA=="}], "type": "inlineReview"}]}