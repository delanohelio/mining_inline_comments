{"pr_number": 18007, "pr_title": "SQL statement type [IMDG-142]", "pr_createdAt": "2020-12-25T06:53:31Z", "pr_url": "https://github.com/hazelcast/hazelcast/pull/18007", "timeline": [{"oid": "011d731440f041388ab7442c06af4d5c43d177e1", "url": "https://github.com/hazelcast/hazelcast/commit/011d731440f041388ab7442c06af4d5c43d177e1", "message": "Works. Need to add tests.", "committedDate": "2020-12-23T10:58:46Z", "type": "commit"}, {"oid": "af2464f8b9db379a63fbe14c27278f2058f97c52", "url": "https://github.com/hazelcast/hazelcast/commit/af2464f8b9db379a63fbe14c27278f2058f97c52", "message": "WIP", "committedDate": "2020-12-24T15:52:15Z", "type": "commit"}, {"oid": "8904f6f3f0cf1064cdcb5b8ae5103805da8201e1", "url": "https://github.com/hazelcast/hazelcast/commit/8904f6f3f0cf1064cdcb5b8ae5103805da8201e1", "message": "Merge branch 'master' into sql-client-statement-type", "committedDate": "2020-12-25T06:04:51Z", "type": "commit"}, {"oid": "58dc0e6f619bc4f6b31ec1aeca6d800075771516", "url": "https://github.com/hazelcast/hazelcast/commit/58dc0e6f619bc4f6b31ec1aeca6d800075771516", "message": "Test", "committedDate": "2020-12-25T06:37:46Z", "type": "commit"}, {"oid": "2155b8659c281ad378ef5f3bb48b766dd45a5a98", "url": "https://github.com/hazelcast/hazelcast/commit/2155b8659c281ad378ef5f3bb48b766dd45a5a98", "message": "Checkstyle", "committedDate": "2020-12-25T06:40:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI5NjUwNQ==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549296505", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public static byte expectedResultTypeToBytes(SqlExpectedResultType expectedResultType) {\n          \n          \n            \n                public static byte expectedResultTypeToByte(SqlExpectedResultType expectedResultType) {", "author": "viliam-durina", "createdAt": "2020-12-28T10:28:28Z", "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/client/SqlClientUtils.java", "diffHunk": "@@ -38,4 +44,34 @@ public static SqlError exceptionToClientError(Exception exception, UUID localMem\n             sqlException.getOriginatingMemberId()\n         );\n     }\n+\n+    public static byte expectedResultTypeToBytes(SqlExpectedResultType expectedResultType) {", "originalCommit": "2155b8659c281ad378ef5f3bb48b766dd45a5a98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTMwMDI3MA==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549300270", "bodyText": "Applied the proposed change.", "author": "devozerov", "createdAt": "2020-12-28T10:40:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI5NjUwNQ=="}], "type": "inlineReview"}, {"oid": "4ea3d089535eb1a71923d6a70091baca5d49ba93", "url": "https://github.com/hazelcast/hazelcast/commit/4ea3d089535eb1a71923d6a70091baca5d49ba93", "message": "Minors", "committedDate": "2020-12-28T10:40:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTMwNjY1MQ==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549306651", "bodyText": "Consider, moving expectedResultTypeToByte and expectedResultTypeToEnum method into SqlExpectedResultType enum with name something like toByte or expectedResultType and fromByte.\nThen we could use SqlExpectedResultType#toByte and would need to change this switch statement.\nWDYT?", "author": "alex-dukhno", "createdAt": "2020-12-28T11:02:42Z", "path": "hazelcast/src/main/java/com/hazelcast/sql/impl/client/SqlClientUtils.java", "diffHunk": "@@ -38,4 +44,34 @@ public static SqlError exceptionToClientError(Exception exception, UUID localMem\n             sqlException.getOriginatingMemberId()\n         );\n     }\n+\n+    public static byte expectedResultTypeToByte(SqlExpectedResultType expectedResultType) {", "originalCommit": "4ea3d089535eb1a71923d6a70091baca5d49ba93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTMwOTAyNw==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549309027", "bodyText": "SqlExpectedResultType is a public API, I would avoid exposing internals from there.", "author": "devozerov", "createdAt": "2020-12-28T11:10:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTMwNjY1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQwMDUxOA==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549400518", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             */\n          \n          \n            \n             * @since 4.2\n          \n          \n            \n             */", "author": "viliam-durina", "createdAt": "2020-12-28T16:07:36Z", "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlExpectedResultType.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright (c) 2008-2020, Hazelcast, Inc. All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.hazelcast.sql;\n+\n+/**\n+ * The expected statement result type.\n+ */", "originalCommit": "4ea3d089535eb1a71923d6a70091baca5d49ba93", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQwMDY1OA==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549400658", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 */\n          \n          \n            \n                 * @since 4.2\n          \n          \n            \n                 */", "author": "viliam-durina", "createdAt": "2020-12-28T16:08:01Z", "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlStatement.java", "diffHunk": "@@ -273,14 +282,39 @@ public SqlStatement setCursorBufferSize(int cursorBufferSize) {\n         return this;\n     }\n \n+    /**\n+     * Gets the expected result type.\n+     *\n+     * @return expected result type\n+     */", "originalCommit": "4ea3d089535eb1a71923d6a70091baca5d49ba93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk1MTQzNA==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549951434", "bodyText": "Applied.", "author": "devozerov", "createdAt": "2020-12-30T06:39:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQwMDY1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQwMDc1OA==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549400758", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 */\n          \n          \n            \n                 * @since 4.2\n          \n          \n            \n                 */", "author": "viliam-durina", "createdAt": "2020-12-28T16:08:19Z", "path": "hazelcast/src/main/java/com/hazelcast/sql/SqlStatement.java", "diffHunk": "@@ -273,14 +282,39 @@ public SqlStatement setCursorBufferSize(int cursorBufferSize) {\n         return this;\n     }\n \n+    /**\n+     * Gets the expected result type.\n+     *\n+     * @return expected result type\n+     */\n+    @Nonnull\n+    public SqlExpectedResultType getExpectedResultType() {\n+        return expectedResultType;\n+    }\n+\n+    /**\n+     * Sets the expected result type.\n+     *\n+     * @param expectedResultType expected result type\n+     * @return this instance for chaining\n+     */", "originalCommit": "4ea3d089535eb1a71923d6a70091baca5d49ba93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk1MTQ1Mw==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549951453", "bodyText": "Applied.", "author": "devozerov", "createdAt": "2020-12-30T06:40:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQwMDc1OA=="}], "type": "inlineReview"}, {"oid": "a85129d208d810575379f34d4c143ac826299dc6", "url": "https://github.com/hazelcast/hazelcast/commit/a85129d208d810575379f34d4c143ac826299dc6", "message": "Added \"since\".", "committedDate": "2020-12-30T06:39:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk1NDQ5Ng==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549954496", "bodyText": "Looks like there is a typo on the protocol side. specifiec  -> specified\nI know it is not related to your work but would you mind fixing that for us?", "author": "sancar", "createdAt": "2020-12-30T06:46:05Z", "path": "hazelcast/src/main/java/com/hazelcast/client/impl/protocol/codec/ClientRemoveMigrationListenerCodec.java", "diffHunk": "@@ -34,9 +34,9 @@\n  */\n \n /**\n- * Removes a Migration listener to the cluster.\n+ * Removes the specifiec migration listener.", "originalCommit": "a85129d208d810575379f34d4c143ac826299dc6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk4Mjg4MA==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r549982880", "bodyText": "Fixed.", "author": "devozerov", "createdAt": "2020-12-30T07:25:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk1NDQ5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDA2OTIwMA==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r550069200", "bodyText": "Reverted back because it leads to test failures.", "author": "devozerov", "createdAt": "2020-12-30T09:19:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk1NDQ5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDA3MTYyNQ==", "url": "https://github.com/hazelcast/hazelcast/pull/18007#discussion_r550071625", "bodyText": "Fixed through protocol generator.", "author": "devozerov", "createdAt": "2020-12-30T09:22:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTk1NDQ5Ng=="}], "type": "inlineReview"}, {"oid": "2d1b8da58d66950426fd2e44e23c3bb1069e424d", "url": "https://github.com/hazelcast/hazelcast/commit/2d1b8da58d66950426fd2e44e23c3bb1069e424d", "message": "Typo", "committedDate": "2020-12-30T07:25:24Z", "type": "commit"}, {"oid": "063f756558dcda479b70592aad30e806268b10ce", "url": "https://github.com/hazelcast/hazelcast/commit/063f756558dcda479b70592aad30e806268b10ce", "message": "Revert back typo.", "committedDate": "2020-12-30T09:20:08Z", "type": "commit"}, {"oid": "c67527add73ee2983762802407c023f1a12041da", "url": "https://github.com/hazelcast/hazelcast/commit/c67527add73ee2983762802407c023f1a12041da", "message": "Revert back typo.", "committedDate": "2020-12-30T09:20:23Z", "type": "commit"}, {"oid": "d65a40e8e2c00690131bb6e55a6410aead48a607", "url": "https://github.com/hazelcast/hazelcast/commit/d65a40e8e2c00690131bb6e55a6410aead48a607", "message": "Fixed typo", "committedDate": "2020-12-30T09:22:13Z", "type": "commit"}]}