{"pr_number": 16521, "pr_title": "Make member metrics JMX exposure to respect JMX sysprop", "pr_createdAt": "2020-01-21T16:04:48Z", "pr_url": "https://github.com/hazelcast/hazelcast/pull/16521", "timeline": [{"oid": "f0886dc75ecec87d393ecada57c31b75aad43965", "url": "https://github.com/hazelcast/hazelcast/commit/f0886dc75ecec87d393ecada57c31b75aad43965", "message": "Make member metrics JMX exposure to respect JMX sysprop\n\nThis change makes metrics and other MBean exposures consistent. Before,\nMetrics MBeans did not respect the \"hazelcast.jmx\" property, and those\nMBeans were exposed even if JMX was not enabled. Now, both the JMX\nconfig and the \"hazelcast.jmx\" property needs to be set to expose the\nMetrics.\n\nOn the client side there is no such property, therefore, enabling JMX\nexposure for metrics in the config is enough.", "committedDate": "2020-01-21T16:02:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNDYyNQ==", "url": "https://github.com/hazelcast/hazelcast/pull/16521#discussion_r369424625", "bodyText": "Since the JMX system property is not cleared in the other test methods, I think this test can see it as true?", "author": "vojtechtoman", "createdAt": "2020-01-22T08:32:54Z", "path": "hazelcast/src/test/java/com/hazelcast/internal/metrics/jmx/MemberJmxMetricsTest.java", "diffHunk": "@@ -63,4 +89,50 @@ public void testNoMBeanLeak() {\n         member.shutdown();\n         helper.assertNoMBeans();\n     }\n+\n+    @Test\n+    public void testMetricsNotExposedOverJmxIfSysPropIsNotSet() throws Exception {", "originalCommit": "f0886dc75ecec87d393ecada57c31b75aad43965", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTUzODE3NQ==", "url": "https://github.com/hazelcast/hazelcast/pull/16521#discussion_r369538175", "bodyText": "Good catch @vojtechtoman \ud83d\udc4d Added clearing the sysprop to @Before.", "author": "blazember", "createdAt": "2020-01-22T12:45:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNDYyNQ=="}], "type": "inlineReview"}, {"oid": "1566754487c463a23db943e7d451dc0349944c74", "url": "https://github.com/hazelcast/hazelcast/commit/1566754487c463a23db943e7d451dc0349944c74", "message": "Address review comment", "committedDate": "2020-01-22T12:43:40Z", "type": "commit"}]}