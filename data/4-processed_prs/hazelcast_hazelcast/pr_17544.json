{"pr_number": 17544, "pr_title": "Detail contribution guidelines", "pr_createdAt": "2020-09-15T09:22:21Z", "pr_url": "https://github.com/hazelcast/hazelcast/pull/17544", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDM1Nw==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r493250357", "bodyText": "I would mention also reaching us via Slack to discuss if needed.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            \n          \n          \n            \n            If you need any assistance or brainstorming, create a GH issue to discuss or reach us directly via [Slack](https://slack.hazelcast.com/).", "author": "Holmistr", "createdAt": "2020-09-23T07:17:11Z", "path": "CONTRIBUTING.md", "diffHunk": "@@ -1,25 +1,58 @@\n # Contributing to Hazelcast\n \n-It makes you feel good...\n+Hazelcast is Open Source software, licensed under the [Apache 2.0. license](LICENSE).\n+The main benefit of Open Source is that you don't need to wait for a vendor to provide a fix or a feature.\n+If you've got the skills (and the will), it's already at your fingertips.\n+\n+There are multiple ways to contribute:\n+\n+1. [Reporting an issue](#issue-reports)\n+2. [Sending a pull request](#pull-requests).\n+Note that you don't need to be a developer to help us.\n+Contributions that improve the documentation are always appreciated.\n ", "originalCommit": "d0bfa7d396d65857bbb7ea63a9596a6904795635", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1NDA2OQ==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r493254069", "bodyText": "I'm much more in favor of Slack instead of GH. IMHO, there are already too many people creating issues that shouldn't be created in the first place.", "author": "nfrankel", "createdAt": "2020-09-23T07:23:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDM1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDcxMg==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r493250712", "bodyText": "We should suggest skipping tests as they take hours.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            6.\tBefore you push, run the command `mvn clean package -P checkstyle,spotbugs` in your terminal and fix the CheckStyle and SpotBugs errors if any.\n          \n          \n            \n            6.\tBefore you push, run the command `mvn clean package -Pcheckstyle,spotbugs -DskipTests` in your terminal and fix the CheckStyle and SpotBugs errors if any.", "author": "Holmistr", "createdAt": "2020-09-23T07:17:52Z", "path": "CONTRIBUTING.md", "diffHunk": "@@ -1,25 +1,58 @@\n # Contributing to Hazelcast\n \n-It makes you feel good...\n+Hazelcast is Open Source software, licensed under the [Apache 2.0. license](LICENSE).\n+The main benefit of Open Source is that you don't need to wait for a vendor to provide a fix or a feature.\n+If you've got the skills (and the will), it's already at your fingertips.\n+\n+There are multiple ways to contribute:\n+\n+1. [Reporting an issue](#issue-reports)\n+2. [Sending a pull request](#pull-requests).\n+Note that you don't need to be a developer to help us.\n+Contributions that improve the documentation are always appreciated.\n \n ## Issue Reports\n-Thanks for reporting your issue.  Please share with us the following information, to help us resolve your issue quickly and efficiently.\n-1.\tHazelcast version that you use (e.g. 4.0.1, also specify whether it is a minor release or the latest snapshot).\n-2.\tCluster size, i.e. the number of Hazelcast cluster members.\n-3.\tNumber of the clients.\n-4.\tVersion of Java. It is also helpful to mention the JVM parameters.\n-5.\tOperating system. If it is Linux, kernel version is helpful.\n+\n+Thanks for reporting your issue.\n+To help us resolve your issue quickly and efficiently, we need as much data for diagnostics as possible.\n+Please share with us the following information:\n+\n+1.\tExact Hazelcast version that you use (_e.g._ 4.0.1, also whether it is a minor release, or the latest snapshot).\n+2.\tCluster size, _i.e._ the number of Hazelcast cluster members.\n+3.\tNumber of clients.\n+4.\tJava version.\n+It is also helpful to mention the JVM parameters.\n+5.\tOperating system.\n+If it is Linux, kernel version is helpful.\n 6.\tLogs and stack traces, if available.\n 7.\tDetailed description of the steps to reproduce your issue.\n-8.\tUnit test with the `hazelcast.xml` file. If you could include a unit test which reproduces your issue, we would be grateful.\n-9.\tIf available, integration module versions (e.g. Tomcat, Jetty, Spring, Hibernate). Also, include their  detailed configuration information such as `web.xml`, Hibernate configuration and `context.xml` for Spring.\n-\n-## Pull Requests\n-Thanks for creating your pull request (PR).\n-1.\tContributions are submitted, reviewed, and accepted using the pull requests on GitHub.\n-2.\tOur bot will automatically ask you on the PR to sign the Hazelcast Contributor Agreement.\n-3.\tTry to make clean commits that are easily readable (including descriptive commit messages).\n-4.\tThe latest changes are in the **master** branch.\n-5.\tBefore you push, run the command `mvn clean package -P checkstyle,spotbugs` in your terminal and fix the CheckStyle and SpotBugs errors (if any). Push your PR once it is free of CheckStyle and SpotBugs errors.\n-6.\tPlease keep your PRs as small as possible, i.e. if you plan to perform a huge change, do not submit a single and large PR for it. For an enhancement or larger feature, you can create a GitHub issue first to discuss.\n+8.\tUnit test with the `hazelcast.xml` file.\n+If you could include a unit test which reproduces your issue, it would speed the resolution time.\n+9.\tIf available, integration module versions (_e.g._ Tomcat, Jetty, Spring, Hibernate).\n+Also, include their  detailed configuration information such as `web.xml`, Hibernate configuration and `context.xml` for Spring.\n+\n+## Pull requests\n+\n+Thanks a lot for creating your <abbr title=\"Pull Request\">PR</abbr>!\n+\n+A PR can target many different subjects:\n+\n+* [Documentation](https://github.com/hazelcast/hazelcast-reference-manual):\n+either fix typos or improve the documentation as a whole\n+* Fix a bug\n+* Add a feature\n+* Add additional tests to improve the test coverage, or fix flaky tests\n+* Anything else that makes Hazelcast better!\n+\n+All PRs follow the same process:\n+\n+1.\tContributions are submitted, reviewed, and accepted using the PR system on GitHub.\n+2.\tFor first time contributors, our bot will automatically ask you to sign the Hazelcast Contributor Agreement on the PR.\n+3.\tThe latest changes are in the `master` branch.\n+4.\tMake sure to design clean commits that are easily readable.\n+That includes descriptive commit messages.\n+5.\tPlease keep your PRs as small as possible, _i.e._ if you plan to perform a huge change, do not submit a single and large PR for it.\n+For an enhancement or larger feature, you can create a GitHub issue first to discuss.\n+6.\tBefore you push, run the command `mvn clean package -P checkstyle,spotbugs` in your terminal and fix the CheckStyle and SpotBugs errors if any.", "originalCommit": "d0bfa7d396d65857bbb7ea63a9596a6904795635", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MzA3NQ==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r493253075", "bodyText": "You don't want people to fail their tests before pushing? \ud83e\udd14 Perhaps there's a battery of tests (true unit tests) that can be ran quickly", "author": "nfrankel", "createdAt": "2020-09-23T07:22:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI3NTQ2NQ==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r493275465", "bodyText": "Usually they can run tests they've created and possibly QuickTest tests in the same package. For instance, when adding a feature on top of IQueue, running all queue tests. But often times it takes tens of minutes or even hours to run tests on a home computer as running them on our lab machines takes up to 40 minutes.", "author": "mmedenjak", "createdAt": "2020-09-23T07:55:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA2NzEzNg==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r494067136", "bodyText": "That's kind of my point. The default set of tests executed by mvn clean package will take ~3 hours. Noone will ever run that and definitely not repeatedly. We have PR builder, we can verify that on our side.", "author": "Holmistr", "createdAt": "2020-09-24T06:28:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA3MTE0OA==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r494071148", "bodyText": "Ok.\n\nAs a former engineer (and build master), I don't understand why we haven't a clear separation between \"quick\" tests in the test phase, and other tests in the integration-test phase. I understand once those are here, it's time-consuming to triage, but the benefits are huge.\nWhy do we ask for package instead of just compile? Do we do some black magic in package? (asking for a friend, of course)", "author": "nfrankel", "createdAt": "2020-09-24T06:38:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA5MDM3NA==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r494090374", "bodyText": "We actually have the categories, quick and slow tests. And those quick tests are actually run in test phase. By a quick test we mean that the test itself is running pretty quickly. But we have so many of them, so it takes hours. About your triage, how would you then select the tests that should be run by default? Hazelcast is a huuuuge project, how do you pick the testsuite that actually gives you some sort of confidence? This is what the default test does, but then, it takes hours. So IMHO the proposal sounds nice on the paper, but to execute it to get a reasonable running time and some actual information about correctness is in practise not really possible.\n\n\nI guess the intention is that the package will actually run the tests :)\n\n\nHaving this discussion, I realize that maybe my initial proposal is wrong. We shouldn't advertise to skip the tests right away. We kind of know that nobody will ever run it, but let's not advertise and let them skip it themselves. In addition to actually have some useful information, we could add a note how to run only some specific tests, i. e. using -Dtest=.... WDYT?", "author": "Holmistr", "createdAt": "2020-09-24T07:17:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDA5Mjk3OA==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r494092978", "bodyText": "I think that between not running tests at all and running all tests, there must be a sweet spot. That's actually a good idea to provide a basic test harness.\nJust tell me what parameter I need to pass. Then we can call mvn clean test -Dtest=... and not package", "author": "nfrankel", "createdAt": "2020-09-24T07:22:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDEwMDgxNA==", "url": "https://github.com/hazelcast/hazelcast/pull/17544#discussion_r494100814", "bodyText": "I do agree it would be nice (or simply interesting?) if there was a category of \"smoke\" tests that the user might run locally. Thing is, since I've joined, there were already more than 20k tests in the QuickTest category so it would first take an effort to identify the basic ones which are worth their own category to run locally.\nSecondly, the PR builder always took about 30-40 minutes so most of the time, it was simpler for everyone involved to simply push the commit and get feedback from all 20k - 30k tests. Running fewer tests (e.g. 1k) might feel good (as if nothing has been broken) but I'm not sure what kind of coverage we would have with that set of tests, and again the full suite would be run as soon as the commit was pushed, which would uncover many more issues.\nAlso, a lot of the times community PRs fail on checkstyle and findbugs. We say users should run them, but they don't. So really, I don't expect users to run even 1k tests locally :)\nFinally, I do see some room for improvement. I don't believe we actually need about 30k tests that we have now and I'm sure there is lots of duplication. What would be great if we could clean up the test codebase to decrease the number of tests, decrease the PR builder time and maybe even make it possible to run some sensible set of tests locally. But, it's a lot of work and we'll probably iteratively clean up tests as we work on the relevant code and I don't think we'll reach the final state any time soon.", "author": "mmedenjak", "createdAt": "2020-09-24T07:36:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzI1MDcxMg=="}], "type": "inlineReview"}, {"oid": "3cf0352901b78d74e22a628b877af5bca4f64cba", "url": "https://github.com/hazelcast/hazelcast/commit/3cf0352901b78d74e22a628b877af5bca4f64cba", "message": "Detail contribution guidelines", "committedDate": "2020-09-23T07:25:14Z", "type": "forcePushed"}, {"oid": "82a193a09a16d7b8c70ac67388d0a0624fbe0f3a", "url": "https://github.com/hazelcast/hazelcast/commit/82a193a09a16d7b8c70ac67388d0a0624fbe0f3a", "message": "Detail contribution guidelines", "committedDate": "2020-09-24T06:35:02Z", "type": "commit"}, {"oid": "82a193a09a16d7b8c70ac67388d0a0624fbe0f3a", "url": "https://github.com/hazelcast/hazelcast/commit/82a193a09a16d7b8c70ac67388d0a0624fbe0f3a", "message": "Detail contribution guidelines", "committedDate": "2020-09-24T06:35:02Z", "type": "forcePushed"}]}