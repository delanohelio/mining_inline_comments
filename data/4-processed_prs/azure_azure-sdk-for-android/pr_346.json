{"pr_number": 346, "pr_title": "Create a new PR for paging support in Android core", "pr_createdAt": "2020-09-16T00:42:31Z", "pr_url": "https://github.com/Azure/azure-sdk-for-android/pull/346", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA5ODEzOA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489098138", "bodyText": "We should be using com.azure.android.core.http.Response<T> as the type to represent a response with an associated strongly-typed response body object. Is there any reason we aren't doing that here?", "author": "bsiegel", "createdAt": "2020-09-16T00:53:33Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java", "diffHunk": "@@ -0,0 +1,121 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+\n+import okhttp3.Response;\n+\n+/**\n+ * Represents a collection of pages where page data and response for retrieving it can be returned asynchronously\n+ * @param <T> type of the items in the page\n+ * @param <P> Page of items\n+ */\n+public class AsyncPagedDataCollection<T, P extends Page<T>> {\n+    private final AsyncPagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, PageAndResponse<P>> pages = new LinkedHashMap<String, PageAndResponse<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Construction requires an asynchronous paged data provider\n+     * @param pagedDataRetriever an asynchronous page data provider\n+     */\n+    public AsyncPagedDataCollection(AsyncPagedDataRetriever<T, P> pagedDataRetriever) {\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    private void cacheResponse(P page, Response response) {\n+        if (page.getPageId() == null) {\n+            return;\n+        }\n+        pages.put(page.getPageId(), new PageAndResponse<P>(page, response));\n+\n+        // setting previous page id should simplify implementation for androidx.arch.DataSource\n+        final Iterator<PageAndResponse<P>> iterator = pages.values().iterator();\n+        while(iterator.hasNext()){\n+            final P existingPage = iterator.next().page;\n+            if (page.getPageId().equals(existingPage.getNextPageId())){\n+                page.setPreviousPageId(existingPage.getPageId());\n+                break;\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Gets first page in the collection along with the response retrieving the first page\n+     * @param callback a callback interface for handling the first page and its response\n+     */\n+    public void getFirstPage(Callback<P> callback) {\n+        if (firstPageId == null){\n+            pagedDataRetriever.getFirstPage(new Callback<P>() {\n+\n+                @Override\n+                public void onSuccess(P value, Response response) {\n+                    if (value == null) {\n+                        callback.onSuccess(value, response);\n+                        return;\n+                    }\n+\n+                    firstPageId = value.getPageId();\n+                    cacheResponse(value, response);\n+                    callback.onSuccess(value, response);\n+                }\n+\n+                @Override\n+                public void onFailure(Throwable t, Response response) {\n+                    callback.onFailure(t, response);\n+                }\n+            });\n+        }\n+        else {\n+            PageAndResponse<P> firstPageResponse = pages.get(firstPageId);\n+            callback.onSuccess(firstPageResponse.page, firstPageResponse.response);\n+        }\n+    }\n+\n+    /**\n+     * Retrieve a page by its id\n+     * @param pageId id of the page\n+     * @param callback callback interface for handling the page along with its response\n+     */\n+    public void getPage(String pageId, Callback<P> callback) {\n+        PageAndResponse<P> pageEntry = pages.get(pageId);\n+        if (pageEntry == null){\n+            pagedDataRetriever.getPage(pageId, new Callback<P>() {\n+                @Override\n+                public void onSuccess(P value, Response response) {\n+                    if (value == null) {\n+                        callback.onSuccess(null, response);\n+                    }\n+\n+                    cacheResponse(value, response);\n+                    callback.onSuccess(value, response);\n+                }\n+\n+                @Override\n+                public void onFailure(Throwable t, Response response) {\n+                    callback.onFailure(t, response);\n+                }\n+            });\n+        }\n+        else {\n+            callback.onSuccess(pageEntry.page, pageEntry.response);\n+        }\n+    }\n+\n+    private static class PageAndResponse<P> {", "originalCommit": "e9419dd2934c799b184e02f396f36ec864d736a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMjU4NA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489102584", "bodyText": "My bad. I thought this was the old one. ;-)\nThe reason for PageAndResponse is this collection has an interface where getFirstPage and getPage both take a Callback<P> where both Page and okhttp3.Response are supposed to be returned. Unless we change the callback signature, we'd have to keep both in order to hand back the okhttp3.Response.", "author": "JianpingChen", "createdAt": "2020-09-16T01:10:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA5ODEzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5MDY2MA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r490490660", "bodyText": "Leaving as-is for this preview.", "author": "bsiegel", "createdAt": "2020-09-17T19:07:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA5ODEzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg3ODcwMA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497878700", "bodyText": "Adding to this for later discussion: We can definitely handle the given okhttp3.Response in the callback and map its contents to our own Response<T> type. I think we did that in Storage at some point.", "author": "vcolin7", "createdAt": "2020-10-01T00:31:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA5ODEzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDI3MQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489100271", "bodyText": "How is the pageId supposed to be communicated to the developer? Is it an opaque identifier (e.g. GUID)? I would expect getPage(int pageNumber, Callback callback) or something similar, otherwise the developer has to do book-keeping.\nAlternatively, why not keep the current page number in the instance's local state, and have a getNextPage(Callback callback) method (and a simple getter, getCurrentPageNumber()or some such) instead?", "author": "bsiegel", "createdAt": "2020-09-16T01:01:42Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Objects;\n+\n+/**\n+ * Represents an asynchronous paged data provider with fixed page size\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public abstract class AsyncPagedDataRetriever<T, P extends Page<T>> {\n+    private final int pageSize;\n+\n+    /**\n+     * Constructor requires the fixed page size\n+     * @param pageSize size of the pages\n+     */\n+    public AsyncPagedDataRetriever(int pageSize){\n+        Objects.requireNonNull(pageSize);\n+        if (pageSize <= 0)\n+            throw new IllegalArgumentException(\"pageSize must be a positive integer\");\n+        this.pageSize = pageSize;\n+    }\n+\n+    /**\n+     * Gets the size of the page\n+     * @return size of the page\n+     */\n+    public int getPageSize(){\n+        return this.pageSize;\n+    }\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @param callback callback function to handle the page data along with the response for retrieving it\n+     */\n+    public abstract void getFirstPage(Callback<P> callback);\n+\n+    /**\n+     * Retrieve a page with its id\n+     * @param pageId id of the page\n+     * @param callback callback function to handle the page data along with the response for retrieving it\n+     */\n+    public abstract void getPage(String pageId, Callback<P> callback);", "originalCommit": "e9419dd2934c799b184e02f396f36ec864d736a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDgxOA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489100818", "bodyText": "I guess this comment isn't specific to this file, but just to the general design.", "author": "bsiegel", "createdAt": "2020-09-16T01:03:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDI3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwNDA0MQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489104041", "bodyText": "For the need of autorest.android, the String id is meant to be opaque. I even had a page iterator function in the collection trying to hide the pageId altogether but it turned out to be overly complicated (in thread synchronization). So we agreed to remove the iterator implementation.\nWe looked at using this interface to implement androidx.arch.DataSource in my initial Draft PR. Having an opaque page id is more convenient than int id for that particular purpose. That's the reason we settled with an opaque string id.\nc.f https://developer.android.com/reference/androidx/paging/PageKeyedDataSource", "author": "JianpingChen", "createdAt": "2020-09-16T01:15:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDI3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTczNzE5NQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489737195", "bodyText": "Thinking a bit more about it:\nThe paged collection = retrieve pages from service via network + caching of the pages.\nWondering, whether it makes sense to have the following signature:\n// group_1: calls go over network.\nvoid getFirstPage(Callback<Page<T>> callback);\nvoid getNextPage(Callback<Page<T>> callback);\n// group_2: an immutable map of cached pages.\nMap<String, Page<T>> getCachedPages();\n// an immutable list of items in the cached pages.\nList<T> getCachedItems();\nOnly the APIs that belongs to the group_1 provides access to the Response object.", "author": "anuchandy", "createdAt": "2020-09-16T20:32:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDI3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5MDcyOA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r490490728", "bodyText": "Leaving as-is for this preview.", "author": "bsiegel", "createdAt": "2020-09-17T19:07:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDI3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDk2OQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489100969", "bodyText": "Is this the sync version of AsyncPagedDataCollection? If so, they should have similar names. E.g. PagedDataCollection.", "author": "bsiegel", "createdAt": "2020-09-16T01:04:23Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseCollection.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+\n+/**\n+ * Represents a collection of pages where page and the response for retrieving it can be returned synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataResponseCollection<T, P extends Page<T>> {", "originalCommit": "e9419dd2934c799b184e02f396f36ec864d736a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwNTM1OQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489105359", "bodyText": "There is a PagedDataCollection in util.paging. We can rename AsyncPagedDataCollection to AsyncPagedDataResponseCollection", "author": "JianpingChen", "createdAt": "2020-09-16T01:20:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5MTI0Ng==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r490491246", "bodyText": "Okay, I understand why they are the way they are, no need to rename.", "author": "bsiegel", "createdAt": "2020-09-17T19:08:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMDk2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTExNw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489101117", "bodyText": "Likewise if this is the sync version of AsyncPagedDataRetriever, let's make this PagedDataRetriever.", "author": "bsiegel", "createdAt": "2020-09-16T01:04:57Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseRetriever.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Objects;\n+\n+/**\n+ * Represents a synchronized paged data provider with fixed page size that returns both page and response\n+ * @param <T> type of the items in the page\n+ * @param <P> type of the page\n+ */\n+public abstract class PagedDataResponseRetriever<T, P extends Page<T>> {", "originalCommit": "e9419dd2934c799b184e02f396f36ec864d736a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwNTY1Nw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489105657", "bodyText": "There is a PagedDataRetriever in util.paging which does not return Response.", "author": "JianpingChen", "createdAt": "2020-09-16T01:21:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTExNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5MTM2Ng==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r490491366", "bodyText": "Leaving as is", "author": "bsiegel", "createdAt": "2020-09-17T19:08:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTExNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTE5MQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489101191", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Represents a synchronized paged data provider with fixed page size that returns both page and response\n          \n          \n            \n             * Represents a synchronous paged data provider with fixed page size that returns both page and response", "author": "bsiegel", "createdAt": "2020-09-16T01:05:11Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseRetriever.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Objects;\n+\n+/**\n+ * Represents a synchronized paged data provider with fixed page size that returns both page and response", "originalCommit": "e9419dd2934c799b184e02f396f36ec864d736a1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTUxMQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489101511", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Represents a collection of paged data with fixed page size where pages can be retrieved synchrounously\n          \n          \n            \n             * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously", "author": "bsiegel", "createdAt": "2020-09-16T01:06:27Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchrounously", "originalCommit": "e9419dd2934c799b184e02f396f36ec864d736a1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTc0MQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489101741", "bodyText": "Not clear why there is a separate set of classes for paged data vs. paged data + response, but only for sync (for async there is only paged data + response).", "author": "bsiegel", "createdAt": "2020-09-16T01:07:16Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchrounously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {", "originalCommit": "e9419dd2934c799b184e02f396f36ec864d736a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwNjk1NA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489106954", "bodyText": "When autorest.android generates sync client, for each function in underlying service, e.g. service.getBlah(), sync client is supposed to have two versions of the same function in its interface, syncClient.getBlah(): Blah, and syncClient.getBlahWithResponse(): Response<Blah>. That's why we have two sets for sync client.", "author": "JianpingChen", "createdAt": "2020-09-16T01:26:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTc0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwNzY2MQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r489107661", "bodyText": "For async client, the Callback<Blah> can return both Blah and okhttp3.Response. Therefore there is no need to have two function signatures for each service.getBlah function.", "author": "JianpingChen", "createdAt": "2020-09-16T01:28:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTc0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ5MTUwOQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r490491509", "bodyText": "Leaving as-is for this preview.", "author": "bsiegel", "createdAt": "2020-09-17T19:08:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTEwMTc0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ4MTY1Nw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r490481657", "bodyText": "We need to add the license header here.", "author": "vcolin7", "createdAt": "2020-09-17T18:50:50Z", "path": "sdk/core/azure-core/src/test/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollectionTest.java", "diffHunk": "@@ -0,0 +1,131 @@\n+package com.azure.android.core.http.responsepaging;", "originalCommit": "db1ec16164cc6c5044910eec4dd5acb8042e4e21", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ4MTY4Ng==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r490481686", "bodyText": "We need to add the license header here.", "author": "vcolin7", "createdAt": "2020-09-17T18:50:55Z", "path": "sdk/core/azure-core/src/test/java/com/azure/android/core/http/responsepaging/PagedDataResponseCollectionTest.java", "diffHunk": "@@ -0,0 +1,114 @@\n+package com.azure.android.core.http.responsepaging;", "originalCommit": "db1ec16164cc6c5044910eec4dd5acb8042e4e21", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ4MTcyNA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r490481724", "bodyText": "We need to add the license header here.", "author": "vcolin7", "createdAt": "2020-09-17T18:50:59Z", "path": "sdk/core/azure-core/src/test/java/com/azure/android/core/util/paging/PagedDataCollectionTest.java", "diffHunk": "@@ -0,0 +1,109 @@\n+package com.azure.android.core.util.paging;", "originalCommit": "db1ec16164cc6c5044910eec4dd5acb8042e4e21", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "af6f9428c9a5d225c1e7261be5e0af9b0e57213d", "url": "https://github.com/Azure/azure-sdk-for-android/commit/af6f9428c9a5d225c1e7261be5e0af9b0e57213d", "message": "Create a new PR for paging support in Android core", "committedDate": "2020-09-23T00:09:17Z", "type": "commit"}, {"oid": "e9bdcb9d2251ac473e42056a7b0bdbf9f7a65c45", "url": "https://github.com/Azure/azure-sdk-for-android/commit/e9bdcb9d2251ac473e42056a7b0bdbf9f7a65c45", "message": "Fix JavaDoc typos", "committedDate": "2020-09-23T00:09:17Z", "type": "commit"}, {"oid": "d836a45471460352aa30f58c2f90257ee864c10d", "url": "https://github.com/Azure/azure-sdk-for-android/commit/d836a45471460352aa30f58c2f90257ee864c10d", "message": "Add NonNull annotation and Objects.requiredNonNull", "committedDate": "2020-09-23T00:09:18Z", "type": "commit"}, {"oid": "571f62bc4a70ff8d7dd133847e9fe5a8525a14fe", "url": "https://github.com/Azure/azure-sdk-for-android/commit/571f62bc4a70ff8d7dd133847e9fe5a8525a14fe", "message": "Fix a JavaDoc inconsistency", "committedDate": "2020-09-23T00:09:18Z", "type": "commit"}, {"oid": "eb3a502f32a6269502c9175d7a7e6522712e7fd9", "url": "https://github.com/Azure/azure-sdk-for-android/commit/eb3a502f32a6269502c9175d7a7e6522712e7fd9", "message": "Create a new PR for paging support in Android core", "committedDate": "2020-09-24T00:23:03Z", "type": "commit"}, {"oid": "0aa2c90cd900e8ce640a66a4248d2347db8f82d9", "url": "https://github.com/Azure/azure-sdk-for-android/commit/0aa2c90cd900e8ce640a66a4248d2347db8f82d9", "message": "Add license to test code files", "committedDate": "2020-09-24T00:24:31Z", "type": "commit"}, {"oid": "874a04da7c8e28de23a04e8d491bcc2fa0631650", "url": "https://github.com/Azure/azure-sdk-for-android/commit/874a04da7c8e28de23a04e8d491bcc2fa0631650", "message": "Add another constructor for convenience", "committedDate": "2020-09-24T00:24:31Z", "type": "commit"}, {"oid": "499768ae9c9108a2615e8787a7326a29a5781bae", "url": "https://github.com/Azure/azure-sdk-for-android/commit/499768ae9c9108a2615e8787a7326a29a5781bae", "message": "Remove page size from retriever constructors since it only makes it harder for autorest.android", "committedDate": "2020-09-28T16:15:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzMTYyNA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497831624", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    nextPageId = nextPageId;\n          \n          \n            \n                    this.nextPageId = nextPageId;", "author": "vcolin7", "createdAt": "2020-09-30T22:16:02Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzMjE5MA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497832190", "bodyText": "For consistency.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return nextPageId;\n          \n          \n            \n                    return this.nextPageId;", "author": "vcolin7", "createdAt": "2020-09-30T22:17:28Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id\n+     * @param nextPageId id of the page next to this page\n+     * @return current page\n+     */\n+    public Page<T> setNextPageId(@NonNull String nextPageId) {\n+        this.nextPageId = nextPageId;\n+        return this;\n+    }\n+\n+    /**\n+     * Get id of the page next to this page\n+     * @return id of the next page\n+     */\n+    public String getNextPageId() {\n+        return nextPageId;", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzMjI4NQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497832285", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Set previous page id\n          \n          \n            \n                 * Set the previous page id", "author": "vcolin7", "createdAt": "2020-09-30T22:17:44Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id\n+     * @param nextPageId id of the page next to this page\n+     * @return current page\n+     */\n+    public Page<T> setNextPageId(@NonNull String nextPageId) {\n+        this.nextPageId = nextPageId;\n+        return this;\n+    }\n+\n+    /**\n+     * Get id of the page next to this page\n+     * @return id of the next page\n+     */\n+    public String getNextPageId() {\n+        return nextPageId;\n+    }\n+\n+    /**\n+     * Set previous page id", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzMjQxMA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497832410", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Get id of the page before current page\n          \n          \n            \n                 * Get the previous page id", "author": "vcolin7", "createdAt": "2020-09-30T22:18:05Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id\n+     * @param nextPageId id of the page next to this page\n+     * @return current page\n+     */\n+    public Page<T> setNextPageId(@NonNull String nextPageId) {\n+        this.nextPageId = nextPageId;\n+        return this;\n+    }\n+\n+    /**\n+     * Get id of the page next to this page\n+     * @return id of the next page\n+     */\n+    public String getNextPageId() {\n+        return nextPageId;\n+    }\n+\n+    /**\n+     * Set previous page id\n+     * @param previousPageId id of the page before this page\n+     * @return current page\n+     */\n+    public Page<T> setPreviousPageId(@NonNull String previousPageId) {\n+        this.previousPageId = previousPageId;\n+        return this;\n+    }\n+\n+    /**\n+     * Get id of the page before current page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzMjc2Nw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497832767", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param nextPageId id of next page\n          \n          \n            \n                 * @param nextPageId id of the next page", "author": "vcolin7", "createdAt": "2020-09-30T22:19:05Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzNjM1NQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497836355", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Set next page id\n          \n          \n            \n                 * Set the next page id", "author": "vcolin7", "createdAt": "2020-09-30T22:28:46Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzNjQyNA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497836424", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param nextPageId id of the page next to this page\n          \n          \n            \n                 * @param nextPageId id of the page after this page", "author": "vcolin7", "createdAt": "2020-09-30T22:28:58Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id\n+     * @param nextPageId id of the page next to this page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzNjUxMg==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497836512", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return current page\n          \n          \n            \n                 * @return this page", "author": "vcolin7", "createdAt": "2020-09-30T22:29:14Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id\n+     * @param nextPageId id of the page next to this page\n+     * @return current page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzNjU3Ng==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497836576", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return current page\n          \n          \n            \n                 * @return this page", "author": "vcolin7", "createdAt": "2020-09-30T22:29:26Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id\n+     * @param nextPageId id of the page next to this page\n+     * @return current page\n+     */\n+    public Page<T> setNextPageId(@NonNull String nextPageId) {\n+        this.nextPageId = nextPageId;\n+        return this;\n+    }\n+\n+    /**\n+     * Get id of the page next to this page\n+     * @return id of the next page\n+     */\n+    public String getNextPageId() {\n+        return nextPageId;\n+    }\n+\n+    /**\n+     * Set previous page id\n+     * @param previousPageId id of the page before this page\n+     * @return current page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzNjkwOA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497836908", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Get id of the page next to this page\n          \n          \n            \n                 * Get the next page id", "author": "vcolin7", "createdAt": "2020-09-30T22:30:16Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id\n+     * @param nextPageId id of the page next to this page\n+     * @return current page\n+     */\n+    public Page<T> setNextPageId(@NonNull String nextPageId) {\n+        this.nextPageId = nextPageId;\n+        return this;\n+    }\n+\n+    /**\n+     * Get id of the page next to this page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzNzQ3NA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497837474", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return id of the next page\n          \n          \n            \n                 * @return id of the page after this page", "author": "vcolin7", "createdAt": "2020-09-30T22:31:40Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/Page.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a page of items\n+ * @param <T> type of the items in the page\n+ */\n+public class Page<T> {\n+    private final String pageId;\n+    private final List<T> items;\n+    private String nextPageId;\n+    private String previousPageId;\n+\n+    /**\n+     * Constructor requires page id and items\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items) {\n+        Objects.requireNonNull(pageId);\n+        Objects.requireNonNull(items);\n+        this.pageId = pageId;\n+        this.items = items;\n+    }\n+\n+    /**\n+     * Constructor with page id, items, and next page id\n+     * @param pageId id of the page\n+     * @param items items in the page\n+     * @param nextPageId id of next page\n+     */\n+    public Page(@NonNull String pageId, @NonNull List<T> items, String nextPageId) {\n+        this(pageId, items);\n+        nextPageId = nextPageId;\n+    }\n+\n+    /**\n+     * Get the page id\n+     * @return id of the page\n+     */\n+    public String getPageId(){\n+        return this.pageId;\n+    }\n+\n+    /**\n+     * Get the items in the page\n+     * @return list of items in the page\n+     */\n+    public List<T> getItems() {\n+        return this.items;\n+    }\n+\n+    /**\n+     * Get an iterator for the items in the page\n+     * @return iterator for the items in the page\n+     */\n+    public Iterator<T> getIterator() {\n+        return items.iterator();\n+    }\n+\n+    /**\n+     * Set next page id\n+     * @param nextPageId id of the page next to this page\n+     * @return current page\n+     */\n+    public Page<T> setNextPageId(@NonNull String nextPageId) {\n+        this.nextPageId = nextPageId;\n+        return this;\n+    }\n+\n+    /**\n+     * Get id of the page next to this page\n+     * @return id of the next page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzODQ5Mw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497838493", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Retrieve first page of the collection. Throws RuntimeException on failure\n          \n          \n            \n                 * Retrieve the first page of the collection", "author": "vcolin7", "createdAt": "2020-09-30T22:34:42Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataRetriever.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Objects;\n+\n+/**\n+ * Represents a synchronous paged data provider with fixed page size\n+ * @param <T> items in the page\n+ * @param <P> page of items\n+ */\n+public abstract class PagedDataRetriever<T, P extends Page<T>> {\n+\n+    /**\n+     * Retrieve first page of the collection. Throws RuntimeException on failure", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzODc3MA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497838770", "bodyText": "Do we really need to state this throws a RuntimeException? The same question applies for all other interface methods that do this.", "author": "vcolin7", "createdAt": "2020-09-30T22:35:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzODQ5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzOTcyMw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497839723", "bodyText": "I think it would look nice if we can add a link to both Page and Response in this Javadoc.", "author": "vcolin7", "createdAt": "2020-09-30T22:38:16Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseRetriever.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+/**\n+ * Represents a synchronous paged data provider with fixed page size that returns both page and response", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0MDk3MQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497840971", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Represents an asynchronous paged data provider with fixed page size\n          \n          \n            \n             * Represents an asynchronous paged data provider with a fixed page size", "author": "vcolin7", "createdAt": "2020-09-30T22:41:54Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+/**\n+ * Represents an asynchronous paged data provider with fixed page size", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0MTE5Mg==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497841192", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * @param <P> page that contains the items\n          \n          \n            \n             * @param <P> type of the page", "author": "vcolin7", "createdAt": "2020-09-30T22:42:30Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+/**\n+ * Represents an asynchronous paged data provider with fixed page size\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0MTczNA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497841734", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param callback callback function to handle the page data along with the response for retrieving it\n          \n          \n            \n                 * @param callback callback function to handle the page data along with the response it comes with", "author": "vcolin7", "createdAt": "2020-09-30T22:44:13Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+/**\n+ * Represents an asynchronous paged data provider with fixed page size\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public abstract class AsyncPagedDataRetriever<T, P extends Page<T>> {\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @param callback callback function to handle the page data along with the response for retrieving it", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0MjIzNA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497842234", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n          \n          \n            \n             * Represents a collection of paged data with a fixed page size where pages can be retrieved synchronously", "author": "vcolin7", "createdAt": "2020-09-30T22:45:32Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0MjMxOA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497842318", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * @param <P> page that contains the items\n          \n          \n            \n             * @param <P> type of the page", "author": "vcolin7", "createdAt": "2020-09-30T22:45:46Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0Mjc2MQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497842761", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Constructor requires a synchronous paged data provider\n          \n          \n            \n                 * @param pagedDataRetriever paged data provider with fixed page size\n          \n          \n            \n                 * Constructor that requires a synchronous paged data provider\n          \n          \n            \n                 * @param pagedDataRetriever paged data provider with a fixed page size", "author": "vcolin7", "createdAt": "2020-09-30T22:47:07Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {\n+    private final PagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, P> pages = new LinkedHashMap<String, P>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a synchronous paged data provider\n+     * @param pagedDataRetriever paged data provider with fixed page size", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0MzA0Ng==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497843046", "bodyText": "For consistency\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    firstPageId = firstPage.getPageId();\n          \n          \n            \n                    this.firstPageId = firstPage.getPageId();", "author": "vcolin7", "createdAt": "2020-09-30T22:47:54Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {\n+    private final PagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, P> pages = new LinkedHashMap<String, P>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a synchronous paged data provider\n+     * @param pagedDataRetriever paged data provider with fixed page size\n+     */\n+    public PagedDataCollection(@NonNull PagedDataRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @return First page of the collection\n+     */\n+    public P getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        P firstPage = pagedDataRetriever.getFirstPage();\n+        firstPageId = firstPage.getPageId();", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0MzE1NQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497843155", "bodyText": "nit;\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return  firstPage;\n          \n          \n            \n                    return firstPage;", "author": "vcolin7", "createdAt": "2020-09-30T22:48:15Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {\n+    private final PagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, P> pages = new LinkedHashMap<String, P>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a synchronous paged data provider\n+     * @param pagedDataRetriever paged data provider with fixed page size\n+     */\n+    public PagedDataCollection(@NonNull PagedDataRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @return First page of the collection\n+     */\n+    public P getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        P firstPage = pagedDataRetriever.getFirstPage();\n+        firstPageId = firstPage.getPageId();\n+        pages.put(firstPage.getPageId(), firstPage);\n+        return  firstPage;", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0NDgyNA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497844824", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Retrieve a page with its id\n          \n          \n            \n                 * @param pageId id of the page\n          \n          \n            \n                 * @return page of data with the requested id\n          \n          \n            \n                 * Retrieve a page with the given id\n          \n          \n            \n                 * @param pageId id of the page to retrieve\n          \n          \n            \n                 * @return a page that matches the given id", "author": "vcolin7", "createdAt": "2020-09-30T22:53:27Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {\n+    private final PagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, P> pages = new LinkedHashMap<String, P>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a synchronous paged data provider\n+     * @param pagedDataRetriever paged data provider with fixed page size\n+     */\n+    public PagedDataCollection(@NonNull PagedDataRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @return First page of the collection\n+     */\n+    public P getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        P firstPage = pagedDataRetriever.getFirstPage();\n+        firstPageId = firstPage.getPageId();\n+        pages.put(firstPage.getPageId(), firstPage);\n+        return  firstPage;\n+    }\n+\n+    /**\n+     * Retrieve a page with its id\n+     * @param pageId id of the page\n+     * @return page of data with the requested id", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2MTQxMw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497861413", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Retrieve a page synchronously along with the response for retrieving it using page id\n          \n          \n            \n                 * @param pageId id of the page\n          \n          \n            \n                 * @return page and the response for retrieving it\n          \n          \n            \n                 * Retrieve a page with the given id synchronously along with the response it comes with\n          \n          \n            \n                 * @param pageId id of the page to retrieve\n          \n          \n            \n                 * @return a response with page data for the given page id", "author": "vcolin7", "createdAt": "2020-09-30T23:48:29Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseCollection.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of pages where page and the response for retrieving it can be returned synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataResponseCollection<T, P extends Page<T>> {\n+    private final PagedDataResponseRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, Response<P>> pages = new LinkedHashMap<String, Response<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a page provider that returns page data and response synchronously\n+     * @param pagedDataRetriever synchronous paged data provider\n+     */\n+    public PagedDataResponseCollection(@NonNull PagedDataResponseRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieves the first page in the collection synchronously\n+     * @return page data along with the response for retrieving the first page\n+     */\n+    public Response<P> getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        Response<P> firstPageResponse = pagedDataRetriever.getFirstPage();\n+        if (firstPageResponse != null\n+            && firstPageResponse.getValue() != null\n+            && firstPageResponse.getValue().getPageId() != null) {\n+            firstPageId = firstPageResponse.getValue().getPageId();\n+            pages.put(firstPageId, firstPageResponse);\n+        }\n+        return  firstPageResponse;\n+    }\n+\n+    /**\n+     * Retrieve a page synchronously along with the response for retrieving it using page id\n+     * @param pageId id of the page\n+     * @return page and the response for retrieving it", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2MTcyMA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497861720", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Get a page by its id\n          \n          \n            \n                 * @param pageId id of the page\n          \n          \n            \n                 * @return a response with page data\n          \n          \n            \n                 * Retrieve a page with the given id along with the response it comes with\n          \n          \n            \n                 * @param pageId id of the page to retrieve\n          \n          \n            \n                 * @return a response with page data for the given page id", "author": "vcolin7", "createdAt": "2020-09-30T23:49:42Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseRetriever.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+/**\n+ * Represents a synchronous paged data provider with fixed page size that returns both page and response\n+ * @param <T> type of the items in the page\n+ * @param <P> type of the page\n+ */\n+public abstract class PagedDataResponseRetriever<T, P extends Page<T>> {\n+\n+    /**\n+     * Get first page in the collection\n+     * @return a response with page data\n+     */\n+    public abstract Response<P> getFirstPage();\n+\n+    /**\n+     * Get a page by its id\n+     * @param pageId id of the page\n+     * @return a response with page data", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2MjExNg==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497862116", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Retrieve page with the given id. Throws RuntimeException on failure\n          \n          \n            \n                 * @param pageId id of the page to retrieve\n          \n          \n            \n                 * @return page of items\n          \n          \n            \n                 * Retrieve a page with the given id\n          \n          \n            \n                 * @param pageId id of the page to retrieve\n          \n          \n            \n                 * @return a page that matches the given id", "author": "vcolin7", "createdAt": "2020-09-30T23:51:02Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataRetriever.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Objects;\n+\n+/**\n+ * Represents a synchronous paged data provider with fixed page size\n+ * @param <T> items in the page\n+ * @param <P> page of items\n+ */\n+public abstract class PagedDataRetriever<T, P extends Page<T>> {\n+\n+    /**\n+     * Retrieve first page of the collection. Throws RuntimeException on failure\n+     * @return the first page of the collection\n+     */\n+    public abstract P getFirstPage();\n+\n+    /**\n+     * Retrieve page with the given id. Throws RuntimeException on failure\n+     * @param pageId id of the page to retrieve\n+     * @return page of items", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2Mjc2OA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497862768", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Represents a synchronous paged data provider with fixed page size\n          \n          \n            \n             * @param <T> items in the page\n          \n          \n            \n             * @param <P> page of items\n          \n          \n            \n             * Represents a synchronous paged data provider with a fixed page size\n          \n          \n            \n             * @param <T> type of the items contained in the page\n          \n          \n            \n             * @param <P> type of the page", "author": "vcolin7", "createdAt": "2020-09-30T23:53:17Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataRetriever.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Objects;\n+\n+/**\n+ * Represents a synchronous paged data provider with fixed page size\n+ * @param <T> items in the page\n+ * @param <P> page of items", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2MzcyNA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497863724", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Represents a synchronous paged data provider with fixed page size that returns both page and response\n          \n          \n            \n             * @param <T> type of the items in the page\n          \n          \n            \n             * @param <P> type of the page\n          \n          \n            \n             * Represents a synchronous paged data provider with a fixed page size that returns both page and response\n          \n          \n            \n             * @param <T> type of the items contained in the page\n          \n          \n            \n             * @param <P> type of the page", "author": "vcolin7", "createdAt": "2020-09-30T23:56:40Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseRetriever.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+/**\n+ * Represents a synchronous paged data provider with fixed page size that returns both page and response\n+ * @param <T> type of the items in the page\n+ * @param <P> type of the page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2Mzg2Nw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497863867", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Get first page in the collection\n          \n          \n            \n                 * @return a response with page data\n          \n          \n            \n                 * Retrieve the first page of the collection\n          \n          \n            \n                 * @return a response with page data for the first page of the collection", "author": "vcolin7", "createdAt": "2020-09-30T23:57:14Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseRetriever.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+/**\n+ * Represents a synchronous paged data provider with fixed page size that returns both page and response\n+ * @param <T> type of the items in the page\n+ * @param <P> type of the page\n+ */\n+public abstract class PagedDataResponseRetriever<T, P extends Page<T>> {\n+\n+    /**\n+     * Get first page in the collection\n+     * @return a response with page data", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2NDE1NQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497864155", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Retrieves the first page in the collection synchronously\n          \n          \n            \n                 * @return page data along with the response for retrieving the first page\n          \n          \n            \n                 * Retrieve the first page of the collection synchronously\n          \n          \n            \n                 * @return a response with page data for the first page of the collection", "author": "vcolin7", "createdAt": "2020-09-30T23:58:17Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseCollection.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of pages where page and the response for retrieving it can be returned synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataResponseCollection<T, P extends Page<T>> {\n+    private final PagedDataResponseRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, Response<P>> pages = new LinkedHashMap<String, Response<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a page provider that returns page data and response synchronously\n+     * @param pagedDataRetriever synchronous paged data provider\n+     */\n+    public PagedDataResponseCollection(@NonNull PagedDataResponseRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieves the first page in the collection synchronously\n+     * @return page data along with the response for retrieving the first page", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2NDk0Mg==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497864942", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Retrieve the first page in the collection\n          \n          \n            \n                 * @return First page of the collection\n          \n          \n            \n                 * Retrieve the first page of the collection\n          \n          \n            \n                 * @return the first page of the collection", "author": "vcolin7", "createdAt": "2020-10-01T00:00:58Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {\n+    private final PagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, P> pages = new LinkedHashMap<String, P>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a synchronous paged data provider\n+     * @param pagedDataRetriever paged data provider with fixed page size\n+     */\n+    public PagedDataCollection(@NonNull PagedDataRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @return First page of the collection", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2NjA1Ng==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497866056", "bodyText": "nit; We can use the value we just set.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    pages.put(firstPage.getPageId(), firstPage);\n          \n          \n            \n                    pages.put(firstPageId, firstPage);", "author": "vcolin7", "createdAt": "2020-10-01T00:05:18Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {\n+    private final PagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, P> pages = new LinkedHashMap<String, P>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a synchronous paged data provider\n+     * @param pagedDataRetriever paged data provider with fixed page size\n+     */\n+    public PagedDataCollection(@NonNull PagedDataRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @return First page of the collection\n+     */\n+    public P getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        P firstPage = pagedDataRetriever.getFirstPage();\n+        firstPageId = firstPage.getPageId();\n+        pages.put(firstPage.getPageId(), firstPage);", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2NjI2NA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497866264", "bodyText": "What happens if the given pageId is null? The annotation will not stop users from passing such a value.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    P page = pages.get(pageId);\n          \n          \n            \n                    Objects.requireNonNull(pageId);\n          \n          \n            \n                    P page = pages.get(pageId);", "author": "vcolin7", "createdAt": "2020-10-01T00:06:07Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {\n+    private final PagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, P> pages = new LinkedHashMap<String, P>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a synchronous paged data provider\n+     * @param pagedDataRetriever paged data provider with fixed page size\n+     */\n+    public PagedDataCollection(@NonNull PagedDataRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @return First page of the collection\n+     */\n+    public P getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        P firstPage = pagedDataRetriever.getFirstPage();\n+        firstPageId = firstPage.getPageId();\n+        pages.put(firstPage.getPageId(), firstPage);\n+        return  firstPage;\n+    }\n+\n+    /**\n+     * Retrieve a page with its id\n+     * @param pageId id of the page\n+     * @return page of data with the requested id\n+     */\n+    public P getPage(@NonNull String pageId) {\n+        P page = pages.get(pageId);", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2NzU1OQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497867559", "bodyText": "nit; we can just use the pageId given as an input parameter.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    pages.put(page.getPageId(), page);\n          \n          \n            \n                    pages.put(pageId, page);", "author": "vcolin7", "createdAt": "2020-10-01T00:11:06Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/util/paging/PagedDataCollection.java", "diffHunk": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.util.paging;\n+\n+import androidx.annotation.NonNull;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of paged data with fixed page size where pages can be retrieved synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataCollection<T, P extends Page<T>> {\n+    private final PagedDataRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, P> pages = new LinkedHashMap<String, P>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a synchronous paged data provider\n+     * @param pagedDataRetriever paged data provider with fixed page size\n+     */\n+    public PagedDataCollection(@NonNull PagedDataRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @return First page of the collection\n+     */\n+    public P getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        P firstPage = pagedDataRetriever.getFirstPage();\n+        firstPageId = firstPage.getPageId();\n+        pages.put(firstPage.getPageId(), firstPage);\n+        return  firstPage;\n+    }\n+\n+    /**\n+     * Retrieve a page with its id\n+     * @param pageId id of the page\n+     * @return page of data with the requested id\n+     */\n+    public P getPage(@NonNull String pageId) {\n+        P page = pages.get(pageId);\n+        if (page != null) {\n+            return page;\n+        }\n+\n+        page = pagedDataRetriever.getPage(pageId);\n+        // setting previous page id should simplify implementation for androidx.arch.DataSource\n+        final Iterator<P> iterator = pages.values().iterator();\n+        while(iterator.hasNext()){\n+            final P existingPage = iterator.next();\n+            if (pageId.equals(existingPage.getNextPageId())) {\n+                page.setPreviousPageId(existingPage.getPageId());\n+                break;\n+            }\n+        }\n+        pages.put(page.getPageId(), page);", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2NzY2NQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497867665", "bodyText": "nit;\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return  firstPageResponse;\n          \n          \n            \n                    return firstPageResponse;", "author": "vcolin7", "createdAt": "2020-10-01T00:11:36Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseCollection.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of pages where page and the response for retrieving it can be returned synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataResponseCollection<T, P extends Page<T>> {\n+    private final PagedDataResponseRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, Response<P>> pages = new LinkedHashMap<String, Response<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a page provider that returns page data and response synchronously\n+     * @param pagedDataRetriever synchronous paged data provider\n+     */\n+    public PagedDataResponseCollection(@NonNull PagedDataResponseRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieves the first page in the collection synchronously\n+     * @return page data along with the response for retrieving the first page\n+     */\n+    public Response<P> getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        Response<P> firstPageResponse = pagedDataRetriever.getFirstPage();\n+        if (firstPageResponse != null\n+            && firstPageResponse.getValue() != null\n+            && firstPageResponse.getValue().getPageId() != null) {\n+            firstPageId = firstPageResponse.getValue().getPageId();\n+            pages.put(firstPageId, firstPageResponse);\n+        }\n+        return  firstPageResponse;", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2ODQ4OQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497868489", "bodyText": "nit; We can use the pageId given as an input parameter.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        pages.put(pageResponse.getValue().getPageId(), pageResponse);\n          \n          \n            \n                        pages.put(pageId, pageResponse);", "author": "vcolin7", "createdAt": "2020-10-01T00:14:46Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseCollection.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of pages where page and the response for retrieving it can be returned synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataResponseCollection<T, P extends Page<T>> {\n+    private final PagedDataResponseRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, Response<P>> pages = new LinkedHashMap<String, Response<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a page provider that returns page data and response synchronously\n+     * @param pagedDataRetriever synchronous paged data provider\n+     */\n+    public PagedDataResponseCollection(@NonNull PagedDataResponseRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieves the first page in the collection synchronously\n+     * @return page data along with the response for retrieving the first page\n+     */\n+    public Response<P> getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        Response<P> firstPageResponse = pagedDataRetriever.getFirstPage();\n+        if (firstPageResponse != null\n+            && firstPageResponse.getValue() != null\n+            && firstPageResponse.getValue().getPageId() != null) {\n+            firstPageId = firstPageResponse.getValue().getPageId();\n+            pages.put(firstPageId, firstPageResponse);\n+        }\n+        return  firstPageResponse;\n+    }\n+\n+    /**\n+     * Retrieve a page synchronously along with the response for retrieving it using page id\n+     * @param pageId id of the page\n+     * @return page and the response for retrieving it\n+     */\n+    public Response<P> getPage(@NonNull String pageId) {\n+        Objects.requireNonNull(pageId);\n+        Response<P> pageResponse = pages.get(pageId);\n+        if (pageResponse != null) {\n+            return pageResponse;\n+        }\n+\n+        pageResponse = pagedDataRetriever.getPage(pageId);\n+        if (pageResponse != null\n+            && pageResponse.getValue() != null\n+            && pageResponse.getValue().getPageId() != null) {\n+            // setting previous page id should simplify implementation for androidx.arch.DataSource\n+            final Iterator<Response<P>> iterator = pages.values().iterator();\n+            while (iterator.hasNext()) {\n+                final P existingPage = iterator.next().getValue();\n+                if (pageId.equals(existingPage.getNextPageId())) {\n+                    pageResponse.getValue().setPreviousPageId(existingPage.getPageId());\n+                    break;\n+                }\n+            }\n+            pages.put(pageResponse.getValue().getPageId(), pageResponse);", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2ODc4Mg==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497868782", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Retrieve a page with its id\n          \n          \n            \n                 * @param pageId id of the page\n          \n          \n            \n                 * @param callback callback function to handle the page data along with the response for retrieving it\n          \n          \n            \n                 * Retrieve a page with the given id\n          \n          \n            \n                 * @param pageId id of the page\n          \n          \n            \n                 * @param callback callback function to handle the page data along with the response it comes with", "author": "vcolin7", "createdAt": "2020-10-01T00:15:21Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+/**\n+ * Represents an asynchronous paged data provider with fixed page size\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public abstract class AsyncPagedDataRetriever<T, P extends Page<T>> {\n+\n+    /**\n+     * Retrieve the first page in the collection\n+     * @param callback callback function to handle the page data along with the response for retrieving it\n+     */\n+    public abstract void getFirstPage(Callback<P> callback);\n+\n+    /**\n+     * Retrieve a page with its id\n+     * @param pageId id of the page\n+     * @param callback callback function to handle the page data along with the response for retrieving it", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg2OTcwNg==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497869706", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Represents a collection of pages where page data and response for retrieving it can be returned asynchronously\n          \n          \n            \n             * @param <T> type of the items in the page\n          \n          \n            \n             * @param <P> Page of items\n          \n          \n            \n             * Represents a collection of pages where page data and the response it comes with it can be obtained asynchronously\n          \n          \n            \n             * @param <T> type of the items in the page\n          \n          \n            \n             * @param <P> type of the page", "author": "vcolin7", "createdAt": "2020-10-01T00:16:44Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+import okhttp3.Response;\n+\n+/**\n+ * Represents a collection of pages where page data and response for retrieving it can be returned asynchronously\n+ * @param <T> type of the items in the page\n+ * @param <P> Page of items", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg3MTExMg==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497871112", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Construction requires an asynchronous paged data provider\n          \n          \n            \n                 * @param asyncPagedDataRetriever an asynchronous page data provider\n          \n          \n            \n                 * Constructor requires an asynchronous paged data provider\n          \n          \n            \n                 * @param asyncPagedDataRetriever an asynchronous paged data provider", "author": "vcolin7", "createdAt": "2020-10-01T00:19:02Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+import okhttp3.Response;\n+\n+/**\n+ * Represents a collection of pages where page data and response for retrieving it can be returned asynchronously\n+ * @param <T> type of the items in the page\n+ * @param <P> Page of items\n+ */\n+public class AsyncPagedDataCollection<T, P extends Page<T>> {\n+    private final AsyncPagedDataRetriever<T, P> asyncPagedDataRetriever;\n+    private LinkedHashMap<String, PageAndResponse<P>> pages = new LinkedHashMap<String, PageAndResponse<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Construction requires an asynchronous paged data provider\n+     * @param asyncPagedDataRetriever an asynchronous page data provider", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg3MjUxMw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497872513", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Gets first page in the collection along with the response retrieving the first page\n          \n          \n            \n                 * @param callback a callback interface for handling the first page and its response\n          \n          \n            \n                 * Retrieve the first page of the collection along with the response it comes with\n          \n          \n            \n                 * @param callback callback interface for handling the first page and the response it comes with", "author": "vcolin7", "createdAt": "2020-10-01T00:21:13Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+import okhttp3.Response;\n+\n+/**\n+ * Represents a collection of pages where page data and response for retrieving it can be returned asynchronously\n+ * @param <T> type of the items in the page\n+ * @param <P> Page of items\n+ */\n+public class AsyncPagedDataCollection<T, P extends Page<T>> {\n+    private final AsyncPagedDataRetriever<T, P> asyncPagedDataRetriever;\n+    private LinkedHashMap<String, PageAndResponse<P>> pages = new LinkedHashMap<String, PageAndResponse<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Construction requires an asynchronous paged data provider\n+     * @param asyncPagedDataRetriever an asynchronous page data provider\n+     */\n+    public AsyncPagedDataCollection(@NonNull AsyncPagedDataRetriever<T, P> asyncPagedDataRetriever) {\n+        Objects.requireNonNull(asyncPagedDataRetriever);\n+        this.asyncPagedDataRetriever = asyncPagedDataRetriever;\n+    }\n+\n+    private void cacheResponse(P page, Response response) {\n+        if (page.getPageId() == null) {\n+            return;\n+        }\n+        pages.put(page.getPageId(), new PageAndResponse<P>(page, response));\n+\n+        // setting previous page id should simplify implementation for androidx.arch.DataSource\n+        final Iterator<PageAndResponse<P>> iterator = pages.values().iterator();\n+        while(iterator.hasNext()){\n+            final P existingPage = iterator.next().page;\n+            if (page.getPageId().equals(existingPage.getNextPageId())){\n+                page.setPreviousPageId(existingPage.getPageId());\n+                break;\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Gets first page in the collection along with the response retrieving the first page\n+     * @param callback a callback interface for handling the first page and its response", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg3NTA1Nw==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497875057", "bodyText": "How likely is it that the pageId turns out to be null? We don't check for nullness in the other PagedCollection classes.", "author": "vcolin7", "createdAt": "2020-10-01T00:25:34Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/PagedDataResponseCollection.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Response;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+/**\n+ * Represents a collection of pages where page and the response for retrieving it can be returned synchronously\n+ * @param <T> type of the items contained in the page\n+ * @param <P> page that contains the items\n+ */\n+public class PagedDataResponseCollection<T, P extends Page<T>> {\n+    private final PagedDataResponseRetriever<T, P> pagedDataRetriever;\n+    private LinkedHashMap<String, Response<P>> pages = new LinkedHashMap<String, Response<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Constructor requires a page provider that returns page data and response synchronously\n+     * @param pagedDataRetriever synchronous paged data provider\n+     */\n+    public PagedDataResponseCollection(@NonNull PagedDataResponseRetriever<T, P> pagedDataRetriever) {\n+        Objects.requireNonNull(pagedDataRetriever);\n+        this.pagedDataRetriever = pagedDataRetriever;\n+    }\n+\n+    /**\n+     * Retrieves the first page in the collection synchronously\n+     * @return page data along with the response for retrieving the first page\n+     */\n+    public Response<P> getFirstPage() {\n+        if (firstPageId != null) {\n+            return pages.get(firstPageId);\n+        }\n+        Response<P> firstPageResponse = pagedDataRetriever.getFirstPage();\n+        if (firstPageResponse != null\n+            && firstPageResponse.getValue() != null\n+            && firstPageResponse.getValue().getPageId() != null) {\n+            firstPageId = firstPageResponse.getValue().getPageId();", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ1MDUwNQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r498450505", "bodyText": "Added null check wherever missing. Hope this resolves it", "author": "JianpingChen", "createdAt": "2020-10-01T18:52:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg3NTA1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg3NTYyMQ==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497875621", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Retrieve a page by its id\n          \n          \n            \n                 * @param pageId id of the page\n          \n          \n            \n                 * @param callback callback interface for handling the page along with its response\n          \n          \n            \n                 * Retrieve a page with the given id\n          \n          \n            \n                 * @param pageId id of the page\n          \n          \n            \n                 * @param callback callback interface for handling the page along with the response it comes with", "author": "vcolin7", "createdAt": "2020-10-01T00:26:29Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+import okhttp3.Response;\n+\n+/**\n+ * Represents a collection of pages where page data and response for retrieving it can be returned asynchronously\n+ * @param <T> type of the items in the page\n+ * @param <P> Page of items\n+ */\n+public class AsyncPagedDataCollection<T, P extends Page<T>> {\n+    private final AsyncPagedDataRetriever<T, P> asyncPagedDataRetriever;\n+    private LinkedHashMap<String, PageAndResponse<P>> pages = new LinkedHashMap<String, PageAndResponse<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Construction requires an asynchronous paged data provider\n+     * @param asyncPagedDataRetriever an asynchronous page data provider\n+     */\n+    public AsyncPagedDataCollection(@NonNull AsyncPagedDataRetriever<T, P> asyncPagedDataRetriever) {\n+        Objects.requireNonNull(asyncPagedDataRetriever);\n+        this.asyncPagedDataRetriever = asyncPagedDataRetriever;\n+    }\n+\n+    private void cacheResponse(P page, Response response) {\n+        if (page.getPageId() == null) {\n+            return;\n+        }\n+        pages.put(page.getPageId(), new PageAndResponse<P>(page, response));\n+\n+        // setting previous page id should simplify implementation for androidx.arch.DataSource\n+        final Iterator<PageAndResponse<P>> iterator = pages.values().iterator();\n+        while(iterator.hasNext()){\n+            final P existingPage = iterator.next().page;\n+            if (page.getPageId().equals(existingPage.getNextPageId())){\n+                page.setPreviousPageId(existingPage.getPageId());\n+                break;\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Gets first page in the collection along with the response retrieving the first page\n+     * @param callback a callback interface for handling the first page and its response\n+     */\n+    public void getFirstPage(@NonNull Callback<P> callback) {\n+        Objects.requireNonNull(callback);\n+        if (firstPageId == null){\n+            asyncPagedDataRetriever.getFirstPage(new Callback<P>() {\n+                @Override\n+                public void onSuccess(P value, Response response) {\n+                    if (value == null) {\n+                        callback.onSuccess(value, response);\n+                        return;\n+                    }\n+\n+                    firstPageId = value.getPageId();\n+                    cacheResponse(value, response);\n+                    callback.onSuccess(value, response);\n+                }\n+\n+                @Override\n+                public void onFailure(Throwable t, Response response) {\n+                    callback.onFailure(t, response);\n+                }\n+            });\n+        }\n+        else {\n+            PageAndResponse<P> firstPageResponse = pages.get(firstPageId);\n+            callback.onSuccess(firstPageResponse.page, firstPageResponse.response);\n+        }\n+    }\n+\n+    /**\n+     * Retrieve a page by its id\n+     * @param pageId id of the page\n+     * @param callback callback interface for handling the page along with its response", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg3OTM1MA==", "url": "https://github.com/Azure/azure-sdk-for-android/pull/346#discussion_r497879350", "bodyText": "For consistency with getPage() below.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    callback.onSuccess(value, response);\n          \n          \n            \n                                    callback.onSuccess(null, response);", "author": "vcolin7", "createdAt": "2020-10-01T00:32:10Z", "path": "sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java", "diffHunk": "@@ -0,0 +1,127 @@\n+/**\n+ * Copyright (c) Microsoft Corporation. All rights reserved.\n+ * Licensed under the MIT License.\n+ */\n+package com.azure.android.core.http.responsepaging;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.azure.android.core.http.Callback;\n+import com.azure.android.core.util.paging.Page;\n+\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.Objects;\n+\n+import okhttp3.Response;\n+\n+/**\n+ * Represents a collection of pages where page data and response for retrieving it can be returned asynchronously\n+ * @param <T> type of the items in the page\n+ * @param <P> Page of items\n+ */\n+public class AsyncPagedDataCollection<T, P extends Page<T>> {\n+    private final AsyncPagedDataRetriever<T, P> asyncPagedDataRetriever;\n+    private LinkedHashMap<String, PageAndResponse<P>> pages = new LinkedHashMap<String, PageAndResponse<P>>();\n+    private String firstPageId;\n+\n+    /**\n+     * Construction requires an asynchronous paged data provider\n+     * @param asyncPagedDataRetriever an asynchronous page data provider\n+     */\n+    public AsyncPagedDataCollection(@NonNull AsyncPagedDataRetriever<T, P> asyncPagedDataRetriever) {\n+        Objects.requireNonNull(asyncPagedDataRetriever);\n+        this.asyncPagedDataRetriever = asyncPagedDataRetriever;\n+    }\n+\n+    private void cacheResponse(P page, Response response) {\n+        if (page.getPageId() == null) {\n+            return;\n+        }\n+        pages.put(page.getPageId(), new PageAndResponse<P>(page, response));\n+\n+        // setting previous page id should simplify implementation for androidx.arch.DataSource\n+        final Iterator<PageAndResponse<P>> iterator = pages.values().iterator();\n+        while(iterator.hasNext()){\n+            final P existingPage = iterator.next().page;\n+            if (page.getPageId().equals(existingPage.getNextPageId())){\n+                page.setPreviousPageId(existingPage.getPageId());\n+                break;\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Gets first page in the collection along with the response retrieving the first page\n+     * @param callback a callback interface for handling the first page and its response\n+     */\n+    public void getFirstPage(@NonNull Callback<P> callback) {\n+        Objects.requireNonNull(callback);\n+        if (firstPageId == null){\n+            asyncPagedDataRetriever.getFirstPage(new Callback<P>() {\n+                @Override\n+                public void onSuccess(P value, Response response) {\n+                    if (value == null) {\n+                        callback.onSuccess(value, response);", "originalCommit": "499768ae9c9108a2615e8787a7326a29a5781bae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5ce1e9cb0864b7bf4e9161235258b275ed04c2b8", "url": "https://github.com/Azure/azure-sdk-for-android/commit/5ce1e9cb0864b7bf4e9161235258b275ed04c2b8", "message": "Fix JavaDoc according to review feedback; Add null check before caching", "committedDate": "2020-10-01T02:18:48Z", "type": "commit"}, {"oid": "804bab9dbf42b824d4e47128f79eb1cb4374b411", "url": "https://github.com/Azure/azure-sdk-for-android/commit/804bab9dbf42b824d4e47128f79eb1cb4374b411", "message": "Update sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:43:57Z", "type": "commit"}, {"oid": "f4df81124301f6cdcb7fec151883e0ed01b97dd7", "url": "https://github.com/Azure/azure-sdk-for-android/commit/f4df81124301f6cdcb7fec151883e0ed01b97dd7", "message": "Update sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:45:04Z", "type": "commit"}, {"oid": "4a246db9b6938e250f7ef2d7db29906d5c6b38be", "url": "https://github.com/Azure/azure-sdk-for-android/commit/4a246db9b6938e250f7ef2d7db29906d5c6b38be", "message": "Update sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:45:49Z", "type": "commit"}, {"oid": "f592028253590144111ef621f0f01fac4d9b0746", "url": "https://github.com/Azure/azure-sdk-for-android/commit/f592028253590144111ef621f0f01fac4d9b0746", "message": "Update sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:47:13Z", "type": "commit"}, {"oid": "480fdc02b1ff9f938bdc3e6192be5083fe83f4cf", "url": "https://github.com/Azure/azure-sdk-for-android/commit/480fdc02b1ff9f938bdc3e6192be5083fe83f4cf", "message": "Update sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:47:56Z", "type": "commit"}, {"oid": "76efa14c70f151a9f9575300ccba9ba6dfe00213", "url": "https://github.com/Azure/azure-sdk-for-android/commit/76efa14c70f151a9f9575300ccba9ba6dfe00213", "message": "Update sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataCollection.java\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:48:29Z", "type": "commit"}, {"oid": "da29fdde6c9f511b813f0ba2ec3a0bc0e537c1e5", "url": "https://github.com/Azure/azure-sdk-for-android/commit/da29fdde6c9f511b813f0ba2ec3a0bc0e537c1e5", "message": "Update sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:48:59Z", "type": "commit"}, {"oid": "e924e08705c2d565ddbf746c35a651b431d8bdce", "url": "https://github.com/Azure/azure-sdk-for-android/commit/e924e08705c2d565ddbf746c35a651b431d8bdce", "message": "Update sdk/core/azure-core/src/main/java/com/azure/android/core/http/responsepaging/AsyncPagedDataRetriever.java\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:49:18Z", "type": "commit"}, {"oid": "8b04f43f99ba8734d44f36425adeb325eb6ba2da", "url": "https://github.com/Azure/azure-sdk-for-android/commit/8b04f43f99ba8734d44f36425adeb325eb6ba2da", "message": "Apply suggestions from code review\n\nCo-authored-by: vcolin7 <vicolina@microsoft.com>", "committedDate": "2020-10-01T18:56:18Z", "type": "commit"}]}