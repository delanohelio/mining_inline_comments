{"pr_number": 380, "pr_title": "IssueProcessor integration tests.", "pr_createdAt": "2020-12-04T16:16:17Z", "pr_url": "https://github.com/junit-pioneer/junit-pioneer/pull/380", "timeline": [{"oid": "8ed894d37269a77b126d9f378e1fcf8ca4ca801c", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/8ed894d37269a77b126d9f378e1fcf8ca4ca801c", "message": "Baseline for IssueProcessor integration tests.\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-12-04T16:14:28Z", "type": "commit"}, {"oid": "e0592087c7d298e171d8fe8c2078e23579c99886", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/e0592087c7d298e171d8fe8c2078e23579c99886", "message": "Update tests\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-12-04T16:20:49Z", "type": "commit"}, {"oid": "b7bf429388efc350fcf0f73ff18ae005dd5c7fdd", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/b7bf429388efc350fcf0f73ff18ae005dd5c7fdd", "message": "Fix code smells\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-12-04T16:25:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1MTI1OQ==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536251259", "bodyText": "Hmm. We define the report key in all extensions etc. with a string and not by the name of a class. Don't know if I like this change", "author": "Bukama", "createdAt": "2020-12-04T17:16:02Z", "path": "src/main/java/org/junitpioneer/jupiter/issue/IssueExtensionExecutionListener.java", "diffHunk": "@@ -37,7 +36,7 @@\n  */\n public class IssueExtensionExecutionListener implements TestExecutionListener {\n \n-\tpublic static final String REPORT_ENTRY_KEY = \"Issue\";\n+\tpublic static final String REPORT_ENTRY_KEY = IssueExtensionExecutionListener.class.toString();", "originalCommit": "b7bf429388efc350fcf0f73ff18ae005dd5c7fdd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI3MTk4OQ==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536271989", "bodyText": "I don't really like it either, but I think \"Issue\" is just a tad bit too generic. \ud83e\udd37\nPerhaps this?\npublic static final String REPORT_ENTRY_KEY = \"IssueExtensionExecutionListener\";", "author": "Michael1993", "createdAt": "2020-12-04T17:49:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1MTI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI3NDIzNQ==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536274235", "bodyText": "I like this better, so we can refactor (if needed) the class without breaking \"the API\".", "author": "Bukama", "createdAt": "2020-12-04T17:53:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1MTI1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1MjA0NA==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536252044", "bodyText": "No correct Javadoc ;)", "author": "Bukama", "createdAt": "2020-12-04T17:17:23Z", "path": "src/main/java/org/junitpioneer/jupiter/issue/IssueProcessorFactory.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * http://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junitpioneer.jupiter.issue;\n+\n+import java.util.ServiceLoader;\n+\n+import org.junitpioneer.jupiter.IssueProcessor;\n+\n+// Ensures we get the same instance of StoringIssueProcessor in the integration tests", "originalCommit": "b7bf429388efc350fcf0f73ff18ae005dd5c7fdd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI3MDkxNw==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536270917", "bodyText": "Does this class need javadoc? It's entirely internal to Pioneer. This is just an explanation why something trivial got moved to a different class.", "author": "Michael1993", "createdAt": "2020-12-04T17:47:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1MjA0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI3NTMwNA==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536275304", "bodyText": "Well, you use the class in another place, so I think it's useful to add JavaDoc (aside from the fact I always add JavaDoc)", "author": "Bukama", "createdAt": "2020-12-04T17:54:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1MjA0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI3Nzc2OA==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536277768", "bodyText": "Our extensions don't have Javadoc either...? \ud83e\udd37 I think only the public-facing API of Pioneer has proper javadoc.\nAhem. Sure, I can write a quick javadoc. No problemo.", "author": "Michael1993", "createdAt": "2020-12-04T17:59:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1MjA0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1NjA1NA==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536256054", "bodyText": "Do you want to use the new key here?", "author": "Bukama", "createdAt": "2020-12-04T17:24:05Z", "path": "src/test/java/org/junitpioneer/jupiter/issue/IssueExtensionIntegrationTests.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * http://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junitpioneer.jupiter.issue;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import java.util.List;\n+\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.TestReporter;\n+import org.junit.platform.engine.discovery.DiscoverySelectors;\n+import org.junit.platform.launcher.core.LauncherDiscoveryRequestBuilder;\n+import org.junit.platform.launcher.core.LauncherFactory;\n+import org.junitpioneer.jupiter.Issue;\n+import org.junitpioneer.jupiter.IssueTestSuite;\n+import org.opentest4j.TestAbortedException;\n+\n+/**\n+ * Mary Elizabeth Fyre: Do Not Stand at My Grave and Weep is in the public domain.\n+ */\n+public class IssueExtensionIntegrationTests {\n+\n+\tprivate final StoringIssueProcessor issueProcessor = (StoringIssueProcessor) IssueProcessorFactory\n+\t\t\t.getIssueProcessors()\n+\t\t\t.iterator()\n+\t\t\t.next();\n+\n+\t@Test\n+\tvoid testIssueCases() {\n+\t\tLauncherFactory\n+\t\t\t\t.create()\n+\t\t\t\t.execute(LauncherDiscoveryRequestBuilder\n+\t\t\t\t\t\t.request()\n+\t\t\t\t\t\t.selectors(DiscoverySelectors.selectClass(IssueIntegrationCases.class))\n+\t\t\t\t\t\t.build());\n+\n+\t\tList<IssueTestSuite> issueTestSuites = issueProcessor.issueTestSuites();\n+\n+\t\tassertThat(issueTestSuites).isNotEmpty();\n+\t}\n+\n+\tstatic class IssueIntegrationCases {\n+\n+\t\t@Test\n+\t\t@Issue(\"Do not stand at my grave and weep. I am not there. I do not sleep.\")\n+\t\tvoid successfulTest() {\n+\t\t}\n+\n+\t\t@Test\n+\t\t@Issue(\"I am a thousand winds that blow. I am the diamond glints on snow.\")\n+\t\tvoid failingTest() {\n+\t\t\tfail(\"supposed to fail\");\n+\t\t}\n+\n+\t\t@Test\n+\t\t@Issue(\"I am the sunlight on ripened grain. I am the gentle autumn rain.\")\n+\t\tvoid abortedTest() {\n+\t\t\tthrow new TestAbortedException();\n+\t\t}\n+\n+\t\t@Test\n+\t\t@Disabled(\"skipped\")\n+\t\t@Issue(\"When you awaken in the morning's hush, I am the swift uplifting rush\")\n+\t\tvoid skippedTest() {\n+\t\t}\n+\n+\t\t@Test\n+\t\t@Issue(\"Of quiet birds in circled flight. I am the soft stars that shine at night.\")\n+\t\tvoid publishingTest(TestReporter reporter) {\n+\t\t\treporter.publishEntry(\"Issue\", \"reporting test\");", "originalCommit": "b7bf429388efc350fcf0f73ff18ae005dd5c7fdd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI3MDY1Mw==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536270653", "bodyText": "No, I specifically used the \"Issue\" string to see what happens. It's not good - the issue id gets overwritten by whatever gets published with \"Issue\" key. \ud83d\ude1e", "author": "Michael1993", "createdAt": "2020-12-04T17:47:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1NjA1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI3NTU1MQ==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536275551", "bodyText": "Allright.", "author": "Bukama", "createdAt": "2020-12-04T17:55:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1NjA1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1ODgwNg==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536258806", "bodyText": "What does this?", "author": "Bukama", "createdAt": "2020-12-04T17:28:18Z", "path": "src/test/java/org/junitpioneer/jupiter/issue/IssueExtensionIntegrationTests.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * http://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junitpioneer.jupiter.issue;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import java.util.List;\n+\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.TestReporter;\n+import org.junit.platform.engine.discovery.DiscoverySelectors;\n+import org.junit.platform.launcher.core.LauncherDiscoveryRequestBuilder;\n+import org.junit.platform.launcher.core.LauncherFactory;\n+import org.junitpioneer.jupiter.Issue;\n+import org.junitpioneer.jupiter.IssueTestSuite;\n+import org.opentest4j.TestAbortedException;\n+\n+/**\n+ * Mary Elizabeth Fyre: Do Not Stand at My Grave and Weep is in the public domain.\n+ */\n+public class IssueExtensionIntegrationTests {\n+\n+\tprivate final StoringIssueProcessor issueProcessor = (StoringIssueProcessor) IssueProcessorFactory\n+\t\t\t.getIssueProcessors()\n+\t\t\t.iterator()\n+\t\t\t.next();\n+\n+\t@Test\n+\tvoid testIssueCases() {\n+\t\tLauncherFactory\n+\t\t\t\t.create()", "originalCommit": "b7bf429388efc350fcf0f73ff18ae005dd5c7fdd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI2ODAyOA==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536268028", "bodyText": "Creates a Launcher, which gets provided with a LauncherDiscoveryRequest and executes it.\nEssentially indirectly executes the IssueIntegrationCases class. By default, the LauncherFactory will use ServiceLoader to load in TestExecutionListeners (so IssueExtensionExecutionListener is automatically loaded in during the execution).", "author": "Michael1993", "createdAt": "2020-12-04T17:42:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1ODgwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1OTc4Mg==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536259782", "bodyText": "So you try to convert every IssueProcessoir which is found into a StoringIssueProcessor?", "author": "Bukama", "createdAt": "2020-12-04T17:29:43Z", "path": "src/test/java/org/junitpioneer/jupiter/issue/IssueExtensionIntegrationTests.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Copyright 2015-2020 the original author or authors.\n+ *\n+ * All rights reserved. This program and the accompanying materials are\n+ * made available under the terms of the Eclipse Public License v2.0 which\n+ * accompanies this distribution and is available at\n+ *\n+ * http://www.eclipse.org/legal/epl-v20.html\n+ */\n+\n+package org.junitpioneer.jupiter.issue;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.fail;\n+\n+import java.util.List;\n+\n+import org.junit.jupiter.api.Disabled;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.TestReporter;\n+import org.junit.platform.engine.discovery.DiscoverySelectors;\n+import org.junit.platform.launcher.core.LauncherDiscoveryRequestBuilder;\n+import org.junit.platform.launcher.core.LauncherFactory;\n+import org.junitpioneer.jupiter.Issue;\n+import org.junitpioneer.jupiter.IssueTestSuite;\n+import org.opentest4j.TestAbortedException;\n+\n+/**\n+ * Mary Elizabeth Fyre: Do Not Stand at My Grave and Weep is in the public domain.\n+ */\n+public class IssueExtensionIntegrationTests {\n+\n+\tprivate final StoringIssueProcessor issueProcessor = (StoringIssueProcessor) IssueProcessorFactory", "originalCommit": "b7bf429388efc350fcf0f73ff18ae005dd5c7fdd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI2OTE1OQ==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536269159", "bodyText": "It's our own tests, so I made the bold assumption that we will only use the one IssueProcessor. \ud83d\ude1b", "author": "Michael1993", "createdAt": "2020-12-04T17:44:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1OTc4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI2OTY3Nw==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r536269677", "bodyText": "I'm fairly certain this won't change in the future, but if it does we can update the test?", "author": "Michael1993", "createdAt": "2020-12-04T17:45:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjI1OTc4Mg=="}], "type": "inlineReview"}, {"oid": "043becd62bc5d5d9c5d996262826b2fdd3c54eb4", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/043becd62bc5d5d9c5d996262826b2fdd3c54eb4", "message": "Address review comments\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-12-05T09:42:27Z", "type": "commit"}, {"oid": "e653dca3d74779139a21d8d05757553ea98cc692", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/e653dca3d74779139a21d8d05757553ea98cc692", "message": "Update tests with actual assertions\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-12-14T19:57:09Z", "type": "commit"}, {"oid": "8ad413dd6b83089c756e877001c529de20933f36", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/8ad413dd6b83089c756e877001c529de20933f36", "message": "Rename factory to registry to better convey function\n\nSigned-off-by: Mihaly Verhas <misi.verhas@gmail.com>", "committedDate": "2020-12-15T11:16:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ0MTEwNg==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r547441106", "bodyText": "This key is used by IssueExtension to publish report entries. Why would it use the key of the \"target\" of the message. If \"Issue\" is too general, let's stick to \"Issue extension\" (or \"IssueExtension\"`).", "author": "nipafx", "createdAt": "2020-12-22T18:38:06Z", "path": "src/main/java/org/junitpioneer/jupiter/issue/IssueExtensionExecutionListener.java", "diffHunk": "@@ -37,7 +36,7 @@\n  */\n public class IssueExtensionExecutionListener implements TestExecutionListener {\n \n-\tpublic static final String REPORT_ENTRY_KEY = \"Issue\";\n+\tpublic static final String REPORT_ENTRY_KEY = \"IssueExtensionExecutionListener\";", "originalCommit": "8ad413dd6b83089c756e877001c529de20933f36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ0NjY4Mw==", "url": "https://github.com/junit-pioneer/junit-pioneer/pull/380#discussion_r547446683", "bodyText": "I don't like how these purely test-related problem bleeds into the production code.", "author": "nipafx", "createdAt": "2020-12-22T18:50:41Z", "path": "src/main/java/org/junitpioneer/jupiter/issue/IssueExtensionExecutionListener.java", "diffHunk": "@@ -88,7 +87,7 @@ public void testPlanExecutionFinished(TestPlan testPlan) {\n \t\t\treturn;\n \n \t\tList<IssueTestSuite> issueTestSuites = createIssueTestSuites();\n-\t\tfor (IssueProcessor issueProcessor : ServiceLoader.load(IssueProcessor.class)) {\n+\t\tfor (IssueProcessor issueProcessor : IssueProcessorRegistry.getIssueProcessors()) {", "originalCommit": "8ad413dd6b83089c756e877001c529de20933f36", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4eb1b71b357656643a38d8dc0a642558ba5d7fea", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/4eb1b71b357656643a38d8dc0a642558ba5d7fea", "message": "Remove `IssueProcessorRegistry`", "committedDate": "2020-12-22T18:57:27Z", "type": "commit"}, {"oid": "aa83c45ece824d8d645a704563f68c6fe146f926", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/aa83c45ece824d8d645a704563f68c6fe146f926", "message": "Change report entry key", "committedDate": "2020-12-22T18:57:56Z", "type": "commit"}, {"oid": "b3890a24fd7cdb59db19662dcdcb9280e9f120c2", "url": "https://github.com/junit-pioneer/junit-pioneer/commit/b3890a24fd7cdb59db19662dcdcb9280e9f120c2", "message": "Fix typo", "committedDate": "2020-12-22T19:07:14Z", "type": "commit"}]}