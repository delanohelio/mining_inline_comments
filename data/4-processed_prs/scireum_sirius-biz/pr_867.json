{"pr_number": 867, "pr_title": "Fixes backend search for Mongo codelists + codelist entries", "pr_createdAt": "2020-09-28T16:35:54Z", "pr_url": "https://github.com/scireum/sirius-biz/pull/867", "timeline": [{"oid": "a873f69b87e75d4faa4acfcaceb77652ac391e9b", "url": "https://github.com/scireum/sirius-biz/commit/a873f69b87e75d4faa4acfcaceb77652ac391e9b", "message": "Enables search prefixes for mongo codelist entries", "committedDate": "2020-09-28T16:29:32Z", "type": "commit"}, {"oid": "147225b4d37ddce49c753e4f940d6ab096b75f6b", "url": "https://github.com/scireum/sirius-biz/commit/147225b4d37ddce49c753e4f940d6ab096b75f6b", "message": "Marks field to be denormalized into search prefixes", "committedDate": "2020-09-28T16:30:44Z", "type": "commit"}, {"oid": "ce9cc042a0a56308845a6ec84b2ed937b6bd4ffb", "url": "https://github.com/scireum/sirius-biz/commit/ce9cc042a0a56308845a6ec84b2ed937b6bd4ffb", "message": "Splits fields to search depending on the database implementation", "committedDate": "2020-09-28T16:32:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjEyMzcwNg==", "url": "https://github.com/scireum/sirius-biz/pull/867#discussion_r496123706", "bodyText": "applyXXX or the like?", "author": "andyHa", "createdAt": "2020-09-28T17:40:00Z", "path": "src/main/java/sirius/biz/codelists/CodeListController.java", "diffHunk": "@@ -110,18 +106,18 @@ private void codeListHandler(WebContext ctx, String codeListId, boolean forceDet\n     }\n \n     private void renderCodeList(WebContext ctx, L codeList) {\n-        BasePageHelper<E, ?, ?, ?> ph = getEntriesAsPage(codeList);\n-        ph.withContext(ctx);\n-        ph.withSearchFields(QueryField.contains(CodeListEntry.CODE_LIST_ENTRY_DATA.inner(CodeListEntryData.CODE)),\n-                            QueryField.contains(CodeListEntry.CODE_LIST_ENTRY_DATA.inner(CodeListEntryData.VALUE)),\n-                            QueryField.contains(CodeListEntry.CODE_LIST_ENTRY_DATA.inner(CodeListEntryData.ADDITIONAL_VALUE)),\n-                            QueryField.contains(CodeListEntry.CODE_LIST_ENTRY_DATA.inner(CodeListEntryData.DESCRIPTION)));\n-\n-        ctx.respondWith().template(\"/templates/biz/codelists/code-list-entries.html.pasta\", codeList, ph.asPage());\n+        BasePageHelper<E, ?, ?, ?> pageHelper = getEntriesAsPage(codeList);\n+        pageHelper.withContext(ctx);\n+        setCodeListEntrySearchFields(pageHelper);\n+        ctx.respondWith().template(\"/templates/biz/codelists/code-list-entries.html.pasta\", codeList, pageHelper.asPage());\n     }\n \n     protected abstract BasePageHelper<E, ?, ?, ?> getEntriesAsPage(L codeList);\n \n+    protected abstract void setCodeListSearchFields(BasePageHelper<L, ?, ?, ?> pageHelper);", "originalCommit": "ce9cc042a0a56308845a6ec84b2ed937b6bd4ffb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "79be0c1839435ddc164f0b6bb506fb18cfe8589f", "url": "https://github.com/scireum/sirius-biz/commit/79be0c1839435ddc164f0b6bb506fb18cfe8589f", "message": "Renames methods", "committedDate": "2020-09-28T18:57:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ0NzA0Mw==", "url": "https://github.com/scireum/sirius-biz/pull/867#discussion_r496447043", "bodyText": "F\u00fcr SQL kann man nicht auch das SEARCH_PREFIXES Feld nehmen?", "author": "sabieber", "createdAt": "2020-09-29T06:30:08Z", "path": "src/main/java/sirius/biz/codelists/jdbc/SQLCodeListController.java", "diffHunk": "@@ -36,6 +41,21 @@\n                                           .orderAsc(SQLCodeListEntry.CODE_LIST_ENTRY_DATA.inner(CodeListEntryData.CODE)));\n     }\n \n+    @Override\n+    protected void setCodeListSearchFields(@Nonnull BasePageHelper<SQLCodeList, ?, ?, ?> pageHelper) {\n+        pageHelper.withSearchFields(QueryField.contains(CodeList.CODE_LIST_DATA.inner(CodeListData.CODE)),", "originalCommit": "ce9cc042a0a56308845a6ec84b2ed937b6bd4ffb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ0OTM3NA==", "url": "https://github.com/scireum/sirius-biz/pull/867#discussion_r496449374", "bodyText": "Mongo exclusive as far as I know \ud83d\ude2c", "author": "idlira", "createdAt": "2020-09-29T06:35:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ0NzA0Mw=="}], "type": "inlineReview"}]}