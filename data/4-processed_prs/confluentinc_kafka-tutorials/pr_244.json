{"pr_number": 244, "pr_title": "DEVX-1580 Provide some initial toolchain enhancements", "pr_createdAt": "2020-03-06T21:06:56Z", "pr_url": "https://github.com/confluentinc/kafka-tutorials/pull/244", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1NTY4NQ==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/244#discussion_r389155685", "bodyText": "I presume the plan would be to tweak this for ksqlDB and ask for a KSQLDB_VERSION?", "author": "colinhicks", "createdAt": "2020-03-06T21:35:23Z", "path": "templates/ksql/filtered/code/docker-compose.yml", "diffHunk": "@@ -0,0 +1,80 @@\n+---\n+version: '2'\n+\n+services:\n+  zookeeper:\n+    image: confluentinc/cp-zookeeper:<CP-VERSION>\n+    hostname: zookeeper\n+    container_name: zookeeper\n+    ports:\n+      - \"2181:2181\"\n+    environment:\n+      ZOOKEEPER_CLIENT_PORT: 2181\n+      ZOOKEEPER_TICK_TIME: 2000\n+\n+  broker:\n+    image: confluentinc/cp-enterprise-kafka:<CP-VERSION>\n+    hostname: broker\n+    container_name: broker\n+    depends_on:\n+      - zookeeper\n+    ports:\n+      - \"29092:29092\"\n+    environment:\n+      KAFKA_BROKER_ID: 1\n+      KAFKA_ZOOKEEPER_CONNECT: 'zookeeper:2181'\n+      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT\n+      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://broker:9092,PLAINTEXT_HOST://localhost:29092\n+      KAFKA_METRIC_REPORTERS: io.confluent.metrics.reporter.ConfluentMetricsReporter\n+      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1\n+      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0\n+      CONFLUENT_METRICS_REPORTER_BOOTSTRAP_SERVERS: broker:9092\n+      CONFLUENT_METRICS_REPORTER_ZOOKEEPER_CONNECT: zookeeper:2181\n+      CONFLUENT_METRICS_REPORTER_TOPIC_REPLICAS: 1\n+      CONFLUENT_METRICS_ENABLE: 'true'\n+      CONFLUENT_SUPPORT_CUSTOMER_ID: 'anonymous'\n+\n+  schema-registry:\n+    image: confluentinc/cp-schema-registry:<CP-VERSION>\n+    hostname: schema-registry\n+    container_name: schema-registry\n+    depends_on:\n+      - zookeeper\n+      - broker\n+    ports:\n+      - \"8081:8081\"\n+    environment:\n+      SCHEMA_REGISTRY_HOST_NAME: schema-registry\n+      SCHEMA_REGISTRY_KAFKASTORE_CONNECTION_URL: 'zookeeper:2181'\n+\n+  ksql-server:\n+    image: confluentinc/cp-ksql-server:<CP-VERSION>\n+    hostname: ksql-server", "originalCommit": "87f48ddaae237731ef94a259d40288012b2229b2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1NjgyNA==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/244#discussion_r389156824", "bodyText": "Yes, I missed that one.", "author": "bbejeck", "createdAt": "2020-03-06T21:38:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1NTY4NQ=="}], "type": "inlineReview"}, {"oid": "9100e1edb1a9958d9087e3bdd71ed0360b7e6b0f", "url": "https://github.com/confluentinc/kafka-tutorials/commit/9100e1edb1a9958d9087e3bdd71ed0360b7e6b0f", "message": "add replacements for ksqlDB versions, update docker-compose.yml file", "committedDate": "2020-03-06T22:03:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg2MTc1OA==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/244#discussion_r389861758", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0\n          \n          \n            \n                  KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0\n          \n          \n            \n                  KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1\n          \n          \n            \n                  KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 1", "author": "colinhicks", "createdAt": "2020-03-09T17:54:51Z", "path": "templates/ksql/filtered/code/docker-compose.yml", "diffHunk": "@@ -0,0 +1,80 @@\n+---\n+version: '2'\n+\n+services:\n+  zookeeper:\n+    image: confluentinc/cp-zookeeper:<CP-VERSION>\n+    hostname: zookeeper\n+    container_name: zookeeper\n+    ports:\n+      - \"2181:2181\"\n+    environment:\n+      ZOOKEEPER_CLIENT_PORT: 2181\n+      ZOOKEEPER_TICK_TIME: 2000\n+\n+  broker:\n+    image: confluentinc/cp-enterprise-kafka:<CP-VERSION>\n+    hostname: broker\n+    container_name: broker\n+    depends_on:\n+      - zookeeper\n+    ports:\n+      - \"29092:29092\"\n+    environment:\n+      KAFKA_BROKER_ID: 1\n+      KAFKA_ZOOKEEPER_CONNECT: 'zookeeper:2181'\n+      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT\n+      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://broker:9092,PLAINTEXT_HOST://localhost:29092\n+      KAFKA_METRIC_REPORTERS: io.confluent.metrics.reporter.ConfluentMetricsReporter\n+      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1\n+      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0", "originalCommit": "599a37ec0c7e97c474a1e38b878c7faae00c2576", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg2MjM4OQ==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/244#discussion_r389862389", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            docker exec -it ksql-cli ksql http://ksql-server:8088\n          \n          \n            \n            docker exec -it ksqldb-cli ksql http://ksqldb-server:8088", "author": "colinhicks", "createdAt": "2020-03-09T17:55:53Z", "path": "templates/ksql/static/dev/code/start-cli.sh", "diffHunk": "@@ -0,0 +1 @@\n+docker exec -it ksql-cli ksql http://ksql-server:8088", "originalCommit": "599a37ec0c7e97c474a1e38b878c7faae00c2576", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0c430fb0023d6780ef2f6ee3f41bc72113b6bd91", "url": "https://github.com/confluentinc/kafka-tutorials/commit/0c430fb0023d6780ef2f6ee3f41bc72113b6bd91", "message": "Initial work on tool chain improvements", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "abe0caea95e9774ed32c523f545aa1ebdc31092c", "url": "https://github.com/confluentinc/kafka-tutorials/commit/abe0caea95e9774ed32c523f545aa1ebdc31092c", "message": "Add check for existing tutorial by type", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "91f6fd04bbcef3201e1891aa94e25dd2d511fa39", "url": "https://github.com/confluentinc/kafka-tutorials/commit/91f6fd04bbcef3201e1891aa94e25dd2d511fa39", "message": "Add empty dot file to empty directories so git will pull them into the structure", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "37f448ccaddd7434b31de1c4474a88ea51a0231b", "url": "https://github.com/confluentinc/kafka-tutorials/commit/37f448ccaddd7434b31de1c4474a88ea51a0231b", "message": "Started clone process", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "6694d336a76bdc71c541af2485fe3be6fed02c38", "url": "https://github.com/confluentinc/kafka-tutorials/commit/6694d336a76bdc71c541af2485fe3be6fed02c38", "message": "First pass over clone script done", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "4dc1d256e4b4a3677a61189f4973e99e1f951c89", "url": "https://github.com/confluentinc/kafka-tutorials/commit/4dc1d256e4b4a3677a61189f4973e99e1f951c89", "message": "move check for existing tutorials to the top", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "23dd36b650f1f18838058b58f0d28a13f0060acf", "url": "https://github.com/confluentinc/kafka-tutorials/commit/23dd36b650f1f18838058b58f0d28a13f0060acf", "message": "Adding more print statements for different stages", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "41dfd802e3585e26966eb046c958de3043115339", "url": "https://github.com/confluentinc/kafka-tutorials/commit/41dfd802e3585e26966eb046c958de3043115339", "message": "add replacements for ksqlDB versions, update docker-compose.yml file", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "3e1ae4714eae388e1f2789ff299bfb9be6bb2939", "url": "https://github.com/confluentinc/kafka-tutorials/commit/3e1ae4714eae388e1f2789ff299bfb9be6bb2939", "message": "Initial work for generating a working project from start", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "7095caf1080ad77e6627717c2bf5af141e658837", "url": "https://github.com/confluentinc/kafka-tutorials/commit/7095caf1080ad77e6627717c2bf5af141e658837", "message": "Updates for getting a working initial sample, gradle build, java code and java test", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "b76bff867cf5e9dbebb7fc035bfbd3f24b3fe2fd", "url": "https://github.com/confluentinc/kafka-tutorials/commit/b76bff867cf5e9dbebb7fc035bfbd3f24b3fe2fd", "message": "Updated gen_project produces fully running bare-bones kstreams tutorial", "committedDate": "2020-03-11T19:48:31Z", "type": "commit"}, {"oid": "b76bff867cf5e9dbebb7fc035bfbd3f24b3fe2fd", "url": "https://github.com/confluentinc/kafka-tutorials/commit/b76bff867cf5e9dbebb7fc035bfbd3f24b3fe2fd", "message": "Updated gen_project produces fully running bare-bones kstreams tutorial", "committedDate": "2020-03-11T19:48:31Z", "type": "forcePushed"}, {"oid": "ec8de34d083db65f1eb854721e89938ee64f52ef", "url": "https://github.com/confluentinc/kafka-tutorials/commit/ec8de34d083db65f1eb854721e89938ee64f52ef", "message": "Apply suggestions from code review\n\nCo-Authored-By: Colin Hicks <colin.hicks@confluent.io>", "committedDate": "2020-03-11T19:51:41Z", "type": "commit"}, {"oid": "2877b0758435580a0bd5e88a24f0380ddf2e4ef6", "url": "https://github.com/confluentinc/kafka-tutorials/commit/2877b0758435580a0bd5e88a24f0380ddf2e4ef6", "message": "initial bare-bones ksql tutorial running", "committedDate": "2020-03-13T00:26:07Z", "type": "commit"}, {"oid": "ad85b397a21ec3dd80b8a25236991def7053bbbc", "url": "https://github.com/confluentinc/kafka-tutorials/commit/ad85b397a21ec3dd80b8a25236991def7053bbbc", "message": "Updates to get running bare bones KSQL tutorial running", "committedDate": "2020-03-13T20:16:48Z", "type": "commit"}, {"oid": "13979aab8717530efb2255f9397f0e2cc8595329", "url": "https://github.com/confluentinc/kafka-tutorials/commit/13979aab8717530efb2255f9397f0e2cc8595329", "message": "Added functionality for printing checklist at the end Additionally add to tutorial directory", "committedDate": "2020-03-13T22:28:13Z", "type": "commit"}, {"oid": "ad64595e9d982476aa67bb415320015faae5063d", "url": "https://github.com/confluentinc/kafka-tutorials/commit/ad64595e9d982476aa67bb415320015faae5063d", "message": "Don't allow scripted tutorial creating with props file in KT base directory", "committedDate": "2020-03-16T17:48:43Z", "type": "commit"}, {"oid": "1f5015f9df4015078218c4af8b579b84beae64a3", "url": "https://github.com/confluentinc/kafka-tutorials/commit/1f5015f9df4015078218c4af8b579b84beae64a3", "message": "Update the README file for using tools", "committedDate": "2020-03-16T20:42:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzMwMTUzMg==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/244#discussion_r393301532", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The script expects you to supply a properties file for setting the name and other parts of the tutorial.  Heres' an example properties file you can use.\n          \n          \n            \n            The script expects you to supply a properties file for setting the name and other parts of the tutorial.  Here's an example properties file you can use.", "author": "colinhicks", "createdAt": "2020-03-16T20:48:22Z", "path": "README.md", "diffHunk": "@@ -78,6 +78,111 @@ Kafka Tutorials is a bit unique in that each tutorial is self-testing. That is,\n \n With in each stack, these tutorials contain a few pieces. These are described below.\n \n+## Using tutorial author tools\n+\n+There are several pieces that you will put together for a tutorial.  Aside from the original content you need to provide (tutorial description, actual tutorial content, code, etc.), all of the steps described below can be automated.  You accomplish tutorial automation via one of two scripts in the `tools` directory\n+\n+  1. `gen_project.sh` \n+  2. `clone_tutorial.sh`\n+\n+Let's describe each script.\n+\n+### The `gen_project.sh` script\n+\n+As the name implies, the `gen_project.sh` script generates the minimal structure for a viable Kafka Tutorials tutorial.  The code and text contained in the tutorial are place holders, and you'll update those with your code and writing to complete the tutorial.\n+\n+The script expects you to supply a properties file for setting the name and other parts of the tutorial.  Heres' an example properties file you can use.", "originalCommit": "1f5015f9df4015078218c4af8b579b84beae64a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzMwMjU0NQ==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/244#discussion_r393302545", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            3. Execute `> tools/clone_tutoral.sh ~/clone-tutorial-props.sh`\n          \n          \n            \n            3. Execute `> tools/clone_tutorial.sh ~/clone-tutorial-props.sh`", "author": "colinhicks", "createdAt": "2020-03-16T20:50:22Z", "path": "README.md", "diffHunk": "@@ -78,6 +78,111 @@ Kafka Tutorials is a bit unique in that each tutorial is self-testing. That is,\n \n With in each stack, these tutorials contain a few pieces. These are described below.\n \n+## Using tutorial author tools\n+\n+There are several pieces that you will put together for a tutorial.  Aside from the original content you need to provide (tutorial description, actual tutorial content, code, etc.), all of the steps described below can be automated.  You accomplish tutorial automation via one of two scripts in the `tools` directory\n+\n+  1. `gen_project.sh` \n+  2. `clone_tutorial.sh`\n+\n+Let's describe each script.\n+\n+### The `gen_project.sh` script\n+\n+As the name implies, the `gen_project.sh` script generates the minimal structure for a viable Kafka Tutorials tutorial.  The code and text contained in the tutorial are place holders, and you'll update those with your code and writing to complete the tutorial.\n+\n+The script expects you to supply a properties file for setting the name and other parts of the tutorial.  Heres' an example properties file you can use.\n+```\n+#!/bin/sh\n+\n+# space-separated list of types could be one of ksql or kstreams\n+CARDS=\"kstreams ksql\"\n+\n+# all lower-case with no spaces\n+TUTORIAL_SHORT_NAME=my-tutorial-name\n+\n+# the MAIN_CLASS variable will generate a test named MAIN_CLASSTest\n+MAIN_CLASS=FilteringCode\n+AK_VERSION=2.4.0\n+CP_VERSION=5.4.0\n+KSQLDB_VERSION=0.7.1\n+SEMAPHORE_TEST_NAME=\"Test name for Semaphore run\"\n+PERMALINK=\"seo-friendly-link-to-my-tutorial\"\n+```\n+\n+To run this script:\n+\n+1. Create a branch\n+2. Make sure you are in the `Kafka Tutorials` base directory\n+3. Execute `> tools/gen_project.sh ~/my_tutorial_props.sh`\n+\n+You'll see a lot of information scroll across the screen, describing each step of the tutorial generation process. The last part of the information presented is a checklist of what you'll need to do to complete your tutorial, aside from adding your code and tutorial text.\n+\n+```\n+Your tutorial, my-tutorial-name, has been generated successfully!\n+The script adds a copy of this checklist to the my-tutorial-name directory.\n+\n+There are some additional steps you'll need to take to complete the tutorial:\n+\n+\n+1. Update the following entries in _data/tutorials.yaml file\n+    a. title\n+    b. meta-description\n+    c. problem\n+    c. introduction\n+\n+You can find these fields by searching for my-tutorial-name in the _data/tutorials.yaml file.\n+\n+\n+2. Update the link text then add the following link(s) to the index.html file in the appropriate section:\n+\n+\n+   <li><a href=\"seo-friendly-link-to-my-tutorial/kstreams.html\">MEANINGFUL LINK TEXT HERE</a></li>\n+\n+   <li><a href=\"seo-friendly-link-to-my-tutorial/ksql.html\">MEANINGFUL LINK TEXT HERE</a></li> \n+\n+```\n+\n+If you only specified one tutorial type (`ksql` or `kstreams`) then you'd only have one link in the output.  Also, a copy of this output is copied in your tutorial directory `/Kafka Tutorials base dir/_includes/tutorials/you_tutorial_short_name`\n+\n+### The `clone-tutorial.sh` script\n+\n+As the name implies, this script creates a clone of an existing tutorial.  The clone script changes the name of the tutorial throughout the content.  To clone a tutorial, you also need to provide a properties file\n+\n+```\n+#!/bin/sh\n+\n+# clones everything ksql and kstreams\n+ORIG_TUTORIAL=filtering\n+\n+# to clone just the ksql part\n+#ORIG_TUTORIAL=filtering/ksql\n+\n+# to clone just the kstreams portion\n+#ORIG_TUTORIAL=filtering/kstreams\n+NEW_TUTORIAL=something-close-to-filtering\n+SEMAPHORE_TEST_NAME=\"My New Filtering Tutorial\"\n+PERMALINK=filtering-new-hotness-tutorial\n+```\n+\n+To clone a tutorial:\n+\n+1. Create a branch\n+2. Make sure you are in the `Kafka Tutorials` base directory\n+3. Execute `> tools/clone_tutoral.sh ~/clone-tutorial-props.sh`", "originalCommit": "1f5015f9df4015078218c4af8b579b84beae64a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d660c009cfac895f27cc59e991e6f84a40d2fcfb", "url": "https://github.com/confluentinc/kafka-tutorials/commit/d660c009cfac895f27cc59e991e6f84a40d2fcfb", "message": "update _config.yml to exclude tools dir", "committedDate": "2020-03-16T22:16:36Z", "type": "commit"}, {"oid": "49c81d4565c9653c58dbc36637a80b387dc509bf", "url": "https://github.com/confluentinc/kafka-tutorials/commit/49c81d4565c9653c58dbc36637a80b387dc509bf", "message": "Apply suggestions from code review\n\nCo-Authored-By: Colin Hicks <colin.hicks@confluent.io>", "committedDate": "2020-03-16T22:19:39Z", "type": "commit"}]}