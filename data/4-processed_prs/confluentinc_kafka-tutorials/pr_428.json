{"pr_number": 428, "pr_title": "update deserialization errors tutorial inline with changes to ksqlDB master", "pr_createdAt": "2020-06-05T11:57:57Z", "pr_url": "https://github.com/confluentinc/kafka-tutorials/pull/428", "timeline": [{"oid": "da77655b0290d3d0c32fbd6b6391004c82471da5", "url": "https://github.com/confluentinc/kafka-tutorials/commit/da77655b0290d3d0c32fbd6b6391004c82471da5", "message": "update deserialization errors tutorial inline with changes to ksqlDB master\n\nThis includes changing the query we run against the processing logger to return something more useful, i.e. something that would allow the user to work out what the cause of the error was. This makes use of the new `encode` method to decode the base64 encoded record - nice!", "committedDate": "2020-06-05T11:56:20Z", "type": "commit"}, {"oid": "dba7a8dbdc25982737bc8b3e5daea9884a8a75ab", "url": "https://github.com/confluentinc/kafka-tutorials/commit/dba7a8dbdc25982737bc8b3e5daea9884a8a75ab", "message": "filter by topic", "committedDate": "2020-06-05T13:34:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk1ODQ3Mw==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/428#discussion_r435958473", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Notice we needed to quote the `topic` field in the `WHERE` clause, as its a reserved word.\n          \n          \n            \n            Notice we needed to quote the `topic` field in the `WHERE` clause, as it's a reserved word.", "author": "colinhicks", "createdAt": "2020-06-05T14:26:28Z", "path": "_includes/tutorials/deserialization-errors/ksql/markup/dev/check-errors-query.adoc", "diffHunk": "@@ -2,10 +2,17 @@ Now here comes the fun part. We know that at least one of the records produced h\n Therefore, this one error needs to show up somewhere.\n With the https://docs.confluent.io/current/ksql/docs/developer-guide/processing-log.html[KSQL Processing Log] feature enabled, you can query a stream called `KSQL_PROCESSING_LOG` to check for deserialization errors.\n \n+The query below is extracting some of the data available in the processing log.\n+As we configured the processing log to include the payload of the message, we can also use the `encode` method to convert the record from `base64` encoded into a human readable `utf8` encoding:\n+\n +++++\n <pre class=\"snippet\"><code class=\"sql\">{% include_raw tutorials/deserialization-errors/ksql/code/tutorial-steps/dev/check-errors-query.sql %}</code></pre>\n +++++\n \n+Notice we needed to quote the `topic` field in the `WHERE` clause, as its a reserved word.", "originalCommit": "dba7a8dbdc25982737bc8b3e5daea9884a8a75ab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk1ODc3Mw==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/428#discussion_r435958773", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            While the `ERRORMESSAGE` is a little cryptic in this instances, the `CAUSE` and `MSG` columns would be enough to diagnose the issue here.\n          \n          \n            \n            While the `ERRORMESSAGE` is a little cryptic in these instances, the `CAUSE` and `MSG` columns would be enough to diagnose the issue here.", "author": "colinhicks", "createdAt": "2020-06-05T14:26:54Z", "path": "_includes/tutorials/deserialization-errors/ksql/markup/dev/check-errors-query.adoc", "diffHunk": "@@ -2,10 +2,17 @@ Now here comes the fun part. We know that at least one of the records produced h\n Therefore, this one error needs to show up somewhere.\n With the https://docs.confluent.io/current/ksql/docs/developer-guide/processing-log.html[KSQL Processing Log] feature enabled, you can query a stream called `KSQL_PROCESSING_LOG` to check for deserialization errors.\n \n+The query below is extracting some of the data available in the processing log.\n+As we configured the processing log to include the payload of the message, we can also use the `encode` method to convert the record from `base64` encoded into a human readable `utf8` encoding:\n+\n +++++\n <pre class=\"snippet\"><code class=\"sql\">{% include_raw tutorials/deserialization-errors/ksql/code/tutorial-steps/dev/check-errors-query.sql %}</code></pre>\n +++++\n \n+Notice we needed to quote the `topic` field in the `WHERE` clause, as its a reserved word.\n+\n+While the `ERRORMESSAGE` is a little cryptic in this instances, the `CAUSE` and `MSG` columns would be enough to diagnose the issue here.", "originalCommit": "dba7a8dbdc25982737bc8b3e5daea9884a8a75ab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY1NTc2Nw==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/428#discussion_r436655767", "bodyText": "There's only a single error in the example, so went with this instance.", "author": "big-andy-coates", "createdAt": "2020-06-08T12:29:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk1ODc3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk1OTE0NQ==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/428#discussion_r435959145", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            This stream simply copies the data from the previous stream, ensuring that the `ID` field is used as key.\n          \n          \n            \n            This stream simply copies the data from the previous stream, ensuring that the `ID` field is used as the key.", "author": "colinhicks", "createdAt": "2020-06-05T14:27:27Z", "path": "_includes/tutorials/deserialization-errors/ksql/markup/dev/create-inputs.adoc", "diffHunk": "@@ -1,8 +1,8 @@\n To start off the implementation of this scenario, you need to create a stream that represent sensors.\n This stream will contain a timestamp field called `TIMESTAMP` to indicate when the sensor was enabled.\n-Each sensor will also have a field called `ENABLED` to indicate whether the status of the sensor.\n-While the this stream acts upon data stored in a topic called `SENSORS_RAW`, we will create another stream called `SENSORS` to actually handle the sensors.\n-This stream simply copies the data from the previous stream, but making sure that the `ID` field is used as key.\n+Each sensor will also have a field called `ENABLED` to indicate the status of the sensor.\n+While this stream acts upon data stored in a topic called `SENSORS_RAW`, we will create derived stream called `SENSORS` to actually handle the sensors.\n+This stream simply copies the data from the previous stream, ensuring that the `ID` field is used as key.", "originalCommit": "dba7a8dbdc25982737bc8b3e5daea9884a8a75ab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTk2MDg4MQ==", "url": "https://github.com/confluentinc/kafka-tutorials/pull/428#discussion_r435960881", "bodyText": "Nice :)", "author": "colinhicks", "createdAt": "2020-06-05T14:30:15Z", "path": "_includes/tutorials/deserialization-errors/ksql/code/tutorial-steps/dev/check-errors-query.sql", "diffHunk": "@@ -1,5 +1,7 @@\n SELECT\n-    LOGGER,\n-    LEVEL,\n-    MESSAGE->DESERIALIZATIONERROR->ERRORMESSAGE\n-FROM KSQL_PROCESSING_LOG EMIT CHANGES LIMIT 1;\n+    message->deserializationError->errorMessage,\n+    encode(message->deserializationError->RECORDB64, 'base64', 'utf8') AS MSG,", "originalCommit": "dba7a8dbdc25982737bc8b3e5daea9884a8a75ab", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dfcc031724eed965cb7be907b50a175767d8030f", "url": "https://github.com/confluentinc/kafka-tutorials/commit/dfcc031724eed965cb7be907b50a175767d8030f", "message": "Update _includes/tutorials/deserialization-errors/ksql/markup/dev/check-errors-query.adoc\n\nCo-authored-by: Colin Hicks <colin.hicks@gmail.com>", "committedDate": "2020-06-08T12:27:53Z", "type": "commit"}, {"oid": "d77e04ac2eda81cc6ceabfe2327e8497053569bd", "url": "https://github.com/confluentinc/kafka-tutorials/commit/d77e04ac2eda81cc6ceabfe2327e8497053569bd", "message": "Update check-errors-query.adoc", "committedDate": "2020-06-08T12:28:36Z", "type": "commit"}, {"oid": "dd04ddfa8a3b6a61c879a2c510c9061fed81685a", "url": "https://github.com/confluentinc/kafka-tutorials/commit/dd04ddfa8a3b6a61c879a2c510c9061fed81685a", "message": "Update _includes/tutorials/deserialization-errors/ksql/markup/dev/create-inputs.adoc\n\nCo-authored-by: Colin Hicks <colin.hicks@gmail.com>", "committedDate": "2020-06-08T12:29:14Z", "type": "commit"}]}