{"pr_number": 4120, "pr_title": "task-NXP-28937-release-pipeline", "pr_createdAt": "2020-06-05T16:28:48Z", "pr_url": "https://github.com/nuxeo/nuxeo/pull/4120", "timeline": [{"oid": "61a746ca6819fe64f0832cf612697ee78ca85821", "url": "https://github.com/nuxeo/nuxeo/commit/61a746ca6819fe64f0832cf612697ee78ca85821", "message": "NXP-28937: Add Jenkinsfile to promote a build as a release", "committedDate": "2020-06-05T16:32:11Z", "type": "forcePushed"}, {"oid": "667de37ab8ad07f691b84176ea187f97bfcc7073", "url": "https://github.com/nuxeo/nuxeo/commit/667de37ab8ad07f691b84176ea187f97bfcc7073", "message": "NXP-28937: Improve git calls", "committedDate": "2020-06-08T08:17:41Z", "type": "forcePushed"}, {"oid": "ede758e5351f9ef7fd106e3e95ddcf4ecee0eba8", "url": "https://github.com/nuxeo/nuxeo/commit/ede758e5351f9ef7fd106e3e95ddcf4ecee0eba8", "message": "NXP-28937: Add Jenkinsfile to promote a build as a release", "committedDate": "2020-06-08T09:17:03Z", "type": "commit"}, {"oid": "a41e309276122533dad82caca132b09379119119", "url": "https://github.com/nuxeo/nuxeo/commit/a41e309276122533dad82caca132b09379119119", "message": "NXP-28937: Improve git calls", "committedDate": "2020-06-08T09:17:03Z", "type": "commit"}, {"oid": "a41e309276122533dad82caca132b09379119119", "url": "https://github.com/nuxeo/nuxeo/commit/a41e309276122533dad82caca132b09379119119", "message": "NXP-28937: Improve git calls", "committedDate": "2020-06-08T09:17:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2NTgwMQ==", "url": "https://github.com/nuxeo/nuxeo/pull/4120#discussion_r436565801", "bodyText": "is this because since there is no new untracked file to be added any way at this point that you privilledge -a over . (and to have a one-liner ?)", "author": "NourNuxeo", "createdAt": "2020-06-08T09:25:38Z", "path": "ci/Jenkinsfiles/build.groovy", "diffHunk": "@@ -396,8 +396,7 @@ pipeline {\n           ----------------------------------------\n           \"\"\"\n           sh \"\"\"\n-            git add .\n-            git commit -m \"Release ${VERSION}\"\n+            git commit -a -m \"Release ${VERSION}\"", "originalCommit": "a41e309276122533dad82caca132b09379119119", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2NzczMw==", "url": "https://github.com/nuxeo/nuxeo/pull/4120#discussion_r436567733", "bodyText": "Yes for both reasons", "author": "ataillefer", "createdAt": "2020-06-08T09:29:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2NTgwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2OTQzOQ==", "url": "https://github.com/nuxeo/nuxeo/pull/4120#discussion_r436569439", "bodyText": "The original jx step tag adds a --force (-f) to the git tag call. I guess it's unecessary ?\nAnd calling the git command manually spares you commiting again uselessly ?", "author": "NourNuxeo", "createdAt": "2020-06-08T09:32:33Z", "path": "ci/Jenkinsfiles/build.groovy", "diffHunk": "@@ -643,7 +642,8 @@ pipeline {\n             git config credential.helper store\n \n             # Git tag\n-            jx step tag -v ${VERSION}\n+            git tag -a v${VERSION} -m \"Release ${VERSION}\"\n+            git push origin v${VERSION}", "originalCommit": "a41e309276122533dad82caca132b09379119119", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU3MjUxOQ==", "url": "https://github.com/nuxeo/nuxeo/pull/4120#discussion_r436572519", "bodyText": "The original jx step tag adds a --force (-f) to the git tag call. I guess it's unnecessary ?\n\nTrying to replace an exiting tag should never happen and I think we prefer an explicit error if ever it were the case.\n\nAnd calling the git command manually spares you committing again uselessly ?\n\nYes it prevents from having an unnecessary extra empty commit, see for instance 90b1aaa and\n\nAnd it's one less use of jx \ud83d\ude04.", "author": "ataillefer", "createdAt": "2020-06-08T09:38:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2OTQzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU3OTQyOA==", "url": "https://github.com/nuxeo/nuxeo/pull/4120#discussion_r436579428", "bodyText": "Thanks for explenations !", "author": "NourNuxeo", "createdAt": "2020-06-08T09:50:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2OTQzOQ=="}], "type": "inlineReview"}]}