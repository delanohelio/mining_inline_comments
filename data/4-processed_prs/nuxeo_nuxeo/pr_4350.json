{"pr_number": 4350, "pr_title": "improvement NXP 29685 update readme include docker", "pr_createdAt": "2020-09-30T21:46:36Z", "pr_url": "https://github.com/nuxeo/nuxeo/pull/4350", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIwMzkxNg==", "url": "https://github.com/nuxeo/nuxeo/pull/4350#discussion_r498203916", "bodyText": "JDK or JRE, is this sync with other docs (I remember there was >=11)", "author": "bdelbosc", "createdAt": "2020-10-01T12:27:06Z", "path": "README.md", "diffHunk": "@@ -1,118 +1,81 @@\n \n-| Nuxeo QA Job | Status | \n-|-----|--------|\n-| Build & Unit tests | [![Build Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/nuxeo-master)](https://qa.nuxeo.org/jenkins/job/master/job/nuxeo-master)|\n-| WebDriver functional testing | [![Test Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/FT-nuxeo-master-webdriver-cap-tomcat)](https://qa.nuxeo.org/jenkins/job/master/job/FT-nuxeo-master-webdriver-cap-tomcat)\n-|Funkload tests with multi-DB |[![Test Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/FT-nuxeo-master-funkload-cap-tomcat-multidb)](https://qa.nuxeo.org/jenkins/job/master/job/FT-nuxeo-master-funkload-cap-tomcat-multidb)\n+# Nuxeo Platform\n \n+[![Build Status](https://jenkins.platform.dev.nuxeo.com/buildStatus/icon?job=nuxeo/nuxeo/master)](https://jenkins.platform.dev.nuxeo.com/job/nuxeo/job/nuxeo/job/master/)\n \n-# About the Nuxeo Platform\n-\n+## About the Nuxeo Platform\n \n The [Nuxeo Platform](http://www.nuxeo.com/products/content-management-platform/) is an open source customizable and extensible content management platform for building business applications. It provides the foundation for developing [document management](http://www.nuxeo.com/solutions/document-management/), [digital asset management](http://www.nuxeo.com/solutions/digital-asset-management/), [case management application](http://www.nuxeo.com/solutions/case-management/) and [knowledge management](http://www.nuxeo.com/solutions/advanced-knowledge-base/). You can easily add features using ready-to-use addons or by extending the platform using its extension point system.\n \n The Nuxeo Platform is developed and supported by Nuxeo, with contributions from the community.\n \n-# Sub-Modules Organization\n-\n-The project is splitted in several sub-modules (listed in dependency order):\n-\n-* **nuxeo-common**:\n-Common utilities\n-* **nuxeo-runtime**:\n-Container and runtime basic services\n-* **nuxeo-core**:\n-Document/content management core services\n-* **nuxeo-services**:\n-Basic services such as file manager, directories, document types\n-* **nuxeo-theme**:\n-Services related to the theme and theme rendering\n-* **nuxeo-jsf**:\n-JSF related services\n-* **nuxeo-webengine**:\n-Services and framework related to WebEngine, the Nuxeo lightweight rendering engine\n-* **nuxeo-features**:\n-Advanced high-level services, such as audit, imaging, publisher, thumbnails, search\n-* **nuxeo-dm**:\n-The default Nuxeo Platform application, mostly configuration and UI elements\n-* **nuxeo-distribution**:\n-This module builds, packages and tests the Nuxeo products.\n-\n-# Building\n-\n-Open Nuxeo in [Eclipse Che](https://www.eclipse.org/che/):  \n-[![Open in Eclipse Che](http://beta.codenvy.com/factory/resources/codenvy-contribute.svg)](https://beta.codenvy.com/f?id=r3pbh9wv7tjvbws7)\n-\n-## Requirements\n-\n-Running the Nuxeo Platform requires Java 11.\n-Depending on the features you want to use, you may need some third-party software, such as Libre Office and pdftohtml for document preview or ImageMagick for pictures. The list of third-party software is available in our Admin documentation: [Installing and Setting Up Related Software](http://doc.nuxeo.com/x/zgJc).\n+## Installation\n \n-Building the Nuxeo Platform requires the following tools:\n+Please follow the [Installation](https://doc.nuxeo.com/n/b1j) guide.\n \n-* JDK 11 (Oracle's JDK or OpenJDK recommended)\n-* Apache Maven 3.1.1+ (3.2+ recommended)\n-* Apache Ant 1.7.1+\n-* Git (obviously)\n+Running the Nuxeo Platform requires Java 11.", "originalCommit": "e9ffe76360760d917c655a2a77f80ad519f9eb8d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIyMzk4OQ==", "url": "https://github.com/nuxeo/nuxeo/pull/4350#discussion_r498223989", "bodyText": "https://doc.nuxeo.com/nxdoc/next/installation/\n\nJDK 11 (Oracle's JDK or OpenJDK)\n\nYes, let's stick with that, upper versions aren't tested.", "author": "ataillefer", "createdAt": "2020-10-01T12:59:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIwMzkxNg=="}], "type": "inlineReview"}, {"oid": "388bddea68a2b3adcf1dbe9f84b1efd0de088dd2", "url": "https://github.com/nuxeo/nuxeo/commit/388bddea68a2b3adcf1dbe9f84b1efd0de088dd2", "message": "NXP-29685: README cleanup", "committedDate": "2020-10-01T13:00:06Z", "type": "commit"}, {"oid": "f50b784177ef247239f519a25a050fb7a01d2a2a", "url": "https://github.com/nuxeo/nuxeo/commit/f50b784177ef247239f519a25a050fb7a01d2a2a", "message": "NXP-29685: Document building the Docker image from a freshly built server ZIP", "committedDate": "2020-10-01T13:00:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI2MzcyNg==", "url": "https://github.com/nuxeo/nuxeo/pull/4350#discussion_r498263726", "bodyText": "if this builds also the server zip and modules it is not only the docker image and you have to explain the diff with the previous command", "author": "bdelbosc", "createdAt": "2020-10-01T13:56:01Z", "path": "README.md", "diffHunk": "@@ -1,118 +1,81 @@\n \n-| Nuxeo QA Job | Status | \n-|-----|--------|\n-| Build & Unit tests | [![Build Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/nuxeo-master)](https://qa.nuxeo.org/jenkins/job/master/job/nuxeo-master)|\n-| WebDriver functional testing | [![Test Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/FT-nuxeo-master-webdriver-cap-tomcat)](https://qa.nuxeo.org/jenkins/job/master/job/FT-nuxeo-master-webdriver-cap-tomcat)\n-|Funkload tests with multi-DB |[![Test Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/FT-nuxeo-master-funkload-cap-tomcat-multidb)](https://qa.nuxeo.org/jenkins/job/master/job/FT-nuxeo-master-funkload-cap-tomcat-multidb)\n+# Nuxeo Platform\n \n+[![Build Status](https://jenkins.platform.dev.nuxeo.com/buildStatus/icon?job=nuxeo/nuxeo/master)](https://jenkins.platform.dev.nuxeo.com/job/nuxeo/job/nuxeo/job/master/)\n \n-# About the Nuxeo Platform\n-\n+## About the Nuxeo Platform\n \n The [Nuxeo Platform](http://www.nuxeo.com/products/content-management-platform/) is an open source customizable and extensible content management platform for building business applications. It provides the foundation for developing [document management](http://www.nuxeo.com/solutions/document-management/), [digital asset management](http://www.nuxeo.com/solutions/digital-asset-management/), [case management application](http://www.nuxeo.com/solutions/case-management/) and [knowledge management](http://www.nuxeo.com/solutions/advanced-knowledge-base/). You can easily add features using ready-to-use addons or by extending the platform using its extension point system.\n \n The Nuxeo Platform is developed and supported by Nuxeo, with contributions from the community.\n \n-# Sub-Modules Organization\n-\n-The project is splitted in several sub-modules (listed in dependency order):\n-\n-* **nuxeo-common**:\n-Common utilities\n-* **nuxeo-runtime**:\n-Container and runtime basic services\n-* **nuxeo-core**:\n-Document/content management core services\n-* **nuxeo-services**:\n-Basic services such as file manager, directories, document types\n-* **nuxeo-theme**:\n-Services related to the theme and theme rendering\n-* **nuxeo-jsf**:\n-JSF related services\n-* **nuxeo-webengine**:\n-Services and framework related to WebEngine, the Nuxeo lightweight rendering engine\n-* **nuxeo-features**:\n-Advanced high-level services, such as audit, imaging, publisher, thumbnails, search\n-* **nuxeo-dm**:\n-The default Nuxeo Platform application, mostly configuration and UI elements\n-* **nuxeo-distribution**:\n-This module builds, packages and tests the Nuxeo products.\n-\n-# Building\n-\n-Open Nuxeo in [Eclipse Che](https://www.eclipse.org/che/):  \n-[![Open in Eclipse Che](http://beta.codenvy.com/factory/resources/codenvy-contribute.svg)](https://beta.codenvy.com/f?id=r3pbh9wv7tjvbws7)\n-\n-## Requirements\n-\n-Running the Nuxeo Platform requires Java 11.\n-Depending on the features you want to use, you may need some third-party software, such as Libre Office and pdftohtml for document preview or ImageMagick for pictures. The list of third-party software is available in our Admin documentation: [Installing and Setting Up Related Software](http://doc.nuxeo.com/x/zgJc).\n+## Installation\n \n-Building the Nuxeo Platform requires the following tools:\n+Please follow the [Installation](https://doc.nuxeo.com/n/b1j) guide.\n \n-* JDK 11 (Oracle's JDK or OpenJDK recommended)\n-* Apache Maven 3.1.1+ (3.2+ recommended)\n-* Apache Ant 1.7.1+\n-* Git (obviously)\n+Running the Nuxeo Platform requires JDK 11, Oracle's JDK or OpenJDK.\n \n-# QA\n+Depending on the features you want to use, you may need some third-party software, such as LibreOffice and pdftohtml for document preview or ImageMagick for pictures. The list of third-party software is available in our Admin documentation: [Installing and Setting Up Related Software](https://doc.nuxeo.com/n/Yki).\n \n-Each module includes unit and integration tests. Functional tests are available in nuxeo-distribution and for each addon package module.\n+## Building\n \n-We also provide some tooling for tests:\n+Building the Nuxeo Platform requires the following tools:\n \n-* [https://github.com/nuxeo/tools-nuxeo-ftest](https://github.com/nuxeo/tools-nuxeo-ftest)\n-* [https://github.com/nuxeo/ant-assembly-maven-plugin](https://github.com/nuxeo/ant-assembly-maven-plugin)\n-* [https://github.com/nuxeo/integration-scripts/](https://github.com/nuxeo/integration-scripts/)\n+- Git (obviously)\n+- JDK 11 (Oracle's JDK or OpenJDK recommended)\n+- Apache Maven 3.1.1+ (3.2+ recommended)\n+- Apache Ant 1.7.1+\n \n-# Deploying\n+Get the source code:\n \n-1. Get the source code:\n-```\n+```shell\n git clone git@github.com:nuxeo/nuxeo.git\n cd nuxeo\n-python clone.py master -a\n ```\n-2. Build using Maven:\n+\n+To build everything, including the server ZIP, packages and Docker image, run:\n+\n+```shell\n+mvn clean install -Pdistrib,docker -DskipTests\n ```\n-mvn clean install -Paddons,distrib\n+\n+To build only the Docker image along with its dependencies (server modules and server ZIP), run:", "originalCommit": "f50b784177ef247239f519a25a050fb7a01d2a2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ1MDg5NQ==", "url": "https://github.com/nuxeo/nuxeo/pull/4350#discussion_r499450895", "bodyText": "\"only\" refers to \"the Docker image along with its dependencies (server modules and server ZIP)\", meaning: modules + ZIP + Docker image, but not \"everything, including packages\" as the previous command.\nMaybe the following is clearer:\n\"To take the shortest path for building the Docker image, run the following command. It starts by building the Docker image's dependencies, server modules and ZIP, then the Docker image itself.\"\nWDYT?", "author": "ataillefer", "createdAt": "2020-10-05T09:10:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI2MzcyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI2NjEwMw==", "url": "https://github.com/nuxeo/nuxeo/pull/4350#discussion_r498266103", "bodyText": "This command (with -nsu added) takes 14 minutes even when run multiple times this can be done once but this is a true show stopper.\nThe below command takes less than 2 minutes:\nexport MAVEN_OPTS='-Xmx4g -Xms2g -XX:+TieredCompilation -XX:TieredStopAtLevel=1'\ntime (mvn -nsu -am -pl server/nuxeo-server-tomcat -Pdistrib -DexcludeGroupIds=org.nuxeo -DskipTests -T6 install -Dnuxeo.skip.enforcer=true && mvn -nsu -pl docker -Pdistrib,docker -Dnuxeo.skip.enforcer=true install)", "author": "bdelbosc", "createdAt": "2020-10-01T13:58:57Z", "path": "README.md", "diffHunk": "@@ -1,118 +1,81 @@\n \n-| Nuxeo QA Job | Status | \n-|-----|--------|\n-| Build & Unit tests | [![Build Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/nuxeo-master)](https://qa.nuxeo.org/jenkins/job/master/job/nuxeo-master)|\n-| WebDriver functional testing | [![Test Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/FT-nuxeo-master-webdriver-cap-tomcat)](https://qa.nuxeo.org/jenkins/job/master/job/FT-nuxeo-master-webdriver-cap-tomcat)\n-|Funkload tests with multi-DB |[![Test Status](https://qa.nuxeo.org/jenkins/buildStatus/icon?job=master/FT-nuxeo-master-funkload-cap-tomcat-multidb)](https://qa.nuxeo.org/jenkins/job/master/job/FT-nuxeo-master-funkload-cap-tomcat-multidb)\n+# Nuxeo Platform\n \n+[![Build Status](https://jenkins.platform.dev.nuxeo.com/buildStatus/icon?job=nuxeo/nuxeo/master)](https://jenkins.platform.dev.nuxeo.com/job/nuxeo/job/nuxeo/job/master/)\n \n-# About the Nuxeo Platform\n-\n+## About the Nuxeo Platform\n \n The [Nuxeo Platform](http://www.nuxeo.com/products/content-management-platform/) is an open source customizable and extensible content management platform for building business applications. It provides the foundation for developing [document management](http://www.nuxeo.com/solutions/document-management/), [digital asset management](http://www.nuxeo.com/solutions/digital-asset-management/), [case management application](http://www.nuxeo.com/solutions/case-management/) and [knowledge management](http://www.nuxeo.com/solutions/advanced-knowledge-base/). You can easily add features using ready-to-use addons or by extending the platform using its extension point system.\n \n The Nuxeo Platform is developed and supported by Nuxeo, with contributions from the community.\n \n-# Sub-Modules Organization\n-\n-The project is splitted in several sub-modules (listed in dependency order):\n-\n-* **nuxeo-common**:\n-Common utilities\n-* **nuxeo-runtime**:\n-Container and runtime basic services\n-* **nuxeo-core**:\n-Document/content management core services\n-* **nuxeo-services**:\n-Basic services such as file manager, directories, document types\n-* **nuxeo-theme**:\n-Services related to the theme and theme rendering\n-* **nuxeo-jsf**:\n-JSF related services\n-* **nuxeo-webengine**:\n-Services and framework related to WebEngine, the Nuxeo lightweight rendering engine\n-* **nuxeo-features**:\n-Advanced high-level services, such as audit, imaging, publisher, thumbnails, search\n-* **nuxeo-dm**:\n-The default Nuxeo Platform application, mostly configuration and UI elements\n-* **nuxeo-distribution**:\n-This module builds, packages and tests the Nuxeo products.\n-\n-# Building\n-\n-Open Nuxeo in [Eclipse Che](https://www.eclipse.org/che/):  \n-[![Open in Eclipse Che](http://beta.codenvy.com/factory/resources/codenvy-contribute.svg)](https://beta.codenvy.com/f?id=r3pbh9wv7tjvbws7)\n-\n-## Requirements\n-\n-Running the Nuxeo Platform requires Java 11.\n-Depending on the features you want to use, you may need some third-party software, such as Libre Office and pdftohtml for document preview or ImageMagick for pictures. The list of third-party software is available in our Admin documentation: [Installing and Setting Up Related Software](http://doc.nuxeo.com/x/zgJc).\n+## Installation\n \n-Building the Nuxeo Platform requires the following tools:\n+Please follow the [Installation](https://doc.nuxeo.com/n/b1j) guide.\n \n-* JDK 11 (Oracle's JDK or OpenJDK recommended)\n-* Apache Maven 3.1.1+ (3.2+ recommended)\n-* Apache Ant 1.7.1+\n-* Git (obviously)\n+Running the Nuxeo Platform requires JDK 11, Oracle's JDK or OpenJDK.\n \n-# QA\n+Depending on the features you want to use, you may need some third-party software, such as LibreOffice and pdftohtml for document preview or ImageMagick for pictures. The list of third-party software is available in our Admin documentation: [Installing and Setting Up Related Software](https://doc.nuxeo.com/n/Yki).\n \n-Each module includes unit and integration tests. Functional tests are available in nuxeo-distribution and for each addon package module.\n+## Building\n \n-We also provide some tooling for tests:\n+Building the Nuxeo Platform requires the following tools:\n \n-* [https://github.com/nuxeo/tools-nuxeo-ftest](https://github.com/nuxeo/tools-nuxeo-ftest)\n-* [https://github.com/nuxeo/ant-assembly-maven-plugin](https://github.com/nuxeo/ant-assembly-maven-plugin)\n-* [https://github.com/nuxeo/integration-scripts/](https://github.com/nuxeo/integration-scripts/)\n+- Git (obviously)\n+- JDK 11 (Oracle's JDK or OpenJDK recommended)\n+- Apache Maven 3.1.1+ (3.2+ recommended)\n+- Apache Ant 1.7.1+\n \n-# Deploying\n+Get the source code:\n \n-1. Get the source code:\n-```\n+```shell\n git clone git@github.com:nuxeo/nuxeo.git\n cd nuxeo\n-python clone.py master -a\n ```\n-2. Build using Maven:\n+\n+To build everything, including the server ZIP, packages and Docker image, run:\n+\n+```shell\n+mvn clean install -Pdistrib,docker -DskipTests", "originalCommit": "f50b784177ef247239f519a25a050fb7a01d2a2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTQ5OTI3NQ==", "url": "https://github.com/nuxeo/nuxeo/pull/4350#discussion_r499499275", "bodyText": "The command you're suggesting doesn't build the packages, which is the purpose of this first command: build everything.\nYet, you're absolutely right about the following things to speed up the build!\n\nexport the relevant MAVEN_OPTS\nno mvn clean\n-Dnuxeo.skip.enforcer=true\n-T6\n\nNote that -nsu isn't needed since the command builds the whole repository from sources and there is no SNAPSHOT dependency.", "author": "ataillefer", "createdAt": "2020-10-05T10:30:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI2NjEwMw=="}], "type": "inlineReview"}, {"oid": "319331cc63ad6022247f546e3a92bf1d4068b5b8", "url": "https://github.com/nuxeo/nuxeo/commit/319331cc63ad6022247f546e3a92bf1d4068b5b8", "message": "NXP-29685: Document building the Docker image from a freshly built server ZIP", "committedDate": "2020-10-05T10:27:14Z", "type": "commit"}, {"oid": "319331cc63ad6022247f546e3a92bf1d4068b5b8", "url": "https://github.com/nuxeo/nuxeo/commit/319331cc63ad6022247f546e3a92bf1d4068b5b8", "message": "NXP-29685: Document building the Docker image from a freshly built server ZIP", "committedDate": "2020-10-05T10:27:14Z", "type": "forcePushed"}]}