{"pr_number": 3902, "pr_title": "NXP-28802: Make fixed part of document history pp configurable (10.10)", "pr_createdAt": "2020-04-09T01:45:20Z", "pr_url": "https://github.com/nuxeo/nuxeo/pull/3902", "timeline": [{"oid": "2d1b26366593989acd892099661e2fb0f559c9ef", "url": "https://github.com/nuxeo/nuxeo/commit/2d1b26366593989acd892099661e2fb0f559c9ef", "message": "NXP-28802: Make fixed part of document history pp configurable", "committedDate": "2020-04-09T00:50:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI0NTY3Mw==", "url": "https://github.com/nuxeo/nuxeo/pull/3902#discussion_r406245673", "bodyText": "This comment and the one above has the correct space after // on master.", "author": "efge", "createdAt": "2020-04-09T14:28:51Z", "path": "nuxeo-features/nuxeo-elasticsearch/nuxeo-elasticsearch-audit/src/test/java/org/nuxeo/elasticsearch/TestESHistoryProvider.java", "diffHunk": "@@ -429,6 +435,29 @@ public void testCustomDocumentHistoryPageProvider() {\n         assertEquals(5, entries.size());\n     }\n \n+    @Test\n+    public void testCustomFixedPartDocumentHistoryPageProvider() {\n+        assertNotNull(pageProviderService.getPageProviderDefinition(\"FIXED_PART_DOCUMENT_HISTORY_PROVIDER\"));\n+        DocumentModel searchDoc = session.createDocumentModel(\"BasicAuditSearch\");\n+        searchDoc.setPathInfo(\"/\", \"auditsearch\");\n+        searchDoc = session.createDocument(searchDoc);\n+\n+        searchDoc.setPropertyValue(\"basicauditsearch:eventIds\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:eventCategories\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:startDate\", null);\n+        searchDoc.setPropertyValue(\"basicauditsearch:endDate\", null);\n+\n+        //test with doc\n+        PageProvider<LogEntry> pageProvider = getPageProvider(\"FIXED_PART_DOCUMENT_HISTORY_PROVIDER\", 30, 0, doc);\n+        pageProvider.setSearchDocumentModel(searchDoc);\n+        assertEquals(1, pageProvider.getCurrentPage().size());\n+\n+        //test with proxy to check that the doc uuid is correctly set in the fixed part", "originalCommit": "2d1b26366593989acd892099661e2fb0f559c9ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUzNjI3NA==", "url": "https://github.com/nuxeo/nuxeo/pull/3902#discussion_r406536274", "bodyText": "Thanks for catching it.", "author": "michaelva", "createdAt": "2020-04-09T23:50:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI0NTY3Mw=="}], "type": "inlineReview"}, {"oid": "654298f5e408f187cdacd18d8631ee99b2a04cae", "url": "https://github.com/nuxeo/nuxeo/commit/654298f5e408f187cdacd18d8631ee99b2a04cae", "message": "NXP-28802: Formatting", "committedDate": "2020-04-09T23:48:54Z", "type": "commit"}]}