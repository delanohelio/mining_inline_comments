{"pr_number": 3392, "pr_title": "[#3380] Update dev image + code clean up", "pr_createdAt": "2020-01-15T06:24:08Z", "pr_url": "https://github.com/akvo/akvo-flow/pull/3392", "timeline": [{"oid": "419ab7e526d4f05ca00105af3c1f5da2701b17ca", "url": "https://github.com/akvo/akvo-flow/commit/419ab7e526d4f05ca00105af3c1f5da2701b17ca", "message": "[#3380] Update dev image + code clean up\n\n- Update to the latest akvo/akvo-flow-builder image that is based\n  on a published google/cloud-sdk\n- Remove references to ruby build process, e.g. RAKEP_MODE BUNDLE etc\n  We're now using `node` to bundle our client application\n- Use `npm ci` instead of `npm install` as part of the build\n  https://docs.npmjs.com/cli/ci.html\n- Cache `$HOME/.npm` to speed up builds", "committedDate": "2020-01-15T06:15:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njg3ODczMQ==", "url": "https://github.com/akvo/akvo-flow/pull/3392#discussion_r366878731", "bodyText": "For my information, what is stored here? I thought npm does not use a global path, but just messes around with the node_modules dir", "author": "dlebrero", "createdAt": "2020-01-15T13:38:46Z", "path": ".travis.yml", "diffHunk": "@@ -5,7 +5,8 @@ services:\n - docker\n cache:\n   directories:\n-    - $HOME/.m2\n+    - \"$HOME/.m2\"\n+    - \"$HOME/.npm\"", "originalCommit": "419ab7e526d4f05ca00105af3c1f5da2701b17ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkwMDMzNg==", "url": "https://github.com/akvo/akvo-flow/pull/3392#discussion_r366900336", "bodyText": "From the documentation page\n# keep the npm cache around to speed up installs\ncache:\n  directories:\n  - \"$HOME/.npm\"\n\nhttps://docs.npmjs.com/cli/ci.html\nIn a fresh container:\ncd $HOME/.npm/\n~/.npm # du -sh\n43.6M\t.\n\nThe actual content can be found here:\nhttps://gist.github.com/iperdomo/042af3dafe282012e3cb66230a51da2b\nnpm ci deletes the local node_modules if exists, before installing the versions used in package-lock.json", "author": "iperdomo", "createdAt": "2020-01-15T14:21:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njg3ODczMQ=="}], "type": "inlineReview"}]}