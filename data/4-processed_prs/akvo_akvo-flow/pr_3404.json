{"pr_number": 3404, "pr_title": "[#3168] - clean up and handle edge cases with creating new assignment", "pr_createdAt": "2020-01-28T12:11:39Z", "pr_url": "https://github.com/akvo/akvo-flow/pull/3404", "timeline": [{"oid": "c96c6aa657d50a8fa35f1cff7dba4abc01f37458", "url": "https://github.com/akvo/akvo-flow/commit/c96c6aa657d50a8fa35f1cff7dba4abc01f37458", "message": "[#3168] - change selected survey group when form component is mounted", "committedDate": "2020-01-22T12:59:35Z", "type": "commit"}, {"oid": "4e4899ff1e4d57e893bd0f9b44e78eb9c4191a30", "url": "https://github.com/akvo/akvo-flow/commit/4e4899ff1e4d57e893bd0f9b44e78eb9c4191a30", "message": "[#3168] - fix bug with removing forms from assignment", "committedDate": "2020-01-22T13:14:31Z", "type": "commit"}, {"oid": "988b084b40b6f86bc753391c9926bbc256338d78", "url": "https://github.com/akvo/akvo-flow/commit/988b084b40b6f86bc753391c9926bbc256338d78", "message": "[#3168] - rearrange methods in assignment", "committedDate": "2020-01-23T08:47:50Z", "type": "commit"}, {"oid": "aa64f368a55f9e9d5012ee5eeca4be5b23f51c83", "url": "https://github.com/akvo/akvo-flow/commit/aa64f368a55f9e9d5012ee5eeca4be5b23f51c83", "message": "Merge branch 'issue-3168/add-survey-edge-cases-on-datapoints' into issue-3168/refactor-assignment", "committedDate": "2020-01-27T11:39:40Z", "type": "commit"}, {"oid": "c22793971eab692125419b6dfdd9b3662fe977b2", "url": "https://github.com/akvo/akvo-flow/commit/c22793971eab692125419b6dfdd9b3662fe977b2", "message": "[#3169] - fix string ids in device selector", "committedDate": "2020-01-27T13:42:46Z", "type": "commit"}, {"oid": "2d1ad506fb868ca629a3bcdffb07b72c10c4b6b5", "url": "https://github.com/akvo/akvo-flow/commit/2d1ad506fb868ca629a3bcdffb07b72c10c4b6b5", "message": "[#3168] - update styling for sidebar", "committedDate": "2020-01-27T13:57:40Z", "type": "commit"}, {"oid": "62cdba3ea0acec7b7d1407719a8b2bbe997d64c5", "url": "https://github.com/akvo/akvo-flow/commit/62cdba3ea0acec7b7d1407719a8b2bbe997d64c5", "message": "[#3168] - update propType from strings to number", "committedDate": "2020-01-27T14:22:38Z", "type": "commit"}, {"oid": "b021df9a8281ae7d63883b8f5a13aaca4a9b3d1b", "url": "https://github.com/akvo/akvo-flow/commit/b021df9a8281ae7d63883b8f5a13aaca4a9b3d1b", "message": "Merge branch 'issue-3168/edit-datapoints' into issue-3168/refactor-assignment", "committedDate": "2020-01-27T15:22:18Z", "type": "commit"}, {"oid": "a73f5907ed592e9a6c9f3efb297970588789b9ff", "url": "https://github.com/akvo/akvo-flow/commit/a73f5907ed592e9a6c9f3efb297970588789b9ff", "message": "[#3168] - fix bug with saving assignments", "committedDate": "2020-01-27T15:41:15Z", "type": "commit"}, {"oid": "63d1fd1edd9231f76e6e6a391a715b1cb9350873", "url": "https://github.com/akvo/akvo-flow/commit/63d1fd1edd9231f76e6e6a391a715b1cb9350873", "message": "[#3168] - fix all bugs and edge cases with creating assignments", "committedDate": "2020-01-28T12:06:49Z", "type": "commit"}, {"oid": "a0713bd97c2e16b78c63e393b0d7e1e1871f780b", "url": "https://github.com/akvo/akvo-flow/commit/a0713bd97c2e16b78c63e393b0d7e1e1871f780b", "message": "Merge branch 'develop' into issue-3168/refactor-assignment", "committedDate": "2020-02-05T11:41:34Z", "type": "commit"}, {"oid": "431adb4d7b1ea2cf9c12e8b538a1e172f23968bf", "url": "https://github.com/akvo/akvo-flow/commit/431adb4d7b1ea2cf9c12e8b538a1e172f23968bf", "message": "[#3168] - load all forms on initial render", "committedDate": "2020-02-05T13:24:25Z", "type": "commit"}, {"oid": "b26c2b5df5af2d9d65731fa82b9a2fd3d6389e4c", "url": "https://github.com/akvo/akvo-flow/commit/b26c2b5df5af2d9d65731fa82b9a2fd3d6389e4c", "message": "[#3168] - fix save datapoint method when navigating back on assignment", "committedDate": "2020-02-05T13:29:23Z", "type": "commit"}, {"oid": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0", "url": "https://github.com/akvo/akvo-flow/commit/a3ed4cf22f9abd2e5816853a00021a95fa7563a0", "message": "[#3168] - revert package-lock.json", "committedDate": "2020-02-05T13:42:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgyNTYwMg==", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r375825602", "bodyText": "Do you still need this comment if you have changed the PropType definitions?", "author": "muloem", "createdAt": "2020-02-06T13:14:24Z", "path": "Dashboard/app/js/lib/components/devices/AssignmentsEditView/screens/EditDevices.jsx", "diffHunk": "@@ -22,6 +22,9 @@ export default class EditDevices extends React.Component {\n   }\n \n   onSelectDevice = (id, checked) => {\n+    // convert id to number", "originalCommit": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgyNTcwMg==", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r375825702", "bodyText": "Still needed?", "author": "muloem", "createdAt": "2020-02-06T13:14:36Z", "path": "Dashboard/app/js/lib/components/devices/AssignmentsEditView/screens/AddDevices.jsx", "diffHunk": "@@ -22,6 +22,9 @@ export default class AddDevice extends React.Component {\n   }\n \n   onSelectDevice = (id, checked) => {\n+    // convert id to number", "originalCommit": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgyNzQzMw==", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r375827433", "bodyText": "Do we need to parse?", "author": "muloem", "createdAt": "2020-02-06T13:18:30Z", "path": "Dashboard/app/js/lib/components/selectors/DeviceSelector/DeviceAccordion.jsx", "diffHunk": "@@ -57,21 +55,15 @@ export default class DeviceAccordion extends React.Component {\n   };\n \n   render() {\n-    const {\n-      name,\n-      devices,\n-      handleSelectDevice,\n-      selectedDevices,\n-      id,\n-    } = this.props;\n+    const { name, devices, handleSelectDevice, selectedDevices, id } = this.props;\n     const { accordionClass, fontClass, panelStyle } = this.getStyleProps();\n \n     return (\n       <div className=\"accordion-container\">\n         <div className={accordionClass}>\n           <Checkbox\n-            id={id}\n-            name={id}\n+            id={parseInt(id, 10)}", "originalCommit": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA0MDA0NA==", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r376040044", "bodyText": "Yes, Object keys are converted to strings. So it has to be parsed back to number here", "author": "marvinkome", "createdAt": "2020-02-06T19:36:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgyNzQzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgzNTk0NA==", "url": "https://github.com/akvo/akvo-flow/pull/3404#discussion_r375835944", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  const formIds = this.selectedSurveys;\n          \n          \n            \n                  const formIds = this.selectedFormIds;", "author": "muloem", "createdAt": "2020-02-06T13:36:03Z", "path": "Dashboard/app/js/lib/views/devices/assignment-edit-views.jsx", "diffHunk": "@@ -159,14 +173,21 @@ FLOW.AssignmentEditView = FLOW.ReactComponentView.extend(\n       FLOW.router.transitionTo('navDevices.assignSurveysOverview');\n     },\n \n+    detectChangeTab() {\n+      if (Ember.none(FLOW.selectedControl.selectedSurveyAssignment.get('keyId'))) {\n+        FLOW.selectedControl.get('selectedSurveyAssignment').deleteRecord();\n+      }\n+      FLOW.selectedControl.set('selectedSurveyAssignment', null);\n+    },\n+\n     // saving functionality\n     saveSurveyAssignment(data) {\n       let endDateParse;\n       let startDateParse;\n \n       // set devices and surveys\n       const deviceIds = this.selectedDevices;\n-      const formIds = this.selectedSurveys.map(item => item.get('keyId'));\n+      const formIds = this.selectedSurveys;", "originalCommit": "a3ed4cf22f9abd2e5816853a00021a95fa7563a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "32b4478b9981d5084cadaf190de4d63c1fadd525", "url": "https://github.com/akvo/akvo-flow/commit/32b4478b9981d5084cadaf190de4d63c1fadd525", "message": "[#3168] - remove useless comments, converts strings to number and make variable names more contextual", "committedDate": "2020-02-07T08:00:38Z", "type": "commit"}]}