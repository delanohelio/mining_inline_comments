{"pr_number": 2746, "pr_title": "ENT-1882: Port PoolResource to spec-first", "pr_createdAt": "2020-07-06T12:59:01Z", "pr_url": "https://github.com/candlepin/candlepin/pull/2746", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY1MzU5MQ==", "url": "https://github.com/candlepin/candlepin/pull/2746#discussion_r450653591", "bodyText": "Missing API response (HTTP 404) when \"Pool ID or cert not found\".", "author": "wolfdale", "createdAt": "2020-07-07T07:08:11Z", "path": "api/candlepin-api-spec.yaml", "diffHunk": "@@ -2849,6 +2849,305 @@ paths:\n         default:\n           $ref: '#/components/responses/default'\n \n+  /pools:\n+    get:\n+      description: Retrieves a list of pools @deprecated Use the method on /owners. This endpoint supports paging with query parameters. For more details please visit https://www.candlepinproject.org/docs/candlepin/pagination.html#paginating-results-from-candlepin.\n+      tags:\n+        - Pools\n+      operationId: list\n+      parameters:\n+        - in: query\n+          name: owner\n+          description: Owner ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: consumer\n+          description: Consumer UUID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: product\n+          description: Product ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: listall\n+          description: Use with consumerUuid to list all pools available to the consumer. This will include pools which would otherwise be omitted due to a rules warning. (i.e. not recommended) Pools that trigger an error however will still be omitted. (no entitlements available, consumer type mismatch, etc)\n+          required: true\n+          schema:\n+            type: boolean\n+            default: false\n+        - in: query\n+          name: activeon\n+          description: Uses ISO 8601 format\n+          required: true\n+          schema:\n+            type: string\n+      security: []\n+      responses:\n+        200:\n+          description: A list of pools\n+          content:\n+            application/json:\n+              schema:\n+                type: array\n+                items:\n+                  $ref: '#/components/schemas/PoolDTO'\n+        400:\n+          description: Both consumer(unit) and owner are given, or a product id is specified without a consumer(unit) or owner\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Both consumer(unit) and owner are given, or a product id is specified without a consumer(unit) or owner\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        403:\n+          description: Users cannot access either of the consumer, owner, or pools\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Users cannot access either of the consumer, owner, or pools\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        404:\n+          description: Specified consumer(unit) or owner is not found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Specified consumer(unit) or owner is not found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+  /pools/{pool_id}:\n+    get:\n+      description: Retrieves a single pool\n+      tags:\n+        - Pools\n+      operationId: getPool\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: consumer\n+          description: Consumer UUID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: activeon\n+          description: Uses ISO 8601 format\n+          required: true\n+          schema:\n+            type: string\n+      responses:\n+        200:\n+          description: Retrives a single pool by its ID\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/PoolDTO'\n+        403:\n+          description: Users cannot access consumer(unit)\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Users cannot access consumer(unit)\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        404:\n+          description: Subscription pool or consumer(unit) not found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Subscription pool or consumer(unit) not found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+    delete:\n+      description: Removes a pool\n+      tags:\n+        - Pools\n+      operationId: deletePool\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+      responses:\n+        200:\n+          description: Retrives a single pool by its ID\n+        400:\n+          description: Cannot delete bonus pools, as they are auto generated\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Cannot delete bonus pools, as they are auto generated\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        404:\n+          description: Subscription pool not found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Subscription pool not found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+  /pools/{pool_id}/cdn:\n+    get:\n+      description: Retrieve a CDN for a Pool\n+      tags:\n+        - Pools\n+        - CDN\n+      operationId: getPoolCdn\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+      responses:\n+        200:\n+          description: CDN details for a Pool\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/CdnDTO'\n+        404:\n+          description: Subscription pool with given ID could not be found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Subscription pool with given ID could not be found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+  /pools/{pool_id}/entitlements:\n+    get:\n+      description: Retrieve a list of entitlements for a pool\n+      tags:\n+        - Pools\n+      operationId: getPoolEntitlements\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+      x-java-response:\n+        type: Iterable\n+        isContainer: true\n+        security: []\n+      responses:\n+        200:\n+          description: A list of entitlements\n+          content:\n+            application/json:\n+              schema:\n+                type: array\n+                items:\n+                  $ref: '#/components/schemas/EntitlementDTO'\n+        404:\n+          description: Subscription pool with given ID could not be found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Subscription pool with given ID could not be found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+  /pools/{pool_id}/entitlements/consumer_uuids:\n+    get:\n+      description: Retrieve a list of Consumer UUIDs attached to a pool. Available only to superadmins\n+      tags:\n+        - Pools\n+      operationId: listEntitledConsumerUuids\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+      responses:\n+        200:\n+          description: A list of consumer UUIDs\n+          content:\n+            application/json:\n+              schema:\n+                type: array\n+                items:\n+                  type: string\n+        404:\n+          description: Subscription pool with given ID could not be found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Subscription pool with given ID could not be found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+  /pools/{pool_id}/cert:\n+    get:\n+      description: Retrieves a Subscription Certificate\n+      tags:\n+        - Pools\n+        - Certificates\n+      operationId: getSubCert\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+      responses:", "originalCommit": "f9debf1b71be39400e01d1f73d68caccb9f8c45f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc3MDEzNw==", "url": "https://github.com/candlepin/candlepin/pull/2746#discussion_r450770137", "bodyText": "Added.", "author": "sonalidhome", "createdAt": "2020-07-07T10:38:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY1MzU5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY1MzYyNg==", "url": "https://github.com/candlepin/candlepin/pull/2746#discussion_r450653626", "bodyText": "Incorrect description for delete API.", "author": "wolfdale", "createdAt": "2020-07-07T07:08:18Z", "path": "api/candlepin-api-spec.yaml", "diffHunk": "@@ -2849,6 +2849,305 @@ paths:\n         default:\n           $ref: '#/components/responses/default'\n \n+  /pools:\n+    get:\n+      description: Retrieves a list of pools @deprecated Use the method on /owners. This endpoint supports paging with query parameters. For more details please visit https://www.candlepinproject.org/docs/candlepin/pagination.html#paginating-results-from-candlepin.\n+      tags:\n+        - Pools\n+      operationId: list\n+      parameters:\n+        - in: query\n+          name: owner\n+          description: Owner ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: consumer\n+          description: Consumer UUID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: product\n+          description: Product ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: listall\n+          description: Use with consumerUuid to list all pools available to the consumer. This will include pools which would otherwise be omitted due to a rules warning. (i.e. not recommended) Pools that trigger an error however will still be omitted. (no entitlements available, consumer type mismatch, etc)\n+          required: true\n+          schema:\n+            type: boolean\n+            default: false\n+        - in: query\n+          name: activeon\n+          description: Uses ISO 8601 format\n+          required: true\n+          schema:\n+            type: string\n+      security: []\n+      responses:\n+        200:\n+          description: A list of pools\n+          content:\n+            application/json:\n+              schema:\n+                type: array\n+                items:\n+                  $ref: '#/components/schemas/PoolDTO'\n+        400:\n+          description: Both consumer(unit) and owner are given, or a product id is specified without a consumer(unit) or owner\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Both consumer(unit) and owner are given, or a product id is specified without a consumer(unit) or owner\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        403:\n+          description: Users cannot access either of the consumer, owner, or pools\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Users cannot access either of the consumer, owner, or pools\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        404:\n+          description: Specified consumer(unit) or owner is not found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Specified consumer(unit) or owner is not found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+  /pools/{pool_id}:\n+    get:\n+      description: Retrieves a single pool\n+      tags:\n+        - Pools\n+      operationId: getPool\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: consumer\n+          description: Consumer UUID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: activeon\n+          description: Uses ISO 8601 format\n+          required: true\n+          schema:\n+            type: string\n+      responses:\n+        200:\n+          description: Retrives a single pool by its ID\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/PoolDTO'\n+        403:\n+          description: Users cannot access consumer(unit)\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Users cannot access consumer(unit)\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        404:\n+          description: Subscription pool or consumer(unit) not found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Subscription pool or consumer(unit) not found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+    delete:\n+      description: Removes a pool\n+      tags:\n+        - Pools\n+      operationId: deletePool\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+      responses:\n+        200:\n+          description: Retrives a single pool by its ID", "originalCommit": "f9debf1b71be39400e01d1f73d68caccb9f8c45f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc2OTkzNQ==", "url": "https://github.com/candlepin/candlepin/pull/2746#discussion_r450769935", "bodyText": "Corrected.", "author": "sonalidhome", "createdAt": "2020-07-07T10:37:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY1MzYyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4NDM3NA==", "url": "https://github.com/candlepin/candlepin/pull/2746#discussion_r450684374", "bodyText": "Wrong description and response code should be 204.", "author": "Januson", "createdAt": "2020-07-07T08:09:03Z", "path": "api/candlepin-api-spec.yaml", "diffHunk": "@@ -2849,6 +2849,305 @@ paths:\n         default:\n           $ref: '#/components/responses/default'\n \n+  /pools:\n+    get:\n+      description: Retrieves a list of pools @deprecated Use the method on /owners. This endpoint supports paging with query parameters. For more details please visit https://www.candlepinproject.org/docs/candlepin/pagination.html#paginating-results-from-candlepin.\n+      tags:\n+        - Pools\n+      operationId: list\n+      parameters:\n+        - in: query\n+          name: owner\n+          description: Owner ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: consumer\n+          description: Consumer UUID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: product\n+          description: Product ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: listall\n+          description: Use with consumerUuid to list all pools available to the consumer. This will include pools which would otherwise be omitted due to a rules warning. (i.e. not recommended) Pools that trigger an error however will still be omitted. (no entitlements available, consumer type mismatch, etc)\n+          required: true\n+          schema:\n+            type: boolean\n+            default: false\n+        - in: query\n+          name: activeon\n+          description: Uses ISO 8601 format\n+          required: true\n+          schema:\n+            type: string\n+      security: []\n+      responses:\n+        200:\n+          description: A list of pools\n+          content:\n+            application/json:\n+              schema:\n+                type: array\n+                items:\n+                  $ref: '#/components/schemas/PoolDTO'\n+        400:\n+          description: Both consumer(unit) and owner are given, or a product id is specified without a consumer(unit) or owner\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Both consumer(unit) and owner are given, or a product id is specified without a consumer(unit) or owner\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        403:\n+          description: Users cannot access either of the consumer, owner, or pools\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Users cannot access either of the consumer, owner, or pools\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        404:\n+          description: Specified consumer(unit) or owner is not found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Specified consumer(unit) or owner is not found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+  /pools/{pool_id}:\n+    get:\n+      description: Retrieves a single pool\n+      tags:\n+        - Pools\n+      operationId: getPool\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: consumer\n+          description: Consumer UUID\n+          required: true\n+          schema:\n+            type: string\n+        - in: query\n+          name: activeon\n+          description: Uses ISO 8601 format\n+          required: true\n+          schema:\n+            type: string\n+      responses:\n+        200:\n+          description: Retrives a single pool by its ID\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/PoolDTO'\n+        403:\n+          description: Users cannot access consumer(unit)\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Users cannot access consumer(unit)\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        404:\n+          description: Subscription pool or consumer(unit) not found\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ExceptionMessage'\n+              example:\n+                displayMessage: Subscription pool or consumer(unit) not found\n+                requestUuid: c4347004-8792-41fe-a4d8-fccaa0d3898a\n+        default:\n+          $ref: '#/components/responses/default'\n+\n+    delete:\n+      description: Removes a pool\n+      tags:\n+        - Pools\n+      operationId: deletePool\n+      parameters:\n+        - in: path\n+          name: pool_id\n+          description: Pool ID\n+          required: true\n+          schema:\n+            type: string\n+      responses:\n+        200:\n+          description: Retrives a single pool by its ID", "originalCommit": "f9debf1b71be39400e01d1f73d68caccb9f8c45f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc3MDAzNg==", "url": "https://github.com/candlepin/candlepin/pull/2746#discussion_r450770036", "bodyText": "Corrected.", "author": "sonalidhome", "createdAt": "2020-07-07T10:37:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY4NDM3NA=="}], "type": "inlineReview"}, {"oid": "13ae67a1c92c696104aa97026bc96ca6eabef270", "url": "https://github.com/candlepin/candlepin/commit/13ae67a1c92c696104aa97026bc96ca6eabef270", "message": "ENT-1882: Port PoolResource to spec-first\n - Added Pool reseaource specification\n - Upated related files", "committedDate": "2020-07-07T10:36:32Z", "type": "forcePushed"}, {"oid": "7e5eb40e4a8a5e38089d15817b06d4d5e9a97c92", "url": "https://github.com/candlepin/candlepin/commit/7e5eb40e4a8a5e38089d15817b06d4d5e9a97c92", "message": "ENT-1882: Port PoolResource to spec-first\n - Added Pool reseaource specification\n - Upated related files", "committedDate": "2020-07-08T06:10:49Z", "type": "commit"}, {"oid": "7e5eb40e4a8a5e38089d15817b06d4d5e9a97c92", "url": "https://github.com/candlepin/candlepin/commit/7e5eb40e4a8a5e38089d15817b06d4d5e9a97c92", "message": "ENT-1882: Port PoolResource to spec-first\n - Added Pool reseaource specification\n - Upated related files", "committedDate": "2020-07-08T06:10:49Z", "type": "forcePushed"}]}