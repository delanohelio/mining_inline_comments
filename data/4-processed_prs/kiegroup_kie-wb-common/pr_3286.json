{"pr_number": 3286, "pr_title": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "pr_createdAt": "2020-04-26T21:07:28Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3286", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTAwMg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r416935002", "bodyText": "Not sure yet if makes sense adding this setLocalTimeZone method, at least for the view class. I understand the presenter should be responsible for obtaining the \"local\" timezone, and then just passing the raw value (maybe an string) to the view.\nSo maybe only adding the new setValue method above on the view class is godo enough to achieve same behavior, but making the presenter obtain the \"local\" value and passing the value to it.\nPS: Also, what means \"local\", from the browser? Also results weird for me having a setter method (setLocalTimeZone) with no arguments... maybe it results clear, if this method still applies, to rename it to something like useLocalTimeZone?", "author": "romartin", "createdAt": "2020-04-28T21:29:26Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-sets/kie-wb-common-stunner-bpmn/kie-wb-common-stunner-bpmn-client/src/main/java/org/kie/workbench/common/stunner/bpmn/client/forms/widgets/TimeZonePickerView.java", "diffHunk": "@@ -27,6 +27,10 @@\n \n     String getValue();\n \n+    void setValue(String value);\n+\n+    void setLocalTimeZone();", "originalCommit": "9ccf1cff71894878c14153443ef33d6ae6d67bd4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzM5OTYwNQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r417399605", "bodyText": "@romartin Good catch! I moved the logic above to the view and it is now encapsulated in the setValue() method. I also removed the setLocalTimeZone method once it is not needed anymore. It looks better now.", "author": "handreyrc", "createdAt": "2020-04-29T15:20:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTAwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTA2NQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r416935065", "bodyText": "why this?", "author": "romartin", "createdAt": "2020-04-28T21:29:33Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-sets/kie-wb-common-stunner-bpmn/kie-wb-common-stunner-bpmn-client/src/main/java/org/kie/workbench/common/stunner/bpmn/client/forms/widgets/TimeZonePicker.java", "diffHunk": "@@ -77,6 +77,13 @@ public void setValue(String value) {\n     public void setValue(String value, boolean fireEvents) {\n         String oldValue = current;\n         current = value;\n+\n+        if (current.equals(\"0\")) {", "originalCommit": "9ccf1cff71894878c14153443ef33d6ae6d67bd4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQxMDEyNQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r417410125", "bodyText": "@romartin The timezone is set in a modal that is reused for adding new notifications or editing them as well, also it is not being created and destroyed as you add/edit an item, it is being hidden from the user and the values reset to default values defined in the code.\nIn order to know if I should set the userTimezone(New Item) or set a value from an existing item in the list (Edit) I'm testing the value \"0\" that is already being set for new items.\nWDYT?", "author": "handreyrc", "createdAt": "2020-04-29T15:33:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTA2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTQ0NDEyMw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r419444123", "bodyText": "ok, in some way it's necessary to have some flag to check ,so that's fine comparing the value to 0 for me. But it results a bit hard to follow on the first look, maybe just replacing the String \"0\" to some static final String field in the class, which name gives some clue about why this \"0\" is used for, eg: VALUE_EMPTY = \"0\". WDYT? Well just trying to make this more readable, maybe adding a comment in that line should work too.", "author": "romartin", "createdAt": "2020-05-04T13:40:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTA2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY2MjAyNw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r419662027", "bodyText": "@romartin I agree, I've created a static field to make it easier to follow.  Thanks.", "author": "handreyrc", "createdAt": "2020-05-04T19:06:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTA2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc3MTc0OQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r421771749", "bodyText": "I just understood the condition now at the first read, great!! thanks a lot for this small things, I think those become important at the long term, easier to maintan... \ud83d\udc4d", "author": "romartin", "createdAt": "2020-05-07T20:24:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTA2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTk0Nw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r416935947", "bodyText": "if you changed from private to protected, just for making this field visible to the unit tests, maybe it's better to just make it package protected (no access modifier), which results more restrictive.", "author": "romartin", "createdAt": "2020-04-28T21:31:09Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-sets/kie-wb-common-stunner-bpmn/kie-wb-common-stunner-bpmn-client/src/main/java/org/kie/workbench/common/stunner/bpmn/client/forms/widgets/TimeZonePickerViewImpl.java", "diffHunk": "@@ -43,8 +43,10 @@\n \n     private final double defaultOffset = new Date().getTimezoneOffset() * -1;\n \n+    private String localTimeZone;\n+\n     @DataField\n-    private Select tzSelect = new Select();\n+    protected Select tzSelect = new Select();", "originalCommit": "9ccf1cff71894878c14153443ef33d6ae6d67bd4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQxMTM2OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r417411368", "bodyText": "@romartin Fixed!", "author": "handreyrc", "createdAt": "2020-04-29T15:35:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNTk0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNjgwMg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r416936802", "bodyText": "Not really sure if this is necessary, as far as I remember I think once declaring some Runner class above (on the class declaration) it already implies initializing the mocks from the class itself.", "author": "romartin", "createdAt": "2020-04-28T21:32:42Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-sets/kie-wb-common-stunner-bpmn/kie-wb-common-stunner-bpmn-client/src/test/java/org/kie/workbench/common/stunner/bpmn/client/forms/widgets/TimeZonePickerTest.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.workbench.common.stunner.bpmn.client.forms.widgets;\n+\n+import com.ait.lienzo.test.LienzoMockitoTestRunner;\n+import com.google.gwt.core.client.GWT;\n+import com.google.gwtmockito.GwtMockito;\n+import org.gwtbootstrap3.extras.select.client.ui.Select;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+\n+import static org.mockito.Matchers.anyBoolean;\n+import static org.mockito.Matchers.anyString;\n+import static org.mockito.Mockito.doCallRealMethod;\n+import static org.mockito.Mockito.spy;\n+import static org.mockito.Mockito.times;\n+import static org.mockito.Mockito.verify;\n+\n+@RunWith(LienzoMockitoTestRunner.class)\n+public class TimeZonePickerTest {\n+\n+    @Mock\n+    private Select tzSelect;\n+\n+    private TimeZonePickerViewImpl view;\n+\n+    private TimeZonePicker tested;\n+\n+    @Before\n+    public void setUp() {\n+        GwtMockito.initMocks(this);", "originalCommit": "9ccf1cff71894878c14153443ef33d6ae6d67bd4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQxMjk0MA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3286#discussion_r417412940", "bodyText": "@romartin you are right It is not necessary, I removed it.", "author": "handreyrc", "createdAt": "2020-04-29T15:37:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkzNjgwMg=="}], "type": "inlineReview"}, {"oid": "887de2a63a5ceefcc4c23876193cf9c2791a6388", "url": "https://github.com/kiegroup/kie-wb-common/commit/887de2a63a5ceefcc4c23876193cf9c2791a6388", "message": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "committedDate": "2020-04-29T15:09:10Z", "type": "forcePushed"}, {"oid": "923e6881743104cef2ee631e6cf382960f3c7033", "url": "https://github.com/kiegroup/kie-wb-common/commit/923e6881743104cef2ee631e6cf382960f3c7033", "message": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "committedDate": "2020-05-04T18:59:43Z", "type": "forcePushed"}, {"oid": "3c96f5a4bbf4e1c4944e9057ee5f2230738ded77", "url": "https://github.com/kiegroup/kie-wb-common/commit/3c96f5a4bbf4e1c4944e9057ee5f2230738ded77", "message": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "committedDate": "2020-05-05T16:07:58Z", "type": "forcePushed"}, {"oid": "ac396b740b671aabf90e3525d6a9ffd0c1feac66", "url": "https://github.com/kiegroup/kie-wb-common/commit/ac396b740b671aabf90e3525d6a9ffd0c1feac66", "message": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "committedDate": "2020-05-14T14:07:43Z", "type": "forcePushed"}, {"oid": "5593e38a5d838b6edad62c04b854ec87008d5c87", "url": "https://github.com/kiegroup/kie-wb-common/commit/5593e38a5d838b6edad62c04b854ec87008d5c87", "message": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "committedDate": "2020-05-15T23:11:08Z", "type": "forcePushed"}, {"oid": "1d63467ac160f7912b8c28be14ec01d7f231c58b", "url": "https://github.com/kiegroup/kie-wb-common/commit/1d63467ac160f7912b8c28be14ec01d7f231c58b", "message": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "committedDate": "2020-05-29T16:53:59Z", "type": "forcePushed"}, {"oid": "fdea07e24417df2f7aefc212d8c8615d51070e7b", "url": "https://github.com/kiegroup/kie-wb-common/commit/fdea07e24417df2f7aefc212d8c8615d51070e7b", "message": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "committedDate": "2020-06-01T14:46:53Z", "type": "commit"}, {"oid": "fdea07e24417df2f7aefc212d8c8615d51070e7b", "url": "https://github.com/kiegroup/kie-wb-common/commit/fdea07e24417df2f7aefc212d8c8615d51070e7b", "message": "RHPAM-2696: Notification UI produces syntactically incorrect iso expressions:", "committedDate": "2020-06-01T14:46:53Z", "type": "forcePushed"}]}