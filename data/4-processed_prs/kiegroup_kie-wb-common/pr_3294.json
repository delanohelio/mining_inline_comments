{"pr_number": 3294, "pr_title": "JBPM-9142 remove jbpm-simulation dependency", "pr_createdAt": "2020-05-06T11:38:14Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3294", "timeline": [{"oid": "176233b3732488fdc897dedceb4dc81d3fd27d03", "url": "https://github.com/kiegroup/kie-wb-common/commit/176233b3732488fdc897dedceb4dc81d3fd27d03", "message": "JBPM-9142 remove unused jbpm-simulation dependency", "committedDate": "2020-05-06T08:54:50Z", "type": "commit"}, {"oid": "aee8d53ade141391ab858934ef1fb4328fb7f3a2", "url": "https://github.com/kiegroup/kie-wb-common/commit/aee8d53ade141391ab858934ef1fb4328fb7f3a2", "message": "Replace in tests old marshaller by new one", "committedDate": "2020-05-06T10:23:13Z", "type": "commit"}, {"oid": "0e0f846d2fc8eca95b09a00c2fec85db166d013a", "url": "https://github.com/kiegroup/kie-wb-common/commit/0e0f846d2fc8eca95b09a00c2fec85db166d013a", "message": "Remove test which doesn't test Stunner/BPMN or CM Designers", "committedDate": "2020-05-06T11:04:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTE1MDEyMQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3294#discussion_r421150121", "bodyText": "Hey @hasys , sorry this dependency is not correct, The forms modules are considered an \"extension\" in Stunner, so they're decoupled from any specific domain (BPMN, DMN, etc).\nBoth dependencies to kie-wb-common-stunner-bpmn-api and kie-wb-common-stunner-bpmn-backend are not correct, even being only for test scope. Can you get rid of them?", "author": "romartin", "createdAt": "2020-05-06T23:27:50Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-extensions/kie-wb-common-stunner-forms/kie-wb-common-stunner-forms-backend/pom.xml", "diffHunk": "@@ -230,11 +230,38 @@\n     </dependency>\n \n     <dependency>\n-      <groupId>org.drools</groupId>\n-      <artifactId>jbpm-simulation</artifactId>\n+      <groupId>org.kie.workbench.stunner</groupId>\n+      <artifactId>kie-wb-common-stunner-core-common</artifactId>\n+      <scope>test</scope>\n+      <type>test-jar</type>\n+    </dependency>\n+\n+    <dependency>\n+      <groupId>org.kie.workbench.stunner</groupId>\n+      <artifactId>kie-wb-common-stunner-backend-common</artifactId>\n+      <scope>test</scope>\n+      <type>test-jar</type>\n+    </dependency>\n+\n+    <dependency>\n+      <groupId>org.kie.workbench.stunner</groupId>\n+      <artifactId>kie-wb-common-stunner-bpmn-api</artifactId>", "originalCommit": "0e0f846d2fc8eca95b09a00c2fec85db166d013a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTE2OTkwMg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3294#discussion_r421169902", "bodyText": "Hi @romartin,\nyes, make sense. But test in this package testing form generation for BPMN file. So we need marshaller to test it. Before it was old marshaller through jbpm-simulation, now when we removed jbmp-simulation dependency we still need some bpmn marshaller to test it. And I think use our current marshaller is better than legacy one. It will be good to do even regardless this jbpm-simulation removal.\nSo, I see your idea, but I afraid in this case forms code/tests should be refactored in general, and I believe it is out of scope for this PR.", "author": "hasys", "createdAt": "2020-05-07T00:31:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTE1MDEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2MDM5OQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3294#discussion_r421760399", "bodyText": "yeah good point, so it means it was already wrong by having the dependency to jbpm-simulation.\nAnyway, it was wrong before and we've to fix it... so please DO NOT add dependencies to domains on the forms (extension) modules, otherwise we'll get into troubles soon. Can you please just try to refactor, or at east move the test/s  (tests which require the bpmn dependencies) to some of the bpmn modules, and so then be able to remove these bpmn dependencies from this module as well?\nThanks!", "author": "romartin", "createdAt": "2020-05-07T20:01:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTE1MDEyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzcyNTYyNA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3294#discussion_r423725624", "bodyText": "It is probably not the best idea letting empty catch blocks, or is it?", "author": "LuboTerifaj", "createdAt": "2020-05-12T13:19:19Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-extensions/kie-wb-common-stunner-forms/kie-wb-common-stunner-forms-backend/src/test/java/org/kie/workbench/common/stunner/forms/backend/service/impl/FormDefinitionGeneratorImplTest.java", "diffHunk": "@@ -205,6 +208,22 @@ public void init() throws Exception {\n         when(diagramPath.toURI()).thenReturn(\"default:///src/main/resources\" + PROCESS_PATH);\n     }\n \n+    private void loadClass() {\n+        try {\n+            when(moduleClassLoader.loadClass(anyString())).thenAnswer(invocation -> Object.class);\n+        } catch (ClassNotFoundException e) {\n+            // Do nothing.", "originalCommit": "0e0f846d2fc8eca95b09a00c2fec85db166d013a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzczMzM2Ng==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3294#discussion_r423733366", "bodyText": "I can't imagine that Object class won't be found. But if won't we will get failing test, runtime not affected. I think it is pretty save to have it like this. Do you have better ideas?", "author": "hasys", "createdAt": "2020-05-12T13:29:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzcyNTYyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE2NDIzNQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3294#discussion_r425164235", "bodyText": "Hi @LuboTerifaj, is it OK to you? Or you know how to do it better?", "author": "hasys", "createdAt": "2020-05-14T14:06:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzcyNTYyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg3MTg0OQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3294#discussion_r429871849", "bodyText": "I see. I would let it be as it is now. Thanks!", "author": "LuboTerifaj", "createdAt": "2020-05-25T10:55:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzcyNTYyNA=="}], "type": "inlineReview"}]}