{"pr_number": 3168, "pr_title": "DROOLS-5080: [DMN Designer] Automatically create InputClause supporting Decisions", "pr_createdAt": "2020-02-19T12:30:14Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3168", "timeline": [{"oid": "8f50c865b72ef210fb11879a63caf4c400f1323d", "url": "https://github.com/kiegroup/kie-wb-common/commit/8f50c865b72ef210fb11879a63caf4c400f1323d", "message": "DROOLS-5080: [DMN Designer] Automatically create InputClause supporting Decisions", "committedDate": "2020-02-19T12:24:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk3ODIzNQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3168#discussion_r381978235", "bodyText": "Maybe I will shooot to my own leg, but in this case I have feeling having source and target as parameters of method would make the code more readable. WDYT?", "author": "jomarko", "createdAt": "2020-02-20T12:50:08Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/test/java/org/kie/workbench/common/dmn/client/editors/expressions/types/dtable/DecisionTableEditorDefinitionEnricherTest.java", "diffHunk": "@@ -81,19 +87,46 @@\n \n     private InputData inputData2;\n \n+    private Decision decision1;\n+\n     @Before\n     public void setup() {\n         super.setup();\n \n         this.diagram = new DMNDiagram();\n         this.inputData1 = new InputData();\n         this.inputData2 = new InputData();\n+        this.decision1 = new Decision();\n+    }\n+\n+    @Test\n+    @SuppressWarnings(\"unchecked\")\n+    public void testModelEnrichmentWhenTopLevelDecisionTableWithDecision() {\n+        setupGraphWithDiagram();\n+        setupGraphWithDecision();", "originalCommit": "8f50c865b72ef210fb11879a63caf4c400f1323d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjIxMzUwMA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3168#discussion_r382213500", "bodyText": "Well... these methods replace the single setupGraph() method that used to exist (that set everything up for the tests). Now however, to be able to test just InputData or just Decision or both InputData and Decision I moved the separate setup codes to different methods and call the correct ones for each test.. I could refactor to take parameters but I'd simply be moving some code from inside the current setupXXX methods to outside it and then passing the result as a parameter. IMO it makes the setup less encapsulated.", "author": "manstis", "createdAt": "2020-02-20T19:34:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk3ODIzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk3OTkzNg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3168#discussion_r381979936", "bodyText": "While here the parameters are not intuitive.", "author": "jomarko", "createdAt": "2020-02-20T12:53:50Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/test/java/org/kie/workbench/common/dmn/client/editors/expressions/types/dtable/DecisionTableEditorDefinitionEnricherTest.java", "diffHunk": "@@ -81,19 +87,46 @@\n \n     private InputData inputData2;\n \n+    private Decision decision1;\n+\n     @Before\n     public void setup() {\n         super.setup();\n \n         this.diagram = new DMNDiagram();\n         this.inputData1 = new InputData();\n         this.inputData2 = new InputData();\n+        this.decision1 = new Decision();\n+    }\n+\n+    @Test\n+    @SuppressWarnings(\"unchecked\")\n+    public void testModelEnrichmentWhenTopLevelDecisionTableWithDecision() {\n+        setupGraphWithDiagram();\n+        setupGraphWithDecision();\n+\n+        final Optional<DecisionTable> oModel = definition.getModelClass();\n+        definition.enrich(Optional.of(NODE_UUID), decision, oModel);\n+\n+        final DecisionTable model = oModel.get();\n+        assertBasicEnrichment(model);\n+\n+        final List<InputClause> input = model.getInput();\n+        assertThat(input.size()).isEqualTo(1);\n+        assertThat(input.get(0).getInputExpression()).isInstanceOf(InputClauseLiteralExpression.class);\n+        assertThat(input.get(0).getInputExpression().getText().getValue()).isEqualTo(DECISION_NAME_1);\n+        assertThat(input.get(0).getInputExpression().getTypeRef()).isEqualTo(DECISION_QNAME_1);\n+\n+        assertStandardOutputClauseEnrichment(model);\n+        assertStandardDecisionRuleEnrichment(model, 1, 1);\n+        assertParentHierarchyEnrichment(model, 1, 1);", "originalCommit": "8f50c865b72ef210fb11879a63caf4c400f1323d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjIyOTU5Nw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3168#discussion_r382229597", "bodyText": "I've simplified the methods' signatures (to only need model).", "author": "manstis", "createdAt": "2020-02-20T20:06:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTk3OTkzNg=="}], "type": "inlineReview"}, {"oid": "bd488d62a6455c508ba7d1d186c9409045d16f12", "url": "https://github.com/kiegroup/kie-wb-common/commit/bd488d62a6455c508ba7d1d186c9409045d16f12", "message": "Updates following peer review.", "committedDate": "2020-02-20T20:04:50Z", "type": "commit"}]}