{"pr_number": 3140, "pr_title": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "pr_createdAt": "2020-02-04T15:29:22Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3140", "timeline": [{"oid": "9f677af7886373bd1c716132fb8d778388338912", "url": "https://github.com/kiegroup/kie-wb-common/commit/9f677af7886373bd1c716132fb8d778388338912", "message": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "committedDate": "2020-02-05T12:35:28Z", "type": "forcePushed"}, {"oid": "dead95b0ce26de71b4285b0d3e0fc1eee73a9f3d", "url": "https://github.com/kiegroup/kie-wb-common/commit/dead95b0ce26de71b4285b0d3e0fc1eee73a9f3d", "message": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "committedDate": "2020-02-05T14:23:55Z", "type": "forcePushed"}, {"oid": "92cdf78f1130e8d931af6d52e2ceac14d08c849a", "url": "https://github.com/kiegroup/kie-wb-common/commit/92cdf78f1130e8d931af6d52e2ceac14d08c849a", "message": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "committedDate": "2020-02-07T10:58:52Z", "type": "forcePushed"}, {"oid": "bc93e5db30ba70b09473bee33c59cff505fab856", "url": "https://github.com/kiegroup/kie-wb-common/commit/bc93e5db30ba70b09473bee33c59cff505fab856", "message": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "committedDate": "2020-02-07T12:12:29Z", "type": "forcePushed"}, {"oid": "d9ac221030d4dc090220cff909edc2ae95aa57ef", "url": "https://github.com/kiegroup/kie-wb-common/commit/d9ac221030d4dc090220cff909edc2ae95aa57ef", "message": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "committedDate": "2020-02-07T14:25:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk3ODI1MA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r376978250", "bodyText": "Please make this private static field of class, it is in each test.", "author": "jomarko", "createdAt": "2020-02-10T10:28:16Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-webapp-kogito-runtime/src/test/java/org/kie/workbench/common/dmn/showcase/client/selenium/DMNDesignerKogitoSeleniumIT.java", "diffHunk": "@@ -179,10 +204,939 @@ public void testDecisionEmpty() throws Exception {\n         final String actual = getContent();\n         assertThat(actual).isNotBlank();\n \n-        XmlAssert.assertThat(actual).and(expected)\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n+                .ignoreComments()\n+                .ignoreWhitespace()\n+                .areIdentical();\n+    }\n+\n+    @Test\n+    public void testDecisionExpressionLiteral() throws Exception {\n+        final String expected = loadResource(\"decision-expression-literal.xml\");\n+        setContent(expected);\n+\n+        final String actual = getContent();\n+        assertThat(actual).isNotBlank();\n+\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n+                .ignoreComments()\n+                .ignoreWhitespace()\n+                .areIdentical();\n+\n+        final Map<String, String> prefix2Uri = new Maps.Builder<String, String>()\n+                .put(DMN.getPrefix(), DMN.getUri())\n+                .build();", "originalCommit": "d9ac221030d4dc090220cff909edc2ae95aa57ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA2NTY2MA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r377065660", "bodyText": "Done.", "author": "manstis", "createdAt": "2020-02-10T13:37:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk3ODI1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk3ODQzMg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r376978432", "bodyText": "Please ignore all new tests due to our issues running on jenkins", "author": "jomarko", "createdAt": "2020-02-10T10:28:34Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-webapp-kogito-runtime/src/test/java/org/kie/workbench/common/dmn/showcase/client/selenium/DMNDesignerKogitoSeleniumIT.java", "diffHunk": "@@ -179,10 +204,939 @@ public void testDecisionEmpty() throws Exception {\n         final String actual = getContent();\n         assertThat(actual).isNotBlank();\n \n-        XmlAssert.assertThat(actual).and(expected)\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n+                .ignoreComments()\n+                .ignoreWhitespace()\n+                .areIdentical();\n+    }\n+\n+    @Test\n+    public void testDecisionExpressionLiteral() throws Exception {\n+        final String expected = loadResource(\"decision-expression-literal.xml\");\n+        setContent(expected);\n+\n+        final String actual = getContent();\n+        assertThat(actual).isNotBlank();\n+\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n+                .ignoreComments()\n+                .ignoreWhitespace()\n+                .areIdentical();\n+\n+        final Map<String, String> prefix2Uri = new Maps.Builder<String, String>()\n+                .put(DMN.getPrefix(), DMN.getUri())\n+                .build();\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmn:decision[@id='_4FEA7589-823B-4880-BCFA-AF2F9B145785']\" +\n+                                  \"/dmn:literalExpression[@id='_35DB53A6-97E7-4D48-9E5A-59CE0015CEF8']\" +\n+                                  \"/dmn:text[text()='123']\");\n+    }\n+\n+    @Test", "originalCommit": "d9ac221030d4dc090220cff909edc2ae95aa57ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA2NjQyMw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r377066423", "bodyText": "I've disabled Integration Tests by default (and removed all @Ignore so that we can run them locally if required using the -DskipITs=false flag). I think this is preferential to disabling them with the annotation. WDYT?", "author": "manstis", "createdAt": "2020-02-10T13:38:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk3ODQzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzEwMDM5NQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r377100395", "bodyText": "+1, thank you", "author": "jomarko", "createdAt": "2020-02-10T14:37:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk3ODQzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk4MDY4Mw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r376980683", "bodyText": "Please refactor/explain what the test does.", "author": "jomarko", "createdAt": "2020-02-10T10:32:52Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-webapp-kogito-runtime/src/test/java/org/kie/workbench/common/dmn/showcase/client/selenium/DMNDesignerKogitoSeleniumIT.java", "diffHunk": "@@ -193,10 +1147,398 @@ public void testDecisionServiceEmpty() throws Exception {\n         final String actual = getContent();\n         assertThat(actual).isNotBlank();\n \n-        XmlAssert.assertThat(actual).and(expected)\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n+                .ignoreComments()\n+                .ignoreWhitespace()\n+                .areIdentical();\n+    }\n+\n+    @Test\n+    public void testDecisionTableInputClauseConstraints_KOGITO369() throws Exception {\n+        final String expected = loadResource(\"KOGITO-369 (Decision Table Input Clause constraints).xml\");\n+        setContent(expected);\n+\n+        final String actual = getContent();\n+        assertThat(actual).isNotBlank();\n+\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n+                .ignoreComments()\n+                .ignoreWhitespace()\n+                .areIdentical();\n+\n+        final Map<String, String> prefix2Uri = new Maps.Builder<String, String>()\n+                .put(DMN.getPrefix(), DMN.getUri())\n+                .put(KIE.getPrefix(), KIE.getUri())\n+                .build();\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmn:decision[@id='_6BFBA4CD-6484-4AAE-9E28-CF54DA401C3D']\" +\n+                                  \"/dmn:decisionTable[@id='_3B5C4F51-7F86-4C25-AE10-565560188523']\" +\n+                                  \"/dmn:input[@id='_4FCD3B90-542B-4518-B541-23CEFC004D9E']\" +\n+                                  \"/dmn:inputValues[@kie:constraintType='enumeration' and @id='_79588FEE-2BA1-4CAE-B553-D96C6B2CB615']\" +\n+                                  \"/dmn:text[text()='[1, 2, 3]']\");\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmn:decision[@id='_6BFBA4CD-6484-4AAE-9E28-CF54DA401C3D']\" +\n+                                  \"/dmn:decisionTable[@id='_3B5C4F51-7F86-4C25-AE10-565560188523']\" +\n+                                  \"/dmn:input[@id='_2FEFE4CA-44EE-4BF9-8CFC-CB26A17AD52E']\" +\n+                                  \"/dmn:inputValues[@kie:constraintType='expression' and @id='_4B2A8314-4EDC-4183-BBF7-98587DAFEBFC']\" +\n+                                  \"/dmn:text[text()='< 1000']\");\n+    }\n+\n+    @Test\n+    public void testDocumentationLinks_KOGITO674() throws Exception {\n+        final String expected = loadResource(\"KOGITO-674 (Documentation links).xml\");\n+        setContent(expected);\n+\n+        final String actual = getContent();\n+        assertThat(actual).isNotBlank();\n+\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n+                .ignoreComments()\n+                .ignoreWhitespace()\n+                .areIdentical();\n+\n+        final Map<String, String> prefix2Uri = new Maps.Builder<String, String>()\n+                .put(DMN.getPrefix(), DMN.getUri())\n+                .put(KIE.getPrefix(), KIE.getUri())\n+                .build();\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmn:inputData[@id='_12A7D464-8A59-4B38-949E-96E63A3FC916']\" +\n+                                  \"/dmn:extensionElements/kie:attachment[@name='google' and @url='www.google.co.uk']\");\n+    }\n+\n+    @Test\n+    public void testEmptyExpression_DROOLS4724() throws Exception {\n+        final String expected = loadResource(\"DROOLS-4724 (Empty expression).xml\");\n+        setContent(expected);\n+\n+        final String actual = getContent();\n+        assertThat(actual).isNotBlank();\n+\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n+                .ignoreComments()\n+                .ignoreWhitespace()\n+                .areIdentical();\n+\n+        final Map<String, String> prefix2Uri = new Maps.Builder<String, String>()\n+                .put(DMN.getPrefix(), DMN.getUri())\n+                .build();\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .nodesByXPath(\"/dmn:definitions\" +\n+                                      \"/dmn:decision\" +\n+                                      \"/dmn:literalExpression\")\n+                .doNotExist();\n+    }\n+\n+    @Test\n+    public void testDecisionServiceNodeLocations_KOGITO371() throws Exception {\n+        final String expected = loadResource(\"KOGITO-371 (Decision Service node locations).xml\");\n+        setContent(expected);\n+\n+        final String actual = getContent();\n+        assertThat(actual).isNotBlank();\n+\n+        XmlAssert.assertThat(actual)\n+                .and(expected)\n                 .ignoreComments()\n                 .ignoreWhitespace()\n                 .areIdentical();\n+\n+        final Map<String, String> prefix2Uri = new Maps.Builder<String, String>()\n+                .put(DMN.getPrefix(), DMN.getUri())\n+                .put(DMNDI.getPrefix(), DMNDI.getUri())\n+                .put(DC.getPrefix(), DC.getUri())\n+                .build();\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmndi:DMNDI\" +\n+                                  \"/dmndi:DMNDiagram\" +\n+                                  \"/dmndi:DMNShape[@id='dmnshape-_4CEF4A0F-B605-4551-9403-7FA31C97DCD1']\" +\n+                                  \"/dc:Bounds[@x='670' and @y='153' and @width='200' and @height='200']\");\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmndi:DMNDI\" +\n+                                  \"/dmndi:DMNDiagram\" +\n+                                  \"/dmndi:DMNShape[@id='dmnshape-_B067B665-3343-495F-8257-608689084A91']\" +\n+                                  \"/dc:Bounds[@x='510' and @y='265' and @width='100' and @height='50']\");\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmndi:DMNDI\" +\n+                                  \"/dmndi:DMNDiagram\" +\n+                                  \"/dmndi:DMNShape[@id='dmnshape-_964EF7FB-010B-4698-9954-BB95ABBDF2A2']\" +\n+                                  \"/dc:Bounds[@x='720' and @y='265' and @width='100' and @height='50']\");\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmndi:DMNDI\" +\n+                                  \"/dmndi:DMNDiagram\" +\n+                                  \"/dmndi:DMNShape[@id='dmnshape-_A531F162-5032-40CF-B53A-E5818BD2C21A']\" +\n+                                  \"/dc:Bounds[@x='720' and @y='195' and @width='100' and @height='50']\");\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmndi:DMNDI\" +\n+                                  \"/dmndi:DMNDiagram\" +\n+                                  \"/dmndi:DMNShape[@id='dmnshape-_4C183144-7DAC-42FB-8243-A666FFDA2177']\" +\n+                                  \"/dc:Bounds[@x='930' and @y='195' and @width='100' and @height='50']\");\n+        XmlAssert.assertThat(actual)\n+                .withNamespaceContext(prefix2Uri)\n+                .hasXPath(\"/dmn:definitions\" +\n+                                  \"/dmndi:DMNDI\" +\n+                                  \"/dmndi:DMNDiagram\" +\n+                                  \"/dmndi:DMNShape[@id='dmnshape-_93FD724C-DF9A-4B85-B048-6E26F28B987A']\" +\n+                                  \"/dc:Bounds[@x='930' and @y='265' and @width='100' and @height='50']\");\n+    }\n+\n+    @Test\n+    public void testPaymentDateFile_KOGITO404() throws Exception {", "originalCommit": "d9ac221030d4dc090220cff909edc2ae95aa57ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzA2NzIyMA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r377067220", "bodyText": "I've added a comment for now.. my plan is to investigate and create the necessary JIRA BEFORE this PR is merged.", "author": "manstis", "createdAt": "2020-02-10T13:40:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk4MDY4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzEwMTMyNQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r377101325", "bodyText": "put jira here then", "author": "jomarko", "createdAt": "2020-02-10T14:39:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk4MDY4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzY5ODM3OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3140#discussion_r377698378", "bodyText": "@jomarko I've updated this PR description to list JIRA following up on this PR.\nI've also linked them on KOGITO-778 as \"Followed up by\".", "author": "manstis", "createdAt": "2020-02-11T15:15:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk4MDY4Mw=="}], "type": "inlineReview"}, {"oid": "c696564167d347223ca0c52edb03e4a7c59bbfc1", "url": "https://github.com/kiegroup/kie-wb-common/commit/c696564167d347223ca0c52edb03e4a7c59bbfc1", "message": "Updates following peer review.", "committedDate": "2020-02-10T13:17:42Z", "type": "forcePushed"}, {"oid": "4228c29c7af97e8eee427dbdd0ce3970420c1b85", "url": "https://github.com/kiegroup/kie-wb-common/commit/4228c29c7af97e8eee427dbdd0ce3970420c1b85", "message": "Updates following peer review.", "committedDate": "2020-02-10T13:36:33Z", "type": "forcePushed"}, {"oid": "d824de4d02c08bb0b758738c68af9d430c459b80", "url": "https://github.com/kiegroup/kie-wb-common/commit/d824de4d02c08bb0b758738c68af9d430c459b80", "message": "Updates following peer review.", "committedDate": "2020-02-10T13:53:20Z", "type": "forcePushed"}, {"oid": "4b247b4a1ca05cad8fae572884d188fbf56a67a3", "url": "https://github.com/kiegroup/kie-wb-common/commit/4b247b4a1ca05cad8fae572884d188fbf56a67a3", "message": "Updates following peer review.", "committedDate": "2020-02-11T09:33:12Z", "type": "forcePushed"}, {"oid": "1b644d7e929f106a496abbb5953fa96947a3e8d9", "url": "https://github.com/kiegroup/kie-wb-common/commit/1b644d7e929f106a496abbb5953fa96947a3e8d9", "message": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "committedDate": "2020-02-11T12:00:00Z", "type": "forcePushed"}, {"oid": "3b4257774e86e8cf85a148e2b860c4304ca4c993", "url": "https://github.com/kiegroup/kie-wb-common/commit/3b4257774e86e8cf85a148e2b860c4304ca4c993", "message": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "committedDate": "2020-02-11T15:12:27Z", "type": "commit"}, {"oid": "3b4257774e86e8cf85a148e2b860c4304ca4c993", "url": "https://github.com/kiegroup/kie-wb-common/commit/3b4257774e86e8cf85a148e2b860c4304ca4c993", "message": "KOGITO-778: [DMN Designer] Client-side marshalling tests", "committedDate": "2020-02-11T15:12:27Z", "type": "forcePushed"}]}