{"pr_number": 2210, "pr_title": "Testsuite - run zypper refresh only when repos are enabled", "pr_createdAt": "2020-05-13T14:02:22Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2210", "timeline": [{"oid": "c7f19c9133be7f19e12344da56b8eb64dbb8074c", "url": "https://github.com/uyuni-project/uyuni/commit/c7f19c9133be7f19e12344da56b8eb64dbb8074c", "message": "run refresh only when repos are enabled", "committedDate": "2020-05-13T13:56:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDQ2NzQwMA==", "url": "https://github.com/uyuni-project/uyuni/pull/2210#discussion_r424467400", "bodyText": "I guess his only needed when the client tools come from D:G:M:* projects?\nOtherwise, why would we need to do the import and the refresh manually?", "author": "juliogonzalez", "createdAt": "2020-05-13T14:08:53Z", "path": "testsuite/features/step_definitions/common_steps.rb", "diffHunk": "@@ -752,7 +752,10 @@\n     puts $minion.run(\"zypper mr --disable #{repos}\")\n   end\n \n-  $minion.run('zypper -n --gpg-auto-import-keys ref')\n+  # Refresh is only necessary when some repos are enabled\n+  if $minion.run('zypper lr').contains? 'Yes'\n+    $minion.run('zypper -n --gpg-auto-import-keys ref')", "originalCommit": "c7f19c9133be7f19e12344da56b8eb64dbb8074c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDQ5NzE1NA==", "url": "https://github.com/uyuni-project/uyuni/pull/2210#discussion_r424497154", "bodyText": "Yep, I understand it the same way.", "author": "lkotek", "createdAt": "2020-05-13T14:47:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDQ2NzQwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkzMzc3NA==", "url": "https://github.com/uyuni-project/uyuni/pull/2210#discussion_r424933774", "bodyText": "contains? -> include?\nif $minion.run('zypper lr').include? 'Yes'", "author": "calancha", "createdAt": "2020-05-14T07:44:34Z", "path": "testsuite/features/step_definitions/common_steps.rb", "diffHunk": "@@ -752,7 +752,10 @@\n     puts $minion.run(\"zypper mr --disable #{repos}\")\n   end\n \n-  $minion.run('zypper -n --gpg-auto-import-keys ref')\n+  # Refresh is only necessary when some repos are enabled\n+  if $minion.run('zypper lr').contains? 'Yes'", "originalCommit": "c7f19c9133be7f19e12344da56b8eb64dbb8074c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}