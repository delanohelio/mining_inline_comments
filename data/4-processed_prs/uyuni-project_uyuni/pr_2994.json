{"pr_number": 2994, "pr_title": "Fix permission issue in Salt user group", "pr_createdAt": "2020-12-09T17:15:47Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2994", "timeline": [{"oid": "c413a6e49b31adb0d8ead21692de44d1e09c9903", "url": "https://github.com/uyuni-project/uyuni/commit/c413a6e49b31adb0d8ead21692de44d1e09c9903", "message": "Fix dash underscore mismatch", "committedDate": "2020-12-09T17:09:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTUxMzU1Nw==", "url": "https://github.com/uyuni-project/uyuni/pull/2994#discussion_r539513557", "bodyText": "@sbluhm we have a special user because tomcat need to write in that directory. Not sure as which user tomcat is running on CentOS.\n@Etheryte I think removing is wrong as it it must be defined when building this package for CentOS.", "author": "mcalmer", "createdAt": "2020-12-09T17:41:56Z", "path": "java/spacewalk-java.spec", "diffHunk": "@@ -32,14 +32,13 @@\n %define appdir          /srv/tomcat/webapps\n %define jardir          /srv/tomcat/webapps/rhn/WEB-INF/lib\n %define apache_group    www\n-%define salt_user-group    salt\n+%define salt_user_group salt\n %define apache2         apache2\n %define java_version    11\n %else\n %define appdir          %{_localstatedir}/lib/tomcat/webapps\n %define jardir          %{_localstatedir}/lib/tomcat/webapps/rhn/WEB-INF/lib\n %define apache_group    apache\n-%define salt_user_group root ", "originalCommit": "c413a6e49b31adb0d8ead21692de44d1e09c9903", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU3MTg3MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2994#discussion_r539571870", "bodyText": "tomcat is run by the user tomcat on CentOS7. Why are you running into the else statement? For SUSE it should stay as salt.\n\nWe could put back the user as salt  in line 702 and 703 and just keep the variable salt_user_group as salt_group. We would cover the groups salt (SUSE), tomcat (other).\nAdd tomcat to the group salt. I assume this is being done for SUSE systems?", "author": "sbluhm", "createdAt": "2020-12-09T19:07:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTUxMzU1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDc2MzYzMg==", "url": "https://github.com/uyuni-project/uyuni/pull/2994#discussion_r540763632", "bodyText": "I think I was wrong. tomcat uses salt-api to write in this directory. So it is important under which user salt-api/salt-master is running. With the salt package shipped with Uyuni this is the user \"salt\".\nI would not suggest to use a different salt package, as upstream is slow with merging our new features. Even the latest salt upstream package might miss features which are required for uyuni.\nSo I think this is now good to be merged. We can make detail changes at any time later if needed.", "author": "mcalmer", "createdAt": "2020-12-11T08:12:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTUxMzU1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDc2ODA5MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2994#discussion_r540768091", "bodyText": "To remove complexity, does it make sense to revert my changes and hardcode the user/group again? Or the least remove the definition out of the if-loop? (Can obviously be done later, as you said).", "author": "sbluhm", "createdAt": "2020-12-11T08:20:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTUxMzU1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDgwNjYzNQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2994#discussion_r540806635", "bodyText": "Personally I think it's fine as-is right now, as good overview of the similarities and differences in the setups similar to apache etc. I'm going to merge this now to see if it resolves the test suite issues fully, and we can come back to this later if it rubs someone the wrong way.", "author": "Etheryte", "createdAt": "2020-12-11T09:26:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTUxMzU1Nw=="}], "type": "inlineReview"}, {"oid": "620e2eb174bf1ce6954d604d497a822ae72f0a07", "url": "https://github.com/uyuni-project/uyuni/commit/620e2eb174bf1ce6954d604d497a822ae72f0a07", "message": "Revert branched user group", "committedDate": "2020-12-09T19:11:54Z", "type": "commit"}]}