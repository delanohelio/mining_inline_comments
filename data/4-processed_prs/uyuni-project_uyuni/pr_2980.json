{"pr_number": 2980, "pr_title": "spacewalk-java: SPEC file updates", "pr_createdAt": "2020-12-07T15:37:51Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2980", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0NjU5Mg==", "url": "https://github.com/uyuni-project/uyuni/pull/2980#discussion_r537846592", "bodyText": "Can you please check on this change? It is confusing me a bit.\n\nThis built successfully on my LEAP15.2 test.\nhttps://build.opensuse.org/package/view_file/systemsmanagement:Uyuni:Master:Other/apache-commons-jexl/apache-commons-jexl.spec also puts the file into %{_javadir}/*\nSo I am wondering why the original location %{jardir}/apache-commons-jexl_commons-jexl.jar worked in the first place...", "author": "sbluhm", "createdAt": "2020-12-07T21:29:52Z", "path": "java/spacewalk-java.spec", "diffHunk": "@@ -748,7 +752,7 @@ chown tomcat:%{apache_group} /var/log/rhn/gatherer.log\n \n %{jardir}/snakeyaml.jar\n # SUSE extra runtime dependencies: spark, jade4j, salt API client + dependencies\n-%{jardir}/apache-commons-jexl_commons-jexl.jar\n+%{jardir}/commons-jexl.jar", "originalCommit": "d6d341ec3812b3fd30d61d20a51ee9932f05dd2b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODM0Mzk2Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2980#discussion_r538343966", "bodyText": "I found out that we have also an official build of this package in Leap. So we do not need to build it on our own.\nI have disabled apache-commons-jexl building for SUSE and removed the last build from the repo.\nThe Leap package has this path similar to the official CentOS package. AFAIK you added the condition which now also match the Leap Package.\nI forgot to disable the CentOS package. I am right, that there is package names apache-commons-jexl in CentOS 8 and it also have the path apache-commons/jexl_commons-jexl.jar ? If yes, I would just use %{jardir}/apache-commons-jexl_commons-jexl.jar everywhere and we can remove apache-commons-jexl from systemsmanagement:Uyuni:Master:Other", "author": "mcalmer", "createdAt": "2020-12-08T13:04:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0NjU5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODM5MTQyMg==", "url": "https://github.com/uyuni-project/uyuni/pull/2980#discussion_r538391422", "bodyText": "There isn't. Let me have another look at this. My current strategy:\n\nAdapt/verify the SPEC to the official SUSE bundle version.\nremove the bundle from systemsmanagement:Uyuni:Master:Other (SUSE and CentOS)\nAdd the bundle to my \"EL8 only\" wip branch (home:sbluhm:systemsmanagement:Uyuni:Other:EL8) and make it match RHEL conventions.\nAdapt the SPEC file to RHEL if required.\nYou can already delete the package from systemsmanagement:Uyuni:Master:Other from a CentOS 8/my perspective.", "author": "sbluhm", "createdAt": "2020-12-08T13:50:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0NjU5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTIwMTgyNA==", "url": "https://github.com/uyuni-project/uyuni/pull/2980#discussion_r539201824", "bodyText": "OK, tested and verified now on LEAP and CentOS. Your parallel changes 3 days ago to the spec file is what really confused me as I couldn't figure out the non-existing delta :)\nNote that we should eventually take out \n  \n    \n      uyuni/java/buildconf/build-props.xml\n    \n    \n         Line 79\n      in\n      b9e6a91\n    \n    \n    \n    \n\n        \n          \n           <condition property=\"commons-jexl\" value=\"apache-commons-jexl/commons-jexl\" else=\"commons-jexl\"> \n        \n    \n  \n\n to make everything consistent.\nThis would conflict with everyone having installed apache-commons-jexl from the Uyuni repository though. I noticed that the Uyuni package always installs before the OS package on LEAP.\nAn alternative option would be to release a new version/revision with the OS path and force this change on the next package update.", "author": "sbluhm", "createdAt": "2020-12-09T10:48:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0NjU5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI0NjAwMg==", "url": "https://github.com/uyuni-project/uyuni/pull/2980#discussion_r539246002", "bodyText": "It was the idea to remove the Uyuni build version. But when it is required for CentOS we should think about it.\nI think I will revisit this on the weekend and check your suggestion with our internal repos for SLES.", "author": "mcalmer", "createdAt": "2020-12-09T11:57:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0NjU5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI0OTcwOA==", "url": "https://github.com/uyuni-project/uyuni/pull/2980#discussion_r539249708", "bodyText": "It is required for CentOS. But the naming conventions should match up with the SUSE ones. So the real issue is current package in Uyuni:Others. I am rebuilding it to RHEL/SUSE standards in my repo atm.", "author": "sbluhm", "createdAt": "2020-12-09T12:03:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0NjU5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg5MjMzNQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2980#discussion_r541892335", "bodyText": "@mcalmer , I just thought about this. We should just require %{jardir}/commons-jexl.jar. That would/should force the installation of the OS package and ignore the Uyuni package version. I won't have this on my todo/test list though as I am currently playing in different areas (unless you ask me to).", "author": "sbluhm", "createdAt": "2020-12-13T10:07:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg0NjU5Mg=="}], "type": "inlineReview"}, {"oid": "42078d50474e7f2b781cd9c7cd07af3d0049e3f8", "url": "https://github.com/uyuni-project/uyuni/commit/42078d50474e7f2b781cd9c7cd07af3d0049e3f8", "message": "spacewalk-java: SPEC file libxml2-devel addition and Source0 update.", "committedDate": "2020-12-09T10:26:26Z", "type": "commit"}, {"oid": "42078d50474e7f2b781cd9c7cd07af3d0049e3f8", "url": "https://github.com/uyuni-project/uyuni/commit/42078d50474e7f2b781cd9c7cd07af3d0049e3f8", "message": "spacewalk-java: SPEC file libxml2-devel addition and Source0 update.", "committedDate": "2020-12-09T10:26:26Z", "type": "forcePushed"}, {"oid": "9d0633166e83641a73a8714c261c8cf7df347a39", "url": "https://github.com/uyuni-project/uyuni/commit/9d0633166e83641a73a8714c261c8cf7df347a39", "message": "Merge branch 'master' into sbluhm-spacewalk-java", "committedDate": "2020-12-09T10:49:00Z", "type": "commit"}]}