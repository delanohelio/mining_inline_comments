{"pr_number": 2184, "pr_title": "Fix bootstrap repo md caching", "pr_createdAt": "2020-05-05T13:47:24Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2184", "timeline": [{"oid": "373652622c019fb1ea3cdd2ff531a8d5ca566f1e", "url": "https://github.com/uyuni-project/uyuni/commit/373652622c019fb1ea3cdd2ff531a8d5ca566f1e", "message": "no not cache metadata of the bootstrap repositories (bsc#1171169)", "committedDate": "2020-05-05T13:41:19Z", "type": "commit"}, {"oid": "42afe59dbefd3e1021767a08ceef16ec037394e7", "url": "https://github.com/uyuni-project/uyuni/commit/42afe59dbefd3e1021767a08ceef16ec037394e7", "message": "update changelog", "committedDate": "2020-05-05T13:42:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDEzODU1Mg==", "url": "https://github.com/uyuni-project/uyuni/pull/2184#discussion_r420138552", "bodyText": "Trying to confirm the correctness of such a sed command by looking at the code is not trivial :) But I assume you tested it and if it results in the line below contained in squid.conf, it is obviously correct as we are using the same rule for the other metadata as well. So fine with me.", "author": "mantel", "createdAt": "2020-05-05T14:09:11Z", "path": "proxy/installer/spacewalk-proxy-installer.spec", "diffHunk": "@@ -106,6 +106,9 @@ if [ -f /etc/sysconfig/apache2 ]; then\n     sysconf_addword /etc/sysconfig/apache2 APACHE_MODULES proxy_http\n fi\n sed -i -e\"s/^range_offset_limit -1 KB/range_offset_limit none/\" /etc/squid/squid.conf\n+if ! grep pub\\/repositories /etc/squid/squid.conf >/dev/null; then\n+    sed -i 's;\\(refresh_pattern /rhn/manager/download.*\\);\\1\\nrefresh_pattern /pub/repositories/.*/repodata/.*$ 0 1% 1440 ignore-no-cache reload-into-ims refresh-ims;' /etc/squid/squid.conf\n+fi", "originalCommit": "42afe59dbefd3e1021767a08ceef16ec037394e7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}