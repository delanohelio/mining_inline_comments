{"pr_number": 2953, "pr_title": "spacewalk-java: Added RHEL build support. Simplified SPEC file.", "pr_createdAt": "2020-12-01T14:09:30Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2953", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA4OTI1OA==", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536089258", "bodyText": "This can be simplified as we have on SUSE now also apache-commons-el .\nI tried it and it works. Please remove jakarta-commons-el. It is not needed anymore.", "author": "mcalmer", "createdAt": "2020-12-04T13:11:55Z", "path": "java/spacewalk-java.spec", "diffHunk": "@@ -32,34 +32,27 @@\n %define appdir          /srv/tomcat/webapps\n %define jardir          /srv/tomcat/webapps/rhn/WEB-INF/lib\n %define apache_group    www\n+%define salt_user-group    salt\n %define apache2         apache2\n-%define ehcache         ehcache >= 2.10.1\n-%define apache_commons_discovery   jakarta-commons-discovery\n-%define apache_commons_el          jakarta-commons-el\n-%define apache_commons_validator   jakarta-commons-validator\n %define java_version    11\n-%if 0%{?sle_version} > 150100\n-%define apache_commons_fileupload  apache-commons-fileupload\n-%define apache_commons_digester    apache-commons-digester\n-%define log4j                      log4j12\n-%else\n-%define apache_commons_fileupload  jakarta-commons-fileupload\n-%define apache_commons_digester    jakarta-commons-digester\n-%define log4j                      log4j\n-%endif\n %else\n %define appdir          %{_localstatedir}/lib/tomcat/webapps\n %define jardir          %{_localstatedir}/lib/tomcat/webapps/rhn/WEB-INF/lib\n %define apache_group    apache\n+%define salt_user_group root \n %define apache2         httpd\n-%define ehcache         ehcache-core >= 2.10.1\n-%define apache_commons_discovery   apache-commons-discovery\n-%define apache_commons_el          apache-commons-el\n-%define apache_commons_fileupload  apache-commons-fileupload\n-%define apache_commons_validator   apache-commons-validator\n %define java_version    1:11\n %endif\n \n+%define ehcache         ( mvn(net.sf.ehcache:ehcache-core) >= 2.10.1 or ehcache-core >= 2.10.1 or ehcache >= 2.10.1)\n+%define apache_commons_digester    (apache-commons-digester or jakarta-commons-digester)\n+%define apache_commons_discovery   (apache-commons-discovery or jakarta-commons-discovery)\n+%define apache_commons_el          (apache-commons-el or jakarta-commons-el)", "originalCommit": "4517f36b64b3eb1c21e14cdf3352aeaad3b13004", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE3MzI2OQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536173269", "bodyText": "done.", "author": "sbluhm", "createdAt": "2020-12-04T15:18:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA4OTI1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MTY5Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536091696", "bodyText": "In line 96 we have the same inside of a \"%if suse\". When this is also needed on CentOS, please remove it from above.", "author": "mcalmer", "createdAt": "2020-12-04T13:15:59Z", "path": "java/spacewalk-java.spec", "diffHunk": "@@ -116,8 +111,14 @@ BuildRequires:  %{apache_commons_discovery}\n BuildRequires:  %{apache_commons_el}\n BuildRequires:  %{apache_commons_fileupload}\n BuildRequires:  %{apache_commons_validator}\n+%if 0%{?rhel} >= 8 || 0%{?fedora}\n+BuildRequires:  java-11-openjdk-devel\n+BuildRequires:\tmaven-javadoc-plugin\n+%else\n BuildRequires:  java-devel >= %{java_version}\n+%endif\n BuildRequires:  java-saml\n+BuildRequires:  javamail", "originalCommit": "4517f36b64b3eb1c21e14cdf3352aeaad3b13004", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE3Mzk5NA==", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536173994", "bodyText": "Thx!", "author": "sbluhm", "createdAt": "2020-12-04T15:19:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MTY5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MjQ3OA==", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536092478", "bodyText": "This BuildRequires exists already above. Maybe this should be just a \"Require\" ?", "author": "mcalmer", "createdAt": "2020-12-04T13:17:17Z", "path": "java/spacewalk-java.spec", "diffHunk": "@@ -172,22 +173,26 @@ Requires:       c3p0 >= 0.9.1\n Requires:       cglib\n %if 0%{?suse_version}\n Requires:       classmate\n-Requires:       javamail\n %endif\n Requires:       cobbler >= 3.0.0\n Requires:       concurrent\n Requires:       dwr >= 3\n Requires:       %{ehcache}\n-Requires:       gnu-jaf\n+Requires:       (jaf or gnu-jaf)\n Requires:       google-gson >= 2.2.4\n Requires:       hibernate-commons-annotations\n Requires:       hibernate5\n Requires:       httpcomponents-client\n Requires:       ical4j\n Requires:       jade4j\n Requires:       %{apache_commons_digester}\n+%if 0%{?rhel} >= 8\n+BuildRequires:  java-11-openjdk", "originalCommit": "4517f36b64b3eb1c21e14cdf3352aeaad3b13004", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE3ODI2NA==", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536178264", "bodyText": "Wer kopiert, der verliert...", "author": "sbluhm", "createdAt": "2020-12-04T15:25:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MjQ3OA=="}], "type": "inlineReview"}, {"oid": "4a59781de07737fade3a863bd1ff0ebf280b124d", "url": "https://github.com/uyuni-project/uyuni/commit/4a59781de07737fade3a863bd1ff0ebf280b124d", "message": "spacewalk-java: Added RHEL build support. Simplified SPEC file.", "committedDate": "2020-12-04T15:09:38Z", "type": "forcePushed"}, {"oid": "4ecbef1b883fd9ac0ff25921248799a57ae4f1a0", "url": "https://github.com/uyuni-project/uyuni/commit/4ecbef1b883fd9ac0ff25921248799a57ae4f1a0", "message": "spacewalk-java: Added RHEL build support. Simplified SPEC file.", "committedDate": "2020-12-04T15:12:39Z", "type": "commit"}, {"oid": "4ecbef1b883fd9ac0ff25921248799a57ae4f1a0", "url": "https://github.com/uyuni-project/uyuni/commit/4ecbef1b883fd9ac0ff25921248799a57ae4f1a0", "message": "spacewalk-java: Added RHEL build support. Simplified SPEC file.", "committedDate": "2020-12-04T15:12:39Z", "type": "forcePushed"}, {"oid": "328186d7c67d8d32edbdd4ecb6fe28f47d51da7a", "url": "https://github.com/uyuni-project/uyuni/commit/328186d7c67d8d32edbdd4ecb6fe28f47d51da7a", "message": "Merge branch 'master' into sbluhm-spacewalk-java", "committedDate": "2020-12-04T15:26:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjcxMjY2MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536712661", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            BuildRequires:  apache_commons_el\n          \n          \n            \n            BuildRequires:  apache-commons-el", "author": "mcalmer", "createdAt": "2020-12-05T12:03:42Z", "path": "java/spacewalk-java.spec", "diffHunk": "@@ -113,11 +106,17 @@ BuildRequires:  ical4j\n BuildRequires:  jade4j\n BuildRequires:  jaf\n BuildRequires:  %{apache_commons_discovery}\n-BuildRequires:  %{apache_commons_el}\n+BuildRequires:  apache_commons_el", "originalCommit": "328186d7c67d8d32edbdd4ecb6fe28f47d51da7a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjcxMjgxMA==", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536712810", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Requires:       apache_commons_el\n          \n          \n            \n            Requires:       apache-commons-el", "author": "mcalmer", "createdAt": "2020-12-05T12:03:58Z", "path": "java/spacewalk-java.spec", "diffHunk": "@@ -211,7 +214,7 @@ Requires:       susemanager-docs_en\n Requires:       tomcat-taglibs-standard\n Requires(pre):  uyuni-base-server\n Requires:       %{apache_commons_discovery}\n-Requires:       %{apache_commons_el}\n+Requires:       apache_commons_el", "originalCommit": "328186d7c67d8d32edbdd4ecb6fe28f47d51da7a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9928228a6d5c96526b8a24760a53a8ec29bc2a78", "url": "https://github.com/uyuni-project/uyuni/commit/9928228a6d5c96526b8a24760a53a8ec29bc2a78", "message": "Update java/spacewalk-java.spec\n\nCo-authored-by: Michael Calmer <Michael.Calmer@suse.de>", "committedDate": "2020-12-05T12:23:11Z", "type": "commit"}, {"oid": "f10fb11c19c156f8f927109532fcdb070cb6755c", "url": "https://github.com/uyuni-project/uyuni/commit/f10fb11c19c156f8f927109532fcdb070cb6755c", "message": "Update java/spacewalk-java.spec\n\nCo-authored-by: Michael Calmer <Michael.Calmer@suse.de>", "committedDate": "2020-12-05T12:23:18Z", "type": "commit"}]}