{"pr_number": 1986, "pr_title": "Virt pool stop", "pr_createdAt": "2020-03-05T14:14:54Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/1986", "timeline": [{"oid": "22e558f1e45132814cbe00755977471238dcf40a", "url": "https://github.com/uyuni-project/uyuni/commit/22e558f1e45132814cbe00755977471238dcf40a", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-05T16:16:09Z", "type": "forcePushed"}, {"oid": "6045325f95432bba184fd05956956944577f9ec8", "url": "https://github.com/uyuni-project/uyuni/commit/6045325f95432bba184fd05956956944577f9ec8", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-05T17:20:39Z", "type": "forcePushed"}, {"oid": "b9045fc03706eeadf27725f5597fc05fdd902a70", "url": "https://github.com/uyuni-project/uyuni/commit/b9045fc03706eeadf27725f5597fc05fdd902a70", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-06T13:40:46Z", "type": "forcePushed"}, {"oid": "42c8651180cc0669f0ebb3f2f24ee79c4e81c50f", "url": "https://github.com/uyuni-project/uyuni/commit/42c8651180cc0669f0ebb3f2f24ee79c4e81c50f", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-09T13:57:19Z", "type": "forcePushed"}, {"oid": "25e4eca92f7762ca9515b5a40d9a82b31d557ed3", "url": "https://github.com/uyuni-project/uyuni/commit/25e4eca92f7762ca9515b5a40d9a82b31d557ed3", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-09T16:57:45Z", "type": "forcePushed"}, {"oid": "5b8009d2b22709365f3e94214da047980548447f", "url": "https://github.com/uyuni-project/uyuni/commit/5b8009d2b22709365f3e94214da047980548447f", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-10T10:12:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg3NjAzNQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1986#discussion_r390876035", "bodyText": "\"When\" please", "author": "Bischoff", "createdAt": "2020-03-11T10:30:11Z", "path": "testsuite/features/step_definitions/common_steps.rb", "diffHunk": "@@ -461,6 +461,24 @@\n   raise \"xpath: #{xpath} not found\" unless find(:xpath, xpath).set(true)\n end\n \n+When(/I wait until the tree item \"([^\"]+)\" has no sub-list/) do |item|\n+  repeat_until_timeout(message: \"could still find a sub list for tree item #{item}\") do\n+    xpath = \"//span[contains(text(), '#{item}')]/ancestor::div[contains(@class, 'product-details-wrapper')]/div/i[contains(@class, 'fa-angle-')]\"\n+    begin\n+      find(:xpath, xpath)\n+      sleep 1\n+    rescue Capybara::ElementNotFound\n+      break\n+    end\n+  end\n+end\n+\n+And(/^I wait until the tree item \"([^\"]+)\" contains \"([^\"]+)\" text$/) do |item, text|", "originalCommit": "5b8009d2b22709365f3e94214da047980548447f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg3NjI0NQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1986#discussion_r390876245", "bodyText": "Could be \"And\"", "author": "Bischoff", "createdAt": "2020-03-11T10:30:32Z", "path": "testsuite/features/secondary/minkvm_guests.feature", "diffHunk": "@@ -194,6 +194,27 @@ Feature: Be able to manage KVM virtual machines via the GUI\n     And I click on \"Delete\" in \"Delete Guest\" modal\n     Then I should not see a \"test-vm2\" virtual machine on \"kvm_server\"\n \n+@virthost_kvm\n+  Scenario: Refresh a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Refresh\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" has no sub-list", "originalCommit": "5b8009d2b22709365f3e94214da047980548447f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg3NjMzMA==", "url": "https://github.com/uyuni-project/uyuni/pull/1986#discussion_r390876330", "bodyText": "Same.", "author": "Bischoff", "createdAt": "2020-03-11T10:30:42Z", "path": "testsuite/features/secondary/minkvm_guests.feature", "diffHunk": "@@ -194,6 +194,27 @@ Feature: Be able to manage KVM virtual machines via the GUI\n     And I click on \"Delete\" in \"Delete Guest\" modal\n     Then I should not see a \"test-vm2\" virtual machine on \"kvm_server\"\n \n+@virthost_kvm\n+  Scenario: Refresh a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Refresh\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" has no sub-list\n+\n+@virthost_kvm\n+  Scenario: Stop a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Stop\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" contains \"inactive\" text", "originalCommit": "5b8009d2b22709365f3e94214da047980548447f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg3NjQ0OA==", "url": "https://github.com/uyuni-project/uyuni/pull/1986#discussion_r390876448", "bodyText": "Same.", "author": "Bischoff", "createdAt": "2020-03-11T10:30:54Z", "path": "testsuite/features/secondary/minkvm_guests.feature", "diffHunk": "@@ -194,6 +194,27 @@ Feature: Be able to manage KVM virtual machines via the GUI\n     And I click on \"Delete\" in \"Delete Guest\" modal\n     Then I should not see a \"test-vm2\" virtual machine on \"kvm_server\"\n \n+@virthost_kvm\n+  Scenario: Refresh a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Refresh\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" has no sub-list\n+\n+@virthost_kvm\n+  Scenario: Stop a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Stop\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" contains \"inactive\" text\n+\n+@virthost_kvm\n+  Scenario: Start a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Start\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" contains \"running\" text", "originalCommit": "5b8009d2b22709365f3e94214da047980548447f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "754a5fb0d16533a32361c609df8e440de9d26e46", "url": "https://github.com/uyuni-project/uyuni/commit/754a5fb0d16533a32361c609df8e440de9d26e46", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-11T15:44:59Z", "type": "forcePushed"}, {"oid": "a83530febfc7464322eb977207df987e02d39a29", "url": "https://github.com/uyuni-project/uyuni/commit/a83530febfc7464322eb977207df987e02d39a29", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-11T16:21:18Z", "type": "forcePushed"}, {"oid": "a4f3e8835945df4dfa4b9439527f6a99b3f969a9", "url": "https://github.com/uyuni-project/uyuni/commit/a4f3e8835945df4dfa4b9439527f6a99b3f969a9", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-12T07:17:10Z", "type": "forcePushed"}, {"oid": "8d7874bbac2581397f9be6795f48173e28cdd3fc", "url": "https://github.com/uyuni-project/uyuni/commit/8d7874bbac2581397f9be6795f48173e28cdd3fc", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-12T12:39:50Z", "type": "forcePushed"}, {"oid": "5599ac3a0add54965cea46eac5be3942c5884ae7", "url": "https://github.com/uyuni-project/uyuni/commit/5599ac3a0add54965cea46eac5be3942c5884ae7", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-13T15:59:58Z", "type": "forcePushed"}, {"oid": "2fcb8b6bacc710eac8cd8698f15058d5797b9255", "url": "https://github.com/uyuni-project/uyuni/commit/2fcb8b6bacc710eac8cd8698f15058d5797b9255", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-23T10:11:16Z", "type": "forcePushed"}, {"oid": "fb73e7ff579587ec2e82e1652523fc3288699aec", "url": "https://github.com/uyuni-project/uyuni/commit/fb73e7ff579587ec2e82e1652523fc3288699aec", "message": "Add virtual pool stop action", "committedDate": "2020-03-23T10:55:58Z", "type": "commit"}, {"oid": "77940af3dcc4b80b725090e03013a819fcb5aea1", "url": "https://github.com/uyuni-project/uyuni/commit/77940af3dcc4b80b725090e03013a819fcb5aea1", "message": "Add Salt implementation for virtual pool stop action", "committedDate": "2020-03-23T10:55:58Z", "type": "commit"}, {"oid": "be069a9f7c753c28c7de6500678e4a86d43df31b", "url": "https://github.com/uyuni-project/uyuni/commit/be069a9f7c753c28c7de6500678e4a86d43df31b", "message": "Add REST API to trigger virtual pool stop action", "committedDate": "2020-03-23T10:55:58Z", "type": "commit"}, {"oid": "bfc8c7dc1c3ac07db740bcaf15117e638064f28a", "url": "https://github.com/uyuni-project/uyuni/commit/bfc8c7dc1c3ac07db740bcaf15117e638064f28a", "message": "Add cucumber step watching over text to appear in a tree item", "committedDate": "2020-03-23T10:55:58Z", "type": "commit"}, {"oid": "a0bec74822a000127d14fe63618ef3a6fb48e999", "url": "https://github.com/uyuni-project/uyuni/commit/a0bec74822a000127d14fe63618ef3a6fb48e999", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-23T10:55:58Z", "type": "commit"}, {"oid": "a0bec74822a000127d14fe63618ef3a6fb48e999", "url": "https://github.com/uyuni-project/uyuni/commit/a0bec74822a000127d14fe63618ef3a6fb48e999", "message": "Add virtual pool stop action UI and cucumber test", "committedDate": "2020-03-23T10:55:58Z", "type": "forcePushed"}]}