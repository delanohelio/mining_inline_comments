{"pr_number": 2572, "pr_title": "move token information into apt auth.conf on Debian 10...", "pr_createdAt": "2020-09-04T12:04:31Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2572", "timeline": [{"oid": "97f17a5e3c329cb5aa04deffbdd91fe0b38b3cea", "url": "https://github.com/uyuni-project/uyuni/commit/97f17a5e3c329cb5aa04deffbdd91fe0b38b3cea", "message": "move token information into apt auth.conf on Debian 10...\n\nSince Debian 10, apt uses a netrc kind of file to hide the authentication\ninformation that needed to access repositories.", "committedDate": "2020-09-04T10:57:05Z", "type": "commit"}, {"oid": "f6da150f8fdc8634a59545945b559e6b41218f74", "url": "https://github.com/uyuni-project/uyuni/commit/f6da150f8fdc8634a59545945b559e6b41218f74", "message": "move repository login information also for Ubuntu >= 18 (like for Debian 10)", "committedDate": "2020-09-05T20:14:57Z", "type": "commit"}, {"oid": "f3e1fd91df4af574216ff12b5906bd2cd316afc2", "url": "https://github.com/uyuni-project/uyuni/commit/f3e1fd91df4af574216ff12b5906bd2cd316afc2", "message": "remove unneeded check for os_family within aptauth.conf", "committedDate": "2020-09-07T11:36:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTcxOTg0Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2572#discussion_r495719846", "bodyText": "Don't forget to remove this file when deleting a minion (see susemanager-utils/susemanager-sls/salt/cleanup_minion/init.sls and susemanager-utils/susemanager-sls/salt/cleanup_ssh_minion/init.sls).", "author": "mateiw", "createdAt": "2020-09-28T06:44:11Z", "path": "susemanager-utils/susemanager-sls/salt/channels/init.sls", "diffHunk": "@@ -72,6 +72,18 @@ mgrchannels_repo:\n {%- endif %}\n {%- endif %}\n \n+{%- if (grains['os'] == 'Debian' and grains['osmajorrelease']|int >= 10) or (grains['os'] == 'Ubuntu' and grains['osmajorrelease']|int >= 18) %}\n+aptauth_conf:\n+  file.managed:\n+    - name: \"/etc/apt/auth.conf.d/susemanager.conf\"", "originalCommit": "f3e1fd91df4af574216ff12b5906bd2cd316afc2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE5MjM0Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2572#discussion_r496192346", "bodyText": "@mateiw Updated branch. Only added to cleanup_minion as that is also included within cleanup_ssh_minion", "author": "rpasche", "createdAt": "2020-09-28T19:47:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTcxOTg0Ng=="}], "type": "inlineReview"}, {"oid": "b0eec77335afbbc489a7175710b55ffce4226bfb", "url": "https://github.com/uyuni-project/uyuni/commit/b0eec77335afbbc489a7175710b55ffce4226bfb", "message": "remove debian auth.conf.d file on minion cleanup", "committedDate": "2020-09-28T19:46:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjU5Mzg4NQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2572#discussion_r496593885", "bodyText": "file.absent doesn't seem to support multiple names.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            mgrchannels_repo_clean_channels:\n          \n          \n            \n              file.absent:\n          \n          \n            \n                - name: /etc/apt/sources.list.d/susemanager:channels.list\n          \n          \n            \n                - name: /etc/apt/auth.conf.d/susemanager.conf\n          \n          \n            \n            mgrchannels_repo_clean_channels:\n          \n          \n            \n              file.absent:\n          \n          \n            \n                - name: /etc/apt/sources.list.d/susemanager:channels.list\n          \n          \n            \n            mgrchannels_repo_clean_auth:\n          \n          \n            \n              file.absent:\n          \n          \n            \n                - name: /etc/apt/auth.conf.d/susemanager.conf", "author": "mateiw", "createdAt": "2020-09-29T09:59:57Z", "path": "susemanager-utils/susemanager-sls/salt/cleanup_minion/init.sls", "diffHunk": "@@ -12,6 +12,7 @@ mgrchannels_repo_clean_all:\n mgrchannels_repo_clean_channels:\n   file.absent:\n     - name: /etc/apt/sources.list.d/susemanager:channels.list\n+    - name: /etc/apt/auth.conf.d/susemanager.conf", "originalCommit": "b0eec77335afbbc489a7175710b55ffce4226bfb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ee7e6e13bd5bd9424cb1b7eba44db63497e838b1", "url": "https://github.com/uyuni-project/uyuni/commit/ee7e6e13bd5bd9424cb1b7eba44db63497e838b1", "message": "Use suggested patch to also remove debian auth file\n\nCo-authored-by: Matei Albu <mateiw@users.noreply.github.com>", "committedDate": "2020-09-29T11:15:11Z", "type": "commit"}, {"oid": "cff241c8e85ee315947b5da9f2c625c41222164f", "url": "https://github.com/uyuni-project/uyuni/commit/cff241c8e85ee315947b5da9f2c625c41222164f", "message": "Merge branch 'master' into create_apt_auth_for_debian_10", "committedDate": "2020-10-02T09:58:59Z", "type": "commit"}]}