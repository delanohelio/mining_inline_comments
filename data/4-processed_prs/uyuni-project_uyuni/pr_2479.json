{"pr_number": 2479, "pr_title": "React translation enablement", "pr_createdAt": "2020-08-11T09:51:16Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2479", "timeline": [{"oid": "afa70bf4541db4fdc8e56a28dfba8a6df3bef7ec", "url": "https://github.com/uyuni-project/uyuni/commit/afa70bf4541db4fdc8e56a28dfba8a6df3bef7ec", "message": "Send only one request to fetch the translation data\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-13T14:29:37Z", "type": "forcePushed"}, {"oid": "32cfe690e1fde108e88e7498a51d703196ac503a", "url": "https://github.com/uyuni-project/uyuni/commit/32cfe690e1fde108e88e7498a51d703196ac503a", "message": "Don't translate login page for now\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-13T16:19:58Z", "type": "forcePushed"}, {"oid": "e9a197b3728982bcc7830be324ee6e54c99e5c6a", "url": "https://github.com/uyuni-project/uyuni/commit/e9a197b3728982bcc7830be324ee6e54c99e5c6a", "message": "Don't translate login page for now\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-14T08:28:10Z", "type": "forcePushed"}, {"oid": "6e721ee34a027b203b634e27da604a964359a437", "url": "https://github.com/uyuni-project/uyuni/commit/6e721ee34a027b203b634e27da604a964359a437", "message": "Don't translate login page for now\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-14T08:38:39Z", "type": "forcePushed"}, {"oid": "b53566fb42cc62be7d5577c55c051dcc35b1eac4", "url": "https://github.com/uyuni-project/uyuni/commit/b53566fb42cc62be7d5577c55c051dcc35b1eac4", "message": "Don't translate login page for now\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-14T09:11:32Z", "type": "forcePushed"}, {"oid": "c413c01d8b33d2e88911b60993a9c8a5a7461f68", "url": "https://github.com/uyuni-project/uyuni/commit/c413c01d8b33d2e88911b60993a9c8a5a7461f68", "message": "bla\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-18T13:58:27Z", "type": "forcePushed"}, {"oid": "0941752eca93364f627449a30af5942043d051e5", "url": "https://github.com/uyuni-project/uyuni/commit/0941752eca93364f627449a30af5942043d051e5", "message": "to be reverted\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-21T09:54:32Z", "type": "forcePushed"}, {"oid": "43fe21d30bd96874720b07bec4cd611c11a9f4da", "url": "https://github.com/uyuni-project/uyuni/commit/43fe21d30bd96874720b07bec4cd611c11a9f4da", "message": "Add missing t()s to the login page\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-21T13:40:32Z", "type": "forcePushed"}, {"oid": "4e1231ddbdc5879fd371c88311bd06f86ab57c15", "url": "https://github.com/uyuni-project/uyuni/commit/4e1231ddbdc5879fd371c88311bd06f86ab57c15", "message": "Add missing t()s to the login page\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-25T15:37:52Z", "type": "forcePushed"}, {"oid": "b30479d03b757e83a848ce7490d6dfcd16a8ef30", "url": "https://github.com/uyuni-project/uyuni/commit/b30479d03b757e83a848ce7490d6dfcd16a8ef30", "message": "Add missing t()s to the login page\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-26T08:18:22Z", "type": "forcePushed"}, {"oid": "8b695ebdf4644d74b95828f56aefeb52940c833f", "url": "https://github.com/uyuni-project/uyuni/commit/8b695ebdf4644d74b95828f56aefeb52940c833f", "message": "Add changelogs\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-26T08:50:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODI5MjY4OQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2479#discussion_r478292689", "bodyText": "Today we all should learn: this is not the way to disable a feature! \ud83d\ude05\nJust to be clear: no blame to anyone, just to be aware of.", "author": "ncounter", "createdAt": "2020-08-27T09:45:16Z", "path": "branding/css/susemanager-theme.less", "diffHunk": "@@ -896,10 +896,6 @@ input[name=\"cveIdentifierId\"]#cveIdentifierId {\n .popover-content ul li {\n   margin-top: .5em\n }\n-/* Create New User. Language selection hidden for SUSE Manager users as we only offer support for English */", "originalCommit": "4d6d28ab719e6c65ad97c50b729b8a3f373f8a7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUzOTU3Mw==", "url": "https://github.com/uyuni-project/uyuni/pull/2479#discussion_r478539573", "bodyText": "Yeah I was shocked when I saw this \ud83d\ude05", "author": "parlt91", "createdAt": "2020-08-27T16:18:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODI5MjY4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM4MjY5Mw==", "url": "https://github.com/uyuni-project/uyuni/pull/2479#discussion_r478382693", "bodyText": "why not DEFAULT_LOCALE? btw, is this going to affect the language or also all the localization like date and time?", "author": "ncounter", "createdAt": "2020-08-27T12:32:23Z", "path": "java/code/src/com/redhat/rhn/common/conf/ConfigDefaults.java", "diffHunk": "@@ -329,6 +330,11 @@\n      */\n     public static final String ALLOW_ADDING_PATCHES_VIA_API = \"java.allow_adding_patches_via_api\";\n \n+    /**\n+     * Specify the default language to use if user preferences are not available such as on the login page\n+     */\n+    public static final String PREFERRED_LOCALE = \"web.locale\";", "originalCommit": "4d6d28ab719e6c65ad97c50b729b8a3f373f8a7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQ5MzQ1Mg==", "url": "https://github.com/uyuni-project/uyuni/pull/2479#discussion_r478493452", "bodyText": "I guess you are right DEFAULT_LOCALE is better in this context.\nIt is just the language.", "author": "parlt91", "createdAt": "2020-08-27T15:10:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM4MjY5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM4NzI4MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2479#discussion_r478387280", "bodyText": "Can we put this into window.preferredLocale?", "author": "ncounter", "createdAt": "2020-08-27T12:40:27Z", "path": "java/code/webapp/WEB-INF/decorators/layout_head.jsp", "diffHunk": "@@ -62,14 +62,17 @@\n         </c:otherwise>\n     </c:choose>\n \n+    <!-- expose user preferred language to the application -->\n+    <c:set var=\"currentLocale\" value=\"${GlobalInstanceHolder.MENU_TREE.getCurrentLocale(pageContext)}\"/>\n+    <script> preferredLocale='${currentLocale}'</script>", "originalCommit": "4d6d28ab719e6c65ad97c50b729b8a3f373f8a7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUwMTgyNQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2479#discussion_r478501825", "bodyText": "Yes of course we can. I will change it", "author": "parlt91", "createdAt": "2020-08-27T15:22:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODM4NzI4MA=="}], "type": "inlineReview"}, {"oid": "26d37abd674945c3a1a21c9282466d5eb1ecdfb5", "url": "https://github.com/uyuni-project/uyuni/commit/26d37abd674945c3a1a21c9282466d5eb1ecdfb5", "message": "Fix ISE on about page\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-27T16:08:40Z", "type": "forcePushed"}, {"oid": "71bc047c7129df3ee1523f1a1b6242e3015474df", "url": "https://github.com/uyuni-project/uyuni/commit/71bc047c7129df3ee1523f1a1b6242e3015474df", "message": "Fix ISE on about page\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-28T11:09:55Z", "type": "forcePushed"}, {"oid": "c5fd42a747f4ea1d1bf0736f52e14bf186ceb37e", "url": "https://github.com/uyuni-project/uyuni/commit/c5fd42a747f4ea1d1bf0736f52e14bf186ceb37e", "message": "Replace browser language picker with config default picker\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-08-31T16:22:43Z", "type": "forcePushed"}, {"oid": "a66c43379d71cc1cd6b97815ab470d0419154368", "url": "https://github.com/uyuni-project/uyuni/commit/a66c43379d71cc1cd6b97815ab470d0419154368", "message": "Move getCurrentLocale from MenuTree to its own class\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-01T16:31:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkxODY4MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2479#discussion_r482918680", "bodyText": "Following @ncounter's suggestion, shall we move this to window.preferredLocale too?", "author": "cbbayburt", "createdAt": "2020-09-03T11:51:38Z", "path": "java/code/src/com/suse/manager/webui/controllers/login/templates/login.jade", "diffHunk": "@@ -58,6 +58,7 @@ html\n             | #{request_method}\n \n         script(type='text/javascript').\n+            preferredLocale = \"#{preferredLocale}\";", "originalCommit": "33e8278fa744085b186558ff12d4ed18eccce538", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjk2ODYwMA==", "url": "https://github.com/uyuni-project/uyuni/pull/2479#discussion_r482968600", "bodyText": "It seems that it is already added to the window variable. At least typing window.preferredLocale into the console at the login page returns the value", "author": "parlt91", "createdAt": "2020-09-03T13:15:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkxODY4MA=="}], "type": "inlineReview"}, {"oid": "784f2d1f26f44eac89c87ca8999bec9bbf48bf0f", "url": "https://github.com/uyuni-project/uyuni/commit/784f2d1f26f44eac89c87ca8999bec9bbf48bf0f", "message": "Add language picker to user preferences\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:36Z", "type": "commit"}, {"oid": "6444483e5a6f54473db7fdaeae29587da21b7108", "url": "https://github.com/uyuni-project/uyuni/commit/6444483e5a6f54473db7fdaeae29587da21b7108", "message": "Pass preferred language to react frontend\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:37Z", "type": "commit"}, {"oid": "9a26c22c987a4c292767e151536689fd430c6618", "url": "https://github.com/uyuni-project/uyuni/commit/9a26c22c987a4c292767e151536689fd430c6618", "message": "Add gettext-parser and node-gettext\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:37Z", "type": "commit"}, {"oid": "9fd8e636789f3016c040875218fcf7efc35b4c8f", "url": "https://github.com/uyuni-project/uyuni/commit/9fd8e636789f3016c040875218fcf7efc35b4c8f", "message": "Update vendors\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:37Z", "type": "commit"}, {"oid": "617e2a32fd496f85912a5faf6387db5fd955c7dd", "url": "https://github.com/uyuni-project/uyuni/commit/617e2a32fd496f85912a5faf6387db5fd955c7dd", "message": "Create custom po-loader for webpack\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:37Z", "type": "commit"}, {"oid": "adbfbc3165b87531800038bb0916d296431595b1", "url": "https://github.com/uyuni-project/uyuni/commit/adbfbc3165b87531800038bb0916d296431595b1", "message": "Add translation enablement for react t()\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:37Z", "type": "commit"}, {"oid": "a65ae2d0157cd8516590de05a83baf60283cf9df", "url": "https://github.com/uyuni-project/uyuni/commit/a65ae2d0157cd8516590de05a83baf60283cf9df", "message": "Remove susemanager-translate file\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:37Z", "type": "commit"}, {"oid": "8ba755b4d030540b6606f98c183d851a099c867e", "url": "https://github.com/uyuni-project/uyuni/commit/8ba755b4d030540b6606f98c183d851a099c867e", "message": "Remove unneeded t()\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:37Z", "type": "commit"}, {"oid": "39752fb85d2120ef5113f40bc5a01038999aea7f", "url": "https://github.com/uyuni-project/uyuni/commit/39752fb85d2120ef5113f40bc5a01038999aea7f", "message": "Add missing t()s to the login page\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:38Z", "type": "commit"}, {"oid": "d9aafa5cda36f6bd6c25ccd1fb07b905a8c50cf0", "url": "https://github.com/uyuni-project/uyuni/commit/d9aafa5cda36f6bd6c25ccd1fb07b905a8c50cf0", "message": "Add changelogs\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:38Z", "type": "commit"}, {"oid": "0c82dd5243046a61560f73c900dcfb169528954f", "url": "https://github.com/uyuni-project/uyuni/commit/0c82dd5243046a61560f73c900dcfb169528954f", "message": "Fix ISE on about page\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:38Z", "type": "commit"}, {"oid": "4266a96f691ba1b5e24471adefa8daf65c323ae2", "url": "https://github.com/uyuni-project/uyuni/commit/4266a96f691ba1b5e24471adefa8daf65c323ae2", "message": "Replace browser language picker with config default picker\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:38Z", "type": "commit"}, {"oid": "24d7fd5a205661388d3f050caa1358676c4dc9ad", "url": "https://github.com/uyuni-project/uyuni/commit/24d7fd5a205661388d3f050caa1358676c4dc9ad", "message": "Move getCurrentLocale from MenuTree to its own class\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:38Z", "type": "commit"}, {"oid": "24d7fd5a205661388d3f050caa1358676c4dc9ad", "url": "https://github.com/uyuni-project/uyuni/commit/24d7fd5a205661388d3f050caa1358676c4dc9ad", "message": "Move getCurrentLocale from MenuTree to its own class\n\nSigned-off-by: Pascal Arlt <parlt@suse.com>", "committedDate": "2020-09-04T08:08:38Z", "type": "forcePushed"}]}