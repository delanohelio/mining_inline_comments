{"pr_number": 2744, "pr_title": "Testsuite: Add test for salt minion ssh push via tunnel", "pr_createdAt": "2020-10-22T15:01:33Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2744", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0NTYzOQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510245639", "bodyText": "I would prefer to use the same naming everywhere, not sure which is the better one, I would say \"via SSH Tunnel\" ?", "author": "srbarrios", "createdAt": "2020-10-22T15:16:12Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0NzA4OA==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510247088", "bodyText": "for push via ssh tunnel maybe?", "author": "srbarrios", "createdAt": "2020-10-22T15:18:13Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push\n+\n+  Scenario: Delete the salt minion for ssh-reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    And I cleanup minion \"sle_minion\"\n+    Then \"sle_minion\" should not be registered\n+\n+  Scenario: Register this minion for SSH push via tunnel", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxMTYwNA==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510311604", "bodyText": "via SSH tunnel then (capital, it's the protocol)", "author": "Bischoff", "createdAt": "2020-10-22T16:48:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0NzA4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0NzkwNw==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510247907", "bodyText": ":D Definitely we need to find a unique name to describe that kind of test", "author": "srbarrios", "createdAt": "2020-10-22T15:19:19Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push\n+\n+  Scenario: Delete the salt minion for ssh-reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    And I cleanup minion \"sle_minion\"\n+    Then \"sle_minion\" should not be registered\n+\n+  Scenario: Register this minion for SSH push via tunnel\n+    Given I am authorized\n+    And I go to the bootstrapping page\n+    Then I should see a \"Bootstrap Minions\" text\n+    And I enter the hostname of \"sle_minion\" as \"hostname\"\n+    And I enter \"22\" as \"port\"\n+    And I enter \"root\" as \"user\"\n+    And I enter \"linux\" as \"password\"\n+    And I select \"1-SUSE-SSH-TUNNEL-DEV-x86_64\" from \"activationKeys\"\n+    And I select the hostname of \"proxy\" from \"proxies\"\n+    And I check \"manageWithSSH\"\n+    And I click on \"Bootstrap\"\n+    And I wait until I see \"Successfully bootstrapped host!\" text\n+    And I am on the System Overview page\n+    And I wait until I see the name of \"sle_minion\", refreshing the page\n+    And I wait until onboarding is completed for \"sle_minion\"\n+\n+  Scenario: Check this minion's contact method\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    Then I should see a \"Push via SSH tunnel\" text\n+\n+  Scenario: Cleanup: delete the SSH push tunnel minion\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    Then \"sle_minion\" should not be registered\n+\n+  Scenario: Cleanup: register a salt minion after SSH push tests", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0ODc4MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510248780", "bodyText": "I would use a more unique name for that scenario, as one of our agreements is not repeat scenario names, and in this case can be too generic.", "author": "srbarrios", "createdAt": "2020-10-22T15:20:22Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push\n+\n+  Scenario: Delete the salt minion for ssh-reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    And I cleanup minion \"sle_minion\"\n+    Then \"sle_minion\" should not be registered\n+\n+  Scenario: Register this minion for SSH push via tunnel\n+    Given I am authorized\n+    And I go to the bootstrapping page\n+    Then I should see a \"Bootstrap Minions\" text\n+    And I enter the hostname of \"sle_minion\" as \"hostname\"\n+    And I enter \"22\" as \"port\"\n+    And I enter \"root\" as \"user\"\n+    And I enter \"linux\" as \"password\"\n+    And I select \"1-SUSE-SSH-TUNNEL-DEV-x86_64\" from \"activationKeys\"\n+    And I select the hostname of \"proxy\" from \"proxies\"\n+    And I check \"manageWithSSH\"\n+    And I click on \"Bootstrap\"\n+    And I wait until I see \"Successfully bootstrapped host!\" text\n+    And I am on the System Overview page\n+    And I wait until I see the name of \"sle_minion\", refreshing the page\n+    And I wait until onboarding is completed for \"sle_minion\"\n+\n+  Scenario: Check this minion's contact method", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcxMTQ3OA==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510711478", "bodyText": "Scenario: The contact method is SSH tunnel on this minion?", "author": "calancha", "createdAt": "2020-10-23T08:12:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0ODc4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0OTA3MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510249071", "bodyText": "When", "author": "srbarrios", "createdAt": "2020-10-22T15:20:46Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push\n+\n+  Scenario: Delete the salt minion for ssh-reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    And I cleanup minion \"sle_minion\"\n+    Then \"sle_minion\" should not be registered\n+\n+  Scenario: Register this minion for SSH push via tunnel\n+    Given I am authorized\n+    And I go to the bootstrapping page\n+    Then I should see a \"Bootstrap Minions\" text\n+    And I enter the hostname of \"sle_minion\" as \"hostname\"", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0OTI5MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510249291", "bodyText": "Then", "author": "srbarrios", "createdAt": "2020-10-22T15:21:03Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push\n+\n+  Scenario: Delete the salt minion for ssh-reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    And I cleanup minion \"sle_minion\"\n+    Then \"sle_minion\" should not be registered\n+\n+  Scenario: Register this minion for SSH push via tunnel\n+    Given I am authorized\n+    And I go to the bootstrapping page\n+    Then I should see a \"Bootstrap Minions\" text\n+    And I enter the hostname of \"sle_minion\" as \"hostname\"\n+    And I enter \"22\" as \"port\"\n+    And I enter \"root\" as \"user\"\n+    And I enter \"linux\" as \"password\"\n+    And I select \"1-SUSE-SSH-TUNNEL-DEV-x86_64\" from \"activationKeys\"\n+    And I select the hostname of \"proxy\" from \"proxies\"\n+    And I check \"manageWithSSH\"\n+    And I click on \"Bootstrap\"\n+    And I wait until I see \"Successfully bootstrapped host!\" text", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxMjA1Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510312056", "bodyText": "Not necessarily. This is an action (to wait). But ok.", "author": "Bischoff", "createdAt": "2020-10-22T16:49:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0OTI5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcxMTg5MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510711890", "bodyText": "I'll follow Eric here (i.e. keep And).", "author": "calancha", "createdAt": "2020-10-23T08:13:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI0OTI5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI1MDA2MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510250061", "bodyText": "Do we really need those two steps? Maybe is enough with the last step I wait until onboarding is completed for \"sle_minion\"", "author": "srbarrios", "createdAt": "2020-10-22T15:22:02Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push\n+\n+  Scenario: Delete the salt minion for ssh-reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    And I cleanup minion \"sle_minion\"\n+    Then \"sle_minion\" should not be registered\n+\n+  Scenario: Register this minion for SSH push via tunnel\n+    Given I am authorized\n+    And I go to the bootstrapping page\n+    Then I should see a \"Bootstrap Minions\" text\n+    And I enter the hostname of \"sle_minion\" as \"hostname\"\n+    And I enter \"22\" as \"port\"\n+    And I enter \"root\" as \"user\"\n+    And I enter \"linux\" as \"password\"\n+    And I select \"1-SUSE-SSH-TUNNEL-DEV-x86_64\" from \"activationKeys\"\n+    And I select the hostname of \"proxy\" from \"proxies\"\n+    And I check \"manageWithSSH\"\n+    And I click on \"Bootstrap\"\n+    And I wait until I see \"Successfully bootstrapped host!\" text\n+    And I am on the System Overview page\n+    And I wait until I see the name of \"sle_minion\", refreshing the page", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcxMjI3Mw==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510712273", "bodyText": "You are right.  Fixed.", "author": "calancha", "createdAt": "2020-10-23T08:14:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDI1MDA2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMwODg1Nw==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510308857", "bodyText": "Please  Copyright (c) 2010-2020 SUSE LLC on top of file.", "author": "Bischoff", "createdAt": "2020-10-22T16:44:32Z", "path": "testsuite/features/core/srv_create_activationkey.feature", "diffHunk": "@@ -119,3 +119,15 @@ Feature: Be able to create and manipulate activation keys\n     And I select \"Push via SSH\" from \"contact-method\"\n     And I click on \"Create Activation Key\"\n     Then I should see a \"Activation key SUSE SSH Test Key x86_64 has been created\" text\n+", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcxMzE0Mw==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510713143", "bodyText": "Copyright should start with the year of publication of the work (this file in this case).  The copyright cannot go backward in time before the existence of the work.", "author": "calancha", "createdAt": "2020-10-23T08:15:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMwODg1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxMTIyNg==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510311226", "bodyText": "We had a convention (introduced by Dario Maiocchi) to always use a minion name that reflects client's role. In this case \"sle_minion\" would also be called \"sle_reverse_ssh_minion\" or something alike.\nI'm not a big fan of this convention and we could also drop it alltogether, but then we need to also remove it at the other places.\nIf not, we need to conform to it.", "author": "Bischoff", "createdAt": "2020-10-22T16:48:07Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push\n+\n+  Scenario: Delete the salt minion for ssh-reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_minion\"", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMzNzAyNw==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510337027", "bodyText": "let's keep the convention, please! But what about some shorter name? \"ssh_push_minion\"?", "author": "srbarrios", "createdAt": "2020-10-22T17:30:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxMTIyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDcwOTU0MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510709540", "bodyText": "Ok, I will go with ssh_push_minion", "author": "calancha", "createdAt": "2020-10-23T08:09:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxMTIyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDc1NDk0Nw==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510754947", "bodyText": "After review doc, maybe \"ssh push\" is not the best way to identify this client.\nSee that https://documentation.suse.com/external-tree/en-us/suma/4.1/suse-manager/architecture/salt-contact-method-overview.html\n\n\nSo... maybe is better to change in the feature file name and in the host name by something else like \"ssh_tunnel_minion\", sorry for all this confusion...", "author": "srbarrios", "createdAt": "2020-10-23T09:25:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxMTIyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxMzE5NQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510313195", "bodyText": "what is \"ssh-reverse\" ? the name of a program?\nIf it's just \"SSH reverse\", then no dash, and use capital letters for protocol name.", "author": "Bischoff", "createdAt": "2020-10-22T16:51:15Z", "path": "testsuite/features/secondary/min_ssh_push.feature", "diffHunk": "@@ -0,0 +1,48 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH push\n+\n+  Scenario: Delete the salt minion for ssh-reverse bootstrap", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxMzgyNQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510313825", "bodyText": "nice catch.\n(SSH reverse ?)", "author": "Bischoff", "createdAt": "2020-10-22T16:52:16Z", "path": "testsuite/features/secondary/trad_ssh_push.feature", "diffHunk": "@@ -3,36 +3,16 @@\n \n Feature: Register a traditional system to be managed via SSH push\n \n-  Scenario: Delete the traditional client for ssh-reverse bootrap\n+  Scenario: Delete the traditional client for ssh-reverse bootstrap", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDMxNDAwMg==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510314002", "bodyText": "nice catch.", "author": "Bischoff", "createdAt": "2020-10-22T16:52:36Z", "path": "testsuite/features/secondary/trad_ssh_push.feature", "diffHunk": "@@ -3,36 +3,16 @@\n \n Feature: Register a traditional system to be managed via SSH push\n \n-  Scenario: Delete the traditional client for ssh-reverse bootrap\n+  Scenario: Delete the traditional client for ssh-reverse bootstrap\n     Given I am on the Systems overview page of this \"sle_client\"\n     When I follow \"Delete System\"\n     Then I should see a \"Confirm System Profile Deletion\" text\n     When I click on \"Delete Profile\"\n     And I wait until I see \"has been deleted\" text\n     Then \"sle_client\" should not be registered\n \n-  Scenario: Create an activation key for SSH push\n-    Given I am on the Systems page\n-    When I follow the left menu \"Systems > Activation Keys\"\n-    And I follow \"Create Key\"\n-    And I enter \"SSH push key\" as \"description\"\n-    And I enter \"ssh-push\" as \"key\"\n-    And I select \"Push via SSH\" from \"contact-method\"\n-    And I click on \"Create Activation Key\"\n-    Then I should see a \"Activation key SSH push key has been created.\" text\n-\n-  Scenario: Create an activation key for SSH push via tunnel\n-    Given I am on the Systems page\n-    When I follow the left menu \"Systems > Activation Keys\"\n-    And I follow \"Create Key\"\n-    And I enter \"SSH push via tunnel key\" as \"description\"\n-    And I enter \"ssh-push-tunnel\" as \"key\"\n-    And I select \"Push via SSH tunnel\" from \"contact-method\"\n-    And I click on \"Create Activation Key\"\n-    Then I should see a \"Activation key SSH push via tunnel key has been created.\" text\n-", "originalCommit": "da0153d78d303e00ee375ab792e3c6af786c9bd5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1501fefb0189dd38eb14cdca8331d8bc8e0a1c39", "url": "https://github.com/uyuni-project/uyuni/commit/1501fefb0189dd38eb14cdca8331d8bc8e0a1c39", "message": "Add label sle_push_minion\n\nApply several tweaks: adjust scenario names and Gherkin syntaxis", "committedDate": "2020-10-23T09:24:13Z", "type": "forcePushed"}, {"oid": "144d4a55b0f98ea8a5e490460f59addfe053b669", "url": "https://github.com/uyuni-project/uyuni/commit/144d4a55b0f98ea8a5e490460f59addfe053b669", "message": "Rename feature file\n\n- testsuite/features/secondary/min_ssh_tunnel.feature\nRenamed from min_ssh_push.feature.\nRename the label from sle_push_minion to sle_ssh_tunnel_minion.\n\n- testsuite/run_sets/secondary.yml: Update file name.", "committedDate": "2020-10-23T09:49:37Z", "type": "forcePushed"}, {"oid": "1d9d7bb38d6e7ece9ba7a25c145f1a7c751cd758", "url": "https://github.com/uyuni-project/uyuni/commit/1d9d7bb38d6e7ece9ba7a25c145f1a7c751cd758", "message": "Rename feature file\n\n- testsuite/features/secondary/min_ssh_tunnel.feature\nRenamed from min_ssh_push.feature.\nRename the label from sle_push_minion to sle_ssh_tunnel_minion.\n\n- testsuite/run_sets/secondary.yml: Update file name.", "committedDate": "2020-10-23T09:57:07Z", "type": "forcePushed"}, {"oid": "baff79177159d91db2c9b776001474e35098441f", "url": "https://github.com/uyuni-project/uyuni/commit/baff79177159d91db2c9b776001474e35098441f", "message": "Rename feature file\n\n- testsuite/features/secondary/min_ssh_tunnel.feature\nRenamed from min_ssh_push.feature.\nRename the label from sle_push_minion to sle_ssh_tunnel_minion.\n\n- testsuite/run_sets/secondary.yml: Update file name.", "committedDate": "2020-10-23T09:59:51Z", "type": "forcePushed"}, {"oid": "1916b4c13a3e1081a75969f7f5f8d9a960479e4b", "url": "https://github.com/uyuni-project/uyuni/commit/1916b4c13a3e1081a75969f7f5f8d9a960479e4b", "message": "Testsuite: Add test for salt minion ssh push via tunnel\n\nAfter botstrap it, install/remove a package on it and\nrun a remote command.\n- features/core/srv_create_activationkey.feature:\nCreate a test key for SSH push via tunnel.\n\n- testsuite/features/secondary/min_ssh_tunnel.feature:\nNew test.\n- testsuite/run_sets/secondary.yml:\nAdd it to the secondary stage.\n\n- testsuite/features/support/twopence_init.rb:\nAdd label 'sle_ssh_tunnel_minion'.\n- testsuite/documentation/cucumber-steps.md:\nDocument the new label.\n\n- testsuite/features/secondary/trad_ssh_push.feature:\nDo not create new keys for ssh/ssh-tunnel, use the existent ones.", "committedDate": "2020-10-23T10:04:57Z", "type": "commit"}, {"oid": "1916b4c13a3e1081a75969f7f5f8d9a960479e4b", "url": "https://github.com/uyuni-project/uyuni/commit/1916b4c13a3e1081a75969f7f5f8d9a960479e4b", "message": "Testsuite: Add test for salt minion ssh push via tunnel\n\nAfter botstrap it, install/remove a package on it and\nrun a remote command.\n- features/core/srv_create_activationkey.feature:\nCreate a test key for SSH push via tunnel.\n\n- testsuite/features/secondary/min_ssh_tunnel.feature:\nNew test.\n- testsuite/run_sets/secondary.yml:\nAdd it to the secondary stage.\n\n- testsuite/features/support/twopence_init.rb:\nAdd label 'sle_ssh_tunnel_minion'.\n- testsuite/documentation/cucumber-steps.md:\nDocument the new label.\n\n- testsuite/features/secondary/trad_ssh_push.feature:\nDo not create new keys for ssh/ssh-tunnel, use the existent ones.", "committedDate": "2020-10-23T10:04:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDc5NTI5NA==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510795294", "bodyText": "No need to fix.. but just so you are aware, maybe here we should also say SSH tunnel minion", "author": "srbarrios", "createdAt": "2020-10-23T10:40:06Z", "path": "testsuite/features/secondary/min_ssh_tunnel.feature", "diffHunk": "@@ -0,0 +1,86 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH tunnel\n+\n+  Scenario: Delete the salt minion for SSH reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    And I cleanup minion \"sle_ssh_tunnel_minion\"\n+    Then \"sle_ssh_tunnel_minion\" should not be registered\n+\n+  Scenario: Register this minion for push via SSH tunnel\n+    Given I am authorized\n+    When I go to the bootstrapping page\n+    Then I should see a \"Bootstrap Minions\" text\n+    And I enter the hostname of \"sle_ssh_tunnel_minion\" as \"hostname\"\n+    And I enter \"22\" as \"port\"\n+    And I enter \"root\" as \"user\"\n+    And I enter \"linux\" as \"password\"\n+    And I select \"1-SUSE-SSH-TUNNEL-DEV-x86_64\" from \"activationKeys\"\n+    And I select the hostname of \"proxy\" from \"proxies\"\n+    And I check \"manageWithSSH\"\n+    And I click on \"Bootstrap\"\n+    And I wait until I see \"Successfully bootstrapped host!\" text\n+    And I wait until onboarding is completed for \"sle_ssh_tunnel_minion\"\n+\n+  Scenario: The contact method is SSH tunnel on this minion\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    Then I should see a \"Push via SSH tunnel\" text\n+\n+  Scenario: Install a package from this SSH tunnel minion\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    When I follow \"Software\" in the content area\n+    And I follow \"Install\"\n+    And I enter \"milkyway-dummy\" as the filtered package name\n+    And I click on the filter button\n+    And I check \"milkyway-dummy\" in the list\n+    And I click on \"Install Selected Packages\"\n+    And I click on \"Confirm\"\n+    Then I should see a \"1 package install has been scheduled for\" text\n+    When I force picking pending events on \"sle_ssh_tunnel_minion\" if necessary\n+    Then I wait until event \"Package Install/Upgrade scheduled by admin\" is completed\n+\n+  Scenario: Remove a package from this SSH tunnel minion\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    And I follow \"Software\" in the content area\n+    And I follow \"List / Remove\"\n+    And I enter \"milkyway-dummy\" as the filtered package name\n+    And I click on the filter button\n+    And I check \"milkyway-dummy\" in the list\n+    And I click on \"Remove Packages\"\n+    And I click on \"Confirm\"\n+    Then I should see a \"1 package removal has been scheduled\" text\n+    When I force picking pending events on \"sle_ssh_tunnel_minion\" if necessary\n+    Then I wait until event \"Package Removal scheduled by admin\" is completed\n+\n+  Scenario: Run a remote command on this SSH reverse minion\n+    Given I am authorized as \"testing\" with password \"testing\"\n+    When I follow the left menu \"Salt > Remote Commands\"\n+    Then I should see a \"Remote Commands\" text in the content area\n+    When I enter command \"echo 'My remote command output'\"\n+    And I enter the hostname of \"sle_ssh_tunnel_minion\" as \"target\"\n+    And I click on preview\n+    Then I should see a \"Target systems (1)\" text\n+    When I wait until I do not see \"pending\" text\n+    And I click on run\n+    And I wait until I see \"show response\" text\n+    And I expand the results for \"sle_ssh_tunnel_minion\"\n+    Then I should see \"My remote command output\" in the command output for \"sle_ssh_tunnel_minion\"\n+\n+  Scenario: Cleanup: delete the SSH push tunnel minion\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    Then \"sle_ssh_tunnel_minion\" should not be registered\n+\n+  Scenario: Cleanup: register a salt minion after SSH push tests", "originalCommit": "1916b4c13a3e1081a75969f7f5f8d9a960479e4b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDc5NTM1Nw==", "url": "https://github.com/uyuni-project/uyuni/pull/2744#discussion_r510795357", "bodyText": "No need to fix.. but just so you are aware, maybe here we should also say SSH tunnel minion", "author": "srbarrios", "createdAt": "2020-10-23T10:40:14Z", "path": "testsuite/features/secondary/min_ssh_tunnel.feature", "diffHunk": "@@ -0,0 +1,86 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Register a salt system to be managed via SSH tunnel\n+\n+  Scenario: Delete the salt minion for SSH reverse bootstrap\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    When I follow \"Delete System\"\n+    Then I should see a \"Confirm System Profile Deletion\" text\n+    When I click on \"Delete Profile\"\n+    And I wait until I see \"has been deleted\" text\n+    And I cleanup minion \"sle_ssh_tunnel_minion\"\n+    Then \"sle_ssh_tunnel_minion\" should not be registered\n+\n+  Scenario: Register this minion for push via SSH tunnel\n+    Given I am authorized\n+    When I go to the bootstrapping page\n+    Then I should see a \"Bootstrap Minions\" text\n+    And I enter the hostname of \"sle_ssh_tunnel_minion\" as \"hostname\"\n+    And I enter \"22\" as \"port\"\n+    And I enter \"root\" as \"user\"\n+    And I enter \"linux\" as \"password\"\n+    And I select \"1-SUSE-SSH-TUNNEL-DEV-x86_64\" from \"activationKeys\"\n+    And I select the hostname of \"proxy\" from \"proxies\"\n+    And I check \"manageWithSSH\"\n+    And I click on \"Bootstrap\"\n+    And I wait until I see \"Successfully bootstrapped host!\" text\n+    And I wait until onboarding is completed for \"sle_ssh_tunnel_minion\"\n+\n+  Scenario: The contact method is SSH tunnel on this minion\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    Then I should see a \"Push via SSH tunnel\" text\n+\n+  Scenario: Install a package from this SSH tunnel minion\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    When I follow \"Software\" in the content area\n+    And I follow \"Install\"\n+    And I enter \"milkyway-dummy\" as the filtered package name\n+    And I click on the filter button\n+    And I check \"milkyway-dummy\" in the list\n+    And I click on \"Install Selected Packages\"\n+    And I click on \"Confirm\"\n+    Then I should see a \"1 package install has been scheduled for\" text\n+    When I force picking pending events on \"sle_ssh_tunnel_minion\" if necessary\n+    Then I wait until event \"Package Install/Upgrade scheduled by admin\" is completed\n+\n+  Scenario: Remove a package from this SSH tunnel minion\n+    Given I am on the Systems overview page of this \"sle_ssh_tunnel_minion\"\n+    And I follow \"Software\" in the content area\n+    And I follow \"List / Remove\"\n+    And I enter \"milkyway-dummy\" as the filtered package name\n+    And I click on the filter button\n+    And I check \"milkyway-dummy\" in the list\n+    And I click on \"Remove Packages\"\n+    And I click on \"Confirm\"\n+    Then I should see a \"1 package removal has been scheduled\" text\n+    When I force picking pending events on \"sle_ssh_tunnel_minion\" if necessary\n+    Then I wait until event \"Package Removal scheduled by admin\" is completed\n+\n+  Scenario: Run a remote command on this SSH reverse minion", "originalCommit": "1916b4c13a3e1081a75969f7f5f8d9a960479e4b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}