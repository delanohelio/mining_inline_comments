{"pr_number": 1819, "pr_title": "Move all the routes initialization calls into the controllers", "pr_createdAt": "2020-01-22T09:28:25Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/1819", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQ2MDQ5NQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1819#discussion_r369460495", "bodyText": "How about organizing the removed code by route i.e. groups, systems, etc by adding new methods and calling them inside MinionsAPI.initRoutes() or calling them directly from here.", "author": "mateiw", "createdAt": "2020-01-22T09:51:41Z", "path": "java/code/src/com/suse/manager/webui/Router.java", "diffHunk": "@@ -117,204 +106,49 @@ public void init() {\n         AdminApiController.initRoutes();\n \n         // Minions\n-        get(\"/manager/systems/keys\",\n-                withUserPreferences(withCsrfToken(withUser(MinionController::list))),\n-                jade);\n-        get(\"/manager/systems/bootstrap\",\n-                withCsrfToken(withOrgAdmin(MinionController::bootstrap)),\n-                jade);\n-        get(\"/manager/systems/cmd\",\n-                withCsrfToken(MinionController::cmd),\n-                jade);\n-        get(\"/manager/systems/:id\",\n-                MinionController::show);\n+        MinionController.initRoutes(jade);\n \n         // Minions API\n-        post(\"/manager/api/systems/bootstrap\", withOrgAdmin(MinionsAPI::bootstrap));\n-        post(\"/manager/api/systems/bootstrap-ssh\", withOrgAdmin(MinionsAPI::bootstrapSSH));\n-        get(\"/manager/api/systems/keys\", withUser(MinionsAPI::listKeys));\n-        post(\"/manager/api/systems/keys/:target/accept\", withOrgAdmin(MinionsAPI::accept));\n-        post(\"/manager/api/systems/keys/:target/reject\", withOrgAdmin(MinionsAPI::reject));\n-        post(\"/manager/api/systems/keys/:target/delete\", withOrgAdmin(MinionsAPI::delete));\n-\n-        // States\n-        get(\"/manager/systems/details/packages\",\n-                withCsrfToken(MinionController::packageStates),\n-                jade);\n-        get(\"/manager/systems/details/custom\",\n-                withCsrfToken(MinionController::minionCustomStates),\n-                jade);\n-        get(\"/manager/systems/details/highstate\",\n-                withCsrfToken(withUser(MinionController::highstate)),\n-                jade);\n-        get(\"/manager/multiorg/details/custom\",\n-                withCsrfToken(MinionController::orgCustomStates),\n-                jade);\n-        get(\"/manager/yourorg/custom\",\n-                withCsrfToken(withUser(MinionController::yourOrgConfigChannels)),\n-                jade);\n-        get(\"/manager/groups/details/custom\",\n-                withCsrfToken(withUser(MinionController::serverGroupConfigChannels)),\n-                jade);\n-        get(\"/manager/groups/details/highstate\",\n-                withCsrfToken(withUser(MinionController::serverGroupHighstate)), jade);\n-\n-        // SSM API\n-        get(\"/manager/systems/ssm/highstate\",\n-                withCsrfToken(withUser(MinionController::ssmHighstate)), jade);\n-        get(\"/manager/systems/ssm/channels/bases\",\n-                withUser(SsmController::getBaseChannels));\n-        post(\"/manager/systems/ssm/channels/allowed-changes\",\n-                withUser(SsmController::computeAllowedChannelChanges));\n-        post(\"/manager/systems/ssm/channels\",\n-                withUser(SsmController::changeChannels));\n+        MinionsAPI.initRoutes();", "originalCommit": "15b2511596a9f963fb06cb612fe668d9128f69f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MDg3MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1819#discussion_r369980871", "bodyText": "Split that one into private functions", "author": "cbosdo", "createdAt": "2020-01-23T08:23:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQ2MDQ5NQ=="}], "type": "inlineReview"}, {"oid": "8a548d404aadc988f5f0b473be7330f88efed3c9", "url": "https://github.com/uyuni-project/uyuni/commit/8a548d404aadc988f5f0b473be7330f88efed3c9", "message": "Move all the routes initialization calls into the controllers\n\nIn order to make the Router class more readable, move all the route\ninitialization functions into the controller as it has already been\nstarted.", "committedDate": "2020-01-23T08:21:14Z", "type": "commit"}, {"oid": "8a548d404aadc988f5f0b473be7330f88efed3c9", "url": "https://github.com/uyuni-project/uyuni/commit/8a548d404aadc988f5f0b473be7330f88efed3c9", "message": "Move all the routes initialization calls into the controllers\n\nIn order to make the Router class more readable, move all the route\ninitialization functions into the controller as it has already been\nstarted.", "committedDate": "2020-01-23T08:21:14Z", "type": "forcePushed"}]}