{"pr_number": 2240, "pr_title": "copy logfiles from all nodes to the controller", "pr_createdAt": "2020-05-21T12:47:54Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2240", "timeline": [{"oid": "06f234ef469b04390b38ba7350038c1091f6500e", "url": "https://github.com/uyuni-project/uyuni/commit/06f234ef469b04390b38ba7350038c1091f6500e", "message": "copy logfiles from all nodes to the controller", "committedDate": "2020-05-21T12:46:25Z", "type": "commit"}, {"oid": "80d0b41c145a8ec0cdcb5784ab0b6131360c2bce", "url": "https://github.com/uyuni-project/uyuni/commit/80d0b41c145a8ec0cdcb5784ab0b6131360c2bce", "message": "create /var/log/messages from journalctl", "committedDate": "2020-05-21T13:08:56Z", "type": "commit"}, {"oid": "45cf96b5b461d08089323e7967992ae71c113b57", "url": "https://github.com/uyuni-project/uyuni/commit/45cf96b5b461d08089323e7967992ae71c113b57", "message": "file_extract does not work, use classic scp", "committedDate": "2020-05-21T13:27:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODY4NTY3NQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2240#discussion_r428685675", "bodyText": "Just curious: why is the echo needed?", "author": "juliogonzalez", "createdAt": "2020-05-21T14:26:38Z", "path": "testsuite/features/step_definitions/command_steps.rb", "diffHunk": "@@ -308,6 +308,17 @@\n   end\n end\n \n+Then(/^I get logfiles from \"([^\"]*)\"$/) do |target|\n+  `mkdir logs` unless Dir.exist?('logs')\n+  node = get_target(target)\n+  _out, code = node.run(\"journalctl > /var/log/messages\")\n+  _out, code = node.run(\"tar cfvJ /tmp/#{target}-logs.tar.xz /var/log/\")\n+  raise 'Generate log archive failed' unless code.zero?\n+  cmd = \"echo | scp -o StrictHostKeyChecking=no root@#{node.ip}:/tmp/#{target}-logs.tar.xz ./logs/ 2>&1\"", "originalCommit": "45cf96b5b461d08089323e7967992ae71c113b57", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}