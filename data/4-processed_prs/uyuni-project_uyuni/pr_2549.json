{"pr_number": 2549, "pr_title": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64, Issue #2548", "pr_createdAt": "2020-09-01T14:41:53Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2549", "timeline": [{"oid": "104092c35ac4dcd363aebf2f43d098a12be95eb9", "url": "https://github.com/uyuni-project/uyuni/commit/104092c35ac4dcd363aebf2f43d098a12be95eb9", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-01T15:16:41Z", "type": "forcePushed"}, {"oid": "9b0a583f27d5e2df0215eda178600edd1f0a6b16", "url": "https://github.com/uyuni-project/uyuni/commit/9b0a583f27d5e2df0215eda178600edd1f0a6b16", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-01T16:52:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMwOTkzNw==", "url": "https://github.com/uyuni-project/uyuni/pull/2549#discussion_r481309937", "bodyText": "I don't really understand, why do we need it commented?", "author": "juliogonzalez", "createdAt": "2020-09-01T17:23:11Z", "path": "schema/spacewalk/common/data/rhnPackageUpgradeArchCompat.sql", "diffHunk": "@@ -144,4 +144,9 @@ insert into rhnPackageUpgradeArchCompat (package_arch_id, package_upgrade_arch_i\n insert into rhnPackageUpgradeArchCompat (package_arch_id, package_upgrade_arch_id, created, modified) values (LOOKUP_PACKAGE_ARCH('amd64-deb'), LOOKUP_PACKAGE_ARCH('all-deb'), current_timestamp, current_timestamp);\n insert into rhnPackageUpgradeArchCompat (package_arch_id, package_upgrade_arch_id, created, modified) values (LOOKUP_PACKAGE_ARCH('amd64-deb'), LOOKUP_PACKAGE_ARCH('amd64-deb'), current_timestamp, current_timestamp);\n insert into rhnPackageUpgradeArchCompat (package_arch_id, package_upgrade_arch_id, created, modified) values (LOOKUP_PACKAGE_ARCH('all-deb'), LOOKUP_PACKAGE_ARCH('amd64-deb'), current_timestamp, current_timestamp);\n+insert into rhnPackageUpgradeArchCompat (package_arch_id, package_upgrade_arch_id, created, modified) values (LOOKUP_PACKAGE_ARCH('arm64-deb'), LOOKUP_PACKAGE_ARCH('all-deb'), current_timestamp, current_timestamp);\n+-- insert into rhnPackageUpgradeArchCompat (package_arch_id, package_upgrade_arch_id, created, modified) values (LOOKUP_PACKAGE_ARCH('arm64-deb'), LOOKUP_PACKAGE_ARCH('arm64-deb'), current_timestamp, current_timestamp);", "originalCommit": "9b0a583f27d5e2df0215eda178600edd1f0a6b16", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTg5MDY0OA==", "url": "https://github.com/uyuni-project/uyuni/pull/2549#discussion_r481890648", "bodyText": "09/02/2020:\nBug in schema/spacewalk/upgrade/susemanager-schema-4.2.0-to-susemanager-schema-4.2.1/120-arm64.sql  found:\nmissing apostroph in \"and package_upgrade_arch_id = LOOKUP_PACKAGE_ARCH(arm64-deb'));\"\nproblem fixed und new commit / force-push done;", "author": "Shirocco88", "createdAt": "2020-09-02T08:36:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMwOTkzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMxMDA5Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2549#discussion_r481310096", "bodyText": "Same: why do we need it commented?", "author": "juliogonzalez", "createdAt": "2020-09-01T17:23:27Z", "path": "schema/spacewalk/upgrade/susemanager-schema-4.2.0-to-susemanager-schema-4.2.1/120-arm64.sql", "diffHunk": "@@ -0,0 +1,96 @@\n+insert into rhnCpuArch (id, label, name) select\n+sequence_nextval('rhn_cpu_arch_id_seq'), 'arm64', 'ARM64' from dual\n+where not exists (select 1 from rhnCpuArch where label = 'arm64');\n+\n+\n+insert into rhnPackageArch (id, label, name, arch_type_id) select\n+sequence_nextval('rhn_package_arch_id_seq'), 'arm64-deb', 'ARM64-deb', lookup_arch_type('deb') from dual\n+where not exists (select 1 from rhnPackageArch where label = 'arm64-deb');\n+\n+\n+insert into rhnServerArch (id, label, name, arch_type_id) select\n+sequence_nextval('rhn_server_arch_id_seq'), 'arm64-debian-linux', 'ARM64 Debian', lookup_arch_type('deb') from dual\n+where not exists (select 1 from rhnServerArch where label = 'arm64-debian-linux');\n+\n+\n+insert into rhnChannelArch (id, label, name, arch_type_id) select\n+sequence_nextval('rhn_channel_arch_id_seq'), 'channel-arm64-deb', 'ARM64 Debian', lookup_arch_type('deb') from dual\n+where not exists (select 1 from rhnChannelArch where label = 'channel-arm64-deb');\n+\n+\n+insert into rhnPackageUpgradeArchCompat (package_arch_id, package_upgrade_arch_id, created, modified) select \n+LOOKUP_PACKAGE_ARCH('arm64-deb'), LOOKUP_PACKAGE_ARCH('all-deb'), current_timestamp, current_timestamp from dual\n+where not exists (select 1 from rhnPackageUpgradeArchCompat where package_arch_id = LOOKUP_PACKAGE_ARCH('arm64-deb') and package_upgrade_arch_id = LOOKUP_PACKAGE_ARCH('all-deb'));\n+\n+-- insert into rhnPackageUpgradeArchCompat (package_arch_id, package_upgrade_arch_id, created, modified) select ", "originalCommit": "9b0a583f27d5e2df0215eda178600edd1f0a6b16", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTM1MTg3NQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2549#discussion_r481351875", "bodyText": "EDIT 09/02/2020:\nBug found:    missing apostroph in \"and package_upgrade_arch_id = LOOKUP_PACKAGE_ARCH(arm64-deb'));\"\nfixed und commit / force-push done;", "author": "Shirocco88", "createdAt": "2020-09-01T18:38:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTMxMDA5Ng=="}], "type": "inlineReview"}, {"oid": "9b8add88e9886b9d0ac1f86720ed630da6999454", "url": "https://github.com/uyuni-project/uyuni/commit/9b8add88e9886b9d0ac1f86720ed630da6999454", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-01T19:05:41Z", "type": "forcePushed"}, {"oid": "33435eaffb82567e2f5da82205e0452d9397d7ce", "url": "https://github.com/uyuni-project/uyuni/commit/33435eaffb82567e2f5da82205e0452d9397d7ce", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-02T08:26:25Z", "type": "forcePushed"}, {"oid": "63671977bf63790bc66917646f43cec741745fe8", "url": "https://github.com/uyuni-project/uyuni/commit/63671977bf63790bc66917646f43cec741745fe8", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-21T11:52:09Z", "type": "forcePushed"}, {"oid": "944d9536783fdb8efb2caa9c45fa9ae279abb9fa", "url": "https://github.com/uyuni-project/uyuni/commit/944d9536783fdb8efb2caa9c45fa9ae279abb9fa", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-21T12:03:39Z", "type": "forcePushed"}, {"oid": "8a5e0138d4fca49850ddc254bf06bc458ba69f67", "url": "https://github.com/uyuni-project/uyuni/commit/8a5e0138d4fca49850ddc254bf06bc458ba69f67", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-21T12:46:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE1MzM3OA==", "url": "https://github.com/uyuni-project/uyuni/pull/2549#discussion_r492153378", "bodyText": "No, this is not right.\nJust add your entry after on top of the file, then an empty line.\nThe headers and the version change are added by the Release Engineer (me, in this case) with tito tag.", "author": "juliogonzalez", "createdAt": "2020-09-21T15:29:36Z", "path": "schema/spacewalk/susemanager-schema.changes", "diffHunk": "@@ -1,4 +1,9 @@\n -------------------------------------------------------------------\n+Mon Sep 21 14:00:22 CEST 2020 - shirocco88\n+\n+- version 4.2.1-2\n+- Schema upgrade for Debian with ARM64v8+ (cpuach=aarch64, cpuarch=arm64) architecture", "originalCommit": "8a5e0138d4fca49850ddc254bf06bc458ba69f67", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE1NDA5MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2549#discussion_r492154090", "bodyText": "Or in other words, you just need:\n- Schema upgrade for Debian with ARM64v8+ (cpuach=aarch64, cpuarch=arm64) architecture\n\n\nOn top of what the file already has on master.", "author": "juliogonzalez", "createdAt": "2020-09-21T15:30:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE1MzM3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE5OTY3OQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2549#discussion_r492199679", "bodyText": "Perfect!", "author": "juliogonzalez", "createdAt": "2020-09-21T16:39:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjE1MzM3OA=="}], "type": "inlineReview"}, {"oid": "91cd02c873c4ebc76103f3b0ad1d119df07425bd", "url": "https://github.com/uyuni-project/uyuni/commit/91cd02c873c4ebc76103f3b0ad1d119df07425bd", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-21T16:12:31Z", "type": "commit"}, {"oid": "91cd02c873c4ebc76103f3b0ad1d119df07425bd", "url": "https://github.com/uyuni-project/uyuni/commit/91cd02c873c4ebc76103f3b0ad1d119df07425bd", "message": "DB schema extension for Debian10-Minions on cpuarch=aarch64,osarch=arm64", "committedDate": "2020-09-21T16:12:31Z", "type": "forcePushed"}]}