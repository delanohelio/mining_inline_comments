{"pr_number": 1817, "pr_title": "Testsuite: Re-add min_bootstrap_negative", "pr_createdAt": "2020-01-21T13:03:28Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/1817", "timeline": [{"oid": "5c380221b368898948790343c277dfe8624b8254", "url": "https://github.com/uyuni-project/uyuni/commit/5c380221b368898948790343c277dfe8624b8254", "message": "Testsuite: Add missing cleanup scenario\n\n* testsuite/features/secondary/min_bootstrap_negative.feature:\nTag with @sle_minion this feature.\n\nAfter bootstrap the minion, wait until the minion is listed at\nSystems overview.\n\nAdd cleanup scenario:\n'Cleanup: subscribe again to base channel after negative tests'\n\n* testsuite/run_sets/secondary_parallelizable.yml:\nRe-add min_bootstrap_negative.feature.", "committedDate": "2020-01-21T12:54:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAyOTUzMQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1817#discussion_r369029531", "bodyText": "Personally, I'd prefer to use a UI step instead of providing a url endpoint here. Just because for me the tests must be near as possible as what a customer will do, meaning clicking options in the UI. But it might just be a matter of taste.", "author": "srbarrios", "createdAt": "2020-01-21T14:24:28Z", "path": "testsuite/features/secondary/min_bootstrap_negative.feature", "diffHunk": "@@ -67,6 +68,21 @@ Feature: Negative tests for bootstrap normal minions\n      And I select the hostname of \"proxy\" from \"proxies\"\n      And I click on \"Bootstrap\"\n      And I wait until I see \"Successfully bootstrapped host!\" text\n+     And I navigate to \"rhn/systems/Overview.do\" page", "originalCommit": "5c380221b368898948790343c277dfe8624b8254", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAzMzk3Nw==", "url": "https://github.com/uyuni-project/uyuni/pull/1817#discussion_r369033977", "bodyText": "Right. It's not a matter of taste, but a generic rule: do not depend on internals.\nI think we should even remove the I navigate to step definition.\nBut this is probably for another PR. This should be addressed globally. Maybe create a card so it does not get lost.", "author": "Bischoff", "createdAt": "2020-01-21T14:32:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAyOTUzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA1MTI3MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1817#discussion_r369051271", "bodyText": "Oki. Anyway, my suggestion here is to just use that step instead:\nWhen I follow the left menu \"Home > Overview\"\n\nWe can do it in a future PR :)", "author": "srbarrios", "createdAt": "2020-01-21T14:59:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAyOTUzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAzNDc2NA==", "url": "https://github.com/uyuni-project/uyuni/pull/1817#discussion_r369034764", "bodyText": "Beware that sometimes this is not even enough, and you should wait for events like package list refresh to finish.", "author": "Bischoff", "createdAt": "2020-01-21T14:33:22Z", "path": "testsuite/features/secondary/min_bootstrap_negative.feature", "diffHunk": "@@ -67,6 +68,21 @@ Feature: Negative tests for bootstrap normal minions\n      And I select the hostname of \"proxy\" from \"proxies\"\n      And I click on \"Bootstrap\"\n      And I wait until I see \"Successfully bootstrapped host!\" text\n+     And I navigate to \"rhn/systems/Overview.do\" page\n+     And I wait until I see the name of \"sle_minion\", refreshing the page", "originalCommit": "5c380221b368898948790343c277dfe8624b8254", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAzNDkyMw==", "url": "https://github.com/uyuni-project/uyuni/pull/1817#discussion_r369034923", "bodyText": "Thanks.", "author": "Bischoff", "createdAt": "2020-01-21T14:33:39Z", "path": "testsuite/features/secondary/min_bootstrap_negative.feature", "diffHunk": "@@ -67,6 +68,21 @@ Feature: Negative tests for bootstrap normal minions\n      And I select the hostname of \"proxy\" from \"proxies\"\n      And I click on \"Bootstrap\"\n      And I wait until I see \"Successfully bootstrapped host!\" text\n+     And I navigate to \"rhn/systems/Overview.do\" page\n+     And I wait until I see the name of \"sle_minion\", refreshing the page\n+\n+  Scenario: Cleanup: subscribe again to base channel after negative tests\n+    Given I am on the Systems overview page of this \"sle_minion\"\n+    When I follow \"Software\" in the content area\n+    And I follow \"Software Channels\" in the content area\n+    And I wait until I do not see \"Loading...\" text\n+    And I check radio button \"Test-Channel-x86_64\"\n+    And I wait until I do not see \"Loading...\" text\n+    And I click on \"Next\"\n+    Then I should see a \"Confirm Software Channel Change\" text\n+    When I click on \"Confirm\"\n+    Then I should see a \"Changing the channels has been scheduled.\" text\n+    And I wait until event \"Subscribe channels scheduled by admin\" is completed", "originalCommit": "5c380221b368898948790343c277dfe8624b8254", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}