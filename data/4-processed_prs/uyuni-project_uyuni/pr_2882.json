{"pr_number": 2882, "pr_title": "mgr-setup: Added RHEL/CentOS compatibility.", "pr_createdAt": "2020-11-21T11:51:58Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2882", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIwMDkyNA==", "url": "https://github.com/uyuni-project/uyuni/pull/2882#discussion_r528200924", "bodyText": "Please add here also a check for not SUSE.\nOn SUSE systems this happens when starting the DB in the systemd start script (systemctl start postgresql).\nYou can check via /etc/os-release that ID_LIKE contains \"suse\":\nif [ -e /etc/os-release ]; then\n   . /etc/os-release\n   if [[ \"$ID_LIKE\" = *\"suse\"* ]]; then\n      echo \"Do something for any SUSE/openSUSE distro\"\n   fi\nfi", "author": "mcalmer", "createdAt": "2020-11-21T14:14:15Z", "path": "susemanager/bin/mgr-setup", "diffHunk": "@@ -181,7 +182,17 @@ cleanup_hostname() {\n }\n \n setup_db_postgres() {\n+    DATADIR=\"/var/lib/pgsql/data\" \n     systemctl --quiet enable postgresql 2>&1\n+    # Create the PostgreSQL data folder, should it not exist.\n+    if [ ! -f $DATADIR/PG_VERSION ]; then", "originalCommit": "04df52be6258389ec290de9d768fd249dda32bc7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIxMTQyNw==", "url": "https://github.com/uyuni-project/uyuni/pull/2882#discussion_r528211427", "bodyText": "I had two thoughts for not making this distro dependent:\n\nThe folder would already exist for SUSE. Or is postgresql service started only AFTER mgr-setup?\nIt is the same code as in postgresql.service. This is where I got it from. So it wouldn't make a difference what creates it.\n\nOverall adding the distro check shouldn't be more than 2 lines (if/fi) as it is already done at the top of mgr-setup for Java.", "author": "sbluhm", "createdAt": "2020-11-21T15:58:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIwMDkyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIzODk4MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2882#discussion_r528238980", "bodyText": "I have made the change in my branch and tested it. If you still insist, let me know and I will push it.", "author": "sbluhm", "createdAt": "2020-11-21T20:26:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIwMDkyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODU4NzI0MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2882#discussion_r528587241", "bodyText": "The folder would already exist for SUSE. Or is postgresql service started only AFTER mgr-setup?\n\n\nI think mgr-setup start postgresql the first time.\n\n\nIt is the same code as in postgresql.service. This is where I got it from. So it wouldn't make a difference what creates it.\n\n\nYes, but I fear times when something must be changed in the init process and we do not get the info about it.\nAnd the init code here on my system looks already a bit different then the one in this PR.\nEspecially exporting the correct environment is important. We had in the past a lot of fun with it.\nIf you don't mind I would like to use the initialization provided by the OS vendor.", "author": "mcalmer", "createdAt": "2020-11-23T10:02:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIwMDkyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODYxMjIwNA==", "url": "https://github.com/uyuni-project/uyuni/pull/2882#discussion_r528612204", "bodyText": "Pushed.", "author": "sbluhm", "createdAt": "2020-11-23T10:44:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODIwMDkyNA=="}], "type": "inlineReview"}, {"oid": "e4d8cd2cf3c84673b731b5ddb41f174d74d8cbac", "url": "https://github.com/uyuni-project/uyuni/commit/e4d8cd2cf3c84673b731b5ddb41f174d74d8cbac", "message": "Added RHEL/CentOS compatibility.", "committedDate": "2020-11-23T10:36:00Z", "type": "commit"}, {"oid": "e4d8cd2cf3c84673b731b5ddb41f174d74d8cbac", "url": "https://github.com/uyuni-project/uyuni/commit/e4d8cd2cf3c84673b731b5ddb41f174d74d8cbac", "message": "Added RHEL/CentOS compatibility.", "committedDate": "2020-11-23T10:36:00Z", "type": "forcePushed"}, {"oid": "24bf35d3053f5448a81f3c2ee1a5be11e75f85cc", "url": "https://github.com/uyuni-project/uyuni/commit/24bf35d3053f5448a81f3c2ee1a5be11e75f85cc", "message": "Merge branch 'master' into sbluhm-mgr-setup", "committedDate": "2020-11-25T16:59:42Z", "type": "commit"}]}