{"pr_number": 1933, "pr_title": "Testsuite: Workaround for spacewalk #9165", "pr_createdAt": "2020-02-20T08:49:54Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/1933", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3MDMzNQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1933#discussion_r381870335", "bodyText": "When", "author": "Bischoff", "createdAt": "2020-02-20T09:14:48Z", "path": "testsuite/features/core/proxy_register_as_minion_with_script.feature", "diffHunk": "@@ -22,9 +22,9 @@ Feature: Setup SUSE Manager proxy\n @proxy\n   Scenario: Accept the key for the proxy\n     Given I am authorized as \"testing\" with password \"testing\"\n-    When I go to the minion onboarding page\n-    Then I should see a \"pending\" text\n-    When I accept \"proxy\" key\n+    And I go to the minion onboarding page", "originalCommit": "f1a342066d839500f603a16679054856ad9717ba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3ODkyNw==", "url": "https://github.com/uyuni-project/uyuni/pull/1933#discussion_r381878927", "bodyText": "Do you mean all of them to start with when, like this:\n    Given I am authorized as \"testing\" with password \"testing\"\n    When I go to the minion onboarding page\n    When I wait until I see \"pending\" text, refreshing the page\n    When I accept \"proxy\" key\n\nOr you want instead I change just the last And with When?", "author": "calancha", "createdAt": "2020-02-20T09:29:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3MDMzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg4OTI2MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1933#discussion_r381889261", "bodyText": "Do you mean all of them to start with when, like this:\n    Given I am authorized as \"testing\" with password \"testing\"\n    When I go to the minion onboarding page\n    When I wait until I see \"pending\" text, refreshing the page\n    When I accept \"proxy\" key\n\nOr you want instead I change just the last And with When?\n\nPlease change just first \"And\" into \"When\". The following \"And\"s stay.\nGiven\nWhen\nAnd\nAnd", "author": "Bischoff", "createdAt": "2020-02-20T09:47:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3MDMzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3MDkzNA==", "url": "https://github.com/uyuni-project/uyuni/pull/1933#discussion_r381870934", "bodyText": "ok, nice, thanks", "author": "Bischoff", "createdAt": "2020-02-20T09:15:55Z", "path": "testsuite/features/step_definitions/command_steps.rb", "diffHunk": "@@ -834,7 +834,14 @@\n   filename = File.basename(path)\n   cmd = \"configure-proxy.sh --non-interactive --rhn-user=admin --rhn-password=admin --answer-file=#{filename}\"\n   proxy_timeout = 600\n-  $proxy.run(cmd, true, proxy_timeout, 'root')\n+  return_code = 0\n+  # Workaround issue https://github.com/SUSE/spacewalk/issues/9165\n+  begin\n+    return_code = $proxy.run(cmd, true, proxy_timeout, 'root')\n+  rescue StandardError => e\n+    puts \"Catched exception (see bsc#1138952): #{e}\"", "originalCommit": "f1a342066d839500f603a16679054856ad9717ba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg5MDAzOQ==", "url": "https://github.com/uyuni-project/uyuni/pull/1933#discussion_r381890039", "bodyText": "It could be a good idea to tag this with the following comment:\n# WORKAROUND bsc#1138952", "author": "Bischoff", "createdAt": "2020-02-20T09:49:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3MDkzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3MTI1Mg==", "url": "https://github.com/uyuni-project/uyuni/pull/1933#discussion_r381871252", "bodyText": "Finally... :-)", "author": "Bischoff", "createdAt": "2020-02-20T09:16:30Z", "path": "testsuite/run_sets/core.yml", "diffHunk": "@@ -23,7 +23,7 @@\n   # one of: proxy_register_as_trad_with_script.feature\n   #         proxy_register_as_minion_with_script.feature\n   #         proxy_register_as_minion_with_gui.feature\n-- features/core/proxy_register_as_minion_with_gui.feature\n+- features/core/proxy_register_as_minion_with_script.feature", "originalCommit": "f1a342066d839500f603a16679054856ad9717ba", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b7f1fe3f5159be7ea1d7d053b519e4d2fcc375ab", "url": "https://github.com/uyuni-project/uyuni/commit/b7f1fe3f5159be7ea1d7d053b519e4d2fcc375ab", "message": "Testsuite: Workaround for spacewalk #9165\n\nRelated with bsc#1138952\n(see https://github.com/SUSE/spacewalk/issues/9165)\n\n- testsuite/features/step_definitions/command_steps.rb\n  Catch the exception.\n\n- testsuite/run_sets/core.yml: Setup the proxy with the script.\n  This is significantly faster that using the GUI; it also\n  increases the test coverage.", "committedDate": "2020-02-20T10:31:00Z", "type": "commit"}, {"oid": "b7f1fe3f5159be7ea1d7d053b519e4d2fcc375ab", "url": "https://github.com/uyuni-project/uyuni/commit/b7f1fe3f5159be7ea1d7d053b519e4d2fcc375ab", "message": "Testsuite: Workaround for spacewalk #9165\n\nRelated with bsc#1138952\n(see https://github.com/SUSE/spacewalk/issues/9165)\n\n- testsuite/features/step_definitions/command_steps.rb\n  Catch the exception.\n\n- testsuite/run_sets/core.yml: Setup the proxy with the script.\n  This is significantly faster that using the GUI; it also\n  increases the test coverage.", "committedDate": "2020-02-20T10:31:00Z", "type": "forcePushed"}]}