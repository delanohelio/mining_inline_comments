{"pr_number": 2004, "pr_title": "Refactor notifications", "pr_createdAt": "2020-03-11T15:18:52Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2004", "timeline": [{"oid": "40befc1467f8f15c8316c626179aa0d7f44914b2", "url": "https://github.com/uyuni-project/uyuni/commit/40befc1467f8f15c8316c626179aa0d7f44914b2", "message": "change notification data type to TEXT", "committedDate": "2020-03-13T12:16:47Z", "type": "forcePushed"}, {"oid": "28e8e57d343bc4e4f6b19be2446086d8a42c1c96", "url": "https://github.com/uyuni-project/uyuni/commit/28e8e57d343bc4e4f6b19be2446086d8a42c1c96", "message": "generate text description from description", "committedDate": "2020-03-14T14:46:30Z", "type": "forcePushed"}, {"oid": "886dd785e6e1c860c6de1a3c7794e427d9c065bc", "url": "https://github.com/uyuni-project/uyuni/commit/886dd785e6e1c860c6de1a3c7794e427d9c065bc", "message": "update changelog", "committedDate": "2020-03-15T13:29:30Z", "type": "forcePushed"}, {"oid": "a60dc9284b69227b78087712703f011c6d92ed52", "url": "https://github.com/uyuni-project/uyuni/commit/a60dc9284b69227b78087712703f011c6d92ed52", "message": "UI Notifications: Minor improvements: Change message description to Optional", "committedDate": "2020-03-20T13:02:15Z", "type": "forcePushed"}, {"oid": "82cfa0c565fc87f072a2e1f611665f270cbe9ee8", "url": "https://github.com/uyuni-project/uyuni/commit/82cfa0c565fc87f072a2e1f611665f270cbe9ee8", "message": "move schema migration", "committedDate": "2020-03-20T15:35:05Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkyNzEyMw==", "url": "https://github.com/uyuni-project/uyuni/pull/2004#discussion_r395927123", "bodyText": "Is this link going to be always visible? Maybe, depending on the type of the message, if the description field does not deliver any additional value to the summary maybe we can hide it. I wonder if it could be the case to already define this on the backend side, leaving the description field null or String.empty and we can decode it on the frontend side. Just my 2c", "author": "ncounter", "createdAt": "2020-03-20T23:09:55Z", "path": "web/html/src/manager/notifications/notification-messages.js", "diffHunk": "@@ -222,23 +218,33 @@ class NotificationMessages extends React.Component {\n     return Object.keys(message).map((id) => message[id]);\n   };\n \n-  buildDescription = (row) => {\n-    let description = null;\n-    switch(row['type']) {\n-      case 'OnboardingFailed':\n-        description = 'Error registering minion id: ' + row['data']['minionId'];\n-      break;\n-      case 'ChannelSyncFailed':\n-        description = <span>Error syncing the channel: <a href={\"/rhn/channels/ChannelDetail.do?cid=\" + row['data']['channelId']}>{row['data']['channelName']}</a></span>;\n-      break;\n-      case 'ChannelSyncFinished':\n-        description = <span>Channel <a href={\"/rhn/channels/ChannelDetail.do?cid=\" + row['data']['channelId']}>{row['data']['channelName']}</a> sync completed</span>;\n-      break;\n-      default: description = JSON.stringify(row['data']);\n-    }\n-    return description;\n+  showDescriptionPopup = (row) => {\n+    this.setState({popupItem: row});\n+    showDialog(\"notifications-popup-dialog\");\n+  }\n+\n+  buildSummary = (row) => {\n+    const popupLink = <a href=\"#\" onClick={() => this.showDescriptionPopup(row)}>{t(\"Details\")}</a>;", "originalCommit": "82cfa0c565fc87f072a2e1f611665f270cbe9ee8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjMxMzY2Mw==", "url": "https://github.com/uyuni-project/uyuni/pull/2004#discussion_r396313663", "bodyText": "We already do that in backend. If the description is absent, frontend receives undefined value. And the logic on line 233 \"hides\" the link (this happens on all \"falsy\" values: null, undefined, empty string, ...).", "author": "hustodemon", "createdAt": "2020-03-23T09:30:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkyNzEyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQzNjQ1OQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2004#discussion_r396436459", "bodyText": "Ups, thanks for clarifying it. I probably overlooked the logic, sorry for the noise. \ud83d\udc4d", "author": "ncounter", "createdAt": "2020-03-23T13:08:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkyNzEyMw=="}], "type": "inlineReview"}, {"oid": "fc6f096076a99ad5af8d9a7c537f5cc4df38f601", "url": "https://github.com/uyuni-project/uyuni/commit/fc6f096076a99ad5af8d9a7c537f5cc4df38f601", "message": "Frontend: rename description into details", "committedDate": "2020-03-23T13:36:20Z", "type": "forcePushed"}, {"oid": "acc2e5fd4f9a62f3f584454519f85ce2b56c968b", "url": "https://github.com/uyuni-project/uyuni/commit/acc2e5fd4f9a62f3f584454519f85ce2b56c968b", "message": "indenting", "committedDate": "2020-03-23T13:38:02Z", "type": "commit"}, {"oid": "3fa66ba1cc59ae8640b10099926dfcb9fb1e89d8", "url": "https://github.com/uyuni-project/uyuni/commit/3fa66ba1cc59ae8640b10099926dfcb9fb1e89d8", "message": "provide summary and description from java to UI", "committedDate": "2020-03-23T13:54:14Z", "type": "commit"}, {"oid": "a829e3767bcffe3ff3dd90e3bc1658898b15e8e2", "url": "https://github.com/uyuni-project/uyuni/commit/a829e3767bcffe3ff3dd90e3bc1658898b15e8e2", "message": "copyright year", "committedDate": "2020-03-23T13:54:15Z", "type": "commit"}, {"oid": "a4f655eddd98fd34bc5dd4e6c102eda25cb9d51b", "url": "https://github.com/uyuni-project/uyuni/commit/a4f655eddd98fd34bc5dd4e6c102eda25cb9d51b", "message": "create CreateBootstrapRepoFailed notification type", "committedDate": "2020-03-23T13:54:15Z", "type": "commit"}, {"oid": "a6f0f0326be9e05ead6e6b602bb75abe5b15e9b5", "url": "https://github.com/uyuni-project/uyuni/commit/a6f0f0326be9e05ead6e6b602bb75abe5b15e9b5", "message": "Frontend: rename description into details", "committedDate": "2020-03-23T13:54:18Z", "type": "forcePushed"}, {"oid": "a81e88e743dd86667348f223bb196c07c8eb7c51", "url": "https://github.com/uyuni-project/uyuni/commit/a81e88e743dd86667348f223bb196c07c8eb7c51", "message": "store notifications from python", "committedDate": "2020-03-23T13:59:49Z", "type": "commit"}, {"oid": "90e7b85395b4048b05aa0658296cb88b6a3e8815", "url": "https://github.com/uyuni-project/uyuni/commit/90e7b85395b4048b05aa0658296cb88b6a3e8815", "message": "change notification data type to TEXT", "committedDate": "2020-03-23T13:59:49Z", "type": "commit"}, {"oid": "59438d6e1d02215f8248a6f9a16f9fb9425a8ac9", "url": "https://github.com/uyuni-project/uyuni/commit/59438d6e1d02215f8248a6f9a16f9fb9425a8ac9", "message": "add new type to message", "committedDate": "2020-03-23T13:59:50Z", "type": "commit"}, {"oid": "b748b29297e31fae631d8730b9cb6b353b5b35a3", "url": "https://github.com/uyuni-project/uyuni/commit/b748b29297e31fae631d8730b9cb6b353b5b35a3", "message": "add notification for failed State Apply", "committedDate": "2020-03-23T13:59:50Z", "type": "commit"}, {"oid": "916519c8adc965e518587ae2339ec60370b4446d", "url": "https://github.com/uyuni-project/uyuni/commit/916519c8adc965e518587ae2339ec60370b4446d", "message": "add strings", "committedDate": "2020-03-23T13:59:50Z", "type": "commit"}, {"oid": "c7bcfb984ca590220553487752b15cda5a5c7485", "url": "https://github.com/uyuni-project/uyuni/commit/c7bcfb984ca590220553487752b15cda5a5c7485", "message": "disable ChannelSyncFinished and list new notification types", "committedDate": "2020-03-23T13:59:50Z", "type": "commit"}, {"oid": "e8eb45bfe7310ba3f67495d9b42ec4e189c1cdf5", "url": "https://github.com/uyuni-project/uyuni/commit/e8eb45bfe7310ba3f67495d9b42ec4e189c1cdf5", "message": "put strings into localized format strings to prevent number formating", "committedDate": "2020-03-23T13:59:50Z", "type": "commit"}, {"oid": "ecebbcbcc3f142b52bdc404312d53a2d6a8dfb39", "url": "https://github.com/uyuni-project/uyuni/commit/ecebbcbcc3f142b52bdc404312d53a2d6a8dfb39", "message": "remove textSummary - not needed anymore", "committedDate": "2020-03-23T13:59:51Z", "type": "commit"}, {"oid": "3d370c2ee72a0eed5379702ca144021f0bca9556", "url": "https://github.com/uyuni-project/uyuni/commit/3d370c2ee72a0eed5379702ca144021f0bca9556", "message": "generate text description from description", "committedDate": "2020-03-23T13:59:51Z", "type": "commit"}, {"oid": "f79b3a505eeb5713884fcde1a34b387a1b6d8009", "url": "https://github.com/uyuni-project/uyuni/commit/f79b3a505eeb5713884fcde1a34b387a1b6d8009", "message": "update changelog", "committedDate": "2020-03-23T13:59:51Z", "type": "commit"}, {"oid": "77bd3042b26202eaf672f49bd4a57c7e2f73b9b7", "url": "https://github.com/uyuni-project/uyuni/commit/77bd3042b26202eaf672f49bd4a57c7e2f73b9b7", "message": "UI Notifications: Add 'description' field to the notification JSON", "committedDate": "2020-03-23T13:59:51Z", "type": "commit"}, {"oid": "cdaef943fa5af0e66b5f300f139b214177d35153", "url": "https://github.com/uyuni-project/uyuni/commit/cdaef943fa5af0e66b5f300f139b214177d35153", "message": "UI Notifications: Refactor: Rename description to summary", "committedDate": "2020-03-23T13:59:52Z", "type": "commit"}, {"oid": "c772c5d141d932683ea9cebb7760ec5aef06cfba", "url": "https://github.com/uyuni-project/uyuni/commit/c772c5d141d932683ea9cebb7760ec5aef06cfba", "message": "UI Notifications: Show notification 'description' in a popup", "committedDate": "2020-03-23T13:59:52Z", "type": "commit"}, {"oid": "43a124e56a0a48450492af372a53116643701e0e", "url": "https://github.com/uyuni-project/uyuni/commit/43a124e56a0a48450492af372a53116643701e0e", "message": "move schema migration", "committedDate": "2020-03-23T13:59:52Z", "type": "commit"}, {"oid": "c1aa482fdf4771a14d5a974b2075b714a1e9c2d8", "url": "https://github.com/uyuni-project/uyuni/commit/c1aa482fdf4771a14d5a974b2075b714a1e9c2d8", "message": "UI Notifications: Wrap the details link in the brackets", "committedDate": "2020-03-23T13:59:52Z", "type": "commit"}, {"oid": "98d3096064dfd818539359d9154939066009b413", "url": "https://github.com/uyuni-project/uyuni/commit/98d3096064dfd818539359d9154939066009b413", "message": "Backend: rename description into details", "committedDate": "2020-03-23T13:59:52Z", "type": "commit"}, {"oid": "aff1c94fb87cc9c0bd22248431b74281f43688ff", "url": "https://github.com/uyuni-project/uyuni/commit/aff1c94fb87cc9c0bd22248431b74281f43688ff", "message": "Frontend: rename description into details", "committedDate": "2020-03-23T13:59:52Z", "type": "commit"}, {"oid": "aff1c94fb87cc9c0bd22248431b74281f43688ff", "url": "https://github.com/uyuni-project/uyuni/commit/aff1c94fb87cc9c0bd22248431b74281f43688ff", "message": "Frontend: rename description into details", "committedDate": "2020-03-23T13:59:52Z", "type": "forcePushed"}]}