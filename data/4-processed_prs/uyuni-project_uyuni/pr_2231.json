{"pr_number": 2231, "pr_title": "Uyuni master ubuntu shows removed pkgs", "pr_createdAt": "2020-05-19T07:47:51Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2231", "timeline": [{"oid": "d400f218ff586b6fece5de8acff7e1079c017892", "url": "https://github.com/uyuni-project/uyuni/commit/d400f218ff586b6fece5de8acff7e1079c017892", "message": "Fix for bsc#1171461 - Ubuntu shows removed packages\n\nSince we status was excluded from the pkg information, everything was deemed\nto be installed. This changes once 'status' is included again.", "committedDate": "2020-05-18T18:44:40Z", "type": "commit"}, {"oid": "c12130106a04a971db95e4d3ea2d32f6ff3d9086", "url": "https://github.com/uyuni-project/uyuni/commit/c12130106a04a971db95e4d3ea2d32f6ff3d9086", "message": "Adds changelog entrywq", "committedDate": "2020-05-19T07:52:49Z", "type": "commit"}, {"oid": "c12130106a04a971db95e4d3ea2d32f6ff3d9086", "url": "https://github.com/uyuni-project/uyuni/commit/c12130106a04a971db95e4d3ea2d32f6ff3d9086", "message": "Adds changelog entrywq", "committedDate": "2020-05-19T07:52:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE2MDgxMw==", "url": "https://github.com/uyuni-project/uyuni/pull/2231#discussion_r427160813", "bodyText": "Hmm... I don't really understand this change. The pkg.info_installed method should always only return installed packages (regardless the attr argument).\nThe attr argument only affects to the format of the output, but the list of packages should always be the same (only installed packages).\nIn case pkg.info_installed is reporting uninstalled packages on Ubuntu/Debian, I would expect a fix on the Salt module but not here.\nAm I missing something here?", "author": "meaksh", "createdAt": "2020-05-19T09:27:54Z", "path": "susemanager-utils/susemanager-sls/salt/packages/profileupdate.sls", "diffHunk": "@@ -2,7 +2,7 @@ packages:\n   module.run:\n     - name: pkg.info_installed\n     - kwargs: {\n-          attr: 'arch,epoch,version,release,install_date_time_t',\n+          attr: 'status,arch,epoch,version,release,install_date_time_t',", "originalCommit": "c12130106a04a971db95e4d3ea2d32f6ff3d9086", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE2Mzg5Mg==", "url": "https://github.com/uyuni-project/uyuni/pull/2231#discussion_r427163892", "bodyText": "You are right. info_installed should return only installed packages. But since attr is just passed to lowpkg.info, we are not getting status at all. And then this piece of code really shines: pkg_nfo.get('status', 'ii'). So if there is no status we just assume that it's installed. That's why this is just the quick fix and this will be the proper fix.", "author": "brejoc", "createdAt": "2020-05-19T09:32:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE2MDgxMw=="}], "type": "inlineReview"}]}