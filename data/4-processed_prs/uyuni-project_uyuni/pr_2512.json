{"pr_number": 2512, "pr_title": "Cucumber tests installer updates", "pr_createdAt": "2020-08-23T14:24:39Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2512", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIyNjAyMg==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r475226022", "bodyText": "We sync only 15 GA, but only tftpboot-installation for SP2 can be installed easily.\nBut this will not work for uyuni.\nShould we include a fix RPM in sumaform which can be used with uyuni and suma independent of the version?", "author": "mcalmer", "createdAt": "2020-08-23T14:27:17Z", "path": "testsuite/features/secondary/srv_distro_cobbler.feature", "diffHunk": "@@ -20,6 +20,20 @@ Feature: Cobbler and distribution autoinstallation\n     Then I should see a \"testprofile\" text\n     And I should see a \"testdistro\" text\n \n+  Scenario: Create SUSE Distibution with installer updates\n+    When I install package \"tftpboot-installation-SLE-15-SP2-x86_64\" on this \"server\"\n+    And I follow the left menu \"Systems > Autoinstallation > Distributions\"\n+    And I follow \"Create Distribution\"\n+    When I enter \"SLE-15-SP2-x86_64\" as \"label\"\n+    And I enter \"/usr/share/tftpboot-installation/SLE-15-SP2-x86_64/\" as \"basepath\"\n+    And I select \"SLE-Product-SLES15-Pool for x86_64\" from \"channelid\"", "originalCommit": "88d8e1c9602f8d08b5e6f66ebb2ae7a91b09c168", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzExNjM0Mw==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r477116343", "bodyText": "Using now existing SLE11 fake media to create this distro. It cannot be used, but it let us test the feature.", "author": "mcalmer", "createdAt": "2020-08-26T08:12:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIyNjAyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMzMzI1MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r476333251", "bodyText": "The feature is a feature of SUSE manager.\nChange to Installer update repositories please.", "author": "Bischoff", "createdAt": "2020-08-25T10:05:34Z", "path": "testsuite/features/reposync/srv_check_installer_updates.feature", "diffHunk": "@@ -0,0 +1,13 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Check Installer Update repositories", "originalCommit": "88d8e1c9602f8d08b5e6f66ebb2ae7a91b09c168", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMzMzg1NA==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r476333854", "bodyText": "Same reason, remove \"check\".\nWhen I add the product\nI want the installer update channels to be synched", "author": "Bischoff", "createdAt": "2020-08-25T10:06:44Z", "path": "testsuite/features/reposync/srv_check_installer_updates.feature", "diffHunk": "@@ -0,0 +1,13 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Check Installer Update repositories\n+  In order to use installer updates\n+  As root user\n+  I want to check that Installer-Updates Channels got synced when adding the product", "originalCommit": "88d8e1c9602f8d08b5e6f66ebb2ae7a91b09c168", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzA5MDQ5Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r477090496", "bodyText": "I do not get this. The test just verify that the installer update repo got synced.\nThe product is not added here.\nI could understand to move the test into the feature where also the sync happens, but here we really just check that\nthe repositories got enabled.", "author": "mcalmer", "createdAt": "2020-08-26T07:27:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMzMzg1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTE0ODA1Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r479148056", "bodyText": "It's only about labeling. A \"cucumber feature\" refers to a feature of the product (SUSE manager). It's not a \"test feature\". Just avoid the obvious \"check\", \"verify\", \"test\" and say what the product is supposed to do.", "author": "Bischoff", "createdAt": "2020-08-28T11:16:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMzMzg1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMzNDExMQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r476334111", "bodyText": "Same, no Check word", "author": "Bischoff", "createdAt": "2020-08-25T10:07:12Z", "path": "testsuite/features/reposync/srv_check_installer_updates.feature", "diffHunk": "@@ -0,0 +1,13 @@\n+# Copyright (c) 2020 SUSE LLC\n+# Licensed under the terms of the MIT license.\n+\n+Feature: Check Installer Update repositories\n+  In order to use installer updates\n+  As root user\n+  I want to check that Installer-Updates Channels got synced when adding the product\n+\n+@scc_credentials\n+  Scenario: Check installer updates channels got enabled during add product", "originalCommit": "88d8e1c9602f8d08b5e6f66ebb2ae7a91b09c168", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMzNDMyNA==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r476334324", "bodyText": "And", "author": "Bischoff", "createdAt": "2020-08-25T10:07:35Z", "path": "testsuite/features/secondary/srv_distro_cobbler.feature", "diffHunk": "@@ -20,6 +20,20 @@ Feature: Cobbler and distribution autoinstallation\n     Then I should see a \"testprofile\" text\n     And I should see a \"testdistro\" text\n \n+  Scenario: Create SUSE Distibution with installer updates\n+    When I install package \"tftpboot-installation-SLE-15-SP2-x86_64\" on this \"server\"\n+    And I follow the left menu \"Systems > Autoinstallation > Distributions\"\n+    And I follow \"Create Distribution\"\n+    When I enter \"SLE-15-SP2-x86_64\" as \"label\"", "originalCommit": "88d8e1c9602f8d08b5e6f66ebb2ae7a91b09c168", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMzNDU1Nw==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r476334557", "bodyText": "text field", "author": "Bischoff", "createdAt": "2020-08-25T10:08:03Z", "path": "testsuite/features/secondary/srv_distro_cobbler.feature", "diffHunk": "@@ -20,6 +20,20 @@ Feature: Cobbler and distribution autoinstallation\n     Then I should see a \"testprofile\" text\n     And I should see a \"testdistro\" text\n \n+  Scenario: Create SUSE Distibution with installer updates\n+    When I install package \"tftpboot-installation-SLE-15-SP2-x86_64\" on this \"server\"\n+    And I follow the left menu \"Systems > Autoinstallation > Distributions\"\n+    And I follow \"Create Distribution\"\n+    When I enter \"SLE-15-SP2-x86_64\" as \"label\"\n+    And I enter \"/usr/share/tftpboot-installation/SLE-15-SP2-x86_64/\" as \"basepath\"\n+    And I select \"SLE-Product-SLES15-Pool for x86_64\" from \"channelid\"\n+    And I select \"SUSE Linux Enterprise 15\" from \"installtype\"\n+    And I click on \"Create Autoinstallable Distribution\"\n+    Then I should see a \"Autoinstallable Distributions\" text\n+    And I should see a \"SLE-15-SP2-x86_64\" link\n+    When I follow \"SLE-15-SP2-x86_64\"\n+    Then textfield \"kernelopts\" should contain \"self_update=http://\"", "originalCommit": "88d8e1c9602f8d08b5e6f66ebb2ae7a91b09c168", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMzNDYzMg==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r476334632", "bodyText": "text field", "author": "Bischoff", "createdAt": "2020-08-25T10:08:13Z", "path": "testsuite/features/step_definitions/common_steps.rb", "diffHunk": "@@ -1210,3 +1210,7 @@ def server_secret\n   puts \"URL: #{url}\"\n   step %(I enter \"#{url}\" as \"calendar-data-text\")\n end\n+\n+Then(/^textfield \"([^\\\"]*)\" should contain \"([^\\\"]*)\"$/) do |field, text|", "originalCommit": "88d8e1c9602f8d08b5e6f66ebb2ae7a91b09c168", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTE5NjY2Mg==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r479196662", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Then(/^text field \"([^\\\"]*)\" should contain \"([^\\\"]*)\"$/) do |field, text|\n          \n          \n            \n            Then(/^the text field \"([^\\\"]*)\" should contain \"([^\\\"]*)\"$/) do |field, text|", "author": "srbarrios", "createdAt": "2020-08-28T11:58:05Z", "path": "testsuite/features/step_definitions/common_steps.rb", "diffHunk": "@@ -1210,3 +1210,7 @@ def server_secret\n   puts \"URL: #{url}\"\n   step %(I enter \"#{url}\" as \"calendar-data-text\")\n end\n+\n+Then(/^text field \"([^\\\"]*)\" should contain \"([^\\\"]*)\"$/) do |field, text|", "originalCommit": "2f0186a26c0c3d255e2489d65e9437ba57a0cfab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTIwMjEzOA==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r479202138", "bodyText": "I wonder if that duplicates the functionality of:\nThen(/^I should see a \"([^\"]*)\" text in element \"([^\"]*)\"$/) do |text, element|\n  within(:xpath, \"//div[@id=\\\"#{element}\\\" or @class=\\\"#{element}\\\"]\") do\n    raise \"Text #{text} not found in #{element}\" unless has_content?(text)\n  end\nend", "author": "srbarrios", "createdAt": "2020-08-28T12:02:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTE5NjY2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTIxODA2Ng==", "url": "https://github.com/uyuni-project/uyuni/pull/2512#discussion_r479218066", "bodyText": "Too bad, already merged, i'll fix the duplication in a separate PR", "author": "Bischoff", "createdAt": "2020-08-28T12:16:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTE5NjY2Mg=="}], "type": "inlineReview"}, {"oid": "83eeb17158102ee50944f096b07bb3f5b5c0cc3a", "url": "https://github.com/uyuni-project/uyuni/commit/83eeb17158102ee50944f096b07bb3f5b5c0cc3a", "message": "check installer updates repos gets synced", "committedDate": "2020-08-28T12:02:35Z", "type": "commit"}, {"oid": "29c678d0bc4604d769628ff0c6702013f424edf4", "url": "https://github.com/uyuni-project/uyuni/commit/29c678d0bc4604d769628ff0c6702013f424edf4", "message": "create a SLES distro and test if installer_updates option is set correct", "committedDate": "2020-08-28T12:02:35Z", "type": "commit"}, {"oid": "29c678d0bc4604d769628ff0c6702013f424edf4", "url": "https://github.com/uyuni-project/uyuni/commit/29c678d0bc4604d769628ff0c6702013f424edf4", "message": "create a SLES distro and test if installer_updates option is set correct", "committedDate": "2020-08-28T12:02:35Z", "type": "forcePushed"}]}