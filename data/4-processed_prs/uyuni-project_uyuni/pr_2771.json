{"pr_number": 2771, "pr_title": "New sanity check: HTTP proxy", "pr_createdAt": "2020-10-28T13:06:15Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2771", "timeline": [{"oid": "cd25659b692af551fcdb16f2a2a941d238a17013", "url": "https://github.com/uyuni-project/uyuni/commit/cd25659b692af551fcdb16f2a2a941d238a17013", "message": "New sanity check: HTTP proxy", "committedDate": "2020-10-28T13:04:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzQzNDg3Mg==", "url": "https://github.com/uyuni-project/uyuni/pull/2771#discussion_r513434872", "bodyText": "I guess the hash passed by parameter will not expire. If so, all good.", "author": "srbarrios", "createdAt": "2020-10-28T13:19:37Z", "path": "testsuite/features/step_definitions/command_steps.rb", "diffHunk": "@@ -34,6 +34,11 @@\n   $server.run(\"curl --insecure --location #{url} --output /dev/null\")\n end\n \n+Then(/^it should be possible to use the HTTP proxy$/) do\n+  url = 'https://updates.suse.com/SUSE/Products/SLE-Full/15-SP2/x86_64/iso/SLE-15-SP2-Full-x86_64-GM-Media1.iso.sha256.asc?puBv2yb9SYRD9TSM--G7wNmD-brWw-55ZleEl6oW7d9azO-egbH9I1neECM-Fxe8B1Vd67OxhDd2Ve0oLJ2npLoVjR6L7XvMPOph1pTD1hMYiedac3CO5MV9MzAz7o1nvRePINPUELIGwGe76UpJ8jjz5RdxUio49sBkjBVMv3MfgYnm4Qx-_eNIl9A&_ga=2.74585554.1711402403.1603885305-150982903.1600156280'", "originalCommit": "cd25659b692af551fcdb16f2a2a941d238a17013", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzQ1ODc4MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2771#discussion_r513458781", "bodyText": "That's the question. I wanted something on updates.suse.com in order to be as close as possible from what the reposync downloads, but all files there use hashes, or you get a 403.\nThis hash corresponds to one of the files in public access from SUSE's web site. After a few hours, it has remained valid, but I have no guarantee for next days or more.\nIf these hashes do not stay, I am afraid we will have to use a server that is not updates.suse.com.", "author": "Bischoff", "createdAt": "2020-10-28T13:50:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzQzNDg3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA2MzA3NA==", "url": "https://github.com/uyuni-project/uyuni/pull/2771#discussion_r514063074", "bodyText": "In fact, I would prefer to use our mirror, as we do everywhere else.\nBut... in NUE or even externally for Uyuni users we don't use mirror, so we need an alternative.", "author": "srbarrios", "createdAt": "2020-10-29T07:54:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzQzNDg3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA3NTQxMg==", "url": "https://github.com/uyuni-project/uyuni/pull/2771#discussion_r514075412", "bodyText": "I would use maybe fjust www.suse.com for the test.\nThe token has an expire date. At some point in time in the future this test will fail because of this and we all wonder what has changed.", "author": "mcalmer", "createdAt": "2020-10-29T08:18:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzQzNDg3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA4ODU1MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2771#discussion_r514088551", "bodyText": "So, I would have both possibilities in the check, if we use a mirror in the environment, then we check through the mirror, if we don't, like in NUE environments, then we use www.suse.com. So in that way, in environments with a mirror we completely de-couple from external links.", "author": "srbarrios", "createdAt": "2020-10-29T08:42:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzQzNDg3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDA5ODI5MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2771#discussion_r514098290", "bodyText": "@mcalmer i did not see your comment. I have just done another PR for head: #2775 .", "author": "Bischoff", "createdAt": "2020-10-29T08:58:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzQzNDg3Mg=="}], "type": "inlineReview"}]}