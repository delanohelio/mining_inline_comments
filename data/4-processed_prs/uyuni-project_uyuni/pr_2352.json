{"pr_number": 2352, "pr_title": "Optimize Salt and DB calls in virtualization guests and pools pages", "pr_createdAt": "2020-06-24T07:49:47Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2352", "timeline": [{"oid": "3c654f92dd7f3b376e5d6470b4e1bd16fcbbf775", "url": "https://github.com/uyuni-project/uyuni/commit/3c654f92dd7f3b376e5d6470b4e1bd16fcbbf775", "message": "Update changelogs", "committedDate": "2020-06-24T09:47:32Z", "type": "forcePushed"}, {"oid": "73a25aa376accd73f5ad74c06474edb620c93f08", "url": "https://github.com/uyuni-project/uyuni/commit/73a25aa376accd73f5ad74c06474edb620c93f08", "message": "Update changelogs", "committedDate": "2020-06-24T10:15:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk5NjcwMA==", "url": "https://github.com/uyuni-project/uyuni/pull/2352#discussion_r444996700", "bodyText": "Can we use a more specific prefix? Something like guest-", "author": "mbologna", "createdAt": "2020-06-24T15:51:07Z", "path": "java/code/src/com/redhat/rhn/domain/action/virtualization/BaseVirtualizationGuestAction.java", "diffHunk": "@@ -54,4 +55,12 @@ public void extractParameters(Map context) {\n         // therefore does nothing.\n     }\n \n+    @Override\n+    public String getWebSocketActionId() {\n+        String id = \"new-\" + getId();", "originalCommit": "76f9badb674cf67f1d86217e6592778e11941259", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTAxMzUzNQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2352#discussion_r445013535", "bodyText": "that one is for now objects... not only guests", "author": "cbosdo", "createdAt": "2020-06-24T16:16:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk5NjcwMA=="}], "type": "inlineReview"}, {"oid": "2730abc0f5fa8afa00b8be1b782edc15647ef0f4", "url": "https://github.com/uyuni-project/uyuni/commit/2730abc0f5fa8afa00b8be1b782edc15647ef0f4", "message": "Update changelogs", "committedDate": "2020-06-26T15:21:17Z", "type": "forcePushed"}, {"oid": "2ae6536958341d200c57558d871a0c8e9a8a4e0c", "url": "https://github.com/uyuni-project/uyuni/commit/2ae6536958341d200c57558d871a0c8e9a8a4e0c", "message": "Update changelogs", "committedDate": "2020-06-29T08:16:18Z", "type": "forcePushed"}, {"oid": "3b17c628bab66d7cd6760e2fc5c1e54ab2ca74e9", "url": "https://github.com/uyuni-project/uyuni/commit/3b17c628bab66d7cd6760e2fc5c1e54ab2ca74e9", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-06-29T09:46:49Z", "type": "forcePushed"}, {"oid": "2b0bf8601a8b34ff3c2f38f784ee58b9f2bbfa98", "url": "https://github.com/uyuni-project/uyuni/commit/2b0bf8601a8b34ff3c2f38f784ee58b9f2bbfa98", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-06-29T15:01:38Z", "type": "forcePushed"}, {"oid": "6fde8b189372ecf21314c591f3cab761ccc923a1", "url": "https://github.com/uyuni-project/uyuni/commit/6fde8b189372ecf21314c591f3cab761ccc923a1", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-07-03T13:25:13Z", "type": "forcePushed"}, {"oid": "36b097394649618c76fb611a7db9c4e922946686", "url": "https://github.com/uyuni-project/uyuni/commit/36b097394649618c76fb611a7db9c4e922946686", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-07-06T13:25:45Z", "type": "forcePushed"}, {"oid": "b2718d33ce86b75291725c4a2724f956ce200500", "url": "https://github.com/uyuni-project/uyuni/commit/b2718d33ce86b75291725c4a2724f956ce200500", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-07-06T14:58:17Z", "type": "forcePushed"}, {"oid": "ceff02d3a14b2b75a2dfd32d52a5ba36043f8fd7", "url": "https://github.com/uyuni-project/uyuni/commit/ceff02d3a14b2b75a2dfd32d52a5ba36043f8fd7", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-07-09T13:24:46Z", "type": "forcePushed"}, {"oid": "a390e4e38422cb82796df92456203195331e6a6e", "url": "https://github.com/uyuni-project/uyuni/commit/a390e4e38422cb82796df92456203195331e6a6e", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-07-09T15:01:32Z", "type": "forcePushed"}, {"oid": "d8f89e0c179bce57d2e982387f5b24fe51e36f16", "url": "https://github.com/uyuni-project/uyuni/commit/d8f89e0c179bce57d2e982387f5b24fe51e36f16", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-07-10T11:58:45Z", "type": "forcePushed"}, {"oid": "014c80aa6f0549e964d3a67c0897b325eddc2a72", "url": "https://github.com/uyuni-project/uyuni/commit/014c80aa6f0549e964d3a67c0897b325eddc2a72", "message": "Rename the virtual guest actions to *VirtualizationGuest*\n\nIn order to clearly reflect what the classes are acting on, add\nGuest to the action classname.", "committedDate": "2020-07-17T07:10:48Z", "type": "commit"}, {"oid": "cfb6fa1d70f407eb8869887d4df8ff6b76563ffe", "url": "https://github.com/uyuni-project/uyuni/commit/cfb6fa1d70f407eb8869887d4df8ff6b76563ffe", "message": "VirtNotifications: move ID calculation to the action class\n\nUse inheritance to compute the action id to send via the websocket\nrather than an ungly classname-based map.", "committedDate": "2020-07-17T07:10:48Z", "type": "commit"}, {"oid": "939211b9cda7ec8eee17688c3650ce3462b2ee95", "url": "https://github.com/uyuni-project/uyuni/commit/939211b9cda7ec8eee17688c3650ce3462b2ee95", "message": "virt guests: trigger refresh only when getting a websocket event\n\nTo avoid polling the DB and Salt minion every 5s while the page is\nopened, move to an event based refresh.", "committedDate": "2020-07-17T07:10:48Z", "type": "commit"}, {"oid": "ff880086d911563f4025ca18fd935d190e209677", "url": "https://github.com/uyuni-project/uyuni/commit/ff880086d911563f4025ca18fd935d190e209677", "message": "virt pools: trigger refresh only when getting a websocket event\n\nTo avoid polling the DB and Salt minion every 5s while the page is\nopened, move to an event based refresh.", "committedDate": "2020-07-17T07:10:48Z", "type": "commit"}, {"oid": "34789d2f2a2fdcdaa7408b98394f43066164a379", "url": "https://github.com/uyuni-project/uyuni/commit/34789d2f2a2fdcdaa7408b98394f43066164a379", "message": "Move the transaction in the AbstractLibvirtEngineMessage", "committedDate": "2020-07-17T07:10:48Z", "type": "commit"}, {"oid": "62c9603599c26fcdd18a26c1479f2575dd104f6d", "url": "https://github.com/uyuni-project/uyuni/commit/62c9603599c26fcdd18a26c1479f2575dd104f6d", "message": "Handle virtual storage pool events", "committedDate": "2020-07-17T07:10:48Z", "type": "commit"}, {"oid": "79039b327fafbad54742480f40cb9aec27e97895", "url": "https://github.com/uyuni-project/uyuni/commit/79039b327fafbad54742480f40cb9aec27e97895", "message": "Notify VM state changes to virt WebSocket\n\nA virtualization action being completed doesn't mean the virtual machine\nor storage was actually started, stopped, etc. Notify the\nVirt WebSocket when the virtpoller detects changes or when libvirt\nevents are received so that the UI can refresh after any libvirt change.", "committedDate": "2020-07-17T07:10:48Z", "type": "commit"}, {"oid": "bfabe39d5b4471b3a36235a80b1e94c7c34f18fc", "url": "https://github.com/uyuni-project/uyuni/commit/bfabe39d5b4471b3a36235a80b1e94c7c34f18fc", "message": "Update changelogs", "committedDate": "2020-07-17T07:11:30Z", "type": "commit"}, {"oid": "8c6778b5e019556fcb90e7a4d60acf18c5bf9104", "url": "https://github.com/uyuni-project/uyuni/commit/8c6778b5e019556fcb90e7a4d60acf18c5bf9104", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-07-17T07:12:00Z", "type": "commit"}, {"oid": "8c6778b5e019556fcb90e7a4d60acf18c5bf9104", "url": "https://github.com/uyuni-project/uyuni/commit/8c6778b5e019556fcb90e7a4d60acf18c5bf9104", "message": "Refresh virtual storage pool after deleting a volume\n\nLibvirt doesn't report any event when a volume has been deleted from a\npool. In order to refresh the UI automatically when triggering a delete\naction, force a pool refresh too.", "committedDate": "2020-07-17T07:12:00Z", "type": "forcePushed"}]}