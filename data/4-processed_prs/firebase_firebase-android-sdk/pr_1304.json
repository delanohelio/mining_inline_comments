{"pr_number": 1304, "pr_title": "Add support for other Firebase products to integrate with Remote Config.", "pr_createdAt": "2020-03-02T22:47:40Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/1304", "timeline": [{"oid": "4694964884b69f097aa9e40fa9c3b997aa94b27b", "url": "https://github.com/firebase/firebase-android-sdk/commit/4694964884b69f097aa9e40fa9c3b997aa94b27b", "message": "Merge Personalization into Remote Config.", "committedDate": "2020-02-26T03:41:48Z", "type": "commit"}, {"oid": "bf6e1e109abcf8c732636f53bfce25c7696a59b1", "url": "https://github.com/firebase/firebase-android-sdk/commit/bf6e1e109abcf8c732636f53bfce25c7696a59b1", "message": "Make pullArm() asynchronous.", "committedDate": "2020-02-26T23:29:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjcwMDY5OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r386700698", "bodyText": "Can we rename this function or alias it for personalization", "author": "ashwinraghav", "createdAt": "2020-03-02T22:54:19Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/RemoteConfigComponent.java", "diffHunk": "@@ -187,6 +195,7 @@ synchronized FirebaseRemoteConfig get(\n               firebaseApp,\n               firebaseInstanceId,\n               isAbtSupported(firebaseApp, namespace) ? firebaseAbt : null,\n+              isAbtSupported(firebaseApp, namespace) ? firebasePersonalization : null,", "originalCommit": "bf6e1e109abcf8c732636f53bfce25c7696a59b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1OTcyNw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r454559727", "bodyText": "Moved it out to getPersonalization().", "author": "vic-flair", "createdAt": "2020-07-14T18:30:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjcwMDY5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjcwMTE3Ng==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r386701176", "bodyText": "Is the plan here for RC to fail hard if this component is unavailable. If this is an optional dep, then this should be optional", "author": "ashwinraghav", "createdAt": "2020-03-02T22:55:23Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/RemoteConfigRegistrar.java", "diffHunk": "@@ -45,6 +46,7 @@\n             .add(Dependency.required(FirebaseApp.class))\n             .add(Dependency.required(FirebaseInstanceId.class))\n             .add(Dependency.required(AbtComponent.class))\n+            .add(Dependency.required(PersonalizationComponent.class))", "originalCommit": "bf6e1e109abcf8c732636f53bfce25c7696a59b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1OTgwMw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r454559803", "bodyText": "Removed the separate PersonalizationComponent and just put everything into RC itself.", "author": "vic-flair", "createdAt": "2020-07-14T18:30:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjcwMTE3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjcyODYxOQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r386728619", "bodyText": "It is not clear why the personalization SDK needs to know anything at this stage. That seems like an optimization", "author": "ashwinraghav", "createdAt": "2020-03-03T00:14:34Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -773,6 +791,41 @@ void updateAbtWithActivatedExperiments(@NonNull JSONArray abtExperiments) {\n     return experimentInfoMaps;\n   }\n \n+  /**\n+   * Notifies the Firebase Personalization SDK about a get() call.\n+   *\n+   * @hide\n+   */\n+  void pullArm(String key) {\n+    if (firebasePersonalization != null) {\n+      // If there is no firebasePersonalization instance, then this FRC is either in a non-3P\n+      // namespace or in a non-main FirebaseApp, so there is no reason to call Personalization.\n+      // For more info: RemoteConfigComponent#isAbtSupported.\n+      executor.execute(() -> firebasePersonalization.pullArm(key));\n+    }\n+  }\n+\n+  /**\n+   * Notifies the Firebase Personalization SDK about activated metadata.\n+   *\n+   * @hide\n+   */\n+  void updatePersonalizationWithActivatedMetadata(@NonNull ConfigContainer configs) {", "originalCommit": "bf6e1e109abcf8c732636f53bfce25c7696a59b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1OTg2MA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r454559860", "bodyText": "Yeah, I guess it is. Removed.", "author": "vic-flair", "createdAt": "2020-07-14T18:30:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjcyODYxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjczNjA0OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r386736049", "bodyText": "We are essentially doing a write-on-read. Developers are used to treating the get*() APIs as idempotent functions. This will no longer be true. Are you ok if GA counts these as independent events.", "author": "ashwinraghav", "createdAt": "2020-03-03T00:38:58Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/FirebaseRemoteConfig.java", "diffHunk": "@@ -358,6 +368,7 @@ public boolean activateFetched() {\n    */\n   @NonNull\n   public String getString(@NonNull String key) {\n+    pullArm(key);", "originalCommit": "bf6e1e109abcf8c732636f53bfce25c7696a59b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Njc0MjIzNA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r386742234", "bodyText": "It seems like we are going to build a variety of products built on top of config that would require this feedback loop to be established. I feel like a filter pattern or a listener pattern is a good candidate to consider here, at the risk of optimizing too early.", "author": "ashwinraghav", "createdAt": "2020-03-03T01:00:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjczNjA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU1OTkyNQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r454559925", "bodyText": "Yeah, we're OK with GA counting these as separate events. Implemented the listener pattern.", "author": "vic-flair", "createdAt": "2020-07-14T18:30:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjczNjA0OQ=="}], "type": "inlineReview"}, {"oid": "1d82298b2a7cf0f03101d1e3ccee68c4cb8847fe", "url": "https://github.com/firebase/firebase-android-sdk/commit/1d82298b2a7cf0f03101d1e3ccee68c4cb8847fe", "message": "Merge branch 'master' into vlum.p13n", "committedDate": "2020-07-10T15:03:45Z", "type": "commit"}, {"oid": "6f50916486c76a5f0c70834de791aa9b5a40a21a", "url": "https://github.com/firebase/firebase-android-sdk/commit/6f50916486c76a5f0c70834de791aa9b5a40a21a", "message": "Move all Personalization code to Remote Config.", "committedDate": "2020-07-14T15:55:52Z", "type": "commit"}, {"oid": "6f50916486c76a5f0c70834de791aa9b5a40a21a", "url": "https://github.com/firebase/firebase-android-sdk/commit/6f50916486c76a5f0c70834de791aa9b5a40a21a", "message": "Move all Personalization code to Remote Config.", "committedDate": "2020-07-14T15:55:52Z", "type": "forcePushed"}, {"oid": "51943bd0e56eca5bb2765195ab01b4e7770cc384", "url": "https://github.com/firebase/firebase-android-sdk/commit/51943bd0e56eca5bb2765195ab01b4e7770cc384", "message": "Port BiConsumer.", "committedDate": "2020-07-14T17:08:27Z", "type": "commit"}, {"oid": "d9b861fdcd179f4f89ad7ab7f53ebe897b04ab3d", "url": "https://github.com/firebase/firebase-android-sdk/commit/d9b861fdcd179f4f89ad7ab7f53ebe897b04ab3d", "message": "Add @Nullable to BiConsumer.", "committedDate": "2020-07-14T17:20:47Z", "type": "commit"}, {"oid": "d359072c59c1bcbf64672954dac1db5add8da9fd", "url": "https://github.com/firebase/firebase-android-sdk/commit/d359072c59c1bcbf64672954dac1db5add8da9fd", "message": "Add API information for BiConsumer.", "committedDate": "2020-07-14T18:10:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM0MTg1OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r465341859", "bodyText": "Can we move this interface to the internal package?", "author": "danasilver", "createdAt": "2020-08-04T21:30:55Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/BiConsumer.java", "diffHunk": "@@ -0,0 +1,23 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+//\n+// You may obtain a copy of the License at\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.remoteconfig;\n+\n+import androidx.annotation.Nullable;\n+\n+/** A port of {@link java.util.function.BiConsumer}, a generic consumer of values. */\n+@FunctionalInterface\n+public interface BiConsumer<T, U> {", "originalCommit": "d359072c59c1bcbf64672954dac1db5add8da9fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU0MTI1NA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r472541254", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-08-18T23:05:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM0MTg1OQ=="}], "type": "inlineReview"}, {"oid": "c3e56c387c0f75d1fe73f930c38e3d80dc356e31", "url": "https://github.com/firebase/firebase-android-sdk/commit/c3e56c387c0f75d1fe73f930c38e3d80dc356e31", "message": "Move BiConsumer to internal/ and change Personalization metadata to object.", "committedDate": "2020-08-17T18:10:15Z", "type": "commit"}, {"oid": "e93f3b8b4da15dd6d6720e5f4cbdcbc1db225767", "url": "https://github.com/firebase/firebase-android-sdk/commit/e93f3b8b4da15dd6d6720e5f4cbdcbc1db225767", "message": "More places where Personalization metadata is supposed to be object.", "committedDate": "2020-08-18T22:48:47Z", "type": "commit"}, {"oid": "103f57a051198cb47e18e7e9b926a659b027808c", "url": "https://github.com/firebase/firebase-android-sdk/commit/103f57a051198cb47e18e7e9b926a659b027808c", "message": "Merge commit 'a69ede1841f5753fb613b9978f84b3b5f4f44509' into vlum.p13n", "committedDate": "2020-08-18T22:48:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYxNTg1OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r482615858", "bodyText": "Thinking: the pattern of encapsulating P13n logging behind a listener interface seems nice and clean, but it does require passage of the whole config to the listener, which kinda breaks the law of demeter.", "author": "erikeldridge", "createdAt": "2020-09-03T00:28:53Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/RemoteConfigComponent.java", "diffHunk": "@@ -153,6 +154,14 @@ public synchronized FirebaseRemoteConfig get(String namespace) {\n     ConfigCacheClient activatedCacheClient = getCacheClient(namespace, ACTIVATE_FILE_NAME);\n     ConfigCacheClient defaultsCacheClient = getCacheClient(namespace, DEFAULTS_FILE_NAME);\n     ConfigMetadataClient metadataClient = getMetadataClient(context, appId, namespace);\n+\n+    ConfigGetParameterHandler getHandler = getGetHandler(activatedCacheClient, defaultsCacheClient);\n+    Personalization personalization =\n+        getPersonalization(firebaseApp, namespace, analyticsConnector);\n+    if (personalization != null) {\n+      getHandler.addListener(personalization::logArmActive);", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYyNDE5Ng==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r482624196", "bodyText": "I don't think we want to log static default value usage to P13n, ie it's not personalized. I think we want something like:\npublic String getString(String key) {\n  String activatedString = getStringFromCache(activatedConfigsCache, key);\n  if (activatedString != null) {\n    callListeners(key, ....);\n    return activatedString;\n  }\n  ...\n\nSame for all the other typed getters below", "author": "erikeldridge", "createdAt": "2020-09-03T00:46:48Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -92,14 +102,14 @@ public ConfigGetParameterHandler(\n    * @param key A Firebase Remote Config parameter key.\n    */\n   public String getString(String key) {\n-    String activatedString = getStringFromCache(activatedConfigsCache, key);\n-    if (activatedString != null) {\n-      return activatedString;\n+    ConfigAndValue configAndValue = getStringFromCache(activatedConfigsCache, key);\n+    if (configAndValue == null) {\n+      configAndValue = getStringFromCache(defaultConfigsCache, key);", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1MTY3NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r494451675", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-09-24T16:26:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYyNDE5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMTIxMQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r482631211", "bodyText": "Thinking out loud: re licensing, GWT is open source and does something similar https://github.com/gwtproject/gwt/blob/f031aba1e5aff65143005de841a491b42fe1031a/user/super/com/google/gwt/emul/java/util/function/BiConsumer.java", "author": "erikeldridge", "createdAt": "2020-09-03T00:59:24Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/BiConsumer.java", "diffHunk": "@@ -0,0 +1,23 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+//\n+// You may obtain a copy of the License at\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.remoteconfig.internal;\n+\n+import androidx.annotation.Nullable;\n+\n+/** A port of {@link java.util.function.BiConsumer}, a generic consumer of values. */", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ0NzYyOQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r494447629", "bodyText": "Turns out they also have this in com.google.android.gms, so used that one instead.", "author": "vic-flair", "createdAt": "2020-09-24T16:20:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMTIxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMjM4MA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r482632380", "bodyText": "As above, if this is an error case, I'd recommend logging something to help customers debug unexpected behavior.", "author": "erikeldridge", "createdAt": "2020-09-03T01:04:05Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/Personalization.java", "diffHunk": "@@ -0,0 +1,63 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+//\n+// You may obtain a copy of the License at\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.remoteconfig.internal;\n+\n+import static com.google.firebase.remoteconfig.internal.ConfigContainer.CONFIGS_KEY;\n+import static com.google.firebase.remoteconfig.internal.ConfigContainer.PERSONALIZATION_METADATA_KEY;\n+\n+import android.os.Bundle;\n+import androidx.annotation.NonNull;\n+import com.google.firebase.analytics.connector.AnalyticsConnector;\n+import org.json.JSONObject;\n+\n+public class Personalization {\n+  static final String ANALYTICS_ORIGIN_PERSONALIZATION = \"fp\";\n+  static final String ANALYTICS_PULL_EVENT = \"_fpc\";\n+  static final String ARM_KEY = \"_fpid\";\n+  static final String ARM_VALUE = \"_fpct\";\n+  static final String PERSONALIZATION_ID = \"personalizationId\";\n+\n+  /** The app's Firebase Analytics client. */\n+  private final AnalyticsConnector analyticsConnector;\n+\n+  /** Creates an instance of {@code Personalization}. */\n+  public Personalization(@NonNull AnalyticsConnector analyticsConnector) {\n+    this.analyticsConnector = analyticsConnector;\n+  }\n+  /**\n+   * Called when an arm is pulled, and uses Google Analytics for Firebase to log it if it's a\n+   * Personalization parameter.\n+   *\n+   * @param key Remote Config parameter\n+   * @param configContainer JSON of {@link ConfigContainer}\n+   */\n+  public void logArmActive(@NonNull String key, @NonNull JSONObject configContainer) {\n+    JSONObject ids = configContainer.optJSONObject(PERSONALIZATION_METADATA_KEY);\n+    JSONObject values = configContainer.optJSONObject(CONFIGS_KEY);\n+    if (ids == null || values == null) {", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1MTg1NA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r494451854", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-09-24T16:26:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMjM4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMzY3Mg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r482633672", "bodyText": "Any risk of a listener being added multiple times? Should the underlying collection of listeners be a Set?", "author": "erikeldridge", "createdAt": "2020-09-03T01:08:59Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/RemoteConfigComponent.java", "diffHunk": "@@ -153,6 +154,14 @@ public synchronized FirebaseRemoteConfig get(String namespace) {\n     ConfigCacheClient activatedCacheClient = getCacheClient(namespace, ACTIVATE_FILE_NAME);\n     ConfigCacheClient defaultsCacheClient = getCacheClient(namespace, DEFAULTS_FILE_NAME);\n     ConfigMetadataClient metadataClient = getMetadataClient(context, appId, namespace);\n+\n+    ConfigGetParameterHandler getHandler = getGetHandler(activatedCacheClient, defaultsCacheClient);\n+    Personalization personalization =\n+        getPersonalization(firebaseApp, namespace, analyticsConnector);\n+    if (personalization != null) {\n+      getHandler.addListener(personalization::logArmActive);", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ0NTA2MQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r494445061", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-09-24T16:16:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzMzY3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzNjM1NA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r482636354", "bodyText": "I'd recommend logging something anywhere we suppress an error. Silent failures limit the details customers can provide in support requests.", "author": "erikeldridge", "createdAt": "2020-09-03T01:18:49Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigFetchHttpClient.java", "diffHunk": "@@ -400,6 +401,16 @@ private static ConfigContainer extractConfigs(JSONObject fetchResponse, Date fet\n         containerBuilder.withAbtExperiments(experimentDescriptions);\n       }\n \n+      JSONObject personalizationMetadata = null;\n+      try {\n+        personalizationMetadata = fetchResponse.getJSONObject(PERSONALIZATION_METADATA);\n+      } catch (JSONException e) {\n+        // Do nothing if personalizationMetadata does not exist.", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ0Nzc4NA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r494447784", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-09-24T16:20:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzNjM1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgyNzQzNQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r497827435", "bodyText": "Thx\nThinking: getJSONObject throws if the key doesn't exist, which will be true for anyone not using P13n. We could check for the key first w has, but since this code only runs during fetch, I don't think it'll be spammy enough to justify that.", "author": "erikeldridge", "createdAt": "2020-09-30T22:05:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzNjM1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ2MzAwMQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r498463001", "bodyText": "Some other thoughts: we follow this getJSONObject pattern for other field above but don't log if there's nothing to get. RC had bug reports of spammy logging when we were logging warnings in the expected case for performance monitoring, so using at least the INFO level seems appropriate. I might even use DEBUG here to make it easier to hide this log message for users not using p13n.", "author": "danasilver", "createdAt": "2020-10-01T19:18:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzNjM1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY2NTI5NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r517665295", "bodyText": "In general, if there's an error and it's actionable, I think we'd be wise to log a warning. In this case, it sounds like the common case will be to throw, so it's borderline not an error, and only actionable for folks using the feature, so it should not be WARN level. I guess in this case, we can't differentiate between an error case of missing metadata and the common case of not using the feature. DEBUG probably makes sense since it's a suppressed error, which folks would be looking for when debugging.", "author": "erikeldridge", "createdAt": "2020-11-04T22:21:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzNjM1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYzODk3OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r482638979", "bodyText": "Thinking: I like this enforcement of the listener being called on a separate thread, since this is running in the low-latency get layer. I am wary of customers spawning threads unwittingly while calling get, but I think we can optimize if/when it becomes an issue.", "author": "erikeldridge", "createdAt": "2020-09-03T01:28:49Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -325,6 +337,33 @@ public FirebaseRemoteConfigValue getValue(String key) {\n     return allConfigs;\n   }\n \n+  /**\n+   * Adds a listener that will be called whenever one of the get methods is called.\n+   *\n+   * @param listener function that takes in the parameter key and the {@link ConfigContainer} JSON\n+   */\n+  public void addListener(BiConsumer<String, JSONObject> listener) {\n+    synchronized (listeners) {\n+      listeners.add(listener);\n+    }\n+  }\n+\n+  /**\n+   * Calls all listeners in {@link #listeners}.\n+   *\n+   * @param key parameter key that was retrieved\n+   * @param container the container the key was retrieved from\n+   */\n+  private void callListeners(String key, ConfigContainer container) {\n+    JSONObject configs = container.getContainer();\n+\n+    synchronized (listeners) {\n+      for (BiConsumer<String, JSONObject> listener : listeners) {\n+        executor.execute(() -> listener.accept(key, configs));", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MDU5Mg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r482640592", "bodyText": "Given the config is available as activatedConfigsCache it's unclear to me why we need the ConfigAndValue tuple, eg as opposed to:\npublic String getString(String key) {\n  String activatedString = getStringFromCache(activatedConfigsCache, key);\n  if (activatedString != null) {\n    ConfigContainer activatedContainer = getConfigsFromCache(activatedConfigsCache);\n    callListeners( ... activatedContainer);\n    return activatedString;\n  }\n  ...", "author": "erikeldridge", "createdAt": "2020-09-03T01:34:48Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -92,14 +102,14 @@ public ConfigGetParameterHandler(\n    * @param key A Firebase Remote Config parameter key.\n    */\n   public String getString(String key) {\n-    String activatedString = getStringFromCache(activatedConfigsCache, key);\n-    if (activatedString != null) {\n-      return activatedString;\n+    ConfigAndValue configAndValue = getStringFromCache(activatedConfigsCache, key);", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1MDc0OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r494450748", "bodyText": "That works too. I figured we're already calling getConfigsFromCache() in getStringFromCache(), so it was easier to just return it, but I guess it is ugly.", "author": "vic-flair", "createdAt": "2020-09-24T16:24:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY0MDU5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI0MjAxNA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r488242014", "bodyText": "Thinking: customers can also get params via getAll ( https://firebase.google.com/docs/reference/android/com/google/firebase/remoteconfig/FirebaseRemoteConfig#getAll() ), which won't log. It feels relatively straightforward to say that's an unsupported advanced use-case, but it is an inconsistency.", "author": "erikeldridge", "createdAt": "2020-09-14T21:55:15Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -92,14 +102,14 @@ public ConfigGetParameterHandler(\n    * @param key A Firebase Remote Config parameter key.\n    */\n   public String getString(String key) {\n-    String activatedString = getStringFromCache(activatedConfigsCache, key);\n-    if (activatedString != null) {\n-      return activatedString;\n+    ConfigAndValue configAndValue = getStringFromCache(activatedConfigsCache, key);", "originalCommit": "103f57a051198cb47e18e7e9b926a659b027808c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQ1MTU1Mg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r494451552", "bodyText": "getAll() relies on getValue(), which does log, so this case is supported.", "author": "vic-flair", "createdAt": "2020-09-24T16:26:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI0MjAxNA=="}], "type": "inlineReview"}, {"oid": "8a3db12b626c5df5165a6cd6ccb630b2fa215018", "url": "https://github.com/firebase/firebase-android-sdk/commit/8a3db12b626c5df5165a6cd6ccb630b2fa215018", "message": "Remove ConfigAndValue and instead call getConfigsFromCache() again.", "committedDate": "2020-09-24T07:01:03Z", "type": "commit"}, {"oid": "8a3db12b626c5df5165a6cd6ccb630b2fa215018", "url": "https://github.com/firebase/firebase-android-sdk/commit/8a3db12b626c5df5165a6cd6ccb630b2fa215018", "message": "Remove ConfigAndValue and instead call getConfigsFromCache() again.", "committedDate": "2020-09-24T07:01:03Z", "type": "forcePushed"}, {"oid": "3ab23799324c5f6180e5b63b73780a3474dbef6a", "url": "https://github.com/firebase/firebase-android-sdk/commit/3ab23799324c5f6180e5b63b73780a3474dbef6a", "message": "Check for null in callListeners().", "committedDate": "2020-09-24T07:16:27Z", "type": "commit"}, {"oid": "765e5b9330664d39ecf9a460d088377e2bb15f91", "url": "https://github.com/firebase/firebase-android-sdk/commit/765e5b9330664d39ecf9a460d088377e2bb15f91", "message": "Only pass value and Personalization metadata to listeners.", "committedDate": "2020-10-06T15:59:27Z", "type": "commit"}, {"oid": "7f719dc830b0a383dd46aa24739d882f9007efe2", "url": "https://github.com/firebase/firebase-android-sdk/commit/7f719dc830b0a383dd46aa24739d882f9007efe2", "message": "Remove unused imports.", "committedDate": "2020-10-06T20:52:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY1MDAxOQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r500650019", "bodyText": "Is this used anymore?", "author": "danasilver", "createdAt": "2020-10-06T23:23:03Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigContainer.java", "diffHunk": "@@ -80,7 +89,12 @@ static ConfigContainer copyOf(JSONObject containerJson) throws JSONException {\n     return new ConfigContainer(\n         containerJson.getJSONObject(CONFIGS_KEY),\n         new Date(containerJson.getLong(FETCH_TIME_KEY)),\n-        containerJson.getJSONArray(ABT_EXPERIMENTS_KEY));\n+        containerJson.getJSONArray(ABT_EXPERIMENTS_KEY),\n+        containerJson.getJSONObject(PERSONALIZATION_METADATA_KEY));\n+  }\n+\n+  JSONObject getContainer() {", "originalCommit": "7f719dc830b0a383dd46aa24739d882f9007efe2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3MDYxOA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r500670618", "bodyText": "Nope.", "author": "vic-flair", "createdAt": "2020-10-07T00:32:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY1MDAxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY1MTY2Mw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r500651663", "bodyText": "What do you think of calling this getPersonalizationMetadata since it's used statically without the Personalization class as context?", "author": "danasilver", "createdAt": "2020-10-06T23:28:54Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/Personalization.java", "diffHunk": "@@ -0,0 +1,67 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+//\n+// You may obtain a copy of the License at\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.remoteconfig.internal;\n+\n+import android.os.Bundle;\n+import androidx.annotation.NonNull;\n+import androidx.annotation.Nullable;\n+import com.google.firebase.analytics.connector.AnalyticsConnector;\n+import org.json.JSONObject;\n+\n+public class Personalization {\n+  static final String ANALYTICS_ORIGIN_PERSONALIZATION = \"fp\";\n+  static final String ANALYTICS_PULL_EVENT = \"_fpc\";\n+  static final String ARM_KEY = \"_fpid\";\n+  static final String ARM_VALUE = \"_fpct\";\n+  static final String PERSONALIZATION_ID = \"personalizationId\";\n+\n+  /** The app's Firebase Analytics client. */\n+  private final AnalyticsConnector analyticsConnector;\n+\n+  /** Creates an instance of {@code Personalization}. */\n+  public Personalization(@NonNull AnalyticsConnector analyticsConnector) {\n+    this.analyticsConnector = analyticsConnector;\n+  }\n+\n+  /**\n+   * Called when an arm is pulled, and uses Google Analytics for Firebase to log it if it's a\n+   * Personalization parameter.\n+   *\n+   * @param value Remote Config parameter value\n+   * @param metadata JSON of Personalization metadata\n+   */\n+  public void logArmActive(@NonNull String value, JSONObject metadata) {\n+    if (metadata == null) {\n+      return;\n+    }\n+\n+    Bundle params = new Bundle();\n+    params.putString(ARM_KEY, metadata.optString(PERSONALIZATION_ID));\n+    params.putString(ARM_VALUE, value);\n+    analyticsConnector.logEvent(ANALYTICS_ORIGIN_PERSONALIZATION, ANALYTICS_PULL_EVENT, params);\n+  }\n+\n+  /**\n+   * Gets the Personalization metadata associated with {@code key}.\n+   *\n+   * @param key Remote Config parameter\n+   * @param configContainer cache of {@link ConfigContainer}\n+   */\n+  @Nullable\n+  public static JSONObject getMetadata(", "originalCommit": "7f719dc830b0a383dd46aa24739d882f9007efe2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3MDkxNg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r500670916", "bodyText": "Prefixed them with Personalization. so there's context.", "author": "vic-flair", "createdAt": "2020-10-07T00:33:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY1MTY2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY1MjYyMw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r500652623", "bodyText": "Wonder if there's a more precise word than retrieved here? I think it refers to the value being retrieved by the developer via a get() call, right?", "author": "danasilver", "createdAt": "2020-10-06T23:31:54Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -325,6 +347,31 @@ public FirebaseRemoteConfigValue getValue(String key) {\n     return allConfigs;\n   }\n \n+  /**\n+   * Adds a listener that will be called whenever one of the get methods is called.\n+   *\n+   * @param listener function that takes in the parameter value and Personalization metadata\n+   */\n+  public void addListener(BiConsumer<String, JSONObject> listener) {\n+    synchronized (listeners) {\n+      listeners.add(listener);\n+    }\n+  }\n+\n+  /**\n+   * Calls all listeners in {@link #listeners}.\n+   *\n+   * @param value parameter value that was retrieved", "originalCommit": "7f719dc830b0a383dd46aa24739d882f9007efe2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3MDk3Mg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r500670972", "bodyText": "Reworded.", "author": "vic-flair", "createdAt": "2020-10-07T00:33:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY1MjYyMw=="}], "type": "inlineReview"}, {"oid": "6118c4121e9edfabbb4812115a775bf8641d3222", "url": "https://github.com/firebase/firebase-android-sdk/commit/6118c4121e9edfabbb4812115a775bf8641d3222", "message": "Use Personalization.getMetadata() to clarify that they're Personalization calls.", "committedDate": "2020-10-07T00:29:12Z", "type": "commit"}, {"oid": "3096c88d3b018ef751b903c51739caeda75793fc", "url": "https://github.com/firebase/firebase-android-sdk/commit/3096c88d3b018ef751b903c51739caeda75793fc", "message": "Go back to passing the whole config to listeners.", "committedDate": "2020-10-09T19:09:44Z", "type": "commit"}, {"oid": "85c80742646f69b77bd7e810da57793f11378c78", "url": "https://github.com/firebase/firebase-android-sdk/commit/85c80742646f69b77bd7e810da57793f11378c78", "message": "Merge branch 'master' into vlum.p13n", "committedDate": "2020-10-13T00:34:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NDM3MA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r503964370", "bodyText": "It's not blocking but might be worth thinking about long-term: why is json passed here? it does not look type-safe, given that there are multiple checks for certain keys that are expected to be in this json object. Would it make sense to create a more type-safe interface to the config?", "author": "vkryachko", "createdAt": "2020-10-13T13:45:22Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/Personalization.java", "diffHunk": "@@ -0,0 +1,72 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+//\n+// You may obtain a copy of the License at\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.remoteconfig.internal;\n+\n+import static com.google.firebase.remoteconfig.FirebaseRemoteConfig.TAG;\n+import static com.google.firebase.remoteconfig.internal.ConfigContainer.CONFIGS_KEY;\n+import static com.google.firebase.remoteconfig.internal.ConfigContainer.PERSONALIZATION_METADATA_KEY;\n+\n+import android.os.Bundle;\n+import android.util.Log;\n+import androidx.annotation.NonNull;\n+import com.google.firebase.analytics.connector.AnalyticsConnector;\n+import org.json.JSONObject;\n+\n+public class Personalization {\n+  static final String ANALYTICS_ORIGIN_PERSONALIZATION = \"fp\";\n+  static final String ANALYTICS_PULL_EVENT = \"_fpc\";\n+  static final String ARM_KEY = \"_fpid\";\n+  static final String ARM_VALUE = \"_fpct\";\n+  static final String PERSONALIZATION_ID = \"personalizationId\";\n+\n+  /** The app's Firebase Analytics client. */\n+  private final AnalyticsConnector analyticsConnector;\n+\n+  /** Creates an instance of {@code Personalization}. */\n+  public Personalization(@NonNull AnalyticsConnector analyticsConnector) {\n+    this.analyticsConnector = analyticsConnector;\n+  }\n+\n+  /**\n+   * Called when an arm is pulled, and uses Google Analytics for Firebase to log it if it's a\n+   * Personalization parameter.\n+   *\n+   * @param key Remote Config parameter\n+   * @param configContainer JSON of {@link ConfigContainer}\n+   */\n+  public void logArmActive(@NonNull String key, @NonNull JSONObject configContainer) {", "originalCommit": "85c80742646f69b77bd7e810da57793f11378c78", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDM4NTUyNg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r504385526", "bodyText": "Good point. Switched it to use ConfigContainer instead.", "author": "vic-flair", "createdAt": "2020-10-14T03:54:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzk2NDM3MA=="}], "type": "inlineReview"}, {"oid": "8a8b301b30cfc0ce312f1746d8055898e3945d1c", "url": "https://github.com/firebase/firebase-android-sdk/commit/8a8b301b30cfc0ce312f1746d8055898e3945d1c", "message": "Pass ConfigContainer instead of JSONObject to logArmActive().", "committedDate": "2020-10-14T03:50:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc0NjU2OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r504746568", "bodyText": "Maybe \"{@link ConfigContainer} containing personalization metadata for {@code key}\"", "author": "danasilver", "createdAt": "2020-10-14T14:56:16Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/Personalization.java", "diffHunk": "@@ -0,0 +1,70 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+//\n+// You may obtain a copy of the License at\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.remoteconfig.internal;\n+\n+import static com.google.firebase.remoteconfig.FirebaseRemoteConfig.TAG;\n+\n+import android.os.Bundle;\n+import android.util.Log;\n+import androidx.annotation.NonNull;\n+import com.google.firebase.analytics.connector.AnalyticsConnector;\n+import org.json.JSONObject;\n+\n+public class Personalization {\n+  static final String ANALYTICS_ORIGIN_PERSONALIZATION = \"fp\";\n+  static final String ANALYTICS_PULL_EVENT = \"_fpc\";\n+  static final String ARM_KEY = \"_fpid\";\n+  static final String ARM_VALUE = \"_fpct\";\n+  static final String PERSONALIZATION_ID = \"personalizationId\";\n+\n+  /** The app's Firebase Analytics client. */\n+  private final AnalyticsConnector analyticsConnector;\n+\n+  /** Creates an instance of {@code Personalization}. */\n+  public Personalization(@NonNull AnalyticsConnector analyticsConnector) {\n+    this.analyticsConnector = analyticsConnector;\n+  }\n+\n+  /**\n+   * Called when an arm is pulled, and uses Google Analytics for Firebase to log it if it's a\n+   * Personalization parameter.\n+   *\n+   * @param key Remote Config parameter\n+   * @param configContainer cache of {@link ConfigContainer}", "originalCommit": "8a8b301b30cfc0ce312f1746d8055898e3945d1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2OTQxNQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r508669415", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-10-20T16:24:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc0NjU2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc1MzMyNQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r504753325", "bodyText": "The ConfigContainer is a local cache of the config, but I'm not sure it makes sense to call it a cache in this context. Maybe {@link ConfigContainer} containing {@code key}", "author": "danasilver", "createdAt": "2020-10-14T15:04:41Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -325,6 +344,35 @@ public FirebaseRemoteConfigValue getValue(String key) {\n     return allConfigs;\n   }\n \n+  /**\n+   * Adds a listener that will be called whenever one of the get methods is called.\n+   *\n+   * @param listener function that takes in the parameter key and the {@link ConfigContainer} JSON\n+   */\n+  public void addListener(BiConsumer<String, ConfigContainer> listener) {\n+    synchronized (listeners) {\n+      listeners.add(listener);\n+    }\n+  }\n+\n+  /**\n+   * Calls all listeners in {@link #listeners}.\n+   *\n+   * @param key Remote Config parameter key\n+   * @param container cache of {@link ConfigContainer}", "originalCommit": "8a8b301b30cfc0ce312f1746d8055898e3945d1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2OTQ5OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r508669498", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-10-20T16:24:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc1MzMyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2MzA3OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r504763078", "bodyText": "Adding some more description would be helpful for future users. Maybe like\nCalls all listeners added to {@link #listeners} with the retrieved key from a {@code get*} call and the config containing the key.", "author": "danasilver", "createdAt": "2020-10-14T15:17:21Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -325,6 +344,35 @@ public FirebaseRemoteConfigValue getValue(String key) {\n     return allConfigs;\n   }\n \n+  /**\n+   * Adds a listener that will be called whenever one of the get methods is called.\n+   *\n+   * @param listener function that takes in the parameter key and the {@link ConfigContainer} JSON\n+   */\n+  public void addListener(BiConsumer<String, ConfigContainer> listener) {\n+    synchronized (listeners) {\n+      listeners.add(listener);\n+    }\n+  }\n+\n+  /**\n+   * Calls all listeners in {@link #listeners}.", "originalCommit": "8a8b301b30cfc0ce312f1746d8055898e3945d1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2OTU3OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r508669578", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-10-20T16:24:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2MzA3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2MzY3NA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r504763674", "bodyText": "Similar to the other comments maybe add a detail about what it's called on (key and container with the key)", "author": "danasilver", "createdAt": "2020-10-14T15:18:13Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -325,6 +344,35 @@ public FirebaseRemoteConfigValue getValue(String key) {\n     return allConfigs;\n   }\n \n+  /**\n+   * Adds a listener that will be called whenever one of the get methods is called.", "originalCommit": "8a8b301b30cfc0ce312f1746d8055898e3945d1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2OTc0OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r508669749", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-10-20T16:25:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2MzY3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2NDA1NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r504764055", "bodyText": "no longer JSON", "author": "danasilver", "createdAt": "2020-10-14T15:18:45Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandler.java", "diffHunk": "@@ -325,6 +344,35 @@ public FirebaseRemoteConfigValue getValue(String key) {\n     return allConfigs;\n   }\n \n+  /**\n+   * Adds a listener that will be called whenever one of the get methods is called.\n+   *\n+   * @param listener function that takes in the parameter key and the {@link ConfigContainer} JSON", "originalCommit": "8a8b301b30cfc0ce312f1746d8055898e3945d1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2OTg0MA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r508669840", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-10-20T16:25:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2NDA1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2NjExMg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r504766112", "bodyText": "Is it accurate to say \"called when a Personalization parameter value (an arm) is retrieved\"? That might help put it in the context of Remote Config a bit more. Would also help to add what the \"it\" is that's being logged", "author": "danasilver", "createdAt": "2020-10-14T15:21:21Z", "path": "firebase-config/src/main/java/com/google/firebase/remoteconfig/internal/Personalization.java", "diffHunk": "@@ -0,0 +1,70 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+//\n+// You may obtain a copy of the License at\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.remoteconfig.internal;\n+\n+import static com.google.firebase.remoteconfig.FirebaseRemoteConfig.TAG;\n+\n+import android.os.Bundle;\n+import android.util.Log;\n+import androidx.annotation.NonNull;\n+import com.google.firebase.analytics.connector.AnalyticsConnector;\n+import org.json.JSONObject;\n+\n+public class Personalization {\n+  static final String ANALYTICS_ORIGIN_PERSONALIZATION = \"fp\";\n+  static final String ANALYTICS_PULL_EVENT = \"_fpc\";\n+  static final String ARM_KEY = \"_fpid\";\n+  static final String ARM_VALUE = \"_fpct\";\n+  static final String PERSONALIZATION_ID = \"personalizationId\";\n+\n+  /** The app's Firebase Analytics client. */\n+  private final AnalyticsConnector analyticsConnector;\n+\n+  /** Creates an instance of {@code Personalization}. */\n+  public Personalization(@NonNull AnalyticsConnector analyticsConnector) {\n+    this.analyticsConnector = analyticsConnector;\n+  }\n+\n+  /**\n+   * Called when an arm is pulled, and uses Google Analytics for Firebase to log it if it's a", "originalCommit": "8a8b301b30cfc0ce312f1746d8055898e3945d1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2OTk4Nw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r508669987", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-10-20T16:25:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2NjExMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2ODEzMg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r504768132", "bodyText": "What do you think about a test that listeners are called correctly?", "author": "danasilver", "createdAt": "2020-10-14T15:24:05Z", "path": "firebase-config/src/test/java/com/google/firebase/remoteconfig/internal/ConfigGetParameterHandlerTest.java", "diffHunk": "@@ -83,7 +84,9 @@\n   public void setUp() {\n     MockitoAnnotations.initMocks(this);\n \n-    getHandler = new ConfigGetParameterHandler(mockActivatedCache, mockDefaultsCache);\n+    getHandler =\n+        new ConfigGetParameterHandler(\n+            MoreExecutors.directExecutor(), mockActivatedCache, mockDefaultsCache);", "originalCommit": "8a8b301b30cfc0ce312f1746d8055898e3945d1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY3MDA2Mg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r508670062", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-10-20T16:25:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc2ODEzMg=="}], "type": "inlineReview"}, {"oid": "c6d4d0d82e68c6126566ad291ef834a2171ccb6c", "url": "https://github.com/firebase/firebase-android-sdk/commit/c6d4d0d82e68c6126566ad291ef834a2171ccb6c", "message": "Merge branch 'master' into vlum.p13n", "committedDate": "2020-10-19T17:02:50Z", "type": "commit"}, {"oid": "1073bb788e29908bedc19b2655fc8ce073f93137", "url": "https://github.com/firebase/firebase-android-sdk/commit/1073bb788e29908bedc19b2655fc8ce073f93137", "message": "Edit comments and add unit test for FirebaseRemoteConfig integration.", "committedDate": "2020-10-20T16:20:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDYwMjIxMg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r514602212", "bodyText": "Maybe this should go with the FirebaseRemoteConfig tests since it's testing the functionality of the get methods? Then the class wouldn't need @VisibleForTesting.", "author": "danasilver", "createdAt": "2020-10-29T22:24:21Z", "path": "firebase-config/src/test/java/com/google/firebase/remoteconfig/internal/PersonalizationTest.java", "diffHunk": "@@ -0,0 +1,213 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+//\n+// You may obtain a copy of the License at\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.remoteconfig.internal;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+import static com.google.firebase.remoteconfig.internal.ConfigFetchHandler.FetchResponse.forBackendUpdatesFetched;\n+import static com.google.firebase.remoteconfig.internal.Personalization.ANALYTICS_ORIGIN_PERSONALIZATION;\n+import static com.google.firebase.remoteconfig.internal.Personalization.ANALYTICS_PULL_EVENT;\n+import static com.google.firebase.remoteconfig.internal.Personalization.ARM_KEY;\n+import static com.google.firebase.remoteconfig.internal.Personalization.ARM_VALUE;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.ArgumentMatchers.eq;\n+import static org.mockito.Mockito.doAnswer;\n+import static org.mockito.Mockito.times;\n+import static org.mockito.Mockito.verify;\n+import static org.mockito.Mockito.when;\n+import static org.mockito.MockitoAnnotations.initMocks;\n+\n+import android.content.Context;\n+import android.os.Bundle;\n+import com.google.android.gms.tasks.Tasks;\n+import com.google.common.util.concurrent.MoreExecutors;\n+import com.google.firebase.FirebaseApp;\n+import com.google.firebase.FirebaseOptions;\n+import com.google.firebase.analytics.connector.AnalyticsConnector;\n+import com.google.firebase.installations.FirebaseInstallationsApi;\n+import com.google.firebase.remoteconfig.FirebaseRemoteConfig;\n+import java.util.ArrayList;\n+import java.util.Date;\n+import java.util.List;\n+import java.util.concurrent.Executor;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import org.robolectric.RobolectricTestRunner;\n+import org.robolectric.RuntimeEnvironment;\n+import org.robolectric.annotation.Config;\n+\n+/** Unit tests for {@link Personalization}. */\n+@RunWith(RobolectricTestRunner.class)\n+@Config(manifest = Config.NONE)\n+public class PersonalizationTest {\n+  private static final String APP_ID = \"1:123:android:test\";\n+  private static final String API_KEY = \"123\";\n+  private static final String PROJECT_ID = \"testApp\";\n+\n+  private static final ConfigContainer CONFIG_CONTAINER;\n+\n+  static {\n+    try {\n+      CONFIG_CONTAINER =\n+          ConfigContainer.newBuilder()\n+              .replaceConfigsWith(\n+                  new JSONObject(\"{key1: 'value1', key2: 'value2', key3: 'value3'}\"))\n+              .withFetchTime(new Date(1))\n+              .withPersonalizationMetadata(\n+                  new JSONObject(\n+                      \"{key1: {personalizationId: 'id1'}, key2: {personalizationId: 'id2'}}\"))\n+              .build();\n+    } catch (JSONException e) {\n+      throw new RuntimeException(e);\n+    }\n+  }\n+\n+  private static final List<Bundle> FAKE_LOGS = new ArrayList<>();\n+\n+  private Personalization personalization;\n+\n+  @Mock private AnalyticsConnector mockAnalyticsConnector;\n+  @Mock private FirebaseInstallationsApi mockFirebaseInstallations;\n+  @Mock private ConfigCacheClient mockFetchedCache;\n+  @Mock private ConfigCacheClient mockActivatedCache;\n+  @Mock private ConfigCacheClient mockDefaultsCache;\n+  @Mock private ConfigFetchHandler mockFetchHandler;\n+  @Mock private ConfigMetadataClient metadataClient;\n+\n+  @Before\n+  public void setUp() {\n+    initMocks(this);\n+\n+    doAnswer(invocation -> FAKE_LOGS.add(invocation.getArgument(2)))\n+        .when(mockAnalyticsConnector)\n+        .logEvent(\n+            eq(ANALYTICS_ORIGIN_PERSONALIZATION), eq(ANALYTICS_PULL_EVENT), any(Bundle.class));\n+\n+    personalization = new Personalization(mockAnalyticsConnector);\n+\n+    FAKE_LOGS.clear();\n+  }\n+\n+  @Test\n+  public void logArmActive_nonPersonalizationKey_notLogged() {\n+    personalization.logArmActive(\"key3\", CONFIG_CONTAINER);\n+\n+    verify(mockAnalyticsConnector, times(0))\n+        .logEvent(\n+            eq(ANALYTICS_ORIGIN_PERSONALIZATION), eq(ANALYTICS_PULL_EVENT), any(Bundle.class));\n+    assertThat(FAKE_LOGS).isEmpty();\n+  }\n+\n+  @Test\n+  public void logArmActive_singlePersonalizationKey_loggedOnce() {\n+    personalization.logArmActive(\"key1\", CONFIG_CONTAINER);\n+\n+    verify(mockAnalyticsConnector, times(1))\n+        .logEvent(\n+            eq(ANALYTICS_ORIGIN_PERSONALIZATION), eq(ANALYTICS_PULL_EVENT), any(Bundle.class));\n+    assertThat(FAKE_LOGS).hasSize(1);\n+\n+    Bundle params = new Bundle();\n+    params.putString(ARM_KEY, \"id1\");\n+    params.putString(ARM_VALUE, \"value1\");\n+    assertThat(FAKE_LOGS.get(0).toString()).isEqualTo(params.toString());\n+  }\n+\n+  @Test\n+  public void logArmActive_multiplePersonalizationKeys_loggedMultiple() {\n+    personalization.logArmActive(\"key1\", CONFIG_CONTAINER);\n+    personalization.logArmActive(\"key2\", CONFIG_CONTAINER);\n+\n+    verify(mockAnalyticsConnector, times(2))\n+        .logEvent(\n+            eq(ANALYTICS_ORIGIN_PERSONALIZATION), eq(ANALYTICS_PULL_EVENT), any(Bundle.class));\n+    assertThat(FAKE_LOGS).hasSize(2);\n+\n+    Bundle params1 = new Bundle();\n+    params1.putString(ARM_KEY, \"id1\");\n+    params1.putString(ARM_VALUE, \"value1\");\n+    assertThat(FAKE_LOGS.get(0).toString()).isEqualTo(params1.toString());\n+\n+    Bundle params2 = new Bundle();\n+    params2.putString(ARM_KEY, \"id2\");\n+    params2.putString(ARM_VALUE, \"value2\");\n+    assertThat(FAKE_LOGS.get(1).toString()).isEqualTo(params2.toString());\n+  }\n+\n+  @Test\n+  public void logArmActive_RemoteConfigIntegration_successful() {", "originalCommit": "1073bb788e29908bedc19b2655fc8ce073f93137", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MTE4Mw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r516241183", "bodyText": "Done.", "author": "vic-flair", "createdAt": "2020-11-02T20:40:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDYwMjIxMg=="}], "type": "inlineReview"}, {"oid": "c97d9ec704093242913ff44839edaa8f16fec289", "url": "https://github.com/firebase/firebase-android-sdk/commit/c97d9ec704093242913ff44839edaa8f16fec289", "message": "Move Personalization integration test to FirebaseRemoteConfigTest.java.", "committedDate": "2020-11-02T20:38:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI1OTg4Ng==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r516259886", "bodyText": "Do we need a different instance of RC for personalization? Using the default namespace will get the same RC instance as frc above.", "author": "danasilver", "createdAt": "2020-11-02T21:19:22Z", "path": "firebase-config/src/test/java/com/google/firebase/remoteconfig/FirebaseRemoteConfigTest.java", "diffHunk": "@@ -189,6 +205,22 @@ public void setUp() throws Exception {\n                 mockFireperfGetHandler,\n                 RemoteConfigComponent.getMetadataClient(context, APP_ID, FIREPERF_NAMESPACE));\n \n+    personalizationFrc =\n+        FirebaseApp.getInstance()\n+            .get(RemoteConfigComponent.class)\n+            .get(\n+                firebaseApp,\n+                RemoteConfigComponent.DEFAULT_NAMESPACE,", "originalCommit": "c97d9ec704093242913ff44839edaa8f16fec289", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzA5MDUwOA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1304#discussion_r517090508", "bodyText": "We need it to use a real ConfigGetParameterHandler so we can test that it's doing things correctly.", "author": "vic-flair", "createdAt": "2020-11-04T04:25:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI1OTg4Ng=="}], "type": "inlineReview"}, {"oid": "d1c9371c062b2255b9387619eeb71db96205f393", "url": "https://github.com/firebase/firebase-android-sdk/commit/d1c9371c062b2255b9387619eeb71db96205f393", "message": "Remove excess logging.", "committedDate": "2020-11-04T20:03:00Z", "type": "commit"}, {"oid": "43400e8a4463ba30cec06ea386558167886aa2bf", "url": "https://github.com/firebase/firebase-android-sdk/commit/43400e8a4463ba30cec06ea386558167886aa2bf", "message": "Remove unused imports.", "committedDate": "2020-11-04T21:24:42Z", "type": "commit"}, {"oid": "ab7f52835ee9c47b0d0f905bd579d0bd4f4a2cb9", "url": "https://github.com/firebase/firebase-android-sdk/commit/ab7f52835ee9c47b0d0f905bd579d0bd4f4a2cb9", "message": "Merge branch 'master' into vlum.p13n", "committedDate": "2020-11-05T01:17:47Z", "type": "commit"}]}