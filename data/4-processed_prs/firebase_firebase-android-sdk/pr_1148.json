{"pr_number": 1148, "pr_title": "Merge FLoC(FirebaseSegmentation) SDK code into master branch", "pr_createdAt": "2020-01-21T22:42:19Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/1148", "timeline": [{"oid": "0d0528232c9f730a469086b40ad12bdfde7eb7a3", "url": "https://github.com/firebase/firebase-android-sdk/commit/0d0528232c9f730a469086b40ad12bdfde7eb7a3", "message": "Add Firebase Segmentation SDK and some skeleton code in Firebase Android SDK (#514)\n\n* Add Firebase Segmentation SDK and some skeleton code in Firebase Android SDK\r\n\r\n* Add Firebase Segmentation SDK and some skeleton code in Firebase Android SDK\r\n\r\n* Address comments #1\r\n\r\n* Address comments #1\r\n\r\n* Address comments #2", "committedDate": "2019-06-13T00:49:19Z", "type": "commit"}, {"oid": "dc46eee03af6193666fd5b9d6e981eecfce65ccc", "url": "https://github.com/firebase/firebase-android-sdk/commit/dc46eee03af6193666fd5b9d6e981eecfce65ccc", "message": "[Firebase Segmentation] Add custom installation id cache layer and tests for it. (#524)\n\n* Add type arguments in StorageTaskManager (#517)\r\n\r\n* Output artifact list during local publishing. (#515)\r\n\r\nThis effort replaces #494.\r\n\r\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* fix functions (#523)\r\n\r\n* fix functions\r\n\r\n* update minsdk version\r\n\r\n* remove idea\r\n\r\n* Set test type to release only in CI. (#522)\r\n\r\n* Set test type to release only in CI.\r\n\r\nThis fixes Android Studio issue, where it is impossible to run\r\nintegration tests in debug mode.\r\n\r\nAdditionally move build type configuration to FirebaseLibraryPlugin to\r\navoid projects.all configuration in gradle.\r\n\r\n* Add comment back.\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Minor fix to error message to match the admin sdk. (#525)\r\n\r\n* Minor fix to error message to match the admin sdk.\r\n\r\nIn particular, it *is* allowed to have slashes, etc in field paths.\r\n\r\n* Added clean task to smoke tests. (#527)\r\n\r\nThis change allows the smoke tests to clean all build variants created\r\nby the infrastructure.\r\n\r\n* Update deps to post-androidx gms versions. (#526)\r\n\r\n* Update deps to post-androidx gms versions.\r\n\r\nAdditionally configure sources.jar for SDKs.\r\n\r\n* Update functions-ktx deps\r\n\r\n* Fix versions.\r\n\r\n* unbump fiam version in fiamui-app\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Copy firebase-firestore-ktx dependencies on firestore into its own subfolder (#528)\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Bump firestore version for release (#530)\r\n\r\nAdditionally fix pom filter to exclude multidex from deps.\r\n\r\n* Google format fix", "committedDate": "2019-06-18T21:03:06Z", "type": "commit"}, {"oid": "a73ebf90dea4185ff4f3a0a450bb7240c9265b26", "url": "https://github.com/firebase/firebase-android-sdk/commit/a73ebf90dea4185ff4f3a0a450bb7240c9265b26", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-06-18T21:06:58Z", "type": "commit"}, {"oid": "8b7380d12b4b3cc22849654afd4282c4a9de3152", "url": "https://github.com/firebase/firebase-android-sdk/commit/8b7380d12b4b3cc22849654afd4282c4a9de3152", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-06-18T22:20:36Z", "type": "commit"}, {"oid": "1274b42b9226ea3f6443dd87d98fb39b2d7af16b", "url": "https://github.com/firebase/firebase-android-sdk/commit/1274b42b9226ea3f6443dd87d98fb39b2d7af16b", "message": "Fix some deprecations (#533)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.", "committedDate": "2019-06-18T22:21:48Z", "type": "commit"}, {"oid": "d9520039c24708e4ee90d401dca8b02e16930529", "url": "https://github.com/firebase/firebase-android-sdk/commit/d9520039c24708e4ee90d401dca8b02e16930529", "message": "package refactor (#534)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.\r\n\r\n* Package refactor\r\n\r\n* nit\r\n\r\n* nit", "committedDate": "2019-06-18T23:06:15Z", "type": "commit"}, {"oid": "a7b5684e0ab150f17f5df7fd1a123b402750221d", "url": "https://github.com/firebase/firebase-android-sdk/commit/a7b5684e0ab150f17f5df7fd1a123b402750221d", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-06-19T23:49:43Z", "type": "commit"}, {"oid": "fdbbdee468ee731e7ba2c9cdf043de1bf87569a1", "url": "https://github.com/firebase/firebase-android-sdk/commit/fdbbdee468ee731e7ba2c9cdf043de1bf87569a1", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-06-20T20:46:36Z", "type": "commit"}, {"oid": "e7fb811fce9cc477f65c75bf8aaa743c2b946921", "url": "https://github.com/firebase/firebase-android-sdk/commit/e7fb811fce9cc477f65c75bf8aaa743c2b946921", "message": "Add the state machine of updating custom installation id in the local cache and update to Firebase Segmentation backend.  (#545)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.\r\n\r\n* Package refactor\r\n\r\n* nit\r\n\r\n* nit\r\n\r\n* Add the state machine of updating custom installation id in the local\r\ncache and update to Firebase Segmentation backend. CL also contains unit\r\ntests.\r\n(The http client is not implemented yet.)\r\n\r\n* minor format fix\r\n\r\n* Address comments #1", "committedDate": "2019-06-24T16:56:25Z", "type": "commit"}, {"oid": "dd16319055d1a8aeb32389fe7d3983e694ef065e", "url": "https://github.com/firebase/firebase-android-sdk/commit/dd16319055d1a8aeb32389fe7d3983e694ef065e", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-06-24T17:01:24Z", "type": "commit"}, {"oid": "0a794dcfc6f96ea3192292e5cb50a73d95da93fe", "url": "https://github.com/firebase/firebase-android-sdk/commit/0a794dcfc6f96ea3192292e5cb50a73d95da93fe", "message": "Merge branch 'floc-master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-06-24T17:01:58Z", "type": "commit"}, {"oid": "a79cae295b13a7d65ed6246fff486d1363890777", "url": "https://github.com/firebase/firebase-android-sdk/commit/a79cae295b13a7d65ed6246fff486d1363890777", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-06-26T20:22:24Z", "type": "commit"}, {"oid": "b4e11e965f9102d2a9feda2b6d4bd9a56090f2b8", "url": "https://github.com/firebase/firebase-android-sdk/commit/b4e11e965f9102d2a9feda2b6d4bd9a56090f2b8", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-07-08T15:10:28Z", "type": "commit"}, {"oid": "d07ec25295de8298f4e18f68b03e2758abf44b76", "url": "https://github.com/firebase/firebase-android-sdk/commit/d07ec25295de8298f4e18f68b03e2758abf44b76", "message": "Http client in Firebase Segmentation SDK to call backend service. (#573)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.\r\n\r\n* Package refactor\r\n\r\n* nit\r\n\r\n* nit\r\n\r\n* Add the state machine of updating custom installation id in the local\r\ncache and update to Firebase Segmentation backend. CL also contains unit\r\ntests.\r\n(The http client is not implemented yet.)\r\n\r\n* minor format fix\r\n\r\n* Address comments #1\r\n\r\n* Http client in Firebase Segmentation SDK to call backend service.\r\n\r\n* Revert unintentional change\r\n\r\n* Fix connected device test\r\n\r\n* Fix connected device test\r\n\r\n* 1. Add a few annotations to make java code Kotlin friendly\r\n2. Some fixes for the http request format\r\n\r\n* Fix java format\r\n\r\n* Fix API version\r\n\r\n* Change the segmentation API implementation to synchronous and put the\r\nentire synchronous code block in async task.\r\n\r\n* Fix a async getResult race issue.\r\n\r\n* OkHttpClient -> HttpsUrlConnection\r\n\r\n* Use gzip for compressing content and fix ourput stream memory leak risk.\r\n\r\n* Addressed a few comments", "committedDate": "2019-07-22T19:39:55Z", "type": "commit"}, {"oid": "8ea4861205fc8610bdbcf0afc1859da16c805cae", "url": "https://github.com/firebase/firebase-android-sdk/commit/8ea4861205fc8610bdbcf0afc1859da16c805cae", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-07-22T19:40:57Z", "type": "commit"}, {"oid": "0990fee668653fbd532a89688895185016153cf7", "url": "https://github.com/firebase/firebase-android-sdk/commit/0990fee668653fbd532a89688895185016153cf7", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-07-30T18:13:30Z", "type": "commit"}, {"oid": "7f30aeaf55ba982e2a9f4825ddb3f36593fb38cc", "url": "https://github.com/firebase/firebase-android-sdk/commit/7f30aeaf55ba982e2a9f4825ddb3f36593fb38cc", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-08-05T23:12:30Z", "type": "commit"}, {"oid": "52d259db3804bed609b5354c7502eddc68133dad", "url": "https://github.com/firebase/firebase-android-sdk/commit/52d259db3804bed609b5354c7502eddc68133dad", "message": "FirebaseSegmentation SDK changes (#673)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.\r\n\r\n* Package refactor\r\n\r\n* nit\r\n\r\n* nit\r\n\r\n* Add the state machine of updating custom installation id in the local\r\ncache and update to Firebase Segmentation backend. CL also contains unit\r\ntests.\r\n(The http client is not implemented yet.)\r\n\r\n* minor format fix\r\n\r\n* Address comments #1\r\n\r\n* Http client in Firebase Segmentation SDK to call backend service.\r\n\r\n* Revert unintentional change\r\n\r\n* Fix connected device test\r\n\r\n* Fix connected device test\r\n\r\n* 1. Add a few annotations to make java code Kotlin friendly\r\n2. Some fixes for the http request format\r\n\r\n* Fix java format\r\n\r\n* Fix API version\r\n\r\n* Change the segmentation API implementation to synchronous and put the\r\nentire synchronous code block in async task.\r\n\r\n* Fix a async getResult race issue.\r\n\r\n* OkHttpClient -> HttpsUrlConnection\r\n\r\n* Use gzip for compressing content and fix ourput stream memory leak risk.\r\n\r\n* Addressed a few comments\r\n\r\n* FirebaseSegmentation SDK\r\n1. Clean up http client response code.\r\n2. When updateCustomInstallationId is called, on non-retryable server errors, the SDK should clean up the local cache. Instead, for retryable errors, SDK can keep the local cache for retrying update later.", "committedDate": "2019-08-06T18:16:50Z", "type": "commit"}, {"oid": "33665b2d47d00614e025d20860dcae68a7ce1b2f", "url": "https://github.com/firebase/firebase-android-sdk/commit/33665b2d47d00614e025d20860dcae68a7ce1b2f", "message": " Restrict Firebase API key to Android app package name. (#690)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.\r\n\r\n* Package refactor\r\n\r\n* nit\r\n\r\n* nit\r\n\r\n* Add the state machine of updating custom installation id in the local\r\ncache and update to Firebase Segmentation backend. CL also contains unit\r\ntests.\r\n(The http client is not implemented yet.)\r\n\r\n* minor format fix\r\n\r\n* Address comments #1\r\n\r\n* Http client in Firebase Segmentation SDK to call backend service.\r\n\r\n* Revert unintentional change\r\n\r\n* Fix connected device test\r\n\r\n* Fix connected device test\r\n\r\n* 1. Add a few annotations to make java code Kotlin friendly\r\n2. Some fixes for the http request format\r\n\r\n* Fix java format\r\n\r\n* Fix API version\r\n\r\n* Change the segmentation API implementation to synchronous and put the\r\nentire synchronous code block in async task.\r\n\r\n* Fix a async getResult race issue.\r\n\r\n* OkHttpClient -> HttpsUrlConnection\r\n\r\n* Use gzip for compressing content and fix ourput stream memory leak risk.\r\n\r\n* Addressed a few comments\r\n\r\n* FirebaseSegmentation SDK\r\n1. Clean up http client response code.\r\n2. When updateCustomInstallationId is called, on non-retryable server errors, the SDK should clean up the local cache. Instead, for retryable errors, SDK can keep the local cache for retrying update later.\r\n\r\n* Restrict Firebase API key to Android app package name.", "committedDate": "2019-08-06T18:57:00Z", "type": "commit"}, {"oid": "f4ba63c6ae1988d43445b4fe21654890e5f210a2", "url": "https://github.com/firebase/firebase-android-sdk/commit/f4ba63c6ae1988d43445b4fe21654890e5f210a2", "message": "Arete floc (#691)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.\r\n\r\n* Package refactor\r\n\r\n* nit\r\n\r\n* nit\r\n\r\n* Add the state machine of updating custom installation id in the local\r\ncache and update to Firebase Segmentation backend. CL also contains unit\r\ntests.\r\n(The http client is not implemented yet.)\r\n\r\n* minor format fix\r\n\r\n* Address comments #1\r\n\r\n* Http client in Firebase Segmentation SDK to call backend service.\r\n\r\n* Revert unintentional change\r\n\r\n* Fix connected device test\r\n\r\n* Fix connected device test\r\n\r\n* 1. Add a few annotations to make java code Kotlin friendly\r\n2. Some fixes for the http request format\r\n\r\n* Fix java format\r\n\r\n* Fix API version\r\n\r\n* Change the segmentation API implementation to synchronous and put the\r\nentire synchronous code block in async task.\r\n\r\n* Fix a async getResult race issue.\r\n\r\n* OkHttpClient -> HttpsUrlConnection\r\n\r\n* Use gzip for compressing content and fix ourput stream memory leak risk.\r\n\r\n* Addressed a few comments\r\n\r\n* FirebaseSegmentation SDK\r\n1. Clean up http client response code.\r\n2. When updateCustomInstallationId is called, on non-retryable server errors, the SDK should clean up the local cache. Instead, for retryable errors, SDK can keep the local cache for retrying update later.\r\n\r\n* Restrict Firebase API key to Android app package name.\r\n\r\n* Explicitly add internet permission", "committedDate": "2019-08-06T20:43:47Z", "type": "commit"}, {"oid": "59439449ef11b1d710d636bf464d47dca3bdc55a", "url": "https://github.com/firebase/firebase-android-sdk/commit/59439449ef11b1d710d636bf464d47dca3bdc55a", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-12-10T19:05:57Z", "type": "commit"}, {"oid": "cb99bb7b86840fc340b407228798aaa4ec48b7cf", "url": "https://github.com/firebase/firebase-android-sdk/commit/cb99bb7b86840fc340b407228798aaa4ec48b7cf", "message": "Disable registrar test for FirebaseSegmentation. (#1050)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.\r\n\r\n* Package refactor\r\n\r\n* nit\r\n\r\n* nit\r\n\r\n* Add the state machine of updating custom installation id in the local\r\ncache and update to Firebase Segmentation backend. CL also contains unit\r\ntests.\r\n(The http client is not implemented yet.)\r\n\r\n* minor format fix\r\n\r\n* Address comments #1\r\n\r\n* Http client in Firebase Segmentation SDK to call backend service.\r\n\r\n* Revert unintentional change\r\n\r\n* Fix connected device test\r\n\r\n* Fix connected device test\r\n\r\n* 1. Add a few annotations to make java code Kotlin friendly\r\n2. Some fixes for the http request format\r\n\r\n* Fix java format\r\n\r\n* Fix API version\r\n\r\n* Change the segmentation API implementation to synchronous and put the\r\nentire synchronous code block in async task.\r\n\r\n* Fix a async getResult race issue.\r\n\r\n* OkHttpClient -> HttpsUrlConnection\r\n\r\n* Use gzip for compressing content and fix ourput stream memory leak risk.\r\n\r\n* Addressed a few comments\r\n\r\n* FirebaseSegmentation SDK\r\n1. Clean up http client response code.\r\n2. When updateCustomInstallationId is called, on non-retryable server errors, the SDK should clean up the local cache. Instead, for retryable errors, SDK can keep the local cache for retrying update later.\r\n\r\n* Restrict Firebase API key to Android app package name.\r\n\r\n* Explicitly add internet permission\r\n\r\n* Disable registrar test for FirebaseSegmentation.", "committedDate": "2019-12-10T19:26:26Z", "type": "commit"}, {"oid": "a5db81c54d7793ac59a04507d680789a716cd893", "url": "https://github.com/firebase/firebase-android-sdk/commit/a5db81c54d7793ac59a04507d680789a716cd893", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-12-10T19:49:51Z", "type": "commit"}, {"oid": "1a51f89fd50a3ed00a98f8861cd72badbd7e4933", "url": "https://github.com/firebase/firebase-android-sdk/commit/1a51f89fd50a3ed00a98f8861cd72badbd7e4933", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2019-12-10T20:53:56Z", "type": "commit"}, {"oid": "fd0a4faf9085a0f0d5fc598a360b9c433b0c91a1", "url": "https://github.com/firebase/firebase-android-sdk/commit/fd0a4faf9085a0f0d5fc598a360b9c433b0c91a1", "message": "Replace the custom installation id cache SharedPref implementation by file implementation. (#1056)\n\n* Implement Firebase segmentation SDK device local cache\r\n\r\n* [Firebase Segmentation] Add custom installation id cache layer and tests for it.\r\n\r\n* Add test for updating cache\r\n\r\n* Switch to use SQLiteOpenHelper\r\n\r\n* Switch to use SharedPreferences from SQLite.\r\n\r\n* Change the cache class to be singleton\r\n\r\n* Wrap shared pref commit in a async task.\r\n\r\n* Address comments\r\n\r\n* Google format fix\r\n\r\n* Replace some deprecated code.\r\n\r\n* Package refactor\r\n\r\n* nit\r\n\r\n* nit\r\n\r\n* Add the state machine of updating custom installation id in the local\r\ncache and update to Firebase Segmentation backend. CL also contains unit\r\ntests.\r\n(The http client is not implemented yet.)\r\n\r\n* minor format fix\r\n\r\n* Address comments #1\r\n\r\n* Http client in Firebase Segmentation SDK to call backend service.\r\n\r\n* Revert unintentional change\r\n\r\n* Fix connected device test\r\n\r\n* Fix connected device test\r\n\r\n* 1. Add a few annotations to make java code Kotlin friendly\r\n2. Some fixes for the http request format\r\n\r\n* Fix java format\r\n\r\n* Fix API version\r\n\r\n* Change the segmentation API implementation to synchronous and put the\r\nentire synchronous code block in async task.\r\n\r\n* Fix a async getResult race issue.\r\n\r\n* OkHttpClient -> HttpsUrlConnection\r\n\r\n* Use gzip for compressing content and fix ourput stream memory leak risk.\r\n\r\n* Addressed a few comments\r\n\r\n* FirebaseSegmentation SDK\r\n1. Clean up http client response code.\r\n2. When updateCustomInstallationId is called, on non-retryable server errors, the SDK should clean up the local cache. Instead, for retryable errors, SDK can keep the local cache for retrying update later.\r\n\r\n* Restrict Firebase API key to Android app package name.\r\n\r\n* Explicitly add internet permission\r\n\r\n* Disable registrar test for FirebaseSegmentation.\r\n\r\n* Disable test lab\r\n\r\n* Add api info for segmentation API\r\n\r\n* [FLoC] Replace the custom installation id cache SharedPref\r\nimplementation by file implementation.", "committedDate": "2019-12-14T00:16:06Z", "type": "commit"}, {"oid": "6e37fb99155f6f844281859edbd786989d7549b5", "url": "https://github.com/firebase/firebase-android-sdk/commit/6e37fb99155f6f844281859edbd786989d7549b5", "message": "[FLoC] Change FLoC instrumental tests to be unit tests. (#1058)\n\n* [FLoC] Change FLoC instrumental tests to be unit tests.", "committedDate": "2019-12-14T07:10:22Z", "type": "commit"}, {"oid": "07366a93a27b949c2421d5ca8bce747da40023a7", "url": "https://github.com/firebase/firebase-android-sdk/commit/07366a93a27b949c2421d5ca8bce747da40023a7", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2020-01-21T22:37:15Z", "type": "commit"}, {"oid": "2f9804497f4454c9deefdf8da6d8fe3e88a803b9", "url": "https://github.com/firebase/firebase-android-sdk/commit/2f9804497f4454c9deefdf8da6d8fe3e88a803b9", "message": "Merge branch 'floc-master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2020-01-21T22:37:56Z", "type": "commit"}, {"oid": "076e7a5e723e7dd5901cdf5d50138421bfb876b3", "url": "https://github.com/firebase/firebase-android-sdk/commit/076e7a5e723e7dd5901cdf5d50138421bfb876b3", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2020-01-22T00:16:23Z", "type": "commit"}, {"oid": "d4498a6ddef6e8dcb55e0c2f246f8ec5eae230de", "url": "https://github.com/firebase/firebase-android-sdk/commit/d4498a6ddef6e8dcb55e0c2f246f8ec5eae230de", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into floc-master", "committedDate": "2020-01-22T23:28:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4NjEzOA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1148#discussion_r370286138", "bodyText": "Is this public api? if not pls add a package-info.java file with an @hide on it.", "author": "vkryachko", "createdAt": "2020-01-23T18:35:01Z", "path": "firebase-segmentation/api.txt", "diffHunk": "@@ -0,0 +1,72 @@\n+// Signature format: 2.0\n+package com.google.firebase.segmentation {\n+\n+  public class FirebaseSegmentation {\n+    method @NonNull public static com.google.firebase.segmentation.FirebaseSegmentation getInstance();\n+    method @NonNull public static com.google.firebase.segmentation.FirebaseSegmentation getInstance(@NonNull com.google.firebase.FirebaseApp);\n+    method @NonNull public com.google.android.gms.tasks.Task<java.lang.Void> setCustomInstallationId(@Nullable String);\n+    field public static final String TAG = \"FirebaseSegmentation\";\n+  }\n+\n+  public class FirebaseSegmentationRegistrar implements com.google.firebase.components.ComponentRegistrar {\n+    ctor public FirebaseSegmentationRegistrar();\n+    method @NonNull public java.util.List<com.google.firebase.components.Component<?>> getComponents();\n+  }\n+\n+  public class SetCustomInstallationIdException extends com.google.firebase.FirebaseException {\n+    method @NonNull public com.google.firebase.segmentation.SetCustomInstallationIdException.Status getStatus();\n+  }\n+\n+  public enum SetCustomInstallationIdException.Status {\n+    enum_constant public static final com.google.firebase.segmentation.SetCustomInstallationIdException.Status BACKEND_ERROR;\n+    enum_constant public static final com.google.firebase.segmentation.SetCustomInstallationIdException.Status CLIENT_ERROR;\n+    enum_constant public static final com.google.firebase.segmentation.SetCustomInstallationIdException.Status DUPLICATED_CUSTOM_INSTALLATION_ID;\n+    enum_constant public static final com.google.firebase.segmentation.SetCustomInstallationIdException.Status UNKOWN;\n+  }\n+\n+}\n+\n+package com.google.firebase.segmentation.local {", "originalCommit": "d4498a6ddef6e8dcb55e0c2f246f8ec5eae230de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMwMDQ1NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1148#discussion_r370300455", "bodyText": "Done", "author": "diwu-arete", "createdAt": "2020-01-23T19:05:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4NjEzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4NjMxNQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1148#discussion_r370286315", "bodyText": "same here and the rest of the packages", "author": "vkryachko", "createdAt": "2020-01-23T18:35:24Z", "path": "firebase-segmentation/api.txt", "diffHunk": "@@ -0,0 +1,72 @@\n+// Signature format: 2.0\n+package com.google.firebase.segmentation {\n+\n+  public class FirebaseSegmentation {\n+    method @NonNull public static com.google.firebase.segmentation.FirebaseSegmentation getInstance();\n+    method @NonNull public static com.google.firebase.segmentation.FirebaseSegmentation getInstance(@NonNull com.google.firebase.FirebaseApp);\n+    method @NonNull public com.google.android.gms.tasks.Task<java.lang.Void> setCustomInstallationId(@Nullable String);\n+    field public static final String TAG = \"FirebaseSegmentation\";\n+  }\n+\n+  public class FirebaseSegmentationRegistrar implements com.google.firebase.components.ComponentRegistrar {\n+    ctor public FirebaseSegmentationRegistrar();\n+    method @NonNull public java.util.List<com.google.firebase.components.Component<?>> getComponents();\n+  }\n+\n+  public class SetCustomInstallationIdException extends com.google.firebase.FirebaseException {\n+    method @NonNull public com.google.firebase.segmentation.SetCustomInstallationIdException.Status getStatus();\n+  }\n+\n+  public enum SetCustomInstallationIdException.Status {\n+    enum_constant public static final com.google.firebase.segmentation.SetCustomInstallationIdException.Status BACKEND_ERROR;\n+    enum_constant public static final com.google.firebase.segmentation.SetCustomInstallationIdException.Status CLIENT_ERROR;\n+    enum_constant public static final com.google.firebase.segmentation.SetCustomInstallationIdException.Status DUPLICATED_CUSTOM_INSTALLATION_ID;\n+    enum_constant public static final com.google.firebase.segmentation.SetCustomInstallationIdException.Status UNKOWN;\n+  }\n+\n+}\n+\n+package com.google.firebase.segmentation.local {\n+\n+  public class CustomInstallationIdCache {\n+    ctor public CustomInstallationIdCache(@NonNull com.google.firebase.FirebaseApp);\n+    method @NonNull public boolean clear();\n+    method @NonNull public boolean insertOrUpdateCacheEntry(@NonNull com.google.firebase.segmentation.local.CustomInstallationIdCacheEntryValue);\n+    method @Nullable public com.google.firebase.segmentation.local.CustomInstallationIdCacheEntryValue readCacheEntryValue();\n+  }\n+\n+  public enum CustomInstallationIdCache.CacheStatus {\n+    enum_constant public static final com.google.firebase.segmentation.local.CustomInstallationIdCache.CacheStatus PENDING_CLEAR;\n+    enum_constant public static final com.google.firebase.segmentation.local.CustomInstallationIdCache.CacheStatus PENDING_UPDATE;\n+    enum_constant public static final com.google.firebase.segmentation.local.CustomInstallationIdCache.CacheStatus SYNCED;\n+  }\n+\n+  public abstract class CustomInstallationIdCacheEntryValue {\n+    ctor public CustomInstallationIdCacheEntryValue();\n+    method @NonNull public static com.google.firebase.segmentation.local.CustomInstallationIdCacheEntryValue create(@NonNull String, @NonNull String, @NonNull com.google.firebase.segmentation.local.CustomInstallationIdCache.CacheStatus);\n+    method @NonNull public abstract com.google.firebase.segmentation.local.CustomInstallationIdCache.CacheStatus getCacheStatus();\n+    method @NonNull public abstract String getCustomInstallationId();\n+    method @NonNull public abstract String getFirebaseInstanceId();\n+  }\n+\n+}\n+\n+package com.google.firebase.segmentation.remote {", "originalCommit": "d4498a6ddef6e8dcb55e0c2f246f8ec5eae230de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDI4NzA3Mg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1148#discussion_r370287072", "bodyText": "pls move it above firebase-storage to keep the lines sorted", "author": "vkryachko", "createdAt": "2020-01-23T18:37:04Z", "path": "subprojects.cfg", "diffHunk": "@@ -28,7 +28,7 @@ firebase-installations\n firebase-storage\n firebase-storage:ktx\n firebase-storage:test-app\n-\n+firebase-segmentation", "originalCommit": "d4498a6ddef6e8dcb55e0c2f246f8ec5eae230de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e65c3b0b05900315b5f5b8f30a099d776481073e", "url": "https://github.com/firebase/firebase-android-sdk/commit/e65c3b0b05900315b5f5b8f30a099d776481073e", "message": "Hide non-public classes.", "committedDate": "2020-01-23T19:06:37Z", "type": "commit"}]}