{"pr_number": 1470, "pr_title": "Added precondition format checks for App-Id and Api-Key", "pr_createdAt": "2020-04-15T20:13:37Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/1470", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTgxMDI1Ng==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1470#discussion_r411810256", "bodyText": "Is there no test that you have to modify?\n(I mean a test that created FirebaseApp without projectId but with gcmSenderId.)", "author": "andirayo", "createdAt": "2020-04-21T01:52:41Z", "path": "firebase-installations/src/main/java/com/google/firebase/installations/FirebaseInstallations.java", "diffHunk": "@@ -146,14 +146,22 @@ private void preConditionChecks() {\n     Preconditions.checkNotEmpty(getApplicationId());\n     Preconditions.checkNotEmpty(getProjectIdentifier());\n     Preconditions.checkNotEmpty(getApiKey());\n+    Preconditions.checkArgument(\n+            Utils.isValidAppIdFormat(getApplicationId()),\n+            \"Please set your Application ID. A valid Firebase App ID is required to communicate \"\n+                    + \"with Firebase server APIs: It identifies your application with Firebase.\"\n+                    + \"Please refer to https://firebase.google.com/support/privacy/init-options.\");\n+    Preconditions.checkArgument(\n+            Utils.isValidApiKeyFormat(getApiKey()),\n+            \"Please set a valid API key. A Firebase API key is required to communicate with \"\n+                    + \"Firebase server APIs: It authenticates your project with Google.\"\n+                    + \"Please refer to https://firebase.google.com/support/privacy/init-options.\");\n   }\n \n   /** Returns the Project Id or Project Number for the Firebase Project. */\n   @Nullable\n   String getProjectIdentifier() {\n-    return TextUtils.isEmpty(firebaseApp.getOptions().getProjectId())\n-        ? firebaseApp.getOptions().getGcmSenderId()\n-        : firebaseApp.getOptions().getProjectId();\n+    return firebaseApp.getOptions().getProjectId();", "originalCommit": "c1ab3aa95bbb135b1bef8f127817a85db665096a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyNzg0NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1470#discussion_r412527845", "bodyText": "No, we don't have", "author": "ChaoqunCHEN", "createdAt": "2020-04-21T22:13:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTgxMDI1Ng=="}], "type": "inlineReview"}, {"oid": "a340e5e8b19f7e3c96a96db9cb5da1cd4939275a", "url": "https://github.com/firebase/firebase-android-sdk/commit/a340e5e8b19f7e3c96a96db9cb5da1cd4939275a", "message": "Added precondition format checks for App-Id and Api-Key", "committedDate": "2020-04-21T21:50:29Z", "type": "commit"}, {"oid": "3893853852059eeef11c93c207961298f69768c2", "url": "https://github.com/firebase/firebase-android-sdk/commit/3893853852059eeef11c93c207961298f69768c2", "message": "Make Firebase Project id/mumber mandatory. GCM sender ID can no longer replace it.", "committedDate": "2020-04-21T21:50:29Z", "type": "commit"}, {"oid": "0e0d421a03d6f16584111e3d3db10dd447086113", "url": "https://github.com/firebase/firebase-android-sdk/commit/0e0d421a03d6f16584111e3d3db10dd447086113", "message": "code formatting", "committedDate": "2020-04-21T21:50:29Z", "type": "commit"}, {"oid": "1b207397892782d77d4cc863ceb6c14c7f98a4f1", "url": "https://github.com/firebase/firebase-android-sdk/commit/1b207397892782d77d4cc863ceb6c14c7f98a4f1", "message": "Added precondition format checks for App-Id and Api-Key", "committedDate": "2020-04-21T22:48:58Z", "type": "commit"}, {"oid": "1b207397892782d77d4cc863ceb6c14c7f98a4f1", "url": "https://github.com/firebase/firebase-android-sdk/commit/1b207397892782d77d4cc863ceb6c14c7f98a4f1", "message": "Added precondition format checks for App-Id and Api-Key", "committedDate": "2020-04-21T22:48:58Z", "type": "forcePushed"}]}