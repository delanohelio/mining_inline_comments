{"pr_number": 1347, "pr_title": "Lint jar for IID Version incompatabiltiy", "pr_createdAt": "2020-03-12T23:00:42Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/1347", "timeline": [{"oid": "4283a2bb3b4434510e061a0d9c4b080595658c2a", "url": "https://github.com/firebase/firebase-android-sdk/commit/4283a2bb3b4434510e061a0d9c4b080595658c2a", "message": "Dropping guava and appcompat dependency from FIS SDK.", "committedDate": "2020-02-06T17:59:09Z", "type": "commit"}, {"oid": "984884cd6f9a90a8172d0957bd13e68e3f06db2f", "url": "https://github.com/firebase/firebase-android-sdk/commit/984884cd6f9a90a8172d0957bd13e68e3f06db2f", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-02-06T18:16:08Z", "type": "commit"}, {"oid": "a82387701d2549bb5fc3b5dc2530a83ed0680d02", "url": "https://github.com/firebase/firebase-android-sdk/commit/a82387701d2549bb5fc3b5dc2530a83ed0680d02", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-02-11T18:58:16Z", "type": "commit"}, {"oid": "afcb14c913c8dedd87faf6b71fdc7dd4384a6c39", "url": "https://github.com/firebase/firebase-android-sdk/commit/afcb14c913c8dedd87faf6b71fdc7dd4384a6c39", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-02-13T23:37:48Z", "type": "commit"}, {"oid": "5574e30b8e3f6c9d09bfca149a6f7853c4141d25", "url": "https://github.com/firebase/firebase-android-sdk/commit/5574e30b8e3f6c9d09bfca149a6f7853c4141d25", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-03-05T16:49:33Z", "type": "commit"}, {"oid": "a5dd4dc54f2b7941ffe4b5cd76b6c8ab5764f7a1", "url": "https://github.com/firebase/firebase-android-sdk/commit/a5dd4dc54f2b7941ffe4b5cd76b6c8ab5764f7a1", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-03-09T16:31:08Z", "type": "commit"}, {"oid": "45312e68fe8516dc4d48a2bfdb422f5023c1241b", "url": "https://github.com/firebase/firebase-android-sdk/commit/45312e68fe8516dc4d48a2bfdb422f5023c1241b", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-03-10T18:13:59Z", "type": "commit"}, {"oid": "f0be4fa07222c687044f66d8cb2859e156611896", "url": "https://github.com/firebase/firebase-android-sdk/commit/f0be4fa07222c687044f66d8cb2859e156611896", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-03-10T21:55:48Z", "type": "commit"}, {"oid": "ac0397ba816265b24da3eca4645761a37d4b46b6", "url": "https://github.com/firebase/firebase-android-sdk/commit/ac0397ba816265b24da3eca4645761a37d4b46b6", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-03-11T18:14:18Z", "type": "commit"}, {"oid": "8f6b46e3346cad5d3a4128ad1316e9e0831c0a2b", "url": "https://github.com/firebase/firebase-android-sdk/commit/8f6b46e3346cad5d3a4128ad1316e9e0831c0a2b", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk", "committedDate": "2020-03-12T19:40:52Z", "type": "commit"}, {"oid": "fe59604397828bfa16ab63ab3d74d3622c7ea914", "url": "https://github.com/firebase/firebase-android-sdk/commit/fe59604397828bfa16ab63ab3d74d3622c7ea914", "message": "Patching vlad's PR and implementing the version incompatability.", "committedDate": "2020-03-12T22:56:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MDQzNw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r391980437", "bodyText": "I don't think developers need this kind of context.\nJust tell them which version to use.\nIf this comment is meant for us, then I would recommend to rephrase:\n\"firebase-iid v20.1.0 is compatible with FirebaseInstallations, but contains a bug that was fixed in v20.1.1\"", "author": "andirayo", "createdAt": "2020-03-13T01:06:16Z", "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -0,0 +1,102 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.installations.lint\n+\n+import com.android.tools.lint.detector.api.Detector\n+\n+import com.android.builder.model.MavenCoordinates\n+import com.android.tools.lint.detector.api.Category\n+import com.android.tools.lint.detector.api.Context\n+import com.android.tools.lint.detector.api.Implementation\n+import com.android.tools.lint.detector.api.Issue\n+import com.android.tools.lint.detector.api.Location\n+import com.android.tools.lint.detector.api.Scope\n+import com.android.tools.lint.detector.api.Severity\n+\n+class IncompatibleIidVersionDetector : Detector() {\n+    companion object Issues {\n+        private val IMPLEMENTATION = Implementation(\n+                IncompatibleIidVersionDetector::class.java,\n+                Scope.EMPTY\n+        )\n+\n+        @JvmField\n+        val INCOMPATIBLE_IID_VERSION = Issue.create(\n+                id = \"IncompatibleIidVersion\",\n+                briefDescription = \"FirebaseInstanceId version is not compatible with FirebaseInstallations\",\n+\n+                explanation = \"\"\"\n+           These versions of FirebaseInstanceId and FirebaseInstallations can not be used in parallel.\n+           Please update your Firebase Instance ID to a version 20.1.0 or later.\n+            \"\"\",\n+                category = Category.INTEROPERABILITY,\n+                priority = 1,\n+                severity = Severity.ERROR,\n+                implementation = IMPLEMENTATION\n+        )\n+    }\n+\n+    override fun beforeCheckEachProject(context: Context) {\n+        if (!context.project.isGradleProject) {\n+            return\n+        }\n+\n+        for (variant in context.project.gradleProjectModel.variants) {\n+            for (lib in variant.mainArtifact.dependencies.libraries) {\n+                val coordinates = lib.resolvedCoordinates\n+                if (coordinates.groupId == \"com.google.firebase\" && coordinates.artifactId == \"firebase-iid\") {\n+                    if (isIncompatibleVersion(coordinates)) {\n+                        context.report(INCOMPATIBLE_IID_VERSION,\n+                                Location.create(context.file),\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {\n+        // firebase-iid v20.1.0 already depended on FirebaseInstallations for identifier creation,\n+        // but had an issue of possible silent failures. Thus, v20.1.1 or later is recommended.\n+        val validIidVersionWithFis = \"20.1.1\"", "originalCommit": "fe59604397828bfa16ab63ab3d74d3622c7ea914", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjQxODkzOA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r392418938", "bodyText": "Updated.", "author": "ankitaj224", "createdAt": "2020-03-13T19:07:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MDQzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MTE4OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r391981189", "bodyText": "There seems to be an inconsistent Inconsistent use of versions!\nSometimes it's 20.1.0, sometimes 20.1.1 (see below).\nI assume that you want to prevent usage of <20.1.0 and recommend usage of v20.1.1...\nI think, you would make your life easier by just marking everything before v20.1.1 as incompatible and keep it consistent.", "author": "andirayo", "createdAt": "2020-03-13T01:09:51Z", "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -0,0 +1,102 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.installations.lint\n+\n+import com.android.tools.lint.detector.api.Detector\n+\n+import com.android.builder.model.MavenCoordinates\n+import com.android.tools.lint.detector.api.Category\n+import com.android.tools.lint.detector.api.Context\n+import com.android.tools.lint.detector.api.Implementation\n+import com.android.tools.lint.detector.api.Issue\n+import com.android.tools.lint.detector.api.Location\n+import com.android.tools.lint.detector.api.Scope\n+import com.android.tools.lint.detector.api.Severity\n+\n+class IncompatibleIidVersionDetector : Detector() {\n+    companion object Issues {\n+        private val IMPLEMENTATION = Implementation(\n+                IncompatibleIidVersionDetector::class.java,\n+                Scope.EMPTY\n+        )\n+\n+        @JvmField\n+        val INCOMPATIBLE_IID_VERSION = Issue.create(\n+                id = \"IncompatibleIidVersion\",\n+                briefDescription = \"FirebaseInstanceId version is not compatible with FirebaseInstallations\",\n+\n+                explanation = \"\"\"\n+           These versions of FirebaseInstanceId and FirebaseInstallations can not be used in parallel.\n+           Please update your Firebase Instance ID to a version 20.1.0 or later.", "originalCommit": "fe59604397828bfa16ab63ab3d74d3622c7ea914", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjQxNjM2Nw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r392416367", "bodyText": "Agreed. Thanks for catching this.", "author": "ankitaj224", "createdAt": "2020-03-13T19:01:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MTE4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjQzNzE5Mw==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r392437193", "bodyText": "This explanation is not the part that developers are most likely to see, instead this is the error they will see in their build:\n/Users/vkryachko/Code/firebase/firebase-android-sdk/firebase-inappmessaging-display: Error: Incompatible IID version found in variant debug: com.google.firebase:firebase-iid:20.0.1@aar [IncompatibleIidVersion]\n\nWith that in mind I think it could be improved in a few ways:\n\nMost likely developers don't have a direct dependency on iid and don't even know what iid is, it might make sense mention that the dependency may be transitive and how it most likely ended up in their build\n\"@aar\" part may confuse developers, consider dropping it\nConsider adding a call for action here like how exactly the problem can be solved with a code example to copy paste into their build file.", "author": "vkryachko", "createdAt": "2020-03-13T19:52:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MTE4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTk4MTgwMg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r391981802", "bodyText": "This method seems unnecessarily complicated.\nCan't we just check for the version that we are interested in?\nkind of like this (pseudo code):\nversionComponents = version.split('.')\n// check if correct SemVer format\nreturn FALSE if 3 != versionComponents.size\n// major version before v20? => incompatible\nreturn FALSE if 20 > versionComponants[0].asInt\n// major version after v21? => compatible\nreturn TRUE if 21 <= versionComponants[0].asInt\n// major version is v20 and minor version major version after v20.1? => compatible\nreturn (1 <= versionComponants[1].asInt)", "author": "andirayo", "createdAt": "2020-03-13T01:12:42Z", "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -0,0 +1,102 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.installations.lint\n+\n+import com.android.tools.lint.detector.api.Detector\n+\n+import com.android.builder.model.MavenCoordinates\n+import com.android.tools.lint.detector.api.Category\n+import com.android.tools.lint.detector.api.Context\n+import com.android.tools.lint.detector.api.Implementation\n+import com.android.tools.lint.detector.api.Issue\n+import com.android.tools.lint.detector.api.Location\n+import com.android.tools.lint.detector.api.Scope\n+import com.android.tools.lint.detector.api.Severity\n+\n+class IncompatibleIidVersionDetector : Detector() {\n+    companion object Issues {\n+        private val IMPLEMENTATION = Implementation(\n+                IncompatibleIidVersionDetector::class.java,\n+                Scope.EMPTY\n+        )\n+\n+        @JvmField\n+        val INCOMPATIBLE_IID_VERSION = Issue.create(\n+                id = \"IncompatibleIidVersion\",\n+                briefDescription = \"FirebaseInstanceId version is not compatible with FirebaseInstallations\",\n+\n+                explanation = \"\"\"\n+           These versions of FirebaseInstanceId and FirebaseInstallations can not be used in parallel.\n+           Please update your Firebase Instance ID to a version 20.1.0 or later.\n+            \"\"\",\n+                category = Category.INTEROPERABILITY,\n+                priority = 1,\n+                severity = Severity.ERROR,\n+                implementation = IMPLEMENTATION\n+        )\n+    }\n+\n+    override fun beforeCheckEachProject(context: Context) {\n+        if (!context.project.isGradleProject) {\n+            return\n+        }\n+\n+        for (variant in context.project.gradleProjectModel.variants) {\n+            for (lib in variant.mainArtifact.dependencies.libraries) {\n+                val coordinates = lib.resolvedCoordinates\n+                if (coordinates.groupId == \"com.google.firebase\" && coordinates.artifactId == \"firebase-iid\") {\n+                    if (isIncompatibleVersion(coordinates)) {\n+                        context.report(INCOMPATIBLE_IID_VERSION,\n+                                Location.create(context.file),\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {\n+        // firebase-iid v20.1.0 already depended on FirebaseInstallations for identifier creation,\n+        // but had an issue of possible silent failures. Thus, v20.1.1 or later is recommended.\n+        val validIidVersionWithFis = \"20.1.1\"\n+\n+        // IID SDK version is incompatible if it is older than the IID SDK version with FIS\n+        // dependency(i.e 20.1.1).\n+        return compareVersions(validIidVersionWithFis, coordinates.version) == 1\n+    }\n+\n+    private fun compareVersions(versionA: String, versionB: String): Int {\n+        val versionAComponents = versionA.split('.').toTypedArray()\n+        val versionBComponents = versionB.split('.').toTypedArray()\n+        val k = Math.min(versionAComponents.size, versionBComponents.size)\n+        for (i in 0..k - 1) {\n+            if (versionAComponents.get(i) > versionBComponents.get(i)) {\n+                return 1\n+            }\n+            if (versionAComponents.get(i) < versionBComponents.get(i)) {\n+                return -1\n+            }\n+        }\n+\n+        if (versionAComponents.size == versionBComponents.size) {\n+            return 0\n+        }\n+        if (versionAComponents.size < versionBComponents.size) {\n+            return -1\n+        } else {\n+            return 1\n+        }\n+    }", "originalCommit": "fe59604397828bfa16ab63ab3d74d3622c7ea914", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e07ec5fb2e085bb6c720c34e66cd1a68a469987a", "url": "https://github.com/firebase/firebase-android-sdk/commit/e07ec5fb2e085bb6c720c34e66cd1a68a469987a", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into lintJar", "committedDate": "2020-03-13T18:51:32Z", "type": "commit"}, {"oid": "832318cdb96ac3225f17b8bd575176e09e25ab4f", "url": "https://github.com/firebase/firebase-android-sdk/commit/832318cdb96ac3225f17b8bd575176e09e25ab4f", "message": "Merging with latest changes and addressing rayo's comments.", "committedDate": "2020-03-13T19:05:44Z", "type": "commit"}, {"oid": "6ac261ff00e51c909aab406f2de57c19475e84ce", "url": "https://github.com/firebase/firebase-android-sdk/commit/6ac261ff00e51c909aab406f2de57c19475e84ce", "message": "Rmoving the patch.", "committedDate": "2020-03-13T19:06:31Z", "type": "commit"}, {"oid": "a77bd376bb5df4c6eee81664bb9d3f8d728aa376", "url": "https://github.com/firebase/firebase-android-sdk/commit/a77bd376bb5df4c6eee81664bb9d3f8d728aa376", "message": "Updating the complicated version check.", "committedDate": "2020-03-13T21:46:56Z", "type": "commit"}, {"oid": "c116bcdb200010e98f541b7841cfa56fab259b04", "url": "https://github.com/firebase/firebase-android-sdk/commit/c116bcdb200010e98f541b7841cfa56fab259b04", "message": "Fixing the comment", "committedDate": "2020-03-13T21:47:27Z", "type": "commit"}, {"oid": "03165121865d9096ec02faae0dec9e3bd4bf4338", "url": "https://github.com/firebase/firebase-android-sdk/commit/03165121865d9096ec02faae0dec9e3bd4bf4338", "message": "Addressing vlad's comments.", "committedDate": "2020-03-13T22:41:26Z", "type": "commit"}, {"oid": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b", "url": "https://github.com/firebase/firebase-android-sdk/commit/0dbbc11b3194409b774cf77e0f147c2c5cb6604b", "message": "Updating the context message", "committedDate": "2020-03-14T02:07:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3ODU4Mg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393378582", "bodyText": "This is against Java readability rules in Google I think. Not sure how this is handled here?", "author": "andirayo", "createdAt": "2020-03-17T00:13:37Z", "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -14,22 +14,15 @@\n \n package com.google.firebase.installations.lint\n \n-import com.android.tools.lint.detector.api.Detector\n-\n import com.android.builder.model.MavenCoordinates\n-import com.android.tools.lint.detector.api.Category\n-import com.android.tools.lint.detector.api.Context\n-import com.android.tools.lint.detector.api.Implementation\n-import com.android.tools.lint.detector.api.Issue\n-import com.android.tools.lint.detector.api.Location\n-import com.android.tools.lint.detector.api.Scope\n-import com.android.tools.lint.detector.api.Severity\n+import com.android.tools.lint.detector.api.*", "originalCommit": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3ODg5Mg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393378892", "bodyText": "Can #toInt throw an exception?\nDo we care?", "author": "andirayo", "createdAt": "2020-03-17T00:15:00Z", "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -59,15 +53,29 @@ class IncompatibleIidVersionDetector : Detector() {\n                     if (isIncompatibleVersion(coordinates)) {\n                         context.report(INCOMPATIBLE_IID_VERSION,\n                                 Location.create(context.file),\n-                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name.removeSuffix(\"@aar\")}.\\n\" +\n+                                        \"To resolve this issue, consider updating the build file to the latest firebase-iid version.\")\n                     }\n                 }\n             }\n         }\n     }\n \n     private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {\n-        // TODO: implement version check\n-        return coordinates.version == \"0.0.0\"\n+        val versionComponents = coordinates.version.split('.').toTypedArray()\n+        // check if correct version format\n+        if (3 != versionComponents.size) {\n+            return true\n+        }\n+        // Incompatible if major version is before v20\n+        if (20 > versionComponents.get(0).toInt()) {", "originalCommit": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3OTA3OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393379079", "bodyText": "Can you tell split to split this into maximum 3 components?\nIf yes, please do so.", "author": "andirayo", "createdAt": "2020-03-17T00:15:46Z", "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -59,15 +53,29 @@ class IncompatibleIidVersionDetector : Detector() {\n                     if (isIncompatibleVersion(coordinates)) {\n                         context.report(INCOMPATIBLE_IID_VERSION,\n                                 Location.create(context.file),\n-                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name.removeSuffix(\"@aar\")}.\\n\" +\n+                                        \"To resolve this issue, consider updating the build file to the latest firebase-iid version.\")\n                     }\n                 }\n             }\n         }\n     }\n \n     private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {\n-        // TODO: implement version check\n-        return coordinates.version == \"0.0.0\"\n+        val versionComponents = coordinates.version.split('.').toTypedArray()", "originalCommit": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4Njc3NA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393386774", "bodyText": "Done.", "author": "ankitaj224", "createdAt": "2020-03-17T00:47:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3OTA3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3OTQzNg==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1347#discussion_r393379436", "bodyText": "Generally it's not a good idea to use negative words in method or variable names.\nThus, I would recommend to call this #isCompatibleInstanceIdVersion", "author": "andirayo", "createdAt": "2020-03-17T00:17:05Z", "path": "firebase-installations/customer-lint-checks/src/main/java/com/google/firebase/installations/lint/IncompatibleIidVersionDetector.kt", "diffHunk": "@@ -59,15 +53,29 @@ class IncompatibleIidVersionDetector : Detector() {\n                     if (isIncompatibleVersion(coordinates)) {\n                         context.report(INCOMPATIBLE_IID_VERSION,\n                                 Location.create(context.file),\n-                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name}\")\n+                                \"Incompatible IID version found in variant ${variant.name}: ${lib.name.removeSuffix(\"@aar\")}.\\n\" +\n+                                        \"To resolve this issue, consider updating the build file to the latest firebase-iid version.\")\n                     }\n                 }\n             }\n         }\n     }\n \n     private fun isIncompatibleVersion(coordinates: MavenCoordinates): Boolean {", "originalCommit": "0dbbc11b3194409b774cf77e0f147c2c5cb6604b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "350b15128b2beb5d681aa5f5090f3dad3a9714cd", "url": "https://github.com/firebase/firebase-android-sdk/commit/350b15128b2beb5d681aa5f5090f3dad3a9714cd", "message": "Addressing Rayo's comments", "committedDate": "2020-03-17T00:46:54Z", "type": "commit"}, {"oid": "19bc81debdd13a9901d582efb7b2021a1c640c9a", "url": "https://github.com/firebase/firebase-android-sdk/commit/19bc81debdd13a9901d582efb7b2021a1c640c9a", "message": "Merge branch 'master' of github.com:firebase/firebase-android-sdk into lintJar", "committedDate": "2020-03-17T16:27:05Z", "type": "commit"}]}