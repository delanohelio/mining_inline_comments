{"pr_number": 1227, "pr_title": "Send CrashlyticsReports through DataTransport", "pr_createdAt": "2020-02-07T22:07:04Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/1227", "timeline": [{"oid": "970a1f3f740aea84ce2032c476ca8c84bb344d23", "url": "https://github.com/firebase/firebase-android-sdk/commit/970a1f3f740aea84ce2032c476ca8c84bb344d23", "message": "Send CrashlyticsReports through DataTransport", "committedDate": "2020-02-07T22:05:44Z", "type": "commit"}, {"oid": "0d60b2b1a6ae3d4afbba5c40e92dd1a73f44c266", "url": "https://github.com/firebase/firebase-android-sdk/commit/0d60b2b1a6ae3d4afbba5c40e92dd1a73f44c266", "message": "Formatting", "committedDate": "2020-02-07T22:32:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODg0OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1227#discussion_r377218848", "bodyText": "Is there a good reason to make this new callback type here instead of using a Task<CrashlyticsReport>?\nIt seems like this is the perfect use case for a Promise -- a result or error that gets resolved at most once.", "author": "bklimt", "createdAt": "2020-02-10T17:49:49Z", "path": "firebase-crashlytics/src/main/java/com/google/firebase/crashlytics/internal/send/DataTransportCrashlyticsReportSender.java", "diffHunk": "@@ -0,0 +1,91 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.crashlytics.internal.send;\n+\n+import android.content.Context;\n+import androidx.annotation.NonNull;\n+import com.google.android.datatransport.Encoding;\n+import com.google.android.datatransport.Event;\n+import com.google.android.datatransport.Transport;\n+import com.google.android.datatransport.cct.CCTDestination;\n+import com.google.android.datatransport.runtime.TransportRuntime;\n+import com.google.firebase.crashlytics.internal.model.CrashlyticsReport;\n+import com.google.firebase.crashlytics.internal.model.serialization.CrashlyticsReportJsonTransform;\n+import java.nio.charset.Charset;\n+import java.util.List;\n+\n+/**\n+ * This class is responsible for sending CrashlyticsReport objects to Crashlytics through Google\n+ * DataTransport.\n+ */\n+public class DataTransportCrashlyticsReportSender {\n+\n+  private static final CrashlyticsReportJsonTransform TRANSFORM =\n+      new CrashlyticsReportJsonTransform();\n+  private static final String CRASHLYTICS_ENDPOINT =\n+      mergeStrings(\"hts/cahyiseot-agolai.o/1frlglgc/aclg\", \"tp:/rsltcrprsp.ogepscmv/ieo/eaybtho\");\n+  private static final String CRASHLYTICS_API_KEY =\n+      mergeStrings(\"AzSBpY4F0rHiHFdinTvM\", \"IayrSTFL9eJ69YeSUO2\");\n+  private static final String CRASHLYTICS_TRANSPORT_NAME = \"FIREBASE_CRASHLYTICS_REPORT\";\n+\n+  private final Transport<CrashlyticsReport> transport;\n+  private final SendCallback<CrashlyticsReport> sendCallback;\n+\n+  static DataTransportCrashlyticsReportSender create(", "originalCommit": "0d60b2b1a6ae3d4afbba5c40e92dd1a73f44c266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI2Mjk2OQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1227#discussion_r377262969", "bodyText": "I'd originally written this to map to the underlying callback, but I'll take another look. I think you're right.", "author": "mrwillis21", "createdAt": "2020-02-10T19:16:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzMzMDQ2NA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1227#discussion_r377330464", "bodyText": "Okay, talked about this in person - going to hold off on this for now, but may move the loop up a level and have a sendReport method that returns a single Task. Will revisit after all the \"thin thread\" changes are in.", "author": "mrwillis21", "createdAt": "2020-02-10T21:36:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIxODg0OA=="}], "type": "inlineReview"}]}