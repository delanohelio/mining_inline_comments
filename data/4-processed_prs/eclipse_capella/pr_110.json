{"pr_number": 110, "pr_title": "[560715] Avoid inter-resource set dependencies with platform plug-in elements", "pr_createdAt": "2020-03-03T13:39:44Z", "pr_url": "https://github.com/eclipse/capella/pull/110", "timeline": [{"oid": "69414b611b5212738531918d3e6f300b85ca61e6", "url": "https://github.com/eclipse/capella/commit/69414b611b5212738531918d3e6f300b85ca61e6", "message": "[560715] Avoid inter-resource set dependencies with platform plug-in\nelements\n\nBug: 560715\nChange-Id: I63676ea870a5e8bcc6969fd612701e9bcc6fae04\nSigned-off-by: Olivier Constant <olivier.constant@thalesgroup.com>", "committedDate": "2020-03-03T13:13:50Z", "type": "commit"}, {"oid": "2d0e39b4c3483826ca6c9d3f1793cbb1f8d34379", "url": "https://github.com/eclipse/capella/commit/2d0e39b4c3483826ca6c9d3f1793cbb1f8d34379", "message": "[560715] Add junit\n\nBug: 560715\nChange-Id: I4cc004928fa6fb9ad9cdcfa03dae130e6cc7b89d\nSigned-off-by: Philippe DUL <philippe.dul@thalesgroup.com>", "committedDate": "2020-03-03T15:17:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA5MTU2Mg==", "url": "https://github.com/eclipse/capella/pull/110#discussion_r387091562", "bodyText": "Are you sure about the false?\nDoes external resources are loaded as long as scope is used in diffmerge?", "author": "pdulth", "createdAt": "2020-03-03T15:20:10Z", "path": "core/plugins/org.polarsys.capella.core.compare/src/org/polarsys/capella/core/compare/CapellaScope.java", "diffHunk": "@@ -282,6 +292,36 @@ protected IFile getFileFor(Resource resource) {\n     return result;\n   }\n   \n+  /**\n+   * Return a scope-local element that corresponds to the given one, if any, otherwise return\n+   * the given element\n+   * @param element a potentially null element\n+   * @return an element that is null if and only if the given element is null\n+   */\n+  protected EObject getLocalElement(EObject element) {\n+    EObject result = element;\n+    ResourceSet localResourceSet = _resourceSet;\n+    if (element != null && localResourceSet != null ) {\n+      Resource valueResource = element.eResource();\n+      if (valueResource != null && localResourceSet != valueResource.getResourceSet()) {\n+        // Element belongs to another resource set\n+        URI valueResourceURI = valueResource.getURI();\n+        if (valueResourceURI != null && valueResourceURI.isPlatformPlugin()) {\n+          // And element belongs to a platform plug-in\n+          URI valueURI = EcoreUtil.getURI(element);\n+          if (valueURI != null) {\n+            // Try and get the same element (URI-based) in the local resource set\n+            EObject localElement = localResourceSet.getEObject(valueURI, false);", "originalCommit": "2d0e39b4c3483826ca6c9d3f1793cbb1f8d34379", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA5ODMxMA==", "url": "https://github.com/eclipse/capella/pull/110#discussion_r387098310", "bodyText": "The rationale is to have as little impact as possible: if the desired element is not readily available, then the usual behavior is executed. It does not otherwise seem harmful to me because we are in a context (scope modification through add(...)) where the scope is supposed to have been loaded already. Also, the FragmentedModelScope base class was not intended to allow additional loading (using true) from a modification method such as add(...).", "author": "oconstant", "createdAt": "2020-03-03T15:29:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA5MTU2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzEzMDAwMA==", "url": "https://github.com/eclipse/capella/pull/110#discussion_r387130000", "bodyText": "Ok, i have updated junit accordingly", "author": "pdulth", "createdAt": "2020-03-03T16:14:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA5MTU2Mg=="}], "type": "inlineReview"}, {"oid": "7adae76942576dfd25ceaede2e6186fff4798977", "url": "https://github.com/eclipse/capella/commit/7adae76942576dfd25ceaede2e6186fff4798977", "message": "[560715] Update junit accordingly\n\nBug: 560715\nChange-Id: I8ce75815686a5fa9a21f0a36d046e52a70f99d1f\nSigned-off-by: Philippe DUL <philippe.dul@thalesgroup.com>", "committedDate": "2020-03-03T16:14:19Z", "type": "commit"}]}