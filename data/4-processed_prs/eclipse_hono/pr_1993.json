{"pr_number": 1993, "pr_title": "[#1679] Integration tests for the mongo db based device registry", "pr_createdAt": "2020-05-28T13:32:40Z", "pr_url": "https://github.com/eclipse/hono/pull/1993", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjMzNTkzMA==", "url": "https://github.com/eclipse/hono/pull/1993#discussion_r432335930", "bodyText": "IMHO we should also skip building the image if the MongoDB profile is disabled", "author": "sophokles73", "createdAt": "2020-05-29T08:32:19Z", "path": "tests/pom.xml", "diffHunk": "@@ -223,6 +239,54 @@ Test cases are run against Docker images of Hono server + (Apache Qpid Dispatch\n               <autoCreateCustomNetworks>true</autoCreateCustomNetworks>\n               <startParallel>false</startParallel>\n               <images>\n+                <!-- ##### Mongo DB instance for the device registry ##### -->\n+                <image>\n+                  <name>${docker.image.org-name}/hono-mongodb-test</name>\n+                  <alias>mongo</alias>\n+                  <build>\n+                    <imagePullPolicy>IfNotPresent</imagePullPolicy>", "originalCommit": "437e1324601cba4c043bb11044c6990c63fb5fd3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQxMjkwMg==", "url": "https://github.com/eclipse/hono/pull/1993#discussion_r434412902", "bodyText": "It makes sense and I have now skipped building the image if the MongoDB profile is disabled. Would you mind taking a look again?", "author": "kaniyan", "createdAt": "2020-06-03T08:55:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjMzNTkzMA=="}], "type": "inlineReview"}, {"oid": "a7cb9f8ef8fa107dc1d574ae6bcd753158579462", "url": "https://github.com/eclipse/hono/commit/a7cb9f8ef8fa107dc1d574ae6bcd753158579462", "message": "[#1679] Integration tests for the mongo db based device registry\n\nSigned-off-by: Kartheeswaran Kalidass <kartheeswaran.kalidass@bosch.io>", "committedDate": "2020-06-03T08:48:35Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQzNDM0NQ==", "url": "https://github.com/eclipse/hono/pull/1993#discussion_r434434345", "bodyText": "please use ${log.color.hono-device-registry} instead", "author": "sophokles73", "createdAt": "2020-06-03T09:30:27Z", "path": "tests/pom.xml", "diffHunk": "@@ -228,6 +244,55 @@ Test cases are run against Docker images of Hono server + (Apache Qpid Dispatch\n               <autoCreateCustomNetworks>true</autoCreateCustomNetworks>\n               <startParallel>false</startParallel>\n               <images>\n+                <!-- ##### Mongo DB instance for the device registry ##### -->\n+                <image>\n+                  <name>${docker.image.org-name}/hono-mongodb-test</name>\n+                  <alias>mongo</alias>\n+                  <build>\n+                    <skip>${hono.mongodb.disabled}</skip>\n+                    <imagePullPolicy>IfNotPresent</imagePullPolicy>\n+                    <from>${hono.mongodb.image.name}</from>\n+                    <assembly>\n+                      <mode>dir</mode>\n+                      <basedir>/</basedir>\n+                      <inline>\n+                        <id>config</id>\n+                          <fileSet>\n+                            <directory>${project.build.directory}/resources/mongodb/init_db</directory>\n+                            <outputDirectory>docker-entrypoint-initdb.d/</outputDirectory>\n+                            <includes>\n+                              <include>*</include>\n+                            </includes>\n+                          </fileSet>\n+                      </inline>\n+                    </assembly>\n+                  </build>\n+                  <run>\n+                    <skip>${hono.mongodb.disabled}</skip>\n+                    <ports>\n+                      <port>+mongodb.ip:mongodb.port:${hono.mongodb.port}</port>\n+                    </ports>\n+                    <portPropertyFile>${project.build.directory}/docker/mongodb.port.properties</portPropertyFile>\n+                    <env>\n+                      <MONGO_INITDB_DATABASE>${hono.mongodb.database.name}</MONGO_INITDB_DATABASE>\n+                    </env>\n+                    <network>\n+                      <mode>custom</mode>\n+                      <name>hono</name>\n+                      <alias>${hono.mongodb.host}</alias>\n+                    </network>\n+                    <memorySwap>314572800</memorySwap>\n+                    <memory>314572800</memory>\n+                    <log>\n+                      <prefix>MONGODB</prefix>\n+                      <color>green</color>", "originalCommit": "a7cb9f8ef8fa107dc1d574ae6bcd753158579462", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQ1Mzg3NA==", "url": "https://github.com/eclipse/hono/pull/1993#discussion_r434453874", "bodyText": "I have updated it.", "author": "kaniyan", "createdAt": "2020-06-03T10:03:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQzNDM0NQ=="}], "type": "inlineReview"}, {"oid": "a75a551c155d545a7baca4f76ed7ecb64550f7c5", "url": "https://github.com/eclipse/hono/commit/a75a551c155d545a7baca4f76ed7ecb64550f7c5", "message": "[#1679] Integration tests for the mongo db based device registry\n\nSigned-off-by: Kartheeswaran Kalidass <kartheeswaran.kalidass@bosch.io>", "committedDate": "2020-06-03T09:57:33Z", "type": "commit"}, {"oid": "1d738be0a3fa8dc3f30bf48531d5f24b6b24f7b0", "url": "https://github.com/eclipse/hono/commit/1d738be0a3fa8dc3f30bf48531d5f24b6b24f7b0", "message": "Use corresponding property for the log color\n\nSigned-off-by: Kartheeswaran Kalidass <kartheeswaran.kalidass@bosch.io>", "committedDate": "2020-06-03T10:01:06Z", "type": "commit"}, {"oid": "1d738be0a3fa8dc3f30bf48531d5f24b6b24f7b0", "url": "https://github.com/eclipse/hono/commit/1d738be0a3fa8dc3f30bf48531d5f24b6b24f7b0", "message": "Use corresponding property for the log color\n\nSigned-off-by: Kartheeswaran Kalidass <kartheeswaran.kalidass@bosch.io>", "committedDate": "2020-06-03T10:01:06Z", "type": "forcePushed"}]}