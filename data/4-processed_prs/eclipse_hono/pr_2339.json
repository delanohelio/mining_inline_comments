{"pr_number": 2339, "pr_title": "[#2338] Fix NPE in AMQP adapter when content-type is null.", "pr_createdAt": "2020-12-01T19:15:40Z", "pr_url": "https://github.com/eclipse/hono/pull/2339", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk1Mzg4Mg==", "url": "https://github.com/eclipse/hono/pull/2339#discussion_r533953882", "bodyText": "A hint in the javadoc about the default value would be good here (like in MqttContext#contentType).", "author": "calohmn", "createdAt": "2020-12-02T07:40:37Z", "path": "adapters/amqp-vertx/src/main/java/org/eclipse/hono/adapter/amqp/impl/AmqpContext.java", "diffHunk": "@@ -105,7 +105,7 @@ final int getPayloadSize() {\n      * @return The content type of the AMQP 1.0 message.\n      */\n     final String getMessageContentType() {\n-        return message.getContentType();\n+        return Optional.ofNullable(message.getContentType()).orElse(MessageHelper.CONTENT_TYPE_OCTET_STREAM);", "originalCommit": "ecbd560356b4d198626378234b063dc302799dad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk4Mzc0MQ==", "url": "https://github.com/eclipse/hono/pull/2339#discussion_r533983741", "bodyText": "Sure. Will add.", "author": "b-abel", "createdAt": "2020-12-02T08:37:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk1Mzg4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0ODA3Nw==", "url": "https://github.com/eclipse/hono/pull/2339#discussion_r534048077", "bodyText": "Done.", "author": "b-abel", "createdAt": "2020-12-02T10:13:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk1Mzg4Mg=="}], "type": "inlineReview"}, {"oid": "7e0963e13d285023a606b85355b6006859ee3339", "url": "https://github.com/eclipse/hono/commit/7e0963e13d285023a606b85355b6006859ee3339", "message": "[#2338] AmqpContext.getMessageContentType() no longer returns null.\n\nIf the AMQP message in AmqpContext does not contain a content type, the default\ncontent type is returned. This is necessary because Telemetry and Event API\nrequire a content type to be set.\n\nSigned-off-by: Abel Buechner-Mihaljevic <abel.buechner-mihaljevic@bosch.io>", "committedDate": "2020-12-02T10:12:42Z", "type": "commit"}, {"oid": "7e0963e13d285023a606b85355b6006859ee3339", "url": "https://github.com/eclipse/hono/commit/7e0963e13d285023a606b85355b6006859ee3339", "message": "[#2338] AmqpContext.getMessageContentType() no longer returns null.\n\nIf the AMQP message in AmqpContext does not contain a content type, the default\ncontent type is returned. This is necessary because Telemetry and Event API\nrequire a content type to be set.\n\nSigned-off-by: Abel Buechner-Mihaljevic <abel.buechner-mihaljevic@bosch.io>", "committedDate": "2020-12-02T10:12:42Z", "type": "forcePushed"}]}