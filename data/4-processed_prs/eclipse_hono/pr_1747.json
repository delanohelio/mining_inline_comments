{"pr_number": 1747, "pr_title": "Update documentation for removal of the obsolete DataVolumePeriod", "pr_createdAt": "2020-02-05T15:26:54Z", "pr_url": "https://github.com/eclipse/hono/pull/1747", "timeline": [{"oid": "c4dae22bd84200e28c9c6ac8afb16fc061940004", "url": "https://github.com/eclipse/hono/commit/c4dae22bd84200e28c9c6ac8afb16fc061940004", "message": "Update documentation for removal of the obsolete DataVolumePeriod.\n\nSigned-off-by: Kartheeswaran Kalidass <Kartheeswaran.Kalidass@bosch.io>", "committedDate": "2020-02-05T16:00:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4ODA3OA==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375388078", "bodyText": "This actually constitutes a breaking change of the (public) Tenant API. I don't think that we can do this in 1.1.0. However, IIRC the Prometheus based resource limits check currently expects to always find this information, doesn't it? If so, we will need to change this and fall back to a default value (e.g. monthly) if no resource limits period is specified.\nThe HTTP management API also does not require this to be specified when defining Data Volume limits for a tenant.", "author": "sophokles73", "createdAt": "2020-02-05T17:07:16Z", "path": "site/documentation/content/api/tenant/index.md", "diffHunk": "@@ -279,18 +270,18 @@ The table below contains the properties which are used to configure a tenant's d\n | :------------------------| :-------: | :------------ | :------------ | :---------- |\n | *effective-since*        | *yes*     | *string*      | `-`           | The point in time at which the current settings became effective, i.e. the start of the first accounting period based on these settings. The value MUST be an [ISO 8601 compliant *combined date and time representation in extended format*](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations).|\n | *max-bytes*              | *no*      | *number*      | `-1`          | The maximum number of bytes allowed for the tenant for each accounting period. MUST be an integer. A negative value indicates that no limit is set. |\n-| *period*                 | *no*      | *object*      | `-`          | The mode and length of an accounting period, i.e. the data usage can limited based on the defined number of days or on a monthly basis. |\n+| *period*                 | *yes*      | *object*     | `-`           | The mode and length of an accounting period, i.e. the data usage can limited based on the defined number of days or on a monthly basis. For more information, please refer to the [resource limits period]({{< relref \"#resource-limits-period-configuration-format\" >}}).|", "originalCommit": "c4dae22bd84200e28c9c6ac8afb16fc061940004", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQwMDUyNQ==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375400525", "bodyText": "I would update the documentation here to set is as optional and a separate PR for setting the default value to monthly. WDYT?", "author": "kaniyan", "createdAt": "2020-02-05T17:29:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4ODA3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTY3NDE2Nw==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375674167", "bodyText": "If we change this to optional then the Prometheus based implementation breaks. So, I'd rather have that case handled as part of this PR.", "author": "sophokles73", "createdAt": "2020-02-06T07:26:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4ODA3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTcxNTQ1NQ==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375715455", "bodyText": "As part of this PR, I would change the period as optional and set the default value to monthly for both DataVolume and the ConnectionDuration. Just to make sure before making any changes.", "author": "kaniyan", "createdAt": "2020-02-06T09:13:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4ODA3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTgxMjA5OQ==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375812099", "bodyText": "This PR should not change the period from being optional (as it had been before).\nWe should probably document, that if the period is not set explicitly, monthly is assumed as the default value. The Prometheus based implementation needs to be adapted accordingly.", "author": "sophokles73", "createdAt": "2020-02-06T12:43:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4ODA3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTkwMjY3Nw==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375902677", "bodyText": "This actually constitutes a breaking change of the (public) Tenant API. I don't think that we can do this in 1.1.0.\n\n@sophokles73 Please correct me if I am wrong. Removing DataVolumePeriod type from Tenant API FMPOV is also a breaking change of the (public) Tenant API in 1.1.0. May be we should remove that  in 2.0.0. Unless the users replace it with the new ResourceLimitsPeriod type the build fails.", "author": "kaniyan", "createdAt": "2020-02-06T15:29:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4ODA3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTkwNTY4OQ==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375905689", "bodyText": "Not sure what you mean by the build fails. Which build is that?", "author": "sophokles73", "createdAt": "2020-02-06T15:33:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4ODA3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4OTgwOQ==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375389809", "bodyText": "Since this is a new (optional) type of limits we are introducing, it is ok to define it as mandatory from a formal point of view. However, IMHO we should keep this aligned with the Data Volume limit and thus better keep it optional, also defining a fall-back default if not set explicitly. The HTTP Management API also needs to be adapted accordingly", "author": "sophokles73", "createdAt": "2020-02-05T17:10:19Z", "path": "site/documentation/content/api/tenant/index.md", "diffHunk": "@@ -258,19 +258,10 @@ The table below contains the properties which are used to configure a tenant's c\n | :------------------------| :-------: | :------------ | :------------ | :---------- |\n | *effective-since*        | *yes*     | *string*      | `-`           | The point in time at which the current settings became effective, i.e. the start of the first accounting period based on these settings. The value MUST be an [ISO 8601 compliant *combined date and time representation in extended format*](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations).|\n | *max-minutes*            | *no*      | *number*      | `-1`        | The maximum connection duration in minutes allowed for the tenant for each accounting period. MUST be an integer. Minus one indicates that no limit is set. |\n-| *period*                 | *no*      | *object*      | `-`          | The mode and length of an accounting period, i.e. the resource usage is calculated based on the defined number of days or on a monthly basis. |\n+| *period*                 | *yes*     | *object*      | `-`         | The mode and length of an accounting period, i.e. the resource usage is calculated based on the defined number of days or on a monthly basis.  For more information, please refer to the [resource limits period]({{< relref \"#resource-limits-period-configuration-format\" >}}).|", "originalCommit": "c4dae22bd84200e28c9c6ac8afb16fc061940004", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM5ODc0Nw==", "url": "https://github.com/eclipse/hono/pull/1747#discussion_r375398747", "bodyText": "It makes sense to keep it optional and in sync with that of the DataVolume. I would update the documentation here and also the HTTP Management API to set it as optional. I would propose a separate PR for setting the default value to monthly.", "author": "kaniyan", "createdAt": "2020-02-05T17:26:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4OTgwOQ=="}], "type": "inlineReview"}, {"oid": "f3b6d339497855355e95eb80f0578867f0435b48", "url": "https://github.com/eclipse/hono/commit/f3b6d339497855355e95eb80f0578867f0435b48", "message": "Adapt resource limit checks API and it's default implementation.\n- The default resource limit checks implementation now uses `monthly` as the default mode when no period is explicitly given.\n- The Period is no more mandatory in case of the connection duration configuration.\n- The documentation has been updated for the above points and for the removal of the obsolete DataVolumePeriod.", "committedDate": "2020-02-06T16:59:47Z", "type": "forcePushed"}, {"oid": "695bac55e7df1c99000a07338a824797b0cbf6c3", "url": "https://github.com/eclipse/hono/commit/695bac55e7df1c99000a07338a824797b0cbf6c3", "message": "Adapt resource limit checks API and it's default implementation.\n\n- The default resource limit checks implementation now uses `monthly` as the default mode when no period is explicitly given.\n- The Period is no more mandatory in case of the connection duration configuration.\n- The documentation has been updated for the above points and for the removal of the obsolete DataVolumePeriod.\n\nSigned-off-by: Kartheeswaran Kalidass <Kartheeswaran.Kalidass@bosch.io>", "committedDate": "2020-02-06T17:11:31Z", "type": "commit"}, {"oid": "695bac55e7df1c99000a07338a824797b0cbf6c3", "url": "https://github.com/eclipse/hono/commit/695bac55e7df1c99000a07338a824797b0cbf6c3", "message": "Adapt resource limit checks API and it's default implementation.\n\n- The default resource limit checks implementation now uses `monthly` as the default mode when no period is explicitly given.\n- The Period is no more mandatory in case of the connection duration configuration.\n- The documentation has been updated for the above points and for the removal of the obsolete DataVolumePeriod.\n\nSigned-off-by: Kartheeswaran Kalidass <Kartheeswaran.Kalidass@bosch.io>", "committedDate": "2020-02-06T17:11:31Z", "type": "forcePushed"}]}