{"pr_number": 1837, "pr_title": "Add coap user-guide.", "pr_createdAt": "2020-03-13T13:59:34Z", "pr_url": "https://github.com/eclipse/hono/pull/1837", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzMwMw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392867303", "bodyText": "is this actually the case?", "author": "sophokles73", "createdAt": "2020-03-16T09:00:09Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. ", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ5MTQyMg==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393491422", "bodyText": "checkMessageLimit is called, but I didn't check, if it really works.\n@kaniyan\nAnything else, which must be called?", "author": "boaks", "createdAt": "2020-03-17T07:42:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzMwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUxNDE0MQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393514141", "bodyText": "@boaks The adapters use only checkMessageLimit from the base class to verify message limit.", "author": "kaniyan", "createdAt": "2020-03-17T08:33:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzMwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MjgxNA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393542814", "bodyText": "However, my understanding is that we (currently) do not report established (DTLS) connections so we are probably only checking for overall message data volume. If so, we should document this fact here ...", "author": "sophokles73", "createdAt": "2020-03-17T09:25:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzMwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2NDcxMw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393564713", "bodyText": "You mean, add that there is currently no forced \"connection limit\"?", "author": "boaks", "createdAt": "2020-03-17T10:02:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzMwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYyMDEzOA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393620138", "bodyText": "yes, I would propose to do so.", "author": "sophokles73", "createdAt": "2020-03-17T11:45:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzMwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY0OTQ1OA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393649458", "bodyText": "Ok", "author": "boaks", "createdAt": "2020-03-17T12:41:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzMwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzQ4OA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392867488", "bodyText": "the second sentence seems to be garbled ...", "author": "sophokles73", "createdAt": "2020-03-16T09:00:30Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY0OTc1NQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393649755", "bodyText": "Please verify, that the new version is not that garbled", "author": "boaks", "createdAt": "2020-03-17T12:41:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2NzQ4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2ODk1OA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392868958", "bodyText": "I wonder how this should work since there (currently?) is no way to map arbitrary content type strings provided by a downstream application to a CoAP content type option value, or is there?", "author": "sophokles73", "createdAt": "2020-03-16T09:03:27Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.\n+* Response Options:\n+  * (optional) `content-type`: A media type describing the semantics and format of payload contained in the response body. This header will only be present if the response contains a command to be executed by the device which requires input data.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ5NDcyMA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393494720", "bodyText": "That simply requires a IANA registration for the content type :-).\n\"arbitrary content type strings\" as the \"\"application/vnd.eclipse-hono-empty-notification\" don't work. Maybe adding a supported content-type table at the bottom helps here.", "author": "boaks", "createdAt": "2020-03-17T07:51:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2ODk1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MzQ5Mw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393543493", "bodyText": "That would be a start. We will also need to document what we do with unsupported content-types, right?", "author": "sophokles73", "createdAt": "2020-03-17T09:26:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2ODk1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY1NjQxOA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393656418", "bodyText": "\"unsupported content-types\" from \"north-bound\"? They are ignored.\nAre there other possibilities? Commands? One-Way commands?", "author": "boaks", "createdAt": "2020-03-17T12:53:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2ODk1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2OTI4Nw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392869287", "bodyText": "seems to be optional if there is a way to indicate that the request doesn't contain payload ...", "author": "sophokles73", "createdAt": "2020-03-16T09:04:10Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ5NTE5NQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393495195", "bodyText": "The same is true for http, so it maybe corrected there as well.", "author": "boaks", "createdAt": "2020-03-17T07:52:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2OTI4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0MzY4Mw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393543683", "bodyText": "Be my guest :-)", "author": "sophokles73", "createdAt": "2020-03-17T09:26:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg2OTI4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3MDAwNw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392870007", "bodyText": "IMHO this needs to be 205 in the CoAP case?", "author": "sophokles73", "createdAt": "2020-03-16T09:05:42Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.\n+* Response Options:\n+  * (optional) `content-type`: A media type describing the semantics and format of payload contained in the response body. This header will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This header will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 200.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ5NjIyNw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393496227", "bodyText": "OK", "author": "boaks", "createdAt": "2020-03-17T07:54:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3MDAwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3MDI3Mg==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392870272", "bodyText": "please move this after 204 ... the notes regarding the difference between NON and CON should be included here as well, I guess.", "author": "sophokles73", "createdAt": "2020-03-16T09:06:14Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.\n+* Response Options:\n+  * (optional) `content-type`: A media type describing the semantics and format of payload contained in the response body. This header will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This header will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 200.\n+  * (optional) Error details, if status code is >= 400.\n+* Status Codes:\n+  * 205 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3MjgxNA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392872814", "bodyText": "is there a QoS header?", "author": "sophokles73", "createdAt": "2020-03-16T09:11:22Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.\n+* Response Options:\n+  * (optional) `content-type`: A media type describing the semantics and format of payload contained in the response body. This header will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This header will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 200.\n+  * (optional) Error details, if status code is >= 400.\n+* Status Codes:\n+  * 205 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.\n+  * 204 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with\n+    this status code.\n+  * 400 (Bad Request): The request cannot be processed. Possible reasons for this include:\n+        * The content type header is missing.\n+        * The request body is empty.\n+        * The QoS header value is invalid.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY2ODEzNg==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393668136", "bodyText": "Removed", "author": "boaks", "createdAt": "2020-03-17T13:13:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3MjgxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3Mjk0MA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392872940", "bodyText": "content type option?", "author": "sophokles73", "createdAt": "2020-03-16T09:11:35Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.\n+* Response Options:\n+  * (optional) `content-type`: A media type describing the semantics and format of payload contained in the response body. This header will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This header will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 200.\n+  * (optional) Error details, if status code is >= 400.\n+* Status Codes:\n+  * 205 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.\n+  * 204 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with\n+    this status code.\n+  * 400 (Bad Request): The request cannot be processed. Possible reasons for this include:\n+        * The content type header is missing.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ5ODIyNA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393498224", "bodyText": "OK", "author": "boaks", "createdAt": "2020-03-17T07:59:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3Mjk0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3MzMxMA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392873310", "bodyText": "the request itself never contains credentials, does it?", "author": "sophokles73", "createdAt": "2020-03-16T09:12:09Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.\n+* Response Options:\n+  * (optional) `content-type`: A media type describing the semantics and format of payload contained in the response body. This header will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This header will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 200.\n+  * (optional) Error details, if status code is >= 400.\n+* Status Codes:\n+  * 205 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.\n+  * 204 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with\n+    this status code.\n+  * 400 (Bad Request): The request cannot be processed. Possible reasons for this include:\n+        * The content type header is missing.\n+        * The request body is empty.\n+        * The QoS header value is invalid.\n+  * 401 (Unauthorized): The request cannot be processed because the request does not contain valid credentials.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUwMDI2Nw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393500267", "bodyText": "If the DTLS handshakes fails, no response is sent at all. So the 401 will only be sent back, if some hono-internal component reports that. I can't see, how that source could be verified efficiently, if it reports that error or not and what will be that cause for 401.", "author": "boaks", "createdAt": "2020-03-17T08:03:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3MzMxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3Mzc0MA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392873740", "bodyText": "there is no legacy control endpoint anymore ...", "author": "sophokles73", "createdAt": "2020-03-16T09:12:54Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.\n+* Response Options:\n+  * (optional) `content-type`: A media type describing the semantics and format of payload contained in the response body. This header will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This header will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 200.\n+  * (optional) Error details, if status code is >= 400.\n+* Status Codes:\n+  * 205 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.\n+  * 204 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with\n+    this status code.\n+  * 400 (Bad Request): The request cannot be processed. Possible reasons for this include:\n+        * The content type header is missing.\n+        * The request body is empty.\n+        * The QoS header value is invalid.\n+  * 401 (Unauthorized): The request cannot be processed because the request does not contain valid credentials.\n+  * 403 (Forbidden): The request cannot be processed because the device's registration status cannot be asserted. Possible reasons for this include:\n+        * The given tenant is not allowed to use this protocol adapter.\n+  * 404 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n+  * 429 (Too Many Requests): The request cannot be processed because the tenant's message limit for the current period is exceeded.\n+  * 503 (Service Unavailable): The request cannot be processed because there is no consumer of telemetry data for the given tenant connected to Hono.\n+\n+This is the preferred way for devices to publish telemetry data. It is available only if the protocol adapter is configured to require devices to authenticate (which is the default).\n+\n+If the `hono-ttd` URI-query option is set in order to receive a command and if the authenticated device is actually a gateway, the returned command will be the first command that the northbound application has sent to either the gateway itself or (if not using the legacy control endpoint) to *any* device that has last sent a telemetry or event message via this gateway.", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUwMDg5NA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393500894", "bodyText": "Please propose the right section (possibly update http-guide?).", "author": "boaks", "createdAt": "2020-03-17T08:05:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3Mzc0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU0NTA4Nw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393545087", "bodyText": "???", "author": "sophokles73", "createdAt": "2020-03-17T09:29:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3Mzc0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2Njg2Nw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393566867", "bodyText": "I have no glue, what this part was good for. And I don't know, what should be written instead. Hono has quite a lot implemented in the base-classes, and I don't know, what is changed there  or not.", "author": "boaks", "createdAt": "2020-03-17T10:06:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3Mzc0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYyMDc5MA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393620790", "bodyText": "just remove the\n\n(if not using the legacy control endpoint)", "author": "sophokles73", "createdAt": "2020-03-17T11:47:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3Mzc0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY3MzY2Nw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393673667", "bodyText": "OK", "author": "boaks", "createdAt": "2020-03-17T13:21:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3Mzc0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjg3NDI4Mw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r392874283", "bodyText": "please change this into a note", "author": "sophokles73", "createdAt": "2020-03-16T09:13:50Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (required) Arbitrary payload encoded according to the given content type.\n+* Response Options:\n+  * (optional) `content-type`: A media type describing the semantics and format of payload contained in the response body. This header will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This header will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 200.\n+  * (optional) Error details, if status code is >= 400.\n+* Status Codes:\n+  * 205 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.\n+  * 204 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with\n+    this status code.\n+  * 400 (Bad Request): The request cannot be processed. Possible reasons for this include:\n+        * The content type header is missing.\n+        * The request body is empty.\n+        * The QoS header value is invalid.\n+  * 401 (Unauthorized): The request cannot be processed because the request does not contain valid credentials.\n+  * 403 (Forbidden): The request cannot be processed because the device's registration status cannot be asserted. Possible reasons for this include:\n+        * The given tenant is not allowed to use this protocol adapter.\n+  * 404 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n+  * 429 (Too Many Requests): The request cannot be processed because the tenant's message limit for the current period is exceeded.\n+  * 503 (Service Unavailable): The request cannot be processed because there is no consumer of telemetry data for the given tenant connected to Hono.\n+\n+This is the preferred way for devices to publish telemetry data. It is available only if the protocol adapter is configured to require devices to authenticate (which is the default).\n+\n+If the `hono-ttd` URI-query option is set in order to receive a command and if the authenticated device is actually a gateway, the returned command will be the first command that the northbound application has sent to either the gateway itself or (if not using the legacy control endpoint) to *any* device that has last sent a telemetry or event message via this gateway.\n+\n+**Examples**\n+\n+The coap-client contained in the linux package `libcoap-1-0-bin` unfortunately doesn't support DTLS 1.2. To use the coap-client with DTLS 1.2 therefore requires a own [local build](https://libcoap.net/install.html).\n+\n+Publish some JSON data for device `4711` (using default message type `CON` *at least once* QoS):\n+\n+~~~sh\n+./coap-client -u sensor1@DEFAULT_TENANT -k hono-secret -m POST coaps://hono.eclipseprojects.io/telemetry -t application/json -e '{\"temp\": 5}'\n+~~~\n+\n+(`./coap-client` reports only error response-codes, so the expected 2.04 will not be report!)", "originalCommit": "7405fb66ba958a053c533b20f2fc2978e2b698e1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9711d2ab08da6be1c83dc83fb834f1ba3a3f1416", "url": "https://github.com/eclipse/hono/commit/9711d2ab08da6be1c83dc83fb834f1ba3a3f1416", "message": "Add coap user-guide.\n\nPart 1, telemetry.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>", "committedDate": "2020-03-17T10:36:56Z", "type": "forcePushed"}, {"oid": "9391dd822d43516f3bc291c7861a156dc9b1726a", "url": "https://github.com/eclipse/hono/commit/9391dd822d43516f3bc291c7861a156dc9b1726a", "message": "Add coap user-guide.\n\nPart 1, telemetry.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>", "committedDate": "2020-03-17T10:39:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYxOTk1OA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393619958", "bodyText": "IMHO we should set this to 225 so that it will appear right after the MQTT adapter", "author": "sophokles73", "createdAt": "2020-03-17T11:45:28Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210", "originalCommit": "9391dd822d43516f3bc291c7861a156dc9b1726a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYyMTcwNw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393621707", "bodyText": "how about using 65000 as the content format option value in this case?", "author": "sophokles73", "createdAt": "2020-03-17T11:48:53Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,231 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 210\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit] ({{< relref \"/concepts/resource-limits.md\" >}}) is not exceeded. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (required) `content-type`: The type of payload contained in the request body.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.", "originalCommit": "9391dd822d43516f3bc291c7861a156dc9b1726a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwMTc0OA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393701748", "bodyText": "That would require a definition how to translate them.\nFMPOV, that doesn't pay off.", "author": "boaks", "createdAt": "2020-03-17T14:03:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYyMTcwNw=="}], "type": "inlineReview"}, {"oid": "e3dcac18dcaadaefce797cc48a0e9e9a0b0483fc", "url": "https://github.com/eclipse/hono/commit/e3dcac18dcaadaefce797cc48a0e9e9a0b0483fc", "message": "Add coap user-guide.\n\nPart 1, telemetry.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>", "committedDate": "2020-03-17T13:18:39Z", "type": "forcePushed"}, {"oid": "a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "url": "https://github.com/eclipse/hono/commit/a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "message": "Add coap user-guide.\n\nPart 1, telemetry.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>", "committedDate": "2020-03-17T13:42:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY5ODc3Mg==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393698772", "bodyText": "currently", "author": "sophokles73", "createdAt": "2020-03-17T13:58:53Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,238 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currenlty assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).", "originalCommit": "a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcyNjY2Nw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393726667", "bodyText": "Done", "author": "boaks", "createdAt": "2020-03-17T14:36:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzY5ODc3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwMjM3NQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393702375", "bodyText": "What about\n\nContent types that do not map to one of the registered CoAP content formats are ignored.", "author": "sophokles73", "createdAt": "2020-03-17T14:04:04Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,238 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currenlty assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+The use of unsupported content types in messages sent to the device are ignored!", "originalCommit": "a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcyNjc3Ng==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393726776", "bodyText": "Done", "author": "boaks", "createdAt": "2020-03-17T14:37:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwMjM3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwMzU2MA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393703560", "bodyText": "FMPOV this will never be returned and we should therefore remove it", "author": "sophokles73", "createdAt": "2020-03-17T14:05:43Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,238 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currenlty assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+The use of unsupported content types in messages sent to the device are ignored!\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This option will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 2.05 (CONTENT).\n+  * (optional) Error details, if status code is >= 4.00.\n+* Status Codes:\n+  * 2.04 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n+  * 2.05 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.\n+  * 4.00 (Bad Request): The request cannot be processed. Possible reasons for this include:\n+        * The content format option is missing.\n+        * The request body is empty without `URI-query: empty`.\n+  * 4.01 (Unauthorized): The request cannot be processed because invalid credentials. If PSK authentication fails, no response is receieved!", "originalCommit": "a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcyNjg1NA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393726854", "bodyText": "Done", "author": "boaks", "createdAt": "2020-03-17T14:37:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwMzU2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwNDcxMw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393704713", "bodyText": "... but the request body is not empty. However, the code suggests that in this case a 4.06 (Not Acceptable) is being returned ...", "author": "sophokles73", "createdAt": "2020-03-17T14:07:18Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,238 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currenlty assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+The use of unsupported content types in messages sent to the device are ignored!\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This option will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 2.05 (CONTENT).\n+  * (optional) Error details, if status code is >= 4.00.\n+* Status Codes:\n+  * 2.04 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n+  * 2.05 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.\n+  * 4.00 (Bad Request): The request cannot be processed. Possible reasons for this include:\n+        * The content format option is missing.", "originalCommit": "a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcyNjkyOA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393726928", "bodyText": "Done", "author": "boaks", "createdAt": "2020-03-17T14:37:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwNDcxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwODI1OQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393708259", "bodyText": "... 2.05 (Content)", "author": "sophokles73", "createdAt": "2020-03-17T14:12:22Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,238 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currenlty assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+The use of unsupported content types in messages sent to the device are ignored!\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This option will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 2.05 (CONTENT).", "originalCommit": "a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcyNzAwMw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393727003", "bodyText": "Done", "author": "boaks", "createdAt": "2020-03-17T14:37:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwODI1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwODQwNQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393708405", "bodyText": "2.04 (Changed):", "author": "sophokles73", "createdAt": "2020-03-17T14:12:33Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,238 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currenlty assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+The use of unsupported content types in messages sent to the device are ignored!\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This option will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 2.05 (CONTENT).\n+  * (optional) Error details, if status code is >= 4.00.\n+* Status Codes:\n+  * 2.04 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),", "originalCommit": "a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcyNzA2NQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393727065", "bodyText": "Done", "author": "boaks", "createdAt": "2020-03-17T14:37:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwODQwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwODUyMQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393708521", "bodyText": "2.05 (Content):", "author": "sophokles73", "createdAt": "2020-03-17T14:12:43Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,238 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currenlty assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+The use of unsupported content types in messages sent to the device are ignored!\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This option will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 2.05 (CONTENT).\n+  * (optional) Error details, if status code is >= 4.00.\n+* Status Codes:\n+  * 2.04 (CHANGED): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n+  * 2.05 (CONTENT): The telemetry data has been accepted for processing. The response contains a command for the device to execute.", "originalCommit": "a8da6d8ac639c2307fb0855cc5ba0a2d7a0ca796", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcyNzE0Mw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393727143", "bodyText": "Done", "author": "boaks", "createdAt": "2020-03-17T14:37:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzcwODUyMQ=="}], "type": "inlineReview"}, {"oid": "ff9502f67e32a8bf14ec04824ec52103b075c20e", "url": "https://github.com/eclipse/hono/commit/ff9502f67e32a8bf14ec04824ec52103b075c20e", "message": "Add coap user-guide.\n\nPart 1, telemetry.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>", "committedDate": "2020-03-17T14:23:00Z", "type": "forcePushed"}, {"oid": "36e63e7e1f9670a505fb91957c25e70c92fda0ba", "url": "https://github.com/eclipse/hono/commit/36e63e7e1f9670a505fb91957c25e70c92fda0ba", "message": "Add coap user-guide.\n\nPart 1, telemetry.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>", "committedDate": "2020-03-17T14:34:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzczMjUwNQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393732505", "bodyText": "IMHO we should make it more explicit that even if the response contains a command, the content format might still be empty, i.e. if the command sent by the application contained an unsupported (unmappable) content type.", "author": "sophokles73", "createdAt": "2020-03-17T14:45:10Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,230 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currently assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+Content types that do not map to one of the registered CoAP content formats are ignored.\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data.", "originalCommit": "36e63e7e1f9670a505fb91957c25e70c92fda0ba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyNzA2Ng==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394227066", "bodyText": "Statement added.", "author": "boaks", "createdAt": "2020-03-18T09:59:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzczMjUwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzczMzYyNg==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r393733626", "bodyText": "Based on the definition at https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html, 4.06 doesn't seem to be the right status code for this. Instead, we should use 4.00 as we do in the HTTP adapter. But this can be done in a separate PR.", "author": "sophokles73", "createdAt": "2020-03-17T14:46:38Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,230 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currently assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+Content types that do not map to one of the registered CoAP content formats are ignored.\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This option will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.\n+* Response Body:\n+  * (optional) Arbitrary data serving as input to a command to be executed by the device, if status code is 2.05 (Content).\n+  * (optional) Error details, if status code is >= 4.00.\n+* Status Codes:\n+  * 2.04 (Changed): The telemetry data has been accepted for processing. Note that if the message type is `NON` (*at most once* semantics),\n+    this status code does **not** mean that the message has been delivered to any potential consumer. However, if the message type is `CON` (*at least once* semantics), then the adapter waits for the message to be delivered and accepted by a downstream consumer before responding with this status code.\n+  * 2.05 (Content): The telemetry data has been accepted for processing. The response contains a command for the device to execute.\n+  * 4.03 (Forbidden): The request cannot be processed because the device's registration status cannot be asserted. Possible reasons for this include:\n+        * The given tenant is not allowed to use this protocol adapter.\n+  * 4.04 (Not Found): The request cannot be processed because the device is disabled or does not exist.\n+  * 4.06 (Not Acceptable): The request body is empty without `URI-query: empty`.", "originalCommit": "36e63e7e1f9670a505fb91957c25e70c92fda0ba", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5fee66b225302d9dc07f3317c02d0307595970dc", "url": "https://github.com/eclipse/hono/commit/5fee66b225302d9dc07f3317c02d0307595970dc", "message": "Add coap user-guide.\n\nPart 1, telemetry.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>", "committedDate": "2020-03-18T09:57:43Z", "type": "commit"}, {"oid": "5fee66b225302d9dc07f3317c02d0307595970dc", "url": "https://github.com/eclipse/hono/commit/5fee66b225302d9dc07f3317c02d0307595970dc", "message": "Add coap user-guide.\n\nPart 1, telemetry.\n\nSigned-off-by: Achim Kraus <achim.kraus@bosch.io>", "committedDate": "2020-03-18T09:57:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNDEwNA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394314104", "bodyText": "wouldn't it be sufficient to simply omit this option in case of a one-way command?", "author": "sophokles73", "createdAt": "2020-03-18T12:37:31Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,230 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currently assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+Content types that do not map to one of the registered CoAP content formats are ignored.\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data. If the command's content type do not map to one of the registered CoAP content formats, the option will not be present.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This option will only be present if the response contains a command to be executed by the device.\n+  * (optional) `location-path: ('command'|'command_response/'<command-request-id>)`: The location path contains `'command'` for one-way-commands, or `'command_response' / <command-request-id>`  for commands expecting  a response. In case of a expected response, the location-path contains exactly the URI-path expected for the response.", "originalCommit": "5fee66b225302d9dc07f3317c02d0307595970dc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ1ODA2NQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394458065", "bodyText": "At least for the gateway-variant below, it's required.\nUsing it enables later \"homogeneous\" extensions, otherwise \"none\" must be a extra case, which defaults then to \"command\".", "author": "boaks", "createdAt": "2020-03-18T15:58:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNDEwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394317282", "bodyText": "I have to admit that I am not really fond of abusing existing option codes for conveying information that is not at all related to the option's original semantics. This brings me back to introducing our own content format and option codes in the > 65000 range. For the options, this merely requires documenting them here. For the content-formats, we could create a wrapper around Cf's MediaTypeRegistry class which contains these codes as well ...\nWDYT?", "author": "sophokles73", "createdAt": "2020-03-18T12:43:18Z", "path": "site/documentation/content/user-guide/coap-adapter.md", "diffHunk": "@@ -0,0 +1,230 @@\n++++\n+title = \"CoAP Adapter\"\n+weight = 225\n++++\n+\n+The CoAP protocol adapter exposes [CoAP](https://tools.ietf.org/html/rfc7252) based endpoints for Eclipse Hono&trade;'s south bound Telemetry, Event and Command & Control APIs.\n+<!--more-->\n+\n+## Device Authentication\n+\n+The CoAP adapter by default requires clients (devices or gateway components) to authenticate during connection establishment. The adapter supports currently only [PSK](https://tools.ietf.org/html/rfc4279) as part of a DTLS handshake for that purpose. The other variants mentioned in [Securing CoAP](https://tools.ietf.org/html/rfc7252#section-9) may follow in the future.\n+\n+The adapter tries to authenticate the device using this mechanisms\n+\n+### PSK\n+\n+The *identity* provided in the ClientKeyExchange must have the form *auth-id@tenant*, e.g. `sensor1@DEFAULT_TENANT`. The adapter performs the handshake using the credentials the `configured Credentials service - (documentation pending)` has one record for the client. The adapter uses the Credentials API's *get* operation to retrieve the credentials on record with the *tenant* and *auth-id* provided by the device in the *identity* and `psk` as the *type* of secret as query parameters.\n+\n+The examples below refer to devices `4711` and `gw-1` of tenant `DEFAULT_TENANT` using *auth-ids* `sensor1` and `gw1` and corresponding passwords. The example deployment as described in the [Deployment Guides]({{< relref \"deployment\" >}}) comes pre-configured with the corresponding entities in its device registry component.\n+Please refer to the [Credentials API]({{< relref \"/api/credentials#standard-credential-types\" >}}) for details regarding the different types of secrets.\n+\n+**NB** There is a subtle difference between the *device identifier* (*device-id*) and the *auth-id* a device uses for authentication. See [Device Identity]({{< relref \"/concepts/device-identity.md\" >}}) for a discussion of the concepts.\n+\n+## Message Limits\n+\n+Before accepting any telemetry or event or command messages, the CoAP adapter verifies that the configured [message limit]({{< relref \"/concepts/resource-limits#messages-limit\" >}}) is not exceeded.\n+For CoAP currently only the messages limit is verified, the connections limit is not available. If the limit is exceeded then the incoming message is discarded with the status code `429 Too Many Requests`. \n+\n+## CoAP Content Formats\n+\n+CoAP doesn't use a textual identifier for content types. Instead numbers are used, which are maintained by the [IANA](https://www.iana.org/).\n+For the currently assigned numbers, please check [IANA - CoAP Content Formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats).\n+Content types that do not map to one of the registered CoAP content formats are ignored.\n+\n+## Publish Telemetry Data (authenticated Device)\n+\n+The device is authenticated using PSK.\n+\n+* URI: `/telemetry`\n+* Method: `POST`\n+* Type:\n+  * `CON`: *at least once* (`1`) QoS levels\n+  * `NON`: *at most once* (`0`) QoS levels\n+* Request Options:\n+  * (optional) `content-format`: The type of payload contained in the request body. Required, if request contains payload.\n+  * (optional) `URI-query: hono-ttd`: The number of seconds the device will wait for the response.\n+  * (optional) `URI-query: empty`: If the request doesn't contain payload.\n+* Request Body:\n+  * (optional) Arbitrary payload encoded according to the given content type. Maybe empty, if `URI-query: empty` is provided.\n+* Response Options:\n+  * (optional) `content-format`: A media type describing the semantics and format of payload contained in the response body. This option will only be present if the response contains a command to be executed by the device which requires input data. If the command's content type do not map to one of the registered CoAP content formats, the option will not be present.\n+  * (optional) `location-query: hono-command`: The name of the command to execute. This option will only be present if the response contains a command to be executed by the device.", "originalCommit": "5fee66b225302d9dc07f3317c02d0307595970dc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ2NjExMg==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394466112", "bodyText": "Do you mean a \"custom option\" instead of the location?\nOr a \"custom content format\", which structures the response's payload in \"response-URI\" and \"command-payload\"?", "author": "boaks", "createdAt": "2020-03-18T16:09:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ3NDQ2Ng==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394474466", "bodyText": "Both, using a custom option instead of location-query and location-path as well as using custom content-format codes for e.g. application/vnd.eclipse-hono-empty-notification.", "author": "sophokles73", "createdAt": "2020-03-18T16:20:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ3NjM3Ng==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394476376", "bodyText": "Both requires, that a implementation is able to process such \"custom\" values. I just don't know, if that is the case.", "author": "boaks", "createdAt": "2020-03-18T16:23:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ3ODEyNA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394478124", "bodyText": "When you say implementation, what are you referring to? A device? A backend application?", "author": "sophokles73", "createdAt": "2020-03-18T16:25:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ4MDk5NQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394480995", "bodyText": "A embedded device. At least, this should be checked for \"libcoap\" and \"erbium\". And for the content-format, californium must be adapted.\nI would prefer to raise a question in the ietf core-mailing list about the usage of the \"location\". For me this case looks pretty close to the original intention of the \"location\".", "author": "boaks", "createdAt": "2020-03-18T16:30:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ5MDY3MQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394490671", "bodyText": "And for the content-format, californium must be adapted.And for the content-format, californium must be adapted.\n\nIMHO we can simply wrap the MediaTypeRegistry and use our wrapper instead in the CoAP adapter code. Don't you think?", "author": "sophokles73", "createdAt": "2020-03-18T16:44:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ5MTEwNQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394491105", "bodyText": "At least, this should be checked for \"libcoap\" and \"erbium\"\n\nCan you do that?", "author": "sophokles73", "createdAt": "2020-03-18T16:45:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ5Nzg3Ng==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394497876", "bodyText": "I have only 1 day left before my vacation and I'm sorry, but this will not be possible before that.\nI want to release Californium 2.2.0-RC1 tomorrow, and so I'm currently just too busy.", "author": "boaks", "createdAt": "2020-03-18T16:54:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDUwMDQ0OA==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394500448", "bodyText": "We don't need to do that as part of this PR. This is just about documenting the current status quo, i.e. the way it is implemented at the moment. However, I wanted to start a discussion around whether it should stay that way.", "author": "sophokles73", "createdAt": "2020-03-18T16:58:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDUwMjE3Nw==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394502177", "bodyText": "OK, but as I wrote, I would prefer to ask the ietf core list about their opinion using the location option. I hope, I can write to the list tomorrow.", "author": "boaks", "createdAt": "2020-03-18T17:01:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU0MTYzMQ==", "url": "https://github.com/eclipse/hono/pull/1837#discussion_r394541631", "bodyText": "Reading 2.01 Created my impression is, that the \"location\" is used to control a cache. Assuming no cache, it doesn't harm.", "author": "boaks", "createdAt": "2020-03-18T18:03:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDMxNzI4Mg=="}], "type": "inlineReview"}]}