{"pr_number": 1978, "pr_title": "Add regexp validations for tenant ID, device ID, credentials types and auth-ID.", "pr_createdAt": "2020-05-25T15:16:39Z", "pr_url": "https://github.com/eclipse/hono/pull/1978", "timeline": [{"oid": "a882af252e1d1e65522c83437b1e84e6400bc631", "url": "https://github.com/eclipse/hono/commit/a882af252e1d1e65522c83437b1e84e6400bc631", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>", "committedDate": "2020-05-25T15:17:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM1MjY0MA==", "url": "https://github.com/eclipse/hono/pull/1978#discussion_r430352640", "bodyText": "I think it would be better to do this check within span, so that we have a proper tracing/logging for the errors. Like it's done for the credentials endpoint.", "author": "dejanb", "createdAt": "2020-05-26T11:48:53Z", "path": "services/device-registry-base/src/main/java/org/eclipse/hono/service/management/device/DelegatingDeviceManagementHttpEndpoint.java", "diffHunk": "@@ -93,21 +93,25 @@ public void addRoutes(final Router router) {\n \n         // CREATE device\n         router.post(pathWithTenantAndDeviceId)\n+                .handler(this::verifyDeviceId)", "originalCommit": "a882af252e1d1e65522c83437b1e84e6400bc631", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM1MzExOQ==", "url": "https://github.com/eclipse/hono/pull/1978#discussion_r430353119", "bodyText": "Maybe you can define default regex at one place, like DEFAULT_ID_REGEX and reuse that value.", "author": "dejanb", "createdAt": "2020-05-26T11:49:49Z", "path": "core/src/main/java/org/eclipse/hono/util/CredentialsConstants.java", "diffHunk": "@@ -116,6 +116,14 @@\n      * The vert.x event bus address to which inbound credentials messages are published.\n      */\n     public static final String EVENT_BUS_ADDRESS_CREDENTIALS_IN = \"credentials.in\";\n+    /**\n+     * The regular expression to validate that the auth-id field supplied in credentials is legal.\n+     */\n+    public static final String AUTH_ID_VALUE_REGEX = \"^[a-z0-9-=]+$\";", "originalCommit": "a882af252e1d1e65522c83437b1e84e6400bc631", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ1MjYyMw==", "url": "https://github.com/eclipse/hono/pull/1978#discussion_r430452623", "bodyText": "I moved the regexp for tenant id and device id to RegistryManagementConstants.DEFAULT_ID_REGEX", "author": "jbtrystram", "createdAt": "2020-05-26T14:24:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM1MzExOQ=="}], "type": "inlineReview"}, {"oid": "b9f5fd2d1e5fd0389b4f0ffe448cba0b9b79d854", "url": "https://github.com/eclipse/hono/commit/b9f5fd2d1e5fd0389b4f0ffe448cba0b9b79d854", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>", "committedDate": "2020-05-26T14:23:07Z", "type": "forcePushed"}, {"oid": "d8168b04200b0ed5dac139b22be412f279538fed", "url": "https://github.com/eclipse/hono/commit/d8168b04200b0ed5dac139b22be412f279538fed", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>", "committedDate": "2020-05-26T14:24:43Z", "type": "forcePushed"}, {"oid": "54a0ac2ee92b4780784907eb519b78c3fc56e062", "url": "https://github.com/eclipse/hono/commit/54a0ac2ee92b4780784907eb519b78c3fc56e062", "message": "do the regexp verification for ID in span and update samples values", "committedDate": "2020-05-27T11:35:04Z", "type": "forcePushed"}, {"oid": "6620699686511be361560805aacb7468f825afc8", "url": "https://github.com/eclipse/hono/commit/6620699686511be361560805aacb7468f825afc8", "message": "Revert \"some more changing DEFAULT_TENANT to lowercase\"\n\nThis reverts commit d9d6378f37b0a2b8ee5a260fb583dd7b1d3dc760.", "committedDate": "2020-05-27T14:32:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcwMTg5OQ==", "url": "https://github.com/eclipse/hono/pull/1978#discussion_r431701899", "bodyText": "We should update a default patterns for different identifiers and add some docs on the configuration.", "author": "dejanb", "createdAt": "2020-05-28T09:26:36Z", "path": "site/documentation/content/api/management/device-registry-v1.yaml", "diffHunk": "@@ -810,8 +810,10 @@ components:\n          properties:\n             \"type\":\n                type: string\n+               pattern: [a-z0-9-]", "originalCommit": "ba4c18ee3d1c5e3b2d0d18b1230fcc37cd32696e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTc3NDgzNw==", "url": "https://github.com/eclipse/hono/pull/1978#discussion_r431774837", "bodyText": "done :)", "author": "jbtrystram", "createdAt": "2020-05-28T11:45:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcwMTg5OQ=="}], "type": "inlineReview"}, {"oid": "99ca2ffd83d7ee6d9c907857af020c07c2225c0d", "url": "https://github.com/eclipse/hono/commit/99ca2ffd83d7ee6d9c907857af020c07c2225c0d", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\nadd configuration option and add info in documentation\nupdate openAPI spec with the default patterns\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>", "committedDate": "2020-05-28T11:46:48Z", "type": "forcePushed"}, {"oid": "3ce37d69f56168e69bc3478742bf8fba80a3f35a", "url": "https://github.com/eclipse/hono/commit/3ce37d69f56168e69bc3478742bf8fba80a3f35a", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\nadd configuration option and add info in documentation\nupdate openAPI spec with the default patterns\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>", "committedDate": "2020-05-29T08:26:09Z", "type": "commit"}, {"oid": "3ce37d69f56168e69bc3478742bf8fba80a3f35a", "url": "https://github.com/eclipse/hono/commit/3ce37d69f56168e69bc3478742bf8fba80a3f35a", "message": "[#1956] Implement regexp validation for ID through the managament API when creating tenants and devices.\nAdding regular expression to validate the characters for credentials auth-id and type fields as wells.\nadd configuration option and add info in documentation\nupdate openAPI spec with the default patterns\n\nSigned-off-by: Jean-Baptiste Trystram <jbtrystram@redhat.com>", "committedDate": "2020-05-29T08:26:09Z", "type": "forcePushed"}]}