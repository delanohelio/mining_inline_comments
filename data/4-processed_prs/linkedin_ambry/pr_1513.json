{"pr_number": 1513, "pr_title": "Return lifeVersion from get request", "pr_createdAt": "2020-05-07T22:42:34Z", "pr_url": "https://github.com/linkedin/ambry/pull/1513", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIyOTYwNA==", "url": "https://github.com/linkedin/ambry/pull/1513#discussion_r423229604", "bodyText": "It seems like in most places, setLifeVersion is called right after new BlobInfo. Instead of adding a new setter, one alternative could be making the BlobInfo.lifeVersion final and adding a new constructor that takes life version as an argument.", "author": "cgtz", "createdAt": "2020-05-11T18:18:02Z", "path": "ambry-router/src/main/java/com/github/ambry/router/GetBlobInfoOperation.java", "diffHunk": "@@ -353,9 +353,9 @@ private void handleBody(InputStream payload, MessageMetadata messageMetadata, Me\n     ByteBuffer userMetadata = MessageFormatRecord.deserializeUserMetadata(payload);\n     if (encryptionKey == null) {\n       // if blob is not encrypted, move the state to Complete\n-      operationResult =\n-          new GetBlobResultInternal(new GetBlobResult(new BlobInfo(serverBlobProperties, userMetadata.array()), null),\n-              null);\n+      BlobInfo blobInfo = new BlobInfo(serverBlobProperties, userMetadata.array());", "originalCommit": "f140c3064b2af292ec9f42a87c397d2adc42949e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIzMDkyMw==", "url": "https://github.com/linkedin/ambry/pull/1513#discussion_r423230923", "bodyText": "just save life version instead of the entire messageInfo?", "author": "cgtz", "createdAt": "2020-05-11T18:20:31Z", "path": "ambry-router/src/main/java/com/github/ambry/router/GetBlobOperation.java", "diffHunk": "@@ -1100,6 +1100,7 @@ private RouterException buildChunkException(String message, RouterErrorCode erro\n     private BlobType blobType;\n     private List<CompositeBlobInfo.ChunkMetadata> chunkMetadataList;\n     private BlobProperties serverBlobProperties;\n+    private MessageInfo serverMessageInfo;", "originalCommit": "f140c3064b2af292ec9f42a87c397d2adc42949e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d120aa91729fefbab590f72b74641764785e6ed3", "url": "https://github.com/linkedin/ambry/commit/d120aa91729fefbab590f72b74641764785e6ed3", "message": "Address comments", "committedDate": "2020-05-11T19:00:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE0Mjc3Mw==", "url": "https://github.com/linkedin/ambry/pull/1513#discussion_r424142773", "bodyText": "creat -> create (also line 34)", "author": "cgtz", "createdAt": "2020-05-13T02:47:14Z", "path": "ambry-api/src/main/java/com/github/ambry/messageformat/BlobInfo.java", "diffHunk": "@@ -14,26 +14,44 @@\n package com.github.ambry.messageformat;\n \n /**\n- * A BlobInfo class that contains both the blob property and the usermetadata for the blob\n+ * A BlobInfo class that contains both the blob property, the usermetadata and the lifeVersion for the blob.\n  */\n public class BlobInfo {\n-\n   private BlobProperties blobProperties;\n-\n   private byte[] userMetadata;\n-\n   private short lifeVersion;\n \n+  /**\n+   * Constructor to creat a {@link BlobInfo}.", "originalCommit": "d120aa91729fefbab590f72b74641764785e6ed3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f19b67e9e2db19fa05809a3de72df44c8a07dd59", "url": "https://github.com/linkedin/ambry/commit/f19b67e9e2db19fa05809a3de72df44c8a07dd59", "message": "Return lifeVersion from get request", "committedDate": "2020-05-13T17:32:34Z", "type": "commit"}, {"oid": "dd8cdf3855afca3818ea7624631847abd0e263e8", "url": "https://github.com/linkedin/ambry/commit/dd8cdf3855afca3818ea7624631847abd0e263e8", "message": "Address comments", "committedDate": "2020-05-13T17:32:34Z", "type": "commit"}, {"oid": "dd8cdf3855afca3818ea7624631847abd0e263e8", "url": "https://github.com/linkedin/ambry/commit/dd8cdf3855afca3818ea7624631847abd0e263e8", "message": "Address comments", "committedDate": "2020-05-13T17:32:34Z", "type": "forcePushed"}, {"oid": "0b65a9e8ce644b65ed67df7b7fe2b5334a8406af", "url": "https://github.com/linkedin/ambry/commit/0b65a9e8ce644b65ed67df7b7fe2b5334a8406af", "message": "Address comments", "committedDate": "2020-05-13T18:40:25Z", "type": "commit"}]}