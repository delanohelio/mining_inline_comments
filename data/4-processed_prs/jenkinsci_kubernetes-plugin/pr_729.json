{"pr_number": 729, "pr_title": "Fix packaging of unwanted dependencies", "pr_createdAt": "2020-03-04T16:36:07Z", "pr_url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729", "timeline": [{"oid": "8e67f5b626ad8f053026e21b7d7ea10aa3b87a2e", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/8e67f5b626ad8f053026e21b7d7ea10aa3b87a2e", "message": "Fix dependencies\n\n* ssh-credentials 1.18\n* fix bundled dependencies that shouldn't be packaged\n(https://github.com/jenkinsci/maven-hpi-plugin/pull/140 doesn't cover\nall use cases)", "committedDate": "2020-03-04T16:35:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgxMTQ1NQ==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729#discussion_r387811455", "bodyText": "Hmm, why was this necessary?", "author": "jglick", "createdAt": "2020-03-04T17:13:59Z", "path": "pom.xml", "diffHunk": "@@ -144,6 +144,16 @@\n       <artifactId>workflow-support</artifactId>\n       <classifier>tests</classifier>\n       <scope>test</scope>\n+      <exclusions>\n+        <exclusion>\n+          <groupId>org.jboss.marshalling</groupId>\n+          <artifactId>jboss-marshalling-river</artifactId>\n+        </exclusion>\n+        <exclusion>\n+          <groupId>org.jboss.marshalling</groupId>\n+          <artifactId>jboss-marshalling</artifactId>", "originalCommit": "8e67f5b626ad8f053026e21b7d7ea10aa3b87a2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgyNTE0NQ==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729#discussion_r387825145", "bodyText": "Not sure but it seems it was pulled in packaging according to build logd", "author": "Vlatombe", "createdAt": "2020-03-04T17:38:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgxMTQ1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODM4MDQ2OQ==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729#discussion_r388380469", "bodyText": "I tracked it down to the addition of workflow-cps in #707 which is pulling workflow-support transitively and then altering the scope of following dependencies (from test to compile)", "author": "Vlatombe", "createdAt": "2020-03-05T15:46:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgxMTQ1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODM4MTQzNg==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729#discussion_r388381436", "bodyText": "An occurrence of jenkinsci/maven-hpi-plugin#140 (comment) essentially", "author": "Vlatombe", "createdAt": "2020-03-05T15:48:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgxMTQ1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQwMTE3Mg==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729#discussion_r388401172", "bodyText": "Trying out a new fix of maven-hpi-plugin", "author": "Vlatombe", "createdAt": "2020-03-05T16:15:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgxMTQ1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQyNzE5NA==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729#discussion_r388427194", "bodyText": "jenkinsci/maven-hpi-plugin#172", "author": "Vlatombe", "createdAt": "2020-03-05T16:55:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgxMTQ1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgxMTg4Nw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729#discussion_r387811887", "bodyText": "Ditto, where was this coming from before?", "author": "jglick", "createdAt": "2020-03-04T17:14:44Z", "path": "pom.xml", "diffHunk": "@@ -265,6 +250,13 @@\n         <scope>import</scope>\n         <type>pom</type>\n       </dependency>\n+      <dependency>\n+        <!-- Avoid it from being bundled -->", "originalCommit": "8e67f5b626ad8f053026e21b7d7ea10aa3b87a2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODgyMjEwNw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/729#discussion_r388822107", "bodyText": "Trails\n+- org.jenkinsci.plugins:kubernetes-credentials:jar:0.6.2:compile\n|  +- org.jenkins-ci.plugins:apache-httpcomponents-client-4-api:jar:4.5.10-2.0:compile\n|  |  +- org.apache.httpcomponents:httpclient:jar:4.5.10:compile\n|  |  |  \\- org.apache.httpcomponents:httpcore:jar:4.4.12:compile\n|  |  +- org.apache.httpcomponents:httpmime:jar:4.5.10:compile\n|  |  +- org.apache.httpcomponents:fluent-hc:jar:4.5.10:compile\n|  |  +- org.apache.httpcomponents:httpclient-cache:jar:4.5.10:compile\n|  |  +- org.apache.httpcomponents:httpasyncclient:jar:4.1.4:compile\n|  |  |  \\- org.apache.httpcomponents:httpcore-nio:jar:4.4.10:compile\n|  |  \\- org.apache.httpcomponents:httpasyncclient-cache:jar:4.1.4:compile\n|  \\- org.jenkins-ci.plugins:google-oauth-plugin:jar:0.8:compile\n|     +- joda-time:joda-time:jar:2.9.5:compile\n|     +- org.jenkins-ci.plugins:oauth-credentials:jar:0.3:compile\n|     |  \\- net.sourceforge.findbugs:jsr305:jar:1.3.2:compile\n|     +- com.google.http-client:google-http-client:jar:1.24.1:compile\n|     |  \\- com.google.code.findbugs:jsr305:jar:3.0.2:compile\n\n+- com.github.spotbugs:spotbugs-annotations:jar:3.1.12:provided (optional) \n|  \\- com.google.code.findbugs:jsr305:jar:3.0.2:compile\n\nThe one from spotbugs-annotations is much shorter, so this is the one that gets picked up during packaging.", "author": "Vlatombe", "createdAt": "2020-03-06T10:19:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgxMTg4Nw=="}], "type": "inlineReview"}, {"oid": "ef9a7860a76c20bb301d8edd82a0e3347ed2ed35", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/ef9a7860a76c20bb301d8edd82a0e3347ed2ed35", "message": "This is a transitive dep of jboss-marshalling-river\n\nand we already exclude it", "committedDate": "2020-03-06T10:13:20Z", "type": "commit"}, {"oid": "151a649b33ab4a014e5428bc3a26cbf88ad7d1e9", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/151a649b33ab4a014e5428bc3a26cbf88ad7d1e9", "message": "Merge branch 'master' into fix-dependencies", "committedDate": "2020-03-09T12:50:25Z", "type": "commit"}]}