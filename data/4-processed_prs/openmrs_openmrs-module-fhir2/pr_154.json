{"pr_number": 154, "pr_title": "FM2-154: Update MedicationRequest Dao and service", "pr_createdAt": "2020-04-28T15:06:54Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154", "timeline": [{"oid": "05628016c2e68c9c6526505e983ac3608785a573", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/05628016c2e68c9c6526505e983ac3608785a573", "message": "Update MedicationRequest Dao and service", "committedDate": "2020-04-28T18:56:44Z", "type": "forcePushed"}, {"oid": "3ce6fdcd8c2dede62463cf619536987d9f5b6a34", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/3ce6fdcd8c2dede62463cf619536987d9f5b6a34", "message": "FM2-154:Update MedicationRequest Dao and service", "committedDate": "2020-04-30T10:00:57Z", "type": "forcePushed"}, {"oid": "c367dac2ba284657f587368755580382e2af469f", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/c367dac2ba284657f587368755580382e2af469f", "message": "FM2-154:Update MedicationRequest Dao and service", "committedDate": "2020-04-30T10:33:56Z", "type": "forcePushed"}, {"oid": "c367dac2ba284657f587368755580382e2af469f", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/c367dac2ba284657f587368755580382e2af469f", "message": "FM2-154:Update MedicationRequest Dao and service", "committedDate": "2020-04-30T10:33:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5NjQwMg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418196402", "bodyText": "You shouldn't need to define this method. Just rename medicationRequestTranslator to translator", "author": "ibacher", "createdAt": "2020-04-30T18:09:15Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirMedicationRequestServiceImpl.java", "diffHunk": "@@ -29,7 +35,7 @@\n \tprivate FhirMedicationRequestDao dao;\n \t\n \t@Override\n-\tpublic MedicationRequest getMedicationRequestByUuid(String uuid) {\n-\t\treturn medicationRequestTranslator.toFhirResource(dao.getMedicationRequestByUuid(uuid));\n+\tprotected OpenmrsFhirTranslator<DrugOrder, MedicationRequest> getTranslator() {", "originalCommit": "c367dac2ba284657f587368755580382e2af469f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU0Nzg4NQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418547885", "bodyText": "i have removed it to", "author": "gitcliff", "createdAt": "2020-05-01T13:47:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5NjQwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5NjYxNQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418196615", "bodyText": "I'm not sure why you changed the interface type here?", "author": "ibacher", "createdAt": "2020-04-30T18:09:37Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/MedicationRequestTranslator.java", "diffHunk": "@@ -12,7 +12,7 @@\n import org.hl7.fhir.r4.model.MedicationRequest;\n import org.openmrs.DrugOrder;\n \n-public interface MedicationRequestTranslator extends ToFhirTranslator<DrugOrder, MedicationRequest>, UpdatableOpenmrsTranslator<DrugOrder, MedicationRequest> {\n+public interface MedicationRequestTranslator extends ToFhirTranslator<DrugOrder, MedicationRequest>, OpenmrsFhirUpdatableTranslator<DrugOrder, MedicationRequest> {", "originalCommit": "c367dac2ba284657f587368755580382e2af469f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODIyNzMyOQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418227329", "bodyText": "@ibacher the reason as to why i changed the interface is because BaseFhirService uses OpenmrsFhirTranslator type when getting the translator while theMedicationRequestTranslatorclass uses the UpdatableOpenmrsTranslator which brings  incompatibility issues during compiling", "author": "gitcliff", "createdAt": "2020-04-30T19:05:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5NjYxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI0Mzc1OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418243758", "bodyText": "Good point. Yeah, we actually do want all resource to implement that interface, so I suppose this is the right change to make.", "author": "ibacher", "createdAt": "2020-04-30T19:37:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5NjYxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5Njg2OQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418196869", "bodyText": "I don't think we actually want this method.", "author": "ibacher", "createdAt": "2020-04-30T18:10:05Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/MedicationRequestTranslatorImpl.java", "diffHunk": "@@ -67,6 +69,11 @@ public MedicationRequest toFhirResource(DrugOrder drugOrder) {\n \t\treturn medicationRequest;\n \t}\n \t\n+\t@Override\n+\tpublic DrugOrder toOpenmrsType(MedicationRequest medicationRequest) {\n+\t\treturn toOpenmrsType(new DrugOrder(), medicationRequest);\n+\t}\n+\t", "originalCommit": "c367dac2ba284657f587368755580382e2af469f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODIyOTM1Mw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418229353", "bodyText": "@ibacher your right though this method came about as a result to using UpdatableOpenmrsTranslator as explained above", "author": "gitcliff", "createdAt": "2020-04-30T19:09:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5Njg2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI0Mzg0NQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418243845", "bodyText": "See above.", "author": "ibacher", "createdAt": "2020-04-30T19:37:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE5Njg2OQ=="}], "type": "inlineReview"}, {"oid": "2cd47bbe3cbc6b49adc227f63a52b828688582c1", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/2cd47bbe3cbc6b49adc227f63a52b828688582c1", "message": "FM2-154:Update MedicationRequest Dao and service", "committedDate": "2020-05-01T07:08:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4MzY4Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418683687", "bodyText": "This also shouldn't be necessary. You can tweak the AccessLevel of the @Setter annotation above if this needs to be protected or public.", "author": "ibacher", "createdAt": "2020-05-01T18:50:29Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirMedicationRequestServiceImpl.java", "diffHunk": "@@ -9,27 +9,31 @@\n  */\n package org.openmrs.module.fhir2.api.impl;\n \n-import lombok.AccessLevel;\n-import lombok.Setter;\n import org.hl7.fhir.r4.model.MedicationRequest;\n import org.openmrs.module.fhir2.api.FhirMedicationRequestService;\n import org.openmrs.module.fhir2.api.dao.FhirMedicationRequestDao;\n import org.openmrs.module.fhir2.api.translators.MedicationRequestTranslator;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n \n+import lombok.AccessLevel;\n+import lombok.Getter;\n+import lombok.Setter;\n+\n @Component\n @Setter(AccessLevel.PACKAGE)\n-public class FhirMedicationRequestServiceImpl implements FhirMedicationRequestService {\n+@Getter(AccessLevel.PROTECTED)\n+public class FhirMedicationRequestServiceImpl extends BaseFhirService<MedicationRequest, org.openmrs.DrugOrder> implements FhirMedicationRequestService {\n \t\n \t@Autowired\n-\tprivate MedicationRequestTranslator medicationRequestTranslator;\n+\tprivate MedicationRequestTranslator translator;\n \t\n \t@Autowired\n \tprivate FhirMedicationRequestDao dao;\n-\t\n-\t@Override\n-\tpublic MedicationRequest getMedicationRequestByUuid(String uuid) {\n-\t\treturn medicationRequestTranslator.toFhirResource(dao.getMedicationRequestByUuid(uuid));\n+\n+\tpublic void setMedicationRequestTranslator(MedicationRequestTranslator translator) {\n+\t\tthis.translator = translator;\n \t}", "originalCommit": "2cd47bbe3cbc6b49adc227f63a52b828688582c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4ODU2OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418988568", "bodyText": "@ibacher the challange is that i did tweak the @Setter annotation but for some reason the compiler still complains that the setMedicationRequestTranslator isn't defined in FhirMedicationRequestServiceImpl, thats why am forced to define it here", "author": "gitcliff", "createdAt": "2020-05-02T18:00:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4MzY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTU0NzcxMA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r419547710", "bodyText": "@gitcliff In the unit tests, make sure you've changed them to call setTranslator() instead of setMedicationRequestTranslator(). That should eliminate the complaints. \ud83d\ude04", "author": "ibacher", "createdAt": "2020-05-04T16:04:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4MzY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxOTY1NA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r419919654", "bodyText": "sure ,,did that and its clear now", "author": "gitcliff", "createdAt": "2020-05-05T07:41:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4MzY4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4Mzk4Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418683982", "bodyText": "Can you add a blank new line before this?", "author": "ibacher", "createdAt": "2020-05-01T18:51:12Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/dao/FhirMedicationRequestDao.java", "diffHunk": "@@ -13,8 +13,8 @@\n \n import org.openmrs.DrugOrder;\n \n-public interface FhirMedicationRequestDao {\n-\t\n-\tDrugOrder getMedicationRequestByUuid(@NotNull String uuid);\n+public interface FhirMedicationRequestDao extends FhirDao<DrugOrder>{\n+\t@Override", "originalCommit": "2cd47bbe3cbc6b49adc227f63a52b828688582c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxOTIwNA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r419919204", "bodyText": "i have fixed it", "author": "gitcliff", "createdAt": "2020-05-05T07:40:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4Mzk4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4NDAxMw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r418684013", "bodyText": "Can you add a blank new line before this?", "author": "ibacher", "createdAt": "2020-05-01T18:51:16Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/FhirMedicationRequestService.java", "diffHunk": "@@ -13,8 +13,8 @@\n \n import org.hl7.fhir.r4.model.MedicationRequest;\n \n-public interface FhirMedicationRequestService {\n-\t\n-\tMedicationRequest getMedicationRequestByUuid(@NotNull String uuid);\n+public interface FhirMedicationRequestService extends FhirService<MedicationRequest>{\n+\t@Override", "originalCommit": "2cd47bbe3cbc6b49adc227f63a52b828688582c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxOTMwNQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/154#discussion_r419919305", "bodyText": "fixed it to", "author": "gitcliff", "createdAt": "2020-05-05T07:41:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4NDAxMw=="}], "type": "inlineReview"}, {"oid": "c27eedacdef6b2f4c6726639f78a6b123ca28fe7", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/c27eedacdef6b2f4c6726639f78a6b123ca28fe7", "message": "FM2-154:Update MedicationRequest Dao and service", "committedDate": "2020-05-04T19:15:25Z", "type": "commit"}, {"oid": "c27eedacdef6b2f4c6726639f78a6b123ca28fe7", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/c27eedacdef6b2f4c6726639f78a6b123ca28fe7", "message": "FM2-154:Update MedicationRequest Dao and service", "committedDate": "2020-05-04T19:15:25Z", "type": "forcePushed"}]}