{"pr_number": 263, "pr_title": "FM2-267: Add create, update and delete methods for ProcedureRequest", "pr_createdAt": "2020-07-25T17:06:35Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/263", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU0OTI1Mw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/263#discussion_r461549253", "bodyText": "This needs to be converted back into a ProcedureRequest before it's passed to buildUpdate()", "author": "ibacher", "createdAt": "2020-07-28T12:43:23Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/ProcedureRequestFhirResourceProvider.java", "diffHunk": "@@ -54,6 +63,34 @@ public ProcedureRequest getProcedureRequestById(@IdParam @NotNull IdType id) {\n \t\treturn (ProcedureRequest) VersionConvertor_30_40.convertResource(serviceRequest, false);\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createProcedureRequest(@ResourceParam ProcedureRequest procedureRequest) {\n+\t\treturn FhirProviderUtils.buildCreate(\n+\t\t    serviceRequestService.create((ServiceRequest) VersionConvertor_30_40.convertResource(procedureRequest, false)));\n+\t}\n+\t\n+\t@Update\n+\tpublic MethodOutcome updateProcedureRequest(@IdParam IdType id, @ResourceParam ProcedureRequest procedureRequest) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\t\t\n+\t\tprocedureRequest.setId(id.getIdPart());\n+\t\t\n+\t\treturn FhirProviderUtils.buildUpdate(serviceRequestService.update(id.getIdPart(),", "originalCommit": "644014172fdfa088df58c0cdc01cecec00bbe17e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU0OTcwNQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/263#discussion_r461549705", "bodyText": "This needs to be converted back to a ProcedureRequest before it's passed to buildCreate()", "author": "ibacher", "createdAt": "2020-07-28T12:44:07Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/ProcedureRequestFhirResourceProvider.java", "diffHunk": "@@ -54,6 +63,34 @@ public ProcedureRequest getProcedureRequestById(@IdParam @NotNull IdType id) {\n \t\treturn (ProcedureRequest) VersionConvertor_30_40.convertResource(serviceRequest, false);\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createProcedureRequest(@ResourceParam ProcedureRequest procedureRequest) {\n+\t\treturn FhirProviderUtils.buildCreate(", "originalCommit": "644014172fdfa088df58c0cdc01cecec00bbe17e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU1MDEyOA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/263#discussion_r461550128", "bodyText": "This is definitely not the expected condition (i.e., an R3 resource provider needs to return the R3 resource).", "author": "ibacher", "createdAt": "2020-07-28T12:44:50Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r3/ProcedureRequestFhirResourceProviderTest.java", "diffHunk": "@@ -107,6 +113,82 @@ public void getServiceRequestByWithWrongId_shouldThrowResourceNotFoundException(\n \t\tassertThat(resourceProvider.getProcedureRequestById(idType), nullValue());\n \t}\n \t\n+\t@Test\n+\tpublic void createProcedureRequest_shouldCreateNewProcedureRequest() {\n+\t\twhen(serviceRequestService.create(any(ServiceRequest.class))).thenReturn(serviceRequest);\n+\t\t\n+\t\tMethodOutcome result = resourceProvider\n+\t\t        .createProcedureRequest((ProcedureRequest) VersionConvertor_30_40.convertResource(serviceRequest, false));\n+\t\t\n+\t\tassertThat(result, notNullValue());\n+\t\tassertThat(result.getCreated(), is(true));\n+\t\tassertThat(result.getResource(), equalTo(serviceRequest));", "originalCommit": "644014172fdfa088df58c0cdc01cecec00bbe17e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU1MDI3OQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/263#discussion_r461550279", "bodyText": "This is definitely not the expected condition (i.e., an R3 resource provider needs to return the R3 resource).", "author": "ibacher", "createdAt": "2020-07-28T12:45:03Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r3/ProcedureRequestFhirResourceProviderTest.java", "diffHunk": "@@ -107,6 +113,82 @@ public void getServiceRequestByWithWrongId_shouldThrowResourceNotFoundException(\n \t\tassertThat(resourceProvider.getProcedureRequestById(idType), nullValue());\n \t}\n \t\n+\t@Test\n+\tpublic void createProcedureRequest_shouldCreateNewProcedureRequest() {\n+\t\twhen(serviceRequestService.create(any(ServiceRequest.class))).thenReturn(serviceRequest);\n+\t\t\n+\t\tMethodOutcome result = resourceProvider\n+\t\t        .createProcedureRequest((ProcedureRequest) VersionConvertor_30_40.convertResource(serviceRequest, false));\n+\t\t\n+\t\tassertThat(result, notNullValue());\n+\t\tassertThat(result.getCreated(), is(true));\n+\t\tassertThat(result.getResource(), equalTo(serviceRequest));\n+\t}\n+\t\n+\t@Test\n+\tpublic void updateProcedureRequest_shouldUpdateProcedureRequest() {\n+\t\twhen(serviceRequestService.update(eq(SERVICE_REQUEST_UUID), any(ServiceRequest.class))).thenReturn(serviceRequest);\n+\t\t\n+\t\tMethodOutcome result = resourceProvider.updateProcedureRequest(new IdType().setValue(SERVICE_REQUEST_UUID),\n+\t\t    (ProcedureRequest) VersionConvertor_30_40.convertResource(serviceRequest, false));\n+\t\t\n+\t\tassertThat(result, notNullValue());\n+\t\tassertThat(result.getResource(), equalTo(serviceRequest));", "originalCommit": "644014172fdfa088df58c0cdc01cecec00bbe17e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f3a5e8e9ca0ebc2a1e3dea2a4268f60ae0d12723", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/f3a5e8e9ca0ebc2a1e3dea2a4268f60ae0d12723", "message": "Fix formatting issues", "committedDate": "2020-07-22T06:10:43Z", "type": "forcePushed"}, {"oid": "25056b2da37cb4d1c30cc601dc92f5be57a8a146", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/25056b2da37cb4d1c30cc601dc92f5be57a8a146", "message": "FM2-267: Add create, update and delete methods for ProcedureRequest", "committedDate": "2020-07-30T15:37:05Z", "type": "commit"}, {"oid": "25056b2da37cb4d1c30cc601dc92f5be57a8a146", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/25056b2da37cb4d1c30cc601dc92f5be57a8a146", "message": "FM2-267: Add create, update and delete methods for ProcedureRequest", "committedDate": "2020-07-30T15:37:05Z", "type": "forcePushed"}]}