{"pr_number": 67, "pr_title": "FM2-66: Mapped verificationstatus to valueset", "pr_createdAt": "2020-02-14T11:52:08Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/67", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ0MjAxOQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/67#discussion_r379442019", "bodyText": "We should probably normalize the case here, i.e., codeableConcept.getCoding().get(0).getCode().toUpperCase()", "author": "ibacher", "createdAt": "2020-02-14T13:56:41Z", "path": "api-2.2/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ConditionVerificationStatusTranslatorImpl_2_2.java", "diffHunk": "@@ -26,28 +26,29 @@ public CodeableConcept toFhirResource(ConditionVerificationStatus verificationSt\n \t\tif (verificationStatus == null) {\n \t\t\treturn null;\n \t\t}\n-\t\treturn this.setVerificationStatus(verificationStatus.toString());\n+\t\treturn new CodeableConcept().addCoding(addVerificationStatusCoding(verificationStatus.toString()));\n \t}\n \t\n \t@Override\n \tpublic ConditionVerificationStatus toOpenmrsType(CodeableConcept codeableConcept) {\n-\t\treturn codeableConcept.getCoding().stream().filter(coding -> coding.getSystem().equals(FhirConstants.OPENMRS_URI))\n-\t\t        .map(this::getVerificationStatus).findFirst().get();\n-\t}\n-\t\n-\tprivate CodeableConcept setVerificationStatus(String text) {\n-\t\tCodeableConcept codeableConcept = new CodeableConcept();\n-\t\tcodeableConcept.addCoding().setCode(text).setDisplay(text).setSystem(FhirConstants.OPENMRS_URI);\n-\t\treturn codeableConcept;\n-\t}\n-\t\n-\tprivate ConditionVerificationStatus getVerificationStatus(Coding coding) {\n-\t\tswitch (coding.getCode().trim().toLowerCase()) {\n-\t\t\tcase \"confirmed\":\n+\t\tif (codeableConcept.getCoding().isEmpty()) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tswitch (codeableConcept.getCoding().get(0).getCode()) {", "originalCommit": "c714b00d04d66b821aa4e5f09b4282a9517cf385", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ5NDc4Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/67#discussion_r379494787", "bodyText": "Absolutely!\u2705", "author": "corneliouzbett", "createdAt": "2020-02-14T15:33:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ0MjAxOQ=="}], "type": "inlineReview"}, {"oid": "594a2af64765d5c8486e38585b834022cb59183d", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/594a2af64765d5c8486e38585b834022cb59183d", "message": "FM2-66: Mapped verificationstatus to valueset", "committedDate": "2020-02-14T15:32:10Z", "type": "commit"}, {"oid": "594a2af64765d5c8486e38585b834022cb59183d", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/594a2af64765d5c8486e38585b834022cb59183d", "message": "FM2-66: Mapped verificationstatus to valueset", "committedDate": "2020-02-14T15:32:10Z", "type": "forcePushed"}, {"oid": "e1ab4e99dd6c592d1b0c2009e9e783ceaf1813ee", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/e1ab4e99dd6c592d1b0c2009e9e783ceaf1813ee", "message": "Merge branch 'master' into FM2-66", "committedDate": "2020-02-17T13:22:15Z", "type": "commit"}]}