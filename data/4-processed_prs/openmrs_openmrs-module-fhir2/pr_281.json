{"pr_number": 281, "pr_title": "Null checks in translators and general improvements", "pr_createdAt": "2020-08-11T19:38:51Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTA1MDQ4MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469050480", "bodyText": "@varung-31Thanks for working on this,what if we also used type instead of reference.getType()  on the line of the exception? cc   @ibacher", "author": "HerbertYiga", "createdAt": "2020-08-12T07:09:54Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/PractitionerReferenceTranslatorUserImpl.java", "diffHunk": "@@ -42,7 +42,9 @@ public User toOpenmrsType(Reference reference) {\n \t\tif (reference == null) {\n \t\t\treturn null;\n \t\t}\n-\t\tif (!getReferenceType(reference).equals(\"Practitioner\")) {\n+\t\t\n+\t\tString type = reference.getType();\n+\t\tif (type != null && !type.equals(\"Practitioner\")) {\n \t\t\tthrow new IllegalArgumentException(\"Reference must be to an User not a \" + reference.getType());", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNDAzNw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469304037", "bodyText": "Please actually leave this on the interface. I'm intending for the Javadocs to go on interfaces where possible.", "author": "ibacher", "createdAt": "2020-08-12T14:31:38Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/FhirEncounterService.java", "diffHunk": "@@ -19,8 +17,6 @@\n \n public interface FhirEncounterService extends FhirService<Encounter> {\n \t\n-\tEncounter get(@NotNull String uuid);", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMyODkyMQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469328921", "bodyText": "But this is unnecessary repetition. This method is already present in the BaseFhirService, why do we want to declare it here as well?", "author": "varung-31", "createdAt": "2020-08-12T15:05:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNDAzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMzMDYyMQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469330621", "bodyText": "To have a per-type Javadoc, which should be, but hasn't been the standard. In most cases it doesn't matter, but it some cases it might.", "author": "ibacher", "createdAt": "2020-08-12T15:07:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNDAzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNDYyOA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469304628", "bodyText": "This needs to be updated, not removed.", "author": "ibacher", "createdAt": "2020-08-12T14:32:29Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/FhirTaskService.java", "diffHunk": "@@ -21,15 +21,6 @@\n  */\n public interface FhirTaskService extends FhirService<Task> {\n \t\n-\t/**\n-\t * Get list of tasks that reference the object type/UUID combo provided\n-\t *\n-\t * @param basedOnReference\n-\t * @param ownerReference\n-\t * @param status\n-\t * @param sort\n-\t * @return the collection of Tasks that match the search parameters\n-\t */", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMyOTQ2Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469329466", "bodyText": "Are we planning to have java docs on both the interfaces and the implementation? I think just having them on the interfaces suffices.", "author": "varung-31", "createdAt": "2020-08-12T15:06:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNDYyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMzNTcyNA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469335724", "bodyText": "Largely just on interfaces, but if FM2-268 is implemented (or as we gradually migrate towards that) it may be necessary to have the Javadoc on some implementations when there is no appropriate interface anymore.", "author": "ibacher", "createdAt": "2020-08-12T15:14:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNDYyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNTE1Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469305157", "bodyText": "I would prefer that on create we always assign a new UUID.", "author": "ibacher", "createdAt": "2020-08-12T14:33:14Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/BaseFhirService.java", "diffHunk": "@@ -28,6 +30,10 @@ public T get(String uuid) {\n \t\n \t@Override\n \tpublic T create(T newResource) {\n+\t\tif (newResource.getId() == null) {", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNTQ2OQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469305469", "bodyText": "This needs to be updated, not removed.", "author": "ibacher", "createdAt": "2020-08-12T14:33:37Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/impl/FhirTaskServiceImpl.java", "diffHunk": "@@ -44,15 +44,6 @@\n \t@Autowired\n \tprivate SearchQuery<FhirTask, Task, FhirTaskDao, TaskTranslator> searchQuery;\n \t\n-\t/**\n-\t * Get a list of Tasks that match the given search and sort criteria\n-\t *\n-\t * @param basedOnReference A reference to a basedOn resource\n-\t * @param ownerReference A reference to an owner resource\n-\t * @param status The list of statuses for requested Tasks\n-\t * @param sort\n-\t * @return the saved task\n-\t */", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNTc3Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469305776", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t}\n          \n          \n            \n            \t\tAllergyIntolerance.AllergyIntoleranceReactionComponent reactionComponent = new AllergyIntolerance.AllergyIntoleranceReactionComponent();\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\tAllergyIntolerance.AllergyIntoleranceReactionComponent reactionComponent = new AllergyIntolerance.AllergyIntoleranceReactionComponent();", "author": "ibacher", "createdAt": "2020-08-12T14:34:00Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/AllergyIntoleranceReactionComponentTranslatorImpl.java", "diffHunk": "@@ -37,6 +37,9 @@\n \t\n \t@Override\n \tpublic AllergyIntolerance.AllergyIntoleranceReactionComponent toFhirResource(Allergy allergy) {\n+\t\tif (allergy == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\tAllergyIntolerance.AllergyIntoleranceReactionComponent reactionComponent = new AllergyIntolerance.AllergyIntoleranceReactionComponent();", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNjA3Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469306077", "bodyText": "Is this, strictly speaking, necessary?", "author": "ibacher", "createdAt": "2020-08-12T14:34:26Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/AllergyIntoleranceTranslatorImpl.java", "diffHunk": "@@ -90,12 +90,15 @@ public AllergyIntolerance toFhirResource(Allergy omrsAllergy) {\n \t\n \t@Override\n \tpublic Allergy toOpenmrsType(AllergyIntolerance fhirAllergy) {\n+\t\tif (fhirAllergy == null) {\n+\t\t\treturn null;\n+\t\t}", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMzNjEyMQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469336121", "bodyText": "Yes, because if fhirAllergy is null and we are not returning null here or throwing an exception, it would lead to a new instance of Allergy being returned.", "author": "varung-31", "createdAt": "2020-08-12T15:15:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNjA3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMzODE3Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469338172", "bodyText": "Oh right! I missed that! Cheerfully withdrawn!", "author": "ibacher", "createdAt": "2020-08-12T15:18:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNjA3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNjk1NA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469306954", "bodyText": "This is actually a behaviour change. Do you think this is what we want to do? I could see:\nif (diagnosticReport == null) {\n\treturn null;\n}\n\nif (existingObs == null) {\n\texistingObs = new Obs();\n}", "author": "ibacher", "createdAt": "2020-08-12T14:35:41Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/DiagnosticReportTranslatorImpl.java", "diffHunk": "@@ -82,11 +82,7 @@ public Obs toOpenmrsType(DiagnosticReport diagnosticReport) {\n \t\n \t@Override\n \tpublic Obs toOpenmrsType(Obs existingObs, DiagnosticReport diagnosticReport) {\n-\t\tif (existingObs == null) {\n-\t\t\texistingObs = new Obs();\n-\t\t}\n-\t\t\n-\t\tif (diagnosticReport == null) {", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNzE0MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469307140", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t}\n          \n          \n            \n            \t\tEncounter.EncounterLocationComponent locationComponent = new Encounter.EncounterLocationComponent();\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\tEncounter.EncounterLocationComponent locationComponent = new Encounter.EncounterLocationComponent();", "author": "ibacher", "createdAt": "2020-08-12T14:35:54Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/EncounterLocationTranslatorImpl.java", "diffHunk": "@@ -31,13 +31,19 @@\n \t\n \t@Override\n \tpublic Encounter.EncounterLocationComponent toFhirResource(Location location) {\n+\t\tif (location == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\tEncounter.EncounterLocationComponent locationComponent = new Encounter.EncounterLocationComponent();", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNzI0MQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469307241", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t}\n          \n          \n            \n            \t\tString locationUuid = getReferenceId(encounterLocationComponent.getLocation());\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\tString locationUuid = getReferenceId(encounterLocationComponent.getLocation());", "author": "ibacher", "createdAt": "2020-08-12T14:36:01Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/EncounterLocationTranslatorImpl.java", "diffHunk": "@@ -31,13 +31,19 @@\n \t\n \t@Override\n \tpublic Encounter.EncounterLocationComponent toFhirResource(Location location) {\n+\t\tif (location == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\tEncounter.EncounterLocationComponent locationComponent = new Encounter.EncounterLocationComponent();\n \t\tlocationComponent.setLocation(createLocationReference(location));\n \t\treturn locationComponent;\n \t}\n \t\n \t@Override\n \tpublic Location toOpenmrsType(Encounter.EncounterLocationComponent encounterLocationComponent) {\n+\t\tif (encounterLocationComponent == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\tString locationUuid = getReferenceId(encounterLocationComponent.getLocation());", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNzM1NQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469307355", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t}\n          \n          \n            \n            \t\tEncounter.EncounterParticipantComponent participantComponent = new Encounter.EncounterParticipantComponent();\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\tEncounter.EncounterParticipantComponent participantComponent = new Encounter.EncounterParticipantComponent();", "author": "ibacher", "createdAt": "2020-08-12T14:36:10Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/EncounterParticipantTranslatorImpl.java", "diffHunk": "@@ -32,6 +32,9 @@\n \t\n \t@Override\n \tpublic Encounter.EncounterParticipantComponent toFhirResource(EncounterProvider encounter) {\n+\t\tif (encounter == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\tEncounter.EncounterParticipantComponent participantComponent = new Encounter.EncounterParticipantComponent();", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwNzc3Mw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469307773", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t}\n          \n          \n            \n            \t\treturn this.toOpenmrsType(new org.openmrs.Encounter(), fhirEncounter);\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\treturn this.toOpenmrsType(new org.openmrs.Encounter(), fhirEncounter);", "author": "ibacher", "createdAt": "2020-08-12T14:36:42Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/EncounterTranslatorImpl.java", "diffHunk": "@@ -93,14 +91,15 @@ public Encounter toFhirResource(org.openmrs.Encounter openMrsEncounter) {\n \t\n \t@Override\n \tpublic org.openmrs.Encounter toOpenmrsType(Encounter fhirEncounter) {\n+\t\tif (fhirEncounter == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\treturn this.toOpenmrsType(new org.openmrs.Encounter(), fhirEncounter);", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwODEyNA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469308124", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t}\n          \n          \n            \n            \t\texistingEncounter.setUuid(encounter.getId());\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\texistingEncounter.setUuid(encounter.getId());", "author": "ibacher", "createdAt": "2020-08-12T14:37:09Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/EncounterTranslatorImpl.java", "diffHunk": "@@ -93,14 +91,15 @@ public Encounter toFhirResource(org.openmrs.Encounter openMrsEncounter) {\n \t\n \t@Override\n \tpublic org.openmrs.Encounter toOpenmrsType(Encounter fhirEncounter) {\n+\t\tif (fhirEncounter == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\treturn this.toOpenmrsType(new org.openmrs.Encounter(), fhirEncounter);\n \t}\n \t\n \t@Override\n \tpublic org.openmrs.Encounter toOpenmrsType(org.openmrs.Encounter existingEncounter, Encounter encounter) {\n-\t\tnotNull(existingEncounter, \"Existing encounter cannot be null\");\n-\t\t\n-\t\tif (encounter == null) {\n+\t\tif (existingEncounter == null || encounter == null) {\n \t\t\treturn existingEncounter;\n \t\t}\n \t\texistingEncounter.setUuid(encounter.getId());", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwODIzMw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469308233", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t}\n          \n          \n            \n            \t\treturn toOpenmrsType(new Cohort(), cohortList);\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\treturn toOpenmrsType(new Cohort(), cohortList);", "author": "ibacher", "createdAt": "2020-08-12T14:37:18Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ListTranslatorImpl.java", "diffHunk": "@@ -62,12 +62,15 @@ public ListResource toFhirResource(Cohort cohort) {\n \t\n \t@Override\n \tpublic Cohort toOpenmrsType(ListResource cohortList) {\n+\t\tif (cohortList == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\treturn toOpenmrsType(new Cohort(), cohortList);", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwODYwNg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469308606", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t}\n          \n          \n            \n            \t\treturn toOpenmrsType(new Location(), address);\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\treturn toOpenmrsType(new Location(), address);", "author": "ibacher", "createdAt": "2020-08-12T14:37:50Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/LocationAddressTranslatorImpl.java", "diffHunk": "@@ -36,12 +37,15 @@ public Address toFhirResource(Location omrsLocation) {\n \t\n \t@Override\n \tpublic Location toOpenmrsType(Address address) {\n+\t\tif (address == null) {\n+\t\t\treturn null;\n+\t\t}\n \t\treturn toOpenmrsType(new Location(), address);", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwOTY3Mw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469309673", "bodyText": "The \"active\" attribute should no longer be translated, so I don't quite understand why we need it here?", "author": "ibacher", "createdAt": "2020-08-12T14:39:22Z", "path": "test-data/src/test/resources/org/openmrs/module/fhir2/providers/PatientWebTest_create.json", "diffHunk": "@@ -1,5 +1,6 @@\n {\n   \"resourceType\": \"Patient\",\n+  \"active\": true,", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMyNjc4OQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469326789", "bodyText": "We need it because in the patient translator we are checking if the patient instance is active or not, and if this active field is not present, it is throwing an exception saying voided by fhir module", "author": "varung-31", "createdAt": "2020-08-12T15:02:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwOTY3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMyOTY1MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469329650", "bodyText": "The easier solution is just to remove that check.", "author": "ibacher", "createdAt": "2020-08-12T15:06:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMwOTY3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMTM2Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469311362", "bodyText": "Is this change strictly-speaking necessary? I understand that id elements can be more complex so that getId() doesn't just return the id, but in this case that would actually indicate a bug in the code and so the test should fail.", "author": "ibacher", "createdAt": "2020-08-12T14:41:40Z", "path": "integration-tests/src/test/java/org/openmrs/module/fhir2/providers/r4/PatientFhirResourceProviderIntegrationTest.java", "diffHunk": "@@ -132,7 +132,7 @@ public void shouldCreateNewPatient() throws Exception {\n \t\tassertThat(patient, validResource());\n \t\t\n \t\t// try to get new patient\n-\t\tresponse = get(\"/Patient/\" + patient.getId()).accept(FhirMediaTypes.JSON).go();\n+\t\tresponse = get(\"/Patient/\" + patient.getIdElement().getIdPart()).accept(FhirMediaTypes.JSON).go();", "originalCommit": "43fb6b366f6abdc2cd71887af2da1b2e5d2ede92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMyNTA5OQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469325099", "bodyText": "If you try to step in through a debugger, you would see that patient.getId() would have the value as \"null\" and there was a gap in the patient translator because of which it was returning a new instance.\nGenerally speaking, patient.getId() has the value as Patient/<uuid>, whereas patient.getIdElement().getIdPart() has the value as <uuid>, hence in my opinion this change is necessary.", "author": "varung-31", "createdAt": "2020-08-12T14:59:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMTM2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMyODQ1OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/281#discussion_r469328458", "bodyText": "I see. That makes sense.", "author": "ibacher", "createdAt": "2020-08-12T15:04:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMTM2Mg=="}], "type": "inlineReview"}, {"oid": "a5abfe22b36fefb6f9040304d0064ab2b063131a", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/a5abfe22b36fefb6f9040304d0064ab2b063131a", "message": "Null checks in translators and general improvements", "committedDate": "2020-08-12T14:52:26Z", "type": "forcePushed"}, {"oid": "5ce8c341aa69842f91db6eb44b397c64fd51bc94", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/5ce8c341aa69842f91db6eb44b397c64fd51bc94", "message": "Null checks in translators and general improvements", "committedDate": "2020-08-13T12:58:37Z", "type": "forcePushed"}, {"oid": "d9470a825c6e68d3d44a3da5655cd778cc8d2309", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/d9470a825c6e68d3d44a3da5655cd778cc8d2309", "message": "Null checks in translators and general improvements", "committedDate": "2020-08-13T20:46:35Z", "type": "commit"}, {"oid": "d9470a825c6e68d3d44a3da5655cd778cc8d2309", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/d9470a825c6e68d3d44a3da5655cd778cc8d2309", "message": "Null checks in translators and general improvements", "committedDate": "2020-08-13T20:46:35Z", "type": "forcePushed"}]}