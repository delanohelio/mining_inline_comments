{"pr_number": 436, "pr_title": "docs - add info about registering native libraries", "pr_createdAt": "2020-09-01T23:27:18Z", "pr_url": "https://github.com/greenplum-db/pxf/pull/436", "timeline": [{"oid": "8917844a4f2cf06e75b13fd12c65c03900351f07", "url": "https://github.com/greenplum-db/pxf/commit/8917844a4f2cf06e75b13fd12c65c03900351f07", "message": "docs - add info about registering native libraries", "committedDate": "2020-09-01T23:22:47Z", "type": "commit"}, {"oid": "dd3d6c029b54a8986855e9b2b4f81e1929e2f7ce", "url": "https://github.com/greenplum-db/pxf/commit/dd3d6c029b54a8986855e9b2b4f81e1929e2f7ce", "message": "update topic title in oss book/subnav", "committedDate": "2020-09-01T23:31:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0ODQ0Mg==", "url": "https://github.com/greenplum-db/pxf/pull/436#discussion_r483948442", "bodyText": "I wonder if we should link to what we mean here?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To register a native library dependency for PXF, for example a Hadoop compression library, you must copy the native library to the Greenplum hosts, update PXF user configuration, synchronize the PXF configuration to the cluster, and then restart PXF on each segment host.\n          \n          \n            \n            To register a native library dependency for PXF, for example [Hadoop native libraries](https://hadoop.apache.org/docs/r2.9.2/hadoop-project-dist/hadoop-common/NativeLibraries.html), you must copy the native library to the Greenplum hosts, update PXF user configuration, synchronize the PXF configuration to the cluster, and then restart PXF on each segment host.", "author": "frankgh", "createdAt": "2020-09-05T12:52:19Z", "path": "docs/content/reg_jar_depend.html.md.erb", "diffHunk": "@@ -34,3 +38,44 @@ gpadmin@gpmaster$ pxf cluster sync\n gpadmin@gpmaster$ pxf cluster restart\n ```\n \n+## <a id=\"reg_native\"></a> Registering a Native Library Dependency\n+\n+To register a native library dependency for PXF, for example a Hadoop compression library, you must copy the native library to the Greenplum hosts, update PXF user configuration, synchronize the PXF configuration to the cluster, and then restart PXF on each segment host.", "originalCommit": "dd3d6c029b54a8986855e9b2b4f81e1929e2f7ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0OTc4MQ==", "url": "https://github.com/greenplum-db/pxf/pull/436#discussion_r483949781", "bodyText": "We only need the path here:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib/dependent_native_lib.so\n          \n          \n            \n                export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib/", "author": "frankgh", "createdAt": "2020-09-05T13:09:31Z", "path": "docs/content/reg_jar_depend.html.md.erb", "diffHunk": "@@ -34,3 +38,44 @@ gpadmin@gpmaster$ pxf cluster sync\n gpadmin@gpmaster$ pxf cluster restart\n ```\n \n+## <a id=\"reg_native\"></a> Registering a Native Library Dependency\n+\n+To register a native library dependency for PXF, for example a Hadoop compression library, you must copy the native library to the Greenplum hosts, update PXF user configuration, synchronize the PXF configuration to the cluster, and then restart PXF on each segment host.\n+\n+You have two options for copying the native library to Greenplum hosts:\n+\n+- You copy the library to the same location on the Greenplum master, standby, and all segment hosts.\n+- You copy the library to the `$PXF_CONF/lib` directory hierarchy on the Greenplum master host. When you next synchronize PXF, the PXF configuration, including the native library, is copied to all hosts in the Greenplum Database cluster.\n+\n+### <a id=\"reg_native_proc\"></a> Procedure\n+\n+1. Copy the native library file to a user-defined location on all Greenplum Database hosts, or copy to the `$PXF_CONF/lib` directory hierarchy on the Greenplum Database master node. Note the file system location of the native library.\n+\n+2. Open the `$PXF_CONF/conf/pxf-env.sh` in the editor of your choice, and set `LD_LIBRARY_PATH`. For example, if you copied a native library named `dependent_native_lib.so` to `/usr/local/lib/dependent_native_lib.so` on all Greenplum hosts, add the following text to the `pxf-env.sh` file to set this environment variable:\n+\n+    ``` shell\n+    export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib/dependent_native_lib.so", "originalCommit": "dd3d6c029b54a8986855e9b2b4f81e1929e2f7ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk0OTgzNQ==", "url": "https://github.com/greenplum-db/pxf/pull/436#discussion_r483949835", "bodyText": "Same here:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$PXF_CONF/lib/native/dependent_native_lib.so\n          \n          \n            \n                export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$PXF_CONF/lib/native/", "author": "frankgh", "createdAt": "2020-09-05T13:09:56Z", "path": "docs/content/reg_jar_depend.html.md.erb", "diffHunk": "@@ -34,3 +38,44 @@ gpadmin@gpmaster$ pxf cluster sync\n gpadmin@gpmaster$ pxf cluster restart\n ```\n \n+## <a id=\"reg_native\"></a> Registering a Native Library Dependency\n+\n+To register a native library dependency for PXF, for example a Hadoop compression library, you must copy the native library to the Greenplum hosts, update PXF user configuration, synchronize the PXF configuration to the cluster, and then restart PXF on each segment host.\n+\n+You have two options for copying the native library to Greenplum hosts:\n+\n+- You copy the library to the same location on the Greenplum master, standby, and all segment hosts.\n+- You copy the library to the `$PXF_CONF/lib` directory hierarchy on the Greenplum master host. When you next synchronize PXF, the PXF configuration, including the native library, is copied to all hosts in the Greenplum Database cluster.\n+\n+### <a id=\"reg_native_proc\"></a> Procedure\n+\n+1. Copy the native library file to a user-defined location on all Greenplum Database hosts, or copy to the `$PXF_CONF/lib` directory hierarchy on the Greenplum Database master node. Note the file system location of the native library.\n+\n+2. Open the `$PXF_CONF/conf/pxf-env.sh` in the editor of your choice, and set `LD_LIBRARY_PATH`. For example, if you copied a native library named `dependent_native_lib.so` to `/usr/local/lib/dependent_native_lib.so` on all Greenplum hosts, add the following text to the `pxf-env.sh` file to set this environment variable:\n+\n+    ``` shell\n+    export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib/dependent_native_lib.so\n+    ```\n+\n+    If you copied a native library named `dependent_native_lib.so` to `$PXF_CONF/lib/native/dependent_native_lib.so` on the Greenplum master host, add the following text to the `pxf-env.sh` file to set this environment variable:\n+\n+    ``` shell\n+    export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$PXF_CONF/lib/native/dependent_native_lib.so", "originalCommit": "dd3d6c029b54a8986855e9b2b4f81e1929e2f7ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3a5d5f1c256285bf66d23577940b8ef6b3f61bca", "url": "https://github.com/greenplum-db/pxf/commit/3a5d5f1c256285bf66d23577940b8ef6b3f61bca", "message": "edits from francisco", "committedDate": "2020-09-08T22:10:19Z", "type": "commit"}, {"oid": "f724323130c13231825449e4a3bfb721ea5a8e77", "url": "https://github.com/greenplum-db/pxf/commit/f724323130c13231825449e4a3bfb721ea5a8e77", "message": "revisit topic contents per pxf PR #439", "committedDate": "2020-09-09T20:43:26Z", "type": "commit"}, {"oid": "2aff6585b57d1fb0a0c1e98e25228b67eb2f661f", "url": "https://github.com/greenplum-db/pxf/commit/2aff6585b57d1fb0a0c1e98e25228b67eb2f661f", "message": "add that user may need to create the native directory", "committedDate": "2020-09-09T23:05:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU5Njc3Mg==", "url": "https://github.com/greenplum-db/pxf/pull/436#discussion_r486596772", "bodyText": "You copy -> Copy\nx3\nPXF copies -> PXF distributes (?)", "author": "dyozie", "createdAt": "2020-09-10T19:53:46Z", "path": "docs/content/reg_jar_depend.html.md.erb", "diffHunk": "@@ -34,3 +38,66 @@ gpadmin@gpmaster$ pxf cluster sync\n gpadmin@gpmaster$ pxf cluster restart\n ```\n \n+## <a id=\"reg_native\"></a> Registering a Native Library Dependency\n+\n+PXF loads native libraries from the following directories in this order:\n+\n+1. The directories that you specify in the `$PXF_CONF/conf/pxf-env.sh` user configuration file `LD_LIBRARY_PATH` setting. Starting in PXF version 5.15.1, the `pxf-env.sh` file includes this commented-out block:\n+\n+    ``` pre\n+    # Additional native libraries to be loaded by PXF\n+    # export LD_LIBRARY_PATH=\n+    ```\n+\n+2. The default PXF native library directory `$PXF_CONF/lib/native`.\n+3. The default Hadoop native library directory `/usr/lib/hadoop/lib/native`.\n+\n+When you register a native library dependency with PXF, for example [Hadoop native libraries](https://hadoop.apache.org/docs/r2.9.2/hadoop-project-dist/hadoop-common/NativeLibraries.html), you copy the native library to a location known to PXF *or* inform PXF of a custom location, and then you must synchronize and restart PXF.\n+\n+You have three file location options when you register a native library with PXF:\n+\n+- You copy the library to the default PXF native library directory, `$PXF_CONF/lib/native`, on only the Greenplum Database master host. When you next synchronize PXF, PXF copies the native library to all hosts in the Greenplum cluster.", "originalCommit": "2aff6585b57d1fb0a0c1e98e25228b67eb2f661f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e5a01874086baa8121ed2e20eddf9f42a67ca66b", "url": "https://github.com/greenplum-db/pxf/commit/e5a01874086baa8121ed2e20eddf9f42a67ca66b", "message": "You copy -> Copy", "committedDate": "2020-09-10T20:12:37Z", "type": "commit"}]}