{"pr_number": 516, "pr_title": "Update README", "pr_createdAt": "2020-12-12T00:36:48Z", "pr_url": "https://github.com/greenplum-db/pxf/pull/516", "timeline": [{"oid": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "url": "https://github.com/greenplum-db/pxf/commit/576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "message": "Update README\n\n- add instructions for locally deployed GPDB and PXF\n- update instructions for GPDB5 and PXF deployed in docker\n- add intructions for debugging running local PXF with IntelliJ", "committedDate": "2020-12-12T00:37:05Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY3NDEwOA==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r541674108", "bodyText": "this is mac-specific, maybe just mention that or we can suggest to set JAVA_HOME to the appropriate location", "author": "frankgh", "createdAt": "2020-12-12T17:12:29Z", "path": "README.md", "diffHunk": "@@ -215,6 +259,11 @@ Setup [User Impersonation](https://hadoop.apache.org/docs/current/hadoop-project\n ~/workspace/pxf/dev/configure_singlecluster.bash\n ```\n \n+While PXF can run on either Java 8 or Java 11, please ensure that you are running Java 8 for hdfs etc. You can set your java version using `JAVA_HOME` like so:\n+```\n+export JAVA_HOME=`/usr/libexec/java_home -v 1.8`", "originalCommit": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY3NDM0OQ==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r541674349", "bodyText": "why GPDB5? These instructions work for GP7, 6 and 5", "author": "frankgh", "createdAt": "2020-12-12T17:13:04Z", "path": "README.md", "diffHunk": "@@ -178,15 +218,19 @@ docker run --rm -it \\\n   -v ~/workspace/gpdb:/home/gpadmin/workspace/gpdb \\\n   -v ~/workspace/pxf:/home/gpadmin/workspace/pxf \\\n   -v ~/workspace/singlecluster-HDP:/home/gpadmin/workspace/singlecluster \\\n-  pivotaldata/gpdb-pxf-dev:centos6 /bin/bash -c \\\n-  \"/home/gpadmin/workspace/pxf/dev/set_up_gpadmin_user.bash && /sbin/service sshd start && su - gpadmin\"\n+  pivotaldata/gpdb-pxf-dev:centos7 /bin/bash -c \\\n+  \"/home/gpadmin/workspace/pxf/dev/set_up_gpadmin_user.bash && /usr/sbin/sshd && su - gpadmin\"\n ```\n \n-### Setup GPDB\n+### Setup GPDB5 in the Docker image", "originalCommit": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQxNTY0OQ==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r542415649", "bodyText": "actually, this is not necessary, you can run\nPXF_BASE=${HOME}/pxf-boot pxf prepare\n\nto prepare the $PXF_BASE directory. This includes creating the directory and copying the template files. This step has to be done after PXF has been installed", "author": "frankgh", "createdAt": "2020-12-14T14:14:52Z", "path": "README.md", "diffHunk": "@@ -111,17 +111,48 @@ make\n make test\n ```\n \n-## How to Install PXF\n+## How to Install PXF locally\n \n To install PXF, first make sure that the user has sufficient permissions in the `$GPHOME` and `$PXF_HOME` directories to perform the installation. It's recommended to change ownership to match the installing user. For example, when installing PXF as user `gpadmin` under `/usr/local/greenplum-db`:\n \n+If `${HOME}/pxf-boot` does not exist, please create it: `mkdir ${HOME}/pxf-boot`. This command should only need to be run once.", "originalCommit": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQxNjYyNA==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r542416624", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            NOTE: if `PXF_BASE` is not properly set up, there is a possibility that the user's existing server configurations may get deleted.\n          \n          \n            \n            NOTE: if `PXF_BASE` is not set, it will default to `PXF_HOME`, and server configurations, libraries or other configurations, might get deleted after a PXF re-install.", "author": "frankgh", "createdAt": "2020-12-14T14:16:14Z", "path": "README.md", "diffHunk": "@@ -111,17 +111,48 @@ make\n make test\n ```\n \n-## How to Install PXF\n+## How to Install PXF locally\n \n To install PXF, first make sure that the user has sufficient permissions in the `$GPHOME` and `$PXF_HOME` directories to perform the installation. It's recommended to change ownership to match the installing user. For example, when installing PXF as user `gpadmin` under `/usr/local/greenplum-db`:\n \n+If `${HOME}/pxf-boot` does not exist, please create it: `mkdir ${HOME}/pxf-boot`. This command should only need to be run once.\n+\n ```bash\n export GPHOME=/usr/local/greenplum-db\n export PXF_HOME=/usr/local/pxf\n+export PXF_BASE=${HOME}/pxf-boot\n chown -R gpadmin:gpadmin \"${GPHOME}\" \"${PXF_HOME}\"\n make -C ~/workspace/pxf install\n ```\n \n+NOTE: if `PXF_BASE` is not properly set up, there is a possibility that the user's existing server configurations may get deleted.", "originalCommit": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQxNzMzOA==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r542417338", "bodyText": "pxf prepare will create your PXF_BASE directory. We might want to note that this is a one-time step", "author": "frankgh", "createdAt": "2020-12-14T14:17:13Z", "path": "README.md", "diffHunk": "@@ -111,17 +111,48 @@ make\n make test\n ```\n \n-## How to Install PXF\n+## How to Install PXF locally\n \n To install PXF, first make sure that the user has sufficient permissions in the `$GPHOME` and `$PXF_HOME` directories to perform the installation. It's recommended to change ownership to match the installing user. For example, when installing PXF as user `gpadmin` under `/usr/local/greenplum-db`:\n \n+If `${HOME}/pxf-boot` does not exist, please create it: `mkdir ${HOME}/pxf-boot`. This command should only need to be run once.\n+\n ```bash\n export GPHOME=/usr/local/greenplum-db\n export PXF_HOME=/usr/local/pxf\n+export PXF_BASE=${HOME}/pxf-boot\n chown -R gpadmin:gpadmin \"${GPHOME}\" \"${PXF_HOME}\"\n make -C ~/workspace/pxf install\n ```\n \n+NOTE: if `PXF_BASE` is not properly set up, there is a possibility that the user's existing server configurations may get deleted.\n+\n+## How to Run PXF locally\n+\n+Ensure that PXF is in your path. This command can be added to your .bashrc\n+```bash\n+export PATH=/usr/local/pxf/bin:$PATH\n+```\n+\n+Then you can prepare and start up PXF by doing the following.\n+```bash\n+pxf prepare", "originalCommit": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQxNzU4NQ==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r542417585", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Note: Local development with PXF requires a running GPDB6 cluster.\n          \n          \n            \n            Note: Local development with PXF requires a running Greenplum cluster.", "author": "frankgh", "createdAt": "2020-12-14T14:17:31Z", "path": "README.md", "diffHunk": "@@ -111,17 +111,48 @@ make\n make test\n ```\n \n-## How to Install PXF\n+## How to Install PXF locally\n \n To install PXF, first make sure that the user has sufficient permissions in the `$GPHOME` and `$PXF_HOME` directories to perform the installation. It's recommended to change ownership to match the installing user. For example, when installing PXF as user `gpadmin` under `/usr/local/greenplum-db`:\n \n+If `${HOME}/pxf-boot` does not exist, please create it: `mkdir ${HOME}/pxf-boot`. This command should only need to be run once.\n+\n ```bash\n export GPHOME=/usr/local/greenplum-db\n export PXF_HOME=/usr/local/pxf\n+export PXF_BASE=${HOME}/pxf-boot\n chown -R gpadmin:gpadmin \"${GPHOME}\" \"${PXF_HOME}\"\n make -C ~/workspace/pxf install\n ```\n \n+NOTE: if `PXF_BASE` is not properly set up, there is a possibility that the user's existing server configurations may get deleted.\n+\n+## How to Run PXF locally\n+\n+Ensure that PXF is in your path. This command can be added to your .bashrc\n+```bash\n+export PATH=/usr/local/pxf/bin:$PATH\n+```\n+\n+Then you can prepare and start up PXF by doing the following.\n+```bash\n+pxf prepare\n+pxf start\n+```\n+\n+## Re-installing PXF after making changes\n+Note: Local development with PXF requires a running GPDB6 cluster.", "originalCommit": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQxODAyNg==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r542418026", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            2. Run `make -sj4 install-server` to only re-install PXF without running tests.\n          \n          \n            \n            2. Run `make -sj4 install-server` to only re-install the PXF server without running unit tests.", "author": "frankgh", "createdAt": "2020-12-14T14:18:07Z", "path": "README.md", "diffHunk": "@@ -111,17 +111,48 @@ make\n make test\n ```\n \n-## How to Install PXF\n+## How to Install PXF locally\n \n To install PXF, first make sure that the user has sufficient permissions in the `$GPHOME` and `$PXF_HOME` directories to perform the installation. It's recommended to change ownership to match the installing user. For example, when installing PXF as user `gpadmin` under `/usr/local/greenplum-db`:\n \n+If `${HOME}/pxf-boot` does not exist, please create it: `mkdir ${HOME}/pxf-boot`. This command should only need to be run once.\n+\n ```bash\n export GPHOME=/usr/local/greenplum-db\n export PXF_HOME=/usr/local/pxf\n+export PXF_BASE=${HOME}/pxf-boot\n chown -R gpadmin:gpadmin \"${GPHOME}\" \"${PXF_HOME}\"\n make -C ~/workspace/pxf install\n ```\n \n+NOTE: if `PXF_BASE` is not properly set up, there is a possibility that the user's existing server configurations may get deleted.\n+\n+## How to Run PXF locally\n+\n+Ensure that PXF is in your path. This command can be added to your .bashrc\n+```bash\n+export PATH=/usr/local/pxf/bin:$PATH\n+```\n+\n+Then you can prepare and start up PXF by doing the following.\n+```bash\n+pxf prepare\n+pxf start\n+```\n+\n+## Re-installing PXF after making changes\n+Note: Local development with PXF requires a running GPDB6 cluster.\n+\n+Once the desired changes have been made, there are 2 options to re-install PXF:\n+\n+1. Run `make -sj4 install` to re-install and run tests\n+2. Run `make -sj4 install-server` to only re-install PXF without running tests.", "originalCommit": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQxODcxOA==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r542418718", "bodyText": "Not sure why we assume greenplum 5 is running, these instructions should work with all versions of Greenplum\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The following commands run the docker container and set up and switch to user gpadmin. They assume tat the user is running GPDB5\n          \n          \n            \n            The following commands run the docker container and set up and switch to user gpadmin.", "author": "frankgh", "createdAt": "2020-12-14T14:19:08Z", "path": "README.md", "diffHunk": "@@ -132,11 +163,20 @@ cd ~/workspace\n tar xzf singlecluster-HDP.tar.gz\n ```\n \n+Create a symlink using `ln -s ~/workspace/singlecluster-HDP ~/workspace/singlecluster` and then follow the steps in [Setup Hadoop](#Setup-Hadoop).\n+\n+Initialize the default server configurations:\n+```\n+cp ${PXF_HOME}/templates/{hdfs,mapred,yarn,core,hbase,hive}-site.xml ${PXF_BASE}/servers/default\n+```\n+\n # Development With Docker\n NOTE: Since the docker container will house all Single cluster Hadoop, Greenplum and PXF, we recommend that you have at least 4 cpus and 6GB memory allocated to Docker. These settings are available under docker preferences.\n \n-The following commands run the docker container and set up and switch to user gpadmin.\n+The following commands run the docker container and set up and switch to user gpadmin. They assume tat the user is running GPDB5", "originalCommit": "576c49fa87a581f0be6a79a6f3e376e3a6b6b4d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1MzE3MA==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r546053170", "bodyText": "We were unable to get the docker set up and running with GPDB 6 or master. There's a TODO below to see if there is something that can be done for that to work. I updated the documentation here to say GPDB 5 only for clarity.", "author": "ashuka24", "createdAt": "2020-12-18T19:39:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQxODcxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjE5MDQ5Mw==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r556190493", "bodyText": "I am not sure locally adds any value here, by default devs assume local install and all steps above were also for local install.", "author": "denalex", "createdAt": "2021-01-13T00:47:01Z", "path": "README.md", "diffHunk": "@@ -111,17 +111,47 @@ make\n make test\n ```\n \n-## How to Install PXF\n+## How to Install PXF locally", "originalCommit": "64a23037b031c41c39913ed77eefab030bab8e4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjE5MDU1Mg==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r556190552", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            export PXF_BASE=${HOME}/pxf-boot\n          \n          \n            \n            export PXF_BASE=${HOME}/pxf-base", "author": "denalex", "createdAt": "2021-01-13T00:47:14Z", "path": "README.md", "diffHunk": "@@ -111,17 +111,47 @@ make\n make test\n ```\n \n-## How to Install PXF\n+## How to Install PXF locally\n \n To install PXF, first make sure that the user has sufficient permissions in the `$GPHOME` and `$PXF_HOME` directories to perform the installation. It's recommended to change ownership to match the installing user. For example, when installing PXF as user `gpadmin` under `/usr/local/greenplum-db`:\n \n ```bash\n export GPHOME=/usr/local/greenplum-db\n export PXF_HOME=/usr/local/pxf\n+export PXF_BASE=${HOME}/pxf-boot", "originalCommit": "64a23037b031c41c39913ed77eefab030bab8e4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjE5MTE1Ng==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r556191156", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If `${HOME}/pxf-boot` does not exist, `pxf prepare` will create the directory for you. This command should only need to be run once.\n          \n          \n            \n            If `${HOME}/pxf-base` does not exist, `pxf prepare` will create the directory for you. This command should only need to be run once.", "author": "denalex", "createdAt": "2021-01-13T00:49:10Z", "path": "README.md", "diffHunk": "@@ -111,17 +111,47 @@ make\n make test\n ```\n \n-## How to Install PXF\n+## How to Install PXF locally\n \n To install PXF, first make sure that the user has sufficient permissions in the `$GPHOME` and `$PXF_HOME` directories to perform the installation. It's recommended to change ownership to match the installing user. For example, when installing PXF as user `gpadmin` under `/usr/local/greenplum-db`:\n \n ```bash\n export GPHOME=/usr/local/greenplum-db\n export PXF_HOME=/usr/local/pxf\n+export PXF_BASE=${HOME}/pxf-boot\n chown -R gpadmin:gpadmin \"${GPHOME}\" \"${PXF_HOME}\"\n make -C ~/workspace/pxf install\n ```\n \n+NOTE: if `PXF_BASE` is not set, it will default to `PXF_HOME`, and server configurations, libraries or other configurations, might get deleted after a PXF re-install.\n+\n+## How to Run PXF locally\n+\n+Ensure that PXF is in your path. This command can be added to your .bashrc\n+```bash\n+export PATH=/usr/local/pxf/bin:$PATH\n+```\n+\n+Then you can prepare and start up PXF by doing the following.\n+```bash\n+pxf prepare\n+pxf start\n+```\n+If `${HOME}/pxf-boot` does not exist, `pxf prepare` will create the directory for you. This command should only need to be run once.", "originalCommit": "64a23037b031c41c39913ed77eefab030bab8e4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjE5Mjk5OA==", "url": "https://github.com/greenplum-db/pxf/pull/516#discussion_r556192998", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            cp ${PXF_HOME}/templates/{hdfs,mapred,yarn,core,hbase,hive}-site.xml ${PXF_BASE}/servers/default\n          \n          \n            \n            cp ${PXF_HOME}/templates/*-site.xml ${PXF_BASE}/servers/default\n          \n      \n    \n    \n  \n\nto also copy pxf-site.xml", "author": "denalex", "createdAt": "2021-01-13T00:54:43Z", "path": "README.md", "diffHunk": "@@ -132,37 +162,31 @@ cd ~/workspace\n tar xzf singlecluster-HDP.tar.gz\n ```\n \n-# Development With Docker\n-NOTE: Since the docker container will house all Single cluster Hadoop, Greenplum and PXF, we recommend that you have at least 4 cpus and 6GB memory allocated to Docker. These settings are available under docker preferences.\n-\n-The following commands run the docker container and set up and switch to user gpadmin.\n+Create a symlink using `ln -s ~/workspace/singlecluster-HDP ~/workspace/singlecluster` and then follow the steps in [Setup Hadoop](#Setup-Hadoop).\n \n-```bash\n-# Get the latest image\n-export GCR_PROJECT=<YOUR-GOOGLE_CONTAINER_REGISTRY-PROJECT-NAME>\n-docker pull gcr.io/$GCR_PROJECT/gpdb-pxf-dev/gpdb6-centos7-test-pxf:latest\n+While PXF can run on either Java 8 or Java 11, please ensure that you are running Java 8 for hdfs, hadoop, etc. Please set your java version by seting your `JAVA_HOME` to the appropriate location.\n \n-docker run --rm -it \\\n-  -p 5432:5432 \\\n-  -p 5888:5888 \\\n-  -p 8000:8000 \\\n-  -p 5005:5005 \\\n-  -p 8020:8020 \\\n-  -p 9000:9000 \\\n-  -p 9090:9090 \\\n-  -p 50070:50070 \\\n-  -w /home/gpadmin/workspace \\\n-  -v ~/workspace/pxf:/home/gpadmin/workspace/pxf \\\n-  -v ~/workspace/singlecluster-HDP:/home/gpadmin/workspace/singlecluster \\\n-  gcr.io/$GCR_PROJECT/gpdb-pxf-dev/gpdb6-centos7-test-pxf:latest /bin/bash -c \\\n-  \"/home/gpadmin/workspace/pxf/dev/indocker_setup.bash && /sbin/service sshd start && su - gpadmin\"\n+On a Mac, you can set your java version using `JAVA_HOME` like so:\n+```\n+export JAVA_HOME=`/usr/libexec/java_home -v 1.8`\n+````\n \n+Initialize the default server configurations:\n ```\n+cp ${PXF_HOME}/templates/{hdfs,mapred,yarn,core,hbase,hive}-site.xml ${PXF_BASE}/servers/default", "originalCommit": "64a23037b031c41c39913ed77eefab030bab8e4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d49dd7cf7a141db84bb3ae6214db78e68acd1b61", "url": "https://github.com/greenplum-db/pxf/commit/d49dd7cf7a141db84bb3ae6214db78e68acd1b61", "message": "Update README\n\n- add instructions for locally deployed GPDB and PXF\n- update instructions for GPDB5 and PXF deployed in docker\n- add instructions for debugging running local PXF with IntelliJ\n- update install_pxf script to also work with PXF6", "committedDate": "2021-01-19T23:30:42Z", "type": "commit"}, {"oid": "d49dd7cf7a141db84bb3ae6214db78e68acd1b61", "url": "https://github.com/greenplum-db/pxf/commit/d49dd7cf7a141db84bb3ae6214db78e68acd1b61", "message": "Update README\n\n- add instructions for locally deployed GPDB and PXF\n- update instructions for GPDB5 and PXF deployed in docker\n- add instructions for debugging running local PXF with IntelliJ\n- update install_pxf script to also work with PXF6", "committedDate": "2021-01-19T23:30:42Z", "type": "forcePushed"}]}