{"pr_number": 413, "pr_title": "Singlecluster pipeline", "pr_createdAt": "2020-07-18T22:02:52Z", "pr_url": "https://github.com/greenplum-db/pxf/pull/413", "timeline": [{"oid": "bae1da5015661bbcb2a4efe5e815566ecfec38ce", "url": "https://github.com/greenplum-db/pxf/commit/bae1da5015661bbcb2a4efe5e815566ecfec38ce", "message": "Convert the docker images pipeline to the singlecluster pipeline", "committedDate": "2020-07-18T22:04:48Z", "type": "forcePushed"}, {"oid": "4272a25a710db66b8abe3d584cb7749fed075ca3", "url": "https://github.com/greenplum-db/pxf/commit/4272a25a710db66b8abe3d584cb7749fed075ca3", "message": "Rename the pipeline filename and add deploy instructions", "committedDate": "2020-07-18T22:05:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM3ODQwNw==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458378407", "bodyText": "can we substitute this with a make command like in the sections above ?", "author": "denalex", "createdAt": "2020-07-21T20:48:26Z", "path": "concourse/README.md", "diffHunk": "@@ -25,7 +25,20 @@ To deploy the certifcation pipeline (forward compatibility) for PXF, make sure P\n make -C \"${HOME}/workspace/pxf/concourse\" certification\n ```\n \n-# Deploy cloudbuild pipeline\n+# Deploy the singlecluster pipeline\n+\n+The singlecluster pipeline generates the singlecluster tarball for CDH, HDP2,\n+and HDP3. The generated tarballs are then published to an S3 and GCS bucket.\n+The produced tarballs can then be consumed in the pxf-build pipelines.\n+\n+```shell script\n+fly -t ud set-pipeline \\\n+    -c ~/workspace/pxf/concourse/pipelines/singlecluster-pipeline.yml \\\n+    -l ~/workspace/gp-continuous-integration/secrets/gpdb_common-ci-secrets.yml \\\n+    -v pxf-git-branch=master -p pxf-singlecluster\n+```", "originalCommit": "4272a25a710db66b8abe3d584cb7749fed075ca3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ2MzAzMA==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458463030", "bodyText": "not a huge fan, but I can do that", "author": "frankgh", "createdAt": "2020-07-22T00:23:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM3ODQwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM3OTA2OA==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458379068", "bodyText": "wonder if we want to use a newer driver ?", "author": "denalex", "createdAt": "2020-07-21T20:49:42Z", "path": "concourse/pipelines/singlecluster-pipeline.yml", "diffHunk": "@@ -0,0 +1,190 @@\n+## ======================================================================\n+## RESOURCE TYPES\n+## ======================================================================\n+resource_types:\n+- name: google-cloud-storage\n+  type: docker-image\n+  source:\n+    repository: frodenas/gcs-resource\n+\n+## ======================================================================\n+## RESOURCES\n+## ======================================================================\n+resources:\n+  - name: hdp2_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: hortonworks/HDP-2.5.3.0-centos6-tars-tarball.tar.gz\n+\n+  - name: hdp3_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: hortonworks/HDP-3.1.4.0-centos7-tars-tarball.tar.gz\n+\n+  - name: cdh_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: cloudera/CDH-5.12.2.tar.gz\n+\n+  - name: jdbc\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: jdbc/postgresql-jdbc-8.4.704.jar", "originalCommit": "4272a25a710db66b8abe3d584cb7749fed075ca3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ2MjU3MQ==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458462571", "bodyText": "yeah, I was wondering if we need the driver at all. Do you have any context on why it's needed?", "author": "frankgh", "createdAt": "2020-07-22T00:22:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM3OTA2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MDAzMQ==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458380031", "bodyText": "what's the point of noarch in the names in these jobs ?", "author": "denalex", "createdAt": "2020-07-21T20:51:33Z", "path": "concourse/pipelines/singlecluster-pipeline.yml", "diffHunk": "@@ -0,0 +1,190 @@\n+## ======================================================================\n+## RESOURCE TYPES\n+## ======================================================================\n+resource_types:\n+- name: google-cloud-storage\n+  type: docker-image\n+  source:\n+    repository: frodenas/gcs-resource\n+\n+## ======================================================================\n+## RESOURCES\n+## ======================================================================\n+resources:\n+  - name: hdp2_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: hortonworks/HDP-2.5.3.0-centos6-tars-tarball.tar.gz\n+\n+  - name: hdp3_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: hortonworks/HDP-3.1.4.0-centos7-tars-tarball.tar.gz\n+\n+  - name: cdh_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: cloudera/CDH-5.12.2.tar.gz\n+\n+  - name: jdbc\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: jdbc/postgresql-jdbc-8.4.704.jar\n+\n+  - name: singlecluster-HDP2\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: singlecluster/singlecluster-HDP2.tar.gz\n+\n+  - name: singlecluster-HDP2-gcs\n+    type: google-cloud-storage\n+    icon: google-drive\n+    source:\n+      bucket: {{pxf-build-resources-bucket-name}}\n+      json_key: {{data-gpdb-ud-google-json-key}}\n+      versioned_file: singlecluster/HDP2/singlecluster-HDP2.tar.gz\n+\n+  - name: singlecluster-HDP3\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: singlecluster/singlecluster-HDP3.tar.gz\n+\n+  - name: singlecluster-HDP3-gcs\n+    type: google-cloud-storage\n+    icon: google-drive\n+    source:\n+      bucket: {{pxf-build-resources-bucket-name}}\n+      json_key: {{data-gpdb-ud-google-json-key}}\n+      versioned_file: singlecluster/HDP3/singlecluster-HDP3.tar.gz\n+\n+  - name: singlecluster-CDH\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: singlecluster/singlecluster-CDH.tar.gz\n+\n+  - name: singlecluster-CDH-gcs\n+    type: google-cloud-storage\n+    icon: google-drive\n+    source:\n+      bucket: {{pxf-build-resources-bucket-name}}\n+      json_key: {{data-gpdb-ud-google-json-key}}\n+      versioned_file: singlecluster/CDH/singlecluster-CDH.tar.gz\n+\n+  - name: pxf_singlecluster\n+    type: git\n+    icon: git\n+    source:\n+      branch: {{pxf-git-branch}}\n+      uri: https://github.com/greenplum-db/pxf.git\n+      paths: [singlecluster/*]\n+\n+  - name: gpdb6-centos7\n+    type: registry-image\n+    icon: docker\n+    source:\n+      repository: pivotaldata/gpdb6-centos7-test\n+      tag: latest\n+\n+## ======================================================================\n+## JOBS\n+## ======================================================================\n+jobs:\n+  - name: singlecluster_noarch_cdh", "originalCommit": "4272a25a710db66b8abe3d584cb7749fed075ca3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ2Mjg0NA==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458462844", "bodyText": "not sure, I didn't change the name of the jobs, that's what they used to be called before", "author": "frankgh", "createdAt": "2020-07-22T00:23:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MDAzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTU1Nw==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458381557", "bodyText": "why do we still need them in S3 ?", "author": "denalex", "createdAt": "2020-07-21T20:54:24Z", "path": "concourse/pipelines/singlecluster-pipeline.yml", "diffHunk": "@@ -0,0 +1,190 @@\n+## ======================================================================\n+## RESOURCE TYPES\n+## ======================================================================\n+resource_types:\n+- name: google-cloud-storage\n+  type: docker-image\n+  source:\n+    repository: frodenas/gcs-resource\n+\n+## ======================================================================\n+## RESOURCES\n+## ======================================================================\n+resources:\n+  - name: hdp2_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: hortonworks/HDP-2.5.3.0-centos6-tars-tarball.tar.gz\n+\n+  - name: hdp3_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: hortonworks/HDP-3.1.4.0-centos7-tars-tarball.tar.gz\n+\n+  - name: cdh_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: cloudera/CDH-5.12.2.tar.gz\n+\n+  - name: jdbc\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: jdbc/postgresql-jdbc-8.4.704.jar\n+\n+  - name: singlecluster-HDP2\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: singlecluster/singlecluster-HDP2.tar.gz", "originalCommit": "4272a25a710db66b8abe3d584cb7749fed075ca3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ2MjY2OQ==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458462669", "bodyText": "I think we ask people to download it from S3 from the main README.md file", "author": "frankgh", "createdAt": "2020-07-22T00:22:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTU1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU0MTc4Nw==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r469541787", "bodyText": "we can remove it if we don't need it", "author": "frankgh", "createdAt": "2020-08-12T20:56:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MTU1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MjA4NA==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458382084", "bodyText": "we must have {{pxf-git-url}} defined somewhere", "author": "denalex", "createdAt": "2020-07-21T20:55:21Z", "path": "concourse/pipelines/singlecluster-pipeline.yml", "diffHunk": "@@ -0,0 +1,190 @@\n+## ======================================================================\n+## RESOURCE TYPES\n+## ======================================================================\n+resource_types:\n+- name: google-cloud-storage\n+  type: docker-image\n+  source:\n+    repository: frodenas/gcs-resource\n+\n+## ======================================================================\n+## RESOURCES\n+## ======================================================================\n+resources:\n+  - name: hdp2_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: hortonworks/HDP-2.5.3.0-centos6-tars-tarball.tar.gz\n+\n+  - name: hdp3_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: hortonworks/HDP-3.1.4.0-centos7-tars-tarball.tar.gz\n+\n+  - name: cdh_tars_tarball\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: cloudera/CDH-5.12.2.tar.gz\n+\n+  - name: jdbc\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: jdbc/postgresql-jdbc-8.4.704.jar\n+\n+  - name: singlecluster-HDP2\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: singlecluster/singlecluster-HDP2.tar.gz\n+\n+  - name: singlecluster-HDP2-gcs\n+    type: google-cloud-storage\n+    icon: google-drive\n+    source:\n+      bucket: {{pxf-build-resources-bucket-name}}\n+      json_key: {{data-gpdb-ud-google-json-key}}\n+      versioned_file: singlecluster/HDP2/singlecluster-HDP2.tar.gz\n+\n+  - name: singlecluster-HDP3\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: singlecluster/singlecluster-HDP3.tar.gz\n+\n+  - name: singlecluster-HDP3-gcs\n+    type: google-cloud-storage\n+    icon: google-drive\n+    source:\n+      bucket: {{pxf-build-resources-bucket-name}}\n+      json_key: {{data-gpdb-ud-google-json-key}}\n+      versioned_file: singlecluster/HDP3/singlecluster-HDP3.tar.gz\n+\n+  - name: singlecluster-CDH\n+    type: s3\n+    icon: s3\n+    source:\n+      access_key_id: {{bucket-access-key-id}}\n+      secret_access_key: {{bucket-secret-access-key}}\n+      bucket: {{pxf-aws-bucket-name}}\n+      region_name: {{aws-region}}\n+      versioned_file: singlecluster/singlecluster-CDH.tar.gz\n+\n+  - name: singlecluster-CDH-gcs\n+    type: google-cloud-storage\n+    icon: google-drive\n+    source:\n+      bucket: {{pxf-build-resources-bucket-name}}\n+      json_key: {{data-gpdb-ud-google-json-key}}\n+      versioned_file: singlecluster/CDH/singlecluster-CDH.tar.gz\n+\n+  - name: pxf_singlecluster\n+    type: git\n+    icon: git\n+    source:\n+      branch: {{pxf-git-branch}}\n+      uri: https://github.com/greenplum-db/pxf.git", "originalCommit": "4272a25a710db66b8abe3d584cb7749fed075ca3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ2MzQ1NA==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r458463454", "bodyText": "we don't have it, do we want to have it?", "author": "frankgh", "createdAt": "2020-07-22T00:25:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MjA4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU0MTE3MA==", "url": "https://github.com/greenplum-db/pxf/pull/413#discussion_r469541170", "bodyText": "found it, nevermind", "author": "frankgh", "createdAt": "2020-08-12T20:55:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM4MjA4NA=="}], "type": "inlineReview"}, {"oid": "0781ac56b810577deb2c718e4130fc38ccc9a257", "url": "https://github.com/greenplum-db/pxf/commit/0781ac56b810577deb2c718e4130fc38ccc9a257", "message": "Convert the docker images pipeline to the singlecluster pipeline", "committedDate": "2020-08-12T20:51:26Z", "type": "commit"}, {"oid": "fcb668f567470d38d0d65259e603bc8626a9d1c0", "url": "https://github.com/greenplum-db/pxf/commit/fcb668f567470d38d0d65259e603bc8626a9d1c0", "message": "Rename the pipeline filename and add deploy instructions", "committedDate": "2020-08-12T20:51:26Z", "type": "commit"}, {"oid": "2b16022144407ef9299135528e9650e9ae683e84", "url": "https://github.com/greenplum-db/pxf/commit/2b16022144407ef9299135528e9650e9ae683e84", "message": "address PR feedback", "committedDate": "2020-08-12T21:02:19Z", "type": "commit"}, {"oid": "2b16022144407ef9299135528e9650e9ae683e84", "url": "https://github.com/greenplum-db/pxf/commit/2b16022144407ef9299135528e9650e9ae683e84", "message": "address PR feedback", "committedDate": "2020-08-12T21:02:19Z", "type": "forcePushed"}]}