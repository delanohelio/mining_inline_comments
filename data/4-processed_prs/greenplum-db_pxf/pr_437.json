{"pr_number": 437, "pr_title": "Build DEB package for pxf-gp6 on Ubuntu 18.04", "pr_createdAt": "2020-09-02T00:35:40Z", "pr_url": "https://github.com/greenplum-db/pxf/pull/437", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUzODEyNA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r481538124", "bodyText": "why use underscore here, pxf-gp6_ where we use dash for rhel?", "author": "frankgh", "createdAt": "2020-09-02T01:45:02Z", "path": "concourse/scripts/generate_releng_email.bash", "diffHunk": "@@ -22,6 +22,7 @@ version=$(<pxf_shipit_file/version)\n pxf_gp5_el6_releng_url=\"${RELENG_GP5_DROP_URL}/pxf-gp5-${version}-2.el6.x86_64.rpm\"\n pxf_gp5_el7_releng_url=\"${RELENG_GP5_DROP_URL}/pxf-gp5-${version}-2.el7.x86_64.rpm\"\n pxf_gp6_el7_releng_url=\"${RELENG_GP6_DROP_URL}/pxf-gp6-${version}-2.el7.x86_64.rpm\"\n+pxf_gp6_ubuntu18_releng_url=\"${RELENG_GP6_DROP_URL}/pxf-gp6_${version}-2.ubuntu18.04_amd64.deb\"", "originalCommit": "de735c4455ba12d201c6b2c637581b7d87513329", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4ODU0Mw==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482188543", "bodyText": "This was something that @ashuka24 and I discussed a bit, let me see if I can summarize:\n\nThe rpmbuild tool builds RPM files and names them following the RHEL convention.\nUsing dpkg-deb --build, it is up to us to name the DEB file and here we decided to follow the larger Debian convention of <pkg-name>_<version>_<architecture>.deb. This gives us roughly pxf-gp6 as the package, 5.15.1-1.ubuntu18.04 as the package version, and amd64 as the architecture.\n\nNote that neither of the PXF RPM or DEB naming convention matches with the Greenplum Server RPM/DEB naming pattern which is greenplum-db-<version>-{rhel6|rhel7|ubuntut18.04}-{x86_64|amd64}.{rpm|deb}, e.g.:\n\ngreenplum-db-6.9.1-rhel6-x86_64.rpm\ngreenplum-db-6.9.1-rhel7-x86_64.rpm\ngreenplum-db-6.9.1-ubuntu18.04-amd64.deb\n\nI have a personal preference for matching the platform's convention but this is a weakly help opinion.", "author": "bradfordb-vmware", "createdAt": "2020-09-02T16:05:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUzODEyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzEwNzYyOA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r483107628", "bodyText": "I see, I would prefer to maintain consistency with the other artifacts we produce, it looks weird that we stop consistency. But I'll leave it up to you guys to decide what's best.", "author": "frankgh", "createdAt": "2020-09-03T16:29:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUzODEyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgyMzU1MA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r485823550", "bodyText": "w/ @ashuka24: We've update the filename to be consistent with the greenplum server filename conventions: pxf-gp6-<version>-ubunutu18.04-amd64.deb.", "author": "bradfordb-vmware", "createdAt": "2020-09-09T18:21:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTUzODEyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MDY0OQ==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r481970649", "bodyText": "I was reading that apt is a more user friendly command introduced to be a more user facing, whereas apt-get gives  your more low-level control during installation. Any reason we prefer one or the other here?", "author": "frankgh", "createdAt": "2020-09-02T10:37:44Z", "path": "concourse/scripts/pxf_common.bash", "diffHunk": "@@ -155,15 +155,15 @@ function install_gpdb_package() {\n \t\tfi\n \t\tpython_dir=python${python_version}/site-packages\n \t\texport_pythonpath+=:/usr/lib/${python_dir}:/usr/lib64/${python_dir}\n-\telif command -v apt; then\n-\t\t# install GPDB DEB, apt wants an absolute path\n+\telif command -v apt-get; then", "originalCommit": "de735c4455ba12d201c6b2c637581b7d87513329", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE1MDUxMw==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482150513", "bodyText": "From man 8 apt\n\nThe apt command is meant to be pleasant for end users and does not need to be backward compatible like apt-get(8).\n\nWhen you use apt in a script it prints the following\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\nThat's why I prefer using apt-get in scripts.", "author": "bradfordb-vmware", "createdAt": "2020-09-02T15:12:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MDY0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MTIxMQ==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r481971211", "bodyText": "minor, this line uses tab, vs the lines preceding it use spaces", "author": "frankgh", "createdAt": "2020-09-02T10:38:48Z", "path": "dev/install_greenplum.bash", "diffHunk": "@@ -29,8 +29,8 @@ else\n     fi\n \n     echo \"Installing GPDB from ${LATEST_DEB} ...\"\n-    # apt wants a full path\n-\tsudo apt install -qq \"${PWD}/${LATEST_DEB}\"\n+    # apt-get wants a full path\n+\tsudo apt-get install -qq \"${PWD}/${LATEST_DEB}\"", "originalCommit": "de735c4455ba12d201c6b2c637581b7d87513329", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE3NDE4Ng==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482174186", "bodyText": "Good catch.", "author": "bradfordb-vmware", "createdAt": "2020-09-02T15:44:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MTIxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MjYzMA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r481972630", "bodyText": "should we parameterize the Maintainer as well? I'm concerned about our team email address being in the wild", "author": "frankgh", "createdAt": "2020-09-02T10:41:10Z", "path": "package/control", "diffHunk": "@@ -0,0 +1,5 @@\n+Package: pxf-gp6\n+Version: %VERSION%\n+Architecture: amd64\n+Maintainer: Greenplum Unmanaged Data <pvtl-gp-ud@vmware.com>", "originalCommit": "de735c4455ba12d201c6b2c637581b7d87513329", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUyMDk4MA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482520980", "bodyText": "Does it need to have email there ? Can we just say VMware, Inc. ?", "author": "denalex", "createdAt": "2020-09-02T22:05:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MjYzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjU0MTYyMw==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482541623", "bodyText": "From the Debian Polciy Manual (which I am using as a stand-in for technical documentation because I don't think the format of the control file is specified elsewhere:\n\nThe name must come first, then the email address inside angle brackets <> (in RFC822 format).\n\nBut it appears that dpkg-deb --build does not check or enforce this, though lintian does flag it as an error.", "author": "bradfordb-vmware", "createdAt": "2020-09-02T22:28:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MjYzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgwNzA4Mg==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r485807082", "bodyText": "w/ @ashuka24: We've moved the value of the maintainer field to a Concourse variables file.", "author": "bradfordb-vmware", "createdAt": "2020-09-09T17:51:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk3MjYzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ1Mzg3Mg==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482453872", "bodyText": "please add new targets to the list below", "author": "denalex", "createdAt": "2020-09-02T20:54:07Z", "path": "Makefile", "diffHunk": "@@ -97,6 +97,40 @@ rpm-tar: rpm\n \tcp package/install_rpm build/stagerpm/$${PXF_PACKAGE_NAME}/install_component ;\\\n \ttar -czf build/distrpm/$${PXF_PACKAGE_NAME}.tar.gz -C build/stagerpm $${PXF_PACKAGE_NAME}\n \n+deb:\n+\tmake -C external-table stage\n+\tmake -C cli/go/src/pxf-cli stage\n+\tmake -C server stage\n+\tset -e ;\\\n+\tGP_MAJOR_VERSION=$$(cat external-table/build/metadata/gp_major_version) ;\\\n+\tPXF_MAIN_VERSION=$${PXF_VERSION//-SNAPSHOT/} ;\\\n+\tif [[ $${PXF_VERSION} == *\"-SNAPSHOT\" ]]; then PXF_RELEASE=SNAPSHOT; else PXF_RELEASE=1; fi ;\\\n+\trm -rf build/debbuild ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\\n+\tcp -a external-table/build/stage/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\\n+\tcp -a cli/build/stage/pxf/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tcp -a server/build/stage/pxf/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\techo $$(git rev-parse --verify HEAD) > build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/commit.sha ;\\\n+\tmkdir build/debbuild/DEBIAN ;\\\n+\tsed -e \"s/%VERSION%/$${PXF_MAIN_VERSION}-$${PXF_RELEASE}/\" package/control > build/debbuild/DEBIAN/control ;\\\n+\tcp -a package/prerm build/debbuild/DEBIAN/prerm ;\\\n+\tdpkg-deb --build build/debbuild ;\\\n+\tmv build/debbuild.deb build/pxf-gp$${GP_MAJOR_VERSION}_$${PXF_MAIN_VERSION}-$${PXF_RELEASE}.ubuntu18.04_amd64.deb\n+\n+deb-tar: deb\n+\trm -rf build/{stagedeb,distdeb}\n+\tmkdir -p build/{stagedeb,distdeb}\n+\tset -e ;\\\n+\tGP_MAJOR_VERSION=$$(cat external-table/build/metadata/gp_major_version) ;\\\n+\tPXF_DEB_FILE=$$(find build/ -name pxf-gp$${GP_MAJOR_VERSION}*.deb) ;\\\n+\tPXF_PACKAGE_NAME=$$(dpkg-deb --field $${PXF_DEB_FILE} Package)-$$(dpkg-deb --field $${PXF_DEB_FILE} Version).$${TARGET_OS} ;\\\n+\tmkdir -p build/stagedeb/$${PXF_PACKAGE_NAME} ;\\\n+\tcp $${PXF_DEB_FILE} build/stagedeb/$${PXF_PACKAGE_NAME} ;\\\n+\tcp package/install_deb build/stagedeb/$${PXF_PACKAGE_NAME}/install_component ;\\\n+\ttar -czf build/distdeb/$${PXF_PACKAGE_NAME}.tar.gz -C build/stagedeb $${PXF_PACKAGE_NAME}\n+\n+\n help:\n \t@echo\n \t@echo 'Possible targets'", "originalCommit": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ1ODE0Mw==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482458143", "bodyText": "line 109 is technically not needed as 110 will create the full path along", "author": "denalex", "createdAt": "2020-09-02T20:57:20Z", "path": "Makefile", "diffHunk": "@@ -97,6 +97,40 @@ rpm-tar: rpm\n \tcp package/install_rpm build/stagerpm/$${PXF_PACKAGE_NAME}/install_component ;\\\n \ttar -czf build/distrpm/$${PXF_PACKAGE_NAME}.tar.gz -C build/stagerpm $${PXF_PACKAGE_NAME}\n \n+deb:\n+\tmake -C external-table stage\n+\tmake -C cli/go/src/pxf-cli stage\n+\tmake -C server stage\n+\tset -e ;\\\n+\tGP_MAJOR_VERSION=$$(cat external-table/build/metadata/gp_major_version) ;\\\n+\tPXF_MAIN_VERSION=$${PXF_VERSION//-SNAPSHOT/} ;\\\n+\tif [[ $${PXF_VERSION} == *\"-SNAPSHOT\" ]]; then PXF_RELEASE=SNAPSHOT; else PXF_RELEASE=1; fi ;\\\n+\trm -rf build/debbuild ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\", "originalCommit": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ2MzQwNg==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482463406", "bodyText": "since stage target prepares binary layout, why just not cp -R build/stagestage build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ?", "author": "denalex", "createdAt": "2020-09-02T21:01:20Z", "path": "Makefile", "diffHunk": "@@ -97,6 +97,40 @@ rpm-tar: rpm\n \tcp package/install_rpm build/stagerpm/$${PXF_PACKAGE_NAME}/install_component ;\\\n \ttar -czf build/distrpm/$${PXF_PACKAGE_NAME}.tar.gz -C build/stagerpm $${PXF_PACKAGE_NAME}\n \n+deb:\n+\tmake -C external-table stage\n+\tmake -C cli/go/src/pxf-cli stage\n+\tmake -C server stage\n+\tset -e ;\\\n+\tGP_MAJOR_VERSION=$$(cat external-table/build/metadata/gp_major_version) ;\\\n+\tPXF_MAIN_VERSION=$${PXF_VERSION//-SNAPSHOT/} ;\\\n+\tif [[ $${PXF_VERSION} == *\"-SNAPSHOT\" ]]; then PXF_RELEASE=SNAPSHOT; else PXF_RELEASE=1; fi ;\\\n+\trm -rf build/debbuild ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tmkdir -p build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\\n+\tcp -a external-table/build/stage/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION}/gpextable ;\\\n+\tcp -a cli/build/stage/pxf/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\\n+\tcp -a server/build/stage/pxf/* build/debbuild/usr/local/pxf-gp$${GP_MAJOR_VERSION} ;\\", "originalCommit": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjU0NjgwMQ==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482546801", "bodyText": "The rpm target does not depend on the top-level stage target, instead invoking the stage target in external-table, server, and cli. The deb target just copied this pattern.\nIf I am understanding you correctly, we could refactor to make stage a prerequisite target for both rpm and `deb?", "author": "bradfordb-vmware", "createdAt": "2020-09-02T22:33:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ2MzQwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjU3NTMwNA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482575304", "bodyText": "we can, I am not sure we should. I don't recall why it was not done to start with, one thing different is that stage doesn't seem to copy external table artifacts into gpextable for some reason", "author": "denalex", "createdAt": "2020-09-02T22:56:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ2MzQwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYxMjQ5NQ==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482612495", "bodyText": "Looking at the pxf secript in the server directory, it looks like the gpextable directory needs to exist and contain the external table PXF extension.\nIf the top-level deb target depended on the top-level stage target, then the DEB package would not contain $PXF_HOME/gpextable and the extension would not be installed. We would need to fix that in the top-level stage target before we could use it.", "author": "bradfordb-vmware", "createdAt": "2020-09-03T00:17:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ2MzQwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ3NjA2MA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482476060", "bodyText": "lines 708 and 710 look redundant now, why not just hardcode the number 6 in the job names ?", "author": "denalex", "createdAt": "2020-09-02T21:11:48Z", "path": "concourse/pipelines/templates/build_pipeline-tpl.yml", "diffHunk": "@@ -724,14 +706,10 @@ jobs:\n       - Test PXF-GP6-HDP2 on OEL7\n {% set gp_ver = None %}\n {% set gp_ver = 6 %}\n-{% if build_deb %}\n       - Test PXF-GP[[gp_ver]]-HDP2 on Ubuntu18\n-{% endif %}\n {% set gp_ver = 6 %}\n-{% if build_deb %}\n     - get: pxf_gp[[gp_ver]]_tarball_ubuntu18\n       passed: [Test PXF-GP[[gp_ver]]-HDP2 on Ubuntu18]", "originalCommit": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYwMDI5Ng==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482600296", "bodyText": "After trying to make this change, I think this is a bit more entangled than I initially thought. If we hardcode the number 6 in the job name, we should probably also hardcode it in all passed conditions that refer it. But then there are resource names that we could hardcode the number in, and so on. Further complicating this refactor, there are several locations where we have gp_ver block around Ubuntu and RHEL7 related items, for example\n{% set gp_ver = 6 %}\n- name: gpdb[[gp_ver]]-pxf-dev-ubuntu18-image\n  type: registry-image\n  icon: docker\n  source:\n    repository: gcr.io/data-gpdb-ud/gpdb-pxf-dev/gpdb[[gp_ver]]-ubuntu18.04-test-pxf\n    tag: latest\n    username: _json_key\n    password: ((pxf-cloudbuild-service-account-key))\n\n- name: gpdb[[gp_ver]]-pxf-dev-centos7-mapr-server-image\n  type: registry-image\n  icon: docker\n  source:\n    repository: gcr.io/data-gpdb-ud/gpdb-pxf-dev/gpdb[[gp_ver]]-centos7-test-pxf-mapr\n    tag: latest\n    username: _json_key\n    password: ((pxf-cloudbuild-service-account-key))\n{% set gp_ver = None %}\nDo we hardcode the version in these RHEL7 locations?\nWould it make sense to do this refactoring (i.e., removing unnecessary [[gp_ver]]) as a separate chore?", "author": "bradfordb-vmware", "createdAt": "2020-09-02T23:35:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ3NjA2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU3MzU3Mg==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r484573572", "bodyText": "I think the idea is that we will eventually add 7 in the list of versions. Not sure if we are going to support ubuntu 18 with 7 though. That might be a data point to make a decision on hardcoding the gp_ver or not", "author": "frankgh", "createdAt": "2020-09-07T21:53:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQ3NjA2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUyMjExNA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482522114", "bodyText": "how is this file integrated with install / upgrade from DEB ?", "author": "denalex", "createdAt": "2020-09-02T22:07:30Z", "path": "package/prerm", "diffHunk": "@@ -0,0 +1,5 @@\n+#!/bin/sh\n+\n+rm -f /usr/local/pxf-gp6/conf/pxf-private.classpath\n+rm -rf /usr/local/pxf-gp6/pxf-service\n+rm -rf /usr/local/pxf-gp6/run", "originalCommit": "456bfe4181419aa30d3d1bdbfb2c52ce1a0b1665", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjU1MTQ5Ng==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r482551496", "bodyText": "This file is copied into the DEBIAN/ sub-directory before building the package; dpkg/apt will call this before uninstalling this version of the package, both when the user is removing the package altogether or when updating to the next version.\nThis is mean to mirror the %preun section of the RPM spec.", "author": "bradfordb-vmware", "createdAt": "2020-09-02T22:36:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUyMjExNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE0NDU0OA==", "url": "https://github.com/greenplum-db/pxf/pull/437#discussion_r483144548", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t@echo\t'  - rpm - create PXF RPM'\n          \n          \n            \n            \t@echo\t'  - rpm - create PXF RPM package'", "author": "ashuka24", "createdAt": "2020-09-03T17:33:02Z", "path": "Makefile", "diffHunk": "@@ -142,5 +141,7 @@ help:\n \t@echo\t'  - test - runs tests for PXF Go CLI and server'\n \t@echo\t'  - install - install PXF external table extension, CLI and server'\n \t@echo\t'  - tar - bundle PXF external table extension, CLI, server and tomcat into a single tarball'\n-\t@echo\t'  - rpm - create PXF RPM / DEB package'\n-\t@echo\t'  - rpm-tar - bundle PXF RPM / DEB package along with helper scripts into a single tarball'\n+\t@echo\t'  - rpm - create PXF RPM'", "originalCommit": "3078236b5bfed2436337bf49737d5f55e2fff26f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0f4fbdbf36dd5df82146218828cc7f6cb45c8738", "url": "https://github.com/greenplum-db/pxf/commit/0f4fbdbf36dd5df82146218828cc7f6cb45c8738", "message": "Build and package PXF for Greenplum 6 on Ubuntu 18.04\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>", "committedDate": "2020-09-09T18:17:58Z", "type": "forcePushed"}, {"oid": "d93f685f73de800c1353142505e6540f10781e92", "url": "https://github.com/greenplum-db/pxf/commit/d93f685f73de800c1353142505e6540f10781e92", "message": "Use apt-get in CI scripts instead of apt\n\napt is a more user-fiendly front-end and is not intended for use in\nscripts.\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>", "committedDate": "2020-09-09T22:10:01Z", "type": "commit"}, {"oid": "5fed2528d75e11c648a3d8a622a2d56d5d07dc23", "url": "https://github.com/greenplum-db/pxf/commit/5fed2528d75e11c648a3d8a622a2d56d5d07dc23", "message": "Build and package PXF for Greenplum 6 on Ubuntu 18.04\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>", "committedDate": "2020-09-09T22:10:01Z", "type": "commit"}, {"oid": "5fed2528d75e11c648a3d8a622a2d56d5d07dc23", "url": "https://github.com/greenplum-db/pxf/commit/5fed2528d75e11c648a3d8a622a2d56d5d07dc23", "message": "Build and package PXF for Greenplum 6 on Ubuntu 18.04\n\n[#173912689]\n\nCo-authored-by: Ashuka Xue <axue@vmware.com>\nCo-authored-by: Bradford D. Boyle <bradfordb@vmware.com>", "committedDate": "2020-09-09T22:10:01Z", "type": "forcePushed"}]}