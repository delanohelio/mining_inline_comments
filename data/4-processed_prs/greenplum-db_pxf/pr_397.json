{"pr_number": 397, "pr_title": "Fix the MapR job", "pr_createdAt": "2020-06-25T20:11:17Z", "pr_url": "https://github.com/greenplum-db/pxf/pull/397", "timeline": [{"oid": "e43b79a018b927faf960e716a304fc209e6e4402", "url": "https://github.com/greenplum-db/pxf/commit/e43b79a018b927faf960e716a304fc209e6e4402", "message": "Fix the MapR job\n\nWhen doing classloading, the LOADER_PATH is ending up with something\nlike this:\n\nexport LOADER_PATH=,file:/home/gpadmin/pxf/conf,....\n\nApparently, PropertiesLauncher is parsing the string above and doing a\nsplit, and for them \"\" means the user wants root of archive but not\ncurrent directory. This is making the root archive to be on the\nclasspath first, then the PXF specific classpath, and then again the\nroot archive for some reason. This is preventing us to classload the PXF\nlibraries before the application libraries. This commit checks whether\nthe PXF_LOADER_PATH environment variable is set, and if it's not, we\ndon't add the comma at the beginning.", "committedDate": "2020-06-25T20:12:49Z", "type": "forcePushed"}, {"oid": "70b2e0ae85927f731808b78e5e216e5a8ba55209", "url": "https://github.com/greenplum-db/pxf/commit/70b2e0ae85927f731808b78e5e216e5a8ba55209", "message": "Fix the MapR job\n\nWhen doing classloading, the LOADER_PATH is ending up with something\nlike this:\n\nexport LOADER_PATH=,file:/home/gpadmin/pxf/conf,....\n\nApparently, PropertiesLauncher is parsing the string above and doing a\nsplit, and for them \"\" means the user wants root of archive but not\ncurrent directory. This is making the root archive to be on the\nclasspath first, then the PXF specific classpath, and then again the\nroot archive for some reason. This is preventing us to classload the PXF\nlibraries before the application libraries. This commit checks whether\nthe PXF_LOADER_PATH environment variable is set, and if it's not, we\ndon't add the comma at the beginning.", "committedDate": "2020-06-25T20:34:12Z", "type": "commit"}, {"oid": "70b2e0ae85927f731808b78e5e216e5a8ba55209", "url": "https://github.com/greenplum-db/pxf/commit/70b2e0ae85927f731808b78e5e216e5a8ba55209", "message": "Fix the MapR job\n\nWhen doing classloading, the LOADER_PATH is ending up with something\nlike this:\n\nexport LOADER_PATH=,file:/home/gpadmin/pxf/conf,....\n\nApparently, PropertiesLauncher is parsing the string above and doing a\nsplit, and for them \"\" means the user wants root of archive but not\ncurrent directory. This is making the root archive to be on the\nclasspath first, then the PXF specific classpath, and then again the\nroot archive for some reason. This is preventing us to classload the PXF\nlibraries before the application libraries. This commit checks whether\nthe PXF_LOADER_PATH environment variable is set, and if it's not, we\ndon't add the comma at the beginning.", "committedDate": "2020-06-25T20:34:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1MjE2Ng==", "url": "https://github.com/greenplum-db/pxf/pull/397#discussion_r445852166", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            if [ -n \"$PXF_LOADER_PATH\" ]; then\n          \n          \n            \n            if [[ -n \"${PXF_LOADER_PATH}\" ]]; then", "author": "denalex", "createdAt": "2020-06-25T21:36:03Z", "path": "server/pxf-service/src/scripts/pxf-env-default.sh", "diffHunk": "@@ -63,4 +63,8 @@ export PXF_OOM_KILL=${PXF_OOM_KILL:-true}\n # export PXF_OOM_DUMP_PATH=\n \n # Additional locations to be class-loaded by the application\n-export LOADER_PATH=\"${PXF_LOADER_PATH},file:${PXF_CONF}/conf,file:${PXF_HOME}/conf,file:${PXF_CONF}/lib\"\n+if [ -n \"$PXF_LOADER_PATH\" ]; then", "originalCommit": "70b2e0ae85927f731808b78e5e216e5a8ba55209", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1MjU2NQ==", "url": "https://github.com/greenplum-db/pxf/pull/397#discussion_r445852565", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              export LOADER_PATH=\"$PXF_LOADER_PATH,file:${PXF_CONF}/conf,file:${PXF_HOME}/conf,file:${PXF_CONF}/lib\"\n          \n          \n            \n              export LOADER_PATH=\"${PXF_LOADER_PATH},file:${PXF_CONF}/conf,file:${PXF_HOME}/conf,file:${PXF_CONF}/lib\"", "author": "denalex", "createdAt": "2020-06-25T21:36:58Z", "path": "server/pxf-service/src/scripts/pxf-env-default.sh", "diffHunk": "@@ -63,4 +63,8 @@ export PXF_OOM_KILL=${PXF_OOM_KILL:-true}\n # export PXF_OOM_DUMP_PATH=\n \n # Additional locations to be class-loaded by the application\n-export LOADER_PATH=\"${PXF_LOADER_PATH},file:${PXF_CONF}/conf,file:${PXF_HOME}/conf,file:${PXF_CONF}/lib\"\n+if [ -n \"$PXF_LOADER_PATH\" ]; then\n+  export LOADER_PATH=\"$PXF_LOADER_PATH,file:${PXF_CONF}/conf,file:${PXF_HOME}/conf,file:${PXF_CONF}/lib\"", "originalCommit": "70b2e0ae85927f731808b78e5e216e5a8ba55209", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b1c7a9326cbda792117d09e0db9d8cc76bedac57", "url": "https://github.com/greenplum-db/pxf/commit/b1c7a9326cbda792117d09e0db9d8cc76bedac57", "message": "address pr feedback", "committedDate": "2020-06-25T21:40:36Z", "type": "commit"}]}