{"pr_number": 3784, "pr_title": "Add Cloud SQL R2DBC sample", "pr_createdAt": "2020-09-22T17:49:50Z", "pr_url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784", "timeline": [{"oid": "964cabd4d410250aba1363592d4c49dc2d1ad289", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/964cabd4d410250aba1363592d4c49dc2d1ad289", "message": "add r2dbc sample", "committedDate": "2020-09-22T17:44:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk5MjMzMw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r492992333", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n          \n          \n            \n            [creating a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).", "author": "dzou", "createdAt": "2020-09-22T19:48:25Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk5MjQ5MQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r492992491", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n          \n          \n            \n            maven utilities) by following the [Java setup guide](https://cloud.google.com/java/docs/setup) and", "author": "dzou", "createdAt": "2020-09-22T19:48:44Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk5MjkwMA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r492992900", "bodyText": "Add four spaces to both code blocks to make them indented within the list in the preview: https://github.com/GoogleCloudPlatform/java-docs-samples/blob/964cabd4d410250aba1363592d4c49dc2d1ad289/cloud-sql/r2dbc/README.md", "author": "dzou", "createdAt": "2020-09-22T19:49:29Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format\n+```", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk5NDkwNA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r492994904", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            for example\n          \n          \n            \n            For example:", "author": "dzou", "createdAt": "2020-09-22T19:53:17Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format\n+```\n+connectionString = r2dbc:gcp:mysql://<user>:<password>@<connection_name>/<db_name>\n+```\n+for example", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk5NjAyNA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r492996024", "bodyText": "Can you do a 4-space tab on the lines under each numbered-list item so they appear indented inside each item in the list?", "author": "dzou", "createdAt": "2020-09-22T19:55:18Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format\n+```\n+connectionString = r2dbc:gcp:mysql://<user>:<password>@<connection_name>/<db_name>\n+```\n+for example\n+```\n+connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+```\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```bash\n+mvn spring-boot:run\n+```\n+\n+Navigate towards `http://127.0.0.1:8080` to verify your application is running correctly.\n+\n+### Deploy to Cloud Run\n+\n+See the [Cloud Run documentation](https://cloud.google.com/run/docs/configuring/connect-cloudsql)\n+for more details on connecting a Cloud Run service to Cloud SQL.\n+", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjI3MTE5OQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r496271199", "bodyText": "resolved", "author": "dmitry-s", "createdAt": "2020-09-28T22:29:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk5NjAyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk5Njk0MA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r492996940", "bodyText": "All of the source files need to be formatted to use 2-space tabs; there is some inconsistent tab usage.", "author": "dzou", "createdAt": "2020-09-22T19:56:58Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/CommanLineRunnerSchemaCreator.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/*", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk5NzUxMw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r492997513", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public class CommanLineRunnerSchemaCreator implements CommandLineRunner {\n          \n          \n            \n            public class CommandLineRunnerSchemaCreator implements CommandLineRunner {\n          \n      \n    \n    \n  \n\nAlso will need to rename the file.", "author": "dzou", "createdAt": "2020-09-22T19:58:08Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/CommanLineRunnerSchemaCreator.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.cloudsql.r2dbcsample;\n+\n+import io.r2dbc.spi.ConnectionFactory;\n+import java.util.Arrays;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.CommandLineRunner;\n+import org.springframework.data.r2dbc.core.DatabaseClient;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class CommanLineRunnerSchemaCreator implements CommandLineRunner {", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAwNjk1NA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493006954", "bodyText": "I think it'd be simpler if you left the .map unnested from the .flatmap, like this:\nreturn serverWebExchange.getFormData()\n        .flatMap(formData -> voteRepository.save(new Vote(formData.getFirst(\"team\"))))\n        .map(vote -> String.format(\n            \"Vote successfully cast for '%s' at time %s!%n\", vote.candidate, vote.timeCast));", "author": "dzou", "createdAt": "2020-09-22T20:16:27Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/VoteController.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.cloudsql.r2dbcsample;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.web.bind.annotation.PostMapping;\n+import org.springframework.web.bind.annotation.RestController;\n+import org.springframework.web.server.ServerWebExchange;\n+import reactor.core.publisher.Mono;\n+\n+@RestController\n+public class VoteController {\n+  @Autowired\n+  VoteRepository voteRepository;\n+\n+  @PostMapping(\"/vote\")\n+  public Mono<String> vote(ServerWebExchange serverWebExchange) {\n+    return serverWebExchange.getFormData()\n+        .flatMap(formData ->", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzcyNDYwMg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493724602", "bodyText": "addressed", "author": "dmitry-s", "createdAt": "2020-09-23T16:21:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAwNjk1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE0NjY1OA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493146658", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Navigate towards `http://127.0.0.1:8080` to verify your application is running correctly.\n          \n          \n            \n            Navigate to `http://127.0.0.1:8080` to verify your application is running correctly.\n          \n      \n    \n    \n  \n\nWhy not localhost?", "author": "meltsufin", "createdAt": "2020-09-23T02:02:38Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format\n+```\n+connectionString = r2dbc:gcp:mysql://<user>:<password>@<connection_name>/<db_name>\n+```\n+for example\n+```\n+connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+```\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```bash\n+mvn spring-boot:run\n+```\n+\n+Navigate towards `http://127.0.0.1:8080` to verify your application is running correctly.", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE0NzQ0Nw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493147447", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            3. Navigate your browser to the URL noted in step 2.\n          \n          \n            \n            3. Navigate to the URL noted in Step 2.", "author": "meltsufin", "createdAt": "2020-09-23T02:03:56Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format\n+```\n+connectionString = r2dbc:gcp:mysql://<user>:<password>@<connection_name>/<db_name>\n+```\n+for example\n+```\n+connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+```\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```bash\n+mvn spring-boot:run\n+```\n+\n+Navigate towards `http://127.0.0.1:8080` to verify your application is running correctly.\n+\n+### Deploy to Cloud Run\n+\n+See the [Cloud Run documentation](https://cloud.google.com/run/docs/configuring/connect-cloudsql)\n+for more details on connecting a Cloud Run service to Cloud SQL.\n+\n+1. Build the container image:\n+\n+```sh\n+mvn compile com.google.cloud.tools:jib-maven-plugin:2.5.2:build \\\n+        -Dimage=gcr.io/[YOUR_PROJECT_ID]/r2dbc-sample\n+```\n+\n+2. Deploy the service to Cloud Run:\n+\n+```sh\n+gcloud run deploy r2dbc-sample \\\n+    --image gcr.io/[YOUR_PROJECT_ID]/r2dbc-sample \\\n+    --platform managed\n+```\n+\n+Take note of the URL output at the end of the deployment process.\n+\n+3. Navigate your browser to the URL noted in step 2.", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE0OTc0Nw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493149747", "bodyText": "Does this class need to be mentioned in the README?\nYou don't talk about creating the schema there.", "author": "meltsufin", "createdAt": "2020-09-23T02:07:44Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/CommanLineRunnerSchemaCreator.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.cloudsql.r2dbcsample;\n+\n+import io.r2dbc.spi.ConnectionFactory;\n+import java.util.Arrays;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.CommandLineRunner;\n+import org.springframework.data.r2dbc.core.DatabaseClient;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class CommanLineRunnerSchemaCreator implements CommandLineRunner {", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzYzMDA5OA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493630098", "bodyText": "@meltsufin It creates schema automatically when the app starts. Could you clarify why you think it should be mentioned in the readme?", "author": "dmitry-s", "createdAt": "2020-09-23T14:17:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE0OTc0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4NjAyOA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493686028", "bodyText": "I see. I guess you can mention that the schema for the vote table will be automatically created the first time you run the sample.", "author": "meltsufin", "createdAt": "2020-09-23T15:27:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzE0OTc0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY3ODk3Ng==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493678976", "bodyText": "Should it be r2dbc-mysql-sample because we might have an example for SQL Server and Postgres in the future?\nThe directory would need to b e renamed as well.", "author": "meltsufin", "createdAt": "2020-09-23T15:18:19Z", "path": "cloud-sql/r2dbc/pom.xml", "diffHunk": "@@ -0,0 +1,56 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+\txsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\t<modelVersion>4.0.0</modelVersion>\n+\t<parent>\n+\t\t<groupId>org.springframework.boot</groupId>\n+\t\t<artifactId>spring-boot-starter-parent</artifactId>\n+\t\t<version>2.3.4.RELEASE</version>\n+\t\t<relativePath/>\n+\t</parent>\n+\t<groupId>com.example.cloudsql</groupId>\n+\t<artifactId>r2dbc-sample</artifactId>", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzczNjM3NQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493736375", "bodyText": "@meltsufin  Actually it is going to work with postgres as well, if the right dependencies are added. Also the connection string needs to be updated. I'll modify the sample to mention that.", "author": "dmitry-s", "createdAt": "2020-09-23T16:40:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY3ODk3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg5NTgwNQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493895805", "bodyText": "done", "author": "dmitry-s", "createdAt": "2020-09-23T21:07:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY3ODk3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQyNTgwMw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r494425803", "bodyText": "We would prefer 2 different samples, even if the code is 99% the same between them. This makes it easier for us to add region tags and integrate in as quickstarts. The project folder should be something like cloud-sql/spring-boot-r2dbc/mysql.\nI'm okay if you want to leave this PR as MySQL and my team can handle making changes for postgres and sqlserver if you prefer.", "author": "kurtisvg", "createdAt": "2020-09-24T15:47:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY3ODk3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4MDAwNQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493680005", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            1. Edit `src/resources/application.properties` and enter your connection details in the following format\n          \n          \n            \n            1. Edit `src/main/resources/application.properties` and enter your connection details in the following format", "author": "meltsufin", "createdAt": "2020-09-23T15:19:40Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4Nzk4MA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493687980", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                logger.info(\"Running DDL: \" + schema);\n          \n          \n            \n                logger.info(\"Executed DDL: \" + schema);\n          \n      \n    \n    \n  \n\nAt this point it would have run. I actually thought it was hanging because that was the last message in the log when I ran it.", "author": "meltsufin", "createdAt": "2020-09-23T15:30:11Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/CommanLineRunnerSchemaCreator.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.cloudsql.r2dbcsample;\n+\n+import io.r2dbc.spi.ConnectionFactory;\n+import java.util.Arrays;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.CommandLineRunner;\n+import org.springframework.data.r2dbc.core.DatabaseClient;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class CommanLineRunnerSchemaCreator implements CommandLineRunner {\n+  private static final Logger logger = LoggerFactory.getLogger(CommanLineRunnerSchemaCreator.class);\n+\n+  @Autowired\n+  ConnectionFactory connectionFactory;\n+\n+  @Override\n+  public void run(String...args) {\n+    runDdl(\"CREATE TABLE IF NOT EXISTS vote ( \"\n+        + \"vote_id SERIAL NOT NULL, \"\n+        + \"time_cast timestamp NOT NULL, \"\n+        + \"candidate CHAR(6) NOT NULL, \"\n+        + \"PRIMARY KEY (vote_id) );\");\n+  }\n+\n+  private void runDdl(String schema) {\n+    DatabaseClient client = DatabaseClient.create(connectionFactory);\n+\n+    client.execute(schema)\n+\t\t\t\t.fetch()\n+\t\t\t\t.rowsUpdated()\n+\t\t\t\t.block();\n+\n+    logger.info(\"Running DDL: \" + schema);", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY4ODk2Ng==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493688966", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            1. Build the container image:\n          \n          \n            \n            1. Build the container image and push it to Google Container Registry (GCR):", "author": "meltsufin", "createdAt": "2020-09-23T15:31:32Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format\n+```\n+connectionString = r2dbc:gcp:mysql://<user>:<password>@<connection_name>/<db_name>\n+```\n+for example\n+```\n+connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+```\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```bash\n+mvn spring-boot:run\n+```\n+\n+Navigate towards `http://127.0.0.1:8080` to verify your application is running correctly.\n+\n+### Deploy to Cloud Run\n+\n+See the [Cloud Run documentation](https://cloud.google.com/run/docs/configuring/connect-cloudsql)\n+for more details on connecting a Cloud Run service to Cloud SQL.\n+\n+1. Build the container image:", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY5MTMwNg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493691306", "bodyText": "Also need to specify zone.", "author": "meltsufin", "createdAt": "2020-09-23T15:34:46Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format\n+```\n+connectionString = r2dbc:gcp:mysql://<user>:<password>@<connection_name>/<db_name>\n+```\n+for example\n+```\n+connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+```\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```bash\n+mvn spring-boot:run\n+```\n+\n+Navigate towards `http://127.0.0.1:8080` to verify your application is running correctly.\n+\n+### Deploy to Cloud Run\n+\n+See the [Cloud Run documentation](https://cloud.google.com/run/docs/configuring/connect-cloudsql)\n+for more details on connecting a Cloud Run service to Cloud SQL.\n+\n+1. Build the container image:\n+\n+```sh\n+mvn compile com.google.cloud.tools:jib-maven-plugin:2.5.2:build \\\n+        -Dimage=gcr.io/[YOUR_PROJECT_ID]/r2dbc-sample\n+```\n+\n+2. Deploy the service to Cloud Run:\n+\n+```sh\n+gcloud run deploy r2dbc-sample \\", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg4NTcwOQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493885709", "bodyText": "It's not necessary, the deploy script will request users to select a zone.", "author": "dmitry-s", "createdAt": "2020-09-23T20:48:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY5MTMwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAwNzIwMA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r494007200", "bodyText": "Yes, I saw that. But it seemed like additional friction to me. Maybe we should at least mention to expect a zone selection.", "author": "meltsufin", "createdAt": "2020-09-24T02:49:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY5MTMwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY5MjM0MQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493692341", "bodyText": "Rather than using [YOUR_PROJECT_ID], I would try using a variable ${GCP_PROJECT} for both commands, that could be defined in the first step.\nThis is because editing multi-line commands in terminal is hard.", "author": "meltsufin", "createdAt": "2020-09-23T15:36:08Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,61 @@\n+# Connecting to Cloud SQL - MySQL\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [java setup guide](https://cloud.google.com/java/docs/setup) and\n+[create a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. Create a 2nd Gen Cloud SQL Instance by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-instance). Note the connection string,\n+database user, and database password that you create.\n+\n+1. Create a database for your application by following these\n+[instructions](https://cloud.google.com/sql/docs/mysql/create-manage-databases). Note the database\n+name.\n+\n+1. Edit `src/resources/application.properties` and enter your connection details in the following format\n+```\n+connectionString = r2dbc:gcp:mysql://<user>:<password>@<connection_name>/<db_name>\n+```\n+for example\n+```\n+connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+```\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```bash\n+mvn spring-boot:run\n+```\n+\n+Navigate towards `http://127.0.0.1:8080` to verify your application is running correctly.\n+\n+### Deploy to Cloud Run\n+\n+See the [Cloud Run documentation](https://cloud.google.com/run/docs/configuring/connect-cloudsql)\n+for more details on connecting a Cloud Run service to Cloud SQL.\n+\n+1. Build the container image:\n+\n+```sh\n+mvn compile com.google.cloud.tools:jib-maven-plugin:2.5.2:build \\", "originalCommit": "964cabd4d410250aba1363592d4c49dc2d1ad289", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzg4NTg1Nw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r493885857", "bodyText": "addressed", "author": "dmitry-s", "createdAt": "2020-09-23T20:48:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzY5MjM0MQ=="}], "type": "inlineReview"}, {"oid": "38061e198bde262bc70b1e6b1bd3f91f4c8f7071", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/38061e198bde262bc70b1e6b1bd3f91f4c8f7071", "message": "Apply suggestions from code review\n\nCo-authored-by: Daniel Zou <dzou@users.noreply.github.com>\nCo-authored-by: Mike Eltsufin <meltsufin@google.com>", "committedDate": "2020-09-23T16:15:50Z", "type": "commit"}, {"oid": "9163deb814f1c599c46e9b1f0ed43207f3f56b2a", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/9163deb814f1c599c46e9b1f0ed43207f3f56b2a", "message": "PR comments", "committedDate": "2020-09-23T21:02:12Z", "type": "commit"}, {"oid": "de9785cde09c97194581d91f441f7392e735bd71", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/de9785cde09c97194581d91f441f7392e735bd71", "message": "PR comments", "committedDate": "2020-09-23T21:06:04Z", "type": "commit"}, {"oid": "6c0e7d25394efde4934070e63f192f7f75fec28f", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/6c0e7d25394efde4934070e63f192f7f75fec28f", "message": "checkstyle", "committedDate": "2020-09-23T22:20:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQyNDIyNg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r494424226", "bodyText": "Please format this file with spaces for consistency.", "author": "kurtisvg", "createdAt": "2020-09-24T15:45:55Z", "path": "cloud-sql/r2dbc/pom.xml", "diffHunk": "@@ -0,0 +1,85 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkzODY4Mg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r498938682", "bodyText": "done", "author": "dmitry-s", "createdAt": "2020-10-02T16:55:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQyNDIyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQyNzEzNw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r494427137", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t<parent>\n          \n          \n            \n            \t\t<groupId>com.google.cloud.samples</groupId>\n          \n          \n            \n            \t\t<artifactId>shared-configuration</artifactId>\n          \n          \n            \n            \t\t<version>1.0.18</version>\n          \n          \n            \n            \t</parent>\n          \n          \n            \n                      <!--\n          \n          \n            \n                          The parent pom defines common style checks and testing strategies for our samples.\n          \n          \n            \n                          Removing or replacing it should not affect the execution of the samples in anyway.\n          \n          \n            \n                        -->\n          \n          \n            \n            \t<parent>\n          \n          \n            \n            \t\t<groupId>com.google.cloud.samples</groupId>\n          \n          \n            \n            \t\t<artifactId>shared-configuration</artifactId>\n          \n          \n            \n            \t\t<version>1.0.18</version>\n          \n          \n            \n            \t</parent>", "author": "kurtisvg", "createdAt": "2020-09-24T15:49:47Z", "path": "cloud-sql/r2dbc/pom.xml", "diffHunk": "@@ -0,0 +1,85 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+\txsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\t<modelVersion>4.0.0</modelVersion>\n+\t<parent>\n+\t\t<groupId>com.google.cloud.samples</groupId>\n+\t\t<artifactId>shared-configuration</artifactId>\n+\t\t<version>1.0.18</version>\n+\t</parent>", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMwMTgwMQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r495301801", "bodyText": "Can we modify the application to pull this information from environment variables? That way it will be consistent with our other Java samples, and it will make setting up end-to-end tests with our CI easier.", "author": "shubha-rajan", "createdAt": "2020-09-25T23:00:48Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,76 @@\n+# Connecting to Cloud SQL - MySQL and Postgres\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [Java setup guide](https://cloud.google.com/java/docs/setup) and\n+[creating a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. You can use MySQL or PostgreSQL instance for this sample. \n+Create a 2nd Gen Cloud SQL Instance by following corresponding instructions: \n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-instance) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-instance).\n+Note the connection string, database user, and database password that you create. \n+\n+1. Create a database for your application by following corresponding instructions:\n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-manage-databases) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-manage-databases).\n+Note the database name.\n+\n+1. Edit `src/main/resources/application.properties` and enter your connection details in the following format\n+    ```\n+    connectionString = r2dbc:gcp:<'mysql' or 'postgres'>://<user>:<password>@<connection_name>/<db_name>\n+    ```\n+    Example for MySQL:\n+    ```\n+    connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+\n+    Example for PostgreSQL:\n+    ```\n+    connectionString = r2dbc:gcp:postgres://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` ", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMwMjAzNQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r495302035", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ## Deploying locally\n          \n          \n            \n            ## Running locally", "author": "shubha-rajan", "createdAt": "2020-09-25T23:01:16Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,76 @@\n+# Connecting to Cloud SQL - MySQL and Postgres\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [Java setup guide](https://cloud.google.com/java/docs/setup) and\n+[creating a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. You can use MySQL or PostgreSQL instance for this sample. \n+Create a 2nd Gen Cloud SQL Instance by following corresponding instructions: \n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-instance) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-instance).\n+Note the connection string, database user, and database password that you create. \n+\n+1. Create a database for your application by following corresponding instructions:\n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-manage-databases) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-manage-databases).\n+Note the database name.\n+\n+1. Edit `src/main/resources/application.properties` and enter your connection details in the following format\n+    ```\n+    connectionString = r2dbc:gcp:<'mysql' or 'postgres'>://<user>:<password>@<connection_name>/<db_name>\n+    ```\n+    Example for MySQL:\n+    ```\n+    connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+\n+    Example for PostgreSQL:\n+    ```\n+    connectionString = r2dbc:gcp:postgres://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+## Schema\n+\n+The schema will be created automatically when the application starts.\n+\n+## Deploying locally", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMwMzg0Mg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r495303842", "bodyText": "nit:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            2. Deploy the service to Cloud Run:\n          \n          \n            \n            1. Deploy the service to Cloud Run:", "author": "shubha-rajan", "createdAt": "2020-09-25T23:04:31Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,76 @@\n+# Connecting to Cloud SQL - MySQL and Postgres\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [Java setup guide](https://cloud.google.com/java/docs/setup) and\n+[creating a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. You can use MySQL or PostgreSQL instance for this sample. \n+Create a 2nd Gen Cloud SQL Instance by following corresponding instructions: \n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-instance) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-instance).\n+Note the connection string, database user, and database password that you create. \n+\n+1. Create a database for your application by following corresponding instructions:\n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-manage-databases) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-manage-databases).\n+Note the database name.\n+\n+1. Edit `src/main/resources/application.properties` and enter your connection details in the following format\n+    ```\n+    connectionString = r2dbc:gcp:<'mysql' or 'postgres'>://<user>:<password>@<connection_name>/<db_name>\n+    ```\n+    Example for MySQL:\n+    ```\n+    connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+\n+    Example for PostgreSQL:\n+    ```\n+    connectionString = r2dbc:gcp:postgres://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+## Schema\n+\n+The schema will be created automatically when the application starts.\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```sh\n+mvn spring-boot:run\n+```\n+\n+Navigate to `http://localhost:8080` to verify your application is running correctly.\n+\n+### Deploy to Cloud Run\n+\n+See the [Cloud Run documentation](https://cloud.google.com/run/docs/configuring/connect-cloudsql)\n+for more details on connecting a Cloud Run service to Cloud SQL.\n+\n+1. Create an environment variable with your GCP project id:\n+    ```sh\n+    export PROJECT_ID=[YOUR_PROJECT_ID]\n+    ```\n+\n+1. Build the container image and push it to Google Container Registry (GCR):\n+\n+    ```sh\n+    mvn compile com.google.cloud.tools:jib-maven-plugin:2.5.2:build \\\n+            -Dimage=gcr.io/$PROJECT_ID/r2dbc-sample\n+    ```\n+\n+2. Deploy the service to Cloud Run:", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMwMzk5MA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r495303990", "bodyText": "nit:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            3. Navigate to the URL noted in Step 2.\n          \n          \n            \n            1. Navigate to the URL noted in Step 2.", "author": "shubha-rajan", "createdAt": "2020-09-25T23:04:47Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,76 @@\n+# Connecting to Cloud SQL - MySQL and Postgres\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [Java setup guide](https://cloud.google.com/java/docs/setup) and\n+[creating a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. You can use MySQL or PostgreSQL instance for this sample. \n+Create a 2nd Gen Cloud SQL Instance by following corresponding instructions: \n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-instance) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-instance).\n+Note the connection string, database user, and database password that you create. \n+\n+1. Create a database for your application by following corresponding instructions:\n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-manage-databases) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-manage-databases).\n+Note the database name.\n+\n+1. Edit `src/main/resources/application.properties` and enter your connection details in the following format\n+    ```\n+    connectionString = r2dbc:gcp:<'mysql' or 'postgres'>://<user>:<password>@<connection_name>/<db_name>\n+    ```\n+    Example for MySQL:\n+    ```\n+    connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+\n+    Example for PostgreSQL:\n+    ```\n+    connectionString = r2dbc:gcp:postgres://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+## Schema\n+\n+The schema will be created automatically when the application starts.\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```sh\n+mvn spring-boot:run\n+```\n+\n+Navigate to `http://localhost:8080` to verify your application is running correctly.\n+\n+### Deploy to Cloud Run\n+\n+See the [Cloud Run documentation](https://cloud.google.com/run/docs/configuring/connect-cloudsql)\n+for more details on connecting a Cloud Run service to Cloud SQL.\n+\n+1. Create an environment variable with your GCP project id:\n+    ```sh\n+    export PROJECT_ID=[YOUR_PROJECT_ID]\n+    ```\n+\n+1. Build the container image and push it to Google Container Registry (GCR):\n+\n+    ```sh\n+    mvn compile com.google.cloud.tools:jib-maven-plugin:2.5.2:build \\\n+            -Dimage=gcr.io/$PROJECT_ID/r2dbc-sample\n+    ```\n+\n+2. Deploy the service to Cloud Run:\n+\n+    ```sh\n+    gcloud run deploy r2dbc-sample \\\n+        --image gcr.io/$PROJECT_ID/r2dbc-sample \\\n+        --platform managed\n+    ```\n+    Take note of the URL output at the end of the deployment process.\n+\n+3. Navigate to the URL noted in Step 2.", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMwNzAzNA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r495307034", "bodyText": "Could we also add instructions for deploying to App Engine? (Or is there a reason why we don't have them?)", "author": "shubha-rajan", "createdAt": "2020-09-25T23:09:58Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,76 @@\n+# Connecting to Cloud SQL - MySQL and Postgres\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [Java setup guide](https://cloud.google.com/java/docs/setup) and\n+[creating a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. You can use MySQL or PostgreSQL instance for this sample. \n+Create a 2nd Gen Cloud SQL Instance by following corresponding instructions: \n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-instance) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-instance).\n+Note the connection string, database user, and database password that you create. \n+\n+1. Create a database for your application by following corresponding instructions:\n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-manage-databases) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-manage-databases).\n+Note the database name.\n+\n+1. Edit `src/main/resources/application.properties` and enter your connection details in the following format\n+    ```\n+    connectionString = r2dbc:gcp:<'mysql' or 'postgres'>://<user>:<password>@<connection_name>/<db_name>\n+    ```\n+    Example for MySQL:\n+    ```\n+    connectionString = r2dbc:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+\n+    Example for PostgreSQL:\n+    ```\n+    connectionString = r2dbc:gcp:postgres://user:123456@my-project:us-central1:r2dbctest/testdb \n+    ``` \n+## Schema\n+\n+The schema will be created automatically when the application starts.\n+\n+## Deploying locally\n+\n+To run this application locally, run the following command inside the project folder:\n+\n+```sh\n+mvn spring-boot:run\n+```\n+\n+Navigate to `http://localhost:8080` to verify your application is running correctly.\n+", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkzODUxNA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r498938514", "bodyText": "done", "author": "dmitry-s", "createdAt": "2020-10-02T16:55:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMwNzAzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMxMTI3MQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r495311271", "bodyText": "We've been doing separate samples for each DB engine  because the SQL syntax can vary. This might not matter much between MySQL/Postgres, but for SQL Server, this command wouldn't work. We might want to split into separate samples for Postgres/MySQL for that reason.", "author": "shubha-rajan", "createdAt": "2020-09-25T23:17:15Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/CommandLineRunnerSchemaCreator.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.cloudsql.r2dbcsample;\n+\n+import io.r2dbc.spi.ConnectionFactory;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.CommandLineRunner;\n+import org.springframework.data.r2dbc.core.DatabaseClient;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class CommandLineRunnerSchemaCreator implements CommandLineRunner {\n+\n+  private static final Logger LOGGER =\n+      LoggerFactory.getLogger(CommandLineRunnerSchemaCreator.class);\n+\n+  @Autowired\n+  private ConnectionFactory connectionFactory;\n+\n+  @Override\n+  public void run(String... args) {\n+    runDdl(\"CREATE TABLE IF NOT EXISTS vote ( \"\n+        + \"vote_id SERIAL NOT NULL, \"\n+        + \"time_cast timestamp NOT NULL, \"\n+        + \"candidate CHAR(6) NOT NULL, \"\n+        + \"PRIMARY KEY (vote_id) );\");\n+  }", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU0MjgxMw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r498542813", "bodyText": "@shubha-rajan\nI would prefer to avoid code duplication, since this is the only thing that would be different. I think we could make it a variable and let users pass it to the application or put it into a config. What do you think?", "author": "dmitry-s", "createdAt": "2020-10-01T22:27:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMxMTI3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU3NTUxNA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r503575514", "bodyText": "We can handle this on our end, but the samples will need to be separated out at some point if we want to link to these from Cloud Docs.", "author": "kurtisvg", "createdAt": "2020-10-12T22:59:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMxMTI3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMxNjIxMw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r495316213", "bodyText": "Can we configure the application to use a connection pool when creating the connection factory? We recommend connection pooling as a best practice in our docs. The spring-data docs call out r2dbc-pool as a popular option", "author": "shubha-rajan", "createdAt": "2020-09-25T23:29:22Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/R2dbcSampleApplication.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.cloudsql.r2dbcsample;\n+\n+import io.r2dbc.spi.ConnectionFactories;\n+import io.r2dbc.spi.ConnectionFactory;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.boot.SpringApplication;\n+import org.springframework.boot.autoconfigure.SpringBootApplication;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.data.r2dbc.config.AbstractR2dbcConfiguration;\n+import org.springframework.data.r2dbc.repository.config.EnableR2dbcRepositories;\n+\n+@SpringBootApplication\n+@Configuration\n+@EnableR2dbcRepositories\n+public class R2dbcSampleApplication extends AbstractR2dbcConfiguration {\n+\n+  @Value(\"${connectionString}\")\n+  private String connectionString;\n+\n+  public static void main(String[] args) {\n+    SpringApplication.run(R2dbcSampleApplication.class, args);\n+  }\n+\n+  @Override\n+  @Bean\n+  public ConnectionFactory connectionFactory() {\n+    return ConnectionFactories.get(connectionString);", "originalCommit": "6c0e7d25394efde4934070e63f192f7f75fec28f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkzODgzNA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r498938834", "bodyText": "done", "author": "dmitry-s", "createdAt": "2020-10-02T16:56:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMxNjIxMw=="}], "type": "inlineReview"}, {"oid": "34cdb908e5683fa00d12005ba26e33f84a99dbd3", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/34cdb908e5683fa00d12005ba26e33f84a99dbd3", "message": "Apply suggestions from code review\n\nCo-authored-by: Shubha Rajan <shubhadayini@google.com>\nCo-authored-by: Kurtis Van Gent <31518063+kurtisvg@users.noreply.github.com>", "committedDate": "2020-09-28T22:30:40Z", "type": "commit"}, {"oid": "c7220351bd51e0a6041f4e1b5b32d99b923bd567", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/c7220351bd51e0a6041f4e1b5b32d99b923bd567", "message": "PR comments", "committedDate": "2020-10-01T22:23:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNzAxNw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r499827017", "bodyText": "Can you include an example of what the connection string format would look like in a comment here? That way, users looking at this code snippet through a cloud documentation page would be able to see it without having to look at the code on GitHub.", "author": "shubha-rajan", "createdAt": "2020-10-05T19:37:24Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/R2dbcSampleApplication.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.cloudsql.r2dbcsample;\n+\n+import io.r2dbc.spi.ConnectionFactories;\n+import io.r2dbc.spi.ConnectionFactory;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.boot.SpringApplication;\n+import org.springframework.boot.autoconfigure.SpringBootApplication;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.data.r2dbc.config.AbstractR2dbcConfiguration;\n+import org.springframework.data.r2dbc.repository.config.EnableR2dbcRepositories;\n+\n+@SpringBootApplication\n+@Configuration\n+@EnableR2dbcRepositories\n+public class R2dbcSampleApplication extends AbstractR2dbcConfiguration {\n+\n+  @Value(\"${connectionString}\")\n+  private String connectionString;\n+\n+  public static void main(String[] args) {\n+    SpringApplication.run(R2dbcSampleApplication.class, args);\n+  }\n+\n+  @Override\n+  @Bean\n+  public ConnectionFactory connectionFactory() {\n+    return ConnectionFactories.get(connectionString);", "originalCommit": "c7220351bd51e0a6041f4e1b5b32d99b923bd567", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk0OTA3Ng==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r499949076", "bodyText": "added an example", "author": "dmitry-s", "createdAt": "2020-10-06T00:55:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNzAxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyODM5OQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r499828399", "bodyText": "Can you also include examples of how to configure attributes like size, timeouts, and number of idle connections for the pool?", "author": "shubha-rajan", "createdAt": "2020-10-05T19:40:12Z", "path": "cloud-sql/r2dbc/src/main/java/com/example/cloudsql/r2dbcsample/R2dbcSampleApplication.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.cloudsql.r2dbcsample;\n+\n+import io.r2dbc.spi.ConnectionFactories;\n+import io.r2dbc.spi.ConnectionFactory;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.boot.SpringApplication;\n+import org.springframework.boot.autoconfigure.SpringBootApplication;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.data.r2dbc.config.AbstractR2dbcConfiguration;\n+import org.springframework.data.r2dbc.repository.config.EnableR2dbcRepositories;\n+\n+@SpringBootApplication\n+@Configuration\n+@EnableR2dbcRepositories\n+public class R2dbcSampleApplication extends AbstractR2dbcConfiguration {\n+\n+  @Value(\"${connectionString}\")\n+  private String connectionString;\n+\n+  public static void main(String[] args) {\n+    SpringApplication.run(R2dbcSampleApplication.class, args);\n+  }\n+\n+  @Override\n+  @Bean\n+  public ConnectionFactory connectionFactory() {\n+    return ConnectionFactories.get(connectionString);", "originalCommit": "c7220351bd51e0a6041f4e1b5b32d99b923bd567", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk0ODk2Ng==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r499948966", "bodyText": "added a paragraph to the README", "author": "dmitry-s", "createdAt": "2020-10-06T00:54:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyODM5OQ=="}], "type": "inlineReview"}, {"oid": "0057767bf95bb30d08c5487ba650b02d2d81a18a", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/0057767bf95bb30d08c5487ba650b02d2d81a18a", "message": "PR comments", "committedDate": "2020-10-06T00:44:25Z", "type": "commit"}, {"oid": "38e6a1e975ae8fd4c69cb3ebeb4525c25d1f00c9", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/38e6a1e975ae8fd4c69cb3ebeb4525c25d1f00c9", "message": "PR comments", "committedDate": "2020-10-06T00:52:29Z", "type": "commit"}, {"oid": "7acc26a0c3936d8cef973d233fe762ba8d1bbde1", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/7acc26a0c3936d8cef973d233fe762ba8d1bbde1", "message": "PR comments", "committedDate": "2020-10-06T14:15:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzY0MjA3OA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/3784#discussion_r503642078", "bodyText": "I'd prefer if the connection options were set programatically within the sample itself rather than in the readme, so that we can include them in the Cloud Docs. Something like:\nConnectionPoolConfiguration configuration = ConnectionPoolConfiguration.builder(connectionFactory)\n   .maxIdleTime(Duration.ofMillis(1000))\n   .maxSize(20)\n   .build();\n\nConnectionPool pool = new ConnectionPool(configuration);", "author": "shubha-rajan", "createdAt": "2020-10-13T03:12:24Z", "path": "cloud-sql/r2dbc/README.md", "diffHunk": "@@ -0,0 +1,104 @@\n+# Connecting to Cloud SQL - MySQL and Postgres\n+\n+## Before you begin\n+\n+1. If you haven't already, set up a Java Development Environment (including google-cloud-sdk and\n+maven utilities) by following the [Java setup guide](https://cloud.google.com/java/docs/setup) and\n+[creating a project](https://cloud.google.com/resource-manager/docs/creating-managing-projects#creating_a_project).\n+\n+1. You can use MySQL or PostgreSQL instance for this sample. \n+Create a 2nd Gen Cloud SQL Instance by following corresponding instructions: \n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-instance) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-instance).\n+Note the connection string, database user, and database password that you create. \n+\n+1. Create a database for your application by following corresponding instructions:\n+[MySQL](https://cloud.google.com/sql/docs/mysql/create-manage-databases) /\n+[PostgreSQL](https://cloud.google.com/sql/docs/postgres/create-manage-databases).\n+Note the database name.\n+\n+1. Assign your connection details in the following format:\n+\n+    ```\n+    r2dbc:pool:gcp:<'mysql' or 'postgres'>://<user>:<password>@<connection_name>/<db_name>[?connectionOption1=optionValue1[&connectionValue2=optionValue2]]\n+    ```\n+    to an environment variable `CLOUD_SQL_CONNECTION_STRING`.\n+\n+    Example for MySQL:\n+    ```sh\n+    export CLOUD_SQL_CONNECTION_STRING=\"r2dbc:pool:gcp:mysql://user:123456@my-project:us-central1:r2dbctest/testdb?maxIdleTime=PT60S&initialSize=2&maxSize=12\" ", "originalCommit": "7acc26a0c3936d8cef973d233fe762ba8d1bbde1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a6afce3b9492d33408ae94a8062c308c9a866e20", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/a6afce3b9492d33408ae94a8062c308c9a866e20", "message": "PR comments", "committedDate": "2020-10-19T14:24:58Z", "type": "commit"}]}