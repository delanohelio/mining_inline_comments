{"pr_number": 8657, "pr_title": "ISPN-12271 Allow different servers for server integration test suite", "pr_createdAt": "2020-08-28T19:12:20Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8657", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTIyNg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r479489226", "bodyText": "If you have another name for the module.\nMaybe third-party and the path third-party-server is not the best", "author": "diegolovison", "createdAt": "2020-08-28T19:13:54Z", "path": "integrationtests/server-integration/third-party-server/pom.xml", "diffHunk": "@@ -0,0 +1,223 @@\n+<?xml version='1.0' encoding='UTF-8'?>\n+<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <parent>\n+        <groupId>org.infinispan</groupId>\n+        <artifactId>infinispan-server-integration</artifactId>\n+        <version>12.0.0-SNAPSHOT</version>\n+        <relativePath>../pom.xml</relativePath>\n+    </parent>\n+\n+    <artifactId>infinispan-server-integrationtests-third-party</artifactId>", "originalCommit": "11779be4f86c3afc33d22f5a02a3d0fc4a3dc034", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTUxMw==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r479489513", "bodyText": "@pruivo should we move to build?\nIt seems so specific to move to a high-level project.", "author": "diegolovison", "createdAt": "2020-08-28T19:14:36Z", "path": "integrationtests/server-integration/third-party-server/pom.xml", "diffHunk": "@@ -0,0 +1,223 @@\n+<?xml version='1.0' encoding='UTF-8'?>\n+<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <parent>\n+        <groupId>org.infinispan</groupId>\n+        <artifactId>infinispan-server-integration</artifactId>\n+        <version>12.0.0-SNAPSHOT</version>\n+        <relativePath>../pom.xml</relativePath>\n+    </parent>\n+\n+    <artifactId>infinispan-server-integrationtests-third-party</artifactId>\n+\n+    <properties>\n+        <version.tomcat>9.0.37</version.tomcat>\n+        <version.wildfly>20.0.1.Final</version.wildfly>\n+        <version.arquillian-tomcat-embedded>1.1.0.Final</version.arquillian-tomcat-embedded>", "originalCommit": "11779be4f86c3afc33d22f5a02a3d0fc4a3dc034", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDkyOTI1OQ==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r480929259", "bodyText": "it is ok. do we really need another wildfly version? \ud83d\ude2d", "author": "pruivo", "createdAt": "2020-09-01T07:42:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTUxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTEyODc0MA==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481128740", "bodyText": "Can we change https://github.com/infinispan/infinispan/blob/master/build-configuration/pom.xml#L114-L115 to something different?\n\nappserver.groupId: wildfly.groupId\nappserver.version: version.wildfly", "author": "diegolovison", "createdAt": "2020-09-01T13:16:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTUxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE0NTMyMw==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481145323", "bodyText": "you can change it, but then you may have problems downstream since we build against EAP 7.3 (WF 18).", "author": "pruivo", "createdAt": "2020-09-01T13:40:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTUxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1Njg2Ng==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481156866", "bodyText": "ok, how about change only the property names ?", "author": "diegolovison", "createdAt": "2020-09-01T13:56:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTUxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE2MjA4Mg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481162082", "bodyText": "what properties?", "author": "pruivo", "createdAt": "2020-09-01T14:04:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTUxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE4MTg5Mg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481181892", "bodyText": "from appserver.groupId to wildfly.groupId\nfrom appserver.version to version.wildfly", "author": "diegolovison", "createdAt": "2020-09-01T14:30:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTUxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTk0NA==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r479489944", "bodyText": "I think this name is better :D", "author": "diegolovison", "createdAt": "2020-08-28T19:15:33Z", "path": "integrationtests/server-integration/wildfly-modules/pom.xml", "diffHunk": "@@ -9,7 +9,7 @@\n       <relativePath>../pom.xml</relativePath>\n    </parent>\n \n-   <artifactId>infinispan-wildfly-module-integrationtests</artifactId>\n+   <artifactId>infinispan-server-integrationtests-wildfly-modules</artifactId>", "originalCommit": "11779be4f86c3afc33d22f5a02a3d0fc4a3dc034", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDkyODM1Ng==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r480928356", "bodyText": "-1", "author": "pruivo", "createdAt": "2020-09-01T07:41:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTk0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE0Nzk3Mw==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481147973", "bodyText": "IMO, it sounds like you are testing the WF modules in infinispan server... which makes no sense.", "author": "pruivo", "createdAt": "2020-09-01T13:43:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4OTk0NA=="}], "type": "inlineReview"}, {"oid": "37fa207df2d3293e22351ab48c848c0fb2783fda", "url": "https://github.com/infinispan/infinispan/commit/37fa207df2d3293e22351ab48c848c0fb2783fda", "message": "ISPN-12271 Allow different servers for server integration test suite", "committedDate": "2020-08-31T12:50:17Z", "type": "forcePushed"}, {"oid": "876b6b0dd627c155a8b2f62daa9bb9a69b477a47", "url": "https://github.com/infinispan/infinispan/commit/876b6b0dd627c155a8b2f62daa9bb9a69b477a47", "message": "ISPN-12271 Allow different servers for server integration test suite", "committedDate": "2020-08-31T14:10:01Z", "type": "forcePushed"}, {"oid": "4c1f97b4292559c92a4137ef2b7566e0b1a6a5b1", "url": "https://github.com/infinispan/infinispan/commit/4c1f97b4292559c92a4137ef2b7566e0b1a6a5b1", "message": "ISPN-12271 Allow different servers for server integration test suite", "committedDate": "2020-08-31T14:19:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE5NDQ4Mg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r480194482", "bodyText": "Here looks like we will use tomcat-embedded but we are using tomcat-managed, IMO version.arquillian-tomcat-managed sounds better", "author": "gustavolira", "createdAt": "2020-08-31T15:08:43Z", "path": "integrationtests/server-integration/third-party-server/pom.xml", "diffHunk": "@@ -0,0 +1,225 @@\n+<?xml version='1.0' encoding='UTF-8'?>\n+<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <parent>\n+        <groupId>org.infinispan</groupId>\n+        <artifactId>infinispan-server-integration</artifactId>\n+        <version>12.0.0-SNAPSHOT</version>\n+        <relativePath>../pom.xml</relativePath>\n+    </parent>\n+\n+    <artifactId>infinispan-server-integrationtests-third-party</artifactId>\n+\n+    <properties>\n+        <version.tomcat>9.0.37</version.tomcat>\n+        <version.wildfly>20.0.1.Final</version.wildfly>\n+        <version.arquillian-tomcat-embedded>1.1.0.Final</version.arquillian-tomcat-embedded>", "originalCommit": "4c1f97b4292559c92a4137ef2b7566e0b1a6a5b1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE5NzY4OQ==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r480197689", "bodyText": "IMO if we have jboss-deployment-structure.xml inside src/test/resources/eap/jboss-deployment-structure.xmlis way better than work with string into the code", "author": "gustavolira", "createdAt": "2020-08-31T15:13:48Z", "path": "integrationtests/server-integration/third-party-server/src/test/java/org/infinispan/test/integration/DeploymentHelper.java", "diffHunk": "@@ -0,0 +1,57 @@\n+package org.infinispan.test.integration;\n+\n+import java.io.File;\n+\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.asset.StringAsset;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.jboss.shrinkwrap.resolver.api.maven.Maven;\n+import org.jboss.shrinkwrap.resolver.api.maven.MavenResolverSystem;\n+\n+public class DeploymentHelper {\n+\n+   public static WebArchive createDeployment() {\n+\n+      WebArchive war = ShrinkWrap.create(WebArchive.class, \"infinispan-server-integration.war\");\n+      String arquillianLaunch = System.getProperty(\"arquillian.launch\");\n+\n+      if (arquillianLaunch.equals(\"tomcat\")) {\n+         tomcat(war);\n+      } else if (arquillianLaunch.equals(\"wildfly\")) {\n+         wildfly(war);\n+      } else {\n+         throw new IllegalStateException(String.format(\"%s not supported\", arquillianLaunch));\n+      }\n+\n+      MavenResolverSystem resolver = Maven.resolver();\n+      addLibrary(war, resolver\n+            .loadPomFromFile(\"pom.xml\")\n+            .resolve(\"org.infinispan:infinispan-client-hotrod\")\n+            .withTransitivity().as(File.class));\n+      return war;\n+   }\n+\n+   private static void wildfly(WebArchive war) {\n+      String jbossDeploymentStructure = \"<jboss-deployment-structure xmlns=\\\"urn:jboss:deployment-structure:1.1\\\">\\n\" +", "originalCommit": "4c1f97b4292559c92a4137ef2b7566e0b1a6a5b1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MDE5OA==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481150198", "bodyText": "where is this used?", "author": "pruivo", "createdAt": "2020-09-01T13:47:11Z", "path": "integrationtests/server-integration/third-party-server/pom.xml", "diffHunk": "@@ -0,0 +1,225 @@\n+<?xml version='1.0' encoding='UTF-8'?>\n+<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <parent>\n+        <groupId>org.infinispan</groupId>\n+        <artifactId>infinispan-server-integration</artifactId>\n+        <version>12.0.0-SNAPSHOT</version>\n+        <relativePath>../pom.xml</relativePath>\n+    </parent>\n+\n+    <artifactId>infinispan-server-integrationtests-third-party</artifactId>\n+\n+    <properties>\n+        <version.tomcat>9.0.37</version.tomcat>", "originalCommit": "4c1f97b4292559c92a4137ef2b7566e0b1a6a5b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE3ODgwMw==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483178803", "bodyText": "Removed", "author": "diegolovison", "createdAt": "2020-09-03T18:34:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MDE5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MDg5Mg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481150892", "bodyText": "update the author and since", "author": "pruivo", "createdAt": "2020-09-01T13:48:13Z", "path": "integrationtests/server-integration/third-party-server/src/test/java/org/infinispan/test/integration/thirdparty/HotRodClientIT.java", "diffHunk": "@@ -0,0 +1,26 @@\n+package org.infinispan.test.integration.thirdparty;\n+\n+import org.infinispan.test.integration.DeploymentHelper;\n+import org.infinispan.test.integration.as.client.AbstractHotRodClientIT;\n+import org.jboss.arquillian.container.test.api.Deployment;\n+import org.jboss.arquillian.junit.Arquillian;\n+import org.jboss.shrinkwrap.api.Archive;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.junit.runner.RunWith;\n+\n+/**\n+ * Test the Infinispan AS remote client module integration\n+ *\n+ * @author Pedro Ruivo", "originalCommit": "4c1f97b4292559c92a4137ef2b7566e0b1a6a5b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1NzI3NQ==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481157275", "bodyText": "I copied and pasted. Nothing changed", "author": "diegolovison", "createdAt": "2020-09-01T13:57:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MDg5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MTQ2OA==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r481151468", "bodyText": "do we need the non-test dependency?", "author": "pruivo", "createdAt": "2020-09-01T13:49:00Z", "path": "pom.xml", "diffHunk": "@@ -1189,6 +1191,18 @@\n             <artifactId>infinispan-hibernate-cache-commons</artifactId>\n             <version>${version.infinispan}</version>\n          </dependency>\n+         <dependency>\n+            <groupId>org.infinispan</groupId>\n+            <artifactId>infinispan-server-integrationtests-commons</artifactId>\n+            <version>${version.infinispan}</version>\n+            <type>test-jar</type>\n+            <scope>test</scope>\n+         </dependency>\n+         <dependency>", "originalCommit": "4c1f97b4292559c92a4137ef2b7566e0b1a6a5b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE3NzY2OA==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483177668", "bodyText": "No", "author": "diegolovison", "createdAt": "2020-09-03T18:32:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTE1MTQ2OA=="}], "type": "inlineReview"}, {"oid": "1a9a9bdeb3f51295a9d92ebfabec581cd37f34b2", "url": "https://github.com/infinispan/infinispan/commit/1a9a9bdeb3f51295a9d92ebfabec581cd37f34b2", "message": "ISPN-12271 Allow different servers for server integration test suite", "committedDate": "2020-09-03T18:32:00Z", "type": "forcePushed"}, {"oid": "2fa3a0aad0348b9250f9340986f18e93c7eea730", "url": "https://github.com/infinispan/infinispan/commit/2fa3a0aad0348b9250f9340986f18e93c7eea730", "message": "ISPN-12271 Allow different servers for server integration test suite", "committedDate": "2020-09-03T18:34:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY0ODIyMg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483648222", "bodyText": "can you change the phase so I don't have to download the WF every time I compile Infinispan?", "author": "pruivo", "createdAt": "2020-09-04T14:24:36Z", "path": "integrationtests/server-integration/third-party-server/pom.xml", "diffHunk": "@@ -0,0 +1,220 @@\n+<?xml version='1.0' encoding='UTF-8'?>\n+<project xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <parent>\n+        <groupId>org.infinispan</groupId>\n+        <artifactId>infinispan-server-integration</artifactId>\n+        <version>12.0.0-SNAPSHOT</version>\n+        <relativePath>../pom.xml</relativePath>\n+    </parent>\n+\n+    <artifactId>infinispan-third-party-integrationtests</artifactId>\n+\n+    <properties>\n+        <version.wildfly>${appserver.version}</version.wildfly>\n+        <version.arquillian-tomcat-managed>1.1.0.Final</version.arquillian-tomcat-managed>\n+        <ispnserver.project.dir>${basedir}/../../../server/runtime</ispnserver.project.dir>\n+        <ispn.config.file>${basedir}/../server-integration-commons/src/test/resources/infinispan-custom.xml</ispn.config.file>\n+    </properties>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.infinispan.protostream</groupId>\n+            <artifactId>protostream-processor</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.infinispan</groupId>\n+            <artifactId>infinispan-commons-test</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.infinispan</groupId>\n+            <artifactId>infinispan-core</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.infinispan</groupId>\n+            <artifactId>infinispan-client-hotrod</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.infinispan</groupId>\n+            <artifactId>infinispan-server-integrationtests-commons</artifactId>\n+            <type>test-jar</type>\n+            <scope>test</scope>\n+        </dependency>\n+\n+        <dependency>\n+            <groupId>org.jboss.arquillian.junit</groupId>\n+            <artifactId>arquillian-junit-container</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+\n+        <dependency>\n+            <groupId>org.jboss.shrinkwrap.resolver</groupId>\n+            <artifactId>shrinkwrap-resolver-depchain</artifactId>\n+            <type>pom</type>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.jboss.shrinkwrap.descriptors</groupId>\n+            <artifactId>shrinkwrap-descriptors-impl-javaee</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+\n+        <dependency>\n+            <groupId>junit</groupId>\n+            <artifactId>junit</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+    </dependencies>\n+\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <groupId>org.apache.maven.plugins</groupId>\n+                <artifactId>maven-failsafe-plugin</artifactId>\n+                <configuration>\n+                    <systemPropertyVariables>\n+                        <arquillian.launch>${infinispan.server.integration.launch}</arquillian.launch>\n+                        <catalinaHome>${catalinaHome}</catalinaHome>\n+                        <jbossHome>${jbossHome}</jbossHome>\n+                        <server.jvm>${server.jvm}</server.jvm>\n+                    </systemPropertyVariables>\n+                </configuration>\n+                <executions>\n+                    <execution>\n+                        <goals>\n+                            <goal>integration-test</goal>\n+                            <goal>verify</goal>\n+                        </goals>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+        </plugins>\n+    </build>\n+\n+    <profiles>\n+        <profile>\n+            <id>smoke</id>\n+            <properties>\n+                <skipTests>true</skipTests>\n+            </properties>\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-failsafe-plugin</artifactId>\n+                        <configuration>\n+                            <skipITs>${skipTests}</skipITs>\n+                        </configuration>\n+                    </plugin>\n+                </plugins>\n+            </build>\n+        </profile>\n+\n+        <profile>\n+            <id>third-party-tomcat</id>\n+            <activation>\n+                <property>\n+                    <name>infinispan.server.integration.launch</name>\n+                    <value>tomcat</value>\n+                </property>\n+            </activation>\n+            <properties>\n+                <infinispan.server.integration.launch>tomcat</infinispan.server.integration.launch>\n+                <catalinaHome>${project.build.directory}/tomcat</catalinaHome>\n+            </properties>\n+            <dependencies>\n+                <!-- there is no arquillian-tomcat-managed-9. we are using arquillian-tomcat-managed-8 -->\n+                <dependency>\n+                    <groupId>org.jboss.arquillian.container</groupId>\n+                    <artifactId>arquillian-tomcat-managed-8</artifactId>\n+                    <version>${version.arquillian-tomcat-managed}</version>\n+                    <scope>test</scope>\n+                </dependency>\n+            </dependencies>\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-antrun-plugin</artifactId>\n+                        <executions>\n+                            <execution>\n+                                <phase>generate-resources</phase>\n+                                <configuration>\n+                                    <target>\n+                                        <echo message=\"unzipping tomcat server\" />\n+                                        <unzip src=\"${tomcat.zip}\" dest=\"${project.build.directory}/tomcat\" />\n+                                        <pathconvert property=\"tomcat.unzip.dir\">\n+                                            <dirset dir=\"${project.build.directory}/tomcat\" includes=\"apache-tomcat-*\"/>\n+                                        </pathconvert>\n+                                        <move todir=\"${project.build.directory}/tomcat\">\n+                                            <fileset dir=\"${tomcat.unzip.dir}\"/>\n+                                        </move>\n+                                        <copy file=\"${basedir}/src/test/resources/tomcat/tomcat-users.xml\" todir=\"${project.build.directory}/tomcat/conf\" overwrite=\"true\" />\n+                                    </target>\n+                                </configuration>\n+                                <goals>\n+                                    <goal>run</goal>\n+                                </goals>\n+                            </execution>\n+                        </executions>\n+                    </plugin>\n+                </plugins>\n+            </build>\n+        </profile>\n+\n+        <profile>\n+            <id>third-party-wildfly</id>\n+            <activation>\n+                <activeByDefault>true</activeByDefault>\n+                <property>\n+                    <name>infinispan.server.integration.launch</name>\n+                    <value>wildfly</value>\n+                </property>\n+            </activation>\n+            <properties>\n+                <infinispan.server.integration.launch>wildfly</infinispan.server.integration.launch>\n+                <jbossHome>${project.build.directory}/wildfly-${version.wildfly}</jbossHome>\n+            </properties>\n+            <dependencies>\n+                <dependency>\n+                    <groupId>org.wildfly.arquillian</groupId>\n+                    <artifactId>wildfly-arquillian-container-managed</artifactId>\n+                </dependency>\n+            </dependencies>\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-dependency-plugin</artifactId>\n+                        <executions>\n+                            <execution>\n+                                <id>unpack</id>\n+                                <phase>process-test-classes</phase>", "originalCommit": "2fa3a0aad0348b9250f9340986f18e93c7eea730", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc4NTkwMg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483785902", "bodyText": "It is downloading even when phase is pre-integration-test. Any idea?", "author": "diegolovison", "createdAt": "2020-09-04T18:28:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY0ODIyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc5MTkyNQ==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483791925", "bodyText": "yes, add <skip>${skipTests}</skip> to the configuration :)", "author": "pruivo", "createdAt": "2020-09-04T18:43:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY0ODIyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgwNTY3Mg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483805672", "bodyText": "Done", "author": "diegolovison", "createdAt": "2020-09-04T19:18:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY0ODIyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY1NjE0Mg==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483656142", "bodyText": "is this intentional?", "author": "pruivo", "createdAt": "2020-09-04T14:37:49Z", "path": "integrationtests/server-integration/third-party-server/src/test/java/org/infinispan/test/integration/DeploymentHelper.java", "diffHunk": "@@ -0,0 +1,46 @@\n+package org.infinispan.test.integration;\n+\n+import java.io.File;\n+\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.asset.FileAsset;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.jboss.shrinkwrap.resolver.api.maven.Maven;\n+import org.jboss.shrinkwrap.resolver.api.maven.MavenResolverSystem;\n+\n+public class DeploymentHelper {\n+\n+   public static WebArchive createDeployment() {\n+\n+      WebArchive war = ShrinkWrap.create(WebArchive.class, \"infinispan-server-integration.war\");\n+      String arquillianLaunch = System.getProperty(\"arquillian.launch\");\n+\n+      if (arquillianLaunch.equals(\"tomcat\")) {\n+         tomcat(war);\n+      } else if (arquillianLaunch.equals(\"wildfly\")) {\n+         wildfly(war);\n+      } else {\n+         throw new IllegalStateException(String.format(\"%s not supported\", arquillianLaunch));\n+      }\n+\n+      MavenResolverSystem resolver = Maven.resolver();\n+      addLibrary(war, resolver\n+            .loadPomFromFile(\"pom.xml\")\n+            .resolve(\"org.infinispan:infinispan-client-hotrod\")\n+            .withTransitivity().as(File.class));\n+      return war;\n+   }\n+\n+   private static void wildfly(WebArchive war) {\n+      war.add(new FileAsset(new File(\"src/test/resources/wildfly/jboss-deployment-structure.xml\")), \"WEB-INF/jboss-deployment-structure.xml\");\n+   }\n+\n+   private static void tomcat(WebArchive war) {", "originalCommit": "2fa3a0aad0348b9250f9340986f18e93c7eea730", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc4NzA0MQ==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483787041", "bodyText": "Yes. I added a comment. Please let me know what you think,", "author": "diegolovison", "createdAt": "2020-09-04T18:31:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY1NjE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc5MjM5OQ==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483792399", "bodyText": "looks good.", "author": "pruivo", "createdAt": "2020-09-04T18:44:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY1NjE0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY1NjY5MA==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483656690", "bodyText": "nitpick: move server-integration-commons beforewf-modules?", "author": "pruivo", "createdAt": "2020-09-04T14:38:46Z", "path": "pom.xml", "diffHunk": "@@ -147,6 +147,8 @@\n       <module>integrationtests/spring-boot-it</module>\n       <module>integrationtests/server-integration</module>\n       <module>integrationtests/server-integration/wildfly-modules</module>\n+      <module>integrationtests/server-integration/third-party-server</module>\n+      <module>integrationtests/server-integration/server-integration-commons</module>", "originalCommit": "2fa3a0aad0348b9250f9340986f18e93c7eea730", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc4NjkyMw==", "url": "https://github.com/infinispan/infinispan/pull/8657#discussion_r483786923", "bodyText": "Done", "author": "diegolovison", "createdAt": "2020-09-04T18:30:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY1NjY5MA=="}], "type": "inlineReview"}, {"oid": "38fb79fce8983b52537a5ce6e892d3d8c3b20e60", "url": "https://github.com/infinispan/infinispan/commit/38fb79fce8983b52537a5ce6e892d3d8c3b20e60", "message": "ISPN-12271 Allow different servers for server integration test suite", "committedDate": "2020-09-04T18:30:22Z", "type": "forcePushed"}, {"oid": "88ded7950fc42fb6c7c896df8f6f5975ded37760", "url": "https://github.com/infinispan/infinispan/commit/88ded7950fc42fb6c7c896df8f6f5975ded37760", "message": "ISPN-12271 Allow different servers for server integration test suite", "committedDate": "2020-09-04T19:18:31Z", "type": "commit"}, {"oid": "88ded7950fc42fb6c7c896df8f6f5975ded37760", "url": "https://github.com/infinispan/infinispan/commit/88ded7950fc42fb6c7c896df8f6f5975ded37760", "message": "ISPN-12271 Allow different servers for server integration test suite", "committedDate": "2020-09-04T19:18:31Z", "type": "forcePushed"}]}