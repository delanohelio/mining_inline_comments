{"pr_number": 8876, "pr_title": "ISPN-12448 JGroups documentation revisited", "pr_createdAt": "2020-11-20T19:50:56Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8876", "timeline": [{"oid": "ef5262b7aa3330fd1c851f9636f8baeb2fdddae4", "url": "https://github.com/infinispan/infinispan/commit/ef5262b7aa3330fd1c851f9636f8baeb2fdddae4", "message": "add stack combine insert before", "committedDate": "2020-11-23T17:15:32Z", "type": "forcePushed"}, {"oid": "5b2eca63a7dd9802598c658f4fadb5b11ff89268", "url": "https://github.com/infinispan/infinispan/commit/5b2eca63a7dd9802598c658f4fadb5b11ff89268", "message": "add stack combine insert before", "committedDate": "2020-11-23T17:48:17Z", "type": "forcePushed"}, {"oid": "c9db834b3a4e72b01746d3b82179c05cc5db9965", "url": "https://github.com/infinispan/infinispan/commit/c9db834b3a4e72b01746d3b82179c05cc5db9965", "message": "ISPN-12448 JGroups documentation revisited", "committedDate": "2020-11-25T16:51:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg1NjgwNA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r530856804", "bodyText": "I don't understand this classification.\nI'd say the discovery protocols fall into two broad categories:\n\nthe generic ones (TCPPING and UDPPING) which should work on most network and don't rely on external services\nthose that rely on some external source for storing/retrieving topology information (DNS, Kubernetes, S3, JDBC, Gossip, etc)", "author": "tristantarrant", "createdAt": "2020-11-26T08:39:50Z", "path": "documentation/src/main/asciidoc/topics/con_discovery.adoc", "diffHunk": "@@ -0,0 +1,16 @@\n+[id='cluster_discovery-{context}']\n+= Cluster Discovery Protocols\n+{brandname} supports different protocols that allow nodes to automatically find each other on the network and form clusters.\n+\n+{brandname} can use the following discovery mechanisms:\n+\n+* Generic discovery protocols (`TCPPING` and `TCPGOSSIP`)\n+* JGroups PING protocols (`KUBE_PING` and `DNS_PING`)", "originalCommit": "c9db834b3a4e72b01746d3b82179c05cc5db9965", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU5OTE5Mw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532599193", "bodyText": "Thanks, that makes a lot more sense.\n@tristantarrant I noticed there is no example of UDPPING in our docs. Do you mean PING instead? If so should we include an example of PING alongside the others?", "author": "oraNod", "createdAt": "2020-11-30T13:33:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg1NjgwNA=="}], "type": "inlineReview"}, {"oid": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "url": "https://github.com/infinispan/infinispan/commit/76c4a32abad2fc674cc01ede810ff20fcefed2ef", "message": "some edits and updates", "committedDate": "2020-11-30T13:29:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY0ODM3Mg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532648372", "bodyText": "-p doesn't encrypt anything :)", "author": "pruivo", "createdAt": "2020-11-30T14:44:40Z", "path": "cli/src/main/resources/help/user.adoc", "diffHunk": "@@ -97,7 +83,7 @@ Specifies the algorithms used to hash the password.\n *-g, --groups*='group1,group2,...'::\n Specifies the groups to which the user belongs.\n \n-*-p, --password*='password'::\n+*-p, --password*='password'::Encrypt all of the passwords ", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY1MjI2OQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532652269", "bodyText": "The file name is redhat-datagrid (I think)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            $ unzip jboss-datagrid-{FullProductVersion}-server.zip\n          \n          \n            \n            $ unzip redhat-datagrid-{FullProductVersion}-server.zip", "author": "pruivo", "createdAt": "2020-11-30T14:49:40Z", "path": "documentation/src/main/asciidoc/topics/cmd_examples/extract_server_distribution.adoc", "diffHunk": "@@ -0,0 +1,6 @@\n+ifndef::productized[]\n+$ unzip infinispan-server-{ispn_version}.zip\n+endif::productized[]\n+ifdef::productized[]\n+$ unzip jboss-datagrid-{FullProductVersion}-server.zip", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY1NDM5Nw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532654397", "bodyText": "import not required since the calls are chained.", "author": "pruivo", "createdAt": "2020-11-30T14:52:28Z", "path": "documentation/src/main/asciidoc/topics/code_examples/ConfigureTransportDefault.java", "diffHunk": "@@ -1,3 +1,5 @@\n+import org.infinispan.configuration.global.TransportConfigurationBuilder;", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY1NDU4Ng==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532654586", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 .clusterName(\"qa-cluster\")\n          \n          \n            \n            \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 .clusterName(\"qa-cluster\")\n          \n          \n            \n            \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 .build()", "author": "pruivo", "createdAt": "2020-11-30T14:52:42Z", "path": "documentation/src/main/asciidoc/topics/code_examples/ConfigureTransportDefault.java", "diffHunk": "@@ -1,3 +1,5 @@\n+import org.infinispan.configuration.global.TransportConfigurationBuilder;\n+\n GlobalConfiguration globalConfig = new GlobalConfigurationBuilder().transport()\n         .defaultTransport()\n \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 .clusterName(\"qa-cluster\")", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY1NjQ5Ng==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532656496", "bodyText": "I would remove the {brandname} from here (and other places in the doc related to user creation)\nThe final outcome would be Create a Infinispan user <- doesn't seem correct to me.", "author": "pruivo", "createdAt": "2020-11-30T14:55:08Z", "path": "documentation/src/main/asciidoc/topics/proc_creating_caches_console.adoc", "diffHunk": "@@ -5,7 +5,7 @@ Dynamically add caches from templates or configuration files through the\n \n .Prerequisites\n \n-Add {brandname} credentials and start at least one {brandname} server instance.\n+Create a {brandname} user and start at least one {brandname} server instance.", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY2MTYzMw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532661633", "bodyText": "not sure why step 1 (locate) & 2 (view xml) are required. Reading this it seems mandatory to open the XML file.\nIMO, You can just tell where the XML is.", "author": "pruivo", "createdAt": "2020-11-30T15:01:52Z", "path": "documentation/src/main/asciidoc/topics/proc_using_jgroups_default.adoc", "diffHunk": "@@ -0,0 +1,51 @@\n+[id='jgroups_getting_started-{context}']\n+= Getting Started with Default Stacks\n+{brandname} uses JGroups protocol stacks so nodes can send each other messages on dedicated cluster channels.\n+\n+{brandname} provides preconfigured JGroups stacks for `UDP` and `TCP` protocols.\n+You can use these default stacks as a starting point for building custom cluster transport configuration that is optimized for your network requirements.\n+\n+.Procedure\n+\n+. Locate the default JGroups stacks in the `default-configs` directory inside the `infinispan-core-{ispn_version}.jar` file.", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY2Mjk3OQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532662979", "bodyText": "update url?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * link:http://www.jgroups.org/manual/html/protlist.html[JGroups Protocol]\n          \n          \n            \n            * link:http://jgroups.org/manual4/index.html#protlist[JGroups Protocol]", "author": "pruivo", "createdAt": "2020-11-30T15:03:49Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_default.adoc", "diffHunk": "@@ -40,4 +38,3 @@ directory.\n .Reference\n \n * link:http://www.jgroups.org/manual/html/protlist.html[JGroups Protocol]", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY2NDk1Nw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532664957", "bodyText": "RELAY2 doesn't have a default port. If not configured, it will use 7800++", "author": "pruivo", "createdAt": "2020-11-30T15:06:33Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_ports.adoc", "diffHunk": "@@ -21,7 +22,3 @@\n |JGroups RELAY2 for cross-site replication", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU3NjY0MQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r533576641", "bodyText": "added some clarification. hopefully changes make sense. or we can just remove the cross-site bits.", "author": "oraNod", "createdAt": "2020-12-01T17:05:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY2NDk1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY2ODA2MQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532668061", "bodyText": "is this true? You don't need stack.position when used with COMBINE. I'm not expecting it to reset everything :)", "author": "pruivo", "createdAt": "2020-11-30T15:10:39Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_inheritance_attributes.adoc", "diffHunk": "@@ -0,0 +1,37 @@\n+[id='jgroups_inheritance_attributes-{context}']\n+= Inheritance Attributes\n+When you extend a JGroups stack, inheritance attributes let you adjust protocols and properties in the stack you are extending.\n+\n+* `stack.combine` uses the following values to extends JGroups stacks:\n++\n+[%header,cols=\"1,2\"]\n+|===\n+\n+| Value\n+| Description\n+\n+| `COMBINE`\n+| Overrides protocol properties.\n+\n+| `REPLACE`\n+| Replaces protocols.\n+\n+| `INSERT_AFTER`\n+| Adds a protocol into the stack after another protocol.\n+Does not affect the protocol that you specify as the insertion point.\n+\n+Protocols in JGroups stacks affect each other based on their location in the stack.\n+For example, you should put a protocol such as `NAKACK2` after the `SYM_ENCRYPT` or `ASYM_ENCRYPT` protocol so that `NAKACK2` is secured.\n+\n+| `INSERT_BEFORE`\n+| Inserts a protocols into the stack before another protocol.\n+Affects the protocol that you specify as the insertion point.\n+\n+| `REMOVE`\n+| Removes protocols from the stack.\n+\n+|===\n+\n+* `stack.position` specifies protocols to modify.\n+If you do not specify `stack.position`, {brandname} modifies the corresponding protocol in the stack.\n+This resets all protocol attributes that you do not specify to default values.", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUzMjMxMg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r533532312", "bodyText": "yeah, maybe this doesn't make sense. I'll remove. thanks!", "author": "oraNod", "createdAt": "2020-12-01T16:06:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY2ODA2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3NDY3Nw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532674677", "bodyText": "there is one more property I added with JGroups 4.2.9:\njgroups.thread_dumps_threshold: \"The number of times a thread pool needs to be full before a thread dump is logged\"", "author": "pruivo", "createdAt": "2020-11-30T15:19:30Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_system_properties.adoc", "diffHunk": "@@ -1,11 +1,6 @@\n [id='jgroups_system_props-{context}']\n-= System Properties for Default JGroups Stacks\n-Use system properties with default JGroups stacks.\n-\n-.Common Properties\n-\n-The following system properties apply to all JGroups stacks, including\n-`default-jgroups-udp.xml` and `default-jgroups-tcp.xml`:", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUzNjQ1Mw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r533536453", "bodyText": "@pruivo is the default for jgroups.thread_dumps_threshold 10000?", "author": "oraNod", "createdAt": "2020-12-01T16:12:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3NDY3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE3ODQxMg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534178412", "bodyText": "yes", "author": "pruivo", "createdAt": "2020-12-02T13:47:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3NDY3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3NjM1NA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532676354", "bodyText": "can you check column \"required\" in jgroups.google.bucket_name? It is mentioning dns_query but I'm not sure if it is related.", "author": "pruivo", "createdAt": "2020-11-30T15:21:40Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_system_properties.adoc", "diffHunk": "@@ -108,7 +103,7 @@ The following system properties apply to `default-jgroups-kubernetes.xml`:\n \n .Google Cloud Platform\n \n-The following system properties apply to `default-jgroups-google.xml`:\n+The following system properties apply only to `default-jgroups-google.xml`:\n \n [%header,cols=\"1,3,2,1\"]\n |===", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU0MzE4Mg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r533543182", "bodyText": "fixed", "author": "oraNod", "createdAt": "2020-12-01T16:20:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3NjM1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3Njc2Mw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532676763", "bodyText": "where is dns_query come from? It is mentioned in the column \"required\".", "author": "pruivo", "createdAt": "2020-11-30T15:22:09Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_system_properties.adoc", "diffHunk": "@@ -89,7 +84,7 @@ The following system properties apply to `default-jgroups-ec2.xml`:\n \n .Kubernetes\n \n-The following system properties apply to `default-jgroups-kubernetes.xml`:\n+The following system properties apply only to `default-jgroups-kubernetes.xml`:\n \n [%header,cols=\"1,3,2,1\"]\n |===", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU0NzQzNQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r533547435", "bodyText": "dns_query is set in DNS_PING. I've updated this description. great catch btw!", "author": "oraNod", "createdAt": "2020-12-01T16:26:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3Njc2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3NzcwMQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532677701", "bodyText": "The JGroups Protocol List URL needs to be updated as well. Put in some attribute?", "author": "pruivo", "createdAt": "2020-11-30T15:23:23Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_system_properties.adoc", "diffHunk": "@@ -108,7 +103,7 @@ The following system properties apply to `default-jgroups-kubernetes.xml`:\n \n .Google Cloud Platform\n \n-The following system properties apply to `default-jgroups-google.xml`:\n+The following system properties apply only to `default-jgroups-google.xml`:\n \n [%header,cols=\"1,3,2,1\"]\n |===", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3ODg5MA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532678890", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            . Add custom JGroups stack files to the `{server_home}/conf` directory.\n          \n          \n            \n            . Add custom JGroups stack files to the `{server_home}/server/conf` directory.", "author": "pruivo", "createdAt": "2020-11-30T15:24:52Z", "path": "documentation/src/main/asciidoc/topics/proc_using_jgroups_external.adoc", "diffHunk": "@@ -1,33 +1,24 @@\n [id='jgroups_external-{context}']\n-= Using JGroups Stacks in External Files\n-You can use custom JGroups transport configuration from external files.\n+= Using External JGroups Stacks\n+Reference external files that define custom JGroups stacks in `infinispan.xml` files.\n \n-{brandname} looks for JGroups configuration files on your classpath first and\n-then for absolute path names.\n+.Procedure\n \n-.Declaratively\n-\n-* Specify your JGroups transport configuration with the `stack-file` element.\n+ifdef::server_mode[]\n+. Add custom JGroups stack files to the `{server_home}/conf` directory.", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUxMjczNg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r533512736", "bodyText": "fixed", "author": "oraNod", "createdAt": "2020-12-01T15:42:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY3ODg5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4MDM4Ng==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532680386", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * link:http://www.jgroups.org/manual/html/protlist.html#DiscoveryProtocols[JGroups Discovery Protocols]\n          \n          \n            \n            * link:http://jgroups.org/manual4/index.html#DiscoveryProtocols[JGroups Discovery Protocols]", "author": "pruivo", "createdAt": "2020-11-30T15:26:42Z", "path": "documentation/src/main/asciidoc/topics/con_discovery.adoc", "diffHunk": "@@ -0,0 +1,16 @@\n+[id='cluster_discovery-{context}']\n+= Cluster Discovery Protocols\n+{brandname} supports different protocols that allow nodes to automatically find each other on the network and form clusters.\n+\n+There are two types of discovery mechanisms that {brandname} can use:\n+\n+* Generic discovery protocols that work on most networks and do not rely on external services.\n+* Discovery protocols that rely on external services to store and retrieve topology information for {brandname} clusters. +\n+For instance the JDBC_PING protocol uses a shared database where nodes write their IP addresses.\n+\n+[NOTE]\n+====\n+Running {brandname} on hosted platforms requires using discovery mechanisms that are adapted to network constraints that individual cloud providers impose.\n+====\n+\n+* link:http://www.jgroups.org/manual/html/protlist.html#DiscoveryProtocols[JGroups Discovery Protocols]", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUxMzA4Mg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r533513082", "bodyText": "fixed", "author": "oraNod", "createdAt": "2020-12-01T15:42:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4MDM4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4MTY4Nw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532681687", "bodyText": "JGroups TCPPING needs update:\nhttp://jgroups.org/manual4/index.html#TCPPING_Prot", "author": "pruivo", "createdAt": "2020-11-30T15:28:17Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_tcp_ping.adoc", "diffHunk": "@@ -1,11 +1,8 @@\n+[id='discovery_tcpping-{context}']\n = TCPPING\n-`TCPPING` is a generic JGroups discovery mechanism that uses a static list of IP\n-addresses for cluster members.\n+TCPPING is a generic JGroups discovery mechanism that uses a list of static addresses for cluster members.\n \n-To use `TCPPING`, you must add the list of static IP addresses to the JGroups\n-configuration file for each {brandname} node. However, the drawback to\n-`TCPPING` is that it does not allow nodes to dynamically join {brandname}\n-clusters.\n+With TCPPING, you manually specify the IP address or hostname of each node in the {brandname} cluster as part of the JGroups stack, rather letting nodes discover each other dynamically.\n \n .TCPPING configuration example\n [source,xml,options=\"nowrap\",subs=attributes+]", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4MjU0Mg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532682542", "bodyText": "link needs update:\nhttp://jgroups.org/manual4/index.html#TCPGOSSIP_Prot", "author": "pruivo", "createdAt": "2020-11-30T15:29:23Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_gossip_router.adoc", "diffHunk": "@@ -1,4 +1,5 @@\n-= Gossip Router\n+[id='discovery_tcpgossip-{context}']\n+= TCPGOSSIP", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4NDUwOA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532684508", "bodyText": "KUBE_PING is old and we don't ship/productize it (DNS_PING is recommended). I would remove it from docs.", "author": "pruivo", "createdAt": "2020-11-30T15:31:50Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_kube_ping.adoc", "diffHunk": "@@ -1,6 +1,7 @@\n+[id='discovery_kubeping-{context}']\n = KUBE_PING", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4NjI1OQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532686259", "bodyText": "link to docs? http://jgroups.org/manual4/index.html#_native_s3_ping", "author": "pruivo", "createdAt": "2020-11-30T15:34:14Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_aws.adoc", "diffHunk": "@@ -11,8 +12,11 @@ requires both Amazon S3 and EC2 subscriptions.\n include::config_examples/s3ping.xml[]\n ----\n \n-.NATIVE_S3_PING dependencies for embedded {brandname}\n+ifdef::embedded_mode[]\n+{brandname} requires cloud provider dependencies to use NATIVE_S3_PING:\n+\n [source,xml,options=\"nowrap\",subs=attributes+]\n ----\n include::dependencies_maven/ispn_cloud_ec2.xml[]\n ----\n+endif::embedded_mode[]", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4ODExNw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532688117", "bodyText": "@tristantarrant we don't productize this and we don't ship it with the server. should be removed from server docs? (or include it in the server? or document how to include it in the server xD)", "author": "pruivo", "createdAt": "2020-11-30T15:36:34Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_azure.adoc", "diffHunk": "@@ -1,5 +1,6 @@\n+[id='discovery_azure-{context}']\n = AZURE_PING", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzU0ODgyMw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r533548823", "bodyText": "@pruivo I've added conditional statements to AZURE_PING and GOOGLE_PING2 so they appear in community docs only. IMO let's not ship with the downstream server unless there is a specific ask but let's see what @tristantarrant says.", "author": "oraNod", "createdAt": "2020-12-01T16:28:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4ODExNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4ODQ5Nw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532688497", "bodyText": "same for this :)", "author": "pruivo", "createdAt": "2020-11-30T15:37:01Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_google.adoc", "diffHunk": "@@ -1,6 +1,7 @@\n+[id='discovery_google-{context}']\n = GOOGLE2_PING", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4ODg3Mw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532688873", "bodyText": "BTW, the protocol name is GOOGLE_PING2 :)", "author": "pruivo", "createdAt": "2020-11-30T15:37:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4ODQ5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4OTA2Nw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532689067", "bodyText": "link is missing: http://jgroups.org/manual4/index.html#GOOGLE_PING2", "author": "pruivo", "createdAt": "2020-11-30T15:37:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4ODQ5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY4OTgyNA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r532689824", "bodyText": "I think it works with \"all\" JDBC databases. Worth mention it?\nAlso, link to docs: http://jgroups.org/manual4/index.html#_jdbc_ping", "author": "pruivo", "createdAt": "2020-11-30T15:38:47Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_jdbc.adoc", "diffHunk": "@@ -1,6 +1,8 @@\n+[id='discovery_jdbcping-{context}']\n = JDBC_PING\n-`JDBC_PING` uses JDBC connections to shared databases, such as Amazon RDS on\n-EC2, to store information about {brandname} nodes.\n+JDBC_PING uses shared databases, such as Amazon RDS on EC2, to store information about {brandname} clusters.", "originalCommit": "76c4a32abad2fc674cc01ede810ff20fcefed2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d2544f013976433599ce466864dcd42b420984c2", "url": "https://github.com/infinispan/infinispan/commit/d2544f013976433599ce466864dcd42b420984c2", "message": "pruivo feedback", "committedDate": "2020-11-30T17:43:16Z", "type": "forcePushed"}, {"oid": "553aad66c1d83624155b9c58cd9b51d9ac8e84e3", "url": "https://github.com/infinispan/infinispan/commit/553aad66c1d83624155b9c58cd9b51d9ac8e84e3", "message": "ISPN-12448 JGroups documentation revisited", "committedDate": "2020-11-30T17:58:24Z", "type": "forcePushed"}, {"oid": "1f844c2120736d83ab1828873079a175a1041173", "url": "https://github.com/infinispan/infinispan/commit/1f844c2120736d83ab1828873079a175a1041173", "message": "ISPN-12448 JGroups documentation revisited", "committedDate": "2020-12-01T16:28:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE4NDI4Nw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534184287", "bodyText": "this file isn't consumed anywhere (at least, I don't find any reference). remove it?", "author": "pruivo", "createdAt": "2020-12-02T13:55:40Z", "path": "documentation/src/main/asciidoc/topics/proc_using_custom_jchannels.adoc", "diffHunk": "@@ -14,4 +14,4 @@ include::code_examples/CustomJChannel.java[]\n \n .Reference\n \n-link:http://www.jgroups.org/manual4/index.html#JChannel[JGroups JChannel]\n+link:{jgroups_docs}#JChannel[JGroups JChannel]", "originalCommit": "dbe30fd839cbee7a350094480ce96356d7048756", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI1MjgwMA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534252800", "bodyText": "I think I just forgot to include it in the assembly. it should be for embedded only. I'll add it back.", "author": "oraNod", "createdAt": "2020-12-02T15:23:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE4NDI4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE4NzUwOA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534187508", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            On Amazon Web Service (AWS), use the S3_PING protocol for discovery.\n          \n          \n            \n            On Amazon Web Service (AWS), use the NATIVE_S3_PING protocol for discovery.\n          \n      \n    \n    \n  \n\nwarning, there is an S3_PING protocol as well. We don't ship it; we only ship the native one.", "author": "pruivo", "createdAt": "2020-12-02T14:00:11Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_aws.adoc", "diffHunk": "@@ -1,8 +1,9 @@\n+[id='discovery_aws-{context}']\n = NATIVE_S3_PING\n-On Amazon Web Service (AWS), use the `S3_PING` protocol for discovery.\n+On Amazon Web Service (AWS), use the S3_PING protocol for discovery.", "originalCommit": "dbe30fd839cbee7a350094480ce96356d7048756", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE5OTIxMA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534199210", "bodyText": "I'm overthinking again \ud83d\ude28\nthis section is fine for embedded. But for the server, it requires custom jars to be placed in server/lib: the jgroups-google jar and manually find its dependencies. (same for azure & native_s3)\nthis isn't a trivial task and the server docs make it look too easy. I'm not sure how to proceed here:\n\nRemove those discovery protocols from server docs?\nsomething else?", "author": "pruivo", "createdAt": "2020-12-02T14:16:37Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_google.adoc", "diffHunk": "@@ -1,16 +1,22 @@\n-= GOOGLE2_PING\n-On Google Compute Engine (GCE), use a generic discovery protocol or\n-`GOOGLE2_PING`, which uses Google Cloud Storage (GCS) to store information\n-about the cluster members.\n+[id='discovery_google-{context}']\n+= GOOGLE_PING2\n+On Google Compute Engine (GCE), use a generic discovery protocol or GOOGLE_PING2, which uses Google Cloud Storage (GCS) to store information about the cluster members.\n \n-.GOOGLE2_PING configuration example\n+.GOOGLE_PING2 configuration example\n [source,xml,options=\"nowrap\",subs=attributes+]\n ----\n include::config_examples/googleping.xml[]\n ----\n \n-.GOOGLE2_PING dependencies for embedded {brandname}\n+ifdef::embedded_mode[]\n+{brandname} requires cloud provider dependencies to use GOOGLE_PING2:", "originalCommit": "dbe30fd839cbee7a350094480ce96356d7048756", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDIwMjQ4MA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534202480", "bodyText": "ps. actually, we don't ship the native_s3 for 11.x/master. We ship in the old server 9.4.x.", "author": "pruivo", "createdAt": "2020-12-02T14:20:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE5OTIxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI2MTYwMQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534261601", "bodyText": "@pruivo Let's remove the discovery protocols from server docs. I'll remove NATIVE_S3 altogether.", "author": "oraNod", "createdAt": "2020-12-02T15:34:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE5OTIxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI2ODc1Mw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534268753", "bodyText": "As discussed, let's drop the 3 cloud protocols. Easier to maintain for us and we link to JGroups docs.", "author": "oraNod", "createdAt": "2020-12-02T15:42:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDE5OTIxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDIwMTgyNw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534201827", "bodyText": "worth mention (as a warning/note) that the user needs to add the driver jar (H2, MySQL, whatever he is using)", "author": "pruivo", "createdAt": "2020-12-02T14:19:59Z", "path": "documentation/src/main/asciidoc/topics/ref_discovery_jdbc.adoc", "diffHunk": "@@ -1,7 +1,12 @@\n+[id='discovery_jdbcping-{context}']\n = JDBC_PING\n-`JDBC_PING` uses JDBC connections to shared databases, such as Amazon RDS on\n-EC2, to store information about {brandname} nodes.\n+JDBC_PING uses shared databases to store information about {brandname} clusters.\n+This protocol supports any database that can use a JDBC connection.", "originalCommit": "dbe30fd839cbee7a350094480ce96356d7048756", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDIwNzUyMg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534207522", "bodyText": "It is required.", "author": "pruivo", "createdAt": "2020-12-02T14:27:03Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_system_properties.adoc", "diffHunk": "@@ -120,12 +120,12 @@ The following system properties apply to `default-jgroups-google.xml`:\n \n | `jgroups.google.bucket_name`\n | Name of the Google Compute Engine bucket. The name must exist and be unique.\n-| N/A\n-| Required if you do not set the `dns_query` parameter.\n+| No default value.\n+| Optional", "originalCommit": "dbe30fd839cbee7a350094480ce96356d7048756", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDIxMDEwMg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534210102", "bodyText": "I would remove dns_query from the table and make the attribute required.\nTo overwrite dns_query you need a custom stack and, if that is the case, jgroups.dns.query is not longer used.", "author": "pruivo", "createdAt": "2020-12-02T14:30:15Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_system_properties.adoc", "diffHunk": "@@ -100,15 +100,15 @@ The following system properties apply to `default-jgroups-kubernetes.xml`:\n | Required/Optional\n \n | `jgroups.dns.query`\n-| Sets the DNS record that returns cluster members.\n-| N/A\n-| Required if you do not set the `dns_query` parameter.\n+| Sets the DNS record that returns cluster members and overrides the `dns_query` parameter in the DNS_PING discovery protocol.", "originalCommit": "dbe30fd839cbee7a350094480ce96356d7048756", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2ecd8bfd477b1f2f3c5ad176a95e97a1d854b090", "url": "https://github.com/infinispan/infinispan/commit/2ecd8bfd477b1f2f3c5ad176a95e97a1d854b090", "message": "pruivo feedback", "committedDate": "2020-12-02T15:27:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI4OTU3OQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534289579", "bodyText": "I miss this one. can you update the URL?", "author": "pruivo", "createdAt": "2020-12-02T16:08:23Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_system_properties.adoc", "diffHunk": "@@ -120,12 +120,12 @@ The following system properties apply to `default-jgroups-google.xml`:\n \n | `jgroups.google.bucket_name`\n | Name of the Google Compute Engine bucket. The name must exist and be unique.\n-| N/A\n-| Required if you do not set the `dns_query` parameter.\n+| No default value.\n+| Required\n \n |===\n \n .Reference\n \n-* link:http://www.jgroups.org/manual4/index.html#SystemProperties[JGroups System Properties]\n+* link:{jgroups_docs}#SystemProperties[JGroups System Properties]\n * link:http://jgroups.org/manual/html/protlist.html[JGroups Protocol List]", "originalCommit": "d0de964929b8de0d80bf4cedaa4eb42355219d5f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMDc3OA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r534310778", "bodyText": "done. thanks for that. I thought we had them all too.", "author": "oraNod", "createdAt": "2020-12-02T16:35:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDI4OTU3OQ=="}], "type": "inlineReview"}, {"oid": "f1e89b016f63f52e7390f0a5b4ccbd397d0e9f6f", "url": "https://github.com/infinispan/infinispan/commit/f1e89b016f63f52e7390f0a5b4ccbd397d0e9f6f", "message": "ISPN-12448 JGroups documentation revisited", "committedDate": "2020-12-02T16:51:51Z", "type": "forcePushed"}, {"oid": "a38cc1cb4f80261c36b1a4408278e052fa48b0e0", "url": "https://github.com/infinispan/infinispan/commit/a38cc1cb4f80261c36b1a4408278e052fa48b0e0", "message": "ISPN-12448 JGroups documentation revisited", "committedDate": "2020-12-03T09:07:31Z", "type": "forcePushed"}, {"oid": "6030fba32f7b9bf0236171077b254f43b6539a16", "url": "https://github.com/infinispan/infinispan/commit/6030fba32f7b9bf0236171077b254f43b6539a16", "message": "ISPN-12448 JGroups documentation revisited", "committedDate": "2020-12-04T11:32:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA0NDI5OQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536044299", "bodyText": "Is JDBC_PING a good example here? It seems one of the more niche discovery protocols. How about DNS_PING? That's what we use in kubernetes/openshfit.", "author": "ryanemerson", "createdAt": "2020-12-04T11:51:10Z", "path": "documentation/src/main/asciidoc/topics/con_discovery.adoc", "diffHunk": "@@ -0,0 +1,23 @@\n+[id='cluster_discovery-{context}']\n+= Cluster Discovery Protocols\n+{brandname} supports different protocols that allow nodes to automatically find each other on the network and form clusters.\n+\n+There are two types of discovery mechanisms that {brandname} can use:\n+\n+* Generic discovery protocols that work on most networks and do not rely on external services.\n+* Discovery protocols that rely on external services to store and retrieve topology information for {brandname} clusters. +\n+For instance the JDBC_PING protocol uses a shared database where nodes write their IP addresses.", "originalCommit": "6030fba32f7b9bf0236171077b254f43b6539a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA0NTgxNw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536045817", "bodyText": "s/to find/to create/", "author": "ryanemerson", "createdAt": "2020-12-04T11:54:02Z", "path": "documentation/src/main/asciidoc/topics/proc_customizing_jgroups_stacks.adoc", "diffHunk": "@@ -0,0 +1,85 @@\n+[id='using_jgroups_inheritance-{context}']\n+= Customizing JGroups Stacks\n+Adjust and tune properties to find a cluster transport configuration that works for your network requirements.", "originalCommit": "6030fba32f7b9bf0236171077b254f43b6539a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA0NjcyMg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536046722", "bodyText": "I'm not sure this sentence adds anything, imo we can remove this.", "author": "ryanemerson", "createdAt": "2020-12-04T11:55:41Z", "path": "documentation/src/main/asciidoc/topics/proc_using_jgroups_default.adoc", "diffHunk": "@@ -0,0 +1,57 @@\n+[id='jgroups_getting_started-{context}']\n+= Getting Started with Default Stacks\n+{brandname} uses JGroups protocol stacks so nodes can send each other messages on dedicated cluster channels.", "originalCommit": "6030fba32f7b9bf0236171077b254f43b6539a16", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA1NDQ4Mw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536054483", "bodyText": "The purpose is to provide an abstract, which aids findability. I didn't want to go with a standard phrase that repeats the heading so decided to go for a pretty general statement about the stacks. I'm definitely open to any suggestions to improve!", "author": "oraNod", "createdAt": "2020-12-04T12:09:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA0NjcyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MDQxOA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536090418", "bodyText": "This will not modify the timout alone!\nIt will replace the protocol - so nothing is used from the original settings\nit is exactly this setting which is used\n(for VERIFY_SUSPECT there is not really a setting in defaults but it is worth to mention)", "author": "wfink", "createdAt": "2020-12-04T13:13:46Z", "path": "documentation/src/main/asciidoc/topics/proc_customizing_jgroups_stacks.adoc", "diffHunk": "@@ -0,0 +1,85 @@\n+[id='using_jgroups_inheritance-{context}']\n+= Customizing JGroups Stacks\n+Adjust and tune properties to create a cluster transport configuration that works for your network requirements.\n+\n+{brandname} provides attributes that let you extend the default JGroups stacks for easier configuration.\n+You can inherit properties from the default stacks while combining, removing, and replacing other properties.\n+\n+.Procedure\n+\n+. Create a new JGroups stack declaration in your `infinispan.xml` file.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<infinispan>\n+  <jgroups>\n+    <stack name=\"my-stack\"> <1>\n+    </stack>\n+  </jgroups>\n+</infinispan>\n+----\n++\n+<1> Creates a custom JGroups stack named \"my-stack\".\n++\n+. Add the `extends` attribute and specify a JGroups stack to inherit properties from.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<infinispan>\n+  <jgroups>\n+    <stack name=\"my-stack\" extends=\"tcp\"> <1>\n+    </stack>\n+  </jgroups>\n+</infinispan>\n+----\n++\n+<1> Inherits from the default TCP stack.\n++\n+. Use the `stack.combine` attribute to modify properties for protocols configured in the inherited stack.\n+. Use the `stack.position` attribute to define the location for your custom stack.\n++\n+For example, you might evaluate using a Gossip router and symmetric encryption with the default TCP stack as follows:\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+include::config_examples/config_jgroups_extends.xml[]\n+----\n++\n+<1> Uses the `TCPGOSSIP` protocol as the discovery mechanism instead of `MPING`.\n+<2> Removes the `FD_SOCK` protocol from the stack.\n+<3> Modifies the timeout value for the `VERIFY_SUSPECT` protocol.", "originalCommit": "8f8aa537394c23f8efe5b4f32cdfa7f81a6a13f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE2MjU2MA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536162560", "bodyText": "this is false. it only modifies the timeout.\nyou can verify it by creating a stack like this\n<jgroups>\n\t<stack name=\"my-stack\" extends=\"tcp\">\n\t\t<TCP bind_port=\"8888\" enable_diagnostics=\"true\"/>\n\t</stack>\n</jgroups>\n\nand using probe you can check the TCP attributes and check they didn't change.", "author": "pruivo", "createdAt": "2020-12-04T15:03:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MDQxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MjU4Mw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536092583", "bodyText": "With default tcp or udp configuration which uses multicast. Other settings might not discover nodes automatically.\nAlso the netword need to allow mcast", "author": "wfink", "createdAt": "2020-12-04T13:17:27Z", "path": "documentation/src/main/asciidoc/topics/proc_forming_clusters.adoc", "diffHunk": "@@ -1,25 +1,25 @@\n [id='verify_cluster_discovery-{context}']\n-= Verifying {brandname} Cluster Discovery\n-{brandname} servers running on the same network discover each other with the\n-`MPING` protocol and automatically form clusters. This procedure demonstrates\n-that capability with two locally running {brandname} server instances.\n+= Verifying Cluster Views\n+{brandname} nodes on the same network automatically discover each other and form clusters.", "originalCommit": "8f8aa537394c23f8efe5b4f32cdfa7f81a6a13f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIwNTM5NA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536205394", "bodyText": "well, we do say just after this \"MPING protocol in the default TCP stack\"\nI feel like it's a little overkill to say your network needs to allow this. Documenting the obvious.", "author": "oraNod", "createdAt": "2020-12-04T16:03:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MjU4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEwNTI0OA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536105248", "bodyText": "We should mention that port-offset use in production is not recommended.\nConsider that it might change only the infinispan ports (8.0) and the jgroups bind-port if ${jgroups.bind.port} is used in config (8.1.1) but FD_SOCK port is still random by default!\nSo -o is not always reliable and should be avoided in prod", "author": "wfink", "createdAt": "2020-12-04T13:38:22Z", "path": "documentation/src/main/asciidoc/topics/proc_forming_clusters.adoc", "diffHunk": "@@ -1,25 +1,25 @@\n [id='verify_cluster_discovery-{context}']\n-= Verifying {brandname} Cluster Discovery\n-{brandname} servers running on the same network discover each other with the\n-`MPING` protocol and automatically form clusters. This procedure demonstrates\n-that capability with two locally running {brandname} server instances.\n+= Verifying Cluster Views\n+{brandname} nodes on the same network automatically discover each other and form clusters.\n+\n+Complete this procedure to observe cluster discovery with the `MPING` protocol in the default `TCP` stack with locally running {brandname} Server instances.\n+If you want to adjust cluster transport for custom network requirements, see the documentation for setting up {brandname} clusters.\n \n .Prerequisites\n \n-Start a locally running {brandname} server instance.\n+Have one instance of {brandname} Server running.\n \n .Procedure\n \n-. Create a new {brandname} server instance.\n-.. Open a terminal in `{server_home}`.\n-.. Copy the root directory to `server2`.\n+. Open a terminal in `{server_home}`.\n+. Copy the root directory to `server2`.\n +\n [source,options=\"nowrap\",subs=attributes+]\n ----\n $ cp -r server server2\n ----\n +\n-. Specify a port offset and the location of the `server2` root directory.", "originalCommit": "8f8aa537394c23f8efe5b4f32cdfa7f81a6a13f3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyMTExNQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536121115", "bodyText": "would be a generic ispn-version better ?", "author": "wfink", "createdAt": "2020-12-04T14:03:11Z", "path": "documentation/src/main/asciidoc/topics/proc_using_jgroups_default.adoc", "diffHunk": "@@ -0,0 +1,57 @@\n+[id='jgroups_getting_started-{context}']\n+= Getting Started with Default Stacks\n+{brandname} uses JGroups protocol stacks so nodes can send each other messages on dedicated cluster channels.\n+\n+{brandname} provides preconfigured JGroups stacks for `UDP` and `TCP` protocols.\n+You can use these default stacks as a starting point for building custom cluster transport configuration that is optimized for your network requirements.\n+\n+.Procedure\n+\n+. Locate the default JGroups stacks, `default-jgroups-*.xml`, in the `default-configs` directory inside the `infinispan-core-{ispn_version}.jar` file.", "originalCommit": "8f8aa537394c23f8efe5b4f32cdfa7f81a6a13f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE3NjQ4Mw==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536176483", "bodyText": "This resolves to the actual version when the docs are built. It's tied into the CI stuff.", "author": "oraNod", "createdAt": "2020-12-04T15:22:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyMTExNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyMjYxNg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536122616", "bodyText": "Hint: that will only work if the infinispan.xml contains the transport expression stack=${infinispan.cluster.stack:XXX}", "author": "wfink", "createdAt": "2020-12-04T14:05:31Z", "path": "documentation/src/main/asciidoc/topics/proc_using_jgroups_default.adoc", "diffHunk": "@@ -0,0 +1,57 @@\n+[id='jgroups_getting_started-{context}']\n+= Getting Started with Default Stacks\n+{brandname} uses JGroups protocol stacks so nodes can send each other messages on dedicated cluster channels.\n+\n+{brandname} provides preconfigured JGroups stacks for `UDP` and `TCP` protocols.\n+You can use these default stacks as a starting point for building custom cluster transport configuration that is optimized for your network requirements.\n+\n+.Procedure\n+\n+. Locate the default JGroups stacks, `default-jgroups-*.xml`, in the `default-configs` directory inside the `infinispan-core-{ispn_version}.jar` file.\n+ifdef::server_mode[]\n++\n+The `jar` file is in the `{server_home}/lib` directory.\n++\n+endif::server_mode[]\n+. Do one of the following:\n+\n+* Use the `stack` attribute in your `infinispan.xml` file.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+include::config_examples/config_transport_stack.xml[]\n+----\n+<1> Uses `default-jgroups-udp.xml` for cluster transport.\n+\n+ifdef::embedded_mode[]\n+* Use the `addProperty()` method to set the JGroups stack file:\n++\n+[source,java]\n+----\n+include::code_examples/ConfigureTransportDefault.java[]\n+----\n+<1> Uses the `default-jgroups-udp.xml` stack for cluster transport.\n+endif::embedded_mode[]\n+\n+ifdef::server_mode[]\n+* Use the `cluster-stack` argument when you start the server:\n++\n+[source,options=\"nowrap\",subs=attributes+]\n+----\n+$ bin/server.sh --cluster-stack=udp", "originalCommit": "8f8aa537394c23f8efe5b4f32cdfa7f81a6a13f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE3NzU5Mg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536177592", "bodyText": "Is that correct? I thought --cluster-stack works for any of the default stacks.", "author": "oraNod", "createdAt": "2020-12-04T15:24:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyMjYxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE4MjQ1MQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536182451", "bodyText": "The Bootstrap class will check --cluster-stack and add a property Server.INFINISPAN_CLUSTER_STACK -> infinispan.cluster.stack.\nSo it woll replace the name of the stack udp/tcp or what ever customized stack you have in config when started\nIF and only if the infinispan.xmk include the expression with that name, if you change the expression or remove it it will have no effect!", "author": "wfink", "createdAt": "2020-12-04T15:30:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyMjYxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIwMjc2NQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536202765", "bodyText": "Will address this in separate Jira as discussed.", "author": "oraNod", "createdAt": "2020-12-04T15:59:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyMjYxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyNTYyOQ==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536125629", "bodyText": "TIP  from 12.0 there is a server.sh -P option to collect all the -D stuff\nMaybe there is a better location to mention that ;)", "author": "wfink", "createdAt": "2020-12-04T14:10:11Z", "path": "documentation/src/main/asciidoc/topics/proc_using_jgroups_system_properties.adoc", "diffHunk": "@@ -0,0 +1,30 @@\n+[id='using_jgroups_system_properties-{context}']\n+= Using JGroups System Properties\n+Pass system properties to {brandname} at startup to tune cluster transport.\n+\n+.Procedure\n+\n+* Use `-D<property-name>=<property-value>` arguments to set JGroups system properties as required.\n+\n+For example, set a custom bind port and IP address as follows:\n+\n+ifdef::embedded_mode[]\n+[source,options=\"nowrap\",subs=attributes+]\n+----\n+$ java -cp ... -Djgroups.bind.port=1234 -Djgroups.bind.address=192.0.2.0\n+----\n+\n+[NOTE]\n+====\n+When you embed {brandname} clusters in clustered {wildflybrandname} applications, JGroups system properties can clash or override each other.\n+\n+For example, you do not set a unique bind address for either your {brandname} cluster or your {wildflybrandname} application.\n+In this case both {brandname} and your {wildflybrandname} application use the JGroups default property and attempt to form clusters using the same bind address.\n+====\n+endif::embedded_mode[]\n+ifdef::server_mode[]\n+[source,options=\"nowrap\",subs=attributes+]\n+----\n+$ bin/server.sh -Djgroups.bind.port=1234 -Djgroups.bind.address=192.0.2.0", "originalCommit": "8f8aa537394c23f8efe5b4f32cdfa7f81a6a13f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIwMzAwOA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536203008", "bodyText": "Will address this in separate Jira as discussed.", "author": "oraNod", "createdAt": "2020-12-04T16:00:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyNTYyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyNzAzNg==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536127036", "bodyText": "We should mention that without such attributes the protocol is replaced completely", "author": "wfink", "createdAt": "2020-12-04T14:12:22Z", "path": "documentation/src/main/asciidoc/topics/ref_jgroups_inheritance_attributes.adoc", "diffHunk": "@@ -0,0 +1,34 @@\n+[id='jgroups_inheritance_attributes-{context}']\n+= Inheritance Attributes\n+When you extend a JGroups stack, inheritance attributes let you adjust protocols and properties in the stack you are extending.\n+", "originalCommit": "8f8aa537394c23f8efe5b4f32cdfa7f81a6a13f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE0MDQxMA==", "url": "https://github.com/infinispan/infinispan/pull/8876#discussion_r536140410", "bodyText": "only the changed attributes are overwritten since stack.combine defaults to COMBINE.", "author": "pruivo", "createdAt": "2020-12-04T14:31:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyNzAzNg=="}], "type": "inlineReview"}, {"oid": "2f8b4d1cede7f710cec35bedbf8546d1c8c907b7", "url": "https://github.com/infinispan/infinispan/commit/2f8b4d1cede7f710cec35bedbf8546d1c8c907b7", "message": "ISPN-12448 JGroups documentation revisited", "committedDate": "2020-12-04T16:27:54Z", "type": "commit"}, {"oid": "2f8b4d1cede7f710cec35bedbf8546d1c8c907b7", "url": "https://github.com/infinispan/infinispan/commit/2f8b4d1cede7f710cec35bedbf8546d1c8c907b7", "message": "ISPN-12448 JGroups documentation revisited", "committedDate": "2020-12-04T16:27:54Z", "type": "forcePushed"}]}