{"pr_number": 8590, "pr_title": "ISPN-12160 systemd example to start Infinispan server with systemctl", "pr_createdAt": "2020-07-24T13:55:28Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8590", "timeline": [{"oid": "d95a22472a88c8b93cddc7ea731fa900fe3e1128", "url": "https://github.com/infinispan/infinispan/commit/d95a22472a88c8b93cddc7ea731fa900fe3e1128", "message": "ISPN-12160 systemd example to start Infinispan server with systemctl", "committedDate": "2020-07-24T13:54:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg5NjkwMg==", "url": "https://github.com/infinispan/infinispan/pull/8590#discussion_r462896902", "bodyText": "Maybe it would be clearer to say \"copy this file to /etc/systemd/system\"?", "author": "danberindei", "createdAt": "2020-07-30T10:16:34Z", "path": "server/runtime/src/main/server/bin/service/infinispan.service", "diffHunk": "@@ -0,0 +1,18 @@\n+# script is for /etc/systemd/system", "originalCommit": "d95a22472a88c8b93cddc7ea731fa900fe3e1128", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg5ODA3MA==", "url": "https://github.com/infinispan/infinispan/pull/8590#discussion_r462898070", "bodyText": "I'm not very familiar with how systemd starts user services, would it work if we removed the User=infinispan line and instead copy the service file to /etc/systemd/user/infinispan?", "author": "danberindei", "createdAt": "2020-07-30T10:18:49Z", "path": "server/runtime/src/main/server/bin/service/infinispan.service", "diffHunk": "@@ -0,0 +1,18 @@\n+# script is for /etc/systemd/system\n+# activate with 'systemctl daemon-reload'\n+#               'systemctl start|enable infinispan'\n+\n+[Unit]\n+Description=Infinispan Server Service\n+After=network.target\n+\n+[Service]\n+Environment=\"INFINISPAN_HOME=/opt/infinispan\"\n+#Environment=\"JAVA_HOME=/usr/java/jdk-11.0.8\"\n+ExecStart=/bin/bash -c ${INFINISPAN_HOME}/bin/server.sh\n+Type=simple\n+User=infinispan", "originalCommit": "d95a22472a88c8b93cddc7ea731fa900fe3e1128", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQ0MDM2MA==", "url": "https://github.com/infinispan/infinispan/pull/8590#discussion_r464440360", "bodyText": "Hi @danberindei\nif you use systemd/user (https://wiki.archlinux.org/index.php/Systemd/User) this will start the process with user permission, but ONLY if the user is active.\nFor ISPN this is not what you want, the process should start if the system is up and running (or by manual systemctl ...) with the user permission, but independent from the user activity", "author": "wfink", "createdAt": "2020-08-03T14:13:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjg5ODA3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNTMxMw==", "url": "https://github.com/infinispan/infinispan/pull/8590#discussion_r484505313", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # script is for /etc/systemd/system\n          \n          \n            \n            # This script allows you to run Infinispan Server as a systemd service.\n          \n          \n            \n            # Modify environment properties in this script as appropriate.\n          \n          \n            \n            # Copy this script to the following location: /etc/systemd/system", "author": "oraNod", "createdAt": "2020-09-07T15:59:09Z", "path": "server/runtime/src/main/server/bin/service/infinispan.service", "diffHunk": "@@ -0,0 +1,18 @@\n+# script is for /etc/systemd/system", "originalCommit": "d95a22472a88c8b93cddc7ea731fa900fe3e1128", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "89f1e92e34c1d368d61e55ecd9ab160ae0c45d7d", "url": "https://github.com/infinispan/infinispan/commit/89f1e92e34c1d368d61e55ecd9ab160ae0c45d7d", "message": "Update server/runtime/src/main/server/bin/service/infinispan.service\n\nCo-authored-by: Don Naro <dnaro@redhat.com>", "committedDate": "2020-09-07T17:38:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU0NDA1MA==", "url": "https://github.com/infinispan/infinispan/pull/8590#discussion_r484544050", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            # activate with 'systemctl daemon-reload'\n          \n          \n            \n            # Activate with 'systemctl daemon-reload'", "author": "oraNod", "createdAt": "2020-09-07T18:46:01Z", "path": "server/runtime/src/main/server/bin/service/infinispan.service", "diffHunk": "@@ -0,0 +1,19 @@\n+# This script allows you to run Infinispan Server as a systemd service.\n+# Modify environment properties in this script as appropriate.\n+# Copy this script to the following location: /etc/systemd/system\n+# activate with 'systemctl daemon-reload'", "originalCommit": "89f1e92e34c1d368d61e55ecd9ab160ae0c45d7d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU0NDEwMA==", "url": "https://github.com/infinispan/infinispan/pull/8590#discussion_r484544100", "bodyText": "sorry I missed this one, @wfink", "author": "oraNod", "createdAt": "2020-09-07T18:46:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU0NDA1MA=="}], "type": "inlineReview"}, {"oid": "075e2c078d38b8dfa4c21d07d958b8f50dcafd49", "url": "https://github.com/infinispan/infinispan/commit/075e2c078d38b8dfa4c21d07d958b8f50dcafd49", "message": "Update server/runtime/src/main/server/bin/service/infinispan.service\n\nCo-authored-by: Don Naro <dnaro@redhat.com>", "committedDate": "2020-10-19T19:32:54Z", "type": "commit"}]}