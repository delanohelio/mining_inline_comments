{"pr_number": 7730, "pr_title": "ISPN-10835 Cross-Site Replication Docs", "pr_createdAt": "2020-01-13T11:31:54Z", "pr_url": "https://github.com/infinispan/infinispan/pull/7730", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgxMzUwOQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365813509", "bodyText": "wrong example.\nShould be take-offline and the site is NYC", "author": "pruivo", "createdAt": "2020-01-13T13:51:15Z", "path": "documentation/src/main/asciidoc/topics/proc_cli_xsite_backups.adoc", "diffHunk": "@@ -0,0 +1,28 @@\n+[id='cli_xsite_backups-{context}']\n+= Managing Backup Locations\n+Retrieve the status of backup locations and bring them offline and online.\n+\n+.Procedure\n+\n+Use the `site` command to manage remote sites that you add as backup locations,\n+as in the following examples:\n+\n+* Retrieve the status of backup locations:\n++\n+----\n+//containers/default]> site status -s LON\n+----\n+\n+* Bring backup locations online:\n++\n+----\n+//containers/default]> site bring-online --cache=customers --site=NYC\n+----\n+\n+* Take backup locations offline:\n++\n+----\n+//containers/default]> site bring-online --cache=customers --site=LON", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgxNjgyNQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365816825", "bodyText": "the default TCP may not work in all environments. Suggestion:\nSet the default-stack with the stack to be used between the brandname clusters so they can discover and communicate between each other. In this example, we use the default TCP stack.", "author": "pruivo", "createdAt": "2020-01-13T13:57:56Z", "path": "documentation/src/main/asciidoc/topics/proc_xsite_configuring_jgroups.adoc", "diffHunk": "@@ -0,0 +1,73 @@\n+[id='configure_relay-{context}']\n+= Configuring Cluster Transport for Cross-Site Replication\n+Add JGroups RELAY2 to your transport layer so that {brandname} clusters can\n+communicate across sites.\n+\n+This procedure explains how to add a RELAY2 stack definition to\n+`infinispan.xml` and configure {brandname} cluster transport.\n+\n+.Procedure\n+\n+. Add a stack definition named \"xsite\" that extends the default JGroups UDP stack.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+   </stack>\n+</jgroups>\n+----\n++\n+. Add `RELAY2` to the stack and the local site name.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"/>\n+   </stack>\n+</jgroups>\n+----\n++\n+. Create a global cluster that includes all site names.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"/>\n+      <remote-sites>\n+         <remote-site name=\"LON\"/>\n+         <remote-site name=\"NYC\"/>\n+      </remote-sites>\n+   </stack>\n+</jgroups>\n+----\n++\n+. Add the `default-stack` attribute and use the default JGroups TCP stack so {brandname} clusters can discover each other and communicate across the cluster.", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgxNzQ2Nw==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365817467", "bodyText": "Use TCPPING instead of LOCAL_PING?", "author": "pruivo", "createdAt": "2020-01-13T13:59:20Z", "path": "documentation/src/main/asciidoc/topics/ref_xsite_jgroups_relay.adoc", "diffHunk": "@@ -0,0 +1,108 @@\n+[id='ref_relay-{context}']\n+= JGroups RELAY2 Examples\n+\n+.Inline Stack File\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"/>\n+      <remote-sites default-stack=\"tcp\">\n+         <remote-site name=\"LON\"/>\n+         <remote-site name=\"NYC\"/>\n+      </remote-sites>\n+   </stack>\n+</jgroups>\n+----\n+\n+.Separate Stack File\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack-file name='relay-global' path='jgroups-relay.xml'/>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"\n+      max_site_masters='10'\n+      can_become_site_master='true'/>\n+      <remote-sites default-stack=\"relay-global\">\n+         <remote-site name=\"LON\"/>\n+         <remote-site name=\"NYC\"/>\n+      </remote-sites>\n+   </stack>\n+</jgroups>\n+----\n+\n+.`jgroups-relay.xml`\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<config xmlns=\"urn:org:jgroups\"\n+      xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+      xsi:schemaLocation=\"urn:org:jgroups http://www.jgroups.org/schema/jgroups-4.1.xsd\">\n+\n+    <TCP bind_addr=\"127.0.0.1\"\n+         bind_port=\"7200\"\n+         port_range=\"30\"\n+         recv_buf_size=\"20000000\"\n+         send_buf_size=\"640000\"\n+         sock_conn_timeout=\"300\"\n+         enable_diagnostics=\"false\"\n+         bundler_type=\"no-bundler\"\n+\n+         thread_pool.min_threads=\"0\"\n+         thread_pool.max_threads=\"8\"\n+         thread_pool.keep_alive_time=\"5000\"\n+    />\n+\n+    <!--TCPPING timeout=\"3000\"\n+             initial_hosts=\"127.0.0.1[7200]\"\n+             port_range=\"3\"\n+             ergonomics=\"false\"\n+            /-->\n+    <LOCAL_PING/>", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgxNzU2Mg==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365817562", "bodyText": "remove unused protocols?", "author": "pruivo", "createdAt": "2020-01-13T13:59:31Z", "path": "documentation/src/main/asciidoc/topics/ref_xsite_jgroups_relay.adoc", "diffHunk": "@@ -0,0 +1,108 @@\n+[id='ref_relay-{context}']\n+= JGroups RELAY2 Examples\n+\n+.Inline Stack File\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"/>\n+      <remote-sites default-stack=\"tcp\">\n+         <remote-site name=\"LON\"/>\n+         <remote-site name=\"NYC\"/>\n+      </remote-sites>\n+   </stack>\n+</jgroups>\n+----\n+\n+.Separate Stack File\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack-file name='relay-global' path='jgroups-relay.xml'/>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"\n+      max_site_masters='10'\n+      can_become_site_master='true'/>\n+      <remote-sites default-stack=\"relay-global\">\n+         <remote-site name=\"LON\"/>\n+         <remote-site name=\"NYC\"/>\n+      </remote-sites>\n+   </stack>\n+</jgroups>\n+----\n+\n+.`jgroups-relay.xml`\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<config xmlns=\"urn:org:jgroups\"\n+      xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+      xsi:schemaLocation=\"urn:org:jgroups http://www.jgroups.org/schema/jgroups-4.1.xsd\">\n+\n+    <TCP bind_addr=\"127.0.0.1\"\n+         bind_port=\"7200\"\n+         port_range=\"30\"\n+         recv_buf_size=\"20000000\"\n+         send_buf_size=\"640000\"\n+         sock_conn_timeout=\"300\"\n+         enable_diagnostics=\"false\"\n+         bundler_type=\"no-bundler\"\n+\n+         thread_pool.min_threads=\"0\"\n+         thread_pool.max_threads=\"8\"\n+         thread_pool.keep_alive_time=\"5000\"\n+    />\n+\n+    <!--TCPPING timeout=\"3000\"\n+             initial_hosts=\"127.0.0.1[7200]\"\n+             port_range=\"3\"\n+             ergonomics=\"false\"\n+            /-->\n+    <LOCAL_PING/>\n+\n+\n+    <!--<MPING timeout=\"1000\"-->", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgxOTU0MQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365819541", "bodyText": "it is missing the NYC server list.", "author": "pruivo", "createdAt": "2020-01-13T14:03:39Z", "path": "documentation/src/main/asciidoc/topics/proc_xsite_configuring_clients.adoc", "diffHunk": "@@ -0,0 +1,39 @@\n+[id='configure_clients-{context}']\n+= Configuring Hot Rod Clients for Cross-Site Replication\n+Configure Hot Rod clients to use {brandname} clusters at different sites.\n+\n+.`hotrod-client.properties`\n+\n+[source,options=\"nowrap\",subs=attributes+]\n+----\n+# Servers at the active site\n+infinispan.client.hotrod.server_list = LON_host1:11222,LON_host2:11222,LON_host3:11222\n+\n+# Servers at the backup site\n+infinispan.client.hotrod.cluster.NYC = NYC_hostA:11222,NYC_hostB:11222,NYC_hostC:11222,NYC_hostD:11222\n+----\n+\n+.`ConfigurationBuilder`\n+\n+[source,java,options=\"nowrap\",subs=attributes+]\n+----\n+ConfigurationBuilder builder = new ConfigurationBuilder();\n+builder.addServers(LON_host1:11222,LON_host2:11222,LON_host3:11222)\n+       .addCluster\u200b()", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMTMxNA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365821314", "bodyText": "this is incorrect (even the old docs). It should be:\nAll nodes in the local site see the remote site online (or similar)\nIt needs to be fixed for offline and mixed.\nFor mixed:\nSome nodes in the local site see the remote site online and other see the remote site offline.", "author": "pruivo", "createdAt": "2020-01-13T14:07:08Z", "path": "documentation/src/main/asciidoc/topics/ref_rest_xsite.adoc", "diffHunk": "@@ -24,26 +24,26 @@ the following example:\n |Value |Description\n \n |`online`\n-|All nodes in the backup site are online\n+| All nodes in the backup location are online.", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMjgyMA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365822820", "bodyText": "same as above. this is how the local caches see the remote site.\nCACHE_1 sees NYC-2 online (i.e. is able to send the updates) but CACHE_2 isn't.", "author": "pruivo", "createdAt": "2020-01-13T14:10:17Z", "path": "documentation/src/main/asciidoc/topics/ref_rest_xsite_cache_managers.adoc", "diffHunk": "@@ -15,39 +15,42 @@ GET /rest/v2/cache-managers/{cacheManagerName}/x-site/backups/\n include::json_examples/xsite_backup_status.json[]\n ----\n \n-The `status` field has the following values:\n+.Returned Status\n \n-* `online`: all caches are online in the backup site.\n-* `offline`: all caches are offline in the backup site.\n-* `mixed`: some caches are online and others offline, and their names will be listed in the `online` and `offline` arrays respectively.\n+|===\n+|Value |Description\n \n+|`online`\n+| All caches in the backup location are online.", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyNDA1MQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365824051", "bodyText": "isn't the CUSTOM failure policy missing?", "author": "pruivo", "createdAt": "2020-01-13T14:12:34Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_backup_strategies.adoc", "diffHunk": "@@ -0,0 +1,34 @@\n+[id='xsite_backups-{context}']\n+= Backup Strategies\n+{brandname} clusters can use different strategies for backing up data to remote sites.\n+\n+{brandname} replicates across sites at the same time that writes to local caches occur. For example, if a client writes \"k1\" to **LON**, {brandname} backs up \"k1\" to **NYC** at the same time.\n+\n+.Synchronous backups\n+When {brandname} applies changes to the remote site, it waits until the operation completes.\n+\n+The synchronous strategy lets you define policies that control how {brandname} handles writes if backup operations fail.\n+\n+.{brandname} failure policies\n+|===\n+| Policy | If backup operations fail...\n+\n+| `IGNORE`\n+| {brandname} ignores exceptions and writes to the local cache.\n+\n+| `WARN`\n+| {brandname} logs exceptions and writes to the local cache. This is the default failure policy.\n+\n+| `FAIL`\n+| {brandname} throws exceptions and aborts writes to the local cache.\n+|===", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk3OTM2Mw==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365979363", "bodyText": "@pruivo I didn't add CUSTOM here on purpose. it's in the schema so users can figure it out there. in the docs I mention only the Infinispan failure policies. I guess we could mention the fact that you can implement custom failure policies but it seems a bit like overkill imho. we shouldn't try to get absolutely everything in the docs.", "author": "oraNod", "createdAt": "2020-01-13T19:16:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyNDA1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyNDQwOA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365824408", "bodyText": "if it can to abort :)", "author": "pruivo", "createdAt": "2020-01-13T14:13:13Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_backup_strategies.adoc", "diffHunk": "@@ -0,0 +1,34 @@\n+[id='xsite_backups-{context}']\n+= Backup Strategies\n+{brandname} clusters can use different strategies for backing up data to remote sites.\n+\n+{brandname} replicates across sites at the same time that writes to local caches occur. For example, if a client writes \"k1\" to **LON**, {brandname} backs up \"k1\" to **NYC** at the same time.\n+\n+.Synchronous backups\n+When {brandname} applies changes to the remote site, it waits until the operation completes.\n+\n+The synchronous strategy lets you define policies that control how {brandname} handles writes if backup operations fail.\n+\n+.{brandname} failure policies\n+|===\n+| Policy | If backup operations fail...\n+\n+| `IGNORE`\n+| {brandname} ignores exceptions and writes to the local cache.\n+\n+| `WARN`\n+| {brandname} logs exceptions and writes to the local cache. This is the default failure policy.\n+\n+| `FAIL`\n+| {brandname} throws exceptions and aborts writes to the local cache.", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk3ODUzMg==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365978532", "bodyText": "{brandname} throws exceptions and attempts to abort writes to the local cache. In some cases, local writes still succeed if the backup writes fail.", "author": "oraNod", "createdAt": "2020-01-13T19:14:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyNDQwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyNTA3NA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365825074", "bodyText": "no config example?", "author": "pruivo", "createdAt": "2020-01-13T14:14:28Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_auto_offline.adoc", "diffHunk": "@@ -0,0 +1,13 @@\n+[id='xsite_auto_offline-{context}']\n+= Automatically Taking Sites Offline\n+Both synchronous and asynchronous strategies let you specify a timeout, in\n+milliseconds, for backup operations. When backup operations reach the timeout, they fail.\n+\n+You can additionally configure the number of consecutive failures for backup operations after which sites go offline.\n+\n+For example, you configure **NYC** as a backup for **LON** and specify five as the number of failures after which **NYC** goes offline. If **LON** attempts six backup operations that fail, {brandname} automatically takes **NYC** offline. **LON** stops backing up to **NYC** until you bring the site back online.", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyNjg0Ng==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r365826846", "bodyText": "I guess you should say: brandname does not delete data.\nThere is another example that may useful. If k2 exists in LON and NYC, and k2 is removed in NYC while LON is offline, the state transfer doesn't delete it.\nAlso, it may be useful to suggest to clear the cache in LON before pushing the state from NYC => LON", "author": "pruivo", "createdAt": "2020-01-13T14:17:59Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_state_transfer.adoc", "diffHunk": "@@ -0,0 +1,29 @@\n+[id='xsite_state_transfer-{context}']\n+= State Transfer\n+State transfer is an administrative operation that synchronizes data between\n+sites.\n+\n+For example, **LON** goes offline and **NYC** starts handling client requests.\n+When you bring **LON** back online, the {brandname} cluster in **LON** does not\n+have the same data as the cluster in **NYC**.\n+\n+To ensure the data is consistent between **LON** and **NYC**, you can push\n+state from **NYC** to **LON**.\n+\n+* State transfer is bidirectional. For example, you can push state from **NYC**\n+to **LON** or from **LON** to **NYC**.\n+* Pushing state to offline sites brings them back online.\n+* State transfer overwrites only data that exists on both sites, the originating site and the receiving site.\n++\n+For example, \"k1\" exists on **LON** and **NYC**. \"k2\" exists on **LON** only.\n+If you push state from **NYC** to **LON**, the transfer does not affect \"k2\" on\n+**LON**. {brandname} does not delete or overwrite \"k2\".", "originalCommit": "e89608d9d77a9476d279db8b079e6da6ba7ad187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3dc827335f47d03f9f0edd59de0e42c111e8b62d", "url": "https://github.com/infinispan/infinispan/commit/3dc827335f47d03f9f0edd59de0e42c111e8b62d", "message": "review feedback and schema updates", "committedDate": "2020-01-14T19:39:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUzOTQ3Ng==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r366539476", "bodyText": "@pruivo and @belaban here we have two protocols. <stack ... extends=\"udp\"> and <remote-sites default-stack=\"tcp\">\ncan you please explain how UDP is used here? the default JGroups TCP is used for RELAY2, right?", "author": "oraNod", "createdAt": "2020-01-14T19:49:23Z", "path": "documentation/src/main/asciidoc/topics/proc_xsite_configuring_jgroups.adoc", "diffHunk": "@@ -0,0 +1,73 @@\n+[id='configure_relay-{context}']\n+= Configuring Cluster Transport for Cross-Site Replication\n+Add JGroups RELAY2 to your transport layer so that {brandname} clusters can\n+communicate across sites.\n+\n+This procedure explains how to add a RELAY2 stack definition to\n+`infinispan.xml` and configure {brandname} cluster transport.\n+\n+.Procedure\n+\n+. Add a stack definition named \"xsite\" that extends the default JGroups UDP stack.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+   </stack>\n+</jgroups>\n+----\n++\n+. Add `RELAY2` to the stack and the local site name.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"/>\n+   </stack>\n+</jgroups>\n+----\n++\n+. Create a global cluster that includes all site names.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"/>\n+      <remote-sites>\n+         <remote-site name=\"LON\"/>\n+         <remote-site name=\"NYC\"/>\n+      </remote-sites>\n+   </stack>\n+</jgroups>\n+----\n++\n+. Add the `default-stack` attribute and specify the JGroups stack that {brandname} clusters use to discover each other and communicate across the cluster. The following example uses the default JGroups stack.\n++\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"/>\n+      <remote-sites default-stack=\"tcp\">", "originalCommit": "3dc827335f47d03f9f0edd59de0e42c111e8b62d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjU3MTU1MA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r366571550", "bodyText": "it is just reading the UDP stack and adding the RELAY2 protocol.\nSo, the intra-cluster communication will use UDP + RELAY2\nThe site masters will use the TCP stack to communicate between them", "author": "pruivo", "createdAt": "2020-01-14T21:05:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUzOTQ3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjgwODIzNw==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r366808237", "bodyText": "thanks a mill @pruivo", "author": "oraNod", "createdAt": "2020-01-15T10:45:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUzOTQ3Ng=="}], "type": "inlineReview"}, {"oid": "2e0360e9ade099fa2e31d51fa843120f79009734", "url": "https://github.com/infinispan/infinispan/commit/2e0360e9ade099fa2e31d51fa843120f79009734", "message": "review feedback and schema updates", "committedDate": "2020-01-15T17:18:00Z", "type": "forcePushed"}, {"oid": "506e318811e37a424e0610004bc346109062e8cd", "url": "https://github.com/infinispan/infinispan/commit/506e318811e37a424e0610004bc346109062e8cd", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-01-15T17:21:02Z", "type": "forcePushed"}, {"oid": "63347ac4a3bd1f67b291f37d8b20a764682bf68e", "url": "https://github.com/infinispan/infinispan/commit/63347ac4a3bd1f67b291f37d8b20a764682bf68e", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-01-16T12:57:58Z", "type": "forcePushed"}, {"oid": "5c2334268913d5136703277745cc2ecc81f620b5", "url": "https://github.com/infinispan/infinispan/commit/5c2334268913d5136703277745cc2ecc81f620b5", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-01-16T13:09:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQxMzM5MQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r367413391", "bodyText": "@gustavonalle heads up on doc changes to rest xsite. this includes the changes for getting state transfer status. please let me know if any changes are needed. cheers.", "author": "oraNod", "createdAt": "2020-01-16T13:23:12Z", "path": "documentation/src/main/asciidoc/topics/ref_rest_xsite.adoc", "diffHunk": "@@ -1,14 +1,13 @@\n [id='rest_v2_xsite_sites_status']", "originalCommit": "5c2334268913d5136703277745cc2ecc81f620b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQxNDM5OA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r367414398", "bodyText": "@tristantarrant hi, this PR adds two topics to CLI docs for xsite with examples for bringing sites online/offline and state transfer. could you please take a look? thx.", "author": "oraNod", "createdAt": "2020-01-16T13:25:18Z", "path": "documentation/src/main/asciidoc/topics/proc_cli_xsite_push.adoc", "diffHunk": "@@ -0,0 +1,13 @@\n+[id='cli_xsite_push-{context}']", "originalCommit": "5c2334268913d5136703277745cc2ecc81f620b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2a8349a0d6831cc90edbd9fee692052f149fcd48", "url": "https://github.com/infinispan/infinispan/commit/2a8349a0d6831cc90edbd9fee692052f149fcd48", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-01-16T18:07:22Z", "type": "forcePushed"}, {"oid": "50b3b463407f6be53e097109011ea0586acc0ebd", "url": "https://github.com/infinispan/infinispan/commit/50b3b463407f6be53e097109011ea0586acc0ebd", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-01-27T11:18:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg5Njk0OQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r371896949", "bodyText": "this needs to be updated :(\n\nThe option -s is unknown.\nOption: --cache is required for this command.\n\nusage example:\n site status --cache=___script_cache --site=NYC\n--site is optional. if not set, it will print all backups configured.", "author": "pruivo", "createdAt": "2020-01-28T16:04:21Z", "path": "documentation/src/main/asciidoc/topics/proc_cli_xsite_sites.adoc", "diffHunk": "@@ -0,0 +1,25 @@\n+[id='manage_sites-{context}']\n+= Bringing Sites Offline and Online\n+Take sites offline manually and bring sites back online.\n+\n+.Procedure\n+\n+* Check if sites are online or offline with the `site status` command:\n++\n+----\n+//containers/default]> site status -s LON", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY1OTE4NA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373659184", "bodyText": "thanks, I think the -s option was an older one that got stuck in there. --site isn't always optional from what I can tell, right? in the case of site status it is optional. but in the case of site cancel-receive-state you need to provide the remote site. isn't that so?", "author": "oraNod", "createdAt": "2020-01-31T19:57:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg5Njk0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg5NzkyNw==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r371897927", "bodyText": "--cache is missing.\n[pedro-laptop-3-34986@cluster//containers/default]> site push-site-state --site NYC\nOption: --cache is required for this command.", "author": "pruivo", "createdAt": "2020-01-28T16:05:49Z", "path": "documentation/src/main/asciidoc/topics/proc_cli_xsite_push.adoc", "diffHunk": "@@ -0,0 +1,13 @@\n+[id='cli_xsite_push-{context}']\n+= Pushing State to Remote Sites\n+Transfer cache state to backup locations.\n+\n+.Procedure\n+\n+* Use the `site` command to push state transfer, as in the following example:\n++\n+----\n+//containers/default]> site push-site-state --site=NYC", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY1OTMzOA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373659338", "bodyText": "thanks. I've made this change.", "author": "oraNod", "createdAt": "2020-01-31T19:57:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg5NzkyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg5ODc2OQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r371898769", "bodyText": "the help message (returned by help site) needs to be updated as well.", "author": "pruivo", "createdAt": "2020-01-28T16:07:07Z", "path": "documentation/src/main/asciidoc/topics/proc_cli_xsite_sites.adoc", "diffHunk": "@@ -0,0 +1,25 @@\n+[id='manage_sites-{context}']\n+= Bringing Sites Offline and Online\n+Take sites offline manually and bring sites back online.\n+\n+.Procedure\n+\n+* Check if sites are online or offline with the `site status` command:\n++\n+----\n+//containers/default]> site status -s LON\n+----\n+\n+* Bring sites online with the `bring-online` command:\n++\n+----\n+//containers/default]> site bring-online --cache=customers --site=NYC\n+----\n+\n+* Take sites offline with the `take-offline` command:\n++\n+----\n+//containers/default]> site take-offline --cache=customers --site=NYC\n+----\n+\n+For more information and examples, run the `help site` command.", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY1OTU2Ng==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373659566", "bodyText": "I've updated the help resources for the site command.", "author": "oraNod", "createdAt": "2020-01-31T19:57:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTg5ODc2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkwNTM2NQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r371905365", "bodyText": "is this link supposed to be here? is this file only for the community?", "author": "pruivo", "createdAt": "2020-01-28T16:17:17Z", "path": "documentation/src/main/asciidoc/topics/attributes/community-attributes.adoc", "diffHunk": "@@ -23,6 +23,28 @@ include::transaction-attributes.adoc[]\n //Doc Home\n :doc_home: https://infinispan.org/documentation/\n \n+//\n+// Doc Links\n+//\n+\n+//Dev\n+:dev_docs: https://access.redhat.com/documentation/en-us/red_hat_data_grid/", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY1OTY0Nw==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373659647", "bodyText": "good catch. fixed.", "author": "oraNod", "createdAt": "2020-01-31T19:58:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkwNTM2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkwOTM5NQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r371909395", "bodyText": "don't use the word metadata here since the user can put metadata with the value.\nyou can say \"uses versioning to detect conflicting updates\" or something similar.", "author": "pruivo", "createdAt": "2020-01-28T16:23:24Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_concurrent_writes.adoc", "diffHunk": "@@ -0,0 +1,24 @@\n+[id='conflicts-{context}']\n+= Conflict Resolution with Cross-Site Replication\n+Conflicting entries can occur with Active/Active site configurations if clients\n+write to the same entries at the same time but at different sites.\n+\n+For example, client A writes to \"k1\" in **LON** at the same time that client B\n+writes to \"k1\" in **NYC**. In this case, \"k1\" has a different value in **LON**\n+than in **NYC**. After replication occurs, there is no guarantee which value\n+for \"k1\" exists at which site.\n+\n+{brandname} uses the metadata of each key to detect conflicts during a backup.", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2MTIzMg==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373661232", "bodyText": "ah, ok. I didn't want to be too specific and say \"vector clock\" but I've updated. hope the changes are fine.", "author": "oraNod", "createdAt": "2020-01-31T20:02:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkwOTM5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkwOTczNg==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r371909736", "bodyText": "this isn't implemented yet. :)", "author": "pruivo", "createdAt": "2020-01-28T16:23:54Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_concurrent_writes.adoc", "diffHunk": "@@ -0,0 +1,24 @@\n+[id='conflicts-{context}']\n+= Conflict Resolution with Cross-Site Replication", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2MTY4MQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373661681", "bodyText": "no, these docs might be a bit ahead of what's currently available but I've got a separate PR for 10.x - I want to update docs in this PR for the irac work.", "author": "oraNod", "createdAt": "2020-01-31T20:03:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkwOTczNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3MTU2MQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372271561", "bodyText": "this is incorrect.\nthe min-wait is the amount of time to wait before taking the site offline. When the first failure happens, it waits this time before taking the site offline. If a successful request happens, the timer is canceled.", "author": "pruivo", "createdAt": "2020-01-29T09:28:35Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_auto_offline.adoc", "diffHunk": "@@ -0,0 +1,53 @@\n+[id='xsite_auto_offline-{context}']\n+= Taking Sites Offline Automatically\n+Backup configurations include timeout values for operations to replicate\n+data to remote sites. When backup operations reach the timeout, {brandname}\n+records the operation as a failure.\n+\n+To automatically take sites offline, you can then configure the\n+number of **consecutive** failures that can occur.\n+\n+For example, the **NYC** backup configuration specifies five as the number of\n+failures after which **NYC** goes offline. If **LON** attempts five consecutive\n+backup operations that fail, {brandname} automatically takes **NYC** offline.\n+**LON** then stops backing up to **NYC** until you bring the site back online.\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<backup site=\"NYC\" strategy=\"ASYNC\">\n+\t<take-offline after-failures=\"5\"/>\n+</backup>\n+----\n+\n+You can also specify a minimum wait time for backup operations to complete", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2MTc2Mg==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373661762", "bodyText": "fixed. thanks for clarifying this.", "author": "oraNod", "createdAt": "2020-01-31T20:03:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3MTU2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3MTkxMQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372271911", "bodyText": "not if backup operations take longer than 10 seconds but rather there is no successful request in these 10 seconds.", "author": "pruivo", "createdAt": "2020-01-29T09:29:13Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_auto_offline.adoc", "diffHunk": "@@ -0,0 +1,53 @@\n+[id='xsite_auto_offline-{context}']\n+= Taking Sites Offline Automatically\n+Backup configurations include timeout values for operations to replicate\n+data to remote sites. When backup operations reach the timeout, {brandname}\n+records the operation as a failure.\n+\n+To automatically take sites offline, you can then configure the\n+number of **consecutive** failures that can occur.\n+\n+For example, the **NYC** backup configuration specifies five as the number of\n+failures after which **NYC** goes offline. If **LON** attempts five consecutive\n+backup operations that fail, {brandname} automatically takes **NYC** offline.\n+**LON** then stops backing up to **NYC** until you bring the site back online.\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<backup site=\"NYC\" strategy=\"ASYNC\">\n+\t<take-offline after-failures=\"5\"/>\n+</backup>\n+----\n+\n+You can also specify a minimum wait time for backup operations to complete\n+before sites go offline, for example:\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<backup site=\"NYC\" strategy=\"ASYNC\">\n+\t<take-offline after-failures=\"5\"\n+                min-wait=\"10000\"/>\n+</backup>\n+----\n+\n+In the preceding example, **NYC** goes offline if backup operations take longer than 10 seconds and failures occur for 5 consecutive operations.", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2MTg1MA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373661850", "bodyText": "also fixed. thanks again.", "author": "oraNod", "createdAt": "2020-01-31T20:03:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3MTkxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3MjE3Mg==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372272172", "bodyText": "negative or zero.", "author": "pruivo", "createdAt": "2020-01-29T09:29:43Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_auto_offline.adoc", "diffHunk": "@@ -0,0 +1,53 @@\n+[id='xsite_auto_offline-{context}']\n+= Taking Sites Offline Automatically\n+Backup configurations include timeout values for operations to replicate\n+data to remote sites. When backup operations reach the timeout, {brandname}\n+records the operation as a failure.\n+\n+To automatically take sites offline, you can then configure the\n+number of **consecutive** failures that can occur.\n+\n+For example, the **NYC** backup configuration specifies five as the number of\n+failures after which **NYC** goes offline. If **LON** attempts five consecutive\n+backup operations that fail, {brandname} automatically takes **NYC** offline.\n+**LON** then stops backing up to **NYC** until you bring the site back online.\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<backup site=\"NYC\" strategy=\"ASYNC\">\n+\t<take-offline after-failures=\"5\"/>\n+</backup>\n+----\n+\n+You can also specify a minimum wait time for backup operations to complete\n+before sites go offline, for example:\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<backup site=\"NYC\" strategy=\"ASYNC\">\n+\t<take-offline after-failures=\"5\"\n+                min-wait=\"10000\"/>\n+</backup>\n+----\n+\n+In the preceding example, **NYC** goes offline if backup operations take longer than 10 seconds and failures occur for 5 consecutive operations.\n+\n+To use only a minimum wait time for automatically taking locations offline, set a negative value for the `after-failures` attribute; for example:", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2MTk5Nw==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373661997", "bodyText": "ack", "author": "oraNod", "createdAt": "2020-01-31T20:04:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3MjE3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3NDA5OQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372274099", "bodyText": "maybe remove the reference to RELAY2 and keep it simple:\nSite masters are the nodes responsible to send and receive requests from backup locations.\nIf a node isn't a SiteMaster and needs to send a request to a backup location, it needs to find a SiteMaster in the local cluster to forward the request.", "author": "pruivo", "createdAt": "2020-01-29T09:33:39Z", "path": "documentation/src/main/asciidoc/topics/con_xsite_site_masters.adoc", "diffHunk": "@@ -0,0 +1,11 @@\n+[id='xsite_masters-{context}']\n+= Site Masters\n+Site masters are nodes in {brandname} clusters that use the JGroups RELAY2", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2MjEyMg==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373662122", "bodyText": "sounds good. thanks.", "author": "oraNod", "createdAt": "2020-01-31T20:04:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3NDA5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3ODU1NA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372278554", "bodyText": "this is wrong. Should be:\n.addCluster(\"NYC\").addClusterNodes(\"NYC_hostA:11222;NYC_hostB:11222;NYC_hostC:11222;NYC_hostD:11222\")\n\nor\n.addCluster(\"NYC\")\n.addClusterNode(NYC_hostA, 11222)\n.addClusterNode(...)\n...", "author": "pruivo", "createdAt": "2020-01-29T09:42:34Z", "path": "documentation/src/main/asciidoc/topics/proc_xsite_configuring_clients.adoc", "diffHunk": "@@ -0,0 +1,39 @@\n+[id='configure_clients-{context}']\n+= Configuring Hot Rod Clients for Cross-Site Replication\n+Configure Hot Rod clients to use {brandname} clusters at different sites.\n+\n+.`hotrod-client.properties`\n+\n+[source,options=\"nowrap\",subs=attributes+]\n+----\n+# Servers at the active site\n+infinispan.client.hotrod.server_list = LON_host1:11222,LON_host2:11222,LON_host3:11222\n+\n+# Servers at the backup site\n+infinispan.client.hotrod.cluster.NYC = NYC_hostA:11222,NYC_hostB:11222,NYC_hostC:11222,NYC_hostD:11222\n+----\n+\n+.`ConfigurationBuilder`\n+\n+[source,java,options=\"nowrap\",subs=attributes+]\n+----\n+ConfigurationBuilder builder = new ConfigurationBuilder();\n+builder.addServers(LON_host1:11222,LON_host2:11222,LON_host3:11222)\n+       .addCluster\u200b(NYC_hostA:11222,NYC_hostB:11222,NYC_hostC:11222,NYC_hostD:11222)", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2MjMyOQ==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373662329", "bodyText": "fixed. cheers for spotting this.", "author": "oraNod", "createdAt": "2020-01-31T20:04:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3ODU1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI3OTI0NA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372279244", "bodyText": "addServers(String) method accepts a string with multiple host:port separated by ;", "author": "pruivo", "createdAt": "2020-01-29T09:43:58Z", "path": "documentation/src/main/asciidoc/topics/proc_xsite_configuring_clients.adoc", "diffHunk": "@@ -0,0 +1,39 @@\n+[id='configure_clients-{context}']\n+= Configuring Hot Rod Clients for Cross-Site Replication\n+Configure Hot Rod clients to use {brandname} clusters at different sites.\n+\n+.`hotrod-client.properties`\n+\n+[source,options=\"nowrap\",subs=attributes+]\n+----\n+# Servers at the active site\n+infinispan.client.hotrod.server_list = LON_host1:11222,LON_host2:11222,LON_host3:11222\n+\n+# Servers at the backup site\n+infinispan.client.hotrod.cluster.NYC = NYC_hostA:11222,NYC_hostB:11222,NYC_hostC:11222,NYC_hostD:11222\n+----\n+\n+.`ConfigurationBuilder`\n+\n+[source,java,options=\"nowrap\",subs=attributes+]\n+----\n+ConfigurationBuilder builder = new ConfigurationBuilder();\n+builder.addServers(LON_host1:11222,LON_host2:11222,LON_host3:11222)", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI4MDMxNg==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372280316", "bodyText": "<2> is in the wrong line. should be above.\nAlso, I'm not sure if single-quote ' are allowed in the xml...", "author": "pruivo", "createdAt": "2020-01-29T09:46:06Z", "path": "documentation/src/main/asciidoc/topics/ref_xsite_jgroups_relay_custom.adoc", "diffHunk": "@@ -0,0 +1,34 @@\n+[id='ref_relay_custom-{context}']\n+= Custom JGroups RELAY2 Stacks\n+\n+[source,xml,options=\"nowrap\",subs=attributes+]\n+----\n+<jgroups>\n+   <stack-file name='relay-global' path='jgroups-relay.xml'/> <1>\n+   <stack name=\"xsite\" extends=\"udp\">\n+      <relay.RELAY2 site=\"LON\" xmlns=\"urn:org:jgroups\"\n+                    max_site_masters='10'\n+                    can_become_site_master='true'/> <2>", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2MjU5Mw==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r373662593", "bodyText": "nice catch. thanks.", "author": "oraNod", "createdAt": "2020-01-31T20:05:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI4MDMxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI4MTI4Nw==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372281287", "bodyText": "we talk about backup locations but here it says Sites :)", "author": "pruivo", "createdAt": "2020-01-29T09:47:54Z", "path": "documentation/src/main/asciidoc/topics/ref_rest_xsite.adoc", "diffHunk": "@@ -1,14 +1,13 @@\n [id='rest_v2_xsite_sites_status']\n-= Getting Status of All Backup Sites\n-Retrieve the status of all backup sites with `GET` requests.\n+= Getting Status of All Sites", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI4MTQzMA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372281430", "bodyText": "backups location instead of remote sites?", "author": "pruivo", "createdAt": "2020-01-29T09:48:11Z", "path": "documentation/src/main/asciidoc/topics/ref_rest_xsite.adoc", "diffHunk": "@@ -1,14 +1,13 @@\n [id='rest_v2_xsite_sites_status']\n-= Getting Status of All Backup Sites\n-Retrieve the status of all backup sites with `GET` requests.\n+= Getting Status of All Sites\n+Retrieve the status of all remote sites with `GET` requests.", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI4MTY2MA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372281660", "bodyText": "backup location instead of site?", "author": "pruivo", "createdAt": "2020-01-29T09:48:38Z", "path": "documentation/src/main/asciidoc/topics/ref_rest_xsite.adoc", "diffHunk": "@@ -1,14 +1,13 @@\n [id='rest_v2_xsite_sites_status']\n-= Getting Status of All Backup Sites\n-Retrieve the status of all backup sites with `GET` requests.\n+= Getting Status of All Sites\n+Retrieve the status of all remote sites with `GET` requests.\n \n [source,options=\"nowrap\",subs=attributes+]\n ----\n GET /v2/caches/{cacheName}/x-site/backups/\n ----\n \n-{brandname} responds with the status of each backup site in JSON format, as in\n-the following example:\n+{brandname} responds with the status of each site in JSON format, as in the following example:", "originalCommit": "50b3b463407f6be53e097109011ea0586acc0ebd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI4MTk5MA==", "url": "https://github.com/infinispan/infinispan/pull/7730#discussion_r372281990", "bodyText": "same question for other sites below in this file :)", "author": "pruivo", "createdAt": "2020-01-29T09:49:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjI4MTY2MA=="}], "type": "inlineReview"}, {"oid": "42d0ef5b809093916ba2032918ff486e5f172bd8", "url": "https://github.com/infinispan/infinispan/commit/42d0ef5b809093916ba2032918ff486e5f172bd8", "message": "review feedback round one", "committedDate": "2020-01-31T20:07:10Z", "type": "forcePushed"}, {"oid": "d9d1fb47e145e868f7eb349eb0afb22d05f66bbd", "url": "https://github.com/infinispan/infinispan/commit/d9d1fb47e145e868f7eb349eb0afb22d05f66bbd", "message": "edits", "committedDate": "2020-02-03T18:55:35Z", "type": "forcePushed"}, {"oid": "d2259042b6a348ba330e940b85249eea166035e6", "url": "https://github.com/infinispan/infinispan/commit/d2259042b6a348ba330e940b85249eea166035e6", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-02-05T19:04:46Z", "type": "forcePushed"}, {"oid": "70e326222d5e80412cf37f71633f9c72e4a22764", "url": "https://github.com/infinispan/infinispan/commit/70e326222d5e80412cf37f71633f9c72e4a22764", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-03-10T10:10:00Z", "type": "forcePushed"}, {"oid": "853c65899d1b3e9c113c98e76931e25bdf7da5c1", "url": "https://github.com/infinispan/infinispan/commit/853c65899d1b3e9c113c98e76931e25bdf7da5c1", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-03-13T14:42:26Z", "type": "forcePushed"}, {"oid": "3633d9d927514c6f2fe6cd13e39b592356089034", "url": "https://github.com/infinispan/infinispan/commit/3633d9d927514c6f2fe6cd13e39b592356089034", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-03-24T12:54:07Z", "type": "forcePushed"}, {"oid": "b152cf476a0932e0fb746fc272e3e55cf3819698", "url": "https://github.com/infinispan/infinispan/commit/b152cf476a0932e0fb746fc272e3e55cf3819698", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-03-26T09:03:01Z", "type": "forcePushed"}, {"oid": "21163096de53efe2b1bf783abe7435f27f89168e", "url": "https://github.com/infinispan/infinispan/commit/21163096de53efe2b1bf783abe7435f27f89168e", "message": "ISPN-11544 xsite doc fixes", "committedDate": "2020-03-26T21:03:16Z", "type": "forcePushed"}, {"oid": "56d38b0f14b31f86ee15aba5c1b39076ea9bc74c", "url": "https://github.com/infinispan/infinispan/commit/56d38b0f14b31f86ee15aba5c1b39076ea9bc74c", "message": "remove details about IRAC conflict resolution", "committedDate": "2020-03-27T16:29:29Z", "type": "forcePushed"}, {"oid": "a8ebc28a54107eae94184c64aba1688d8f68324d", "url": "https://github.com/infinispan/infinispan/commit/a8ebc28a54107eae94184c64aba1688d8f68324d", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-03-27T18:16:36Z", "type": "commit"}, {"oid": "a8ebc28a54107eae94184c64aba1688d8f68324d", "url": "https://github.com/infinispan/infinispan/commit/a8ebc28a54107eae94184c64aba1688d8f68324d", "message": "ISPN-10835 xsite repl doc updates", "committedDate": "2020-03-27T18:16:36Z", "type": "forcePushed"}]}