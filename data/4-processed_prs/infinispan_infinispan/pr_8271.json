{"pr_number": 8271, "pr_title": "ISPN-11479 Implement <indexed-entities> for protobuf payloads in indexed caches", "pr_createdAt": "2020-05-01T17:23:51Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8271", "timeline": [{"oid": "021564e1862ae63c50189345fc28b8bfe408e51e", "url": "https://github.com/infinispan/infinispan/commit/021564e1862ae63c50189345fc28b8bfe408e51e", "message": "ISPN-11479 Enforce <indexed-entities> for protobuf payloads in indexed caches\n\n* the type name can be a java class FQN or a protobuf type FQN\n* TODO what about primitive types?", "committedDate": "2020-05-01T17:57:18Z", "type": "forcePushed"}, {"oid": "0f8e369b691cdf6e1c277b0fa3d19177ae1da000", "url": "https://github.com/infinispan/infinispan/commit/0f8e369b691cdf6e1c277b0fa3d19177ae1da000", "message": "wip", "committedDate": "2020-05-02T13:23:53Z", "type": "forcePushed"}, {"oid": "4b7a09785a69e53d89a5943e52047a06ac5316fc", "url": "https://github.com/infinispan/infinispan/commit/4b7a09785a69e53d89a5943e52047a06ac5316fc", "message": "wip", "committedDate": "2020-05-03T11:02:34Z", "type": "forcePushed"}, {"oid": "3613b981c6d8d8f289673c45f17a1f4623782bfa", "url": "https://github.com/infinispan/infinispan/commit/3613b981c6d8d8f289673c45f17a1f4623782bfa", "message": "wip", "committedDate": "2020-05-03T21:09:19Z", "type": "forcePushed"}, {"oid": "c7cf4a725950b7ef60ca022d02ddc748dd1857be", "url": "https://github.com/infinispan/infinispan/commit/c7cf4a725950b7ef60ca022d02ddc748dd1857be", "message": "wip", "committedDate": "2020-05-03T21:41:16Z", "type": "forcePushed"}, {"oid": "5e18f272809e1c8f6dde5863bb7046ac60681249", "url": "https://github.com/infinispan/infinispan/commit/5e18f272809e1c8f6dde5863bb7046ac60681249", "message": "ISPN-11764 Indexed entities and key transformers are not serialized by the core Serializer", "committedDate": "2020-05-04T09:49:16Z", "type": "forcePushed"}, {"oid": "59f57092871060cc04546f0f58ace5ba5166d713", "url": "https://github.com/infinispan/infinispan/commit/59f57092871060cc04546f0f58ace5ba5166d713", "message": "ISPN-11395 Indexing configuration serialization broken\n\n* indexed entities and key transformers were not serialized by the core Serializer", "committedDate": "2020-05-04T10:51:32Z", "type": "forcePushed"}, {"oid": "0a564e83cd99fea735c354abd72377d2b9e3c3c5", "url": "https://github.com/infinispan/infinispan/commit/0a564e83cd99fea735c354abd72377d2b9e3c3c5", "message": "ISPN-11395 Indexing configuration serialization broken\n\n* indexed entities and key transformers were not serialized by the core Serializer", "committedDate": "2020-05-04T16:13:57Z", "type": "forcePushed"}, {"oid": "992ec5119ae9644eab7795176eaa1c99b03acebc", "url": "https://github.com/infinispan/infinispan/commit/992ec5119ae9644eab7795176eaa1c99b03acebc", "message": "WIP Use TermsQuery instead of multiple TermQuery in SegmentFilterFactory", "committedDate": "2020-05-11T07:07:41Z", "type": "forcePushed"}, {"oid": "26162f710bc1ee23f8b228a5ea497468269354d7", "url": "https://github.com/infinispan/infinispan/commit/26162f710bc1ee23f8b228a5ea497468269354d7", "message": "WIP Pico-optimization in SegmentFieldBridge", "committedDate": "2020-05-11T07:44:56Z", "type": "forcePushed"}, {"oid": "7735761ecbdfff36ff202f4d533cb43b9d1f3f24", "url": "https://github.com/infinispan/infinispan/commit/7735761ecbdfff36ff202f4d533cb43b9d1f3f24", "message": "WIP", "committedDate": "2020-05-11T09:19:19Z", "type": "forcePushed"}, {"oid": "59347d41891466f26fff5f7321cc5b0603edbc27", "url": "https://github.com/infinispan/infinispan/commit/59347d41891466f26fff5f7321cc5b0603edbc27", "message": "ISPN-11479 Enforce <indexed-entities> for protobuf payloads in indexed caches\n\n* the type name can be a java class FQN or a protobuf type FQN\n* TODO what about primitive types?", "committedDate": "2020-05-12T13:11:16Z", "type": "forcePushed"}, {"oid": "97ce38798f90937b5fd9f9f689a4c5f02c083895", "url": "https://github.com/infinispan/infinispan/commit/97ce38798f90937b5fd9f9f689a4c5f02c083895", "message": "wip", "committedDate": "2020-05-12T16:59:02Z", "type": "forcePushed"}, {"oid": "63a3b7da4bb97bfaa8ad9780a6810560998e4773", "url": "https://github.com/infinispan/infinispan/commit/63a3b7da4bb97bfaa8ad9780a6810560998e4773", "message": "ISPN-11479 Enforce <indexed-entities> for protobuf payloads in indexed caches\n\n* the type name can be a java class FQN or a protobuf type FQN\n* TODO what about primitive types?", "committedDate": "2020-05-13T08:21:55Z", "type": "forcePushed"}, {"oid": "a931c81260ee718d1486cfb38bcf0cd7d8e1c359", "url": "https://github.com/infinispan/infinispan/commit/a931c81260ee718d1486cfb38bcf0cd7d8e1c359", "message": "wip", "committedDate": "2020-05-13T12:50:55Z", "type": "forcePushed"}, {"oid": "150784237e3572342b254b9ae4186cb04674d382", "url": "https://github.com/infinispan/infinispan/commit/150784237e3572342b254b9ae4186cb04674d382", "message": "wip", "committedDate": "2020-05-13T16:47:50Z", "type": "forcePushed"}, {"oid": "5a1848eae238316b4d37394c55ed9f33738e4238", "url": "https://github.com/infinispan/infinispan/commit/5a1848eae238316b4d37394c55ed9f33738e4238", "message": "wip", "committedDate": "2020-05-13T18:21:01Z", "type": "forcePushed"}, {"oid": "ba72a9a461fdf661289087bc7d1dbc57baebac08", "url": "https://github.com/infinispan/infinispan/commit/ba72a9a461fdf661289087bc7d1dbc57baebac08", "message": "wip", "committedDate": "2020-05-13T22:41:00Z", "type": "forcePushed"}, {"oid": "3b5632e7841b78182764baa81cd5a9ee63d1ceee", "url": "https://github.com/infinispan/infinispan/commit/3b5632e7841b78182764baa81cd5a9ee63d1ceee", "message": "wip", "committedDate": "2020-05-14T10:28:47Z", "type": "forcePushed"}, {"oid": "c8e899274ab776af3ce8bac3230f2d667ae43bdb", "url": "https://github.com/infinispan/infinispan/commit/c8e899274ab776af3ce8bac3230f2d667ae43bdb", "message": "wip", "committedDate": "2020-05-15T07:48:14Z", "type": "forcePushed"}, {"oid": "e3dbd63b4776ce76ec0757d3742f45779f3fb205", "url": "https://github.com/infinispan/infinispan/commit/e3dbd63b4776ce76ec0757d3742f45779f3fb205", "message": "wip", "committedDate": "2020-05-15T11:07:27Z", "type": "forcePushed"}, {"oid": "8508aac4ae0a34d2cbf2072fef16e3e34f161e6d", "url": "https://github.com/infinispan/infinispan/commit/8508aac4ae0a34d2cbf2072fef16e3e34f161e6d", "message": "ISPN-11847 Remove QueryBuilder and other deprecated dsl package usages", "committedDate": "2020-05-18T07:50:10Z", "type": "forcePushed"}, {"oid": "5ef8e7c2530d2c58fe7b01c7e8cb40653e0dcd92", "url": "https://github.com/infinispan/infinispan/commit/5ef8e7c2530d2c58fe7b01c7e8cb40653e0dcd92", "message": "ISPN-11847 Remove QueryBuilder and other deprecated dsl package usages", "committedDate": "2020-05-18T07:57:31Z", "type": "forcePushed"}, {"oid": "d07e04136fb80131d7b16d0115e8dcd8ed6c8807", "url": "https://github.com/infinispan/infinispan/commit/d07e04136fb80131d7b16d0115e8dcd8ed6c8807", "message": "ISPN-11847 Remove QueryBuilder and other deprecated dsl package usages", "committedDate": "2020-05-21T07:32:30Z", "type": "forcePushed"}, {"oid": "07461ed00b419d0c5dca03c0ecfcf4559ec10cd2", "url": "https://github.com/infinispan/infinispan/commit/07461ed00b419d0c5dca03c0ecfcf4559ec10cd2", "message": "ISPN-11790 Deprecate CacheQuery and related methods in SearchManager/SearchManagerImplementor", "committedDate": "2020-05-21T11:52:31Z", "type": "forcePushed"}, {"oid": "99a69297a35c393441c008e4637e672760f3b653", "url": "https://github.com/infinispan/infinispan/commit/99a69297a35c393441c008e4637e672760f3b653", "message": "ISPN-11790 Deprecate CacheQuery and related methods in SearchManager/SearchManagerImplementor", "committedDate": "2020-05-22T14:48:46Z", "type": "forcePushed"}, {"oid": "1d429320bcf213cf793977e3943bf9475801be3b", "url": "https://github.com/infinispan/infinispan/commit/1d429320bcf213cf793977e3943bf9475801be3b", "message": "ISPN-11790 Deprecate CacheQuery and related methods in SearchManager/SearchManagerImplementor", "committedDate": "2020-05-22T15:24:13Z", "type": "forcePushed"}, {"oid": "4ce0dd3a89cc438c4243547880734fe53acd1827", "url": "https://github.com/infinispan/infinispan/commit/4ce0dd3a89cc438c4243547880734fe53acd1827", "message": "ISPN-11790 Deprecate CacheQuery and related methods in SearchManager/SearchManagerImplementor", "committedDate": "2020-05-22T15:45:43Z", "type": "forcePushed"}, {"oid": "30f38af23f060ae1df17b235035fcb37b7c1a98f", "url": "https://github.com/infinispan/infinispan/commit/30f38af23f060ae1df17b235035fcb37b7c1a98f", "message": "wip indexed-entities tests", "committedDate": "2020-05-22T21:09:51Z", "type": "forcePushed"}, {"oid": "f82e33a05f8481cdad2e00352b4c675a949836f1", "url": "https://github.com/infinispan/infinispan/commit/f82e33a05f8481cdad2e00352b4c675a949836f1", "message": "wip indexed-entities tests", "committedDate": "2020-05-22T21:33:51Z", "type": "forcePushed"}, {"oid": "95795a01302f04ebb237a6ca8cbc63cec5f67be5", "url": "https://github.com/infinispan/infinispan/commit/95795a01302f04ebb237a6ca8cbc63cec5f67be5", "message": "wip indexed-entities tests", "committedDate": "2020-05-23T00:38:09Z", "type": "forcePushed"}, {"oid": "09787b01d5ad9634ffd299fa9a90c849ebf0e215", "url": "https://github.com/infinispan/infinispan/commit/09787b01d5ad9634ffd299fa9a90c849ebf0e215", "message": "wip indexed-entities tests", "committedDate": "2020-05-23T07:47:22Z", "type": "forcePushed"}, {"oid": "ddd513897343a0cd05f73cc0ba63646684f5832e", "url": "https://github.com/infinispan/infinispan/commit/ddd513897343a0cd05f73cc0ba63646684f5832e", "message": "ISPN-11847 Remove QueryBuilder and other deprecated dsl package usages", "committedDate": "2020-05-23T07:53:46Z", "type": "forcePushed"}, {"oid": "248b548e8571847b6e3791cad1f17407ffd85168", "url": "https://github.com/infinispan/infinispan/commit/248b548e8571847b6e3791cad1f17407ffd85168", "message": "ISPN-11847 Remove QueryBuilder and other deprecated dsl package usages", "committedDate": "2020-05-23T14:19:55Z", "type": "forcePushed"}, {"oid": "d70a72fc2607a832fafce6e8e8336493656515aa", "url": "https://github.com/infinispan/infinispan/commit/d70a72fc2607a832fafce6e8e8336493656515aa", "message": "ISPN-11847 Remove QueryBuilder and other deprecated dsl package usages", "committedDate": "2020-05-25T07:41:31Z", "type": "forcePushed"}, {"oid": "13a06f4edae5743746c3b54f9d0734a8ec640373", "url": "https://github.com/infinispan/infinispan/commit/13a06f4edae5743746c3b54f9d0734a8ec640373", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-26T09:21:12Z", "type": "forcePushed"}, {"oid": "798012571ef48f40e7daae65ede1a94ae71d695f", "url": "https://github.com/infinispan/infinispan/commit/798012571ef48f40e7daae65ede1a94ae71d695f", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-26T10:24:33Z", "type": "forcePushed"}, {"oid": "38325ff420d952dda3473b5bcaa368bcd6b1d2f0", "url": "https://github.com/infinispan/infinispan/commit/38325ff420d952dda3473b5bcaa368bcd6b1d2f0", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-26T14:01:18Z", "type": "forcePushed"}, {"oid": "5ba20cdda22fb1d86064de90f16946dda3843815", "url": "https://github.com/infinispan/infinispan/commit/5ba20cdda22fb1d86064de90f16946dda3843815", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-27T07:05:16Z", "type": "forcePushed"}, {"oid": "1371114ac8dd2caf92a07414caf2ad14765285b3", "url": "https://github.com/infinispan/infinispan/commit/1371114ac8dd2caf92a07414caf2ad14765285b3", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-27T07:06:59Z", "type": "forcePushed"}, {"oid": "7314bd789c9e378e0261808f4af4828c05164671", "url": "https://github.com/infinispan/infinispan/commit/7314bd789c9e378e0261808f4af4828c05164671", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-27T17:05:50Z", "type": "forcePushed"}, {"oid": "23618d33d0b9ad40daf00911460eecafad3dee9d", "url": "https://github.com/infinispan/infinispan/commit/23618d33d0b9ad40daf00911460eecafad3dee9d", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-28T09:13:26Z", "type": "forcePushed"}, {"oid": "c4065e9d6579244e7cfd989cf264230d30b90b35", "url": "https://github.com/infinispan/infinispan/commit/c4065e9d6579244e7cfd989cf264230d30b90b35", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-28T11:21:28Z", "type": "forcePushed"}, {"oid": "df97329780c5eab87f442848d56d0a3b5fe3b8a0", "url": "https://github.com/infinispan/infinispan/commit/df97329780c5eab87f442848d56d0a3b5fe3b8a0", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-05-31T08:40:26Z", "type": "forcePushed"}, {"oid": "27158b8ca41e9ff857cb86ad254786912a888d47", "url": "https://github.com/infinispan/infinispan/commit/27158b8ca41e9ff857cb86ad254786912a888d47", "message": "wip", "committedDate": "2020-05-31T11:06:13Z", "type": "forcePushed"}, {"oid": "a453cdb0ed406c8ed8847caee2317a6207fad147", "url": "https://github.com/infinispan/infinispan/commit/a453cdb0ed406c8ed8847caee2317a6207fad147", "message": "wip", "committedDate": "2020-05-31T11:21:36Z", "type": "forcePushed"}, {"oid": "a87e6bd01555c97f0519bd56473f469fcad1412a", "url": "https://github.com/infinispan/infinispan/commit/a87e6bd01555c97f0519bd56473f469fcad1412a", "message": "wip", "committedDate": "2020-06-02T12:24:47Z", "type": "forcePushed"}, {"oid": "7339ff35d03abd7f4561e5b34ace49fc9e66d19e", "url": "https://github.com/infinispan/infinispan/commit/7339ff35d03abd7f4561e5b34ace49fc9e66d19e", "message": "wip", "committedDate": "2020-06-02T19:51:41Z", "type": "forcePushed"}, {"oid": "39b01d8ad9d89e82434d51a31cad9d040aa3d1d3", "url": "https://github.com/infinispan/infinispan/commit/39b01d8ad9d89e82434d51a31cad9d040aa3d1d3", "message": "wip Query<T>", "committedDate": "2020-06-03T07:03:49Z", "type": "forcePushed"}, {"oid": "46676932ceacff2e158d4c1863dc48f905e46a2c", "url": "https://github.com/infinispan/infinispan/commit/46676932ceacff2e158d4c1863dc48f905e46a2c", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-06-09T09:33:58Z", "type": "forcePushed"}, {"oid": "065613a7443ecb7534636a108c639aefb5009338", "url": "https://github.com/infinispan/infinispan/commit/065613a7443ecb7534636a108c639aefb5009338", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-06-09T10:46:36Z", "type": "forcePushed"}, {"oid": "a0b84bda82eaad79ca3edbcb2ee0c2fcf772ed57", "url": "https://github.com/infinispan/infinispan/commit/a0b84bda82eaad79ca3edbcb2ee0c2fcf772ed57", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-06-09T10:48:49Z", "type": "forcePushed"}, {"oid": "9e482294bbe409ecc9e68b5431c1f4b397d70ab5", "url": "https://github.com/infinispan/infinispan/commit/9e482294bbe409ecc9e68b5431c1f4b397d70ab5", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-06-09T11:21:13Z", "type": "forcePushed"}, {"oid": "f0175c2ebfeb60485edbb589a46da7d3e00948ee", "url": "https://github.com/infinispan/infinispan/commit/f0175c2ebfeb60485edbb589a46da7d3e00948ee", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-06-09T14:22:12Z", "type": "forcePushed"}, {"oid": "7e70ecc5a6416dc7b856333bdcc0379b60ba47a5", "url": "https://github.com/infinispan/infinispan/commit/7e70ecc5a6416dc7b856333bdcc0379b60ba47a5", "message": "wip", "committedDate": "2020-06-09T15:42:14Z", "type": "forcePushed"}, {"oid": "d981ba57d70793912e53bfa546f25b75fcc938bf", "url": "https://github.com/infinispan/infinispan/commit/d981ba57d70793912e53bfa546f25b75fcc938bf", "message": "ISPN-11479 Relax unknown indexed type error and make it a warning for 11", "committedDate": "2020-06-09T16:48:19Z", "type": "forcePushed"}, {"oid": "6e5aa0a6aaf152144ea3b08b45b25e9f028101f4", "url": "https://github.com/infinispan/infinispan/commit/6e5aa0a6aaf152144ea3b08b45b25e9f028101f4", "message": "ISPN-11479 Relax unknown indexed type error and make it a warning for 11", "committedDate": "2020-06-09T22:07:21Z", "type": "forcePushed"}, {"oid": "cd05bedf55f11dfa5aafd4c3146588b53d11d670", "url": "https://github.com/infinispan/infinispan/commit/cd05bedf55f11dfa5aafd4c3146588b53d11d670", "message": "ISPN-11479 Relax unknown indexed type error and make it a warning for 11", "committedDate": "2020-06-10T07:23:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkzMjQzOQ==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r437932439", "bodyText": "Could you add a line in upgrading.adoc about this?", "author": "gustavonalle", "createdAt": "2020-06-10T07:57:26Z", "path": "remote-query/remote-query-server/src/main/java/org/infinispan/query/remote/impl/logging/Log.java", "diffHunk": "@@ -66,4 +66,9 @@\n    @Message(id = 28016, value = \"Query performed in a cache ('%s') that has an unknown format configuration. \" +\n          \"Please configure the cache encoding as 'application/x-protostream' or 'application/x-java-object'\")\n    void warnNoMediaType(String cacheName);\n+\n+   //TODO [anistor] This warning will become ERROR in version 12", "originalCommit": "cd05bedf55f11dfa5aafd4c3146588b53d11d670", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk5Mzk0NQ==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r437993945", "bodyText": "done", "author": "anistor", "createdAt": "2020-06-10T09:37:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzkzMjQzOQ=="}], "type": "inlineReview"}, {"oid": "272fa44b0dbe7b57107fce98fb68639d0e444c95", "url": "https://github.com/infinispan/infinispan/commit/272fa44b0dbe7b57107fce98fb68639d0e444c95", "message": "ISPN-11479 Relax unknown indexed type error and make it a warning for 11", "committedDate": "2020-06-10T09:25:03Z", "type": "forcePushed"}, {"oid": "f8659577a98e4686a38cd01df6719ac1e9c9dab3", "url": "https://github.com/infinispan/infinispan/commit/f8659577a98e4686a38cd01df6719ac1e9c9dab3", "message": "ISPN-11479 Relax unknown indexed type error and make it a warning for 11", "committedDate": "2020-06-10T09:54:53Z", "type": "forcePushed"}, {"oid": "46059ac12822b902eee310360bdbd9617ce9cad5", "url": "https://github.com/infinispan/infinispan/commit/46059ac12822b902eee310360bdbd9617ce9cad5", "message": "ISPN-11479 Relax unknown indexed type error and make it a warning for 11", "committedDate": "2020-06-10T12:29:46Z", "type": "forcePushed"}, {"oid": "2f6f9186382c1c9d3ca12b771f01d003579277e4", "url": "https://github.com/infinispan/infinispan/commit/2f6f9186382c1c9d3ca12b771f01d003579277e4", "message": "Make TestModuleRepository final", "committedDate": "2020-06-10T17:59:07Z", "type": "forcePushed"}, {"oid": "83e5eca13d94331033cca61e64b00a4496651c6c", "url": "https://github.com/infinispan/infinispan/commit/83e5eca13d94331033cca61e64b00a4496651c6c", "message": "Make TestModuleRepository final", "committedDate": "2020-06-11T08:18:30Z", "type": "forcePushed"}, {"oid": "e61fff8b7fbdb9bf5248b55f72aeada0ba7c0bf9", "url": "https://github.com/infinispan/infinispan/commit/e61fff8b7fbdb9bf5248b55f72aeada0ba7c0bf9", "message": "Remove RemoteQueryManager.isQueryEnabled(Cache) and update signature of QueryFacade to no longer imply a byte[] cache", "committedDate": "2020-06-11T09:18:58Z", "type": "forcePushed"}, {"oid": "ccac8d79e391dd40aa7494ae5650c1b746f9c728", "url": "https://github.com/infinispan/infinispan/commit/ccac8d79e391dd40aa7494ae5650c1b746f9c728", "message": "Remove RemoteQueryManager.isQueryEnabled(Cache) and update signature of QueryFacade to no longer imply a byte[] cache", "committedDate": "2020-06-11T09:47:57Z", "type": "forcePushed"}, {"oid": "0ce78cb92760a25725d60b99dce5a17ed5b54f0d", "url": "https://github.com/infinispan/infinispan/commit/0ce78cb92760a25725d60b99dce5a17ed5b54f0d", "message": "Ensure we only allow a single QueryFacade implementation\n\n* update signature of QueryFacade to no longer imply a byte[] cache\n* remove RemoteQueryManager.isQueryEnabled(Cache)", "committedDate": "2020-06-11T10:12:32Z", "type": "forcePushed"}, {"oid": "4c24a83fdb9bb88c5ce0166bc66381aa21b717f9", "url": "https://github.com/infinispan/infinispan/commit/4c24a83fdb9bb88c5ce0166bc66381aa21b717f9", "message": "TestModuleRepository relies onlky on public features of ModuleRepository and no longer depends on accessing package local stuff, thus avoiding possible java modules access violations\n\n* generify several usages of ComponentAccessor", "committedDate": "2020-06-11T11:46:31Z", "type": "forcePushed"}, {"oid": "5998150069155cb896c458c32a445a62c0ea3f6b", "url": "https://github.com/infinispan/infinispan/commit/5998150069155cb896c458c32a445a62c0ea3f6b", "message": "TestModuleRepository relies on package-local stuff located in another java module\n\n* make TestModuleRepository final\n* generify several usages of ComponentAccessor", "committedDate": "2020-06-11T11:47:11Z", "type": "forcePushed"}, {"oid": "843b7bc4732a7a16d8825838b8b5d118310e2ab1", "url": "https://github.com/infinispan/infinispan/commit/843b7bc4732a7a16d8825838b8b5d118310e2ab1", "message": "TestModuleRepository relies on package-local stuff located in another java module\n\n* refactor to avoid module access violations\n* make TestModuleRepository final\n* generify several usages of ComponentAccessor", "committedDate": "2020-06-11T12:04:12Z", "type": "forcePushed"}, {"oid": "98b1981d6a3e5adb38b9554bc1e8357f99013b2d", "url": "https://github.com/infinispan/infinispan/commit/98b1981d6a3e5adb38b9554bc1e8357f99013b2d", "message": "Ensure we only allow a single QueryFacade implementation\n\n* update signature of QueryFacade to no longer imply a byte[] cache\n* remove RemoteQueryManager.isQueryEnabled(Cache)", "committedDate": "2020-06-11T15:13:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2NTEyMQ==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r438865121", "bodyText": "Unfortunately  builder.memory().encoding().value().isProtobufStorage() only gives the information that \"protobuf was explicitly configured in the cache\", and not if the storage turns out to be protobuf or not. Storage information is obtained only at runtime\nadvancedCache.getValueDataConversion().getStorageMediaType()\nI think the reasons why it \"works\" here in this PR is because the exception is ignored", "author": "gustavonalle", "createdAt": "2020-06-11T15:20:59Z", "path": "core/src/main/java/org/infinispan/configuration/parsing/Parser.java", "diffHunk": "@@ -2779,14 +2779,25 @@ private void parseKeyTransformer(XMLExtendedStreamReader reader, ConfigurationBu\n \n    private void parseIndexedEntities(XMLExtendedStreamReader reader, ConfigurationBuilderHolder holder, ConfigurationBuilder builder) throws XMLStreamException {\n       ParseUtils.requireNoAttributes(reader);\n+      boolean isProtobufStorage = builder.memory().encoding().value().isProtobufStorage();", "originalCommit": "98b1981d6a3e5adb38b9554bc1e8357f99013b2d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIyNzIzNQ==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r439227235", "bodyText": "And don't we want to know that \"protobuf was explicitly configured in the cache\" ?", "author": "anistor", "createdAt": "2020-06-12T06:17:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIyODA4Mw==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r439228083", "bodyText": "And we need that to know at config time not at runtime.", "author": "anistor", "createdAt": "2020-06-12T06:20:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI0NTM4OQ==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r439245389", "bodyText": "atm there is no way of knowing at config time, unless it is explicitly configured. So if a cache hasn't go the encoding config, but declares protobuf messages as entities, the parser will try to load this inexistent classes, but will fail. No big deal, I was just saying that it will work since the exception is ignored.", "author": "gustavonalle", "createdAt": "2020-06-12T07:07:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI0ODgzNw==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r439248837", "bodyText": "we absolutely need that in 12, at least, otherwise the whole pre-declared stuff for HS 6 will not really exist.", "author": "anistor", "createdAt": "2020-06-12T07:16:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2NTEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1MzkxMg==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r439253912", "bodyText": "yes, it shall be available at config time", "author": "gustavonalle", "createdAt": "2020-06-12T07:28:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2NTEyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2Nzg5NQ==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r438867895", "bodyText": "this will flood the logs for sure \ud83d\ude04\nI wonder if it's possible to print only at cache creation or start", "author": "gustavonalle", "createdAt": "2020-06-11T15:24:59Z", "path": "documentation/src/main/asciidoc/topics/upgrading.adoc", "diffHunk": "@@ -42,6 +42,11 @@ It is forbidden to use both the `.indexing().enabled( )` and the deprecated `.in\n \n * The `auto-config` attribute is deprecated and will be removed in a future version.\n \n+* Starting with version 11 it is mandatory to declare all indexed types in the indexing configuration or else warnings will be logged every time an undeclared type is indexed or queried.\n+This requirement exists solely for indexed caches and applies to both Java classes and protobuf types.", "originalCommit": "98b1981d6a3e5adb38b9554bc1e8357f99013b2d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg4ODc5NQ==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r438888795", "bodyText": "I'll try to move that to once", "author": "anistor", "createdAt": "2020-06-11T15:48:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2Nzg5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkwNDExNg==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r438904116", "bodyText": "@Once will be once for all caches I'm afraid. Ideally it should print once per cache", "author": "gustavonalle", "createdAt": "2020-06-11T16:08:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2Nzg5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIyMTQxNQ==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r439221415", "bodyText": "I added an internal flag in ProtobufValueWrapperFieldBridge to log only once per cache", "author": "anistor", "createdAt": "2020-06-12T05:57:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODg2Nzg5NQ=="}], "type": "inlineReview"}, {"oid": "e0cb42089cf667d72d9a09169e65e2dac03f49f4", "url": "https://github.com/infinispan/infinispan/commit/e0cb42089cf667d72d9a09169e65e2dac03f49f4", "message": "Ensure we only allow a single QueryFacade implementation\n\n* update signature of QueryFacade to no longer imply a byte[] cache\n* remove RemoteQueryManager.isQueryEnabled(Cache)", "committedDate": "2020-06-11T19:23:32Z", "type": "forcePushed"}, {"oid": "fd781d941e68113829996543310034df43bfb852", "url": "https://github.com/infinispan/infinispan/commit/fd781d941e68113829996543310034df43bfb852", "message": "Ensure we only allow a single QueryFacade implementation\n\n* update signature of QueryFacade to no longer imply a byte[] cache\n* remove RemoteQueryManager.isQueryEnabled(Cache)", "committedDate": "2020-06-12T05:55:13Z", "type": "forcePushed"}, {"oid": "a4f8386fba87f14c5ad25914020e42c2a610efce", "url": "https://github.com/infinispan/infinispan/commit/a4f8386fba87f14c5ad25914020e42c2a610efce", "message": "Ensure we only allow a single QueryFacade implementation\n\n* update signature of QueryFacade to no longer imply a byte[] cache\n* remove RemoteQueryManager.isQueryEnabled(Cache)", "committedDate": "2020-06-12T06:33:52Z", "type": "forcePushed"}, {"oid": "30850ea70a7b6c7257c3a939f5790225a5513278", "url": "https://github.com/infinispan/infinispan/commit/30850ea70a7b6c7257c3a939f5790225a5513278", "message": "Ensure we only allow a single QueryFacade implementation\n\n* update signature of QueryFacade to no longer imply a byte[] cache\n* remove RemoteQueryManager.isQueryEnabled(Cache)", "committedDate": "2020-06-12T06:45:29Z", "type": "forcePushed"}, {"oid": "e1a94aef2a1baacf5cfdbe5ad9b5023d973f448f", "url": "https://github.com/infinispan/infinispan/commit/e1a94aef2a1baacf5cfdbe5ad9b5023d973f448f", "message": "Ensure we only allow a single QueryFacade implementation\n\n* update signature of QueryFacade to no longer imply a byte[] cache\n* remove RemoteQueryManager.isQueryEnabled(Cache)", "committedDate": "2020-06-12T06:53:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1MjQ5Mw==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r439252493", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * Starting with version 11 it is mandatory to declare all indexed types in the indexing configuration or else warnings will be logged every time an undeclared type is indexed or queried.\n          \n          \n            \n            * Starting with version 11 it is mandatory to declare all indexed types in the indexing configuration or else warnings will be logged when the undeclared type is firstly used.", "author": "gustavonalle", "createdAt": "2020-06-12T07:25:18Z", "path": "documentation/src/main/asciidoc/topics/upgrading.adoc", "diffHunk": "@@ -42,6 +42,11 @@ It is forbidden to use both the `.indexing().enabled( )` and the deprecated `.in\n \n * The `auto-config` attribute is deprecated and will be removed in a future version.\n \n+* Starting with version 11 it is mandatory to declare all indexed types in the indexing configuration or else warnings will be logged every time an undeclared type is indexed or queried.", "originalCommit": "56b9f61dc07f7649ff2195a767c3fdc9661b5719", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI4NTQ3Mg==", "url": "https://github.com/infinispan/infinispan/pull/8271#discussion_r439285472", "bodyText": "Done!", "author": "anistor", "createdAt": "2020-06-12T08:36:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTI1MjQ5Mw=="}], "type": "inlineReview"}, {"oid": "4edc247a7d11caab587a399f858bc021fd9b7e56", "url": "https://github.com/infinispan/infinispan/commit/4edc247a7d11caab587a399f858bc021fd9b7e56", "message": "Remove unused field SearchManagerImpl.cache", "committedDate": "2020-06-12T08:18:07Z", "type": "commit"}, {"oid": "bd350e24b08c7052eb0833338ccc0f96a386d82f", "url": "https://github.com/infinispan/infinispan/commit/bd350e24b08c7052eb0833338ccc0f96a386d82f", "message": "Reword SegmentFieldBridge missing param error message", "committedDate": "2020-06-12T08:18:07Z", "type": "commit"}, {"oid": "99272debc598cb94ba890cdd6b1ad1da7c97937d", "url": "https://github.com/infinispan/infinispan/commit/99272debc598cb94ba890cdd6b1ad1da7c97937d", "message": "SingleCacheManagerTest.assertNoTransactions with lambda", "committedDate": "2020-06-12T08:18:07Z", "type": "commit"}, {"oid": "5ebf0883dca12d87e0f831c78352f6bc852f7165", "url": "https://github.com/infinispan/infinispan/commit/5ebf0883dca12d87e0f831c78352f6bc852f7165", "message": "ISPN-11856 Improve QueryCache debug messages", "committedDate": "2020-06-12T08:18:07Z", "type": "commit"}, {"oid": "369f891e55c33f65d6dede08b3541f44b9c3fced", "url": "https://github.com/infinispan/infinispan/commit/369f891e55c33f65d6dede08b3541f44b9c3fced", "message": "ProtostreamTranscoder.ctxRegistry does not need to be volatile", "committedDate": "2020-06-12T08:18:07Z", "type": "commit"}, {"oid": "b1a3e8081d5f95d81c7c2223be8e3f8b6775b8a0", "url": "https://github.com/infinispan/infinispan/commit/b1a3e8081d5f95d81c7c2223be8e3f8b6775b8a0", "message": "Fix asserts in InvalidatedMarshalledValueTest", "committedDate": "2020-06-12T08:18:07Z", "type": "commit"}, {"oid": "6a9a03f4d0ec9eca9a7977680b8d52a52d1e2944", "url": "https://github.com/infinispan/infinispan/commit/6a9a03f4d0ec9eca9a7977680b8d52a52d1e2944", "message": "Fix error message when no logs are recorded yet by StringLogAppender", "committedDate": "2020-06-12T08:18:07Z", "type": "commit"}, {"oid": "47d47674efe34053129c839467d3d2c43ec49807", "url": "https://github.com/infinispan/infinispan/commit/47d47674efe34053129c839467d3d2c43ec49807", "message": "ISPN-11790 Deprecate CacheQuery and related methods in SearchManager/SearchManagerImplementor", "committedDate": "2020-06-12T08:18:07Z", "type": "commit"}, {"oid": "b5083e2429475076fabdaa5e1f84bbb02651d12b", "url": "https://github.com/infinispan/infinispan/commit/b5083e2429475076fabdaa5e1f84bbb02651d12b", "message": "ISPN-11818 Restore SearchConfiguration.getProvidedServices to provide LuceneAnalysisDefinitionProvider which was lost when Infinispan index manager was killed", "committedDate": "2020-06-12T08:18:08Z", "type": "commit"}, {"oid": "64f6503cca34dd9c6d585efc8716a2a9621c0399", "url": "https://github.com/infinispan/infinispan/commit/64f6503cca34dd9c6d585efc8716a2a9621c0399", "message": "ISPN-11846 Server runtime tests cannot run from IDE after antlr-runtime became optional", "committedDate": "2020-06-12T08:18:08Z", "type": "commit"}, {"oid": "b69b024af229d1b307f337fd626d4ed0150147be", "url": "https://github.com/infinispan/infinispan/commit/b69b024af229d1b307f337fd626d4ed0150147be", "message": "ISPN-11395 Indexing configuration serialization broken\n\n* indexed entities and key transformers were not serialized by the core Serializer", "committedDate": "2020-06-12T08:18:08Z", "type": "commit"}, {"oid": "ada567d5b7b855904fbcd0c41a7caa56ab13cda6", "url": "https://github.com/infinispan/infinispan/commit/ada567d5b7b855904fbcd0c41a7caa56ab13cda6", "message": "ISPN-11479 Enforce <indexed-entities> for protobuf payloads in indexed caches\n\n* the type name can be a java class FQN or a protobuf type FQN\n* TODO what about primitive types?", "committedDate": "2020-06-12T08:18:08Z", "type": "commit"}, {"oid": "ef9abdeefac546bc7b128bd10d39d442a85524f4", "url": "https://github.com/infinispan/infinispan/commit/ef9abdeefac546bc7b128bd10d39d442a85524f4", "message": "ISPN-11847 Remove usages of QueryBuilder and other deprecated dsl package usages\n\n* convert most to new API, still keep a few to prove the deprecated DSL is still working", "committedDate": "2020-06-12T08:18:08Z", "type": "commit"}, {"oid": "547c36068457fd98197cf4b8d834bb00bb4697f6", "url": "https://github.com/infinispan/infinispan/commit/547c36068457fd98197cf4b8d834bb00bb4697f6", "message": "All usages of org.infinispan.query.dsl.Query interface must use the newly introduced generic type param", "committedDate": "2020-06-12T08:18:08Z", "type": "commit"}, {"oid": "ae9bf3a4e213b3bb1b82caa8ad207243b54c2b1e", "url": "https://github.com/infinispan/infinispan/commit/ae9bf3a4e213b3bb1b82caa8ad207243b54c2b1e", "message": "Generify EntityNameResolver", "committedDate": "2020-06-12T08:18:08Z", "type": "commit"}, {"oid": "a0c14bc97071717ecab567b3fa7ea8ee1b6d7bbd", "url": "https://github.com/infinispan/infinispan/commit/a0c14bc97071717ecab567b3fa7ea8ee1b6d7bbd", "message": "ISPN-11479 Relax unknown indexed type error and make it a warning for 11", "committedDate": "2020-06-12T08:35:01Z", "type": "commit"}, {"oid": "02267bd74918354b9bfdf31aafdff0547559e179", "url": "https://github.com/infinispan/infinispan/commit/02267bd74918354b9bfdf31aafdff0547559e179", "message": "Move ProtobufMetadataManagerInterceptor blockhound exception to its own module", "committedDate": "2020-06-12T08:35:05Z", "type": "commit"}, {"oid": "9bec77ec1b8357371697d0784b3ba05b03dff2d2", "url": "https://github.com/infinispan/infinispan/commit/9bec77ec1b8357371697d0784b3ba05b03dff2d2", "message": "Ensure we only allow a single QueryFacade implementation\n\n* update signature of QueryFacade to no longer imply a byte[] cache\n* remove RemoteQueryManager.isQueryEnabled(Cache)", "committedDate": "2020-06-12T08:35:05Z", "type": "commit"}, {"oid": "c9c4204d04e04002aba9c1bdb0c4b5e61c99696b", "url": "https://github.com/infinispan/infinispan/commit/c9c4204d04e04002aba9c1bdb0c4b5e61c99696b", "message": "Remove unused field IndexingMetadata.NO_INDEXING", "committedDate": "2020-06-12T08:35:05Z", "type": "commit"}, {"oid": "c9c4204d04e04002aba9c1bdb0c4b5e61c99696b", "url": "https://github.com/infinispan/infinispan/commit/c9c4204d04e04002aba9c1bdb0c4b5e61c99696b", "message": "Remove unused field IndexingMetadata.NO_INDEXING", "committedDate": "2020-06-12T08:35:05Z", "type": "forcePushed"}]}