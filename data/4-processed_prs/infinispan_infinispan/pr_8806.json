{"pr_number": 8806, "pr_title": "[11.0.x] ISPN-12383 improved clarity in marshalling docs", "pr_createdAt": "2020-10-22T10:13:13Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8806", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU1NTIzMw==", "url": "https://github.com/infinispan/infinispan/pull/8806#discussion_r512555233", "bodyText": "In 11.0.x SerializationContextInitializers are not automatically registered. This behaviour was only introduced in 12.0.x.", "author": "ryanemerson", "createdAt": "2020-10-27T09:59:43Z", "path": "documentation/src/main/asciidoc/topics/proc_generating_protostream_sci.adoc", "diffHunk": "@@ -0,0 +1,79 @@\n+[id='generating_protostream_sci-{context}']\n+= Generating Serialization Context Initializers\n+A ProtoStream `SerializationContext` contains Protobuf type definitions for\n+custom Java objects, loaded from Protobuf schemas, and the accompanying\n+marshallers for those objects.\n+\n+{brandname} provides a `protostream-processor` artifact that processes Java\n+annotations in your classes at compile time. The processor generates Protobuf\n+schemas, marshallers, and a concrete implementation of the\n+`SerializationContextInitializer` interface that you can use to initialize a\n+ProtoStream `SerializationContext`.\n+\n+[NOTE]\n+====\n+By default, implementation names are the annotated class name with an \"Impl\"\n+suffix.\n+====\n+\n+.Procedure\n+\n+. Add the `protostream-processor` dependency to your `pom.xml`.\n++\n+[source,xml]\n+----\n+include::dependencies_maven/protostream-processor.xml[]\n+----\n++\n+. Annotate the Java objects that you want to marshall with `@ProtoField` and `@ProtoFactory`.\n++\n+[source,java]\n+.Author.java\n+----\n+include::code_examples/Author.java[]\n+----\n++\n+[source,java]\n+.Book.java\n+----\n+include::code_examples/Book.java[]\n+----\n++\n+. Define an interface that extends `SerializationContextInitializer` and is annotated with `@AutoProtoSchemaBuilder`.\n++\n+[source,java]\n+----\n+include::code_examples/LibraryInitializer.java[]\n+----\n++\n+<1> Names the generated `.proto` schema file.\n+<2> Sets the path under `target/classes` where the schema file is generated.\n+\n+.Next steps\n+\n+{brandname} automatically registers any `SerializationContextInitializer`\n+implementations on the application classpath. After you generate a\n+`SerializationContextInitializer`, {brandname} is ready to marshall your Java\n+objects.\n+\n+[NOTE]\n+====\n+If you do not want {brandname} to automatically register your\n+`SerializationContextInitializer` implementation, you should set a value of\n+`false` for the `AutoProtoSchemaBuilder.service` annotation. However, you must\n+then declare the implementation in your {brandname} configuration to register\n+it.\n+\n+[source,java]\n+----\n+@AutoProtoSchemaBuilder(\n+      includeClasses = SomeClass.class,\n+      ...\n+      service = false\n+)\n+----", "originalCommit": "7cfc680f49abcd0a31763f8fe0816ae63145c90e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMxMzA3OQ==", "url": "https://github.com/infinispan/infinispan/pull/8806#discussion_r514313079", "bodyText": "bah. I forgot to push some changes. sorry.", "author": "oraNod", "createdAt": "2020-10-29T14:42:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU1NTIzMw=="}], "type": "inlineReview"}, {"oid": "9135d4cccb351dda447c456fbddab5d904c4536b", "url": "https://github.com/infinispan/infinispan/commit/9135d4cccb351dda447c456fbddab5d904c4536b", "message": "adapt content for 11.0.x", "committedDate": "2020-10-29T14:40:52Z", "type": "forcePushed"}, {"oid": "e7cde9c4c38bbd3041bf6774fa9f5381ee34e60f", "url": "https://github.com/infinispan/infinispan/commit/e7cde9c4c38bbd3041bf6774fa9f5381ee34e60f", "message": "ISPN-12383 improved clarity in marshalling docs", "committedDate": "2020-10-30T10:21:55Z", "type": "commit"}, {"oid": "e7cde9c4c38bbd3041bf6774fa9f5381ee34e60f", "url": "https://github.com/infinispan/infinispan/commit/e7cde9c4c38bbd3041bf6774fa9f5381ee34e60f", "message": "ISPN-12383 improved clarity in marshalling docs", "committedDate": "2020-10-30T10:21:55Z", "type": "forcePushed"}]}