{"pr_number": 1735, "pr_title": "JDK6 changes to run on CI testing (4.17)", "pr_createdAt": "2020-12-02T09:01:19Z", "pr_url": "https://github.com/jbosstm/narayana/pull/1735", "timeline": [{"oid": "011b321039758f0aa5b5e3bebb3a9eb288b055e4", "url": "https://github.com/jbosstm/narayana/commit/011b321039758f0aa5b5e3bebb3a9eb288b055e4", "message": "[SCRIPTS ONLY] adding arq profile for building to get downloaded all dependencies on build time", "committedDate": "2020-12-01T14:14:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDAxNzc1OA==", "url": "https://github.com/jbosstm/narayana/pull/1735#discussion_r534017758", "bodyText": "Yes I agree with Tom. This command will fail every time since NonExistentTests don't exist.", "author": "mmusgrov", "createdAt": "2020-12-02T09:29:31Z", "path": "scripts/hudson/narayana.sh", "diffHunk": "@@ -208,11 +208,25 @@ function build_as {\n   sed -i \"s/2.1.1/2.2/g\" testsuite/pom.xml\n   sed -i \"s/2.1.1/2.2/g\" testsuite/integration/pom.xml\n \n+  # JAVA_HOME_FOR_BUILD can be used in environment if JDK needs to be different from one which runs e.g. tests.\n+  # This env property is used to build with JDK 1.7 as we need JDK 1.6 has issues to download from SSL\n+  if [ -n \"$JAVA_HOME_FOR_BUILD\" ]; then\n+    local pathOriginal=\"$PATH\"\n+    local javaHomeOriginal=\"$JAVA_HOME\"\n+    export JAVA_HOME=\"$JAVA_HOME_FOR_BUILD\"\n+    export PATH=\"$JAVA_HOME/bin:$PATH\"\n+  fi\n+\n   export MAVEN_OPTS=\"$MAVEN_OPTS -Xms2048m -Xmx2048m -XX:MaxPermSize=1024m\"\n   export JAVA_OPTS=\"$JAVA_OPTS -Xms1303m -Xmx1303m -XX:MaxPermSize=512m\"\n-  (cd .. && ./build.sh -f jboss-as/pom.xml -B clean install -DskipTests -Dts.smoke=false $IPV6_OPTS -Drelease=true -Dversion.org.jboss.jboss-transaction-spi=7.1.0.SP2 -Dversion.org.jboss.jbossts.jbossjts=4.17.44.Final-SNAPSHOT -Dversion.org.jboss.jbossts.jbossjts-integration=4.17.44.Final-SNAPSHOT -Dversion.org.jboss.jbossts.jbossxts=4.17.44.Final-SNAPSHOT -Dversion.org.jboss.jbossts=4.17.44.Final-SNAPSHOT $AS_XARGS)\n+  (cd .. && ./build.sh -f jboss-as/pom.xml -B clean install -Dtest=NonExistentTest -DfailIfNoTests=false -Dts.smoke=false $IPV6_OPTS -Drelease=true -Dversion.org.jboss.jboss-transaction-spi=7.1.0.SP2 -Dversion.org.jboss.jbossts.jbossjts=4.17.44.Final-SNAPSHOT -Dversion.org.jboss.jbossts.jbossjts-integration=4.17.44.Final-SNAPSHOT -Dversion.org.jboss.jbossts.jbossxts=4.17.44.Final-SNAPSHOT -Dversion.org.jboss.jbossts=4.17.44.Final-SNAPSHOT $AS_XARGS)", "originalCommit": "48d6a3d6554c34c2c3d6553502a36a7af00b50de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDAzMjgxNw==", "url": "https://github.com/jbosstm/narayana/pull/1735#discussion_r534032817", "bodyText": "The build is run with -DfailIfNoTests=false which ensures there won't be a failure.\nThe reason for this \"hack\" is that the NonExistentTest is used to not skip the maven surefire plugin dependency resolution and to download even the test dependencies to maven local repo.\nI will add a comment to clarify why this cryptic stuff is used here.\nThanks for objecting this.", "author": "ochaloup", "createdAt": "2020-12-02T09:51:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDAxNzc1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDA0MzEzOA==", "url": "https://github.com/jbosstm/narayana/pull/1735#discussion_r534043138", "bodyText": "Thanks!", "author": "tomjenkinson", "createdAt": "2020-12-02T10:06:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDAxNzc1OA=="}], "type": "inlineReview"}, {"oid": "2625abde8236569ad51ec7bb66578c36685088a2", "url": "https://github.com/jbosstm/narayana/commit/2625abde8236569ad51ec7bb66578c36685088a2", "message": "[JDK6 compatibility] txframework to download right maven artifacts versions when running on JDK6", "committedDate": "2020-12-02T09:49:05Z", "type": "commit"}, {"oid": "2625abde8236569ad51ec7bb66578c36685088a2", "url": "https://github.com/jbosstm/narayana/commit/2625abde8236569ad51ec7bb66578c36685088a2", "message": "[JDK6 compatibility] txframework to download right maven artifacts versions when running on JDK6", "committedDate": "2020-12-02T09:49:05Z", "type": "forcePushed"}]}