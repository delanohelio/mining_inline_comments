{"pr_number": 1546, "pr_title": "JBTM-3242 Set Location header to newly created LRA's", "pr_createdAt": "2020-01-09T19:27:15Z", "pr_url": "https://github.com/jbosstm/narayana/pull/1546", "timeline": [{"oid": "17f537b8ce8504ebd7490329d8d9267e03563641", "url": "https://github.com/jbosstm/narayana/commit/17f537b8ce8504ebd7490329d8d9267e03563641", "message": "JBTM-3242 Set Location header to newly created LRA's", "committedDate": "2020-01-10T10:33:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwMTA0Nw==", "url": "https://github.com/jbosstm/narayana/pull/1546#discussion_r365201047", "bodyText": "FYI I think the comment about LRAInfo might be slightly out of date", "author": "tomjenkinson", "createdAt": "2020-01-10T11:56:18Z", "path": "rts/lra/lra-client/src/main/java/io/narayana/lra/client/NarayanaLRAClient.java", "diffHunk": "@@ -295,7 +295,7 @@ public URI startLRA(URI parentLRA, String clientID, Long timeout, ChronoUnit uni\n             }\n \n             // validate that there is an LRAInfo response header holding the LRAInfo id\n-            Object lraObject = response.getLastHeader(LRA_HTTP_CONTEXT_HEADER);\n+            Object lraObject = response.getLocationHeaderAsURI();", "originalCommit": "17f537b8ce8504ebd7490329d8d9267e03563641", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIxMzA4OA==", "url": "https://github.com/jbosstm/narayana/pull/1546#discussion_r365213088", "bodyText": "Okay, I have just pushed an update.", "author": "mmusgrov", "createdAt": "2020-01-10T12:32:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwMTA0Nw=="}], "type": "inlineReview"}, {"oid": "2eabd9a0474d12a27512583b73072c5e0e23810a", "url": "https://github.com/jbosstm/narayana/commit/2eabd9a0474d12a27512583b73072c5e0e23810a", "message": "JBTM-3242 Set Location header to newly created LRA's", "committedDate": "2020-01-10T12:29:36Z", "type": "commit"}, {"oid": "2eabd9a0474d12a27512583b73072c5e0e23810a", "url": "https://github.com/jbosstm/narayana/commit/2eabd9a0474d12a27512583b73072c5e0e23810a", "message": "JBTM-3242 Set Location header to newly created LRA's", "committedDate": "2020-01-10T12:29:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIyMTcxNA==", "url": "https://github.com/jbosstm/narayana/pull/1546#discussion_r365221714", "bodyText": "I should have mentioned, this LRAInfo comment is stale too. If you change LRAInfo to LRA, and push a commit up agai,  then merge this PR then my approval would still stand. Otherwise, please let me know if you want me to look again.", "author": "tomjenkinson", "createdAt": "2020-01-10T12:58:09Z", "path": "rts/lra/lra-client/src/main/java/io/narayana/lra/client/NarayanaLRAClient.java", "diffHunk": "@@ -286,25 +286,22 @@ public URI startLRA(URI parentLRA, String clientID, Long timeout, ChronoUnit uni\n                     .request()\n                     .post();\n \n-            // validate the HTTP status code says an LRAInfo resource was created\n+            // validate the HTTP status code says an LRA resource was created\n             if (isUnexpectedResponseStatus(response, Response.Status.CREATED)) {\n                 LRALogger.i18NLogger.error_lraCreationUnexpectedStatus(response.getStatus(), response.toString());\n                 throwGenericLRAException(null, INTERNAL_SERVER_ERROR.getStatusCode(),\n                         \"LRA start returned an unexpected status code: \" + response.getStatus());\n                 return null;\n             }\n \n-            // validate that there is an LRAInfo response header holding the LRAInfo id\n-            Object lraObject = response.getLastHeader(LRA_HTTP_CONTEXT_HEADER);\n+            lra = response.getLocationHeaderAsURI();", "originalCommit": "2eabd9a0474d12a27512583b73072c5e0e23810a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIyMjAyMA==", "url": "https://github.com/jbosstm/narayana/pull/1546#discussion_r365222020", "bodyText": "+1", "author": "mmusgrov", "createdAt": "2020-01-10T12:59:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIyMTcxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIyNDEwMw==", "url": "https://github.com/jbosstm/narayana/pull/1546#discussion_r365224103", "bodyText": "Although there are no longer any references to LRAInfo", "author": "mmusgrov", "createdAt": "2020-01-10T13:04:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIyMTcxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTI1NDQ1Mg==", "url": "https://github.com/jbosstm/narayana/pull/1546#discussion_r365254452", "bodyText": "I see you removed this comment I missed the \"-\". I will mark this as resolved", "author": "tomjenkinson", "createdAt": "2020-01-10T14:19:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIyMTcxNA=="}], "type": "inlineReview"}]}