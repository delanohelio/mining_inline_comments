{"pr_number": 1560, "pr_title": "JBTM-3231 LRA testrecovery2 fails", "pr_createdAt": "2020-02-19T10:01:36Z", "pr_url": "https://github.com/jbosstm/narayana/pull/1560", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQzNjQ5NQ==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r382436495", "bodyText": "Could you please remove this line here? I think it's not necessary here anymore when the coordinator runs as a quarkus application.", "author": "ochaloup", "createdAt": "2020-02-21T07:43:29Z", "path": "rts/lra/lra-test/pom.xml", "diffHunk": "@@ -75,7 +75,8 @@\n                 </property>\n             </activation>\n             <properties>\n-                <lra.coordinator.trace.params>-Dthorntail.logging=TRACE</lra.coordinator.trace.params>\n+<!--                <lra.coordinator.trace.params>-Dthorntail.logging=TRACE</lra.coordinator.trace.params>-->", "originalCommit": "a7b9d24150d6ed2ab235fd048bdb36130a6636d2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA5MTM5Mg==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r383091392", "bodyText": "Okay, I will remove this.", "author": "mayankkunwar", "createdAt": "2020-02-24T05:35:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQzNjQ5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQzNzEyMA==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r382437120", "bodyText": "Maybe this variable should be named more precisely? What I mean is that this ENABLE_TRACE_LOGS is meant to work really only for the rts/lra maven module. It's not beneficial for any other Narayana maven module. Could be rather something like ENABLE_LRA_TRACE_LOGS?", "author": "ochaloup", "createdAt": "2020-02-21T07:45:45Z", "path": "scripts/hudson/narayana.sh", "diffHunk": "@@ -56,6 +56,7 @@ function init_test_options {\n     [ x\"$CODE_COVERAGE_ARGS\" != \"x\" ] || CODE_COVERAGE_ARGS=\"\"\n     [ $ARQ_PROF ] || ARQ_PROF=arq\t# IPv4 arquillian profile\n     [ $IBM_ORB ] || IBM_ORB=0\n+    [ $ENABLE_TRACE_LOGS ] || ENABLE_TRACE_LOGS=\" -Ptrace.thorntail.test -Ptrace.lra.coordinator\"", "originalCommit": "a7b9d24150d6ed2ab235fd048bdb36130a6636d2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA5MTU3OA==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r383091578", "bodyText": "Okay, I will make the changes.", "author": "mayankkunwar", "createdAt": "2020-02-24T05:36:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjQzNzEyMA=="}], "type": "inlineReview"}, {"oid": "4722630e50c9018057791a8ebf73180d8f26a47d", "url": "https://github.com/jbosstm/narayana/commit/4722630e50c9018057791a8ebf73180d8f26a47d", "message": "JBTM-3231 LRA testrecovery2 fails", "committedDate": "2020-02-26T05:35:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyODQ4NA==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385028484", "bodyText": "please, remove this line. The lra-coordinator has no tests included under the directory structure and this is not needed.", "author": "ochaloup", "createdAt": "2020-02-27T10:09:49Z", "path": "rts/lra/lra-coordinator/pom.xml", "diffHunk": "@@ -51,6 +51,7 @@\n                 <artifactId>maven-surefire-plugin</artifactId>\n                 <version>${surefire-plugin.version}</version>\n                 <configuration>\n+                    <redirectTestOutputToFile>${test.logs.to.file}</redirectTestOutputToFile>", "originalCommit": "12efb9eecb70331718fca3c20335fb19b782b7ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1NTAyNA==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385055024", "bodyText": "okay", "author": "mayankkunwar", "createdAt": "2020-02-27T10:58:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyODQ4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMDYzOQ==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385030639", "bodyText": "I would vote for removing this comment completely as for anybody who understands the maven it's superfluous.\nIf you want to comment then don't say things like \"this plugin is used for file logging\" which is just not true.\nMaybe you can define some property definitions like test.logs.to.file but it's still a bit dangerous (by my perspective) to say about default value etc. as those are things which change.", "author": "ochaloup", "createdAt": "2020-02-27T10:13:53Z", "path": "rts/lra/pom.xml", "diffHunk": "@@ -101,6 +104,12 @@\n               <groupId>org.sonatype.plugins</groupId>\n               <artifactId>nexus-staging-maven-plugin</artifactId>\n             </plugin>\n+\n+<!--            This plugin is used for file logging, when the logging is enabled. But logging is only enabled when CI job is executed.", "originalCommit": "12efb9eecb70331718fca3c20335fb19b782b7ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1NTY4Mg==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385055682", "bodyText": "Okay, will remove this comment", "author": "mayankkunwar", "createdAt": "2020-02-27T10:59:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMDYzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMTg2Mw==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385031863", "bodyText": "please, remove this property completely. From what I know (if I'm not badly mistaken somehow) the value of ConsoleHandler has first no impact to be passed as -D command line property. Second has for sure no impact to thorntail logging setup.", "author": "ochaloup", "createdAt": "2020-02-27T10:16:12Z", "path": "rts/lra/pom.xml", "diffHunk": "@@ -36,6 +36,9 @@\n \n         <test.logs.to.file>false</test.logs.to.file>\n         <skipITs>true</skipITs> <!-- integration tests are disabled by default, use profile to run 'arq' -->\n+\n+        <thorntail.test.logging></thorntail.test.logging>\n+        <java.util.file.logging.level></java.util.file.logging.level>", "originalCommit": "12efb9eecb70331718fca3c20335fb19b782b7ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1ODQ1Nw==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385058457", "bodyText": "okay", "author": "mayankkunwar", "createdAt": "2020-02-27T11:05:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMTg2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMjYzOQ==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385032639", "bodyText": "please rename the trace.log to lra-coordinator-trace.log or similar", "author": "ochaloup", "createdAt": "2020-02-27T10:17:40Z", "path": "rts/lra/lra-test/pom.xml", "diffHunk": "@@ -75,7 +80,17 @@\n                 </property>\n             </activation>\n             <properties>\n-                <lra.coordinator.trace.params>-Dthorntail.logging=TRACE</lra.coordinator.trace.params>\n+<!--                # Disabling console logging-->\n+                <lra.coordinator.log.console.disable>-Dquarkus.log.console.enable=false</lra.coordinator.log.console.disable>\n+<!--                # Enabling file logging-->\n+                <lra.coordinator.log.file.enable>-Dquarkus.log.file.enable=true</lra.coordinator.log.file.enable>\n+                <lra.coordinator.log.file.level>-Dquarkus.log.file.level=TRACE</lra.coordinator.log.file.level>\n+<!--                # Send output to a trace.log file under the target/failsafe-reports/ directory-->\n+                <lra.coordinator.log.file.path>-Dquarkus.log.file.path=target/failsafe-reports/trace.log</lra.coordinator.log.file.path>", "originalCommit": "12efb9eecb70331718fca3c20335fb19b782b7ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1OTIzNA==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385059234", "bodyText": "will do the same", "author": "mayankkunwar", "createdAt": "2020-02-27T11:07:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMjYzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMzQ3OA==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385033478", "bodyText": "please, use the same indentation for the <!-- as for the rest of the upper and lower lines", "author": "ochaloup", "createdAt": "2020-02-27T10:19:17Z", "path": "rts/lra/lra-test/pom.xml", "diffHunk": "@@ -75,7 +80,17 @@\n                 </property>\n             </activation>\n             <properties>\n-                <lra.coordinator.trace.params>-Dthorntail.logging=TRACE</lra.coordinator.trace.params>\n+<!--                # Disabling console logging-->\n+                <lra.coordinator.log.console.disable>-Dquarkus.log.console.enable=false</lra.coordinator.log.console.disable>\n+<!--                # Enabling file logging-->\n+                <lra.coordinator.log.file.enable>-Dquarkus.log.file.enable=true</lra.coordinator.log.file.enable>\n+                <lra.coordinator.log.file.level>-Dquarkus.log.file.level=TRACE</lra.coordinator.log.file.level>\n+<!--                # Send output to a trace.log file under the target/failsafe-reports/ directory-->", "originalCommit": "12efb9eecb70331718fca3c20335fb19b782b7ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1OTg3Mg==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385059872", "bodyText": "okay", "author": "mayankkunwar", "createdAt": "2020-02-27T11:09:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzMzQ3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzNDE5Nw==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385034197", "bodyText": "I would recommend to use to use property ${project.build.directory}/ rather than the target/ constant", "author": "ochaloup", "createdAt": "2020-02-27T10:20:38Z", "path": "rts/lra/lra-test/pom.xml", "diffHunk": "@@ -75,7 +80,17 @@\n                 </property>\n             </activation>\n             <properties>\n-                <lra.coordinator.trace.params>-Dthorntail.logging=TRACE</lra.coordinator.trace.params>\n+<!--                # Disabling console logging-->\n+                <lra.coordinator.log.console.disable>-Dquarkus.log.console.enable=false</lra.coordinator.log.console.disable>\n+<!--                # Enabling file logging-->\n+                <lra.coordinator.log.file.enable>-Dquarkus.log.file.enable=true</lra.coordinator.log.file.enable>\n+                <lra.coordinator.log.file.level>-Dquarkus.log.file.level=TRACE</lra.coordinator.log.file.level>\n+<!--                # Send output to a trace.log file under the target/failsafe-reports/ directory-->\n+                <lra.coordinator.log.file.path>-Dquarkus.log.file.path=target/failsafe-reports/trace.log</lra.coordinator.log.file.path>", "originalCommit": "12efb9eecb70331718fca3c20335fb19b782b7ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA1OTk2Mw==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385059963", "bodyText": "okay", "author": "mayankkunwar", "createdAt": "2020-02-27T11:09:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzNDE5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzNzc4Ng==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385037786", "bodyText": "I'm a bit concerned about so many log properties. Would you mind to merge it under just one? E.g. lra.coordinator.log.params or similar? And then put all the configuration on one line rather than splitting it over multiple.\nBut this could be only my personal feeling on having the properties too bloated.", "author": "ochaloup", "createdAt": "2020-02-27T10:27:04Z", "path": "rts/lra/lra-test/pom.xml", "diffHunk": "@@ -23,7 +23,12 @@\n     <properties>\n         <lra.coordinator.exec.plugin.phase>none</lra.coordinator.exec.plugin.phase> <!-- not starting coordinator by default, need -Parq -->\n         <lra.coordinator.port>8080</lra.coordinator.port>\n-        <lra.coordinator.trace.params></lra.coordinator.trace.params>\n+        <lra.coordinator.log.console.disable></lra.coordinator.log.console.disable>", "originalCommit": "12efb9eecb70331718fca3c20335fb19b782b7ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTA2MDk1Mw==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385060953", "bodyText": "okay, will make the changes", "author": "mayankkunwar", "createdAt": "2020-02-27T11:11:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzNzc4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEwMjc1MQ==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r385102751", "bodyText": "I tried merging them, but after that functionality stopped working. So for now I will leave this as it is.", "author": "mayankkunwar", "createdAt": "2020-02-27T12:44:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAzNzc4Ng=="}], "type": "inlineReview"}, {"oid": "4699cd3dca9848894d4a030455748debb7d26056", "url": "https://github.com/jbosstm/narayana/commit/4699cd3dca9848894d4a030455748debb7d26056", "message": "JBTM-3231 LRA testrecovery2 fails", "committedDate": "2020-02-28T11:03:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA0MDA1MQ==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r387040051", "bodyText": "We should only log narayana specific messages which can be done by appending the log category to the property name. So this line should be\n<thorntail.test.logging>-Dthorntail.logging.com.arjuna=TRACE -Dthorntail.logging.io.narayana.lra=TRACE</thorntail.test.logging>\n\nThere is a similar line in TCK pom:\n<lra.tck.suite.thorntail.trace.params>-Dthorntail.logging.com.arjuna=TRACE -Dthorntail.logging.io.narayana.lra=TRACE</lra.tck.suite.thorntail.trace.params>\n\nBTW why do we need to repeat this property with a different name. Can they be combined.", "author": "mmusgrov", "createdAt": "2020-03-03T14:05:56Z", "path": "rts/lra/pom.xml", "diffHunk": "@@ -170,6 +177,18 @@\n           </properties>\n       </profile>\n \n+        <profile>\n+            <id>trace.thorntail.test</id>\n+            <activation>\n+                <property>\n+                    <name>trace.thorntail.test</name>\n+                </property>\n+            </activation>\n+            <properties>\n+                <thorntail.test.logging>-Dthorntail.logging=TRACE</thorntail.test.logging>", "originalCommit": "4699cd3dca9848894d4a030455748debb7d26056", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ1NzIwOQ==", "url": "https://github.com/jbosstm/narayana/pull/1560#discussion_r387457209", "bodyText": "Okay, I will change the property to \"-Dthorntail.logging.com.arjuna=TRACE\"\nIn TCK there is same property repeated because maybe in case, we want to enable, only TCK trace logs. But for now it is not the case, so I will remove the duplication part and will apply same property to both places, i.e. \"thorntail.test.logging\"", "author": "mayankkunwar", "createdAt": "2020-03-04T05:35:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzA0MDA1MQ=="}], "type": "inlineReview"}, {"oid": "4919ff9b08b91536ef71792dbe51c83aaa6524e2", "url": "https://github.com/jbosstm/narayana/commit/4919ff9b08b91536ef71792dbe51c83aaa6524e2", "message": "JBTM-3231 LRA testrecovery2 fails", "committedDate": "2020-03-04T10:10:54Z", "type": "forcePushed"}, {"oid": "7d91870bdc1bbeaa9eac4e43e50d720eaa04e95c", "url": "https://github.com/jbosstm/narayana/commit/7d91870bdc1bbeaa9eac4e43e50d720eaa04e95c", "message": "JBTM-3231 LRA testrecovery2 fails", "committedDate": "2020-03-04T17:09:27Z", "type": "commit"}, {"oid": "7d91870bdc1bbeaa9eac4e43e50d720eaa04e95c", "url": "https://github.com/jbosstm/narayana/commit/7d91870bdc1bbeaa9eac4e43e50d720eaa04e95c", "message": "JBTM-3231 LRA testrecovery2 fails", "committedDate": "2020-03-04T17:09:27Z", "type": "forcePushed"}]}