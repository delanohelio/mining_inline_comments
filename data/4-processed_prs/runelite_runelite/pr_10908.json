{"pr_number": 10908, "pr_title": "Check player animation to update fishing status", "pr_createdAt": "2020-02-28T20:36:33Z", "pr_url": "https://github.com/runelite/runelite/pull/10908", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk0NDI0OQ==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r385944249", "bodyText": "This isn't a fishing animation", "author": "Nightfirecat", "createdAt": "2020-02-28T22:06:06Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +57,23 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()\n+\t\t\t.add(AnimationID.FISHING_BARBTAIL_HARPOON)\n+\t\t\t.add(AnimationID.FISHING_BAREHAND)\n+\t\t\t.add(AnimationID.FISHING_BIG_NET)\n+\t\t\t.add(AnimationID.FISHING_CAGE)\n+\t\t\t.add(AnimationID.FISHING_CRUSHING_INFERNAL_EELS)", "originalCommit": "1de317c927a12f2ea1cc9ebdfe04a960f26fb87c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk0NDU1NA==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r385944554", "bodyText": "This isn't a fishing animation", "author": "Nightfirecat", "createdAt": "2020-02-28T22:07:07Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +57,23 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()\n+\t\t\t.add(AnimationID.FISHING_BARBTAIL_HARPOON)\n+\t\t\t.add(AnimationID.FISHING_BAREHAND)\n+\t\t\t.add(AnimationID.FISHING_BIG_NET)\n+\t\t\t.add(AnimationID.FISHING_CAGE)\n+\t\t\t.add(AnimationID.FISHING_CRUSHING_INFERNAL_EELS)\n+\t\t\t.add(AnimationID.FISHING_CRYSTAL_HARPOON)\n+\t\t\t.add(AnimationID.FISHING_CUTTING_SACRED_EELS)", "originalCommit": "1de317c927a12f2ea1cc9ebdfe04a960f26fb87c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk0NTI3MQ==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r385945271", "bodyText": "I don't see a need to specifically check this case if we're adding an animation check.", "author": "Nightfirecat", "createdAt": "2020-02-28T22:09:12Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -78,7 +98,9 @@ public Dimension render(Graphics2D graphics)\n \t\tpanelComponent.getChildren().clear();\n \t\tif (client.getLocalPlayer().getInteracting() != null\n \t\t\t&& client.getLocalPlayer().getInteracting().getName().contains(FISHING_SPOT)\n-\t\t\t&& client.getLocalPlayer().getInteracting().getGraphic() != GraphicID.FLYING_FISH)\n+\t\t\t&& client.getLocalPlayer().getInteracting().getGraphic() != GraphicID.FLYING_FISH\n+\t\t\t&& client.getWidget(WidgetInfo.LEVEL_UP) == null", "originalCommit": "1de317c927a12f2ea1cc9ebdfe04a960f26fb87c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk1NjcyMw==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r385956723", "bodyText": "After level up dialogue the fishing animation continues for some time, and it was unclear to me if fishing was actually taking place, but I agree it's unneeded and it has been removed along with non-fishing animations.", "author": "BrandtHill", "createdAt": "2020-02-28T22:45:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk0NTI3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIxMTAzNg==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r389211036", "bodyText": "This animation is uninterrupted, however a different animation plays when a player has caught a fish bare-handed, and that animation is missing here. (There are different animations for each type of fish caught)", "author": "Nightfirecat", "createdAt": "2020-03-07T01:10:09Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +56,21 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()\n+\t\t\t.add(AnimationID.FISHING_BARBTAIL_HARPOON)\n+\t\t\t.add(AnimationID.FISHING_BAREHAND)", "originalCommit": "0596cf9179ce5df4d1a3d1d1d46c3de7c5a3b297", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM0NDU1NA==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r389344554", "bodyText": "I found four new undocumented animations (6703, 6704 upon start, 6710, 6711 upon catch) whilst barehanded fishing for Tuna. My Fishing level is 63. Can anyone with a higher fishing level let me know what the animation IDs are for Swordfish and Sharks?\nTo find I'd just throw if (client.getLocalPlayer().getAnimation() != -1) log.info(\"Animation: {}\", client.getLocalPlayer().getAnimation()); at the top of onGameTick()", "author": "BrandtHill", "createdAt": "2020-03-08T07:48:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIxMTAzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM0NTEyMg==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r389345122", "bodyText": "These Barehanded caught animations (and maybe windup ones too) are specific to Tuna, so names are subject to change once we figure out what Shark/Swordfish ones are", "author": "BrandtHill", "createdAt": "2020-03-08T07:57:27Z", "path": "runelite-api/src/main/java/net/runelite/api/AnimationID.java", "diffHunk": "@@ -103,6 +103,10 @@\n \tpublic static final int FISHING_CRUSHING_INFERNAL_EELS = 7553;\n \tpublic static final int FISHING_CUTTING_SACRED_EELS = 7151;\n \tpublic static final int FISHING_BAREHAND = 6709;\n+\tpublic static final int FISHING_BAREHAND_WINDUP_1 = 6703;\n+\tpublic static final int FISHING_BAREHAND_WINDUP_2 = 6704;\n+\tpublic static final int FISHING_BAREHAND_CAUGHT_1 = 6710;\n+\tpublic static final int FISHING_BAREHAND_CAUGHT_2 = 6711;", "originalCommit": "d8ac428c591b81c7829df39297e92334e6c07780", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQxNDk1Mg==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r391414952", "bodyText": "These are not named correctly. Since these apply only to tuna, they should be named appropriately to reflect that.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic static final int FISHING_BAREHAND_CAUGHT_1 = 6710;\n          \n          \n            \n            \tpublic static final int FISHING_BAREHAND_CAUGHT_2 = 6711;\n          \n          \n            \n            \tpublic static final int FISHING_BAREHAND_CAUGHT_TUNA_1 = 6710;\n          \n          \n            \n            \tpublic static final int FISHING_BAREHAND_CAUGHT_TUNA_2 = 6711;", "author": "Nightfirecat", "createdAt": "2020-03-12T05:57:33Z", "path": "runelite-api/src/main/java/net/runelite/api/AnimationID.java", "diffHunk": "@@ -103,6 +103,10 @@\n \tpublic static final int FISHING_CRUSHING_INFERNAL_EELS = 7553;\n \tpublic static final int FISHING_CUTTING_SACRED_EELS = 7151;\n \tpublic static final int FISHING_BAREHAND = 6709;\n+\tpublic static final int FISHING_BAREHAND_WINDUP_1 = 6703;\n+\tpublic static final int FISHING_BAREHAND_WINDUP_2 = 6704;\n+\tpublic static final int FISHING_BAREHAND_CAUGHT_1 = 6710;\n+\tpublic static final int FISHING_BAREHAND_CAUGHT_2 = 6711;", "originalCommit": "d8ac428c591b81c7829df39297e92334e6c07780", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQyMzM4OA==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r391423388", "bodyText": "Thank you for finding the rest of these animations.", "author": "BrandtHill", "createdAt": "2020-03-12T06:30:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQxNDk1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMyNDUyNg==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r392324526", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()\n          \n          \n            \n            \tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<>()", "author": "Adam-", "createdAt": "2020-03-13T16:08:35Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +56,29 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = new ImmutableSet.Builder<Integer>()", "originalCommit": "2c176dc54fe4987d02ffc1893467eea1e8487a96", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM1MDU4Mg==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r392350582", "bodyText": "Type inference doesn't work here", "author": "BrandtHill", "createdAt": "2020-03-13T16:51:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMyNDUyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM1MTA5NA==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r392351094", "bodyText": "use https://guava.dev/releases/19.0/api/docs/com/google/common/collect/ImmutableSet.html#of(E,%20E,%20E,%20E,%20E,%20E,%20E...)", "author": "Adam-", "createdAt": "2020-03-13T16:52:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMyNDUyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM3MDIzMg==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r392370232", "bodyText": "You got it", "author": "BrandtHill", "createdAt": "2020-03-13T17:27:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMyNDUyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUxOTEyOQ==", "url": "https://github.com/runelite/runelite/pull/10908#discussion_r392519129", "bodyText": "This field can be made static, be defined as a Set (or even a Collection since we're not calling any set-specific methods of it), and renamed to match the constant naming schema:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate final ImmutableSet<Integer> fishingAnimations = ImmutableSet.of(\n          \n          \n            \n            \tprivate static final Set<Integer> FISHING_ANIMATIONS = ImmutableSet.of(", "author": "Nightfirecat", "createdAt": "2020-03-13T22:52:04Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/fishing/FishingOverlay.java", "diffHunk": "@@ -54,6 +56,28 @@\n \n \tprivate final PanelComponent panelComponent = new PanelComponent();\n \n+\tprivate final ImmutableSet<Integer> fishingAnimations = ImmutableSet.of(", "originalCommit": "d731ae6a823745ce7617fe863176aa82334193b2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "266eeee85e14ad9572ace71d089b90b7e5d7ae7e", "url": "https://github.com/runelite/runelite/commit/266eeee85e14ad9572ace71d089b90b7e5d7ae7e", "message": "fishing: Check player animation to update fishing status\n\nThis commit adds an animation check to the other fishing status checks\nalready present in the fishing overlay (interacting and fishing spot NPC\nname check) to ensure that the status correctly changes to \"NOT fishing\"\nwhen the player's fishing animation is interrupted by certain actions\nsuch as being presented with a level-up dialog. This commit causes one\nother behavioral change as a side effect, which is that the player's\nfishing status will be \"NOT fishing\" while running toward a distant\nfishing spot until they reach it and start their fishing animation.\n\nFixes runelite/runelite#10900", "committedDate": "2020-03-14T02:15:40Z", "type": "forcePushed"}, {"oid": "eb098792053145a2e44410b2c60475799d493890", "url": "https://github.com/runelite/runelite/commit/eb098792053145a2e44410b2c60475799d493890", "message": "fishing: Check player animation to update fishing status\n\nThis commit adds an animation check to the other fishing status checks\nalready present in the fishing overlay (interacting and fishing spot NPC\nname check) to ensure that the status correctly changes to \"NOT fishing\"\nwhen the player's fishing animation is interrupted by certain actions\nsuch as being presented with a level-up dialog. This commit causes one\nother behavioral change as a side effect, which is that the player's\nfishing status will be \"NOT fishing\" while running toward a distant\nfishing spot until they reach it and start their fishing animation.\n\nFixes runelite/runelite#10900", "committedDate": "2020-03-14T02:21:18Z", "type": "commit"}, {"oid": "eb098792053145a2e44410b2c60475799d493890", "url": "https://github.com/runelite/runelite/commit/eb098792053145a2e44410b2c60475799d493890", "message": "fishing: Check player animation to update fishing status\n\nThis commit adds an animation check to the other fishing status checks\nalready present in the fishing overlay (interacting and fishing spot NPC\nname check) to ensure that the status correctly changes to \"NOT fishing\"\nwhen the player's fishing animation is interrupted by certain actions\nsuch as being presented with a level-up dialog. This commit causes one\nother behavioral change as a side effect, which is that the player's\nfishing status will be \"NOT fishing\" while running toward a distant\nfishing spot until they reach it and start their fishing animation.\n\nFixes runelite/runelite#10900", "committedDate": "2020-03-14T02:21:18Z", "type": "forcePushed"}]}