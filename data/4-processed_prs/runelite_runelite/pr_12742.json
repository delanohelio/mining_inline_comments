{"pr_number": 12742, "pr_title": "zalcano: add damage counter", "pr_createdAt": "2020-11-03T23:40:29Z", "pr_url": "https://github.com/runelite/runelite/pull/12742", "timeline": [{"oid": "d9109f2d233be9117db250b578d12c850460f862", "url": "https://github.com/runelite/runelite/commit/d9109f2d233be9117db250b578d12c850460f862", "message": "zalcano: add damage counter\n\nAdds a panel which tracks damage dealt to Zalcano's health and shield\nto make it easier prioritising what to focus on at a low level.", "committedDate": "2020-11-03T23:47:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjI5NzE4OQ==", "url": "https://github.com/runelite/runelite/pull/12742#discussion_r532297189", "bodyText": "We think Zolcano is never an instance. Also this means you can move this off of the client thread if you need.", "author": "Adam-", "createdAt": "2020-11-30T00:50:21Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/zalcano/ZalcanoPlugin.java", "diffHunk": "@@ -183,4 +223,47 @@ public void onProjectileMoved(ProjectileMoved event)\n \t\t\ttargetedGlowingRockEndCycle = projectile.getEndCycle();\n \t\t}\n \t}\n+\n+\t@Subscribe\n+\tpublic void onHitsplatApplied(HitsplatApplied event)\n+\t{\n+\t\tfinal Actor actor = event.getActor();\n+\n+\t\tif (!(actor instanceof NPC))\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tint npcId = ((NPC) actor).getId();\n+\n+\t\tif (!(npcId == ZALCANO_WEAKENED || npcId == ZALCANO))\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tint damage = event.getHitsplat().getAmount();\n+\t\tHitsplat.HitsplatType type = event.getHitsplat().getHitsplatType();\n+\n+\t\tswitch (type)\n+\t\t{\n+\t\t\tcase DAMAGE_ME:\n+\t\t\t\thealthDamage += damage;\n+\t\t\t\tbreak;\n+\t\t\tcase DAMAGE_ME_ORANGE:\n+\t\t\t\tshieldDamage += damage;\n+\t\t\t\tbreak;\n+\t\t}\n+\t}\n+\n+\tprivate boolean checkArea()\n+\t{\n+\t\tfinal Player localPlayer = client.getLocalPlayer();\n+\t\tif (localPlayer == null)\n+\t\t{\n+\t\t\treturn false;\n+\t\t}\n+\n+\t\tfinal WorldPoint point = WorldPoint.fromLocalInstance(client, localPlayer.getLocalLocation());", "originalCommit": "d9109f2d233be9117db250b578d12c850460f862", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjI5ODE0NQ==", "url": "https://github.com/runelite/runelite/pull/12742#discussion_r532298145", "bodyText": "If you were to leave in the middle of a round this would not reset, is there a better way to do that?", "author": "Adam-", "createdAt": "2020-11-30T00:56:09Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/zalcano/ZalcanoPlugin.java", "diffHunk": "@@ -132,6 +161,11 @@ public void onNpcDespawned(NpcDespawned event)\n \t\tif (npc.getId() == ZALCANO_WEAKENED)\n \t\t{\n \t\t\tclient.clearHintArrow();\n+\n+\t\t\tif (npc.isDead())", "originalCommit": "d9109f2d233be9117db250b578d12c850460f862", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjI5OTI0Mw==", "url": "https://github.com/runelite/runelite/pull/12742#discussion_r532299243", "bodyText": "This and the rocks.clear() should just be in if (event.getGameState() == GameState.LOADING)", "author": "Adam-", "createdAt": "2020-11-30T01:03:28Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/zalcano/ZalcanoPlugin.java", "diffHunk": "@@ -111,6 +135,11 @@ public void onGameStateChanged(GameStateChanged event)\n \t\t{\n \t\t\trocks.clear();\n \t\t}\n+\t\telse\n+\t\t{\n+\t\t\tinCavern = checkArea();", "originalCommit": "d9109f2d233be9117db250b578d12c850460f862", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "542a6e7498e67d07f829c3a28910a9e490288c00", "url": "https://github.com/runelite/runelite/commit/542a6e7498e67d07f829c3a28910a9e490288c00", "message": "zalcano: add damage counter\n\nAdds a panel which tracks damage dealt to Zalcano's health and shield\nto make it easier prioritising what to focus on at a low level.\n\nCo-authored-by: Adam <Adam@sigterm.info>", "committedDate": "2020-12-01T03:10:19Z", "type": "forcePushed"}, {"oid": "ec69e7bf6f5b31adcf20c42d8ded09410ff40511", "url": "https://github.com/runelite/runelite/commit/ec69e7bf6f5b31adcf20c42d8ded09410ff40511", "message": "zalcano: add damage counter\n\nAdds a panel which tracks damage dealt to Zalcano's health and shield\nto make it easier prioritising what to focus on at a low level.\n\nCo-authored-by: Adam <Adam@sigterm.info>", "committedDate": "2020-12-12T18:15:32Z", "type": "forcePushed"}, {"oid": "86771fb222f589972e4ee861a9c61ca22c0f8212", "url": "https://github.com/runelite/runelite/commit/86771fb222f589972e4ee861a9c61ca22c0f8212", "message": "zalcano: add damage counter\n\nAdds a panel which tracks damage dealt to Zalcano's health and shield\nto make it easier prioritising what to focus on at a low level.\n\nCo-authored-by: Adam <Adam@sigterm.info>", "committedDate": "2020-12-13T15:37:46Z", "type": "commit"}, {"oid": "86771fb222f589972e4ee861a9c61ca22c0f8212", "url": "https://github.com/runelite/runelite/commit/86771fb222f589972e4ee861a9c61ca22c0f8212", "message": "zalcano: add damage counter\n\nAdds a panel which tracks damage dealt to Zalcano's health and shield\nto make it easier prioritising what to focus on at a low level.\n\nCo-authored-by: Adam <Adam@sigterm.info>", "committedDate": "2020-12-13T15:37:46Z", "type": "forcePushed"}]}