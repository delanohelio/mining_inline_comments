{"pr_number": 10973, "pr_title": "friendicons: add note icon in friends/ignore list", "pr_createdAt": "2020-03-07T01:28:12Z", "pr_url": "https://github.com/runelite/runelite/pull/10973", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMjk5NA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389222994", "bodyText": "This should use its own icon. (whether that's a copy of the notes plugin's icon or something else is fine) Maybe there's an ingame sprite which might work well for this?", "author": "Nightfirecat", "createdAt": "2020-03-07T03:20:24Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -84,19 +100,94 @@\n \t@Inject\n \tprivate ChatboxPanelManager chatboxPanelManager;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n+\t@Inject\n+\tprivate FriendNotesConfig config;\n+\n \t@Getter\n \tprivate HoveredFriend hoveredFriend = null;\n \n+\tprivate int iconIdx = -1;\n+\tprivate String currentlyLayouting = null;\n+\n+\t@Provides\n+\tprivate FriendNotesConfig getConfig(ConfigManager configManager)\n+\t{\n+\t\treturn configManager.getConfig(FriendNotesConfig.class);\n+\t}\n+\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n \t\toverlayManager.add(overlay);\n+\t\tloadIcon();\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\trebuildFriendsList();\n+\t\t\trebuildIgnoreList();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onGameStateChanged(GameStateChanged event)\n+\t{\n+\t\tif (event.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tloadIcon();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (!event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\trebuildFriendsList();\n+\t\t\trebuildIgnoreList();\n+\t\t}\n+\t}\n+\n+\tprivate void loadIcon()\n+\t{\n+\t\tfinal IndexedSprite[] modIcons = client.getModIcons();\n+\t\tif (iconIdx != -1 || modIcons == null)\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tfinal IndexedSprite[] newIcons = Arrays.copyOf(modIcons, modIcons.length + 1);\n+\t\ticonIdx = modIcons.length;\n+\t\ttry\n+\t\t{\n+\t\t\tfinal BufferedImage iconImg = ImageIO.read(NotesPlugin.class.getResourceAsStream(\"notes_icon.png\"));", "originalCommit": "213a0cf7c8c813e857125f4c3d2746040529c15d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI1MDQ3Nw==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389250477", "bodyText": "couldnt find a good in game sprite (has to be a modicon) so copypasted the notes icon", "author": "ThatGamerBlue", "createdAt": "2020-03-07T12:10:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMjk5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzMyOA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389223328", "bodyText": "How do you come to 14x12 as the dimensions? The scripts seem to indicate that the \"Previous name\" icon is 14x14", "author": "Nightfirecat", "createdAt": "2020-03-07T03:25:31Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -68,6 +82,8 @@\n \tprivate static final String EDIT_NOTE = \"Edit Note\";\n \tprivate static final String NOTE_PROMPT_FORMAT = \"%s's Notes<br>\" +\n \t\tColorUtil.prependColorTag(\"(Limit %s Characters)\", new Color(0, 0, 170));\n+\tprivate static final int ICON_WIDTH = 14;\n+\tprivate static final int ICON_HEIGHT = 12;", "originalCommit": "213a0cf7c8c813e857125f4c3d2746040529c15d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0OTYxNA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389249614", "bodyText": "this is the dimensions of the icon that we add, maybe a better name?", "author": "ThatGamerBlue", "createdAt": "2020-03-07T11:54:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzMyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzQ0OA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389223448", "bodyText": "Since the meaning the parameters is known, they should be listed in the javadoc. See some of the earlier ScriptID entries for examples.", "author": "Nightfirecat", "createdAt": "2020-03-07T03:27:12Z", "path": "runelite-api/src/main/java/net/runelite/api/ScriptID.java", "diffHunk": "@@ -233,4 +233,16 @@\n \t */\n \t@ScriptArguments(integer = 2)\n \tpublic static final int TOPLEVEL_RESIZE = 909;\n+\n+\t/**\n+\t * Called when the friends list is updated", "originalCommit": "213a0cf7c8c813e857125f4c3d2746040529c15d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzU3Mw==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389223573", "bodyText": "While this file doesn't seem to maintain the usual definitions order of getConfig(), startUp(), shutDown(), @Subscribers, then instance/static methods (it has some instance methods mixed with the subscribers), shutDown() should definitely be defined here before defining any more subscribers.", "author": "Nightfirecat", "createdAt": "2020-03-07T03:29:16Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -84,19 +100,94 @@\n \t@Inject\n \tprivate ChatboxPanelManager chatboxPanelManager;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n+\t@Inject\n+\tprivate FriendNotesConfig config;\n+\n \t@Getter\n \tprivate HoveredFriend hoveredFriend = null;\n \n+\tprivate int iconIdx = -1;\n+\tprivate String currentlyLayouting = null;\n+\n+\t@Provides\n+\tprivate FriendNotesConfig getConfig(ConfigManager configManager)\n+\t{\n+\t\treturn configManager.getConfig(FriendNotesConfig.class);\n+\t}\n+\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n \t\toverlayManager.add(overlay);\n+\t\tloadIcon();\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\trebuildFriendsList();\n+\t\t\trebuildIgnoreList();\n+\t\t}\n+\t}\n+\n+\t@Subscribe", "originalCommit": "213a0cf7c8c813e857125f4c3d2746040529c15d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzYyMg==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389223622", "bodyText": "Check both config group and config key.", "author": "Nightfirecat", "createdAt": "2020-03-07T03:30:09Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -84,19 +100,94 @@\n \t@Inject\n \tprivate ChatboxPanelManager chatboxPanelManager;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n+\t@Inject\n+\tprivate FriendNotesConfig config;\n+\n \t@Getter\n \tprivate HoveredFriend hoveredFriend = null;\n \n+\tprivate int iconIdx = -1;\n+\tprivate String currentlyLayouting = null;\n+\n+\t@Provides\n+\tprivate FriendNotesConfig getConfig(ConfigManager configManager)\n+\t{\n+\t\treturn configManager.getConfig(FriendNotesConfig.class);\n+\t}\n+\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n \t\toverlayManager.add(overlay);\n+\t\tloadIcon();\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\trebuildFriendsList();\n+\t\t\trebuildIgnoreList();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onGameStateChanged(GameStateChanged event)\n+\t{\n+\t\tif (event.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tloadIcon();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (!event.getGroup().equals(CONFIG_GROUP))", "originalCommit": "213a0cf7c8c813e857125f4c3d2746040529c15d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTI0OTM2Nw==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389249367", "bodyText": "we need to rebuild the list when a note changes too, imo the easiest way is to do it here", "author": "ThatGamerBlue", "createdAt": "2020-03-07T11:50:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzYyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMyMjkyOQ==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389322929", "bodyText": "List rebuilding can be explicitly added to the tail end of setFriendNote() instead of implicitly called here after the config change event dispatches. Alternately, you can check that the key matches \"showIcons\" or starts with KEY_PREFIX.", "author": "Nightfirecat", "createdAt": "2020-03-08T00:21:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzYyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzY0Ng==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389223646", "bodyText": "Make the plugin's config group package-private and reference it here.", "author": "Nightfirecat", "createdAt": "2020-03-07T03:30:33Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesConfig.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package net.runelite.client.plugins.friendnotes;\n+\n+import net.runelite.client.config.Config;\n+import net.runelite.client.config.ConfigGroup;\n+import net.runelite.client.config.ConfigItem;\n+\n+@ConfigGroup(\"friendNotes\")", "originalCommit": "213a0cf7c8c813e857125f4c3d2746040529c15d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzg2NA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389223864", "bodyText": "Use a guard clause instead:\nif (!config.showIcons())\n{\n\treturn;\n}\n\n// function code continues here", "author": "Nightfirecat", "createdAt": "2020-03-07T03:33:31Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -258,4 +349,76 @@ public void onRemovedFriend(RemovedFriend event)\n \t\tlog.debug(\"Remove friend: '{}'\", displayName);\n \t\tsetFriendNote(displayName, null);\n \t}\n+\n+\t@Subscribe\n+\tpublic void onScriptCallbackEvent(ScriptCallbackEvent event)\n+\t{\n+\t\tif (config.showIcons())", "originalCommit": "213a0cf7c8c813e857125f4c3d2746040529c15d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTIyMzk0OA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389223948", "bodyText": "A switch statement would make this a bit cleaner:\nswitch (event.getName())\n{\n\tcase \"friend_cc_settext\":\n\tcase \"ignore_cc_settext\":\n\t{\n\t\t// ...\n\t}\n\tcase \"friend_cc_setposition\":\n\tcase \"ignore_cc_setposition\":\n\t{\n\t\t// ...\n\t}\n}", "author": "Nightfirecat", "createdAt": "2020-03-07T03:34:51Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -258,4 +349,76 @@ public void onRemovedFriend(RemovedFriend event)\n \t\tlog.debug(\"Remove friend: '{}'\", displayName);\n \t\tsetFriendNote(displayName, null);\n \t}\n+\n+\t@Subscribe\n+\tpublic void onScriptCallbackEvent(ScriptCallbackEvent event)\n+\t{\n+\t\tif (config.showIcons())\n+\t\t{\n+\t\t\tif (event.getEventName().equals(\"friend_cc_settext\") || event.getEventName().equals(\"ignore_cc_settext\"))", "originalCommit": "213a0cf7c8c813e857125f4c3d2746040529c15d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMzMTQyMA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r389331420", "bodyText": "These conditions can all be combined.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (!event.getGroup().equals(CONFIG_GROUP))\n          \n          \n            \n            \t\t{\n          \n          \n            \n            \t\t\treturn;\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\tif (!event.getKey().equals(\"showIcons\"))\n          \n          \n            \n            \t\t{\n          \n          \n            \n            \t\t\treturn;\n          \n          \n            \n            \t\t}\n          \n          \n            \n            \n          \n          \n            \n            \t\tif (client.getGameState() == GameState.LOGGED_IN)\n          \n          \n            \n            \t\tif (event.getGroup().equals(CONFIG_GROUP) && event.getKey().equals(\"showIcons\") && client.getGameState() == GameState.LOGGED_IN)", "author": "Nightfirecat", "createdAt": "2020-03-08T03:24:54Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -84,19 +99,74 @@\n \t@Inject\n \tprivate ChatboxPanelManager chatboxPanelManager;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n+\t@Inject\n+\tprivate FriendNotesConfig config;\n+\n \t@Getter\n \tprivate HoveredFriend hoveredFriend = null;\n \n+\tprivate int iconIdx = -1;\n+\tprivate String currentlyLayouting = null;\n+\n+\t@Provides\n+\tprivate FriendNotesConfig getConfig(ConfigManager configManager)\n+\t{\n+\t\treturn configManager.getConfig(FriendNotesConfig.class);\n+\t}\n+\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n \t\toverlayManager.add(overlay);\n+\t\tloadIcon();\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\trebuildFriendsList();\n+\t\t\trebuildIgnoreList();\n+\t\t}\n \t}\n \n \t@Override\n \tprotected void shutDown() throws Exception\n \t{\n \t\toverlayManager.remove(overlay);\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\trebuildFriendsList();\n+\t\t\trebuildIgnoreList();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onGameStateChanged(GameStateChanged event)\n+\t{\n+\t\tif (event.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tloadIcon();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (!event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tif (!event.getKey().equals(\"showIcons\"))\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)", "originalCommit": "399593ac2667fbb3715b8e2c4d61d9cee082a756", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwNTcwNg==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r391405706", "bodyText": "This is the default initialized value of this field, it does not need to be explicitly defined.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate String currentlyLayouting = null;\n          \n          \n            \n            \tprivate String currentlyLayouting;", "author": "Nightfirecat", "createdAt": "2020-03-12T05:16:54Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -84,19 +99,74 @@\n \t@Inject\n \tprivate ChatboxPanelManager chatboxPanelManager;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n+\t@Inject\n+\tprivate FriendNotesConfig config;\n+\n \t@Getter\n \tprivate HoveredFriend hoveredFriend = null;\n \n+\tprivate int iconIdx = -1;\n+\tprivate String currentlyLayouting = null;", "originalCommit": "ff76a51cb90240e5fdf257d5e65d5a1a16ea6e7e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc2NzE5OA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r391767198", "bodyText": "changed", "author": "ThatGamerBlue", "createdAt": "2020-03-12T17:09:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwNTcwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM0MDM1MA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r392340350", "bodyText": "This is not thread-safe.", "author": "Adam-", "createdAt": "2020-03-13T16:35:29Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -84,19 +99,74 @@\n \t@Inject\n \tprivate ChatboxPanelManager chatboxPanelManager;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n+\t@Inject\n+\tprivate FriendNotesConfig config;\n+\n \t@Getter\n \tprivate HoveredFriend hoveredFriend = null;\n \n+\tprivate int iconIdx = -1;\n+\tprivate String currentlyLayouting;\n+\n+\t@Provides\n+\tprivate FriendNotesConfig getConfig(ConfigManager configManager)\n+\t{\n+\t\treturn configManager.getConfig(FriendNotesConfig.class);\n+\t}\n+\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n \t\toverlayManager.add(overlay);\n+\t\tloadIcon();", "originalCommit": "f88b6cd860a86abcda8017aa5eb7902ffa88a2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM0MzA3OA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r392343078", "bodyText": "I would maybe also check iconidx somehow isn't set here", "author": "Adam-", "createdAt": "2020-03-13T16:40:17Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -258,4 +333,107 @@ public void onRemovedFriend(RemovedFriend event)\n \t\tlog.debug(\"Remove friend: '{}'\", displayName);\n \t\tsetFriendNote(displayName, null);\n \t}\n+\n+\t@Subscribe\n+\tpublic void onScriptCallbackEvent(ScriptCallbackEvent event)\n+\t{\n+\t\tif (!config.showIcons())\n+\t\t{\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tswitch (event.getEventName())\n+\t\t{\n+\t\t\tcase \"friend_cc_settext\":\n+\t\t\tcase \"ignore_cc_settext\":\n+\t\t\t\tString[] stringStack = client.getStringStack();\n+\t\t\t\tint stringStackSize = client.getStringStackSize();\n+\t\t\t\tfinal String rsn = stringStack[stringStackSize - 1];\n+\t\t\t\tfinal String sanitized = Text.toJagexName(Text.removeTags(rsn));\n+\t\t\t\tcurrentlyLayouting = sanitized;\n+\t\t\t\tif (getFriendNote(sanitized) != null)\n+\t\t\t\t{\n+\t\t\t\t\tstringStack[stringStackSize - 1] = rsn + \" <img=\" + iconIdx + \">\";", "originalCommit": "f88b6cd860a86abcda8017aa5eb7902ffa88a2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM4MTEwNQ==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r392381105", "bodyText": "not sure if thats what you meant but i added a guard clause if iconidx == -1 return", "author": "ThatGamerBlue", "createdAt": "2020-03-13T17:48:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM0MzA3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM0Mzc5MA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r392343790", "bodyText": "What is this for? can this happen?", "author": "Adam-", "createdAt": "2020-03-13T16:41:08Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesPlugin.java", "diffHunk": "@@ -84,19 +99,74 @@\n \t@Inject\n \tprivate ChatboxPanelManager chatboxPanelManager;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n+\t@Inject\n+\tprivate FriendNotesConfig config;\n+\n \t@Getter\n \tprivate HoveredFriend hoveredFriend = null;\n \n+\tprivate int iconIdx = -1;\n+\tprivate String currentlyLayouting;\n+\n+\t@Provides\n+\tprivate FriendNotesConfig getConfig(ConfigManager configManager)\n+\t{\n+\t\treturn configManager.getConfig(FriendNotesConfig.class);\n+\t}\n+\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n \t\toverlayManager.add(overlay);\n+\t\tloadIcon();\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\trebuildFriendsList();\n+\t\t\trebuildIgnoreList();\n+\t\t}\n \t}\n \n \t@Override\n \tprotected void shutDown() throws Exception\n \t{\n \t\toverlayManager.remove(overlay);\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\trebuildFriendsList();\n+\t\t\trebuildIgnoreList();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onGameStateChanged(GameStateChanged event)\n+\t{\n+\t\tif (event.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tloadIcon();", "originalCommit": "f88b6cd860a86abcda8017aa5eb7902ffa88a2ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM0Mzk5Mw==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r392343993", "bodyText": "The license header should be added to all new files.", "author": "Adam-", "createdAt": "2020-03-13T16:41:19Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/friendnotes/FriendNotesConfig.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package net.runelite.client.plugins.friendnotes;", "originalCommit": "f88b6cd860a86abcda8017aa5eb7902ffa88a2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM4MDY5OA==", "url": "https://github.com/runelite/runelite/pull/10973#discussion_r392380698", "bodyText": "added", "author": "ThatGamerBlue", "createdAt": "2020-03-13T17:47:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM0Mzk5Mw=="}], "type": "inlineReview"}, {"oid": "c9334c05ac419a69f4199aa7a8ed4133dcd1ba90", "url": "https://github.com/runelite/runelite/commit/c9334c05ac419a69f4199aa7a8ed4133dcd1ba90", "message": "scripts: add FriendUpdate and IgnoreUpdate\n\nCo-authored-by: Adam <Adam@sigterm.info>", "committedDate": "2020-03-16T21:49:01Z", "type": "commit"}, {"oid": "2d9254d45b626294c21abc830a09a34441a642d9", "url": "https://github.com/runelite/runelite/commit/2d9254d45b626294c21abc830a09a34441a642d9", "message": "friendicons: add note icon in friends/ignore list\n\nCo-authored-by: Adam <Adam@sigterm.info>", "committedDate": "2020-03-16T21:49:12Z", "type": "commit"}]}