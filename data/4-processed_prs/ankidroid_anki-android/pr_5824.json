{"pr_number": 5824, "pr_title": "Fix #5506 NullPointerException in StudyOptionsFragment", "pr_createdAt": "2020-03-16T14:08:14Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/5824", "timeline": [{"oid": "5880d19b7d034b738237976f7a7c35b34577b0d9", "url": "https://github.com/ankidroid/Anki-Android/commit/5880d19b7d034b738237976f7a7c35b34577b0d9", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null", "committedDate": "2020-03-16T14:17:50Z", "type": "forcePushed"}, {"oid": "e6998866e11e6bb93d2d6faf60c76a80bf4b6481", "url": "https://github.com/ankidroid/Anki-Android/commit/e6998866e11e6bb93d2d6faf60c76a80bf4b6481", "message": "NF: Removed unnecessary method\n\nWe were loading preferences, but not using them.\n\nContext:\nUsage removed in 2da08a086c417acc42de813d2714a3ce7261947f, but method\nremained.", "committedDate": "2020-03-16T14:21:52Z", "type": "commit"}, {"oid": "371db18ce09e018173af3c616505abd190e38380", "url": "https://github.com/ankidroid/Anki-Android/commit/371db18ce09e018173af3c616505abd190e38380", "message": "StudyOptions: Unconditionally process arguments\n\nArguments were previously unset if there was no associated view.", "committedDate": "2020-03-16T14:21:56Z", "type": "commit"}, {"oid": "58f9b3ad8f9143751d560ea994ac4c7e4a4f4f60", "url": "https://github.com/ankidroid/Anki-Android/commit/58f9b3ad8f9143751d560ea994ac4c7e4a4f4f60", "message": "NF: Remove references to mStudyOptionsView\n\nI want to add a Nullable annotation to the variable and want to remove\nreferences to the local", "committedDate": "2020-03-16T14:21:56Z", "type": "commit"}, {"oid": "97405cfadfce5e51d523193d4be641f167f91d42", "url": "https://github.com/ankidroid/Anki-Android/commit/97405cfadfce5e51d523193d4be641f167f91d42", "message": "#5506: Only refresh view when view exists\n\nWe can be in this state without an associated View.\n\nIf so, don't perform any view-related operations", "committedDate": "2020-03-16T14:21:56Z", "type": "commit"}, {"oid": "f90ac478460f08aac689d0958aac6ab76e7f67e6", "url": "https://github.com/ankidroid/Anki-Android/commit/f90ac478460f08aac689d0958aac6ab76e7f67e6", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null", "committedDate": "2020-03-16T14:21:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIxMDI5Mw==", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#discussion_r393210293", "bodyText": "So strange - I checked that method to see if there were any side effects (that we wanted) to explain why we get a prefs object and then ignore it everywhere, and nothing. I love seeing dead code go away, thanks", "author": "mikehardy", "createdAt": "2020-03-16T17:56:48Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/StudyOptionsFragment.java", "diffHunk": "@@ -487,13 +485,6 @@ private void dismissProgressDialog() {\n         }\n     }\n \n-\n-    public SharedPreferences restorePreferences() {\n-        SharedPreferences preferences = AnkiDroidApp.getSharedPrefs(getActivity().getBaseContext());", "originalCommit": "e6998866e11e6bb93d2d6faf60c76a80bf4b6481", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIxMTk1OA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#discussion_r393211958", "bodyText": "To any other readers: Usage removed in 2da08a0, but method remained.", "author": "david-allison-1", "createdAt": "2020-03-16T17:59:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIxMDI5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIxNTUyMg==", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#discussion_r393215522", "bodyText": "assert doesn't work in the android JVM so this is something we don't use in AnkiDroid\nI believe the Android Studio 4.x toolchain (including gradle plugins) which actually start making assert work via the extra de-sugaring they are implementing but that's still in alpha\nEither way, if we want assert behavior we Timber.e and throw RuntimeException, it's effectively the same", "author": "mikehardy", "createdAt": "2020-03-16T18:04:28Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/StudyOptionsFragment.java", "diffHunk": "@@ -189,6 +190,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n             return null;\n         }\n         mStudyOptionsView = inflater.inflate(R.layout.studyoptions_fragment, container, false);\n+        assert mStudyOptionsView != null;", "originalCommit": "f90ac478460f08aac689d0958aac6ab76e7f67e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzMxOTA3OQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#discussion_r393319079", "bodyText": "Thanks for the heads up\nFYI: We use assert in libAnki. That might need an issue.\nI was using an assert to fix code quality warnings over use of a @Nullable. Will fix.", "author": "david-allison-1", "createdAt": "2020-03-16T21:25:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIxNTUyMg=="}], "type": "inlineReview"}, {"oid": "dc70130b3250d652de5822bf1f23830bf2e4557a", "url": "https://github.com/ankidroid/Anki-Android/commit/dc70130b3250d652de5822bf1f23830bf2e4557a", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null", "committedDate": "2020-03-17T17:35:07Z", "type": "commit"}, {"oid": "dc70130b3250d652de5822bf1f23830bf2e4557a", "url": "https://github.com/ankidroid/Anki-Android/commit/dc70130b3250d652de5822bf1f23830bf2e4557a", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null", "committedDate": "2020-03-17T17:35:07Z", "type": "forcePushed"}]}