{"pr_number": 7267, "pr_title": "Ensure closing transaction won't crash", "pr_createdAt": "2020-09-23T22:01:20Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/7267", "timeline": [{"oid": "b92f81834d84a63e1128b457cb7673c44dd95c6b", "url": "https://github.com/ankidroid/Anki-Android/commit/b92f81834d84a63e1128b457cb7673c44dd95c6b", "message": "Converted void methods to executeInTransaction\n\nThis ensures that the endTransaction behaviour is correct\n\nFixes some of 7265", "committedDate": "2020-09-23T20:56:32Z", "type": "commit"}, {"oid": "a9afb959e1d14a34a53b28326d9677f9395413bd", "url": "https://github.com/ankidroid/Anki-Android/commit/a9afb959e1d14a34a53b28326d9677f9395413bd", "message": "Added DB.safeEndInTransaction\n\nTo ensure that the actual error message in a failure is observed\n\nFixes 7265", "committedDate": "2020-09-23T21:01:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkyNTU5NQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/7267#discussion_r493925595", "bodyText": "Hmm - I think it's just because it can never throw? shouldn't matter?", "author": "mikehardy", "createdAt": "2020-09-23T22:14:48Z", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/DB.java", "diffHunk": "@@ -391,4 +385,34 @@ public void executeManyNoTransaction(String sql, List<Object[]> list) {\n     public String getPath() {\n         return mDatabase.getPath();\n     }\n+\n+\n+    public void executeInTransaction(Runnable r) {\n+        // Ported from code which started the transaction outside the try..finally\n+        getDatabase().beginTransaction();", "originalCommit": "b92f81834d84a63e1128b457cb7673c44dd95c6b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}