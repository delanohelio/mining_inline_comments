{"pr_number": 5867, "pr_title": "Xiaomi ai teacher adaption (no browser, fewer prefs)", "pr_createdAt": "2020-03-26T03:41:07Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/5867", "timeline": [{"oid": "bdfae8791a3e7ee482152190291979680a2a55a0", "url": "https://github.com/ankidroid/Anki-Android/commit/bdfae8791a3e7ee482152190291979680a2a55a0", "message": "Adaption on Xiaomi AI teacher\n\nThe device has no web browser, also some advanced prefences are reduced for device function limitation.\n\nSigned-off-by: landinggao <gaoyingjun@xiaomi.com>", "committedDate": "2020-03-31T09:21:52Z", "type": "commit"}, {"oid": "bdfae8791a3e7ee482152190291979680a2a55a0", "url": "https://github.com/ankidroid/Anki-Android/commit/bdfae8791a3e7ee482152190291979680a2a55a0", "message": "Adaption on Xiaomi AI teacher\n\nThe device has no web browser, also some advanced prefences are reduced for device function limitation.\n\nSigned-off-by: landinggao <gaoyingjun@xiaomi.com>", "committedDate": "2020-03-31T09:21:52Z", "type": "forcePushed"}, {"oid": "942f2fa66a99bf01f77df098426eab9754e44488", "url": "https://github.com/ankidroid/Anki-Android/commit/942f2fa66a99bf01f77df098426eab9754e44488", "message": "remove unused import etc.", "committedDate": "2020-03-31T09:52:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDkzOTY0NQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400939645", "bodyText": "For translations you must only touch the default english strings in /values/ - the strings in other localizations will be overwritten each time. It is fine of course to change them in development to test but you should not commit anything except in src/main/res/values/ https://github.com/ankidroid/Anki-Android/wiki/Development-Guide#handling-translations", "author": "mikehardy", "createdAt": "2020-03-31T14:03:59Z", "path": "AnkiDroid/src/main/res/values-zh-rCN/02-strings.xml", "diffHunk": "@@ -226,4 +226,8 @@\n     <string name=\"import_cannot_with_v2\">V2 \u8c03\u5ea6\u5668\u65e0\u6cd5\u5bfc\u5165\u5305\u542b\u8fdb\u5ea6\u7684 V1 \u724c\u7ec4\u3002</string>\n     <string name=\"export_v2_dummy_note\">\u6b64\u6587\u4ef6\u9700\u8981\u66f4\u65b0\u7248\u672c\u7684 Anki\u3002</string>\n     <string name=\"export_v2_forbidden\">\u5728\u5bfc\u51fa\u5e26\u6709\u8fdb\u5ea6\u4fe1\u606f\u7684\u5355\u4e2a\u724c\u7ec4\u524d\uff0c\u8bf7\u5207\u6362\u5230 V1 \u8c03\u5ea6\u5668\u3002</string>\n+\n+    <string name=\"activity_start_failed\">\u6ca1\u6709\u627e\u5230\u6267\u884c\u8fd9\u4e2a\u8bf7\u6c42\u7684\u5e94\u7528</string>\n+    <string name=\"no_browser_notification\">\u6ca1\u6709\u68c0\u6d4b\u5230\u6d4f\u89c8\u5668\uff0c\u8bf7\u4f7f\u7528pc\u6216\u624b\u673a\u767b\u5f55\u7f51\u9875: </string>\n+    <string name=\"no_outgoing_link_in_cardbrowser\">\u8be5\u8bbe\u5907\u6682\u4e0d\u652f\u6301\u95ea\u5361\u4e2d\u5916\u90e8\u7f51\u9875\u7684\u8bbf\u95ee</string>", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTMyMjkxNg==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r401322916", "bodyText": "I'll remove them, thanks.", "author": "landinggao", "createdAt": "2020-04-01T02:35:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDkzOTY0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0MTAxMQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400941011", "bodyText": "I believe the preferences will skew quickly if we attempt to maintain two sets.\nCan you alter this to use the same strategy as you used with notifications preference and programmatically knockout the preferences you don't want?", "author": "mikehardy", "createdAt": "2020-03-31T14:05:46Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/Preferences.java", "diffHunk": "@@ -125,7 +126,11 @@ private Collection getCol() {\n \n     @Override\n     public void onBuildHeaders(List<Header> target) {\n-        loadHeadersFromResource(R.xml.preference_headers, target);\n+        if(AdaptionUtil.hasReducedPreferences()) {\n+            loadHeadersFromResource(R.xml.preference_headers_without_advanced, target);", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTM0MzYxNA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r401343614", "bodyText": "I changed the code for this, thanks.", "author": "landinggao", "createdAt": "2020-04-01T04:03:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0MTAxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0MTEyMA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400941120", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    }else {\n          \n          \n            \n                    } else {", "author": "mikehardy", "createdAt": "2020-03-31T14:05:55Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/Preferences.java", "diffHunk": "@@ -125,7 +126,11 @@ private Collection getCol() {\n \n     @Override\n     public void onBuildHeaders(List<Header> target) {\n-        loadHeadersFromResource(R.xml.preference_headers, target);\n+        if(AdaptionUtil.hasReducedPreferences()) {\n+            loadHeadersFromResource(R.xml.preference_headers_without_advanced, target);\n+        }else {", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0MTM4NA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400941384", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if(AdaptionUtil.hasReducedPreferences()) {\n          \n          \n            \n                            if (AdaptionUtil.hasReducedPreferences()) {\n          \n      \n    \n    \n  \n\nAnd this is the example I mention above of programmatically knocking out the preferences you don't want", "author": "mikehardy", "createdAt": "2020-03-31T14:06:18Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/Preferences.java", "diffHunk": "@@ -185,13 +190,20 @@ public static Intent getPreferenceSubscreenIntent(Context context, String subscr\n         i.putExtra(PreferenceActivity.EXTRA_NO_HEADERS, true);\n         return i;\n     }\n-\n     private void initSubscreen(String action, PreferenceContext listener) {\n         PreferenceScreen screen;\n         switch (action) {\n             case \"com.ichi2.anki.prefs.general\":\n                 listener.addPreferencesFromResource(R.xml.preferences_general);\n                 screen = listener.getPreferenceScreen();\n+                if(AdaptionUtil.hasReducedPreferences()) {", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0MzI0OQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400943249", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public static boolean hasWebBrowser(Context context){\n          \n          \n            \n                private static boolean sHasRunWebBrowserCheck = false;\n          \n          \n            \n                private static boolean sHasWebBrowser = true;\n          \n          \n            \n            \n          \n          \n            \n                public static boolean hasWebBrowser(Context context) {\n          \n          \n            \n                    if (sHasRunWebBrowserCheck) {\n          \n          \n            \n                        return sHasWebBrowser;\n          \n          \n            \n                    }\n          \n          \n            \n                    \n          \n      \n    \n    \n  \n\nSince this is static and should not vary much, probably best to memoize this as it could affect performance. I haven't tested this suggested code but it should work or be close to working", "author": "mikehardy", "createdAt": "2020-03-31T14:08:43Z", "path": "AnkiDroid/src/main/java/com/ichi2/utils/AdaptionUtil.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package com.ichi2.utils;\n+\n+import android.content.Context;\n+import android.content.Intent;\n+import android.content.pm.PackageManager;\n+import android.content.pm.ResolveInfo;\n+import android.net.Uri;\n+import android.os.Build;\n+\n+import java.util.List;\n+\n+public class AdaptionUtil {\n+    public static boolean hasWebBrowser(Context context){", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0Mzg4MA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400943880", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return list.size()==0 ? false : true;\n          \n          \n            \n                    if (list.size() == 0) {\n          \n          \n            \n                        sHasWebBrowser = false;\n          \n          \n            \n                    ]\n          \n          \n            \n                    return sHasWebBrowser;", "author": "mikehardy", "createdAt": "2020-03-31T14:09:33Z", "path": "AnkiDroid/src/main/java/com/ichi2/utils/AdaptionUtil.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package com.ichi2.utils;\n+\n+import android.content.Context;\n+import android.content.Intent;\n+import android.content.pm.PackageManager;\n+import android.content.pm.ResolveInfo;\n+import android.net.Uri;\n+import android.os.Build;\n+\n+import java.util.List;\n+\n+public class AdaptionUtil {\n+    public static boolean hasWebBrowser(Context context){\n+        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(\"http://www.google.com\"));\n+        PackageManager pm = context.getPackageManager();\n+        List<ResolveInfo> list = pm.queryIntentActivities(intent, PackageManager.MATCH_DEFAULT_ONLY);\n+        return list.size()==0 ? false : true;", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTMyMzc2Mw==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r401323763", "bodyText": "Agree, I'll set sHasRunWebBrowserCheck to true before return then.", "author": "landinggao", "createdAt": "2020-04-01T02:39:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0Mzg4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NDE0Mg==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400944142", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return Build.MANUFACTURER.equalsIgnoreCase(\"Xiaomi\") && (Build.PRODUCT.equalsIgnoreCase(\"Archytas\")||Build.PRODUCT.equalsIgnoreCase(\"Archimedes\"));\n          \n          \n            \n                    return Build.MANUFACTURER.equalsIgnoreCase(\"Xiaomi\") && (Build.PRODUCT.equalsIgnoreCase(\"Archytas\") || Build.PRODUCT.equalsIgnoreCase(\"Archimedes\"));", "author": "mikehardy", "createdAt": "2020-03-31T14:09:53Z", "path": "AnkiDroid/src/main/java/com/ichi2/utils/AdaptionUtil.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package com.ichi2.utils;\n+\n+import android.content.Context;\n+import android.content.Intent;\n+import android.content.pm.PackageManager;\n+import android.content.pm.ResolveInfo;\n+import android.net.Uri;\n+import android.os.Build;\n+\n+import java.util.List;\n+\n+public class AdaptionUtil {\n+    public static boolean hasWebBrowser(Context context){\n+        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(\"http://www.google.com\"));\n+        PackageManager pm = context.getPackageManager();\n+        List<ResolveInfo> list = pm.queryIntentActivities(intent, PackageManager.MATCH_DEFAULT_ONLY);\n+        return list.size()==0 ? false : true;\n+    }\n+\n+    public static boolean hasReducedPreferences(){\n+        return Build.MANUFACTURER.equalsIgnoreCase(\"Xiaomi\") && (Build.PRODUCT.equalsIgnoreCase(\"Archytas\")||Build.PRODUCT.equalsIgnoreCase(\"Archimedes\"));", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NDYxMg==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400944612", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(AdaptionUtil.hasReducedPreferences()) {\n          \n          \n            \n                    if (AdaptionUtil.hasReducedPreferences()) {", "author": "mikehardy", "createdAt": "2020-03-31T14:10:30Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/Preferences.java", "diffHunk": "@@ -125,7 +126,11 @@ private Collection getCol() {\n \n     @Override\n     public void onBuildHeaders(List<Header> target) {\n-        loadHeadersFromResource(R.xml.preference_headers, target);\n+        if(AdaptionUtil.hasReducedPreferences()) {", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NDczOQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400944739", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                if(AdaptionUtil.hasReducedPreferences()) {\n          \n          \n            \n                                if (AdaptionUtil.hasReducedPreferences()) {", "author": "mikehardy", "createdAt": "2020-03-31T14:10:43Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/NoteEditor.java", "diffHunk": "@@ -1221,6 +1222,10 @@ public void onClick(View v) {\n                                 return false;\n                         }\n                     });\n+                    if(AdaptionUtil.hasReducedPreferences()) {", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NDkzMA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400944930", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                if(AdaptionUtil.hasWebBrowser(this)) {\n          \n          \n            \n                                if (AdaptionUtil.hasWebBrowser(this)) {", "author": "mikehardy", "createdAt": "2020-03-31T14:10:57Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/NavigationDrawerActivity.java", "diffHunk": "@@ -306,10 +307,18 @@ public boolean onNavigationItemSelected(final MenuItem item) {\n                     startActivityForResultWithAnimation(new Intent(NavigationDrawerActivity.this, Preferences.class), REQUEST_PREFERENCES_UPDATE, ActivityTransitionAnimation.FADE);\n                     break;\n                 case R.id.nav_help:\n-                    openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));\n+                    if(AdaptionUtil.hasWebBrowser(this)) {\n+                        openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));\n+                    }else{\n+                        UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+AnkiDroidApp.getManualUrl(), false);\n+                    }\n                     break;\n                 case R.id.nav_feedback:\n-                    openUrl(Uri.parse(AnkiDroidApp.getFeedbackUrl()));\n+                    if(AdaptionUtil.hasWebBrowser(this)) {", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NTI2OQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400945269", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                }else{\n          \n          \n            \n                                    UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+AnkiDroidApp.getFeedbackUrl(), false);\n          \n          \n            \n                                } else {\n          \n          \n            \n                                    UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification) + AnkiDroidApp.getFeedbackUrl(), false);", "author": "mikehardy", "createdAt": "2020-03-31T14:11:26Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/NavigationDrawerActivity.java", "diffHunk": "@@ -306,10 +307,18 @@ public boolean onNavigationItemSelected(final MenuItem item) {\n                     startActivityForResultWithAnimation(new Intent(NavigationDrawerActivity.this, Preferences.class), REQUEST_PREFERENCES_UPDATE, ActivityTransitionAnimation.FADE);\n                     break;\n                 case R.id.nav_help:\n-                    openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));\n+                    if(AdaptionUtil.hasWebBrowser(this)) {\n+                        openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));\n+                    }else{\n+                        UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+AnkiDroidApp.getManualUrl(), false);\n+                    }\n                     break;\n                 case R.id.nav_feedback:\n-                    openUrl(Uri.parse(AnkiDroidApp.getFeedbackUrl()));\n+                    if(AdaptionUtil.hasWebBrowser(this)) {\n+                        openUrl(Uri.parse(AnkiDroidApp.getFeedbackUrl()));\n+                    }else{\n+                        UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+AnkiDroidApp.getFeedbackUrl(), false);", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NTY2OA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400945668", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                if(AdaptionUtil.hasWebBrowser(this)) {\n          \n          \n            \n                                    openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));\n          \n          \n            \n                                }else{\n          \n          \n            \n                                    UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+AnkiDroidApp.getManualUrl(), false);\n          \n          \n            \n                                if (AdaptionUtil.hasWebBrowser(this)) {\n          \n          \n            \n                                    openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));\n          \n          \n            \n                                } else {\n          \n          \n            \n                                    UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification) + AnkiDroidApp.getManualUrl(), false);", "author": "mikehardy", "createdAt": "2020-03-31T14:11:58Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/NavigationDrawerActivity.java", "diffHunk": "@@ -306,10 +307,18 @@ public boolean onNavigationItemSelected(final MenuItem item) {\n                     startActivityForResultWithAnimation(new Intent(NavigationDrawerActivity.this, Preferences.class), REQUEST_PREFERENCES_UPDATE, ActivityTransitionAnimation.FADE);\n                     break;\n                 case R.id.nav_help:\n-                    openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));\n+                    if(AdaptionUtil.hasWebBrowser(this)) {\n+                        openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));\n+                    }else{\n+                        UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+AnkiDroidApp.getManualUrl(), false);", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NjAwNw==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400946007", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(AdaptionUtil.hasWebBrowser(this)) {\n          \n          \n            \n                        signUpButton.setOnClickListener(v -> openUrl(Uri.parse(getResources().getString(R.string.register_url))));\n          \n          \n            \n                    }else{\n          \n          \n            \n                        signUpButton.setOnClickListener(v -> UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+getResources().getString(R.string.register_url), false));\n          \n          \n            \n                    if (AdaptionUtil.hasWebBrowser(this)) {\n          \n          \n            \n                        signUpButton.setOnClickListener(v -> openUrl(Uri.parse(getResources().getString(R.string.register_url))));\n          \n          \n            \n                    } else {\n          \n          \n            \n                        signUpButton.setOnClickListener(v -> UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification) + getResources().getString(R.string.register_url), false));", "author": "mikehardy", "createdAt": "2020-03-31T14:12:26Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/MyAccount.java", "diffHunk": "@@ -150,7 +155,11 @@ private void initAllContentViews() {\n         resetPWButton.setOnClickListener(v -> resetPassword());\n \n         Button signUpButton = mLoginToMyAccountView.findViewById(R.id.sign_up_button);\n-        signUpButton.setOnClickListener(v -> openUrl(Uri.parse(getResources().getString(R.string.register_url))));\n+        if(AdaptionUtil.hasWebBrowser(this)) {\n+            signUpButton.setOnClickListener(v -> openUrl(Uri.parse(getResources().getString(R.string.register_url))));\n+        }else{\n+            signUpButton.setOnClickListener(v -> UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+getResources().getString(R.string.register_url), false));", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NjM0NQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400946345", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(AdaptionUtil.hasWebBrowser(this)) {\n          \n          \n            \n                        Intent intent = new Intent(Intent.ACTION_VIEW);\n          \n          \n            \n                        intent.setData(Uri.parse(getResources().getString(R.string.resetpw_url)));\n          \n          \n            \n                        startActivityWithoutAnimation(intent);\n          \n          \n            \n                    }else {\n          \n          \n            \n                        UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+getResources().getString(R.string.resetpw_url), false);\n          \n          \n            \n                    if (AdaptionUtil.hasWebBrowser(this)) {\n          \n          \n            \n                        Intent intent = new Intent(Intent.ACTION_VIEW);\n          \n          \n            \n                        intent.setData(Uri.parse(getResources().getString(R.string.resetpw_url)));\n          \n          \n            \n                        startActivityWithoutAnimation(intent);\n          \n          \n            \n                    } else {\n          \n          \n            \n                        UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification) + getResources().getString(R.string.resetpw_url), false);", "author": "mikehardy", "createdAt": "2020-03-31T14:12:50Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/MyAccount.java", "diffHunk": "@@ -132,9 +133,13 @@ private void logout() {\n \n \n     private void resetPassword() {\n-        Intent intent = new Intent(Intent.ACTION_VIEW);\n-        intent.setData(Uri.parse(getResources().getString(R.string.resetpw_url)));\n-        startActivityWithoutAnimation(intent);\n+        if(AdaptionUtil.hasWebBrowser(this)) {\n+            Intent intent = new Intent(Intent.ACTION_VIEW);\n+            intent.setData(Uri.parse(getResources().getString(R.string.resetpw_url)));\n+            startActivityWithoutAnimation(intent);\n+        }else {\n+            UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification)+getResources().getString(R.string.resetpw_url), false);", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NjYzNg==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400946636", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(AdaptionUtil.hasWebBrowser(DeckPicker.this)) {\n          \n          \n            \n                        openUrl(Uri.parse(getResources().getString(R.string.shared_decks_url)));\n          \n          \n            \n                    }else {\n          \n          \n            \n                        UIUtils.showThemedToast(DeckPicker.this, getResources().getString(R.string.no_browser_notification)+ getResources().getString(R.string.shared_decks_url), false);\n          \n          \n            \n                    if (AdaptionUtil.hasWebBrowser(DeckPicker.this)) {\n          \n          \n            \n                        openUrl(Uri.parse(getResources().getString(R.string.shared_decks_url)));\n          \n          \n            \n                    } else {\n          \n          \n            \n                        UIUtils.showThemedToast(DeckPicker.this, getResources().getString(R.string.no_browser_notification) + getResources().getString(R.string.shared_decks_url), false);", "author": "mikehardy", "createdAt": "2020-03-31T14:13:12Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java", "diffHunk": "@@ -1924,7 +1925,11 @@ public void onReceive(Context context, Intent intent) {\n \n \n     public void addSharedDeck() {\n-        openUrl(Uri.parse(getResources().getString(R.string.shared_decks_url)));\n+        if(AdaptionUtil.hasWebBrowser(DeckPicker.this)) {\n+            openUrl(Uri.parse(getResources().getString(R.string.shared_decks_url)));\n+        }else {\n+            UIUtils.showThemedToast(DeckPicker.this, getResources().getString(R.string.no_browser_notification)+ getResources().getString(R.string.shared_decks_url), false);", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NzAyMg==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400947022", "bodyText": "I believe you want to key of web browser availability here, not reduced preferences?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if(AdaptionUtil.hasReducedPreferences()) {\n          \n          \n            \n                            if (AdaptionUtil.hasWebBrowser()) {", "author": "mikehardy", "createdAt": "2020-03-31T14:13:40Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -1448,6 +1451,20 @@ public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request\n                 return filterUrl(url);\n             }\n \n+            @Override\n+            @TargetApi(Build.VERSION_CODES.N)\n+            public WebResourceResponse shouldInterceptRequest(WebView view, WebResourceRequest request) {\n+                WebResourceResponse webResourceResponse=null;\n+                if(AdaptionUtil.hasReducedPreferences()) {", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk0NzE0OA==", "url": "https://github.com/ankidroid/Anki-Android/pull/5867#discussion_r400947148", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            WebResourceResponse webResourceResponse=null;\n          \n          \n            \n                            WebResourceResponse webResourceResponse = null;", "author": "mikehardy", "createdAt": "2020-03-31T14:13:50Z", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -1448,6 +1451,20 @@ public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request\n                 return filterUrl(url);\n             }\n \n+            @Override\n+            @TargetApi(Build.VERSION_CODES.N)\n+            public WebResourceResponse shouldInterceptRequest(WebView view, WebResourceRequest request) {\n+                WebResourceResponse webResourceResponse=null;", "originalCommit": "942f2fa66a99bf01f77df098426eab9754e44488", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "01c8a3c92fa1db65002029006eed5b1f521d03d3", "url": "https://github.com/ankidroid/Anki-Android/commit/01c8a3c92fa1db65002029006eed5b1f521d03d3", "message": "Apply suggestions from code review\r\n\r\nCommit suggestions from MikeHardy.\n\nCo-Authored-By: Mike Hardy <github@mikehardy.net>", "committedDate": "2020-04-01T02:42:17Z", "type": "commit"}, {"oid": "3235cd62fed53ee2a49395c9865a56b38f8e4a71", "url": "https://github.com/ankidroid/Anki-Android/commit/3235cd62fed53ee2a49395c9865a56b38f8e4a71", "message": "update based on review comments:\n\n1. use code instead of configuration file to reduce the preference header\n2. remove string values in 02-strings.xml\n3. other small changes.\n\nSigned-off-by: landinggao <gaoyingjun@xiaomi.com>", "committedDate": "2020-04-01T04:00:53Z", "type": "commit"}]}