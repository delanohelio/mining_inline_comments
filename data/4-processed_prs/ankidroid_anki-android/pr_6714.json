{"pr_number": 6714, "pr_title": "Correcting test on phone", "pr_createdAt": "2020-07-22T11:47:12Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/6714", "timeline": [{"oid": "60b65f3011258d24e6df3ecbd51c3bf8a17f9cf2", "url": "https://github.com/ankidroid/Anki-Android/commit/60b65f3011258d24e6df3ecbd51c3bf8a17f9cf2", "message": "Correcting test on phone\n\nOn my phone, tests break, because the schedVersion is checked even if the sched version was not actually changed. So I\nused real test instead.\nI believe that what would be even better would be to run the tests only once if we are on phone, but I don't know how to\ndo it", "committedDate": "2020-07-22T11:46:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODczNzUxNA==", "url": "https://github.com/ankidroid/Anki-Android/pull/6714#discussion_r458737514", "bodyText": "I don't think this should be static. set tearDown = false at the start of the method, and leave it as an instance variable.", "author": "david-allison-1", "createdAt": "2020-07-22T11:56:33Z", "path": "AnkiDroid/src/androidTest/java/com/ichi2/anki/tests/ContentProviderTest.java", "diffHunk": "@@ -111,6 +114,8 @@\n     private static final String[] TEST_MODEL_AFMT = {\"{{BACK}}\", \"{{FRONTS}}\"};\n     private static final String[] TEST_NOTE_FIELDS = {\"dis is za Fr0nt\", \"Te$t\"};\n     private static final String TEST_MODEL_CSS = \"styleeeee\";\n+    // Whether tear down should be executed. I.e. if set up was not cancelled.\n+    private static boolean tearDown = false;", "originalCommit": "991521dbfd5032a611725a2280a3cc1420d69543", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODczOTMyNg==", "url": "https://github.com/ankidroid/Anki-Android/pull/6714#discussion_r458739326", "bodyText": "Yeah, right, no reason for static here. I don't know what I was expecting to do here wit hit", "author": "Arthur-Milchior", "createdAt": "2020-07-22T12:00:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODczNzUxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODc0MDcwNA==", "url": "https://github.com/ankidroid/Anki-Android/pull/6714#discussion_r458740704", "bodyText": "Makes far more sens no. Thanks. Tests are indeed ignored instead of failing.\nThat'll still make a lot of noise, given that all tests are ignored; on the other hand that's also most efficient because it ensures test are not run twice with the same scheduler", "author": "Arthur-Milchior", "createdAt": "2020-07-22T12:02:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODczNzUxNA=="}], "type": "inlineReview"}, {"oid": "9547033dc4ea205f9c8da8079a937c1699cb0656", "url": "https://github.com/ankidroid/Anki-Android/commit/9547033dc4ea205f9c8da8079a937c1699cb0656", "message": "Tear down only if set up was executed", "committedDate": "2020-07-22T12:00:31Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODc3MjM4MQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6714#discussion_r458772381", "bodyText": "set tearDown = false in this block, not in the variable init\nsetUp is run more than once, and we want the initial state to be false", "author": "david-allison-1", "createdAt": "2020-07-22T12:59:41Z", "path": "AnkiDroid/src/androidTest/java/com/ichi2/anki/tests/ContentProviderTest.java", "diffHunk": "@@ -137,7 +142,15 @@ public void setUp() throws Exception {\n         // (so it is safe) we will try to run with multiple scheduler versions\n         if (InstrumentedTest.isEmulator()) {\n             col.changeSchedulerVer(schedVersion);\n+        } else {", "originalCommit": "9547033dc4ea205f9c8da8079a937c1699cb0656", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "05dc4d9c667ab22556772ff228e340ad24f6c821", "url": "https://github.com/ankidroid/Anki-Android/commit/05dc4d9c667ab22556772ff228e340ad24f6c821", "message": "Tear down only if set up was executed", "committedDate": "2020-07-22T13:03:29Z", "type": "commit"}, {"oid": "05dc4d9c667ab22556772ff228e340ad24f6c821", "url": "https://github.com/ankidroid/Anki-Android/commit/05dc4d9c667ab22556772ff228e340ad24f6c821", "message": "Tear down only if set up was executed", "committedDate": "2020-07-22T13:03:29Z", "type": "forcePushed"}]}