{"pr_number": 7669, "pr_title": "Remove MIUI Keyboard Hack Preference", "pr_createdAt": "2020-11-13T06:30:04Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/7669", "timeline": [{"oid": "503a6198590d8a713dd30489fd86ea16d54af5cf", "url": "https://github.com/ankidroid/Anki-Android/commit/503a6198590d8a713dd30489fd86ea16d54af5cf", "message": "Remove MIUI Keyboard Hack Preference\n\nNo longer necessary now we have the note editor toolbar.\n\nRelated: 43151b618758c80b2bd4b7134f498a56f5b27170\nFixed By: 7124", "committedDate": "2020-11-13T06:29:56Z", "type": "commit"}, {"oid": "503a6198590d8a713dd30489fd86ea16d54af5cf", "url": "https://github.com/ankidroid/Anki-Android/commit/503a6198590d8a713dd30489fd86ea16d54af5cf", "message": "Remove MIUI Keyboard Hack Preference\n\nNo longer necessary now we have the note editor toolbar.\n\nRelated: 43151b618758c80b2bd4b7134f498a56f5b27170\nFixed By: 7124", "committedDate": "2020-11-13T06:29:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk3NDQyMA==", "url": "https://github.com/ankidroid/Anki-Android/pull/7669#discussion_r522974420", "bodyText": "I think also needs an update to remove the key?\n\n  \n    \n      Anki-Android/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java\n    \n    \n        Lines 1223 to 1224\n      in\n      d1c0906\n    \n    \n    \n    \n\n        \n          \n           // Check if preference upgrade or database check required, otherwise go to new feature screen \n        \n\n        \n          \n           int upgradePrefsVersion = AnkiDroidApp.CHECK_PREFERENCES_AT_VERSION; \n        \n    \n  \n\n\nSomething like this:\n\n  \n    \n      Anki-Android/AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java\n    \n    \n        Lines 1343 to 1356\n      in\n      d1c0906\n    \n    \n    \n    \n\n        \n          \n           // when upgrading from before 2.5alpha35 \n        \n\n        \n          \n           if (previousVersionCode < 20500135) { \n        \n\n        \n          \n               Timber.i(\"Old version of Anki - Fixing Zoom\"); \n        \n\n        \n          \n               // Card zooming behaviour was changed the preferences renamed \n        \n\n        \n          \n               int oldCardZoom = preferences.getInt(\"relativeDisplayFontSize\", 100); \n        \n\n        \n          \n               int oldImageZoom = preferences.getInt(\"relativeImageSize\", 100); \n        \n\n        \n          \n               preferences.edit().putInt(\"cardZoom\", oldCardZoom).apply(); \n        \n\n        \n          \n               preferences.edit().putInt(\"imageZoom\", oldImageZoom).apply(); \n        \n\n        \n          \n               if (!preferences.getBoolean(\"useBackup\", true)) { \n        \n\n        \n          \n                   preferences.edit().putInt(\"backupMax\", 0).apply(); \n        \n\n        \n          \n               } \n        \n\n        \n          \n               preferences.edit().remove(\"useBackup\").apply(); \n        \n\n        \n          \n               preferences.edit().remove(\"intentAdditionInstantAdd\").apply(); \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nNote that it is hard to pin down exactly when this will go (and thus to get the version code correct) but if you have time to do this now you will know that the next beta version number will have it and that will clear it out for almost everyone, orphaning almost no one and with no real importance if it does", "author": "mikehardy", "createdAt": "2020-11-13T14:12:49Z", "path": "AnkiDroid/src/main/res/xml/preferences_advanced.xml", "diffHunk": "@@ -68,13 +68,6 @@\n                 android:key=\"disableExtendedTextUi\"\n                 android:summary=\"@string/disable_extended_text_ui_summ\"\n                 android:title=\"@string/disable_extended_text_ui\" />\n-\n-            <!-- HACK before 7124 MIUI Clipboard Cloze -->\n-            <CheckBoxPreference\n-                android:defaultValue=\"true\"\n-                android:key=\"enableMIUIClipboardHack\"", "originalCommit": "503a6198590d8a713dd30489fd86ea16d54af5cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzIwMDM3Mw==", "url": "https://github.com/ankidroid/Anki-Android/pull/7669#discussion_r523200373", "bodyText": "We haven't done this for any past keys - all of the updates in this routine relate to modifications, rather than removals.\nMaintainer's choice - I don't feel it's worth the complexity.", "author": "david-allison-1", "createdAt": "2020-11-13T20:16:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk3NDQyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQxODA4Ng==", "url": "https://github.com/ankidroid/Anki-Android/pull/7669#discussion_r523418086", "bodyText": "Mmm - cost is slowly growing preferences on people that used the non-default setting for the feature, scaled by rate of addition of features that need preferences and are orphaned over time, vs cost of code in a nasty startup sequence.\nOur rate of preference-requiring additions is low, so I tend to agree", "author": "mikehardy", "createdAt": "2020-11-14T13:07:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk3NDQyMA=="}], "type": "inlineReview"}]}