{"pr_number": 6529, "pr_title": "NF: replace mModels by getModels()", "pr_createdAt": "2020-06-21T21:53:30Z", "pr_url": "https://github.com/ankidroid/Anki-Android/pull/6529", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDMzNTczNw==", "url": "https://github.com/ankidroid/Anki-Android/pull/6529#discussion_r444335737", "bodyText": "I really dislike that when I originally did progress reporting on database check in #5177 I hard coded the check count, because it leads to errors like this where we fail to maintain a magic constant that you can only derive by counting the verifications we perform.\nCan you revert the 27 -> 25 number?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    int totalTasks = (getModels().all().size() * 4) + 25; // a few fixes are in all-models loops, the rest are one-offs\n          \n          \n            \n                    int totalTasks = (getModels().all().size() * 4) + 27; // a few fixes are in all-models loops, the rest are one-offs", "author": "mikehardy", "createdAt": "2020-06-23T16:00:50Z", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -1504,7 +1504,7 @@ public CheckDatabaseResult fixIntegrity(CollectionTask.ProgressCallback progress\n         File file = new File(mPath);\n         CheckDatabaseResult result = new CheckDatabaseResult(file.length());\n         final int[] currentTask = {1};\n-        int totalTasks = (mModels.all().size() * 4) + 27; // a few fixes are in all-models loops, the rest are one-offs\n+        int totalTasks = (getModels().all().size() * 4) + 25; // a few fixes are in all-models loops, the rest are one-offs", "originalCommit": "f7c059b0eafdee9f3e9ba5877a987bf82e45ed5f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDM1MDA5MA==", "url": "https://github.com/ankidroid/Anki-Android/pull/6529#discussion_r444350090", "bodyText": "I can. I actually have no idea how I ever made this change. I've no idea what this is supposed to be", "author": "Arthur-Milchior", "createdAt": "2020-06-23T16:22:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDMzNTczNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDM1MDY3OQ==", "url": "https://github.com/ankidroid/Anki-Android/pull/6529#discussion_r444350679", "bodyText": "Done", "author": "Arthur-Milchior", "createdAt": "2020-06-23T16:23:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDMzNTczNw=="}], "type": "inlineReview"}, {"oid": "fe14ae46be389fe43a92d72fd6c6ae64db8f9f47", "url": "https://github.com/ankidroid/Anki-Android/commit/fe14ae46be389fe43a92d72fd6c6ae64db8f9f47", "message": "replace mModels by getModels()", "committedDate": "2020-06-23T16:23:28Z", "type": "commit"}, {"oid": "fe14ae46be389fe43a92d72fd6c6ae64db8f9f47", "url": "https://github.com/ankidroid/Anki-Android/commit/fe14ae46be389fe43a92d72fd6c6ae64db8f9f47", "message": "replace mModels by getModels()", "committedDate": "2020-06-23T16:23:28Z", "type": "forcePushed"}]}