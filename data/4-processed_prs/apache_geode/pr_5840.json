{"pr_number": 5840, "pr_title": "GEODE-8782: Add getPrincipal method to FunctionContext interface", "pr_createdAt": "2020-12-11T16:13:37Z", "pr_url": "https://github.com/apache/geode/pull/5840", "timeline": [{"oid": "5ccf8e53a7e4553f66525b1693d0709fe27c3a1f", "url": "https://github.com/apache/geode/commit/5ccf8e53a7e4553f66525b1693d0709fe27c3a1f", "message": "GEODE-8782: Add getPrincipal method to FunctionContext interface\n\n- Add the ability to retrieve the Principal from the FunctionContext\n  when a SecurityManager is enabled.\n\nAuthored-by: Jens Deppe <jdeppe@vmware.com>", "committedDate": "2020-12-11T16:12:46Z", "type": "commit"}, {"oid": "57907feac374173149c7964ad1804078fe59447a", "url": "https://github.com/apache/geode/commit/57907feac374173149c7964ad1804078fe59447a", "message": "Fix failing tests", "committedDate": "2020-12-11T18:56:39Z", "type": "commit"}, {"oid": "7b6f3aa8255ed2f730f9492d046cbcfccbb9cb14", "url": "https://github.com/apache/geode/commit/7b6f3aa8255ed2f730f9492d046cbcfccbb9cb14", "message": "Added a test and some small refactorings", "committedDate": "2020-12-11T23:53:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjY5MTI2NQ==", "url": "https://github.com/apache/geode/pull/5840#discussion_r542691265", "bodyText": "Instead of this, I think you could make this class implement VersionedDataSerializable which might handle writing the principal differently.", "author": "upthewaterspout", "createdAt": "2020-12-14T19:36:34Z", "path": "geode-core/src/main/java/org/apache/geode/internal/cache/execute/FunctionRemoteContext.java", "diffHunk": "@@ -84,6 +85,10 @@ public void fromData(DataInput in) throws IOException, ClassNotFoundException {\n       this.bucketArray = BucketSetHelper.fromSet(bucketSet);\n     }\n     this.isReExecute = DataSerializer.readBoolean(in);\n+\n+    if (StaticSerialization.getVersionForDataStream(in).isNotOlderThan(KnownVersion.GEODE_1_14_0)) {", "originalCommit": "7b6f3aa8255ed2f730f9492d046cbcfccbb9cb14", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ2NzgzMg==", "url": "https://github.com/apache/geode/pull/5840#discussion_r543467832", "bodyText": "I tried that but had some upgrade tests that became flaky. I may have done something wrong, but using VersionedDataSerializable seemed to not work for this.", "author": "jdeppe-pivotal", "createdAt": "2020-12-15T15:56:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjY5MTI2NQ=="}], "type": "inlineReview"}, {"oid": "95e832b10dafa7327b046e17dc9f6179250ae59f", "url": "https://github.com/apache/geode/commit/95e832b10dafa7327b046e17dc9f6179250ae59f", "message": "Review updates\n\n- Added principal object to FunctionContextImpl\n- Removed default implementation of getPrincipal() since the interface\n  is not user implemented and also no concrete implementations are ever\n  serialized.\n\nAuthored-by: Jens Deppe <jdeppe@vmware.com>", "committedDate": "2020-12-15T15:51:26Z", "type": "commit"}, {"oid": "9dd0ab5d6e0c96dd1b9f2707faa8775b746f924a", "url": "https://github.com/apache/geode/commit/9dd0ab5d6e0c96dd1b9f2707faa8775b746f924a", "message": "Fix failing test", "committedDate": "2020-12-15T21:09:36Z", "type": "commit"}]}