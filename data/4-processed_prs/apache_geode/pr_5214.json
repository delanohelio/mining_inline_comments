{"pr_number": 5214, "pr_title": "GEODE-8223: Update documentation of expiration accuracy as well as supported, unsupported, and unimplemented commands in Redis API for Geode docs", "pr_createdAt": "2020-06-04T19:58:11Z", "pr_url": "https://github.com/apache/geode/pull/5214", "timeline": [{"oid": "9daa41a8d4a0cb40145c3b997c27e34076a4d35c", "url": "https://github.com/apache/geode/commit/9daa41a8d4a0cb40145c3b997c27e34076a4d35c", "message": "GEODE-8223: Update expiration implementation as well as supported, unsupported, and unimplemented commands in Redis API for Geode docs", "committedDate": "2020-06-04T19:57:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUxODQ5Mg==", "url": "https://github.com/apache/geode/pull/5214#discussion_r435518492", "bodyText": "did you intend to mention ECHO, TIME, and SHUTDOWN twice (once in Server once in Connection)?", "author": "dschneider-pivotal", "createdAt": "2020-06-04T20:06:05Z", "path": "geode-docs/tools_modules/redis_api_for_geode.html.md.erb", "diffHunk": "@@ -60,30 +65,47 @@ If the server is functioning properly, you should see a response of `PONG`.\n \n The Redis API for <%=vars.product_name%> currently supports the following commands.  See [Redis commands](https://redis.io/commands/) for a complete list of and more information on Redis commands.\n \n--   **Strings**: APPEND, GET, GETRANGE, SET\n+-   **Strings**: APPEND, GET, SET\n -   **Hashes**: HGETALL, HMSET, HSET\n -   **Sets**: SADD, SMEMBERS, SREM\n -   **Publish/Subscribe**: PUBLISH, PSUBSCRIBE, PUNSUBSCRIBE, SUBSCRIBE, UNSUBSCRIBE\n--   **Keys**: DEL, EXISTS, EXPIRE, PERSIST, PEXPIRE, PEXPIREAT, RENAME\n+-   **Keys**: DEL, EXISTS, EXPIRE, EXPIREAT, KEYS, PERSIST, PEXPIRE, PEXPIREAT, PTTL, RENAME, TTL, TYPE\n+-   **Connection**: AUTH, PING, QUIT\n \n-The following Redis API for <%=vars.product_name%> commands are **experimental**:\n+The following Redis API for <%=vars.product_name%> commands are **unsupported**:\n \n--   **Strings**: BITCOUNT, BITOP, BITPOS, DECR, DECRBY, GETBIT, GETSET, INCR, INCRBY, INCRBYFLOAT, MGET,\n-  MSET, MSETNX, PSETEX, SETBIT, SETEX, SETNX, STRLEN\n--   **Lists**: LINDEX, LLEN, LPOP, LPUSH, LPUSHX, LRANGE, LREM, LSET, LTRIM, RPOP, RPUSH, RPUSHX\n--   **Hashes**: HDEL, HEXISTS, HGET, HINCRBY, HINCRBYFLOAT, HKEYS, HMGET, HSETNX, HLEN, HSCAN, HVALS\n+-   **Strings**: BITCOUNT, BITOP, BITPOS, DECR, DECRBY, GETBIT, GETRANGE, GETSET, INCR, INCRBY, INCRBYFLOAT, MGET,\n+  MSET, MSETNX, PSETEX, SETBIT, SETEX, SETNX, SETRANGE, STRLEN\n+-   **Hashes**: HDEL, HEXISTS, HGET, HINCRBY, HINCRBYFLOAT, HKEYS, HLEN, HMGET, HSCAN, HSETNX, HVALS\n -   **Sets**: SCARD, SDIFF, SDIFFSTORE, SINTER, SINTERSTORE, SISMEMBER, SMOVE, SPOP, SRANDMEMBER,\n   SSCAN, SUNION, SUNIONSTORE\n--   **SortedSets**: ZADD, ZCARD, ZCOUNT, ZINCRBY, ZLEXCOUNT, ZRANGE, ZRANGEBYLEX, ZRANGEBYSCORE,\n-  ZRANK, ZREM, ZREMRANGEBYLEX, ZREMRANGEBYRANK, ZREMRANGEBYSCORE, ZREVRANGE, ZREVRANGEBYSCORE,\n-  ZREVRANK, ZSCAN, ZSCORE\n--   **HyperLogLog**: PFADD, PFCOUNT, PFMERGE\n--   **Keys**: DBSIZE, EXPIREAT, FLUSHDB, FLUSHALL, KEYS, PTTL, SCAN, TTL\n--   **Transactions**: DISCARD, EXEC, MULTI\n--   **Server**: AUTH, ECHO, PING, QUIT\n+-   **Keys**: FLUSHALL (no async option), FLUSHDB (no async option), SCAN\n+-   **Server**: DBSIZE, ECHO, TIME, SHUTDOWN\n+-   **Connection**: ECHO, TIME, SHUTDOWN", "originalCommit": "9daa41a8d4a0cb40145c3b997c27e34076a4d35c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzNzE4NA==", "url": "https://github.com/apache/geode/pull/5214#discussion_r435537184", "bodyText": "No, we were going through how Redis groups them and forgot to remove them. Just updated it! Thanks for finding that.", "author": "sabbey37", "createdAt": "2020-06-04T20:43:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUxODQ5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUxOTM1Mw==", "url": "https://github.com/apache/geode/pull/5214#discussion_r435519353", "bodyText": "DBSIZE makes more sense to be in the \"Keys\" section since it tells you how many keys exist", "author": "dschneider-pivotal", "createdAt": "2020-06-04T20:07:41Z", "path": "geode-docs/tools_modules/redis_api_for_geode.html.md.erb", "diffHunk": "@@ -60,30 +65,47 @@ If the server is functioning properly, you should see a response of `PONG`.\n \n The Redis API for <%=vars.product_name%> currently supports the following commands.  See [Redis commands](https://redis.io/commands/) for a complete list of and more information on Redis commands.\n \n--   **Strings**: APPEND, GET, GETRANGE, SET\n+-   **Strings**: APPEND, GET, SET\n -   **Hashes**: HGETALL, HMSET, HSET\n -   **Sets**: SADD, SMEMBERS, SREM\n -   **Publish/Subscribe**: PUBLISH, PSUBSCRIBE, PUNSUBSCRIBE, SUBSCRIBE, UNSUBSCRIBE\n--   **Keys**: DEL, EXISTS, EXPIRE, PERSIST, PEXPIRE, PEXPIREAT, RENAME\n+-   **Keys**: DEL, EXISTS, EXPIRE, EXPIREAT, KEYS, PERSIST, PEXPIRE, PEXPIREAT, PTTL, RENAME, TTL, TYPE\n+-   **Connection**: AUTH, PING, QUIT\n \n-The following Redis API for <%=vars.product_name%> commands are **experimental**:\n+The following Redis API for <%=vars.product_name%> commands are **unsupported**:\n \n--   **Strings**: BITCOUNT, BITOP, BITPOS, DECR, DECRBY, GETBIT, GETSET, INCR, INCRBY, INCRBYFLOAT, MGET,\n-  MSET, MSETNX, PSETEX, SETBIT, SETEX, SETNX, STRLEN\n--   **Lists**: LINDEX, LLEN, LPOP, LPUSH, LPUSHX, LRANGE, LREM, LSET, LTRIM, RPOP, RPUSH, RPUSHX\n--   **Hashes**: HDEL, HEXISTS, HGET, HINCRBY, HINCRBYFLOAT, HKEYS, HMGET, HSETNX, HLEN, HSCAN, HVALS\n+-   **Strings**: BITCOUNT, BITOP, BITPOS, DECR, DECRBY, GETBIT, GETRANGE, GETSET, INCR, INCRBY, INCRBYFLOAT, MGET,\n+  MSET, MSETNX, PSETEX, SETBIT, SETEX, SETNX, SETRANGE, STRLEN\n+-   **Hashes**: HDEL, HEXISTS, HGET, HINCRBY, HINCRBYFLOAT, HKEYS, HLEN, HMGET, HSCAN, HSETNX, HVALS\n -   **Sets**: SCARD, SDIFF, SDIFFSTORE, SINTER, SINTERSTORE, SISMEMBER, SMOVE, SPOP, SRANDMEMBER,\n   SSCAN, SUNION, SUNIONSTORE\n--   **SortedSets**: ZADD, ZCARD, ZCOUNT, ZINCRBY, ZLEXCOUNT, ZRANGE, ZRANGEBYLEX, ZRANGEBYSCORE,\n-  ZRANK, ZREM, ZREMRANGEBYLEX, ZREMRANGEBYRANK, ZREMRANGEBYSCORE, ZREVRANGE, ZREVRANGEBYSCORE,\n-  ZREVRANK, ZSCAN, ZSCORE\n--   **HyperLogLog**: PFADD, PFCOUNT, PFMERGE\n--   **Keys**: DBSIZE, EXPIREAT, FLUSHDB, FLUSHALL, KEYS, PTTL, SCAN, TTL\n--   **Transactions**: DISCARD, EXEC, MULTI\n--   **Server**: AUTH, ECHO, PING, QUIT\n+-   **Keys**: FLUSHALL (no async option), FLUSHDB (no async option), SCAN\n+-   **Server**: DBSIZE, ECHO, TIME, SHUTDOWN", "originalCommit": "9daa41a8d4a0cb40145c3b997c27e34076a4d35c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUzNzYxMw==", "url": "https://github.com/apache/geode/pull/5214#discussion_r435537613", "bodyText": "Redis groups it with other Server commands: https://redis.io/commands#server\nShould we use the same grouping as Redis?", "author": "sabbey37", "createdAt": "2020-06-04T20:44:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUxOTM1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0MDAyNw==", "url": "https://github.com/apache/geode/pull/5214#discussion_r435540027", "bodyText": "Just realizing we need to move FLUSHALL and FLUSHDB as well since Redis groups them with the Server commands", "author": "sabbey37", "createdAt": "2020-06-04T20:48:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUxOTM1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0MTAxOA==", "url": "https://github.com/apache/geode/pull/5214#discussion_r435541018", "bodyText": "I agree that we should follow redis's grouping. I had not even noticed that redis had the \"filter by group\" drop down.\nSo: FLUSHALL and FLUSHDB are also in the \"Server\" group. So that leaves just SCAN in our unsupported \"Keys\" group.", "author": "dschneider-pivotal", "createdAt": "2020-06-04T20:50:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUxOTM1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0Mjc3Ng==", "url": "https://github.com/apache/geode/pull/5214#discussion_r435542776", "bodyText": "I just reorganized them, please double check though.", "author": "sabbey37", "createdAt": "2020-06-04T20:54:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUxOTM1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0OTE0MQ==", "url": "https://github.com/apache/geode/pull/5214#discussion_r435549141", "bodyText": "looks good", "author": "dschneider-pivotal", "createdAt": "2020-06-04T21:06:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTUxOTM1Mw=="}], "type": "inlineReview"}, {"oid": "97d891966d350d42000d1f16f9dbed7cee3d29b0", "url": "https://github.com/apache/geode/commit/97d891966d350d42000d1f16f9dbed7cee3d29b0", "message": "Removes duplicate commands", "committedDate": "2020-06-04T20:41:55Z", "type": "commit"}, {"oid": "6b77e624734cc5f343274f5ff3bd11c7d156ffb1", "url": "https://github.com/apache/geode/commit/6b77e624734cc5f343274f5ff3bd11c7d156ffb1", "message": "reorganizes commands", "committedDate": "2020-06-04T20:53:12Z", "type": "commit"}, {"oid": "75118a67358f1f25174692c4a9aed90fa5e43039", "url": "https://github.com/apache/geode/commit/75118a67358f1f25174692c4a9aed90fa5e43039", "message": "Adds description of unsupported commands", "committedDate": "2020-06-05T16:58:31Z", "type": "commit"}, {"oid": "f7bc2b00a9eedb998a363362dd8b82754c15c874", "url": "https://github.com/apache/geode/commit/f7bc2b00a9eedb998a363362dd8b82754c15c874", "message": "Addtional edits", "committedDate": "2020-06-05T19:04:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE3ODY0NA==", "url": "https://github.com/apache/geode/pull/5214#discussion_r436178644", "bodyText": "For clarity, please begin each bullet with the type of expiration it explains. A bit more stilted, stylistically, but worth it I think for ease of apprehension. Something like this:\n\nWith active expiration, expiration is evaluated..\nWith passive expiration, keys are evaluated every second...", "author": "davebarnes97", "createdAt": "2020-06-05T21:47:14Z", "path": "geode-docs/tools_modules/redis_api_for_geode.html.md.erb", "diffHunk": "@@ -60,30 +65,52 @@ If the server is functioning properly, you should see a response of `PONG`.\n \n The Redis API for <%=vars.product_name%> currently supports the following commands.  See [Redis commands](https://redis.io/commands/) for a complete list of and more information on Redis commands.\n \n--   **Strings**: APPEND, GET, GETRANGE, SET\n+**Note**: These commands are supported for Redis 5.\n+\n+-   **Connection**: AUTH, PING, QUIT\n -   **Hashes**: HGETALL, HMSET, HSET\n--   **Sets**: SADD, SMEMBERS, SREM\n+-   **Keys**: DEL, EXISTS, EXPIRE, EXPIREAT, KEYS, PERSIST, PEXPIRE, PEXPIREAT, PTTL, RENAME, TTL, TYPE\n -   **Publish/Subscribe**: PUBLISH, PSUBSCRIBE, PUNSUBSCRIBE, SUBSCRIBE, UNSUBSCRIBE\n--   **Keys**: DEL, EXISTS, EXPIRE, PERSIST, PEXPIRE, PEXPIREAT, RENAME\n+-   **Sets**: SADD, SMEMBERS, SREM\n+-   **Strings**: APPEND, GET, SET\n \n-The following Redis API for <%=vars.product_name%> commands are **experimental**:\n+The following Redis API for <%=vars.product_name%> commands are **unsupported**. Unsupported\n+commands are available to use, but have not been fully tested. There is no guarantee they will work\n+exactly as expected.\n \n--   **Strings**: BITCOUNT, BITOP, BITPOS, DECR, DECRBY, GETBIT, GETSET, INCR, INCRBY, INCRBYFLOAT, MGET,\n-  MSET, MSETNX, PSETEX, SETBIT, SETEX, SETNX, STRLEN\n--   **Lists**: LINDEX, LLEN, LPOP, LPUSH, LPUSHX, LRANGE, LREM, LSET, LTRIM, RPOP, RPUSH, RPUSHX\n--   **Hashes**: HDEL, HEXISTS, HGET, HINCRBY, HINCRBYFLOAT, HKEYS, HMGET, HSETNX, HLEN, HSCAN, HVALS\n+-   **Connection**: ECHO\n+-   **Hashes**: HDEL, HEXISTS, HGET, HINCRBY, HINCRBYFLOAT, HKEYS, HLEN, HMGET, HSCAN, HSETNX, HVALS\n+-   **Keys**: SCAN\n+-   **Server**: DBSIZE, FLUSHALL (no async option), FLUSHDB (no async option), SHUTDOWN, TIME\n -   **Sets**: SCARD, SDIFF, SDIFFSTORE, SINTER, SINTERSTORE, SISMEMBER, SMOVE, SPOP, SRANDMEMBER,\n   SSCAN, SUNION, SUNIONSTORE\n--   **SortedSets**: ZADD, ZCARD, ZCOUNT, ZINCRBY, ZLEXCOUNT, ZRANGE, ZRANGEBYLEX, ZRANGEBYSCORE,\n-  ZRANK, ZREM, ZREMRANGEBYLEX, ZREMRANGEBYRANK, ZREMRANGEBYSCORE, ZREVRANGE, ZREVRANGEBYSCORE,\n-  ZREVRANK, ZSCAN, ZSCORE\n--   **HyperLogLog**: PFADD, PFCOUNT, PFMERGE\n--   **Keys**: DBSIZE, EXPIREAT, FLUSHDB, FLUSHALL, KEYS, PTTL, SCAN, TTL\n--   **Transactions**: DISCARD, EXEC, MULTI\n--   **Server**: AUTH, ECHO, PING, QUIT\n+-   **Strings**: BITCOUNT, BITOP, BITPOS, DECR, DECRBY, GETBIT, GETRANGE, GETSET, INCR, INCRBY, INCRBYFLOAT, MGET,\n+  MSET, MSETNX, PSETEX, SETBIT, SETEX, SETNX, SETRANGE, STRLEN\n+\n+\n+To enable unsupported commands, the Geode server must be started with the Java property `enable-redis-unsupported-commands=true`:\n+\n+```pre\n+start server \\\n+  --J=-Denable-redis-unsupported-commands=true \\\n+  --name=<serverName> \\\n+  --locators=<locatorPort> \\\n+  --redis-port=<redisPort> \\\n+  --redis-bind-address=<redisBindAddress> \\\n+  --redis-password=<redisPassword>\n+```\n+\n+Commands not listed above are **not implemented**.\n \n ## <a id=\"advantages-of-<%=vars.product_name_lowercase%>-over-redis\" class=\"no-quick-link\"></a>Advantages of <%=vars.product_name%> over Redis\n \n <%=vars.product_name%>\u2019s primary advantage is its **scalability**. While the Redis server is single threaded, <%=vars.product_name%> supports high concurrency. Many Redis clients can execute commands on the <%=vars.product_name%> cluster simultaneously.\n \n-<%=vars.product_name%>'s architecture and management features help detect and resolve **network partitioning** problems without explicit management on the part of the Redis client.\n\\ No newline at end of file\n+<%=vars.product_name%>'s architecture and management features help detect and resolve **network partitioning** problems without explicit management on the part of the Redis client.\n+\n+## <a id=\"expiration-accuracy\" class=\"no-quick-link\"></a>Expiration Accuracy\n+\n+Keys are expired in two ways, actively and passively:\n+\n+-   Expiration is evaluated whenever a key is accessed. If the key is due to expire, it is deleted. Active expiration is accurate to the millisecond.", "originalCommit": "f7bc2b00a9eedb998a363362dd8b82754c15c874", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjcxMDQ5OQ==", "url": "https://github.com/apache/geode/pull/5214#discussion_r436710499", "bodyText": "Just updated it!", "author": "sabbey37", "createdAt": "2020-06-08T13:42:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE3ODY0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4MTg3NA==", "url": "https://github.com/apache/geode/pull/5214#discussion_r436181874", "bodyText": "Not part of this PR, but a potential problem. We use template variables to allow portability to other products that use the geode open-source repo. Use in section names (such as \"Advantages of <%=vars.product_name%>...\" follows this intention. However, use in target ids (such as \"#advantages-of-<%=vars.product_name_lowercase%>-over-redis\") defeats the purpose, as the links are almost certainly guaranteed to fail in other contexts. The anchor tags should be genericized, for example \"advantages-over-redis\".", "author": "davebarnes97", "createdAt": "2020-06-05T21:57:15Z", "path": "geode-book/master_middleman/source/subnavs/geode-subnav.erb", "diffHunk": "@@ -2197,6 +2197,9 @@ gfsh</a>\n                             <li>\n                                 <a href=\"/docs/guide/<%=vars.product_version_nodot%>/tools_modules/redis_api_for_geode.html#advantages-of-<%=vars.product_name_lowercase%>-over-redis\">Advantages of <%=vars.product_name%> over Redis</a>", "originalCommit": "f7bc2b00a9eedb998a363362dd8b82754c15c874", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjcxMDk0NA==", "url": "https://github.com/apache/geode/pull/5214#discussion_r436710944", "bodyText": "I went ahead and updated it.", "author": "sabbey37", "createdAt": "2020-06-08T13:42:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4MTg3NA=="}], "type": "inlineReview"}, {"oid": "35ed195371d1dccf972693555c5d50b7cab6cf55", "url": "https://github.com/apache/geode/commit/35ed195371d1dccf972693555c5d50b7cab6cf55", "message": "PR review changes", "committedDate": "2020-06-08T13:42:09Z", "type": "commit"}]}