{"pr_number": 4650, "pr_title": "GEODE-7752: Removed the current optionality on the ClusterManagementServiceBuilder", "pr_createdAt": "2020-01-30T19:02:20Z", "pr_url": "https://github.com/apache/geode/pull/4650", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE5OTUwNg==", "url": "https://github.com/apache/geode/pull/4650#discussion_r373199506", "bodyText": "Is there anyway to make building cms easier? I don't need to know any RestTemplateClusterManagementServiceTransport, I don't need to know any BaseConnectionConfig, I just want to plug in the host and port.....", "author": "jinmeiliao", "createdAt": "2020-01-30T21:20:33Z", "path": "geode-assembly/src/acceptanceTest/resources/ManagementClientCreateRegion.java", "diffHunk": "@@ -32,14 +33,18 @@ public static void main(String[] args) throws Exception {\n     if (useSsl) {\n       // The default SSLContext will pull in all necessary javax.net.ssl properties\n       cms =\n-          new ClusterManagementServiceBuilder().setConnectionConfig(\n-              new BaseConnectionConfig(\"localhost\", httpPort)\n-                  .setSslContext(SSLContext.getDefault()))\n+          new ClusterManagementServiceBuilder()\n+              .setTransport(new RestTemplateClusterManagementServiceTransport(", "originalCommit": "aa73ee63a668b0934d8aa2640ade40eb08545ce7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzI0NzQ0OA==", "url": "https://github.com/apache/geode/pull/4650#discussion_r373247448", "bodyText": "host and port can be set via system properties.\nIn this change all that I have done is made the transport explicit. I don't think there is anything wrong with exposing that there is a Transport and what kind of transport is being used.\nWhat is incorrect is having multiple options on a Builder that if you incorrectly pick will cause failure, rather than an intuitive Builder where differences from \"normal\"  are handled as optional and there is a happy case.", "author": "kohlmu-pivotal", "createdAt": "2020-01-30T23:24:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE5OTUwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzI1NzY0Mw==", "url": "https://github.com/apache/geode/pull/4650#discussion_r373257643", "bodyText": "what I mean is: is there a way to build a cms without having to know I need to construct a BaseConnectionConfig and a a RestTemplate....Transport.", "author": "jinmeiliao", "createdAt": "2020-01-31T00:00:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE5OTUwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDk3MTgzNA==", "url": "https://github.com/apache/geode/pull/4650#discussion_r374971834", "bodyText": "@jinmeiliao I've made a few changes. Added GeodeClusterManagementServiceBuilder which is specifically geared towards the Geode Cache CMS configuration. The current ClusterManagementServiceBuilder is specifically targeted to a non-Cache CMS builder.\nI've also added GeodeConnectionConfig and cleaned up the BaseConnectionConfig / ConnectionConfig confusion.\nI hope that my latest refactor will not force the user to know about RestTemplate..... Transport. You can still create your own Transport and add it using setTransport", "author": "kohlmu-pivotal", "createdAt": "2020-02-04T22:58:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE5OTUwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzNzA2MQ==", "url": "https://github.com/apache/geode/pull/4650#discussion_r375437061", "bodyText": "I like the current state a lot better now.  The only request I have is to move this builder out of the internal package. It should be a public api.", "author": "jinmeiliao", "createdAt": "2020-02-05T18:42:12Z", "path": "geode-core/src/main/java/org/apache/geode/management/internal/builder/GeodeClusterManagementServiceBuilder.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to You under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ *\n+ */\n+\n+package org.apache.geode.management.internal.builder;", "originalCommit": "63be39dfbb126d7ac23a345bbf14555f89f4d034", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzNzY2OA==", "url": "https://github.com/apache/geode/pull/4650#discussion_r375437668", "bodyText": "And I believe the cache needs to work on both client cache and server cache. You can refer back to the state of things before Jens made all the changes to the builder", "author": "jinmeiliao", "createdAt": "2020-02-05T18:43:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzNzA2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ2OTQ3Nw==", "url": "https://github.com/apache/geode/pull/4650#discussion_r375469477", "bodyText": "I like the current state a lot better now. The only request I have is to move this builder out of the internal package. It should be a public api.\n\nGood catch! I did not see that .. Will move this to a public interface", "author": "kohlmu-pivotal", "createdAt": "2020-02-05T19:43:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzNzA2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQ2OTczNw==", "url": "https://github.com/apache/geode/pull/4650#discussion_r375469737", "bodyText": "And I believe the cache needs to work on both client cache and server cache. You can refer back to the state of things before Jens made all the changes to the builder\n\nThe GeodeConnectionConfig works for both client and Server.\nIf you look at the GeodeConnectionConfig constructor, you will see that we process the cache as either a client cache or server cache. This way the decision point / code is only in the config, where it belongs.\nPlease let me know if you feel this is not sufficient.", "author": "kohlmu-pivotal", "createdAt": "2020-02-05T19:44:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTQzNzA2MQ=="}], "type": "inlineReview"}, {"oid": "88286f22f1ad9e5c5489ed23cb6eff0ab1b21cdd", "url": "https://github.com/apache/geode/commit/88286f22f1ad9e5c5489ed23cb6eff0ab1b21cdd", "message": "GEODE-7752: Removed the current optionality on the ClusterManagementServiceBuilder.\nThe Transport is not responsible to set the ConnectionConfig.", "committedDate": "2020-02-05T20:48:52Z", "type": "commit"}]}