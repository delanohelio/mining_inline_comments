{"pr_number": 1763, "pr_title": "Attempt to handle parsing errors from tree-sitter.", "pr_createdAt": "2020-10-01T02:44:47Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/1763", "timeline": [{"oid": "653855ab89ee702a5543269801f84e5148c73891", "url": "https://github.com/returntocorp/semgrep/commit/653855ab89ee702a5543269801f84e5148c73891", "message": "Attempt to handle parsing errors from tree-sitter.", "committedDate": "2020-10-01T02:25:08Z", "type": "commit"}, {"oid": "a2ea4c00930c4a1258d87de099f197b8d5fd2e58", "url": "https://github.com/returntocorp/semgrep/commit/a2ea4c00930c4a1258d87de099f197b8d5fd2e58", "message": "Update pfff", "committedDate": "2020-10-01T03:05:43Z", "type": "commit"}, {"oid": "68cb9e8b121440fa99e8c60c6b246cd81f9cc575", "url": "https://github.com/returntocorp/semgrep/commit/68cb9e8b121440fa99e8c60c6b246cd81f9cc575", "message": "Update ocaml-tree-sitter", "committedDate": "2020-10-01T03:07:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzk4MzkyNg==", "url": "https://github.com/returntocorp/semgrep/pull/1763#discussion_r497983926", "bodyText": "Why removing 42?", "author": "aryx", "createdAt": "2020-10-01T04:58:22Z", "path": "semgrep-core/dune", "diffHunk": "@@ -1,5 +1,5 @@\n (env\n (dev\n-(flags (:standard -w +42-52-6)))\n+(flags (:standard -w -52-6)))", "originalCommit": "68cb9e8b121440fa99e8c60c6b246cd81f9cc575", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODM5NDU2MA==", "url": "https://github.com/returntocorp/semgrep/pull/1763#discussion_r498394560", "bodyText": "This is what warning 42 tells us:\nWarning 42: this use of x relies on type-directed disambiguation, it will not compile with OCaml 4.00 or earlier.\n\nIf 42 is enabled, the code gets really ugly when record fields from multiple modules need to be accessed. This was a problem for this code:\nlet mk_tree_sitter_error (err : Tree_sitter_run.Tree_sitter_error.t) =\n  let start = err.start_pos in\n  let loc = {\n    PI.str = err.substring;\n    charpos = 0; (* fake *)\n    line = start.row + 1;\n    column = start.column;\n    file = err.file.name;\n  } in\n  Error_code.({ loc; typ = ParseError; sev = Error })\nWith warning 42, we'd have to open 2 modules (Tree_sitter_run.Tree_sitter_error and Tree_sitter_run.Src_file), or access fields as err.Tree_sitter_error.substring in combination with let open Tree_sitter_run in, or create short module aliases... even though the compiler and the reader know exactly which type we're dealing with from the type annotation on the function argument.", "author": "mjambon", "createdAt": "2020-10-01T17:07:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzk4MzkyNg=="}], "type": "inlineReview"}]}