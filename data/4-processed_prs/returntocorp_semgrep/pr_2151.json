{"pr_number": 2151, "pr_title": "Basic support for metavariable matching multiple arguments in JS", "pr_createdAt": "2020-12-02T16:19:16Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/2151", "timeline": [{"oid": "1244312014114d04c5578cea867a60af660697ee", "url": "https://github.com/returntocorp/semgrep/commit/1244312014114d04c5578cea867a60af660697ee", "message": "Basic support for metavariable matching multiple arguments in JS\n\nFixes https://github.com/returntocorp/semgrep/issues/2150\nThere is probably more work after.\n\ntest plan:\nsee include files\nmake test", "committedDate": "2020-12-02T16:18:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMDI2MQ==", "url": "https://github.com/returntocorp/semgrep/pull/2151#discussion_r534310261", "bodyText": "My intuition is that we could match 0 items, but this might lead to weird matching in edge cases...\nI'd expect to be able to match:\nunsafe_api_call($ARGS...)\nto\nunsafe_api_call()\nso I could have an autofix:\nsafe_api_call($ARGS...)\n(I'm not sure how we're imagining performing autofix here, do we need to include the delimiter token inside the match?)", "author": "nbrahms", "createdAt": "2020-12-02T16:34:30Z", "path": "semgrep-core/matching/Generic_vs_generic.ml", "diffHunk": "@@ -1085,6 +1085,19 @@ and m_list__m_argument (xsa: A.argument list) (xsb: A.argument list) =\n   | [A.Arg (A.Ellipsis _i)], [] ->\n       return ()\n \n+  | A.Arg (A.Id ((s, tok), _idinfo))::xsa, xb::xsb\n+    when MV.is_metavar_ellipsis s ->\n+      (* can match 1 or more arguments (or 0 is ok too?) *)", "originalCommit": "1244312014114d04c5578cea867a60af660697ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMyMDY4Ng==", "url": "https://github.com/returntocorp/semgrep/pull/2151#discussion_r534320686", "bodyText": "I was just scared that if it matches nothing, then we will get some NoTokenLocation errors.\nBut yes my intuition is that I think also it should match 0 or more.", "author": "aryx", "createdAt": "2020-12-02T16:48:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMDI2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMjU1NQ==", "url": "https://github.com/returntocorp/semgrep/pull/2151#discussion_r534312555", "bodyText": "The more I think about this, the more I think we need to include the delimiter in the match", "author": "nbrahms", "createdAt": "2020-12-02T16:37:35Z", "path": "semgrep-core/matching/Matching_generic.mli", "diffHunk": "@@ -62,6 +62,7 @@ val check_and_add_metavar_binding :\n (*s: signature [[Matching_generic.has_ellipsis_stmts]] *)\n val has_ellipsis_stmts : AST_generic.stmt list -> bool\n (*e: signature [[Matching_generic.has_ellipsis_stmts]] *)\n+val inits_and_rest_of_list: 'a list -> ('a list * 'a list) list", "originalCommit": "1244312014114d04c5578cea867a60af660697ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}