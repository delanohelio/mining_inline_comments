{"pr_number": 986, "pr_title": "Add imported entity metavariable as expression in the environment", "pr_createdAt": "2020-06-12T14:19:02Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/986", "timeline": [{"oid": "4fbe2526a9210591288f57701dd25e9c66d1106f", "url": "https://github.com/returntocorp/semgrep/commit/4fbe2526a9210591288f57701dd25e9c66d1106f", "message": "Add imported entity metavariable as expression in the environment\n\nThis fix issue #974\nThe main issue is that the metavariable matching was working, but\nthe metavar was added as an ident in the environment, instead of an expr,\nand so later one when the same metavariable is used in an expression context,\nit was not matching the same metavar that was binded to an ident.\n\nWe had similar problems before where a metavar on a function definition\nwas not matching later the same metavar used in a function call.\n\nTest plan:\ntest files included", "committedDate": "2020-06-12T14:18:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyOTE4NA==", "url": "https://github.com/returntocorp/semgrep/pull/986#discussion_r439529184", "bodyText": "Nice! Does this work for anything pulled into the namespace here? In other words, if I have import { func1, func2, func3 } this will detect func1(...), func2(...), or func3(...)? I can imagine user's will want it either way. Is there a way to specify if I only care about func1(...). E.g. something like import { ..., func1, ... } from 'dependency';?", "author": "mschwager", "createdAt": "2020-06-12T16:42:28Z", "path": "semgrep-core/tests/js/metavar_import3.sgrep", "diffHunk": "@@ -0,0 +1,3 @@\n+import { $X } from 'dependency';\n+...\n+$X(...);", "originalCommit": "4fbe2526a9210591288f57701dd25e9c66d1106f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTczMjA2Nw==", "url": "https://github.com/returntocorp/semgrep/pull/986#discussion_r439732067", "bodyText": "import {a, b, c} from 'X' is transformed internally as import {a} from 'X'; import {b} from 'X';\nso yes doing import {$X} from 'dependency' will have $X match in turn func1, func2, and func3.\nYou can also do import { func1 } from 'dependency' and it will also match, even if it was written as import { func2, func3, func1 }", "author": "aryx", "createdAt": "2020-06-13T11:31:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyOTE4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3NTgzNw==", "url": "https://github.com/returntocorp/semgrep/pull/986#discussion_r440275837", "bodyText": "Ahh, great, thanks for the clarification!", "author": "mschwager", "createdAt": "2020-06-15T15:51:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTUyOTE4NA=="}], "type": "inlineReview"}]}