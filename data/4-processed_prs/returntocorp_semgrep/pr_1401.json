{"pr_number": 1401, "pr_title": "Add python backed pre-commit hook", "pr_createdAt": "2020-07-29T23:11:09Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/1401", "timeline": [{"oid": "8da8ae9b7c75cd7db9baa486b74211012bef6564", "url": "https://github.com/returntocorp/semgrep/commit/8da8ae9b7c75cd7db9baa486b74211012bef6564", "message": "Add python backed pre-commit hook", "committedDate": "2020-07-29T23:10:09Z", "type": "commit"}, {"oid": "5fba6550c4ef46f69f38ad40d1e6afcc45615094", "url": "https://github.com/returntocorp/semgrep/commit/5fba6550c4ef46f69f38ad40d1e6afcc45615094", "message": "fixup! Add python backed pre-commit hook", "committedDate": "2020-07-29T23:30:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE4MTAyMg==", "url": "https://github.com/returntocorp/semgrep/pull/1401#discussion_r463181022", "bodyText": "Will we be breaking backwards compatibility at all for existing pre-commit configurations? I don't think so. Since the Docker image uses the Python package and they present the same interface I think we're fine here. Thoughts?\nIf there's no backwards compatibility issues, and we go with semgrep-docker, we should update the first one to semgrep-docker-develop. Although we'll also have to update a few of our internal pre-commit configurations. Maybe it's not worth it, what do you think?", "author": "mschwager", "createdAt": "2020-07-30T18:11:08Z", "path": ".pre-commit-hooks.yaml", "diffHunk": "@@ -4,8 +4,16 @@\n   language: docker_image\n   entry: returntocorp/semgrep:develop\n \n-- id: semgrep\n+- id: semgrep-docker\n   name: semgrep\n   description: This hook runs semgrep\n   language: docker_image\n   entry: returntocorp/semgrep:latest\n+\n+- id: semgrep", "originalCommit": "5fba6550c4ef46f69f38ad40d1e6afcc45615094", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzI1NDIzOQ==", "url": "https://github.com/returntocorp/semgrep/pull/1401#discussion_r463254239", "bodyText": "There should not be any issues since when you specify a pre-commit hook you specify the git tag the repo is checked out at so any existing users that use the id semgrep will still actually use the docker container one.", "author": "brendongo", "createdAt": "2020-07-30T20:32:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE4MTAyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE4NDE2Mw==", "url": "https://github.com/returntocorp/semgrep/pull/1401#discussion_r463184163", "bodyText": "Should we instead use something like semgrep_pre_commit_package? That way if we ever see this string anywhere it'll give us a hint as to where it's coming from. We may also want to grab this PyPI package name just so there's no funny business ever going on with that.", "author": "mschwager", "createdAt": "2020-07-30T18:16:59Z", "path": "setup.py", "diffHunk": "@@ -0,0 +1,10 @@\n+# type: ignore\n+# Used for pre-commit since it expects a setup.py in repo root\n+# for actual setup.py see semgrep/setup.py\n+from setuptools import setup\n+\n+setup(\n+    name=\"pre_commit_dummy_package\",", "originalCommit": "5fba6550c4ef46f69f38ad40d1e6afcc45615094", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzI1MzM5MA==", "url": "https://github.com/returntocorp/semgrep/pull/1401#discussion_r463253390", "bodyText": "Went with your suggestion and parked the name", "author": "brendongo", "createdAt": "2020-07-30T20:30:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE4NDE2Mw=="}], "type": "inlineReview"}, {"oid": "ef1b5aeae987345944f056993db7b638110b1987", "url": "https://github.com/returntocorp/semgrep/commit/ef1b5aeae987345944f056993db7b638110b1987", "message": "fixup! fixup! Add python backed pre-commit hook", "committedDate": "2020-07-30T20:30:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQ0NjE1Mg==", "url": "https://github.com/returntocorp/semgrep/pull/1401#discussion_r464446152", "bodyText": "It looks like these are the default values for args, require_serial, and additional_dependencies, so we shouldn't need to re-specify them here.", "author": "mschwager", "createdAt": "2020-08-03T14:23:05Z", "path": ".pre-commit-hooks.yaml", "diffHunk": "@@ -4,8 +4,16 @@\n   language: docker_image\n   entry: returntocorp/semgrep:develop\n \n-- id: semgrep\n+- id: semgrep-docker\n   name: semgrep\n   description: This hook runs semgrep\n   language: docker_image\n   entry: returntocorp/semgrep:latest\n+\n+- id: semgrep\n+  name: semgrep\n+  entry: semgrep\n+  language: python\n+  args: []", "originalCommit": "ef1b5aeae987345944f056993db7b638110b1987", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQ0Nzc1OA==", "url": "https://github.com/returntocorp/semgrep/pull/1401#discussion_r464447758", "bodyText": "Not sure why Github won't allow me to comment on the unchanged line above... Should we move semgrep-develop -> semgrep-docker-develop above to stay consistent here?", "author": "mschwager", "createdAt": "2020-08-03T14:25:31Z", "path": ".pre-commit-hooks.yaml", "diffHunk": "@@ -4,8 +4,16 @@\n   language: docker_image\n   entry: returntocorp/semgrep:develop\n \n-- id: semgrep\n+- id: semgrep-docker", "originalCommit": "ef1b5aeae987345944f056993db7b638110b1987", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "676098fc9c3c13f95d64281259ec923c97baf784", "url": "https://github.com/returntocorp/semgrep/commit/676098fc9c3c13f95d64281259ec923c97baf784", "message": "fixup! fixup! fixup! Add python backed pre-commit hook", "committedDate": "2020-08-03T20:51:11Z", "type": "commit"}]}