{"pr_number": 610, "pr_title": "Add  flag for specifying number of subprocesses to use to run checks in parallel", "pr_createdAt": "2020-04-29T19:29:42Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/610", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU4NDIwMQ==", "url": "https://github.com/returntocorp/semgrep/pull/610#discussion_r417584201", "bodyText": "Is --cpus more clear?", "author": "brendongo", "createdAt": "2020-04-29T20:15:36Z", "path": "semgrep/semgrep/cli.py", "diffHunk": "@@ -81,6 +82,14 @@ def cli() -> None:\n         action=\"store_true\",\n     )\n     config.add_argument(\"--precommit\", help=argparse.SUPPRESS, action=\"store_true\")\n+    config.add_argument(\n+        \"-j\",\n+        \"--jobs\",", "originalCommit": "8b8816f9bc429b7a7cef817e1ebfb9f6aa901cb5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU5MTM0MQ==", "url": "https://github.com/returntocorp/semgrep/pull/610#discussion_r417591341", "bodyText": "I actually see -j/--jobs more commonly used, e.g. make and flake8", "author": "mschwager", "createdAt": "2020-04-29T20:28:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU4NDIwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzgyNjE1OQ==", "url": "https://github.com/returntocorp/semgrep/pull/610#discussion_r417826159", "bodyText": "thx!\nI wanted to add it but was waiting for it being supported in the python wrapper.", "author": "aryx", "createdAt": "2020-04-30T07:59:22Z", "path": "CHANGELOG.md", "diffHunk": "@@ -2,6 +2,11 @@\n \n This project adheres to [Semantic Versioning](http://semver.org/spec/v2.0.0.html).\n \n+## [Unreleased]\n+\n+### Added\n+- The `-j/--jobs` flag for specifying number of subprocesses to use to run checks in parallel.", "originalCommit": "bc0c6e189a2fbeab1402073a8a287f27e3a5ed65", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzgyNjMyOQ==", "url": "https://github.com/returntocorp/semgrep/pull/610#discussion_r417826329", "bodyText": "oops", "author": "aryx", "createdAt": "2020-04-30T07:59:41Z", "path": "semgrep-core/bin/main_semgrep_core.ml", "diffHunk": "@@ -109,7 +109,7 @@ let set_gc () =\n   ()\n \n let map f xs =\n-  if !ncores = 1\n+  if !ncores <= 1", "originalCommit": "bc0c6e189a2fbeab1402073a8a287f27e3a5ed65", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e4c99358b3d4ef13693aef2e334e1f88356f9d52", "url": "https://github.com/returntocorp/semgrep/commit/e4c99358b3d4ef13693aef2e334e1f88356f9d52", "message": "Try exporting env variable here", "committedDate": "2020-04-30T15:12:51Z", "type": "forcePushed"}, {"oid": "3135c6951c2c3f343b9a4578b545de6bd8a6d9d1", "url": "https://github.com/returntocorp/semgrep/commit/3135c6951c2c3f343b9a4578b545de6bd8a6d9d1", "message": "Add  flag for specifying number of subprocesses to use to run checks in parallel", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "ac916bb3286194b1da093ba92abdec8e5b45f282", "url": "https://github.com/returntocorp/semgrep/commit/ac916bb3286194b1da093ba92abdec8e5b45f282", "message": "Handle Windows multiprocessing.cpu_count case", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "fafe77e9851e3e7902eab81e8f07beae051c2dc6", "url": "https://github.com/returntocorp/semgrep/commit/fafe77e9851e3e7902eab81e8f07beae051c2dc6", "message": "Avoid breaking when ncores <= 0", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "d89178d2d9086dd0f49e73974f172547c5295c8a", "url": "https://github.com/returntocorp/semgrep/commit/d89178d2d9086dd0f49e73974f172547c5295c8a", "message": "Enable OCaml backtraces in CI", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "88c4a67f8425dd1de5634a7495db023c3dc69e3a", "url": "https://github.com/returntocorp/semgrep/commit/88c4a67f8425dd1de5634a7495db023c3dc69e3a", "message": "Install wheel package to avoid error: invalid command 'bdist_wheel'", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "0a87bfc5e188395a806596689a9cc76babb0c3fc", "url": "https://github.com/returntocorp/semgrep/commit/0a87bfc5e188395a806596689a9cc76babb0c3fc", "message": "Try exporting env variable here", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "e2fe8ee49ac60c86c5742d9cd272fb607608a2b5", "url": "https://github.com/returntocorp/semgrep/commit/e2fe8ee49ac60c86c5742d9cd272fb607608a2b5", "message": "Pass env variable to subprocess", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "012944ad0fab5da1521c36c61aff3f661e91969b", "url": "https://github.com/returntocorp/semgrep/commit/012944ad0fab5da1521c36c61aff3f661e91969b", "message": "Try this", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "14700f5d9d106bfc61a995baa10b05c8fde8bb54", "url": "https://github.com/returntocorp/semgrep/commit/14700f5d9d106bfc61a995baa10b05c8fde8bb54", "message": "Add jobs argument to test.py", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "2afa9d85c8539d334930ba2ab84cded6b0cbe39c", "url": "https://github.com/returntocorp/semgrep/commit/2afa9d85c8539d334930ba2ab84cded6b0cbe39c", "message": "Remove unused import", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "e68d458034eeadcb88f776093fe8bbe3e072a98a", "url": "https://github.com/returntocorp/semgrep/commit/e68d458034eeadcb88f776093fe8bbe3e072a98a", "message": "Keep trying", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "2b61cabcc460331aecf7589a176cc566b9233741", "url": "https://github.com/returntocorp/semgrep/commit/2b61cabcc460331aecf7589a176cc566b9233741", "message": "Another thing", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "3fef595b1a3cad54ae3a20365447ff9eb2520074", "url": "https://github.com/returntocorp/semgrep/commit/3fef595b1a3cad54ae3a20365447ff9eb2520074", "message": "Try hard coded CPU count", "committedDate": "2020-04-30T19:40:34Z", "type": "commit"}, {"oid": "3fef595b1a3cad54ae3a20365447ff9eb2520074", "url": "https://github.com/returntocorp/semgrep/commit/3fef595b1a3cad54ae3a20365447ff9eb2520074", "message": "Try hard coded CPU count", "committedDate": "2020-04-30T19:40:34Z", "type": "forcePushed"}, {"oid": "787c93fbc0fad705fb6b6655bc192d5fcd5a2547", "url": "https://github.com/returntocorp/semgrep/commit/787c93fbc0fad705fb6b6655bc192d5fcd5a2547", "message": "Try chunksize 0 case", "committedDate": "2020-04-30T19:49:58Z", "type": "commit"}, {"oid": "6ae1fa57efbd6fbf25f0b113e3a659d5abc0e187", "url": "https://github.com/returntocorp/semgrep/commit/6ae1fa57efbd6fbf25f0b113e3a659d5abc0e187", "message": "add OCAMLRUNPARAM='b' to test script", "committedDate": "2020-05-03T05:26:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTA1MDYwMA==", "url": "https://github.com/returntocorp/semgrep/pull/610#discussion_r419050600", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    args.dangerously_allow_arbitrary_code_execution_from_rules, args.jobs\n          \n          \n            \n                    allow_exec=args.dangerously_allow_arbitrary_code_execution_from_rules, jobs=args.jobs", "author": "DrewDennison", "createdAt": "2020-05-03T05:32:33Z", "path": "semgrep/semgrep/semgrep_main.py", "diffHunk": "@@ -251,7 +251,7 @@ def main(args: argparse.Namespace) -> Dict[str, Any]:\n \n     # actually invoke semgrep\n     rule_matches_by_rule, semgrep_errors = CoreRunner(\n-        args.dangerously_allow_arbitrary_code_execution_from_rules,\n+        args.dangerously_allow_arbitrary_code_execution_from_rules, args.jobs", "originalCommit": "6ae1fa57efbd6fbf25f0b113e3a659d5abc0e187", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2783a52b7974ece2ee4dfbe83e05bb2a7dd14f9f", "url": "https://github.com/returntocorp/semgrep/commit/2783a52b7974ece2ee4dfbe83e05bb2a7dd14f9f", "message": "Merge branch 'develop' into mschwager-jobs-flag", "committedDate": "2020-05-03T05:52:18Z", "type": "commit"}, {"oid": "752c334b04fffaf2adfd5e264c88b459e678087d", "url": "https://github.com/returntocorp/semgrep/commit/752c334b04fffaf2adfd5e264c88b459e678087d", "message": "Update semgrep/semgrep/semgrep_main.py", "committedDate": "2020-05-03T05:52:59Z", "type": "commit"}, {"oid": "5d743407aedc3a8fd97f7e17afe3c151520ee5dc", "url": "https://github.com/returntocorp/semgrep/commit/5d743407aedc3a8fd97f7e17afe3c151520ee5dc", "message": "blacken", "committedDate": "2020-05-03T05:56:09Z", "type": "commit"}, {"oid": "d32c292ad41dcb879994d0dc300136c264425149", "url": "https://github.com/returntocorp/semgrep/commit/d32c292ad41dcb879994d0dc300136c264425149", "message": "fix division by zero error", "committedDate": "2020-05-03T06:29:16Z", "type": "commit"}, {"oid": "cc4a4b83052935a7935069bbd52074d2ce995bbd", "url": "https://github.com/returntocorp/semgrep/commit/cc4a4b83052935a7935069bbd52074d2ce995bbd", "message": "let's remove the ocaml stack trace flag since it didn't seem to work", "committedDate": "2020-05-03T06:48:22Z", "type": "commit"}, {"oid": "9ebbef4cbbbfba061d03683cd575c235395eabf1", "url": "https://github.com/returntocorp/semgrep/commit/9ebbef4cbbbfba061d03683cd575c235395eabf1", "message": "add asserts", "committedDate": "2020-05-03T07:25:13Z", "type": "commit"}, {"oid": "6ccf014e859f1bf748fcd94bd2564ebcde737c3b", "url": "https://github.com/returntocorp/semgrep/commit/6ccf014e859f1bf748fcd94bd2564ebcde737c3b", "message": "do in 1 line", "committedDate": "2020-05-03T07:26:18Z", "type": "commit"}]}