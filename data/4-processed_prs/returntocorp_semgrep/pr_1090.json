{"pr_number": 1090, "pr_title": "Convert parse errors from SemgrepCore into SemgrepError", "pr_createdAt": "2020-06-20T19:02:46Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/1090", "timeline": [{"oid": "6235fed0f298cb5a58512e5b5d803e3977cf954c", "url": "https://github.com/returntocorp/semgrep/commit/6235fed0f298cb5a58512e5b5d803e3977cf954c", "message": "Convert parse errors from SemgrepCore into SemgrepError", "committedDate": "2020-06-20T19:21:19Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUzMTI4Mg==", "url": "https://github.com/returntocorp/semgrep/pull/1090#discussion_r444531282", "bodyText": "IMO shouldnt be the job of CoreRunner to know about output handling. It should run semgrep-core and return the findings, and errors and let the caller handle how that is output.", "author": "brendongo", "createdAt": "2020-06-23T21:55:51Z", "path": "semgrep/semgrep/core_runner.py", "diffHunk": "@@ -117,9 +122,10 @@ class CoreRunner:\n         This includes properly invoking semgrep-core and parsing the output\n     \"\"\"\n \n-    def __init__(self, allow_exec: bool, jobs: int):\n+    def __init__(self, allow_exec: bool, jobs: int, output_handler: OutputHandler):\n         self._allow_exec = allow_exec\n         self._jobs = jobs\n+        self._output_handler = output_handler", "originalCommit": "6235fed0f298cb5a58512e5b5d803e3977cf954c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU0MDU4Mg==", "url": "https://github.com/returntocorp/semgrep/pull/1090#discussion_r444540582", "bodyText": "the intention is that in a followup diff, this will pave the way to have corerunner emit results as it gets them. I could also imagine some sort of generator interface, but I don't think that giving corerunner a place to report its results is a bad thing", "author": "rcoh", "createdAt": "2020-06-23T22:20:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUzMTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU2MjA4MA==", "url": "https://github.com/returntocorp/semgrep/pull/1090#discussion_r444562080", "bodyText": "I think it will be much cleaner to later modify CoreRunner to expose some streaming interface than have the CoreRunner class need to know about how its results and errors are being used. Much simpler for it to be a layer that interacts with semgrep-core and returns the results of that interaction.", "author": "brendongo", "createdAt": "2020-06-23T23:26:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUzMTI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE3MDE5Nw==", "url": "https://github.com/returntocorp/semgrep/pull/1090#discussion_r447170197", "bodyText": "I'm not totally sure that's true since there are errors and successes that may both be coming back at different rates, but I've gone that direction for now", "author": "rcoh", "createdAt": "2020-06-29T18:30:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUzMTI4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUzMjc1Nw==", "url": "https://github.com/returntocorp/semgrep/pull/1090#discussion_r444532757", "bodyText": "Why was this test removed?", "author": "brendongo", "createdAt": "2020-06-23T21:59:36Z", "path": "semgrep/tests/e2e/test_semgrep_core_parse_error.py", "diffHunk": "@@ -15,23 +15,3 @@ def test_rule_parser__failure__error_messages(run_semgrep_in_tmp, snapshot, file\n             stderr=True,\n         )\n     snapshot.assert_match(excinfo.value.output, \"error.txt\")\n-\n-\n-@pytest.mark.parametrize(\n-    \"filename\", [\"invalid_python.py\",],\n-)\n-def test_rule_parser__failure__error_messages_verbose(", "originalCommit": "6235fed0f298cb5a58512e5b5d803e3977cf954c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU0MDA5MA==", "url": "https://github.com/returntocorp/semgrep/pull/1090#discussion_r444540090", "bodyText": "per a discussion with @DrewDennison , parse errors will show up even when not in verbose mode (so now there's no reason to test that they show up in verbose mode)", "author": "rcoh", "createdAt": "2020-06-23T22:19:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUzMjc1Nw=="}], "type": "inlineReview"}, {"oid": "a93866f72feefae6c63fb7fdf327afd9f4069262", "url": "https://github.com/returntocorp/semgrep/commit/a93866f72feefae6c63fb7fdf327afd9f4069262", "message": "Refactorings after resolving merge conflicts", "committedDate": "2020-06-27T18:17:18Z", "type": "forcePushed"}, {"oid": "490fe7b10df36f0f4f78f3494793b68480d0d91c", "url": "https://github.com/returntocorp/semgrep/commit/490fe7b10df36f0f4f78f3494793b68480d0d91c", "message": "Refactorings after resolving merge conflicts", "committedDate": "2020-06-27T18:37:27Z", "type": "forcePushed"}, {"oid": "47fa98a4cea0a66f0499b596c675bef51d3b1fcb", "url": "https://github.com/returntocorp/semgrep/commit/47fa98a4cea0a66f0499b596c675bef51d3b1fcb", "message": "Convert parse errors from SemgrepCore into SemgrepError", "committedDate": "2020-07-01T23:38:02Z", "type": "commit"}, {"oid": "23666b944304c12a3f1d7d5e92a87f8949a39730", "url": "https://github.com/returntocorp/semgrep/commit/23666b944304c12a3f1d7d5e92a87f8949a39730", "message": "Refactorings after resolving merge conflicts", "committedDate": "2020-07-01T23:38:02Z", "type": "commit"}, {"oid": "2ef540077ad5baa0d9a15a08da4c77964a0aa8a6", "url": "https://github.com/returntocorp/semgrep/commit/2ef540077ad5baa0d9a15a08da4c77964a0aa8a6", "message": "Refactorings after resolving merge conflicts", "committedDate": "2020-07-01T23:38:02Z", "type": "commit"}, {"oid": "da02592b55069c62ca524b36f04eea3bdcd15930", "url": "https://github.com/returntocorp/semgrep/commit/da02592b55069c62ca524b36f04eea3bdcd15930", "message": "Fix imports", "committedDate": "2020-07-01T23:38:02Z", "type": "commit"}, {"oid": "a11cecdcc6baed1a56f48a56d228c7af235cf75e", "url": "https://github.com/returntocorp/semgrep/commit/a11cecdcc6baed1a56f48a56d228c7af235cf75e", "message": "Add nosem", "committedDate": "2020-07-01T23:38:02Z", "type": "commit"}, {"oid": "a11cecdcc6baed1a56f48a56d228c7af235cf75e", "url": "https://github.com/returntocorp/semgrep/commit/a11cecdcc6baed1a56f48a56d228c7af235cf75e", "message": "Add nosem", "committedDate": "2020-07-01T23:38:02Z", "type": "forcePushed"}, {"oid": "d2cf87b0cf15f498782a93785328dd234f7381cd", "url": "https://github.com/returntocorp/semgrep/commit/d2cf87b0cf15f498782a93785328dd234f7381cd", "message": "Merge branch 'develop' into russell/unified-errors", "committedDate": "2020-07-02T01:20:15Z", "type": "commit"}]}