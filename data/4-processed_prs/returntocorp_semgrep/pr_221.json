{"pr_number": 221, "pr_title": "refactor sgrep py", "pr_createdAt": "2020-02-27T22:13:03Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/221", "timeline": [{"oid": "e7aada9fda8110ae0321fdb3091937a15df35879", "url": "https://github.com/returntocorp/semgrep/commit/e7aada9fda8110ae0321fdb3091937a15df35879", "message": "refactor sgrep.py", "committedDate": "2020-02-27T20:20:19Z", "type": "commit"}, {"oid": "668d01ab7128a136a954a07f35373c9546efd2e7", "url": "https://github.com/returntocorp/semgrep/commit/668d01ab7128a136a954a07f35373c9546efd2e7", "message": "new sgrep location", "committedDate": "2020-02-27T20:23:45Z", "type": "commit"}, {"oid": "5ed9cf206329e8cb7666625a36c57c2a8f72ded5", "url": "https://github.com/returntocorp/semgrep/commit/5ed9cf206329e8cb7666625a36c57c2a8f72ded5", "message": "black", "committedDate": "2020-02-27T22:12:31Z", "type": "commit"}, {"oid": "94de97df067a4842216bbd151b56a34c8b05a49f", "url": "https://github.com/returntocorp/semgrep/commit/94de97df067a4842216bbd151b56a34c8b05a49f", "message": "standalone docker image, but breaks tests", "committedDate": "2020-02-27T22:45:01Z", "type": "commit"}, {"oid": "0ad101c481c15b9ca756ac2009fda7359c83e094", "url": "https://github.com/returntocorp/semgrep/commit/0ad101c481c15b9ca756ac2009fda7359c83e094", "message": "tests in non-module format", "committedDate": "2020-02-27T22:57:18Z", "type": "commit"}, {"oid": "2c4beedef1e0751abc752dc8ba828bcec2c90e7c", "url": "https://github.com/returntocorp/semgrep/commit/2c4beedef1e0751abc752dc8ba828bcec2c90e7c", "message": "tests in non-module format", "committedDate": "2020-02-27T22:59:19Z", "type": "commit"}, {"oid": "309e07588691577a75903d6036bf7725246f4bb8", "url": "https://github.com/returntocorp/semgrep/commit/309e07588691577a75903d6036bf7725246f4bb8", "message": "building now", "committedDate": "2020-02-27T23:21:38Z", "type": "commit"}, {"oid": "3b7cee3a4c509ed1db8354a1449bc8f8ee31dc2d", "url": "https://github.com/returntocorp/semgrep/commit/3b7cee3a4c509ed1db8354a1449bc8f8ee31dc2d", "message": "python workflow not relevant", "committedDate": "2020-02-27T23:23:05Z", "type": "commit"}, {"oid": "f7d089533e5882b9680dcbb5ea81faeaba5af93b", "url": "https://github.com/returntocorp/semgrep/commit/f7d089533e5882b9680dcbb5ea81faeaba5af93b", "message": "no more requirements installation", "committedDate": "2020-02-27T23:26:26Z", "type": "commit"}, {"oid": "5aa77383da5c75b6b27d950fd40505dc05265bf5", "url": "https://github.com/returntocorp/semgrep/commit/5aa77383da5c75b6b27d950fd40505dc05265bf5", "message": "dependencies", "committedDate": "2020-02-28T00:11:47Z", "type": "commit"}, {"oid": "87527438d161bde6ffbd7a8253ab2bcd7eef14c0", "url": "https://github.com/returntocorp/semgrep/commit/87527438d161bde6ffbd7a8253ab2bcd7eef14c0", "message": "correct yaml", "committedDate": "2020-02-28T00:13:14Z", "type": "commit"}, {"oid": "43fc343a7b2300746cc40cefcbc3f534e21cbc8a", "url": "https://github.com/returntocorp/semgrep/commit/43fc343a7b2300746cc40cefcbc3f534e21cbc8a", "message": "remove init - not a module", "committedDate": "2020-02-28T00:39:47Z", "type": "commit"}, {"oid": "63ffb97ae30394ce7eb1d0959c5ffbc28e6fe3b2", "url": "https://github.com/returntocorp/semgrep/commit/63ffb97ae30394ce7eb1d0959c5ffbc28e6fe3b2", "message": "try build on CI", "committedDate": "2020-02-28T01:15:42Z", "type": "commit"}, {"oid": "cc6a7d93ba2ce23c35d50a6d8ed84f86f4878ab2", "url": "https://github.com/returntocorp/semgrep/commit/cc6a7d93ba2ce23c35d50a6d8ed84f86f4878ab2", "message": "try build on CI", "committedDate": "2020-02-28T01:15:54Z", "type": "commit"}, {"oid": "9c829ee3b7fee7082c614e184f82bf394eb4d358", "url": "https://github.com/returntocorp/semgrep/commit/9c829ee3b7fee7082c614e184f82bf394eb4d358", "message": "EOF fixer breaks tests, disabling", "committedDate": "2020-02-28T01:25:48Z", "type": "commit"}, {"oid": "e85e222f175f56d619ae9329a8198dae93cb4d30", "url": "https://github.com/returntocorp/semgrep/commit/e85e222f175f56d619ae9329a8198dae93cb4d30", "message": "fix sgrep-lint tests", "committedDate": "2020-02-28T01:34:10Z", "type": "commit"}, {"oid": "7efe496ae25214214b1e16da20e6f484e0967741", "url": "https://github.com/returntocorp/semgrep/commit/7efe496ae25214214b1e16da20e6f484e0967741", "message": "add pytest dep", "committedDate": "2020-02-28T01:42:13Z", "type": "commit"}, {"oid": "e00d3709b403fca6510849288bcee1ed265c3e72", "url": "https://github.com/returntocorp/semgrep/commit/e00d3709b403fca6510849288bcee1ed265c3e72", "message": "fix pre-commit", "committedDate": "2020-02-28T03:30:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5MzY1MQ==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385493651", "bodyText": "this should be a tag so Circle can cache it but I want to replace this with a GH action next week as part of the mac build so ok for now", "author": "DrewDennison", "createdAt": "2020-02-28T03:39:37Z", "path": ".circleci/config.yml", "diffHunk": "@@ -3,14 +3,13 @@ version: 2.1\n executors:\n   sgrep-build:\n     docker:\n-      - image: returntocorp/sgrep-build:2.5\n+      - image: returntocorp/sgrep-build:latest", "originalCommit": "e00d3709b403fca6510849288bcee1ed265c3e72", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5Mzc0NA==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385493744", "bodyText": "I assume you use something other than pytest so ok with deleting", "author": "DrewDennison", "createdAt": "2020-02-28T03:40:19Z", "path": ".github/workflows/python.yml", "diffHunk": "@@ -1,29 +0,0 @@\n-name: python\n-\n-on:\n-  pull_request:\n-  push:\n-    branches: [master, develop]\n-\n-jobs:\n-  build:\n-    runs-on: ubuntu-latest\n-    strategy:\n-      matrix:\n-        python-version: [3.7, 3.8]\n-    steps:\n-    - uses: actions/checkout@v2\n-    - name: Set up Python ${{ matrix.python-version }}\n-      uses: actions/setup-python@v1\n-      with:\n-        python-version: ${{ matrix.python-version }}\n-    - name: Install dependencies\n-      run: |\n-        python -m pip install --upgrade pip\n-        pip install -r requirements.txt\n-    - name: Test with pytest\n-      run: |\n-        # add to PYTHONPATH so imports work in test files\n-        export PYTHONPATH=\"${PYTHONPATH}:${pwd}\"\n-        pip install pytest\n-        pytest", "originalCommit": "e00d3709b403fca6510849288bcee1ed265c3e72", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU2MTQxOA==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385561418", "bodyText": "It's just part of make test now", "author": "ievans", "createdAt": "2020-02-28T08:21:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5Mzc0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5Mzg2OQ==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385493869", "bodyText": "why? \ud83d\ude1e", "author": "DrewDennison", "createdAt": "2020-02-28T03:40:53Z", "path": ".pre-commit-config.yaml", "diffHunk": "@@ -1,12 +1,11 @@\n-exclude: \"^tests|testlint|old|lib|demos|bin|.*\\\\.ml\"\n+exclude: \"^sgrep-lint/tests|tests|testlint|old|lib|demos|bin|.*\\\\.ml\"\n \n repos:\n   - repo: https://github.com/pre-commit/pre-commit-hooks\n     rev: v2.5.0\n     hooks:\n       - id: check-yaml\n         args: [--allow-multiple-documents]\n-      - id: end-of-file-fixer", "originalCommit": "e00d3709b403fca6510849288bcee1ed265c3e72", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTUyNzkwMg==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385527902", "bodyText": "breaks test cases", "author": "ievans", "createdAt": "2020-02-28T06:34:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5Mzg2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5Mzk0MA==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385493940", "bodyText": "I thought we believed in types \ud83d\ude22 Would you be ok if I added in the types to keep this check", "author": "DrewDennison", "createdAt": "2020-02-28T03:41:23Z", "path": ".pre-commit-config.yaml", "diffHunk": "@@ -26,17 +25,6 @@ repos:\n     hooks:\n       - id: reorder-python-imports\n \n-  - repo: https://github.com/pre-commit/mirrors-mypy\n-    rev: \"v0.761\"\n-    hooks:\n-      - id: mypy", "originalCommit": "e00d3709b403fca6510849288bcee1ed265c3e72", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTUyOTAxMQ==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385529011", "bodyText": "mypy doesn't handle the weird globals and eval nonsense", "author": "ievans", "createdAt": "2020-02-28T06:36:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5Mzk0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5Mzk5NQ==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385493995", "bodyText": "I have used this config multiple times to catch bugs", "author": "DrewDennison", "createdAt": "2020-02-28T03:41:36Z", "path": ".pre-commit-config.yaml", "diffHunk": "@@ -26,17 +25,6 @@ repos:\n     hooks:\n       - id: reorder-python-imports\n \n-  - repo: https://github.com/pre-commit/mirrors-mypy\n-    rev: \"v0.761\"\n-    hooks:\n-      - id: mypy\n-\n-  - repo: https://gitlab.com/pycqa/flake8\n-    rev: \"3.7.9\"\n-    hooks:\n-      - id: flake8\n-        args: [\"--select=E9,F63,F7,F82\"]", "originalCommit": "e00d3709b403fca6510849288bcee1ed265c3e72", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTUzMDUyNw==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r385530527", "bodyText": "is it doing anything that mypy wouldn't? we have tons of test files with intentionally unused variables", "author": "ievans", "createdAt": "2020-02-28T06:41:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ5Mzk5NQ=="}], "type": "inlineReview"}, {"oid": "187a5c5d01502f87eb96e4a44d83a26953359a98", "url": "https://github.com/returntocorp/semgrep/commit/187a5c5d01502f87eb96e4a44d83a26953359a98", "message": "docker subtleties", "committedDate": "2020-02-28T06:33:24Z", "type": "commit"}, {"oid": "d6753bb47b2c0880c27cd7db780db474da1cb8d5", "url": "https://github.com/returntocorp/semgrep/commit/d6753bb47b2c0880c27cd7db780db474da1cb8d5", "message": "precommit", "committedDate": "2020-02-28T06:35:57Z", "type": "commit"}, {"oid": "ab169c90d345c1467b8ab04be4328083f5c82835", "url": "https://github.com/returntocorp/semgrep/commit/ab169c90d345c1467b8ab04be4328083f5c82835", "message": "enable LTO", "committedDate": "2020-02-28T08:04:25Z", "type": "commit"}, {"oid": "0395a9400baef11d4ddfbe2b9d3b6e3da771a0ed", "url": "https://github.com/returntocorp/semgrep/commit/0395a9400baef11d4ddfbe2b9d3b6e3da771a0ed", "message": "make mypy shut up again", "committedDate": "2020-02-28T08:20:16Z", "type": "commit"}, {"oid": "403cdeb94df787063a14f881a06c6f224a801de7", "url": "https://github.com/returntocorp/semgrep/commit/403cdeb94df787063a14f881a06c6f224a801de7", "message": "switch to tag", "committedDate": "2020-02-28T08:20:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY5MzQyNQ==", "url": "https://github.com/returntocorp/semgrep/pull/221#discussion_r386693425", "bodyText": "\ud83d\udde1", "author": "DrewDennison", "createdAt": "2020-03-02T22:36:52Z", "path": "sgrep_lint/constants.py", "diffHunk": "@@ -0,0 +1 @@\n+RCE_RULE_FLAG = \"--dangerously-allow-arbitrary-code-execution-from-rules\"", "originalCommit": "403cdeb94df787063a14f881a06c6f224a801de7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c39f872e5ed5e96ecb6678b4969d5dea7b0ab973", "url": "https://github.com/returntocorp/semgrep/commit/c39f872e5ed5e96ecb6678b4969d5dea7b0ab973", "message": "cleanup imports, move config resolution to separate file (#222)\n\n* cleanup imports, move config resolution to separate file\r\n\r\n* config resolver tests\r\n\r\n* add more tests", "committedDate": "2020-03-02T22:40:31Z", "type": "commit"}]}