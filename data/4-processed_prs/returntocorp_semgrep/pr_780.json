{"pr_number": 780, "pr_title": "Expand argparse arguments", "pr_createdAt": "2020-05-19T02:46:16Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/780", "timeline": [{"oid": "0506b8481ada0e1a10e4e40b8cbf855af1547d11", "url": "https://github.com/returntocorp/semgrep/commit/0506b8481ada0e1a10e4e40b8cbf855af1547d11", "message": "Expand argparse arguments\n\nInstead of functions accepting an argparse object explicitly pass each needed\nargument. Reduces random dictionary like objects being passed around semgrep.\n\nThis also makes it possible to call semgrep as a python library.", "committedDate": "2020-05-19T02:46:26Z", "type": "forcePushed"}, {"oid": "2d4f260fb0b49c84e3f6aaff3ddd7c1998aa8ad8", "url": "https://github.com/returntocorp/semgrep/commit/2d4f260fb0b49c84e3f6aaff3ddd7c1998aa8ad8", "message": "Expand argparse arguments\n\nInstead of functions accepting an argparse object explicitly pass each needed\nargument. Reduces random dictionary like objects being passed around semgrep.\n\nThis also makes it possible to call semgrep as a python library.", "committedDate": "2020-05-19T05:27:06Z", "type": "forcePushed"}, {"oid": "b729ca146ca9a2b3f063ed97ec419d69d9125d92", "url": "https://github.com/returntocorp/semgrep/commit/b729ca146ca9a2b3f063ed97ec419d69d9125d92", "message": "Expand argparse arguments\n\nInstead of functions accepting an argparse object explicitly pass each needed\nargument. Reduces random dictionary like objects being passed around semgrep.\n\nThis also makes it possible to call semgrep as a python library.", "committedDate": "2020-05-19T05:41:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyMDc0Mw==", "url": "https://github.com/returntocorp/semgrep/pull/780#discussion_r427320743", "bodyText": "Is there any way we can just grab the argparse defaults here? Currently all these values are duplicated between semgrep.cli.cli and here. I always forget to update this spot when adding a new argument and am reminded to duplicate it here.", "author": "mschwager", "createdAt": "2020-05-19T13:55:12Z", "path": "semgrep/semgrep/test.py", "diffHunk": "@@ -169,35 +169,30 @@ def confusion_matrix_to_string(confusion: List[int]) -> str:\n \n \n def invoke_semgrep(\n-    verbose: bool, strict: bool, test_files: List[Path], config: Path, unsafe: bool\n+    strict: bool, test_files: List[Path], config: Path, unsafe: bool\n ) -> Any:\n     return json.loads(\n         semgrepmain(\n-            argparse.Namespace(\n-                verbose=verbose,\n-                strict=strict,\n-                dump_ast=False,\n-                no_rewrite_rule_ids=True,\n-                dangerously_allow_arbitrary_code_execution_from_rules=unsafe,\n-                config=str(config),\n-                quiet=True,\n-                precommit=False,\n-                generate_config=False,\n-                pattern=None,\n-                validate=False,\n-                json=True,\n-                sarif=False,\n-                exclude_tests=False,\n-                jobs=1,\n-                exclude=[],\n-                include=[],\n-                exclude_dir=[],\n-                include_dir=[],\n-                output=None,\n-                error=False,\n-                autofix=False,\n-                target=[str(t) for t in test_files],\n-            )\n+            target=[str(t) for t in test_files],", "originalCommit": "b729ca146ca9a2b3f063ed97ec419d69d9125d92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ2MDMxNw==", "url": "https://github.com/returntocorp/semgrep/pull/780#discussion_r427460317", "bodyText": "With this PR you actually get alerted on missing args with mypy.", "author": "brendongo", "createdAt": "2020-05-19T17:04:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyMDc0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ2OTg2MQ==", "url": "https://github.com/returntocorp/semgrep/pull/780#discussion_r427469861", "bodyText": "Probably going to switch over to using click in the near future so that should remove the duplication so fine with mypy checked duplication for now.", "author": "brendongo", "createdAt": "2020-05-19T17:20:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyMDc0Mw=="}], "type": "inlineReview"}, {"oid": "152434eed29379391e8d1c89a9ea7b6ce6a73331", "url": "https://github.com/returntocorp/semgrep/commit/152434eed29379391e8d1c89a9ea7b6ce6a73331", "message": "Expand argparse arguments\n\nInstead of functions accepting an argparse object explicitly pass each needed\nargument. Reduces random dictionary like objects being passed around semgrep.\n\nThis also makes it possible to call semgrep as a python library.", "committedDate": "2020-05-19T16:57:29Z", "type": "commit"}, {"oid": "152434eed29379391e8d1c89a9ea7b6ce6a73331", "url": "https://github.com/returntocorp/semgrep/commit/152434eed29379391e8d1c89a9ea7b6ce6a73331", "message": "Expand argparse arguments\n\nInstead of functions accepting an argparse object explicitly pass each needed\nargument. Reduces random dictionary like objects being passed around semgrep.\n\nThis also makes it possible to call semgrep as a python library.", "committedDate": "2020-05-19T16:57:29Z", "type": "forcePushed"}]}