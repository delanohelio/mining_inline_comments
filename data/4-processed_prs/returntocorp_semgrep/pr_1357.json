{"pr_number": 1357, "pr_title": "Move typed metavariables from experimental to official support", "pr_createdAt": "2020-07-24T15:02:30Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/1357", "timeline": [{"oid": "2a35151a41d88e27d27daa096db5b2920b140005", "url": "https://github.com/returntocorp/semgrep/commit/2a35151a41d88e27d27daa096db5b2920b140005", "message": "Move typed metavariables from experimental to official support", "committedDate": "2020-07-24T14:57:01Z", "type": "commit"}, {"oid": "a0101948194fbf4c6d9e4ec986b177dd666bccee", "url": "https://github.com/returntocorp/semgrep/commit/a0101948194fbf4c6d9e4ec986b177dd666bccee", "message": "Workaround Golang pattern newlines at end of file", "committedDate": "2020-07-27T13:53:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk2MjY3Nw==", "url": "https://github.com/returntocorp/semgrep/pull/1357#discussion_r460962677", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Typed metavariables only match a metavariable if it is of a specific type. For\n          \n          \n            \n            Typed metavariables only match a metavariable if it is declared as a specific type. For", "author": "nbrahms", "createdAt": "2020-07-27T15:10:20Z", "path": "docs/pattern-features.md", "diffHunk": "@@ -417,6 +418,76 @@ class Hash {\n }\n ```\n \n+### Typed Metavariables\n+\n+Typed metavariables only match a metavariable if it is of a specific type. For", "originalCommit": "a0101948194fbf4c6d9e4ec986b177dd666bccee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk2MzU0Mw==", "url": "https://github.com/returntocorp/semgrep/pull/1357#discussion_r460963543", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Go currently does not recognize the type of all variables when declared on the\n          \n          \n            \n            Semgrep for Go currently does not recognize the type of all variables when declared on the", "author": "nbrahms", "createdAt": "2020-07-27T15:11:33Z", "path": "docs/pattern-features.md", "diffHunk": "@@ -417,6 +418,76 @@ class Hash {\n }\n ```\n \n+### Typed Metavariables\n+\n+Typed metavariables only match a metavariable if it is of a specific type. For\n+example, you may want to specifically check that `==` is never used for\n+strings.\n+\n+**Java:**\n+\n+```text\n+pattern: $X == (String $Y)\n+```\n+\n+```java\n+public class Example {\n+    public int foo(String a, int b) {\n+        // Matched\n+        if (a == \"hello\") {\n+            return 1;\n+        }\n+\n+        // Not matched\n+        if (b == 2) {\n+            return -1;\n+        }\n+    }\n+}\n+```\n+\n+**Go:**\n+\n+```text\n+pattern: \"$X == ($Y : str)\"\n+```\n+\n+```go\n+func main() {\n+    var x string\n+    var y string\n+    var a int\n+    var b int\n+\n+    // Matched\n+    if x == y {\n+       x = y\n+    }\n+\n+    // Not matched\n+    if a == b {\n+       a = b\n+    }\n+}\n+```\n+\n+#### Limitations:\n+\n+Currently, since matching happens within a single file, this is only guaranteed\n+to work for local variables and arguments. Additionally, it only understands\n+types on a shallow level. For example, if you have `int[] A`, it will not\n+recognize `A[0]` as an integer. If you have a class with fields, you will not be\n+able to use typechecking on field accesses, and it will not recognize the\n+class' field as the expected type. Literal types are understood to a limited\n+extent.\n+\n+Go currently does not recognize the type of all variables when declared on the", "originalCommit": "a0101948194fbf4c6d9e4ec986b177dd666bccee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "23150025e1e3571b9772114188226417d4013b3c", "url": "https://github.com/returntocorp/semgrep/commit/23150025e1e3571b9772114188226417d4013b3c", "message": "Update docs/pattern-features.md\n\nCo-authored-by: Nathaniel Brahms <nbrahms@users.noreply.github.com>", "committedDate": "2020-07-27T15:14:19Z", "type": "commit"}, {"oid": "67e36dde56517128fe20ecff50d045e71f6cdc18", "url": "https://github.com/returntocorp/semgrep/commit/67e36dde56517128fe20ecff50d045e71f6cdc18", "message": "Update docs/pattern-features.md\n\nCo-authored-by: Nathaniel Brahms <nbrahms@users.noreply.github.com>", "committedDate": "2020-07-27T15:14:30Z", "type": "commit"}]}