{"pr_number": 1111, "pr_title": "More Bento and pre-commit cleanup", "pr_createdAt": "2020-06-23T20:51:29Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/1111", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5OTM4NA==", "url": "https://github.com/returntocorp/semgrep/pull/1111#discussion_r444499384", "bodyText": "We're not using click or flask in this project.", "author": "mschwager", "createdAt": "2020-06-23T20:51:51Z", "path": ".bento/config.yml", "diffHunk": "@@ -36,13 +36,6 @@ tools:\n     ignore:\n     - bare-except-bugbear\n     run: true\n-  r2c.click:", "originalCommit": "743c020de8282a393394b934431f8ff5d5233582", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5OTk5NA==", "url": "https://github.com/returntocorp/semgrep/pull/1111#discussion_r444499994", "bodyText": "None of these rules fire anywhere, not sure why we have all of them excluded.", "author": "mschwager", "createdAt": "2020-06-23T20:52:34Z", "path": ".pre-commit-config.yaml", "diffHunk": "@@ -47,7 +47,6 @@ repos:\n         language: docker_image\n         entry: koalaman/shellcheck:v0.7.1\n         files: \".sh\"\n-        args: [\"--exclude=SC1004,SC1008,SC1009,SC1047,SC1050,SC1062,SC1071,SC1072,SC1090,SC1091,SC1105,SC1107,SC1123,SC1124,SC1126,SC2001,SC2002,SC2003,SC2004,SC2005,SC2006,SC2007,SC2009,SC2034,SC2035,SC2039,SC2155,SC2164,SC2181,SC2186,SC2196,SC2197,SC2230\"]", "originalCommit": "743c020de8282a393394b934431f8ff5d5233582", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUzODQwNA==", "url": "https://github.com/returntocorp/semgrep/pull/1111#discussion_r444538404", "bodyText": "I think these were the rules we did not feel were up to par for bento cause of inaccuracies etc.", "author": "brendongo", "createdAt": "2020-06-23T22:14:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5OTk5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk0MjcxMA==", "url": "https://github.com/returntocorp/semgrep/pull/1111#discussion_r444942710", "bodyText": "Do we still feel that way? For this project I think it makes sense to start fresh and slowly exclude rules we don't find useful vs. blanket exclude all these. Thoughts?", "author": "mschwager", "createdAt": "2020-06-24T14:37:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQ5OTk5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUwMDUxMQ==", "url": "https://github.com/returntocorp/semgrep/pull/1111#discussion_r444500511", "bodyText": "Same here, except for DL3008 and DL3018, which I don't find very useful.", "author": "mschwager", "createdAt": "2020-06-23T20:53:07Z", "path": ".pre-commit-config.yaml", "diffHunk": "@@ -56,4 +55,4 @@ repos:\n         language: docker_image\n         files: \"Dockerfile\"\n         entry: hadolint/hadolint:v1.18.0 hadolint\n-        args: [\"--ignore\", \"DL3008\", \"--ignore\", \"DL3010\", \"--ignore\", \"DL3012\", \"--ignore\", \"DL3018\", \"--ignore\", \"DL3020\", \"--ignore\", \"DL3022\", \"--ignore\", \"DL3027\", \"--ignore\", \"DL4001\"]", "originalCommit": "743c020de8282a393394b934431f8ff5d5233582", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxNDg0Nw==", "url": "https://github.com/returntocorp/semgrep/pull/1111#discussion_r444514847", "bodyText": "The pre-commit GHA now includes caching built in \ud83d\udc4d\npre-commit/action#31", "author": "mschwager", "createdAt": "2020-06-23T21:19:18Z", "path": ".github/workflows/lint.yml", "diffHunk": "@@ -10,13 +10,7 @@ jobs:\n     steps:\n     - uses: actions/checkout@v2\n     - uses: actions/setup-python@v1\n-    - name: set PY", "originalCommit": "a56912241b5826a84f42d2bfeafd91eb6e2958d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDUxNDk1NQ==", "url": "https://github.com/returntocorp/semgrep/pull/1111#discussion_r444514955", "bodyText": "We don't have a requirements.txt file in this repository.", "author": "mschwager", "createdAt": "2020-06-23T21:19:34Z", "path": ".pre-commit-config.yaml", "diffHunk": "@@ -15,7 +15,6 @@ repos:\n       - id: check-executables-have-shebangs\n       - id: check-merge-conflict\n       - id: check-symlinks\n-      - id: requirements-txt-fixer", "originalCommit": "a56912241b5826a84f42d2bfeafd91eb6e2958d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "06822909a9da1de9b0169aba2dcbb3e712eb4336", "url": "https://github.com/returntocorp/semgrep/commit/06822909a9da1de9b0169aba2dcbb3e712eb4336", "message": "More Bento and pre-commit cleanup", "committedDate": "2020-06-24T14:23:40Z", "type": "commit"}, {"oid": "41f1f2bd792091fdb5d821ea82a5ee642e3c610c", "url": "https://github.com/returntocorp/semgrep/commit/41f1f2bd792091fdb5d821ea82a5ee642e3c610c", "message": "Use pre-commit GHA v2.0.0 which includes automatic caching", "committedDate": "2020-06-24T14:23:40Z", "type": "commit"}, {"oid": "41623f2c8fd284a5ea33a11d44ad06c7aa244f8b", "url": "https://github.com/returntocorp/semgrep/commit/41623f2c8fd284a5ea33a11d44ad06c7aa244f8b", "message": "Remove pre-commit requirements.txt checker, we have no requirements.txt", "committedDate": "2020-06-24T14:23:40Z", "type": "commit"}, {"oid": "55a117476351cc2d4b256ba5c50078d8f34271a8", "url": "https://github.com/returntocorp/semgrep/commit/55a117476351cc2d4b256ba5c50078d8f34271a8", "message": "Use relative import in tests", "committedDate": "2020-06-24T14:35:27Z", "type": "commit"}, {"oid": "55a117476351cc2d4b256ba5c50078d8f34271a8", "url": "https://github.com/returntocorp/semgrep/commit/55a117476351cc2d4b256ba5c50078d8f34271a8", "message": "Use relative import in tests", "committedDate": "2020-06-24T14:35:27Z", "type": "forcePushed"}, {"oid": "3d284f7fc18b32f7d56843952b82184d5f58741b", "url": "https://github.com/returntocorp/semgrep/commit/3d284f7fc18b32f7d56843952b82184d5f58741b", "message": "Add __init__ files so we can do relative imports", "committedDate": "2020-06-24T14:40:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk0ODEwOA==", "url": "https://github.com/returntocorp/semgrep/pull/1111#discussion_r444948108", "bodyText": "Instead of monkeypatching PYTHONPATH to do importing here and running tests we should use proper Python modules and do relative imports. Hopefully this can also be a step toward avoiding subprocess and simply calling the semgrep_main functionality we need directly \ud83d\udc4d", "author": "mschwager", "createdAt": "2020-06-24T14:44:38Z", "path": "semgrep/tests/e2e/test_rule_parser.py", "diffHunk": "@@ -2,7 +2,8 @@\n from subprocess import CalledProcessError\n \n import pytest\n-from tests.conftest import TESTS_PATH\n+\n+from ..conftest import TESTS_PATH", "originalCommit": "3d284f7fc18b32f7d56843952b82184d5f58741b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}