{"pr_number": 718, "pr_title": "Switch environment to use Pipenv", "pr_createdAt": "2020-05-08T02:48:56Z", "pr_url": "https://github.com/returntocorp/semgrep/pull/718", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIyNDkyMg==", "url": "https://github.com/returntocorp/semgrep/pull/718#discussion_r422224922", "bodyText": "We run tests on 3.6, couldn't we set that here?", "author": "underyx", "createdAt": "2020-05-08T15:58:05Z", "path": "semgrep/Pipfile", "diffHunk": "@@ -0,0 +1,16 @@\n+[[source]]\n+name = \"pypi\"\n+url = \"https://pypi.org/simple\"\n+verify_ssl = true\n+\n+[dev-packages]\n+pytest = \"*\"\n+wheel = \"*\"\n+tox = \"*\"\n+pytest-snapshot = \"*\"\n+\n+[packages]\n+semgrep = {editable = true,path = \".\"}\n+\n+[requires]\n+python_version = \"3.7\"", "originalCommit": "8f97ce08feea09bdd701234d2221e1669e3a4c25", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNzI5Mw==", "url": "https://github.com/returntocorp/semgrep/pull/718#discussion_r425317293", "bodyText": "a bunch of things (nuitka, docker images, etc.) currently rely on 3.7 so keeping it for now", "author": "rcoh", "createdAt": "2020-05-14T17:40:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIyNDkyMg=="}], "type": "inlineReview"}, {"oid": "99c1d59d2fa94e70c5bd7a6317c2471946293607", "url": "https://github.com/returntocorp/semgrep/commit/99c1d59d2fa94e70c5bd7a6317c2471946293607", "message": "Don't install into the system so that make test works", "committedDate": "2020-05-08T19:04:07Z", "type": "forcePushed"}, {"oid": "4dd7217003a7327b37687119aedc1b121163b420", "url": "https://github.com/returntocorp/semgrep/commit/4dd7217003a7327b37687119aedc1b121163b420", "message": "Switch environment to use Pipenv", "committedDate": "2020-05-14T15:22:06Z", "type": "commit"}, {"oid": "ce079d5ccddcbaf80ec73661858d7997af68f47c", "url": "https://github.com/returntocorp/semgrep/commit/ce079d5ccddcbaf80ec73661858d7997af68f47c", "message": "Install pipenv in workflow", "committedDate": "2020-05-14T15:22:06Z", "type": "commit"}, {"oid": "17c630e87c5bf239ba1dc2e0509853661b42eed0", "url": "https://github.com/returntocorp/semgrep/commit/17c630e87c5bf239ba1dc2e0509853661b42eed0", "message": "Fix build script to use pipfile deps", "committedDate": "2020-05-14T15:22:06Z", "type": "commit"}, {"oid": "15dc56140ac35aa5cb31200b8524ad8b2f3811e9", "url": "https://github.com/returntocorp/semgrep/commit/15dc56140ac35aa5cb31200b8524ad8b2f3811e9", "message": "Replace another use of requirements.txt", "committedDate": "2020-05-14T15:22:06Z", "type": "commit"}, {"oid": "0ad458722804dee7828176a93de5937fa200fb63", "url": "https://github.com/returntocorp/semgrep/commit/0ad458722804dee7828176a93de5937fa200fb63", "message": "Use importlib to load the version", "committedDate": "2020-05-14T15:24:10Z", "type": "commit"}, {"oid": "3d40f325104861e294240799ff50af3b55d58c14", "url": "https://github.com/returntocorp/semgrep/commit/3d40f325104861e294240799ff50af3b55d58c14", "message": "Add .git during docker build", "committedDate": "2020-05-14T15:24:10Z", "type": "commit"}, {"oid": "b1cf6ebe49f5a51a643a909ebdcae765c1b93d95", "url": "https://github.com/returntocorp/semgrep/commit/b1cf6ebe49f5a51a643a909ebdcae765c1b93d95", "message": "Remove uneeded setting of PYTHONPATH", "committedDate": "2020-05-14T15:24:10Z", "type": "commit"}, {"oid": "eda4bb005609abcf768177787fbe2df5c32150b2", "url": "https://github.com/returntocorp/semgrep/commit/eda4bb005609abcf768177787fbe2df5c32150b2", "message": "Don't install into the system so that make test works", "committedDate": "2020-05-14T15:24:10Z", "type": "commit"}, {"oid": "9a7dc6751fd6d6d6a9ef91172537a466374510c3", "url": "https://github.com/returntocorp/semgrep/commit/9a7dc6751fd6d6d6a9ef91172537a466374510c3", "message": "Fix qa-test target", "committedDate": "2020-05-14T15:24:10Z", "type": "commit"}, {"oid": "f95a63632ccfe834505dc80fcf28a1c3f5c54606", "url": "https://github.com/returntocorp/semgrep/commit/f95a63632ccfe834505dc80fcf28a1c3f5c54606", "message": "Produce a semgrep/version.py file instead, add homebrew support", "committedDate": "2020-05-14T16:00:56Z", "type": "commit"}, {"oid": "f95a63632ccfe834505dc80fcf28a1c3f5c54606", "url": "https://github.com/returntocorp/semgrep/commit/f95a63632ccfe834505dc80fcf28a1c3f5c54606", "message": "Produce a semgrep/version.py file instead, add homebrew support", "committedDate": "2020-05-14T16:00:56Z", "type": "forcePushed"}, {"oid": "9dbc97a673b989352a04a75cc5d7bb9ae8fa404e", "url": "https://github.com/returntocorp/semgrep/commit/9dbc97a673b989352a04a75cc5d7bb9ae8fa404e", "message": "Remove old version string. Thanks Bento!", "committedDate": "2020-05-14T16:16:35Z", "type": "commit"}, {"oid": "e6200f8af106ced6f0f54726ae20fa8e17692078", "url": "https://github.com/returntocorp/semgrep/commit/e6200f8af106ced6f0f54726ae20fa8e17692078", "message": "Remove uneeded line from Dockerfile", "committedDate": "2020-05-14T16:21:52Z", "type": "commit"}, {"oid": "19597d5bf6c7c5d6ba33114811dbc16d6eef41d4", "url": "https://github.com/returntocorp/semgrep/commit/19597d5bf6c7c5d6ba33114811dbc16d6eef41d4", "message": "Masked keys refactoring", "committedDate": "2020-05-14T17:07:09Z", "type": "commit"}, {"oid": "e4f2a9ad4d5253501150f89cbeee5b9e788b460d", "url": "https://github.com/returntocorp/semgrep/commit/e4f2a9ad4d5253501150f89cbeee5b9e788b460d", "message": "Remove unused Bento archive", "committedDate": "2020-05-14T17:40:04Z", "type": "forcePushed"}, {"oid": "ca54932ef06eef261d665d6be5144e6ae742bdbd", "url": "https://github.com/returntocorp/semgrep/commit/ca54932ef06eef261d665d6be5144e6ae742bdbd", "message": "Remove unused Bento archive", "committedDate": "2020-05-14T17:41:01Z", "type": "commit"}, {"oid": "ca54932ef06eef261d665d6be5144e6ae742bdbd", "url": "https://github.com/returntocorp/semgrep/commit/ca54932ef06eef261d665d6be5144e6ae742bdbd", "message": "Remove unused Bento archive", "committedDate": "2020-05-14T17:41:01Z", "type": "forcePushed"}, {"oid": "e78a6dfabb8945d051d37b63fa92b30fef297d64", "url": "https://github.com/returntocorp/semgrep/commit/e78a6dfabb8945d051d37b63fa92b30fef297d64", "message": "Move git attributes to the right place", "committedDate": "2020-05-14T17:46:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMyNjUyNg==", "url": "https://github.com/returntocorp/semgrep/pull/718#discussion_r425326526", "bodyText": "Is there a reason to have wheel installed separately instead of adding it to the --dev pipenv?", "author": "brendongo", "createdAt": "2020-05-14T17:53:56Z", "path": ".github/workflows/build.yml", "diffHunk": "@@ -21,7 +21,7 @@ jobs:\n       - name: Install and test semgrep-core\n         run: eval $(opam  env --root /home/opam/.opam --set-root) && cd semgrep-core && opam install -y . && make all && make test && make install\n       - name: Install and test semgrep\n-        run: eval $(opam  env --root /home/opam/.opam --set-root) && cd semgrep && export PATH=/github/home/.local/bin:$PATH && pip3 install wheel==0.34.2 && pip3 install -r requirements.txt && make test && make qa-test && make all\n+        run: eval $(opam  env --root /home/opam/.opam --set-root) && cd semgrep && export PATH=/github/home/.local/bin:$PATH && pip3 install wheel==0.34.2 pipenv && pipenv install --dev && make test && make qa-test && make all", "originalCommit": "ca54932ef06eef261d665d6be5144e6ae742bdbd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM0MDU4MQ==", "url": "https://github.com/returntocorp/semgrep/pull/718#discussion_r425340581", "bodyText": "I think no, let me try moving it.", "author": "rcoh", "createdAt": "2020-05-14T18:17:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMyNjUyNg=="}], "type": "inlineReview"}, {"oid": "e6c82f9a2602cd894e104a3da07a027be4035823", "url": "https://github.com/returntocorp/semgrep/commit/e6c82f9a2602cd894e104a3da07a027be4035823", "message": "Don't install wheel manually", "committedDate": "2020-05-14T18:22:52Z", "type": "commit"}]}