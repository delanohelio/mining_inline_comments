{"pr_number": 3135, "pr_title": "NMS-12874: Renamed RemotePoller to PerspectivePoller", "pr_createdAt": "2020-08-28T13:02:01Z", "pr_url": "https://github.com/OpenNMS/opennms/pull/3135", "timeline": [{"oid": "ca5e642854d94211641c85627e3fb99e3a329a71", "url": "https://github.com/OpenNMS/opennms/commit/ca5e642854d94211641c85627e3fb99e3a329a71", "message": "NMS-12874: Renamed RemotePoller to PerspectivePoller", "committedDate": "2020-08-29T08:42:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkxODE5OQ==", "url": "https://github.com/OpenNMS/opennms/pull/3135#discussion_r479918199", "bodyText": "Typo", "author": "christianpape", "createdAt": "2020-08-31T06:23:47Z", "path": "features/perspectivepoller/src/test/java/org/opennms/netmgt/perspectivepoller/PerspectivePollerdIT.java", "diffHunk": "@@ -98,7 +98,7 @@\n         \"classpath:/META-INF/opennms/applicationContext-commonConfigs.xml\",\n         \"classpath:/META-INF/opennms/applicationContext-dao.xml\",\n         \"classpath:/META-INF/opennms/applicationContext-databasePopulator.xml\",\n-        \"classpath:/META-INF/opennms/applicationContext-testRemotePollerDaemon.xml\",\n+        \"classpath:/META-INF/opennms/applicationContext-testPerpsectivePollerDaemon.xml\",", "originalCommit": "ca5e642854d94211641c85627e3fb99e3a329a71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTkxODY4Mw==", "url": "https://github.com/OpenNMS/opennms/pull/3135#discussion_r479918683", "bodyText": "upper case P please, findPerspectivePolledService", "author": "christianpape", "createdAt": "2020-08-31T06:25:10Z", "path": "features/perspectivepoller/src/test/java/org/opennms/netmgt/perspectivepoller/PerspectivePollerdIT.java", "diffHunk": "@@ -263,66 +263,66 @@ public void reportResultTest() throws Exception {\n         final InetAddress ipAddress = this.node1icmp.getIpAddress();\n         final String location = this.node1icmp.getIpInterface().getNode().getLocation().getLocationName();\n \n-        final RemotePolledService remotePolledService = findRemotePolledService(this.node1icmp, \"RDU\");\n+        final PerspectivePolledService perspectivePolledService = findperspectivePolledService(this.node1icmp, \"RDU\");\n         assertThat(this.databasePopulator.getOutageDao().currentOutageForServiceFromPerspective(this.node1icmp, this.databasePopulator.getLocRDU()), is(nullValue()));\n \n         this.eventIpcManager.getEventAnticipator().reset();\n-        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.REMOTE_NODE_REGAINED_SERVICE_UEI, \"RemotePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n-        this.remotePollerd.reportResult(remotePolledService, PollStatus.available());\n+        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.PERSPECTIVE_NODE_REGAINED_SERVICE_UEI, \"PerspectivePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n+        this.perspectivePollerd.reportResult(perspectivePolledService, PollStatus.available());\n         assertThat(this.databasePopulator.getOutageDao().currentOutageForServiceFromPerspective(this.node1icmp, this.databasePopulator.getLocRDU()), is(nullValue()));\n         this.eventIpcManager.getEventAnticipator().verifyAnticipated();\n \n         this.eventIpcManager.getEventAnticipator().reset();\n-        this.remotePollerd.reportResult(remotePolledService, PollStatus.available());\n+        this.perspectivePollerd.reportResult(perspectivePolledService, PollStatus.available());\n         assertThat(this.databasePopulator.getOutageDao().currentOutageForServiceFromPerspective(this.node1icmp, this.databasePopulator.getLocRDU()), is(nullValue()));\n         this.eventIpcManager.getEventAnticipator().verifyAnticipated();\n \n         this.eventIpcManager.getEventAnticipator().reset();\n-        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.REMOTE_NODE_LOST_SERVICE_UEI, \"RemotePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n-        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.OUTAGE_CREATED_EVENT_UEI, \"RemotePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n-        this.remotePollerd.reportResult(remotePolledService, PollStatus.unavailable(\"old reason\"));\n+        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.PERSPECTIVE_NODE_LOST_SERVICE_UEI, \"PerspectivePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n+        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.OUTAGE_CREATED_EVENT_UEI, \"PerspectivePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n+        this.perspectivePollerd.reportResult(perspectivePolledService, PollStatus.unavailable(\"old reason\"));\n         assertThat(this.databasePopulator.getOutageDao().currentOutageForServiceFromPerspective(this.node1icmp, this.databasePopulator.getLocRDU()), is(notNullValue()));\n         this.eventIpcManager.getEventAnticipator().verifyAnticipated();\n \n         this.eventIpcManager.getEventAnticipator().reset();\n-        this.remotePollerd.reportResult(remotePolledService, PollStatus.unavailable(\"old reason\"));\n+        this.perspectivePollerd.reportResult(perspectivePolledService, PollStatus.unavailable(\"old reason\"));\n         assertThat(this.databasePopulator.getOutageDao().currentOutageForServiceFromPerspective(this.node1icmp, this.databasePopulator.getLocRDU()), is(notNullValue()));\n         this.eventIpcManager.getEventAnticipator().verifyAnticipated();\n \n         this.eventIpcManager.getEventAnticipator().reset();\n-        this.remotePollerd.reportResult(remotePolledService, PollStatus.unavailable(\"new reason\"));\n+        this.perspectivePollerd.reportResult(perspectivePolledService, PollStatus.unavailable(\"new reason\"));\n         assertThat(this.databasePopulator.getOutageDao().currentOutageForServiceFromPerspective(this.node1icmp, this.databasePopulator.getLocRDU()), is(notNullValue()));\n         this.eventIpcManager.getEventAnticipator().verifyAnticipated();\n \n         this.eventIpcManager.getEventAnticipator().reset();\n-        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.REMOTE_NODE_REGAINED_SERVICE_UEI, \"RemotePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n-        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.OUTAGE_RESOLVED_EVENT_UEI, \"RemotePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n-        this.remotePollerd.reportResult(remotePolledService, PollStatus.available());\n+        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.PERSPECTIVE_NODE_REGAINED_SERVICE_UEI, \"PerspectivePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n+        this.eventIpcManager.getEventAnticipator().anticipateEvent(new EventBuilder(EventConstants.OUTAGE_RESOLVED_EVENT_UEI, \"PerspectivePollerd\").setNodeid(nodeId).setInterface(ipAddress).setService(serviceMatch.service.getName()).setParam(\"location\", location).getEvent());\n+        this.perspectivePollerd.reportResult(perspectivePolledService, PollStatus.available());\n         assertThat(this.databasePopulator.getOutageDao().currentOutageForServiceFromPerspective(this.node1icmp, this.databasePopulator.getLocRDU()), is(nullValue()));\n         this.eventIpcManager.getEventAnticipator().verifyAnticipated();\n     }\n \n     @Test\n     public void testDaemonReload() throws Exception {\n         // Initial config, ICMP and SNMP bound to single package\n-        Assert.assertEquals(8, this.remotePollerd.scheduler.getJobKeys(GroupMatcher.anyGroup()).size());\n-        assertThat(findRemotePolledService(this.node1icmp, \"RDU\").getPkg().getName(), is(\"foo1\"));\n-        assertThat(findRemotePolledService(this.node1icmp, \"Fulda\").getPkg().getName(), is(\"foo1\"));\n-        assertThat(findRemotePolledService(this.node2icmp, \"RDU\").getPkg().getName(), is(\"foo1\"));\n-        assertThat(findRemotePolledService(this.node2icmp, \"Fulda\").getPkg().getName(), is(\"foo1\"));\n-        assertThat(findRemotePolledService(this.node1snmp, \"RDU\").getPkg().getName(), is(\"foo1\"));\n-        assertThat(findRemotePolledService(this.node2snmp, \"RDU\").getPkg().getName(), is(\"foo1\"));\n+        Assert.assertEquals(8, this.perspectivePollerd.scheduler.getJobKeys(GroupMatcher.anyGroup()).size());\n+        assertThat(findperspectivePolledService(this.node1icmp, \"RDU\").getPkg().getName(), is(\"foo1\"));", "originalCommit": "ca5e642854d94211641c85627e3fb99e3a329a71", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c01ddbac560ddfb1d76cfd82188c53b42c165e22", "url": "https://github.com/OpenNMS/opennms/commit/c01ddbac560ddfb1d76cfd82188c53b42c165e22", "message": "NMS-12874: Renamed RemotePoller to PerspectivePoller", "committedDate": "2020-09-01T15:27:09Z", "type": "commit"}, {"oid": "0e119dad1135d969be71b33d8ba7c530b1d40a79", "url": "https://github.com/OpenNMS/opennms/commit/0e119dad1135d969be71b33d8ba7c530b1d40a79", "message": "Merge remote-tracking branch 'origin/features/rpwm' into jira/NMS-12874", "committedDate": "2020-09-01T20:17:51Z", "type": "commit"}, {"oid": "f41e70cbb9fd86a98a9edb176b519307339fb241", "url": "https://github.com/OpenNMS/opennms/commit/f41e70cbb9fd86a98a9edb176b519307339fb241", "message": "NSM-12874: Fix tests", "committedDate": "2020-09-01T20:18:22Z", "type": "commit"}, {"oid": "f41e70cbb9fd86a98a9edb176b519307339fb241", "url": "https://github.com/OpenNMS/opennms/commit/f41e70cbb9fd86a98a9edb176b519307339fb241", "message": "NSM-12874: Fix tests", "committedDate": "2020-09-01T20:18:22Z", "type": "forcePushed"}, {"oid": "b7bd4a3cabc21cbd274897bd98264082215b16b4", "url": "https://github.com/OpenNMS/opennms/commit/b7bd4a3cabc21cbd274897bd98264082215b16b4", "message": "fixup! NSM-12874: Fix tests", "committedDate": "2020-09-02T08:17:40Z", "type": "commit"}, {"oid": "45c985d98aeff5a6725748d5308934be9f35a762", "url": "https://github.com/OpenNMS/opennms/commit/45c985d98aeff5a6725748d5308934be9f35a762", "message": "fixup! NSM-12874: Fix tests", "committedDate": "2020-09-02T11:25:12Z", "type": "commit"}]}