{"pr_number": 2878, "pr_title": "NMS-12445: Integrate Graph Service with the opennms-integration-api (OIA)", "pr_createdAt": "2020-02-04T13:19:57Z", "pr_url": "https://github.com/OpenNMS/opennms/pull/2878", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg3ODIzOQ==", "url": "https://github.com/OpenNMS/opennms/pull/2878#discussion_r377878239", "bodyText": "Should we use a thread-safe map here?", "author": "j-white", "createdAt": "2020-02-11T20:25:19Z", "path": "features/graph/service/src/main/java/org/opennms/netmgt/graph/service/DefaultGraphService.java", "diffHunk": "@@ -42,10 +45,25 @@\n import org.opennms.netmgt.graph.api.info.GraphInfo;\n import org.opennms.netmgt.graph.api.service.GraphContainerProvider;\n import org.opennms.netmgt.graph.api.service.GraphService;\n+import org.opennms.netmgt.graph.api.service.osgi.GraphContainerProviderRegistration;\n+import org.osgi.framework.BundleContext;\n+import org.osgi.framework.ServiceRegistration;\n+\n+import com.google.common.collect.Maps;\n \n public class DefaultGraphService implements GraphService {\n \n     private List<GraphContainerProvider> graphContainerProviders = new CopyOnWriteArrayList<>();\n+    private final BundleContext bundleContext;\n+    private final Map<GraphContainerProvider, ServiceRegistration<GraphContainerProviderRegistration>> serviceRegistrationMap = Maps.newHashMap();", "originalCommit": "74be0c3f53882d75831936e5b706bc533cf27137", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE1MTY3OQ==", "url": "https://github.com/OpenNMS/opennms/pull/2878#discussion_r378151679", "bodyText": "Yes, we should use a thread-safe map here.", "author": "mvrueden", "createdAt": "2020-02-12T10:07:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg3ODIzOQ=="}], "type": "inlineReview"}, {"oid": "da6437c5941b71ca67425f71ecfb8226f26307fb", "url": "https://github.com/OpenNMS/opennms/commit/da6437c5941b71ca67425f71ecfb8226f26307fb", "message": "NMS-12445: Integrate OIA GraphProvider as well as allow exposing it to the TopologyUI", "committedDate": "2020-02-13T09:50:09Z", "type": "commit"}, {"oid": "d41799d536e1e12ff36f0b69769eb6b26f50c07c", "url": "https://github.com/OpenNMS/opennms/commit/d41799d536e1e12ff36f0b69769eb6b26f50c07c", "message": "NMS-12445: Restructuring and add support for OIA-GraphContainerProvider", "committedDate": "2020-02-13T09:50:10Z", "type": "commit"}, {"oid": "c125eb97fde779cdec616c11e38b530b5e50e53d", "url": "https://github.com/OpenNMS/opennms/commit/c125eb97fde779cdec616c11e38b530b5e50e53d", "message": "NMS-12445: Various enhancements to fully integrate with the Graph Service API", "committedDate": "2020-02-13T09:50:10Z", "type": "commit"}, {"oid": "3d54adaff5bd283fd99ee294a13d3ca9399b84c6", "url": "https://github.com/OpenNMS/opennms/commit/3d54adaff5bd283fd99ee294a13d3ca9399b84c6", "message": "NMS-12445: Expose status for new Graph API", "committedDate": "2020-02-13T09:50:10Z", "type": "commit"}, {"oid": "1b059db9c1fbef97b6ce93dacace041f60b1f010", "url": "https://github.com/OpenNMS/opennms/commit/1b059db9c1fbef97b6ce93dacace041f60b1f010", "message": "NMS-12445: Integrate Status calculation for Graph/Topology API", "committedDate": "2020-02-13T09:50:10Z", "type": "commit"}, {"oid": "9e0b8eedb00ddaed223a0bb4ea77083250a24961", "url": "https://github.com/OpenNMS/opennms/commit/9e0b8eedb00ddaed223a0bb4ea77083250a24961", "message": "NMS-12445: Some cleanup", "committedDate": "2020-02-13T09:50:10Z", "type": "commit"}, {"oid": "721ed1fa2877dac74c5621318f99cbf16a609eda", "url": "https://github.com/OpenNMS/opennms/commit/721ed1fa2877dac74c5621318f99cbf16a609eda", "message": "NMS-12445: Prevent NPE if status was null", "committedDate": "2020-02-13T09:50:10Z", "type": "commit"}, {"oid": "daf81642d5caaf0746aa1f77f7dfaaf3fec14181", "url": "https://github.com/OpenNMS/opennms/commit/daf81642d5caaf0746aa1f77f7dfaaf3fec14181", "message": "NMS-12445: Consider GraphCacheStrategy in OIA", "committedDate": "2020-02-13T09:50:10Z", "type": "commit"}, {"oid": "013f728eb22c9d37f3a8814eb22a01dffc9bfb0d", "url": "https://github.com/OpenNMS/opennms/commit/013f728eb22c9d37f3a8814eb22a01dffc9bfb0d", "message": "NMS-12445: Apply rename from oia upstream to the implemetnation", "committedDate": "2020-02-13T09:50:10Z", "type": "commit"}, {"oid": "d03bdc79e403485a5913b4084e6c44e4fc95b133", "url": "https://github.com/OpenNMS/opennms/commit/d03bdc79e403485a5913b4084e6c44e4fc95b133", "message": "NMS-12445: Fix NPE", "committedDate": "2020-02-13T09:50:11Z", "type": "commit"}, {"oid": "e3cdc4ce37308f974e37ae623c8f58e4ac7ca574", "url": "https://github.com/OpenNMS/opennms/commit/e3cdc4ce37308f974e37ae623c8f58e4ac7ca574", "message": "NMS-12445: Implement getOppositeVertices(VertexRef)", "committedDate": "2020-02-13T09:50:11Z", "type": "commit"}, {"oid": "d92f33a6968c08c2077076b2befc7bb809c79391", "url": "https://github.com/OpenNMS/opennms/commit/d92f33a6968c08c2077076b2befc7bb809c79391", "message": "NMS-12445: Use thread-safe map", "committedDate": "2020-02-13T09:50:11Z", "type": "commit"}, {"oid": "4fc507c4efcbe9788a599c648419de9c7b171af0", "url": "https://github.com/OpenNMS/opennms/commit/4fc507c4efcbe9788a599c648419de9c7b171af0", "message": "NMS-12445: Register MetaTopologyProvider last to avoid wird states (no icons/no status, etc)", "committedDate": "2020-02-13T09:50:11Z", "type": "commit"}, {"oid": "770b605ce6208491d3db6175943fab7c02e85bae", "url": "https://github.com/OpenNMS/opennms/commit/770b605ce6208491d3db6175943fab7c02e85bae", "message": "NMS-12445: Expose TopologyCache as its own interface", "committedDate": "2020-02-13T09:50:11Z", "type": "commit"}, {"oid": "ec2ca90cfa48041630bc72488cdf192acc198410", "url": "https://github.com/OpenNMS/opennms/commit/ec2ca90cfa48041630bc72488cdf192acc198410", "message": "NMS-12445: Invalidate topology cache when MetaTopologyProvider is unregistered", "committedDate": "2020-02-13T09:50:11Z", "type": "commit"}, {"oid": "ec2ca90cfa48041630bc72488cdf192acc198410", "url": "https://github.com/OpenNMS/opennms/commit/ec2ca90cfa48041630bc72488cdf192acc198410", "message": "NMS-12445: Invalidate topology cache when MetaTopologyProvider is unregistered", "committedDate": "2020-02-13T09:50:11Z", "type": "forcePushed"}, {"oid": "9ce3cc74a4de2154a63d02ea74f86dadd240319d", "url": "https://github.com/OpenNMS/opennms/commit/9ce3cc74a4de2154a63d02ea74f86dadd240319d", "message": "NMS-12445: Make OpenNMS compile again", "committedDate": "2020-02-13T14:55:24Z", "type": "commit"}]}