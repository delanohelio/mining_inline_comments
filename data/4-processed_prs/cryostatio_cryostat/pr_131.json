{"pr_number": 131, "pr_title": "Use frontend plugin to build web-client", "pr_createdAt": "2020-03-05T19:53:19Z", "pr_url": "https://github.com/cryostatio/cryostat/pull/131", "timeline": [{"oid": "360f57c142a41c69a976e622ec28cbc359fa687c", "url": "https://github.com/cryostatio/cryostat/commit/360f57c142a41c69a976e622ec28cbc359fa687c", "message": "Use frontend plugin to build web-client\n\nUse specific \"frontend\" plugin for building -web submodule, rather than\ninvoking \"exec\" plugin directly", "committedDate": "2020-03-06T14:39:40Z", "type": "forcePushed"}, {"oid": "54f1b71e1e16b95189201a09ff29fe7f092fa0bd", "url": "https://github.com/cryostatio/cryostat/commit/54f1b71e1e16b95189201a09ff29fe7f092fa0bd", "message": "Ignore .factorypath", "committedDate": "2020-03-09T19:53:30Z", "type": "forcePushed"}, {"oid": "fa31b1607843ff6ef1d035a844ea4a426aa41cc7", "url": "https://github.com/cryostatio/cryostat/commit/fa31b1607843ff6ef1d035a844ea4a426aa41cc7", "message": "Use frontend plugin to build web-client\n\nUse specific \"frontend\" plugin for building -web submodule, rather than\ninvoking \"exec\" plugin directly", "committedDate": "2020-03-09T20:06:20Z", "type": "commit"}, {"oid": "d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "url": "https://github.com/cryostatio/cryostat/commit/d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "message": "Ignore .factorypath", "committedDate": "2020-03-09T20:06:20Z", "type": "commit"}, {"oid": "d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "url": "https://github.com/cryostatio/cryostat/commit/d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "message": "Ignore .factorypath", "committedDate": "2020-03-09T20:06:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAxNzg5MA==", "url": "https://github.com/cryostatio/cryostat/pull/131#discussion_r390017890", "bodyText": "Should we use ${containerjfr.imageVersion} instead of latest here? Also I had this task hang for me, but couldn't reproduce it. Not sure why.\nINFO] --- jib-maven-plugin:2.1.0:dockerBuild (build-oci-image) @ container-jfr ---\n[WARNING] Setting image creation time to current time; your image may not be reproducible.\n[INFO] \n[INFO] Containerizing application to Docker daemon as quay.io/rh-jmc-team/container-jfr, quay.io/rh-jmc-team/container-jfr:0.16.0...\n[WARNING] Base image 'gcr.io/distroless/java:11' does not use a specific image digest - build may not be reproducible\n[INFO] Using base image with digest: sha256:c94feda039172152495b5cd60a350a03162fce4f8986b560ea555de4d276ce19\n[INFO] \n[INFO] Container entrypoint set to [java, -XX:+CrashOnOutOfMemoryError, -Dcom.sun.management.jmxremote.port=9091, -Dcom.sun.management.jmxremote.ssl=false, -Dcom.sun.management.jmxremote.authenticate=false, -cp, /app/resources:/app/classes:/app/libs/*, com.redhat.rhjmc.containerjfr.ContainerJfr]\n[INFO] \n[INFO] Built image to Docker daemon as quay.io/rh-jmc-team/container-jfr, quay.io/rh-jmc-team/container-jfr:0.16.0\n[INFO] Executing tasks:\n[INFO] [==============================] 100.0% complete\n[INFO] \n[INFO] \n[INFO] --- exec-maven-plugin:1.6.0:exec (start-container) @ container-jfr ---\n^C", "author": "ebaron", "createdAt": "2020-03-09T23:34:52Z", "path": "pom.xml", "diffHunk": "@@ -163,6 +166,65 @@\n         </annotationProcessorPaths>\n       </configuration>\n     </plugin>\n+    <plugin>\n+      <groupId>org.codehaus.mojo</groupId>\n+      <artifactId>exec-maven-plugin</artifactId>\n+      <version>${org.codehaus.mojo.exec.plugin.version}</version>\n+      <configuration>\n+        <mainClass>com.redhat.rhjmc.containerjfr.ContainerJfr</mainClass>\n+        <additionalClasspathElements>\n+          <additionalClasspathElement>${project.build.directory}/assets/app/resources</additionalClasspathElement>\n+        </additionalClasspathElements>\n+      </configuration>\n+      <executions>\n+        <execution>\n+          <id>start-container</id>\n+          <phase>pre-integration-test</phase>\n+          <goals>\n+            <goal>exec</goal>\n+          </goals>\n+          <configuration>\n+            <executable>${imageBuilder}</executable>\n+            <arguments>\n+              <argument>run</argument>\n+              <argument>--hostname=container-jfr</argument>\n+              <argument>--name=container-jfr-itest</argument>\n+              <argument>--publish</argument>\n+              <argument>9091:9091</argument>\n+              <argument>--publish</argument>\n+              <argument>${containerjfr.itest.webPort}:${containerjfr.itest.webPort}</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_LOG_LEVEL=ALL</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_WEB_HOST=0.0.0.0</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_LISTEN_HOST=0.0.0.0</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_WEB_PORT=${containerjfr.itest.webPort}</argument>\n+              <argument>--env</argument>\n+              <argument>CONTAINER_JFR_EXT_WEB_PORT=${containerjfr.itest.webPort}</argument>\n+              <argument>--detach</argument>\n+              <argument>--rm</argument>\n+              <argument>${containerjfr.imageStream}:latest</argument>", "originalCommit": "d859a83787f1d73ea2c30897f5ab0fa691d60bcb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM3NzAwNA==", "url": "https://github.com/cryostatio/cryostat/pull/131#discussion_r390377004", "bodyText": "Sure, I'll push a commit momentarily to use imageVersion rather than latest.\nI've seen the same hang on start-container. I just filed an issue for it (#134). I think it's a podman thing, but I'm going to test that hypothesis by running the suite a few times using docker instead and see what happens.", "author": "andrewazores", "createdAt": "2020-03-10T14:56:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDAxNzg5MA=="}], "type": "inlineReview"}, {"oid": "6dd26ed21d79230d0e37003ae3b84f6afe5250c3", "url": "https://github.com/cryostatio/cryostat/commit/6dd26ed21d79230d0e37003ae3b84f6afe5250c3", "message": "Integration tests use tagged image version, not latest", "committedDate": "2020-03-10T14:57:54Z", "type": "commit"}]}