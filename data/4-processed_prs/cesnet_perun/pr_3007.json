{"pr_number": 3007, "pr_title": "Tools for list Sponsors and SponsoredMembers", "pr_createdAt": "2020-11-26T12:24:58Z", "pr_url": "https://github.com/CESNET/perun/pull/3007", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA3MTc0Nw==", "url": "https://github.com/CESNET/perun/pull/3007#discussion_r531071747", "bodyText": "I am afraid this method is deprecated. Please, use usersManager/getSponsorsForMember instead.", "author": "stavamichal", "createdAt": "2020-11-26T14:38:36Z", "path": "perun-cli/Perun/MembersAgent.pm", "diffHunk": "@@ -128,4 +128,14 @@ sub unsetSponsorshipForMember\n  return Perun::Common::callManagerMethod('unsetSponsorshipForMember', 'RichMember', @_);\n }\n \n+sub getSponsors\n+{\n+ return Perun::Common::callManagerMethod('getSponsors', '[]RichUser', @_);", "originalCommit": "3ada71dd3c7c64d98bd9f7255a68ec50560c9bf2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA3MjkzMA==", "url": "https://github.com/CESNET/perun/pull/3007#discussion_r531072930", "bodyText": "This line is probably not working correctly for parameter '-v'. It shoudl be:\n\"validityTo|v=s\" > $exp,", "author": "stavamichal", "createdAt": "2020-11-26T14:40:26Z", "path": "perun-cli/setSponsorshipForMember", "diffHunk": "@@ -13,26 +13,30 @@ sub help {\n \tAvailable options:\n \t--memberId       | -m member id\n \t--sponsorId      | -s sponsor (user) id\n+\t--validityTo     | -v expiration of sponsorship (YYYY-MM-DD) optional\n \t--batch          | -b batch\n \t--help           | -h prints this help\n \t};\n }\n \n-my ($memberId, $sponsorId, $batch);\n+my ($memberId, $sponsorId, $exp, $batch);\n GetOptions (\"help|h\"  => sub {\n \t\tprint help();\n \t\texit 0;\n \t}, \"batch|b\"        => \\$batch,\n-\t\"memberId|m=i\"        => \\$memberId, \n-\t\"sponsorId|s=i\"         => \\$sponsorId ) || die help();\n+\t\"validityTo=s\"      => \\$exp,", "originalCommit": "3ada71dd3c7c64d98bd9f7255a68ec50560c9bf2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA3NDQ5OA==", "url": "https://github.com/CESNET/perun/pull/3007#discussion_r531074498", "bodyText": "This message is not correct for this script.", "author": "stavamichal", "createdAt": "2020-11-26T14:43:01Z", "path": "perun-cli/listOfMembersSponsoredByUser", "diffHunk": "@@ -0,0 +1,53 @@\n+#!/usr/bin/perl\n+\n+use strict;\n+use warnings;\n+use Getopt::Long qw(:config no_ignore_case);\n+use Text::ASCIITable;\n+use Perun::Agent;\n+use Perun::Common qw(printMessage tableToPrint getSortingFunction);\n+\n+sub help {\n+\treturn qq{\n+\tSets sponsorship for member. Member ID and sponsor ID is required.", "originalCommit": "3ada71dd3c7c64d98bd9f7255a68ec50560c9bf2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA4Mzc0MA==", "url": "https://github.com/CESNET/perun/pull/3007#discussion_r531083740", "bodyText": "Name of the script should be probably little different. I would prefer:\n\nlistOfMembersSponsoredByUserInVo", "author": "stavamichal", "createdAt": "2020-11-26T14:57:38Z", "path": "perun-cli/listOfMembersSponsoredByUser", "diffHunk": "@@ -0,0 +1,53 @@\n+#!/usr/bin/perl\n+\n+use strict;\n+use warnings;\n+use Getopt::Long qw(:config no_ignore_case);\n+use Text::ASCIITable;\n+use Perun::Agent;\n+use Perun::Common qw(printMessage tableToPrint getSortingFunction);\n+", "originalCommit": "3ada71dd3c7c64d98bd9f7255a68ec50560c9bf2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA4NDkwNw==", "url": "https://github.com/CESNET/perun/pull/3007#discussion_r531084907", "bodyText": "This message is not correct for this script.", "author": "stavamichal", "createdAt": "2020-11-26T14:59:35Z", "path": "perun-cli/listOfSponsorsForMember", "diffHunk": "@@ -0,0 +1,50 @@\n+#!/usr/bin/perl\n+\n+use strict;\n+use warnings;\n+use Getopt::Long qw(:config no_ignore_case);\n+use Text::ASCIITable;\n+use Perun::Agent;\n+use Perun::Common qw(printMessage tableToPrint getSortingFunction);\n+\n+sub help {\n+\treturn qq{\n+\tSets sponsorship for member. Member ID and sponsor ID is required.", "originalCommit": "3ada71dd3c7c64d98bd9f7255a68ec50560c9bf2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9e0bec012d16140e586a73b6b822757d51cbc4b9", "url": "https://github.com/CESNET/perun/commit/9e0bec012d16140e586a73b6b822757d51cbc4b9", "message": "Tools for list Sponsors ana SponsoredMembers\n\nlistOfMembersSponsoredByUser lists members (memberId,Name) sponsored by entered user\nlistOfSponsorsForMember lists sponsor (userId,Name) for entered member\nsetSponsorshipForMember updated to be able to set expiration of\nsponsorship (validityTo option)\n\nUpdated texts in listOfMembersSponsoredByUserInVo and\nlistOfSponsorsForMember.\nCerrected option -v in setSponsorshipForMember\nMethod getSponsorForMember from UsersManager has been used instead\nmethod getSponsors from MembersManager", "committedDate": "2020-11-27T13:13:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzE1OTA3Mg==", "url": "https://github.com/CESNET/perun/pull/3007#discussion_r533159072", "bodyText": "Would be great to have more \"get\" method for listing sponsors (at least firstName and lastName).", "author": "stavamichal", "createdAt": "2020-12-01T08:40:43Z", "path": "perun-cli/Perun/beans/Sponsor.pm", "diffHunk": "@@ -0,0 +1,45 @@\n+package Perun::beans::Sponsor;\n+\n+use strict;\n+use warnings;\n+\n+use Perun::Common;\n+\n+sub new\n+{\n+\tbless({});\n+}\n+\n+sub fromHash\n+{\n+        return Perun::Common::fromHash(@_);\n+}\n+\n+sub TO_JSON\n+{\n+\tmy $self = shift;\n+\n+\treturn { user => $self->{_user} };\n+}\n+\n+sub getUserId {\n+        return shift->{_user}->{id};\n+}\n+\n+sub getValidytyTo {\n+\treturn shift->{_validytyTo};\n+}\t\n+", "originalCommit": "9e0bec012d16140e586a73b6b822757d51cbc4b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9aafb45306adc31668b80eec823b76f18d65864d", "url": "https://github.com/CESNET/perun/commit/9aafb45306adc31668b80eec823b76f18d65864d", "message": "Tools for list Sponsors ana SponsoredMembers\n\nlistOfMembersSponsoredByUser lists members (memberId,Name) sponsored by entered user\nlistOfSponsorsForMember lists sponsor (userId,Name) for entered member\nsetSponsorshipForMember updated to be able to set expiration of\nsponsorship (validityTo option)\n\nUpdated texts in listOfMembersSponsoredByUserInVo and\nlistOfSponsorsForMember.\nCorrected option -v in setSponsorshipForMember\nMethod getSponsorForMember from UsersManager has been used instead\nmethod getSponsors from MembersManager\n\nremoved listOfMembersSponsoredByUser\nUpdated bean Sponsor, getUserFirstName and getUserLastName added\nupdated listOfSponsorsForMember, newly created getUserFirstName and\ngetUserLastNam used for listing", "committedDate": "2020-12-02T11:31:30Z", "type": "commit"}, {"oid": "9aafb45306adc31668b80eec823b76f18d65864d", "url": "https://github.com/CESNET/perun/commit/9aafb45306adc31668b80eec823b76f18d65864d", "message": "Tools for list Sponsors ana SponsoredMembers\n\nlistOfMembersSponsoredByUser lists members (memberId,Name) sponsored by entered user\nlistOfSponsorsForMember lists sponsor (userId,Name) for entered member\nsetSponsorshipForMember updated to be able to set expiration of\nsponsorship (validityTo option)\n\nUpdated texts in listOfMembersSponsoredByUserInVo and\nlistOfSponsorsForMember.\nCorrected option -v in setSponsorshipForMember\nMethod getSponsorForMember from UsersManager has been used instead\nmethod getSponsors from MembersManager\n\nremoved listOfMembersSponsoredByUser\nUpdated bean Sponsor, getUserFirstName and getUserLastName added\nupdated listOfSponsorsForMember, newly created getUserFirstName and\ngetUserLastNam used for listing", "committedDate": "2020-12-02T11:31:30Z", "type": "forcePushed"}]}