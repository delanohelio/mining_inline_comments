{"pr_number": 2745, "pr_title": "OpenApi AuthzResolver", "pr_createdAt": "2020-06-12T14:22:02Z", "pr_url": "https://github.com/CESNET/perun/pull/2745", "timeline": [{"oid": "19778b1c3270faa9e0ca33d78b90822c08a4552e", "url": "https://github.com/CESNET/perun/commit/19778b1c3270faa9e0ca33d78b90822c08a4552e", "message": "AuthzResolver added missing methods", "committedDate": "2020-06-12T14:19:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc0NzQ2Mg==", "url": "https://github.com/CESNET/perun/pull/2745#discussion_r440747462", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              /json/aithzResolver/getPrincipalRoleNames:\n          \n          \n            \n              /json/authzResolver/getPrincipalRoleNames:", "author": "Vojtech-Sassmann", "createdAt": "2020-06-16T10:25:39Z", "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -2144,6 +2144,20 @@ paths:\n   #                                               #\n   #################################################\n \n+  /json/aithzResolver/getPrincipalRoleNames:", "originalCommit": "19778b1c3270faa9e0ca33d78b90822c08a4552e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc0ODk3Nw==", "url": "https://github.com/CESNET/perun/pull/2745#discussion_r440748977", "bodyText": "Although it is now written in the documentation, this method takes a group param of type int.", "author": "Vojtech-Sassmann", "createdAt": "2020-06-16T10:28:37Z", "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -2384,6 +2400,127 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n+  /json/authzResolver/getGroupRoleNames:", "originalCommit": "19778b1c3270faa9e0ca33d78b90822c08a4552e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc2MzI2Ng==", "url": "https://github.com/CESNET/perun/pull/2745#discussion_r440763266", "bodyText": "I looked into documentation and as you can see on the printscreen, there are no parameters in this method.", "author": "xpavlic", "createdAt": "2020-06-16T10:55:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc0ODk3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc2NTQ1Mg==", "url": "https://github.com/CESNET/perun/pull/2745#discussion_r440765452", "bodyText": "The documentation is wrong, look at the implementation: https://github.com/CESNET/perun/blob/master/perun-rpc/src/main/java/cz/metacentrum/perun/rpc/methods/AuthzResolverMethod.java#L77", "author": "martin-kuba", "createdAt": "2020-06-16T11:00:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc0ODk3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc1MDYxMw==", "url": "https://github.com/CESNET/perun/pull/2745#discussion_r440750613", "bodyText": "This might sound a bit dumb but this method actually takes a groupId param. #/components/parameters/groupId refers to a param with name group.", "author": "Vojtech-Sassmann", "createdAt": "2020-06-16T10:31:38Z", "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -2384,6 +2400,127 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n+  /json/authzResolver/getGroupRoleNames:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: getGroupRoleNames\n+      summary: |\n+        Returns list of group's role names. Perun system uses role names in the upper case format. However,\n+        for now, they are converted to the lower case format because of the compatibility with external systems.\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfStringsResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/authzResolver/getGroupRoles:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: getGroupRoles\n+      summary: Returns all roles as an AuthzRoles object for a given group.\n+      parameters:\n+        - $ref: '#/components/parameters/groupId'", "originalCommit": "19778b1c3270faa9e0ca33d78b90822c08a4552e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc1MTgzNw==", "url": "https://github.com/CESNET/perun/pull/2745#discussion_r440751837", "bodyText": "You can use here the optionalGroupId defined parameter.", "author": "Vojtech-Sassmann", "createdAt": "2020-06-16T10:34:06Z", "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -2384,6 +2400,127 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n+  /json/authzResolver/getGroupRoleNames:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: getGroupRoleNames\n+      summary: |\n+        Returns list of group's role names. Perun system uses role names in the upper case format. However,\n+        for now, they are converted to the lower case format because of the compatibility with external systems.\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfStringsResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/authzResolver/getGroupRoles:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: getGroupRoles\n+      summary: Returns all roles as an AuthzRoles object for a given group.\n+      parameters:\n+        - $ref: '#/components/parameters/groupId'\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/AuthzRolesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/authzResolver/isVoAdmin:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: isVoAdmin\n+      summary: Returns 1 if User has VO manager role (VOADMIN) or for specific VO defined by id\n+      parameters:\n+        - name: vo\n+          description: \"id of Vo\"\n+          schema:\n+            type: integer\n+          in: query\n+          required: false\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/IntegerResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/authzResolver/isGroupAdmin:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: isGroupAdmin\n+      summary: Returns 1 if User has Group manager role (GROUPADMIN) or for specific Group defined by id\n+      parameters:", "originalCommit": "19778b1c3270faa9e0ca33d78b90822c08a4552e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc1MjA5OA==", "url": "https://github.com/CESNET/perun/pull/2745#discussion_r440752098", "bodyText": "Same here, you can use the optionalFacilityId", "author": "Vojtech-Sassmann", "createdAt": "2020-06-16T10:34:39Z", "path": "perun-openapi/openapi.yml", "diffHunk": "@@ -2384,6 +2400,127 @@ paths:\n         default:\n           $ref: '#/components/responses/ExceptionResponse'\n \n+  /json/authzResolver/getGroupRoleNames:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: getGroupRoleNames\n+      summary: |\n+        Returns list of group's role names. Perun system uses role names in the upper case format. However,\n+        for now, they are converted to the lower case format because of the compatibility with external systems.\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/ListOfStringsResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/authzResolver/getGroupRoles:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: getGroupRoles\n+      summary: Returns all roles as an AuthzRoles object for a given group.\n+      parameters:\n+        - $ref: '#/components/parameters/groupId'\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/AuthzRolesResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/authzResolver/isVoAdmin:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: isVoAdmin\n+      summary: Returns 1 if User has VO manager role (VOADMIN) or for specific VO defined by id\n+      parameters:\n+        - name: vo\n+          description: \"id of Vo\"\n+          schema:\n+            type: integer\n+          in: query\n+          required: false\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/IntegerResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/authzResolver/isGroupAdmin:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: isGroupAdmin\n+      summary: Returns 1 if User has Group manager role (GROUPADMIN) or for specific Group defined by id\n+      parameters:\n+        - name: group\n+          description: \"id of Group\"\n+          schema:\n+            type: integer\n+          in: query\n+          required: false\n+      responses:\n+        '200':\n+          $ref: '#/components/responses/IntegerResponse'\n+        default:\n+          $ref: '#/components/responses/ExceptionResponse'\n+\n+  /urlinjsonout/authzResolver/isFacilityAdmin:\n+    get:\n+      tags:\n+        - AuthzResolver\n+      operationId: isFacilityAdmin\n+      summary: Returns 1 if User has Facility manager role (FACILITYADMIN) or for specific Facility defined by id\n+      parameters:", "originalCommit": "19778b1c3270faa9e0ca33d78b90822c08a4552e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1798ace422db0ca6522bfe66c28663219aa2d8b8", "url": "https://github.com/CESNET/perun/commit/1798ace422db0ca6522bfe66c28663219aa2d8b8", "message": "suggestion fixes", "committedDate": "2020-06-16T10:58:50Z", "type": "commit"}, {"oid": "0e062b113ae9c196adbcd95644fe4ca3e088c9bb", "url": "https://github.com/CESNET/perun/commit/0e062b113ae9c196adbcd95644fe4ca3e088c9bb", "message": "Merge branch 'master' into AuthzResolverOpenApi", "committedDate": "2020-06-16T10:59:39Z", "type": "commit"}, {"oid": "27d5772dea79e75516f7f7141140a365a39cf3f6", "url": "https://github.com/CESNET/perun/commit/27d5772dea79e75516f7f7141140a365a39cf3f6", "message": "added groupId parameter into getGroupRoleNames", "committedDate": "2020-06-16T11:24:11Z", "type": "commit"}]}