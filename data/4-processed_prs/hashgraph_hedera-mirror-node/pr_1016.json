{"pr_number": 1016, "pr_title": "Improved check-state-proof CLI support and documentation", "pr_createdAt": "2020-09-03T19:17:50Z", "pr_url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016", "timeline": [{"oid": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/a8802fd2a5af85b83a7a3de97b7ddd2635291302", "message": "Improved check-state-proof CLI support and documentation\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-09-03T19:01:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMjAxMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483212013", "bodyText": "yaml", "author": "steven-sheehy", "createdAt": "2020-09-03T19:40:13Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows\n+1. Navigate to the `hedera-mirror-rest/state-proof-demo` directory\n+2. Npm install the tool -  `npm install -g .`\n+\n+To verify correct installation simply run `check-state-proof` or `npm start` with no parameters.\n+The following help section will be displayed to showcase usage\n+```.env\n+Usage: -t <transactionId> -e <env>\n+\n+Options:\n+  --help               Show help                                       [boolean]\n+  --version            Show version number                             [boolean]\n+  -t, --transactionId  Your Hedera Network Transaction Id e.g.\n+                       0.0.94139-1570800748-313194300        [string] [required]\n+  -s, --sample         Use sample data                                 [boolean]\n+  -e, --env            Your environment e.g. test / main     [string] [required]\n+\n+Missing required arguments: t, e\n+```\n+\n+``\n+\n+### Configure REST API\n+To enable State Proof logic the REST API configurations must updated to allow for communication with cloud buckets to pull down the necessary files (address book, signatures files and record file).\n+The process involves setting the properties under `hedera.mirror.rest.stateproof` as documented at [REST API Config](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/configuration.md#rest-api)\n+\n+An example configuration is provided below\n+\n+```.env", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NTI1Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483365253", "bodyText": "Updated", "author": "Nana-EC", "createdAt": "2020-09-04T03:30:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMjAxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMjgxNw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483212817", "bodyText": "Missing new host, file options and still has sample", "author": "steven-sheehy", "createdAt": "2020-09-03T19:41:56Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows\n+1. Navigate to the `hedera-mirror-rest/state-proof-demo` directory\n+2. Npm install the tool -  `npm install -g .`\n+\n+To verify correct installation simply run `check-state-proof` or `npm start` with no parameters.\n+The following help section will be displayed to showcase usage\n+```.env\n+Usage: -t <transactionId> -e <env>\n+\n+Options:\n+  --help               Show help                                       [boolean]\n+  --version            Show version number                             [boolean]\n+  -t, --transactionId  Your Hedera Network Transaction Id e.g.", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NTI2NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483365264", "bodyText": "Updated", "author": "Nana-EC", "createdAt": "2020-09-04T03:30:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMjgxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMzE1Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483213153", "bodyText": "Remove error, instead recommend they explicitly invoke --help and show its output", "author": "steven-sheehy", "createdAt": "2020-09-03T19:42:37Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows\n+1. Navigate to the `hedera-mirror-rest/state-proof-demo` directory\n+2. Npm install the tool -  `npm install -g .`\n+\n+To verify correct installation simply run `check-state-proof` or `npm start` with no parameters.\n+The following help section will be displayed to showcase usage\n+```.env\n+Usage: -t <transactionId> -e <env>\n+\n+Options:\n+  --help               Show help                                       [boolean]\n+  --version            Show version number                             [boolean]\n+  -t, --transactionId  Your Hedera Network Transaction Id e.g.\n+                       0.0.94139-1570800748-313194300        [string] [required]\n+  -s, --sample         Use sample data                                 [boolean]\n+  -e, --env            Your environment e.g. test / main     [string] [required]\n+\n+Missing required arguments: t, e", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NTg0Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483365843", "bodyText": "Updated", "author": "Nana-EC", "createdAt": "2020-09-04T03:33:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMzE1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMzk5OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483213998", "bodyText": "Should support file as stdin input so you can curl | check-state-proof", "author": "steven-sheehy", "createdAt": "2020-09-03T19:44:23Z", "path": "hedera-mirror-rest/state-proof-demo/startUp.js", "diffHunk": "@@ -42,36 +43,59 @@ const options = yargs\n     type: 'string',\n     demandOption: true,\n   })\n-  .option('s', {alias: 'sample', describe: 'Use sample data', type: 'boolean', demandOption: false})\n-  .option('e', {alias: 'env', describe: 'Your environment e.g. test / main', type: 'string', demandOption: true}).argv;\n+  .option('f', {", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwOTU0MA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483409540", "bodyText": "Seems weird to support stdin input when the -f option is supported.\nEspecially for the case of curl when the tool itself makes an http call by design.\nI get that it's once less step but node script design makes it not very pretty (trying now) for a script to support both console arguments and stdin input.\nMainly because the result stdin input isn't available immediately and is chunked through so you have to build it over time and ensure everything came though.\nThis process isn't synchronous so I'd have to add await logic and some refactoring which is unnecessary for the non pipe scenario.\nWill take another look but I'm suggesting punting for this PR.", "author": "Nana-EC", "createdAt": "2020-09-04T06:17:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMzk5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY2MTg2Nw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483661867", "bodyText": "Found an easier way to do this but it's essentially serves as a replacement for -f and still requires async handling of the time it takes to populate the buffer in the case of doing an actual curl.\nThought I'd have it in the next commit but I'll hold off", "author": "Nana-EC", "createdAt": "2020-09-04T14:47:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxMzk5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNDU0Nw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483214547", "bodyText": "Would be better to add local as an explicit option and throw an error for default", "author": "steven-sheehy", "createdAt": "2020-09-03T19:45:22Z", "path": "hedera-mirror-rest/state-proof-demo/startUp.js", "diffHunk": "@@ -42,36 +43,59 @@ const options = yargs\n     type: 'string',\n     demandOption: true,\n   })\n-  .option('s', {alias: 'sample', describe: 'Use sample data', type: 'boolean', demandOption: false})\n-  .option('e', {alias: 'env', describe: 'Your environment e.g. test / main', type: 'string', demandOption: true}).argv;\n+  .option('f', {\n+    alias: 'file',\n+    describe: 'Absolute file path containing State Proof REST API response json',\n+    type: 'string',\n+    demandOption: false,\n+  })\n+  .option('h', {\n+    alias: 'host',\n+    describe: 'REST API host. Default is testnet',\n+    type: 'string',\n+    demandOption: false,\n+  })\n+  .option('e', {\n+    alias: 'env',\n+    describe: 'Your environment e.g. previewnet/testnet/mainnet',\n+    type: 'string',\n+    demandOption: false,\n+  }).argv;\n \n const startUpScreen = () => {\n-  const greeting = chalk.bold(`Hedera Transaction State Proof CLI!`);\n+  const greeting = chalk.bold(`Hedera Transaction State Proof Checker CLI!`);\n \n   const msgBox = boxen(greeting, boxenOptions);\n   console.log(msgBox);\n \n   let host;\n-  switch (options.env) {\n-    case 'testnet':\n-      host = 'https://testnet.mirrornode.hedera.com';\n-      break;\n-    case 'mainnet':\n-      host = 'https://mainnet.mirrornode.hedera.com';\n-      break;\n-    default:\n-      host = 'localhost:5551';\n+  // if host parameter was not passed then set host according to env.\n+  if (_.isUndefined(options.host)) {\n+    switch (options.env) {\n+      case 'previewnet':\n+        host = 'https://previewnet.mirrornode.hedera.com';\n+        break;\n+      case 'mainnet':\n+        host = 'https://mainnet.mirrornode.hedera.com';\n+        break;\n+      case 'testnet':\n+        host = 'https://testnet.mirrornode.hedera.com';\n+        break;\n+      default:\n+        host = 'http://localhost:5551';", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NTg3Nw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483365877", "bodyText": "Added local and throwing for default", "author": "Nana-EC", "createdAt": "2020-09-04T03:33:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNDU0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwNjY0Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483406646", "bodyText": "Moved stuff around since with default throwing error when a file is provided -e doesn't need to be set and it throws.\nRearranged by skipping host and env logic when a file is provided", "author": "Nana-EC", "createdAt": "2020-09-04T06:08:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNDU0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNTQ1Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483215452", "bodyText": "We should change the folder name to match check-state-proof", "author": "steven-sheehy", "createdAt": "2020-09-03T19:47:12Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NTIzOA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483365238", "bodyText": "Updated", "author": "Nana-EC", "createdAt": "2020-09-04T03:30:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNTQ1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNjkxOA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483216918", "bodyText": "Extra ticks", "author": "steven-sheehy", "createdAt": "2020-09-03T19:50:11Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows\n+1. Navigate to the `hedera-mirror-rest/state-proof-demo` directory\n+2. Npm install the tool -  `npm install -g .`\n+\n+To verify correct installation simply run `check-state-proof` or `npm start` with no parameters.\n+The following help section will be displayed to showcase usage\n+```.env\n+Usage: -t <transactionId> -e <env>\n+\n+Options:\n+  --help               Show help                                       [boolean]\n+  --version            Show version number                             [boolean]\n+  -t, --transactionId  Your Hedera Network Transaction Id e.g.\n+                       0.0.94139-1570800748-313194300        [string] [required]\n+  -s, --sample         Use sample data                                 [boolean]\n+  -e, --env            Your environment e.g. test / main     [string] [required]\n+\n+Missing required arguments: t, e\n+```\n+\n+``", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2OTMwNw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483369307", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-09-04T03:49:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNjkxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNzk4Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483217983", "bodyText": "Not necessarily. Most users will probably depend upon our managed mirror node to invoke against. That's why requirements should be npm and a mirror node with State Proof Alpha REST API enabled. Then we can mention if they'd like to run the REST API themselves, see how to enable it in docs/configuration.md. Any steps for how to run mirror node should be moved to the config doc. This doc should stay focused on running the cli against an existing API.", "author": "steven-sheehy", "createdAt": "2020-09-03T19:52:24Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2OTM4OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483369388", "bodyText": "Moved configuration to configuration doc and added a link", "author": "Nana-EC", "createdAt": "2020-09-04T03:49:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxNzk4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxOTUxMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483219513", "bodyText": "This duplicates the help output above. Can probably remove that output and move it here to consolidate.", "author": "steven-sheehy", "createdAt": "2020-09-03T19:55:42Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows\n+1. Navigate to the `hedera-mirror-rest/state-proof-demo` directory\n+2. Npm install the tool -  `npm install -g .`\n+\n+To verify correct installation simply run `check-state-proof` or `npm start` with no parameters.\n+The following help section will be displayed to showcase usage\n+```.env\n+Usage: -t <transactionId> -e <env>\n+\n+Options:\n+  --help               Show help                                       [boolean]\n+  --version            Show version number                             [boolean]\n+  -t, --transactionId  Your Hedera Network Transaction Id e.g.\n+                       0.0.94139-1570800748-313194300        [string] [required]\n+  -s, --sample         Use sample data                                 [boolean]\n+  -e, --env            Your environment e.g. test / main     [string] [required]\n+\n+Missing required arguments: t, e\n+```\n+\n+``\n+\n+### Configure REST API\n+To enable State Proof logic the REST API configurations must updated to allow for communication with cloud buckets to pull down the necessary files (address book, signatures files and record file).\n+The process involves setting the properties under `hedera.mirror.rest.stateproof` as documented at [REST API Config](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/configuration.md#rest-api)\n+\n+An example configuration is provided below\n+\n+```.env\n+hedera:\n+  mirror:\n+    rest:\n+      stateproof:\n+        enabled: true\n+        streams:\n+          network: 'TESTNET'\n+          cloudProvider: 'GCP'\n+          region: 'us-east-1'\n+          accessKey: <accessKey>\n+          secretKey: <secretKey>\n+          bucketName: 'hedera-stable-testnet-streams-2020-08-27'\n+```\n+\n+## Run Check-State-Proof CLI\n+From command line run\n+\n+`check-state-proof -t <transactionId> -h <host> -e <environment> -f <filePath>`\n+\n+- t - The transactionId to be verified", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM3MTkyMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483371923", "bodyText": "Consolidated", "author": "Nana-EC", "createdAt": "2020-09-04T03:59:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIxOTUxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIyMDczOA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483220738", "bodyText": "Sample case terminology is still weird. I think we should simplify to 3 types of run modes: Environment, Custom Endpoint and Input File, in that order. For environment, can just mention the 3 values instead of showing separate commands for each environment.", "author": "steven-sheehy", "createdAt": "2020-09-03T19:58:26Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows\n+1. Navigate to the `hedera-mirror-rest/state-proof-demo` directory\n+2. Npm install the tool -  `npm install -g .`\n+\n+To verify correct installation simply run `check-state-proof` or `npm start` with no parameters.\n+The following help section will be displayed to showcase usage\n+```.env\n+Usage: -t <transactionId> -e <env>\n+\n+Options:\n+  --help               Show help                                       [boolean]\n+  --version            Show version number                             [boolean]\n+  -t, --transactionId  Your Hedera Network Transaction Id e.g.\n+                       0.0.94139-1570800748-313194300        [string] [required]\n+  -s, --sample         Use sample data                                 [boolean]\n+  -e, --env            Your environment e.g. test / main     [string] [required]\n+\n+Missing required arguments: t, e\n+```\n+\n+``\n+\n+### Configure REST API\n+To enable State Proof logic the REST API configurations must updated to allow for communication with cloud buckets to pull down the necessary files (address book, signatures files and record file).\n+The process involves setting the properties under `hedera.mirror.rest.stateproof` as documented at [REST API Config](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/configuration.md#rest-api)\n+\n+An example configuration is provided below\n+\n+```.env\n+hedera:\n+  mirror:\n+    rest:\n+      stateproof:\n+        enabled: true\n+        streams:\n+          network: 'TESTNET'\n+          cloudProvider: 'GCP'\n+          region: 'us-east-1'\n+          accessKey: <accessKey>\n+          secretKey: <secretKey>\n+          bucketName: 'hedera-stable-testnet-streams-2020-08-27'\n+```\n+\n+## Run Check-State-Proof CLI\n+From command line run\n+\n+`check-state-proof -t <transactionId> -h <host> -e <environment> -f <filePath>`\n+\n+- t - The transactionId to be verified\n+- e - Hedera network environment to point at e.g. previewnet | mainnet | testnet\n+- h - The host of the REST API endpoint e.g. https://testnet.mirrornode.hedera.com (also the default). This overrides the value of the environment.\n+\n+\n+> **_Note_** `npm start --` may be used in favor of `check-state-proof` if you don't install the tool globally\n+e.g. `npm start -- -t <transactionId> -h <host> -e <previewnet|mainnet|testnet> -f <filePath>`\n+\n+\n+### Sample Case", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM3Mzk2Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483373962", "bodyText": "Good suggestion. Taken", "author": "Nana-EC", "createdAt": "2020-09-04T04:07:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIyMDczOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIyMTI4OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483221288", "bodyText": "Think this makes more sense back at the top. Can simplify header to Algorithm or Logic or Architecture", "author": "steven-sheehy", "createdAt": "2020-09-03T19:59:36Z", "path": "hedera-mirror-rest/state-proof-demo/README.md", "diffHunk": "@@ -0,0 +1,115 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Requirements\n+To run the CLI you must first install and then configure the REST API as explained below\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows\n+1. Navigate to the `hedera-mirror-rest/state-proof-demo` directory\n+2. Npm install the tool -  `npm install -g .`\n+\n+To verify correct installation simply run `check-state-proof` or `npm start` with no parameters.\n+The following help section will be displayed to showcase usage\n+```.env\n+Usage: -t <transactionId> -e <env>\n+\n+Options:\n+  --help               Show help                                       [boolean]\n+  --version            Show version number                             [boolean]\n+  -t, --transactionId  Your Hedera Network Transaction Id e.g.\n+                       0.0.94139-1570800748-313194300        [string] [required]\n+  -s, --sample         Use sample data                                 [boolean]\n+  -e, --env            Your environment e.g. test / main     [string] [required]\n+\n+Missing required arguments: t, e\n+```\n+\n+``\n+\n+### Configure REST API\n+To enable State Proof logic the REST API configurations must updated to allow for communication with cloud buckets to pull down the necessary files (address book, signatures files and record file).\n+The process involves setting the properties under `hedera.mirror.rest.stateproof` as documented at [REST API Config](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/configuration.md#rest-api)\n+\n+An example configuration is provided below\n+\n+```.env\n+hedera:\n+  mirror:\n+    rest:\n+      stateproof:\n+        enabled: true\n+        streams:\n+          network: 'TESTNET'\n+          cloudProvider: 'GCP'\n+          region: 'us-east-1'\n+          accessKey: <accessKey>\n+          secretKey: <secretKey>\n+          bucketName: 'hedera-stable-testnet-streams-2020-08-27'\n+```\n+\n+## Run Check-State-Proof CLI\n+From command line run\n+\n+`check-state-proof -t <transactionId> -h <host> -e <environment> -f <filePath>`\n+\n+- t - The transactionId to be verified\n+- e - Hedera network environment to point at e.g. previewnet | mainnet | testnet\n+- h - The host of the REST API endpoint e.g. https://testnet.mirrornode.hedera.com (also the default). This overrides the value of the environment.\n+\n+\n+> **_Note_** `npm start --` may be used in favor of `check-state-proof` if you don't install the tool globally\n+e.g. `npm start -- -t <transactionId> -h <host> -e <previewnet|mainnet|testnet> -f <filePath>`\n+\n+\n+### Sample Case\n+To verify the sample case run the following command\n+\n+`check-state-proof -t 0.0.94139-1570800748-313194300 -f <absoluteDirPath>/stateProofSample.json`\n+\n+> **_Note_** The -f option requires an absolute filePath to be provided\n+\n+\n+### Testnet Case\n+\n+`check-state-proof -t <transactionId> -e testnet`\n+\n+### Mainnet Case\n+\n+`check-state-proof -t <transactionId> -e mainnet`\n+\n+### Custom Endpoint Case\n+\n+`check-state-proof -t <transactionId> -h <http(s)Endpoint>`\n+\n+## State Proof Logic", "originalCommit": "a8802fd2a5af85b83a7a3de97b7ddd2635291302", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM3NDQ5Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483374492", "bodyText": "Moved back up , to before requirements", "author": "Nana-EC", "createdAt": "2020-09-04T04:10:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzIyMTI4OA=="}], "type": "inlineReview"}, {"oid": "d9f6c2f05260fbcf2b0eabed057d7e11f36944af", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/d9f6c2f05260fbcf2b0eabed057d7e11f36944af", "message": "Updated docs and addressed feedback\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-09-04T06:05:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY1MDcwNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483650704", "bodyText": "nit: This would be better to add to the help output directly", "author": "steven-sheehy", "createdAt": "2020-09-04T14:28:42Z", "path": "hedera-mirror-rest/check-state-proof/README.md", "diffHunk": "@@ -0,0 +1,100 @@\n+# Hedera Mirror State Proof Alpha\n+\n+The Mirror Node State Proof Alpha provides the ability to cryptographically prove a transaction is valid on Hedera Network.\n+It's the interim solution until [full state proof](https://www.hedera.com/blog/state-proofs-on-hedera) is implemented.\n+\n+Refer to the [State Proof Alpha Design](https://github.com/hashgraph/hedera-mirror-node/blob/master/docs/design/stateproofalpha.md) for more architectural details.\n+\n+A node based CLI tool `check-state-proof` is provided here to showcase the steps necessary to independently check the validity of a transaction.\n+\n+## Logic\n+The CLI takes the following steps to prove legitimacy of provided transaction ID\n+\n+1. Obtains user input of transactionId and other params\n+\n+2. Makes a REST API call to the mirror node to retrieve stateproof supporting files - addressBook(s), signature files and a record file.\n+\n+3. Store files locally and verifies at least 1 addressBook, 2 signatures, 1 rcd file were retrieved.\n+\n+4. Parses AddressBook(s) pulling out and creating a map of nodeIds to public keys\n+\n+5. Parses signature file buffer pulling out signature and hash from each file\n+\n+6. Parses record file pulling out file hash and a map of transactionsIds\n+\n+7. Verified the record file contains the requested transactionId\n+\n+8. Verifies the public keys of each node were used to sign the hashes noted in the signature files and produced the provided signatures.\n+\n+9. Verifies there is a hash from the signatures files that is matched by at least 1/3 of the nodes.\n+\n+10. Verified the record file hash matches the hash that reached 1/3 consensus from nodes.\n+\n+11. Returns true if all  verifications pass\n+\n+## Requirements\n+To run the CLI you must\n+1. Install the node application\n+2. Point to a mirror node with the State Proof Alpha REST API enabled.\n+\n+If you would like to configure your mirror node to support State Proof Alpha you can follow the configuration steps [Enable State Proof Alpha](../../docs/configuration.md#enable-state-proof-alpha)\n+\n+### Install CLI\n+The node based CLI tool `check-state-proof` can be installed as follows\n+1. Ensure you've installed [NodeJS](https://nodejs.org/en/about/)\n+2. Navigate to the `hedera-mirror-rest/state-proof-demo` directory\n+3. Npm install the tool -  `npm install -g .`\n+\n+To verify correct installation simply run `check-state-proof --help` or `npm start -- --help` to show usage instructions.\n+\n+## Run Check-State-Proof CLI\n+From command line run\n+\n+`check-state-proof -t <transactionId> -h <host> -e <environment> -f <filePath>`\n+\n+Usage options include\n+```.env\n+  --help               Show help                                       [boolean]\n+  --version            Show version number                             [boolean]\n+  -t, --transactionId  Your Hedera Network Transaction Id e.g.\n+                       0.0.94139-1570800748-313194300        [string] [required]\n+  -f, --file           Absolute file path containing State Proof REST API\n+                       response json                                    [string]\n+  -h, --host           REST API host. Default is testnet                [string]\n+  -e, --env            Your environment e.g. local|mainnet|previewnet|testnet\n+                                                                        [string]\n+```\n+\n+> **_Note 1:_** The host value overrides the value of the environment.", "originalCommit": "d9f6c2f05260fbcf2b0eabed057d7e11f36944af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY2MTgwNQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1016#discussion_r483661805", "bodyText": "I'll add it there and also leave it here since people don't always read --help when the command works the fist time.", "author": "Nana-EC", "createdAt": "2020-09-04T14:47:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzY1MDcwNA=="}], "type": "inlineReview"}, {"oid": "29203df129b41d8e10b599c4897082329e29061f", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/29203df129b41d8e10b599c4897082329e29061f", "message": "Added note in startup for host override\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-09-04T15:11:48Z", "type": "commit"}]}