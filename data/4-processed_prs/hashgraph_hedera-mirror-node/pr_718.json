{"pr_number": 718, "pr_title": "Add Helm tests", "pr_createdAt": "2020-04-28T18:38:22Z", "pr_url": "https://github.com/hashgraph/hedera-mirror-node/pull/718", "timeline": [{"oid": "944cbaa8840bbccb89c68e71740399b4ebdd2f95", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/944cbaa8840bbccb89c68e71740399b4ebdd2f95", "message": "Add helm tests\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>", "committedDate": "2020-04-28T18:46:35Z", "type": "forcePushed"}, {"oid": "2c3788f7130a14ce941870e96f3f760ed642a72f", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/2c3788f7130a14ce941870e96f3f760ed642a72f", "message": "Add helm tests\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>", "committedDate": "2020-04-28T19:04:37Z", "type": "commit"}, {"oid": "2c3788f7130a14ce941870e96f3f760ed642a72f", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/2c3788f7130a14ce941870e96f3f760ed642a72f", "message": "Add helm tests\n\nSigned-off-by: Steven Sheehy <steven.sheehy@hedera.com>", "committedDate": "2020-04-28T19:04:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg2NzQ0OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/718#discussion_r416867449", "bodyText": "might be good to add one for topic messages also", "author": "Nana-EC", "createdAt": "2020-04-28T19:28:31Z", "path": "charts/hedera-mirror-rest/templates/tests/configmap.yaml", "diffHunk": "@@ -0,0 +1,38 @@\n+apiVersion: v1\n+kind: ConfigMap\n+metadata:\n+  annotations:\n+    helm.sh/hook: test-success\n+    helm.sh/hook-delete-policy: hook-succeeded\n+  labels:\n+    {{- include \"hedera-mirror-rest.labels\" . | nindent 4 }}\n+  name: {{ include \"hedera-mirror-rest.fullname\" . }}-test\n+  namespace: {{ include \"hedera-mirror-rest.namespace\" . }}\n+data:\n+  test.sh: |-\n+    #!/usr/bin/env bash\n+\n+    URI='http://{{ include \"hedera-mirror-rest.fullname\" . }}:{{ .Values.service.port }}'\n+\n+    # Infinite loop is okay since helm test itself has a timeout\n+    function setup() {\n+      apk add -qu curl jq\n+      until (curl -s \"${URI}/api/v1/transactions?limit=1\"); do\n+        sleep 1\n+      done\n+    }\n+\n+    @test \"Has accounts\" {\n+      curl -s \"${URI}/api/v1/accounts?limit=1\" | jq -e '.accounts | length >= 1'\n+      [[ \"$?\" -eq 0 ]]\n+    }\n+\n+    @test \"Has balances\" {\n+      curl -s \"${URI}/api/v1/balances?limit=1\" | jq -e '.balances | length >= 1'\n+      [[ \"$?\" -eq 0 ]]\n+    }\n+\n+    @test \"Has transactions\" {", "originalCommit": "2c3788f7130a14ce941870e96f3f760ed642a72f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg3MDg2OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/718#discussion_r416870868", "bodyText": "Nope, see PR description", "author": "steven-sheehy", "createdAt": "2020-04-28T19:34:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjg2NzQ0OQ=="}], "type": "inlineReview"}]}