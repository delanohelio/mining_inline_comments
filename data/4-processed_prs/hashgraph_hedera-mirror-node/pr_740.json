{"pr_number": 740, "pr_title": "Added deployer folder structure with schema and docker file", "pr_createdAt": "2020-05-06T16:33:24Z", "pr_url": "https://github.com/hashgraph/hedera-mirror-node/pull/740", "timeline": [{"oid": "19c65ee41a5d1333e0cfb755c5824ad75be968a9", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/19c65ee41a5d1333e0cfb755c5824ad75be968a9", "message": "Moved Dockerfile up a level\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-07T15:41:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyMzE2NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421723164", "bodyText": "nit: hedera-mirror-node.tar.gz", "author": "apeksharma", "createdAt": "2020-05-07T18:54:56Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart, swap values file and archive chart\n+ADD chart /tmp/chart\n+RUN mv /tmp/chart/values-gcp-marketplace.yaml /tmp/chart/values.yaml\n+RUN cd /tmp && tar -czvf /tmp/hedera-mirror.tar.gz chart", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgwNjUxMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421806513", "bodyText": "True, left over from before name discussion. Will change", "author": "Nana-EC", "createdAt": "2020-05-07T21:30:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyMzE2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyMzMxOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421723319", "bodyText": "remove unused code here and below", "author": "apeksharma", "createdAt": "2020-05-07T18:55:11Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart, swap values file and archive chart\n+ADD chart /tmp/chart\n+RUN mv /tmp/chart/values-gcp-marketplace.yaml /tmp/chart/values.yaml\n+RUN cd /tmp && tar -czvf /tmp/hedera-mirror.tar.gz chart\n+\n+##ADD apptest/deployer/hedera-mirror /tmp/test/chart", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgwNzE1NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421807154", "bodyText": "Left in here as next step would be that and the file paths are pretty standard.\nWas just gonna leave it to make whoever does that tasks job easier, but I can I remove it as lots of repos show the same logic as examples", "author": "Nana-EC", "createdAt": "2020-05-07T21:32:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyMzMxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MTMyNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424771324", "bodyText": "Removed, left one line for the schema test commented as I don't wanna forget it once everything is working in this PR", "author": "Nana-EC", "createdAt": "2020-05-13T22:40:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyMzMxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyNTA4NQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421725085", "bodyText": "couldn't find REGISTRY in schema.yaml. what am i missing?", "author": "apeksharma", "createdAt": "2020-05-07T18:58:26Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart, swap values file and archive chart\n+ADD chart /tmp/chart\n+RUN mv /tmp/chart/values-gcp-marketplace.yaml /tmp/chart/values.yaml\n+RUN cd /tmp && tar -czvf /tmp/hedera-mirror.tar.gz chart\n+\n+##ADD apptest/deployer/hedera-mirror /tmp/test/chart\n+##RUN cd /tmp/test \\\n+##    && tar -czvf /tmp/test/hedera-mirror.tar.gz chart/\n+\n+ADD schema.yaml /tmp/schema.yaml\n+\n+ARG REGISTRY\n+ARG TAG\n+\n+RUN cat /tmp/schema.yaml \\\n+    | env -i \"REGISTRY=$REGISTRY\" \"TAG=$TAG\" envsubst \\", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc0ODg2Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424748863", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-13T21:44:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyNTA4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyNzIxOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421727219", "bodyText": "remove.", "author": "apeksharma", "createdAt": "2020-05-07T19:02:13Z", "path": "hedera-mirror-gcp-marketplace/pom.xml", "diffHunk": "@@ -0,0 +1,87 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <artifactId>hedera-mirror-gcp-marketplace</artifactId>\n+    <description>Google Cloud Platform Marketplace solution for the Hedera Mirror Node</description>\n+    <modelVersion>4.0.0</modelVersion>\n+    <name>Hedera Mirror Node GCP Marketplace</name>\n+    <packaging>pom</packaging>\n+\n+    <parent>\n+        <groupId>com.hedera</groupId>\n+        <artifactId>hedera-mirror-node</artifactId>\n+        <version>0.11.0-rc1</version>\n+    </parent>\n+\n+    <properties>\n+        <docker.buildArg.registry>${docker.push.repository}/hedera-mirror-node</docker.buildArg.registry>\n+        <docker.buildArg.tag>${gmp.track}</docker.buildArg.tag>\n+    </properties>\n+\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <artifactId>maven-resources-plugin</artifactId>\n+                <version>3.1.0</version>\n+                <executions>\n+                    <execution>\n+                        <id>copy-chart</id>\n+                        <!-- here the phase you need -->", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc0OTE1MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424749151", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-13T21:44:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcyNzIxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTczNDgyMg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421734822", "bodyText": "can be removed?", "author": "apeksharma", "createdAt": "2020-05-07T19:15:59Z", "path": "charts/hedera-mirror/values-gcp-marketplace.yaml", "diffHunk": "@@ -0,0 +1,86 @@\n+#properties:", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgwODAyMQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421808021", "bodyText": "Already removed, yet to push. Will probably also merge this file in with the one Steven created since he got in first", "author": "Nana-EC", "createdAt": "2020-05-07T21:34:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTczNDgyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0MDkwOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421740909", "bodyText": "properties (global scope) are not good way, please use plugin's configuration to pass args to the docker build.\nhttps://dmp.fabric8.io/#build-buildargs", "author": "apeksharma", "createdAt": "2020-05-07T19:27:09Z", "path": "hedera-mirror-gcp-marketplace/pom.xml", "diffHunk": "@@ -0,0 +1,87 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <artifactId>hedera-mirror-gcp-marketplace</artifactId>\n+    <description>Google Cloud Platform Marketplace solution for the Hedera Mirror Node</description>\n+    <modelVersion>4.0.0</modelVersion>\n+    <name>Hedera Mirror Node GCP Marketplace</name>\n+    <packaging>pom</packaging>\n+\n+    <parent>\n+        <groupId>com.hedera</groupId>\n+        <artifactId>hedera-mirror-node</artifactId>\n+        <version>0.11.0-rc1</version>\n+    </parent>\n+\n+    <properties>\n+        <docker.buildArg.registry>${docker.push.repository}/hedera-mirror-node</docker.buildArg.registry>", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgwODI4Nw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421808287", "bodyText": "Was working around what I thought was a bug. Turns out buildings are case sensitive so I can switch back to the plugin config way", "author": "Nana-EC", "createdAt": "2020-05-07T21:34:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0MDkwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0MTkwNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421741904", "bodyText": "We should keep all marketplace related files in single place. schema.yaml here and values-....yaml in other folder should be in single place.\nWe can keep them both in charts/mirror-node/marketplace/....", "author": "apeksharma", "createdAt": "2020-05-07T19:28:58Z", "path": "hedera-mirror-gcp-marketplace/schema.yaml", "diffHunk": "@@ -0,0 +1,89 @@\n+x-google-marketplace:", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgwODc2NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421808764", "bodyText": "It's separate files due to a marketplace requirement when deploying. You have to have the Schema.yam file and they expect values.yaml to fill in as desired", "author": "Nana-EC", "createdAt": "2020-05-07T21:35:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0MTkwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0Mjc3NQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421742775", "bodyText": "what's the significance of this?\nAlso, not used in multiple poms, please move it to the single pom using it.", "author": "apeksharma", "createdAt": "2020-05-07T19:30:38Z", "path": "pom.xml", "diffHunk": "@@ -57,6 +58,7 @@\n         <docker.push.repository>gcr.io/mirrornode</docker.push.repository>\n         <docker.tag.version>${project.version}</docker.tag.version>\n         <docker.tag.latest>latest</docker.tag.latest>\n+        <gmp.track>0.11</gmp.track>", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgxMDM4MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421810381", "bodyText": "marketplace enforces a TRACK concept of versioning.\nSo you can say track 1.0 and your solution can range across all 1.x.y values so far as they are backward compatible.\nSee https://cloud.google.com/marketplace/docs/partners/kubernetes-solutions/set-up-environment#organize-releases\nAll images have to have this track value as a tag, hence putting it in here. Will be updating gate poms to also tag there on importer, grpc and rest for releases", "author": "Nana-EC", "createdAt": "2020-05-07T21:39:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0Mjc3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgzMDEyNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421830124", "bodyText": "What you say is true, but the version in the schema.yaml should be the specific unique release tag, not the track ID. Thus you don't need to store this and pass it through to the Dockerfile, can just use ${project.version}. The track ID will just be used to tag the latest for that track.  We can use some oneliner to convert x.y.z to x.y in circleci.", "author": "steven-sheehy", "createdAt": "2020-05-07T22:26:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0Mjc3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MDg2NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424770864", "bodyText": "Updated build arg to use the docker.tag.version like the other projects. This allows for build time version sets.\nLeft the <gap.track> around since all the images need this as a tag also.", "author": "Nana-EC", "createdAt": "2020-05-13T22:39:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0Mjc3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0NzgzNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421747834", "bodyText": "Use COPY\nhttps://docs.docker.com/develop/develop-images/dockerfile_best-practices/#add-or-copy", "author": "apeksharma", "createdAt": "2020-05-07T19:39:57Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart, swap values file and archive chart\n+ADD chart /tmp/chart", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgxODU5Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421818592", "bodyText": "Good point. Changing", "author": "Nana-EC", "createdAt": "2020-05-07T21:57:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0NzgzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0OTIzNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421749234", "bodyText": "no need of this plugin just to copy dir.\nPass ${project.basedir}/../charts/hedera-mirror as arg srcChartDir to docker builder, and in Dockerfile use COPY ${srcChartDir} <to>", "author": "apeksharma", "createdAt": "2020-05-07T19:42:30Z", "path": "hedera-mirror-gcp-marketplace/pom.xml", "diffHunk": "@@ -0,0 +1,87 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <artifactId>hedera-mirror-gcp-marketplace</artifactId>\n+    <description>Google Cloud Platform Marketplace solution for the Hedera Mirror Node</description>\n+    <modelVersion>4.0.0</modelVersion>\n+    <name>Hedera Mirror Node GCP Marketplace</name>\n+    <packaging>pom</packaging>\n+\n+    <parent>\n+        <groupId>com.hedera</groupId>\n+        <artifactId>hedera-mirror-node</artifactId>\n+        <version>0.11.0-rc1</version>\n+    </parent>\n+\n+    <properties>\n+        <docker.buildArg.registry>${docker.push.repository}/hedera-mirror-node</docker.buildArg.registry>\n+        <docker.buildArg.tag>${gmp.track}</docker.buildArg.tag>\n+    </properties>\n+\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <artifactId>maven-resources-plugin</artifactId>", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgxNzk1Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421817952", "bodyText": "Was dealing with docker build context issues previous. Trying to copy from files above the Dockerfile level created issues liked forbidden errors and then the fact that going up ends up increasing the build context memory and hit copy issues because the /target file is within the same context.\nWas fighting with this for a few hours yesterday. I can revisit this later is it works but as of now I'm still seeing the forbidden our of build context issue and I'd prefer not to necessarily increase the build context that is then put in a temporary tar", "author": "Nana-EC", "createdAt": "2020-05-07T21:55:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0OTIzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwMTk4MA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424801980", "bodyText": "I was thinking of something like this 1351c54  if you guys okay with keeping all marketplace stuff (values and schema) together in charts/marketplace/...", "author": "apeksharma", "createdAt": "2020-05-14T00:16:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0OTIzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNjMwOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425306309", "bodyText": "I like this idea. I'm not a fan of a new submodule that then has to have access to other folders outside its project to complete its task. Might as well just have charts/marketplace and add extra docker-maven-plugin in root pom.xml", "author": "steven-sheehy", "createdAt": "2020-05-14T17:22:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0OTIzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwMzc3Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425403776", "bodyText": "Gotcha, working on this.\nWill remove the module and move schema.yaml etc to /charts/marketplace/gcp\nWill also update parent pom to house the build logic", "author": "Nana-EC", "createdAt": "2020-05-14T20:15:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc0OTIzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgzNTQyMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r421835423", "bodyText": "share common parts of this plugin with Rest module by adding to pluginManagement in root pom.", "author": "apeksharma", "createdAt": "2020-05-07T22:41:35Z", "path": "hedera-mirror-gcp-marketplace/pom.xml", "diffHunk": "@@ -0,0 +1,87 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <artifactId>hedera-mirror-gcp-marketplace</artifactId>\n+    <description>Google Cloud Platform Marketplace solution for the Hedera Mirror Node</description>\n+    <modelVersion>4.0.0</modelVersion>\n+    <name>Hedera Mirror Node GCP Marketplace</name>\n+    <packaging>pom</packaging>\n+\n+    <parent>\n+        <groupId>com.hedera</groupId>\n+        <artifactId>hedera-mirror-node</artifactId>\n+        <version>0.11.0-rc1</version>\n+    </parent>\n+\n+    <properties>\n+        <docker.buildArg.registry>${docker.push.repository}/hedera-mirror-node</docker.buildArg.registry>\n+        <docker.buildArg.tag>${gmp.track}</docker.buildArg.tag>\n+    </properties>\n+\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <artifactId>maven-resources-plugin</artifactId>\n+                <version>3.1.0</version>\n+                <executions>\n+                    <execution>\n+                        <id>copy-chart</id>\n+                        <!-- here the phase you need -->\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>copy-resources</goal>\n+                        </goals>\n+                        <configuration>\n+                            <outputDirectory>${basedir}/chart</outputDirectory>\n+                            <resources>\n+                                <resource>\n+                                    <directory>${project.basedir}/../charts/hedera-mirror</directory>\n+                                    <filtering>true</filtering>\n+                                </resource>\n+                            </resources>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+            <plugin>", "originalCommit": "6da318eacde516514e59b7a3718269e04fc97197", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MDI2NQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424770265", "bodyText": "Good suggestion. Done", "author": "Nana-EC", "createdAt": "2020-05-13T22:37:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgzNTQyMw=="}], "type": "inlineReview"}, {"oid": "c756693a9494074f7776d303505450da726890e7", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/c756693a9494074f7776d303505450da726890e7", "message": "Added deployer folder structure with schema and docker file\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:41:30Z", "type": "commit"}, {"oid": "90d9445e848845cc09eec2ae6d79292380fc5ba3", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/90d9445e848845cc09eec2ae6d79292380fc5ba3", "message": "Removed application.yaml and Makefile and updated image urls in values\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:41:30Z", "type": "commit"}, {"oid": "1bf9791817384cc928d8a45a279ad651b87e2adb", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/1bf9791817384cc928d8a45a279ad651b87e2adb", "message": "Configure pom to create gmp deployer image\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:55Z", "type": "commit"}, {"oid": "291a2cc414b1156947d4931ae3715cdae5e46d75", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/291a2cc414b1156947d4931ae3715cdae5e46d75", "message": "Added pom to marketplace dir and updated build args\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "54d6323039aad8581ff58e4685d25093d07b25de", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/54d6323039aad8581ff58e4685d25093d07b25de", "message": "Added missing submodule reference to base pom\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "54d0f6cea64faa3a8d9ce3080a6d08e421325ab1", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/54d0f6cea64faa3a8d9ce3080a6d08e421325ab1", "message": "Fixed dockerfile location\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "9fb7d6471c6bdb6961c89290d5c1112d4c80ef43", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/9fb7d6471c6bdb6961c89290d5c1112d4c80ef43", "message": "Moved Dockerfile up a level\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "b02c8e5c6e60346345f70ef2e8b49094a84a073e", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/b02c8e5c6e60346345f70ef2e8b49094a84a073e", "message": "Verify current docker context\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "6de4fcdef177b76ae34419b44aab0b6e126e8855", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/6de4fcdef177b76ae34419b44aab0b6e126e8855", "message": "Added maven dockerignore file\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "974a7e3bc73c083f1cd4b926b63014fc1cd80df7", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/974a7e3bc73c083f1cd4b926b63014fc1cd80df7", "message": "Updated docker ignore target path\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "465b76fa455f2210fb766dd5a1eec6904581d8c8", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/465b76fa455f2210fb766dd5a1eec6904581d8c8", "message": "Updated pom to copy chart in and use appropraite build context\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "bcdaf7a70898f68ff41a75ff0653c88f045dd60b", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/bcdaf7a70898f68ff41a75ff0653c88f045dd60b", "message": "Updated ignore files and correct repo path\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "9043ded043712e9de32ac96fd7207ff479331f6c", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/9043ded043712e9de32ac96fd7207ff479331f6c", "message": "Added deployer folder structure with schema and docker file\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "1c1c235b3ce4ccbcf5a79ccc38dfcd547d7b84b6", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/1c1c235b3ce4ccbcf5a79ccc38dfcd547d7b84b6", "message": "Removed application.yaml and Makefile and updated image urls in values\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "32c3297d7208966b3585f005d0a98706fd12ea89", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/32c3297d7208966b3585f005d0a98706fd12ea89", "message": "Configure pom to create gmp deployer image\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "d7db3f1a322feb763baef08b55b496fc1aae8289", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/d7db3f1a322feb763baef08b55b496fc1aae8289", "message": "Added pom to marketplace dir and updated build args\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "6c115218f737757aa4ad8e72220d905e962a815f", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/6c115218f737757aa4ad8e72220d905e962a815f", "message": "Moved Dockerfile up a level\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "283ce45b789c620bb831ae3a0bb939e8455f183d", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/283ce45b789c620bb831ae3a0bb939e8455f183d", "message": "Fixed schema duplicate from rebasing\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "85b5b156ef7e81fee9a5758a66fe8a59253cb2fe", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/85b5b156ef7e81fee9a5758a66fe8a59253cb2fe", "message": "Fixed pom version mismatch from rebase\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "0c2d5d0ea9822192b8ad4d97c13c3298143dbdcb", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/0c2d5d0ea9822192b8ad4d97c13c3298143dbdcb", "message": "Updated tagging logic in circle ci and pom. Also put some base wording for README\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:56Z", "type": "commit"}, {"oid": "266283426c5d1bddb9facbd9ee1ff1aa62fb06e3", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/266283426c5d1bddb9facbd9ee1ff1aa62fb06e3", "message": "Moved docker build args up to configurable properties\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:42:57Z", "type": "commit"}, {"oid": "a1cb8a94590fa2a269c511391bb8b4d1e47a6419", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/a1cb8a94590fa2a269c511391bb8b4d1e47a6419", "message": "Updated marketplace tag value and pushed schema.yaml to /data-test also\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:44:01Z", "type": "commit"}, {"oid": "0eccc357d53444c480d1aede6be87138d4c1672a", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/0eccc357d53444c480d1aede6be87138d4c1672a", "message": "Create /data-test folder for schema\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:44:01Z", "type": "commit"}, {"oid": "7b86420f875c59c2e4ea0b853930a2ceabff08d3", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/7b86420f875c59c2e4ea0b853930a2ceabff08d3", "message": "Modified mv to copy for data-test schema\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:44:01Z", "type": "commit"}, {"oid": "45529babe9d73ea3f9b6fbc62a523fe5c57391b0", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/45529babe9d73ea3f9b6fbc62a523fe5c57391b0", "message": "Deployer image modifications 1\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:44:01Z", "type": "commit"}, {"oid": "27db2f5210aeaf8ea6484fc7333959e4797212b8", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/27db2f5210aeaf8ea6484fc7333959e4797212b8", "message": "Updated templates and Dockerfile to support deployer rollout\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:44:22Z", "type": "commit"}, {"oid": "cc40842a466cb7ca3f1d04f65445babaae652db1", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/cc40842a466cb7ca3f1d04f65445babaae652db1", "message": "Cleaned up and shared some code in pom\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:44:52Z", "type": "commit"}, {"oid": "cc40842a466cb7ca3f1d04f65445babaae652db1", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/cc40842a466cb7ca3f1d04f65445babaae652db1", "message": "Cleaned up and shared some code in pom\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-13T22:44:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc4ODgzNQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424788835", "bodyText": "not being used anywhere?", "author": "apeksharma", "createdAt": "2020-05-13T23:32:20Z", "path": "pom.xml", "diffHunk": "@@ -59,7 +60,9 @@\n         <docker.resources>${project.build.directory}/container</docker.resources>\n         <docker.tag.version>${project.version}</docker.tag.version>\n         <docker.tag.latest>latest</docker.tag.latest>\n+        <gmp.track>0.11.0</gmp.track>\n         <grpc.version>1.29.0</grpc.version>\n+        <guava.version>28.2-jre</guava.version>", "originalCommit": "cc40842a466cb7ca3f1d04f65445babaae652db1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIzOTcyMA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425239720", "bodyText": "Might be a merge issue when I rebased. Not a part of my changes. I can remove it since I see it specified in the importer.", "author": "Nana-EC", "createdAt": "2020-05-14T15:45:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc4ODgzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwMjA1Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424802052", "bodyText": "no need to specify dockerFile if it's directly under contextDir", "author": "apeksharma", "createdAt": "2020-05-14T00:17:06Z", "path": "hedera-mirror-gcp-marketplace/pom.xml", "diffHunk": "@@ -0,0 +1,65 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <artifactId>hedera-mirror-gcp-marketplace</artifactId>\n+    <description>Google Cloud Platform Marketplace solution for the Hedera Mirror Node</description>\n+    <modelVersion>4.0.0</modelVersion>\n+    <name>Hedera Mirror Node GCP Marketplace</name>\n+    <packaging>pom</packaging>\n+\n+    <parent>\n+        <groupId>com.hedera</groupId>\n+        <artifactId>hedera-mirror-node</artifactId>\n+        <version>0.11.0-rc1</version>\n+    </parent>\n+\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <artifactId>maven-resources-plugin</artifactId>\n+                <version>3.1.0</version>\n+                <executions>\n+                    <execution>\n+                        <id>copy-chart</id>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>copy-resources</goal>\n+                        </goals>\n+                        <configuration>\n+                            <outputDirectory>${basedir}/chart</outputDirectory>\n+                            <resources>\n+                                <resource>\n+                                    <directory>${project.basedir}/../charts/hedera-mirror</directory>\n+                                </resource>\n+                            </resources>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+            <plugin>\n+                <groupId>io.fabric8</groupId>\n+                <artifactId>docker-maven-plugin</artifactId>\n+                <configuration>\n+                    <images>\n+                        <image>\n+                            <build>\n+                                <contextDir>${project.basedir}/</contextDir>\n+                                <dockerFile>${project.basedir}/Dockerfile</dockerFile>", "originalCommit": "cc40842a466cb7ca3f1d04f65445babaae652db1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxODU2OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425318569", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-14T17:42:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwMjA1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwMjQ2Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424802466", "bodyText": "delete /tmp dir in the end", "author": "apeksharma", "createdAt": "2020-05-14T00:18:38Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart\n+COPY chart /tmp/chart\n+\n+# get yq and merge values files\n+RUN apt-get update \\\n+    && apt-get install -y --no-install-recommends software-properties-common \\\n+    && add-apt-repository ppa:rmescandon/yq\n+RUN apt update && apt install -y --no-install-recommends yq\n+RUN yq m -x /tmp/chart/values.yaml /tmp/chart/values-marketplace.yaml > /tmp/chart/values-merged.yaml\n+\n+# helm template to render and verify templates\n+RUN helm template /tmp/chart -f /tmp/chart/values-merged.yaml\n+\n+# overwrite values file and archive\n+RUN mv /tmp/chart/values-merged.yaml /tmp/chart/values.yaml\n+RUN cd /tmp && tar -czvf /tmp/hedera-mirror-node.tar.gz chart/\n+\n+# Pull in and update schema for marketplace deployer\n+ARG tag\n+COPY schema.yaml /tmp/schema.yaml\n+RUN cat /tmp/schema.yaml \\\n+    | env -i \"TAG=$tag\" envsubst \\\n+    > /tmp/schema.yaml.new \\\n+    && mv /tmp/schema.yaml.new /tmp/schema.yaml\n+\n+# move chart and schema to expected /data folder structure\n+RUN mv /tmp/hedera-mirror-node.tar.gz /data/chart/\n+RUN mv /tmp/schema.yaml /data/schema.yaml\n+", "originalCommit": "cc40842a466cb7ca3f1d04f65445babaae652db1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNDMwNQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425314305", "bodyText": "Will do", "author": "Nana-EC", "createdAt": "2020-05-14T17:35:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwMjQ2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwMzEyMQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424803121", "bodyText": "Why not directly write to /data/schema.yml rather than write to x, move to y, then move to z.", "author": "apeksharma", "createdAt": "2020-05-14T00:20:58Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart\n+COPY chart /tmp/chart\n+\n+# get yq and merge values files\n+RUN apt-get update \\\n+    && apt-get install -y --no-install-recommends software-properties-common \\\n+    && add-apt-repository ppa:rmescandon/yq\n+RUN apt update && apt install -y --no-install-recommends yq\n+RUN yq m -x /tmp/chart/values.yaml /tmp/chart/values-marketplace.yaml > /tmp/chart/values-merged.yaml\n+\n+# helm template to render and verify templates\n+RUN helm template /tmp/chart -f /tmp/chart/values-merged.yaml\n+\n+# overwrite values file and archive\n+RUN mv /tmp/chart/values-merged.yaml /tmp/chart/values.yaml\n+RUN cd /tmp && tar -czvf /tmp/hedera-mirror-node.tar.gz chart/\n+\n+# Pull in and update schema for marketplace deployer\n+ARG tag\n+COPY schema.yaml /tmp/schema.yaml\n+RUN cat /tmp/schema.yaml \\\n+    | env -i \"TAG=$tag\" envsubst \\\n+    > /tmp/schema.yaml.new \\", "originalCommit": "cc40842a466cb7ca3f1d04f65445babaae652db1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNTQzOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425315439", "bodyText": "Doesn't seem to work for in place writing with the current logic. Looked into it a little and I believe it's because the pipes are asynchronous. When writing the files contents it'll clear it if the file already exists. So recommended practice is to use a temporary file to avoid any such issues.\nSome explanations of it here https://stackoverflow.com/questions/35078753/can-envsubst-not-do-in-place-substitution\nhttps://stackoverflow.com/questions/47081507/why-does-rewriting-a-file-with-envsubst-file-file-leave-it-empty", "author": "Nana-EC", "createdAt": "2020-05-14T17:37:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwMzEyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwNDAwMA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424804000", "bodyText": "'tag' is very overloaded right now.\nWe can rename just the arg to its purpose - 'publishedVersion' or something more specific.", "author": "apeksharma", "createdAt": "2020-05-14T00:24:14Z", "path": "hedera-mirror-gcp-marketplace/pom.xml", "diffHunk": "@@ -0,0 +1,65 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n+<project xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+    <artifactId>hedera-mirror-gcp-marketplace</artifactId>\n+    <description>Google Cloud Platform Marketplace solution for the Hedera Mirror Node</description>\n+    <modelVersion>4.0.0</modelVersion>\n+    <name>Hedera Mirror Node GCP Marketplace</name>\n+    <packaging>pom</packaging>\n+\n+    <parent>\n+        <groupId>com.hedera</groupId>\n+        <artifactId>hedera-mirror-node</artifactId>\n+        <version>0.11.0-rc1</version>\n+    </parent>\n+\n+    <build>\n+        <plugins>\n+            <plugin>\n+                <artifactId>maven-resources-plugin</artifactId>\n+                <version>3.1.0</version>\n+                <executions>\n+                    <execution>\n+                        <id>copy-chart</id>\n+                        <phase>install</phase>\n+                        <goals>\n+                            <goal>copy-resources</goal>\n+                        </goals>\n+                        <configuration>\n+                            <outputDirectory>${basedir}/chart</outputDirectory>\n+                            <resources>\n+                                <resource>\n+                                    <directory>${project.basedir}/../charts/hedera-mirror</directory>\n+                                </resource>\n+                            </resources>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+            <plugin>\n+                <groupId>io.fabric8</groupId>\n+                <artifactId>docker-maven-plugin</artifactId>\n+                <configuration>\n+                    <images>\n+                        <image>\n+                            <build>\n+                                <contextDir>${project.basedir}/</contextDir>\n+                                <dockerFile>${project.basedir}/Dockerfile</dockerFile>\n+                                <nocache>true</nocache>\n+                                <assembly>\n+                                    <exportTargetDir>false</exportTargetDir>\n+                                </assembly>\n+                                <args>\n+                                    <tag>${docker.tag.version}</tag>", "originalCommit": "cc40842a466cb7ca3f1d04f65445babaae652db1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNDQ2Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425314466", "bodyText": "Agreed tag can be overloaded but in this case it is indeed a tag on the image. What is it being confused for?\nThe qualifier after says what the tag represents.\nDid you want me to rename the existing .version to .publishedVersion", "author": "Nana-EC", "createdAt": "2020-05-14T17:35:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwNDAwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwNDkxMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r424804913", "bodyText": "remove Dockerfile from ignore list. let it be sent with the context.", "author": "apeksharma", "createdAt": "2020-05-14T00:27:23Z", "path": "hedera-mirror-gcp-marketplace/.maven-dockerignore", "diffHunk": "@@ -0,0 +1,2 @@\n+Dockerfile", "originalCommit": "cc40842a466cb7ca3f1d04f65445babaae652db1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxODc0OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425318749", "bodyText": "Done", "author": "Nana-EC", "createdAt": "2020-05-14T17:42:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwNDkxMw=="}], "type": "inlineReview"}, {"oid": "6189a45010b22513865d2f7aaf4ab6f30646311f", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/6189a45010b22513865d2f7aaf4ab6f30646311f", "message": "Cleanup up circle ci and chart configs\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-14T14:09:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI0OTUxNg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425249516", "bodyText": "Will figure out how to not have to hard code this.\nThe json parser marketplace uses wouldn't accept {{ .Values }} so I did this as a work around. Lots of other solution also hard code these as they don't change often.\nWill come back to it", "author": "Nana-EC", "createdAt": "2020-05-14T15:58:52Z", "path": "charts/hedera-mirror/templates/application.yaml", "diffHunk": "@@ -4,40 +4,34 @@ kind: Application\n metadata:\n   annotations:\n     kubernetes-engine.cloud.google.com/icon: data:image/png;base64,{{ .Files.Get \"logo.png\" | b64enc }}\n-    marketplace.cloud.google.com/deploy-info: |-\n-      {\n-        partner_id: {{ .Values.applicationResource.partnerId | quote }},\n-        partner_name: {{ .Values.applicationResource.partnerName | quote }},\n-        product_id: {{ .Values.applicationResource.productId | quote }}\n-      }\n+    marketplace.cloud.google.com/deploy-info: '{ \"partner_id\": \"hederaPartnerId\", \"partner_name\": \"partner_name\", \"product_id\": \"hederaMirrorSolutionId\" }'", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3ad2b08a3b7d4c4411aba12a34c27de65be73002", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/3ad2b08a3b7d4c4411aba12a34c27de65be73002", "message": "Addressed Appy feedback\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-14T17:42:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5MjQzNQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425192435", "bodyText": "This if should be around the export SERVICE_IP and grafana sections as well", "author": "steven-sheehy", "createdAt": "2020-05-14T14:43:35Z", "path": "charts/hedera-mirror/templates/NOTES.txt", "diffHunk": "@@ -3,11 +3,13 @@ Hedera Mirror Node {{ .Chart.AppVersion }} successfully installed.\n To get the load balancer IP:\n   export SERVICE_IP=$(kubectl get svc -n {{ include \"hedera-mirror.namespace\" . }} {{ .Values.traefik.fullnameOverride }} -o jsonpath=\"{.status.loadBalancer.ingress[0].ip}\")\n \n+{{ if and .Values.traefik.enabled -}}\n To access the GRPC API:\n   grpcurl -plaintext ${SERVICE_IP}:{{ .Values.traefik.ports.web.exposedPort }} list\n \n To access the REST API:\n   curl -s \"http://${SERVICE_IP}:{{ .Values.traefik.ports.web.exposedPort }}/api/v1/transactions?limit=1\"\n+{{- end -}}", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwNTE2Nw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425405167", "bodyText": "Will expand", "author": "Nana-EC", "createdAt": "2020-05-14T20:17:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5MjQzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5MjgzOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425192839", "bodyText": "This can probably stay {{ include \"hedera-mirror.namespace\" . }}", "author": "steven-sheehy", "createdAt": "2020-05-14T14:44:09Z", "path": "charts/hedera-mirror/templates/application.yaml", "diffHunk": "@@ -4,40 +4,34 @@ kind: Application\n metadata:\n   annotations:\n     kubernetes-engine.cloud.google.com/icon: data:image/png;base64,{{ .Files.Get \"logo.png\" | b64enc }}\n-    marketplace.cloud.google.com/deploy-info: |-\n-      {\n-        partner_id: {{ .Values.applicationResource.partnerId | quote }},\n-        partner_name: {{ .Values.applicationResource.partnerName | quote }},\n-        product_id: {{ .Values.applicationResource.productId | quote }}\n-      }\n+    marketplace.cloud.google.com/deploy-info: '{ \"partner_id\": \"hederaPartnerId\", \"partner_name\": \"partner_name\", \"product_id\": \"hederaMirrorSolutionId\" }'\n   labels:\n     {{- include \"hedera-mirror.labels\" . | nindent 4 }}\n-  name: {{ include \"hedera-mirror.fullname\" . }}\n-  namespace: {{ include \"hedera-mirror.namespace\" . }}\n+    app.kubernetes.io/name: {{ .Release.Name }}\n+  name: {{ .Release.Name }}\n+  namespace: {{ .Release.Namespace }}", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU3OTMyMA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425579320", "bodyText": "Reverted", "author": "Nana-EC", "createdAt": "2020-05-15T05:48:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5MjgzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5NDQ4OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425194489", "bodyText": "All of the plugin declaration in child pom can be removed except the groupId and artifactId", "author": "steven-sheehy", "createdAt": "2020-05-14T14:46:13Z", "path": "hedera-mirror-rest/pom.xml", "diffHunk": "@@ -37,13 +37,6 @@\n                 <configuration>\n                     <images>\n                         <image>\n-                            <build>", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU3OTQ3OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425579479", "bodyText": "Reverted back", "author": "Nana-EC", "createdAt": "2020-05-15T05:49:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE5NDQ4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1NjE1OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425256158", "bodyText": "Rest of file is sorted. Would prefer new elements sorted as well.", "author": "steven-sheehy", "createdAt": "2020-05-14T16:08:16Z", "path": "charts/hedera-mirror/values.yaml", "diffHunk": "@@ -350,3 +350,6 @@ traefik:\n     - name: traefik\n       mountPath: /etc/traefik/\n       type: configMap\n+\n+priorityClass:", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxMDQxNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425410414", "bodyText": "Can do", "author": "Nana-EC", "createdAt": "2020-05-14T20:27:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1NjE1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1Nzg5OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425257899", "bodyText": "These should be templated", "author": "steven-sheehy", "createdAt": "2020-05-14T16:10:47Z", "path": "charts/hedera-mirror/templates/application.yaml", "diffHunk": "@@ -4,40 +4,34 @@ kind: Application\n metadata:\n   annotations:\n     kubernetes-engine.cloud.google.com/icon: data:image/png;base64,{{ .Files.Get \"logo.png\" | b64enc }}\n-    marketplace.cloud.google.com/deploy-info: |-\n-      {\n-        partner_id: {{ .Values.applicationResource.partnerId | quote }},\n-        partner_name: {{ .Values.applicationResource.partnerName | quote }},\n-        product_id: {{ .Values.applicationResource.productId | quote }}\n-      }\n+    marketplace.cloud.google.com/deploy-info: '{ \"partner_id\": \"hederaPartnerId\", \"partner_name\": \"partner_name\", \"product_id\": \"hederaMirrorSolutionId\" }'", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQwOTk0NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425409944", "bodyText": "Made a comment on this above regarding the mpdev json parser complaining when it was.\nI intend to come back to it once everything is sorted.\nSome projects even leave it as hard coded given it is unlikely o change but agreed that it should be templated", "author": "Nana-EC", "createdAt": "2020-05-14T20:26:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1Nzg5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1ODk4NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425258984", "bodyText": "This is already the value in values.yaml, no need to duplicate", "author": "steven-sheehy", "createdAt": "2020-05-14T16:12:22Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -9,28 +30,66 @@ grpc:\n     create: false\n   serviceMonitor:\n     enabled: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/grpc\n+    <<: *versiontag\n+  service:\n+    type: LoadBalancer\n+\n importer:\n   podMonitor:\n     enabled: false\n+  priorityClassName: \"\"\n   rbac:\n     enabled: false\n   replicas: 1\n   serviceAccount:\n     create: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/importer\n+    <<: *versiontag\n+\n+labels: {}", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxMDg3MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425410871", "bodyText": "Left over from temporary merge. Missed it in cleanup. Will remove", "author": "Nana-EC", "createdAt": "2020-05-14T20:28:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1ODk4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1OTA2OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425259069", "bodyText": "This is already the value in values.yaml, no need to duplicate", "author": "steven-sheehy", "createdAt": "2020-05-14T16:12:31Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -9,28 +30,66 @@ grpc:\n     create: false\n   serviceMonitor:\n     enabled: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/grpc\n+    <<: *versiontag\n+  service:\n+    type: LoadBalancer\n+\n importer:\n   podMonitor:\n     enabled: false\n+  priorityClassName: \"\"\n   rbac:\n     enabled: false\n   replicas: 1\n   serviceAccount:\n     create: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/importer\n+    <<: *versiontag\n+\n+labels: {}\n+\n loki:\n   enabled: false\n+\n+networkPolicy:\n+  enabled: false", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxMTM3Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425411372", "bodyText": "Same as labels. Will remove", "author": "Nana-EC", "createdAt": "2020-05-14T20:29:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1OTA2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MTE3NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425261174", "bodyText": "Don't like the name gmp.track. Also, tagging latest minor version has value even for non marketplace deployments. Would suggest docker.tag.minor", "author": "steven-sheehy", "createdAt": "2020-05-14T16:15:33Z", "path": "pom.xml", "diffHunk": "@@ -59,7 +60,9 @@\n         <docker.resources>${project.build.directory}/container</docker.resources>\n         <docker.tag.version>${project.version}</docker.tag.version>\n         <docker.tag.latest>latest</docker.tag.latest>\n+        <gmp.track>0.11.0</gmp.track>", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxMzcyMg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425413722", "bodyText": "Can change.", "author": "Nana-EC", "createdAt": "2020-05-14T20:33:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MTE3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MTcxNQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425261715", "bodyText": "How would this value get handled for master tags?", "author": "steven-sheehy", "createdAt": "2020-05-14T16:16:15Z", "path": "pom.xml", "diffHunk": "@@ -185,6 +188,7 @@\n                             <tags>\n                                 <tag>${docker.tag.latest}</tag>\n                                 <tag>${docker.tag.version}</tag>\n+                                <tag>${gmp.track}</tag>", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNTI0Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425415243", "bodyText": "It would be added even for master images. Is there a downside other than the extra tag on an image?", "author": "Nana-EC", "createdAt": "2020-05-14T20:36:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MTcxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxODE3Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425418172", "bodyText": "0.x tags should point to latest tagged release, not latest master. This is the standard on how every docker tag works on docker hub. See postgres for an example.", "author": "steven-sheehy", "createdAt": "2020-05-14T20:42:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MTcxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4MDM3Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425580372", "bodyText": "I can update the circle ci logic to set docker.tag.latest to the minor value in this case. Will look into it and remove this so it's not done all the time", "author": "Nana-EC", "createdAt": "2020-05-15T05:51:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MTcxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkzMDk0Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r426930946", "bodyText": "Fixed this. Circle CI will not add -Ddocker.tags.0=. on release builds. All other branches won't see this", "author": "Nana-EC", "createdAt": "2020-05-18T22:42:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MTcxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2OTU0Nw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425269547", "bodyText": "Shouldn't this be separated into pgpool and postgresql image sections?", "author": "steven-sheehy", "createdAt": "2020-05-14T16:25:47Z", "path": "hedera-mirror-gcp-marketplace/schema.yaml", "diffHunk": "@@ -0,0 +1,80 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      A mirror-node update.\n+    # releaseTypes list is optional. Feature | BugFix | Security\n+    # \"Security\" should only be used if this is an important update to patch\n+    # an existing vulnerability, as such updates will display more prominently for users.\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        mirrornode.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        mirrornode.image.tag:\n+          type: TAG\n+    grpc:\n+      properties:\n+        grpc.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        grpc.image.tag:\n+          type: TAG\n+    rest:\n+      properties:\n+        rest.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        rest.image.tag:\n+          type: TAG\n+    postgresql:", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc1MDY2OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r426750669", "bodyText": "Yes, you are right. This helped move me forward a bit. Thanks", "author": "Nana-EC", "createdAt": "2020-05-18T16:27:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2OTU0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3MDk4OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425270989", "bodyText": "Initial release of the Hedera Mirror Node", "author": "steven-sheehy", "createdAt": "2020-05-14T16:27:24Z", "path": "hedera-mirror-gcp-marketplace/schema.yaml", "diffHunk": "@@ -0,0 +1,80 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      A mirror-node update.", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNjExNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425416114", "bodyText": "Eventually it won't be the initial so figured update was more fitting but I can change it. Saw some projects with version > 2.x.y but still said initial, lol", "author": "Nana-EC", "createdAt": "2020-05-14T20:38:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3MDk4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxODcyNQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425418725", "bodyText": "I think the intent is that this gets replaced every release with a blurb about what's changed. Otherwise we should just not provide it if it's always going to be static as that's not helpful", "author": "steven-sheehy", "createdAt": "2020-05-14T20:43:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3MDk4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4MTU0Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425581543", "bodyText": "Can come back to it. If is is static will remove", "author": "Nana-EC", "createdAt": "2020-05-15T05:55:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3MDk4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3Mjc0OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425272748", "bodyText": "We should also expose replicas property and passwords for all components. Replicas default to 1 but passwords should be empty and require input.", "author": "steven-sheehy", "createdAt": "2020-05-14T16:30:01Z", "path": "hedera-mirror-gcp-marketplace/schema.yaml", "diffHunk": "@@ -0,0 +1,80 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      A mirror-node update.\n+    # releaseTypes list is optional. Feature | BugFix | Security\n+    # \"Security\" should only be used if this is an important update to patch\n+    # an existing vulnerability, as such updates will display more prominently for users.\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        mirrornode.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        mirrornode.image.tag:\n+          type: TAG\n+    grpc:\n+      properties:\n+        grpc.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        grpc.image.tag:\n+          type: TAG\n+    rest:\n+      properties:\n+        rest.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        rest.image.tag:\n+          type: TAG\n+    postgresql:\n+      properties:\n+        postgresql.postgresqlImage.registry:\n+          type: REGISTRY\n+        postgresql.postgresqlImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.postgresqlImage.tag:\n+          type: TAG\n+        postgresql.pgpoolImage.registry:\n+          type: REGISTRY\n+        postgresql.pgpoolImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.pgpoolImage.tag:\n+          type: TAG\n+\n+  # Other fields, like clusterConstraints, can be included here.\n+\n+  # The Properties and Required sections of v2 are structured the same as those of v1.\n+  # IMPORTANT: These IDs must match your listing ID in Marketplace.\n+  partnerId: hederaPartnerId\n+  solutionId: hederaMirrorSolutionId\n+\n+properties:\n+  name:\n+    type: string\n+    x-google-marketplace:\n+      type: NAME\n+  namespace:\n+    type: string\n+    x-google-marketplace:\n+      type: NAMESPACE\n+  deployer.image:\n+    type: string\n+    x-google-marketplace:\n+      type: DEPLOYER_IMAGE", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc1MTA4Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r426751082", "bodyText": "Can do", "author": "Nana-EC", "createdAt": "2020-05-18T16:28:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3Mjc0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI4MDg2Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425280863", "bodyText": "Combine these two lines. Move add-apt-repository as first then you can install all in one command", "author": "steven-sheehy", "createdAt": "2020-05-14T16:42:32Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart\n+COPY chart /tmp/chart\n+\n+# get yq and merge values files\n+RUN apt-get update \\\n+    && apt-get install -y --no-install-recommends software-properties-common \\\n+    && add-apt-repository ppa:rmescandon/yq\n+RUN apt update && apt install -y --no-install-recommends yq", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ0ODY3Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425448673", "bodyText": "In most cases add-apt-repository isn't available. Since it's a utility in the software-properties-common package you have to install that first or else you get a\nadd-apt-repository: not found\nLet me see if I can work around that though", "author": "Nana-EC", "createdAt": "2020-05-14T21:44:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI4MDg2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI4MTIzNg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425281236", "bodyText": "Nice!", "author": "steven-sheehy", "createdAt": "2020-05-14T16:43:04Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart\n+COPY chart /tmp/chart\n+\n+# get yq and merge values files\n+RUN apt-get update \\\n+    && apt-get install -y --no-install-recommends software-properties-common \\\n+    && add-apt-repository ppa:rmescandon/yq\n+RUN apt update && apt install -y --no-install-recommends yq\n+RUN yq m -x /tmp/chart/values.yaml /tmp/chart/values-marketplace.yaml > /tmp/chart/values-merged.yaml", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI4OTczNQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425289735", "bodyText": "This command is not necessary if you just merge two files above directly to values.yaml", "author": "steven-sheehy", "createdAt": "2020-05-14T16:56:21Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart\n+COPY chart /tmp/chart\n+\n+# get yq and merge values files\n+RUN apt-get update \\\n+    && apt-get install -y --no-install-recommends software-properties-common \\\n+    && add-apt-repository ppa:rmescandon/yq\n+RUN apt update && apt install -y --no-install-recommends yq\n+RUN yq m -x /tmp/chart/values.yaml /tmp/chart/values-marketplace.yaml > /tmp/chart/values-merged.yaml\n+\n+# helm template to render and verify templates\n+RUN helm template /tmp/chart -f /tmp/chart/values-merged.yaml\n+\n+# overwrite values file and archive\n+RUN mv /tmp/chart/values-merged.yaml /tmp/chart/values.yaml", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ3MzYyMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425473623", "bodyText": "Yep yq m -i --overwrite will do it", "author": "Nana-EC", "createdAt": "2020-05-14T22:51:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI4OTczNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI5NzQxNw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425297417", "bodyText": "This should be a multi-stage build so that all the prebuild utilities and folders don't get carried over.", "author": "steven-sheehy", "createdAt": "2020-05-14T17:08:13Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart\n+COPY chart /tmp/chart\n+\n+# get yq and merge values files\n+RUN apt-get update \\\n+    && apt-get install -y --no-install-recommends software-properties-common \\\n+    && add-apt-repository ppa:rmescandon/yq\n+RUN apt update && apt install -y --no-install-recommends yq\n+RUN yq m -x /tmp/chart/values.yaml /tmp/chart/values-marketplace.yaml > /tmp/chart/values-merged.yaml\n+\n+# helm template to render and verify templates\n+RUN helm template /tmp/chart -f /tmp/chart/values-merged.yaml\n+\n+# overwrite values file and archive\n+RUN mv /tmp/chart/values-merged.yaml /tmp/chart/values.yaml\n+RUN cd /tmp && tar -czvf /tmp/hedera-mirror-node.tar.gz chart/\n+\n+# Pull in and update schema for marketplace deployer\n+ARG tag\n+COPY schema.yaml /tmp/schema.yaml\n+RUN cat /tmp/schema.yaml \\\n+    | env -i \"TAG=$tag\" envsubst \\\n+    > /tmp/schema.yaml.new \\\n+    && mv /tmp/schema.yaml.new /tmp/schema.yaml\n+\n+# move chart and schema to expected /data folder structure", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ3NDEwNw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425474107", "bodyText": "Good suggestion", "author": "Nana-EC", "createdAt": "2020-05-14T22:52:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI5NzQxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwMjI0MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425302241", "bodyText": "Add mpdev", "author": "steven-sheehy", "createdAt": "2020-05-14T17:15:18Z", "path": "hedera-mirror-gcp-marketplace/README.md", "diffHunk": "@@ -0,0 +1,31 @@\n+# Overview\n+\n+This submodule contains logic to support the development and deployment of the Hedera Mirror Node in a Kubernetes cluster in GCP Marketplace.\n+\n+The module takes in the wrapper hedera-mirror Helm chart and bundles it into the required deployer image which is built and pushed to GCR repo on maven deploy.\n+\n+# Setup\n+\n+## Prerequisites\n+\n+### Command line tools\n+\n+- [gcloud](https://cloud.google.com/sdk/gcloud/)\n+- [kubectl](https://kubernetes.io/docs/tasks/tools/install-kubectl/)\n+- [docker](https://docs.docker.com/install/)\n+- [helm](https://helm.sh/docs/using_helm/#installing-helm)\n+- [git](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git)", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4MTg3Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425581876", "bodyText": "Done", "author": "Nana-EC", "createdAt": "2020-05-15T05:56:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwMjI0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwMjgyMQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425302821", "bodyText": "Can remove", "author": "steven-sheehy", "createdAt": "2020-05-14T17:16:11Z", "path": "hedera-mirror-gcp-marketplace/Dockerfile", "diffHunk": "@@ -0,0 +1,32 @@\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+## pull in chart\n+COPY chart /tmp/chart\n+\n+# get yq and merge values files\n+RUN apt-get update \\\n+    && apt-get install -y --no-install-recommends software-properties-common \\\n+    && add-apt-repository ppa:rmescandon/yq\n+RUN apt update && apt install -y --no-install-recommends yq\n+RUN yq m -x /tmp/chart/values.yaml /tmp/chart/values-marketplace.yaml > /tmp/chart/values-merged.yaml\n+\n+# helm template to render and verify templates\n+RUN helm template /tmp/chart -f /tmp/chart/values-merged.yaml\n+\n+# overwrite values file and archive\n+RUN mv /tmp/chart/values-merged.yaml /tmp/chart/values.yaml\n+RUN cd /tmp && tar -czvf /tmp/hedera-mirror-node.tar.gz chart/\n+\n+# Pull in and update schema for marketplace deployer\n+ARG tag\n+COPY schema.yaml /tmp/schema.yaml\n+RUN cat /tmp/schema.yaml \\\n+    | env -i \"TAG=$tag\" envsubst \\\n+    > /tmp/schema.yaml.new \\\n+    && mv /tmp/schema.yaml.new /tmp/schema.yaml\n+\n+# move chart and schema to expected /data folder structure\n+RUN mv /tmp/hedera-mirror-node.tar.gz /data/chart/\n+RUN mv /tmp/schema.yaml /data/schema.yaml\n+\n+#RUN cp /data/schema.yaml /data-test/schema.yaml", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ3NDY1OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425474659", "bodyText": "Added a comment in my own review that I had hoped to add a schema-test.yaml file that you can use for testing purposes. Left uncommented so I wouldn't forget.", "author": "Nana-EC", "createdAt": "2020-05-14T22:54:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwMjgyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzI5Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425307296", "bodyText": "We don't need to override pullSecrets since [] is already default", "author": "steven-sheehy", "createdAt": "2020-05-14T17:23:54Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -9,28 +30,66 @@ grpc:\n     create: false\n   serviceMonitor:\n     enabled: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/grpc\n+    <<: *versiontag\n+  service:\n+    type: LoadBalancer\n+\n importer:\n   podMonitor:\n     enabled: false\n+  priorityClassName: \"\"\n   rbac:\n     enabled: false\n   replicas: 1\n   serviceAccount:\n     create: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/importer\n+    <<: *versiontag\n+\n+labels: {}\n+\n loki:\n   enabled: false\n+\n+networkPolicy:\n+  enabled: false\n+\n postgresql:\n   metrics:\n     enabled: false\n   pgpool:\n+    priorityClassName: \"\"\n     replicaCount: 1\n+  postgresqlImage:\n+    registry: gcr.io\n+    repository: mirrornode/hedera-mirror-node/postgresql\n+    <<: *tracktag\n+    pullSecrets: []", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ3Njc0NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425476744", "bodyText": "Will remove. Was hitting issues on non defined pullSecrets previous to adding the merge logic, hence adding it.", "author": "Nana-EC", "createdAt": "2020-05-14T23:01:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzI5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzg1Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425307856", "bodyText": "There is no metrics section in values.yaml. This can be removed", "author": "steven-sheehy", "createdAt": "2020-05-14T17:24:52Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -41,5 +100,21 @@ rest:\n     create: false\n   serviceMonitor:\n     enabled: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/rest\n+    <<: *versiontag\n+  service:\n+    type: LoadBalancer\n+\n traefik:\n   enabled: false\n+  ports:\n+    web:\n+\n+metrics:", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4MjAwOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425582009", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-15T05:57:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwNzg1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwODkyOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425308929", "bodyText": "I don't think this section is necessary anymore now that you merge the yamls", "author": "steven-sheehy", "createdAt": "2020-05-14T17:26:36Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -9,28 +30,66 @@ grpc:\n     create: false\n   serviceMonitor:\n     enabled: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/grpc\n+    <<: *versiontag\n+  service:\n+    type: LoadBalancer\n+\n importer:\n   podMonitor:\n     enabled: false\n+  priorityClassName: \"\"\n   rbac:\n     enabled: false\n   replicas: 1\n   serviceAccount:\n     create: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/importer\n+    <<: *versiontag\n+\n+labels: {}\n+\n loki:\n   enabled: false\n+\n+networkPolicy:\n+  enabled: false\n+\n postgresql:\n   metrics:\n     enabled: false\n   pgpool:\n+    priorityClassName: \"\"\n     replicaCount: 1\n+  postgresqlImage:\n+    registry: gcr.io\n+    repository: mirrornode/hedera-mirror-node/postgresql\n+    <<: *tracktag\n+    pullSecrets: []\n   postgresql:\n+    priorityClassName: \"\"\n     replicaCount: 1\n+  pgpoolImage:\n+    registry: gcr.io\n+    repository: mirrornode/hedera-mirror-node/pgpool\n+    <<: *tracktag\n+    pullSecrets: []\n+\n prometheus-adapter:\n   enabled: false\n+\n prometheus:\n   enabled: false\n+  grafana:", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkwMjY1Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425902653", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-15T16:08:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwODkyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMDk4OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425310988", "bodyText": "This should be importer.image.repository. Same for next", "author": "steven-sheehy", "createdAt": "2020-05-14T17:29:40Z", "path": "hedera-mirror-gcp-marketplace/schema.yaml", "diffHunk": "@@ -0,0 +1,80 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      A mirror-node update.\n+    # releaseTypes list is optional. Feature | BugFix | Security\n+    # \"Security\" should only be used if this is an important update to patch\n+    # an existing vulnerability, as such updates will display more prominently for users.\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        mirrornode.image.repository:", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4MjA2Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425582062", "bodyText": "Updated", "author": "Nana-EC", "createdAt": "2020-05-15T05:57:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMDk4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMTE5MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425311191", "bodyText": "This section can be removed", "author": "steven-sheehy", "createdAt": "2020-05-14T17:29:59Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -1,4 +1,25 @@\n+applicationResource:\n+  enabled: true\n+  partnerId: hederaPartnerId\n+  partnerName: partner_name\n+  projectId: hederaMirrorSolutionId\n+\n+track-tag: &tracktag\n+  tag: 0.11.0\n+\n+version-tag: &versiontag\n+  tag: 0.11.0-rc1\n+\n+mirrornode:", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4MjE5MA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425582190", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-15T05:57:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMTE5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM1MjM1Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427352356", "bodyText": "Not removed", "author": "steven-sheehy", "createdAt": "2020-05-19T14:35:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMTE5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMjY5NQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425312695", "bodyText": "You shouldn't use track tags for image versions. Needs to be full version for all components.", "author": "steven-sheehy", "createdAt": "2020-05-14T17:32:34Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -1,4 +1,25 @@\n+applicationResource:\n+  enabled: true\n+  partnerId: hederaPartnerId\n+  partnerName: partner_name\n+  projectId: hederaMirrorSolutionId\n+\n+track-tag: &tracktag", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4MjI4Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425582282", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-15T05:57:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMjY5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMzU1OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425313558", "bodyText": "Not necessary with other changes", "author": "steven-sheehy", "createdAt": "2020-05-14T17:34:00Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -41,5 +100,21 @@ rest:\n     create: false\n   serviceMonitor:\n     enabled: false\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node/rest\n+    <<: *versiontag\n+  service:\n+    type: LoadBalancer\n+\n traefik:\n   enabled: false\n+  ports:", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4MjMyMg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425582322", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-15T05:58:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxMzU1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMyMjQxMQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r425322411", "bodyText": "These are already the default versions, not need to respecify them again in this file. Main thing is just that schema.yaml can override them, which you have. The only exception is postgresql as its version would differ from default", "author": "steven-sheehy", "createdAt": "2020-05-14T17:47:06Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -1,4 +1,25 @@\n+applicationResource:\n+  enabled: true\n+  partnerId: hederaPartnerId\n+  partnerName: partner_name\n+  projectId: hederaMirrorSolutionId\n+\n+track-tag: &tracktag\n+  tag: 0.11.0\n+\n+version-tag: &versiontag\n+  tag: 0.11.0-rc1", "originalCommit": "6189a45010b22513865d2f7aaf4ab6f30646311f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0288845c4a89ddc46e99dbba27157f90e021d0ba", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/0288845c4a89ddc46e99dbba27157f90e021d0ba", "message": "Made gcp marketplace a sub folder instead of a sub module\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-14T20:04:03Z", "type": "commit"}, {"oid": "b70a7975d05e5929ec0e1cc85b86a0f9c2757ca3", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/b70a7975d05e5929ec0e1cc85b86a0f9c2757ca3", "message": "Shared docker build logic and addressed some config modifications\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-14T20:31:20Z", "type": "commit"}, {"oid": "5c44fc6bda1f9eeefc3c401d6faaac93c1f44a9b", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/5c44fc6bda1f9eeefc3c401d6faaac93c1f44a9b", "message": "Cleaned up values and made docker file multi stage\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-15T05:46:36Z", "type": "commit"}, {"oid": "88fcc3e0ef423047cbd76e9f9ab000786c76ae36", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/88fcc3e0ef423047cbd76e9f9ab000786c76ae36", "message": "Remove latest tag and added password and replica properties to schema\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-15T23:25:59Z", "type": "commit"}, {"oid": "363f04d8cc90ea1185f1fcbc27e830eeec06e3f2", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/363f04d8cc90ea1185f1fcbc27e830eeec06e3f2", "message": "Added minor tag logic to circle ci and fixed main image and postgres pull\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-18T16:21:47Z", "type": "commit"}, {"oid": "2561e95bc4d5e83adbb5ac54bd32368a7b04f0c7", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/2561e95bc4d5e83adbb5ac54bd32368a7b04f0c7", "message": "Remove docker latest tag\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-18T22:35:31Z", "type": "commit"}, {"oid": "f009612b2d0bda6ed7038abb74541f641f6cd620", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/f009612b2d0bda6ed7038abb74541f641f6cd620", "message": "Signed-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>\nMerge branch 'master' into helm-deployer-image", "committedDate": "2020-05-18T22:36:06Z", "type": "commit"}, {"oid": "81efbfd985ad501adffbe51698c0e70b25c58c90", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/81efbfd985ad501adffbe51698c0e70b25c58c90", "message": " Add  minor flag to jib case also\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-19T03:27:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk1Mjg4Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r426952886", "bodyText": "Misspelled here and other places", "author": "steven-sheehy", "createdAt": "2020-05-18T23:51:40Z", "path": "charts/marketplace/gcp/schema.yaml", "diffHunk": "@@ -0,0 +1,141 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      Initial release of the Hedera Mirror Node\n+    # releaseTypes list is optional. Feature | BugFix | Security\n+    # \"Security\" should only be used if this is an important update to patch\n+    # an existing vulnerability, as such updates will display more prominently for users.\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        mirrornode.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        mirrornode.image.tag:\n+          type: TAG\n+    grpc:\n+      properties:\n+        grpc.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        grpc.image.tag:\n+          type: TAG\n+    rest:\n+      properties:\n+        rest.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        rest.image.tag:\n+          type: TAG\n+    postgresql:\n+      properties:\n+        postgresql.postgresqlImage.registry:\n+          type: REGISTRY\n+        postgresql.postgresqlImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.postgresqlImage.tag:\n+          type: TAG\n+    pgpool:\n+      properties:\n+        postgresql.pgpoolImage.registry:\n+          type: REGISTRY\n+        postgresql.pgpoolImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.pgpoolImage.tag:\n+          type: TAG\n+\n+  # Other fields, like clusterConstraints, can be included here.\n+\n+  # The Properties and Required sections of v2 are structured the same as those of v1.\n+  # IMPORTANT: These IDs must match your listing ID in Marketplace.\n+  partnerId: hederaPartnerId\n+  solutionId: hederaMirrorSolutionId\n+\n+properties:\n+  name:\n+    type: string\n+    x-google-marketplace:\n+      type: NAME\n+  namespace:\n+    type: string\n+    x-google-marketplace:\n+      type: NAMESPACE\n+  deployer.image:\n+    type: string\n+    x-google-marketplace:\n+      type: DEPLOYER_IMAGE\n+  grpc.config.hedera.mirror.grpc.db.password:\n+    type: string\n+    default: ''\n+    description: The grpc user password\n+    title: grpc user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  grpc.replicas:\n+    type: integer\n+    default: 1\n+    description: Number of grpc node replicas\n+    title: gRPC replicas\n+    minimun: 1\n+    maximum: 10\n+  importer.config.hedera.mirror.importer.db.password:\n+    type: string\n+    default: ''\n+    description: The importer user password\n+    title: importer user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  importer.replicas:\n+    type: integer\n+    default: 1\n+    description: Number of importer node replicas\n+    title: importer replicas\n+    minimun: 1", "originalCommit": "f009612b2d0bda6ed7038abb74541f641f6cd620", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQzNzg4MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427437881", "bodyText": "Fixed thanks", "author": "Nana-EC", "createdAt": "2020-05-19T16:30:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk1Mjg4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk1MzExMg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r426953112", "bodyText": "We should probably allow 0 min for rest and grpc replicas", "author": "steven-sheehy", "createdAt": "2020-05-18T23:52:27Z", "path": "charts/marketplace/gcp/schema.yaml", "diffHunk": "@@ -0,0 +1,141 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      Initial release of the Hedera Mirror Node\n+    # releaseTypes list is optional. Feature | BugFix | Security\n+    # \"Security\" should only be used if this is an important update to patch\n+    # an existing vulnerability, as such updates will display more prominently for users.\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        mirrornode.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        mirrornode.image.tag:\n+          type: TAG\n+    grpc:\n+      properties:\n+        grpc.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        grpc.image.tag:\n+          type: TAG\n+    rest:\n+      properties:\n+        rest.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        rest.image.tag:\n+          type: TAG\n+    postgresql:\n+      properties:\n+        postgresql.postgresqlImage.registry:\n+          type: REGISTRY\n+        postgresql.postgresqlImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.postgresqlImage.tag:\n+          type: TAG\n+    pgpool:\n+      properties:\n+        postgresql.pgpoolImage.registry:\n+          type: REGISTRY\n+        postgresql.pgpoolImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.pgpoolImage.tag:\n+          type: TAG\n+\n+  # Other fields, like clusterConstraints, can be included here.\n+\n+  # The Properties and Required sections of v2 are structured the same as those of v1.\n+  # IMPORTANT: These IDs must match your listing ID in Marketplace.\n+  partnerId: hederaPartnerId\n+  solutionId: hederaMirrorSolutionId\n+\n+properties:\n+  name:\n+    type: string\n+    x-google-marketplace:\n+      type: NAME\n+  namespace:\n+    type: string\n+    x-google-marketplace:\n+      type: NAMESPACE\n+  deployer.image:\n+    type: string\n+    x-google-marketplace:\n+      type: DEPLOYER_IMAGE\n+  grpc.config.hedera.mirror.grpc.db.password:\n+    type: string\n+    default: ''\n+    description: The grpc user password\n+    title: grpc user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  grpc.replicas:\n+    type: integer\n+    default: 1\n+    description: Number of grpc node replicas\n+    title: gRPC replicas\n+    minimun: 1", "originalCommit": "f009612b2d0bda6ed7038abb74541f641f6cd620", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQzNzk4MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427437981", "bodyText": "Good point.", "author": "Nana-EC", "createdAt": "2020-05-19T16:30:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk1MzExMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0NTE4Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427345183", "bodyText": "Can be removed", "author": "steven-sheehy", "createdAt": "2020-05-19T14:26:27Z", "path": ".gitignore", "diffHunk": "@@ -39,6 +39,7 @@ hedera-mirror-*/application.yml\n /db/\n *.log\n !/charts/**/*.tgz\n+hedera-mirror-gcp-marketplace/chart/", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQzODMwOA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427438308", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-19T16:31:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0NTE4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0NTY2Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427345663", "bodyText": "nit: Can remove and", "author": "steven-sheehy", "createdAt": "2020-05-19T14:27:06Z", "path": "charts/hedera-mirror/templates/NOTES.txt", "diffHunk": "@@ -1,5 +1,6 @@\n Hedera Mirror Node {{ .Chart.AppVersion }} successfully installed.\n \n+{{ if and .Values.traefik.enabled -}}", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQzODYyNg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427438626", "bodyText": "Removed", "author": "Nana-EC", "createdAt": "2020-05-19T16:31:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0NTY2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2MDM2Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427360363", "bodyText": "It doesn't make sense to have the deployer image in the values file as it is the deployer image itself that's running and inspecting the schema.yaml and values yaml. Also, I don't think it needs to be in the schema.yaml either for the same reason and because users don't need to edit it. I see it in some of the click-to-deploy apps but not in others like nginx.", "author": "steven-sheehy", "createdAt": "2020-05-19T14:44:54Z", "path": "charts/hedera-mirror/values-marketplace.yaml", "diffHunk": "@@ -1,36 +1,76 @@\n+applicationResource:\n+  enabled: true\n+  partnerId: hederaPartnerId\n+  partnerName: partner_name\n+  projectId: hederaMirrorSolutionId\n+\n+mirrornode:\n+  image:\n+    repository: gcr.io/mirrornode/hedera-mirror-node\n+\n+deployer:", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU0MTY4Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427541686", "bodyText": "Yeah as you saw some projects had it and others didn't. Did remove it though", "author": "Nana-EC", "createdAt": "2020-05-19T19:18:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2MDM2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2MzI3NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427363274", "bodyText": "To reduce the number of base images to download, can you just use gcr.io/cloud-marketplace-tools/k8s/deployer_helm here as well?", "author": "steven-sheehy", "createdAt": "2020-05-19T14:48:46Z", "path": "charts/marketplace/gcp/Dockerfile", "diffHunk": "@@ -0,0 +1,33 @@\n+FROM ubuntu:19.10 AS build", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1NTQxOA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427455418", "bodyText": "Will try this. Seeing issues pulling in yq as a result but will look into.\nMight have to get it via wget if it persists", "author": "Nana-EC", "createdAt": "2020-05-19T16:57:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2MzI3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2NTYyOQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427365629", "bodyText": "These two commands should be in build stage. You should also only copy the tgz and schema.yaml from build container instead of a directory. Can remove rm -r chart", "author": "steven-sheehy", "createdAt": "2020-05-19T14:51:40Z", "path": "charts/marketplace/gcp/Dockerfile", "diffHunk": "@@ -0,0 +1,33 @@\n+FROM ubuntu:19.10 AS build\n+\n+## pull in chart\n+COPY hedera-mirror /tmp/chart\n+\n+# get yq and merge values files\n+RUN apt-get update \\\n+    && apt-get install -y software-properties-common \\\n+    && add-apt-repository ppa:rmescandon/yq \\\n+    && apt-get install -y --no-install-recommends yq gettext-base\n+\n+RUN yq m -i --overwrite /tmp/chart/values.yaml /tmp/chart/values-marketplace.yaml\n+\n+# Pull in and update schema for marketplace deployer\n+ARG tag\n+COPY marketplace/gcp/schema.yaml /tmp/schema.yaml\n+RUN cat /tmp/schema.yaml \\\n+    | env -i \"TAG=$tag\" envsubst \\\n+    > /tmp/schema.yaml.new \\\n+    && mv /tmp/schema.yaml.new /tmp/schema.yaml\n+\n+# Setup marketplace structure on helm deployer image base\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm\n+COPY --from=build /tmp/ .\n+\n+# helm template to render and verify templates\n+RUN helm template chart -f chart/values.yaml", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ1NDc1NQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427454755", "bodyText": "Yeah moved them here cause I didn't want to have to install helm on the build image but that was probably the better approach.", "author": "Nana-EC", "createdAt": "2020-05-19T16:56:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2NTYyOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU0MjEzMQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427542131", "bodyText": "Moved into build container", "author": "Nana-EC", "createdAt": "2020-05-19T19:19:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2NTYyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2ODg5OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427368899", "bodyText": "Mentioned before, but this has to be importer.image.* to override the values.yaml", "author": "steven-sheehy", "createdAt": "2020-05-19T14:55:45Z", "path": "charts/marketplace/gcp/schema.yaml", "diffHunk": "@@ -0,0 +1,148 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      Initial release of the Hedera Mirror Node\n+    # releaseTypes list is optional. Feature | BugFix | Security\n+    # \"Security\" should only be used if this is an important update to patch\n+    # an existing vulnerability, as such updates will display more prominently for users.\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        mirrornode.image.repository:", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ3MTk4OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427471989", "bodyText": "Yeah, did change it and encountered an image pull issue on the pod. Left it as such to get through the other stuff. Was coming back to this.", "author": "Nana-EC", "createdAt": "2020-05-19T17:24:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2ODg5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU3OTA2OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427579069", "bodyText": "Fixed", "author": "Nana-EC", "createdAt": "2020-05-19T20:27:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2ODg5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2OTQ1Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427369452", "bodyText": "nit: Can remove comments", "author": "steven-sheehy", "createdAt": "2020-05-19T14:56:25Z", "path": "charts/marketplace/gcp/schema.yaml", "diffHunk": "@@ -0,0 +1,148 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      Initial release of the Hedera Mirror Node\n+    # releaseTypes list is optional. Feature | BugFix | Security\n+    # \"Security\" should only be used if this is an important update to patch\n+    # an existing vulnerability, as such updates will display more prominently for users.\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        mirrornode.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        mirrornode.image.tag:\n+          type: TAG\n+    grpc:\n+      properties:\n+        grpc.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        grpc.image.tag:\n+          type: TAG\n+    rest:\n+      properties:\n+        rest.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        rest.image.tag:\n+          type: TAG\n+    postgresql:\n+      properties:\n+        postgresql.postgresqlImage.registry:\n+          type: REGISTRY\n+        postgresql.postgresqlImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.postgresqlImage.tag:\n+          type: TAG\n+    pgpool:\n+      properties:\n+        postgresql.pgpoolImage.registry:\n+          type: REGISTRY\n+        postgresql.pgpoolImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.pgpoolImage.tag:\n+          type: TAG\n+\n+  # Other fields, like clusterConstraints, can be included here.", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ3NTkzMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427475933", "bodyText": "Removing unnecessary ones. Some comments contain good info to leave in there for reference", "author": "Nana-EC", "createdAt": "2020-05-19T17:30:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2OTQ1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM3MTQ2NQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427371465", "bodyText": "Use docker-maven-plugin.version", "author": "steven-sheehy", "createdAt": "2020-05-19T14:58:53Z", "path": "pom.xml", "diffHunk": "@@ -282,6 +277,44 @@\n                         </execution>\n                     </executions>\n                 </plugin>\n+                <plugin>\n+                    <groupId>io.fabric8</groupId>\n+                    <artifactId>docker-maven-plugin</artifactId>\n+                    <version>0.33.0</version>", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ3NjY2MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427476661", "bodyText": "Will updated", "author": "Nana-EC", "createdAt": "2020-05-19T17:31:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM3MTQ2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM3MzUwMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427373503", "bodyText": "Can remove version if in parent pluginManagement", "author": "steven-sheehy", "createdAt": "2020-05-19T15:01:33Z", "path": "hedera-mirror-rest/pom.xml", "diffHunk": "@@ -20,34 +20,6 @@\n                 <groupId>io.fabric8</groupId>\n                 <artifactId>docker-maven-plugin</artifactId>\n                 <version>${docker-maven-plugin.version}</version>", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ3NzgzNg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427477836", "bodyText": "Will remove", "author": "Nana-EC", "createdAt": "2020-05-19T17:32:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM3MzUwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM4Njg4NA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427386884", "bodyText": "We do want to cache.  We build locally and don't want to have to re-download node_modules all the time.", "author": "steven-sheehy", "createdAt": "2020-05-19T15:19:11Z", "path": "pom.xml", "diffHunk": "@@ -282,6 +277,44 @@\n                         </execution>\n                     </executions>\n                 </plugin>\n+                <plugin>\n+                    <groupId>io.fabric8</groupId>\n+                    <artifactId>docker-maven-plugin</artifactId>\n+                    <version>0.33.0</version>\n+                    <executions>\n+                        <execution>\n+                            <id>dockerBuild</id>\n+                            <goals>\n+                                <goal>build</goal>\n+                            </goals>\n+                        </execution>\n+                        <execution>\n+                            <id>dockerPush</id>\n+                            <goals>\n+                                <goal>push</goal>\n+                            </goals>\n+                        </execution>\n+                    </executions>\n+                    <configuration>\n+                        <images>\n+                            <image>\n+                                <external>\n+                                    <type>properties</type>\n+                                    <prefix>docker</prefix>\n+                                    <mode>override</mode>\n+                                </external>\n+                                <build>\n+                                    <contextDir>${project.basedir}</contextDir>\n+                                    <assembly>\n+                                        <exportTargetDir>false</exportTargetDir>\n+                                    </assembly>\n+                                    <noCache>true</noCache>", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ3NzkzMw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427477933", "bodyText": "Gotcha, will revert", "author": "Nana-EC", "createdAt": "2020-05-19T17:32:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM4Njg4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM4NzQ2OQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427387469", "bodyText": "docker.tag.latest was removed in pom. This needs to be adjusted somehow", "author": "steven-sheehy", "createdAt": "2020-05-19T15:19:54Z", "path": ".circleci/config.yml", "diffHunk": "@@ -376,6 +376,13 @@ jobs:\n             if [ \"$CIRCLE_BRANCH\" = \"master\" ]; then\n                 DOCKER_TAG_OVERRIDE=\"-Ddocker.tag.version=${CIRCLE_BRANCH}-${CIRCLE_SHA1} -Ddocker.tag.latest=master\"", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQ3ODk5Mg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427478992", "bodyText": "Changing to -Ddocker.tags.0=master -Djib.to.tags=master\"", "author": "Nana-EC", "createdAt": "2020-05-19T17:34:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM4NzQ2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM5NzcxOA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427397718", "bodyText": "Unfortunately, we also have to set importer.config.hedera.mirror.importer.db.restPassword. Is there a way to set multiple values from the same user input?", "author": "steven-sheehy", "createdAt": "2020-05-19T15:33:28Z", "path": "charts/marketplace/gcp/schema.yaml", "diffHunk": "@@ -0,0 +1,148 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      Initial release of the Hedera Mirror Node\n+    # releaseTypes list is optional. Feature | BugFix | Security\n+    # \"Security\" should only be used if this is an important update to patch\n+    # an existing vulnerability, as such updates will display more prominently for users.\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        mirrornode.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        mirrornode.image.tag:\n+          type: TAG\n+    grpc:\n+      properties:\n+        grpc.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        grpc.image.tag:\n+          type: TAG\n+    rest:\n+      properties:\n+        rest.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        rest.image.tag:\n+          type: TAG\n+    postgresql:\n+      properties:\n+        postgresql.postgresqlImage.registry:\n+          type: REGISTRY\n+        postgresql.postgresqlImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.postgresqlImage.tag:\n+          type: TAG\n+    pgpool:\n+      properties:\n+        postgresql.pgpoolImage.registry:\n+          type: REGISTRY\n+        postgresql.pgpoolImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.pgpoolImage.tag:\n+          type: TAG\n+\n+  # Other fields, like clusterConstraints, can be included here.\n+\n+  # The Properties and Required sections of v2 are structured the same as those of v1.\n+  # IMPORTANT: These IDs must match your listing ID in Marketplace.\n+  partnerId: hederaPartnerId\n+  solutionId: hederaMirrorSolutionId\n+\n+properties:\n+  name:\n+    type: string\n+    x-google-marketplace:\n+      type: NAME\n+  namespace:\n+    type: string\n+    x-google-marketplace:\n+      type: NAMESPACE\n+  deployer.image:\n+    type: string\n+    x-google-marketplace:\n+      type: DEPLOYER_IMAGE\n+  grpc.config.hedera.mirror.grpc.db.password:\n+    type: string\n+    default: ''\n+    description: The grpc user password\n+    title: grpc user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  grpc.replicas:\n+    type: integer\n+    default: 1\n+    description: Number of grpc node replicas\n+    title: gRPC replicas\n+    minimun: 1\n+    maximum: 10\n+  importer.config.hedera.mirror.importer.db.password:\n+    type: string\n+    default: ''\n+    description: The importer user password\n+    title: importer user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  importer.replicas:\n+    type: integer\n+    default: 1\n+    description: Number of importer node replicas\n+    title: importer replicas\n+    minimun: 1\n+    maximum: 10\n+  postgresql.pgpool.replicaCount:\n+    type: integer\n+    default: 1\n+    description: Number of pgpool node replicas\n+    title: pgpool replicas\n+    minimun: 1\n+    maximum: 10\n+  postgresql.postgresql.replicaCount:\n+    type: integer\n+    default: 1\n+    description: Number of postgres node replicas\n+    title: pgpool replicas\n+    minimun: 1\n+    maximum: 10\n+  postgresql.postgresql.repmgrPassword:\n+    type: string\n+    default: ''\n+    description: The repmgr user password\n+    title: repmgr user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  rest.config.hedera.mirror.rest.db.password:", "originalCommit": "81efbfd985ad501adffbe51698c0e70b25c58c90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUyMTgwMA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427521800", "bodyText": "Will set and look into if multiple values is possible", "author": "Nana-EC", "createdAt": "2020-05-19T18:44:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM5NzcxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU0ODgzNA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427548834", "bodyText": "My understandings each of these shows up as a field in marketplace for customization.\nSo I don't think the intent is to have them ever combined in the same input\nI'm sure these guys would have loved to have grouped some properties\nhttps://github.com/GoogleCloudPlatform/click-to-deploy/blob/master/k8s/wordpress/schema.yaml\nhttps://github.com/Dynatrace/helm-charts/blob/master/dynatrace-oneagent-operator-google-marketplace/schema.yaml\nCan always come back and simplify it later if I find a way", "author": "Nana-EC", "createdAt": "2020-05-19T19:30:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM5NzcxOA=="}], "type": "inlineReview"}, {"oid": "9958f1743264435100a779aeff85ede01507db56", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/9958f1743264435100a779aeff85ede01507db56", "message": "Use postgresql-repmgr naming\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-19T16:05:50Z", "type": "commit"}, {"oid": "b4d52f83678e3087696bfb5df43342e813075d12", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/b4d52f83678e3087696bfb5df43342e813075d12", "message": "Addressed feedback\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-19T18:55:50Z", "type": "commit"}, {"oid": "137a60e9c90d3986d6ab82ccac79b7c28bc47c70", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/137a60e9c90d3986d6ab82ccac79b7c28bc47c70", "message": "Removed mirrornode property in place of importer\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-19T20:26:39Z", "type": "commit"}, {"oid": "6a3d297ed554d17f7dd97522bc5206b932545622", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/6a3d297ed554d17f7dd97522bc5206b932545622", "message": "Pull amd64 not 386 yq binary\n\nSigned-off-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>", "committedDate": "2020-05-19T20:37:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU4MjQzOA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427582438", "bodyText": "Can move values-marketplace.yaml to charts/marketplace/gcp/values.yaml in follow up", "author": "steven-sheehy", "createdAt": "2020-05-19T20:33:36Z", "path": "charts/marketplace/gcp/Dockerfile", "diffHunk": "@@ -0,0 +1,29 @@\n+# build image to format chart structure and verify templates\n+FROM gcr.io/cloud-marketplace-tools/k8s/deployer_helm AS build\n+\n+# pull in chart\n+COPY hedera-mirror /tmp/chart\n+\n+# get yq and merge values files\n+RUN wget https://github.com/mikefarah/yq/releases/download/2.4.0/yq_linux_386 \\\n+    && mv yq_linux_386 /usr/local/bin/yq \\\n+    && chmod +x /usr/local/bin/yq\n+\n+RUN yq m -i --overwrite /tmp/chart/values.yaml /tmp/chart/values-marketplace.yaml", "originalCommit": "137a60e9c90d3986d6ab82ccac79b7c28bc47c70", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU4NDQ0MQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427584441", "bodyText": "dc -> database", "author": "steven-sheehy", "createdAt": "2020-05-19T20:37:22Z", "path": "charts/marketplace/gcp/schema.yaml", "diffHunk": "@@ -0,0 +1,152 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      Initial release of the Hedera Mirror Node\n+    # releaseTypes - Feature | BugFix | Security\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        importer.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        importer.image.tag:\n+          type: TAG\n+    grpc:\n+      properties:\n+        grpc.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        grpc.image.tag:\n+          type: TAG\n+    rest:\n+      properties:\n+        rest.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        rest.image.tag:\n+          type: TAG\n+    postgresql-repmgr:\n+      properties:\n+        postgresql.postgresqlImage.registry:\n+          type: REGISTRY\n+        postgresql.postgresqlImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.postgresqlImage.tag:\n+          type: TAG\n+    pgpool:\n+      properties:\n+        postgresql.pgpoolImage.registry:\n+          type: REGISTRY\n+        postgresql.pgpoolImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.pgpoolImage.tag:\n+          type: TAG\n+\n+  # Other fields, like clusterConstraints, can be included here.\n+\n+  # The Properties and Required sections of v2 are structured the same as those of v1.\n+  # IMPORTANT: These IDs must match your listing ID in Marketplace.\n+  partnerId: hederaPartnerId\n+  solutionId: hederaMirrorSolutionId\n+\n+properties:\n+  name:\n+    type: string\n+    x-google-marketplace:\n+      type: NAME\n+  namespace:\n+    type: string\n+    x-google-marketplace:\n+      type: NAMESPACE\n+  deployer.image:\n+    type: string\n+    x-google-marketplace:\n+      type: DEPLOYER_IMAGE\n+  grpc.config.hedera.mirror.grpc.db.password:\n+    type: string\n+    default: ''\n+    description: The grpc user password\n+    title: grpc user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  grpc.replicas:\n+    type: integer\n+    default: 1\n+    description: Number of grpc node replicas\n+    title: gRPC replicas\n+    minimum: 0\n+    maximum: 10\n+  importer.config.hedera.mirror.importer.db.password:\n+    type: string\n+    default: ''\n+    description: The importer user password\n+    title: importer user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  importer.config.hedera.mirror.importer.db.restPassword:\n+    type: string\n+    default: ''\n+    description: The importer dc rest user password", "originalCommit": "137a60e9c90d3986d6ab82ccac79b7c28bc47c70", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU4NTE2Ng==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/740#discussion_r427585166", "bodyText": "Would like all these titles to use proper casing since it appears in front of users: REST API database password", "author": "steven-sheehy", "createdAt": "2020-05-19T20:38:44Z", "path": "charts/marketplace/gcp/schema.yaml", "diffHunk": "@@ -0,0 +1,152 @@\n+x-google-marketplace:\n+  schemaVersion: v2\n+\n+  applicationApiVersion: v1beta1\n+\n+  # The release version, MUST match the release tag on the the deployer.\n+  publishedVersion: \"$TAG\"\n+  publishedVersionMetadata:\n+    releaseNote: >-\n+      Initial release of the Hedera Mirror Node\n+    # releaseTypes - Feature | BugFix | Security\n+    releaseTypes:\n+      - Feature\n+    # If \"recommended\" is \"true\", users using older releases are encouraged\n+    # to update as soon as possible. This is useful if, for example, this release\n+    # fixes a critical issue.\n+    recommended: false\n+\n+  # images for subcharts. Primary image is importer\n+  images:\n+    '':\n+      properties:\n+        importer.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        importer.image.tag:\n+          type: TAG\n+    grpc:\n+      properties:\n+        grpc.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        grpc.image.tag:\n+          type: TAG\n+    rest:\n+      properties:\n+        rest.image.repository:\n+          type: REPO_WITH_REGISTRY\n+        rest.image.tag:\n+          type: TAG\n+    postgresql-repmgr:\n+      properties:\n+        postgresql.postgresqlImage.registry:\n+          type: REGISTRY\n+        postgresql.postgresqlImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.postgresqlImage.tag:\n+          type: TAG\n+    pgpool:\n+      properties:\n+        postgresql.pgpoolImage.registry:\n+          type: REGISTRY\n+        postgresql.pgpoolImage.repository:\n+          type: REPO_WITHOUT_REGISTRY\n+        postgresql.pgpoolImage.tag:\n+          type: TAG\n+\n+  # Other fields, like clusterConstraints, can be included here.\n+\n+  # The Properties and Required sections of v2 are structured the same as those of v1.\n+  # IMPORTANT: These IDs must match your listing ID in Marketplace.\n+  partnerId: hederaPartnerId\n+  solutionId: hederaMirrorSolutionId\n+\n+properties:\n+  name:\n+    type: string\n+    x-google-marketplace:\n+      type: NAME\n+  namespace:\n+    type: string\n+    x-google-marketplace:\n+      type: NAMESPACE\n+  deployer.image:\n+    type: string\n+    x-google-marketplace:\n+      type: DEPLOYER_IMAGE\n+  grpc.config.hedera.mirror.grpc.db.password:\n+    type: string\n+    default: ''\n+    description: The grpc user password\n+    title: grpc user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  grpc.replicas:\n+    type: integer\n+    default: 1\n+    description: Number of grpc node replicas\n+    title: gRPC replicas\n+    minimum: 0\n+    maximum: 10\n+  importer.config.hedera.mirror.importer.db.password:\n+    type: string\n+    default: ''\n+    description: The importer user password\n+    title: importer user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  importer.config.hedera.mirror.importer.db.restPassword:\n+    type: string\n+    default: ''\n+    description: The importer dc rest user password\n+    title: importer db rest user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  importer.replicas:\n+    type: integer\n+    default: 1\n+    description: Number of importer node replicas\n+    title: importer replicas\n+    minimum: 1\n+    maximum: 10\n+  postgresql.pgpool.replicaCount:\n+    type: integer\n+    default: 1\n+    description: Number of pgpool node replicas\n+    title: pgpool replicas\n+    minimum: 1\n+    maximum: 10\n+  postgresql.postgresql.replicaCount:\n+    type: integer\n+    default: 1\n+    description: Number of postgres node replicas\n+    title: pgpool replicas\n+    minimum: 1\n+    maximum: 10\n+  postgresql.postgresql.repmgrPassword:\n+    type: string\n+    default: ''\n+    description: The repmgr user password\n+    title: repmgr user password\n+    x-google-marketplace:\n+      type: MASKED_FIELD\n+  rest.config.hedera.mirror.rest.db.password:\n+    type: string\n+    default: ''\n+    description: The rest user password\n+    title: rest user password", "originalCommit": "137a60e9c90d3986d6ab82ccac79b7c28bc47c70", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}