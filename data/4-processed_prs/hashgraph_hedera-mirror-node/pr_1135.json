{"pr_number": 1135, "pr_title": "HTS REST Performance Tests", "pr_createdAt": "2020-10-16T06:20:12Z", "pr_url": "https://github.com/hashgraph/hedera-mirror-node/pull/1135", "timeline": [{"oid": "e23af388bb4dc6b864581d2e6e90820f7eed5317", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/e23af388bb4dc6b864581d2e6e90820f7eed5317", "message": "Add performance rest tests for /tokens\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-16T06:14:46Z", "type": "commit"}, {"oid": "8c63741932547ea51bfde64fd7278bd80ec2f168", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/8c63741932547ea51bfde64fd7278bd80ec2f168", "message": "Add very rough draft of token balances perf test\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-20T06:54:23Z", "type": "commit"}, {"oid": "8f463621f525035d1df1e5fcacf12c9be6c65862", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/8f463621f525035d1df1e5fcacf12c9be6c65862", "message": "Merge branch 'master' into hts_rest_performance_tests", "committedDate": "2020-10-20T17:40:04Z", "type": "commit"}, {"oid": "b342749e071b968f4d308cf9050236e447577c5b", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/b342749e071b968f4d308cf9050236e447577c5b", "message": "Add HTS Performance jmeter tests (#1134)\n    - Add test to publish batches of token transfers and later retrieve via REST\n    - Add test to publish and immediately retrieve token transfers via REST\n    - Add k8s manifests to run tests\n    - Update documentation with new tests\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-21T03:39:50Z", "type": "commit"}, {"oid": "f17cbbb8ec388f397444fefa7222706ed7c503b9", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/f17cbbb8ec388f397444fefa7222706ed7c503b9", "message": "Merge branch 'master' into hts_rest_performance_tests", "committedDate": "2020-10-21T16:17:08Z", "type": "commit"}, {"oid": "5bca282cc320432f90d9da30423117962e6d6295", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/5bca282cc320432f90d9da30423117962e6d6295", "message": "Refactor REST perf tests to be cleaner and less duplicate code, and add test for token info\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-21T17:55:10Z", "type": "commit"}, {"oid": "ba342ab2196ad6637fef3fb6aad3c786b697f45f", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/ba342ab2196ad6637fef3fb6aad3c786b697f45f", "message": "Merge branch 'master' into hts_rest_performance_tests", "committedDate": "2020-10-21T17:59:14Z", "type": "commit"}, {"oid": "92f4631fb9a3e6989553e312e5a31c512cedeb84", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/92f4631fb9a3e6989553e312e5a31c512cedeb84", "message": "Add documentation for new test format\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-21T19:47:59Z", "type": "commit"}, {"oid": "7decf4dd3c88ea44981b165cffb23f4ae0ddfa3f", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/7decf4dd3c88ea44981b165cffb23f4ae0ddfa3f", "message": "Merge branch 'hts_rest_performance_tests' of github.com:hashgraph/hedera-mirror-node into hts_rest_performance_tests", "committedDate": "2020-10-21T19:48:07Z", "type": "commit"}, {"oid": "25aaddfbd3e54ba72c222cccbf880507243dcad3", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/25aaddfbd3e54ba72c222cccbf880507243dcad3", "message": "Reword readme\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-21T19:52:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM0NTYyMQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1135#discussion_r510345621", "bodyText": "Leftover log?", "author": "steven-sheehy", "createdAt": "2020-10-22T17:44:24Z", "path": "hedera-mirror-rest/__performancetests__/generateQuerySets.js", "diffHunk": "@@ -151,6 +170,34 @@ const makeQuerySet = async (test) => {\n   };\n };\n \n+const makeIdsQuerySet = async (test) => {\n+  let idValues;\n+  if (test.idAxis === 'TOKENID') {\n+    idValues = await populateIdValues(test, sampleTokenIds, (sample) => {\n+      return '' + sample;\n+    });\n+  }\n+  console.log('Here there be ' + idValues);", "originalCommit": "25aaddfbd3e54ba72c222cccbf880507243dcad3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MDcwMg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1135#discussion_r511150702", "bodyText": "Yep, removed.", "author": "ijungmann", "createdAt": "2020-10-23T20:54:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDM0NTYyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQyNzQ0Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1135#discussion_r510427443", "bodyText": "I believe this should also cover the ACCOUNTID also right?\nYou could add that case", "author": "Nana-EC", "createdAt": "2020-10-22T20:10:13Z", "path": "hedera-mirror-rest/__performancetests__/generateQuerySets.js", "diffHunk": "@@ -151,6 +170,34 @@ const makeQuerySet = async (test) => {\n   };\n };\n \n+const makeIdsQuerySet = async (test) => {\n+  let idValues;\n+  if (test.idAxis === 'TOKENID') {", "originalCommit": "25aaddfbd3e54ba72c222cccbf880507243dcad3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MDc3Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1135#discussion_r511150773", "bodyText": "Correct, I have added that", "author": "ijungmann", "createdAt": "2020-10-23T20:54:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQyNzQ0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQyNzk2Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1135#discussion_r510427963", "bodyText": "With the added logic you can also support e.g.\n- name: 'account transactions - accountid point lookup'\n     query: '/accounts/%d'\n\t idAxis: ACCOUNTID\n     count: 100", "author": "Nana-EC", "createdAt": "2020-10-22T20:11:04Z", "path": "hedera-mirror-rest/__performancetests__/tests.yml", "diffHunk": "@@ -72,3 +72,23 @@ tests:\n     filterAxis: BALANCE\n     count: 100\n     rangeTinyHbars: 1000_00_000_000 # 1000\u210f\n+    # Tests for /tokens\n+  - name: 'tokens - tokenid point lookup'\n+    query: '/tokens'\n+    filterAxis: TOKENID\n+    count: 100\n+  - name: 'tokens - token ids range (100)'\n+    query: '/tokens'\n+    filterAxis: TOKENID\n+    count: 5\n+    rangeNumTokens: 100\n+    # Tests for /tokens/{id}\n+  - name: 'token info - tokenid point lookup'\n+    query: '/tokens/%d'", "originalCommit": "25aaddfbd3e54ba72c222cccbf880507243dcad3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1MDY1NQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1135#discussion_r511150655", "bodyText": "Good call, added", "author": "ijungmann", "createdAt": "2020-10-23T20:53:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQyNzk2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQyOTQ4NQ==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1135#discussion_r510429485", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            -   `idAxis` is the primary axis to filter results based on ids (e.g. `/tokens/{id}`).  It can only have one value.\n          \n          \n            \n            -   `idAxis` is the primary axis to filter results based on ids in the query path (e.g. `/tokens/{id}`).  It can only have one value.", "author": "Nana-EC", "createdAt": "2020-10-22T20:13:47Z", "path": "docs/testing.md", "diffHunk": "@@ -47,16 +48,20 @@ Where\n -   `name` is user defined name for the test\n -   `query` is any arbitrary REST query. \\\n     It should NOT include `http://host:port/api/v1` as prefix. It should also NOT include param set by `filterAxis`.\n--   `filterAxis` is primary axis to filter results. It can have one of the three values:\n+-   `filterAxis` is primary axis to filter results based on query params. It can have one of the four values.  Either it or `idAxis` are required:\n     -   `ACCOUNTID`: Sets `account.id` param. Values for this param are sampled from `entity_num` column in `t_entities`.\n     -   `CONSENSUS_TIMESTAMP`: Sets `timestamp` param. Values for this param are sampled from `consensus_ns` column in\n         `transaction`.\n     -   `BALANCE`: Sets `account.balance` param. Values for this param are sampled from `balance` column in\n         `account_balance`.\n+    -   `TOKENID`: Sets `token.id` param. Values for this param are sampled from `token_id` column in `token`.\n+-   `idAxis` is the primary axis to filter results based on ids (e.g. `/tokens/{id}`).  It can only have one value.", "originalCommit": "25aaddfbd3e54ba72c222cccbf880507243dcad3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0a81fce16753a1623f48f4277f5fad822eee08a8", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/0a81fce16753a1623f48f4277f5fad822eee08a8", "message": "Add perf test for account transaction, and remove temp logging\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-23T20:53:32Z", "type": "commit"}, {"oid": "262b04a8b20d97639164d84b9724419f8540cc19", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/262b04a8b20d97639164d84b9724419f8540cc19", "message": "Update testing documentation\n\nCo-authored-by: Nana-EC <56320167+Nana-EC@users.noreply.github.com>\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-23T20:55:00Z", "type": "commit"}, {"oid": "731961b346d62a0725b398f3b5ddc6c73c4122b9", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/731961b346d62a0725b398f3b5ddc6c73c4122b9", "message": "Add new idAxis to testing document\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-23T20:56:51Z", "type": "commit"}, {"oid": "d08d0ad282c8c6851726861e692495c3ec0a1119", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/d08d0ad282c8c6851726861e692495c3ec0a1119", "message": "Add new idAxis to testing document\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-23T20:57:49Z", "type": "commit"}, {"oid": "00e46bac158bd6f9f5c11f1cbe7d0cdf1e09b293", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/00e46bac158bd6f9f5c11f1cbe7d0cdf1e09b293", "message": "Correct error missing else in if, else if statement\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-26T14:57:27Z", "type": "commit"}, {"oid": "59bced4e9717a779ad33d0e38bd21f6733753b03", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/59bced4e9717a779ad33d0e38bd21f6733753b03", "message": "Correct error missing else in if, else if statement\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-26T14:57:27Z", "type": "forcePushed"}, {"oid": "00e46bac158bd6f9f5c11f1cbe7d0cdf1e09b293", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/00e46bac158bd6f9f5c11f1cbe7d0cdf1e09b293", "message": "Correct error missing else in if, else if statement\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-10-26T14:57:27Z", "type": "forcePushed"}]}