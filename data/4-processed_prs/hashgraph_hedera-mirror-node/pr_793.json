{"pr_number": 793, "pr_title": "GCP Requester Pays - add project id config", "pr_createdAt": "2020-05-29T03:53:48Z", "pr_url": "https://github.com/hashgraph/hedera-mirror-node/pull/793", "timeline": [{"oid": "402ff94a84ec73819529ebb95b6de7e81c7679c3", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/402ff94a84ec73819529ebb95b6de7e81c7679c3", "message": "GCP Requester Pays - add project id config\n\n- Remove test specific configuration in CommonDownloaderProperties\n- Remove hard-coded testing value in prod code. Was used for local testing with mock S3.\n- Additionally, `endpointOverride` config makes it possible to run mirrornode with any S3\n  compatible cloud storage system, not just S3 and GCS. It can be azure, wasabi, etc\n- Tested with mainnet bucket and my personal GCP account's keys.\n\nSigned-off-by: Apekshit Sharma <apekshit.sharma@hedera.com>", "committedDate": "2020-05-29T03:50:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU0OTc1MA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/793#discussion_r432549750", "bodyText": "Need to remove LOCAL", "author": "steven-sheehy", "createdAt": "2020-05-29T15:06:50Z", "path": "docs/configuration.md", "diffHunk": "@@ -39,6 +39,8 @@ value, it is recommended to only populate overridden properties in the custom `a\n | `hedera.mirror.importer.downloader.balance.threads`                  | 13                      | The number of threads to search for new files to download                                      |\n | `hedera.mirror.importer.downloader.bucketName`                       | \"hedera-demo-streams\"   | The cloud storage bucket name to download streamed files                                       |\n | `hedera.mirror.importer.downloader.cloudProvider`                    | S3                      | The cloud provider to download files from. Either `S3`, `GCP` or `LOCAL`                       |", "originalCommit": "402ff94a84ec73819529ebb95b6de7e81c7679c3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY1NzA4OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/793#discussion_r432657088", "bodyText": "q: should the region be parametized, with the above as default of course.", "author": "Nana-EC", "createdAt": "2020-05-29T18:16:37Z", "path": "hedera-mirror-importer/src/main/java/com/hedera/mirror/importer/config/MirrorImporterConfiguration.java", "diffHunk": "@@ -67,47 +71,63 @@ LeaderAspect leaderAspect() {\n     }\n \n     @Bean\n-    public S3AsyncClient s3AsyncClient(ExecutionInterceptor metricsExecutionInterceptor) {\n+    @ConditionalOnProperty(prefix = \"hedera.mirror.importer.downloader\", name = \"cloudProvider\", havingValue = \"GCP\")\n+    public S3AsyncClient gcpCloudStorageClient() {\n+        log.info(\"Configured to download from GCP with bucket name '{}'\", downloaderProperties.getBucketName());\n+        // Any valid region for aws client. Ignored by GCP.\n+        S3AsyncClientBuilder clientBuilder = asyncClientBuilder(\"us-east-1\")", "originalCommit": "402ff94a84ec73819529ebb95b6de7e81c7679c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MTI4OA==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/793#discussion_r432661288", "bodyText": "this is just dummy value since aws sdk needs a non-null value. its ignored by gcp.", "author": "apeksharma", "createdAt": "2020-05-29T18:24:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY1NzA4OA=="}], "type": "inlineReview"}]}