{"pr_number": 8460, "pr_title": "Mask user info on materials tab on pipeline config spa", "pr_createdAt": "2020-08-14T05:03:06Z", "pr_url": "https://github.com/gocd/gocd/pull/8460", "timeline": [{"oid": "dacc77d19d5d8ab3a34f8e5bbfcfcb3a60b3e5c0", "url": "https://github.com/gocd/gocd/commit/dacc77d19d5d8ab3a34f8e5bbfcfcb3a60b3e5c0", "message": "Use url-parse library to mask user-info (if present) on the materials tab", "committedDate": "2020-08-14T05:06:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQxNDQzNQ==", "url": "https://github.com/gocd/gocd/pull/8460#discussion_r470414435", "bodyText": "how about renaming the method name urlForDisplay?\n\n\nHow about simplifying the above code as:\n\n\nfunction urlForDisplay(url?: string) {\n  if (!url) { return undefined;}\n\n  const parsed = urlParse(url, {});\n  // do not mask passwords\n  if (_.isEmpty(parsed.auth) || parsed.protocol.includes('ssh') || parsed.protocol.includes('svn+ssh')) {\n    return parsed.href;\n  }\n\n  if (parsed.auth.includes(\":\")) {\n    // mask password when username and password is provided as username:password@url\n    parsed.set('password', '******');\n  } else {\n    // mask token when credentials are provided as token@url\n    parsed.set('username', '******');\n  }\n\n  return parsed.href;\n}", "author": "GaneshSPatil", "createdAt": "2020-08-14T05:15:49Z", "path": "server/src/main/webapp/WEB-INF/rails/webpack/models/materials/types.ts", "diffHunk": "@@ -51,6 +51,24 @@ export const mapTypeToDisplayType: { [key: string]: string; } = {\n   plugin:     \"Plugin\"\n };\n \n+function clean(url?: string) {\n+  if (!url) {\n+    return url;\n+  }\n+  const parsedUrl = urlParse(url, {});\n+  if (!_.isEmpty(parsedUrl.auth)) {\n+    if (parsedUrl.auth.includes(\":\")) {\n+      parsedUrl.set('password', '******');\n+      return parsedUrl.href;\n+    }\n+    if (parsedUrl.protocol.includes('ssh') || parsedUrl.protocol.includes('svn+ssh')) {\n+      return parsedUrl.href;\n+    }\n+    parsedUrl.set('username', '******');\n+  }\n+  return parsedUrl.href;\n+}\n+", "originalCommit": "dacc77d19d5d8ab3a34f8e5bbfcfcb3a60b3e5c0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d7524a78198207cdb6afa44724ed0cce4d45c896", "url": "https://github.com/gocd/gocd/commit/d7524a78198207cdb6afa44724ed0cce4d45c896", "message": "Use url-parse library to mask user-info (if present) on the materials tab", "committedDate": "2020-08-14T05:21:29Z", "type": "commit"}, {"oid": "d7524a78198207cdb6afa44724ed0cce4d45c896", "url": "https://github.com/gocd/gocd/commit/d7524a78198207cdb6afa44724ed0cce4d45c896", "message": "Use url-parse library to mask user-info (if present) on the materials tab", "committedDate": "2020-08-14T05:21:29Z", "type": "forcePushed"}]}