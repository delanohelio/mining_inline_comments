{"pr_number": 2862, "pr_title": "Implemented QuantityScrutinizer tests using Mocks", "pr_createdAt": "2020-07-02T16:35:54Z", "pr_url": "https://github.com/OpenRefine/OpenRefine/pull/2862", "timeline": [{"oid": "343831ccb21905f38bcf4533a920a3688a2b5e90", "url": "https://github.com/OpenRefine/OpenRefine/commit/343831ccb21905f38bcf4533a920a3688a2b5e90", "message": "Implemented QunatityScrutinizer tests using Mockito\n\nUpdated test cases and added AllowedUnitsConstraint class", "committedDate": "2020-07-02T14:52:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIyMTg0NA==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2862#discussion_r449221844", "bodyText": "Why did you need to change this value? Isn't this changing the meaning of the tests below?", "author": "wetneb", "createdAt": "2020-07-02T19:20:16Z", "path": "extensions/wikidata/tests/src/org/openrefine/wikidata/qa/scrutinizers/QuantityScrutinizerTest.java", "diffHunk": "@@ -24,10 +42,17 @@\n             new BigDecimal(\"1.545\"));\n     \n     private QuantityValue wrongUnitValue = Datamodel.makeQuantityValue(\n-            new BigDecimal(\"1.234\"), \"Q346721\");\n+            new BigDecimal(\"2\"), \"Q346721\");", "originalCommit": "c9ed61efdaf64adf66248f439debae5882b4eb94", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTIyMjI0Ng==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2862#discussion_r449222246", "bodyText": "It would be better to reuse the constant declared in the scrutinizer, NO_BOUNDS_CONSTRAINT_QID (and same for all other tests).", "author": "wetneb", "createdAt": "2020-07-02T19:21:15Z", "path": "extensions/wikidata/tests/src/org/openrefine/wikidata/qa/scrutinizers/QuantityScrutinizerTest.java", "diffHunk": "@@ -36,67 +61,190 @@ public EditScrutinizer getScrutinizer() {\n     \n     @Test\n     public void testBoundsAllowed() {\n-        scrutinize(valueWithBounds);\n+        ItemIdValue idA = TestingData.existingId;\n+        Snak mainSnak = Datamodel.makeSomeValueSnak(propertyIdValue);\n+        Statement statement = new StatementImpl(\"P1083\", mainSnak, idA);\n+        ItemUpdate update = new ItemUpdateBuilder(idA).addStatement(statement).build();\n+\n+        ConstraintFetcher fetcher = mock(ConstraintFetcher.class);\n+        when(fetcher.getConstraintsByType(propertyIdValue, \"Q51723761\")).thenReturn(new ArrayList<>());", "originalCommit": "c9ed61efdaf64adf66248f439debae5882b4eb94", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTM5MDQwNA==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2862#discussion_r449390404", "bodyText": "This could be simply imported from the QuantityScrutinizer itself.", "author": "wetneb", "createdAt": "2020-07-03T05:59:59Z", "path": "extensions/wikidata/tests/src/org/openrefine/wikidata/qa/scrutinizers/QuantityScrutinizerTest.java", "diffHunk": "@@ -27,7 +45,18 @@\n             new BigDecimal(\"1.234\"), \"Q346721\");\n     \n     private QuantityValue goodUnitValue = Datamodel.makeQuantityValue(\n-            new BigDecimal(\"1.234\"), MockConstraintFetcher.allowedUnit.getIri());\n+            new BigDecimal(\"1.234\"), (ItemIdValue) allowedUnit);\n+\n+    public static String NO_BOUNDS_CONSTRAINT_QID = \"Q51723761\";\n+    public static String INTEGER_VALUED_CONSTRAINT_QID = \"Q52848401\";\n+    public static String ALLOWED_UNITS_CONSTRAINT_QID = \"Q21514353\";", "originalCommit": "93d3ffc12cd2f2ee85d64535d75a8e00941d70bc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5fea98d96af7766239a17aafb322fed61a4cc322", "url": "https://github.com/OpenRefine/OpenRefine/commit/5fea98d96af7766239a17aafb322fed61a4cc322", "message": "Test cases updated", "committedDate": "2020-07-03T11:15:04Z", "type": "commit"}]}