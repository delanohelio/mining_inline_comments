{"pr_number": 2996, "pr_title": "Clustering dialog choices limit & performance improvements - fixes #695", "pr_createdAt": "2020-07-27T19:41:47Z", "pr_url": "https://github.com/OpenRefine/OpenRefine/pull/2996", "timeline": [{"oid": "28cd4b17cda7c95a3cae6dc4ad1de6fbbf90c22a", "url": "https://github.com/OpenRefine/OpenRefine/commit/28cd4b17cda7c95a3cae6dc4ad1de6fbbf90c22a", "message": "Clustering dialog choices limit & performance improvements - fixes #695\n\nFixes #695\n- Caps the total number of choices displayed at 10,000 and warns when\n  over the limit. Users can use facets to tune which clusters are displayed.\n- Doubles the performance of the Javascript processing\n- Only displays count of rows for a choice if it's > 1 to DOM elements\n- Adds internationalization for row count\n\nFor 41K clusters containing 118K choices, processing dropped from\n3m20s to 1m20s, but with the 10K choice cap total time is ~10sec.", "committedDate": "2020-07-27T19:32:30Z", "type": "commit"}, {"oid": "2fbf353225b0f7abc63eef8bfc3b93c131add49d", "url": "https://github.com/OpenRefine/OpenRefine/commit/2fbf353225b0f7abc63eef8bfc3b93c131add49d", "message": "Restore even/odd row class", "committedDate": "2020-07-27T20:00:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc1NTg5MA==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2996#discussion_r461755890", "bodyText": "@wetneb If you want to experiment with the number of rows that your machine can handle, the limit is set here", "author": "tfmorris", "createdAt": "2020-07-28T17:37:20Z", "path": "main/webapp/modules/core/scripts/dialogs/clustering-dialog.js", "diffHunk": "@@ -256,23 +272,28 @@ ClusteringDialog.prototype._renderTable = function(clusters) {\n                 editCheck.attr(\"checked\", \"true\");\n             }\n \n-            var input = $('<input type=\"text\" size=\"25\" />')\n+            $('<input type=\"text\" size=\"25\" />')\n                 .attr(\"value\", cluster.value)\n                 .bind(\"keyup change input\",function() {\n                     cluster.value = this.value;\n                 }).appendTo(tr.insertCell(4));\n+\n+            return choices.length;\n         };\n \n-        for (var i = 0; i < clusters.length; i++) {\n-            renderCluster(clusters[i]);\n+        var maxRenderRows = 10000;", "originalCommit": "2fbf353225b0f7abc63eef8bfc3b93c131add49d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75", "url": "https://github.com/OpenRefine/OpenRefine/commit/0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75", "message": "Updates from review feedback", "committedDate": "2020-07-29T19:55:22Z", "type": "commit"}, {"oid": "0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75", "url": "https://github.com/OpenRefine/OpenRefine/commit/0b1bddc33bf60bdc1ca234e82abd9dd6f53f3f75", "message": "Updates from review feedback", "committedDate": "2020-07-29T19:55:22Z", "type": "forcePushed"}]}