{"pr_number": 2596, "pr_title": "correct excel mime types", "pr_createdAt": "2020-04-26T10:51:47Z", "pr_url": "https://github.com/OpenRefine/OpenRefine/pull/2596", "timeline": [{"oid": "84b9b894e723a5a3450000858ac680d9c99d5e9d", "url": "https://github.com/OpenRefine/OpenRefine/commit/84b9b894e723a5a3450000858ac680d9c99d5e9d", "message": "correct excel mime types", "committedDate": "2020-04-26T10:50:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5MzE3NQ==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#discussion_r415293175", "bodyText": "This should be removed - we should only need to add a mapping from the MIME type to the internal format identifier, with IM.registerMimeType (see below).", "author": "wetneb", "createdAt": "2020-04-26T11:58:38Z", "path": "main/webapp/modules/core/MOD-INF/controller.js", "diffHunk": "@@ -223,6 +223,8 @@ function registerImporting() {\n \n   IM.registerFormat(\"text/xml\", \"XML files\", \"XmlParserUI\", new Packages.com.google.refine.importers.XmlImporter());\n   IM.registerFormat(\"binary/text/xml/xls/xlsx\", \"Excel files\", \"ExcelParserUI\", new Packages.com.google.refine.importers.ExcelImporter());\n+  IM.registerFormat(\"application/vnd.ms-excel\", \"Excel files\", \"ExcelParserUI\", new Packages.com.google.refine.importers.ExcelImporter());\n+  IM.registerFormat(\"application/vnd.openxmlformats-officedocument.spreadsheetml.*\", \"Excel files\", \"ExcelParserUI\", new Packages.com.google.refine.importers.ExcelImporter());", "originalCommit": "84b9b894e723a5a3450000858ac680d9c99d5e9d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5MzE4OA==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#discussion_r415293188", "bodyText": "This should be kept: here, \"binary/text/xml/xls/xlsx\" serves as an internal identifier for the format, and does not need to be an official MIME type. The correct place to add the mapping is further down, with IM.registerMimeType.", "author": "wetneb", "createdAt": "2020-04-26T11:58:42Z", "path": "main/webapp/modules/core/MOD-INF/controller.js", "diffHunk": "@@ -245,8 +247,8 @@ function registerImporting() {\n   IM.registerExtension(\".json\", \"text/json\");\n   IM.registerExtension(\".js\", \"text/json\");\n \n-  IM.registerExtension(\".xls\", \"binary/text/xml/xls/xlsx\");\n-  IM.registerExtension(\".xlsx\", \"binary/text/xml/xls/xlsx\");\n+  IM.registerExtension(\".xls\", \"application/vnd.ms-excel\");\n+  IM.registerExtension(\".xlsx\", \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");", "originalCommit": "84b9b894e723a5a3450000858ac680d9c99d5e9d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3aa130eb7ffb2969c2deced45d5a5fcc792df885", "url": "https://github.com/OpenRefine/OpenRefine/commit/3aa130eb7ffb2969c2deced45d5a5fcc792df885", "message": "address PR issue", "committedDate": "2020-04-26T12:12:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5NjA4Mg==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#discussion_r415296082", "bodyText": "I'm not sure if wildcards work here\napplication/vnd.ms-excel already has an entry", "author": "pjfanning", "createdAt": "2020-04-26T12:13:55Z", "path": "main/webapp/modules/core/MOD-INF/controller.js", "diffHunk": "@@ -291,7 +291,8 @@ function registerImporting() {\n   IM.registerMimeType(\"application/x-excel\", \"binary/text/xml/xls/xlsx\");\n   IM.registerMimeType(\"application/xls\", \"binary/text/xml/xls/xlsx\");\n   IM.registerMimeType(\"application/x-xls\", \"binary/text/xml/xls/xlsx\");\n-  \n+  IM.registerMimeType(\"application/vnd.openxmlformats-officedocument.spreadsheetml.*\", \"binary/text/xml/xls/xlsx\");", "originalCommit": "3aa130eb7ffb2969c2deced45d5a5fcc792df885", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5NzQ1OA==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#discussion_r415297458", "bodyText": "good catch, wildcards are indeed not supported yet, sadly. Perhaps it is still worth keeping here for reference, it does not hurt: I'll add an issue to add support for wildcards which would enable it. Unless there is a small number of possible values for this wildcard, in which case we could add all the variants directly?", "author": "wetneb", "createdAt": "2020-04-26T12:20:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5NjA4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5ODc5MQ==", "url": "https://github.com/OpenRefine/OpenRefine/pull/2596#discussion_r415298791", "bodyText": "If we keep this line for now, we should add a comment about the fact that the wildcard is not supported yet, with a link to #2598", "author": "wetneb", "createdAt": "2020-04-26T12:27:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI5NjA4Mg=="}], "type": "inlineReview"}, {"oid": "6f714ca289aba660539c0a2250563fda7400bd45", "url": "https://github.com/OpenRefine/OpenRefine/commit/6f714ca289aba660539c0a2250563fda7400bd45", "message": "remove use of wildcard", "committedDate": "2020-04-26T12:27:24Z", "type": "commit"}]}