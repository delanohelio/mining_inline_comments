{"pr_number": 2309, "pr_title": "Charge command", "pr_createdAt": "2020-09-10T21:03:10Z", "pr_url": "https://github.com/Slimefun/Slimefun4/pull/2309", "timeline": [{"oid": "e1b9238cf136abc29648e648f1804cc36774c560", "url": "https://github.com/Slimefun/Slimefun4/commit/e1b9238cf136abc29648e648f1804cc36774c560", "message": "Merge pull request #2 from Slimefun/master\n\nUpdate", "committedDate": "2020-09-10T20:45:37Z", "type": "commit"}, {"oid": "6b95ed02936f0d6dbbb9ee53b34f8c5378573bed", "url": "https://github.com/Slimefun/Slimefun4/commit/6b95ed02936f0d6dbbb9ee53b34f8c5378573bed", "message": "Added Charge Command", "committedDate": "2020-09-10T21:02:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYzNTM3MA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2309#discussion_r486635370", "bodyText": "*/sf charge", "author": "TheBusyBiscuit", "createdAt": "2020-09-10T21:10:18Z", "path": "src/test/java/io/github/thebusybiscuit/slimefun4/testing/tests/commands/TestChargeCommand.java", "diffHunk": "@@ -0,0 +1,69 @@\n+package io.github.thebusybiscuit.slimefun4.testing.tests.commands;\n+\n+import be.seeseemelk.mockbukkit.MockBukkit;\n+import be.seeseemelk.mockbukkit.ServerMock;\n+import io.github.thebusybiscuit.slimefun4.core.attributes.Rechargeable;\n+import io.github.thebusybiscuit.slimefun4.implementation.SlimefunPlugin;\n+import io.github.thebusybiscuit.slimefun4.testing.TestUtilities;\n+import io.github.thebusybiscuit.slimefun4.utils.LoreBuilder;\n+import me.mrCookieSlime.Slimefun.Lists.RecipeType;\n+import me.mrCookieSlime.Slimefun.Objects.Category;\n+import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n+import me.mrCookieSlime.Slimefun.api.SlimefunItemStack;\n+import org.bukkit.Material;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+class TestChargeCommand {\n+\n+    private static ServerMock server;\n+    private static SlimefunPlugin plugin;\n+\n+    @BeforeAll\n+    public static void load() {\n+        server = MockBukkit.mock();\n+        plugin = MockBukkit.load(SlimefunPlugin.class);\n+    }\n+\n+    @AfterAll\n+    public static void unload() {\n+        MockBukkit.unmock();\n+    }\n+\n+    @Test\n+    @DisplayName(\"Test if /charge charges the item the player is holding\")", "originalCommit": "6b95ed02936f0d6dbbb9ee53b34f8c5378573bed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYzNjI1NA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2309#discussion_r486636254", "bodyText": "You should also assert the ground condition, that the charge was 0 before executing the command.\nThis way we can be certain that this did actually update.", "author": "TheBusyBiscuit", "createdAt": "2020-09-10T21:12:09Z", "path": "src/test/java/io/github/thebusybiscuit/slimefun4/testing/tests/commands/TestChargeCommand.java", "diffHunk": "@@ -0,0 +1,69 @@\n+package io.github.thebusybiscuit.slimefun4.testing.tests.commands;\n+\n+import be.seeseemelk.mockbukkit.MockBukkit;\n+import be.seeseemelk.mockbukkit.ServerMock;\n+import io.github.thebusybiscuit.slimefun4.core.attributes.Rechargeable;\n+import io.github.thebusybiscuit.slimefun4.implementation.SlimefunPlugin;\n+import io.github.thebusybiscuit.slimefun4.testing.TestUtilities;\n+import io.github.thebusybiscuit.slimefun4.utils.LoreBuilder;\n+import me.mrCookieSlime.Slimefun.Lists.RecipeType;\n+import me.mrCookieSlime.Slimefun.Objects.Category;\n+import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n+import me.mrCookieSlime.Slimefun.api.SlimefunItemStack;\n+import org.bukkit.Material;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+class TestChargeCommand {\n+\n+    private static ServerMock server;\n+    private static SlimefunPlugin plugin;\n+\n+    @BeforeAll\n+    public static void load() {\n+        server = MockBukkit.mock();\n+        plugin = MockBukkit.load(SlimefunPlugin.class);\n+    }\n+\n+    @AfterAll\n+    public static void unload() {\n+        MockBukkit.unmock();\n+    }\n+\n+    @Test\n+    @DisplayName(\"Test if /charge charges the item the player is holding\")\n+    void testCommand() {\n+        Category category = TestUtilities.getCategory(plugin, \"rechargeable\");\n+        final SlimefunItemStack RECHARGEABLE_ITEM = new SlimefunItemStack(\"RECHARGEABLE_ITEM\", Material.REDSTONE_BLOCK, \"Rechargeable Item\", \"This isn't real\", LoreBuilder.powerCharged(0, 100));\n+        new RechargeableMock(category, RECHARGEABLE_ITEM, RecipeType.NULL, new ItemStack[9]).register(plugin);\n+\n+        Player player = server.addPlayer();\n+        player.setOp(true);\n+        player.getInventory().setItemInMainHand(RECHARGEABLE_ITEM.clone());\n+        server.execute(\"slimefun\", player, \"charge\");\n+\n+        ItemStack chargedItemStack = player.getInventory().getItemInMainHand();\n+        Rechargeable chargedItem = (Rechargeable) SlimefunItem.getByItem(chargedItemStack);\n+\n+        Assertions.assertEquals(chargedItem.getItemCharge(chargedItemStack), chargedItem.getMaxItemCharge(chargedItemStack));", "originalCommit": "6b95ed02936f0d6dbbb9ee53b34f8c5378573bed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYzNjYwMg==", "url": "https://github.com/Slimefun/Slimefun4/pull/2309#discussion_r486636602", "bodyText": "Also you should pick a more unique id to prevent overlaps with future or existing unit tests, \"SF_CHARGE_TEST_ITEM\" for example.", "author": "TheBusyBiscuit", "createdAt": "2020-09-10T21:12:53Z", "path": "src/test/java/io/github/thebusybiscuit/slimefun4/testing/tests/commands/TestChargeCommand.java", "diffHunk": "@@ -0,0 +1,69 @@\n+package io.github.thebusybiscuit.slimefun4.testing.tests.commands;\n+\n+import be.seeseemelk.mockbukkit.MockBukkit;\n+import be.seeseemelk.mockbukkit.ServerMock;\n+import io.github.thebusybiscuit.slimefun4.core.attributes.Rechargeable;\n+import io.github.thebusybiscuit.slimefun4.implementation.SlimefunPlugin;\n+import io.github.thebusybiscuit.slimefun4.testing.TestUtilities;\n+import io.github.thebusybiscuit.slimefun4.utils.LoreBuilder;\n+import me.mrCookieSlime.Slimefun.Lists.RecipeType;\n+import me.mrCookieSlime.Slimefun.Objects.Category;\n+import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n+import me.mrCookieSlime.Slimefun.api.SlimefunItemStack;\n+import org.bukkit.Material;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+class TestChargeCommand {\n+\n+    private static ServerMock server;\n+    private static SlimefunPlugin plugin;\n+\n+    @BeforeAll\n+    public static void load() {\n+        server = MockBukkit.mock();\n+        plugin = MockBukkit.load(SlimefunPlugin.class);\n+    }\n+\n+    @AfterAll\n+    public static void unload() {\n+        MockBukkit.unmock();\n+    }\n+\n+    @Test\n+    @DisplayName(\"Test if /charge charges the item the player is holding\")\n+    void testCommand() {\n+        Category category = TestUtilities.getCategory(plugin, \"rechargeable\");\n+        final SlimefunItemStack RECHARGEABLE_ITEM = new SlimefunItemStack(\"RECHARGEABLE_ITEM\", Material.REDSTONE_BLOCK, \"Rechargeable Item\", \"This isn't real\", LoreBuilder.powerCharged(0, 100));", "originalCommit": "6b95ed02936f0d6dbbb9ee53b34f8c5378573bed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYzNjk5NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2309#discussion_r486636995", "bodyText": "This test alone is pretty good and sufficient.\nIn theory you could add more tests to achieve better coverage but I think this is enough", "author": "TheBusyBiscuit", "createdAt": "2020-09-10T21:13:43Z", "path": "src/test/java/io/github/thebusybiscuit/slimefun4/testing/tests/commands/TestChargeCommand.java", "diffHunk": "@@ -0,0 +1,69 @@\n+package io.github.thebusybiscuit.slimefun4.testing.tests.commands;\n+\n+import be.seeseemelk.mockbukkit.MockBukkit;\n+import be.seeseemelk.mockbukkit.ServerMock;\n+import io.github.thebusybiscuit.slimefun4.core.attributes.Rechargeable;\n+import io.github.thebusybiscuit.slimefun4.implementation.SlimefunPlugin;\n+import io.github.thebusybiscuit.slimefun4.testing.TestUtilities;\n+import io.github.thebusybiscuit.slimefun4.utils.LoreBuilder;\n+import me.mrCookieSlime.Slimefun.Lists.RecipeType;\n+import me.mrCookieSlime.Slimefun.Objects.Category;\n+import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n+import me.mrCookieSlime.Slimefun.api.SlimefunItemStack;\n+import org.bukkit.Material;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+class TestChargeCommand {\n+\n+    private static ServerMock server;\n+    private static SlimefunPlugin plugin;\n+\n+    @BeforeAll\n+    public static void load() {\n+        server = MockBukkit.mock();\n+        plugin = MockBukkit.load(SlimefunPlugin.class);\n+    }\n+\n+    @AfterAll\n+    public static void unload() {\n+        MockBukkit.unmock();\n+    }\n+\n+    @Test", "originalCommit": "6b95ed02936f0d6dbbb9ee53b34f8c5378573bed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYzNzMzNg==", "url": "https://github.com/Slimefun/Slimefun4/pull/2309#discussion_r486637336", "bodyText": "You could be more specific here *\"to the maximum value as defined by Rechargeable#getMax...\"", "author": "TheBusyBiscuit", "createdAt": "2020-09-10T21:14:28Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/ChargeCommand.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package io.github.thebusybiscuit.slimefun4.core.commands.subcommands;\n+\n+import io.github.thebusybiscuit.slimefun4.core.attributes.Rechargeable;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SlimefunCommand;\n+import io.github.thebusybiscuit.slimefun4.core.commands.SubCommand;\n+import io.github.thebusybiscuit.slimefun4.implementation.SlimefunPlugin;\n+import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+\n+/**\n+ * {@link ChargeCommand} adds an in game command which charges any {@link Rechargeable}\n+ * item to max.", "originalCommit": "6b95ed02936f0d6dbbb9ee53b34f8c5378573bed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "57f52f62c6ab9de0328f3255b3b70020fc020138", "url": "https://github.com/Slimefun/Slimefun4/commit/57f52f62c6ab9de0328f3255b3b70020fc020138", "message": "Did requested changes", "committedDate": "2020-09-10T21:27:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY0Njg5MA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2309#discussion_r486646890", "bodyText": "No need to mark this as final here, especially not in a Unit Test.", "author": "TheBusyBiscuit", "createdAt": "2020-09-10T21:35:10Z", "path": "src/test/java/io/github/thebusybiscuit/slimefun4/testing/tests/commands/TestChargeCommand.java", "diffHunk": "@@ -0,0 +1,74 @@\n+package io.github.thebusybiscuit.slimefun4.testing.tests.commands;\n+\n+import be.seeseemelk.mockbukkit.MockBukkit;\n+import be.seeseemelk.mockbukkit.ServerMock;\n+import io.github.thebusybiscuit.slimefun4.core.attributes.Rechargeable;\n+import io.github.thebusybiscuit.slimefun4.implementation.SlimefunPlugin;\n+import io.github.thebusybiscuit.slimefun4.testing.TestUtilities;\n+import io.github.thebusybiscuit.slimefun4.utils.LoreBuilder;\n+import me.mrCookieSlime.Slimefun.Lists.RecipeType;\n+import me.mrCookieSlime.Slimefun.Objects.Category;\n+import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n+import me.mrCookieSlime.Slimefun.api.SlimefunItemStack;\n+import org.bukkit.Material;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+class TestChargeCommand {\n+\n+    private static ServerMock server;\n+    private static SlimefunPlugin plugin;\n+\n+    @BeforeAll\n+    public static void load() {\n+        server = MockBukkit.mock();\n+        plugin = MockBukkit.load(SlimefunPlugin.class);\n+    }\n+\n+    @AfterAll\n+    public static void unload() {\n+        MockBukkit.unmock();\n+    }\n+\n+    @Test\n+    @DisplayName(\"Test if /sf charge charges the item the player is holding\")\n+    void testCommand() {\n+        Category category = TestUtilities.getCategory(plugin, \"rechargeable\");\n+        final SlimefunItemStack RECHARGEABLE_ITEM = new SlimefunItemStack(\"SF_CHARGE_TEST_ITEM\", Material.REDSTONE_BLOCK, \"Rechargeable Item\", \"This isn't real\", LoreBuilder.powerCharged(0, 100));", "originalCommit": "57f52f62c6ab9de0328f3255b3b70020fc020138", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY0NzE0NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2309#discussion_r486647145", "bodyText": "\"RechargeableItem\" was probably a more appropriate class name, my previous comment was only in regard to the id, not the class name.", "author": "TheBusyBiscuit", "createdAt": "2020-09-10T21:35:42Z", "path": "src/test/java/io/github/thebusybiscuit/slimefun4/testing/tests/commands/TestChargeCommand.java", "diffHunk": "@@ -0,0 +1,74 @@\n+package io.github.thebusybiscuit.slimefun4.testing.tests.commands;\n+\n+import be.seeseemelk.mockbukkit.MockBukkit;\n+import be.seeseemelk.mockbukkit.ServerMock;\n+import io.github.thebusybiscuit.slimefun4.core.attributes.Rechargeable;\n+import io.github.thebusybiscuit.slimefun4.implementation.SlimefunPlugin;\n+import io.github.thebusybiscuit.slimefun4.testing.TestUtilities;\n+import io.github.thebusybiscuit.slimefun4.utils.LoreBuilder;\n+import me.mrCookieSlime.Slimefun.Lists.RecipeType;\n+import me.mrCookieSlime.Slimefun.Objects.Category;\n+import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n+import me.mrCookieSlime.Slimefun.api.SlimefunItemStack;\n+import org.bukkit.Material;\n+import org.bukkit.entity.Player;\n+import org.bukkit.inventory.ItemStack;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+class TestChargeCommand {\n+\n+    private static ServerMock server;\n+    private static SlimefunPlugin plugin;\n+\n+    @BeforeAll\n+    public static void load() {\n+        server = MockBukkit.mock();\n+        plugin = MockBukkit.load(SlimefunPlugin.class);\n+    }\n+\n+    @AfterAll\n+    public static void unload() {\n+        MockBukkit.unmock();\n+    }\n+\n+    @Test\n+    @DisplayName(\"Test if /sf charge charges the item the player is holding\")\n+    void testCommand() {\n+        Category category = TestUtilities.getCategory(plugin, \"rechargeable\");\n+        final SlimefunItemStack RECHARGEABLE_ITEM = new SlimefunItemStack(\"SF_CHARGE_TEST_ITEM\", Material.REDSTONE_BLOCK, \"Rechargeable Item\", \"This isn't real\", LoreBuilder.powerCharged(0, 100));\n+        new SlimefunChargeTest(category, RECHARGEABLE_ITEM, RecipeType.NULL, new ItemStack[9]).register(plugin);\n+\n+        Player player = server.addPlayer();\n+        player.setOp(true);\n+        player.getInventory().setItemInMainHand(RECHARGEABLE_ITEM.clone());\n+\n+        ItemStack chargedItemStack = player.getInventory().getItemInMainHand();\n+        Rechargeable chargedItem = (Rechargeable) SlimefunItem.getByItem(chargedItemStack);\n+\n+        Assertions.assertEquals(chargedItem.getItemCharge(chargedItemStack), 0);\n+        server.execute(\"slimefun\", player, \"charge\");\n+\n+        chargedItemStack = player.getInventory().getItemInMainHand();\n+        chargedItem = (Rechargeable) SlimefunItem.getByItem(chargedItemStack);\n+\n+        Assertions.assertEquals(chargedItem.getItemCharge(chargedItemStack), chargedItem.getMaxItemCharge(chargedItemStack));\n+    }\n+\n+\n+    private class SlimefunChargeTest extends SlimefunItem implements Rechargeable {", "originalCommit": "57f52f62c6ab9de0328f3255b3b70020fc020138", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "128bc65417a8ce77fd26c6476d04c299d9c88ab9", "url": "https://github.com/Slimefun/Slimefun4/commit/128bc65417a8ce77fd26c6476d04c299d9c88ab9", "message": "Did requested changes", "committedDate": "2020-09-10T21:36:52Z", "type": "commit"}, {"oid": "37c0ce4ce01fad82d98c4c1a0275f49ceb5b34d1", "url": "https://github.com/Slimefun/Slimefun4/commit/37c0ce4ce01fad82d98c4c1a0275f49ceb5b34d1", "message": "Organized imports", "committedDate": "2020-09-11T04:52:19Z", "type": "commit"}]}