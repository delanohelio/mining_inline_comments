{"pr_number": 2394, "pr_title": "Improve magical zombie pills", "pr_createdAt": "2020-10-05T13:01:09Z", "pr_url": "https://github.com/Slimefun/Slimefun4/pull/2394", "timeline": [{"oid": "5ec63f632f0480d70e61d5774bca51e7934419bf", "url": "https://github.com/Slimefun/Slimefun4/commit/5ec63f632f0480d70e61d5774bca51e7934419bf", "message": "Update lore", "committedDate": "2020-10-05T12:20:44Z", "type": "commit"}, {"oid": "e1488c0811997a083f01cd51bdcf94e258e27d90", "url": "https://github.com/Slimefun/Slimefun4/commit/e1488c0811997a083f01cd51bdcf94e258e27d90", "message": "Add Zombified piglin conversion", "committedDate": "2020-10-05T12:56:40Z", "type": "commit"}, {"oid": "ab92df7693381606df98e459f4787d624b836371", "url": "https://github.com/Slimefun/Slimefun4/commit/ab92df7693381606df98e459f4787d624b836371", "message": "Fix imports", "committedDate": "2020-10-05T12:58:53Z", "type": "commit"}, {"oid": "21bf7cf60704eee6da3dfaf9ebaae223f305e48f", "url": "https://github.com/Slimefun/Slimefun4/commit/21bf7cf60704eee6da3dfaf9ebaae223f305e48f", "message": "Refactor slightly", "committedDate": "2020-10-05T13:00:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU4NTcxOA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499585718", "bodyText": "This is pretty redundant with the above, there's probably lots of ways to refactor this.", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T13:09:59Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -63,6 +64,20 @@ public EntityInteractHandler getItemHandler() {\n                     zombieVillager.setConversionPlayer(p);\n                 }\n             }\n+            else if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_16)\n+                    && entity.getType() == EntityType.ZOMBIFIED_PIGLIN) {\n+                Player p = e.getPlayer();\n+\n+                if (p.getGameMode() != GameMode.CREATIVE) {\n+                    ItemUtils.consumeItem(item, false);\n+                }\n+\n+                Location loc = entity.getLocation();\n+                p.playSound(loc, Sound.ENTITY_ZOMBIE_VILLAGER_CONVERTED, 1, 1);\n+\n+                entity.remove();\n+                loc.getWorld().spawnEntity(loc, EntityType.PIGLIN);\n+            }", "originalCommit": "21bf7cf60704eee6da3dfaf9ebaae223f305e48f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU5MDA3OQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499590079", "bodyText": "I'm not sure about the lore change here. It may break some items in some servers.", "author": "LinoxGH", "createdAt": "2020-10-05T13:16:48Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunItems.java", "diffHunk": "@@ -63,7 +63,7 @@ private SlimefunItems() {}\n     public static final SlimefunItemStack SPLINT = new SlimefunItemStack(\"SPLINT\", Material.STICK, \"&cSplint\", \"\", \"&aLevel I - Medical Supply\", \"\", \"&fRestores 2 Hearts\", \"\", LoreBuilder.RIGHT_CLICK_TO_USE);\n     public static final SlimefunItemStack VITAMINS = new SlimefunItemStack(\"VITAMINS\", Material.NETHER_WART, \"&cVitamins\", \"\", \"&aLevel III - Medical Supply\", \"\", \"&fRestores 4 Hearts\", \"&fExtinguishes Fire\", \"&fCures Poison/Wither/Radiation\", \"\", LoreBuilder.RIGHT_CLICK_TO_USE);\n     public static final SlimefunItemStack MEDICINE = new SlimefunItemStack(\"MEDICINE\", Material.POTION, Color.RED, \"&cMedicine\", \"\", \"&aLevel III - Medical Supply\", \"\", \"&fRestores 4 Hearts\", \"&fExtinguishes Fire\", \"&fCures Poison/Wither/Radiation\");\n-    public static final SlimefunItemStack MAGICAL_ZOMBIE_PILLS = new SlimefunItemStack(\"MAGICAL_ZOMBIE_PILLS\", Material.NETHER_WART, \"&6Magical Zombie Pills\", \"\", \"&eRight Click &7a Zombified Villager to\", \"&7instantly cure it from its curse\");\n+    public static final SlimefunItemStack MAGICAL_ZOMBIE_PILLS = new SlimefunItemStack(\"MAGICAL_ZOMBIE_PILLS\", Material.NETHER_WART, \"&6Magical Zombie Pills\", \"\", \"&eRight Click &7a Zombified Villager\", \"&eor &7a Zombified Piglin to\", \"&7instantly cure it from its curse\");", "originalCommit": "21bf7cf60704eee6da3dfaf9ebaae223f305e48f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU5ODc1MA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499598750", "bodyText": "Other than simply not stacking with older items this should be fine.", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T13:29:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU5MDA3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwMDE3Nw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499600177", "bodyText": "True, but if you dont put it in the lore, not many people will know about it\nBusys message didnt show when I posted this", "author": "svr333", "createdAt": "2020-10-05T13:31:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU5MDA3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU5MjQ1Mw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499592453", "bodyText": "This part is now a duplicate of the code above. Instead move this to a private method and call it. For both entity types. I am not sure if this is still possible. Though it's worth a try.", "author": "LinoxGH", "createdAt": "2020-10-05T13:20:09Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -63,6 +64,20 @@ public EntityInteractHandler getItemHandler() {\n                     zombieVillager.setConversionPlayer(p);\n                 }\n             }\n+            else if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_16)\n+                    && entity.getType() == EntityType.ZOMBIFIED_PIGLIN) {\n+                Player p = e.getPlayer();\n+\n+                if (p.getGameMode() != GameMode.CREATIVE) {\n+                    ItemUtils.consumeItem(item, false);\n+                }\n+\n+                Location loc = entity.getLocation();\n+                p.playSound(loc, Sound.ENTITY_ZOMBIE_VILLAGER_CONVERTED, 1, 1);\n+\n+                entity.remove();\n+                loc.getWorld().spawnEntity(loc, EntityType.PIGLIN);", "originalCommit": "21bf7cf60704eee6da3dfaf9ebaae223f305e48f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a01d33fea317b73611fa29092bfc3e2f88709204", "url": "https://github.com/Slimefun/Slimefun4/commit/a01d33fea317b73611fa29092bfc3e2f88709204", "message": "Refactor", "committedDate": "2020-10-05T13:25:11Z", "type": "commit"}, {"oid": "a2fb390a8ec8bb0985b9b135bd3926a416011fae", "url": "https://github.com/Slimefun/Slimefun4/commit/a2fb390a8ec8bb0985b9b135bd3926a416011fae", "message": "Extra code to separate methods", "committedDate": "2020-10-05T13:28:43Z", "type": "commit"}, {"oid": "e65341eb0b2f6cd32c22ffe0d39f946cad9e0068", "url": "https://github.com/Slimefun/Slimefun4/commit/e65341eb0b2f6cd32c22ffe0d39f946cad9e0068", "message": "Add newline", "committedDate": "2020-10-05T13:29:02Z", "type": "commit"}, {"oid": "ab5251021ad654f49f570a024172e2c6c129c7ad", "url": "https://github.com/Slimefun/Slimefun4/commit/ab5251021ad654f49f570a024172e2c6c129c7ad", "message": "Fix compile error", "committedDate": "2020-10-05T13:30:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTU5OTk2Ng==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499599966", "bodyText": "@Nonnull \ud83d\udc40", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T13:30:51Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -74,4 +76,19 @@ public EntityInteractHandler getItemHandler() {\n     public ItemUseHandler onRightClick() {\n         return PlayerRightClickEvent::cancel;\n     }\n-}\n\\ No newline at end of file\n+\n+    private void healZombieVillager(ZombieVillager zombieVillager, Player p) {", "originalCommit": "ab5251021ad654f49f570a024172e2c6c129c7ad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwMDAxOQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499600019", "bodyText": "@Nonnull \ud83d\udc40", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T13:30:55Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -74,4 +76,19 @@ public EntityInteractHandler getItemHandler() {\n     public ItemUseHandler onRightClick() {\n         return PlayerRightClickEvent::cancel;\n     }\n-}\n\\ No newline at end of file\n+\n+    private void healZombieVillager(ZombieVillager zombieVillager, Player p) {\n+        zombieVillager.setConversionTime(1);\n+\n+        if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_15)) {\n+            zombieVillager.setConversionPlayer(p);\n+        }\n+    }\n+\n+    private void healZombifiedPiglin(Entity zombiePiglin) {", "originalCommit": "ab5251021ad654f49f570a024172e2c6c129c7ad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwMDQzMw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499600433", "bodyText": "Also, while this should not cause any probems as it is, it could be a better practice to do an instanceof check here instead because you are doing a class cast, just in case.", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T13:31:36Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -56,11 +57,12 @@ public EntityInteractHandler getItemHandler() {\n \n                 p.playSound(p.getLocation(), Sound.ENTITY_ZOMBIE_VILLAGER_CONVERTED, 1, 1);\n \n-                ZombieVillager zombieVillager = (ZombieVillager) entity;\n-                zombieVillager.setConversionTime(1);\n+                if (entity.getType() == EntityType.ZOMBIE_VILLAGER) {\n+                    healZombieVillager((ZombieVillager) entity, p);\n+                }\n \n-                if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_15)) {\n-                    zombieVillager.setConversionPlayer(p);\n+                else if (entity.getType() == EntityType.ZOMBIFIED_PIGLIN) {\n+                    healZombifiedPiglin(entity);\n                 }", "originalCommit": "ab5251021ad654f49f570a024172e2c6c129c7ad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3ca6e612cc77e3c8202057c80ffc0302004671bb", "url": "https://github.com/Slimefun/Slimefun4/commit/3ca6e612cc77e3c8202057c80ffc0302004671bb", "message": "Add @nonnull", "committedDate": "2020-10-05T13:33:48Z", "type": "commit"}, {"oid": "8d3f432158cb58d620b4f607231341e1090150fa", "url": "https://github.com/Slimefun/Slimefun4/commit/8d3f432158cb58d620b4f607231341e1090150fa", "message": "Use instanceof", "committedDate": "2020-10-05T13:37:45Z", "type": "commit"}, {"oid": "6c568bd7d15c018737fbca1e9dea629621087ec3", "url": "https://github.com/Slimefun/Slimefun4/commit/6c568bd7d15c018737fbca1e9dea629621087ec3", "message": "Fix imports", "committedDate": "2020-10-05T13:38:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwNjA2OQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499606069", "bodyText": "No star imports!", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T13:39:51Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -3,11 +3,7 @@\n import org.bukkit.GameMode;\n import org.bukkit.Location;\n import org.bukkit.Sound;\n-import org.bukkit.entity.Entity;\n-import org.bukkit.entity.EntityType;\n-import org.bukkit.entity.Player;\n-import org.bukkit.entity.Villager;\n-import org.bukkit.entity.ZombieVillager;\n+import org.bukkit.entity.*;", "originalCommit": "8d3f432158cb58d620b4f607231341e1090150fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwNjQxNw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499606417", "bodyText": "Yeah my ide did that automatically, already fixed", "author": "svr333", "createdAt": "2020-10-05T13:40:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwNjA2OQ=="}], "type": "inlineReview"}, {"oid": "b8c2c97766abc475e12ea9aa8fc7b010acdffcec", "url": "https://github.com/Slimefun/Slimefun4/commit/b8c2c97766abc475e12ea9aa8fc7b010acdffcec", "message": "Add missing import", "committedDate": "2020-10-05T13:43:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwOTc4MQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499609781", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private void healZombifiedPiglin(@Nonnull Entity zombiePiglin) {\n          \n          \n            \n                private void healZombifiedPiglin(@Nonnull PigZombie zombiePiglin) {", "author": "LinoxGH", "createdAt": "2020-10-05T13:45:16Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -74,4 +79,19 @@ public EntityInteractHandler getItemHandler() {\n     public ItemUseHandler onRightClick() {\n         return PlayerRightClickEvent::cancel;\n     }\n-}\n\\ No newline at end of file\n+\n+    private void healZombieVillager(@Nonnull ZombieVillager zombieVillager, @Nonnull Player p) {\n+        zombieVillager.setConversionTime(1);\n+\n+        if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_15)) {\n+            zombieVillager.setConversionPlayer(p);\n+        }\n+    }\n+\n+    private void healZombifiedPiglin(@Nonnull Entity zombiePiglin) {", "originalCommit": "b8c2c97766abc475e12ea9aa8fc7b010acdffcec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYxMTg5MA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499611890", "bodyText": "Casting here isnt necessary, it saves a few milliseconds so I dont think it matters\nIn the current context, were 100% sure its a PigZombie, but we dont have to cast it since we can use the generic Entity methods\nThough if this is preferred, Ill change it", "author": "svr333", "createdAt": "2020-10-05T13:48:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwOTc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYxNDEwNw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499614107", "bodyText": "I agree with Linox, changing the parameter type restricts the type of argument this can accept.\nSo this is definitely a desired change in terms of maintainability.", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T13:51:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwOTc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYxNTQ0NA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499615444", "bodyText": "Casting here isnt necessary, it saves a few milliseconds so I dont think it matters\nIn the current context, were 100% sure its a PigZombie, but we dont have to cast it since we can use the generic Entity methods\nThough if this is preferred, Ill change it\n\nYou are already checking instanceof bef\u0131re this is called. That doesn't change a thing.", "author": "LinoxGH", "createdAt": "2020-10-05T13:53:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYwOTc4MQ=="}], "type": "inlineReview"}, {"oid": "0a19f767872159d6cb963230c81da0bfa403e89c", "url": "https://github.com/Slimefun/Slimefun4/commit/0a19f767872159d6cb963230c81da0bfa403e89c", "message": "Use PigZombie over Entity", "committedDate": "2020-10-05T13:56:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY5Njg1MA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499696850", "bodyText": "Can you please remove this empty line here?", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T15:45:11Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -56,11 +60,12 @@ public EntityInteractHandler getItemHandler() {\n \n                 p.playSound(p.getLocation(), Sound.ENTITY_ZOMBIE_VILLAGER_CONVERTED, 1, 1);\n \n-                ZombieVillager zombieVillager = (ZombieVillager) entity;\n-                zombieVillager.setConversionTime(1);\n+                if (entity instanceof ZombieVillager) {\n+                    healZombieVillager((ZombieVillager) entity, p);\n+                }\n ", "originalCommit": "0a19f767872159d6cb963230c81da0bfa403e89c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fe50d962700c5093a9534d2a6fac092e150f1e2f", "url": "https://github.com/Slimefun/Slimefun4/commit/fe50d962700c5093a9534d2a6fac092e150f1e2f", "message": "Remove empty line", "committedDate": "2020-10-05T16:38:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MDExOQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499740119", "bodyText": "Wait a second, I only just realized that you removed the 1.16 version check? O_O", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T16:54:49Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -74,4 +78,19 @@ public EntityInteractHandler getItemHandler() {\n     public ItemUseHandler onRightClick() {\n         return PlayerRightClickEvent::cancel;\n     }\n-}\n\\ No newline at end of file\n+\n+    private void healZombieVillager(@Nonnull ZombieVillager zombieVillager, @Nonnull Player p) {\n+        zombieVillager.setConversionTime(1);\n+\n+        if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_15)) {\n+            zombieVillager.setConversionPlayer(p);\n+        }\n+    }\n+\n+    private void healZombifiedPiglin(@Nonnull PigZombie zombiePiglin) {", "originalCommit": "fe50d962700c5093a9534d2a6fac092e150f1e2f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0NTIzNg==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499745236", "bodyText": "entity.getType will never be equal to a ZombiePiglin, because they dont exist in other versions", "author": "svr333", "createdAt": "2020-10-05T17:03:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MDExOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0NTM1Ng==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499745356", "bodyText": "I could add it back though, if thats preferred", "author": "svr333", "createdAt": "2020-10-05T17:04:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MDExOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODE4Mw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499748183", "bodyText": "entity.getType will never be equal to a ZombiePiglin, because they dont exist in other versions\n\nYes and cause an exception. That is why the version check is needed.", "author": "LinoxGH", "createdAt": "2020-10-05T17:09:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MDExOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0OTQyMw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499749423", "bodyText": "I dont actually think it will create an exception?  (im probably wrong here)\nBut sure Ill add the check", "author": "svr333", "createdAt": "2020-10-05T17:11:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MDExOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc1MTkxNw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499751917", "bodyText": "I dont actually think it will create an exception?  (im probably wrong here)\nBut sure Ill add the check\n\nOf course it will. The server will try to access an EntityType that doesn't exist and boom. Exception.", "author": "LinoxGH", "createdAt": "2020-10-05T17:16:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MDExOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc1OTY5Ng==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499759696", "bodyText": "Oh I was assuming that it still uses the latest version of the api, and that it would just throw if anything out of that version was accessed. Good to know this!", "author": "svr333", "createdAt": "2020-10-05T17:30:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MDExOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MjU5NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499742595", "bodyText": "This else if is redundant, it could be simply an else.", "author": "poma123", "createdAt": "2020-10-05T16:59:07Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -56,11 +60,11 @@ public EntityInteractHandler getItemHandler() {\n \n                 p.playSound(p.getLocation(), Sound.ENTITY_ZOMBIE_VILLAGER_CONVERTED, 1, 1);\n \n-                ZombieVillager zombieVillager = (ZombieVillager) entity;\n-                zombieVillager.setConversionTime(1);\n-\n-                if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_15)) {\n-                    zombieVillager.setConversionPlayer(p);\n+                if (entity instanceof ZombieVillager) {\n+                    healZombieVillager((ZombieVillager) entity, p);\n+                }\n+                else if (entity instanceof PigZombie) {", "originalCommit": "fe50d962700c5093a9534d2a6fac092e150f1e2f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0OTE3NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499749175", "bodyText": "Im aware that it is, but if there will ever be more recipes added, theyd have to create the else if statement back", "author": "svr333", "createdAt": "2020-10-05T17:11:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MjU5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc1NjAxMg==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499756012", "bodyText": "It will be their problem. Currently, this else if is redundant since we are working with only two cases (ZombieVillager and PigZombie), and the first one is already handled by an if check, for the second one it could simply be an else.", "author": "poma123", "createdAt": "2020-10-05T17:23:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MjU5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2MDU4MQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499760581", "bodyText": "I agree with @svr333 here, this else if clearly indicates what exact case this is for.\nAn else could lead to unwanted side effects if we ever add more entity types.", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T17:31:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MjU5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2MjA2NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499762065", "bodyText": "Fair enough.", "author": "poma123", "createdAt": "2020-10-05T17:34:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MjU5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODI0Mw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499748243", "bodyText": "Also, why are we using PigZombie instead of Piglin? Then the version check should be a bit different.\nIs a zombified piglin entity really an instance of PigZombie?", "author": "poma123", "createdAt": "2020-10-05T17:09:34Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -47,7 +51,7 @@ public EntityInteractHandler getItemHandler() {\n         return (e, item, offhand) -> {\n             Entity entity = e.getRightClicked();\n \n-            if (entity.getType() == EntityType.ZOMBIE_VILLAGER) {\n+            if (entity instanceof ZombieVillager || entity instanceof PigZombie) {", "originalCommit": "fe50d962700c5093a9534d2a6fac092e150f1e2f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODg1Mg==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499748852", "bodyText": "Because we want to turn a PigZombie into a Piglin, not vice versa", "author": "svr333", "createdAt": "2020-10-05T17:10:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODI0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0OTQ3OA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499749478", "bodyText": "But in 1.16 there is no PigZombie. Or am I wrong?", "author": "poma123", "createdAt": "2020-10-05T17:11:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODI0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc1MDAyMQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499750021", "bodyText": "We are looking for zombified piglins, right? Is a zombified piglin entity really an instance of PigZombie?", "author": "poma123", "createdAt": "2020-10-05T17:12:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODI0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc1OTkzOQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499759939", "bodyText": "Zombie pigmen were renamed to Zombified Piglins, theyre the same\nAlso I compiled locally and tested and it worked fine", "author": "svr333", "createdAt": "2020-10-05T17:30:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODI0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2MDgzMQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499760831", "bodyText": "I believe you. Did you test this ingame?", "author": "poma123", "createdAt": "2020-10-05T17:32:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODI0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2MTAxMw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499761013", "bodyText": "Yep, Spigot still calls the Zombified Pigling PigZombie internally. That's the corrret class", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T17:32:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODI0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2MTYyMQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499761621", "bodyText": "Okay then", "author": "poma123", "createdAt": "2020-10-05T17:33:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0ODI0Mw=="}], "type": "inlineReview"}, {"oid": "b237d076bffb17ac319027563c717a79982490a1", "url": "https://github.com/Slimefun/Slimefun4/commit/b237d076bffb17ac319027563c717a79982490a1", "message": "Add version check", "committedDate": "2020-10-05T17:34:00Z", "type": "commit"}, {"oid": "868a7e566b0be9358354343e32638b1ccb7337ee", "url": "https://github.com/Slimefun/Slimefun4/commit/868a7e566b0be9358354343e32638b1ccb7337ee", "message": "Change else if to else", "committedDate": "2020-10-05T17:34:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2NzI2MQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499767261", "bodyText": "Please change this back to an else if as stated here D:", "author": "poma123", "createdAt": "2020-10-05T17:44:43Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -56,11 +61,11 @@ public EntityInteractHandler getItemHandler() {\n \n                 p.playSound(p.getLocation(), Sound.ENTITY_ZOMBIE_VILLAGER_CONVERTED, 1, 1);\n \n-                ZombieVillager zombieVillager = (ZombieVillager) entity;\n-                zombieVillager.setConversionTime(1);\n-\n-                if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_15)) {\n-                    zombieVillager.setConversionPlayer(p);\n+                if (entity instanceof ZombieVillager) {\n+                    healZombieVillager((ZombieVillager) entity, p);\n+                }\n+                else {", "originalCommit": "868a7e566b0be9358354343e32638b1ccb7337ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2ODc1MQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499768751", "bodyText": "More specifically: #2394 (comment)", "author": "poma123", "createdAt": "2020-10-05T17:47:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2NzI2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2NjQ0MQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499766441", "bodyText": "Not a fan of this line here, it's really messy and redundant with the two if statements below.\nI'll suggest an alternative below", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T17:43:08Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -47,7 +51,8 @@ public EntityInteractHandler getItemHandler() {\n         return (e, item, offhand) -> {\n             Entity entity = e.getRightClicked();\n \n-            if (entity.getType() == EntityType.ZOMBIE_VILLAGER) {\n+            if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_16) && entity instanceof PigZombie\n+                    || entity instanceof ZombieVillager) {", "originalCommit": "868a7e566b0be9358354343e32638b1ccb7337ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2NzUyOQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499767529", "bodyText": "What if you put Line 56-62 into a seperate method like useItem or whatever and then just call this method before the specific heal method, this way we save redundancy even further because we no longer need two different if statements for the same check.", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T17:45:13Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -47,7 +51,8 @@ public EntityInteractHandler getItemHandler() {\n         return (e, item, offhand) -> {\n             Entity entity = e.getRightClicked();\n \n-            if (entity.getType() == EntityType.ZOMBIE_VILLAGER) {\n+            if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_16) && entity instanceof PigZombie\n+                    || entity instanceof ZombieVillager) {\n                 Player p = e.getPlayer();", "originalCommit": "868a7e566b0be9358354343e32638b1ccb7337ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2NzgxNw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499767817", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            else {\n          \n          \n            \n                            else if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_16) && entity instanceof PigZombie) {", "author": "TheBusyBiscuit", "createdAt": "2020-10-05T17:45:47Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/magical/MagicalZombiePills.java", "diffHunk": "@@ -56,11 +61,11 @@ public EntityInteractHandler getItemHandler() {\n \n                 p.playSound(p.getLocation(), Sound.ENTITY_ZOMBIE_VILLAGER_CONVERTED, 1, 1);\n \n-                ZombieVillager zombieVillager = (ZombieVillager) entity;\n-                zombieVillager.setConversionTime(1);\n-\n-                if (SlimefunPlugin.getMinecraftVersion().isAtLeast(MinecraftVersion.MINECRAFT_1_15)) {\n-                    zombieVillager.setConversionPlayer(p);\n+                if (entity instanceof ZombieVillager) {\n+                    healZombieVillager((ZombieVillager) entity, p);\n+                }\n+                else {", "originalCommit": "868a7e566b0be9358354343e32638b1ccb7337ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc3MTA0OA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2394#discussion_r499771048", "bodyText": "I did the minecraft version check above it, is that not good?\ndidnt see the first messages", "author": "svr333", "createdAt": "2020-10-05T17:51:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc2NzgxNw=="}], "type": "inlineReview"}, {"oid": "94c5068cc2dffa47b0111a96da36cd5bc0f75d51", "url": "https://github.com/Slimefun/Slimefun4/commit/94c5068cc2dffa47b0111a96da36cd5bc0f75d51", "message": "Move version check\n\nCo-authored-by: TheBusyBiscuit <TheBusyBiscuit@users.noreply.github.com>", "committedDate": "2020-10-05T18:03:50Z", "type": "commit"}, {"oid": "997dce897033e82ec57e3036c29d7e1b27ecda51", "url": "https://github.com/Slimefun/Slimefun4/commit/997dce897033e82ec57e3036c29d7e1b27ecda51", "message": "Extract to method && remove redundant if statement", "committedDate": "2020-10-05T18:07:56Z", "type": "commit"}]}