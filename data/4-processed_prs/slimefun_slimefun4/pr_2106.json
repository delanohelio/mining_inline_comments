{"pr_number": 2106, "pr_title": "Optimizations for Paper (cargo network optimizations)", "pr_createdAt": "2020-07-20T10:53:21Z", "pr_url": "https://github.com/Slimefun/Slimefun4/pull/2106", "timeline": [{"oid": "ae780a69bbe076ceca09dfc0abbb7c7a3ca3ce3b", "url": "https://github.com/Slimefun/Slimefun4/commit/ae780a69bbe076ceca09dfc0abbb7c7a3ca3ce3b", "message": "Added PaperLib", "committedDate": "2020-07-19T23:51:14Z", "type": "commit"}, {"oid": "045cdf1090b03c8752e34ff4dca323ff0c8e1f76", "url": "https://github.com/Slimefun/Slimefun4/commit/045cdf1090b03c8752e34ff4dca323ff0c8e1f76", "message": "Added performance improvements for Block States", "committedDate": "2020-07-20T00:22:24Z", "type": "commit"}, {"oid": "c1d6021216f9aadb5a64fee020eed404b9a80232", "url": "https://github.com/Slimefun/Slimefun4/commit/c1d6021216f9aadb5a64fee020eed404b9a80232", "message": "Optimized teleportations", "committedDate": "2020-07-20T00:31:58Z", "type": "commit"}, {"oid": "64b59e3a023bbfb18bbb6680dce3272056737159", "url": "https://github.com/Slimefun/Slimefun4/commit/64b59e3a023bbfb18bbb6680dce3272056737159", "message": "Spigot is now called \"Spigot\"", "committedDate": "2020-07-20T01:05:49Z", "type": "commit"}, {"oid": "f4c0c9f905e779d03b446fbddd01f5c40320fb0d", "url": "https://github.com/Slimefun/Slimefun4/commit/f4c0c9f905e779d03b446fbddd01f5c40320fb0d", "message": "Minor changes", "committedDate": "2020-07-20T08:49:59Z", "type": "commit"}, {"oid": "fd10f2ea4cdc97fa83e2e076e50452b90bd452b7", "url": "https://github.com/Slimefun/Slimefun4/commit/fd10f2ea4cdc97fa83e2e076e50452b90bd452b7", "message": "Merge branch 'master' of https://github.com/TheBusyBiscuit/Slimefun4 into paper", "committedDate": "2020-07-20T10:48:25Z", "type": "commit"}, {"oid": "397f1940292feaf8aea2164a46fc7df9bf975bc6", "url": "https://github.com/Slimefun/Slimefun4/commit/397f1940292feaf8aea2164a46fc7df9bf975bc6", "message": "Fixed two synchronization issues", "committedDate": "2020-07-20T11:08:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM3NTUxOA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2106#discussion_r457375518", "bodyText": "English?", "author": "WalshyDev", "createdAt": "2020-07-20T13:20:30Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/VersionsCommand.java", "diffHunk": "@@ -33,7 +34,10 @@ public boolean isHidden() {\n     @Override\n     public void onExecute(CommandSender sender, String[] args) {\n         if (sender.hasPermission(\"slimefun.command.versions\") || sender instanceof ConsoleCommandSender) {\n-            sender.sendMessage(ChatColors.color(\"&a\" + Bukkit.getName() + \" &2\" + ReflectionUtils.getVersion()));\n+            // After all these years... Spigot still displays as \"CraftBukkit\"\n+            // so we will just this issue for them :)", "originalCommit": "397f1940292feaf8aea2164a46fc7df9bf975bc6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM4NDAwNA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2106#discussion_r457384004", "bodyText": "Ich entschuldige mich hierf\u00fcr, es war sehr sp\u00e4t in der Nacht. \u00af_(\u30c4)_/\u00af\nYes, I can english good very.", "author": "TheBusyBiscuit", "createdAt": "2020-07-20T13:29:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM3NTUxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM3NzM3Mg==", "url": "https://github.com/Slimefun/Slimefun4/pull/2106#discussion_r457377372", "bodyText": "These strings are nullable", "author": "WalshyDev", "createdAt": "2020-07-20T13:22:31Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/gps/ElevatorPlate.java", "diffHunk": "@@ -134,8 +135,12 @@ public void open(Player p, Block b) {\n                         yaw = -180 + (yaw - 180);\n                     }\n \n-                    player.teleport(new Location(player.getWorld(), block.getX() + 0.5, block.getY() + 0.4, block.getZ() + 0.5, yaw, player.getEyeLocation().getPitch()));\n-                    player.sendTitle(ChatColor.WHITE + ChatColors.color(floor), \" \", 20, 60, 20);\n+                    Location destination = new Location(player.getWorld(), block.getX() + 0.5, block.getY() + 0.4, block.getZ() + 0.5, yaw, player.getEyeLocation().getPitch());\n+                    PaperLib.teleportAsync(player, destination).thenAccept(teleported -> {\n+                        if (teleported.booleanValue()) {\n+                            Slimefun.runSync(() -> player.sendTitle(ChatColor.WHITE + ChatColors.color(floor), \" \", 20, 60, 20));", "originalCommit": "397f1940292feaf8aea2164a46fc7df9bf975bc6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM4NDMwMQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2106#discussion_r457384301", "bodyText": "Which strings and why?", "author": "TheBusyBiscuit", "createdAt": "2020-07-20T13:30:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM3NzM3Mg=="}], "type": "inlineReview"}, {"oid": "29b26ed32790448b5a22292d5f5c463bd23d788d", "url": "https://github.com/Slimefun/Slimefun4/commit/29b26ed32790448b5a22292d5f5c463bd23d788d", "message": "Made requested changes", "committedDate": "2020-07-20T14:30:20Z", "type": "commit"}, {"oid": "2d64f37999543ed84df0106bfcf14e36b3041d4a", "url": "https://github.com/Slimefun/Slimefun4/commit/2d64f37999543ed84df0106bfcf14e36b3041d4a", "message": "Update CHANGELOG.md", "committedDate": "2020-07-20T17:33:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU4NDQ2OA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2106#discussion_r457584468", "bodyText": "Probably best to use Arrays.asList\nI can't see a reason why this should be done. Would be slower and means there's a mutable list (even if for a short time)", "author": "WalshyDev", "createdAt": "2020-07-20T17:45:04Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/api/gps/TeleportationManager.java", "diffHunk": "@@ -58,10 +61,21 @@ public void openTeleporterGUI(Player p, UUID uuid, Block b, int complexity) {\n                 }\n \n                 int slot = teleporterInventory[index];\n-\n                 Location l = waypoint.getLocation();\n-                menu.addItem(slot,\n-                        new CustomItem(waypoint.getIcon(), waypoint.getName().replace(\"player:death \", \"\"), \"\", \"&8\\u21E8 &7\" + SlimefunPlugin.getLocalization().getResourceString(p, \"tooltips.world\") + \": &f\" + l.getWorld().getName(), \"&8\\u21E8 &7X: &f\" + l.getX(), \"&8\\u21E8 &7Y: &f\" + l.getY(), \"&8\\u21E8 &7Z: &f\" + l.getZ(), \"&8\\u21E8 &7\" + SlimefunPlugin.getLocalization().getMessage(p, \"machines.TELEPORTER.gui.time\") + \": &f\" + DoubleHandler.fixDouble(0.5 * getTeleportationTime(complexity, source, l)) + \"s\", \"\", \"&8\\u21E8 &c\" + SlimefunPlugin.getLocalization().getMessage(p, \"machines.TELEPORTER.gui.tooltip\")));\n+                double time = DoubleHandler.fixDouble(0.5 * getTeleportationTime(complexity, source, l));\n+\n+                List<String> nameAndLore = new ArrayList<>();\n+                nameAndLore.add(waypoint.getName().replace(\"player:death \", \"\"));\n+                nameAndLore.add(\"\");\n+                nameAndLore.add(\"&8\\u21E8 &7\" + SlimefunPlugin.getLocalization().getResourceString(p, \"tooltips.world\") + \": &f\" + l.getWorld().getName());\n+                nameAndLore.add(\"&8\\u21E8 &7X: &f\" + l.getX());\n+                nameAndLore.add(\"&8\\u21E8 &7Y: &f\" + l.getY());\n+                nameAndLore.add(\"&8\\u21E8 &7Z: &f\" + l.getZ());\n+                nameAndLore.add(\"&8\\u21E8 &7\" + SlimefunPlugin.getLocalization().getMessage(p, \"machines.TELEPORTER.gui.time\") + \": &f\" + time + \"s\");\n+                nameAndLore.add(\"\");\n+                nameAndLore.add(\"&8\\u21E8 &c\" + SlimefunPlugin.getLocalization().getMessage(p, \"machines.TELEPORTER.gui.tooltip\"));", "originalCommit": "2d64f37999543ed84df0106bfcf14e36b3041d4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU4OTcwOA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2106#discussion_r457589708", "bodyText": "Check if this can be async first.", "author": "WalshyDev", "createdAt": "2020-07-20T17:54:09Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/gps/ElevatorPlate.java", "diffHunk": "@@ -134,8 +135,12 @@ public void open(Player p, Block b) {\n                         yaw = -180 + (yaw - 180);\n                     }\n \n-                    player.teleport(new Location(player.getWorld(), block.getX() + 0.5, block.getY() + 0.4, block.getZ() + 0.5, yaw, player.getEyeLocation().getPitch()));\n-                    player.sendTitle(ChatColor.WHITE + ChatColors.color(floor), \" \", 20, 60, 20);\n+                    Location destination = new Location(player.getWorld(), block.getX() + 0.5, block.getY() + 0.4, block.getZ() + 0.5, yaw, player.getEyeLocation().getPitch());\n+                    PaperLib.teleportAsync(player, destination).thenAccept(teleported -> {\n+                        if (teleported.booleanValue()) {\n+                            Slimefun.runSync(() -> player.sendTitle(ChatColor.WHITE + ChatColors.color(floor), null, 20, 60, 20));", "originalCommit": "2d64f37999543ed84df0106bfcf14e36b3041d4a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6eebb793144a08b0f9dfbd96912b4d341b5f16e0", "url": "https://github.com/Slimefun/Slimefun4/commit/6eebb793144a08b0f9dfbd96912b4d341b5f16e0", "message": "Fixed", "committedDate": "2020-07-21T07:56:29Z", "type": "commit"}]}