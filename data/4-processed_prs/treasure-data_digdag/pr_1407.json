{"pr_number": 1407, "pr_title": "Use GitHub Actions instead of Travis CI and improve the CI test itself", "pr_createdAt": "2020-05-15T05:39:38Z", "pr_url": "https://github.com/treasure-data/digdag/pull/1407", "timeline": [{"oid": "9cfa48402fa203831e1f2285bb491334556c7c7b", "url": "https://github.com/treasure-data/digdag/commit/9cfa48402fa203831e1f2285bb491334556c7c7b", "message": "Create ci.yml", "committedDate": "2020-05-08T08:00:20Z", "type": "commit"}, {"oid": "20443650db3f5c29085a8a94869b5b750ceca793", "url": "https://github.com/treasure-data/digdag/commit/20443650db3f5c29085a8a94869b5b750ceca793", "message": "Update ci.yml", "committedDate": "2020-05-08T08:39:30Z", "type": "commit"}, {"oid": "ef4f1fe6abf8564e9be1f803bcec1b85d375176c", "url": "https://github.com/treasure-data/digdag/commit/ef4f1fe6abf8564e9be1f803bcec1b85d375176c", "message": "Show stacktrace in docker run", "committedDate": "2020-05-08T09:26:04Z", "type": "commit"}, {"oid": "ebb05f2ae4d16e0e6caa0270ffd0290e4866d91d", "url": "https://github.com/treasure-data/digdag/commit/ebb05f2ae4d16e0e6caa0270ffd0290e4866d91d", "message": "Update ci.yml", "committedDate": "2020-05-08T12:52:50Z", "type": "commit"}, {"oid": "49bc667ba5e13be9bb728ba8d719d610d74a9903", "url": "https://github.com/treasure-data/digdag/commit/49bc667ba5e13be9bb728ba8d719d610d74a9903", "message": "Correct a description about CI_ACCEPTANCE_TEST", "committedDate": "2020-05-08T13:37:07Z", "type": "commit"}, {"oid": "8399642dd7e487d326eedb6ad7489ed06275db23", "url": "https://github.com/treasure-data/digdag/commit/8399642dd7e487d326eedb6ad7489ed06275db23", "message": "Tweak Github Actions workflow config", "committedDate": "2020-05-08T13:37:59Z", "type": "commit"}, {"oid": "5df1f42707feb7de8f9e8013b7273a59a5e1a38c", "url": "https://github.com/treasure-data/digdag/commit/5df1f42707feb7de8f9e8013b7273a59a5e1a38c", "message": "Avoid building all CI nodes with UI", "committedDate": "2020-05-13T05:55:03Z", "type": "commit"}, {"oid": "707477e21c9b74ffb5b5c4faf12d9869ae0c4fcd", "url": "https://github.com/treasure-data/digdag/commit/707477e21c9b74ffb5b5c4faf12d9869ae0c4fcd", "message": "Remove CI on Travis CI", "committedDate": "2020-05-13T05:55:43Z", "type": "commit"}, {"oid": "313002bab6c26c48a167f52d8b86d23bbaa3fa32", "url": "https://github.com/treasure-data/digdag/commit/313002bab6c26c48a167f52d8b86d23bbaa3fa32", "message": "Fix script", "committedDate": "2020-05-13T06:07:38Z", "type": "commit"}, {"oid": "5106f0df4400016b47fe50a68e606d708d731b20", "url": "https://github.com/treasure-data/digdag/commit/5106f0df4400016b47fe50a68e606d708d731b20", "message": "Integrate with Coveralls on Github Actions", "committedDate": "2020-05-13T06:42:02Z", "type": "commit"}, {"oid": "3eb61993739708542f3b98d125809e5bd0db95b0", "url": "https://github.com/treasure-data/digdag/commit/3eb61993739708542f3b98d125809e5bd0db95b0", "message": "Update ci.yml", "committedDate": "2020-05-13T06:48:36Z", "type": "commit"}, {"oid": "8d3119a222a6132ff62dea4736afc5925dcc6523", "url": "https://github.com/treasure-data/digdag/commit/8d3119a222a6132ff62dea4736afc5925dcc6523", "message": "Remove Coveralls integration for now", "committedDate": "2020-05-13T09:42:23Z", "type": "commit"}, {"oid": "db45ac89eba36a9842361635f99a10c0a53d1298", "url": "https://github.com/treasure-data/digdag/commit/db45ac89eba36a9842361635f99a10c0a53d1298", "message": "Update ci.yml", "committedDate": "2020-05-14T05:55:48Z", "type": "commit"}, {"oid": "5207a3223b7b477e3d016f5420e96dba900b7f58", "url": "https://github.com/treasure-data/digdag/commit/5207a3223b7b477e3d016f5420e96dba900b7f58", "message": "Avoid UI build in case of h2 tests", "committedDate": "2020-05-15T06:16:01Z", "type": "commit"}, {"oid": "0d81ed356a8ed62c85fcdbf40a1c9de959e86efa", "url": "https://github.com/treasure-data/digdag/commit/0d81ed356a8ed62c85fcdbf40a1c9de959e86efa", "message": "Use '-x buildUi' instead of '-PwithoutUi'", "committedDate": "2020-06-19T12:06:34Z", "type": "commit"}, {"oid": "187c48d6614013e6f4e08099f36e24407e927ca9", "url": "https://github.com/treasure-data/digdag/commit/187c48d6614013e6f4e08099f36e24407e927ca9", "message": "Update ci.yml\n\nPrevent duplicated CI build", "committedDate": "2020-07-09T08:47:41Z", "type": "commit"}, {"oid": "38b302f0fdff2f6e084e437042702a6a0469ad7a", "url": "https://github.com/treasure-data/digdag/commit/38b302f0fdff2f6e084e437042702a6a0469ad7a", "message": "Update README.md\n\nReplace the badge of Travis CI with Github Action's one", "committedDate": "2020-07-21T06:45:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg3NjkwNA==", "url": "https://github.com/treasure-data/digdag/pull/1407#discussion_r457876904", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \"${BASEDIR}/run_test_h2.sh\" ${WITHOUT_BUILD_UI}\n          \n          \n            \n            \"${BASEDIR}/run_test_h2.sh\" ${BUILD_UI_OPT}\n          \n      \n    \n    \n  \n\nIsn't this line ${BUILD_UI_OPT} instead of ${WITHOUT_BUILD_UI}?", "author": "szyn", "createdAt": "2020-07-21T06:56:01Z", "path": "ci/run_test.sh", "diffHunk": "@@ -9,6 +9,16 @@ if [[ $(( 1 % ${CI_NODE_TOTAL} )) -eq ${CI_NODE_INDEX} ]]; then\n     \"${BASEDIR}/validate.sh\"\n fi\n \n-\"${BASEDIR}/run_test_h2.sh\"\n-\"${BASEDIR}/run_test_pg.sh\"\n+WITH_BUILD_UI=\"\"\n+WITHOUT_BUILD_UI=\"-x buildUi\"\n+\n+# Don't need to build UI always\n+if [[ $(( 2 % ${CI_NODE_TOTAL} )) -eq ${CI_NODE_INDEX} ]]; then\n+  BUILD_UI_OPT=${WITH_BUILD_UI}\n+else\n+  BUILD_UI_OPT=${WITHOUT_BUILD_UI}\n+fi\n+\n+\"${BASEDIR}/run_test_h2.sh\" ${WITHOUT_BUILD_UI}", "originalCommit": "38b302f0fdff2f6e084e437042702a6a0469ad7a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg3OTQ1OQ==", "url": "https://github.com/treasure-data/digdag/pull/1407#discussion_r457879459", "bodyText": "Ah, I think it's enough to build UI either with H2 or PostgreSQL not with the both.", "author": "komamitsu", "createdAt": "2020-07-21T07:01:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg3NjkwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg4MDg2OA==", "url": "https://github.com/treasure-data/digdag/pull/1407#discussion_r457880868", "bodyText": "I see, then please ignore my comment. Thank you for your explanation.", "author": "szyn", "createdAt": "2020-07-21T07:04:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg3NjkwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg4ODE5OQ==", "url": "https://github.com/treasure-data/digdag/pull/1407#discussion_r457888199", "bodyText": "I'll add a comment to clarify my intention :)", "author": "komamitsu", "createdAt": "2020-07-21T07:20:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg3NjkwNA=="}], "type": "inlineReview"}, {"oid": "89f3905195f140dfffb6f26103c00588a8c63f09", "url": "https://github.com/treasure-data/digdag/commit/89f3905195f140dfffb6f26103c00588a8c63f09", "message": "Add a comment", "committedDate": "2020-07-21T07:21:35Z", "type": "commit"}]}