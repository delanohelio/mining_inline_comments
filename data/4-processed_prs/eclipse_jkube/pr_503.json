{"pr_number": 503, "pr_title": "Fix #484: CacheFrom parameter is missing in BuildConfiguration", "pr_createdAt": "2020-11-26T12:48:01Z", "pr_url": "https://github.com/eclipse/jkube/pull/503", "timeline": [{"oid": "e1844e8c7103efaf5ce9aadd727f577bc1b9b71e", "url": "https://github.com/eclipse/jkube/commit/e1844e8c7103efaf5ce9aadd727f577bc1b9b71e", "message": "Fix #484: CacheFrom parameter is missing in BuildConfiguration", "committedDate": "2020-11-27T07:05:39Z", "type": "forcePushed"}, {"oid": "5e3571f4072f802fadc45508b6be9fdb28a363c7", "url": "https://github.com/eclipse/jkube/commit/5e3571f4072f802fadc45508b6be9fdb28a363c7", "message": "Fix #484: CacheFrom parameter is missing in BuildConfiguration", "committedDate": "2020-11-27T07:14:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MDY0NA==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535190644", "bodyText": "Why is implementation here different to that of DMP?\nhttps://github.com/fabric8io/docker-maven-plugin/blob/e7fefdaddd99294d5842ef8c5b16070ce230d29e/src/main/java/io/fabric8/maven/docker/config/handler/property/PropertyConfigHandler.java#L141", "author": "manusa", "createdAt": "2020-12-03T12:33:49Z", "path": "jkube-kit/build/service/docker/src/main/java/org/eclipse/jkube/kit/build/service/docker/config/handler/property/PropertyConfigHandler.java", "diffHunk": "@@ -229,6 +232,7 @@ private BuildConfiguration extractBuildConfiguration(ImageConfiguration fromConf\n                 .cmd(extractArguments(valueProvider, CMD, valueOrNull(config, BuildConfiguration::getCmd)))\n                 .cleanup(valueProvider.getString(CLEANUP, valueOrNull(config, BuildConfiguration::getCleanup)))\n                 .nocache(valueProvider.getBoolean(NOCACHE, valueOrNull(config, BuildConfiguration::getNocache)))\n+                .cacheFrom(extractCacheFrom(valueProvider.getString(CACHEFROM, config == null ? null : (config.getCacheFrom() == null ? null : config.getCacheFrom().toString()))))", "originalCommit": "5e3571f4072f802fadc45508b6be9fdb28a363c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MjgyNg==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535192826", "bodyText": "We're generating builders via lombok, I couldn't add a custom builder method like done in dmp: https://github.com/fabric8io/docker-maven-plugin/blob/e7fefdaddd99294d5842ef8c5b16070ce230d29e/src/main/java/io/fabric8/maven/docker/config/BuildImageConfiguration.java#L465", "author": "rohanKanojia", "createdAt": "2020-12-03T12:37:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MDY0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5Mzc4OA==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535193788", "bodyText": "https://github.com/eclipse/jkube/pull/503/files#r535193232", "author": "manusa", "createdAt": "2020-12-03T12:38:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MDY0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5NDIyOQ==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535194229", "bodyText": "Also, this class (IIRC) is completely useless right now", "author": "manusa", "createdAt": "2020-12-03T12:39:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MDY0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI5NjQ3OQ==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535296479", "bodyText": "Sorry, I don't understand this. Are you talking about PropertyConfigHandler?", "author": "rohanKanojia", "createdAt": "2020-12-03T14:50:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MDY0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTMwNDc1OQ==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535304759", "bodyText": "Yes, I think we have another issue for that. But this class is mostly useless (IIRC). Just for you to keep in mind.", "author": "manusa", "createdAt": "2020-12-03T14:58:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MDY0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MzIzMg==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535193232", "bodyText": "Given this is a list, to improve the builder, maybe we should make this a @Singular (You'll need to tune the name, because cacheFrom is already singular - not standard)", "author": "manusa", "createdAt": "2020-12-03T12:37:58Z", "path": "jkube-kit/config/image/src/main/java/org/eclipse/jkube/kit/config/image/build/BuildConfiguration.java", "diffHunk": "@@ -228,6 +228,8 @@\n   @Setter(AccessLevel.PRIVATE)\n   private File dockerArchiveFile;\n \n+  private List<String> cacheFrom;", "originalCommit": "5e3571f4072f802fadc45508b6be9fdb28a363c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTI5MTQwMQ==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535291401", "bodyText": "Should I rename this to cacheFromList? In Docker REST API spec also has cachefrom name despite it being a JSON array:", "author": "rohanKanojia", "createdAt": "2020-12-03T14:45:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MzIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTMwNzIwMA==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535307200", "bodyText": "No, you need to keep the name so it's compatible with the docs/mojo deserialization (I think).\nIf it's not necessary to keep the name, just rename to caheFroms with a final s. Lombok will generate methods cacheFrom to add entries to the list (in the builder). Also keep in mind that when adding the singular annotation this value will be initialized as an empty list, so whenever we are using the getter, we need to consider the possibility of the list being empty.", "author": "manusa", "createdAt": "2020-12-03T15:00:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MzIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM2MzA0MA==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535363040", "bodyText": "I think I can go ahead and rename the field to cacheFroms", "author": "rohanKanojia", "createdAt": "2020-12-03T15:59:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MzIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM2ODQxNg==", "url": "https://github.com/eclipse/jkube/pull/503#discussion_r535368416", "bodyText": "I really think that this gets populated from the XML provided by <build> element. So probably renaming will break any configuration that uses it. Double check, but I'm afraid name must remain intact.\nYou can configure @Singular to use a different method name @Singular(\"addCacheFrom\") or @Singular(\"cacheFromEntry\") might work well.", "author": "manusa", "createdAt": "2020-12-03T16:06:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE5MzIzMg=="}], "type": "inlineReview"}, {"oid": "fb12beace4bb39464a4494492e8f9c31c251a356", "url": "https://github.com/eclipse/jkube/commit/fb12beace4bb39464a4494492e8f9c31c251a356", "message": "Fix #484: CacheFrom parameter is missing in BuildConfiguration", "committedDate": "2020-12-03T16:48:38Z", "type": "commit"}, {"oid": "c3277d645864cb245e37042fe08bd55add119f07", "url": "https://github.com/eclipse/jkube/commit/c3277d645864cb245e37042fe08bd55add119f07", "message": "Add @Singular annotation to cacheFrom in BuildConfiguration", "committedDate": "2020-12-03T16:48:39Z", "type": "commit"}, {"oid": "c3277d645864cb245e37042fe08bd55add119f07", "url": "https://github.com/eclipse/jkube/commit/c3277d645864cb245e37042fe08bd55add119f07", "message": "Add @Singular annotation to cacheFrom in BuildConfiguration", "committedDate": "2020-12-03T16:48:39Z", "type": "forcePushed"}]}