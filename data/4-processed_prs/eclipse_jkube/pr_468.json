{"pr_number": 468, "pr_title": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode", "pr_createdAt": "2020-11-03T06:51:04Z", "pr_url": "https://github.com/eclipse/jkube/pull/468", "timeline": [{"oid": "d0176a2d8275433d17496a02ccfa81449fb12ac4", "url": "https://github.com/eclipse/jkube/commit/d0176a2d8275433d17496a02ccfa81449fb12ac4", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile", "committedDate": "2020-11-03T07:29:02Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEyMDM2OA==", "url": "https://github.com/eclipse/jkube/pull/468#discussion_r517120368", "bodyText": "nit: Please make it consistent, rename to extractPorts", "author": "manusa", "createdAt": "2020-11-04T06:26:19Z", "path": "jkube-kit/build/api/src/main/java/org/eclipse/jkube/kit/build/api/helper/DockerFileUtil.java", "diffHunk": "@@ -312,4 +317,23 @@ private static String trimSurroundingQuotes(String argStringValue) {\n         }\n         return argStringValue;\n     }\n+\n+    static List<String> getPortsFromDockerFile(File dockerFile) {", "originalCommit": "d0176a2d8275433d17496a02ccfa81449fb12ac4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEyMTAwNA==", "url": "https://github.com/eclipse/jkube/pull/468#discussion_r517121004", "bodyText": "If this is visible for testing, make it private and test using the dependent method (should be easy enough).\nAlso, nit: rename it to be consistent: extractPorts", "author": "manusa", "createdAt": "2020-11-04T06:28:34Z", "path": "jkube-kit/build/api/src/main/java/org/eclipse/jkube/kit/build/api/helper/DockerFileUtil.java", "diffHunk": "@@ -312,4 +317,23 @@ private static String trimSurroundingQuotes(String argStringValue) {\n         }\n         return argStringValue;\n     }\n+\n+    static List<String> getPortsFromDockerFile(File dockerFile) {\n+        Properties properties = new Properties();\n+        try {\n+            return getPortsFromDockerFileLines(extractLines(dockerFile, \"EXPOSE\", properties, null));\n+        } catch (IOException ioException) {\n+            throw new IllegalArgumentException(\"Error in reading Dockerfile\", ioException);\n+        }\n+    }\n+\n+    static List<String> getPortsFromDockerFileLines(List<String[]> dockerLinesContainingExpose) {", "originalCommit": "d0176a2d8275433d17496a02ccfa81449fb12ac4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEyMzA4NA==", "url": "https://github.com/eclipse/jkube/pull/468#discussion_r517123084", "bodyText": "Use a corner-case scenario to validate it works as expected:\n\nAdd several EXPOSE lines (top of the document, bottom, in the middle lines).\nAdd expose using all possible formats: EXPOSE 80, EXPOSE 80/http, EXPOSE 99/udp, EXPOSE 8080...\nAdd duplicate EXPOSE values", "author": "manusa", "createdAt": "2020-11-04T06:35:31Z", "path": "jkube-kit/build/api/src/test/resources/docker/Dockerfile_expose_ports", "diffHunk": "@@ -0,0 +1,7 @@\n+ARG VERSION=latest\n+FROM openjdk:$VERSION\n+COPY maven/target/docker-file-simple.jar /deployments/docker-file-simple.jar\n+# Copying a file inside project root directory\n+COPY maven/static-dir-in-project-root/my-file.txt /deployments/my-file.txt\n+EXPOSE 8080", "originalCommit": "d0176a2d8275433d17496a02ccfa81449fb12ac4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5abe78535105dc144aa3ba72807823e036b62b73", "url": "https://github.com/eclipse/jkube/commit/5abe78535105dc144aa3ba72807823e036b62b73", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile", "committedDate": "2020-11-04T13:33:18Z", "type": "forcePushed"}, {"oid": "f654d8198b15ecca080112d97f6196db3d816761", "url": "https://github.com/eclipse/jkube/commit/f654d8198b15ecca080112d97f6196db3d816761", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile", "committedDate": "2020-11-04T13:34:19Z", "type": "forcePushed"}, {"oid": "4a93076c810e5781c9dcc50cb4f0a953ace985e3", "url": "https://github.com/eclipse/jkube/commit/4a93076c810e5781c9dcc50cb4f0a953ace985e3", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile", "committedDate": "2020-11-04T14:47:51Z", "type": "commit"}, {"oid": "4a93076c810e5781c9dcc50cb4f0a953ace985e3", "url": "https://github.com/eclipse/jkube/commit/4a93076c810e5781c9dcc50cb4f0a953ace985e3", "message": "Fix #240: No Ports exposed inside Deployment in case of Zero Config Dockerfile Mode\n\nAdd ports to ImageConfiguration generated in DockerFileUtil.createSimpleDockerfileConfig\nby parsing contents of Dockerfile", "committedDate": "2020-11-04T14:47:51Z", "type": "forcePushed"}]}