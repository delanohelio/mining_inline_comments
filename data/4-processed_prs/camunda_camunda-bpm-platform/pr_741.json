{"pr_number": 741, "pr_title": "CAM-11552: feat(open-api): add task id-link endpoints", "pr_createdAt": "2020-03-18T16:45:38Z", "pr_url": "https://github.com/camunda/camunda-bpm-platform/pull/741", "timeline": [{"oid": "8613be0f46ec3a920f20f4c0a1b631b8dd0274d9", "url": "https://github.com/camunda/camunda-bpm-platform/commit/8613be0f46ec3a920f20f4c0a1b631b8dd0274d9", "message": "feat(open-api): add task id-link endpoints\n\nRelated to CAM-11552", "committedDate": "2020-03-20T10:45:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ4OTM4Mg==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/741#discussion_r396489382", "bodyText": "Maybe this is incorrect, but my understanding of the IdentityLink documentation is that the type can be any String and those enum-values are just the ones the engine can handle by default.\nIf this is the case we would restrict this endpoint to only those three types.", "author": "mboskamp", "createdAt": "2020-03-23T14:25:02Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/models/org/camunda/bpm/engine/rest/dto/runtime/task/IdentityLinkDto.ftl", "diffHunk": "@@ -0,0 +1,21 @@\n+<@lib.dto required = [\"type\"] >\n+\n+    <@lib.property\n+        name = \"userId\"\n+        type = \"string\"\n+        desc = \"The id of the user participating in this link. Either `userId` or `groupId` is set.\" />\n+\n+    <@lib.property\n+        name = \"groupId\"\n+        type = \"string\"\n+        desc = \"The id of the group participating in this link. Either `groupId` or `userId` is set.\" />\n+\n+    <@lib.property\n+        name = \"type\"\n+        type = \"string\"\n+        enumValues = ['\"assignee\"', '\"candidate\"', '\"owner\"']", "originalCommit": "8613be0f46ec3a920f20f4c0a1b631b8dd0274d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU2MjQ4OQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/741#discussion_r396562489", "bodyText": "I agree it's technically possible to create additional, custom Task-User relationships, and we shouldn't restrict the values to the default three.\nI will remove the enumValues and reference the engine-native values in the description.", "author": "koevskinikola", "createdAt": "2020-03-23T15:59:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ4OTM4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ5NzU4OA==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/741#discussion_r396497588", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    desc = \"Task with given id does not exist. See the [Introduction](/reference/rest/overview/#error-handling)\n          \n          \n            \n                    desc = \"Task with given id does not exist. See the [Introduction](${docsUrl}/reference/rest/overview/#error-handling)", "author": "mboskamp", "createdAt": "2020-03-23T14:36:11Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/task/{id}/identity-links/get.ftl", "diffHunk": "@@ -0,0 +1,62 @@\n+{\n+\n+  <@lib.endpointInfo\n+      id = \"getIdentityLinks\"\n+      tag = \"Identity Link\"\n+      desc = \"Gets the identity links for a task by id, which are the users and groups that are in\n+              *some* relation to it (including assignee and owner).\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"id\"\n+        location = \"path\"\n+        type = \"string\"\n+        required = true\n+        desc = \"The id of the task to retrieve the identity links for.\"/>\n+\n+    <@lib.parameter\n+        name = \"type\"\n+        location = \"query\"\n+        type = \"string\"\n+        last = true\n+        desc = \"Filter by the type of links to include.\"/>\n+  ],\n+\n+  \"responses\" : {\n+\n+    <@lib.response\n+        code = \"200\"\n+        dto = \"IdentityLinkDto\"\n+        array = true\n+        desc = \"Request successful.\"\n+        examples = ['\"example-1\": {\n+                       \"summary\": \"GET /task/anId/identityLinks\",\n+                       \"value\": [\n+                         {\n+                           \"userId\": \"userId\",\n+                           \"groupId\": null,\n+                           \"type\": \"assignee\"\n+                         },\n+                         {\n+                           \"userId\": null,\n+                           \"groupId\": \"groupId1\",\n+                           \"type\": \"candidate\"\n+                         },\n+                         {\n+                           \"userId\": null,\n+                           \"groupId\": \"groupId2\",\n+                           \"type\": \"candidate\"\n+                         }\n+                       ]\n+                     }']/>\n+\n+    <@lib.response\n+        code = \"400\"\n+        dto = \"ExceptionDto\"\n+        last = true\n+        desc = \"Task with given id does not exist. See the [Introduction](/reference/rest/overview/#error-handling)", "originalCommit": "8613be0f46ec3a920f20f4c0a1b631b8dd0274d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUwMTQzNg==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/741#discussion_r396501436", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    desc = \"Task with given id does not exist. See the [Introduction](/reference/rest/overview/#error-handling)\n          \n          \n            \n                    desc = \"Task with given id does not exist. See the [Introduction](${docsUrl}/reference/rest/overview/#error-handling)", "author": "mboskamp", "createdAt": "2020-03-23T14:41:17Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/task/{id}/identity-links/delete/post.ftl", "diffHunk": "@@ -0,0 +1,45 @@\n+{\n+\n+  <@lib.endpointInfo\n+      id = \"deleteIdentityLink\"\n+      tag = \"Identity Link\"\n+      desc = \"Removes an identity link from a task by id\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"id\"\n+        location = \"path\"\n+        type = \"string\"\n+        required = true\n+        last = true\n+        desc = \"The id of the task to remove a link from.\"/>\n+\n+  ],\n+\n+  <@lib.requestBody\n+      mediaType = \"application/json\"\n+      dto = \"IdentityLinkDto\"\n+      examples = ['\"example-1\": {\n+                       \"summary\": \"POST `/task/anId/identityLinks/delete`\",\n+                       \"value\": {\n+                         \"groupId\": \"theOldGroupId\",\n+                         \"type\": \"candidate\"\n+                       }\n+                     }'] />\n+\n+  \"responses\" : {\n+\n+    <@lib.response\n+        code = \"204\"\n+        desc = \"Request successful.\" />\n+\n+    <@lib.response\n+        code = \"400\"\n+        dto = \"ExceptionDto\"\n+        last = true\n+        desc = \"Task with given id does not exist. See the [Introduction](/reference/rest/overview/#error-handling)", "originalCommit": "8613be0f46ec3a920f20f4c0a1b631b8dd0274d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUwNTYzMQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/741#discussion_r396505631", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    desc = \"Task with given id does not exist. See the [Introduction](/reference/rest/overview/#error-handling)\n          \n          \n            \n                    desc = \"Task with given id does not exist. See the [Introduction](${docsUrl}/reference/rest/overview/#error-handling)", "author": "mboskamp", "createdAt": "2020-03-23T14:46:48Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/task/{id}/identity-links/post.ftl", "diffHunk": "@@ -0,0 +1,46 @@\n+{\n+\n+  <@lib.endpointInfo\n+      id = \"addIdentityLink\"\n+      tag = \"Identity Link\"\n+      desc = \"Adds an identity link to a task by id. Can be used to link any user or group to a task\n+              and specify a relation.\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"id\"\n+        location = \"path\"\n+        type = \"string\"\n+        required = true\n+        last = true\n+        desc = \"The id of the task to add a link to.\"/>\n+\n+  ],\n+\n+  <@lib.requestBody\n+      mediaType = \"application/json\"\n+      dto = \"IdentityLinkDto\"\n+      examples = ['\"example-1\": {\n+                       \"summary\": \"POST `/task/anId/identity-links`\",\n+                       \"value\": {\n+                         \"groupId\": \"aNewGroupId\",\n+                         \"type\": \"candidate\"\n+                       }\n+                     }'] />\n+\n+  \"responses\" : {\n+\n+    <@lib.response\n+        code = \"204\"\n+        desc = \"Request successful.\" />\n+\n+    <@lib.response\n+        code = \"400\"\n+        dto = \"ExceptionDto\"\n+        last = true\n+        desc = \"Task with given id does not exist. See the [Introduction](/reference/rest/overview/#error-handling)", "originalCommit": "8613be0f46ec3a920f20f4c0a1b631b8dd0274d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU4MDIxNw==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/741#discussion_r396580217", "bodyText": "I'll use this line to reply to the general review comment:\nYes, the IdentityLinkDto properties are documented in three different ways in the endpoints. That's why I decided to generalize them. This one varies the most.\n\nAs I mentioned, I will expand the description, by adding the default engine relationships (and remove the enumValues).\n\nRegarding the required type, we actually do validate the presence of the property, it's just buried pretty deep in the code \ud83d\ude04. You can find the validations here:\n\nhttps://github.com/camunda/camunda-bpm-platform/blob/master/engine/src/main/java/org/camunda/bpm/engine/impl/cmd/AddIdentityLinkCmd.java#L60\nhttps://github.com/camunda/camunda-bpm-platform/blob/master/engine/src/main/java/org/camunda/bpm/engine/impl/cmd/DeleteIdentityLinkCmd.java#L61", "author": "koevskinikola", "createdAt": "2020-03-23T16:23:01Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/models/org/camunda/bpm/engine/rest/dto/runtime/task/IdentityLinkDto.ftl", "diffHunk": "@@ -0,0 +1,21 @@\n+<@lib.dto required = [\"type\"] >\n+\n+    <@lib.property\n+        name = \"userId\"\n+        type = \"string\"\n+        desc = \"The id of the user participating in this link. Either `userId` or `groupId` is set.\" />\n+\n+    <@lib.property\n+        name = \"groupId\"\n+        type = \"string\"\n+        desc = \"The id of the group participating in this link. Either `groupId` or `userId` is set.\" />\n+\n+    <@lib.property\n+        name = \"type\"\n+        type = \"string\"\n+        enumValues = ['\"assignee\"', '\"candidate\"', '\"owner\"']\n+        last = true\n+        desc = \"The type of the identity link. Can be any defined type. `assignee` and `owner`", "originalCommit": "26895893375cf2da507cf33fba48b939a434b734", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d5836790bc8d71b5b3fdffe0437c4360272528fa", "url": "https://github.com/camunda/camunda-bpm-platform/commit/d5836790bc8d71b5b3fdffe0437c4360272528fa", "message": "feat(open-api): add task id-link endpoints\n\nRelated to CAM-11552", "committedDate": "2020-03-24T07:32:20Z", "type": "commit"}, {"oid": "313b13bcd1ab884528b75ff6a391f3adf63e10c0", "url": "https://github.com/camunda/camunda-bpm-platform/commit/313b13bcd1ab884528b75ff6a391f3adf63e10c0", "message": "SQUASH ME: implement review hints", "committedDate": "2020-03-24T08:35:21Z", "type": "forcePushed"}, {"oid": "d9af98fa6b39bb1b6ea7b228afd71f09321fc3a0", "url": "https://github.com/camunda/camunda-bpm-platform/commit/d9af98fa6b39bb1b6ea7b228afd71f09321fc3a0", "message": "SQUASH ME: implement review hints", "committedDate": "2020-03-24T08:41:26Z", "type": "commit"}, {"oid": "d9af98fa6b39bb1b6ea7b228afd71f09321fc3a0", "url": "https://github.com/camunda/camunda-bpm-platform/commit/d9af98fa6b39bb1b6ea7b228afd71f09321fc3a0", "message": "SQUASH ME: implement review hints", "committedDate": "2020-03-24T08:41:26Z", "type": "forcePushed"}]}