{"pr_number": 791, "pr_title": "CAM-11186: add new pricing model metrics", "pr_createdAt": "2020-04-20T15:11:02Z", "pr_url": "https://github.com/camunda/camunda-bpm-platform/pull/791", "timeline": [{"oid": "7356c20368b0b0b94b17dd4602687837fa1f6028", "url": "https://github.com/camunda/camunda-bpm-platform/commit/7356c20368b0b0b94b17dd4602687837fa1f6028", "message": "feat(engine-dmn): add executed decision instances metrics\n\nRelated to CAM-11186", "committedDate": "2020-04-20T15:08:34Z", "type": "commit"}, {"oid": "14f80316ad47c495f6c5d49260df5ad223b8dcaa", "url": "https://github.com/camunda/camunda-bpm-platform/commit/14f80316ad47c495f6c5d49260df5ad223b8dcaa", "message": "feat(engine): add root process instance metrics", "committedDate": "2020-04-20T15:08:48Z", "type": "commit"}, {"oid": "3ca033eab756a1d41d222281dd41f195211c454a", "url": "https://github.com/camunda/camunda-bpm-platform/commit/3ca033eab756a1d41d222281dd41f195211c454a", "message": "chore(engine): refactor junit3 metrics tests\n\nRelated to CAM-11186", "committedDate": "2020-04-20T15:08:48Z", "type": "commit"}, {"oid": "023b2d2f108e3a013986cfd824c4b27e8f866542", "url": "https://github.com/camunda/camunda-bpm-platform/commit/023b2d2f108e3a013986cfd824c4b27e8f866542", "message": "feat(engine): add tests for new pricing model metrics\n\nRelated to CAM-11186", "committedDate": "2020-04-20T15:08:48Z", "type": "commit"}, {"oid": "00e18d235afcd579b34e6fdfabb4590511a186f1", "url": "https://github.com/camunda/camunda-bpm-platform/commit/00e18d235afcd579b34e6fdfabb4590511a186f1", "message": "SQUASH ME: adjust metrics test", "committedDate": "2020-04-22T11:51:58Z", "type": "commit"}, {"oid": "00e18d235afcd579b34e6fdfabb4590511a186f1", "url": "https://github.com/camunda/camunda-bpm-platform/commit/00e18d235afcd579b34e6fdfabb4590511a186f1", "message": "SQUASH ME: adjust metrics test", "committedDate": "2020-04-22T11:51:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgxNTA1MQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/791#discussion_r415815051", "bodyText": "It's more robust to flip the operands of the comparison. An execution always has an ID, but an execution may not have a root process instance id (consider a migration case where a process instance was started in an old Camuna version without a root process instance id, and it executes a call activity in 7.13).", "author": "ThorbenLindhauer", "createdAt": "2020-04-27T13:32:01Z", "path": "engine/src/main/java/org/camunda/bpm/engine/impl/metrics/parser/MetricsBpmnParseListener.java", "diffHunk": "@@ -18,25 +18,41 @@\n \n import org.camunda.bpm.engine.delegate.ExecutionListener;\n import org.camunda.bpm.engine.impl.bpmn.parser.AbstractBpmnParseListener;\n+import org.camunda.bpm.engine.impl.persistence.entity.ExecutionEntity;\n+import org.camunda.bpm.engine.impl.persistence.entity.ProcessDefinitionEntity;\n import org.camunda.bpm.engine.impl.pvm.process.ActivityImpl;\n import org.camunda.bpm.engine.impl.pvm.process.ScopeImpl;\n import org.camunda.bpm.engine.impl.util.xml.Element;\n import org.camunda.bpm.engine.management.Metrics;\n+import org.camunda.bpm.engine.runtime.Execution;\n \n /**\n  * @author Daniel Meyer\n  *\n  */\n public class MetricsBpmnParseListener extends AbstractBpmnParseListener {\n \n-  public static MetricsExecutionListener ACTIVITY_INSTANCE_START_COUNTER = new MetricsExecutionListener(Metrics.ACTIVTY_INSTANCE_START);\n-  public static MetricsExecutionListener ACTIVITY_INSTANCE_END_COUNTER = new MetricsExecutionListener(Metrics.ACTIVTY_INSTANCE_END);\n+  public static MetricsExecutionListener ROOT_PROCESS_INSTANCE_START_COUNTER =\n+      new MetricsExecutionListener(Metrics.ROOT_PROCESS_INSTANCE_START,\n+                                   delegateExecution -> ((ExecutionEntity) delegateExecution)\n+                                       .getRootProcessInstanceId()\n+                                       .equals(delegateExecution.getId()));", "originalCommit": "14f80316ad47c495f6c5d49260df5ad223b8dcaa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d035de463df4ac3c3fe92bd90706911bd749bb7f", "url": "https://github.com/camunda/camunda-bpm-platform/commit/d035de463df4ac3c3fe92bd90706911bd749bb7f", "message": "SQUASH ME: implement review hints", "committedDate": "2020-04-28T11:13:46Z", "type": "commit"}]}