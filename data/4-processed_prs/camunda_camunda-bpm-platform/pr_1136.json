{"pr_number": 1136, "pr_title": "chore(ce-pipeline): adjust archiveArtifacts for ee pipe", "pr_createdAt": "2020-11-20T09:56:32Z", "pr_url": "https://github.com/camunda/camunda-bpm-platform/pull/1136", "timeline": [{"oid": "89474fbce1f699ebf8da588e380b84aaa6f3ad89", "url": "https://github.com/camunda/camunda-bpm-platform/commit/89474fbce1f699ebf8da588e380b84aaa6f3ad89", "message": "test branch", "committedDate": "2020-11-20T11:53:32Z", "type": "forcePushed"}, {"oid": "c42d7bbe7c71559667ce2f7120ecb4b939d28c37", "url": "https://github.com/camunda/camunda-bpm-platform/commit/c42d7bbe7c71559667ce2f7120ecb4b939d28c37", "message": "test branch", "committedDate": "2020-11-20T12:01:51Z", "type": "forcePushed"}, {"oid": "fef57f631ec20b9ee8985d39ce79bd9165303077", "url": "https://github.com/camunda/camunda-bpm-platform/commit/fef57f631ec20b9ee8985d39ce79bd9165303077", "message": "test branch", "committedDate": "2020-11-20T12:05:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzY4MzE5MA==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/1136#discussion_r527683190", "bodyText": "Note: this will only work if a branch with the same name exists on the EE repo.\nI think that this is acceptable at the current state of development. We can think later how we handle the other use-cases.", "author": "koevskinikola", "createdAt": "2020-11-20T13:16:17Z", "path": "Jenkinsfile", "diffHunk": "@@ -55,31 +55,27 @@ pipeline {\n       }\n       steps {\n         withMaven(jdk: 'jdk-8-latest', maven: 'maven-3.2-latest', mavenSettingsConfig: 'maven-nexus-settings') {\n-          sh '''\n-            mvn --version\n-            java -version\n-          '''\n           nodejs('nodejs-14.6.0'){\n-            sh '''\n-              node -v\n-              npm version\n-            '''\n              configFileProvider([configFile(fileId: 'maven-nexus-settings', variable: 'MAVEN_SETTINGS_XML')]) {\n                sh \"\"\"\n                  mvn -s \\$MAVEN_SETTINGS_XML clean install source:jar -Pdistro,distro-ce,distro-wildfly,distro-webjar -DskipTests -Dmaven.repo.local=\\$(pwd)/.m2 com.mycila:license-maven-plugin:check -B\n                \"\"\"\n              }\n           }\n-\n-          archiveArtifacts artifacts: '.m2/org/camunda/**/*-SNAPSHOT/**', excludes: '**/*.zip,**/*.tar.gz', followSymlinks: false\n-\n+    \n+          archiveArtifacts artifacts: '.m2/org/camunda/**/*-SNAPSHOT/**/*.jar,.m2/org/camunda/**/*-SNAPSHOT/**/*.pom,.m2/org/camunda/**/*-SNAPSHOT/**/*.xml,.m2/org/camunda/**/*-SNAPSHOT/**/*.txt,.m2/org/camunda/**/*-SNAPSHOT/**/camunda-webapp*frontend-sources.zip', followSymlinks: false\n+          archiveArtifacts artifacts: '.m2/org/camunda/**/camunda-webapp*frontend-sources.zip,.m2/org/camunda/**/license-book*.zip,.m2/org/camunda/**/camunda-webapp*.war,.m2/org/camunda/**/camunda-engine-rest*.war,.m2/org/camunda/**/camunda-example-invoice*.war,.m2/org/camunda/**/camunda-h2-webapp*.war,.m2/org/camunda/**/*-SNAPSHOT/**/*.tar.gz,.m2/org/camunda/**/*-SNAPSHOT/**/camunda-jboss-modules*.zip', followSymlinks: false\n+    \n           stash name: \"platform-stash-runtime\", includes: \".m2/org/camunda/**/*-SNAPSHOT/**\", excludes: \"**/qa/**,**/*qa*/**,**/*.zip,**/*.tar.gz\"\n-          // stash name: \"platform-stash-qa\", includes: \".m2/org/camunda/bpm/**/qa/**/*-SNAPSHOT/**,.m2/org/camunda/bpm/**/*qa*/**/*-SNAPSHOT/**\", excludes: \"**/*.zip,**/*.tar.gz\"\n+          stash name: \"platform-stash-qa\", includes: \".m2/org/camunda/bpm/**/qa/**/*-SNAPSHOT/**,.m2/org/camunda/bpm/**/*qa*/**/*-SNAPSHOT/**\", excludes: \"**/*.zip,**/*.tar.gz\"\n           stash name: \"platform-stash-distro\", includes: \".m2/org/camunda/bpm/**/*-SNAPSHOT/**/*.zip,.m2/org/camunda/bpm/**/*-SNAPSHOT/**/*.tar.gz\"\n          }\n-\n-        build job: 'cambpm-jenkins-pipelines-ee/pipeline-master', parameters: [string(name: 'copyArtifactSelector', value: '<TriggeredBuildSelector plugin=\"copyartifact@1.45.1\">  <upstreamFilterStrategy>UseGlobalSetting</upstreamFilterStrategy>  <allowUpstreamDependencies>false</allowUpstreamDependencies></TriggeredBuildSelector>'), booleanParam(name: 'STANDALONE', value: false)], quietPeriod: 10, wait: false\n-\n+    \n+        build job: \"cambpm-jenkins-pipelines-ee/${env.BRANCH_NAME}\", parameters: [ ", "originalCommit": "48cc2eae45529be7d0ac41fa451246ed2530aaa1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzcwNzc2MQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/1136#discussion_r527707761", "bodyText": "Let's add code comments to these two lines, so that it's clear what patterns should be added to each.\nWe should also be consistent with the -SNAPSHOT pattern, and use it in both places or in none of them.\nAlso, the camunda-webapp*frontend-sources.zip pattern is duplicated in both lines.", "author": "koevskinikola", "createdAt": "2020-11-20T13:58:53Z", "path": "Jenkinsfile", "diffHunk": "@@ -55,31 +55,27 @@ pipeline {\n       }\n       steps {\n         withMaven(jdk: 'jdk-8-latest', maven: 'maven-3.2-latest', mavenSettingsConfig: 'maven-nexus-settings') {\n-          sh '''\n-            mvn --version\n-            java -version\n-          '''\n           nodejs('nodejs-14.6.0'){\n-            sh '''\n-              node -v\n-              npm version\n-            '''\n              configFileProvider([configFile(fileId: 'maven-nexus-settings', variable: 'MAVEN_SETTINGS_XML')]) {\n                sh \"\"\"\n                  mvn -s \\$MAVEN_SETTINGS_XML clean install source:jar -Pdistro,distro-ce,distro-wildfly,distro-webjar -DskipTests -Dmaven.repo.local=\\$(pwd)/.m2 com.mycila:license-maven-plugin:check -B\n                \"\"\"\n              }\n           }\n-\n-          archiveArtifacts artifacts: '.m2/org/camunda/**/*-SNAPSHOT/**', excludes: '**/*.zip,**/*.tar.gz', followSymlinks: false\n-\n+    \n+          archiveArtifacts artifacts: '.m2/org/camunda/**/*-SNAPSHOT/**/*.jar,.m2/org/camunda/**/*-SNAPSHOT/**/*.pom,.m2/org/camunda/**/*-SNAPSHOT/**/*.xml,.m2/org/camunda/**/*-SNAPSHOT/**/*.txt,.m2/org/camunda/**/*-SNAPSHOT/**/camunda-webapp*frontend-sources.zip', followSymlinks: false\n+          archiveArtifacts artifacts: '.m2/org/camunda/**/camunda-webapp*frontend-sources.zip,.m2/org/camunda/**/license-book*.zip,.m2/org/camunda/**/camunda-webapp*.war,.m2/org/camunda/**/camunda-engine-rest*.war,.m2/org/camunda/**/camunda-example-invoice*.war,.m2/org/camunda/**/camunda-h2-webapp*.war,.m2/org/camunda/**/*-SNAPSHOT/**/*.tar.gz,.m2/org/camunda/**/*-SNAPSHOT/**/camunda-jboss-modules*.zip', followSymlinks: false", "originalCommit": "48cc2eae45529be7d0ac41fa451246ed2530aaa1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c9787bc45cc29d17326c73f541689c23801d2553", "url": "https://github.com/camunda/camunda-bpm-platform/commit/c9787bc45cc29d17326c73f541689c23801d2553", "message": "fix local repo\n\nadd configFileProvider\n\nfix branches\n\nadd nsu option\n\nadd debug\n\nremove unstash\n\nfix repo\n\nreturn assembly\n\ntest\n\ntest\n\ncheck repo\n\ntest\n\nfix\n\nadd qa and distro stashes", "committedDate": "2020-11-23T12:23:35Z", "type": "commit"}, {"oid": "bf64f8776eed2191d56228c09dd9ddcf4296df81", "url": "https://github.com/camunda/camunda-bpm-platform/commit/bf64f8776eed2191d56228c09dd9ddcf4296df81", "message": "return pipeline-master reference\n\ntest archiveArtifacts\n\nrevert test\n\nadd frontend-sources\n\nadjust artifact pattern\n\nadd webapp war\n\nadd license book zip\n\nadd branch resolve\n\ntest branch\n\narchive more artifacts", "committedDate": "2020-11-23T12:23:38Z", "type": "commit"}, {"oid": "f040d28f9d5cfe4d45b057b42ee937f700d8724b", "url": "https://github.com/camunda/camunda-bpm-platform/commit/f040d28f9d5cfe4d45b057b42ee937f700d8724b", "message": "adjust archiveArtifacts", "committedDate": "2020-11-23T12:23:38Z", "type": "commit"}, {"oid": "a87aa061977ea2fc15ec7f8227c4400ad1e9cce3", "url": "https://github.com/camunda/camunda-bpm-platform/commit/a87aa061977ea2fc15ec7f8227c4400ad1e9cce3", "message": "wip", "committedDate": "2020-11-23T12:23:38Z", "type": "forcePushed"}, {"oid": "d08700e4645de9f49e4b408eda056424b4a167da", "url": "https://github.com/camunda/camunda-bpm-platform/commit/d08700e4645de9f49e4b408eda056424b4a167da", "message": "wip", "committedDate": "2020-11-23T12:28:35Z", "type": "commit"}, {"oid": "d08700e4645de9f49e4b408eda056424b4a167da", "url": "https://github.com/camunda/camunda-bpm-platform/commit/d08700e4645de9f49e4b408eda056424b4a167da", "message": "wip", "committedDate": "2020-11-23T12:28:35Z", "type": "forcePushed"}, {"oid": "7038a72b8cce1a670f789b8810c9ca5b28de1b1b", "url": "https://github.com/camunda/camunda-bpm-platform/commit/7038a72b8cce1a670f789b8810c9ca5b28de1b1b", "message": "wip", "committedDate": "2020-11-23T12:40:07Z", "type": "forcePushed"}, {"oid": "a53cb9634d94c876bfa8e09c2fe295e075ebeed7", "url": "https://github.com/camunda/camunda-bpm-platform/commit/a53cb9634d94c876bfa8e09c2fe295e075ebeed7", "message": "wip", "committedDate": "2020-11-23T12:42:20Z", "type": "commit"}, {"oid": "a53cb9634d94c876bfa8e09c2fe295e075ebeed7", "url": "https://github.com/camunda/camunda-bpm-platform/commit/a53cb9634d94c876bfa8e09c2fe295e075ebeed7", "message": "wip", "committedDate": "2020-11-23T12:42:20Z", "type": "forcePushed"}]}