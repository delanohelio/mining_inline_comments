{"pr_number": 892, "pr_title": "CAM-12149: migration of JUnit 3 tests to JUnit 4", "pr_createdAt": "2020-07-10T07:02:17Z", "pr_url": "https://github.com/camunda/camunda-bpm-platform/pull/892", "timeline": [{"oid": "aef1dd8dfc193a381345e7366e41412c6ae86e55", "url": "https://github.com/camunda/camunda-bpm-platform/commit/aef1dd8dfc193a381345e7366e41412c6ae86e55", "message": "fix(test): make CompetingHistoryCleanupAcquisitionTest work with junit4", "committedDate": "2020-07-10T14:21:09Z", "type": "forcePushed"}, {"oid": "66f7cdca1204d8af5b9c521ee14071c2f6e9873c", "url": "https://github.com/camunda/camunda-bpm-platform/commit/66f7cdca1204d8af5b9c521ee14071c2f6e9873c", "message": "chore(test): migrate JPAVariableTest to juint4", "committedDate": "2020-07-13T19:26:10Z", "type": "forcePushed"}, {"oid": "d9403294f77a6777af46a126246d5da510f5b27c", "url": "https://github.com/camunda/camunda-bpm-platform/commit/d9403294f77a6777af46a126246d5da510f5b27c", "message": "chore(test): refactor concurrency tests", "committedDate": "2020-07-14T19:59:55Z", "type": "forcePushed"}, {"oid": "ce2259ee2496f7b85a3930816e96a933b1d612c0", "url": "https://github.com/camunda/camunda-bpm-platform/commit/ce2259ee2496f7b85a3930816e96a933b1d612c0", "message": "chore(test): refactor concurrency tests", "committedDate": "2020-07-14T20:06:09Z", "type": "forcePushed"}, {"oid": "02d5038266d9d4706d1fa8f0b98cb2d721158611", "url": "https://github.com/camunda/camunda-bpm-platform/commit/02d5038266d9d4706d1fa8f0b98cb2d721158611", "message": "chore(test): optimize imports", "committedDate": "2020-07-14T20:27:23Z", "type": "forcePushed"}, {"oid": "36f44cccb5777323fde565beb9fdc24eb282e205", "url": "https://github.com/camunda/camunda-bpm-platform/commit/36f44cccb5777323fde565beb9fdc24eb282e205", "message": "chore(test): port PmvTestCase & TestCase tests to JUnit4", "committedDate": "2020-07-20T11:27:57Z", "type": "forcePushed"}, {"oid": "1d1d2898111ab9367473d26ee573304e79ab5b30", "url": "https://github.com/camunda/camunda-bpm-platform/commit/1d1d2898111ab9367473d26ee573304e79ab5b30", "message": "feat(test): refactor ProvidedProcessEngineRule class\n\n* Move the cached Process Engine from the PluggableProcessEngineTestCase\n  to the ProvidedProcessEngineRule.", "committedDate": "2020-07-20T15:58:46Z", "type": "forcePushed"}, {"oid": "0e27679cdb6deb08080ded4924b5101da96ce071", "url": "https://github.com/camunda/camunda-bpm-platform/commit/0e27679cdb6deb08080ded4924b5101da96ce071", "message": "chore(engine): replace PluggableProcessEngineTestCase\n\n* Replace PluggableProcessEngineTestCase with a test (source) class.\n  This will allow us to do larger changes to the base Test class without\nimpacting users that may be using the Runtime class.\n* Refactor test classes that use the runtime class with the new test\n  class.\n\nRelated to CAM-12149", "committedDate": "2020-07-23T19:44:40Z", "type": "commit"}, {"oid": "403b9d4a083e432f796476396e906ba0de4d970f", "url": "https://github.com/camunda/camunda-bpm-platform/commit/403b9d4a083e432f796476396e906ba0de4d970f", "message": "chore(engine): replace ResourceProcessEngineTestCase\n\nRelated to CAM-12149", "committedDate": "2020-07-23T19:45:33Z", "type": "commit"}, {"oid": "89efbd2593effbf0c28114fdb7d62171b1a7c2a7", "url": "https://github.com/camunda/camunda-bpm-platform/commit/89efbd2593effbf0c28114fdb7d62171b1a7c2a7", "message": "chore(engine): replace CmmnProcessEngineTestCase\n\nRelated to CAM-12149", "committedDate": "2020-07-23T19:46:05Z", "type": "commit"}, {"oid": "31a6b740f95531ee16583f7317affbe90c1df133", "url": "https://github.com/camunda/camunda-bpm-platform/commit/31a6b740f95531ee16583f7317affbe90c1df133", "message": "chore(readme): update test writing instructions\n\nRelated to CAM-12149", "committedDate": "2020-07-23T20:00:30Z", "type": "forcePushed"}, {"oid": "454d60ede9605285978a373420beb74c15794a69", "url": "https://github.com/camunda/camunda-bpm-platform/commit/454d60ede9605285978a373420beb74c15794a69", "message": "chore(readme): update test writing instructions\n\nRelated to CAM-12149", "committedDate": "2020-07-23T20:03:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkxNDIzMQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/892#discussion_r459914231", "bodyText": "Do we really want to discourage using PluggableProcessEngineTest? It contains some common code that is quite handy to simply reuse (e.g. assigning the services to fields) instead of duplicating it.", "author": "ThorbenLindhauer", "createdAt": "2020-07-24T08:17:32Z", "path": "CONTRIBUTING.md", "diffHunk": "@@ -51,18 +51,19 @@ Best practices for writing test cases:\n   ```\n * Project `camunda-engine`: If you need a process engine with custom configuration, use the JUnit rule `org.camunda.bpm.engine.test.util.ProcessEngineBootstrapRule` and chain it with `org.camunda.bpm.engine.test.util.ProvidedProcessEngineRule` like so:\n   ```\n-  protected ProcessEngineBootstrapRule bootstrapRule = new ProcessEngineBootstrapRule() {\n-    public ProcessEngineConfiguration configureEngine(ProcessEngineConfigurationImpl configuration) {\n+  protected ProcessEngineBootstrapRule bootstrapRule = new ProcessEngineBootstrapRule(configuration -> {\n       // apply configuration options here\n-\n-      return configuration;\n-    }\n-  };\n+  });\n   protected ProvidedProcessEngineRule engineRule = new ProvidedProcessEngineRule(bootstrapRule);\n \n   @Rule\n   public RuleChain ruleChain = RuleChain.outerRule(bootstrapRule).around(engineRule);\n   ```\n+* Some Test classes extend the `org.camunda.bpm.engine.test.util.PluggableProcessEngineTest` class. This is a \n+  compatibility class to ease the transition of Test classes from JUnit3 to JUnit4. If you need to modify the \n+  `ProcessEngineConfiguration` in a class that extends `PluggableProcessEngineTest`, please remove \n+  the `extends PluggableProcessEngineTest` inheritance, and add the necessary JUnit4 Rules and Process Engine Services \n+  directly in the class you are modifying, as described in the point above.", "originalCommit": "454d60ede9605285978a373420beb74c15794a69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk4MzM5OQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/892#discussion_r459983399", "bodyText": "I wrote that section to explain that, if a custom configuration needs to be applied to the ProcessEngineBootstrapRule, this isn't really possible when a class is extending the PluggableProcessEngineTest since we can't pass the bootstrapRule to the ProvidedProcessEngineRule instance.\nI can rephrase it so it's clearer.\nIf the default configuration needs to be used, it's completely fine to use extend the PluggableProcessEngineTest.", "author": "koevskinikola", "createdAt": "2020-07-24T10:53:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkxNDIzMQ=="}], "type": "inlineReview"}, {"oid": "dfb915133b07369cd4ea5a2d2aca35544b172052", "url": "https://github.com/camunda/camunda-bpm-platform/commit/dfb915133b07369cd4ea5a2d2aca35544b172052", "message": "chore(engine): refactor junit3 test code to junit4\n\n* Migrate junit3 helper methods to ProcessEngineTestRule methods;\n* Port test classes to JUnit4;\n* Add missing dependencies after porting (e.g. JUnit Asserts);\n* Refactor test code to Java 8 syntax where possible.\n* Migrate authorization tests: Call authorization super.setUp after test setUp\n* Make JdbcStatementTimeoutTest work with junit4\n* Make CompetingHistoryCleanupAcquisitionTest work with junit4\n* Migrate JPAVariableTest to juint4\n* Refactor concurrency tests;\n\nRelated to CAM-12149", "committedDate": "2020-07-24T13:28:49Z", "type": "commit"}, {"oid": "228d1bc8d5e8d14ae3c12f687f65b076ad765d8c", "url": "https://github.com/camunda/camunda-bpm-platform/commit/228d1bc8d5e8d14ae3c12f687f65b076ad765d8c", "message": "chore(test): port PmvTestCase & TestCase tests to JUnit4\n\nRelated to CAM-12149", "committedDate": "2020-07-24T13:30:21Z", "type": "commit"}, {"oid": "d8e592eca30a9b99eca5ff2f0d462b1e226810b0", "url": "https://github.com/camunda/camunda-bpm-platform/commit/d8e592eca30a9b99eca5ff2f0d462b1e226810b0", "message": "chore(test): improve test code and contribution docs\n\n* Make the ConcurrencyTestHelper class independent of the Process Engine\n  Configuration and Services;\n* Extract the CMMN test helper methods in a separate class (CmmnTest).\n* Refactor the ProvidedProcessEngineRule class: Move the cached Process Engine from the PluggableProcessEngineTestCase\n  to the ProvidedProcessEngineRule.\n* Remove unused CmmnProcessEngineTestCase class;\n* Convert ProcessEngineBootstrapRule static initializers into lambdas.\n* Update instructions on creating tests in CONTRIBUTING.md.\n\nRelated to CAM-12149", "committedDate": "2020-07-24T13:32:50Z", "type": "forcePushed"}, {"oid": "0b3e3787c4090a6d1489a1c07e03caf7ed3c92ab", "url": "https://github.com/camunda/camunda-bpm-platform/commit/0b3e3787c4090a6d1489a1c07e03caf7ed3c92ab", "message": "chore(test): improve test code and contribution docs\n\n* Make the ConcurrencyTestHelper class independent of the Process Engine\n  Configuration and Services;\n* Extract the CMMN test helper methods in a separate class (CmmnTest).\n* Refactor the ProvidedProcessEngineRule class: Move the cached Process Engine from the PluggableProcessEngineTestCase\n  to the ProvidedProcessEngineRule.\n* Remove unused CmmnProcessEngineTestCase class;\n* Convert ProcessEngineBootstrapRule static initializers into lambdas.\n* Update instructions on creating tests in CONTRIBUTING.md.\n\nRelated to CAM-12149", "committedDate": "2020-07-24T13:49:42Z", "type": "commit"}, {"oid": "0b3e3787c4090a6d1489a1c07e03caf7ed3c92ab", "url": "https://github.com/camunda/camunda-bpm-platform/commit/0b3e3787c4090a6d1489a1c07e03caf7ed3c92ab", "message": "chore(test): improve test code and contribution docs\n\n* Make the ConcurrencyTestHelper class independent of the Process Engine\n  Configuration and Services;\n* Extract the CMMN test helper methods in a separate class (CmmnTest).\n* Refactor the ProvidedProcessEngineRule class: Move the cached Process Engine from the PluggableProcessEngineTestCase\n  to the ProvidedProcessEngineRule.\n* Remove unused CmmnProcessEngineTestCase class;\n* Convert ProcessEngineBootstrapRule static initializers into lambdas.\n* Update instructions on creating tests in CONTRIBUTING.md.\n\nRelated to CAM-12149", "committedDate": "2020-07-24T13:49:42Z", "type": "forcePushed"}]}