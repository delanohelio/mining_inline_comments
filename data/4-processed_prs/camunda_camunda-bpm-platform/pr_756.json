{"pr_number": 756, "pr_title": "CAM-11532: add documentation for metric endpoints", "pr_createdAt": "2020-03-25T11:11:23Z", "pr_url": "https://github.com/camunda/camunda-bpm-platform/pull/756", "timeline": [{"oid": "ccd586654aeb7d18fc99e6e80d1f848469442902", "url": "https://github.com/camunda/camunda-bpm-platform/commit/ccd586654aeb7d18fc99e6e80d1f848469442902", "message": "chore(engine-rest): add general improvements\n\nRelated to CAM-11532", "committedDate": "2020-03-25T10:57:28Z", "type": "commit"}, {"oid": "f638fd343835cbd2fb36434681f65008985b4069", "url": "https://github.com/camunda/camunda-bpm-platform/commit/f638fd343835cbd2fb36434681f65008985b4069", "message": "feat(engine-rest): add documentation for metrics endpoints\n\nRelated to CAM-11532", "committedDate": "2020-03-25T10:58:17Z", "type": "commit"}, {"oid": "79da2e1f6cde037e8e42b5ba499024cb672e077e", "url": "https://github.com/camunda/camunda-bpm-platform/commit/79da2e1f6cde037e8e42b5ba499024cb672e077e", "message": "chore(engine-rest): add general improvements\n\nRelated to CAM-11532", "committedDate": "2020-03-25T11:10:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk3NjUwNw==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397976507", "bodyText": "I think that this is supposed to be:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    type = \"number\"\n          \n          \n            \n                    type = \"integer\"\n          \n          \n            \n                    format = \"int64\"", "author": "koevskinikola", "createdAt": "2020-03-25T16:06:18Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/models/org/camunda/bpm/engine/rest/dto/metrics/MetricsIntervalResultDto.ftl", "diffHunk": "@@ -0,0 +1,25 @@\n+<@lib.dto>\n+\n+    <@lib.property\n+        name = \"timestamp\"\n+        type = \"string\"\n+        format = \"date-time\"\n+        desc = \"The interval timestamp.\"/>\n+\n+    <@lib.property\n+        name = \"name\"\n+        type = \"string\"\n+        desc = \"The name of the metric.\"/>\n+\n+    <@lib.property\n+        name = \"reporter\"\n+        type = \"string\"\n+        desc = \"The reporter of the metric. `null` if the metrics are aggregated by reporter.\"/>\n+\n+    <@lib.property\n+        name = \"value\"\n+        type = \"number\"", "originalCommit": "79da2e1f6cde037e8e42b5ba499024cb672e077e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4MjA0MA==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397982040", "bodyText": "From what I can see from the (only) usage, this is a Java long (see here). The OpenAPI spec defines the number type as float/double. So we need to set this to:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    type = \"number\"\n          \n          \n            \n                    type = \"integer\"\n          \n          \n            \n                    format = \"int64\"", "author": "koevskinikola", "createdAt": "2020-03-25T16:13:16Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/models/org/camunda/bpm/engine/rest/dto/metrics/MetricsResultDto.ftl", "diffHunk": "@@ -0,0 +1,9 @@\n+<@lib.dto>\n+\n+    <@lib.property\n+        name = \"result\"\n+        type = \"number\"", "originalCommit": "79da2e1f6cde037e8e42b5ba499024cb672e077e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4NzAwOQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397987009", "bodyText": "Shouldn't we define these as enumValues? The values are limited by the constants in the Metrics class", "author": "koevskinikola", "createdAt": "2020-03-25T16:19:49Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/metrics/get.ftl", "diffHunk": "@@ -0,0 +1,92 @@\n+{\n+  <@lib.endpointInfo\n+      id = \"interval\"\n+      tag = \"Metrics\"\n+      desc = \"Retrieves a list of metrics, aggregated for a given interval.\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"name\"\n+        location = \"query\"\n+        type = \"string\"\n+        desc = \"The name of the metric. Supported names:\n+                `activity-instance-start`,\n+                `activity-instance-end`,\n+                `job-acquisition-attempt`,\n+                `job-acquired-success`,\n+                `job-acquired-failure`,\n+                `job-execution-rejected`,\n+                `job-successful`,\n+                `job-failed`,\n+                `job-locked-exclusive`,\n+                `executed-decision-elements`,\n+                `history-cleanup-removed-process-instances`,\n+                `history-cleanup-removed-case-instances`,\n+                `history-cleanup-removed-decision-instances`,\n+                `history-cleanup-removed-batch-operations`\" />", "originalCommit": "79da2e1f6cde037e8e42b5ba499024cb672e077e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM2NDI1NQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r398364255", "bodyText": "Jep, I agree", "author": "mboskamp", "createdAt": "2020-03-26T07:31:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk4NzAwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk5MzQxMQ==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397993411", "bodyText": "I thinl that we should add that the defaultValue is 900:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    desc = \"The interval for which the metrics should be aggregated. Time unit is seconds.\n          \n          \n            \n                    defaultValue = \"900\"\n          \n          \n            \n                    desc = \"The interval for which the metrics should be aggregated. Time unit is seconds.", "author": "koevskinikola", "createdAt": "2020-03-25T16:28:10Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/metrics/get.ftl", "diffHunk": "@@ -0,0 +1,92 @@\n+{\n+  <@lib.endpointInfo\n+      id = \"interval\"\n+      tag = \"Metrics\"\n+      desc = \"Retrieves a list of metrics, aggregated for a given interval.\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"name\"\n+        location = \"query\"\n+        type = \"string\"\n+        desc = \"The name of the metric. Supported names:\n+                `activity-instance-start`,\n+                `activity-instance-end`,\n+                `job-acquisition-attempt`,\n+                `job-acquired-success`,\n+                `job-acquired-failure`,\n+                `job-execution-rejected`,\n+                `job-successful`,\n+                `job-failed`,\n+                `job-locked-exclusive`,\n+                `executed-decision-elements`,\n+                `history-cleanup-removed-process-instances`,\n+                `history-cleanup-removed-case-instances`,\n+                `history-cleanup-removed-decision-instances`,\n+                `history-cleanup-removed-batch-operations`\" />\n+\n+    <@lib.parameter\n+        name = \"reporter\"\n+        location = \"query\"\n+        type = \"string\"\n+        desc = \"The name of the reporter (host), on which the metrics was logged. This will have\n+                value provided by the [hostname configuration property](${docsUrl}/reference/deployment-descriptors/tags/process-engine/#hostname).\" />\n+\n+    <@lib.parameter\n+        name = \"startDate\"\n+        location = \"query\"\n+        type = \"string\"\n+        format = \"date-time\"\n+        desc = \"The start date (inclusive).\"/>\n+\n+    <@lib.parameter\n+        name = \"endDate\"\n+        location = \"query\"\n+        type = \"string\"\n+        format = \"date-time\"\n+        desc = \"The end date (exclusive).\"/>\n+\n+    <#include \"/lib/commons/pagination-params.ftl\" >\n+\n+    <@lib.parameter\n+        name = \"interval\"\n+        location = \"query\"\n+        type = \"string\"\n+        desc = \"The interval for which the metrics should be aggregated. Time unit is seconds.", "originalCommit": "79da2e1f6cde037e8e42b5ba499024cb672e077e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk5NTA1Nw==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/756#discussion_r397995057", "bodyText": "Same as above, these can be defined as enumValues.", "author": "koevskinikola", "createdAt": "2020-03-25T16:30:21Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/metrics/{metrics-name}/sum/get.ftl", "diffHunk": "@@ -0,0 +1,59 @@\n+{\n+  <@lib.endpointInfo\n+      id = \"getMetrics\"\n+      tag = \"Metrics\"\n+      desc = \"Retrieves the `sum` (count) for a given metric.\" />\n+\n+  \"parameters\" : [\n+\n+    <@lib.parameter\n+        name = \"metrics-name\"\n+        location = \"path\"\n+        required = true\n+        type = \"string\"\n+        desc = \"The name of the metric. Supported names:\n+                `activity-instance-start`,\n+                `activity-instance-end`,\n+                `job-acquisition-attempt`,\n+                `job-acquired-success`,\n+                `job-acquired-failure`,\n+                `job-execution-rejected`,\n+                `job-successful`,\n+                `job-failed`,\n+                `job-locked-exclusive`,\n+                `executed-decision-elements`,\n+                `history-cleanup-removed-process-instances`,\n+                `history-cleanup-removed-case-instances`,\n+                `history-cleanup-removed-decision-instances`,\n+                `history-cleanup-removed-batch-operations`\" />", "originalCommit": "79da2e1f6cde037e8e42b5ba499024cb672e077e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3147fff0ee1bec4eda33e829833956f0496885b4", "url": "https://github.com/camunda/camunda-bpm-platform/commit/3147fff0ee1bec4eda33e829833956f0496885b4", "message": "Apply suggestions from code review\n\nCo-Authored-By: Nikola Koevski <nikola.koevski@camunda.com>", "committedDate": "2020-03-26T07:13:34Z", "type": "commit"}, {"oid": "ad05179370f22e13ccf08685c3e593313fd2db02", "url": "https://github.com/camunda/camunda-bpm-platform/commit/ad05179370f22e13ccf08685c3e593313fd2db02", "message": "chore(engine-rest): add enum values for metrics-name\n\nRelated to CAM-11532", "committedDate": "2020-03-26T07:32:51Z", "type": "commit"}, {"oid": "a1aa2e64eb961705d9b1131f84622da2c9ddf3a2", "url": "https://github.com/camunda/camunda-bpm-platform/commit/a1aa2e64eb961705d9b1131f84622da2c9ddf3a2", "message": "chore(engine-rest): add enum values for metrics-name\n\nRelated to CAM-11532", "committedDate": "2020-03-26T07:41:26Z", "type": "commit"}]}