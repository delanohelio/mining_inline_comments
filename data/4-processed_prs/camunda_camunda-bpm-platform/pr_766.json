{"pr_number": 766, "pr_title": "CAM-11697: feat(rest): add external task query & count openapi endpoints", "pr_createdAt": "2020-03-31T15:07:12Z", "pr_url": "https://github.com/camunda/camunda-bpm-platform/pull/766", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3MTM4Ng==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/766#discussion_r401571386", "bodyText": "awesome!", "author": "yanavasileva", "createdAt": "2020-04-01T12:20:06Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/lib/utils.ftl", "diffHunk": "@@ -21,8 +22,15 @@\n       </#if>\n \n       \"type\": \"${type}\"\n-      <#if format?has_content>\n-      ,\"format\": \"${format}\"\n+\n+      <#if type == \"array\">,", "originalCommit": "c71854cd61419eac6b3ac665d935607868fcfe1e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3MzYxMw==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/766#discussion_r401573613", "bodyText": "let's mention this in the openapi readme", "author": "yanavasileva", "createdAt": "2020-04-01T12:23:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3MTM4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY1MDIxNw==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/766#discussion_r401650217", "bodyText": "I will document this in a separate commit in the main ticket (CAM-11485)", "author": "koevskinikola", "createdAt": "2020-04-01T14:17:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3MTM4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3MjQ4Mw==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/766#discussion_r401572483", "bodyText": "processDefinitionVersionTag is missing in the docs-manual:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            \n          \n          \n            \n               <@lib.property\n          \n          \n            \n                  name = \"processDefinitionVersionTag\"\n          \n          \n            \n                  type = \"string\"\n          \n          \n            \n                  desc = \"The version tag of the process definition the external task is defined in.\"", "author": "yanavasileva", "createdAt": "2020-04-01T12:21:54Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/models/org/camunda/bpm/engine/rest/dto/runtime/external-task/ExternalTaskDto.ftl", "diffHunk": "@@ -0,0 +1,97 @@\n+<@lib.dto\n+    title = \"ExternalTaskDto\"\n+    desc = \"An External Task object with the following properties\" >\n+\n+  <@lib.property\n+      name = \"activityId\"\n+      type = \"string\"\n+      desc = \"The id of the activity that this external task belongs to.\" />\n+\n+  <@lib.property\n+      name = \"activityInstanceId\"\n+      type = \"string\"\n+      desc = \"The id of the activity instance that the external task belongs to.\" />\n+\n+  <@lib.property\n+      name = \"errorMessage\"\n+      type = \"string\"\n+      desc = \"The full error message submitted with the latest reported failure executing this task; `null` if no\n+              failure was reported previously or if no error message was submitted\" />\n+\n+  <@lib.property\n+      name = \"errorDetails\"\n+      type = \"string\"\n+      desc = \"The error details submitted with the latest reported failure executing this task. `null` if no failure\n+              was reported previously or if no error details was submitted\" />\n+\n+  <@lib.property\n+      name = \"executionId\"\n+      type = \"string\"\n+      desc = \"The id of the execution that the external task belongs to.\" />\n+\n+  <@lib.property\n+      name = \"id\"\n+      type = \"string\"\n+      desc = \"The id of the external task.\" />\n+\n+  <@lib.property\n+      name = \"lockExpirationTime\"\n+      type = \"string\"\n+      format = \"date-time\"\n+      desc = \"The date that the task's most recent lock expires or has expired.\" />\n+\n+  <@lib.property\n+      name = \"processDefinitionId\"\n+      type = \"string\"\n+      desc = \"The id of the process definition the external task is defined in.\" />\n+\n+  <@lib.property\n+      name = \"processDefinitionKey\"\n+      type = \"string\"\n+      desc = \"The key of the process definition the external task is defined in.\" />\n+", "originalCommit": "c71854cd61419eac6b3ac665d935607868fcfe1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3ODA0MA==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/766#discussion_r401578040", "bodyText": "could we discuss briefly the sorting description for POST /count", "author": "yanavasileva", "createdAt": "2020-04-01T12:31:55Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/paths/external-task/count/post.ftl", "diffHunk": "@@ -0,0 +1,42 @@\n+{\n+\n+  <@lib.endpointInfo\n+      id = \"queryExternalTasksCount\"\n+      tag = \"External Task\"\n+      desc = \"Queries for the number of external tasks that fulfill given parameters. This method takes the same message\n+              body as the [Get External Tasks (POST)](${docsUrl}/reference/rest/external-task/post-query/) method.\" />\n+\n+  <@lib.requestBody\n+      mediaType = \"application/json\"\n+      dto = \"ExternalTaskQueryDto\"", "originalCommit": "c71854cd61419eac6b3ac665d935607868fcfe1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU5MzYwNA==", "url": "https://github.com/camunda/camunda-bpm-platform/pull/766#discussion_r401593604", "bodyText": "update desc that this doesn't apply for count query.", "author": "yanavasileva", "createdAt": "2020-04-01T12:57:12Z", "path": "engine-rest/engine-rest-openapi/src/main/templates/models/org/camunda/bpm/engine/rest/dto/runtime/external-task/ExternalTaskQueryDto.ftl", "diffHunk": "@@ -0,0 +1,136 @@\n+<@lib.dto\n+    title = \"ExternalTaskQueryDto\"\n+    desc = \"A JSON object with the following properties:\" >\n+\n+  <@lib.property\n+      name = \"externalTaskId\"\n+      type = \"string\"\n+      desc = \"Filter by an external task's id.\" />\n+\n+  <@lib.property\n+      name = \"topicName\"\n+      type = \"string\"\n+      desc = \"Filter by an external task topic.\" />\n+\n+  <@lib.property\n+      name = \"workerId\"\n+      type = \"string\"\n+      desc = \"Filter by the id of the worker that the task was most recently locked by.\" />\n+\n+  <@lib.property\n+      name = \"locked\"\n+      type = \"boolean\"\n+      desc = \"Only include external tasks that are currently locked (i.e., they have a lock time and it has not expired).\n+              Value may only be `true`, as `false` matches any external task.\" />\n+\n+  <@lib.property\n+      name = \"notLocked\"\n+      type = \"boolean\"\n+      desc = \"Only include external tasks that are currently not locked (i.e., they have no lock or it has expired).\n+              Value may only be `true`, as `false` matches any external task.\" />\n+\n+  <@lib.property\n+      name = \"withRetriesLeft\"\n+      type = \"boolean\"\n+      desc = \"Only include external tasks that have a positive (&gt; 0) number of retries (or `null`). Value may only be\n+              `true`, as `false` matches any external task.\" />\n+\n+  <@lib.property\n+      name = \"noRetriesLeft\"\n+      type = \"boolean\"\n+      desc = \"Only include external tasks that have 0 retries. Value may only be `true`, as `false` matches any\n+              external task.\" />\n+\n+  <@lib.property\n+      name = \"lockExpirationAfter\"\n+      type = \"string\"\n+      format = \"date-time\"\n+      desc = \"Restrict to external tasks that have a lock that expires after a given date. By\n+              [default](${docsUrl}/reference/rest/overview/date-format/), the date must have the format\n+              `yyyy-MM-dd'T'HH:mm:ss.SSSZ`, e.g., `2013-01-23T14:42:45.000+0200`.\" />\n+\n+  <@lib.property\n+      name = \"lockExpirationBefore\"\n+      type = \"string\"\n+      format = \"date-time\"\n+      desc = \"Restrict to external tasks that have a lock that expires before a given date. By\n+              [default](${docsUrl}/reference/rest/overview/date-format/), the date must have the format\n+              `yyyy-MM-dd'T'HH:mm:ss.SSSZ`, e.g., `2013-01-23T14:42:45.000+0200`.\" />\n+\n+  <@lib.property\n+      name = \"activityId\"\n+      type = \"string\"\n+      desc = \"Filter by the id of the activity that an external task is created for.\" />\n+\n+  <@lib.property\n+      name = \"activityIdIn\"\n+      type = \"array\"\n+      itemType = \"string\"\n+      desc = \"Filter by the comma-separated list of ids of the activities that an external task is created for.\" />\n+\n+  <@lib.property\n+      name = \"executionId\"\n+      type = \"string\"\n+      desc = \"Filter by the id of the execution that an external task belongs to.\" />\n+\n+  <@lib.property\n+      name = \"processInstanceId\"\n+      type = \"string\"\n+      desc = \"Filter by the id of the process instance that an external task belongs to.\" />\n+\n+  <@lib.property\n+      name = \"processInstanceIdIn\"\n+      type = \"array\"\n+      itemType = \"string\"\n+      desc = \"Filter by a comma-separated list of process instance ids that an external task may belong to.\" />\n+\n+  <@lib.property\n+      name = \"processDefinitionId\"\n+      type = \"string\"\n+      desc = \"Filter by the id of the process definition that an external task belongs to.\" />\n+\n+  <@lib.property\n+      name = \"tenantIdIn\"\n+      type = \"array\"\n+      itemType = \"string\"\n+      desc = \"Filter by a comma-separated list of tenant ids.\n+              An external task must have one of the given tenant ids.\" />\n+\n+  <@lib.property\n+      name = \"active\"\n+      type = \"boolean\"\n+      desc = \"Only include active tasks. Value may only be `true`, as `false` matches any external task.\" />\n+\n+  <@lib.property\n+      name = \"suspended\"\n+      type = \"boolean\"\n+      desc = \"Only include suspended tasks. Value may only be `true`, as `false` matches any external task.\" />\n+\n+  <@lib.property\n+      name = \"priorityHigherThanOrEquals\"\n+      type = \"integer\"\n+      format = \"int64\"\n+      desc = \"Only include jobs with a priority higher than or equal to the given value.\n+              Value must be a valid `long` value.\" />\n+\n+  <@lib.property\n+      name = \"priorityLowerThanOrEquals\"\n+      type = \"integer\"\n+      format = \"int64\"\n+      desc = \"Only include jobs with a priority lower than or equal to the given value.\n+              Value must be a valid `long` value.\" />\n+\n+  \"sorting\": {\n+    \"type\": \"array\",\n+    \"description\": \"A JSON array of criteria to sort the result by. Each element of the array is a JSON object that", "originalCommit": "c71854cd61419eac6b3ac665d935607868fcfe1e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f03e0ed2fc2d6aa964e6f21153e3c509f8efe184", "url": "https://github.com/camunda/camunda-bpm-platform/commit/f03e0ed2fc2d6aa964e6f21153e3c509f8efe184", "message": "feat(rest): add external task query & count openapi endpoints\n\nRelated to CAM-11540, CAM-11697", "committedDate": "2020-04-01T15:06:56Z", "type": "commit"}, {"oid": "1c29dfa65a904270c2af2570e86189b02c25d3cd", "url": "https://github.com/camunda/camunda-bpm-platform/commit/1c29dfa65a904270c2af2570e86189b02c25d3cd", "message": "fix(open-api): fix quotes in task variables endpoint\n\n* causing build failure on Windows OS", "committedDate": "2020-04-01T15:06:56Z", "type": "commit"}, {"oid": "1c29dfa65a904270c2af2570e86189b02c25d3cd", "url": "https://github.com/camunda/camunda-bpm-platform/commit/1c29dfa65a904270c2af2570e86189b02c25d3cd", "message": "fix(open-api): fix quotes in task variables endpoint\n\n* causing build failure on Windows OS", "committedDate": "2020-04-01T15:06:56Z", "type": "forcePushed"}]}