{"pr_number": 2490, "pr_title": "Methods contentLength and transferEncoding added", "pr_createdAt": "2020-10-29T14:06:17Z", "pr_url": "https://github.com/oracle/helidon/pull/2490", "timeline": [{"oid": "db4bb39cee506f6141b10c9bf2426caf6b210752", "url": "https://github.com/oracle/helidon/commit/db4bb39cee506f6141b10c9bf2426caf6b210752", "message": "contentLength and transferEncoding methods added to response headers\n\nSigned-off-by: David Kral <david.k.kral@oracle.com>", "committedDate": "2020-11-06T21:44:20Z", "type": "commit"}, {"oid": "db4bb39cee506f6141b10c9bf2426caf6b210752", "url": "https://github.com/oracle/helidon/commit/db4bb39cee506f6141b10c9bf2426caf6b210752", "message": "contentLength and transferEncoding methods added to response headers\n\nSigned-off-by: David Kral <david.k.kral@oracle.com>", "committedDate": "2020-11-06T21:44:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTk0OTY4Mw==", "url": "https://github.com/oracle/helidon/pull/2490#discussion_r519949683", "bodyText": "I think just checking for isEmpty is not sufficient. Transfer encoding can have the following values:\nTransfer-Encoding: chunked\nTransfer-Encoding: compress\nTransfer-Encoding: deflate\nTransfer-Encoding: gzip\nTransfer-Encoding: identity", "author": "tomas-langer", "createdAt": "2020-11-09T16:36:08Z", "path": "webclient/webclient/src/main/java/io/helidon/webclient/NettyClientHandler.java", "diffHunk": "@@ -197,12 +197,13 @@ private boolean shouldResponseAutomaticallyClose(WebClientResponse clientRespons\n     }\n \n     private boolean noContentLength(WebClientResponseHeaders headers) {\n-        return headers.first(Http.Header.CONTENT_LENGTH).isEmpty()\n-                || headers.first(Http.Header.CONTENT_LENGTH).get().equals(\"0\");\n+        return headers.contentLength()\n+                .map(value -> value == 0)\n+                .orElse(true);\n     }\n \n     private boolean notChunked(WebClientResponseHeaders headers) {\n-        return headers.first(Http.Header.TRANSFER_ENCODING).isEmpty();\n+        return headers.transferEncoding().isEmpty();", "originalCommit": "db4bb39cee506f6141b10c9bf2426caf6b210752", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d15beb7957e8acd28e12467183a79bb456795fde", "url": "https://github.com/oracle/helidon/commit/d15beb7957e8acd28e12467183a79bb456795fde", "message": "condition updated\n\nSigned-off-by: David Kral <david.k.kral@oracle.com>", "committedDate": "2020-11-10T09:16:43Z", "type": "commit"}]}