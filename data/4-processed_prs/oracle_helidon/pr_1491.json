{"pr_number": 1491, "pr_title": "Fail fast when policy validation fails because of setup/syntax.", "pr_createdAt": "2020-03-11T13:11:21Z", "pr_url": "https://github.com/oracle/helidon/pull/1491", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTMwMDY5MQ==", "url": "https://github.com/oracle/helidon/pull/1491#discussion_r391300691", "bodyText": "Consider wrapping e so it isn't lost.", "author": "ljnelson", "createdAt": "2020-03-11T22:16:16Z", "path": "security/abac/policy-el/src/main/java/io/helidon/security/abac/policy/el/JavaxElPolicyExecutor.java", "diffHunk": "@@ -164,9 +161,8 @@ public JavaxElPolicyExecutor build() {\n                 try {\n                     expressionFactory = ExpressionFactory.newInstance();\n                 } catch (ELException e) {\n-                    LOGGER.fine(\n-                            \"Expression language factory not available. To support policy expressions, you need to add some \"\n-                                    + \"implementation to class/module path\");\n+                    throw new SecurityException(\"Failed to configure ABAC Policy support for Jakarta Expression Language,\"", "originalCommit": "1559c14f461f99b6348b6a5ef5c4f462bce6dcc4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ3NjkyMA==", "url": "https://github.com/oracle/helidon/pull/1491#discussion_r391476920", "bodyText": "Good catch, will fix", "author": "tomas-langer", "createdAt": "2020-03-12T08:55:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTMwMDY5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU1NTk0Mg==", "url": "https://github.com/oracle/helidon/pull/1491#discussion_r391555942", "bodyText": "Fixed.", "author": "tomas-langer", "createdAt": "2020-03-12T11:23:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTMwMDY5MQ=="}], "type": "inlineReview"}, {"oid": "eb7aec69969e0927e61d7534e3cd5b520d52dfb1", "url": "https://github.com/oracle/helidon/commit/eb7aec69969e0927e61d7534e3cd5b520d52dfb1", "message": "Fail fast when policy validation fails because of setup/syntax.\n\nSigned-off-by: Tomas Langer <tomas.langer@oracle.com>", "committedDate": "2020-03-13T11:15:07Z", "type": "commit"}, {"oid": "f645ab23d1202bb91342429dcec63b0e50e7a32a", "url": "https://github.com/oracle/helidon/commit/f645ab23d1202bb91342429dcec63b0e50e7a32a", "message": "Review fix - not hiding exception.\n\nSigned-off-by: Tomas Langer <tomas.langer@oracle.com>", "committedDate": "2020-03-13T11:15:07Z", "type": "commit"}, {"oid": "f645ab23d1202bb91342429dcec63b0e50e7a32a", "url": "https://github.com/oracle/helidon/commit/f645ab23d1202bb91342429dcec63b0e50e7a32a", "message": "Review fix - not hiding exception.\n\nSigned-off-by: Tomas Langer <tomas.langer@oracle.com>", "committedDate": "2020-03-13T11:15:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIwNDY3Mw==", "url": "https://github.com/oracle/helidon/pull/1491#discussion_r392204673", "bodyText": "Is logging still needed here?", "author": "danielkec", "createdAt": "2020-03-13T12:44:48Z", "path": "security/abac/policy-el/src/main/java/io/helidon/security/abac/policy/el/JavaxElPolicyExecutor.java", "diffHunk": "@@ -116,11 +116,8 @@ public void executePolicy(String policyStatement, Errors.Collector collector, Pr\n                 collector.fatal(this, \"Policy statement \\\"\" + policyStatement + \"\\\" evaluated to false\");\n             }\n         } catch (Exception e) {\n-            collector.fatal(this,\n-                            \"Policy statement \\\"\" + policyStatement + \"\\\" evaluated to an exception \" + e.getClass()\n-                                    .getName() + \" with message: \" + e.getMessage());\n-\n             LOGGER.log(Level.FINEST, e, () -> \"Statement \" + policyStatement + \" evaluation failed\");\n+            throw new SecurityException(\"Policy statement \\\"\" + policyStatement + \"\\\" evaluated to an exception\", e);", "originalCommit": "f645ab23d1202bb91342429dcec63b0e50e7a32a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjI2Mzg0Mg==", "url": "https://github.com/oracle/helidon/pull/1491#discussion_r392263842", "bodyText": "The security exception is propagated outside of security (and outside of Helidon code), so yes, I think it is reasonable to log it (that is why it is in FINEST level)", "author": "tomas-langer", "createdAt": "2020-03-13T14:31:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIwNDY3Mw=="}], "type": "inlineReview"}]}