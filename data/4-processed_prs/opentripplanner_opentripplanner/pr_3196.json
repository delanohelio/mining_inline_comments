{"pr_number": 3196, "pr_title": "Add Mapbox Vector Tiles API as a sandbox feature", "pr_createdAt": "2020-09-29T08:07:09Z", "pr_url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3196", "timeline": [{"oid": "66cb4bdc10546510218e15b4e351ad36e6725dbf", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/66cb4bdc10546510218e15b4e351ad36e6725dbf", "message": "Move and rename classes from the analyst directory", "committedDate": "2020-09-28T11:45:25Z", "type": "commit"}, {"oid": "4adfde8d86dda37d39b6bdb42187d15fcbbcdee5", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/4adfde8d86dda37d39b6bdb42187d15fcbbcdee5", "message": "Remove unused superclass usage", "committedDate": "2020-09-28T11:45:25Z", "type": "commit"}, {"oid": "8b23fd3cbe4cac6d88a14fa7621a35a501a3165d", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/8b23fd3cbe4cac6d88a14fa7621a35a501a3165d", "message": "Add API endpoint for fetching Mapbox Vector Tiles", "committedDate": "2020-09-29T08:05:02Z", "type": "commit"}, {"oid": "d2e167a37db4bd2fd0f6f03484fae86d20c59f50", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/d2e167a37db4bd2fd0f6f03484fae86d20c59f50", "message": "Add documentation", "committedDate": "2020-09-29T08:32:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjU0NzM4NQ==", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3196#discussion_r496547385", "bodyText": "Link to this in:\n\nmkdocs.yml\nSandbox.md", "author": "t2gran", "createdAt": "2020-09-29T08:49:22Z", "path": "docs/sandbox/MapboxVectorTilesApi.md", "diffHunk": "@@ -0,0 +1,60 @@\n+# Mapbox Vector Tiles API\n+", "originalCommit": "d2e167a37db4bd2fd0f6f03484fae86d20c59f50", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjU0Nzk0NQ==", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3196#discussion_r496547945", "bodyText": "Add some doc on how to extend and move to \"core\"", "author": "t2gran", "createdAt": "2020-09-29T08:50:14Z", "path": "docs/sandbox/MapboxVectorTilesApi.md", "diffHunk": "@@ -0,0 +1,60 @@\n+# Mapbox Vector Tiles API\n+\n+## Contact Info\n+- HSL, Finland\n+- Kyyti Group Oy, Finland\n+- Hannes Junnila\n+\n+\n+## Changelog\n+- Initial version of Mapbox vector tiles api API\n+\n+## Documentation\n+\n+This API produces [Mapbox vector tiles](https://docs.mapbox.com/vector-tiles/reference/), which are used by eg. [Digitransit-ui](https://github.com/HSLdevcom/digitransit-ui) to show information about public transit entities on the map.\n+\n+The tiles can be fetched from `/otp/routers/{routerId}/vectorTiles/{layers}/{z}/{x}/{y}.pbf`, where `layers is a comma separated list of layer names from the configuration.\n+\n+### Configuration\n+To enable this you need to add the feature `SandboxAPIMapboxVectorTilesApi` in `otp-config.json`.\n+\n+The feature must be configured in `router-config.json` as follows\n+ \n+```\n+{\n+  \"vectorTileLayers\": [\n+    {\n+      \"name\": \"stops\",\n+      \"type\": \"Stop\",\n+      \"mapper\": \"Digitransit\",\n+      \"maxZoom\": 20,\n+      \"minZoom\": 14,\n+      \"cacheMaxSeconds\": 600\n+    },\n+    {\n+      \"name\": \"stations\",\n+      \"type\": \"Station\",\n+      \"mapper\": \"Digitransit\",\n+      \"maxZoom\": 20,\n+      \"minZoom\": 12,\n+      \"cacheMaxSeconds\": 600\n+    },\n+    {\n+      \"name\": \"citybikes\",\n+      \"type\": \"BikeRental\",\n+      \"mapper\": \"Digitransit\",\n+      \"maxZoom\": 20,\n+      \"minZoom\": 14,\n+      \"cacheMaxSeconds\": 60\n+    }\n+  ]\n+}\n+```\n+\n+For each layer, the configuration includes,\n+ - `name` which is used in the url to fetch tiles, and as the layer name in the vector tiles.\n+ - `type` which tells the type of the layer. Currently `Stop`, `Station` and `BikeRental` are supported.\n+ - `mapper` which describes the mapper converting the properties from the OTP model entities to the vector tile properties. Currently `Digitransit` is supported for all layer types.\n+ - `minZoom` and `maxZoom` which describe the zoom levels the layer is active for.\n+ - `cacheMaxSeconds` which sets the cache header in the response. The lowest value of the layers included is selected.\n+ ", "originalCommit": "d2e167a37db4bd2fd0f6f03484fae86d20c59f50", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "341f2a3b0cb0bd9a08627539a278ca51ceb9a5f0", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/341f2a3b0cb0bd9a08627539a278ca51ceb9a5f0", "message": "Merge remote-tracking branch 'origin/dev-2.x' into mvt", "committedDate": "2020-09-29T09:50:34Z", "type": "commit"}, {"oid": "77b59ef42c5d23f788164197ab90db6b02ea2491", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/77b59ef42c5d23f788164197ab90db6b02ea2491", "message": "Add notes about extension", "committedDate": "2020-09-29T09:53:45Z", "type": "commit"}]}