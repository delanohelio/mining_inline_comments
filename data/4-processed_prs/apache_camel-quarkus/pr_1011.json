{"pr_number": 1011, "pr_title": "Fix native images issues on Java 11", "pr_createdAt": "2020-04-01T12:22:54Z", "pr_url": "https://github.com/apache/camel-quarkus/pull/1011", "timeline": [{"oid": "9305905f154d11827b9700b4756750c1e57cfba2", "url": "https://github.com/apache/camel-quarkus/commit/9305905f154d11827b9700b4756750c1e57cfba2", "message": "Use ASM to replace a method", "committedDate": "2020-04-01T07:03:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NDQ3NQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401574475", "bodyText": "Don't we want to abandon Java 8 ASAP?", "author": "ppalaga", "createdAt": "2020-04-01T12:25:32Z", "path": ".github/workflows/pr-build.yaml", "diffHunk": "@@ -64,7 +64,7 @@ jobs:\n     needs: build\n     strategy:\n       matrix:\n-        java: [ '11' , '12' ]\n+        java: [ '8' , '12' ]", "originalCommit": "f5d7ccb91f5acc3271d5f100ff0442729b834ea8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4NTQ0NQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401585445", "bodyText": "Yeah, I've just kept it to be sure it can still work thill we decide to abandon Java 8", "author": "lburgazzoli", "createdAt": "2020-04-01T12:44:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NDQ3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NzA5NA==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401577094", "bodyText": "Shouldn't Resilience4jConfigurationProperties be listed below where other org.apache.camel.main.Resilience4j* classes are listed?", "author": "ppalaga", "createdAt": "2020-04-01T12:30:11Z", "path": "extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java", "diffHunk": "@@ -302,7 +302,17 @@ void process(\n                     org.apache.camel.main.DefaultConfigurationProperties.class,\n                     org.apache.camel.main.MainConfigurationProperties.class,\n                     org.apache.camel.main.HystrixConfigurationProperties.class,\n+                    org.apache.camel.main.Resilience4jConfigurationProperties.class,", "originalCommit": "f5d7ccb91f5acc3271d5f100ff0442729b834ea8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4NjM0NQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401586345", "bodyText": "the other are form different packages unless you means some other location", "author": "lburgazzoli", "createdAt": "2020-04-01T12:45:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NzA5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4ODQyNw==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401588427", "bodyText": "Yes, I have not noticed they are from a different package, but I rather meant the same TODO applies to Resilience4jConfigurationProperties", "author": "ppalaga", "createdAt": "2020-04-01T12:49:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NzA5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU5OTE2MA==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401599160", "bodyText": "ah yeah (btw, we probably wont need them any more with camel 3.2.0)", "author": "lburgazzoli", "createdAt": "2020-04-01T13:05:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NzA5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4MDIwNA==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401580204", "bodyText": "log can perhaps be removed? I do not see it used.", "author": "ppalaga", "createdAt": "2020-04-01T12:35:36Z", "path": "integration-tests/rest-binding-mode-xml/pom.xml", "diffHunk": "@@ -0,0 +1,144 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+\n+    Licensed to the Apache Software Foundation (ASF) under one or more\n+    contributor license agreements.  See the NOTICE file distributed with\n+    this work for additional information regarding copyright ownership.\n+    The ASF licenses this file to You under the Apache License, Version 2.0\n+    (the \"License\"); you may not use this file except in compliance with\n+    the License.  You may obtain a copy of the License at\n+\n+         http://www.apache.org/licenses/LICENSE-2.0\n+\n+    Unless required by applicable law or agreed to in writing, software\n+    distributed under the License is distributed on an \"AS IS\" BASIS,\n+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+    See the License for the specific language governing permissions and\n+    limitations under the License.\n+\n+-->\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+    <parent>\n+        <groupId>org.apache.camel.quarkus</groupId>\n+        <artifactId>camel-quarkus-integration-tests</artifactId>\n+        <version>1.1.0-SNAPSHOT</version>\n+    </parent>\n+\n+    <artifactId>camel-quarkus-integration-test-rest-binding-mode-xml</artifactId>\n+    <name>Camel Quarkus :: Integration Tests :: Rest :: Binding Mode XML</name>\n+    <description>Integration tests for Camel Quarkus Rest extension with XML binding mode</description>\n+\n+    <properties>\n+        <!-- mvnd, a.k.a. Maven Daemon: https://github.com/gnodet/mvnd -->\n+        <!-- The following rule tells mvnd to build the listed deployment modules before this module. -->\n+        <!-- This is important because mvnd builds modules in parallel by default. The deployment modules are not -->\n+        <!-- explicit dependencies of this module in the Maven sense, although they are required by the Quarkus Maven plugin. -->\n+        <!-- Please update rule whenever you change the dependencies of this module by running -->\n+        <!--     mvn process-resources -Pformat    from the root directory -->\n+        <mvnd.builder.rule>camel-quarkus-attachments-deployment,camel-quarkus-log-deployment,camel-quarkus-platform-http-deployment,camel-quarkus-rest-deployment,camel-quarkus-support-policy-deployment</mvnd.builder.rule>\n+    </properties>\n+\n+    <dependencyManagement>\n+        <dependencies>\n+            <dependency>\n+                <groupId>org.apache.camel.quarkus</groupId>\n+                <artifactId>camel-quarkus-bom-test</artifactId>\n+                <version>${project.version}</version>\n+                <type>pom</type>\n+                <scope>import</scope>\n+            </dependency>\n+        </dependencies>\n+    </dependencyManagement>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-platform-http</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-rest</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-xml-jaxb</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-jaxb</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-log</artifactId>", "originalCommit": "f5d7ccb91f5acc3271d5f100ff0442729b834ea8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4MDM0Ng==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401580346", "bodyText": "attachments can perhaps be removed? I do not see them used.", "author": "ppalaga", "createdAt": "2020-04-01T12:35:52Z", "path": "integration-tests/rest-binding-mode-xml/pom.xml", "diffHunk": "@@ -0,0 +1,144 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+\n+    Licensed to the Apache Software Foundation (ASF) under one or more\n+    contributor license agreements.  See the NOTICE file distributed with\n+    this work for additional information regarding copyright ownership.\n+    The ASF licenses this file to You under the Apache License, Version 2.0\n+    (the \"License\"); you may not use this file except in compliance with\n+    the License.  You may obtain a copy of the License at\n+\n+         http://www.apache.org/licenses/LICENSE-2.0\n+\n+    Unless required by applicable law or agreed to in writing, software\n+    distributed under the License is distributed on an \"AS IS\" BASIS,\n+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+    See the License for the specific language governing permissions and\n+    limitations under the License.\n+\n+-->\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+    <parent>\n+        <groupId>org.apache.camel.quarkus</groupId>\n+        <artifactId>camel-quarkus-integration-tests</artifactId>\n+        <version>1.1.0-SNAPSHOT</version>\n+    </parent>\n+\n+    <artifactId>camel-quarkus-integration-test-rest-binding-mode-xml</artifactId>\n+    <name>Camel Quarkus :: Integration Tests :: Rest :: Binding Mode XML</name>\n+    <description>Integration tests for Camel Quarkus Rest extension with XML binding mode</description>\n+\n+    <properties>\n+        <!-- mvnd, a.k.a. Maven Daemon: https://github.com/gnodet/mvnd -->\n+        <!-- The following rule tells mvnd to build the listed deployment modules before this module. -->\n+        <!-- This is important because mvnd builds modules in parallel by default. The deployment modules are not -->\n+        <!-- explicit dependencies of this module in the Maven sense, although they are required by the Quarkus Maven plugin. -->\n+        <!-- Please update rule whenever you change the dependencies of this module by running -->\n+        <!--     mvn process-resources -Pformat    from the root directory -->\n+        <mvnd.builder.rule>camel-quarkus-attachments-deployment,camel-quarkus-log-deployment,camel-quarkus-platform-http-deployment,camel-quarkus-rest-deployment,camel-quarkus-support-policy-deployment</mvnd.builder.rule>\n+    </properties>\n+\n+    <dependencyManagement>\n+        <dependencies>\n+            <dependency>\n+                <groupId>org.apache.camel.quarkus</groupId>\n+                <artifactId>camel-quarkus-bom-test</artifactId>\n+                <version>${project.version}</version>\n+                <type>pom</type>\n+                <scope>import</scope>\n+            </dependency>\n+        </dependencies>\n+    </dependencyManagement>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-platform-http</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-rest</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-xml-jaxb</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-jaxb</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-log</artifactId>\n+        </dependency>\n+        <dependency><!-- Leave this one out (and save ~560 kB of the native image) unless you want to attach uploads to the camel message -->\n+            <groupId>org.apache.camel.quarkus</groupId>\n+            <artifactId>camel-quarkus-attachments</artifactId>", "originalCommit": "f5d7ccb91f5acc3271d5f100ff0442729b834ea8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4MDc3MA==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401580770", "bodyText": "quarkus.ssl.native=true can perhaps be removed?", "author": "ppalaga", "createdAt": "2020-04-01T12:36:39Z", "path": "integration-tests/rest-binding-mode-xml/src/main/resources/application.properties", "diffHunk": "@@ -0,0 +1,27 @@\n+## ---------------------------------------------------------------------------\n+## Licensed to the Apache Software Foundation (ASF) under one or more\n+## contributor license agreements.  See the NOTICE file distributed with\n+## this work for additional information regarding copyright ownership.\n+## The ASF licenses this file to You under the Apache License, Version 2.0\n+## (the \"License\"); you may not use this file except in compliance with\n+## the License.  You may obtain a copy of the License at\n+##\n+##      http://www.apache.org/licenses/LICENSE-2.0\n+##\n+## Unless required by applicable law or agreed to in writing, software\n+## distributed under the License is distributed on an \"AS IS\" BASIS,\n+## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+## See the License for the specific language governing permissions and\n+## limitations under the License.\n+## ---------------------------------------------------------------------------\n+#\n+# Quarkus\n+#\n+quarkus.ssl.native=true", "originalCommit": "f5d7ccb91f5acc3271d5f100ff0442729b834ea8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4MTAyOQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401581029", "bodyText": "quarkus.native.add-all-charsets = true can perhaps be removed?", "author": "ppalaga", "createdAt": "2020-04-01T12:37:05Z", "path": "integration-tests/rest-binding-mode-xml/src/main/resources/application.properties", "diffHunk": "@@ -0,0 +1,27 @@\n+## ---------------------------------------------------------------------------\n+## Licensed to the Apache Software Foundation (ASF) under one or more\n+## contributor license agreements.  See the NOTICE file distributed with\n+## this work for additional information regarding copyright ownership.\n+## The ASF licenses this file to You under the Apache License, Version 2.0\n+## (the \"License\"); you may not use this file except in compliance with\n+## the License.  You may obtain a copy of the License at\n+##\n+##      http://www.apache.org/licenses/LICENSE-2.0\n+##\n+## Unless required by applicable law or agreed to in writing, software\n+## distributed under the License is distributed on an \"AS IS\" BASIS,\n+## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+## See the License for the specific language governing permissions and\n+## limitations under the License.\n+## ---------------------------------------------------------------------------\n+#\n+# Quarkus\n+#\n+quarkus.ssl.native=true\n+quarkus.http.body.uploads-directory=target/uploads\n+quarkus.log.file.enable = false\n+quarkus.log.category.\"org.apache.camel.quarkus.core.deployment\".level = INFO\n+quarkus.log.category.\"org.apache.camel.quarkus.component.platform.http\".level = INFO\n+\n+# Required by the encoding() test\n+quarkus.native.add-all-charsets = true", "originalCommit": "f5d7ccb91f5acc3271d5f100ff0442729b834ea8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5MzU0OQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401693549", "bodyText": "Nitpick: you wanted to move Resilience4jConfigurationProperties, not RestConfigurationProperties", "author": "ppalaga", "createdAt": "2020-04-01T15:13:30Z", "path": "extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java", "diffHunk": "@@ -302,14 +302,14 @@ void process(\n                     org.apache.camel.main.DefaultConfigurationProperties.class,\n                     org.apache.camel.main.MainConfigurationProperties.class,\n                     org.apache.camel.main.HystrixConfigurationProperties.class,\n-                    org.apache.camel.main.Resilience4jConfigurationProperties.class,\n-                    org.apache.camel.main.RestConfigurationProperties.class));\n+                    org.apache.camel.main.Resilience4jConfigurationProperties.class));", "originalCommit": "d416fe2fb64e56d86af036183a62d08eb5f63054", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5NTU2NQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401695565", "bodyText": "damn, will fix it later to avoid another build", "author": "lburgazzoli", "createdAt": "2020-04-01T15:16:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5MzU0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTcwMjgxMA==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401702810", "bodyText": "Let it be!", "author": "ppalaga", "createdAt": "2020-04-01T15:25:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5MzU0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc1NjU0NQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401756545", "bodyText": "fixed", "author": "lburgazzoli", "createdAt": "2020-04-01T16:41:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5MzU0OQ=="}], "type": "inlineReview"}, {"oid": "75a008ea7bc1223b9d6572781590c934e994289b", "url": "https://github.com/apache/camel-quarkus/commit/75a008ea7bc1223b9d6572781590c934e994289b", "message": "Set Java 11 as default", "committedDate": "2020-04-01T15:59:40Z", "type": "commit"}, {"oid": "4112a5a94a1179db6be102f10d9b1750808fcddc", "url": "https://github.com/apache/camel-quarkus/commit/4112a5a94a1179db6be102f10d9b1750808fcddc", "message": "Fix native images issues on Java 11 #1000 #1005 #999", "committedDate": "2020-04-01T15:59:40Z", "type": "commit"}, {"oid": "11808db115f6324ec799c5f4a6499b4c12b9b010", "url": "https://github.com/apache/camel-quarkus/commit/11808db115f6324ec799c5f4a6499b4c12b9b010", "message": "Fix findings", "committedDate": "2020-04-01T15:59:41Z", "type": "forcePushed"}, {"oid": "69ade679a0baf0aa3ed699084096cef27457f770", "url": "https://github.com/apache/camel-quarkus/commit/69ade679a0baf0aa3ed699084096cef27457f770", "message": "Fix findings", "committedDate": "2020-04-01T16:41:33Z", "type": "commit"}, {"oid": "9af2546d1602788a3ba9981b1b1976e9c0f90ff0", "url": "https://github.com/apache/camel-quarkus/commit/9af2546d1602788a3ba9981b1b1976e9c0f90ff0", "message": "camle-tagsoup extension tests fails in native mode on Jdk 11 #1010", "committedDate": "2020-04-01T16:41:34Z", "type": "commit"}, {"oid": "9af2546d1602788a3ba9981b1b1976e9c0f90ff0", "url": "https://github.com/apache/camel-quarkus/commit/9af2546d1602788a3ba9981b1b1976e9c0f90ff0", "message": "camle-tagsoup extension tests fails in native mode on Jdk 11 #1010", "committedDate": "2020-04-01T16:41:34Z", "type": "forcePushed"}, {"oid": "db646b3fade47c2d89cfd43057e48ff074ff8699", "url": "https://github.com/apache/camel-quarkus/commit/db646b3fade47c2d89cfd43057e48ff074ff8699", "message": "Workaround for RestProducer on Java 11", "committedDate": "2020-04-02T09:16:09Z", "type": "commit"}, {"oid": "db646b3fade47c2d89cfd43057e48ff074ff8699", "url": "https://github.com/apache/camel-quarkus/commit/db646b3fade47c2d89cfd43057e48ff074ff8699", "message": "Workaround for RestProducer on Java 11", "committedDate": "2020-04-02T09:16:09Z", "type": "forcePushed"}]}