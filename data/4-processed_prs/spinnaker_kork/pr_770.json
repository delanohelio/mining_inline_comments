{"pr_number": 770, "pr_title": "refactor(test): Migrate Spek to Spek2", "pr_createdAt": "2020-09-02T14:31:32Z", "pr_url": "https://github.com/spinnaker/kork/pull/770", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2MTgyNw==", "url": "https://github.com/spinnaker/kork/pull/770#discussion_r482161827", "bodyText": "Shouldn't that be a Then rather than a When?", "author": "robfletcher", "createdAt": "2020-09-02T15:27:22Z", "path": "kork-sql/src/test/kotlin/com/netflix/spinnaker/kork/sql/PagedIteratorSpec.kt", "diffHunk": "@@ -28,42 +28,38 @@ import com.nhaarman.mockito_kotlin.whenever\n import org.assertj.core.api.AbstractAssert\n import org.assertj.core.api.Assertions.assertThat\n import org.assertj.core.api.Assertions.assertThatThrownBy\n-import org.jetbrains.spek.api.Spek\n-import org.jetbrains.spek.api.dsl.describe\n-import org.jetbrains.spek.api.dsl.given\n-import org.jetbrains.spek.api.dsl.it\n-import org.jetbrains.spek.api.dsl.on\n+import org.spekframework.spek2.Spek\n+import org.spekframework.spek2.style.gherkin.Feature\n \n internal object PagedIteratorSpec : Spek({\n \n-  describe(\"fetching paged data\") {\n-\n+  Feature(\"fetching paged data\") {\n     val pageSize = 3\n     val nextPage = mock<(Int, String?) -> Iterable<String>>()\n \n-    given(\"there is no data\") {\n+    Scenario(\"there is no data\") {\n       val subject = PagedIterator(pageSize, String::toString, nextPage)\n \n-      beforeGroup {\n+      beforeScenario {\n         whenever(nextPage(eq(pageSize), anyOrNull())) doReturn emptyList<String>()\n       }\n \n-      afterGroup { reset(nextPage) }\n+      afterScenario { reset(nextPage) }\n \n-      it(\"has no elements\") {\n+      When(\"has no elements\") {", "originalCommit": "8050833e7d6cf98ce6aa8189c6ab4d778875f95a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2MzYwMg==", "url": "https://github.com/spinnaker/kork/pull/770#discussion_r482163602", "bodyText": "Seems weird you can have a declaration outside the DSL scope like this", "author": "robfletcher", "createdAt": "2020-09-02T15:29:42Z", "path": "kork-sql/src/test/kotlin/com/netflix/spinnaker/kork/sql/PagedIteratorSpec.kt", "diffHunk": "@@ -107,32 +103,32 @@ internal object PagedIteratorSpec : Spek({\n         }\n       }\n \n-      afterGroup { reset(nextPage) }\n+      afterScenario { reset(nextPage) }\n \n-      it(\"has some elements\") {\n+      Given(\"has some elements\") {\n         assertThat(subject.hasNext()).isTrue()\n       }\n \n-      on(\"draining the iterator\") {\n-        val results = mutableListOf<String>()\n+      val results = mutableListOf<String>()", "originalCommit": "8050833e7d6cf98ce6aa8189c6ab4d778875f95a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjMwNTg2Ng==", "url": "https://github.com/spinnaker/kork/pull/770#discussion_r482305866", "bodyText": "Maybe weird, but if you don't, the class won't compile - if you wanted to keep all variable definitions inside of the DSL scopes, you'd need to assign it into some holder object that is then passed implicitly from one function to the next. It's really no different than defining variables outside Scenario in this case?", "author": "robzienert", "createdAt": "2020-09-02T18:53:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2MzYwMg=="}], "type": "inlineReview"}, {"oid": "be8f15bbf126227f7d3d8622feb2ddf8cc8127e9", "url": "https://github.com/spinnaker/kork/commit/be8f15bbf126227f7d3d8622feb2ddf8cc8127e9", "message": "refactor(test): Migrate Spek to Spek2", "committedDate": "2020-09-04T00:29:34Z", "type": "forcePushed"}, {"oid": "d7f5407eac2f9b3c2ed560dcf3f7ddebe2fc55ae", "url": "https://github.com/spinnaker/kork/commit/d7f5407eac2f9b3c2ed560dcf3f7ddebe2fc55ae", "message": "refactor(test): Migrate Spek to Spek2", "committedDate": "2020-09-08T20:19:00Z", "type": "commit"}, {"oid": "d7f5407eac2f9b3c2ed560dcf3f7ddebe2fc55ae", "url": "https://github.com/spinnaker/kork/commit/d7f5407eac2f9b3c2ed560dcf3f7ddebe2fc55ae", "message": "refactor(test): Migrate Spek to Spek2", "committedDate": "2020-09-08T20:19:00Z", "type": "forcePushed"}]}