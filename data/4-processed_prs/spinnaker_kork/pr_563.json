{"pr_number": 563, "pr_title": "feat(configuration): Add support for spring cloud config with S3", "pr_createdAt": "2020-03-19T17:33:15Z", "pr_url": "https://github.com/spinnaker/kork/pull/563", "timeline": [{"oid": "bceb72794a019811f0c2c8b4bf50b75c95aaac33", "url": "https://github.com/spinnaker/kork/commit/bceb72794a019811f0c2c8b4bf50b75c95aaac33", "message": "feat(configuration): Add support for spring cloud configuration with S3 backend", "committedDate": "2020-03-20T08:08:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY2MjY5OA==", "url": "https://github.com/spinnaker/kork/pull/563#discussion_r395662698", "bodyText": "Is this needed? I believe if we skip this line, the default credential is used either way.", "author": "costimuraru", "createdAt": "2020-03-20T14:12:31Z", "path": "kork-config/src/main/java/com/netflix/spinnaker/kork/configserver/autoconfig/SpringCloudAwsConfiguration.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package com.netflix.spinnaker.kork.configserver.autoconfig;\n+\n+import com.amazonaws.auth.DefaultAWSCredentialsProviderChain;\n+import com.amazonaws.services.s3.AmazonS3Client;\n+import com.amazonaws.services.s3.AmazonS3ClientBuilder;\n+import org.springframework.cloud.config.server.environment.AwsS3EnvironmentProperties;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.context.annotation.Profile;\n+\n+@Profile(\"awss3\")\n+@Configuration\n+class SpringCloudAwsConfiguration {\n+\n+  @Bean\n+  public static AmazonS3Client amazonS3(AwsS3EnvironmentProperties s3EnvironmentProperties) {\n+    return (AmazonS3Client)\n+        AmazonS3ClientBuilder.standard()\n+            .withRegion(s3EnvironmentProperties.getRegion())\n+            .withCredentials(new DefaultAWSCredentialsProviderChain())", "originalCommit": "bceb72794a019811f0c2c8b4bf50b75c95aaac33", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODEwMTYxOA==", "url": "https://github.com/spinnaker/kork/pull/563#discussion_r398101618", "bodyText": "done", "author": "titirigaiulian", "createdAt": "2020-03-25T19:06:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY2MjY5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxNDM0OQ==", "url": "https://github.com/spinnaker/kork/pull/563#discussion_r395214349", "bodyText": "This is unnecessary: The AWS SDK BOM is included just 2 lines up.", "author": "robzienert", "createdAt": "2020-03-19T17:53:15Z", "path": "spinnaker-dependencies/spinnaker-dependencies.gradle", "diffHunk": "@@ -58,6 +58,7 @@ dependencies {\n   api(platform(\"org.springframework.boot:spring-boot-dependencies:${versions.springBoot}\"))\n   api(platform(\"com.amazonaws:aws-java-sdk-bom:${versions.aws}\"))\n   api(platform(\"org.springframework.cloud:spring-cloud-dependencies:${versions.springCloud}\"))\n+  api(platform(\"com.amazonaws:aws-java-sdk-s3:${versions.aws}\"))", "originalCommit": "d0c966b56a09169a174c36cd7ad3a36e46fa901c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODEwMTcxNg==", "url": "https://github.com/spinnaker/kork/pull/563#discussion_r398101716", "bodyText": "done", "author": "titirigaiulian", "createdAt": "2020-03-25T19:06:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxNDM0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxNDQyOA==", "url": "https://github.com/spinnaker/kork/pull/563#discussion_r395214428", "bodyText": "Why?", "author": "robzienert", "createdAt": "2020-03-19T17:53:23Z", "path": "spinnaker-dependencies/spinnaker-dependencies.gradle", "diffHunk": "@@ -123,7 +124,7 @@ dependencies {\n     api(\"commons-io:commons-io:2.5\")\n     api(\"de.danielbechler:java-object-diff:0.95\")\n     api(\"de.huxhorn.sulky:de.huxhorn.sulky.ulid:8.2.0\")\n-    api(\"dev.minutest:minutest:1.11.0\")\n+    api(\"dev.minutest:minutest:1.10.0\")", "originalCommit": "d0c966b56a09169a174c36cd7ad3a36e46fa901c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODEwMTkyNA==", "url": "https://github.com/spinnaker/kork/pull/563#discussion_r398101924", "bodyText": "Rebase leftover. Done", "author": "titirigaiulian", "createdAt": "2020-03-25T19:06:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIxNDQyOA=="}], "type": "inlineReview"}, {"oid": "a435f5003bdfa37c9c7394c0ded123035ddb57bc", "url": "https://github.com/spinnaker/kork/commit/a435f5003bdfa37c9c7394c0ded123035ddb57bc", "message": "Address reviews", "committedDate": "2020-03-25T19:03:44Z", "type": "forcePushed"}, {"oid": "06daba34dc11230b2b602affb56ba02181cff568", "url": "https://github.com/spinnaker/kork/commit/06daba34dc11230b2b602affb56ba02181cff568", "message": "Address reviews", "committedDate": "2020-06-12T12:25:30Z", "type": "forcePushed"}, {"oid": "a792e0b62e6a084a39fada0a833b6375f44f0314", "url": "https://github.com/spinnaker/kork/commit/a792e0b62e6a084a39fada0a833b6375f44f0314", "message": "Address reviews", "committedDate": "2020-06-12T12:30:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTU2ODAyOA==", "url": "https://github.com/spinnaker/kork/pull/563#discussion_r439568028", "bodyText": "I believe these should be implementation not api", "author": "cfieber", "createdAt": "2020-06-12T18:03:17Z", "path": "kork-config/kork-config.gradle", "diffHunk": "@@ -11,6 +11,8 @@ dependencies {\n \n   api \"org.springframework.cloud:spring-cloud-context\"\n   api \"org.springframework.cloud:spring-cloud-config-server\"\n+  api \"org.springframework.cloud:spring-cloud-aws-context\"", "originalCommit": "a792e0b62e6a084a39fada0a833b6375f44f0314", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "400282c67d821071d20257fa9077e4a74c40d16e", "url": "https://github.com/spinnaker/kork/commit/400282c67d821071d20257fa9077e4a74c40d16e", "message": "feat(configuration): Add support for spring cloud configuration with S3 backend", "committedDate": "2020-09-25T09:32:57Z", "type": "commit"}, {"oid": "c58bf71f6669c86fb55fa9701b4e1ecd17788f78", "url": "https://github.com/spinnaker/kork/commit/c58bf71f6669c86fb55fa9701b4e1ecd17788f78", "message": "Address reviews", "committedDate": "2020-09-25T09:37:55Z", "type": "commit"}, {"oid": "4d650465fff9fa08644a3fa4291cb428d400a354", "url": "https://github.com/spinnaker/kork/commit/4d650465fff9fa08644a3fa4291cb428d400a354", "message": "Rebase + reviews", "committedDate": "2020-09-28T12:04:03Z", "type": "forcePushed"}, {"oid": "0e5be9465593f121fdd8a60bd138610a055201f0", "url": "https://github.com/spinnaker/kork/commit/0e5be9465593f121fdd8a60bd138610a055201f0", "message": "Rebase + reviews", "committedDate": "2020-09-28T12:15:47Z", "type": "commit"}, {"oid": "0e5be9465593f121fdd8a60bd138610a055201f0", "url": "https://github.com/spinnaker/kork/commit/0e5be9465593f121fdd8a60bd138610a055201f0", "message": "Rebase + reviews", "committedDate": "2020-09-28T12:15:47Z", "type": "forcePushed"}, {"oid": "bfba47af29fe5063abd089a00a112c3ad05a57bd", "url": "https://github.com/spinnaker/kork/commit/bfba47af29fe5063abd089a00a112c3ad05a57bd", "message": "Merge branch 'master' into master", "committedDate": "2020-09-29T09:17:38Z", "type": "commit"}, {"oid": "bfe76910e46c46f5bd04f48fb1e99c78ff65f772", "url": "https://github.com/spinnaker/kork/commit/bfe76910e46c46f5bd04f48fb1e99c78ff65f772", "message": "Merge branch 'master' into master", "committedDate": "2020-09-30T19:20:17Z", "type": "commit"}, {"oid": "e4d3f0dc655f53a363eb02eeec8e4b49d86271c3", "url": "https://github.com/spinnaker/kork/commit/e4d3f0dc655f53a363eb02eeec8e4b49d86271c3", "message": "Merge branch 'master' into master", "committedDate": "2020-09-30T19:28:45Z", "type": "commit"}]}