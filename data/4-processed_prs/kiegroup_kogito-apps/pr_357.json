{"pr_number": 357, "pr_title": "FAI-240: Model definition endpoint - trusty-service", "pr_createdAt": "2020-07-31T14:03:41Z", "pr_url": "https://github.com/kiegroup/kogito-apps/pull/357", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY3NjcxOQ==", "url": "https://github.com/kiegroup/kogito-apps/pull/357#discussion_r463676719", "bodyText": "I think it could be protected or even private so we can avoid unexpected usages :)", "author": "danielezonca", "createdAt": "2020-07-31T15:25:00Z", "path": "trusty/trusty-service/src/main/java/org/kie/kogito/trusty/service/messaging/ModelEventConsumer.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ *  Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *        http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+\n+package org.kie.kogito.trusty.service.messaging;\n+\n+import java.util.Optional;\n+import java.util.concurrent.CompletionStage;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import io.cloudevents.v1.AttributesImpl;\n+import io.cloudevents.v1.CloudEventImpl;\n+import org.eclipse.microprofile.reactive.messaging.Incoming;\n+import org.eclipse.microprofile.reactive.messaging.Message;\n+import org.kie.kogito.decision.DecisionModelType;\n+import org.kie.kogito.tracing.decision.event.model.ModelEvent;\n+import org.kie.kogito.trusty.service.ITrustyService;\n+\n+@ApplicationScoped\n+public class ModelEventConsumer extends BaseEventConsumer<ModelEvent> {\n+\n+    private static final TypeReference<CloudEventImpl<ModelEvent>> CLOUD_EVENT_TYPE_REF = new TypeReference<>() {\n+    };\n+\n+    public ModelEventConsumer() {", "originalCommit": "35104de4cc2f7203fc2b3bad70a5f46b0780c098", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgzODAyOQ==", "url": "https://github.com/kiegroup/kogito-apps/pull/357#discussion_r463838029", "bodyText": "Done.", "author": "manstis", "createdAt": "2020-07-31T21:01:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY3NjcxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY3NzAzNw==", "url": "https://github.com/kiegroup/kogito-apps/pull/357#discussion_r463677037", "bodyText": "Same as above", "author": "danielezonca", "createdAt": "2020-07-31T15:25:31Z", "path": "trusty/trusty-service/src/main/java/org/kie/kogito/trusty/service/messaging/TraceEventConsumer.java", "diffHunk": "@@ -27,49 +27,38 @@\n import io.cloudevents.v1.CloudEventImpl;\n import org.eclipse.microprofile.reactive.messaging.Incoming;\n import org.eclipse.microprofile.reactive.messaging.Message;\n-import org.kie.kogito.tracing.decision.event.CloudEventUtils;\n import org.kie.kogito.tracing.decision.event.trace.TraceEvent;\n import org.kie.kogito.tracing.decision.event.trace.TraceEventType;\n import org.kie.kogito.trusty.service.ITrustyService;\n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n \n @ApplicationScoped\n-public class TraceEventConsumer {\n-\n-    private static final Logger LOG = LoggerFactory.getLogger(TraceEventConsumer.class);\n+public class TraceEventConsumer extends BaseEventConsumer<TraceEvent> {\n \n     private static final TypeReference<CloudEventImpl<TraceEvent>> CLOUD_EVENT_TYPE_REF = new TypeReference<>() {\n     };\n \n-    private final ITrustyService service;\n+    public TraceEventConsumer() {", "originalCommit": "35104de4cc2f7203fc2b3bad70a5f46b0780c098", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzgzODEzMA==", "url": "https://github.com/kiegroup/kogito-apps/pull/357#discussion_r463838130", "bodyText": "Done.", "author": "manstis", "createdAt": "2020-07-31T21:01:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY3NzAzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg0MDg5MA==", "url": "https://github.com/kiegroup/kogito-apps/pull/357#discussion_r463840890", "bodyText": "Simple enough; but I put it in a separate class to (1) be consistent, (2) in case it becomes more complex later.", "author": "manstis", "createdAt": "2020-07-31T21:05:06Z", "path": "trusty/trusty-service/src/main/java/org/kie/kogito/trusty/service/messaging/ModelEventConverter.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ *  Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *        http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+\n+package org.kie.kogito.trusty.service.messaging;\n+\n+import org.kie.kogito.tracing.decision.event.model.ModelEvent;\n+\n+public class ModelEventConverter {\n+\n+    public static String toModel(final ModelEvent event) {\n+        return event.getDefinition();", "originalCommit": "41bedc71d93b73516cb627f7b8ace9ebc6faa3d8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg0MjczNg==", "url": "https://github.com/kiegroup/kogito-apps/pull/357#discussion_r463842736", "bodyText": "@r00ta FYI, I updated the test topic name to be consistent with the non-test topic naming.", "author": "manstis", "createdAt": "2020-07-31T21:07:42Z", "path": "trusty/trusty-service/src/test/resources/application.properties", "diffHunk": "@@ -8,9 +8,16 @@ quarkus.infinispan-client.auth-server-name=infinispan\n quarkus.infinispan-client.client-intelligence=BASIC\n quarkus.infinispan-client.sasl-mechanism=DIGEST-MD5\n kogito.persistence.type=infinispan\n+\n # Kafka Tracing\n mp.messaging.incoming.kogito-tracing.group.id=trusty-service\n mp.messaging.incoming.kogito-tracing.connector=smallrye-kafka\n-mp.messaging.incoming.kogito-tracing.topic=trusty-service-test\n+mp.messaging.incoming.kogito-tracing.topic=kogito-tracing-test", "originalCommit": "41bedc71d93b73516cb627f7b8ace9ebc6faa3d8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "35eedeb6cc57dc087dc002aab33fe4017d4b617c", "url": "https://github.com/kiegroup/kogito-apps/commit/35eedeb6cc57dc087dc002aab33fe4017d4b617c", "message": "FAI-240: Model definition endpoint - trusty-service", "committedDate": "2020-08-03T20:08:20Z", "type": "commit"}, {"oid": "0073dfa06b7c537c7eb0e5e448b8c6c2bf6d8328", "url": "https://github.com/kiegroup/kogito-apps/commit/0073dfa06b7c537c7eb0e5e448b8c6c2bf6d8328", "message": "Refactor to common BaseEventConsumer class..", "committedDate": "2020-08-03T20:08:20Z", "type": "commit"}, {"oid": "76f314e6f60c44746463a8b6c980a30aaeb2de32", "url": "https://github.com/kiegroup/kogito-apps/commit/76f314e6f60c44746463a8b6c980a30aaeb2de32", "message": "Make zero parameter constructors private following peer review.", "committedDate": "2020-08-03T20:08:20Z", "type": "commit"}, {"oid": "c0fd8b569eae297f5cb66f72f1d5534baa071cdd", "url": "https://github.com/kiegroup/kogito-apps/commit/c0fd8b569eae297f5cb66f72f1d5534baa071cdd", "message": "Increase test coverage", "committedDate": "2020-08-03T20:08:21Z", "type": "commit"}, {"oid": "c0fd8b569eae297f5cb66f72f1d5534baa071cdd", "url": "https://github.com/kiegroup/kogito-apps/commit/c0fd8b569eae297f5cb66f72f1d5534baa071cdd", "message": "Increase test coverage", "committedDate": "2020-08-03T20:08:21Z", "type": "forcePushed"}]}