{"pr_number": 517, "pr_title": "KOGITO-3619 Bulk cancel operation", "pr_createdAt": "2020-11-03T04:10:06Z", "pr_url": "https://github.com/kiegroup/kogito-apps/pull/517", "timeline": [{"oid": "dfb279763beb5a206f180e4508f9f49812337a7b", "url": "https://github.com/kiegroup/kogito-apps/commit/dfb279763beb5a206f180e4508f9f49812337a7b", "message": "KOGITO-3619 Bulk cancel operation", "committedDate": "2020-11-03T06:05:59Z", "type": "forcePushed"}, {"oid": "01856402da434810582c730b1a3ac964c1d098ff", "url": "https://github.com/kiegroup/kogito-apps/commit/01856402da434810582c730b1a3ac964c1d098ff", "message": "KOGITO-3619 Bulk cancel operation", "committedDate": "2020-11-03T06:06:31Z", "type": "forcePushed"}, {"oid": "675a64e5c54a4e274a20c1036ea945e528ba5c3d", "url": "https://github.com/kiegroup/kogito-apps/commit/675a64e5c54a4e274a20c1036ea945e528ba5c3d", "message": "KOGITO-3619 Bulk cancel operation", "committedDate": "2020-11-03T07:25:05Z", "type": "forcePushed"}, {"oid": "b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "url": "https://github.com/kiegroup/kogito-apps/commit/b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "message": "KOGITO-3619 Bulk cancel operation", "committedDate": "2020-11-03T10:08:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU4ODU5Mw==", "url": "https://github.com/kiegroup/kogito-apps/pull/517#discussion_r516588593", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  successInstances: {},\n          \n          \n            \n                  failedInstances: {},\n          \n          \n            \n                  IgnoredInstances: {}\n          \n          \n            \n                  successJobs: {},\n          \n          \n            \n                  failedJobs: {},\n          \n          \n            \n                  ignoredJobs: {}", "author": "jstastny-cz", "createdAt": "2020-11-03T11:10:19Z", "path": "ui-packages/packages/management-console/src/components/Atoms/JobsCancelModal/tests/JobsCancelModal.test.tsx", "diffHunk": "@@ -2,17 +2,50 @@ import React from 'react';\n import { setTitle } from '../../../../utils/Utils';\n import JobsCancelModal from '../JobsCancelModal';\n import { shallow } from 'enzyme';\n+jest.mock('../../ProcessListBulkInstances/ProcessListBulkInstances');\n \n+const jobOperation = {\n+  CANCEL: {\n+    messages: {\n+      successMessage: 'Cancel Jobs',\n+      ignoredMessage:\n+        'These jobs were ignored because they were executed or canceled',\n+      noProcessMessage: 'No jobs were canceled'\n+    },\n+    functions: {\n+      perform: jest.fn()\n+    },\n+    results: {\n+      successInstances: {},\n+      failedInstances: {},\n+      IgnoredInstances: {}", "originalCommit": "b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU5MjE1Mg==", "url": "https://github.com/kiegroup/kogito-apps/pull/517#discussion_r516592152", "bodyText": "See - those are the issues when reusing IOperation from ProcessListToolbar.", "author": "jstastny-cz", "createdAt": "2020-11-03T11:16:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU4ODU5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU5MDk4NA==", "url": "https://github.com/kiegroup/kogito-apps/pull/517#discussion_r516590984", "bodyText": "Seems like the type is dictating Process specific naming of properties, I think we can do bigger refactoring and extract the IOperation from ProcessListToolbar + name the properties more generally.", "author": "jstastny-cz", "createdAt": "2020-11-03T11:14:42Z", "path": "ui-packages/packages/management-console/src/components/Atoms/JobsCancelModal/JobsCancelModal.tsx", "diffHunk": "@@ -1,19 +1,24 @@\n import React from 'react';\n import { Modal, Button, TextContent, Text } from '@patternfly/react-core';\n import { OUIAProps, componentOuiaProps } from '@kogito-apps/common';\n+import ProcessListBulkInstances from '../ProcessListBulkInstances/ProcessListBulkInstances';\n+import { IOperation } from '../../Molecules/ProcessListToolbar/ProcessListToolbar';\n+\n interface IOwnProps {\n   actionType: string;\n   modalTitle: JSX.Element;\n   modalContent: string;\n   handleModalToggle: () => void;\n   isModalOpen: boolean;\n+  jobOperations?: IOperation;", "originalCommit": "b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU5MTcxOA==", "url": "https://github.com/kiegroup/kogito-apps/pull/517#discussion_r516591718", "bodyText": "Again, we should not use this component IMO, its name indicates ProcessList operation rather than job operation. But again we can refactor to have a generally usable component.", "author": "jstastny-cz", "createdAt": "2020-11-03T11:16:03Z", "path": "ui-packages/packages/management-console/src/components/Atoms/JobsCancelModal/JobsCancelModal.tsx", "diffHunk": "@@ -37,9 +42,13 @@ const JobsCancelModal: React.FC<IOwnProps & OUIAProps> = ({\n       ]}\n       {...componentOuiaProps(ouiaId, 'jobs-cancel-modal', ouiaSafe)}\n     >\n-      <TextContent>\n-        <Text>{modalContent}</Text>\n-      </TextContent>\n+      {modalContent.length > 0 ? (\n+        <TextContent>\n+          <Text>{modalContent}</Text>\n+        </TextContent>\n+      ) : (\n+        <ProcessListBulkInstances operationResult={jobOperations} type=\"job\" />", "originalCommit": "b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU5NTE0NA==", "url": "https://github.com/kiegroup/kogito-apps/pull/517#discussion_r516595144", "bodyText": "Introduce a generally usable component that would be usable in both cases (we can't name it ProcessListBulkInstances when using for Jobs).", "author": "jstastny-cz", "createdAt": "2020-11-03T11:22:33Z", "path": "ui-packages/packages/management-console/src/components/Atoms/ProcessListBulkInstances/ProcessListBulkInstances.tsx", "diffHunk": "@@ -14,16 +14,30 @@ import {\n   GraphQL\n } from '@kogito-apps/common';\n import { IOperation } from '../../Molecules/ProcessListToolbar/ProcessListToolbar';\n-import { getProcessInstanceDescription } from '../../../utils/Utils';\n+import {\n+  getProcessInstanceDescription,\n+  getJobsDescription\n+} from '../../../utils/Utils';\n \n interface IOwnProps {\n   operationResult: IOperation;\n+  type: string;\n }\n+\n const ProcessListBulkInstances: React.FC<IOwnProps & OUIAProps> = ({\n   operationResult,\n+  type,\n   ouiaId,\n   ouiaSafe\n }) => {\n+  const getItemDescription = item => {", "originalCommit": "b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU5NTgwMQ==", "url": "https://github.com/kiegroup/kogito-apps/pull/517#discussion_r516595801", "bodyText": "Here we can use the general component.", "author": "jstastny-cz", "createdAt": "2020-11-03T11:23:48Z", "path": "ui-packages/packages/management-console/src/components/Atoms/ProcessListModal/ProcessListModal.tsx", "diffHunk": "@@ -63,7 +63,10 @@ const ProcessListModal: React.FC<IOwnProps & OUIAProps> = ({\n       {...componentOuiaProps(ouiaId, 'process-list-modal', ouiaSafe)}\n     >\n       {operationResult !== undefined && (\n-        <ProcessListBulkInstances operationResult={operationResult} />\n+        <ProcessListBulkInstances", "originalCommit": "b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU5NjQwNQ==", "url": "https://github.com/kiegroup/kogito-apps/pull/517#discussion_r516596405", "bodyText": "here again, this would need to be generalized not to introduce Jobs into Process specific component.", "author": "jstastny-cz", "createdAt": "2020-11-03T11:24:55Z", "path": "ui-packages/packages/management-console/src/components/Molecules/ProcessListToolbar/ProcessListToolbar.tsx", "diffHunk": "@@ -66,11 +66,14 @@ export interface ProcessInstanceBulkList {\n     'id' | 'processId' | 'serviceUrl' | 'state'\n   >;\n }\n+export interface JobsBulkList {\n+  [key: string]: GraphQL.Job;\n+}\n \n interface IOperationResult {\n-  successInstances: ProcessInstanceBulkList;\n-  failedInstances: ProcessInstanceBulkList;\n-  ignoredInstances: ProcessInstanceBulkList;\n+  successInstances: ProcessInstanceBulkList | JobsBulkList;", "originalCommit": "b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU5NzY1OQ==", "url": "https://github.com/kiegroup/kogito-apps/pull/517#discussion_r516597659", "bodyText": "this is again an ugly example of reusing process-specific component for jobs - noProcessMessage", "author": "jstastny-cz", "createdAt": "2020-11-03T11:27:20Z", "path": "ui-packages/packages/management-console/src/components/Templates/JobsManagementPage/JobsManagementPage.tsx", "diffHunk": "@@ -43,10 +54,75 @@ const JobsManagementPage: React.FC<OUIAProps> = ({ ouiaId, ouiaSafe }) => {\n   const [modalTitle, setModalTitle] = useState<JSX.Element>(null);\n   const [modalContent, setModalContent] = useState<string>('');\n   const [selectedJob, setSelectedJob] = useState<any>({});\n+  const [isKebabOpen, setIsKebabOpen] = useState<boolean>(false);\n+  const [selectedJobInstances, setSelectedJobInstances] = useState<\n+    GraphQL.Job[]\n+  >([]);\n+  const [jobOperationResults, setJobOperationResults] = useState({\n+    CANCEL: {\n+      successInstances: {},\n+      failedInstances: {},\n+      ignoredInstances: {}\n+    }\n+  });\n+  const jobOperations = {\n+    CANCEL: {\n+      results: jobOperationResults[JobOperationType.CANCEL],\n+      messages: {\n+        successMessage: 'Cancel jobs: ',\n+        noProcessMessage: 'No jobs were canceled',", "originalCommit": "b4847a275f9de99efd2da0da1f5abf1f8d4840ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "68c21e707ae5a74a251b8d5ad6c245e97a8890a0", "url": "https://github.com/kiegroup/kogito-apps/commit/68c21e707ae5a74a251b8d5ad6c245e97a8890a0", "message": "split jobs and process bulk list", "committedDate": "2020-11-03T12:28:42Z", "type": "forcePushed"}, {"oid": "3899b9ec2cd3abf9c8f686ea8d497c4306f2ae02", "url": "https://github.com/kiegroup/kogito-apps/commit/3899b9ec2cd3abf9c8f686ea8d497c4306f2ae02", "message": "split jobs and process bulk list", "committedDate": "2020-11-03T12:44:55Z", "type": "forcePushed"}, {"oid": "83c2de469529241183cac04a4d52064e23ab1a2d", "url": "https://github.com/kiegroup/kogito-apps/commit/83c2de469529241183cac04a4d52064e23ab1a2d", "message": "split jobs and process bulk list", "committedDate": "2020-11-03T12:47:49Z", "type": "forcePushed"}, {"oid": "89893e57135a2cdef70e454d4f36a8e70efccb12", "url": "https://github.com/kiegroup/kogito-apps/commit/89893e57135a2cdef70e454d4f36a8e70efccb12", "message": "KOGITO-3619 Bulk cancel operation", "committedDate": "2020-11-05T15:16:52Z", "type": "commit"}, {"oid": "d6278cc641ee84c1d03efdc6546054e6bd606a00", "url": "https://github.com/kiegroup/kogito-apps/commit/d6278cc641ee84c1d03efdc6546054e6bd606a00", "message": "split jobs and process bulk list", "committedDate": "2020-11-05T15:18:10Z", "type": "forcePushed"}, {"oid": "95232ef5795aa0dda81c9f8cd61280c8f7f6043a", "url": "https://github.com/kiegroup/kogito-apps/commit/95232ef5795aa0dda81c9f8cd61280c8f7f6043a", "message": "split jobs and process bulk list", "committedDate": "2020-11-06T03:20:00Z", "type": "commit"}, {"oid": "95232ef5795aa0dda81c9f8cd61280c8f7f6043a", "url": "https://github.com/kiegroup/kogito-apps/commit/95232ef5795aa0dda81c9f8cd61280c8f7f6043a", "message": "split jobs and process bulk list", "committedDate": "2020-11-06T03:20:00Z", "type": "forcePushed"}]}