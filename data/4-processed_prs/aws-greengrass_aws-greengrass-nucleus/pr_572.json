{"pr_number": 572, "pr_title": "local deployment use operation centered syntax for config update", "pr_createdAt": "2020-10-26T17:30:28Z", "pr_url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/572", "timeline": [{"oid": "45ca1349b4539a9e9d05d4d6d887b927c90e5a75", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/45ca1349b4539a9e9d05d4d6d887b927c90e5a75", "message": "local deployment use operation centered syntax for config update", "committedDate": "2020-10-26T16:59:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE2NjE3NQ==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/572#discussion_r512166175", "bodyText": "Will this disrupt the existing CLI UATs?", "author": "abanthiy", "createdAt": "2020-10-26T18:06:13Z", "path": "src/main/java/com/aws/greengrass/builtin/services/cli/CLIEventStreamAgent.java", "diffHunk": "@@ -455,13 +456,23 @@ public CreateLocalDeploymentResponse handleRequest(CreateLocalDeploymentRequest\n             // new recipes set using the updateRecipesAndArtifacts API.\n             String deploymentId = UUID.randomUUID().toString();\n \n+            Map<String, ConfigurationUpdateOperation> configUpdate = null;\n+            if (request.getComponentToConfiguration() != null) {\n+                configUpdate = request.getComponentToConfiguration().entrySet().stream()\n+                        .collect(Collectors.toMap(Map.Entry::getKey, e -> {\n+                            ConfigurationUpdateOperation configUpdateOption = new ConfigurationUpdateOperation();\n+                            configUpdateOption.setValueToMerge((Map) e.getValue().get(\"MERGE\"));\n+                            configUpdateOption.setPathsToReset((List) e.getValue().get(\"RESET\"));\n+                            return configUpdateOption;\n+                        }));\n+            }\n             LocalOverrideRequest localOverrideRequest = LocalOverrideRequest.builder().requestId(deploymentId)\n                     .componentsToMerge(request.getRootComponentVersionsToAdd())\n                     .componentsToRemove(request.getRootComponentsToRemove())\n                     .requestTimestamp(System.currentTimeMillis())\n                     .groupName(request.getGroupName() == null || request.getGroupName().isEmpty() ? DEFAULT_GROUP_NAME\n                             : request.getGroupName())\n-                    .componentNameToConfig(request.getComponentToConfiguration()).build();\n+                    .configurationUpdate(configUpdate).build();", "originalCommit": "45ca1349b4539a9e9d05d4d6d887b927c90e5a75", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjMxNjIyNw==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/572#discussion_r512316227", "bodyText": "No It should not", "author": "fahadmohammed01", "createdAt": "2020-10-26T22:52:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE2NjE3NQ=="}], "type": "inlineReview"}, {"oid": "5702ffd9713ef8dac3459e0b3128fa3215487246", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/5702ffd9713ef8dac3459e0b3128fa3215487246", "message": "Merge branch 'master' into local-deployment-update", "committedDate": "2020-10-26T19:41:09Z", "type": "commit"}, {"oid": "217662175add2454d1a019f94e8d8c8a2465bfd2", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/217662175add2454d1a019f94e8d8c8a2465bfd2", "message": "Merge branch 'master' into local-deployment-update", "committedDate": "2020-10-27T00:55:18Z", "type": "commit"}, {"oid": "31c01e7eec7bc1bb1447d89c12f636e77ef954ae", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/31c01e7eec7bc1bb1447d89c12f636e77ef954ae", "message": "Merge branch 'master' into local-deployment-update", "committedDate": "2020-10-27T06:18:15Z", "type": "commit"}]}