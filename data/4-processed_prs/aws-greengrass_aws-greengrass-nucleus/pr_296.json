{"pr_number": 296, "pr_title": "Updating readme for multiple group deployments support", "pr_createdAt": "2020-07-03T01:04:22Z", "pr_url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296", "timeline": [{"oid": "526f4d29455e4232edd5932619682b85ed66c584", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/526f4d29455e4232edd5932619682b85ed66c584", "message": "Updating readme for multiple group deployments support", "committedDate": "2020-07-03T01:02:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NTUwMg==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#discussion_r451045502", "bodyText": "nit: without", "author": "hui-yang", "createdAt": "2020-07-07T17:58:13Z", "path": "src/main/java/com/aws/iot/evergreen/deployment/README.md", "diffHunk": "@@ -47,4 +48,24 @@ the instruction from CLI to create a deployment. Upon getting such instruction *\n 3. *DeploymentService* waits for the deployment to get completed and then invokes [***DeploymentStatusKeeper***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentStatusKeeper.java) \n to update the status of the job. Currently *DeploymentStatusKeeper* does not do anything for LOCAL deployment types\n     \n-  \n+## Multiple Group Deployments\n+An Iot device can belong to mutiple Iot ThingGroups. When a configuration is set and published for any such group, \n+that results in a deployment on every device in that group. As device can belong to multiple groups, the device needs\n+ to maintain a status of what components are being deployed as part of which groups. This is needed so that a \n+ deployment for one group does not remove the components deployed previously as part of another group. Any \n+ deployments done outside of ThingGroup are treated as belonging to DEFAULT group. This would include individual \n+ device deployment (done via Iot Device shadows), local deployment (wthout mentioning any group).", "originalCommit": "526f4d29455e4232edd5932619682b85ed66c584", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NTY4NA==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#discussion_r451045684", "bodyText": "nit: multiple", "author": "hui-yang", "createdAt": "2020-07-07T17:58:33Z", "path": "src/main/java/com/aws/iot/evergreen/deployment/README.md", "diffHunk": "@@ -47,4 +48,24 @@ the instruction from CLI to create a deployment. Upon getting such instruction *\n 3. *DeploymentService* waits for the deployment to get completed and then invokes [***DeploymentStatusKeeper***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentStatusKeeper.java) \n to update the status of the job. Currently *DeploymentStatusKeeper* does not do anything for LOCAL deployment types\n     \n-  \n+## Multiple Group Deployments\n+An Iot device can belong to mutiple Iot ThingGroups. When a configuration is set and published for any such group, ", "originalCommit": "526f4d29455e4232edd5932619682b85ed66c584", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NzAzMw==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#discussion_r451047033", "bodyText": "nit: \", \"", "author": "hui-yang", "createdAt": "2020-07-07T18:00:44Z", "path": "src/main/java/com/aws/iot/evergreen/deployment/README.md", "diffHunk": "@@ -47,4 +48,24 @@ the instruction from CLI to create a deployment. Upon getting such instruction *\n 3. *DeploymentService* waits for the deployment to get completed and then invokes [***DeploymentStatusKeeper***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentStatusKeeper.java) \n to update the status of the job. Currently *DeploymentStatusKeeper* does not do anything for LOCAL deployment types\n     \n-  \n+## Multiple Group Deployments\n+An Iot device can belong to mutiple Iot ThingGroups. When a configuration is set and published for any such group, \n+that results in a deployment on every device in that group. As device can belong to multiple groups, the device needs\n+ to maintain a status of what components are being deployed as part of which groups. This is needed so that a \n+ deployment for one group does not remove the components deployed previously as part of another group. Any \n+ deployments done outside of ThingGroup are treated as belonging to DEFAULT group. This would include individual \n+ device deployment (done via Iot Device shadows), local deployment (wthout mentioning any group).\n+ 1. [***DeploymentService***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentService.java) maintains a \n+ mapping of groupName to the root components and their version constraints ,deployed as ", "originalCommit": "526f4d29455e4232edd5932619682b85ed66c584", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "584e4b6f881643040df86e12fd3dc72b263f99dd", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/584e4b6f881643040df86e12fd3dc72b263f99dd", "message": "Merge branch 'master' into deploymentDocumentation", "committedDate": "2020-07-16T07:21:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU2MzI5Mg==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/296#discussion_r455563292", "bodyText": "bad link, I think, this is just going to the directory instead of the file", "author": "MikeDombo", "createdAt": "2020-07-16T07:22:21Z", "path": "src/main/java/com/aws/iot/evergreen/deployment/README.md", "diffHunk": "@@ -47,4 +48,24 @@ the instruction from CLI to create a deployment. Upon getting such instruction *\n 3. *DeploymentService* waits for the deployment to get completed and then invokes [***DeploymentStatusKeeper***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentStatusKeeper.java) \n to update the status of the job. Currently *DeploymentStatusKeeper* does not do anything for LOCAL deployment types\n     \n-  \n+## Multiple Group Deployments\n+An Iot device can belong to mutiple Iot ThingGroups. When a configuration is set and published for any such group, \n+that results in a deployment on every device in that group. As device can belong to multiple groups, the device needs\n+ to maintain a status of what components are being deployed as part of which groups. This is needed so that a \n+ deployment for one group does not remove the components deployed previously as part of another group. Any \n+ deployments done outside of ThingGroup are treated as belonging to DEFAULT group. This would include individual \n+ device deployment (done via Iot Device shadows), local deployment (wthout mentioning any group).\n+ 1. [***DeploymentService***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentService.java) maintains a \n+ mapping of groupName to the root components and their version constraints ,deployed as \n+ part of that group.This \n+ mapping is stored in the DeploymentService's [***Configuration***](/src/main/java/com/aws/iot/evergreen/config/Configuration.java).\n+ 2. Upon receiving a new deployment from the *DeploymentsQueue*, when constructing the new configuration for the \n+ kernel, the [***DeploymentTask***](/src/main/java/com/aws/iot/evergreen/deployment/DeploymentTask.java) uses the \n+ saved mapping to calculate the set of root components. For the group that is being deployed, it takes the root \n+ components from the deployment document. For all other groups it takes the root components from the saved mapping.\n+ 3. [***DependencyResolver***](/src/main/java/com/aws/iot/evergreen/deployment/) uses the saved mapping to calculate ", "originalCommit": "526f4d29455e4232edd5932619682b85ed66c584", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "86f63375aaa8c7eccf17db5f498baeb1ccb8c313", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/86f63375aaa8c7eccf17db5f498baeb1ccb8c313", "message": "Update README.md", "committedDate": "2020-07-21T17:15:14Z", "type": "commit"}, {"oid": "4c6f1a5cc2f586c9cfb235f660e6bc60a806675e", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/4c6f1a5cc2f586c9cfb235f660e6bc60a806675e", "message": "Merge branch 'master' into deploymentDocumentation", "committedDate": "2020-07-21T17:15:30Z", "type": "commit"}]}