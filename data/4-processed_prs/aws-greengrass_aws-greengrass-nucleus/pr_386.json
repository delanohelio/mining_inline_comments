{"pr_number": 386, "pr_title": "setup to consume common lib from codeartifact", "pr_createdAt": "2020-08-25T19:39:08Z", "pr_url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386", "timeline": [{"oid": "f7aa431158dea3894b54a8fff9455012f7907888", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f7aa431158dea3894b54a8fff9455012f7907888", "message": "setup to consume common lib from codeartifact", "committedDate": "2020-08-25T17:32:32Z", "type": "commit"}, {"oid": "35e7f510666b40a0a688a7c03817eb1e09426777", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/35e7f510666b40a0a688a7c03817eb1e09426777", "message": "acquire code-artifact token in github actions", "committedDate": "2020-08-25T20:22:27Z", "type": "commit"}, {"oid": "873d8a33384aa14341605d21271e495d790f56e6", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/873d8a33384aa14341605d21271e495d790f56e6", "message": "echo token", "committedDate": "2020-08-25T21:42:29Z", "type": "commit"}, {"oid": "ecafa3825907a8b9875aa4f723201cd18a82e454", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/ecafa3825907a8b9875aa4f723201cd18a82e454", "message": "Revert \"echo token\"\n\nThis reverts commit 873d8a33384aa14341605d21271e495d790f56e6.", "committedDate": "2020-08-25T22:05:13Z", "type": "commit"}, {"oid": "09ca09833c935e264ebf2857091d4e342a7a891c", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/09ca09833c935e264ebf2857091d4e342a7a891c", "message": "echo token", "committedDate": "2020-08-25T22:07:17Z", "type": "commit"}, {"oid": "c1944f3d9f81a449eb79e73cd7cd7a655d883c24", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/c1944f3d9f81a449eb79e73cd7cd7a655d883c24", "message": "add region in get coderartifact token command", "committedDate": "2020-08-25T22:14:14Z", "type": "commit"}, {"oid": "3e68d75d325a95ccd9c654e7afb8695764f229ef", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/3e68d75d325a95ccd9c654e7afb8695764f229ef", "message": "debug github action on acquiring token", "committedDate": "2020-08-25T22:44:52Z", "type": "commit"}, {"oid": "4526414ea284a4a4d234e60657f5c90295188de8", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/4526414ea284a4a4d234e60657f5c90295188de8", "message": "acquire token before running mvn build", "committedDate": "2020-08-25T22:48:06Z", "type": "commit"}, {"oid": "68d8aea6b48e3623109b0495a2363d398ea07c95", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/68d8aea6b48e3623109b0495a2363d398ea07c95", "message": "echo token for debug", "committedDate": "2020-08-25T22:51:00Z", "type": "commit"}, {"oid": "968e4012d510a0103e410c4a713541137bcfaa59", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/968e4012d510a0103e410c4a713541137bcfaa59", "message": "use settings.xml in maven build", "committedDate": "2020-08-25T23:21:31Z", "type": "commit"}, {"oid": "647e2b4987f6f7c8400496576267e5744ffc33bd", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/647e2b4987f6f7c8400496576267e5744ffc33bd", "message": "Merge branch 'master' into consume_common_lib", "committedDate": "2020-08-25T23:31:55Z", "type": "commit"}, {"oid": "980cd3d7aad4a98ea45bbf6beba504e640830b63", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/980cd3d7aad4a98ea45bbf6beba504e640830b63", "message": "Merge branch 'master' into consume_common_lib", "committedDate": "2020-08-26T06:12:13Z", "type": "commit"}, {"oid": "e9a3de9bbbef8bd51030dbaa8ea9c5e876d16086", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/e9a3de9bbbef8bd51030dbaa8ea9c5e876d16086", "message": "remove dependency, revert token acquire, try running unit tests", "committedDate": "2020-08-26T16:31:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0MDY5Mw==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#discussion_r477440693", "bodyText": "this is the windows build. You need to make it work on windows and linux (L41)", "author": "MikeDombo", "createdAt": "2020-08-26T16:43:11Z", "path": ".github/workflows/maven.yml", "diffHunk": "@@ -32,7 +32,9 @@ jobs:\n       - run: rm -rf /tmp/*\n         continue-on-error: true\n       - name: Build with Maven\n-        run: mvn -ntp -U clean verify\n+        run: |\n+          for /f %i in ('aws codeartifact get-authorization-token --domain evergreen --query authorizationToken --output text --region us-west-2') do set CODEARTIFACT_AUTH_TOKEN=%i", "originalCommit": "e9a3de9bbbef8bd51030dbaa8ea9c5e876d16086", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Nzc2OTg4Mw==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#discussion_r477769883", "bodyText": "Yeah, working on it.", "author": "wikimonkey", "createdAt": "2020-08-27T00:27:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0MDY5Mw=="}], "type": "inlineReview"}, {"oid": "f1725e478c811435f1e631dcd36f5924127660da", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f1725e478c811435f1e631dcd36f5924127660da", "message": "validate windows cmd running multiple commands", "committedDate": "2020-08-26T21:31:45Z", "type": "commit"}, {"oid": "f2d2b74a6b90e3ec2c49ec7855e347d2ad096378", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f2d2b74a6b90e3ec2c49ec7855e347d2ad096378", "message": "try with powershell", "committedDate": "2020-08-26T23:15:26Z", "type": "commit"}, {"oid": "4d149ec5ff9b5b38b52d909aa918cdb497b6c3d6", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/4d149ec5ff9b5b38b52d909aa918cdb497b6c3d6", "message": "use powershell to run windows commands", "committedDate": "2020-08-26T23:19:43Z", "type": "commit"}, {"oid": "44fee2452814a6b96d6d12820d2110324467a42e", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/44fee2452814a6b96d6d12820d2110324467a42e", "message": "Merge branch 'master' into consume_common_lib", "committedDate": "2020-08-26T23:31:05Z", "type": "commit"}, {"oid": "5ad7d83f4ad3012b56deaa0cccc6a044001dab02", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/5ad7d83f4ad3012b56deaa0cccc6a044001dab02", "message": "Merge branch 'master' into consume_common_lib", "committedDate": "2020-08-27T00:25:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzgxOTE3OA==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#discussion_r477819178", "bodyText": "Can we get cloud to publish into S3? This requires us to have tokens on all of our computers and every single build step across all our repositories (there are already more than 10).", "author": "MikeDombo", "createdAt": "2020-08-27T00:53:39Z", "path": ".github/workflows/maven.yml", "diffHunk": "@@ -32,11 +32,15 @@ jobs:\n       - run: rm -rf /tmp/*\n         continue-on-error: true\n       - name: Build with Maven\n-        run: mvn -ntp -U clean verify\n-        shell: cmd\n+        run: |\n+          $CODEARTIFACT_TOKEN = aws codeartifact get-authorization-token --domain evergreen --query authorizationToken --output text --region us-west-2", "originalCommit": "5ad7d83f4ad3012b56deaa0cccc6a044001dab02", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Nzg3NDYzOQ==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/386#discussion_r477874639", "bodyText": "Right, given code artifact is not that 'easy' to use, cost over weighs benefits. I will just go back to use S3.", "author": "wikimonkey", "createdAt": "2020-08-27T01:30:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzgxOTE3OA=="}], "type": "inlineReview"}, {"oid": "01d2d2ceb3ea6db0d84594791c0a5d7f801fb0a0", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/01d2d2ceb3ea6db0d84594791c0a5d7f801fb0a0", "message": "use existing s3->cloudfront path to consume component common lib", "committedDate": "2020-08-27T02:58:02Z", "type": "commit"}, {"oid": "99440014771decedfcb56fdf31c05e0745c45a65", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/99440014771decedfcb56fdf31c05e0745c45a65", "message": "revert github action experimental changes", "committedDate": "2020-08-27T02:58:53Z", "type": "commit"}, {"oid": "2a26c1ecd97bddb87267fd04d530dcb91e40671d", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2a26c1ecd97bddb87267fd04d530dcb91e40671d", "message": "Merge branch 'master' into consume_common_lib", "committedDate": "2020-08-27T16:42:55Z", "type": "commit"}]}