{"pr_number": 414, "pr_title": "Make S3 download fallback if TES credentials are null", "pr_createdAt": "2020-09-05T01:59:38Z", "pr_url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414", "timeline": [{"oid": "6f148b258d02da7a5d9d924a7c59bb9da763e2da", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/6f148b258d02da7a5d9d924a7c59bb9da763e2da", "message": "Make S3 download fallback if TES credentials are null", "committedDate": "2020-09-05T01:58:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA3NTU0Ng==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414#discussion_r485075546", "bodyText": "Shouldn't resolve throw ideally?", "author": "prateek-y", "createdAt": "2020-09-08T17:14:11Z", "path": "src/main/java/com/aws/iot/evergreen/tes/LazyCredentialProvider.java", "diffHunk": "@@ -34,10 +34,15 @@ public LazyCredentialProvider(Kernel kernel) {\n     @Override\n     public AwsCredentials resolveCredentials() {\n         try {\n-            return ((TokenExchangeService) kernel.locate(TOKEN_EXCHANGE_SERVICE_TOPICS)).resolveCredentials();\n+            AwsCredentials creds =\n+                    ((TokenExchangeService) kernel.locate(TOKEN_EXCHANGE_SERVICE_TOPICS)).resolveCredentials();", "originalCommit": "6f148b258d02da7a5d9d924a7c59bb9da763e2da", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA3Nzg3Mg==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414#discussion_r485077872", "bodyText": "Perhaps, but all that TES code is really ugly and should be rewritten.", "author": "MikeDombo", "createdAt": "2020-09-08T17:18:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA3NTU0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA5ODAxOQ==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414#discussion_r485098019", "bodyText": "Do you have any suggestions on how can we make it better there?", "author": "prateek-y", "createdAt": "2020-09-08T17:55:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA3NTU0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTEwMTAyMg==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/414#discussion_r485101022", "bodyText": "Use the IoT SDK instead of writing it ourselves\nStore the credentials instead of byte[] - We deserialize, serialize, and deserialize again on every request; it is insane.\nDo not return null when the credentials are invalid, but a reasonable exception", "author": "MikeDombo", "createdAt": "2020-09-08T18:00:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA3NTU0Ng=="}], "type": "inlineReview"}, {"oid": "65e11bcc4af286ddc6f10f018d750b7e1bbfbcf9", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/65e11bcc4af286ddc6f10f018d750b7e1bbfbcf9", "message": "Merge branch 'master' into s3-cred-fallback", "committedDate": "2020-09-08T23:41:09Z", "type": "commit"}, {"oid": "57a35d9264de48ba2133271a3d8fa84ea76f4080", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/57a35d9264de48ba2133271a3d8fa84ea76f4080", "message": "Merge branch 'master' into s3-cred-fallback", "committedDate": "2020-09-08T23:44:47Z", "type": "commit"}]}