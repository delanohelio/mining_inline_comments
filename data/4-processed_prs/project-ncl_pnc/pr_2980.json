{"pr_number": 2980, "pr_title": "[NCL-5634] Propose new ALIGNMENT_PARAMETERS after build type edit", "pr_createdAt": "2020-04-16T15:05:34Z", "pr_url": "https://github.com/project-ncl/pnc/pull/2980", "timeline": [{"oid": "d4f0ed8b6093a385ca994398305819d623e70093", "url": "https://github.com/project-ncl/pnc/commit/d4f0ed8b6093a385ca994398305819d623e70093", "message": "[NCL-5634] Propose new ALIGNMENT_PARAMETERS after build type edit", "committedDate": "2020-04-20T08:48:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkzMjgwMw==", "url": "https://github.com/project-ncl/pnc/pull/2980#discussion_r412932803", "bodyText": "please change alert-danger to alert-warning", "author": "matedo1", "createdAt": "2020-04-22T12:21:40Z", "path": "ui/app/build-configs/directives/pnc-select-build-parameters/pnc-display-build-parameters.html", "diffHunk": "@@ -30,7 +30,22 @@\n \n     <!-- Detail Mode -->\n     <div ng-hide=\"$ctrl.isEditOn(key)\">\n-      <pre>{{ value }}</pre>\n+\n+      <div ng-hide=\"$ctrl.isAlignmentAndBuildTypeChanged(key)\">\n+        <pre>{{ value }}</pre>\n+      </div>\n+\n+      <div ng-show=\"$ctrl.isAlignmentAndBuildTypeChanged(key)\">\n+        <label>Original parameters:</label>\n+        <pre class=\"alert-danger\">{{ value }}</pre>", "originalCommit": "d4f0ed8b6093a385ca994398305819d623e70093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkzNDQ1NQ==", "url": "https://github.com/project-ncl/pnc/pull/2980#discussion_r412934455", "bodyText": "I guess <p> is not needed and should be removed, except that it cannot contain block-level elements like div", "author": "matedo1", "createdAt": "2020-04-22T12:24:05Z", "path": "ui/app/build-configs/directives/pnc-select-build-parameters/pnc-display-build-parameters.html", "diffHunk": "@@ -30,7 +30,22 @@\n \n     <!-- Detail Mode -->\n     <div ng-hide=\"$ctrl.isEditOn(key)\">\n-      <pre>{{ value }}</pre>\n+\n+      <div ng-hide=\"$ctrl.isAlignmentAndBuildTypeChanged(key)\">\n+        <pre>{{ value }}</pre>\n+      </div>\n+\n+      <div ng-show=\"$ctrl.isAlignmentAndBuildTypeChanged(key)\">\n+        <label>Original parameters:</label>\n+        <pre class=\"alert-danger\">{{ value }}</pre>\n+        <label>New parameters should be applied when Build Type is changed:</label>\n+        <pre ng-bind=\"$ctrl.newAlignmentParameters\" class=\"alert-success\"></pre>\n+        <p>", "originalCommit": "d4f0ed8b6093a385ca994398305819d623e70093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkzNTA5NA==", "url": "https://github.com/project-ncl/pnc/pull/2980#discussion_r412935094", "bodyText": "if (!$ctrl.isEditForm){ is enough", "author": "matedo1", "createdAt": "2020-04-22T12:25:04Z", "path": "ui/app/build-configs/directives/pnc-select-build-parameters/pncDisplayBuildParameters.js", "diffHunk": "@@ -44,10 +51,39 @@\n       $ctrl.currentParams = angular.copy($ctrl.params);\n     }\n \n+    function setNewParams(parameters){\n+      $ctrl.newAlignmentParameters = parameters;\n+      if ($ctrl.isEditForm === false){", "originalCommit": "d4f0ed8b6093a385ca994398305819d623e70093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk0MTQ1OQ==", "url": "https://github.com/project-ncl/pnc/pull/2980#discussion_r412941459", "bodyText": "change help-block, text-danger to text-warning p-t-10 p-b-10 , anyway comma , is not valid", "author": "matedo1", "createdAt": "2020-04-22T12:34:19Z", "path": "ui/app/build-configs/directives/pnc-create-build-config-general-form/pnc-create-build-config-general-form.html", "diffHunk": "@@ -42,6 +42,7 @@\n     <br>\n     <select name=\"buildType\" pf-bootstrap-select=\"{ noneSelectedText: 'Select Build Type' }\" ng-model=\"$ctrl.data.buildType\" id=\"build-config-build-type\" ng-options=\"buildType.id as buildType.name for buildType in $ctrl.buildTypes\" required></select>\n     <p ng-show=\"form.buildType.$invalid && form.buildType.$touched\" class=\"help-block\">Build Type is a required field.</p>\n+    <p ng-show=\"form.buildType.$dirty && $ctrl.isEditForm\" class=\"help-block, text-danger\">ALIGNMENT_PARAMETERS should be updated when the Build Type is changed, see Build Parameters section below</p>", "originalCommit": "d4f0ed8b6093a385ca994398305819d623e70093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk0NjgxNg==", "url": "https://github.com/project-ncl/pnc/pull/2980#discussion_r412946816", "bodyText": "show this message (including the hr line below) even if parameters are just removed", "author": "matedo1", "createdAt": "2020-04-22T12:41:47Z", "path": "ui/app/build-configs/directives/pnc-select-build-parameters/pnc-select-build-parameters.html", "diffHunk": "@@ -23,7 +23,8 @@\n   </div>\n   <hr ng-if=\"$ctrl.hasParams()\">\n   <div>\n-    <pnc-display-build-parameters params=\"$ctrl.params\" on-edit=\"$ctrl.addParam(key, value)\" on-remove=\"$ctrl.removeParam(key)\">\n+    <pnc-display-build-parameters is-edit-form=\"$ctrl.isEditForm\" build-type=\"$ctrl.buildType\" params=\"$ctrl.params\" on-edit=\"$ctrl.addParam(key, value)\" on-remove=\"$ctrl.removeParam(key)\">\n     </pnc-display-build-parameters>\n   </div>\n+  <p ng-show=\"$ctrl.paramsUpdated && $ctrl.isEditForm\" class=\"help-block\">New parameters need to be saved down below</p>", "originalCommit": "d4f0ed8b6093a385ca994398305819d623e70093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk1NDE3MA==", "url": "https://github.com/project-ncl/pnc/pull/2980#discussion_r412954170", "bodyText": "error state (see catch()) needs to be handled, the current solution is proposing wrong New parameters value (it's proposing value for the original Build Type instead of the new Build Type) when the request in not finished properly and user is not aware of it", "author": "matedo1", "createdAt": "2020-04-22T12:51:51Z", "path": "ui/app/build-configs/directives/pnc-select-build-parameters/pncDisplayBuildParameters.js", "diffHunk": "@@ -44,10 +51,39 @@\n       $ctrl.currentParams = angular.copy($ctrl.params);\n     }\n \n+    function setNewParams(parameters){\n+      $ctrl.newAlignmentParameters = parameters;\n+      if ($ctrl.isEditForm === false){\n+        // Build configuration is being created so apply new parameters immediately\n+        $ctrl.applyNewParameters();\n+      }\n+    }\n+\n     $ctrl.$onInit = function(){\n       $scope.$watchCollection('$ctrl.params', function () {\n         copyParams();\n       });\n+\n+      $scope.$watch('$ctrl.buildType', function (newBuildType) {\n+        if (newBuildType){\n+          BuildConfigResource.getAlignmentParameters(newBuildType).then(function (params){", "originalCommit": "d4f0ed8b6093a385ca994398305819d623e70093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cf5160a2e75a116c06d0a0dac19f2622b19a3c3f", "url": "https://github.com/project-ncl/pnc/commit/cf5160a2e75a116c06d0a0dac19f2622b19a3c3f", "message": "[NCL-5634] Add warning when alignment params request fails", "committedDate": "2020-04-23T11:36:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjQxNDEzMw==", "url": "https://github.com/project-ncl/pnc/pull/2980#discussion_r416414133", "bodyText": "When Build Type is changed and then changed back to the original value, this message should be removed (Build Parameters section has correct behaviour)", "author": "matedo1", "createdAt": "2020-04-28T08:06:35Z", "path": "ui/app/build-configs/directives/pnc-create-build-config-general-form/pnc-create-build-config-general-form.html", "diffHunk": "@@ -42,6 +42,7 @@\n     <br>\n     <select name=\"buildType\" pf-bootstrap-select=\"{ noneSelectedText: 'Select Build Type' }\" ng-model=\"$ctrl.data.buildType\" id=\"build-config-build-type\" ng-options=\"buildType.id as buildType.name for buildType in $ctrl.buildTypes\" required></select>\n     <p ng-show=\"form.buildType.$invalid && form.buildType.$touched\" class=\"help-block\">Build Type is a required field.</p>\n+    <p ng-show=\"form.buildType.$dirty && $ctrl.isEditForm\" class=\"text-warning p-t-10 p-b-10\">ALIGNMENT_PARAMETERS should be updated when the Build Type is changed, see Build Parameters section below</p>", "originalCommit": "cf5160a2e75a116c06d0a0dac19f2622b19a3c3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "255a44a6cdf78fb98f4825b6b3ec04af10c3b362", "url": "https://github.com/project-ncl/pnc/commit/255a44a6cdf78fb98f4825b6b3ec04af10c3b362", "message": "[NCL-5634] Propose new ALIGNMENT_PARAMETERS after build type edit", "committedDate": "2020-04-29T10:07:02Z", "type": "commit"}, {"oid": "abc7391b63327c83bfdd5865aca0b092b88ffdd5", "url": "https://github.com/project-ncl/pnc/commit/abc7391b63327c83bfdd5865aca0b092b88ffdd5", "message": "[NCL-5634] Add warning when alignment params request fails", "committedDate": "2020-04-29T10:07:02Z", "type": "commit"}, {"oid": "263aed388eecb294b54853e00ab7f80738ed67c2", "url": "https://github.com/project-ncl/pnc/commit/263aed388eecb294b54853e00ab7f80738ed67c2", "message": "[NCL-5634] Parameters proposed even if not present", "committedDate": "2020-04-29T10:07:02Z", "type": "commit"}, {"oid": "263aed388eecb294b54853e00ab7f80738ed67c2", "url": "https://github.com/project-ncl/pnc/commit/263aed388eecb294b54853e00ab7f80738ed67c2", "message": "[NCL-5634] Parameters proposed even if not present", "committedDate": "2020-04-29T10:07:02Z", "type": "forcePushed"}]}