{"pr_number": 5814, "pr_title": "Offer a table based on kind of alert", "pr_createdAt": "2020-01-21T11:57:38Z", "pr_url": "https://github.com/zaproxy/zaproxy/pull/5814", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE2NDQ0OA==", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r369164448", "bodyText": "This (and following line) can be added before the loop (if there are no rows it's rendered as an empty table).", "author": "thc202", "createdAt": "2020-01-21T18:19:47Z", "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.md.xsl", "diffHunk": "@@ -24,6 +24,17 @@\n | Low | <xsl:value-of select=\"count(descendant::alertitem[riskcode='1'])\"/> |\n | Informational | <xsl:value-of select=\"count(descendant::alertitem[riskcode='0'])\"/> |\n \n+## Alerts\n+\n+<xsl:for-each select=\"descendant::alertitem\">\n+  <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+  <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>\n+  <xsl:sort order=\"ascending\" data-type=\"text\" select=\"name\"/>\n+  <xsl:if test=\"position()=1\">\n+| Name | Number of Alerts |", "originalCommit": "f29587fbcee7352468abe9b7aba27c2a09220e67", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM4MzYwOA==", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r369383608", "bodyText": "Okay, I'll do that.", "author": "ricekot", "createdAt": "2020-01-22T06:06:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE2NDQ0OA=="}], "type": "inlineReview"}, {"oid": "2709754060c26356b5c02fa009a3be0ed92d1415", "url": "https://github.com/zaproxy/zaproxy/commit/2709754060c26356b5c02fa009a3be0ed92d1415", "message": "Rename \"Kinds of Alerts\" to \"Alerts\"\n\nRename \"Kinds of Alerts\" to \"Alerts\" and \"Kind\" to\n\"Name\".\n\nSigned-off-by: akshathkothari <akshath.kothari@gmail.com>", "committedDate": "2020-01-23T15:18:28Z", "type": "forcePushed"}, {"oid": "07567052ef427f04fc15e0c6dff677ef93190c43", "url": "https://github.com/zaproxy/zaproxy/commit/07567052ef427f04fc15e0c6dff677ef93190c43", "message": "Rename \"Kinds of Alerts\" to \"Alerts\"\n\nRename \"Kinds of Alerts\" to \"Alerts\" and \"Kind\" to\n\"Name\".\n\nSigned-off-by: akshathkothari <akshath.kothari@gmail.com>", "committedDate": "2020-01-23T15:46:59Z", "type": "forcePushed"}, {"oid": "52be3a60befbd61f21cd267d86be2495a8595e06", "url": "https://github.com/zaproxy/zaproxy/commit/52be3a60befbd61f21cd267d86be2495a8595e06", "message": "Offer a table in reports based on kind of alert\n\nIn addition to 'Summary of Alerts', also provide\nan 'Alerts' table in HTML and markdown reports.\nSee zaproxy/zaproxy#5732.\n\nSigned-off-by: akshathkothari <akshath.kothari@gmail.com>", "committedDate": "2020-01-23T16:42:53Z", "type": "forcePushed"}, {"oid": "6e620c4ff48c5516efa89d398d6a30201f7ed4d2", "url": "https://github.com/zaproxy/zaproxy/commit/6e620c4ff48c5516efa89d398d6a30201f7ed4d2", "message": "Offer a table in reports based on kind of alert\n\nIn addition to 'Summary of Alerts', also provide\nan 'Alerts' table in HTML and markdown reports.\nSee zaproxy/zaproxy#5732.\n\nSigned-off-by: akshathkothari <akshath.kothari@gmail.com>", "committedDate": "2020-01-24T06:02:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAwNzU2Ng==", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r371007566", "bodyText": "Could use choose to avoid repeating the (negated) condition\nI'd suggest \"name\" (or \"type\") instead of \"kind\".", "author": "thc202", "createdAt": "2020-01-26T15:27:08Z", "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "diffHunk": "@@ -119,6 +122,42 @@ ZAP Scanning Report\n   </tr>\n </table>\n <div class=\"spacer-lg\"></div>\n+\n+<h3>Alerts</h3>\n+<table width=\"75%\" class=\"alerts\">\n+  <tr bgcolor=\"#666666\"> \n+    <th width=\"60%\" height=\"24\">Name</th>\n+    <th width=\"20%\" align=\"center\">Risk (Confidence)</th>\n+    <th width=\"20%\" align=\"center\">Number of Instances</th>\n+  </tr>\n+  <xsl:key name=\"alerts-by-name-risk\" match=\"alertitem\" use=\"concat(name, ' ', riskdesc)\"/>\n+  <xsl:for-each select=\"descendant::alertitem[count(. | key('alerts-by-name-risk', concat(name, ' ', riskdesc))[1]) = 1]\">\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>\n+    <xsl:sort order=\"ascending\" data-type=\"text\" select=\"name\"/>\n+    <tr bgcolor=\"#e8e8e8\"> \n+      <td>\n+        <xsl:value-of select=\"name\"/>\n+      </td>\n+      <td align=\"center\">\n+        <xsl:value-of select=\"riskdesc\"/>\n+      </td>\n+      <td align=\"center\">\n+        <xsl:variable name=\"alerts-of-a-kind\" select=\"key('alerts-by-name-risk', concat(name, ' ', riskdesc))\"/>\n+        <!-- Add <count>s when merge is on -->\n+        <xsl:if test=\"$alerts-of-a-kind/count\">", "originalCommit": "6e620c4ff48c5516efa89d398d6a30201f7ed4d2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "896ecb05230b60a8bdfc9fbaf781e233412cff9a", "url": "https://github.com/zaproxy/zaproxy/commit/896ecb05230b60a8bdfc9fbaf781e233412cff9a", "message": "Offer a table in reports based on kind of alert\n\nIn addition to 'Summary of Alerts', also provide\nan 'Alerts' table in HTML and markdown reports.\nSee zaproxy/zaproxy#5732.\n\nSigned-off-by: akshathkothari <akshath.kothari@gmail.com>", "committedDate": "2020-01-26T19:23:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQ4MzMyNA==", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r373483324", "bodyText": "I'd suggest removing this since the confidence is no longer shown (otherwise it's not obvious what the order is).", "author": "thc202", "createdAt": "2020-01-31T13:40:49Z", "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "diffHunk": "@@ -119,6 +122,44 @@ ZAP Scanning Report\n   </tr>\n </table>\n <div class=\"spacer-lg\"></div>\n+\n+<h3>Alerts</h3>\n+<table width=\"75%\" class=\"alerts\">\n+  <tr bgcolor=\"#666666\"> \n+    <th width=\"60%\" height=\"24\">Name</th>\n+    <th width=\"20%\" align=\"center\">Risk Level</th>\n+    <th width=\"20%\" align=\"center\">Number of Instances</th>\n+  </tr>\n+  <xsl:key name=\"alerts-by-name-risk\" match=\"alertitem\" use=\"concat(name, ' ', riskcode)\"/>\n+  <xsl:for-each select=\"descendant::alertitem[count(. | key('alerts-by-name-risk', concat(name, ' ', riskcode))[1]) = 1]\">\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>", "originalCommit": "896ecb05230b60a8bdfc9fbaf781e233412cff9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUxNDUyMg==", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r373514522", "bodyText": "Okay, I'll do that.", "author": "ricekot", "createdAt": "2020-01-31T14:44:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzQ4MzMyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUzMjU4MQ==", "url": "https://github.com/zaproxy/zaproxy/pull/5814#discussion_r373532581", "bodyText": "Re: @thc202's followup comment the issue does actually mention:\n\nIt would certainly be useful if the alerts were sorted by kind (currently, I'm not sure what their sort order is).\n\nWe discussed this via IRC and believe that risk-name-confidence is likely best.", "author": "kingthorin", "createdAt": "2020-01-31T15:18:26Z", "path": "zap/src/main/resources/org/zaproxy/zap/resources/xml/report.html.xsl", "diffHunk": "@@ -119,6 +122,44 @@ ZAP Scanning Report\n   </tr>\n </table>\n <div class=\"spacer-lg\"></div>\n+\n+<h3>Alerts</h3>\n+<table width=\"75%\" class=\"alerts\">\n+  <tr bgcolor=\"#666666\"> \n+    <th width=\"60%\" height=\"24\">Name</th>\n+    <th width=\"20%\" align=\"center\">Risk Level</th>\n+    <th width=\"20%\" align=\"center\">Number of Instances</th>\n+  </tr>\n+  <xsl:key name=\"alerts-by-name-risk\" match=\"alertitem\" use=\"concat(name, ' ', riskcode)\"/>\n+  <xsl:for-each select=\"descendant::alertitem[count(. | key('alerts-by-name-risk', concat(name, ' ', riskcode))[1]) = 1]\">\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"riskcode\"/>\n+    <xsl:sort order=\"descending\" data-type=\"number\" select=\"confidence\"/>\n+    <xsl:sort order=\"ascending\" data-type=\"text\" select=\"name\"/>\n+    <tr bgcolor=\"#e8e8e8\"> \n+      <td>\n+        <xsl:value-of select=\"name\"/>\n+      </td>\n+      <td align=\"center\">\n+        <xsl:value-of select=\"substring-before(riskdesc, ' ')\"/>\n+      </td>\n+      <td align=\"center\">\n+        <xsl:variable name=\"same-name-alerts\" select=\"key('alerts-by-name-risk', concat(name, ' ', riskcode))\"/>\n+        <xsl:choose>\n+          <!-- Add <count>s when merge is on -->\n+          <xsl:when test=\"$same-name-alerts/count\">\n+            <xsl:value-of select=\"sum($same-name-alerts/count)\"/>\n+          </xsl:when>\n+          <!-- Count alerts when merge is off -->\n+          <xsl:otherwise>\n+            <xsl:value-of select=\"count($same-name-alerts)\"/>\n+          </xsl:otherwise>\n+        </xsl:choose>\n+      </td>\n+    </tr>\n+  </xsl:for-each>\n+</table>\n+<div class=\"spacer-lg\"></div>\n+\n <h3>Alert Detail</h3>\n \n <xsl:apply-templates select=\"descendant::alertitem\">", "originalCommit": "896ecb05230b60a8bdfc9fbaf781e233412cff9a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6a51ae4721b332ed7ef69011c631c152e9fa7605", "url": "https://github.com/zaproxy/zaproxy/commit/6a51ae4721b332ed7ef69011c631c152e9fa7605", "message": "Offer a table in reports based on kind of alert\n\nIn addition to 'Summary of Alerts', also provide\nan 'Alerts' table in HTML and markdown reports.\nAlso, minor sort 'Alert Details' by name of Alert.\nCloses zaproxy/zaproxy#5732.\n\nSigned-off-by: Akshath Kothari <akshath.kothari@gmail.com>", "committedDate": "2020-01-31T15:23:01Z", "type": "forcePushed"}, {"oid": "f53c3d78b692279b825d88c2bf0847144442f4c3", "url": "https://github.com/zaproxy/zaproxy/commit/f53c3d78b692279b825d88c2bf0847144442f4c3", "message": "Offer a table in reports based on kind of alert\n\nIn addition to 'Summary of Alerts', also provide\nan 'Alerts' table in HTML and markdown reports.\nAlso, sort 'Alert Details' as risk-name-confidence.\nCloses zaproxy/zaproxy#5732.\n\nSigned-off-by: Akshath Kothari <akshath.kothari@gmail.com>", "committedDate": "2020-01-31T15:34:28Z", "type": "commit"}, {"oid": "f53c3d78b692279b825d88c2bf0847144442f4c3", "url": "https://github.com/zaproxy/zaproxy/commit/f53c3d78b692279b825d88c2bf0847144442f4c3", "message": "Offer a table in reports based on kind of alert\n\nIn addition to 'Summary of Alerts', also provide\nan 'Alerts' table in HTML and markdown reports.\nAlso, sort 'Alert Details' as risk-name-confidence.\nCloses zaproxy/zaproxy#5732.\n\nSigned-off-by: Akshath Kothari <akshath.kothari@gmail.com>", "committedDate": "2020-01-31T15:34:28Z", "type": "forcePushed"}]}