{"pr_number": 6108, "pr_title": "Add `IS_CONTAINERIZED` env var to containerized check", "pr_createdAt": "2020-08-03T16:31:40Z", "pr_url": "https://github.com/zaproxy/zaproxy/pull/6108", "timeline": [{"oid": "50e8143491e3860ce906923913752ffdfe2bdd24", "url": "https://github.com/zaproxy/zaproxy/commit/50e8143491e3860ce906923913752ffdfe2bdd24", "message": "Add `IS_CONTAINERIZED` env var to containerized check\n\nThis should allow the container to function correctly in all\ncontainer runtimes, as it is not bound to a specifc\nimplementation\n\nSigned-off-by: Jannik Hollenbach <13718901+J12934@users.noreply.github.com>", "committedDate": "2020-08-03T16:32:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU3Nzg4NQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6108#discussion_r464577885", "bodyText": "This image does not use the Python scripts, does no harm either.", "author": "thc202", "createdAt": "2020-08-03T18:06:28Z", "path": "docker/Dockerfile-bare", "diffHunk": "@@ -33,5 +33,6 @@ ENV PATH $JAVA_HOME/bin:/zap/:$PATH\n ENV ZAP_PATH /zap/zap.sh\n ENV HOME /home/zap/\n ENV ZAP_PORT 8080\n+ENV IS_CONTAINERIZED true", "originalCommit": "50e8143491e3860ce906923913752ffdfe2bdd24", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDkxMjU4Nw==", "url": "https://github.com/zaproxy/zaproxy/pull/6108#discussion_r464912587", "bodyText": "Ah right, good catch \ud83d\udc4d", "author": "J12934", "createdAt": "2020-08-04T09:12:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU3Nzg4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU4NTMwMg==", "url": "https://github.com/zaproxy/zaproxy/pull/6108#discussion_r464585302", "bodyText": "Should this actually check the value? Can anyone foresee a scenario where someone might purposefully set it to false or some value other than true?", "author": "kingthorin", "createdAt": "2020-08-03T18:21:04Z", "path": "docker/zap_common.py", "diffHunk": "@@ -244,7 +244,7 @@ def cp_to_docker(cid, file, dir):\n \n \n def running_in_docker():\n-    return os.path.exists('/.dockerenv') or os.path.exists('/run/.containerenv')\n+    return os.path.exists('/.dockerenv') or os.path.exists('/run/.containerenv') or os.environ.get(\"IS_CONTAINERIZED\") is not None", "originalCommit": "50e8143491e3860ce906923913752ffdfe2bdd24", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDkxNDcwNg==", "url": "https://github.com/zaproxy/zaproxy/pull/6108#discussion_r464914706", "bodyText": "Good point. I've added an actual check on the value. Just to be sure that its always used consistently.\nAt the moment there is no real use to setting it to false as it would be overwritten by the path checks. Might be possible to extend this in the future when needed.", "author": "J12934", "createdAt": "2020-08-04T09:15:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU4NTMwMg=="}], "type": "inlineReview"}, {"oid": "8a79b9999ecd9d3fbc6dc35f9c35f033b5860e4d", "url": "https://github.com/zaproxy/zaproxy/commit/8a79b9999ecd9d3fbc6dc35f9c35f033b5860e4d", "message": "Add `IS_CONTAINERIZED` env var to containerized check\n\nThis should allow the container to function correctly in all\ncontainer runtimes, as it is not bound to a specifc\nimplementation\n\nSigned-off-by: Jannik Hollenbach <13718901+J12934@users.noreply.github.com>", "committedDate": "2020-08-04T09:11:18Z", "type": "commit"}, {"oid": "001eb9daaf4ee853dcc1b5222cf0700387c30ab4", "url": "https://github.com/zaproxy/zaproxy/commit/001eb9daaf4ee853dcc1b5222cf0700387c30ab4", "message": "Ensure that IS_CONTAINERIZED is actually set to true", "committedDate": "2020-08-04T09:11:52Z", "type": "forcePushed"}, {"oid": "d69abfb13beaeb6118fdead43d3bb601969bacf8", "url": "https://github.com/zaproxy/zaproxy/commit/d69abfb13beaeb6118fdead43d3bb601969bacf8", "message": "Ensure that IS_CONTAINERIZED is actually set to true\n\nSigned-off-by: Jannik Hollenbach <13718901+J12934@users.noreply.github.com>", "committedDate": "2020-08-04T09:12:37Z", "type": "commit"}, {"oid": "d69abfb13beaeb6118fdead43d3bb601969bacf8", "url": "https://github.com/zaproxy/zaproxy/commit/d69abfb13beaeb6118fdead43d3bb601969bacf8", "message": "Ensure that IS_CONTAINERIZED is actually set to true\n\nSigned-off-by: Jannik Hollenbach <13718901+J12934@users.noreply.github.com>", "committedDate": "2020-08-04T09:12:37Z", "type": "forcePushed"}]}