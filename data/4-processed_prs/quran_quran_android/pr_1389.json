{"pr_number": 1389, "pr_title": "Initial handling of local data", "pr_createdAt": "2020-06-27T21:01:47Z", "pr_url": "https://github.com/quran/quran_android/pull/1389", "timeline": [{"oid": "048a5be392e568b76ea2fcc5a26743167adbdeeb", "url": "https://github.com/quran/quran_android/commit/048a5be392e568b76ea2fcc5a26743167adbdeeb", "message": "Initial handling of local data\n\nFor warsh, the plan is to replace the set of images with an updated set.\nTo make life easier, the plan is to bundle these with the apk. This\npatch allows for copying bundled data for sets that support it instead\nof downloading that data from a server.", "committedDate": "2020-06-27T21:00:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU2NzA3OA==", "url": "https://github.com/quran/quran_android/pull/1389#discussion_r446567078", "bodyText": "CopyDatabaseUtil has similar code but will be removed in a future PR in sha' Allah since it's not used at the present.", "author": "ahmedre", "createdAt": "2020-06-27T21:02:24Z", "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranFileUtils.kt", "diffHunk": "@@ -195,6 +220,25 @@ class QuranFileUtils @Inject constructor(\n         makeDirectory(getQuranAyahDatabaseDirectory(context))\n   }\n \n+  @WorkerThread\n+  fun copyFromAssets(assetsFileName: String, filename: String, destination: String) {\n+    val assets = appContext.assets\n+    assets.open(assetsFileName)\n+        .source()\n+        .use { source ->\n+          File(destination, filename).sink()\n+              .buffer()\n+              .use { destination -> destination.writeAll(source) }\n+        }\n+\n+    if (filename.endsWith(\".zip\")) {\n+      val zipFile = destination + File.separator + filename\n+      ZipUtils.unzipFile(zipFile, destination, filename, null)\n+      // delete the zip file, since there's no need to have it twice\n+      File(zipFile).delete()\n+    }\n+  }\n+", "originalCommit": "048a5be392e568b76ea2fcc5a26743167adbdeeb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}