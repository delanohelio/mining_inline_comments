{"pr_number": 1425, "pr_title": "Add confirm dialog before removing audio in audio manager", "pr_createdAt": "2020-08-29T04:30:21Z", "pr_url": "https://github.com/quran/quran_android/pull/1425", "timeline": [{"oid": "4079951da1962cbd38b0566ef830b609c721e6eb", "url": "https://github.com/quran/quran_android/commit/4079951da1962cbd38b0566ef830b609c721e6eb", "message": "Add confirm dialog before removing audio in audio manager", "committedDate": "2020-08-29T04:14:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTcwNDA1MA==", "url": "https://github.com/quran/quran_android/pull/1425#discussion_r479704050", "bodyText": "jazakumAllah khairan - one minor comment - save a reference to the dialog (nullable) and dismiss it onDestroy if it's not null to prevent leaks", "author": "ahmedre", "createdAt": "2020-08-30T00:26:54Z", "path": "app/src/main/java/com/quran/labs/androidquran/ui/SheikhAudioManagerActivity.kt", "diffHunk": "@@ -243,8 +244,18 @@ class SheikhAudioManagerActivity : QuranActionBarActivity(), SimpleDownloadListe\n             val surah = position + 1\n             val downloaded = info.downloadedSuras[surah]\n             if (downloaded) {\n-              // TODO: show a confirmation dialog before deleting\n-              deleteSelection(ArrayList(listOf(surah)))\n+              var surahName = quranDisplayData.getSuraName(this, surah, true)\n+              val msg = String.format(getString(R.string.audio_manager_remove_audio_msg), surahName)\n+              val builder = AlertDialog.Builder(this)\n+              builder.setTitle(R.string.audio_manager_remove_audio_title)\n+                  .setMessage(msg)\n+                  .setPositiveButton(R.string.remove_button\n+                  ) { _, _ ->\n+                    deleteSelection(ArrayList(listOf(surah)))\n+                  }\n+                  .setNegativeButton(R.string.cancel\n+                  ) { dialog, _ -> dialog.dismiss() }\n+              builder.show()", "originalCommit": "4079951da1962cbd38b0566ef830b609c721e6eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0c007df740ef62cff16ded3023b6317b1d47e6f7", "url": "https://github.com/quran/quran_android/commit/0c007df740ef62cff16ded3023b6317b1d47e6f7", "message": "Making sure the dialog is dismissed to avoid leaks", "committedDate": "2020-08-30T18:03:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIxNDE3Mg==", "url": "https://github.com/quran/quran_android/pull/1425#discussion_r485214172", "bodyText": "jazakumAllah khairan - don't need the null check since the ? is a null check", "author": "ahmedre", "createdAt": "2020-09-08T21:46:31Z", "path": "app/src/main/java/com/quran/labs/androidquran/ui/SheikhAudioManagerActivity.kt", "diffHunk": "@@ -135,6 +137,9 @@ class SheikhAudioManagerActivity : QuranActionBarActivity(), SimpleDownloadListe\n \n   override fun onDestroy() {\n     compositeDisposable.clear()\n+    if (dialogConfirm != null) {", "originalCommit": "0c007df740ef62cff16ded3023b6317b1d47e6f7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}