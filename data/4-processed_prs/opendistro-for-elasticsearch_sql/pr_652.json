{"pr_number": 652, "pr_title": "ODBC: Use literals instead of parameters in Power BI data connector", "pr_createdAt": "2020-07-31T20:09:17Z", "pr_url": "https://github.com/opendistro-for-elasticsearch/sql/pull/652", "timeline": [{"oid": "427bd79a138bc13f53e071c8485d8726aa19d1dd", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/427bd79a138bc13f53e071c8485d8726aa19d1dd", "message": "pbi connector", "committedDate": "2020-07-19T04:01:17Z", "type": "commit"}, {"oid": "401a05360a74b165b372f274e1c01b61a5c06ebd", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/401a05360a74b165b372f274e1c01b61a5c06ebd", "message": "update names", "committedDate": "2020-07-19T04:21:22Z", "type": "commit"}, {"oid": "11856cdce473256a3048d967b447b43197181604", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/11856cdce473256a3048d967b447b43197181604", "message": "- add mez file\n- add docs", "committedDate": "2020-07-20T02:42:45Z", "type": "commit"}, {"oid": "e6932698c592fdc2d74d9d92e9a044bc01b979f6", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/e6932698c592fdc2d74d9d92e9a044bc01b979f6", "message": "nit", "committedDate": "2020-07-20T02:46:49Z", "type": "commit"}, {"oid": "4158974559d9fc35e6ea0a610aaf0063ad0397fe", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/4158974559d9fc35e6ea0a610aaf0063ad0397fe", "message": "nit", "committedDate": "2020-07-20T02:49:26Z", "type": "commit"}, {"oid": "586793f0d70894c6042fd9177e83c88f24cf4164", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/586793f0d70894c6042fd9177e83c88f24cf4164", "message": "image resize", "committedDate": "2020-07-20T03:13:33Z", "type": "commit"}, {"oid": "9cb48a4fffa2aa88b59917da2961cba7e4849580", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/9cb48a4fffa2aa88b59917da2961cba7e4849580", "message": "resize image", "committedDate": "2020-07-20T03:17:21Z", "type": "commit"}, {"oid": "c234b8829b0f5b1864bfe500f2b9053c79c7b12d", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/c234b8829b0f5b1864bfe500f2b9053c79c7b12d", "message": "remove extra lines", "committedDate": "2020-07-20T03:32:00Z", "type": "commit"}, {"oid": "0d0c0509eea739936f4ee4b81307d0566cb39dad", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/0d0c0509eea739936f4ee4b81307d0566cb39dad", "message": "nit", "committedDate": "2020-07-20T03:45:54Z", "type": "commit"}, {"oid": "50d4ccf583d527b263bd8465d29b80f32a9f0a62", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/50d4ccf583d527b263bd8465d29b80f32a9f0a62", "message": "update mez file", "committedDate": "2020-07-20T03:46:55Z", "type": "commit"}, {"oid": "023fb674a86c080f802c32fcd46f11c5bfeadba8", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/023fb674a86c080f802c32fcd46f11c5bfeadba8", "message": "rename connector", "committedDate": "2020-07-21T17:39:34Z", "type": "commit"}, {"oid": "0b857c003716461562dbce6fa10df6090eeaad3d", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/0b857c003716461562dbce6fa10df6090eeaad3d", "message": "rename mez file", "committedDate": "2020-07-21T17:40:37Z", "type": "commit"}, {"oid": "06ae48656b35034cd62dd826569b08c9b075a3d9", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/06ae48656b35034cd62dd826569b08c9b075a3d9", "message": "- add basic & aws auth\n- add unit test\n- add errors\n- enable direct query", "committedDate": "2020-07-23T03:04:10Z", "type": "commit"}, {"oid": "b2ff22274877393d4777bff958616d371ec1de32", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/b2ff22274877393d4777bff958616d371ec1de32", "message": "Merge branch 'develop' of https://github.com/rupal-bq/sql into feature/odbc/pbi\n\n# Conflicts:\n#\tsql-odbc/.gitignore\n#\tsql-odbc/src/PowerBIConnector/OdfeSqlOdbcPBIConnector.mproj\n#\tsql-odbc/src/PowerBIConnector/OdfeSqlOdbcPBIConnector.pq\n#\tsql-odbc/src/PowerBIConnector/OdfeSqlOdbcPBIConnector.query.pq\n#\tsql-odbc/src/PowerBIConnector/bin/Release/OdfeSqlOdbcPBIConnector.mez", "committedDate": "2020-07-23T03:19:22Z", "type": "commit"}, {"oid": "3f6ff5d99d07e525874fde3a9ab6987dbe5bfadf", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/3f6ff5d99d07e525874fde3a9ab6987dbe5bfadf", "message": "add connector", "committedDate": "2020-07-23T03:21:15Z", "type": "commit"}, {"oid": "ad73d915d13dce97ea855154d9428e67b09368a9", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/ad73d915d13dce97ea855154d9428e67b09368a9", "message": "update doc", "committedDate": "2020-07-23T03:41:43Z", "type": "commit"}, {"oid": "91d5cbebad32016daa6445db98ad0fc938a0be65", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/91d5cbebad32016daa6445db98ad0fc938a0be65", "message": "add ssl for auth", "committedDate": "2020-07-23T03:59:03Z", "type": "commit"}, {"oid": "ddc725bd3cfd70d3501ae325871eaab73b669fd3", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/ddc725bd3cfd70d3501ae325871eaab73b669fd3", "message": "update docs for errors", "committedDate": "2020-07-23T16:25:05Z", "type": "commit"}, {"oid": "b9463517addc5113cbc8bfc60ca7069b6a9e4b83", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/b9463517addc5113cbc8bfc60ca7069b6a9e4b83", "message": "Merge branch 'develop' of https://github.com/rupal-bq/sql into feature/odbc/pbi", "committedDate": "2020-07-23T20:07:00Z", "type": "commit"}, {"oid": "2bd944c759017fb4c6666d08eae676d1e3a988ea", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/2bd944c759017fb4c6666d08eae676d1e3a988ea", "message": "- remove sqlgetinfo & sqlcapabilities values from connector", "committedDate": "2020-07-24T20:09:56Z", "type": "commit"}, {"oid": "ed0afb91caaf7daa2e14c71f9ed8ee636969932b", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/ed0afb91caaf7daa2e14c71f9ed8ee636969932b", "message": "adding EncryptedConnectionString", "committedDate": "2020-07-24T21:20:35Z", "type": "commit"}, {"oid": "22dc963da1d58323df93640564c37102816d4aa6", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/22dc963da1d58323df93640564c37102816d4aa6", "message": "Merge branch 'develop' of https://github.com/rupal-bq/sql into feature/odbc/pbi", "committedDate": "2020-07-28T04:49:07Z", "type": "commit"}, {"oid": "82e9a728bfbb17876121a65e4c46d0018c4d8bc1", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/82e9a728bfbb17876121a65e4c46d0018c4d8bc1", "message": "add data type for columns", "committedDate": "2020-07-28T17:45:59Z", "type": "commit"}, {"oid": "5022f1f01577b4d31fe2a8b57c4a4f06e571feb0", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/5022f1f01577b4d31fe2a8b57c4a4f06e571feb0", "message": "add alternate column size", "committedDate": "2020-07-28T19:36:07Z", "type": "commit"}, {"oid": "f4c706876421ea82de028bf88e79ea42411e996e", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/f4c706876421ea82de028bf88e79ea42411e996e", "message": "reverting changes in catalog test", "committedDate": "2020-07-28T19:40:56Z", "type": "commit"}, {"oid": "a76c382c3ead0ef192ed15ba8c37bb32acd0e843", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/a76c382c3ead0ef192ed15ba8c37bb32acd0e843", "message": "nit", "committedDate": "2020-07-28T19:47:19Z", "type": "commit"}, {"oid": "debe0c5bce13bc52a69a6e1e05fdc7faa91d9a19", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/debe0c5bce13bc52a69a6e1e05fdc7faa91d9a19", "message": "revert changes for column size validation", "committedDate": "2020-07-28T21:42:06Z", "type": "commit"}, {"oid": "6add9da5949e1816b5174e13285d3ebb4f204a50", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/6add9da5949e1816b5174e13285d3ebb4f204a50", "message": "Merge branch 'develop' of https://github.com/rupal-bq/sql into feature/odbc/pbi", "committedDate": "2020-07-28T21:50:34Z", "type": "commit"}, {"oid": "a80eee8edfbff508293818db621eb8dd7c704ad8", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/a80eee8edfbff508293818db621eb8dd7c704ad8", "message": "address PR comments", "committedDate": "2020-07-29T01:20:24Z", "type": "commit"}, {"oid": "e6490e453455b3eb978977015ad665b864902449", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/e6490e453455b3eb978977015ad665b864902449", "message": "Update SQL_GROUP_BY value for fixing query folding issue", "committedDate": "2020-07-29T22:50:09Z", "type": "commit"}, {"oid": "e1032c3ab9a60935c950e5b5f576da5fbcb7a65a", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/e1032c3ab9a60935c950e5b5f576da5fbcb7a65a", "message": "Merge branch 'develop' of https://github.com/rupal-bq/sql into feature/odbc/pbi", "committedDate": "2020-07-29T22:57:58Z", "type": "commit"}, {"oid": "9a36d476b7aa71a9a9f0810bbe2cd72493faee8b", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/9a36d476b7aa71a9a9f0810bbe2cd72493faee8b", "message": "removing AstVisitor for resolving query folding issue with data type boolean", "committedDate": "2020-07-30T18:24:50Z", "type": "commit"}, {"oid": "8fa089b17c965ccff5392dbe568846c12751c367", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/8fa089b17c965ccff5392dbe568846c12751c367", "message": "fix parameter binding issue", "committedDate": "2020-07-31T19:01:37Z", "type": "commit"}, {"oid": "4a874c73ad2961082e28fd05518eca58c34b152a", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/4a874c73ad2961082e28fd05518eca58c34b152a", "message": "Merge branch 'develop' of https://github.com/rupal-bq/sql into feature/odbc/pbi\n\n# Resolved Conflicts:\n#\tsql-odbc/src/PowerBIConnector/OdfeSqlOdbcPBIConnector.pq\n#\tsql-odbc/src/PowerBIConnector/bin/Release/OdfeSqlOdbcPBIConnector.mez", "committedDate": "2020-07-31T19:06:54Z", "type": "commit"}, {"oid": "d681bf8a5409329efa130ad292776e22781396d2", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/d681bf8a5409329efa130ad292776e22781396d2", "message": "simplify changes", "committedDate": "2020-07-31T19:30:26Z", "type": "commit"}, {"oid": "10986bb69763f8ccb0990e77479b221b5be23b41", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/10986bb69763f8ccb0990e77479b221b5be23b41", "message": "update user doc for pbi", "committedDate": "2020-07-31T20:07:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3MzIzNA==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/652#discussion_r463873234", "bodyText": "Can you confirm these options for date/time/timestamp literals? Wondering if this refers to the {dt ...}-type syntax we've seen before, which ODFE SQL plugin doesn't support", "author": "jordanw-bq", "createdAt": "2020-07-31T22:32:22Z", "path": "sql-odbc/src/PowerBIConnector/OdfeSqlOdbcPBIConnector.pq", "diffHunk": "@@ -106,6 +106,20 @@ OdfeSqlOdbcPBIConnectorImpl = (Host as text, optional Port as number) as table =\n                     Value.ReplaceType(toTable, Value.Type(source))\n             else\n                 source,\n+        \n+        SQLGetFunctions = Diagnostics.LogValue(\"SQLGetFunctions_Options\", [\n+            SQL_API_SQLBINDPARAMETER = false\n+        ]),\n+\n+        SqlCapabilities = Diagnostics.LogValue(\"SqlCapabilities_Options\", [\n+            SupportsTop = false,\n+            LimitClauseKind = LimitClauseKind.LimitOffset,\n+            SupportsNumericLiterals = true,\n+            SupportsStringLiterals = true,\n+            SupportsOdbcDateLiterals = true,", "originalCommit": "10986bb69763f8ccb0990e77479b221b5be23b41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg4MTE3MA==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/652#discussion_r463881170", "bodyText": "Yes, this refers to {d ..} syntax. But if we don't set this to true then date values will always be specified using Parameter Binding (https://docs.microsoft.com/en-us/power-query/odbc) which is also not supported.\nI will check if it is possible to report the escape sequence syntax unsupported.", "author": "rupal-bq", "createdAt": "2020-07-31T23:07:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3MzIzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg5MTc3Mw==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/652#discussion_r463891773", "bodyText": "ODBC driver sets SQL_DATETIME_LITERALS to 0 in SQLGetInfo and a value of \"0\" means that SQL-92 datetime literals are not supported. (https://docs.microsoft.com/en-us/sql/odbc/reference/syntax/sqlgetinfo-function?view=sql-server-ver15)", "author": "rupal-bq", "createdAt": "2020-08-01T00:02:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3MzIzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg5Njc3OQ==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/652#discussion_r463896779", "bodyText": "Verified with @rupal-bq that timestamp values work with the current PBI connector; will look back at this when we include DirectQuery support", "author": "jordanw-bq", "createdAt": "2020-08-01T00:33:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3MzIzNA=="}], "type": "inlineReview"}]}