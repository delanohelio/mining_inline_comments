{"pr_number": 536, "pr_title": "Enforce comparison test in new SQL module", "pr_createdAt": "2020-06-29T15:38:49Z", "pr_url": "https://github.com/opendistro-for-elasticsearch/sql/pull/536", "timeline": [{"oid": "c318dc5f3ca4b687f8acca664f18286b4b48e4bb", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/c318dc5f3ca4b687f8acca664f18286b4b48e4bb", "message": "Add comparison test base class and sample IT", "committedDate": "2020-06-26T23:12:26Z", "type": "commit"}, {"oid": "5023d4cf0616879e6ce12ad830a3b885221037d5", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/5023d4cf0616879e6ce12ad830a3b885221037d5", "message": "Close connection", "committedDate": "2020-06-26T23:12:26Z", "type": "commit"}, {"oid": "099fd2a25e390d69ac7b26b4d8f7e228ec7ebea7", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/099fd2a25e390d69ac7b26b4d8f7e228ec7ebea7", "message": "Add refresh=true", "committedDate": "2020-06-26T23:12:26Z", "type": "commit"}, {"oid": "9957c3ba10e3f0d30e31568060d5196e28bfb0fb", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/9957c3ba10e3f0d30e31568060d5196e28bfb0fb", "message": "Add refresh=true", "committedDate": "2020-06-26T23:12:26Z", "type": "commit"}, {"oid": "6ac52fd0572b9294060eefe0a441a6b60ec171de", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/6ac52fd0572b9294060eefe0a441a6b60ec171de", "message": "Add comment to explain why not close REST client", "committedDate": "2020-06-26T23:12:27Z", "type": "commit"}, {"oid": "f13832301847101a443fe8d40df33b336318fbe0", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/f13832301847101a443fe8d40df33b336318fbe0", "message": "Organize test case in txt file", "committedDate": "2020-06-26T23:12:27Z", "type": "commit"}, {"oid": "6a684062f357057e7176190eb5504314b703aa5e", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/6a684062f357057e7176190eb5504314b703aa5e", "message": "Support fetch size 0 which is default request by JDBC driver", "committedDate": "2020-06-26T23:14:06Z", "type": "commit"}, {"oid": "900b465f5ed1ac570252036cbd4468aff9c5ae37", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/900b465f5ed1ac570252036cbd4468aff9c5ae37", "message": "Explain comparison test result for easy troubleshooting", "committedDate": "2020-06-26T23:14:20Z", "type": "commit"}, {"oid": "7f1283498209028defb94a0c851f6929ae9932c0", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/7f1283498209028defb94a0c851f6929ae9932c0", "message": "Run queries in a file by a batch", "committedDate": "2020-06-26T23:14:20Z", "type": "commit"}, {"oid": "51de1d558979c202539cfb445d1825c5672b0c5e", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/51de1d558979c202539cfb445d1825c5672b0c5e", "message": "Prepare for PR", "committedDate": "2020-06-26T23:14:21Z", "type": "commit"}, {"oid": "a887e89e61926c1adbf71bcc1fe33f5ebc846c18", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/a887e89e61926c1adbf71bcc1fe33f5ebc846c18", "message": "Prepare PR", "committedDate": "2020-06-26T23:43:23Z", "type": "commit"}, {"oid": "15f972d332b13ccdbd23823495158579f25fd08a", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/15f972d332b13ccdbd23823495158579f25fd08a", "message": "Remove unused query files", "committedDate": "2020-06-29T15:14:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkxMDYwMQ==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/536#discussion_r447910601", "bodyText": "Shall we also include missing values in compareTo?", "author": "chloe-zh", "createdAt": "2020-06-30T18:56:21Z", "path": "integ-test/src/test/java/com/amazon/opendistroforelasticsearch/sql/correctness/runner/resultset/Row.java", "diffHunk": "@@ -56,4 +57,32 @@ private Object roundFloatNum(Object value) {\n     return value;\n   }\n \n+  @SuppressWarnings(\"unchecked\")\n+  @Override\n+  public int compareTo(Row other) {\n+    List<Object> thisObjects = new ArrayList<>(values);\n+    List<Object> otherObjects = new ArrayList<>(other.values);\n+\n+    for (int i = 0; i < thisObjects.size(); i++) {\n+      Object thisObject = thisObjects.get(i);\n+      Object otherObject = otherObjects.get(i);\n+\n+      /*\n+       * Only one is null, otherwise (both null or non-null) go ahead.\n+       * Always consider NULL is greater which means NULL comes last in ASC and first in DESC\n+       */\n+      if (thisObject == null ^ otherObject == null) {\n+        return thisObject == null ? 1 : -1;\n+      }", "originalCommit": "15f972d332b13ccdbd23823495158579f25fd08a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ0MjQxMw==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/536#discussion_r448442413", "bodyText": "Shall we also include missing values in compareTo?\n\n\nShall we also include missing values in compareTo?\n\nSure, the object here is what we get from JSON response. So I think no matter missing value absent or present as ex.\"MISSING\", it will be taken care by the if below. Let me know if any case I miss. Thanks.", "author": "dai-chen", "createdAt": "2020-07-01T15:26:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzkxMDYwMQ=="}], "type": "inlineReview"}, {"oid": "87b589200289e8957ab09ffbde0545d87f1569a9", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/87b589200289e8957ab09ffbde0545d87f1569a9", "message": "Merge branch 'develop' into enforce-comparison-test-merged", "committedDate": "2020-06-30T20:14:38Z", "type": "commit"}]}