{"pr_number": 516, "pr_title": "[PPL] Add PPL documentation.", "pr_createdAt": "2020-06-11T00:25:25Z", "pr_url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516", "timeline": [{"oid": "ea69d228dc49030e6de4c84ac19fe18736734a08", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/ea69d228dc49030e6de4c84ac19fe18736734a08", "message": "add interface", "committedDate": "2020-06-10T02:50:01Z", "type": "commit"}, {"oid": "0ec0f77b3eca71ed75c06a3195ea0014b78d5154", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/0ec0f77b3eca71ed75c06a3195ea0014b78d5154", "message": "update", "committedDate": "2020-06-10T02:59:21Z", "type": "commit"}, {"oid": "969f743b8f800226ec826a2da56fe9800233c758", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/969f743b8f800226ec826a2da56fe9800233c758", "message": "search command", "committedDate": "2020-06-10T03:54:52Z", "type": "commit"}, {"oid": "a53a1912ddbf9e25d8cdfb0b552881a127b179c7", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/a53a1912ddbf9e25d8cdfb0b552881a127b179c7", "message": "add dedup", "committedDate": "2020-06-10T20:40:02Z", "type": "commit"}, {"oid": "985d4de62f57332fecb659b50698aaea0a26f6fa", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/985d4de62f57332fecb659b50698aaea0a26f6fa", "message": "update commands", "committedDate": "2020-06-10T23:15:55Z", "type": "commit"}, {"oid": "fb70191fa57bd9014b900c47240d87c6f799c2e4", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/fb70191fa57bd9014b900c47240d87c6f799c2e4", "message": "update syntax", "committedDate": "2020-06-10T23:31:11Z", "type": "commit"}, {"oid": "ead0201a05526c57848e6615ff520555ae977fc0", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/ead0201a05526c57848e6615ff520555ae977fc0", "message": "wording", "committedDate": "2020-06-11T00:18:20Z", "type": "commit"}, {"oid": "b7cc8f38a1b3a313964962769ac8f232afe35deb", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/b7cc8f38a1b3a313964962769ac8f232afe35deb", "message": "remove sample", "committedDate": "2020-06-11T00:23:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE5ODM1Ng==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516#discussion_r439198356", "bodyText": "What about removing example 3 or merging example 3 & 4 to one example by making 3 as the comparison case?", "author": "chloe-zh", "createdAt": "2020-06-12T04:18:29Z", "path": "docs/experiment/ppl/cmd/dedup.rst", "diffHunk": "@@ -0,0 +1,112 @@\n+=============\n+dedup\n+=============\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+   :depth: 2\n+\n+\n+Description\n+============\n+| Using ``dedup`` command to remove identical document defined by field from the search result.\n+\n+\n+Syntax\n+============\n+dedup [int] <field-list> [keepempty=<bool>] [consecutive=<bool>]\n+\n+\n+* int: optional. The ``dedup`` command retains multiple events for each combination when you specify <int>. The number for <int> must be greater than 0. If you do not specify a number, only the first occurring event is kept. All other duplicates are removed from the results. **Default:** 1\n+* keepempty: optional. if true, keep the document if the any field in the field-list has NULL value or field is MISSING. **Default:** false.\n+* consecutive: optional. If set to true, removes only events with duplicate combinations of values that are consecutive. **Default:** false.\n+* field-list: mandatory. The comma-delimited field list. At least one field is required.\n+\n+\n+Example 1: Dedup by one field\n+=============================\n+\n+The example show dedup the document with gender field.\n+\n+PPL query::\n+\n+    od> source=accounts | dedup gender | fields account_number, gender;\n+    fetched rows / total rows = 2/2\n+    +------------------+----------+\n+    | account_number   | gender   |\n+    |------------------+----------|\n+    | 1                | M        |\n+    | 13               | F        |\n+    +------------------+----------+\n+\n+Example 2: Keep 2 duplicates documents\n+======================================\n+\n+The example show dedup the document with gender field keep 2 duplication.\n+\n+PPL query::\n+\n+    od> source=accounts | dedup 2 gender | fields account_number, gender;\n+    fetched rows / total rows = 3/3\n+    +------------------+----------+\n+    | account_number   | gender   |\n+    |------------------+----------|\n+    | 1                | M        |\n+    | 6                | M        |\n+    | 13               | F        |\n+    +------------------+----------+\n+\n+Example 3: Ignore the empty field by default\n+============================================\n+\n+The example show dedup the document by ignore the empty value field.\n+\n+PPL query::\n+\n+    od> source=accounts | dedup email | fields account_number, email;\n+    fetched rows / total rows = 3/3\n+    +------------------+-----------------------+\n+    | account_number   | email                 |\n+    |------------------+-----------------------|\n+    | 1                | amberduke@pyrami.com  |\n+    | 6                | hattiebond@netagy.com |\n+    | 18               | daleadams@boink.com   |\n+    +------------------+-----------------------+\n+\n+Example 4: Keep the empty field\n+===============================\n+\n+The example show dedup the document by keep null value field.\n+\n+PPL query::\n+\n+    od> source=accounts | dedup email keepempty=true | fields account_number, email;\n+    fetched rows / total rows = 4/4\n+    +------------------+-----------------------+\n+    | account_number   | email                 |\n+    |------------------+-----------------------|\n+    | 1                | amberduke@pyrami.com  |\n+    | 6                | hattiebond@netagy.com |\n+    | 13               | null                  |\n+    | 18               | daleadams@boink.com   |\n+    +------------------+-----------------------+\n+", "originalCommit": "b7cc8f38a1b3a313964962769ac8f232afe35deb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYwMzc4NQ==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516#discussion_r439603785", "bodyText": "goot point, done.", "author": "penghuo", "createdAt": "2020-06-12T19:25:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE5ODM1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIwMDExOA==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516#discussion_r439200118", "bodyText": "Maybe we should also put the rule (that search command is mandatory and used as the first command) in syntax.rst so that users can get to know it more straightforward", "author": "chloe-zh", "createdAt": "2020-06-12T04:27:00Z", "path": "docs/experiment/ppl/cmd/search.rst", "diffHunk": "@@ -0,0 +1,59 @@\n+=============\n+search\n+=============\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+   :depth: 2\n+\n+\n+Description\n+============\n+| Using ``search`` command to retrieve document from the index. ``search`` command could be only used as the first command in the PPL query.\n+", "originalCommit": "b7cc8f38a1b3a313964962769ac8f232afe35deb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYwMDE4Ng==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516#discussion_r439600186", "bodyText": "sure, add another section to describe the command order.", "author": "penghuo", "createdAt": "2020-06-12T19:16:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIwMDExOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIwMDMwNQ==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516#discussion_r439200305", "bodyText": "Typo?", "author": "chloe-zh", "createdAt": "2020-06-12T04:27:50Z", "path": "docs/experiment/ppl/cmd/syntax.rst", "diffHunk": "@@ -0,0 +1,19 @@\n+=============\n+rename", "originalCommit": "b7cc8f38a1b3a313964962769ac8f232afe35deb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYwMDAyOQ==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516#discussion_r439600029", "bodyText": "done.", "author": "penghuo", "createdAt": "2020-06-12T19:15:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIwMDMwNQ=="}], "type": "inlineReview"}, {"oid": "14f0f53134c181b37db81b67feb7b9895b8e5e3e", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/14f0f53134c181b37db81b67feb7b9895b8e5e3e", "message": "address comments", "committedDate": "2020-06-12T19:22:43Z", "type": "commit"}, {"oid": "08265aebd84a63539d848d0ae8049305a4ec6cc1", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/08265aebd84a63539d848d0ae8049305a4ec6cc1", "message": "update", "committedDate": "2020-06-12T19:24:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYwNDgyMw==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516#discussion_r439604823", "bodyText": "np but reminder: #513 merged, rename command can be applied to multiple fields now", "author": "chloe-zh", "createdAt": "2020-06-12T19:27:53Z", "path": "docs/experiment/ppl/cmd/rename.rst", "diffHunk": "@@ -0,0 +1,42 @@\n+=============\n+rename\n+=============\n+\n+.. rubric:: Table of contents\n+\n+.. contents::\n+   :local:\n+   :depth: 2\n+\n+\n+Description\n+============\n+| Using ``rename`` command to rename one in the search result.\n+\n+\n+Syntax\n+============\n+rename <source-field> AS <target-field>\n+\n+* source-field: mandatory. The name of the field you want to rename.\n+* field list: mandatory. The name you want to rename to.\n+\n+\n+Example 1: Rename one field\n+==============================================\n+\n+The example show rename one field.\n+\n+PPL query::\n+\n+    od> source=accounts | rename account_number as an | fields an;\n+    fetched rows / total rows = 4/4\n+    +------+\n+    | an   |\n+    |------|\n+    | 1    |\n+    | 6    |\n+    | 13   |\n+    | 18   |\n+    +------+\n+", "originalCommit": "08265aebd84a63539d848d0ae8049305a4ec6cc1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYzNzU1Ng==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/516#discussion_r439637556", "bodyText": "sure, merge the code and add the description.", "author": "penghuo", "createdAt": "2020-06-12T20:53:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTYwNDgyMw=="}], "type": "inlineReview"}, {"oid": "3d8f0aa589dad469bf487d23ce1227e2bf43b857", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/3d8f0aa589dad469bf487d23ce1227e2bf43b857", "message": "update", "committedDate": "2020-06-12T20:45:35Z", "type": "commit"}, {"oid": "d7d6bb4e79bf8c4cbbc4e666c628a1f9a7b5cdf2", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/d7d6bb4e79bf8c4cbbc4e666c628a1f9a7b5cdf2", "message": "Merge branch 'develop' into ppl-doc", "committedDate": "2020-06-12T20:45:38Z", "type": "commit"}, {"oid": "02cefc2ab1e11599736f0f63f6e72261f4abf8d9", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/02cefc2ab1e11599736f0f63f6e72261f4abf8d9", "message": "add multiple fields description for rename", "committedDate": "2020-06-12T20:50:36Z", "type": "commit"}]}