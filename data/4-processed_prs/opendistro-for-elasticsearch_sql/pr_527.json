{"pr_number": 527, "pr_title": "Add new sql module", "pr_createdAt": "2020-06-18T17:35:01Z", "pr_url": "https://github.com/opendistro-for-elasticsearch/sql/pull/527", "timeline": [{"oid": "44c0504252c25b7a887ae36bb000e5dc08ec26f4", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/44c0504252c25b7a887ae36bb000e5dc08ec26f4", "message": "Add new SQL module with support for SELECT literal", "committedDate": "2020-06-17T19:06:57Z", "type": "commit"}, {"oid": "e6a4b88a9f5c8b9fffa4c80651f065602c834e60", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/e6a4b88a9f5c8b9fffa4c80651f065602c834e60", "message": "Add support for more data types", "committedDate": "2020-06-17T22:44:16Z", "type": "commit"}, {"oid": "364024cc9b717f1681450d90bc4bcc37467dcbaf", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/364024cc9b717f1681450d90bc4bcc37467dcbaf", "message": "Route request to new frontend", "committedDate": "2020-06-18T03:25:32Z", "type": "commit"}, {"oid": "89a73a64fd191210adf4b30f341342e78a685da4", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/89a73a64fd191210adf4b30f341342e78a685da4", "message": "Add more UT", "committedDate": "2020-06-18T04:35:40Z", "type": "commit"}, {"oid": "607f2ca85c318c926e6666cc3a298dd32c87bf5e", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/607f2ca85c318c926e6666cc3a298dd32c87bf5e", "message": "Fix doctest", "committedDate": "2020-06-18T04:49:08Z", "type": "commit"}, {"oid": "6b0197cf36c2ac4a6d48b51a3c62b08c0381f6d1", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/6b0197cf36c2ac4a6d48b51a3c62b08c0381f6d1", "message": "Add more UT", "committedDate": "2020-06-18T05:04:34Z", "type": "commit"}, {"oid": "5e977e3ad9696b863bb0038c6dbbb3f39002050b", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/5e977e3ad9696b863bb0038c6dbbb3f39002050b", "message": "Add more UT", "committedDate": "2020-06-18T16:16:59Z", "type": "commit"}, {"oid": "616d34bad0673368a4a97c31b4b55efc6cd3431f", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/616d34bad0673368a4a97c31b4b55efc6cd3431f", "message": "Fix checkstyle and jacoco", "committedDate": "2020-06-18T17:18:38Z", "type": "commit"}, {"oid": "84f4da778df1c0c374fda3555c7dcd907ac56000", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/84f4da778df1c0c374fda3555c7dcd907ac56000", "message": "Address PR", "committedDate": "2020-06-18T18:25:41Z", "type": "commit"}, {"oid": "66133355b9cff464c9f23d202e3ec2113a249c7d", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/66133355b9cff464c9f23d202e3ec2113a249c7d", "message": "Add more docs", "committedDate": "2020-06-18T18:50:04Z", "type": "commit"}, {"oid": "27e832d654ac6e6aaf30529b97027b7b85c2e80c", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/27e832d654ac6e6aaf30529b97027b7b85c2e80c", "message": "Merge branch 'develop' into add-new-sql-module", "committedDate": "2020-06-18T18:50:57Z", "type": "commit"}, {"oid": "f8f922e85c3f80ff842345c6c9f71a8e83b20fe2", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/f8f922e85c3f80ff842345c6c9f71a8e83b20fe2", "message": "Use new syntax check exception", "committedDate": "2020-06-18T18:59:46Z", "type": "commit"}, {"oid": "dceff7332b77f3120ef86368448c8cdd2479e66a", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/dceff7332b77f3120ef86368448c8cdd2479e66a", "message": "Unregister new handler and add UT", "committedDate": "2020-06-19T15:47:45Z", "type": "commit"}, {"oid": "efb49a8da78286014272ca4f6eddae0ac59c40fa", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/efb49a8da78286014272ca4f6eddae0ac59c40fa", "message": "Support fetch size 0 which is default request by JDBC driver", "committedDate": "2020-06-25T16:48:17Z", "type": "commit"}, {"oid": "79233cfaecb0eb9630084fce87294534f98efa1d", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/79233cfaecb0eb9630084fce87294534f98efa1d", "message": "Merge branch 'develop' into add-new-sql-module", "committedDate": "2020-06-25T16:49:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjM5OTI4Mw==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/527#discussion_r446399283", "bodyText": "add some log to tracking the fallback behaviour for debug", "author": "penghuo", "createdAt": "2020-06-26T20:39:19Z", "path": "legacy/src/main/java/com/amazon/opendistroforelasticsearch/sql/legacy/plugin/RestSqlAction.java", "diffHunk": "@@ -135,8 +142,19 @@ protected RestChannelConsumer prepareRequest(RestRequest request, NodeClient cli\n             LOG.info(\"[{}] Incoming request {}: {}\", LogUtils.getRequestId(), request.uri(),\n                     QueryDataAnonymizer.anonymizeData(sqlRequest.getSql()));\n \n-            final QueryAction queryAction =\n-                    explainRequest(client, sqlRequest, SqlRequestParam.getFormat(request.params()));\n+            Format format = SqlRequestParam.getFormat(request.params());\n+\n+            // Route request to new query engine if it's supported already\n+            SQLQueryRequest newSqlRequest = new SQLQueryRequest(sqlRequest.getJsonContent(),\n+                                                                sqlRequest.getSql(),\n+                                                                request.path(),\n+                                                                format.getFormatName());\n+            RestChannelConsumer result = newSqlQueryHandler.prepareRequest(newSqlRequest, client);\n+            if (result != RestSQLQueryAction.NOT_SUPPORTED_YET) {\n+                return result;", "originalCommit": "79233cfaecb0eb9630084fce87294534f98efa1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQwMDU0OA==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/527#discussion_r446400548", "bodyText": "sure, will do!", "author": "dai-chen", "createdAt": "2020-06-26T20:42:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjM5OTI4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQwMzEzNw==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/527#discussion_r446403137", "bodyText": "Add some SQL VALUES related doc if possible.", "author": "penghuo", "createdAt": "2020-06-26T20:48:51Z", "path": "core/src/main/java/com/amazon/opendistroforelasticsearch/sql/planner/logical/LogicalValues.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ *    Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n+ *\n+ *    Licensed under the Apache License, Version 2.0 (the \"License\").\n+ *    You may not use this file except in compliance with the License.\n+ *    A copy of the License is located at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *    or in the \"license\" file accompanying this file. This file is distributed\n+ *    on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n+ *    express or implied. See the License for the specific language governing\n+ *    permissions and limitations under the License.\n+ *\n+ */\n+\n+package com.amazon.opendistroforelasticsearch.sql.planner.logical;\n+\n+import com.amazon.opendistroforelasticsearch.sql.expression.LiteralExpression;\n+import com.google.common.collect.ImmutableList;\n+import java.util.List;\n+import lombok.EqualsAndHashCode;\n+import lombok.Getter;\n+import lombok.RequiredArgsConstructor;\n+import lombok.ToString;\n+\n+/**\n+ * Logical operator which is a sequence of literal list.", "originalCommit": "79233cfaecb0eb9630084fce87294534f98efa1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQyNDQzOQ==", "url": "https://github.com/opendistro-for-elasticsearch/sql/pull/527#discussion_r446424439", "bodyText": "Sure, adding more comments. Thanks!", "author": "dai-chen", "createdAt": "2020-06-26T21:45:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjQwMzEzNw=="}], "type": "inlineReview"}, {"oid": "5a062ce62470ae1ae4f0515d8d58d09ce909aeb9", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/5a062ce62470ae1ae4f0515d8d58d09ce909aeb9", "message": "Address PR comments", "committedDate": "2020-06-26T22:25:40Z", "type": "commit"}, {"oid": "98dafa77ba20582cc3f065941338d07e84f4fbab", "url": "https://github.com/opendistro-for-elasticsearch/sql/commit/98dafa77ba20582cc3f065941338d07e84f4fbab", "message": "Merge branch 'develop' into add-new-sql-module", "committedDate": "2020-06-26T22:32:25Z", "type": "commit"}]}