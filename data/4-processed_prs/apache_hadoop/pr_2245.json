{"pr_number": 2245, "pr_title": "HADOOP-17159. Make UGI support forceful relogin from keytab ignoring the last login time (branch-2.10)", "pr_createdAt": "2020-08-25T15:16:10Z", "pr_url": "https://github.com/apache/hadoop/pull/2245", "timeline": [{"oid": "a5c8c616ed2332a2d2510f50cf1e64a347f1fba8", "url": "https://github.com/apache/hadoop/commit/a5c8c616ed2332a2d2510f50cf1e64a347f1fba8", "message": "HADOOP-17159 Ability for forceful relogin in UserGroupInformation class", "committedDate": "2020-08-25T15:14:55Z", "type": "commit"}, {"oid": "23654b10dd8ac71a1bd01c05b60f2b24011aaebe", "url": "https://github.com/apache/hadoop/commit/23654b10dd8ac71a1bd01c05b60f2b24011aaebe", "message": "Fix checkstyle warnings", "committedDate": "2020-08-25T18:36:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODYwMjEyMA==", "url": "https://github.com/apache/hadoop/pull/2245#discussion_r478602120", "bodyText": "I'm thinking of the same problem of the same method signature when potential Hadoop 2 code calling reloginFromKeytab(false) upgrades to Hadoop 3. Because of the same method name and a bool parameter, users most likely will not notice the parameter value is for different meanings: in Hadoop 2 here, the bool parameter is for ignoreTimeElapsed where in Hadoop 3 it is actually for checkTGT.\nSo is it better to:\n\nMake this new API public synchronized void reloginFromKeytab(boolean ignoreTimeElapsed) private\nAND we also add the new API as in Hadoop 3: public void forceReloginFromKeytab().\n\nThat way, the application code which forces login will have the same code between Hadoop 2 and 3. And the other new API reloginFromKeytab(boolean) is private in UGI both in Hadoop 2 and 3.", "author": "liuml07", "createdAt": "2020-08-27T18:05:30Z", "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/security/UserGroupInformation.java", "diffHunk": "@@ -1215,23 +1215,43 @@ private void fixKerberosTicketOrder() {\n    * Re-Login a user in from a keytab file. Loads a user identity from a keytab\n    * file and logs them in. They become the currently logged-in user. This\n    * method assumes that {@link #loginUserFromKeytab(String, String)} had\n-   * happened already.\n-   * The Subject field of this UserGroupInformation object is updated to have\n-   * the new credentials.\n+   * happened already. The Subject field of this UserGroupInformation object is\n+   * updated to have the new credentials.\n+   *\n    * @throws IOException\n    * @throws KerberosAuthException on a failure\n    */\n   @InterfaceAudience.Public\n   @InterfaceStability.Evolving\n   public synchronized void reloginFromKeytab() throws IOException {\n+    reloginFromKeytab(false);\n+  }\n+\n+  /**\n+   * Force re-Login a user in from a keytab file. Loads a user identity from a\n+   * keytab file and logs them in. They become the currently logged-in user.\n+   * This method assumes that {@link #loginUserFromKeytab(String, String)} had\n+   * happened already. The Subject field of this UserGroupInformation object is\n+   * updated to have the new credentials.\n+   *\n+   * @param ignoreTimeElapsed Force re-login irrespective of the time of last\n+   *                          login\n+   * @throws IOException\n+   * @throws KerberosAuthException on a failure\n+   */\n+  @InterfaceAudience.Public\n+  @InterfaceStability.Evolving\n+  public synchronized void reloginFromKeytab(boolean ignoreTimeElapsed)", "originalCommit": "23654b10dd8ac71a1bd01c05b60f2b24011aaebe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY0MzUzMw==", "url": "https://github.com/apache/hadoop/pull/2245#discussion_r478643533", "bodyText": "@liuml07 Yes it makes sense to keep the code consistent for the callers to avoid such issues with a upgrade", "author": "sguggilam", "createdAt": "2020-08-27T19:23:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODYwMjEyMA=="}], "type": "inlineReview"}, {"oid": "40c83137f15e11c3ee394b7794b8e5bd80182cef", "url": "https://github.com/apache/hadoop/commit/40c83137f15e11c3ee394b7794b8e5bd80182cef", "message": "Add a new API forceRelogin", "committedDate": "2020-08-27T19:44:04Z", "type": "commit"}]}