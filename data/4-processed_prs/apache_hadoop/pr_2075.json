{"pr_number": 2075, "pr_title": "YARN-10314. YarnClient throws NoClassDefFoundError for WebSocketException with only shaded client jars", "pr_createdAt": "2020-06-15T05:28:54Z", "pr_url": "https://github.com/apache/hadoop/pull/2075", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY2MTIxOA==", "url": "https://github.com/apache/hadoop/pull/2075#discussion_r440661218", "bodyText": "Agreed that jetty-client and jetty-http are shaded as well because jetty websocket-client depends on them.\nwebsocket-client depends on jetty-xml, too.  Should we shade jetty-xml or not?\nhttps://github.com/eclipse/jetty.project/blob/jetty-9.4.x/jetty-websocket/websocket-client/pom.xml#L25", "author": "aajisaka", "createdAt": "2020-06-16T08:02:50Z", "path": "hadoop-client-modules/hadoop-client-runtime/pom.xml", "diffHunk": "@@ -158,11 +158,8 @@\n                       <!-- the jdk ships part of the javax.annotation namespace, so if we want to relocate this we'll have to care it out by class :( -->\n                       <exclude>com.google.code.findbugs:jsr305</exclude>\n                       <exclude>io.dropwizard.metrics:metrics-core</exclude>\n-                      <exclude>org.eclipse.jetty.websocket:*</exclude>\n                       <exclude>org.eclipse.jetty:jetty-servlet</exclude>\n                       <exclude>org.eclipse.jetty:jetty-security</exclude>\n-                      <exclude>org.eclipse.jetty:jetty-client</exclude>\n-                      <exclude>org.eclipse.jetty:jetty-http</exclude>\n                       <exclude>org.eclipse.jetty:jetty-xml</exclude>", "originalCommit": "8c0899fc88753a94b754eb46f7166f8566252b45", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc1NDUyMQ==", "url": "https://github.com/apache/hadoop/pull/2075#discussion_r440754521", "bodyText": "jetty-servlet and jetty-security are brought by YARN-8778. jetty-client, jetty-http and jetty-xml are brought by HADOOP-16152. The patch of HADOOP-16152 looks excluding them on purpose.", "author": "iwasakims", "createdAt": "2020-06-16T10:39:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY2MTIxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDc3MDEyNg==", "url": "https://github.com/apache/hadoop/pull/2075#discussion_r440770126", "bodyText": "I believe jetty-servlet and jetty-security are brought in by YARN-8763 not YARN-8778. ` ``\n\nwebsocket-client depends on jetty-xml, too. Should we shade jetty-xml or not?\n\nI think its fair to include jetty-xml as well in the shaded runtime jar. Will update the PR.", "author": "vinayakumarb", "createdAt": "2020-06-16T11:09:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY2MTIxOA=="}], "type": "inlineReview"}, {"oid": "66f7dddf4a244f98cb8d8c9bdb6e484d35282f8f", "url": "https://github.com/apache/hadoop/commit/66f7dddf4a244f98cb8d8c9bdb6e484d35282f8f", "message": "YARN-10314. YarnClient throws NoClassDefFoundError for WebSocketException with only shaded client jars", "committedDate": "2020-06-16T11:19:08Z", "type": "commit"}, {"oid": "66f7dddf4a244f98cb8d8c9bdb6e484d35282f8f", "url": "https://github.com/apache/hadoop/commit/66f7dddf4a244f98cb8d8c9bdb6e484d35282f8f", "message": "YARN-10314. YarnClient throws NoClassDefFoundError for WebSocketException with only shaded client jars", "committedDate": "2020-06-16T11:19:08Z", "type": "forcePushed"}]}