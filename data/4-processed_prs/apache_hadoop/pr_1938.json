{"pr_number": 1938, "pr_title": "HADOOP-16922. ABFS: Change User-Agent header", "pr_createdAt": "2020-04-03T12:19:58Z", "pr_url": "https://github.com/apache/hadoop/pull/1938", "timeline": [{"oid": "b508ce2308bfd77e0440aa7ae0eae6d6a875d319", "url": "https://github.com/apache/hadoop/commit/b508ce2308bfd77e0440aa7ae0eae6d6a875d319", "message": "User-Agent String changes", "committedDate": "2020-04-02T21:27:49Z", "type": "commit"}, {"oid": "bfa75cb779fa21d0ca17f263dd36dadadc884d99", "url": "https://github.com/apache/hadoop/commit/bfa75cb779fa21d0ca17f263dd36dadadc884d99", "message": "User-Agent header changes", "committedDate": "2020-04-03T12:16:36Z", "type": "commit"}, {"oid": "a396b3c06de487e0d6b5ff5cc00702a4423558b0", "url": "https://github.com/apache/hadoop/commit/a396b3c06de487e0d6b5ff5cc00702a4423558b0", "message": "Adding test cases", "committedDate": "2020-04-03T15:29:26Z", "type": "commit"}, {"oid": "acaea3b3ea4846296485e6166f3f8f889e5ed4af", "url": "https://github.com/apache/hadoop/commit/acaea3b3ea4846296485e6166f3f8f889e5ed4af", "message": "Fixing import order", "committedDate": "2020-04-03T15:33:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM2NDIzOQ==", "url": "https://github.com/apache/hadoop/pull/1938#discussion_r403364239", "bodyText": "is this annotation needed?", "author": "DadanielZ", "createdAt": "2020-04-03T22:22:24Z", "path": "hadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/services/TestAbfsClient.java", "diffHunk": "@@ -18,80 +18,220 @@\n \n package org.apache.hadoop.fs.azurebfs.services;\n \n+import java.io.IOException;\n+import java.net.MalformedURLException;\n import java.net.URL;\n import java.util.regex.Pattern;\n \n-import org.apache.hadoop.fs.azurebfs.contracts.exceptions.AzureBlobFileSystemException;\n-import org.junit.Assert;\n+import org.assertj.core.api.Assertions;\n import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n \n import org.apache.hadoop.fs.azurebfs.AbfsConfiguration;\n import org.apache.hadoop.fs.azurebfs.oauth2.AccessTokenProvider;\n import org.apache.hadoop.conf.Configuration;\n import org.apache.hadoop.fs.azurebfs.constants.ConfigurationKeys;\n import org.apache.hadoop.security.ssl.DelegatingSSLSocketFactory;\n-import org.apache.hadoop.util.VersionInfo;\n+\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.APN_VERSION;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.CLIENT_VERSION;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.EMPTY_STRING;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.FORWARD_SLASH;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.JAVA_VERSION;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.OS_ARCH;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.OS_NAME;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.OS_VERSION;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.SEMICOLON;\n+import static org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants.SINGLE_WHITE_SPACE;\n+import static org.apache.hadoop.fs.azurebfs.constants.ConfigurationKeys.FS_AZURE_CLUSTER_NAME;\n+import static org.apache.hadoop.fs.azurebfs.constants.ConfigurationKeys.FS_AZURE_CLUSTER_TYPE;\n \n /**\n  * Test useragent of abfs client.\n  *\n  */\n+@RunWith(JUnit4.class)", "originalCommit": "acaea3b3ea4846296485e6166f3f8f889e5ed4af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ba069d884a4961b41d6e0881cafcad8cf1934075", "url": "https://github.com/apache/hadoop/commit/ba069d884a4961b41d6e0881cafcad8cf1934075", "message": "Fixing test cases", "committedDate": "2020-04-04T16:50:01Z", "type": "commit"}, {"oid": "a9769e603f6b609238b9135adb15c76b39675603", "url": "https://github.com/apache/hadoop/commit/a9769e603f6b609238b9135adb15c76b39675603", "message": "Removing unused annotation", "committedDate": "2020-04-04T17:00:09Z", "type": "commit"}, {"oid": "b5a00d329a1423059fff523784104bb78b960337", "url": "https://github.com/apache/hadoop/commit/b5a00d329a1423059fff523784104bb78b960337", "message": "Fixing imports", "committedDate": "2020-04-04T17:03:36Z", "type": "commit"}, {"oid": "322f778ac20dd3f1b84b66e1265ae1e32507b955", "url": "https://github.com/apache/hadoop/commit/322f778ac20dd3f1b84b66e1265ae1e32507b955", "message": "Improving test cases", "committedDate": "2020-04-05T13:46:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIxNzM1Nw==", "url": "https://github.com/apache/hadoop/pull/1938#discussion_r404217357", "bodyText": "if you pulled this out somewhere or made static you could have a unit test which would validate some of this", "author": "steveloughran", "createdAt": "2020-04-06T16:16:04Z", "path": "hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AbfsClient.java", "diffHunk": "@@ -679,32 +679,60 @@ public AuthType getAuthType() {\n \n   @VisibleForTesting\n   String initializeUserAgent(final AbfsConfiguration abfsConfiguration,\n-                             final String sslProviderName) {\n+      final String sslProviderName) {", "originalCommit": "322f778ac20dd3f1b84b66e1265ae1e32507b955", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAxMzUzMg==", "url": "https://github.com/apache/hadoop/pull/1938#discussion_r405013532", "bodyText": "There are test cases written to validate this as this method is package protected and with the @VisibleForTesting.", "author": "bilaharith", "createdAt": "2020-04-07T18:12:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIxNzM1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIyMDEwOQ==", "url": "https://github.com/apache/hadoop/pull/1938#discussion_r404220109", "bodyText": "can we have org.apache.hadoop.util.VersionInfo,getVersion() in there too? Lets people pin the blame on the logs", "author": "steveloughran", "createdAt": "2020-04-06T16:20:07Z", "path": "hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AbfsClient.java", "diffHunk": "@@ -679,32 +679,60 @@ public AuthType getAuthType() {\n \n   @VisibleForTesting\n   String initializeUserAgent(final AbfsConfiguration abfsConfiguration,\n-                             final String sslProviderName) {\n+      final String sslProviderName) {\n+\n     StringBuilder sb = new StringBuilder();\n-    sb.append(\"(JavaJRE \");\n+", "originalCommit": "322f778ac20dd3f1b84b66e1265ae1e32507b955", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAxNTAzMQ==", "url": "https://github.com/apache/hadoop/pull/1938#discussion_r405015031", "bodyText": "CLIENT_VERSION includes org.apache.hadoop.util.VersionInfo,getVersion()", "author": "bilaharith", "createdAt": "2020-04-07T18:14:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIyMDEwOQ=="}], "type": "inlineReview"}, {"oid": "a0a372837319fb5c562639c8cbcffe6b4e201878", "url": "https://github.com/apache/hadoop/commit/a0a372837319fb5c562639c8cbcffe6b4e201878", "message": "CheckStyle", "committedDate": "2020-04-13T19:32:59Z", "type": "commit"}]}