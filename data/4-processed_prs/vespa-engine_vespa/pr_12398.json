{"pr_number": 12398, "pr_title": "Always use container cluster ID as cluster ID for load balancers ", "pr_createdAt": "2020-03-02T12:11:02Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12398", "timeline": [{"oid": "8dc031111d0ec7ff77273a3a21e0f23c7d4aceca", "url": "https://github.com/vespa-engine/vespa/commit/8dc031111d0ec7ff77273a3a21e0f23c7d4aceca", "message": "Add combined ID to ClusterSpec", "committedDate": "2020-03-02T12:09:05Z", "type": "commit"}, {"oid": "f3a5ff31d84a112e29680b0c59ec03a815d06b5e", "url": "https://github.com/vespa-engine/vespa/commit/f3a5ff31d84a112e29680b0c59ec03a815d06b5e", "message": "Always use container ID as cluster ID for load balancers", "committedDate": "2020-03-02T12:09:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2NTkzOQ==", "url": "https://github.com/vespa-engine/vespa/pull/12398#discussion_r386365939", "bodyText": "During upgrade this will write a value with combined id that other instances that are not upgraded yet will not be able to read. Shouldn't we handle strings with combined id first and in a later version start writing it?", "author": "hmusum", "createdAt": "2020-03-02T12:33:44Z", "path": "config-provisioning/src/main/java/com/yahoo/config/provision/ClusterMembership.java", "diffHunk": "@@ -54,7 +59,8 @@ protected String toStringValue() {\n                (cluster.group().isPresent() ? \"/\" + cluster.group().get().index() : \"\") +\n                \"/\" + index +\n                ( cluster.isExclusive() ? \"/exclusive\" : \"\") +\n-               ( retired ? \"/retired\" : \"\");\n+               ( retired ? \"/retired\" : \"\") +\n+               ( cluster.combinedId().isPresent() ? \"/\" + cluster.combinedId().get().value() : \"\");", "originalCommit": "8dc031111d0ec7ff77273a3a21e0f23c7d4aceca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3MDc4Mw==", "url": "https://github.com/vespa-engine/vespa/pull/12398#discussion_r386370783", "bodyText": "Of course, thanks!", "author": "mpolden", "createdAt": "2020-03-02T12:44:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2NTkzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3Mjg3MQ==", "url": "https://github.com/vespa-engine/vespa/pull/12398#discussion_r386372871", "bodyText": "Actually, the existing code appears to handle this. It ignores trailing components of the serialized string that it does not explicitly handle.", "author": "mpolden", "createdAt": "2020-03-02T12:49:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2NTkzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3NzMxNQ==", "url": "https://github.com/vespa-engine/vespa/pull/12398#discussion_r386377315", "bodyText": "Yes, it might not be an issue here. As long as you don't need the combined id I guess that will work, but if you later rely upon this (e.g. in a later PR that goes in before this is released) something might break.", "author": "hmusum", "createdAt": "2020-03-02T12:59:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM2NTkzOQ=="}], "type": "inlineReview"}]}