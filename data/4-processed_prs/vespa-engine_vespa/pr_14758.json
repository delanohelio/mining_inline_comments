{"pr_number": 14758, "pr_title": "fast value to enable inlined sparse operations", "pr_createdAt": "2020-10-07T13:41:02Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/14758", "timeline": [{"oid": "0422bd14dd0ffb4d1a46ab5d4254e77c4fb0f7b0", "url": "https://github.com/vespa-engine/vespa/commit/0422bd14dd0ffb4d1a46ab5d4254e77c4fb0f7b0", "message": "fast value to enable inlined sparse operations\n\nuse full overlap sparse join as initial test of full inlining.\n\nalso improve simple sparse map performance by pre-calculating string\nhashes and using hash values for equality checks.", "committedDate": "2020-10-07T13:32:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTUwMjQ5NQ==", "url": "https://github.com/vespa-engine/vespa/pull/14758#discussion_r501502495", "bodyText": "dumping to stderr should be temporary", "author": "arnej27959", "createdAt": "2020-10-08T07:25:56Z", "path": "eval/src/tests/eval/simple_sparse_map/simple_sparse_map_test.cpp", "diffHunk": "@@ -55,10 +55,12 @@ TEST(SimpleSparseMapTest, simple_sparse_map_basic_usage_works) {\n     EXPECT_EQ(map.lookup(a4.direct_ref()), map.npos());\n     EXPECT_EQ(map.lookup(a4.indirect_ref()), map.npos());\n     EXPECT_EQ(SimpleSparseMap::npos(), map.npos());\n-    SL expect_labels({\"a\",\"a\",\"a\",\n-                      \"a\",\"a\",\"b\",\n-                      \"a\",\"b\",\"a\"});\n-    EXPECT_EQ(map.labels(), expect_labels.direct_str());\n+    EXPECT_EQ(map.labels().size(), 9);\n+    auto dump = [&](auto addr_tag, auto subspace, auto hash) {\n+        auto addr = map.make_addr(addr_tag);", "originalCommit": "0422bd14dd0ffb4d1a46ab5d4254e77c4fb0f7b0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}