{"pr_number": 15594, "pr_title": "Remove DistributorComponent trampoline member function.", "pr_createdAt": "2020-12-02T12:16:41Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/15594", "timeline": [{"oid": "1dd6bcf0478568cb01ce6192caafde7fcd8d1faf", "url": "https://github.com/vespa-engine/vespa/commit/1dd6bcf0478568cb01ce6192caafde7fcd8d1faf", "message": "Remove DistributorComponent trampoline member function.", "committedDate": "2020-12-02T12:08:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDEzNDM4OQ==", "url": "https://github.com/vespa-engine/vespa/pull/15594#discussion_r534134389", "bodyText": "Better than making the check_ownership_in_pending_and_current_state const and the map mutable ?\nNow you expose also the setXXX methods.", "author": "baldersheim", "createdAt": "2020-12-02T12:37:41Z", "path": "storage/src/vespa/storage/distributor/distributor_operation_context.h", "diffHunk": "@@ -23,15 +23,14 @@ class DistributorOperationContext {\n public:\n     virtual ~DistributorOperationContext() {}\n     virtual api::Timestamp generate_unique_timestamp() = 0;\n-    virtual BucketOwnership check_ownership_in_pending_and_current_state(const document::Bucket &bucket) const = 0;\n     virtual void update_bucket_database(const document::Bucket& bucket,\n                                         const BucketCopy& changed_node,\n                                         uint32_t update_flags = 0) = 0;\n     virtual void update_bucket_database(const document::Bucket& bucket,\n                                         const std::vector<BucketCopy>& changed_nodes,\n                                         uint32_t update_flags = 0) = 0;\n     virtual void remove_node_from_bucket_database(const document::Bucket& bucket, uint16_t node_index) = 0;\n-    virtual const DistributorBucketSpaceRepo& bucket_space_repo() const = 0;", "originalCommit": "1dd6bcf0478568cb01ce6192caafde7fcd8d1faf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f52796b5398f0b32037e4ab84a439d16c7ade9af", "url": "https://github.com/vespa-engine/vespa/commit/f52796b5398f0b32037e4ab84a439d16c7ade9af", "message": "Use mutable hash maps in DistributorBucketSpace.", "committedDate": "2020-12-02T12:45:49Z", "type": "commit"}, {"oid": "6a47eecdb9420cf39702e1b8245883763cba3849", "url": "https://github.com/vespa-engine/vespa/commit/6a47eecdb9420cf39702e1b8245883763cba3849", "message": "Remove getIdealNodes() trampoline member function from DistributorComponent.", "committedDate": "2020-12-02T13:10:39Z", "type": "commit"}]}