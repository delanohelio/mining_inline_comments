{"pr_number": 15193, "pr_title": "Return empty map, not null from getReports()", "pr_createdAt": "2020-11-05T13:06:09Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/15193", "timeline": [{"oid": "f52db95ab8c851d38dc4fc737bcec337e67ccc01", "url": "https://github.com/vespa-engine/vespa/commit/f52db95ab8c851d38dc4fc737bcec337e67ccc01", "message": "Return empty map, not null from getReports()", "committedDate": "2020-11-05T13:05:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA0MDAzMQ==", "url": "https://github.com/vespa-engine/vespa/pull/15193#discussion_r518040031", "bodyText": "If NodeRepositoryNode will be used to serialize to JSON, I suggest adding a method\n@JsonGetter(\"reports\")\npublic Map<...> getReportsOrNull() { return reports; }\n\nthat will be used by jackson to serialize, while our code will typically refer to the getReports() to avoid having to deal with null.", "author": "hakonhall", "createdAt": "2020-11-05T13:13:36Z", "path": "controller-api/src/main/java/com/yahoo/vespa/hosted/controller/api/integration/noderepository/NodeRepositoryNode.java", "diffHunk": "@@ -357,8 +358,9 @@ public void setWantedFirmwareCheck(Long wantedFirmwareCheck) {\n         this.wantedFirmwareCheck = wantedFirmwareCheck;\n     }\n \n+    @JsonIgnore\n     public Map<String, JsonNode> getReports() {", "originalCommit": "f52db95ab8c851d38dc4fc737bcec337e67ccc01", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA0MTQzMQ==", "url": "https://github.com/vespa-engine/vespa/pull/15193#discussion_r518041431", "bodyText": "This would be in addition to the changes you've done in this PR so far.", "author": "hakonhall", "createdAt": "2020-11-05T13:15:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA0MDAzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA2Mjk2Mg==", "url": "https://github.com/vespa-engine/vespa/pull/15193#discussion_r518062962", "bodyText": "Not sure that I get what you mean. Should I revert getReports to its original state?", "author": "bjormel", "createdAt": "2020-11-05T13:48:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA0MDAzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA4ODA2MA==", "url": "https://github.com/vespa-engine/vespa/pull/15193#discussion_r518088060", "bodyText": "No, my proposed changes are in addition to the ones you have already done in this PR.", "author": "hakonhall", "createdAt": "2020-11-05T14:22:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA0MDAzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQxMzA1Mg==", "url": "https://github.com/vespa-engine/vespa/pull/15193#discussion_r518413052", "bodyText": "nice, the getter really saved me the null handling \ud83d\udc4d", "author": "bjormel", "createdAt": "2020-11-05T22:38:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA0MDAzMQ=="}], "type": "inlineReview"}, {"oid": "9deed987c08cce184ef2378415c118dbb49f3786", "url": "https://github.com/vespa-engine/vespa/commit/9deed987c08cce184ef2378415c118dbb49f3786", "message": "Added json getter method for reports", "committedDate": "2020-11-05T13:47:08Z", "type": "commit"}]}