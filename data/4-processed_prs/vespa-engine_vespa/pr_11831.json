{"pr_number": 11831, "pr_title": "Jvenstad/staging testup", "pr_createdAt": "2020-01-17T10:45:13Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/11831", "timeline": [{"oid": "bcb8b29b2d6690054f921bb2ebfbefa1fcfec1ec", "url": "https://github.com/vespa-engine/vespa/commit/bcb8b29b2d6690054f921bb2ebfbefa1fcfec1ec", "message": "Add StagingSetup annotation", "committedDate": "2020-01-16T14:19:51Z", "type": "commit"}, {"oid": "17cc18a0fe6a94f086d2d25d04f7d8a7030c85db", "url": "https://github.com/vespa-engine/vespa/commit/17cc18a0fe6a94f086d2d25d04f7d8a7030c85db", "message": "Run staging-setup tagged unit tests on initial staging deployment before upgrade", "committedDate": "2020-01-17T10:44:20Z", "type": "commit"}, {"oid": "af32b913879398868025c4d2462186d657feaf15", "url": "https://github.com/vespa-engine/vespa/commit/af32b913879398868025c4d2462186d657feaf15", "message": "Add missing StagingSetup.java file", "committedDate": "2020-01-17T11:28:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkyMzYyMA==", "url": "https://github.com/vespa-engine/vespa/pull/11831#discussion_r367923620", "bodyText": "These changes must roll out before any changes that writes such steps to ZK?", "author": "hakonhall", "createdAt": "2020-01-17T13:00:38Z", "path": "controller-server/src/main/java/com/yahoo/vespa/hosted/controller/persistence/RunSerializer.java", "diffHunk": "@@ -258,6 +262,8 @@ static Step stepOf(String step) {\n             case \"installTester\"      : return installTester;\n             case \"deactivateTester\"   : return deactivateTester;\n             case \"copyVespaLogs\"      : return copyVespaLogs;\n+            case \"startStagingSetup\"  : return startStagingSetup;", "originalCommit": "af32b913879398868025c4d2462186d657feaf15", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkzNzMwOA==", "url": "https://github.com/vespa-engine/vespa/pull/11831#discussion_r367937308", "bodyText": "Well, a non-upgraded controller will be unable to read (to modify or display) the run status for any staging test that has been started by an upgraded controller, until it upgrades itself. I don't think that's a major consequence.", "author": "jonmv", "createdAt": "2020-01-17T13:35:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkyMzYyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzk5ODQ4NQ==", "url": "https://github.com/vespa-engine/vespa/pull/11831#discussion_r367998485", "bodyText": "Of course you\u2019re right it\u2019s the right thing to do, but I\u2019m impatient and I don\u2019t think it\u2019ll be an actual problem here :P", "author": "jonmv", "createdAt": "2020-01-17T15:38:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkyMzYyMA=="}], "type": "inlineReview"}]}