{"pr_number": 12237, "pr_title": "Let only successful run expire due to age", "pr_createdAt": "2020-02-18T08:57:43Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12237", "timeline": [{"oid": "0e882b64b6cb94f49593619dcf27535e030c9100", "url": "https://github.com/vespa-engine/vespa/commit/0e882b64b6cb94f49593619dcf27535e030c9100", "message": "Let only successful run expire due to age\n\n@mpolden please review.\n\nThis fixes a problem where a NoSuchElementException was thrown when the\nonly run was a success, this expired, and a new run failed.\nThe solution is simply to throw away the success in this case, as we\nhave no logs for it anyway", "committedDate": "2020-02-18T08:57:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUzNjEyMg==", "url": "https://github.com/vespa-engine/vespa/pull/12237#discussion_r380536122", "bodyText": "To var or not to var, that is the question.", "author": "mpolden", "createdAt": "2020-02-18T09:02:46Z", "path": "controller-server/src/test/java/com/yahoo/vespa/hosted/controller/maintenance/JobRunnerTest.java", "diffHunk": "@@ -337,6 +337,25 @@ public void historyPruning() {\n         assertFalse(jobs.firstFailing(jobId).isPresent());\n     }\n \n+    @Test\n+    public void onlySuccessfulRunExpiresThenAnotherFails() {\n+        DeploymentTester tester = new DeploymentTester();\n+        JobController jobs = tester.controller().jobController();", "originalCommit": "0e882b64b6cb94f49593619dcf27535e030c9100", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU5NzM5Ng==", "url": "https://github.com/vespa-engine/vespa/pull/12237#discussion_r380597396", "bodyText": "Yeah, I'm not settled on that one yet :)", "author": "jonmv", "createdAt": "2020-02-18T10:51:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDUzNjEyMg=="}], "type": "inlineReview"}]}