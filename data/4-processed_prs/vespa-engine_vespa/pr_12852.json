{"pr_number": 12852, "pr_title": "Call failed handler for io error on non-linux platform.", "pr_createdAt": "2020-04-06T13:01:55Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12852", "timeline": [{"oid": "004a355bf27d3edd82571dd0d086f7939e108df6", "url": "https://github.com/vespa-engine/vespa/commit/004a355bf27d3edd82571dd0d086f7939e108df6", "message": "Call failed handler for io error on non-linux platform.", "committedDate": "2020-04-06T12:54:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA4NDU2OA==", "url": "https://github.com/vespa-engine/vespa/pull/12852#discussion_r404084568", "bodyText": "should it be \"pread\" ?", "author": "baldersheim", "createdAt": "2020-04-06T13:21:04Z", "path": "fastos/src/vespa/fastos/unix_file.cpp", "diffHunk": "@@ -58,6 +72,12 @@ void FastOS_UNIX_File::ReadBuf(void *buffer, size_t length,\n     ssize_t readResult;\n \n     readResult = pread(_filedes, buffer, length, readOffset);\n+    if (readResult < 0 && _failedHandler != nullptr) {\n+        int error = errno;\n+        const char *fileName = GetFileName();\n+        _failedHandler(\"read\", fileName, error, readOffset, length, readResult);", "originalCommit": "004a355bf27d3edd82571dd0d086f7939e108df6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA5NjA2NA==", "url": "https://github.com/vespa-engine/vespa/pull/12852#discussion_r404096064", "bodyText": "This reflects how it is done on linux and what the ioerrorhandler unit test expects.\nThe error reporting does not differentiate between pread and read, nor between pwrite and write.", "author": "toregge", "createdAt": "2020-04-06T13:37:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA4NDU2OA=="}], "type": "inlineReview"}]}