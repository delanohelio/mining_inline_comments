{"pr_number": 14242, "pr_title": "Configure compression and chunk size", "pr_createdAt": "2020-09-02T10:51:05Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/14242", "timeline": [{"oid": "aef40155b80cef617828af4895c0bec1c733b4e5", "url": "https://github.com/vespa-engine/vespa/commit/aef40155b80cef617828af4895c0bec1c733b4e5", "message": "Configure compression and chunk size", "committedDate": "2020-09-02T10:28:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk4Mzk1OA==", "url": "https://github.com/vespa-engine/vespa/pull/14242#discussion_r481983958", "bodyText": "Get crc method from _encoding ?", "author": "toregge", "createdAt": "2020-09-02T11:02:08Z", "path": "searchlib/src/vespa/searchlib/transactionlog/domainpart.cpp", "diffHunk": "@@ -582,12 +602,12 @@ DomainPart::write(FastOS_FileInterface &file, const Packet::Entry &entry)\n     int32_t crc(0);\n     uint32_t len(entry.serializedSize() + sizeof(crc));\n     nbostream os;\n-    os << static_cast<uint8_t>(_defaultCrc);\n+    os << static_cast<uint8_t>(Crc::xxh64);", "originalCommit": "aef40155b80cef617828af4895c0bec1c733b4e5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAwNzAzMw==", "url": "https://github.com/vespa-engine/vespa/pull/14242#discussion_r482007033", "bodyText": "Fixed", "author": "baldersheim", "createdAt": "2020-09-02T11:47:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk4Mzk1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk4NDExOA==", "url": "https://github.com/vespa-engine/vespa/pull/14242#discussion_r481984118", "bodyText": "Get crc method from _encoding ?", "author": "toregge", "createdAt": "2020-09-02T11:02:30Z", "path": "searchlib/src/vespa/searchlib/transactionlog/domainpart.cpp", "diffHunk": "@@ -582,12 +602,12 @@ DomainPart::write(FastOS_FileInterface &file, const Packet::Entry &entry)\n     int32_t crc(0);\n     uint32_t len(entry.serializedSize() + sizeof(crc));\n     nbostream os;\n-    os << static_cast<uint8_t>(_defaultCrc);\n+    os << static_cast<uint8_t>(Crc::xxh64);\n     os << len;\n     size_t start(os.size());\n     entry.serialize(os);\n     size_t end(os.size());\n-    crc = calcCrc(_defaultCrc, os.data() + start, end - start);\n+    crc = calcCrc(Crc::xxh64, os.data() + start, end - start);", "originalCommit": "aef40155b80cef617828af4895c0bec1c733b4e5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAwNjkzOQ==", "url": "https://github.com/vespa-engine/vespa/pull/14242#discussion_r482006939", "bodyText": "Fixed", "author": "baldersheim", "createdAt": "2020-09-02T11:46:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk4NDExOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk4NDgyOA==", "url": "https://github.com/vespa-engine/vespa/pull/14242#discussion_r481984828", "bodyText": "Remove unneeded space ?", "author": "toregge", "createdAt": "2020-09-02T11:03:59Z", "path": "searchlib/src/vespa/searchlib/transactionlog/translogserverapp.cpp", "diffHunk": "@@ -24,28 +25,72 @@ TransLogServerApp::TransLogServerApp(const config::ConfigUri & tlsConfigUri,\n \n namespace {\n \n-DomainPart::Crc\n+Encoding::Crc\n getCrc(searchlib::TranslogserverConfig::Crcmethod crcType)\n {\n     switch (crcType) {\n         case searchlib::TranslogserverConfig::Crcmethod::ccitt_crc32:\n-            return DomainPart::ccitt_crc32;\n+            return Encoding::Crc::ccitt_crc32;\n         case searchlib::TranslogserverConfig::Crcmethod::xxh64:\n-            return DomainPart::xxh64;\n+            return Encoding::Crc ::xxh64;", "originalCommit": "aef40155b80cef617828af4895c0bec1c733b4e5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjAwNjgyOA==", "url": "https://github.com/vespa-engine/vespa/pull/14242#discussion_r482006828", "bodyText": "Fixed", "author": "baldersheim", "createdAt": "2020-09-02T11:46:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTk4NDgyOA=="}], "type": "inlineReview"}, {"oid": "7c95498434b1540b51e359094d46997dc9602b0d", "url": "https://github.com/vespa-engine/vespa/commit/7c95498434b1540b51e359094d46997dc9602b0d", "message": "- Use _encoding.\n- Add explicit to avoid dangerous auto conversion.", "committedDate": "2020-09-02T11:45:29Z", "type": "commit"}]}