{"pr_number": 14867, "pr_title": "vespalib::Monitor -> std:.mutex/std::condition_variable", "pr_createdAt": "2020-10-14T14:24:05Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/14867", "timeline": [{"oid": "c127fb84883687fc184c0eafeb2ebb8e9073cc7a", "url": "https://github.com/vespa-engine/vespa/commit/c127fb84883687fc184c0eafeb2ebb8e9073cc7a", "message": "vespalib::Monitor -> std:.mutex/std::condition_variable", "committedDate": "2020-10-14T14:21:01Z", "type": "commit"}, {"oid": "cbaed757c8163d4853ba91d7a91bd17be32ca23e", "url": "https://github.com/vespa-engine/vespa/commit/cbaed757c8163d4853ba91d7a91bd17be32ca23e", "message": "GC unused include", "committedDate": "2020-10-14T14:30:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcyNTE0MA==", "url": "https://github.com/vespa-engine/vespa/pull/14867#discussion_r504725140", "bodyText": "prefer signal while holding lock unless very special conditions", "author": "havardpe", "createdAt": "2020-10-14T14:30:02Z", "path": "vbench/src/vbench/core/handler_thread.hpp", "diffHunk": "@@ -58,10 +59,10 @@ void\n HandlerThread<T>::join()\n {\n     {\n-        vespalib::MonitorGuard guard(_monitor);\n+        std::lock_guard guard(_lock);\n         _done = true;\n-        guard.signal();\n     }\n+    _cond.notify_one();", "originalCommit": "c127fb84883687fc184c0eafeb2ebb8e9073cc7a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDczMjU4NQ==", "url": "https://github.com/vespa-engine/vespa/pull/14867#discussion_r504732585", "bodyText": "Done.", "author": "baldersheim", "createdAt": "2020-10-14T14:39:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcyNTE0MA=="}], "type": "inlineReview"}, {"oid": "ee0846129f1275d8084891c123c9ea9cd7cc1c01", "url": "https://github.com/vespa-engine/vespa/commit/ee0846129f1275d8084891c123c9ea9cd7cc1c01", "message": "Hold lock when signaling", "committedDate": "2020-10-14T14:37:09Z", "type": "commit"}]}