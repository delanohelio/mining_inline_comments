{"pr_number": 14782, "pr_title": "Ensure we really wait until operation is complete.", "pr_createdAt": "2020-10-08T12:04:19Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/14782", "timeline": [{"oid": "f0de1d6106d9de4235d39d65afb39ecb5f71e4f7", "url": "https://github.com/vespa-engine/vespa/commit/f0de1d6106d9de4235d39d65afb39ecb5f71e4f7", "message": "Ensure we really wait until operation is complete.", "committedDate": "2020-10-08T12:02:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcwMjM1Mw==", "url": "https://github.com/vespa-engine/vespa/pull/14782#discussion_r501702353", "bodyText": "Consider adding mutable specifier to the lambda expression.", "author": "toregge", "createdAt": "2020-10-08T13:03:27Z", "path": "searchcore/src/tests/proton/documentdb/feedview/feedview_test.cpp", "diffHunk": "@@ -594,7 +594,8 @@ struct FixtureBase\n     void putAndWait(const DocumentContext &docCtx) {\n         FeedTokenContext token(_tracer);\n         PutOperation op(docCtx.bid, docCtx.ts, docCtx.doc);\n-        runInMaster([&] () { performPut(token.ft, op); });\n+        runInMaster([this, ft=std::move(token.ft), &op] () { performPut(std::move(ft), op); });", "originalCommit": "f0de1d6106d9de4235d39d65afb39ecb5f71e4f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcxMzg3MQ==", "url": "https://github.com/vespa-engine/vespa/pull/14782#discussion_r501713871", "bodyText": "Fixed", "author": "baldersheim", "createdAt": "2020-10-08T13:19:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcwMjM1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcwMjQ5MQ==", "url": "https://github.com/vespa-engine/vespa/pull/14782#discussion_r501702491", "bodyText": "Consider adding mutable specifier to the lambda expression.", "author": "toregge", "createdAt": "2020-10-08T13:03:39Z", "path": "searchcore/src/tests/proton/documentdb/feedview/feedview_test.cpp", "diffHunk": "@@ -606,7 +607,8 @@ struct FixtureBase\n     void updateAndWait(const DocumentContext &docCtx) {\n         FeedTokenContext token(_tracer);\n         UpdateOperation op(docCtx.bid, docCtx.ts, docCtx.upd);\n-        runInMaster([&] () { performUpdate(token.ft, op); });\n+        runInMaster([this, ft=std::move(token.ft), &op] () { performUpdate(std::move(ft), op); });", "originalCommit": "f0de1d6106d9de4235d39d65afb39ecb5f71e4f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcxNDEyMQ==", "url": "https://github.com/vespa-engine/vespa/pull/14782#discussion_r501714121", "bodyText": "Fixed", "author": "baldersheim", "createdAt": "2020-10-08T13:20:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcwMjQ5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcwMjY0MQ==", "url": "https://github.com/vespa-engine/vespa/pull/14782#discussion_r501702641", "bodyText": "Consider adding mutable specifier to the lambda expression.", "author": "toregge", "createdAt": "2020-10-08T13:03:52Z", "path": "searchcore/src/tests/proton/documentdb/feedview/feedview_test.cpp", "diffHunk": "@@ -620,7 +622,8 @@ struct FixtureBase\n     void removeAndWait(const DocumentContext &docCtx) {\n         FeedTokenContext token(_tracer);\n         RemoveOperationWithDocId op(docCtx.bid, docCtx.ts, docCtx.doc->getId());\n-        runInMaster([&] () { performRemove(token.ft, op); });\n+        runInMaster([this, ft=std::move(token.ft), &op] () { performRemove(std::move(ft), op); });", "originalCommit": "f0de1d6106d9de4235d39d65afb39ecb5f71e4f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcxMzk5Ng==", "url": "https://github.com/vespa-engine/vespa/pull/14782#discussion_r501713996", "bodyText": "Fixed", "author": "baldersheim", "createdAt": "2020-10-08T13:19:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTcwMjY0MQ=="}], "type": "inlineReview"}, {"oid": "26aeb923d8636d8a17dfc89ff56d933efa9ab076", "url": "https://github.com/vespa-engine/vespa/commit/26aeb923d8636d8a17dfc89ff56d933efa9ab076", "message": "Add mutable for move to work as expected", "committedDate": "2020-10-08T13:19:26Z", "type": "commit"}]}