{"pr_number": 13717, "pr_title": "Support sharedl4 routing in manually deployed zones", "pr_createdAt": "2020-06-26T07:39:45Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/13717", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMDk2MQ==", "url": "https://github.com/vespa-engine/vespa/pull/13717#discussion_r446020961", "bodyText": "\"zone supports\"?", "author": "mpolden", "createdAt": "2020-06-26T07:42:29Z", "path": "controller-server/src/test/java/com/yahoo/vespa/hosted/controller/ControllerTest.java", "diffHunk": "@@ -633,6 +637,14 @@ public void testDevDeployment() {\n         assertTrue(\"No job status added\",\n                    context.instanceJobs().isEmpty());\n         assertEquals(\"DeploymentSpec is not persisted\", DeploymentSpec.empty, context.application().deploymentSpec());\n+\n+        // Verify routingMethod supports shared layer 4 and shared", "originalCommit": "0883aa3cc312c3be8b2a8171522af5cbe56abfc9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAyMTg4OQ==", "url": "https://github.com/vespa-engine/vespa/pull/13717#discussion_r446021889", "bodyText": "Isn't this equivalent to assertEquals(Set.of(RoutingMethod.shared, RoutingMethod.sharedLayer4), routingMethods)?", "author": "mpolden", "createdAt": "2020-06-26T07:44:21Z", "path": "controller-server/src/test/java/com/yahoo/vespa/hosted/controller/ControllerTest.java", "diffHunk": "@@ -633,6 +637,14 @@ public void testDevDeployment() {\n         assertTrue(\"No job status added\",\n                    context.instanceJobs().isEmpty());\n         assertEquals(\"DeploymentSpec is not persisted\", DeploymentSpec.empty, context.application().deploymentSpec());\n+\n+        // Verify routingMethod supports shared layer 4 and shared\n+        Set<RoutingMethod> routingMethods = tester.controller().routing().endpointsOf(context.deploymentIdIn(zone))\n+                .asList()\n+                .stream()\n+                .map(Endpoint::routingMethod)\n+                .collect(Collectors.toSet());\n+        assertThat(routingMethods, IsIterableContainingInAnyOrder.containsInAnyOrder(RoutingMethod.shared, RoutingMethod.sharedLayer4));", "originalCommit": "0883aa3cc312c3be8b2a8171522af5cbe56abfc9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3aca539b25a75c405c2264c085fa8a56c84fd83e", "url": "https://github.com/vespa-engine/vespa/commit/3aca539b25a75c405c2264c085fa8a56c84fd83e", "message": "Support sharedl4 routing in manually deployed zones", "committedDate": "2020-06-26T07:48:51Z", "type": "commit"}, {"oid": "3aca539b25a75c405c2264c085fa8a56c84fd83e", "url": "https://github.com/vespa-engine/vespa/commit/3aca539b25a75c405c2264c085fa8a56c84fd83e", "message": "Support sharedl4 routing in manually deployed zones", "committedDate": "2020-06-26T07:48:51Z", "type": "forcePushed"}]}