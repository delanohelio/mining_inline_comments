{"pr_number": 15533, "pr_title": "renumber Peek children, the sequel", "pr_createdAt": "2020-11-30T11:40:46Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/15533", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU1Njg3OA==", "url": "https://github.com/vespa-engine/vespa/pull/15533#discussion_r532556878", "bodyText": "should no longer normalize here, since it is done in eval_node instead", "author": "havardpe", "createdAt": "2020-11-30T12:20:58Z", "path": "eval/src/vespa/eval/eval/test/reference_evaluation.cpp", "diffHunk": "@@ -135,7 +130,7 @@ struct EvalNode : public NodeVisitor {\n                 }\n             }\n         }\n-        result = ReferenceOperations::peek(param, spec, children).normalize();\n+        result = ReferenceOperations::peek(spec, children).normalize();", "originalCommit": "4c12600e5f86cdcd8ae66f88dc3ad5b0f383ceca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU4OTU0Ng==", "url": "https://github.com/vespa-engine/vespa/pull/15533#discussion_r532589546", "bodyText": "fixed by rebasing and resolving conflicts", "author": "arnej27959", "createdAt": "2020-11-30T13:18:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU1Njg3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU1NzI1Mw==", "url": "https://github.com/vespa-engine/vespa/pull/15533#discussion_r532557253", "bodyText": "should also check for empty children", "author": "havardpe", "createdAt": "2020-11-30T12:21:40Z", "path": "eval/src/vespa/eval/eval/test/reference_operations.cpp", "diffHunk": "@@ -175,14 +175,15 @@ TensorSpec ReferenceOperations::merge(const TensorSpec &a, const TensorSpec &b,\n }\n \n \n-TensorSpec ReferenceOperations::peek(const TensorSpec &param, const PeekSpec &peek_spec, const std::vector<TensorSpec> &children) {\n+TensorSpec ReferenceOperations::peek(const PeekSpec &peek_spec, const std::vector<TensorSpec> &children) {\n     if (peek_spec.empty()) {", "originalCommit": "4c12600e5f86cdcd8ae66f88dc3ad5b0f383ceca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU4OTY3Mg==", "url": "https://github.com/vespa-engine/vespa/pull/15533#discussion_r532589672", "bodyText": "fixed", "author": "arnej27959", "createdAt": "2020-11-30T13:18:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU1NzI1Mw=="}], "type": "inlineReview"}, {"oid": "c65ddeb8386bda44c33324a3f6e8950a817ad46d", "url": "https://github.com/vespa-engine/vespa/commit/c65ddeb8386bda44c33324a3f6e8950a817ad46d", "message": "renumber Peek children, the sequel\n\n* change the ReferenceOperations peek API also, putting\n  the input parameter as the first child, and numbering\n  child indexes in the Spec starting at 1.", "committedDate": "2020-11-30T13:16:19Z", "type": "commit"}, {"oid": "582f6150b046e5563a3870011cd399deeabb2932", "url": "https://github.com/vespa-engine/vespa/commit/582f6150b046e5563a3870011cd399deeabb2932", "message": "also check for empty children", "committedDate": "2020-11-30T13:16:28Z", "type": "commit"}, {"oid": "582f6150b046e5563a3870011cd399deeabb2932", "url": "https://github.com/vespa-engine/vespa/commit/582f6150b046e5563a3870011cd399deeabb2932", "message": "also check for empty children", "committedDate": "2020-11-30T13:16:28Z", "type": "forcePushed"}]}