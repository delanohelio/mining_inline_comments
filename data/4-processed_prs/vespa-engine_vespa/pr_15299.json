{"pr_number": 15299, "pr_title": "Set state for session instead of deleting it when deleting an applica\u2026", "pr_createdAt": "2020-11-11T18:46:04Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/15299", "timeline": [{"oid": "1058c29a273a41eba74eae6928ca27ebe157484e", "url": "https://github.com/vespa-engine/vespa/commit/1058c29a273a41eba74eae6928ca27ebe157484e", "message": "Set state for session instead of deleting it when deleting an application\n\nSimplify by just setting the state of the active session belonging to an\napplication that is deleted. This is more in line with what we do for other\ntransitions.\n\nInactive sessions will be deleted nby maintainers in config server after\nsome time", "committedDate": "2020-11-11T18:45:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTg5MDI2NQ==", "url": "https://github.com/vespa-engine/vespa/pull/15299#discussion_r521890265", "bodyText": "Doing nothing on DELETE means we must be sure the DEACTIVATE has already been acted upon, and the session deactivated. How can we be sure this is the case here?", "author": "jonmv", "createdAt": "2020-11-12T07:33:37Z", "path": "configserver/src/main/java/com/yahoo/vespa/config/server/session/SessionStateWatcher.java", "diffHunk": "@@ -48,6 +48,7 @@ private synchronized void sessionStatusChanged(Status newStatus) {\n         switch (newStatus) {\n             case NEW:\n             case NONE:\n+            case DELETE:", "originalCommit": "1058c29a273a41eba74eae6928ca27ebe157484e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTg5MzE0Mg==", "url": "https://github.com/vespa-engine/vespa/pull/15299#discussion_r521893142", "bodyText": "Thanks for reminding me, that was the one thing I was thinking \"that needs to be done as well\" and the reason for the \"DO NOT MERGE\", but had forgotten about today.", "author": "hmusum", "createdAt": "2020-11-12T07:39:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTg5MDI2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTkxMDYwMA==", "url": "https://github.com/vespa-engine/vespa/pull/15299#discussion_r521910600", "bodyText": "Fixed", "author": "hmusum", "createdAt": "2020-11-12T08:13:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTg5MDI2NQ=="}], "type": "inlineReview"}, {"oid": "ce5870730b3606ed10a92d2beac90226a36b39d9", "url": "https://github.com/vespa-engine/vespa/commit/ce5870730b3606ed10a92d2beac90226a36b39d9", "message": "Deactivate session when session status is DELETE", "committedDate": "2020-11-12T08:13:00Z", "type": "commit"}]}