{"pr_number": 15524, "pr_title": "Balder/added throughput mode", "pr_createdAt": "2020-11-29T21:52:47Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/15524", "timeline": [{"oid": "34d64875c38d2a8049a70f0bdf9d7fcc3ce16ef8", "url": "https://github.com/vespa-engine/vespa/commit/34d64875c38d2a8049a70f0bdf9d7fcc3ce16ef8", "message": "Use std::make_unique and hide actual ThreadExecutor implementation.", "committedDate": "2020-11-29T21:31:32Z", "type": "commit"}, {"oid": "12275ab8fb1f83935ba2a4ab2f7a72bd262cbcf3", "url": "https://github.com/vespa-engine/vespa/commit/12275ab8fb1f83935ba2a4ab2f7a72bd262cbcf3", "message": "Allow to optimize for throughput over latency. Wakeup is extremely expensive.", "committedDate": "2020-11-29T21:32:15Z", "type": "commit"}, {"oid": "8d4eb868704b3374c937f354f30533b174edb4fe", "url": "https://github.com/vespa-engine/vespa/commit/8d4eb868704b3374c937f354f30533b174edb4fe", "message": "In ADAPTIVE mode a wakeup will be done with 100 packets ready for write.", "committedDate": "2020-11-29T21:48:12Z", "type": "commit"}, {"oid": "32065b5a38dcad1a7c30d89509ee9be02ad5373d", "url": "https://github.com/vespa-engine/vespa/commit/32065b5a38dcad1a7c30d89509ee9be02ad5373d", "message": "Simplify and use a single events_before_wakup number in the transport thread for controlling wakeup frequency.", "committedDate": "2020-11-30T11:21:19Z", "type": "commit"}, {"oid": "7481d52c6ce19da5efa9435a5e57a5b25beb232a", "url": "https://github.com/vespa-engine/vespa/commit/7481d52c6ce19da5efa9435a5e57a5b25beb232a", "message": "We must keep the handling in the selector still.", "committedDate": "2020-11-30T11:52:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU0OTA4OQ==", "url": "https://github.com/vespa-engine/vespa/pull/15524#discussion_r532549089", "bodyText": "consider protecting against 0", "author": "havardpe", "createdAt": "2020-11-30T12:06:35Z", "path": "fnet/src/vespa/fnet/transport.h", "diffHunk": "@@ -53,6 +53,11 @@ class FNET_Transport\n         : FNET_Transport(vespalib::AsyncResolver::get_shared(), vespalib::CryptoEngine::get_default(), 1) {}\n     ~FNET_Transport();\n \n+    size_t events_before_wakeup() const { return _events_before_wakeup; }\n+    void events_before_wakeup(size_t events_before_wakeup_in) {\n+        _events_before_wakeup = events_before_wakeup_in;", "originalCommit": "7481d52c6ce19da5efa9435a5e57a5b25beb232a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU4NTM0MA==", "url": "https://github.com/vespa-engine/vespa/pull/15524#discussion_r532585340", "bodyText": "I have another PR cooking that redoes config propagation. It is covered there.", "author": "baldersheim", "createdAt": "2020-11-30T13:11:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjU0OTA4OQ=="}], "type": "inlineReview"}, {"oid": "a471ab72a468ccc51390d232275df6ef5fdf8f1b", "url": "https://github.com/vespa-engine/vespa/commit/a471ab72a468ccc51390d232275df6ef5fdf8f1b", "message": "Rename handle_wakeup -> handle_wakeup_events and leave an empty handle_wakeup to satisfy selector callback api.", "committedDate": "2020-11-30T13:09:26Z", "type": "commit"}]}