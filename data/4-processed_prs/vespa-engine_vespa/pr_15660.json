{"pr_number": 15660, "pr_title": "Use std::to_chars for int to string conversion.", "pr_createdAt": "2020-12-04T09:54:23Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/15660", "timeline": [{"oid": "275ac97c80b786958962c77bdd6cc731bce87872", "url": "https://github.com/vespa-engine/vespa/commit/275ac97c80b786958962c77bdd6cc731bce87872", "message": "Use std::to_chars for int to string conversion.", "committedDate": "2020-12-04T09:45:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk4NjU3Mw==", "url": "https://github.com/vespa-engine/vespa/pull/15660#discussion_r535986573", "bodyText": "consider checking ec to avoid returning unspecified results.", "author": "havardpe", "createdAt": "2020-12-04T10:12:41Z", "path": "searchlib/src/vespa/searchlib/attribute/integerbase.cpp", "diffHunk": "@@ -49,18 +59,19 @@ uint32_t IntegerAttribute::get(DocId doc, WeightedConstChar * v, uint32_t sz) co\n }\n const char *\n IntegerAttribute::getString(DocId doc, char * s, size_t sz) const {\n-    largeint_t v = getInt(doc);\n-    snprintf(s, sz, \"%\" PRId64, v);\n+    if (sz > 1) {\n+        largeint_t v = getInt(doc);\n+        auto res = std::to_chars(s, s + sz - 1, v, 10);\n+        res.ptr[0] = 0;", "originalCommit": "275ac97c80b786958962c77bdd6cc731bce87872", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjAxNzEwNQ==", "url": "https://github.com/vespa-engine/vespa/pull/15660#discussion_r536017105", "bodyText": "Fixed", "author": "baldersheim", "createdAt": "2020-12-04T11:01:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTk4NjU3Mw=="}], "type": "inlineReview"}, {"oid": "93f496fe7fa9ddd76821d15b99c6974b78f15af0", "url": "https://github.com/vespa-engine/vespa/commit/93f496fe7fa9ddd76821d15b99c6974b78f15af0", "message": "If there is error return an empty string.", "committedDate": "2020-12-04T11:00:35Z", "type": "commit"}]}