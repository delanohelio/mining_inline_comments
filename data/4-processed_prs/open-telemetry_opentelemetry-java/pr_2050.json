{"pr_number": 2050, "pr_title": "Update the zipkin exporter Span Status handling", "pr_createdAt": "2020-11-10T04:34:00Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/2050", "timeline": [{"oid": "0c4277db327704e1391df5a1cfd707e7c424a4b6", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/0c4277db327704e1391df5a1cfd707e7c424a4b6", "message": "Update the zipkin exporter Span Status handling", "committedDate": "2020-11-10T04:33:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDI5Nzc2Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2050#discussion_r520297763", "bodyText": "Don't believe status can actually be null, if it can we should fix it to return unset in such cases in a separate PR.", "author": "anuraaga", "createdAt": "2020-11-10T05:33:18Z", "path": "exporters/zipkin/src/main/java/io/opentelemetry/exporter/zipkin/ZipkinSpanExporter.java", "diffHunk": "@@ -141,7 +141,9 @@ static Span generateSpan(SpanData spanData, Endpoint localEndpoint) {\n         });\n     SpanData.Status status = spanData.getStatus();\n     // for GRPC spans, include status code & description.\n-    if (status != null && spanAttributes.get(SemanticAttributes.RPC_SERVICE) != null) {\n+    if (status != null", "originalCommit": "0c4277db327704e1391df5a1cfd707e7c424a4b6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDI5ODA2OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2050#discussion_r520298069", "bodyText": "I'm reading the attached issue https://github.com/open-telemetry/opentelemetry-specification/pull/1186/files and can't find anything about this check, can you point me at it? IIUC we're supposed to set status even if not rpc.", "author": "anuraaga", "createdAt": "2020-11-10T05:34:23Z", "path": "exporters/zipkin/src/main/java/io/opentelemetry/exporter/zipkin/ZipkinSpanExporter.java", "diffHunk": "@@ -141,7 +141,9 @@ static Span generateSpan(SpanData spanData, Endpoint localEndpoint) {\n         });\n     SpanData.Status status = spanData.getStatus();\n     // for GRPC spans, include status code & description.\n-    if (status != null && spanAttributes.get(SemanticAttributes.RPC_SERVICE) != null) {\n+    if (status != null\n+        && !status.isUnset()\n+        && spanAttributes.get(SemanticAttributes.RPC_SERVICE) != null) {", "originalCommit": "0c4277db327704e1391df5a1cfd707e7c424a4b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDMzNzczNQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2050#discussion_r520337735", "bodyText": "can't find anything about this check\n\nSo do I\nCan you help to confirm this? @Oberon00", "author": "dengliming", "createdAt": "2020-11-10T07:12:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDI5ODA2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ5NzY2Mg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2050#discussion_r521497662", "bodyText": "This was definitely a holdover from when the statuses were so closely aligned with the GRPC status codes. Should be fine, I would think, to remove it. \ud83d\udc4d", "author": "jkwatson", "createdAt": "2020-11-11T16:53:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDI5ODA2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUwNjMxMg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2050#discussion_r521506312", "bodyText": "Thanks. It was removed.", "author": "dengliming", "createdAt": "2020-11-11T17:06:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDI5ODA2OQ=="}], "type": "inlineReview"}, {"oid": "d6c405e079c64d3ef8ae395a5950d89e3d44c4a1", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/d6c405e079c64d3ef8ae395a5950d89e3d44c4a1", "message": "Fix review", "committedDate": "2020-11-11T16:35:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ5OTM0OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2050#discussion_r521499348", "bodyText": "yes, status cannot be null here, so this extra check can be removed.", "author": "jkwatson", "createdAt": "2020-11-11T16:56:05Z", "path": "exporters/zipkin/src/main/java/io/opentelemetry/exporter/zipkin/ZipkinSpanExporter.java", "diffHunk": "@@ -140,8 +139,8 @@ static Span generateSpan(SpanData spanData, Endpoint localEndpoint) {\n           }\n         });\n     SpanData.Status status = spanData.getStatus();\n-    // for GRPC spans, include status code & description.\n-    if (status != null && spanAttributes.get(SemanticAttributes.RPC_SERVICE) != null) {\n+    // include status code & description.\n+    if (status != null && !status.isUnset()) {", "originalCommit": "d6c405e079c64d3ef8ae395a5950d89e3d44c4a1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5d7c63eddee32efc78839052ffad3945813836b1", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/5d7c63eddee32efc78839052ffad3945813836b1", "message": "Remove unneeded check null", "committedDate": "2020-11-11T17:04:45Z", "type": "commit"}]}