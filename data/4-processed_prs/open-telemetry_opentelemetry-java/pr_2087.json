{"pr_number": 2087, "pr_title": "Report BatchSpanProcessor current queue size", "pr_createdAt": "2020-11-17T22:40:17Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/2087", "timeline": [{"oid": "01e557a5261f49d209ac70f0d6d92ef8e0349352", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/01e557a5261f49d209ac70f0d6d92ef8e0349352", "message": "Report BatchSpanProcessor current queue size\n\nSigned-off-by: Ruben Vargas <ruben.vp8510@gmail.com>", "committedDate": "2020-11-17T23:16:20Z", "type": "commit"}, {"oid": "01e557a5261f49d209ac70f0d6d92ef8e0349352", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/01e557a5261f49d209ac70f0d6d92ef8e0349352", "message": "Report BatchSpanProcessor current queue size\n\nSigned-off-by: Ruben Vargas <ruben.vp8510@gmail.com>", "committedDate": "2020-11-17T23:16:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYwNDgwNQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2087#discussion_r525604805", "bodyText": "This makes me think that we should have both the class name and the key be static fields of the Worker class, since we use them quite a bit. What do you think about making that simple refactoring?", "author": "jkwatson", "createdAt": "2020-11-17T23:59:11Z", "path": "sdk/tracing/src/main/java/io/opentelemetry/sdk/trace/export/BatchSpanProcessor.java", "diffHunk": "@@ -187,6 +195,11 @@ private Worker(\n       this.exporterTimeoutMillis = exporterTimeoutMillis;\n       this.queue = queue;\n       this.batch = new ArrayList<>(this.maxExportBatchSize);\n+      spansInQueue.setCallback(\n+          result ->\n+              result.observe(\n+                  queue.size(),\n+                  Labels.of(\"spanProcessorType\", BatchSpanProcessor.class.getSimpleName())));", "originalCommit": "01e557a5261f49d209ac70f0d6d92ef8e0349352", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYyMzk2MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2087#discussion_r525623961", "bodyText": "+1 I'll do the change.", "author": "rubenvp8510", "createdAt": "2020-11-18T00:54:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYwNDgwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYzNTYwOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2087#discussion_r525635609", "bodyText": "Done.", "author": "rubenvp8510", "createdAt": "2020-11-18T01:29:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYwNDgwNQ=="}], "type": "inlineReview"}, {"oid": "0f7811663a759014dc5b1e5cbac06126e751d9ce", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/0f7811663a759014dc5b1e5cbac06126e751d9ce", "message": "class name and span processor label to static fields\n\nSigned-off-by: Ruben Vargas <ruben.vp8510@gmail.com>", "committedDate": "2020-11-18T01:48:33Z", "type": "commit"}, {"oid": "0f7811663a759014dc5b1e5cbac06126e751d9ce", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/0f7811663a759014dc5b1e5cbac06126e751d9ce", "message": "class name and span processor label to static fields\n\nSigned-off-by: Ruben Vargas <ruben.vp8510@gmail.com>", "committedDate": "2020-11-18T01:48:33Z", "type": "forcePushed"}]}