{"pr_number": 758, "pr_title": "Define constants for semantic convention attribute names", "pr_createdAt": "2020-01-15T13:50:27Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/758", "timeline": [{"oid": "b138c472509636acfcd69e01b27a3eb7e778c2df", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/b138c472509636acfcd69e01b27a3eb7e778c2df", "message": "Initial def of string constants for semantic convention span attribute names", "committedDate": "2020-01-15T13:47:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzEyMjAzNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r367122034", "bodyText": "Do we commit on these values to be 18-24 months backwards compatible? Maybe we should have a contrib package for this.\n@tedsuo @yurishkuro what is your experience with this?", "author": "bogdandrutu", "createdAt": "2020-01-15T21:41:54Z", "path": "api/src/main/java/io/opentelemetry/trace/SemanticConventions.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace;\n+\n+/**\n+ * Defines constants for all attribute names defined in the OpenTelemetry Semantic Conventions\n+ * specifications.\n+ *\n+ * @see <a\n+ *     href=\"https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/data-semantic-conventions.md\">Semantic\n+ *     Conventions</a>\n+ */\n+public final class SemanticConventions {", "originalCommit": "b138c472509636acfcd69e01b27a3eb7e778c2df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ1NTE0Nw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r378455147", "bodyText": "Ping @tedsuo and @yurishkuro", "author": "bogdandrutu", "createdAt": "2020-02-12T19:10:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzEyMjAzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMxNjUwNw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r379316507", "bodyText": "I think we should start treating semantic conventions more like an API definition (a contract between instrumentation writers and the back-end), so I'd love if we could guarantee at least 18-24 months compatibility.\nStill, like typed spans (#778), a contrib package seems fine (I'd rather have typed spans in the API than the string constants).", "author": "Oberon00", "createdAt": "2020-02-14T09:03:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzEyMjAzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAyMzIyNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r368023224", "bodyText": "Since these all apply to attributes, could we rename the class to SemanticAttributes?", "author": "tylerbenson", "createdAt": "2020-01-17T16:26:45Z", "path": "api/src/main/java/io/opentelemetry/trace/SemanticConventions.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace;\n+\n+/**\n+ * Defines constants for all attribute names defined in the OpenTelemetry Semantic Conventions\n+ * specifications.\n+ *\n+ * @see <a\n+ *     href=\"https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/data-semantic-conventions.md\">Semantic\n+ *     Conventions</a>\n+ */\n+public final class SemanticConventions {", "originalCommit": "b138c472509636acfcd69e01b27a3eb7e778c2df", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ1NTA0Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r378455046", "bodyText": "I think it is a good suggestion.", "author": "bogdandrutu", "createdAt": "2020-02-12T19:10:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAyMzIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ2OTYzNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r378469634", "bodyText": "I like SemanticAttributes more as well.", "author": "carlosalberto", "createdAt": "2020-02-12T19:37:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAyMzIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkyNTEwOA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r382925108", "bodyText": "Changed", "author": "kbrockhoff", "createdAt": "2020-02-22T16:40:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAyMzIyNA=="}], "type": "inlineReview"}, {"oid": "0a507a3dea5b5b07d8f10efb19d8ff123f43cbec", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/0a507a3dea5b5b07d8f10efb19d8ff123f43cbec", "message": "Merge branch 'master' into add-semantic-conventions-constants", "committedDate": "2020-02-22T16:19:40Z", "type": "commit"}, {"oid": "78e97fd34f635d9816cab001a1fd6635c0098347", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/78e97fd34f635d9816cab001a1fd6635c0098347", "message": "Change to recommended name and update to latest specifications", "committedDate": "2020-02-22T16:40:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkyOTcyMA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r382929720", "bodyText": "Please use full descriptions from the spec.", "author": "yurishkuro", "createdAt": "2020-02-22T17:54:50Z", "path": "api/src/main/java/io/opentelemetry/trace/SemanticAttributes.java", "diffHunk": "@@ -0,0 +1,95 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace;\n+\n+/**\n+ * Defines constants for all attribute names defined in the OpenTelemetry Semantic Conventions\n+ * specifications.\n+ *\n+ * @see <a\n+ *     href=\"https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/data-semantic-conventions.md\">Semantic\n+ *     Conventions</a>\n+ */\n+public final class SemanticAttributes {\n+\n+  /** Transport protocol used. */\n+  public static final String NET_TRANSPORT = \"net.transport\";\n+  /** Remote address of the peer (dotted decimal for IPv4 or RFC5952 for IPv6). */\n+  public static final String NET_PEER_IP = \"net.peer.ip\";\n+  /** Remote port number as an integer. E.g., 80. */\n+  public static final String NET_PEER_PORT = \"net.peer.port\";\n+  /** Remote hostname or similar. */\n+  public static final String NET_PEER_NAME = \"net.peer.name\";\n+  /** Like net.peer.ip but for the host IP. Useful in case of a multi-IP host. */\n+  public static final String NET_HOST_IP = \"net.host.ip\";\n+  /** Like net.peer.port but for the host port. */\n+  public static final String NET_HOST_PORT = \"net.host.port\";\n+  /** Local hostname or similar. */\n+  public static final String NET_HOST_NAME = \"net.host.name\";\n+  /** Username or client_id extracted from the access token or Authorization header. */\n+  public static final String ENDUSER_ID = \"enduser.id\";\n+  /** Actual/assumed role the client is making the request under. */\n+  public static final String ENDUSER_ROLE = \"enduser.role\";\n+  /** Scopes or granted authorities the client currently possesses. */\n+  public static final String ENDUSER_SCOPE = \"enduser.scope\";", "originalCommit": "78e97fd34f635d9816cab001a1fd6635c0098347", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDk1MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r382934951", "bodyText": "Fixed.", "author": "kbrockhoff", "createdAt": "2020-02-22T19:22:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkyOTcyMA=="}], "type": "inlineReview"}, {"oid": "fbc6baea5fed7e0e19040e9a8a8f4c110947994e", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/fbc6baea5fed7e0e19040e9a8a8f4c110947994e", "message": "Changed constants to objects which enabled typed setting of span attributes", "committedDate": "2020-02-22T18:31:06Z", "type": "commit"}, {"oid": "90b1d2e3916d4678a7959f216fba04f169c5d6a1", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/90b1d2e3916d4678a7959f216fba04f169c5d6a1", "message": "Merge branch 'master' into add-semantic-conventions-constants", "committedDate": "2020-02-22T18:35:46Z", "type": "commit"}, {"oid": "747e0676a91a172b42cb2fa3e200c15c3d572cae", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/747e0676a91a172b42cb2fa3e200c15c3d572cae", "message": "Sync Javadoc with specifications document.", "committedDate": "2020-02-22T19:21:30Z", "type": "commit"}, {"oid": "24a6f62dd5e5bb4210909ef5e41d302dbf68f1ca", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/24a6f62dd5e5bb4210909ef5e41d302dbf68f1ca", "message": "Merge branch 'master' into add-semantic-conventions-constants", "committedDate": "2020-02-29T17:59:32Z", "type": "commit"}, {"oid": "57d1e6040502186f75e2dad973b6ac03c0189246", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/57d1e6040502186f75e2dad973b6ac03c0189246", "message": "Update to latest factory name", "committedDate": "2020-02-29T18:04:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ3ODMzNQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r386478335", "bodyText": "I suggest naming these *AttributeSetter instead of just *Attribute to avoid confusion with already existing classes like io.opentelemetry.trace.AttributeValue.", "author": "Oberon00", "createdAt": "2020-03-02T15:53:23Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/AbstractAttribute.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import javax.annotation.concurrent.Immutable;\n+\n+/**\n+ * Abstract base class for {@link Attribute} implementations.\n+ *\n+ * @param <T> the attribute value type\n+ */\n+@Immutable\n+public abstract class AbstractAttribute<T> implements Attribute<T> {", "originalCommit": "57d1e6040502186f75e2dad973b6ac03c0189246", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwOTQ4NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r389309484", "bodyText": "Changed to AttributeSetter", "author": "kbrockhoff", "createdAt": "2020-03-07T20:22:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ3ODMzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MDA4NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r386480084", "bodyText": "This case looks really awkward. Why would we convert a boolean to a string? Isn't setting a null string equivalent to not calling setAttribute as opposed to clearing the attribute anyway?", "author": "Oberon00", "createdAt": "2020-03-02T15:55:46Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/BooleanAttribute.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.Nullable;\n+import javax.annotation.concurrent.Immutable;\n+\n+/** Defines the behavior for a span attribute with boolean values. */\n+@Immutable\n+public class BooleanAttribute extends AbstractAttribute<Boolean> {\n+\n+  /**\n+   * Constructs an attribute object.\n+   *\n+   * @param attributeKey the attribute name/key\n+   */\n+  public BooleanAttribute(String attributeKey) {\n+    super(attributeKey);\n+  }\n+\n+  @Override\n+  public void set(Span span, @Nullable Boolean value) {\n+    if (value != null) {\n+      span.setAttribute(key(), value);\n+    } else {\n+      span.setAttribute(key(), (String) null);", "originalCommit": "57d1e6040502186f75e2dad973b6ac03c0189246", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjAwNzM5NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r396007395", "bodyText": "Changed", "author": "kbrockhoff", "createdAt": "2020-03-21T16:39:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MDA4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MTExOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r386481119", "bodyText": "I don't like this class. Also, from the name I would have expected it not to parse the string but leave it as-is. EDIT: Maybe if the class handles parsing errors (e.g. by setting the value as-is), I would like it better \ud83d\ude03", "author": "Oberon00", "createdAt": "2020-03-02T15:57:07Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/IntOrStringAttribute.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.Nullable;\n+import javax.annotation.concurrent.Immutable;\n+\n+/**\n+ * Defines the behavior for a span attribute with long values which are normally handled as integers\n+ * or strings in most applications.\n+ */\n+@Immutable\n+public class IntOrStringAttribute extends AbstractAttribute<Integer> {", "originalCommit": "57d1e6040502186f75e2dad973b6ac03c0189246", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwOTU5NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r389309595", "bodyText": "This was copied from OpenTracing based on the assumption that it was added there because of need", "author": "kbrockhoff", "createdAt": "2020-03-07T20:23:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MTExOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTUxNjUxNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r389516514", "bodyText": "I challenge that assumption ;) Or rather, I have an alternative idea, see #758 (comment)", "author": "Oberon00", "createdAt": "2020-03-09T08:29:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MTExOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjAwNzQwNQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r396007405", "bodyText": "Changed", "author": "kbrockhoff", "createdAt": "2020-03-21T16:39:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MTExOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MTc0MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r386481741", "bodyText": "This may throw an exception for invalid input which violates the specification's error handling guidelines. Also, since this input will most likely come directly from the monitored code, it is even more dangerous.", "author": "Oberon00", "createdAt": "2020-03-02T15:58:05Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/IntOrStringAttribute.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.Nullable;\n+import javax.annotation.concurrent.Immutable;\n+\n+/**\n+ * Defines the behavior for a span attribute with long values which are normally handled as integers\n+ * or strings in most applications.\n+ */\n+@Immutable\n+public class IntOrStringAttribute extends AbstractAttribute<Integer> {\n+\n+  /**\n+   * Constructs an attribute object.\n+   *\n+   * @param attributeKey the attribute name/key\n+   */\n+  public IntOrStringAttribute(String attributeKey) {\n+    super(attributeKey);\n+  }\n+\n+  @Override\n+  public void set(Span span, @Nullable Integer value) {\n+    if (value != null) {\n+      span.setAttribute(key(), value.longValue());\n+    } else {\n+      span.setAttribute(key(), (String) null);\n+    }\n+  }\n+\n+  /**\n+   * Sets the attribute on the provided span.\n+   *\n+   * @param span the span to add the attribute to\n+   * @param value the string value which can be parsed into an integer\n+   */\n+  public void set(Span span, @Nullable String value) {\n+    if (value != null) {\n+      span.setAttribute(key(), Long.valueOf(value));", "originalCommit": "57d1e6040502186f75e2dad973b6ac03c0189246", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwOTYzMg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r389309632", "bodyText": "Good catch. I have added try catch block", "author": "kbrockhoff", "createdAt": "2020-03-07T20:24:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQ4MTc0MQ=="}], "type": "inlineReview"}, {"oid": "a0d9449333148ed316d2100f1508170d6c4b37a6", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/a0d9449333148ed316d2100f1508170d6c4b37a6", "message": "Merge branch 'master' into add-semantic-conventions-constants", "committedDate": "2020-03-07T19:50:36Z", "type": "commit"}, {"oid": "b13ae10e05d606ffd5e2598098642b62aa57ba00", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/b13ae10e05d606ffd5e2598098642b62aa57ba00", "message": "Renaming to make usage clearer", "committedDate": "2020-03-07T20:21:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTUxMzQzOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r389513439", "bodyText": "What about this: We remove this class but instead give LongAttributeSetter two methods:\n\ntrySetParsed(String) which tries to parse the argument and does nothing on failure.\nsetParsedOrRaw(String) which tries to parse the argument and sets the string as-is on failure\n(remove set(String) to avoid accidentally passing a string)\n\nI would think that this is much cleaner than having this IntOrStringAttributeSetter  where it is not clear what set does on failure.", "author": "Oberon00", "createdAt": "2020-03-09T08:21:00Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/IntOrStringAttributeSetter.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.Nullable;\n+import javax.annotation.concurrent.Immutable;\n+\n+/**\n+ * Defines the behavior for a span attribute with long values which are normally handled as integers\n+ * or strings in most applications.\n+ */\n+@Immutable\n+public class IntOrStringAttributeSetter extends AbstractAttributeSetter<Integer> {", "originalCommit": "b13ae10e05d606ffd5e2598098642b62aa57ba00", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTUxNjA1Mg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r389516052", "bodyText": "I think there is no benefit in having this in the interface. In fact there is a drawback, because it forces as to use (nullable) Long instead of just primitive long. In fact, I'd vote for removing this interface entirely (actually, we could even remove the abstract base class since the achieved code sharing is extremely minimal: We'd write private final String key instead of extends AbstractAttributeSetter<Foo> and this.key = key instead of super(key) and that's about it.)", "author": "Oberon00", "createdAt": "2020-03-09T08:27:59Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/AttributeSetter.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.Nullable;\n+\n+/** Defines the behavior for one attribute definition. */\n+public interface AttributeSetter<T> {\n+\n+  /**\n+   * Returns the attribute name.\n+   *\n+   * @return the attribute map key\n+   */\n+  String key();\n+\n+  /**\n+   * Sets the attribute on the provided span.\n+   *\n+   * @param span the span to add the attribute to\n+   * @param value the value for this attribute or <code>null</code> to remove attribute from span\n+   */\n+  void set(Span span, @Nullable T value);", "originalCommit": "b13ae10e05d606ffd5e2598098642b62aa57ba00", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2e8c9b6c0f4b059947c3372bb5f195ac7c273b6f", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/2e8c9b6c0f4b059947c3372bb5f195ac7c273b6f", "message": "Merge branch 'master' into add-semantic-conventions-constants", "committedDate": "2020-03-19T12:15:23Z", "type": "commit"}, {"oid": "1c4086e26aad790690033ae33c2e128935466e48", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/1c4086e26aad790690033ae33c2e128935466e48", "message": "Merge branch 'master' into add-semantic-conventions-constants", "committedDate": "2020-03-21T15:15:18Z", "type": "commit"}, {"oid": "b7f7bc85f660b89e619c1ed3975bc8aba06dac5a", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/b7f7bc85f660b89e619c1ed3975bc8aba06dac5a", "message": "API improvements and cleanup based on PR comments", "committedDate": "2020-03-21T16:38:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjI5MDg3Mg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r396290872", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    keys.add(((LongAttributeSetter) attribute).key());\n          \n          \n            \n                    ((LongAttributeSetter) attribute).set(span, 42L);\n          \n          \n            \n                    ((LongAttributeSetter) attribute).trySetParsed(span, \"42\");\n          \n          \n            \n                    ((LongAttributeSetter) attribute).trySetParsed(span, \"BAD\");\n          \n          \n            \n                    ((LongAttributeSetter) attribute).trySetParsed(span, null);\n          \n          \n            \n                    ((LongAttributeSetter) attribute).setParsedOrRaw(span, \"42\");\n          \n          \n            \n                    ((LongAttributeSetter) attribute).setParsedOrRaw(span, \"BAD\");\n          \n          \n            \n                    ((LongAttributeSetter) attribute).setParsedOrRaw(span, null);\n          \n          \n            \n                    final LongAttributeSetter longAttribute = (LongAttributeSetter) attribute:\n          \n          \n            \n                    keys.add(longAttribute .key());\n          \n          \n            \n                    longAttribute.set(span, 42L);\n          \n          \n            \n                    longAttribute.trySetParsed(span, \"42\");\n          \n          \n            \n                    longAttribute.trySetParsed(span, \"BAD\");\n          \n          \n            \n                    longAttribute.trySetParsed(span, null);\n          \n          \n            \n                    longAttribute.setParsedOrRaw(span, \"42\");\n          \n          \n            \n                    longAttribute.setParsedOrRaw(span, \"BAD\");\n          \n          \n            \n                    longAttribute.setParsedOrRaw(span, null);\n          \n      \n    \n    \n  \n\nand so on", "author": "Oberon00", "createdAt": "2020-03-23T08:51:10Z", "path": "api/src/test/java/io/opentelemetry/trace/attributes/SemanticAttributesTest.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import io.opentelemetry.OpenTelemetry;\n+import io.opentelemetry.trace.Span;\n+import io.opentelemetry.trace.Tracer;\n+import java.lang.reflect.Field;\n+import java.util.HashSet;\n+import java.util.Set;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+/** Unit tests for {@link SemanticAttributes}. */\n+@RunWith(JUnit4.class)\n+public class SemanticAttributesTest {\n+\n+  private Span span;\n+\n+  @Before\n+  public void setUp() {\n+    Tracer tracer = OpenTelemetry.getTracerProvider().get(\"io.telemetry.api\");\n+    span = tracer.spanBuilder(\"junit\").startSpan();\n+  }\n+\n+  @Test\n+  public void shouldEnableSetAttributeOnSpan() throws IllegalAccessException {\n+    Set<String> keys = new HashSet<>();\n+    Field[] fields = SemanticAttributes.class.getFields();\n+    for (int i = 0; i < fields.length; i++) {\n+      Object attribute = fields[i].get(null);\n+      if (attribute instanceof StringAttributeSetter) {\n+        keys.add(((StringAttributeSetter) attribute).key());\n+        ((StringAttributeSetter) attribute).set(span, \"TestValue\");\n+        ((StringAttributeSetter) attribute).set(span, null);\n+      } else if (attribute instanceof LongAttributeSetter) {\n+        keys.add(((LongAttributeSetter) attribute).key());\n+        ((LongAttributeSetter) attribute).set(span, 42L);\n+        ((LongAttributeSetter) attribute).trySetParsed(span, \"42\");\n+        ((LongAttributeSetter) attribute).trySetParsed(span, \"BAD\");\n+        ((LongAttributeSetter) attribute).trySetParsed(span, null);\n+        ((LongAttributeSetter) attribute).setParsedOrRaw(span, \"42\");\n+        ((LongAttributeSetter) attribute).setParsedOrRaw(span, \"BAD\");\n+        ((LongAttributeSetter) attribute).setParsedOrRaw(span, null);", "originalCommit": "b7f7bc85f660b89e619c1ed3975bc8aba06dac5a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDY0OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397214648", "bodyText": "Do we really need these methods now? I would suggest to stay only with set for the moment until we need these. Same comment applies to all.", "author": "bogdandrutu", "createdAt": "2020-03-24T14:52:55Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/BooleanAttributeSetter.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.concurrent.Immutable;\n+\n+/** Defines the behavior for a span attribute with boolean values. */\n+@Immutable\n+public class BooleanAttributeSetter {\n+\n+  private final String attributeKey;\n+\n+  /**\n+   * Constructs an attribute object.\n+   *\n+   * @param attributeKey the attribute name/key\n+   */\n+  public BooleanAttributeSetter(String attributeKey) {\n+    super();\n+    this.attributeKey = attributeKey;\n+  }\n+\n+  /**\n+   * Returns the attribute name.\n+   *\n+   * @return the attribute map key\n+   */\n+  public String key() {\n+    return attributeKey;\n+  }\n+\n+  /**\n+   * Sets the attribute on the provided span.\n+   *\n+   * @param span the span to add the attribute to\n+   * @param value the value for this attribute\n+   */\n+  public void set(Span span, boolean value) {\n+    span.setAttribute(key(), value);\n+  }\n+\n+  /**\n+   * Sets the attribute on the provided span if provided a parsable boolean else does nothing.\n+   *\n+   * @param span the span to add the attribute to\n+   * @param value the value for this attribute\n+   */\n+  public void trySetParsed(Span span, String value) {\n+    if (\"true\".equalsIgnoreCase(value) || \"false\".equalsIgnoreCase(value)) {\n+      span.setAttribute(key(), Boolean.parseBoolean(value));\n+    }\n+  }\n+\n+  /**\n+   * Sets the attribute on the provided span to either a boolean if provided string is parsable or\n+   * else the raw string.\n+   *\n+   * @param span the span to add the attribute to\n+   * @param value the value for this attribute\n+   */\n+  public void setParsedOrRaw(Span span, String value) {\n+    if (\"true\".equalsIgnoreCase(value) || \"false\".equalsIgnoreCase(value)) {\n+      span.setAttribute(key(), Boolean.parseBoolean(value));\n+    } else {\n+      span.setAttribute(key(), value);\n+    }\n+  }", "originalCommit": "b7f7bc85f660b89e619c1ed3975bc8aba06dac5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI1MjY0OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397252649", "bodyText": "No we don't need them but it's a nice convenience feature. And since OpenTracing had similar features, it may ease porting of instrumentations from there to OpenTelemetry. I have no strong opinion, but I think it's fine to keep them in this PR.", "author": "Oberon00", "createdAt": "2020-03-24T15:41:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDY0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI2NzU1Mg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397267552", "bodyText": "Trying to limit the API for the moment. Any unnecessary method that we add now will cost us a lot to maintain/keep.", "author": "bogdandrutu", "createdAt": "2020-03-24T15:59:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDY0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI3MTczMA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397271730", "bodyText": "Ah I see, it's in the core API package. Which is IMHO good, since I think the semantic conventions should be seen as a core API. Maybe we should mark these methods final to limit the possibility of headaches in the future?", "author": "Oberon00", "createdAt": "2020-03-24T16:04:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDY0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMwOTQwNg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397309406", "bodyText": "I think the whole class should be final :)", "author": "bogdandrutu", "createdAt": "2020-03-24T16:53:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDY0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDg0Mg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397214842", "bodyText": "why calling this?", "author": "bogdandrutu", "createdAt": "2020-03-24T14:53:10Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/BooleanAttributeSetter.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.concurrent.Immutable;\n+\n+/** Defines the behavior for a span attribute with boolean values. */\n+@Immutable\n+public class BooleanAttributeSetter {\n+\n+  private final String attributeKey;\n+\n+  /**\n+   * Constructs an attribute object.\n+   *\n+   * @param attributeKey the attribute name/key\n+   */\n+  public BooleanAttributeSetter(String attributeKey) {\n+    super();", "originalCommit": "b7f7bc85f660b89e619c1ed3975bc8aba06dac5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcyMzM3Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r399723376", "bodyText": "Ping on this one.", "author": "bogdandrutu", "createdAt": "2020-03-28T23:45:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDIzODE4MA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r400238180", "bodyText": "@kbrockhoff would be nice to fix this (though personally I wouldn't hold up the PR further just because of this superfluous line).", "author": "Oberon00", "createdAt": "2020-03-30T14:30:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ4ODMxNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r400488314", "bodyText": "This is fixed. I am not sure why it is showing as outdated.", "author": "kbrockhoff", "createdAt": "2020-03-30T20:55:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDUzNzU4OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r400537588", "bodyText": "Am I looking to a wrong class https://github.com/open-telemetry/opentelemetry-java/pull/758/files#diff-55ba0be6445e26747fa46c33ffaffdaeR39?", "author": "bogdandrutu", "createdAt": "2020-03-30T22:40:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNDg0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNTA0NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397215044", "bodyText": "Consider to use autovalue.", "author": "bogdandrutu", "createdAt": "2020-03-24T14:53:24Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/BooleanAttributeSetter.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.concurrent.Immutable;\n+\n+/** Defines the behavior for a span attribute with boolean values. */\n+@Immutable\n+public class BooleanAttributeSetter {", "originalCommit": "b7f7bc85f660b89e619c1ed3975bc8aba06dac5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI1MzUyOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397253529", "bodyText": "Why?", "author": "Oberon00", "createdAt": "2020-03-24T15:42:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNTA0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI2MjA5NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397262094", "bodyText": "To avoid checking for null the key and have autogenerated hash/equal if we need them :)", "author": "bogdandrutu", "createdAt": "2020-03-24T15:52:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNTA0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI2MjM2NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397262364", "bodyText": "Not a strong opinion, as I said is a consideration.", "author": "bogdandrutu", "createdAt": "2020-03-24T15:53:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNTA0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNTY4NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397215684", "bodyText": "Consider to use a static factory method create. It is more flexible than the ctor.", "author": "bogdandrutu", "createdAt": "2020-03-24T14:54:08Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/BooleanAttributeSetter.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.concurrent.Immutable;\n+\n+/** Defines the behavior for a span attribute with boolean values. */\n+@Immutable\n+public class BooleanAttributeSetter {\n+\n+  private final String attributeKey;\n+\n+  /**\n+   * Constructs an attribute object.\n+   *\n+   * @param attributeKey the attribute name/key\n+   */\n+  public BooleanAttributeSetter(String attributeKey) {", "originalCommit": "b7f7bc85f660b89e619c1ed3975bc8aba06dac5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY5OTUzMw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r399699533", "bodyText": "Changed to factory method", "author": "kbrockhoff", "createdAt": "2020-03-28T19:25:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxNTY4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397218969", "bodyText": "Another maybe useful helper would be setToCurrent(boolean) allows users to avoid getting the current Span :)", "author": "bogdandrutu", "createdAt": "2020-03-24T14:58:09Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/BooleanAttributeSetter.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.concurrent.Immutable;\n+\n+/** Defines the behavior for a span attribute with boolean values. */\n+@Immutable\n+public class BooleanAttributeSetter {\n+\n+  private final String attributeKey;\n+\n+  /**\n+   * Constructs an attribute object.\n+   *\n+   * @param attributeKey the attribute name/key\n+   */\n+  public BooleanAttributeSetter(String attributeKey) {\n+    super();\n+    this.attributeKey = attributeKey;\n+  }\n+\n+  /**\n+   * Returns the attribute name.\n+   *\n+   * @return the attribute map key\n+   */\n+  public String key() {\n+    return attributeKey;\n+  }\n+\n+  /**\n+   * Sets the attribute on the provided span.\n+   *\n+   * @param span the span to add the attribute to\n+   * @param value the value for this attribute\n+   */\n+  public void set(Span span, boolean value) {\n+    span.setAttribute(key(), value);\n+  }", "originalCommit": "b7f7bc85f660b89e619c1ed3975bc8aba06dac5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI2ODAyNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397268024", "bodyText": "Hmm, that would kinda explode the interface if we also wanted things like setParsedOrRawToCurrent. In Python, there is a special sentinel value for CURRENT_SPAN that is of type Span. That could work for Java too.\nWe could solve this via a global helper method curentSpan that you would import static, then you can write myAttr.set(currentSpan(), myBool) which is not much longer than myAttr.setToCurrent(myBool). Maybe such a method even exists already.", "author": "Oberon00", "createdAt": "2020-03-24T15:59:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI2ODIxMw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397268213", "bodyText": "Another maybe useful helper is to add attributes to a Span.Builder", "author": "bogdandrutu", "createdAt": "2020-03-24T16:00:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMxMDE5MA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397310190", "bodyText": "We do have getCurrentSpan() :)", "author": "bogdandrutu", "createdAt": "2020-03-24T16:53:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMxMDk5NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397310995", "bodyText": "So I am fine to not have the setToCurrent(). But I do want the setParsedOrRaw to be removed for the moment.", "author": "bogdandrutu", "createdAt": "2020-03-24T16:55:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMyOTIwOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397329209", "bodyText": "What about trySetParsed?", "author": "Oberon00", "createdAt": "2020-03-24T17:20:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM3MDQxMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397370411", "bodyText": "Both, I think they can be built easily on top of just Set for the moment. Adding new methods is easier than removing in terms of backwards compatibility.", "author": "bogdandrutu", "createdAt": "2020-03-24T18:24:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzM4Mzc4MA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397383780", "bodyText": "It's not possible to implement setParsedOrRaw with set, since you can only set integer values but not string values with that.", "author": "Oberon00", "createdAt": "2020-03-24T18:46:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzQzNzA5NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r397437095", "bodyText": "Now that I see the behavior is even more confusing to set a string value using a int attribute setter.", "author": "bogdandrutu", "createdAt": "2020-03-24T20:23:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY5OTU2Nw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r399699567", "bodyText": "Removed requested methods", "author": "kbrockhoff", "createdAt": "2020-03-28T19:25:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzIxODk2OQ=="}], "type": "inlineReview"}, {"oid": "53c7180714c872b4903a774c449e583599c7ff3e", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/53c7180714c872b4903a774c449e583599c7ff3e", "message": "Merge branch 'master' into add-semantic-conventions-constants", "committedDate": "2020-03-28T14:39:14Z", "type": "commit"}, {"oid": "d8aac8f6de159f1695463e84eeee79e1a84a3035", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/d8aac8f6de159f1695463e84eeee79e1a84a3035", "message": "Removed methods required by code reviews", "committedDate": "2020-03-28T19:24:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcyMzQ4Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r399723486", "bodyText": "Make classes final to avoid unexpected inheritance behavior.", "author": "bogdandrutu", "createdAt": "2020-03-28T23:47:36Z", "path": "api/src/main/java/io/opentelemetry/trace/attributes/BooleanAttributeSetter.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.trace.attributes;\n+\n+import io.opentelemetry.trace.Span;\n+import javax.annotation.concurrent.Immutable;\n+\n+/** Defines the behavior for a span attribute with boolean values. */\n+@Immutable\n+public class BooleanAttributeSetter {", "originalCommit": "d8aac8f6de159f1695463e84eeee79e1a84a3035", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDEzODY1OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/758#discussion_r400138659", "bodyText": "Fixed", "author": "kbrockhoff", "createdAt": "2020-03-30T12:06:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcyMzQ4Ng=="}], "type": "inlineReview"}, {"oid": "2a41c409ecccdfcd08d3a36f359852d70fc51669", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/2a41c409ecccdfcd08d3a36f359852d70fc51669", "message": "Made setter classes final", "committedDate": "2020-03-30T12:03:14Z", "type": "commit"}]}