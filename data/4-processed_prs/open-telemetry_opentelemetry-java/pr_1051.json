{"pr_number": 1051, "pr_title": "Update QUICKSTART with the latest context prop changes.", "pr_createdAt": "2020-03-28T19:35:09Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051", "timeline": [{"oid": "33891f7f373b71ee0e502970e5ff389250f94ebd", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/33891f7f373b71ee0e502970e5ff389250f94ebd", "message": "Update QUICKSTART with the latest context prop changes.", "committedDate": "2020-03-28T19:34:34Z", "type": "commit"}, {"oid": "078c001a58c87d14edfe0a1aac695b604a90725b", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/078c001a58c87d14edfe0a1aac695b604a90725b", "message": "Oops, had forgotten to include the link.", "committedDate": "2020-03-28T19:36:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTkzODIyMw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r399938223", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [W3C Trace Context](https://www.w3.org/TR/trace-context/) HTTP headers. For doing in-process\n          \n          \n            \n            propagation, [gRPC Context]() is used (contained in a single, small artifact non-dependent on\n          \n          \n            \n            [W3C Trace Context](https://www.w3.org/TR/trace-context/) HTTP headers.", "author": "thisthat", "createdAt": "2020-03-30T05:41:12Z", "path": "QUICKSTART.md", "diffHunk": "@@ -164,8 +164,15 @@ For more details how to read context from remote processes, see\n \n ### Context Propagation\n \n+In-process propagation leverages [gRPC Context](https://grpc.github.io/grpc-java/javadoc/io/grpc/Context.html),\n+a well established context propagation library, contained in a small artifact, which is non-dependent on the\n+entire gRPC engine.\n+\n OpenTelemetry provides a text-based approach to propagate context to remote services using the\n-[W3C Trace Context](https://www.w3.org/TR/trace-context/) HTTP headers. The following presents an\n+[W3C Trace Context](https://www.w3.org/TR/trace-context/) HTTP headers. For doing in-process\n+propagation, [gRPC Context]() is used (contained in a single, small artifact non-dependent on", "originalCommit": "078c001a58c87d14edfe0a1aac695b604a90725b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5NTI1NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400295254", "bodyText": "Ooops, somehow this ended up repeated. Fixed.", "author": "carlosalberto", "createdAt": "2020-03-30T15:43:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTkzODIyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI0OTIyMw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400249223", "bodyText": "This makes it look like if setting attributes was only allowed within the scope. You might want to move that out to make it clear this is not the case.", "author": "arminru", "createdAt": "2020-03-30T14:44:53Z", "path": "QUICKSTART.md", "diffHunk": "@@ -181,13 +188,17 @@ HttpTextFormat.Setter<HttpURLConnection> setter =\n \n URL url = new URL(\"http://127.0.0.1:8080/resource\");\n Span outGoing = tracer.spanBuilder(\"/resource\").setSpanKind(Span.Kind.CLIENT).startSpan();\n-// Semantic Convention\n-outGoing.setAttribute(\"http.method\", \"GET\");\n-outGoing.setAttribute(\"http.url\", url.toString());\n-HttpURLConnection transportLayer = (HttpURLConnection) url.openConnection();\n-// Inject the request with the context\n-tracer.getHttpTextFormat().inject(outGoing.getContext(), transportLayer, setter);\n-// Make outgoing call\n+try (Scope scope = tracer.withSpan(outGoing)) {\n+  // Semantic Convention\n+  outGoing.setAttribute(\"http.method\", \"GET\");\n+  outGoing.setAttribute(\"http.url\", url.toString());", "originalCommit": "078c001a58c87d14edfe0a1aac695b604a90725b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI5NjY5OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400296698", "bodyText": "I'd rather add a note such as setting attributes does not require the Span to be associated to the current Context, as moving that out of the scope would also give users a bad idea (that you set the attributes first and then you set the Span active). Would that work for you?", "author": "carlosalberto", "createdAt": "2020-03-30T15:45:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI0OTIyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMzNjg2MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400336861", "bodyText": "Sounds reasonable!", "author": "arminru", "createdAt": "2020-03-30T16:42:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI0OTIyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM4ODM1MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400388351", "bodyText": "Done.", "author": "carlosalberto", "createdAt": "2020-03-30T18:02:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI0OTIyMw=="}], "type": "inlineReview"}, {"oid": "04e0e9ae9e00c2a9d3b76ddbe4eddc807452eb92", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/04e0e9ae9e00c2a9d3b76ddbe4eddc807452eb92", "message": "Fix repeated line.", "committedDate": "2020-03-30T15:42:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMxOTQ3Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400319476", "bodyText": "he/ctx are too Go like for the Java world :) Probably we should use better variable names.", "author": "bogdandrutu", "createdAt": "2020-03-30T16:16:39Z", "path": "QUICKSTART.md", "diffHunk": "@@ -207,10 +216,11 @@ HttpTextFormat.Getter<HttpExchange> getter =\n };\n ...\n public void handle(HttpExchange he) {\n-    // Extract the context from the request\n-    SpanContext ctx = tracer.getHttpTextFormat().extract(he, getter);\n+  // Extract the SpanContext and other elements from the request.\n+  Context ctx = tracer.getHttpTextFormat().extract(Context.current(), he, getter);", "originalCommit": "04e0e9ae9e00c2a9d3b76ddbe4eddc807452eb92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM4NzkwMg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400387902", "bodyText": "Done.", "author": "carlosalberto", "createdAt": "2020-03-30T18:01:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMxOTQ3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMzNTg1MA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400335850", "bodyText": "Can we put a comment up above about where this HttpExchange class comes from?", "author": "jkwatson", "createdAt": "2020-03-30T16:40:30Z", "path": "QUICKSTART.md", "diffHunk": "@@ -207,10 +216,11 @@ HttpTextFormat.Getter<HttpExchange> getter =\n };\n ...\n public void handle(HttpExchange he) {", "originalCommit": "04e0e9ae9e00c2a9d3b76ddbe4eddc807452eb92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM4ODI2MA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400388260", "bodyText": "I linked HttpExchange to https://docs.oracle.com/javase/8/docs/jre/api/net/httpserver/spec/com/sun/net/httpserver/HttpExchange.html\nDoes that work for you?", "author": "carlosalberto", "createdAt": "2020-03-30T18:02:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMzNTg1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM5NDMxNw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1051#discussion_r400394317", "bodyText": "perfect (always scary to be using stuff in com.sun, but it's good to at least have the connection)", "author": "jkwatson", "createdAt": "2020-03-30T18:11:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMzNTg1MA=="}], "type": "inlineReview"}, {"oid": "7c31e0fe1fc01ba7a9d899fdb119653b90809757", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/7c31e0fe1fc01ba7a9d899fdb119653b90809757", "message": "Misc improvements.", "committedDate": "2020-03-30T18:00:47Z", "type": "commit"}]}