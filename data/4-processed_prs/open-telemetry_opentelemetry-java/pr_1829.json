{"pr_number": 1829, "pr_title": "Upgrade to Gradle 6.7 and use toolchains feature to build on 11 and t\u2026", "pr_createdAt": "2020-10-19T06:39:29Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829", "timeline": [{"oid": "04300d22ac797786b650092306f0f305b3dd793f", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/04300d22ac797786b650092306f0f305b3dd793f", "message": "Upgrade to Gradle 6.7 and use toolchains feature to build on 11 and test on 11/8.", "committedDate": "2020-10-19T06:39:00Z", "type": "commit"}, {"oid": "4080b3f23cbf7443adaffe65b412f6d883813144", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/4080b3f23cbf7443adaffe65b412f6d883813144", "message": "Debug (probably first JDK download taking some time)", "committedDate": "2020-10-19T06:56:11Z", "type": "commit"}, {"oid": "16b975dcbd3c38edbb5faa6a455c14a6d20a2574", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/16b975dcbd3c38edbb5faa6a455c14a6d20a2574", "message": "Remove now unnecessary java toolchain workarounds", "committedDate": "2020-10-19T07:17:37Z", "type": "commit"}, {"oid": "71a782fd9e619068fccaba28092ec51b74b70eb2", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/71a782fd9e619068fccaba28092ec51b74b70eb2", "message": "Remove debug", "committedDate": "2020-10-19T08:43:47Z", "type": "commit"}, {"oid": "3ec747c70fe821db75761abf66e6c68ceaea634f", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/3ec747c70fe821db75761abf66e6c68ceaea634f", "message": "Merge branch 'master' of github.com:open-telemetry/opentelemetry-java into gradle-6.7", "committedDate": "2020-10-19T23:22:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzMDQ3NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508430475", "bodyText": "If gradle is supposed to downloaded needed toolchain, why do we provide it manually?", "author": "iNikem", "createdAt": "2020-10-20T11:41:35Z", "path": ".github/workflows/continuous-build.yml", "diffHunk": "@@ -18,28 +18,32 @@ jobs:\n           - macos-latest\n           - ubuntu-latest\n           - windows-latest\n-        java:\n-          # Test all OS's with Java 11\n-          - 11\n         include:\n           - os: ubuntu-latest\n-            java: 11\n+            testAdditionalJavaVersions: true\n             coverage: true\n-          - os: ubuntu-latest\n-            java: 8\n     steps:\n       - uses: actions/checkout@v2\n         with:\n           submodules: true\n-      - uses: actions/setup-java@v1\n+      - id: setup-java-8", "originalCommit": "3ec747c70fe821db75761abf66e6c68ceaea634f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzMjg3OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508432879", "bodyText": "Java is required to launch Gradle itself.", "author": "vlsi", "createdAt": "2020-10-20T11:45:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzMDQ3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQ1OTk1MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508459951", "bodyText": "For that we have java 11 next to this 8", "author": "iNikem", "createdAt": "2020-10-20T12:31:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzMDQ3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY1NzcwNw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508657707", "bodyText": "Yeah but setup-java doesn't download Java it just extracts from a local VM disk very quickly. Figure it's worth saving some downloading.", "author": "anuraaga", "createdAt": "2020-10-20T16:10:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzMDQ3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzNjI1Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508436256", "bodyText": "Do you really need all?\nCan you use bin distribution?", "author": "vlsi", "createdAt": "2020-10-20T11:51:49Z", "path": "examples/gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -1,5 +1,6 @@\n distributionBase=GRADLE_USER_HOME\n distributionPath=wrapper/dists\n-distributionUrl=https\\://services.gradle.org/distributions/gradle-6.6-all.zip\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-6.7-all.zip", "originalCommit": "3ec747c70fe821db75761abf66e6c68ceaea634f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2MDYwNg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508660606", "bodyText": "Back in the day -all was required for intellij completion from what I understand. Now I do see gradle compile stubs on first launch with -bin. Does that mean bin is enough for projects, but not plugin authors? If so it mostly makes sense - but I personally found the time it takes for -bin to generate stubs to be way longer (several minutes on a macbook pro) than just downloading -all so not sure it's a savings in practice. What do you think?", "author": "anuraaga", "createdAt": "2020-10-20T16:13:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzNjI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2NDY5OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508664699", "bodyText": "Oh, I thought -all was generating stubs as well. I did not compare the contents, however, I thought the difference is just source code (*.java files are present in -all, and they are not there in -bin).\nI think -all was required earlier for the IDE to navigate to Gradle sources, however, it is not needed now.", "author": "vlsi", "createdAt": "2020-10-20T16:17:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzNjI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY2NjYzNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508666634", "bodyText": "https://twitter.com/CedricChampeau/status/1113871652809531392\nIf you are here, then there's Madrid JUG happening right NOW: https://www.meetup.com/madrid-gug/events/273721823\nModernizing the Groovy build by C\u00e9dric Champeau, so you can join and ask -bin vs -all :)", "author": "vlsi", "createdAt": "2020-10-20T16:20:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzNjI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODY3ODE4Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508678186", "bodyText": "I think I noticed slowness with -bin with the generations of stubs that wasn't there with -all but am not sure, I'll need to try a controlled experiments to confirm.\nAnd as much as I love Gradle I was supposed to pass out an hour ago and will promptly do so for tomorrow :) Sounds like a fun event for sure though.", "author": "anuraaga", "createdAt": "2020-10-20T16:38:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzNjI1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQzNjM2NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r508436365", "bodyText": "Do you really need all?\nCan you use bin distribution?", "author": "vlsi", "createdAt": "2020-10-20T11:51:59Z", "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -1,5 +1,6 @@\n distributionBase=GRADLE_USER_HOME\n distributionPath=wrapper/dists\n-distributionUrl=https\\://services.gradle.org/distributions/gradle-6.6-all.zip\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-6.7-all.zip", "originalCommit": "3ec747c70fe821db75761abf66e6c68ceaea634f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "019664202aea321d26e2fa6dcd4fdfb96b3351e1", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/019664202aea321d26e2fa6dcd4fdfb96b3351e1", "message": "Remove windows build for now", "committedDate": "2020-10-20T23:51:20Z", "type": "commit"}, {"oid": "13c72fd0a5076cf75eb1e527b04a7d982d4b077c", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/13c72fd0a5076cf75eb1e527b04a7d982d4b077c", "message": "bin", "committedDate": "2020-10-21T03:00:04Z", "type": "commit"}, {"oid": "351c760f2d982aac9e0e1c78d287a8e19bd5dc78", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/351c760f2d982aac9e0e1c78d287a8e19bd5dc78", "message": "Raise no_output_timeout since this change seems to eliminate cache and build doesn't finish.", "committedDate": "2020-10-21T04:32:15Z", "type": "commit"}, {"oid": "c6f025547f7c863c89587c1fb78a6944e4e0dd51", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/c6f025547f7c863c89587c1fb78a6944e4e0dd51", "message": "Merge branch 'master' of github.com:open-telemetry/opentelemetry-java into gradle-6.7", "committedDate": "2020-10-21T04:38:47Z", "type": "commit"}, {"oid": "9d9eb589afe129f0d98e20217d63ed055590faf4", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/9d9eb589afe129f0d98e20217d63ed055590faf4", "message": "Merge branch 'gradle-6.7' of github.com:anuraaga/opentelemetry-java into gradle-6.7", "committedDate": "2020-10-21T04:38:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEwNzkwMA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r509107900", "bodyText": "Are we sure that this image is being used? The line 25 defines executor type as machine which is VM and I think as it is applied at root all jobs will use it.", "author": "pavolloffay", "createdAt": "2020-10-21T08:57:09Z", "path": ".circleci/config.yml", "diffHunk": "@@ -28,8 +30,9 @@ jobs:\n       # Configure the JVM and Gradle to avoid OOM errors\n       _JAVA_OPTIONS: \"-Xmx1g\"\n       GRADLE_OPTS: \"-Dorg.gradle.daemon=false -Dorg.gradle.workers.max=2\"\n+      ORG_GRADLE_PROJECT_testAdditionalJavaVersions: true\n     docker:\n-      - image: circleci/openjdk:8-jdk\n+      - image: circleci/openjdk:11.0.6-jdk-buster", "originalCommit": "9d9eb589afe129f0d98e20217d63ed055590faf4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEwOTY4NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r509109684", "bodyText": "Right I found out it's not being used. I'm going to be deleting CircleCI build anyways :)", "author": "anuraaga", "createdAt": "2020-10-21T08:59:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEwNzkwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg5NjQyNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1829#discussion_r512896424", "bodyText": "@anuraaga I think by removing this, Intellij doesn't configure the language level correctly.", "author": "tylerbenson", "createdAt": "2020-10-27T17:39:48Z", "path": "build.gradle", "diffHunk": "@@ -169,15 +169,32 @@ configure(opentelemetryProjects) {\n         mavenLocal()\n     }\n \n-    sourceCompatibility = 1.8\n-    targetCompatibility = 1.8", "originalCommit": "9d9eb589afe129f0d98e20217d63ed055590faf4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}