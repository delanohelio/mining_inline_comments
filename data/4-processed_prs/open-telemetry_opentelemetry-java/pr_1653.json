{"pr_number": 1653, "pr_title": "Add w3c context propagation tests", "pr_createdAt": "2020-09-16T12:36:17Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653", "timeline": [{"oid": "0907858ead0b5bdbf46ffaae9c8ecc4599197720", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/0907858ead0b5bdbf46ffaae9c8ecc4599197720", "message": "Add w3c context propagation tests\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-16T12:34:44Z", "type": "commit"}, {"oid": "05d0e717753f83a4de4426cbd1fd298d9deac236", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/05d0e717753f83a4de4426cbd1fd298d9deac236", "message": "add sleep for printing test results\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-16T13:13:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU3MjI0NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r489572245", "bodyText": "Can you add some notes in here about the environmental requirements to have this be runnable? It looks like you'll need to be on some sort of system that supports a bourne shell, and have python3/pip3 installed.", "author": "jkwatson", "createdAt": "2020-09-16T16:34:11Z", "path": "integration_tests/tracecontext/README.md", "diffHunk": "@@ -0,0 +1,7 @@\n+# OpenTelemetry W3C Context Propagation tests", "originalCommit": "05d0e717753f83a4de4426cbd1fd298d9deac236", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTk1NjMzMg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r489956332", "bodyText": "It'd be great if we can push a docker image with this test environment. I wouldn't block this PR on it, but then we'd even be able to run it as part of the build.", "author": "anuraaga", "createdAt": "2020-09-17T04:11:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU3MjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDMyNTQ0OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r490325448", "bodyText": "I would have to guess that there's a stock ubuntu image out there with python3/pip3 already ready-to-go.", "author": "jkwatson", "createdAt": "2020-09-17T15:03:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU3MjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk3NzI2NA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r490977264", "bodyText": "updated readme and circleci config to run in docker image", "author": "malafeev", "createdAt": "2020-09-18T14:11:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU3MjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxNzM0Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r491817343", "bodyText": "circleci config reverted", "author": "malafeev", "createdAt": "2020-09-21T06:34:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU3MjI0NQ=="}], "type": "inlineReview"}, {"oid": "9139d78c5a997be2a2e0462475f294a2615916e9", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/9139d78c5a997be2a2e0462475f294a2615916e9", "message": "add Environmental requirements\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T13:48:15Z", "type": "commit"}, {"oid": "6e782131e30d290e749bdb6af31670a4f652ac86", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/6e782131e30d290e749bdb6af31670a4f652ac86", "message": "use far jar to run\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T13:48:42Z", "type": "commit"}, {"oid": "7a2471a9d3cf95b181c454a6d37a8ca26e7022e9", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/7a2471a9d3cf95b181c454a6d37a8ca26e7022e9", "message": "run integration tests in circleci\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T13:50:05Z", "type": "commit"}, {"oid": "bb390bdd7ac38180b3f8352d0d0fd132d6852953", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/bb390bdd7ac38180b3f8352d0d0fd132d6852953", "message": "change image\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T14:04:12Z", "type": "commit"}, {"oid": "a85282151fe1077f61235c13e3bfa6961c071a46", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/a85282151fe1077f61235c13e3bfa6961c071a46", "message": "reformat\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T14:07:36Z", "type": "commit"}, {"oid": "f8c443a8bff38c237176636e0e9f81f2f1701a5e", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/f8c443a8bff38c237176636e0e9f81f2f1701a5e", "message": "pip3 to pip\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T14:14:41Z", "type": "commit"}, {"oid": "695eeb66738a56563123e266aac8ee5edb7983de", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/695eeb66738a56563123e266aac8ee5edb7983de", "message": "upgrade pip\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T14:18:27Z", "type": "commit"}, {"oid": "33c53562683850b83a73503c90c9fed3facdc796", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/33c53562683850b83a73503c90c9fed3facdc796", "message": "missing colon\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T14:20:20Z", "type": "commit"}, {"oid": "6e223dfb83373cc97463030208fa226574a28b30", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/6e223dfb83373cc97463030208fa226574a28b30", "message": "install pip3\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T14:31:02Z", "type": "commit"}, {"oid": "d4656244798b123c96201228e5d27d791f877443", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/d4656244798b123c96201228e5d27d791f877443", "message": "do not install pip3\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T14:38:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk5NTczOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r490995739", "bodyText": "If we have failing tests, won't this fail every build until we get them fixed?", "author": "jkwatson", "createdAt": "2020-09-18T14:39:15Z", "path": ".circleci/config.yml", "diffHunk": "@@ -107,13 +107,36 @@ jobs:\n           paths:\n             - ~/.gradle\n           key: gradle-{{ checksum \"build.gradle\" }}\n+# Integration tests\n+  integration-tests:\n+    environment:\n+      # Configure the JVM and Gradle to avoid OOM errors\n+      _JAVA_OPTIONS: \"-Xmx1g\"\n+      GRADLE_OPTS: \"-Dorg.gradle.daemon=false -Dorg.gradle.workers.max=2\"\n+    docker:\n+      - image: openkbs/jdk-mvn-py3\n+    steps:\n+      - checkout\n+      - restore_cache:\n+          keys:\n+            - gradle-w3c-{{ checksum \"build.gradle\" }}\n+      - run:\n+          name: Integration Tests\n+          command: cd integration_tests/tracecontext && ./tracecontext-integration-test.sh\n+      - run:\n+          <<: *publish_snapshots_task\n+      - save_cache:\n+          paths:\n+            - ~/.gradle\n+          key: gradle-w3c-{{ checksum \"build.gradle\" }}\n \n workflows:\n   version: 2\n   build_and_test:\n     jobs:\n       - build\n       - java11\n+      - integration-tests", "originalCommit": "d4656244798b123c96201228e5d27d791f877443", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTAzOTAyNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r491039024", "bodyText": "get docker image with jdk and python3 and pip3 made my day crazy... still not be able to do that", "author": "malafeev", "createdAt": "2020-09-18T15:49:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk5NTczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA0NTkzOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r491045939", "bodyText": "we can hold on that for a follow-up if you want. I'd be happy getting the tests in as a first step, then automating the running of them as a second step.", "author": "jkwatson", "createdAt": "2020-09-18T16:00:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk5NTczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxNjk2Mg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r491816962", "bodyText": "I removed automation", "author": "malafeev", "createdAt": "2020-09-21T06:32:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk5NTczOQ=="}], "type": "inlineReview"}, {"oid": "98c21171a996d69b5a76934f34e7c9b76e98eb53", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/98c21171a996d69b5a76934f34e7c9b76e98eb53", "message": "install python 3 and pip3\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T15:01:13Z", "type": "commit"}, {"oid": "7197a01da57bccf80d02db45825ea69f65b819a6", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/7197a01da57bccf80d02db45825ea69f65b819a6", "message": "install python 3 and pip3\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T15:02:48Z", "type": "commit"}, {"oid": "259e741f31356dfc9825886844c0f0a51ac67541", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/259e741f31356dfc9825886844c0f0a51ac67541", "message": "install python 3 and pip3\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T15:09:51Z", "type": "commit"}, {"oid": "dffa0833f14d1bcd690be366d61a3438e6b6939f", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/dffa0833f14d1bcd690be366d61a3438e6b6939f", "message": "install python 3 and pip3\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T15:11:53Z", "type": "commit"}, {"oid": "cdaaeffe4c5ca33f45f88a4b1f4c25599ba72916", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/cdaaeffe4c5ca33f45f88a4b1f4c25599ba72916", "message": "install python 3 and pip3\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T15:22:12Z", "type": "commit"}, {"oid": "c1d4a481e544afaf78b95192d267b9dc71cd184b", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/c1d4a481e544afaf78b95192d267b9dc71cd184b", "message": "install python 3 and pip3\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-18T16:09:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA1NTQwMA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r491055400", "bodyText": "this docker image has pip3, but output shows that pip3 not found.\nhow it's possible?", "author": "malafeev", "createdAt": "2020-09-18T16:17:07Z", "path": ".circleci/config.yml", "diffHunk": "@@ -107,13 +107,36 @@ jobs:\n           paths:\n             - ~/.gradle\n           key: gradle-{{ checksum \"build.gradle\" }}\n+# Integration tests\n+  integration-tests:\n+    environment:\n+      # Configure the JVM and Gradle to avoid OOM errors\n+      _JAVA_OPTIONS: \"-Xmx1g\"\n+      GRADLE_OPTS: \"-Dorg.gradle.daemon=false -Dorg.gradle.workers.max=2\"\n+    docker:\n+      - image: openkbs/jdk-mvn-py3", "originalCommit": "c1d4a481e544afaf78b95192d267b9dc71cd184b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA3NzY3OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r491077679", "bodyText": "maybe it's not on the default PATH?", "author": "jkwatson", "createdAt": "2020-09-18T16:59:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA1NTQwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTgxNjgxMw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1653#discussion_r491816813", "bodyText": "no, something different, I removed it now.", "author": "malafeev", "createdAt": "2020-09-21T06:32:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA1NTQwMA=="}], "type": "inlineReview"}, {"oid": "cd2d9d02137ccadcf987cf924f349657a8849914", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/cd2d9d02137ccadcf987cf924f349657a8849914", "message": "add /usr/local/bin to PATH\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-21T06:23:32Z", "type": "commit"}, {"oid": "090e0326c211e05af5b02757c0352e29c4ca4e1b", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/090e0326c211e05af5b02757c0352e29c4ca4e1b", "message": "call /usr/local/bin/pip3 to PATH\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-21T06:29:06Z", "type": "commit"}, {"oid": "5e2d48dcd1473a2b317dd9f7d60c89f829c7626d", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/5e2d48dcd1473a2b317dd9f7d60c89f829c7626d", "message": "get rid of automation\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-21T06:32:04Z", "type": "commit"}, {"oid": "36a83e83eb41a3f0a85a26b9074a689f6294cedd", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/36a83e83eb41a3f0a85a26b9074a689f6294cedd", "message": "refactor extractor to pass more tests\n\nSigned-off-by: Sergei Malafeev <sergei@malafeev.org>", "committedDate": "2020-09-23T13:20:32Z", "type": "commit"}]}