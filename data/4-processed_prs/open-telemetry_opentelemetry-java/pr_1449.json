{"pr_number": 1449, "pr_title": "Refactor decision to sampling result", "pr_createdAt": "2020-07-22T17:27:12Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/1449", "timeline": [{"oid": "009437e18c8a53fd12bae691e2341e408e34257b", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/009437e18c8a53fd12bae691e2341e408e34257b", "message": "Refactor decision to sampling result", "committedDate": "2020-07-22T17:25:21Z", "type": "commit"}, {"oid": "26ada2825cedd40624e9214be3e6fadc22f753c5", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/26ada2825cedd40624e9214be3e6fadc22f753c5", "message": "Fix bad refactor samplingResult => decision", "committedDate": "2020-07-22T17:30:05Z", "type": "commit"}, {"oid": "4028b11d4977c6cc6a61b306fa5122d1c0ec6d1f", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/4028b11d4977c6cc6a61b306fa5122d1c0ec6d1f", "message": "Fix decision not sampling result", "committedDate": "2020-07-22T17:30:56Z", "type": "commit"}, {"oid": "0d4c4a313eaecd948fef1fbb1db1036870c74663", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/0d4c4a313eaecd948fef1fbb1db1036870c74663", "message": "Fix comments with divergent explanations of same entity", "committedDate": "2020-07-22T17:31:48Z", "type": "commit"}, {"oid": "193e6bfacd68490a7ebdb1c1d5db4f384b4d1444", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/193e6bfacd68490a7ebdb1c1d5db4f384b4d1444", "message": "Fix make comments clearer", "committedDate": "2020-07-22T17:38:00Z", "type": "commit"}, {"oid": "3382504e857d9cf367876fa20948e4f1ea486966", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/3382504e857d9cf367876fa20948e4f1ea486966", "message": "Add links to SamplingResult", "committedDate": "2020-07-22T17:45:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk5NDYwMA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1449#discussion_r458994600", "bodyText": "Should we deprecate this? Maybe a followup PR, for the moment just create an issue to not forget about?", "author": "bogdandrutu", "createdAt": "2020-07-22T18:23:44Z", "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/Samplers.java", "diffHunk": "@@ -259,39 +279,44 @@ public final String getDescription() {\n \n   @Immutable\n   @AutoValue\n-  abstract static class DecisionImpl implements Decision {\n+  abstract static class SamplingResultImpl implements SamplingResult {\n     /**\n-     * Creates sampling decision with probability attribute.\n+     * Creates sampling result with probability attribute.\n      *\n-     * @param decision sampling decision\n-     * @param probability the probability that was used for the decision.\n+     * @param decision the decision on sampling and recording\n+     * @param probability the probability that was used for the samplingResult.\n      */\n-    static Decision createWithProbability(boolean decision, double probability) {\n-      return new AutoValue_Samplers_DecisionImpl(\n+    static SamplingResult createWithProbability(Decision decision, double probability) {\n+      return new AutoValue_Samplers_SamplingResultImpl(\n           decision, Attributes.of(SAMPLING_PROBABILITY.key(), doubleAttributeValue(probability)));\n     }\n \n     /**\n-     * Creates sampling decision without attributes.\n+     * Creates sampling result without attributes.\n      *\n-     * @param decision sampling decision\n+     * @param decision sampling samplingResult\n      */\n-    static Decision createWithoutAttributes(boolean decision) {\n-      return new AutoValue_Samplers_DecisionImpl(decision, Attributes.empty());\n+    static SamplingResult createWithoutAttributes(Decision decision) {\n+      return new AutoValue_Samplers_SamplingResultImpl(decision, Attributes.empty());\n     }\n \n     /**\n-     * Creates sampling decision with the given attributes.\n+     * Creates sampling result with the given attributes.\n      *\n-     * @param decision sampling decision\n+     * @param decision sampling decisionq\n      * @param attributes attributes. Will not be copied, so do not modify afterwards.\n      */\n-    static Decision create(boolean decision, Attributes attributes) {\n-      return new AutoValue_Samplers_DecisionImpl(decision, attributes);\n+    static SamplingResult create(Decision decision, Attributes attributes) {\n+      return new AutoValue_Samplers_SamplingResultImpl(decision, attributes);\n     }\n \n     @Override\n-    public abstract boolean isSampled();\n+    public abstract Decision getDecision();\n+\n+    @Override\n+    public boolean isSampled() {", "originalCommit": "3382504e857d9cf367876fa20948e4f1ea486966", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk5NDkyNg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1449#discussion_r458994926", "bodyText": "Can we remove this?", "author": "bogdandrutu", "createdAt": "2020-07-22T18:24:20Z", "path": "sdk/src/main/java/io/opentelemetry/sdk/trace/Sampler.java", "diffHunk": "@@ -68,27 +68,36 @@ Decision shouldSample(\n    */\n   String getDescription();\n \n+  /** A decision on whether a span should be recorded, recorded and sampled or not recorded. */\n+  enum Decision {\n+    NOT_RECORD,\n+    RECORD,\n+    RECORD_AND_SAMPLED,\n+  }\n+\n   /**\n-   * Sampling decision returned by {@link Sampler#shouldSample(SpanContext, TraceId, String, Kind,\n+   * Sampling result returned by {@link Sampler#shouldSample(SpanContext, TraceId, String, Kind,\n    * ReadableAttributes, List)}.\n    *\n    * @since 0.1.0\n    */\n-  interface Decision {\n+  interface SamplingResult {\n \n     /**\n-     * Return sampling decision whether span should be sampled or not.\n+     * Return decision on whether a span should be recorded, recorded and sampled or not recorded.\n      *\n-     * @return sampling decision.\n-     * @since 0.1.0\n+     * @return sampling result.\n+     * @since 0.7.0\n      */\n+    Decision getDecision();\n+\n     boolean isSampled();", "originalCommit": "3382504e857d9cf367876fa20948e4f1ea486966", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk5NzQwMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1449#discussion_r458997401", "bodyText": "It's no longer required in the spec so it would seem like yes\nhttps://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/trace/sdk.md#sampler", "author": "ptravers", "createdAt": "2020-07-22T18:28:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODk5NDkyNg=="}], "type": "inlineReview"}]}