{"pr_number": 2016, "pr_title": "DBZ-1818 OpenTracing documentation", "pr_createdAt": "2020-12-16T13:43:44Z", "pr_url": "https://github.com/debezium/debezium/pull/2016", "timeline": [{"oid": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "url": "https://github.com/debezium/debezium/commit/fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "message": "DBZ-1818 OpenTracing documentation", "committedDate": "2020-12-16T13:43:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNTQ1NQ==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545625455", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n          \n          \n            \n            One of the key ingredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].", "author": "gunnarmorling", "createdAt": "2020-12-18T07:44:34Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNTU4Mw==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545625583", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n          \n          \n            \n            The tracing support is added to Debezium through the https://opentracing.io/[OpenTracing] specification.", "author": "gunnarmorling", "createdAt": "2020-12-18T07:44:53Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNTc0Ng==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545625746", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n          \n          \n            \n            Neither the specification JAR files nor the Jaeger client are part of the Debezium Kafka Connect container image.", "author": "gunnarmorling", "createdAt": "2020-12-18T07:45:19Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNzIwNw==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545627207", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In this case, the application writing to a database is responsible for providing tracing span context.\n          \n          \n            \n            In this case, the application writing to a database is responsible for providing the tracing span context.", "author": "gunnarmorling", "createdAt": "2020-12-18T07:48:49Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNzQzMA==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545627430", "bodyText": "I don't understand this one.", "author": "gunnarmorling", "createdAt": "2020-12-18T07:49:21Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc1MDY5NA==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545750694", "bodyText": "@gunnarmorling Rewritten and ready for review", "author": "jpechane", "createdAt": "2020-12-18T10:46:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNzQzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNzUwNg==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545627506", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n          \n          \n            \n            In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end tracing.", "author": "gunnarmorling", "createdAt": "2020-12-18T07:49:34Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNzcyOA==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545627728", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n          \n          \n            \n            * create the event `db-log-write` span context with the start timestamp set to the database log write timestamp", "author": "gunnarmorling", "createdAt": "2020-12-18T07:50:10Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyNzc3MA==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545627770", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * extract parent span context if present in the message\n          \n          \n            \n            * extract the parent span context if present in the message", "author": "gunnarmorling", "createdAt": "2020-12-18T07:50:17Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyODAxMw==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545628013", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even\n          \n          \n            \n            * create the processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even", "author": "gunnarmorling", "createdAt": "2020-12-18T07:50:50Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n+* insert fields from `source` block into the span as *tags*\n+* create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyODQ5Nw==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545628497", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Outbox extension provides the additional operations necessary for tracing context propagation out-of-the-box.\n          \n          \n            \n            The outbox extension provides the additional operations necessary for tracing context propagation out-of-the-box.", "author": "gunnarmorling", "createdAt": "2020-12-18T07:52:08Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n+* insert fields from `source` block into the span as *tags*\n+* create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even\n+* insert fields from envelope such as `op` into the processing span as *tags*\n+* injects the processing span context into message headers\n+\n+=== Kafka Producer tracing\n+\n+Optionally it is possible to enable tracing at the Kafka producer level.\n+If enabled then when the message is being written to the Kafka broker the producer will extract Debezium's processing span context from the Kafka message headers, create a new child span and record information about the write to the broker.\n+Then it injects the new span into the message headers so a consumer of the message can restore the trace and resume end-to-end tracing.\n+\n+=== Configuration options\n+\n+[cols=\"65%a,>15%a,>20%\"]\n+|===\n+|Configuration property\n+|Type\n+|Default\n+\n+|`tracing.span.context.field`::\n+The name of the field containing span context. +\n++\n+_The sender must write the span context into the database column as a serialized instance of `java.util.Properties` with injected span context._\n+|string\n+|tracingspancontext\n+\n+|`tracing.operation.name`::\n+The operation name representing the Debezium processing span. +\n+|string\n+|debezium-read\n+\n+|`tracing.with.context.field.only`::\n+Only events that have serialized context field should be traced.\n++\n+_If set to `true` then tracing span will be created only for events with associated tracing span context field.\n+If set to `false` then the tracing span is created for all incoming events regardless of having associated span context._\n+|boolean\n+|false\n+\n+|===\n+\n+== Outbox Extension\n+\n+Outbox extension provides the additional operations necessary for tracing context propagation out-of-the-box.", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyODUzOA==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545628538", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            It provides `tracingspancontext` field in an outbox table that is used as the vehicle to pass span context from service using the outbox extension to a Debezium connector.\n          \n          \n            \n            It provides the `tracingspancontext` field in an outbox table that is used as the vehicle to pass span context from service using the outbox extension to a Debezium connector.", "author": "gunnarmorling", "createdAt": "2020-12-18T07:52:16Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n+* insert fields from `source` block into the span as *tags*\n+* create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even\n+* insert fields from envelope such as `op` into the processing span as *tags*\n+* injects the processing span context into message headers\n+\n+=== Kafka Producer tracing\n+\n+Optionally it is possible to enable tracing at the Kafka producer level.\n+If enabled then when the message is being written to the Kafka broker the producer will extract Debezium's processing span context from the Kafka message headers, create a new child span and record information about the write to the broker.\n+Then it injects the new span into the message headers so a consumer of the message can restore the trace and resume end-to-end tracing.\n+\n+=== Configuration options\n+\n+[cols=\"65%a,>15%a,>20%\"]\n+|===\n+|Configuration property\n+|Type\n+|Default\n+\n+|`tracing.span.context.field`::\n+The name of the field containing span context. +\n++\n+_The sender must write the span context into the database column as a serialized instance of `java.util.Properties` with injected span context._\n+|string\n+|tracingspancontext\n+\n+|`tracing.operation.name`::\n+The operation name representing the Debezium processing span. +\n+|string\n+|debezium-read\n+\n+|`tracing.with.context.field.only`::\n+Only events that have serialized context field should be traced.\n++\n+_If set to `true` then tracing span will be created only for events with associated tracing span context field.\n+If set to `false` then the tracing span is created for all incoming events regardless of having associated span context._\n+|boolean\n+|false\n+\n+|===\n+\n+== Outbox Extension\n+\n+Outbox extension provides the additional operations necessary for tracing context propagation out-of-the-box.\n+It provides `tracingspancontext` field in an outbox table that is used as the vehicle to pass span context from service using the outbox extension to a Debezium connector.", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyODY5OQ==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545628699", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * writes the record into the database\n          \n          \n            \n            * write the record into the database", "author": "gunnarmorling", "createdAt": "2020-12-18T07:52:40Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n+* insert fields from `source` block into the span as *tags*\n+* create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even\n+* insert fields from envelope such as `op` into the processing span as *tags*\n+* injects the processing span context into message headers\n+\n+=== Kafka Producer tracing\n+\n+Optionally it is possible to enable tracing at the Kafka producer level.\n+If enabled then when the message is being written to the Kafka broker the producer will extract Debezium's processing span context from the Kafka message headers, create a new child span and record information about the write to the broker.\n+Then it injects the new span into the message headers so a consumer of the message can restore the trace and resume end-to-end tracing.\n+\n+=== Configuration options\n+\n+[cols=\"65%a,>15%a,>20%\"]\n+|===\n+|Configuration property\n+|Type\n+|Default\n+\n+|`tracing.span.context.field`::\n+The name of the field containing span context. +\n++\n+_The sender must write the span context into the database column as a serialized instance of `java.util.Properties` with injected span context._\n+|string\n+|tracingspancontext\n+\n+|`tracing.operation.name`::\n+The operation name representing the Debezium processing span. +\n+|string\n+|debezium-read\n+\n+|`tracing.with.context.field.only`::\n+Only events that have serialized context field should be traced.\n++\n+_If set to `true` then tracing span will be created only for events with associated tracing span context field.\n+If set to `false` then the tracing span is created for all incoming events regardless of having associated span context._\n+|boolean\n+|false\n+\n+|===\n+\n+== Outbox Extension\n+\n+Outbox extension provides the additional operations necessary for tracing context propagation out-of-the-box.\n+It provides `tracingspancontext` field in an outbox table that is used as the vehicle to pass span context from service using the outbox extension to a Debezium connector.\n+\n+When an outbox even is emitted the extension will:\n+\n+* creates a new `outbox-write` span as a child of current active span\n+* injects the span context into that `java.util.Properties` instance that is serialized into the `tracingspancontext` column\n+* writes the record into the database", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyODczOQ==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545628739", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * injects the span context into that `java.util.Properties` instance that is serialized into the `tracingspancontext` column\n          \n          \n            \n            * inject the span context into that `java.util.Properties` instance that is serialized into the `tracingspancontext` column", "author": "gunnarmorling", "createdAt": "2020-12-18T07:52:46Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n+* insert fields from `source` block into the span as *tags*\n+* create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even\n+* insert fields from envelope such as `op` into the processing span as *tags*\n+* injects the processing span context into message headers\n+\n+=== Kafka Producer tracing\n+\n+Optionally it is possible to enable tracing at the Kafka producer level.\n+If enabled then when the message is being written to the Kafka broker the producer will extract Debezium's processing span context from the Kafka message headers, create a new child span and record information about the write to the broker.\n+Then it injects the new span into the message headers so a consumer of the message can restore the trace and resume end-to-end tracing.\n+\n+=== Configuration options\n+\n+[cols=\"65%a,>15%a,>20%\"]\n+|===\n+|Configuration property\n+|Type\n+|Default\n+\n+|`tracing.span.context.field`::\n+The name of the field containing span context. +\n++\n+_The sender must write the span context into the database column as a serialized instance of `java.util.Properties` with injected span context._\n+|string\n+|tracingspancontext\n+\n+|`tracing.operation.name`::\n+The operation name representing the Debezium processing span. +\n+|string\n+|debezium-read\n+\n+|`tracing.with.context.field.only`::\n+Only events that have serialized context field should be traced.\n++\n+_If set to `true` then tracing span will be created only for events with associated tracing span context field.\n+If set to `false` then the tracing span is created for all incoming events regardless of having associated span context._\n+|boolean\n+|false\n+\n+|===\n+\n+== Outbox Extension\n+\n+Outbox extension provides the additional operations necessary for tracing context propagation out-of-the-box.\n+It provides `tracingspancontext` field in an outbox table that is used as the vehicle to pass span context from service using the outbox extension to a Debezium connector.\n+\n+When an outbox even is emitted the extension will:\n+\n+* creates a new `outbox-write` span as a child of current active span\n+* injects the span context into that `java.util.Properties` instance that is serialized into the `tracingspancontext` column", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyODc4NQ==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545628785", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * creates a new `outbox-write` span as a child of current active span\n          \n          \n            \n            * create a new `outbox-write` span as a child of current active span", "author": "gunnarmorling", "createdAt": "2020-12-18T07:52:53Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n+* insert fields from `source` block into the span as *tags*\n+* create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even\n+* insert fields from envelope such as `op` into the processing span as *tags*\n+* injects the processing span context into message headers\n+\n+=== Kafka Producer tracing\n+\n+Optionally it is possible to enable tracing at the Kafka producer level.\n+If enabled then when the message is being written to the Kafka broker the producer will extract Debezium's processing span context from the Kafka message headers, create a new child span and record information about the write to the broker.\n+Then it injects the new span into the message headers so a consumer of the message can restore the trace and resume end-to-end tracing.\n+\n+=== Configuration options\n+\n+[cols=\"65%a,>15%a,>20%\"]\n+|===\n+|Configuration property\n+|Type\n+|Default\n+\n+|`tracing.span.context.field`::\n+The name of the field containing span context. +\n++\n+_The sender must write the span context into the database column as a serialized instance of `java.util.Properties` with injected span context._\n+|string\n+|tracingspancontext\n+\n+|`tracing.operation.name`::\n+The operation name representing the Debezium processing span. +\n+|string\n+|debezium-read\n+\n+|`tracing.with.context.field.only`::\n+Only events that have serialized context field should be traced.\n++\n+_If set to `true` then tracing span will be created only for events with associated tracing span context field.\n+If set to `false` then the tracing span is created for all incoming events regardless of having associated span context._\n+|boolean\n+|false\n+\n+|===\n+\n+== Outbox Extension\n+\n+Outbox extension provides the additional operations necessary for tracing context propagation out-of-the-box.\n+It provides `tracingspancontext` field in an outbox table that is used as the vehicle to pass span context from service using the outbox extension to a Debezium connector.\n+\n+When an outbox even is emitted the extension will:\n+\n+* creates a new `outbox-write` span as a child of current active span", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyOTA4MA==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545629080", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Event Router acts as an Outbox Extension counterpart, executes the same steps as `ActivateTracingSpan` SMT, and is used instead of it.\n          \n          \n            \n            The Event Router SMT acts as an Outbox Extension counterpart, it executes the same steps as the `ActivateTracingSpan` SMT, and is used instead of it.", "author": "gunnarmorling", "createdAt": "2020-12-18T07:53:37Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n+* insert fields from `source` block into the span as *tags*\n+* create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even\n+* insert fields from envelope such as `op` into the processing span as *tags*\n+* injects the processing span context into message headers\n+\n+=== Kafka Producer tracing\n+\n+Optionally it is possible to enable tracing at the Kafka producer level.\n+If enabled then when the message is being written to the Kafka broker the producer will extract Debezium's processing span context from the Kafka message headers, create a new child span and record information about the write to the broker.\n+Then it injects the new span into the message headers so a consumer of the message can restore the trace and resume end-to-end tracing.\n+\n+=== Configuration options\n+\n+[cols=\"65%a,>15%a,>20%\"]\n+|===\n+|Configuration property\n+|Type\n+|Default\n+\n+|`tracing.span.context.field`::\n+The name of the field containing span context. +\n++\n+_The sender must write the span context into the database column as a serialized instance of `java.util.Properties` with injected span context._\n+|string\n+|tracingspancontext\n+\n+|`tracing.operation.name`::\n+The operation name representing the Debezium processing span. +\n+|string\n+|debezium-read\n+\n+|`tracing.with.context.field.only`::\n+Only events that have serialized context field should be traced.\n++\n+_If set to `true` then tracing span will be created only for events with associated tracing span context field.\n+If set to `false` then the tracing span is created for all incoming events regardless of having associated span context._\n+|boolean\n+|false\n+\n+|===\n+\n+== Outbox Extension\n+\n+Outbox extension provides the additional operations necessary for tracing context propagation out-of-the-box.\n+It provides `tracingspancontext` field in an outbox table that is used as the vehicle to pass span context from service using the outbox extension to a Debezium connector.\n+\n+When an outbox even is emitted the extension will:\n+\n+* creates a new `outbox-write` span as a child of current active span\n+* injects the span context into that `java.util.Properties` instance that is serialized into the `tracingspancontext` column\n+* writes the record into the database\n+\n+== Event Router SMT\n+\n+Event Router acts as an Outbox Extension counterpart, executes the same steps as `ActivateTracingSpan` SMT, and is used instead of it.", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYyOTI0OA==", "url": "https://github.com/debezium/debezium/pull/2016#discussion_r545629248", "bodyText": "Can you add a link to its doc page here (same for the next section).", "author": "gunnarmorling", "createdAt": "2020-12-18T07:53:59Z", "path": "documentation/modules/ROOT/pages/integrations/tracing.adoc", "diffHunk": "@@ -0,0 +1,101 @@\n+[id=\"distributed-tracing\"]\n+= Distributed Tracing\n+\n+:toc:\n+:toc-placement: macro\n+:linkattrs:\n+:icons: font\n+:source-highlighter: highlight.js\n+\n+toc::[]\n+\n+== Overview\n+\n+Observability is an important aspect of microservice-oriented applications.\n+One of the key ingeredients for observability is https://microservices.io/patterns/observability/distributed-tracing.html[distributed tracing].\n+\n+It is necessary to provide additional precautions when an application writes a record to a database that is later processed by Debezium.\n+The active trace is effectively demarcated by the write to the database.\n+If we want Debezium to join the larger scope application tracer we need to pass the trace metadata to Debezium.\n+\n+The tracing support is added to Debezium through https://opentracing.io/[OpenTracing] specification.\n+It is also necessary to provide a client implementing the specification.\n+Debezium was tested with https://www.jaegertracing.io/[Jaeger] implementation.\n+\n+[WARNING]\n+====\n+Neither specification JAR files nor Jaeger client are part of the Debezium Connect image.\n+The user either needs to extend the image with them or can use the https://strimzi.io/[Strimzi] Kafka image.\n+In that case, the tracing of Kafka producer and consumer is also available.\n+\n+See compose file of https://github.com/debezium/debezium-examples/tree/master/outbox[Outbox example].\n+====\n+\n+== ActivateTracingSpan SMT\n+\n+The main implementation point of tracing in Debezium is `ActivateTracingSpan` SMT.\n+In this case, the application writing to a database is responsible for providing tracing span context.\n+The writer should have span context inject into `java.util.Properties` instance that is serialized then serialized and written to the database as a distinct field of the table.\n+\n+If the span context is not provided then the SMT will create a new span.\n+In this case, Debezium operations together with metadata will be traced but will not be connected to business transaction traces to enable end-to-end testing.\n+\n+When this SMT is invoked with a message then it will:\n+\n+* extract parent span context if present in the message\n+* create event `db-log-write` span context with the start timestamp set to the database log write timestamp\n+* insert fields from `source` block into the span as *tags*\n+* create processing `debezium-read` span as a child of `db-log-write` span with the start timestamp set to the processing time of the even\n+* insert fields from envelope such as `op` into the processing span as *tags*\n+* injects the processing span context into message headers\n+\n+=== Kafka Producer tracing\n+\n+Optionally it is possible to enable tracing at the Kafka producer level.\n+If enabled then when the message is being written to the Kafka broker the producer will extract Debezium's processing span context from the Kafka message headers, create a new child span and record information about the write to the broker.\n+Then it injects the new span into the message headers so a consumer of the message can restore the trace and resume end-to-end tracing.\n+\n+=== Configuration options\n+\n+[cols=\"65%a,>15%a,>20%\"]\n+|===\n+|Configuration property\n+|Type\n+|Default\n+\n+|`tracing.span.context.field`::\n+The name of the field containing span context. +\n++\n+_The sender must write the span context into the database column as a serialized instance of `java.util.Properties` with injected span context._\n+|string\n+|tracingspancontext\n+\n+|`tracing.operation.name`::\n+The operation name representing the Debezium processing span. +\n+|string\n+|debezium-read\n+\n+|`tracing.with.context.field.only`::\n+Only events that have serialized context field should be traced.\n++\n+_If set to `true` then tracing span will be created only for events with associated tracing span context field.\n+If set to `false` then the tracing span is created for all incoming events regardless of having associated span context._\n+|boolean\n+|false\n+\n+|===\n+\n+== Outbox Extension", "originalCommit": "fe54ef31d684ae822ee56aaee7c050593dd5fcfd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b9a6856436ccb70a4b9bca43f3cd7ee359ddb5f8", "url": "https://github.com/debezium/debezium/commit/b9a6856436ccb70a4b9bca43f3cd7ee359ddb5f8", "message": "DBZ-1818 Fix typos; add links\n\nCo-authored-by: Gunnar Morling <gunnar.morling@googlemail.com>", "committedDate": "2020-12-18T10:44:44Z", "type": "commit"}, {"oid": "b9a6856436ccb70a4b9bca43f3cd7ee359ddb5f8", "url": "https://github.com/debezium/debezium/commit/b9a6856436ccb70a4b9bca43f3cd7ee359ddb5f8", "message": "DBZ-1818 Fix typos; add links\n\nCo-authored-by: Gunnar Morling <gunnar.morling@googlemail.com>", "committedDate": "2020-12-18T10:44:44Z", "type": "forcePushed"}]}