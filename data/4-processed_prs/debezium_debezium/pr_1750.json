{"pr_number": 1750, "pr_title": "DBZ-2171 avoid divisive language", "pr_createdAt": "2020-08-11T15:25:42Z", "pr_url": "https://github.com/debezium/debezium/pull/1750", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMDE4MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468710180", "bodyText": "I added braces here for the ORs after the && to fix the logic and avoid NPEs", "author": "rk3rn3r", "createdAt": "2020-08-11T16:28:53Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/SourceInfo.java", "diffHunk": "@@ -501,19 +505,42 @@ public void setOffset(Map<String, ?> sourceOffset) {\n             this.restartEventsToSkip = longOffsetValue(sourceOffset, EVENTS_TO_SKIP_OFFSET_KEY);\n             nextSnapshot = booleanOffsetValue(sourceOffset, SNAPSHOT_KEY);\n             lastSnapshot = nextSnapshot;\n-            this.databaseWhitelist = (String) sourceOffset.get(DATABASE_WHITELIST_KEY);\n-            this.databaseBlacklist = (String) sourceOffset.get(DATABASE_BLACKLIST_KEY);\n-            this.tableWhitelist = (String) sourceOffset.get(TABLE_WHITELIST_KEY);\n-            this.tableBlacklist = (String) sourceOffset.get(TABLE_BLACKLIST_KEY);\n+            if (sourceOffset.containsKey(DATABASE_INCLUDE_LIST_KEY)) {\n+                this.databaseIncludeList = (String) sourceOffset.get(DATABASE_INCLUDE_LIST_KEY);\n+            }\n+            else {\n+                this.databaseIncludeList = (String) sourceOffset.get(DATABASE_WHITELIST_KEY);\n+            }\n+            if (sourceOffset.containsKey(DATABASE_EXCLUDE_LIST_KEY)) {\n+                this.databaseExcludeList = (String) sourceOffset.get(DATABASE_EXCLUDE_LIST_KEY);\n+            }\n+            else {\n+                this.databaseExcludeList = (String) sourceOffset.get(DATABASE_BLACKLIST_KEY);\n+            }\n+            if (sourceOffset.containsKey(TABLE_INCLUDE_LIST_KEY)) {\n+                this.tableIncludeList = (String) sourceOffset.get(TABLE_INCLUDE_LIST_KEY);\n+            }\n+            else {\n+                this.tableIncludeList = (String) sourceOffset.get(TABLE_WHITELIST_KEY);\n+            }\n+            if (sourceOffset.containsKey(TABLE_EXCLUDE_LIST_KEY)) {\n+                this.tableExcludeList = (String) sourceOffset.get(TABLE_EXCLUDE_LIST_KEY);\n+            }\n+            else {\n+                this.tableExcludeList = (String) sourceOffset.get(TABLE_BLACKLIST_KEY);\n+            }\n         }\n     }\n \n     public static boolean offsetsHaveFilterInfo(Map<String, ?> sourceOffset) {\n-        return sourceOffset != null &&\n-                sourceOffset.containsKey(DATABASE_BLACKLIST_KEY) ||\n+        return sourceOffset != null && (sourceOffset.containsKey(DATABASE_BLACKLIST_KEY) ||", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExMjIzMQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469112231", "bodyText": "\ud83d\udc4d", "author": "gunnarmorling", "createdAt": "2020-08-12T09:00:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMDE4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMTEzNA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468711134", "bodyText": "instead of duplicating tests and extending runtimes I decided to randomly choose from the different options. not super nice but will serve the needs imo.", "author": "rk3rn3r", "createdAt": "2020-08-11T16:30:16Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/Configurator.java", "diffHunk": "@@ -35,23 +35,38 @@\n     }\n \n     /* package local */ Configurator includeDatabases(String regexList) {\n-        return with(MySqlConnectorConfig.DATABASE_WHITELIST, regexList);\n+        if (Math.random() >= 0.5) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExMjg3MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469112870", "bodyText": "Yes, see my other comment elsewhere. We can do this, but it should be logged which one has been chosen.", "author": "gunnarmorling", "createdAt": "2020-08-12T09:01:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMTEzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2ODMyNw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469168327", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-12T10:41:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMTEzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMjAxOA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468712018", "bodyText": "instead of duplicating the big test case I decided to parametrize the original test and call it with the 2 different parameters", "author": "rk3rn3r", "createdAt": "2020-08-11T16:31:37Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/MySqlConnectorIT.java", "diffHunk": "@@ -309,6 +326,15 @@ public void shouldValidateLockingModeNoneWithValidSnapshotModeConfiguration() {\n \n     @Test\n     public void shouldConsumeAllEventsFromDatabaseUsingSnapshot() throws SQLException, InterruptedException {\n+        shouldConsumeAllEventsFromDatabaseUsingSnapshotByField(MySqlConnectorConfig.DATABASE_INCLUDE_LIST, 18765);\n+    }\n+\n+    @Test\n+    public void shouldConsumeAllEventsFromDatabaseUsingSnapshotOld() throws SQLException, InterruptedException {\n+        shouldConsumeAllEventsFromDatabaseUsingSnapshotByField(MySqlConnectorConfig.DATABASE_WHITELIST, 18775);\n+    }\n+", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMzE5MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468713191", "bodyText": "sometimes, not always, tests were failing for me with \"Unknown database emptydb\". that fixed it for me.", "author": "rk3rn3r", "createdAt": "2020-08-11T16:33:30Z", "path": "debezium-connector-mysql/src/test/resources/ddl/connector_test.sql", "diffHunk": "@@ -70,4 +70,6 @@ VALUES (default, '2016-01-16', 1001, 1, 102),\n        (default, '2016-01-17', 1002, 2, 105),\n        (default, '2016-02-18', 1004, 3, 109),\n        (default, '2016-02-19', 1002, 2, 106),\n-       (default, '16-02-21', 1003, 1, 107);\n\\ No newline at end of file\n+       (default, '16-02-21', 1003, 1, 107);\n+\n+CREATE DATABASE IF NOT EXISTS emptydb;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNDU0Mg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469114542", "bodyText": "Ok \ud83d\udc4d", "author": "gunnarmorling", "createdAt": "2020-08-12T09:04:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMzE5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMzg1OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468713859", "bodyText": "AWS calls it RDS Master Password so I handled it like a name. we need to monitor if AWS updates the name to avoid divisive language too and then we can update to the new name", "author": "rk3rn3r", "createdAt": "2020-08-11T16:34:42Z", "path": "debezium-connector-postgres/RDS.md", "diffHunk": "@@ -66,7 +66,7 @@ This is where all the _magic_ happens where we put tie together all the pieces o\n Remember this version should match the version of database parameters you cloned in the prior steps.\n 3. Select the **Template** of interest, I typically picked **Free tier** because it's free ;)\n 4. Provide your database with a **DB Instance Identifier**.\n-5. Under **Credentials Settings**, manually assign a **Master Password** and confirm it.\n+5. Under **Credentials Settings**, manually assign a **RDS Master Password** and confirm it.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNDcxOA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469114718", "bodyText": "\ud83d\udc4d", "author": "gunnarmorling", "createdAt": "2020-08-12T09:04:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxMzg1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNDUxMA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468714510", "bodyText": "this logic is imo a bit weird and maybe should be fixed. I didn't change the logic now to avoid too many unrelated changes.", "author": "rk3rn3r", "createdAt": "2020-08-11T16:35:46Z", "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/Filters.java", "diffHunk": "@@ -39,37 +39,37 @@\n     public Filters(PostgresConnectorConfig config) {\n \n         // we always want to exclude PG system schemas as they are never part of logical decoding events\n-        String schemaBlacklist = config.schemaBlacklist();\n-        if (schemaBlacklist != null) {\n-            schemaBlacklist = schemaBlacklist + \",\" + SYSTEM_SCHEMA_BLACKLIST;\n+        String schemaExcludeList = config.schemaExcludeList();\n+        if (schemaExcludeList != null) {\n+            schemaExcludeList = schemaExcludeList + \",\" + SYSTEM_SCHEMA_EXCLUDE_LIST;\n         }\n         else {\n-            schemaBlacklist = SYSTEM_SCHEMA_BLACKLIST;\n+            schemaExcludeList = SYSTEM_SCHEMA_EXCLUDE_LIST;\n         }\n \n-        String tableBlacklist = config.tableBlacklist();\n-        if (tableBlacklist != null) {\n-            tableBlacklist = tableBlacklist + \",\" + TEMP_TABLE_BLACKLIST;\n+        String tableExcludeList = config.tableExcludeList();", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNTcwMA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469115700", "bodyText": "Can you capture this in a Jira issue? There already might be one actually for unifying the include/exclude filter handling. If you find it, can you please add a comment there. There only should be a single Filters class (at least for all the relational connectors) to begin with.", "author": "gunnarmorling", "createdAt": "2020-08-12T09:06:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNDUxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2Mjk5OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469162999", "bodyText": "https://issues.redhat.com/browse/DBZ-2426", "author": "rk3rn3r", "createdAt": "2020-08-12T10:30:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNDUxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2Mzk0Mg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469163942", "bodyText": "the global class might be io.debezium.relational.RelationalTableFilters ?", "author": "rk3rn3r", "createdAt": "2020-08-12T10:32:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNDUxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5MjQ0NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469192444", "bodyText": "Yes, exactly. This one should eventually be the only entry point for logic interested in filtering logic. The biggest obstacle there is the pending refactoring by @jpechane to move MySQL to the common framework. Once that's done, this can be tackled.", "author": "gunnarmorling", "createdAt": "2020-08-12T11:33:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNDUxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNzAwMg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468717002", "bodyText": "I added a TODO here and a deprecation annotation. We recently discussed that there should be no direct access to Confdiguration but all encapsulated with methods (PostgresConnectorConfig, MongoDBConnectorConfig, MysqlConnectorConfig, ...). I think it was just convenient in the past to just pass the Configuration instance instead of encapsulating it?\nWDYT?", "author": "rk3rn3r", "createdAt": "2020-08-11T16:39:54Z", "path": "debezium-core/src/main/java/io/debezium/config/CommonConnectorConfig.java", "diffHunk": "@@ -428,7 +428,9 @@ protected CommonConnectorConfig(Configuration config, String logicalName, int de\n     /**\n      * Provides access to the \"raw\" config instance. In most cases, access via typed getters for individual properties\n      * on the connector config class should be preferred.\n+     * TODO this should be protected in the future to force proper facade methods based access / encapsulation\n      */\n+    @Deprecated", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMTA5Mg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469121092", "bodyText": "Yes, exactly, eventually there should be no need for this method. Right now the code is in a somewhat transitioning state and no new code should make access of the raw config. When working on something it's also a good idea to update related usages; so far we haven't done a general refactoring, though.", "author": "gunnarmorling", "createdAt": "2020-08-12T09:15:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNzAwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2NDMzNg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469164336", "bodyText": "great, so we can keep the annotation?", "author": "rk3rn3r", "createdAt": "2020-08-12T10:33:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNzAwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5MjQ5MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469192490", "bodyText": "Yes.", "author": "gunnarmorling", "createdAt": "2020-08-12T11:33:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNzAwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNzgxMw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468717813", "bodyText": "Was moved here to avoid duplicate/copied strings in different connectors and their tests.", "author": "rk3rn3r", "createdAt": "2020-08-11T16:41:08Z", "path": "debezium-core/src/main/java/io/debezium/relational/RelationalDatabaseSchema.java", "diffHunk": "@@ -29,6 +29,7 @@\n  */\n public abstract class RelationalDatabaseSchema implements DatabaseSchema<TableId> {\n     private final static Logger LOG = LoggerFactory.getLogger(RelationalDatabaseSchema.class);\n+    public static final String NO_MONITORED_TABLES_WARNING = \"After applying include/exclude list filters there are no tables to monitor, please check your configuration\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMjI4NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469722285", "bodyText": "As commented elsewhere, needs to go to the super-class probably.", "author": "gunnarmorling", "createdAt": "2020-08-13T06:22:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNzgxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk3MzM1MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469973350", "bodyText": "will do", "author": "rk3rn3r", "createdAt": "2020-08-13T14:00:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNzgxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxODc0NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r468718744", "bodyText": "I always kept the old anchor links so that if there are links in external blog posts leading to the old anchor they are still working but pointing to the new property.", "author": "rk3rn3r", "createdAt": "2020-08-11T16:42:39Z", "path": "documentation/modules/ROOT/pages/connectors/mongodb.adoc", "diffHunk": "@@ -803,28 +803,31 @@ Only alphanumeric characters and underscores should be used.\n |`false`\n |When SSL is enabled this setting controls whether strict hostname checking is disabled during connection phase. If `true` the connection will not prevent man-in-the-middle attacks.\n \n-|[[mongodb-property-database-whitelist]]<<mongodb-property-database-whitelist, `database.whitelist`>>\n+|[[mongodb-property-database-whitelist]]<<mongodb-property-database-whitelist [[mongodb-property-database-include-list]]<<mongodb-property-database-include-list , `database.include.list`>>", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzg4MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469123880", "bodyText": "+1", "author": "gunnarmorling", "createdAt": "2020-08-12T09:20:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxODc0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwMzIxMQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469103211", "bodyText": "Let's revert that, as changing descriptions of issues closed long time ago adds more to the confusion than anything else.", "author": "gunnarmorling", "createdAt": "2020-08-12T08:45:22Z", "path": "CHANGELOG.md", "diffHunk": "@@ -2469,7 +2469,7 @@ November 9, 2016 - [Detailed release notes](https://issues.jboss.org/secure/Rele\n \n This release includes the following feature:\n \n-* MySQL connector now supports failover to MySQL masters that are slaves of multiple other MySQL servers/clusters. [DBZ-143](https://issues.jboss.org/projects/DBZ/issues/DBZ-143)\n+* MySQL connector now supports failover to MySQL primaries that are replicas of multiple other MySQL servers/clusters. [DBZ-143](https://issues.jboss.org/projects/DBZ/issues/DBZ-143)", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE0NDIwMw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469144203", "bodyText": "LOL, that's right. at that point I think I was not screening the context.", "author": "rk3rn3r", "createdAt": "2020-08-12T09:54:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwMzIxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2ODU4NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469168584", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-12T10:42:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwMzIxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNDg0Mg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469104842", "bodyText": "Var names should be includeList and excludeList?", "author": "gunnarmorling", "createdAt": "2020-08-12T08:48:05Z", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbConnectorConfig.java", "diffHunk": "@@ -413,19 +473,21 @@ private static int validateHosts(Configuration config, Field field, ValidationOu\n         return count;\n     }\n \n-    private static int validateCollectionBlacklist(Configuration config, Field field, ValidationOutput problems) {\n-        return validateBlacklistField(config, problems, COLLECTION_WHITELIST, COLLECTION_BLACKLIST);\n-    }\n-\n-    private static int validateDatabaseBlacklist(Configuration config, Field field, ValidationOutput problems) {\n-        return validateBlacklistField(config, problems, DATABASE_WHITELIST, DATABASE_BLACKLIST);\n+    private static int validateCollectionExcludeList(Configuration config, Field field, ValidationOutput problems) {\n+        String whitelist = config.getFallbackStringProperty(COLLECTION_INCLUDE_LIST, COLLECTION_WHITELIST);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE0NTIyNQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469145225", "bodyText": "we were talking about not changing not-userfacing parts. I only did for vars in a more complex context, but I'll change it now.", "author": "rk3rn3r", "createdAt": "2020-08-12T09:56:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNDg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2ODY2NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469168665", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-12T10:42:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNDg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5NTM3MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469195370", "bodyText": "Ok.", "author": "gunnarmorling", "createdAt": "2020-08-12T11:39:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNDg0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNDkzNQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469104935", "bodyText": "Same as above.", "author": "gunnarmorling", "createdAt": "2020-08-12T08:48:16Z", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbConnectorConfig.java", "diffHunk": "@@ -413,19 +473,21 @@ private static int validateHosts(Configuration config, Field field, ValidationOu\n         return count;\n     }\n \n-    private static int validateCollectionBlacklist(Configuration config, Field field, ValidationOutput problems) {\n-        return validateBlacklistField(config, problems, COLLECTION_WHITELIST, COLLECTION_BLACKLIST);\n-    }\n-\n-    private static int validateDatabaseBlacklist(Configuration config, Field field, ValidationOutput problems) {\n-        return validateBlacklistField(config, problems, DATABASE_WHITELIST, DATABASE_BLACKLIST);\n+    private static int validateCollectionExcludeList(Configuration config, Field field, ValidationOutput problems) {\n+        String whitelist = config.getFallbackStringProperty(COLLECTION_INCLUDE_LIST, COLLECTION_WHITELIST);\n+        String blacklist = config.getFallbackStringProperty(COLLECTION_EXCLUDE_LIST, COLLECTION_BLACKLIST);\n+        if (whitelist != null && blacklist != null) {\n+            problems.accept(COLLECTION_EXCLUDE_LIST, blacklist, COLLECTION_INCLUDE_LIST_ALREADY_SPECIFIED_ERROR_MSG);\n+            return 1;\n+        }\n+        return 0;\n     }\n \n-    private static int validateBlacklistField(Configuration config, ValidationOutput problems, Field fieldWhitelist, Field fieldBlacklist) {\n-        String whitelist = config.getString(fieldWhitelist);\n-        String blacklist = config.getString(fieldBlacklist);\n+    private static int validateDatabaseExcludeList(Configuration config, Field field, ValidationOutput problems) {\n+        String whitelist = config.getFallbackStringProperty(DATABASE_INCLUDE_LIST, DATABASE_WHITELIST);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2ODcyMA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469168720", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-12T10:42:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNDkzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNTU1Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469105557", "bodyText": "So changes like these add to the huge size of the single commit. Let's try and keep them in separate commits next time, so one can focus on the actual change vs. refactorings/clean-up when reviewing.", "author": "gunnarmorling", "createdAt": "2020-08-12T08:49:17Z", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbSchema.java", "diffHunk": "@@ -113,7 +114,7 @@ public boolean tableInformationComplete() {\n     @Override\n     public void assureNonEmptySchema() {\n         if (collections.isEmpty()) {\n-            LOGGER.warn(\"After applying blacklist/whitelist filters there are no tables to monitor, please check your configuration\");\n+            LOGGER.warn(RelationalDatabaseSchema.NO_MONITORED_TABLES_WARNING);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2OTk3Mg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469169972", "bodyText": "good idea. will do housekeeping commits for such things in the future", "author": "rk3rn3r", "createdAt": "2020-08-12T10:45:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNTU1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNjU0NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469106545", "bodyText": "Creative :) In general tests should be really 100% reproduceable, but I can get behind the deviation in this case.\nProbably good though to add a log message which one has been chosen, so to aid analyzing test failures.", "author": "gunnarmorling", "createdAt": "2020-08-12T08:50:51Z", "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/Configurator.java", "diffHunk": "@@ -45,23 +45,38 @@ public Configurator maxBatchSize(int maxBatchSize) {\n     }\n \n     public Configurator includeDatabases(String regexList) {\n-        return with(MongoDbConnectorConfig.DATABASE_WHITELIST, regexList);\n+        if (Math.random() >= 0.5) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE0NTY5OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469145699", "bodyText": "+1, will add log messages", "author": "rk3rn3r", "createdAt": "2020-08-12T09:57:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNjU0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE2ODg1OA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469168858", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-12T10:42:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNjU0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNzMyMg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469107322", "bodyText": "So is this one actually new? If not, then it'd have been nice to do the file rename in a separate commit.", "author": "gunnarmorling", "createdAt": "2020-08-12T08:52:10Z", "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/FieldExcludeListIT.java", "diffHunk": "@@ -0,0 +1,1274 @@\n+/*", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3MDgwMw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469170803", "bodyText": "It's not new. It's a copy of FieldBlacklistIT.java with the global config using the new field.exlude.list property instead of field.blacklist in order to test the old and the new property.", "author": "rk3rn3r", "createdAt": "2020-08-12T10:47:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNzMyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5Mjk5Ng==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469192996", "bodyText": "Ok; would also have been a great thing to leave for a separate commit. Makes it much easier to skim over it. Next time :)", "author": "gunnarmorling", "createdAt": "2020-08-12T11:34:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwNzMyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwODI4MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469108280", "bodyText": "Ah, I didn't think of that usage within the offsets. Go figure.", "author": "gunnarmorling", "createdAt": "2020-08-12T08:53:41Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/Filters.java", "diffHunk": "@@ -125,26 +127,41 @@ public Builder(Configuration config) {\n          * @return this\n          */\n         public Builder setFiltersFromOffsets(Map<String, ?> offsets) {\n-            setFiltersFromStrings((String) offsets.get(SourceInfo.DATABASE_WHITELIST_KEY), (String) offsets.get(SourceInfo.DATABASE_BLACKLIST_KEY),\n-                    (String) offsets.get(SourceInfo.TABLE_WHITELIST_KEY), (String) offsets.get(SourceInfo.TABLE_BLACKLIST_KEY));\n+            String dbIncludeList = (String) offsets.get(SourceInfo.DATABASE_INCLUDE_LIST_KEY);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE4MjA1Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469182057", "bodyText": "I implemented with a fallback here too so old configs are still working the new version, but we only write new keys. BTW, I couldn't find any implementation like that for the other connectors. I think we are using the Relational handling and they are serialized in a different/common way?", "author": "rk3rn3r", "createdAt": "2020-08-12T11:10:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwODI4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5MzYxNg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469193616", "bodyText": "Yes, this there only for MySQL. It relates to the incubating support for filter config changes which currently only exist for MySQL. Unfortunately, it has some conceptual flaws as we found out, so the current plan is to have a new implementation as part of the framework and MySQL will eventually be able to benefit from that, too.", "author": "gunnarmorling", "createdAt": "2020-08-12T11:36:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwODI4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwOTM5NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469109394", "bodyText": "Woul have been a tad nicer to leave the existing field as is, again reducing the size of the change.", "author": "gunnarmorling", "createdAt": "2020-08-12T08:55:27Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/MySqlConnectorConfig.java", "diffHunk": "@@ -616,50 +619,74 @@ public static GtidNewChannelPosition parse(String value, String defaultValue) {\n             .withImportance(Importance.LOW)\n             .withValidation(Field::isClassName)\n             .withDescription(\"JDBC Driver class name used to connect to the MySQL database server.\");\n+\n     /**\n      * A comma-separated list of regular expressions that match database names to be monitored.\n-     * May not be used with {@link #DATABASE_BLACKLIST}.\n+     * Must not be used with {@link #DATABASE_BLACKLIST}.\n      */\n-    public static final Field DATABASE_WHITELIST = Field.create(DATABASE_WHITELIST_NAME)\n+    public static final Field DATABASE_INCLUDE_LIST = Field.create(DATABASE_INCLUDE_LIST_NAME)", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE4Mjg1OA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469182858", "bodyText": "they are still there (mostly unchanged). I think just the diff comparison doesn't recognize what belongs together.", "author": "rk3rn3r", "createdAt": "2020-08-12T11:12:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwOTM5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5MzcyMQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469193721", "bodyText": "Ok!", "author": "gunnarmorling", "createdAt": "2020-08-12T11:36:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwOTM5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwOTgxNg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469109816", "bodyText": "Can you add \"Please use 'database.include.list' instead.\" (here and elsewhere)?", "author": "gunnarmorling", "createdAt": "2020-08-12T08:56:08Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/MySqlConnectorConfig.java", "diffHunk": "@@ -616,50 +619,74 @@ public static GtidNewChannelPosition parse(String value, String defaultValue) {\n             .withImportance(Importance.LOW)\n             .withValidation(Field::isClassName)\n             .withDescription(\"JDBC Driver class name used to connect to the MySQL database server.\");\n+\n     /**\n      * A comma-separated list of regular expressions that match database names to be monitored.\n-     * May not be used with {@link #DATABASE_BLACKLIST}.\n+     * Must not be used with {@link #DATABASE_BLACKLIST}.\n      */\n-    public static final Field DATABASE_WHITELIST = Field.create(DATABASE_WHITELIST_NAME)\n+    public static final Field DATABASE_INCLUDE_LIST = Field.create(DATABASE_INCLUDE_LIST_NAME)\n             .withDisplayName(\"Databases\")\n             .withType(Type.LIST)\n             .withWidth(Width.LONG)\n             .withImportance(Importance.HIGH)\n-            .withDependents(TABLE_WHITELIST_NAME)\n+            .withDependents(TABLE_INCLUDE_LIST_NAME, TABLE_WHITELIST_NAME)\n             .withDescription(\"The databases for which changes are to be captured\");\n \n+    /**\n+     * Old, backwards-compatible \"whitelist\" property.\n+     */\n+    public static final Field DATABASE_WHITELIST = Field.create(DATABASE_WHITELIST_NAME)\n+            .withDisplayName(\"Databases\")\n+            .withType(Type.LIST)\n+            .withWidth(Width.LONG)\n+            .withImportance(Importance.HIGH)\n+            .withDependents(TABLE_INCLUDE_LIST_NAME, TABLE_WHITELIST_NAME)\n+            .withDescription(\"The databases for which changes are to be captured (deprecated)\");", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE4ODk5MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469188991", "bodyText": "updated (hopefully) everywhere. Done.", "author": "rk3rn3r", "createdAt": "2020-08-12T11:26:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEwOTgxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExMDE3NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469110174", "bodyText": "As you're writing this comment now, it should say \"exclude\" property.", "author": "gunnarmorling", "createdAt": "2020-08-12T08:56:44Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/MySqlConnectorConfig.java", "diffHunk": "@@ -616,50 +619,74 @@ public static GtidNewChannelPosition parse(String value, String defaultValue) {\n             .withImportance(Importance.LOW)\n             .withValidation(Field::isClassName)\n             .withDescription(\"JDBC Driver class name used to connect to the MySQL database server.\");\n+\n     /**\n      * A comma-separated list of regular expressions that match database names to be monitored.\n-     * May not be used with {@link #DATABASE_BLACKLIST}.\n+     * Must not be used with {@link #DATABASE_BLACKLIST}.\n      */\n-    public static final Field DATABASE_WHITELIST = Field.create(DATABASE_WHITELIST_NAME)\n+    public static final Field DATABASE_INCLUDE_LIST = Field.create(DATABASE_INCLUDE_LIST_NAME)\n             .withDisplayName(\"Databases\")\n             .withType(Type.LIST)\n             .withWidth(Width.LONG)\n             .withImportance(Importance.HIGH)\n-            .withDependents(TABLE_WHITELIST_NAME)\n+            .withDependents(TABLE_INCLUDE_LIST_NAME, TABLE_WHITELIST_NAME)\n             .withDescription(\"The databases for which changes are to be captured\");\n \n+    /**\n+     * Old, backwards-compatible \"whitelist\" property.\n+     */\n+    public static final Field DATABASE_WHITELIST = Field.create(DATABASE_WHITELIST_NAME)\n+            .withDisplayName(\"Databases\")\n+            .withType(Type.LIST)\n+            .withWidth(Width.LONG)\n+            .withImportance(Importance.HIGH)\n+            .withDependents(TABLE_INCLUDE_LIST_NAME, TABLE_WHITELIST_NAME)\n+            .withDescription(\"The databases for which changes are to be captured (deprecated)\");\n+\n     /**\n      * A comma-separated list of regular expressions that match database names to be excluded from monitoring.\n-     * May not be used with {@link #DATABASE_WHITELIST}.\n+     * Must not be used with {@link #DATABASE_INCLUDE_LIST}.\n      */\n-    public static final Field DATABASE_BLACKLIST = Field.create(DATABASE_BLACKLIST_NAME)\n+    public static final Field DATABASE_EXCLUDE_LIST = Field.create(DATABASE_EXCLUDE_LIST_NAME)\n             .withDisplayName(\"Exclude Databases\")\n             .withType(Type.STRING)\n             .withWidth(Width.LONG)\n             .withImportance(Importance.MEDIUM)\n-            .withValidation(MySqlConnectorConfig::validateDatabaseBlacklist)\n+            .withValidation(MySqlConnectorConfig::validateDatabaseExcludeList)\n+            .withInvisibleRecommender()\n+            .withDescription(\"A comma-separated list of regular expressions that match database names to be excluded from monitoring\");\n+\n+    /**\n+     * Old, backwards-compatible \"blacklist\" property.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5MDM1Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469190357", "bodyText": "this is the blacklist property field. it's just thought from the other side. can I leave it instead of replacing all these comments?", "author": "rk3rn3r", "createdAt": "2020-08-12T11:29:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExMDE3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxNTU3NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469715574", "bodyText": "You can leave it as is, but I find it a bit inconsistent. We also want to get away from the legacy terms within the code base, so in a descriptive comment like this, the new terminology would make more sense IMHO.", "author": "gunnarmorling", "createdAt": "2020-08-13T06:02:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExMDE3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExMDY2NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469110665", "bodyText": "Seems validateTableExcludeList went missing?", "author": "gunnarmorling", "createdAt": "2020-08-12T08:57:32Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/MySqlConnectorConfig.java", "diffHunk": "@@ -1020,21 +1049,11 @@ private static int validateInconsistentSchemaHandlingModeNotIgnore(Configuration\n         return 0;\n     }\n \n-    private static int validateDatabaseBlacklist(Configuration config, Field field, ValidationOutput problems) {\n-        String whitelist = config.getString(DATABASE_WHITELIST);\n-        String blacklist = config.getString(DATABASE_BLACKLIST);\n-        if (whitelist != null && blacklist != null) {\n-            problems.accept(DATABASE_BLACKLIST, blacklist, \"Whitelist is already specified\");\n-            return 1;\n-        }\n-        return 0;\n-    }\n-\n-    private static int validateTableBlacklist(Configuration config, Field field, ValidationOutput problems) {\n-        String whitelist = config.getString(TABLE_WHITELIST);\n-        String blacklist = config.getString(TABLE_BLACKLIST);\n+    private static int validateDatabaseExcludeList(Configuration config, Field field, ValidationOutput problems) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3NjM4OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469176389", "bodyText": "field TABLE_EXCLUDE_LIST is inherited from io.debezium.relational.RelationalDatabaseConnectorConfig#TABLE_EXCLUDE_LIST where the validation is taking place as well.", "author": "rk3rn3r", "createdAt": "2020-08-12T10:58:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExMDY2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5Mzg2Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469193867", "bodyText": "Ah, that's nice!", "author": "gunnarmorling", "createdAt": "2020-08-12T11:36:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExMDY2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNDM2Mw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469114363", "bodyText": "Better to leave these kinds of changes for a separate clean-up commit. You can do git add --patch in order to isolate them.", "author": "gunnarmorling", "createdAt": "2020-08-12T09:04:03Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/SnapshotReaderIT.java", "diffHunk": "@@ -557,14 +586,10 @@ public void shouldSnapshotTablesInLexicographicalOrder() throws Exception {\n         assertArrayEquals(tablesInOrder.toArray(), tablesInOrderExpected.toArray());\n     }\n \n-    private Function<SourceRecord, String> getTableNameFromSourceRecord = sourceRecord -> ((Struct) sourceRecord.value()).getStruct(\"source\").getString(\"table\");\n+    private final Function<SourceRecord, String> getTableNameFromSourceRecord = sourceRecord -> ((Struct) sourceRecord.value()).getStruct(\"source\").getString(\"table\");\n \n     private LinkedHashSet<String> getTableNamesInSpecifiedOrder(String... tables) {\n-        LinkedHashSet<String> tablesInOrderExpected = new LinkedHashSet<>();\n-        for (String table : tables) {\n-            tablesInOrderExpected.add(table);\n-        }\n-        return tablesInOrderExpected;\n+        return new LinkedHashSet<>(Arrays.asList(tables));", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNjczNg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469116736", "bodyText": "We usually import assertThat statically.", "author": "gunnarmorling", "createdAt": "2020-08-12T09:08:14Z", "path": "debezium-connector-postgres/src/test/java/io/debezium/connector/postgresql/TablesWithoutPrimaryKeyIT.java", "diffHunk": "@@ -42,6 +42,28 @@ public void before() throws SQLException {\n     public void shouldProcessFromSnapshot() throws Exception {\n         TestHelper.execute(STATEMENTS);\n \n+        start(PostgresConnector.class, TestHelper.defaultConfig()\n+                .with(PostgresConnectorConfig.SNAPSHOT_MODE, SnapshotMode.INITIAL_ONLY)\n+                .with(PostgresConnectorConfig.SCHEMA_INCLUDE_LIST, \"nopk\")\n+                .build());\n+        assertConnectorIsRunning();\n+\n+        final int expectedRecordsCount = 1 + 1 + 1;\n+\n+        TestConsumer consumer = testConsumer(expectedRecordsCount, \"nopk\");\n+        consumer.await(TestHelper.waitTimeForRecords(), TimeUnit.SECONDS);\n+        final Map<String, List<SourceRecord>> recordsByTopic = recordsByTopic(expectedRecordsCount, consumer);\n+        Assertions.assertThat(recordsByTopic.get(\"test_server.nopk.t1\").get(0).keySchema().field(\"pk\")).isNotNull();", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3NjcyMQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469176721", "bodyText": "Makes sense. I just copied code here.", "author": "rk3rn3r", "createdAt": "2020-08-12T10:59:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNjczNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNzMxNg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469117316", "bodyText": "Do you see a big gain by making local vars final? I know @jpechane and I disagree on that, personally I think it's just noise and doesn't help really. Can you please come in my camp so we can outnumber @jpechane ;)", "author": "gunnarmorling", "createdAt": "2020-08-12T09:09:11Z", "path": "debezium-connector-postgres/src/test/java/io/debezium/connector/postgresql/TablesWithoutPrimaryKeyIT.java", "diffHunk": "@@ -42,6 +42,28 @@ public void before() throws SQLException {\n     public void shouldProcessFromSnapshot() throws Exception {\n         TestHelper.execute(STATEMENTS);\n \n+        start(PostgresConnector.class, TestHelper.defaultConfig()\n+                .with(PostgresConnectorConfig.SNAPSHOT_MODE, SnapshotMode.INITIAL_ONLY)\n+                .with(PostgresConnectorConfig.SCHEMA_INCLUDE_LIST, \"nopk\")\n+                .build());\n+        assertConnectorIsRunning();\n+\n+        final int expectedRecordsCount = 1 + 1 + 1;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3NzYwNw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469177607", "bodyText": "immutability for the win! like this they can be for example directly been used inside lambda context.", "author": "rk3rn3r", "createdAt": "2020-08-12T11:00:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNzMxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMDY3OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469720679", "bodyText": "Which you don't do here, though :)", "author": "gunnarmorling", "createdAt": "2020-08-13T06:18:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExNzMxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExODI3MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469118270", "bodyText": "Why did you change the name? We don't add the \"test\" really (although it's handled a bit incosistently; my personal preference is something like \"blacklistedColumnShouldNotShowUpInChangeEvent\", i.e. describing the expectation/intention behind the test.", "author": "gunnarmorling", "createdAt": "2020-08-12T09:10:49Z", "path": "debezium-connector-sqlserver/src/test/java/io/debezium/connector/sqlserver/SnapshotIT.java", "diffHunk": "@@ -311,7 +311,7 @@ public void takeSchemaOnlySnapshotAndSendHeartbeat() throws Exception {\n \n     @Test\n     @FixFor(\"DBZ-1067\")\n-    public void blacklistColumn() throws Exception {\n+    public void testBlacklistColumn() throws Exception {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE3OTcxNA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469179714", "bodyText": "we always have \"should\" everywhere, LOL. just personally I find it's easier to see if something is actually a test (when my brain fades out the \"@test\" annotation) when it starts with test/should prefix. and I think there are prefixes everywhere for actual test cases and no prefix for helper methods. just thought it is off (personal OCD mind)", "author": "rk3rn3r", "createdAt": "2020-08-12T11:05:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExODI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5NDIzOA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469194238", "bodyText": "Well, the annotation really is the hint that something is a test method. No need to duplicate that information into the name.", "author": "gunnarmorling", "createdAt": "2020-08-12T11:37:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExODI3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExODg1Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469118857", "bodyText": "Same comment as above: all those should rather go into a separate housekeeping commit (mentioning it for next time, no need to change now).", "author": "gunnarmorling", "createdAt": "2020-08-12T09:11:52Z", "path": "debezium-core/src/main/java/io/debezium/config/CommonConnectorConfig.java", "diffHunk": "@@ -166,17 +166,17 @@ public static EventProcessingFailureHandlingMode parse(String value) {\n         /**\n          * Represent binary values as byte array\n          */\n-        BYTES(\"bytes\", () -> SchemaBuilder.bytes()),\n+        BYTES(\"bytes\", SchemaBuilder::bytes),", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE0NjAzMQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469146031", "bodyText": "okay. will do next time", "author": "rk3rn3r", "createdAt": "2020-08-12T09:57:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTExODg1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMjMwMA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469122300", "bodyText": "Do we indeed need to expose all of them? Ideally, access only would be via getFilters().", "author": "gunnarmorling", "createdAt": "2020-08-12T09:17:31Z", "path": "debezium-core/src/main/java/io/debezium/relational/RelationalDatabaseConnectorConfig.java", "diffHunk": "@@ -383,11 +464,36 @@ public Duration snapshotLockTimeout() {\n         return Duration.ofMillis(getConfig().getLong(SNAPSHOT_LOCK_TIMEOUT_MS));\n     }\n \n-    private static int validateColumnBlacklist(Configuration config, Field field, Field.ValidationOutput problems) {\n-        String whitelist = config.getString(COLUMN_WHITELIST);\n-        String blacklist = config.getString(COLUMN_BLACKLIST);\n-        if (whitelist != null && blacklist != null) {\n-            problems.accept(COLUMN_BLACKLIST, blacklist, \"Column whitelist is already specified\");\n+    public String schemaExcludeList() {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE0Njg5Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469146897", "bodyText": "see the comment on the PostgresConnectorConfig. I moved and renamed them from there. I think it's architecture-wise the best way to have getters here and avoiding access to properties by config.getString(....) etc.", "author": "rk3rn3r", "createdAt": "2020-08-12T09:59:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMjMwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5NDczMg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469194732", "bodyText": "Yes, that's better. But eventually, the raw filter properties shouldn't be exposed at all, rather only the Filters class should provide the access. But it seems you're saying that right now we still need to do this?", "author": "gunnarmorling", "createdAt": "2020-08-12T11:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMjMwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMjA4Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469722087", "bodyText": "That's still pending?", "author": "gunnarmorling", "createdAt": "2020-08-13T06:22:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMjMwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg3ODQ3Mw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469878473", "bodyText": "I think we should do this in a future refactoring. maybe introduce a FiltersConfig in the relational namespace?\nWhat do you mean with \"pending\"? Is it okay like this or what do you think needs to be done? @gunnarmorling\nI logged https://issues.redhat.com/browse/DBZ-2431 for the refactoring", "author": "rk3rn3r", "createdAt": "2020-08-13T11:18:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMjMwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTkyNDg5Mw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469924893", "bodyText": "Thanks for logging that one. We can discuss this over there.", "author": "gunnarmorling", "createdAt": "2020-08-13T12:47:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMjMwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469123766", "bodyText": "No mention of the actual properties for Db2?", "author": "gunnarmorling", "createdAt": "2020-08-12T09:20:06Z", "path": "documentation/modules/ROOT/pages/connectors/db2.adoc", "diffHunk": "@@ -22,10 +22,10 @@ SQL based polling model of tables put into \"capture mode\". This uses the ASN lib\n In order to use ASN and hence this connector, you need to have a license for the IBM InfoSphere Data Replication (IIDR) product.\n It is not required that IIDR itself is installed.\n \n-The first time it connects to a Db2 database, it reads a consistent snapshot of all of the tables that are whitelisted (or not blacklisted depending on the mode of operation).", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyNTM1Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469125357", "bodyText": "If so indeed, can you please log an issue and assign it to @TovaCohen? Thx!", "author": "gunnarmorling", "createdAt": "2020-08-12T09:22:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE0OTQ4NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469149485", "bodyText": "DB2 is in the incubator repo. I will need to update incubator connectors in another PR. What should in general happen to incubator connectors are they always pointing to the recent DBZ version or frozen to a specific (maybe older) version until such changes on core are applied in the incubator repo as well?", "author": "rk3rn3r", "createdAt": "2020-08-12T10:04:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE1MDIzNQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469150235", "bodyText": "maybe we should reason about moving incubator to a directory in this repo and have it mono-repo-ed? would make such changes easier.", "author": "rk3rn3r", "createdAt": "2020-08-12T10:05:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5NTA0OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469195049", "bodyText": "Usually we send two PRs, stating on the incubator one that it requires the core PR xzy.", "author": "gunnarmorling", "createdAt": "2020-08-12T11:39:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMjk2MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469722961", "bodyText": "Note my question was about those props apparently being undocumented for Db2. If you can confirm this, can you please log an issue? Thx!", "author": "gunnarmorling", "createdAt": "2020-08-13T06:24:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg4MzIwOA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469883208", "bodyText": "misunderstanding, sorry! with my comment I meant that they are documented, but I didn't update the config yet because I wasn't sure on how we handle incubator connectors.", "author": "rk3rn3r", "createdAt": "2020-08-13T11:28:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTkyNDA5Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469924097", "bodyText": "Ah, gotcha now. Your call whether you'd do the doc update for the incubator connectors as part of this PR, or send another PR for that alongside the incubator PR for the actual code changes.", "author": "gunnarmorling", "createdAt": "2020-08-13T12:46:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk1MDg5Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469950897", "bodyText": "I am currently working through the Db2 connector doc. I completely rewrote the sentence that this comment thread is about. The sentence is now: \"When the connector starts, it performs a consistent snapshot] of the Db2 database tables that the connector is configured to capture changes for. \"  So you don't need to update the Db2 doc. Okay?", "author": "TovaCohen", "createdAt": "2020-08-13T13:29:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk3NTU4OA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469975588", "bodyText": "Thank you @TovaCohen!\n@gunnarmorling I decided to do the incubator connector changes first because the old properties will still be supported and I can't estimate how much time I will need to do the incubator connectors. It would be bad if I change the docs now and it will take >1 week to get the incubator changes out of the door and people read docs that are not up to date with code changes.", "author": "rk3rn3r", "createdAt": "2020-08-13T14:03:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTEyMzc2Ng=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxNDA1Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469714057", "bodyText": "\"Relational...\" shouldn't be referenced from any MongoDB related code. Move the constant to DatabaseSchema then, and rename it into NO_CAPTURED_DATA_COLLECTIONS_WARNING (we want to move away from \"monitor\" when it comes to describing capturing changes, and we use \"data collection\" as common term for tables, MongoDB collections etc.", "author": "gunnarmorling", "createdAt": "2020-08-13T05:58:09Z", "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/MongoDbConnectorIT.java", "diffHunk": "@@ -656,7 +665,7 @@ public void shouldConsumeEventsFromCollectionWithReplacedTopicName() throws Inte\n         // ---------------------------------------------------------------------------------------------------------------\n         // Stop the connector\n         // ---------------------------------------------------------------------------------------------------------------\n-        stopConnector(value -> assertThat(logInterceptor.containsWarnMessage(NO_MONITORED_TABLES_WARNING)).isFalse());\n+        stopConnector(value -> assertThat(logInterceptor.containsWarnMessage(RelationalDatabaseSchema.NO_MONITORED_TABLES_WARNING)).isFalse());", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg4Mzc0OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469883749", "bodyText": "good point! will do", "author": "rk3rn3r", "createdAt": "2020-08-13T11:29:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxNDA1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAxMzAyMw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470013023", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-13T14:54:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxNDA1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxNjczMA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469716730", "bodyText": "Should use new names?", "author": "gunnarmorling", "createdAt": "2020-08-13T06:06:30Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/LegacyV1SourceInfoTest.java", "diffHunk": "@@ -158,6 +158,23 @@ public void shouldRecoverSourceInfoFromOffsetWithNonZeroBinlogCoordinatesAndNonZ\n \n     @Test\n     public void shouldRecoverSourceInfoFromOffsetWithFilterData() {\n+        final String databaseWhitelist = \"a,b\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg4NDE0MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469884141", "bodyText": "not in tests, like we agreed in the discussion on what we are going to change. that will blow up the PR a lot!", "author": "rk3rn3r", "createdAt": "2020-08-13T11:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxNjczMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTkyMjg1OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469922859", "bodyText": "Hum, ok. Can you create a follow-up Jira issue for this then. Thx.", "author": "gunnarmorling", "createdAt": "2020-08-13T12:44:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxNjczMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAxOTI2NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470019264", "bodyText": "I logged https://issues.redhat.com/browse/DBZ-2433 for this", "author": "rk3rn3r", "createdAt": "2020-08-13T15:02:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxNjczMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxODE5NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469718195", "bodyText": "Same here?", "author": "gunnarmorling", "createdAt": "2020-08-13T06:11:23Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/LegacyV1SourceInfoTest.java", "diffHunk": "@@ -158,6 +158,23 @@ public void shouldRecoverSourceInfoFromOffsetWithNonZeroBinlogCoordinatesAndNonZ\n \n     @Test\n     public void shouldRecoverSourceInfoFromOffsetWithFilterData() {\n+        final String databaseWhitelist = \"a,b\";\n+        final String tableWhitelist = \"c.foo,d.bar,d.baz\";\n+        Map<String, String> offset = offset(10, 10);\n+        offset.put(SourceInfo.DATABASE_INCLUDE_LIST_KEY, databaseWhitelist);\n+        offset.put(SourceInfo.TABLE_INCLUDE_LIST_KEY, tableWhitelist);\n+\n+        sourceWith(offset);\n+        assertThat(source.hasFilterInfo()).isTrue();\n+        assertEquals(databaseWhitelist, source.getDatabaseIncludeList());\n+        assertEquals(tableWhitelist, source.getTableIncludeList());\n+        // confirm other filter info is null\n+        assertThat(source.getDatabaseExcludeList()).isNull();\n+        assertThat(source.getTableExcludeList()).isNull();\n+    }\n+\n+    @Test\n+    public void shouldRecoverSourceInfoFromOffsetWithFilterDataOld() {\n         final String databaseWhitelist = \"a,b\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg4NDI1Ng==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469884256", "bodyText": "yep. same here^^", "author": "rk3rn3r", "createdAt": "2020-08-13T11:30:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxODE5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxODUwNg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469718506", "bodyText": "Same here?", "author": "gunnarmorling", "createdAt": "2020-08-13T06:12:10Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/LegacyV1SourceInfoTest.java", "diffHunk": "@@ -182,15 +199,35 @@ public void setOffsetFilterFromFilter() {\n         sourceWith(offset);\n         assertThat(!source.hasFilterInfo());\n \n+        final Configuration configuration = Configuration.create()\n+                .with(MySqlConnectorConfig.DATABASE_EXCLUDE_LIST, databaseBlacklist)\n+                .with(MySqlConnectorConfig.TABLE_EXCLUDE_LIST, tableBlacklist)\n+                .build();\n+        source.setFilterDataFromConfig(configuration);\n+\n+        assertThat(source.hasFilterInfo()).isTrue();\n+        assertEquals(databaseBlacklist, source.getDatabaseExcludeList());", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxOTI3MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469719271", "bodyText": "Should use new names? The only time a var should use the old names is when it actually refers to the old property/key in some backwards compat test.", "author": "gunnarmorling", "createdAt": "2020-08-13T06:14:20Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/SourceInfoTest.java", "diffHunk": "@@ -165,15 +165,32 @@ public void shouldRecoverSourceInfoFromOffsetWithFilterData() {\n \n         sourceWith(offset);\n         assertThat(source.hasFilterInfo()).isTrue();\n-        assertEquals(databaseWhitelist, source.getDatabaseWhitelist());\n-        assertEquals(tableWhitelist, source.getTableWhitelist());\n+        assertEquals(databaseWhitelist, source.getDatabaseIncludeList());\n+        assertEquals(tableWhitelist, source.getTableIncludeList());\n         // confirm other filter info is null\n-        assertThat(source.getDatabaseBlacklist()).isNull();\n-        assertThat(source.getTableBlacklist()).isNull();\n+        assertThat(source.getDatabaseExcludeList()).isNull();\n+        assertThat(source.getTableExcludeList()).isNull();\n     }\n \n     @Test\n-    public void setOffsetFilterFromFilter() {\n+    public void shouldRecoverSourceInfoFromOffsetWithFilterData() {\n+        final String databaseWhitelist = \"a,b\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAxOTYyMQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470019621", "bodyText": "same here as well!", "author": "rk3rn3r", "createdAt": "2020-08-13T15:02:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxOTI3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAyMDE2NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470020164", "bodyText": "in https://issues.redhat.com/browse/DBZ-2433 I described it like old property tests can have old names, but we always prefer new / non-divisive names.", "author": "rk3rn3r", "createdAt": "2020-08-13T15:03:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxOTI3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxOTMzNQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469719335", "bodyText": "Same here.", "author": "gunnarmorling", "createdAt": "2020-08-13T06:14:31Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/SourceInfoTest.java", "diffHunk": "@@ -188,8 +205,28 @@ public void setOffsetFilterFromFilter() {\n         source.setFilterDataFromConfig(configuration);\n \n         assertThat(source.hasFilterInfo()).isTrue();\n-        assertEquals(databaseBlacklist, source.getDatabaseBlacklist());\n-        assertEquals(tableBlacklist, source.getTableBlacklist());\n+        assertEquals(databaseBlacklist, source.getDatabaseExcludeList());", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxOTM4NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469719384", "bodyText": "Same here.", "author": "gunnarmorling", "createdAt": "2020-08-13T06:14:40Z", "path": "debezium-connector-mysql/src/test/java/io/debezium/connector/mysql/SourceInfoTest.java", "diffHunk": "@@ -188,8 +205,28 @@ public void setOffsetFilterFromFilter() {\n         source.setFilterDataFromConfig(configuration);\n \n         assertThat(source.hasFilterInfo()).isTrue();\n-        assertEquals(databaseBlacklist, source.getDatabaseBlacklist());\n-        assertEquals(tableBlacklist, source.getTableBlacklist());\n+        assertEquals(databaseBlacklist, source.getDatabaseExcludeList());\n+        assertEquals(tableBlacklist, source.getTableExcludeList());\n+    }\n+\n+    @Test\n+    public void setOffsetFilterFromFilter() {\n+        final String databaseBlacklist = \"a,b\";", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMDAzNA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469720034", "bodyText": "The orginal closing brace position made more sense actually. This will be rendered as a link labeled \"specified\".", "author": "gunnarmorling", "createdAt": "2020-08-13T06:16:31Z", "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/PostgresSchema.java", "diffHunk": "@@ -35,7 +35,7 @@\n /**\n  * Component that records the schema information for the {@link PostgresConnector}. The schema information contains\n  * the {@link Tables table definitions} and the Kafka Connect {@link #schemaFor(TableId) Schema}s for each table, where the\n- * {@link Schema} excludes any columns that have been {@link PostgresConnectorConfig#COLUMN_BLACKLIST specified} in the\n+ * {@link Schema} excludes any columns that have been {@link PostgresConnectorConfig#COLUMN_EXCLUDE_LIST} specified in the", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk5NTQ0MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469995440", "bodyText": "ok. will do", "author": "rk3rn3r", "createdAt": "2020-08-13T14:30:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMDAzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAyMDU2Ng==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470020566", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-13T15:04:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMDAzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMDg4MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469720881", "bodyText": "Would still prefer the static import.", "author": "gunnarmorling", "createdAt": "2020-08-13T06:18:53Z", "path": "debezium-connector-postgres/src/test/java/io/debezium/connector/postgresql/TablesWithoutPrimaryKeyIT.java", "diffHunk": "@@ -62,6 +84,29 @@ public void shouldProcessFromSnapshot() throws Exception {\n \n     @Test\n     public void shouldProcessFromStreaming() throws Exception {\n+        start(PostgresConnector.class, TestHelper.defaultConfig()\n+                .with(PostgresConnectorConfig.SNAPSHOT_MODE, SnapshotMode.NEVER)\n+                .with(PostgresConnectorConfig.SCHEMA_INCLUDE_LIST, \"nopk\")\n+                .build());\n+        assertConnectorIsRunning();\n+        waitForStreamingToStart();\n+\n+        TestHelper.execute(STATEMENTS);\n+\n+        final int expectedRecordsCount = 1 + 1 + 1;\n+\n+        TestConsumer consumer = testConsumer(expectedRecordsCount, \"nopk\");\n+        consumer.await(TestHelper.waitTimeForRecords(), TimeUnit.SECONDS);\n+        final Map<String, List<SourceRecord>> recordsByTopic = recordsByTopic(expectedRecordsCount, consumer);\n+        Assertions.assertThat(recordsByTopic.get(\"test_server.nopk.t1\").get(0).keySchema().field(\"pk\")).isNotNull();", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAwMDA5NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470000094", "bodyText": "There are many occurences everywhere. I logged https://issues.redhat.com/browse/DBZ-2432 to change it everywhere, + not covering it in this PR", "author": "rk3rn3r", "createdAt": "2020-08-13T14:36:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMDg4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMTU5OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r469721599", "bodyText": "I didn't check, do we log a warning somewhere when using the old names?", "author": "gunnarmorling", "createdAt": "2020-08-13T06:20:50Z", "path": "debezium-core/src/main/java/io/debezium/config/Configuration.java", "diffHunk": "@@ -2097,4 +2097,33 @@ default void forEachMatchingFieldName(Pattern regex, BiConsumer<String, String>\n     default <T> void forEach(BiConsumer<String, String> function) {\n         this.asMap().forEach(function);\n     }\n+\n+    /**\n+     * Returns the string config value from newProperty config field if it's set or its default value when it's not\n+     * set/null.If both are null it returns the value of the oldProperty config field, or its default value when it's\n+     * null.\n+     * This fallback only works for newProperty fields that have a null / not-set default value!\n+     *\n+     * @param newProperty the new property config field\n+     * @param oldProperty the old / fallback property config field\n+     * @return the evaluated value\n+     */\n+    default String getFallbackStringProperty(Field newProperty, Field oldProperty) {\n+        return getString(newProperty, () -> getString(oldProperty));", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAwMTI5MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470001290", "bodyText": "no, I will add logging to the lambda.", "author": "rk3rn3r", "createdAt": "2020-08-13T14:37:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMTU5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAyMDc3Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470020777", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-13T15:04:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcyMTU5OQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzODM3MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470438370", "bodyText": "Let's better avoid getting a new logger instance for each call and put it into a static field as done elsewhere.", "author": "gunnarmorling", "createdAt": "2020-08-14T06:39:54Z", "path": "debezium-core/src/main/java/io/debezium/config/Configuration.java", "diffHunk": "@@ -2097,4 +2097,47 @@ default void forEachMatchingFieldName(Pattern regex, BiConsumer<String, String>\n     default <T> void forEach(BiConsumer<String, String> function) {\n         this.asMap().forEach(function);\n     }\n+\n+    /**\n+     * Returns the string config value from newProperty config field if it's set or its default value when it's not\n+     * set/null.If both are null it returns the value of the oldProperty config field, or its default value when it's\n+     * null.\n+     * This fallback only works for newProperty fields that have a null / not-set default value!\n+     *\n+     * @param newProperty the new property config field\n+     * @param oldProperty the old / fallback property config field\n+     * @return the evaluated value\n+     */\n+    default String getFallbackStringProperty(Field newProperty, Field oldProperty) {\n+        return getString(\n+                newProperty,\n+                () -> {\n+                    LoggerFactory.getLogger(Configuration.class).warn(\"Using configuration property \\\"\" + oldProperty.name()\n+                            + \"\\\" is deprecated and will be removed in future versions. Please use \\\"\" + newProperty.name()\n+                            + \"\\\" instead.\");\n+                    return getString(oldProperty);\n+                });\n+    }\n+\n+    /**\n+     * Returns the string config value of the provided Configuration from newProperty config field if it's set or its\n+     * default value when it's not set/null.If both are null it returns the value of the oldProperty config field, or\n+     * its default value when it's null.\n+     * This fallback only works for newProperty fields that have a null / not-set default value!\n+     *\n+     * @param newProperty the new property config field\n+     * @param oldProperty the old / fallback property config field\n+     * @return the evaluated value\n+     */\n+    static String getFallbackStringProperty(Configuration config, Field newProperty, Field oldProperty) {\n+        return config.getString(\n+                newProperty,\n+                () -> {\n+                    LoggerFactory.getLogger(Configuration.class).warn(\"Using configuration property \\\"\" + oldProperty.name()", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MTgxMg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470441812", "bodyText": "Same in the other method.", "author": "gunnarmorling", "createdAt": "2020-08-14T06:49:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzODM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU0NDQ4OA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470544488", "bodyText": "Where to get the logger from? I put it there and it's in prod only called when loading config.\nThis is an interface. The only other option would be a public CONFIGURATION_LOGGER accessible from everywhere. Are you fine with that?", "author": "rk3rn3r", "createdAt": "2020-08-14T10:28:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzODM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyMDYwMw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472720603", "bodyText": "@rk3rn3r  The best approach would probably be an auxilliary io.debezium.config.Loggers with package protected members but I feel it would be a little bit of overengineering. I think public static attribute is acceptable in this case.", "author": "jpechane", "createdAt": "2020-08-19T05:38:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzODM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwNTM0Mg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473005342", "bodyText": "Oh yes, interesting solution. But I agree, then I will revert to my previous version with the public member. thanks for the feedback @jpechane", "author": "rk3rn3r", "createdAt": "2020-08-19T12:53:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzODM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzMzA5Ng==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473133096", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-19T15:51:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzODM3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTA4NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470439085", "bodyText": "For MongoDB we shouldn't talk about tables. Perhaps \"table/collections\"? and please replace \"monitor\" with \"to capture changes from\". We want to get away from \"monitor\" in this context, and keep that for, well, monitoring the connectors via JMX etc.", "author": "gunnarmorling", "createdAt": "2020-08-14T06:41:55Z", "path": "debezium-core/src/main/java/io/debezium/schema/DatabaseSchema.java", "diffHunk": "@@ -15,6 +15,8 @@\n  */\n public interface DatabaseSchema<I extends DataCollectionId> {\n \n+    String NO_CAPTURED_DATA_COLLECTIONS_WARNING = \"After applying include/exclude list filters there are no tables to monitor, please check your configuration\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU3MzU1Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470573557", "bodyText": "will do String NO_CAPTURED_DATA_COLLECTIONS_WARNING = \"After applying include/exclude list filters there's nothing selected to capture changes from, please check your configuration\";", "author": "rk3rn3r", "createdAt": "2020-08-14T11:40:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTA4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU3Mzk1NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470573954", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-14T11:41:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTA4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTUyNQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470439525", "bodyText": "@jcechace, can you check out this one. This could actually be a problem when using the current test suite with older versions as I think you do?", "author": "gunnarmorling", "createdAt": "2020-08-14T06:43:08Z", "path": "debezium-testing/debezium-testing-openshift/src/test/java/io/debezium/testing/openshift/resources/ConnectorFactories.java", "diffHunk": "@@ -29,7 +29,7 @@ public ConnectorConfigBuilder mysql() {\n                 .put(\"database.user\", ConfigProperties.DATABASE_MYSQL_DBZ_USERNAME)\n                 .put(\"database.password\", ConfigProperties.DATABASE_MYSQL_DBZ_PASSWORD)\n                 .put(\"database.server.name\", \"mysqldb\") // this should be overwritten with unique name\n-                .put(\"database.whitelist\", \"inventory\") // might want to change", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTMxMjEzOQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r471312139", "bodyText": "Removing it certainly is not a good idea :). I'd say replace it with the new property and I will fix backward compatibility in separate PR.", "author": "jcechace", "createdAt": "2020-08-17T08:09:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTMxMzU4OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r471313589", "bodyText": "it's not removed @jcechace. Look at the full diff. Just Github diff here shows it in a bad way", "author": "rk3rn3r", "createdAt": "2020-08-17T08:12:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTMxNzM4Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r471317387", "bodyText": "Ah, I see. It should be all right then. Tis should be OK then. The question is whether are we going to backport it to downstream? If yes then I certainly do need to update the compatibility earlier. Anyway I'd solve this in separate PR", "author": "jcechace", "createdAt": "2020-08-17T08:19:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTMyMDU2OA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r471320568", "bodyText": "@jpechane do you happen to know if this will be backported?", "author": "rk3rn3r", "createdAt": "2020-08-17T08:25:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEyMjU2OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473122569", "bodyText": "@jpechane \ud83d\udc46", "author": "rk3rn3r", "createdAt": "2020-08-19T15:36:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3ODU0MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473178541", "bodyText": "@rk3rn3r, I don't think this is something we're going to back-port.  It's meant to be a part of 1.3+ afaik.", "author": "Naros", "createdAt": "2020-08-19T16:52:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQzOTUyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MTcxMw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470441713", "bodyText": "Why is this not static final any longer? It really should be.", "author": "gunnarmorling", "createdAt": "2020-08-14T06:49:39Z", "path": "debezium-core/src/main/java/io/debezium/config/Configuration.java", "diffHunk": "@@ -60,7 +60,7 @@\n @Immutable\n public interface Configuration {\n \n-    public static final Pattern PASSWORD_PATTERN = Pattern.compile(\".*password$|.*sasl\\\\.jaas\\\\.config$\", Pattern.CASE_INSENSITIVE);\n+    Pattern PASSWORD_PATTERN = Pattern.compile(\".*password$|.*sasl\\\\.jaas\\\\.config$\", Pattern.CASE_INSENSITIVE);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU0NTA0Ng==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r470545046", "bodyText": "It's an interface. every member is public static final anyway.", "author": "rk3rn3r", "createdAt": "2020-08-14T10:30:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MTcxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcxODMyMQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472718321", "bodyText": "@rk3rn3r  Please remove this change as in other intefaces we follow the same convention.", "author": "jpechane", "createdAt": "2020-08-19T05:34:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MTcxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5MzkwOQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472993909", "bodyText": "@jpechane what do you mean? this code doesn't change anything? every member var already is public static final\nShouldn't we instead create a task to clean the other code as well?", "author": "rk3rn3r", "createdAt": "2020-08-19T12:34:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MTcxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwNTMwMw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473005303", "bodyText": "@rk3rn3r ok, my proposal then is to keep the line as is and create a task with proposal of removing those modifiers globally. If agreed upon we can add formatter rule to enforce it.", "author": "jpechane", "createdAt": "2020-08-19T12:53:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MTcxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzExNzcwMg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473117702", "bodyText": "I filed https://issues.redhat.com/browse/DBZ-2439 for this \u2764\ufe0f", "author": "rk3rn3r", "createdAt": "2020-08-19T15:28:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ0MTcxMw=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTMxNDQwNA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r471314404", "bodyText": "watch this! @jcechace", "author": "rk3rn3r", "createdAt": "2020-08-17T08:14:10Z", "path": "debezium-testing/debezium-testing-openshift/src/test/java/io/debezium/testing/openshift/resources/ConnectorFactories.java", "diffHunk": "@@ -29,7 +29,7 @@ public ConnectorConfigBuilder mysql() {\n                 .put(\"database.user\", ConfigProperties.DATABASE_MYSQL_DBZ_USERNAME)\n                 .put(\"database.password\", ConfigProperties.DATABASE_MYSQL_DBZ_PASSWORD)\n                 .put(\"database.server.name\", \"mysqldb\") // this should be overwritten with unique name\n-                .put(\"database.whitelist\", \"inventory\") // might want to change\n+                .put(\"database.include.list\", \"inventory\") // might want to change", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyNTU0NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472725544", "bodyText": "@rk3rn3r Shouldn't be the importance of oboslete fields reduced to LOW? It might have an impact on UI side.\nAlso I recommend to\n\nUse withInvisibleRecommender\nPrefix DisplayName with Deprecated:  prefix", "author": "jpechane", "createdAt": "2020-08-19T05:45:32Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/MySqlConnectorConfig.java", "diffHunk": "@@ -616,50 +619,75 @@ public static GtidNewChannelPosition parse(String value, String defaultValue) {\n             .withImportance(Importance.LOW)\n             .withValidation(Field::isClassName)\n             .withDescription(\"JDBC Driver class name used to connect to the MySQL database server.\");\n+\n     /**\n      * A comma-separated list of regular expressions that match database names to be monitored.\n-     * May not be used with {@link #DATABASE_BLACKLIST}.\n+     * Must not be used with {@link #DATABASE_BLACKLIST}.\n      */\n-    public static final Field DATABASE_WHITELIST = Field.create(DATABASE_WHITELIST_NAME)\n+    public static final Field DATABASE_INCLUDE_LIST = Field.create(DATABASE_INCLUDE_LIST_NAME)\n             .withDisplayName(\"Databases\")\n             .withType(Type.LIST)\n             .withWidth(Width.LONG)\n             .withImportance(Importance.HIGH)\n-            .withDependents(TABLE_WHITELIST_NAME)\n+            .withDependents(TABLE_INCLUDE_LIST_NAME, TABLE_WHITELIST_NAME)\n             .withDescription(\"The databases for which changes are to be captured\");\n \n+    /**\n+     * Old, backwards-compatible \"whitelist\" property.\n+     */\n+    public static final Field DATABASE_WHITELIST = Field.create(DATABASE_WHITELIST_NAME)\n+            .withDisplayName(\"Databases\")\n+            .withType(Type.LIST)\n+            .withWidth(Width.LONG)\n+            .withImportance(Importance.HIGH)", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5ODg3MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472998871", "bodyText": "Yep, I missed that change. Will do!\nAdding the InvisibleRecommender is a good idea!", "author": "rk3rn3r", "createdAt": "2020-08-19T12:42:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyNTU0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzNTEzMg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473135132", "bodyText": "Done: applied the prefix and InvisibleRecommender everywhere", "author": "rk3rn3r", "createdAt": "2020-08-19T15:54:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyNTU0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjczMDYxMA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472730610", "bodyText": "@rk3rn3r Should not be invisible blacklist, not exclude?", "author": "jpechane", "createdAt": "2020-08-19T05:53:03Z", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbConnectorConfig.java", "diffHunk": "@@ -236,47 +239,89 @@ public static SnapshotMode parse(String value, String defaultValue) {\n \n     /**\n      * A comma-separated list of regular expressions that match the databases to be monitored.\n-     * May not be used with {@link #DATABASE_BLACKLIST}.\n+     * Must not be used with {@link #DATABASE_EXCLUDE_LIST}.\n      */\n-    public static final Field DATABASE_WHITELIST = Field.create(\"database.whitelist\")\n-            .withDisplayName(\"DB Whitelist\")\n+    public static final Field DATABASE_INCLUDE_LIST = Field.create(\"database.include.list\")\n+            .withDisplayName(\"Database Include List\")\n             .withType(Type.LIST)\n             .withWidth(Width.LONG)\n             .withImportance(Importance.HIGH)\n             .withValidation(Field::isListOfRegex,\n-                    MongoDbConnectorConfig::validateDatabaseBlacklist)\n+                    MongoDbConnectorConfig::validateDatabaseExcludeList)\n             .withDescription(\"The databases for which changes are to be captured\");\n \n+    /**\n+     * Old, backwards-compatible \"whitelist\" property.\n+     */\n+    public static final Field DATABASE_WHITELIST = Field.create(\"database.whitelist\")\n+            .withDisplayName(\"Database Whitelist\")\n+            .withType(Type.LIST)\n+            .withWidth(Width.LONG)\n+            .withImportance(Importance.LOW)\n+            .withValidation(Field::isListOfRegex,\n+                    MongoDbConnectorConfig::validateDatabaseExcludeList)\n+            .withDescription(\"The databases for which changes are to be captured (deprecated, use \\\"\" + DATABASE_INCLUDE_LIST.name() + \"\\\" instead)\");\n+\n     /**\n      * A comma-separated list of regular expressions that match the databases to be excluded.\n-     * May not be used with {@link #DATABASE_WHITELIST}.\n+     * Must not be used with {@link #DATABASE_INCLUDE_LIST}.\n      */\n-    public static final Field DATABASE_BLACKLIST = Field.create(\"database.blacklist\")\n-            .withDisplayName(\"DB Blacklist\")\n+    public static final Field DATABASE_EXCLUDE_LIST = Field.create(\"database.exclude.list\")\n+            .withDisplayName(\"Database Exclude List\")\n             .withType(Type.LIST)\n             .withWidth(Width.LONG)\n             .withImportance(Importance.HIGH)\n             .withValidation(Field::isListOfRegex)\n             .withDescription(\"The databases for which changes are to be excluded\");\n \n+    /**\n+     * Old, backwards-compatible \"blacklist\" property.\n+     */\n+    public static final Field DATABASE_BLACKLIST = Field.create(\"database.blacklist\")\n+            .withDisplayName(\"DB Blacklist\")\n+            .withType(Type.LIST)\n+            .withWidth(Width.LONG)\n+            .withImportance(Importance.LOW)\n+            .withValidation(Field::isListOfRegex)\n+            .withDescription(\"The databases for which changes are to be excluded (deprecated, use \\\"\" + DATABASE_EXCLUDE_LIST.name() + \"\\\" instead)\");\n+\n     /**\n      * A comma-separated list of regular expressions that match the fully-qualified namespaces of collections to be monitored.\n      * Fully-qualified namespaces for collections are of the form {@code <databaseName>.<collectionName>}.\n-     * May not be used with {@link #COLLECTION_BLACKLIST}.\n+     * Must not be used with {@link #COLLECTION_EXCLUDE_LIST}.\n      */\n-    public static final Field COLLECTION_WHITELIST = Field.create(\"collection.whitelist\")\n-            .withDisplayName(\"Collections\")\n+    public static final Field COLLECTION_INCLUDE_LIST = Field.create(\"collection.include.list\")\n+            .withDisplayName(\"Collections Include List\")\n             .withType(Type.LIST)\n             .withWidth(Width.LONG)\n             .withImportance(Importance.HIGH)\n             .withValidation(Field::isListOfRegex,\n-                    MongoDbConnectorConfig::validateCollectionBlacklist)\n+                    MongoDbConnectorConfig::validateCollectionExcludeList)\n             .withDescription(\"The collections for which changes are to be captured\");\n \n+    /**\n+     * Old, backwards-compatible \"whitelist\" property.\n+     */\n+    public static final Field COLLECTION_WHITELIST = Field.create(\"collection.whitelist\")\n+            .withDisplayName(\"Collections Whitelist\")\n+            .withType(Type.LIST)\n+            .withWidth(Width.LONG)\n+            .withImportance(Importance.LOW)\n+            .withValidation(Field::isListOfRegex,\n+                    MongoDbConnectorConfig::validateCollectionExcludeList)\n+            .withDescription(\"The collections for which changes are to be captured (deprecated, use \\\"\" + COLLECTION_INCLUDE_LIST.name() + \"\\\" instead)\");\n+\n     /**\n      * A comma-separated list of regular expressions that match the fully-qualified namespaces of collections to be excluded from\n      * monitoring. Fully-qualified namespaces for collections are of the form {@code <databaseName>.<collectionName>}.\n-     * May not be used with {@link #COLLECTION_WHITELIST}.\n+     * Must not be used with {@link #COLLECTION_INCLUDE_LIST}.\n+     */\n+    public static final Field COLLECTION_EXCLUDE_LIST = Field.create(\"collection.exclude.list\")\n+            .withValidation(Field::isListOfRegex)\n+            .withInvisibleRecommender();", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5NjE1Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472996157", "bodyText": "both are invisible. see the next few lines", "author": "rk3rn3r", "createdAt": "2020-08-19T12:38:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjczMDYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzcwMDI3OA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473700278", "bodyText": "I really wonder what was the rationale behind having blacklist invisible. But let's keep it as is now.", "author": "jpechane", "createdAt": "2020-08-20T07:35:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjczMDYxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgyNjE5Ng==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473826196", "bodyText": "The reason was that it is not shown/recommended because it can be invalid to set a blacklist when a whitelist is already defined (at least according to the docs of InvisivbleRecommender). I think there should be a DependentRecommender that automatically shows or hides based on predicates that works with the provided config?", "author": "rk3rn3r", "createdAt": "2020-08-20T09:46:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjczMDYxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjczMzA2MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472733060", "bodyText": "Should it use Configurator.withXXX method?", "author": "jpechane", "createdAt": "2020-08-19T05:56:31Z", "path": "debezium-connector-mongodb/src/test/java/io/debezium/connector/mongodb/ConnectionIT.java", "diffHunk": "@@ -40,8 +40,8 @@ public void setUp() {\n     @Test\n     public void shouldCreateMovieDatabase() {\n         useConfiguration(config.edit()\n-                .with(MongoDbConnectorConfig.DATABASE_WHITELIST, \"dbA,dbB\")\n-                .with(MongoDbConnectorConfig.COLLECTION_BLACKLIST, \"dbB.moviesB\")\n+                .with(MongoDbConnectorConfig.DATABASE_INCLUDE_LIST, \"dbA,dbB\")", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5NzIzNA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472997234", "bodyText": "I didn't change the code, just updated the const name. Maybe log an easy-starter issue to change this everywhere? Do we want to get rid of the \"Config-Editor\"?", "author": "rk3rn3r", "createdAt": "2020-08-19T12:40:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjczMzA2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MjA0OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472742049", "bodyText": "As I think about that should not the warning be emitted when either old name or both new and old names are present?", "author": "jpechane", "createdAt": "2020-08-19T06:09:38Z", "path": "debezium-core/src/main/java/io/debezium/config/Configuration.java", "diffHunk": "@@ -2097,4 +2097,47 @@ default void forEachMatchingFieldName(Pattern regex, BiConsumer<String, String>\n     default <T> void forEach(BiConsumer<String, String> function) {\n         this.asMap().forEach(function);\n     }\n+\n+    /**\n+     * Returns the string config value from newProperty config field if it's set or its default value when it's not\n+     * set/null.If both are null it returns the value of the oldProperty config field, or its default value when it's\n+     * null.\n+     * This fallback only works for newProperty fields that have a null / not-set default value!\n+     *\n+     * @param newProperty the new property config field\n+     * @param oldProperty the old / fallback property config field\n+     * @return the evaluated value\n+     */\n+    default String getFallbackStringProperty(Field newProperty, Field oldProperty) {\n+        return getString(", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwNzkxMg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473007912", "bodyText": "Not just silently using the documented (newer) version when both are there? I could add a warning but might be quite irrelevant, wdyt?\nI would personally leave it for a future Debezium version that removes the legacy (blacklist/whitelist) properties completely and then fail on configs that still have both properties.", "author": "rk3rn3r", "createdAt": "2020-08-19T12:57:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MjA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY5ODM2Mg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473698362", "bodyText": "I'd rather have a warning - just in case there are two persons working with connector config and each updates different param. In this case it is one more safety to avoid config inconsistency", "author": "jpechane", "createdAt": "2020-08-20T07:34:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MjA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg0NTg1Ng==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473845856", "bodyText": "yep. will do that", "author": "rk3rn3r", "createdAt": "2020-08-20T10:10:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MjA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg1NDk2MA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473854960", "bodyText": "Done. And also changed the code to call the static method instead of the duplicated code.", "author": "rk3rn3r", "createdAt": "2020-08-20T10:21:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MjA0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0NjExNg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r472746116", "bodyText": "How about using getOrDefault method to simplify the code?", "author": "jpechane", "createdAt": "2020-08-19T06:15:30Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/SourceInfo.java", "diffHunk": "@@ -501,19 +505,42 @@ public void setOffset(Map<String, ?> sourceOffset) {\n             this.restartEventsToSkip = longOffsetValue(sourceOffset, EVENTS_TO_SKIP_OFFSET_KEY);\n             nextSnapshot = booleanOffsetValue(sourceOffset, SNAPSHOT_KEY);\n             lastSnapshot = nextSnapshot;\n-            this.databaseWhitelist = (String) sourceOffset.get(DATABASE_WHITELIST_KEY);\n-            this.databaseBlacklist = (String) sourceOffset.get(DATABASE_BLACKLIST_KEY);\n-            this.tableWhitelist = (String) sourceOffset.get(TABLE_WHITELIST_KEY);\n-            this.tableBlacklist = (String) sourceOffset.get(TABLE_BLACKLIST_KEY);\n+            if (sourceOffset.containsKey(DATABASE_INCLUDE_LIST_KEY)) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwMjI1NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473002254", "bodyText": "I think this code is slightly faster or equal than the getOrDefault version. I would have used getOrDefault if I could've been able to pass a lambda as default but in the getOrDefault version I would need to do 2 complete value lookups. here it's a key existence check and fetching 1 entry from the map. it might be the same performance if both keys are in the same bucket but worse when in 2 different buckets.\nAnd from readablity I would say that getOrDefault might be harder to understand than this longer if-contains-then-else clause.", "author": "rk3rn3r", "createdAt": "2020-08-19T12:48:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0NjExNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzcwMDkyOA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473700928", "bodyText": "ok", "author": "jpechane", "createdAt": "2020-08-20T07:36:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0NjExNg=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzMDcxNA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473130714", "bodyText": "@Naros is the wording okay?", "author": "rk3rn3r", "createdAt": "2020-08-19T15:47:49Z", "path": "debezium-core/src/main/java/io/debezium/schema/DatabaseSchema.java", "diffHunk": "@@ -15,6 +15,8 @@\n  */\n public interface DatabaseSchema<I extends DataCollectionId> {\n \n+    String NO_CAPTURED_DATA_COLLECTIONS_WARNING = \"After applying include/exclude list filters there's nothing selected to capture changes from, please check your configuration\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3NTIxNw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473175217", "bodyText": "I think the following sounds more appropriate.  Wdyt?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String NO_CAPTURED_DATA_COLLECTIONS_WARNING = \"After applying include/exclude list filters there's nothing selected to capture changes from, please check your configuration\";\n          \n          \n            \n                String NO_CAPTURED_DATA_COLLECTIONS_WARNING = \"After applying the include/exclude list filters, no changes will be captured.  Please check your configuration.\";", "author": "Naros", "createdAt": "2020-08-19T16:46:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzMDcxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg0NjY0NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473846645", "bodyText": "\ud83e\udd37\u200d\u2642\ufe0f you are the pro!\nWill do it with the other commit", "author": "rk3rn3r", "createdAt": "2020-08-20T10:11:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzMDcxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg1NTU1OQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473855559", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-20T10:21:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzMDcxNA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzNDk4Mw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473134983", "bodyText": "I would prefer to see this and any other \"backwards-compatible\" fields annotated with @Deprecated too.  I don't intend to mark all occurrences in my review as this should suffice as a marker for all.", "author": "Naros", "createdAt": "2020-08-19T15:54:07Z", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbConnectorConfig.java", "diffHunk": "@@ -236,47 +239,89 @@ public static SnapshotMode parse(String value, String defaultValue) {\n \n     /**\n      * A comma-separated list of regular expressions that match the databases to be monitored.\n-     * May not be used with {@link #DATABASE_BLACKLIST}.\n+     * Must not be used with {@link #DATABASE_EXCLUDE_LIST}.\n      */\n-    public static final Field DATABASE_WHITELIST = Field.create(\"database.whitelist\")\n-            .withDisplayName(\"DB Whitelist\")\n+    public static final Field DATABASE_INCLUDE_LIST = Field.create(\"database.include.list\")\n+            .withDisplayName(\"Include Databases\")\n             .withType(Type.LIST)\n             .withWidth(Width.LONG)\n             .withImportance(Importance.HIGH)\n-            .withValidation(Field::isListOfRegex,\n-                    MongoDbConnectorConfig::validateDatabaseBlacklist)\n+            .withValidation(Field::isListOfRegex, MongoDbConnectorConfig::validateDatabaseExcludeList)\n             .withDescription(\"The databases for which changes are to be captured\");\n \n+    /**\n+     * Old, backwards-compatible \"whitelist\" property.\n+     */\n+    public static final Field DATABASE_WHITELIST = Field.create(\"database.whitelist\")", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgyMTI5NQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473821295", "bodyText": "good point! will do that", "author": "rk3rn3r", "createdAt": "2020-08-20T09:40:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzNDk4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg1NjE4Nw==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473856187", "bodyText": "Done. All old fields are now annotated.", "author": "rk3rn3r", "createdAt": "2020-08-20T10:22:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzEzNDk4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE1NTY2NA==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473155664", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * (e.g. in a blacklisted database), but none of them is in table.include.list.\n          \n          \n            \n                 * (e.g. in a excluded database), but none of them is in table.include.list.", "author": "Naros", "createdAt": "2020-08-19T16:23:24Z", "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/PostgresStreamingChangeEventSource.java", "diffHunk": "@@ -232,7 +232,7 @@ private void skipMessage(final Long lsn) throws SQLException, InterruptedExcepti\n      * acknowledged with the replication slot, causing any ever growing WAL backlog.\n      * <p>\n      * This situation typically occurs if there are changes on the database server,\n-     * (e.g. in a blacklisted database), but none of them is in a whitelisted table.\n+     * (e.g. in a blacklisted database), but none of them is in table.include.list.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgzMTkwNg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473831906", "bodyText": "very good, I missed that one. have to do another commit anyway so I will add it there", "author": "rk3rn3r", "createdAt": "2020-08-20T09:52:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE1NTY2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg1NjYwNQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473856605", "bodyText": "Done", "author": "rk3rn3r", "createdAt": "2020-08-20T10:23:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE1NTY2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3NjU3Mg==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473176572", "bodyText": "We introduced the {mysql-version} variable in this paragraph but the prior explicitly specifies 5.7.  I'd suggest this change be omitted and instead logged & applied as a separate task where we apply this to all references.", "author": "Naros", "createdAt": "2020-08-19T16:48:59Z", "path": "debezium-embedded/README.md", "diffHunk": "@@ -94,7 +94,7 @@ The next few lines define the fields that are specific to the connector, which i\n \n Here, we set the name of the host machine and port number where the MySQL database server is running, and we define the username and password that will be used to connect to the MySQL database. Note that for MySQL the username and password should correspond to a MySQL database user that has been granted the [`REPLICATION SLAVE` privilege](http://dev.mysql.com/doc/refman/5.7/en/replication-howto-repuser.html), allowing the database to read the server's binlog that is normally used for MySQL replication.\n \n-The configuration also includes a numeric identifier for the `server.id`. Since MySQL's binlog is part of the MySQL replication mechanism, in order to read the binlog the `MySqlConnector` instance must join the MySQL server group, and that means this server ID must be [unique within all processes that make up the MySQL server group](http://dev.mysql.com/doc/refman/5.7/en/replication-howto-masterbaseconfig.html) and is any integer between 1 and (2^32)\u22121. In our code we set it to a fairly large but somewhat random value we'll use only for our application.\n+The configuration also includes a numeric identifier for the `server.id`. Since MySQL's binlog is part of the MySQL replication mechanism, in order to read the binlog the `MySqlConnector` instance must join the MySQL server group, and that means this server ID must be [unique within all processes that make up the MySQL server group](http://dev.mysql.com/doc/refman/{mysql-version}/en/replication-howto-masterbaseconfig.html) and is any integer between 1 and (2^32)\u22121. In our code we set it to a fairly large but somewhat random value we'll use only for our application.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg0OTU4MQ==", "url": "https://github.com/debezium/debezium/pull/1750#discussion_r473849581", "bodyText": "I checked the link and fixed it everywhere/all references. yes, this is housekeeping, but imo it will make more work for me now to revert than to leave it like it is now?", "author": "rk3rn3r", "createdAt": "2020-08-20T10:14:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3NjU3Mg=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "90205c5a34b8727f5a685c2f43789d441fd4b2f0", "url": "https://github.com/debezium/debezium/commit/90205c5a34b8727f5a685c2f43789d441fd4b2f0", "message": "DBZ-2171 avoid divisive language", "committedDate": "2020-08-20T10:25:03Z", "type": "commit"}, {"oid": "90205c5a34b8727f5a685c2f43789d441fd4b2f0", "url": "https://github.com/debezium/debezium/commit/90205c5a34b8727f5a685c2f43789d441fd4b2f0", "message": "DBZ-2171 avoid divisive language", "committedDate": "2020-08-20T10:25:03Z", "type": "forcePushed"}]}