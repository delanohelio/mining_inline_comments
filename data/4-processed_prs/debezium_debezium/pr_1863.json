{"pr_number": 1863, "pr_title": "DBZ-2597 Fix ConcurrentModificationException when schema modified in sharded cluster", "pr_createdAt": "2020-10-02T17:48:06Z", "pr_url": "https://github.com/debezium/debezium/pull/1863", "timeline": [{"oid": "954f2bcd7e968d5ca002225da1c0850aa905f9bd", "url": "https://github.com/debezium/debezium/commit/954f2bcd7e968d5ca002225da1c0850aa905f9bd", "message": "DBZ-2597 Fix ConcurrentModificationException when schema modified in sharded cluster", "committedDate": "2020-10-02T17:47:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODk4MjcyMw==", "url": "https://github.com/debezium/debezium/pull/1863#discussion_r498982723", "bodyText": "Can you change the variable type to ConcurrentInterface to and also see whether some of our marker annotations like @ThreadSafe, Immutable etc. can be added? Thx!", "author": "gunnarmorling", "createdAt": "2020-10-02T18:25:12Z", "path": "debezium-connector-mongodb/src/main/java/io/debezium/connector/mongodb/MongoDbSchema.java", "diffHunk": "@@ -56,7 +57,7 @@\n     private final Schema sourceSchema;\n     private final SchemaNameAdjuster adjuster = SchemaNameAdjuster.create(LOGGER);\n     private final Function<Document, String> valueTransformer;\n-    private final Map<CollectionId, MongoDbCollectionSchema> collections = new HashMap<>();\n+    private final Map<CollectionId, MongoDbCollectionSchema> collections = new ConcurrentHashMap<>();", "originalCommit": "954f2bcd7e968d5ca002225da1c0850aa905f9bd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0d5c6e7823c78830ee5a439df9e7de818029dbe6", "url": "https://github.com/debezium/debezium/commit/0d5c6e7823c78830ee5a439df9e7de818029dbe6", "message": "DBZ-2597 Suggested changes", "committedDate": "2020-10-02T19:08:42Z", "type": "commit"}, {"oid": "0d5c6e7823c78830ee5a439df9e7de818029dbe6", "url": "https://github.com/debezium/debezium/commit/0d5c6e7823c78830ee5a439df9e7de818029dbe6", "message": "DBZ-2597 Suggested changes", "committedDate": "2020-10-02T19:08:42Z", "type": "forcePushed"}]}