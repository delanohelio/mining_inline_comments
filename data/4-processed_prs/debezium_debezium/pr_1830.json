{"pr_number": 1830, "pr_title": "DBZ-2583 MySQL connector - ignore statement-based logs", "pr_createdAt": "2020-09-23T15:41:22Z", "pr_url": "https://github.com/debezium/debezium/pull/1830", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDIwNDQ0MA==", "url": "https://github.com/debezium/debezium/pull/1830#discussion_r494204440", "bodyText": "Do we really need a new option for this? Couldn't this also be controlled via eventDeserializationFailureHandlingMode?", "author": "gunnarmorling", "createdAt": "2020-09-24T10:24:22Z", "path": "debezium-connector-mysql/src/main/java/io/debezium/connector/mysql/BinlogReader.java", "diffHunk": "@@ -100,6 +100,7 @@\n     private final Clock clock;\n     private final ElapsedTimeStrategy pollOutputDelay;\n     private final EventProcessingFailureHandlingMode eventDeserializationFailureHandlingMode;\n+    private final EventProcessingFailureHandlingMode eventStatementFailureHandlingMode;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI0OTE2OQ==", "url": "https://github.com/debezium/debezium/pull/1830#discussion_r494249169", "bodyText": "Hi, I will remake it, but I'll ask first: how much does mysql connector care about backward / forward compatibility of configs vs programs?\nIn case you don't care, it's better to merge the options and I'll do it. But if you do care about having compatible options (and unchanged behavior on upgrade), then we have to have another option to avoid changing features without announcing it first somehow.", "author": "petoju", "createdAt": "2020-09-24T11:45:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDIwNDQ0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI4NTA2Mw==", "url": "https://github.com/debezium/debezium/pull/1830#discussion_r494285063", "bodyText": "Good point; we do care about compatibility, a lot :)\nSo the default behavior of that setting is FAIL, i.e. in that case there'd be no behavioral change. Only if someone had set it to WARN or IGNORE, they'd now not longer fail on unexpected \"statement\" style rows but move forward. Which seems ok-ish to me, but I also could understand someone finding this not acceptable.\n@jpechane, @rk3rn3r, @Naros, any thoughts on this?", "author": "gunnarmorling", "createdAt": "2020-09-24T12:42:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDIwNDQ0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI5MTcyNg==", "url": "https://github.com/debezium/debezium/pull/1830#discussion_r494291726", "bodyText": "@gunnarmorling IMHO this is fine as during the start of connector we check the global setting of binlog_format.\nIn fact this could be even improvement as we had reports in the past that people switch to row-based rpelication but Debezium still refused to start as there were still old statemenet-based replication messages in the binlog. They were then asked to flush the binlog etc. This could be easier solution for such scenario.", "author": "jpechane", "createdAt": "2020-09-24T12:52:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDIwNDQ0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg0OTUyMA==", "url": "https://github.com/debezium/debezium/pull/1830#discussion_r495849520", "bodyText": "@jpechane sorry I don't fully understand. So what is \"this\", that could be easier solution? Is it the original PR or is it related to the suggested changes?", "author": "petoju", "createdAt": "2020-09-28T10:46:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDIwNDQ0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjQ2NzkyNg==", "url": "https://github.com/debezium/debezium/pull/1830#discussion_r496467926", "bodyText": "I am sorry for the confsion. IMHO we should just use the single eventDeserializationFailureHandlingMode for that purpose as proposed by @gunnarmorling . I don't think there is a real break in backward compatibility.", "author": "jpechane", "createdAt": "2020-09-29T07:14:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDIwNDQ0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjU4NDA0Nw==", "url": "https://github.com/debezium/debezium/pull/1830#discussion_r496584047", "bodyText": "Thanks, this should be fixed now.", "author": "petoju", "createdAt": "2020-09-29T09:44:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDIwNDQ0MA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "5c74fbe6ea3388e6929e1537bb8ea4daccf2cb1c", "url": "https://github.com/debezium/debezium/commit/5c74fbe6ea3388e6929e1537bb8ea4daccf2cb1c", "message": "DBZ-2583 MySQL connector - ignore statement-based logs\n\nCurrent mysql debezium connector fails once it sees an event generated\nwith statement or mixed based replication.\n\nAs users and programs can call SET SESSION binlog_format='STATEMENT'; as\nthey wish, they are able to break debezium connector. Only MySQL 8.0.14\nis fixing this, but not everyone is on that version.\n\nTo prevent connector crashing in such cases, there should be an option\nto log these issues and continue. That would be similar to processing\ninconsistent schema (on the setting level).", "committedDate": "2020-09-29T09:36:35Z", "type": "commit"}, {"oid": "5c74fbe6ea3388e6929e1537bb8ea4daccf2cb1c", "url": "https://github.com/debezium/debezium/commit/5c74fbe6ea3388e6929e1537bb8ea4daccf2cb1c", "message": "DBZ-2583 MySQL connector - ignore statement-based logs\n\nCurrent mysql debezium connector fails once it sees an event generated\nwith statement or mixed based replication.\n\nAs users and programs can call SET SESSION binlog_format='STATEMENT'; as\nthey wish, they are able to break debezium connector. Only MySQL 8.0.14\nis fixing this, but not everyone is on that version.\n\nTo prevent connector crashing in such cases, there should be an option\nto log these issues and continue. That would be similar to processing\ninconsistent schema (on the setting level).", "committedDate": "2020-09-29T09:36:35Z", "type": "forcePushed"}]}