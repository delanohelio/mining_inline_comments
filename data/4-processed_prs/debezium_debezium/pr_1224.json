{"pr_number": 1224, "pr_title": "DBZ-1687 DBZ-1729 Consolidate attributes, Antora process clean-up", "pr_createdAt": "2020-01-23T17:32:27Z", "pr_url": "https://github.com/debezium/debezium/pull/1224", "timeline": [{"oid": "e4966e63b5749f46ea2b402fbf7b77b5361bef2c", "url": "https://github.com/debezium/debezium/commit/e4966e63b5749f46ea2b402fbf7b77b5361bef2c", "message": "DBZ-1687 Migrated custom attributes to Antora component descriptor [ci-skip]", "committedDate": "2020-01-23T14:10:34Z", "type": "commit"}, {"oid": "6ae58ef3e28085a195ded471429fba471c7a1c2d", "url": "https://github.com/debezium/debezium/commit/6ae58ef3e28085a195ded471429fba471c7a1c2d", "message": "DBZ-1687 Moved several global, non-version attributes to playbook [ci-skip]", "committedDate": "2020-01-23T17:27:46Z", "type": "commit"}, {"oid": "22f316fa3838fa6cf3a174614479af5c95e0b3da", "url": "https://github.com/debezium/debezium/commit/22f316fa3838fa6cf3a174614479af5c95e0b3da", "message": "DBZ-1729 Updated DOCUMENTATION.md [ci-skip]", "committedDate": "2020-01-23T17:27:49Z", "type": "commit"}, {"oid": "0458b62bee89611971191660be90b709fba35254", "url": "https://github.com/debezium/debezium/commit/0458b62bee89611971191660be90b709fba35254", "message": "DBZ-1729 Change connector download url to use debezium-version attribute [ci-skip]", "committedDate": "2020-01-23T17:27:56Z", "type": "commit"}, {"oid": "6391903c1bc3b1030a931eb9de67797f50e8f99b", "url": "https://github.com/debezium/debezium/commit/6391903c1bc3b1030a931eb9de67797f50e8f99b", "message": "DBZ-1687 Align versions with current master [ci-skip]", "committedDate": "2020-01-23T17:28:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI5ODA3OQ==", "url": "https://github.com/debezium/debezium/pull/1224#discussion_r371298079", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Lets say we need to add an attribute that points to our JIRA issue for issue links, that would be an example of an attrbute that would be defined in the playbook.  But if we needed to add an attribute that points to a specific version of a naven artifact or reference a specific version of a dependency, that's more appropriate for the `antora.yml` component descriptor located in this repository. \n          \n          \n            \n            Lets say we need to add an attribute that points to our JIRA issue for issue links,\n          \n          \n            \n            that would be an example of an attrbute that would be defined in the playbook.\n          \n          \n            \n            But if we needed to add an attribute that points to a specific version of a Maven artifact or reference a specific version of a dependency,\n          \n          \n            \n            that's more appropriate for the `antora.yml` component descriptor located in this repository.", "author": "gunnarmorling", "createdAt": "2020-01-27T15:14:29Z", "path": "DOCUMENTATION.md", "diffHunk": "@@ -92,42 +92,77 @@ The `nav` attribute describes an array of navigation AsciiDoc files uses to buil\n \n The `version` attribute is the most important aspect of this file.  This designates the naming convention to be used when referencing what _version_ this documentation represents.  This can be an actual version number as shown above, in which case it should be quoted.  Other examples could be things like `stable` or `latest`.\n \n+**NOTE**: As of Antora 2.3, the `antora.yml` file can now define Asciidoc attributes, which are discussed below.\n+\n ### Attributes\n \n-Should a documentation page need to reference attributes, e.g. version numbers, this can be accomplished by importing the `_attributes.adoc` file in the `.adoc` documentation page.  If the attribute is new, its generally a good idea to update the `_attributes.adoc` with it so that it can be reused and updated in a single place.\n+Should a documentation page need to reference attributes, e.g. version numbers, this can be accomplished in two ways:\n+\n+1. Defined in the `antora.yml` component descriptor in this repository.\n+2. Defined in the Antora playbook files in the Debezium website repository.\n+\n+The general rule is if an attribute changes frequently or is related to a specific version or subset of versions of Debezium, it likely belongs in the `antora.yml` file in this repository.  If the attribute changes infrequent or is not specific to a given version of Debezium, its easier to maintain that in the various playbook files in the Debezium website repository.\n+\n+Lets say we need to add an attribute that points to our JIRA issue for issue links, that would be an example of an attrbute that would be defined in the playbook.  But if we needed to add an attribute that points to a specific version of a naven artifact or reference a specific version of a dependency, that's more appropriate for the `antora.yml` component descriptor located in this repository. ", "originalCommit": "6391903c1bc3b1030a931eb9de67797f50e8f99b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI5ODM4MQ==", "url": "https://github.com/debezium/debezium/pull/1224#discussion_r371298381", "bodyText": "Fixed a typo (naven) and also changed to \"one thought per line\" wrapping style. Let's stick to that for easier diffing in case of future changes.", "author": "gunnarmorling", "createdAt": "2020-01-27T15:14:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI5ODA3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI5OTAwOQ==", "url": "https://github.com/debezium/debezium/pull/1224#discussion_r371299009", "bodyText": "Same as above: can you change to one thought/sentence per line, avoiding super-long lines? Thanks!", "author": "gunnarmorling", "createdAt": "2020-01-27T15:15:53Z", "path": "DOCUMENTATION.md", "diffHunk": "@@ -92,42 +92,77 @@ The `nav` attribute describes an array of navigation AsciiDoc files uses to buil\n \n The `version` attribute is the most important aspect of this file.  This designates the naming convention to be used when referencing what _version_ this documentation represents.  This can be an actual version number as shown above, in which case it should be quoted.  Other examples could be things like `stable` or `latest`.\n \n+**NOTE**: As of Antora 2.3, the `antora.yml` file can now define Asciidoc attributes, which are discussed below.\n+\n ### Attributes\n \n-Should a documentation page need to reference attributes, e.g. version numbers, this can be accomplished by importing the `_attributes.adoc` file in the `.adoc` documentation page.  If the attribute is new, its generally a good idea to update the `_attributes.adoc` with it so that it can be reused and updated in a single place.\n+Should a documentation page need to reference attributes, e.g. version numbers, this can be accomplished in two ways:\n+\n+1. Defined in the `antora.yml` component descriptor in this repository.\n+2. Defined in the Antora playbook files in the Debezium website repository.\n+\n+The general rule is if an attribute changes frequently or is related to a specific version or subset of versions of Debezium, it likely belongs in the `antora.yml` file in this repository.  If the attribute changes infrequent or is not specific to a given version of Debezium, its easier to maintain that in the various playbook files in the Debezium website repository.\n+\n+Lets say we need to add an attribute that points to our JIRA issue for issue links, that would be an example of an attrbute that would be defined in the playbook.  But if we needed to add an attribute that points to a specific version of a naven artifact or reference a specific version of a dependency, that's more appropriate for the `antora.yml` component descriptor located in this repository. \n \n-The current attributes file looks similar to the following:\n+The current `antora.yml` component descriptor looks similar to the following:\n+```\n+asciidoc:\n+  attributes:\n+    debezium-version: '1.1.0.Final'\n+    debezium-dev-version: '1.2'\n+    debezium-kafka-version: '2.4.0'\n+    debezium-docker-label: '1.1'\n+    install-version: '1.1'\n+    assemblies: '../assemblies'\n+    modules: '../../modules'\n+    mysql-connector-plugin-download: 'https://repo1.maven.org/maven2/io/debezium/debezium-connector-mysql/1.1.0.Final/debezium-connector-mysql-1.1.0.Final-plugin.tar.gz'\n+    mysql-version: '8.0'\n+    confluent-platform-version: '5.3.1'\n+    strimzi-version: '0.13.0'\n ```\n-:moduledir: ..\n-:attachmentsdir: {moduledir}/assets/attachments\n-:examplesdir: {moduledir}/examples\n-:imagesdir: {moduledir}/assets/images\n-:partialsdir: {moduledir}/pages/_partials\n \n-:debezium-version: 0.10.0.Beta4\n-:debezium-dev-version: 0.10\n-:debezium-kafka-version: 2.3.0\n-:debezium-docker-label: 0.10\n-:install-version: 0.10\n-:confluent-platform-version: 5.1.2\n-:strimzi-version: 0.10.0\n+Attributes are defined by creating a nested yaml structure under `asciidoc.attributes` where the key-value attribute pairs are to be defined.  \n \n+The playbook files in the website repository use the same layout, shown here:\n ```\n+# Global asciidoc attributes here, used across all versions of documentation\n+asciidoc:\n+  attributes:\n+    prodname: 'Debezium'\n+    context: 'debezium'\n+    jira-url: 'https://issues.redhat.com'\n+    # because of how handlebars templates work with page.attributes, this must be prefixed with \"page-\"\n+    page-copyright-year: '2020'\n+``` \n \n-## What to change _after_ releasing new version\n+**NOTE**: Given that the Debezium documentation is consumed downstream by other processes, do not define attributes in the `_attributes.adoc` file and use it as an include nor should you define attributes locally in a given .adoc file.\n \n-It's important that 2 files be properly maintained after the repository transitions between releases\n+## What to change _before_ releasing a new version\n \n-* _attributes.adoc\n-* antora.yml\n+The `antora.yml` file in the `master` branch always uses version called _master_.  It is important right before a release when applying the change log and contributor changes to modify this file to reference the correct major and minor version.  It's also important to make any necessary changes to version-specific attributes in this file at the same time.", "originalCommit": "6391903c1bc3b1030a931eb9de67797f50e8f99b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTI5OTY3Ng==", "url": "https://github.com/debezium/debezium/pull/1224#discussion_r371299676", "bodyText": "That would better go to the release procedure document.", "author": "gunnarmorling", "createdAt": "2020-01-27T15:16:57Z", "path": "DOCUMENTATION.md", "diffHunk": "@@ -92,42 +92,77 @@ The `nav` attribute describes an array of navigation AsciiDoc files uses to buil\n \n The `version` attribute is the most important aspect of this file.  This designates the naming convention to be used when referencing what _version_ this documentation represents.  This can be an actual version number as shown above, in which case it should be quoted.  Other examples could be things like `stable` or `latest`.\n \n+**NOTE**: As of Antora 2.3, the `antora.yml` file can now define Asciidoc attributes, which are discussed below.\n+\n ### Attributes\n \n-Should a documentation page need to reference attributes, e.g. version numbers, this can be accomplished by importing the `_attributes.adoc` file in the `.adoc` documentation page.  If the attribute is new, its generally a good idea to update the `_attributes.adoc` with it so that it can be reused and updated in a single place.\n+Should a documentation page need to reference attributes, e.g. version numbers, this can be accomplished in two ways:\n+\n+1. Defined in the `antora.yml` component descriptor in this repository.\n+2. Defined in the Antora playbook files in the Debezium website repository.\n+\n+The general rule is if an attribute changes frequently or is related to a specific version or subset of versions of Debezium, it likely belongs in the `antora.yml` file in this repository.  If the attribute changes infrequent or is not specific to a given version of Debezium, its easier to maintain that in the various playbook files in the Debezium website repository.\n+\n+Lets say we need to add an attribute that points to our JIRA issue for issue links, that would be an example of an attrbute that would be defined in the playbook.  But if we needed to add an attribute that points to a specific version of a naven artifact or reference a specific version of a dependency, that's more appropriate for the `antora.yml` component descriptor located in this repository. \n \n-The current attributes file looks similar to the following:\n+The current `antora.yml` component descriptor looks similar to the following:\n+```\n+asciidoc:\n+  attributes:\n+    debezium-version: '1.1.0.Final'\n+    debezium-dev-version: '1.2'\n+    debezium-kafka-version: '2.4.0'\n+    debezium-docker-label: '1.1'\n+    install-version: '1.1'\n+    assemblies: '../assemblies'\n+    modules: '../../modules'\n+    mysql-connector-plugin-download: 'https://repo1.maven.org/maven2/io/debezium/debezium-connector-mysql/1.1.0.Final/debezium-connector-mysql-1.1.0.Final-plugin.tar.gz'\n+    mysql-version: '8.0'\n+    confluent-platform-version: '5.3.1'\n+    strimzi-version: '0.13.0'\n ```\n-:moduledir: ..\n-:attachmentsdir: {moduledir}/assets/attachments\n-:examplesdir: {moduledir}/examples\n-:imagesdir: {moduledir}/assets/images\n-:partialsdir: {moduledir}/pages/_partials\n \n-:debezium-version: 0.10.0.Beta4\n-:debezium-dev-version: 0.10\n-:debezium-kafka-version: 2.3.0\n-:debezium-docker-label: 0.10\n-:install-version: 0.10\n-:confluent-platform-version: 5.1.2\n-:strimzi-version: 0.10.0\n+Attributes are defined by creating a nested yaml structure under `asciidoc.attributes` where the key-value attribute pairs are to be defined.  \n \n+The playbook files in the website repository use the same layout, shown here:\n ```\n+# Global asciidoc attributes here, used across all versions of documentation\n+asciidoc:\n+  attributes:\n+    prodname: 'Debezium'\n+    context: 'debezium'\n+    jira-url: 'https://issues.redhat.com'\n+    # because of how handlebars templates work with page.attributes, this must be prefixed with \"page-\"\n+    page-copyright-year: '2020'\n+``` \n \n-## What to change _after_ releasing new version\n+**NOTE**: Given that the Debezium documentation is consumed downstream by other processes, do not define attributes in the `_attributes.adoc` file and use it as an include nor should you define attributes locally in a given .adoc file.\n \n-It's important that 2 files be properly maintained after the repository transitions between releases\n+## What to change _before_ releasing a new version\n \n-* _attributes.adoc\n-* antora.yml\n+The `antora.yml` file in the `master` branch always uses version called _master_.  It is important right before a release when applying the change log and contributor changes to modify this file to reference the correct major and minor version.  It's also important to make any necessary changes to version-specific attributes in this file at the same time.\n \n-### Attributes\n+So when releasing version 2.1 as an example, change `antora.yml` from:", "originalCommit": "6391903c1bc3b1030a931eb9de67797f50e8f99b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b8325a59f3d8d703af9631ac340c385abcf80fc1", "url": "https://github.com/debezium/debezium/commit/b8325a59f3d8d703af9631ac340c385abcf80fc1", "message": "DBZ-1729 Misc. suggested changes\n\n* Typos and formatting changes.\n* Moved release procedure steps from DOCUMENTATION.md to RELEASING.md.", "committedDate": "2020-01-27T18:26:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY1Njk2MA==", "url": "https://github.com/debezium/debezium/pull/1224#discussion_r371656960", "bodyText": "@jpechane, are you aware of this procedure?", "author": "gunnarmorling", "createdAt": "2020-01-28T08:16:26Z", "path": "RELEASING.md", "diffHunk": "@@ -30,6 +30,21 @@ It currently exists in two versions, one in the main code repo and one on the we\n JIRA issues that break backwards compatability for existing consumers, should be marked with the \"add-to-upgrade-guide\" label.\n Search for them using [this query](https://issues.jboss.org/issues/?jql=labels%20%3D%20add-to-upgrade-guide) and describe the implications and required steps for upgrading in the changelog on the website.\n \n+## Update antora.yml", "originalCommit": "b8325a59f3d8d703af9631ac340c385abcf80fc1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}