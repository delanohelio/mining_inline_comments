{"pr_number": 575, "pr_title": "Replicate handling of non-existent variables in ChunkResolver", "pr_createdAt": "2020-12-23T17:22:19Z", "pr_url": "https://github.com/HubSpot/jinjava/pull/575", "timeline": [{"oid": "12af952c58d5356852b2a4c3f67e8a3568e6cd58", "url": "https://github.com/HubSpot/jinjava/commit/12af952c58d5356852b2a4c3f67e8a3568e6cd58", "message": "Cancel out even number of backslashes for escaping", "committedDate": "2020-12-23T16:54:15Z", "type": "commit"}, {"oid": "a8fac7e00910d43977a83539a8b2b6263cd86f7f", "url": "https://github.com/HubSpot/jinjava/commit/a8fac7e00910d43977a83539a8b2b6263cd86f7f", "message": "Handle unknown variables like the rest of Jinjava in chunk resolver", "committedDate": "2020-12-23T17:07:45Z", "type": "commit"}, {"oid": "5f5338bc1bd92a71bd9fceb5c450a0312de8e885", "url": "https://github.com/HubSpot/jinjava/commit/5f5338bc1bd92a71bd9fceb5c450a0312de8e885", "message": "Add test for cancelling backslashes", "committedDate": "2020-12-23T17:14:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODA2NzkwNQ==", "url": "https://github.com/HubSpot/jinjava/pull/575#discussion_r548067905", "bodyText": "Here it's just set to the null character as prevChar is only used to check escaping. So setting it to the null character simply ignores the slash for escaping purposes, allowing any number of slashes to be back-to-back.", "author": "jasmith-hs", "createdAt": "2020-12-23T17:25:17Z", "path": "src/main/java/com/hubspot/jinjava/util/ChunkResolver.java", "diffHunk": "@@ -182,14 +184,23 @@ public String resolveChunks() {\n         }\n         continue;\n       }\n-      prevChar = c;\n+      setPrevChar(c);\n       tokenBuilder.append(c);\n     }\n     miniChunkBuilder.append(resolveToken(tokenBuilder.toString()));\n     chunks.add(resolveChunk(miniChunkBuilder.toString()));\n     return chunks;\n   }\n \n+  private void setPrevChar(char c) {\n+    if (c == '\\\\' && prevChar == '\\\\') {\n+      // Backslashes cancel each other out for escaping when there's an even number.\n+      prevChar = '\\0';", "originalCommit": "5f5338bc1bd92a71bd9fceb5c450a0312de8e885", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}