{"pr_number": 2466, "pr_title": "Add partial support for the mysql COLLATE and CHARACTER syntax", "pr_createdAt": "2020-02-23T16:57:25Z", "pr_url": "https://github.com/h2database/h2database/pull/2466", "timeline": [{"oid": "1f359b8ccc9ec0c2cdeea6d5b887d11fbacf7752", "url": "https://github.com/h2database/h2database/commit/1f359b8ccc9ec0c2cdeea6d5b887d11fbacf7752", "message": "Add partial support for the mysql COLLATE and CHARACTER syntax\n\nAdd support to parse the mysql COLLATE and CHARACTER keywords during\ntable creation, column definition or table alteration. Also add the\nsupport for UTF8MB4_BIN mysqlcharset.\n\nThis PR doesn't add support for column collation, but merely make it\npossible to use mysql scripts that uses those keyword without giving an\nerror.", "committedDate": "2020-02-23T19:04:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA2NzYxOQ==", "url": "https://github.com/h2database/h2database/pull/2466#discussion_r383067619", "bodyText": "if (database.getMode().getEnum() == ModeEnum.MySQL) {\n\u2026\n}", "author": "katzyn", "createdAt": "2020-02-24T02:30:44Z", "path": "h2/src/main/org/h2/command/Parser.java", "diffHunk": "@@ -6001,6 +6001,13 @@ private Column parseColumnForTable(String columnName, boolean defaultNullable) {\n             int value = readNonNegativeInt();\n             column.setSelectivity(value);\n         }\n+        if (readIf(\"CHARACTER\")) {\n+            readIf(SET);\n+            readMySQLCharset();\n+        }\n+        if (readIf(\"COLLATE\")) {\n+            readMySQLCharset();\n+        }", "originalCommit": "1f359b8ccc9ec0c2cdeea6d5b887d11fbacf7752", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA2ODE1Mw==", "url": "https://github.com/h2database/h2database/pull/2466#discussion_r383068153", "bodyText": "if (!readIf(\"UTF8\") && !readIf(\"UTF8MB4\")) {\n    read(\"UTF8MB4_BIN\");\n}\nor something like it.", "author": "katzyn", "createdAt": "2020-02-24T02:35:01Z", "path": "h2/src/main/org/h2/command/Parser.java", "diffHunk": "@@ -9106,9 +9116,9 @@ private void parseCreateTableMySQLTableOptions(CreateTable command) {\n \n     private void readMySQLCharset() {\n         readIf(EQUAL);\n-        if (!readIf(\"UTF8\")) {\n-            read(\"UTF8MB4\");\n-        }\n+        readIf(\"UTF8\");\n+        readIf(\"UTF8MB4\");\n+        readIf(\"UTF8MB4_BIN\");", "originalCommit": "1f359b8ccc9ec0c2cdeea6d5b887d11fbacf7752", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzIxNzkwMA==", "url": "https://github.com/h2database/h2database/pull/2466#discussion_r383217900", "bodyText": "Would you be interested in a function in the kind of\nreadAny(List<String> tokens) or ReadOneOf(List<String> tokens)?\nIf not, I'll apply your changes ASAP :)", "author": "Drahakar", "createdAt": "2020-02-24T11:41:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA2ODE1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzIyMjM3OQ==", "url": "https://github.com/h2database/h2database/pull/2466#discussion_r383222379", "bodyText": "No, they will be slower and they aren't normally needed.\nIn this specific case you actually can use readUniqueIdentifier(). We aren't going to do something with these encodings and collations and can accept and ignore any name. I don't see any reason to limit it to these three values.", "author": "katzyn", "createdAt": "2020-02-24T11:52:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzA2ODE1Mw=="}], "type": "inlineReview"}, {"oid": "787322a6d7f94d2617550eabcd5572d3c7f9eba6", "url": "https://github.com/h2database/h2database/commit/787322a6d7f94d2617550eabcd5572d3c7f9eba6", "message": "Add partial support for the mysql COLLATE and CHARACTER statements\n\nAdd support to parse the mysql COLLATE and CHARACTER statements during\ntable creation, column definition or table alteration. Also add the\nsupport for UTF8MB4_BIN mysqlcharset.\n\nThis PR doesn't add support for column collation, but merely make it\npossible to use mysql scripts that uses those keyword without giving an\nerror.", "committedDate": "2020-02-26T02:39:23Z", "type": "commit"}, {"oid": "787322a6d7f94d2617550eabcd5572d3c7f9eba6", "url": "https://github.com/h2database/h2database/commit/787322a6d7f94d2617550eabcd5572d3c7f9eba6", "message": "Add partial support for the mysql COLLATE and CHARACTER statements\n\nAdd support to parse the mysql COLLATE and CHARACTER statements during\ntable creation, column definition or table alteration. Also add the\nsupport for UTF8MB4_BIN mysqlcharset.\n\nThis PR doesn't add support for column collation, but merely make it\npossible to use mysql scripts that uses those keyword without giving an\nerror.", "committedDate": "2020-02-26T02:39:23Z", "type": "forcePushed"}]}