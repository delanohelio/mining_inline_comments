{"pr_number": 2714, "pr_title": "fixed few code smells discovered by PVS-Studio", "pr_createdAt": "2020-06-20T18:57:11Z", "pr_url": "https://github.com/h2database/h2database/pull/2714", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1MzY3MQ==", "url": "https://github.com/h2database/h2database/pull/2714#discussion_r443153671", "bodyText": "no, that's not right, because we assign to trunk inside the if block", "author": "grandinj", "createdAt": "2020-06-20T19:18:58Z", "path": "h2/src/main/org/h2/pagestore/PageInputStream.java", "diffHunk": "@@ -101,8 +101,7 @@ private void fillBuffer() {\n                     endOfFile = true;\n                     return;\n                 }\n-            }\n-            if (trunk != null) {\n+            } else {", "originalCommit": "aa0607e248b850362eb7d99f730c230c64664477", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1Mzg4MQ==", "url": "https://github.com/h2database/h2database/pull/2714#discussion_r443153881", "bodyText": "Oops. I agree. Will revert this.", "author": "turbanoff", "createdAt": "2020-06-20T19:22:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1MzY3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1MzY5OQ==", "url": "https://github.com/h2database/h2database/pull/2714#discussion_r443153699", "bodyText": "wrong", "author": "grandinj", "createdAt": "2020-06-20T19:19:41Z", "path": "h2/src/main/org/h2/security/auth/ConfigProperties.java", "diffHunk": "@@ -28,7 +28,7 @@ public ConfigProperties(PropertyConfig... configProperties) {\n \n     public ConfigProperties(Collection<PropertyConfig> configProperties) {\n         properties = new HashMap<>();\n-        if (properties != null) {\n+        if (configProperties != null) {", "originalCommit": "aa0607e248b850362eb7d99f730c230c64664477", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1Mzk2Ng==", "url": "https://github.com/h2database/h2database/pull/2714#discussion_r443153966", "bodyText": "Can you please elaborate? As I can see properties definitely can't be null here (it was just initialized as new HashMap<>()).\nSo it doesn't make sense to check it.\nAlso I found that in this constructor - it's possible to pass null as configProperties\n    public ConfigProperties(PropertyConfig... configProperties) {\n        this(configProperties == null ? null : Arrays.asList(configProperties));\n    }\n\nI believe my proposed fix is correct", "author": "turbanoff", "createdAt": "2020-06-20T19:24:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1MzY5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1NDIyMA==", "url": "https://github.com/h2database/h2database/pull/2714#discussion_r443154220", "bodyText": "Sorry, you are correct", "author": "grandinj", "createdAt": "2020-06-20T19:28:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1MzY5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1MzgzNw==", "url": "https://github.com/h2database/h2database/pull/2714#discussion_r443153837", "bodyText": "Also wrong.\nAt this point I stopped checking - please don't just routinely accept warnings from such tools. You need to carefully analyse the surrounding code and then determine if the warning is valid - such tools often produce false positives.", "author": "grandinj", "createdAt": "2020-06-20T19:21:53Z", "path": "h2/src/main/org/h2/tools/Recover.java", "diffHunk": "@@ -1031,8 +1031,6 @@ private void dumpPageLogStream(PrintWriter writer, int logKey,\n                 int sessionId = in.readVarInt();\n                 String transaction = in.readString();\n                 writer.println(\"-- prepare commit \" + sessionId + \" \" + transaction);\n-            } else if (x == PageLog.NOOP) {\n-                // nothing to do\n             } else if (x == PageLog.CHECKPOINT) {", "originalCommit": "aa0607e248b850362eb7d99f730c230c64664477", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1NDA5Ng==", "url": "https://github.com/h2database/h2database/pull/2714#discussion_r443154096", "bodyText": "Also wrong.\n\nCan you please explain why?\nAs I can see x is already compared with PageLog.NOOP in if-else-if chain. See - https://github.com/h2database/h2database/blob/master/h2/src/main/org/h2/tools/Recover.java#L899\nSo it doesn't make sense to check it again.", "author": "turbanoff", "createdAt": "2020-06-20T19:26:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1MzgzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1NDIzMw==", "url": "https://github.com/h2database/h2database/pull/2714#discussion_r443154233", "bodyText": "Yeah, you are right", "author": "grandinj", "createdAt": "2020-06-20T19:29:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1MzgzNw=="}], "type": "inlineReview"}, {"oid": "3e57b445330f4e804514b2cb79b3434b7893be1d", "url": "https://github.com/h2database/h2database/commit/3e57b445330f4e804514b2cb79b3434b7893be1d", "message": "fixed few code smells discovered by PVS-Studio", "committedDate": "2020-06-20T19:29:22Z", "type": "commit"}, {"oid": "3e57b445330f4e804514b2cb79b3434b7893be1d", "url": "https://github.com/h2database/h2database/commit/3e57b445330f4e804514b2cb79b3434b7893be1d", "message": "fixed few code smells discovered by PVS-Studio", "committedDate": "2020-06-20T19:29:22Z", "type": "forcePushed"}]}