{"pr_number": 6927, "pr_title": "KEYCLOAK-8100 Expose sub claim in OIDC IdentityBroker Mappers", "pr_createdAt": "2020-03-24T18:24:34Z", "pr_url": "https://github.com/keycloak/keycloak/pull/6927", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTA5Nzc1MA==", "url": "https://github.com/keycloak/keycloak/pull/6927#discussion_r441097750", "bodyText": "Could you please leave the format as is? The reason is that it makes a review more extensive if we start accepting code formatting changes. Yeah, we don't have a code style, but we're working on it :)", "author": "pedroigor", "createdAt": "2020-06-16T19:40:54Z", "path": "services/src/main/java/org/keycloak/broker/oidc/mappers/AbstractClaimMapper.java", "diffHunk": "@@ -50,7 +58,7 @@ public static Object getClaimValue(JsonWebToken token, String claim) {\n             } else {\n                 Object val = jsonObject.get(component);\n                 if (!(val instanceof Map)) return null;\n-                jsonObject = (Map<String, Object>)val;\n+                jsonObject = (Map<String, Object>) val;", "originalCommit": "d3b026d85bac605ce031d232c9f373b6f1697a88", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTA5Nzk5NQ==", "url": "https://github.com/keycloak/keycloak/pull/6927#discussion_r441097995", "bodyText": "Same here, please remove changes formatting the code.", "author": "pedroigor", "createdAt": "2020-06-16T19:41:26Z", "path": "services/src/main/java/org/keycloak/broker/oidc/mappers/AbstractClaimMapper.java", "diffHunk": "@@ -63,15 +71,15 @@ public static Object getClaimValue(IdentityProviderMapperModel mapperModel, Brok\n \n     public static Object getClaimValue(BrokeredIdentityContext context, String claim) {\n         {  // search access token\n-            JsonWebToken token = (JsonWebToken)context.getContextData().get(KeycloakOIDCIdentityProvider.VALIDATED_ACCESS_TOKEN);\n+            JsonWebToken token = (JsonWebToken) context.getContextData().get(KeycloakOIDCIdentityProvider.VALIDATED_ACCESS_TOKEN);", "originalCommit": "d3b026d85bac605ce031d232c9f373b6f1697a88", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTA5ODA4OQ==", "url": "https://github.com/keycloak/keycloak/pull/6927#discussion_r441098089", "bodyText": "Same here, please remove changes formatting the code.", "author": "pedroigor", "createdAt": "2020-06-16T19:41:37Z", "path": "services/src/main/java/org/keycloak/broker/oidc/mappers/AbstractClaimMapper.java", "diffHunk": "@@ -63,15 +71,15 @@ public static Object getClaimValue(IdentityProviderMapperModel mapperModel, Brok\n \n     public static Object getClaimValue(BrokeredIdentityContext context, String claim) {\n         {  // search access token\n-            JsonWebToken token = (JsonWebToken)context.getContextData().get(KeycloakOIDCIdentityProvider.VALIDATED_ACCESS_TOKEN);\n+            JsonWebToken token = (JsonWebToken) context.getContextData().get(KeycloakOIDCIdentityProvider.VALIDATED_ACCESS_TOKEN);\n             if (token != null) {\n                 Object value = getClaimValue(token, claim);\n                 if (value != null) return value;\n             }\n \n         }\n         {  // search ID Token\n-            JsonWebToken token = (JsonWebToken)context.getContextData().get(KeycloakOIDCIdentityProvider.VALIDATED_ID_TOKEN);\n+            JsonWebToken token = (JsonWebToken) context.getContextData().get(KeycloakOIDCIdentityProvider.VALIDATED_ID_TOKEN);", "originalCommit": "d3b026d85bac605ce031d232c9f373b6f1697a88", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTA5ODE3Mg==", "url": "https://github.com/keycloak/keycloak/pull/6927#discussion_r441098172", "bodyText": "Same here, please remove changes formatting the code.", "author": "pedroigor", "createdAt": "2020-06-16T19:41:44Z", "path": "services/src/main/java/org/keycloak/broker/oidc/mappers/AbstractClaimMapper.java", "diffHunk": "@@ -116,7 +124,7 @@ public boolean valueEquals(String desiredValue, Object value) {\n \n             }\n         } else if (value instanceof List) {\n-            List list = (List)value;\n+            List list = (List) value;", "originalCommit": "d3b026d85bac605ce031d232c9f373b6f1697a88", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f70828c92ce8ae9445f72c436444ac76229719c5", "url": "https://github.com/keycloak/keycloak/commit/f70828c92ce8ae9445f72c436444ac76229719c5", "message": "KEYCLOAK-8100 Improve handling of available claims in IdentityBroker Mappers\n\nWe now expose the claims \"jti\", \"exp\", \"nbf\", \"iat\", \"iss\", \"aud\",\n\"sub\", \"typ\", \"azp\" along side other claims for use in Identity Broker mappers.\nPreviously claims directly mapped to `JsonWebToken` fields were not\naccessible for mappings.", "committedDate": "2020-06-17T08:47:17Z", "type": "forcePushed"}, {"oid": "f6496d495b439e07163b3929829e3e082523a2c9", "url": "https://github.com/keycloak/keycloak/commit/f6496d495b439e07163b3929829e3e082523a2c9", "message": "KEYCLOAK-8100 Expose sub claim in OIDC IdentityBroker Mappers\n\nWe now expose the claims \"sub\" for use in Identity Broker mappers.\nPreviously claims directly mapped to `JsonWebToken` fields were not\naccessible for mappings.", "committedDate": "2020-06-17T08:49:28Z", "type": "commit"}, {"oid": "f6496d495b439e07163b3929829e3e082523a2c9", "url": "https://github.com/keycloak/keycloak/commit/f6496d495b439e07163b3929829e3e082523a2c9", "message": "KEYCLOAK-8100 Expose sub claim in OIDC IdentityBroker Mappers\n\nWe now expose the claims \"sub\" for use in Identity Broker mappers.\nPreviously claims directly mapped to `JsonWebToken` fields were not\naccessible for mappings.", "committedDate": "2020-06-17T08:49:28Z", "type": "forcePushed"}]}