{"pr_number": 6855, "pr_title": "KEYCLOAK-13121 My Resources", "pr_createdAt": "2020-03-03T08:51:51Z", "pr_url": "https://github.com/keycloak/keycloak/pull/6855", "timeline": [{"oid": "37465ae41657585aae5be86b55bc4d39cf5cf400", "url": "https://github.com/keycloak/keycloak/commit/37465ae41657585aae5be86b55bc4d39cf5cf400", "message": "KEYCLOAK-13121 added the basic functionality", "committedDate": "2020-03-24T12:38:34Z", "type": "forcePushed"}, {"oid": "67ddcd46010e7ff998c716cb88e6b956c9bc4b38", "url": "https://github.com/keycloak/keycloak/commit/67ddcd46010e7ff998c716cb88e6b956c9bc4b38", "message": "KEYCLOAK-13121 added the basic functionality", "committedDate": "2020-03-26T09:14:54Z", "type": "forcePushed"}, {"oid": "6db70195093d8262830fb98739be26802262be24", "url": "https://github.com/keycloak/keycloak/commit/6db70195093d8262830fb98739be26802262be24", "message": "KEYCLOAK-13121 added the basic functionality", "committedDate": "2020-03-27T07:12:59Z", "type": "forcePushed"}, {"oid": "c1ee036864849672b729242b7b12a2e1e283d3b2", "url": "https://github.com/keycloak/keycloak/commit/c1ee036864849672b729242b7b12a2e1e283d3b2", "message": "KEYCLOAK-13121 added the basic functionality", "committedDate": "2020-03-27T13:55:13Z", "type": "forcePushed"}, {"oid": "204dadabae69797d8e48a82530e6303347ab7e46", "url": "https://github.com/keycloak/keycloak/commit/204dadabae69797d8e48a82530e6303347ab7e46", "message": "KEYCLOAK-13121 added the basic functionality", "committedDate": "2020-03-30T13:12:08Z", "type": "forcePushed"}, {"oid": "fe949cc107145741c4c86c4566bbc6008206cb49", "url": "https://github.com/keycloak/keycloak/commit/fe949cc107145741c4c86c4566bbc6008206cb49", "message": "KEYCLOAK-13121 added the basic functionality", "committedDate": "2020-03-30T14:32:43Z", "type": "forcePushed"}, {"oid": "957a3a114da5ceb57235ee1cddec0a49dfba508e", "url": "https://github.com/keycloak/keycloak/commit/957a3a114da5ceb57235ee1cddec0a49dfba508e", "message": "Merge branch 'pedroigor-KEYCLOAK-11762' into KEYCLOAK-13121", "committedDate": "2020-03-30T14:57:55Z", "type": "forcePushed"}, {"oid": "5bdce024e8bc137d8317be8cbdc7d16861e980b0", "url": "https://github.com/keycloak/keycloak/commit/5bdce024e8bc137d8317be8cbdc7d16861e980b0", "message": "Fixed console for test", "committedDate": "2020-04-01T12:43:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTYxMDQzNg==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r401610436", "bodyText": "I think we avoid using wildcard when possible.", "author": "pedroigor", "createdAt": "2020-04-01T13:22:47Z", "path": "services/src/main/java/org/keycloak/services/resources/account/resources/ResourcesService.java", "diffHunk": "@@ -25,11 +25,7 @@\n import javax.ws.rs.QueryParam;\n import javax.ws.rs.core.Link;\n import javax.ws.rs.core.Response;\n-import java.util.ArrayList;\n-import java.util.Collection;\n-import java.util.HashMap;\n-import java.util.List;\n-import java.util.Map;\n+import java.util.*;", "originalCommit": "5bdce024e8bc137d8317be8cbdc7d16861e980b0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d50137e08e8fd004d9e0a203af51ee4a92cd086e", "url": "https://github.com/keycloak/keycloak/commit/d50137e08e8fd004d9e0a203af51ee4a92cd086e", "message": "Fixed console for test", "committedDate": "2020-04-01T13:39:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY1NDIwMQ==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r407654201", "bodyText": "Didn't we get rid of querystring?", "author": "ssilvert", "createdAt": "2020-04-13T18:59:16Z", "path": "themes/pom.xml", "diffHunk": "@@ -143,6 +143,13 @@\n                     <include>**/node_modules/systemjs/dist/system.src.js</include>\n                     <include>**/node_modules/tippy.js/dist/tippy.min.js</include>\n                     <include>**/node_modules/upper-case/upper-case.js</include>\n+                    <include>**/node_modules/parse-link-header/index.js</include>\n+                    <include>**/node_modules/querystring/*.js</include>", "originalCommit": "d50137e08e8fd004d9e0a203af51ee4a92cd086e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzg5MTUxNw==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r407891517", "bodyText": "only in the new snowpack version right? but I could merge that in here as well", "author": "edewit", "createdAt": "2020-04-14T06:18:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY1NDIwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODA3NTMyMA==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r408075320", "bodyText": "It was my understanding that you added custom code so we could stop using querystring and url packages.  If that code is ready to go then let's go ahead and include with this PR.  Since it only affects My Resources, I think that will be easier than using a standalone PR for it.", "author": "ssilvert", "createdAt": "2020-04-14T11:50:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY1NDIwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODEzMTI1Nw==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r408131257", "bodyText": "your understanding is correct, I thought that this would be included in your PR not this one. But we can add it here makes no difference.", "author": "edewit", "createdAt": "2020-04-14T13:22:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY1NDIwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY1NDM0OA==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r407654348", "bodyText": "Didn't we get rid of url?", "author": "ssilvert", "createdAt": "2020-04-13T18:59:32Z", "path": "themes/pom.xml", "diffHunk": "@@ -143,6 +143,13 @@\n                     <include>**/node_modules/systemjs/dist/system.src.js</include>\n                     <include>**/node_modules/tippy.js/dist/tippy.min.js</include>\n                     <include>**/node_modules/upper-case/upper-case.js</include>\n+                    <include>**/node_modules/parse-link-header/index.js</include>\n+                    <include>**/node_modules/querystring/*.js</include>\n+                    <include>**/node_modules/url/url.js</include>", "originalCommit": "d50137e08e8fd004d9e0a203af51ee4a92cd086e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY1ODQ2MQ==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r407658461", "bodyText": "@edewit Just wondering.  Have you tried this on small devices like cell phones?  How does it look?", "author": "ssilvert", "createdAt": "2020-04-13T19:06:59Z", "path": "themes/src/main/resources/theme/keycloak-preview/account/resources/app/content/my-resources-page/EditTheResource.tsx", "diffHunk": "@@ -0,0 +1,147 @@\n+/*\n+ * Copyright 2019 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+import * as React from 'react';\n+\n+import {\n+    Button,\n+    Modal,\n+    DataList,\n+    DataListItemRow,\n+    DataListItemCells,\n+    DataListCell,\n+    DataListItem,\n+    ChipGroup,\n+    ChipGroupToolbarItem,\n+    Chip\n+} from '@patternfly/react-core';\n+\n+import { EditAltIcon } from '@patternfly/react-icons';\n+\n+import { Resource, Permission, Scope } from './MyResourcesPage';\n+import { Msg } from '../../widgets/Msg';\n+import { AccountServiceClient } from '../../account-service/account.service';\n+import { ContentAlert } from '../ContentAlert';\n+\n+interface EditTheResourceProps {\n+    resource: Resource;\n+    permissions: Permission[];\n+    onClose: (resource: Resource, row: number) => void;\n+    row: number;\n+}\n+\n+interface EditTheResourceState {\n+    isOpen: boolean;\n+}\n+\n+export class EditTheResource extends React.Component<EditTheResourceProps, EditTheResourceState> {\n+    protected static defaultProps = { permissions: [], row: 0 };\n+\n+    public constructor(props: EditTheResourceProps) {\n+        super(props);\n+\n+        this.state = {\n+            isOpen: false,\n+        };\n+    }\n+\n+    private clearState(): void {\n+        this.setState({\n+        });\n+    }\n+\n+    private handleToggleDialog = () => {\n+        if (this.state.isOpen) {\n+            this.setState({ isOpen: false });\n+        } else {\n+            this.clearState();\n+            this.setState({ isOpen: true });\n+        }\n+    };\n+\n+    async deletePermission(permission: Permission, scope: Scope): Promise<void> {\n+        permission.scopes.splice(permission.scopes.indexOf(scope), 1);\n+        await AccountServiceClient.Instance.doPut(`/resources/${this.props.resource._id}/permissions`, {data: [permission]});\n+        ContentAlert.success(Msg.localize('shareSuccess'));\n+        this.props.onClose(this.props.resource, this.props.row);\n+    }\n+\n+    public render(): React.ReactNode {\n+        return (\n+            <React.Fragment>\n+                <Button variant=\"link\" onClick={this.handleToggleDialog}>\n+                    <EditAltIcon /> Edit\n+                </Button>\n+\n+                <Modal\n+                    title={'Edit the resource - ' + this.props.resource.name}\n+                    isLarge={true}\n+                    width={'45%'}", "originalCommit": "d50137e08e8fd004d9e0a203af51ee4a92cd086e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzg5NjMxOA==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r407896318", "bodyText": "that is a very stupid setting both seems that it's a copy paste, removed it in both places. Without it it looks like this:", "author": "edewit", "createdAt": "2020-04-14T06:31:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY1ODQ2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzkxMzc3Mw==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r407913773", "bodyText": "on a wide screen without the 45% it's a bit wide, but still okay in my opinion:", "author": "edewit", "createdAt": "2020-04-14T07:12:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY1ODQ2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY2MjUxNA==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r407662514", "bodyText": "Is noResourceSharedWithYou still used somewhere?  If not, it needs to be removed from the resource bundle.", "author": "ssilvert", "createdAt": "2020-04-13T19:14:39Z", "path": "themes/src/main/resources/theme/keycloak-preview/account/resources/app/content/my-resources-page/MyResourcesPage.tsx", "diffHunk": "@@ -224,8 +227,8 @@ export class MyResourcesPage extends React.Component<MyResourcesPageProps, MyRes\n         return (\n             <ContentPage title=\"resources\" onRefresh={this.fetchInitialResources.bind(this)}>\n                 <Tabs isFilled activeKey={this.state.activeTabKey} onSelect={this.handleTabClick}>\n-                    {this.makeTab(0, 'myResources', this.state.myResources, 'notHaveAnyResource')}\n-                    {this.makeTab(1, 'sharedwithMe', this.state.sharedWithMe, 'noResourcesSharedWithYou')}", "originalCommit": "d50137e08e8fd004d9e0a203af51ee4a92cd086e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzg5MjYxMg==", "url": "https://github.com/keycloak/keycloak/pull/6855#discussion_r407892612", "bodyText": "it's used on multiple places just not here ;)", "author": "edewit", "createdAt": "2020-04-14T06:21:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzY2MjUxNA=="}], "type": "inlineReview"}, {"oid": "d25515515c87696d0484e1414e27fc7c7b80eb69", "url": "https://github.com/keycloak/keycloak/commit/d25515515c87696d0484e1414e27fc7c7b80eb69", "message": "Fixed console for test", "committedDate": "2020-04-14T07:13:20Z", "type": "forcePushed"}, {"oid": "c5d82bee801dd1f03fb65b824fed560a3fbd2c7a", "url": "https://github.com/keycloak/keycloak/commit/c5d82bee801dd1f03fb65b824fed560a3fbd2c7a", "message": "Merge remote-tracking branch 'remotes/origin/remove-parse-link-header' into KEYCLOAK-13121\n\n# Conflicts:\n#\tthemes/src/main/resources/theme/keycloak-preview/account/resources/package-lock.json", "committedDate": "2020-04-14T13:53:00Z", "type": "forcePushed"}, {"oid": "eed9e94c8f764cfca9ce4a018843f3ef0b8821cb", "url": "https://github.com/keycloak/keycloak/commit/eed9e94c8f764cfca9ce4a018843f3ef0b8821cb", "message": "Merge remote-tracking branch 'remotes/origin/remove-parse-link-header' into KEYCLOAK-13121\n\n# Conflicts:\n#\tthemes/src/main/resources/theme/keycloak-preview/account/resources/package-lock.json", "committedDate": "2020-04-16T10:42:08Z", "type": "forcePushed"}, {"oid": "6a008d659afbf620334caca8d5a7394a10fb6c59", "url": "https://github.com/keycloak/keycloak/commit/6a008d659afbf620334caca8d5a7394a10fb6c59", "message": "Merge remote-tracking branch 'remotes/origin/remove-parse-link-header' into KEYCLOAK-13121\n\n# Conflicts:\n#\tthemes/src/main/resources/theme/keycloak-preview/account/resources/package-lock.json", "committedDate": "2020-04-16T11:58:48Z", "type": "forcePushed"}, {"oid": "a7445de25e920affbb8dcfeaeb58d9017ba3643d", "url": "https://github.com/keycloak/keycloak/commit/a7445de25e920affbb8dcfeaeb58d9017ba3643d", "message": "KEYCLOAK-13121 added the basic functionality", "committedDate": "2020-04-24T06:17:54Z", "type": "commit"}, {"oid": "c563a3ba478882f462153d2d75d69da2e644b419", "url": "https://github.com/keycloak/keycloak/commit/c563a3ba478882f462153d2d75d69da2e644b419", "message": "Fixed console for test", "committedDate": "2020-04-24T06:19:33Z", "type": "commit"}, {"oid": "af0cbcbe7750d3294038dcf2735d28271e57a419", "url": "https://github.com/keycloak/keycloak/commit/af0cbcbe7750d3294038dcf2735d28271e57a419", "message": "fix: removes the dependency on parse-link-header", "committedDate": "2020-04-24T06:20:13Z", "type": "commit"}, {"oid": "b689dd4d61100f0c01805284df58d5c2bfc44369", "url": "https://github.com/keycloak/keycloak/commit/b689dd4d61100f0c01805284df58d5c2bfc44369", "message": "fix merge errors", "committedDate": "2020-04-24T06:47:44Z", "type": "forcePushed"}, {"oid": "3c81685cd102f12e1f51d8ef8211be61c72af1b2", "url": "https://github.com/keycloak/keycloak/commit/3c81685cd102f12e1f51d8ef8211be61c72af1b2", "message": "fix merge errors", "committedDate": "2020-04-24T06:53:11Z", "type": "commit"}, {"oid": "3c81685cd102f12e1f51d8ef8211be61c72af1b2", "url": "https://github.com/keycloak/keycloak/commit/3c81685cd102f12e1f51d8ef8211be61c72af1b2", "message": "fix merge errors", "committedDate": "2020-04-24T06:53:11Z", "type": "forcePushed"}]}