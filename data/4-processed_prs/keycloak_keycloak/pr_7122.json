{"pr_number": 7122, "pr_title": "KEYCLOAK-14310 Added fix that considers Content-Type for data encoding", "pr_createdAt": "2020-05-29T11:18:22Z", "pr_url": "https://github.com/keycloak/keycloak/pull/7122", "timeline": [{"oid": "a607a5d7f260f8f9f85a3637f0b3dbb27bde87c7", "url": "https://github.com/keycloak/keycloak/commit/a607a5d7f260f8f9f85a3637f0b3dbb27bde87c7", "message": "KEYCLOAK-14310 Added fix that considers Content-Type for data encoding and added corresponding test", "committedDate": "2020-05-29T11:06:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjIzNzc1Mw==", "url": "https://github.com/keycloak/keycloak/pull/7122#discussion_r442237753", "bodyText": "Shall we handle the case when there is an org.apache.http.HttpHeaders#CONTENT_TYPE header? Also, please, replace the string with org.apache.http.HttpHeaders#CONTENT_TYPE.", "author": "pedroigor", "createdAt": "2020-06-18T13:46:08Z", "path": "server-spi-private/src/main/java/org/keycloak/broker/provider/util/SimpleHttp.java", "diffHunk": "@@ -242,7 +242,7 @@ private URI appendParameterToUrl(String url) throws IOException {\n     }\n \n     private StringEntity getJsonEntity() throws IOException {\n-        return new StringEntity(JsonSerialization.writeValueAsString(entity));\n+        return new StringEntity(JsonSerialization.writeValueAsString(entity), ContentType.getByMimeType(headers.get(\"Content-Type\")));", "originalCommit": "a607a5d7f260f8f9f85a3637f0b3dbb27bde87c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQxNjg2OQ==", "url": "https://github.com/keycloak/keycloak/pull/7122#discussion_r443416869", "bodyText": "Hi @pedroigor\nthe case with existing/manual added headers is already contained and there is only the String, String signature available for adding headers, so this should be fine.\nI replaced the string with the constant. As SimpleHttp almost nowhere uses constants, I initially tried to stick to that code style, but with the constants it's of course nicer.", "author": "fabianschlier", "createdAt": "2020-06-22T09:03:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjIzNzc1Mw=="}], "type": "inlineReview"}, {"oid": "4658fc8bc522bff6ad58141d82a967110588e202", "url": "https://github.com/keycloak/keycloak/commit/4658fc8bc522bff6ad58141d82a967110588e202", "message": "KEYCLOAK-14310 Replaced string by constant after review amendment", "committedDate": "2020-06-22T08:55:52Z", "type": "commit"}]}