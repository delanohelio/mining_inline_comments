{"pr_number": 6842, "pr_title": "KEYCLOAK-12768: Prevent reserved characters in URLs", "pr_createdAt": "2020-02-27T13:47:38Z", "pr_url": "https://github.com/keycloak/keycloak/pull/6842", "timeline": [{"oid": "a8ed7b651bab832abc53222091a3d436a8cd6013", "url": "https://github.com/keycloak/keycloak/commit/a8ed7b651bab832abc53222091a3d436a8cd6013", "message": "KEYCLOAK-12768: Prevent reserved characters in URLs", "committedDate": "2020-03-09T18:20:17Z", "type": "commit"}, {"oid": "a8ed7b651bab832abc53222091a3d436a8cd6013", "url": "https://github.com/keycloak/keycloak/commit/a8ed7b651bab832abc53222091a3d436a8cd6013", "message": "KEYCLOAK-12768: Prevent reserved characters in URLs", "committedDate": "2020-03-09T18:20:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMzNTIxNw==", "url": "https://github.com/keycloak/keycloak/pull/6842#discussion_r390335217", "bodyText": "I think node is the hostname of a node, so an IP address or domain, with/without ports. So this would probably break things as ':' is marked as a reserved character.\n@mposolda ??", "author": "stianst", "createdAt": "2020-03-10T14:03:16Z", "path": "services/src/main/java/org/keycloak/services/resources/admin/ClientResource.java", "diffHunk": "@@ -565,6 +566,9 @@ public void registerNode(Map<String, String> formParams) {\n         if (node == null) {\n             throw new BadRequestException(\"Node not found in params\");\n         }\n+        \n+        ReservedCharValidator.validate(node);", "originalCommit": "a8ed7b651bab832abc53222091a3d436a8cd6013", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM1ODY0Nw==", "url": "https://github.com/keycloak/keycloak/pull/6842#discussion_r390358647", "bodyText": "Yes, it is hostname of a node, so an IP address or domain. However it is without ports. So this validation should be ok.", "author": "mposolda", "createdAt": "2020-03-10T14:33:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMzNTIxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMzNTgxMA==", "url": "https://github.com/keycloak/keycloak/pull/6842#discussion_r390335810", "bodyText": "Should this be data.get(\"alias\").toString()?", "author": "stianst", "createdAt": "2020-03-10T14:03:56Z", "path": "services/src/main/java/org/keycloak/services/resources/admin/IdentityProvidersResource.java", "diffHunk": "@@ -134,6 +135,9 @@ public Response getIdentityProviders(@PathParam(\"provider_id\") String providerId\n         if (!(data.containsKey(\"providerId\") && data.containsKey(\"fromUrl\"))) {\n             throw new BadRequestException();\n         }\n+        \n+        ReservedCharValidator.validate((String)data.get(\"alias\"));", "originalCommit": "a8ed7b651bab832abc53222091a3d436a8cd6013", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM1OTY2MA==", "url": "https://github.com/keycloak/keycloak/pull/6842#discussion_r390359660", "bodyText": "@stianst I guess it depends on what you want to happen if somehow \"alias\" is not a string.  That would be an error.  With a cast you get ClassCastException.  With toString(), you get unpredictable results.", "author": "ssilvert", "createdAt": "2020-03-10T14:35:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDMzNTgxMA=="}], "type": "inlineReview"}]}