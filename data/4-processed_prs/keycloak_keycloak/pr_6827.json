{"pr_number": 6827, "pr_title": "[KEYCLOAK-12980] Username not updated when \"Email as username\" is ena\u2026", "pr_createdAt": "2020-02-24T22:56:06Z", "pr_url": "https://github.com/keycloak/keycloak/pull/6827", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTAyNw==", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385025027", "bodyText": "Should this be userRep.getUsername()?", "author": "stianst", "createdAt": "2020-02-27T10:03:27Z", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -458,6 +458,18 @@ public void createUserWithoutUsername() {\n         response.close();\n     }\n \n+    @Test\n+    public void createUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());", "originalCommit": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMwNTY1Nw==", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385305657", "bodyText": "Yes, fixed, thanks", "author": "douglaspalmer", "createdAt": "2020-02-27T18:54:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTAyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTI4Ng==", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385025286", "bodyText": "Should this be userRep.getUsername()?", "author": "stianst", "createdAt": "2020-02-27T10:03:51Z", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -1458,6 +1470,25 @@ public void updateUserWithoutUsername() {\n         switchEditUsernameAllowedOn(false);\n     }\n \n+    @Test\n+    public void updateUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());", "originalCommit": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMwNTg4Mg==", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385305882", "bodyText": "Yes, fixed, thanks.", "author": "douglaspalmer", "createdAt": "2020-02-27T18:55:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTI4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTMyMA==", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385025320", "bodyText": "Should this be userRep.getUsername()?", "author": "stianst", "createdAt": "2020-02-27T10:03:55Z", "path": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/UserTest.java", "diffHunk": "@@ -1458,6 +1470,25 @@ public void updateUserWithoutUsername() {\n         switchEditUsernameAllowedOn(false);\n     }\n \n+    @Test\n+    public void updateUserWithEmailAsUsername() {\n+        switchRegistrationEmailAsUsername(true);\n+\n+        String id = createUser();\n+\n+        UserResource user = realm.users().get(id);\n+        UserRepresentation userRep = user.toRepresentation();\n+        assertEquals(\"user1@localhost\", userRep.getEmail());\n+\n+        userRep.setEmail(\"user11@localhost\");\n+        updateUser(user, userRep);\n+\n+        userRep = realm.users().get(id).toRepresentation();\n+        assertEquals(\"user11@localhost\", userRep.getEmail());", "originalCommit": "4c99d9645c44b49c26c6c3b5d61c8d78509f3ff0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMwNTk0MQ==", "url": "https://github.com/keycloak/keycloak/pull/6827#discussion_r385305941", "bodyText": "Yes, fixed, thanks.", "author": "douglaspalmer", "createdAt": "2020-02-27T18:55:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTAyNTMyMA=="}], "type": "inlineReview"}, {"oid": "cecdf867c87e428f16a36ffe5db9a72f51eb7732", "url": "https://github.com/keycloak/keycloak/commit/cecdf867c87e428f16a36ffe5db9a72f51eb7732", "message": "[KEYCLOAK-12980] Username not updated when \"Email as username\" is enabled", "committedDate": "2020-02-27T18:51:23Z", "type": "commit"}, {"oid": "cecdf867c87e428f16a36ffe5db9a72f51eb7732", "url": "https://github.com/keycloak/keycloak/commit/cecdf867c87e428f16a36ffe5db9a72f51eb7732", "message": "[KEYCLOAK-12980] Username not updated when \"Email as username\" is enabled", "committedDate": "2020-02-27T18:51:23Z", "type": "forcePushed"}]}