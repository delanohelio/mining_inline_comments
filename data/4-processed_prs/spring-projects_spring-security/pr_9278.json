{"pr_number": 9278, "pr_title": "Introduced DispatcherType request matcher", "pr_createdAt": "2020-12-11T03:18:32Z", "pr_url": "https://github.com/spring-projects/spring-security/pull/9278", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAyOTIyNA==", "url": "https://github.com/spring-projects/spring-security/pull/9278#discussion_r541029224", "bodyText": "Please move any changes that are not directly related to this issue to a different pull request or a different commit within this pull request.", "author": "eleftherias", "createdAt": "2020-12-11T15:30:14Z", "path": "config/src/main/java/org/springframework/security/config/annotation/web/AbstractRequestMatcherRegistry.java", "diffHunk": "@@ -83,7 +87,7 @@ public C anyRequest() {\n \t * @return the object that is chained after creating the {@link RequestMatcher}\n \t */\n \tpublic C antMatchers(HttpMethod method) {\n-\t\treturn antMatchers(method, new String[] { \"/**\" });", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTA0ODc2OQ==", "url": "https://github.com/spring-projects/spring-security/pull/9278#discussion_r541048769", "bodyText": "Okay -- I'll split this (and the change from a private static valueOf method to HttpMethod::resolve) into a separate commit", "author": "nmck257", "createdAt": "2020-12-11T15:57:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAyOTIyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTAzMDY1Mg==", "url": "https://github.com/spring-projects/spring-security/pull/9278#discussion_r541030652", "bodyText": "Please use a for-loop instead of a Stream.\nThe GC overhead of creating additional objects (including intermediate objects) can cause significant decrease in performance.\nSee #7154 for more details.", "author": "eleftherias", "createdAt": "2020-12-11T15:32:13Z", "path": "config/src/main/java/org/springframework/security/config/annotation/web/AbstractRequestMatcherRegistry.java", "diffHunk": "@@ -206,6 +210,35 @@ public C regexMatchers(String... regexPatterns) {\n \t\treturn chainRequestMatchers(RequestMatchers.regexMatchers(regexPatterns));\n \t}\n \n+\t/**\n+\t * Maps a {@link List} of\n+\t * {@link org.springframework.security.web.util.matcher.DispatcherTypeRequestMatcher}\n+\t * instances.\n+\t * @param method the {@link HttpMethod} to use or {@code null} for any\n+\t * {@link HttpMethod}.\n+\t * @param dispatcherTypes the dispatcher types to match against\n+\t * @return the object that is chained after creating the {@link RequestMatcher}\n+\t */\n+\tpublic C dispatcherTypeMatchers(HttpMethod method, DispatcherType... dispatcherTypes) {\n+\t\tAssert.state(!this.anyRequestConfigured, \"Can't configure dispatcherTypeMatchers after anyRequest\");\n+\t\treturn chainRequestMatchers(Arrays.stream(dispatcherTypes)", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0838d4df64183cbb0010d48fe106b81528f92914", "url": "https://github.com/spring-projects/spring-security/commit/0838d4df64183cbb0010d48fe106b81528f92914", "message": "Introduced DispatcherType request matcher\n\nCreated a DispatcherTypeRequestMatcher and corresponding methods\nfor configuring an HttpSecurity object. This enables filtering of\nsecurity rules based on the dispatcher type of the incoming servlet\nrequest.\n\nCloses gh-9205", "committedDate": "2020-12-11T22:37:27Z", "type": "commit"}, {"oid": "b4325307a01c5bf391df5ad0819d525284266b79", "url": "https://github.com/spring-projects/spring-security/commit/b4325307a01c5bf391df5ad0819d525284266b79", "message": "Minor cleanup on Ant / Regex Request Matchers\n\n - Removed duplicative code for transforming String into HttpMethod\n - Removed an unnecessary array initialization", "committedDate": "2020-12-11T22:40:55Z", "type": "commit"}, {"oid": "b4325307a01c5bf391df5ad0819d525284266b79", "url": "https://github.com/spring-projects/spring-security/commit/b4325307a01c5bf391df5ad0819d525284266b79", "message": "Minor cleanup on Ant / Regex Request Matchers\n\n - Removed duplicative code for transforming String into HttpMethod\n - Removed an unnecessary array initialization", "committedDate": "2020-12-11T22:40:55Z", "type": "forcePushed"}]}