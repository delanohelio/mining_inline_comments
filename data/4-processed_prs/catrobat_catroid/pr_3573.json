{"pr_number": 3573, "pr_title": "CATROID-237 \"If on edge bounce\" bounce outside of loops", "pr_createdAt": "2020-04-07T08:38:06Z", "pr_url": "https://github.com/Catrobat/Catroid/pull/3573", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY3NTk5Ng==", "url": "https://github.com/Catrobat/Catroid/pull/3573#discussion_r404675996", "bodyText": "Please handle this in the Look.setLookData(...).", "author": "gPathpp", "createdAt": "2020-04-07T09:41:28Z", "path": "catroid/src/main/java/org/catrobat/catroid/content/actions/conditional/IfOnEdgeBounceAction.java", "diffHunk": "@@ -34,6 +34,7 @@\n \n \t@Override\n \tprotected void update(float percent) {\n+\t\tsprite.look.updateLookIfSizeIsZero();", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY3NzA1MA==", "url": "https://github.com/Catrobat/Catroid/pull/3573#discussion_r404677050", "bodyText": "Please make this whole thing thread-safe.", "author": "gPathpp", "createdAt": "2020-04-07T09:43:07Z", "path": "catroid/src/main/java/org/catrobat/catroid/content/Look.java", "diffHunk": "@@ -233,15 +233,7 @@ protected void checkImageChanged() {\n \t\t\t\timageChanged = false;\n \t\t\t\treturn;\n \t\t\t}\n-\n-\t\t\tpixmap = lookData.getPixmap();\n-\t\t\tfloat newX = getX() - (pixmap.getWidth() - getWidth()) / 2f;\n-\t\t\tfloat newY = getY() - (pixmap.getHeight() - getHeight()) / 2f;\n-\n-\t\t\tsetSize(pixmap.getWidth(), pixmap.getHeight());\n-\t\t\tsetPosition(newX, newY);\n-\t\t\tsetOrigin(getWidth() / 2f, getHeight() / 2f);\n-\n+\t\t\tupdateLook();", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk4NTQ2Nw==", "url": "https://github.com/Catrobat/Catroid/pull/3573#discussion_r412985467", "bodyText": "Please use \"synchronized\".\nhttps://www.straub.as/java/threads/synchronized.html", "author": "gPathpp", "createdAt": "2020-04-22T13:32:38Z", "path": "catroid/src/main/java/org/catrobat/catroid/content/Look.java", "diffHunk": "@@ -64,10 +65,9 @@\n \n \tpublic static final float DEGREE_UI_OFFSET = 90.0f;\n \tprivate static final float COLOR_SCALE = 200.0f;\n+\tprivate boolean changeShader = false;\n+\tprivate ReentrantLock shaderLock = new ReentrantLock();", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk4NjAyNw==", "url": "https://github.com/Catrobat/Catroid/pull/3573#discussion_r412986027", "bodyText": "Please synchronize it.", "author": "gPathpp", "createdAt": "2020-04-22T13:33:19Z", "path": "catroid/src/main/java/org/catrobat/catroid/content/Look.java", "diffHunk": "@@ -176,7 +176,6 @@ public void createBrightnessContrastHueShader() {\n \n \t@Override\n \tpublic void draw(Batch batch, float parentAlpha) {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk5NDQxNA==", "url": "https://github.com/Catrobat/Catroid/pull/3573#discussion_r412994414", "bodyText": "Nice!\nBut instead of deleting the assertions with wrong parameters, use the correct expected value, please.", "author": "gPathpp", "createdAt": "2020-04-22T13:43:25Z", "path": "catroid/src/androidTest/java/org/catrobat/catroid/test/physics/actions/IfOnEdgeBouncePhysicsActionTest.java", "diffHunk": "@@ -142,8 +141,6 @@ public void testSpriteOverlapsRightAndTopAxis() {\n \t\tfloat setVelocityYValue = 400.0f;\n \t\tphysicsObject.setVelocity(setVelocityXValue, setVelocityYValue);\n \n-\t\tassertEquals(setXValue, sprite.look.getX());\n-\t\tassertEquals(setYValue, sprite.look.getY());", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjQ1Nzg1MQ==", "url": "https://github.com/Catrobat/Catroid/pull/3573#discussion_r416457851", "bodyText": "Please, change as discussed.", "author": "gPathpp", "createdAt": "2020-04-28T09:13:23Z", "path": "catroid/src/main/java/org/catrobat/catroid/content/Look.java", "diffHunk": "@@ -488,16 +475,16 @@ public float getBrightnessInUserInterfaceDimensionUnit() {\n \t\treturn brightness * 100f;\n \t}\n \n-\tpublic void setBrightnessInUserInterfaceDimensionUnit(float percent) {\n+\tpublic synchronized void setBrightnessInUserInterfaceDimensionUnit(float percent) {\n \t\tif (percent < 0f) {\n \t\t\tpercent = 0f;\n \t\t} else if (percent > 200f) {\n \t\t\tpercent = 200f;\n \t\t}\n \n \t\tbrightness = percent / 100f;\n-\t\tbrightnessChanged = true;\n-\t\timageChanged = true;\n+\t\tchangeShader = true;", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9c87291600b21bfa61423b9f2d76c5348ada3773", "url": "https://github.com/Catrobat/Catroid/commit/9c87291600b21bfa61423b9f2d76c5348ada3773", "message": "CATROID-237 \"If on edge bounce\" bounce outside of loops", "committedDate": "2020-04-28T09:27:13Z", "type": "commit"}, {"oid": "9c87291600b21bfa61423b9f2d76c5348ada3773", "url": "https://github.com/Catrobat/Catroid/commit/9c87291600b21bfa61423b9f2d76c5348ada3773", "message": "CATROID-237 \"If on edge bounce\" bounce outside of loops", "committedDate": "2020-04-28T09:27:13Z", "type": "forcePushed"}]}