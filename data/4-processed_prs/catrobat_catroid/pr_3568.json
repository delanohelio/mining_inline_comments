{"pr_number": 3568, "pr_title": "CATROID-126 Fixed repeating sound to match scratch behavior", "pr_createdAt": "2020-04-01T07:38:45Z", "pr_url": "https://github.com/Catrobat/Catroid/pull/3568", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODEyNjM5MQ==", "url": "https://github.com/Catrobat/Catroid/pull/3568#discussion_r438126391", "bodyText": "PLEASE-EXPLAIN: For what does this function do?\nPLEASE-FIX: Please Rename this function.", "author": "gPathpp", "createdAt": "2020-06-10T13:35:25Z", "path": "catroid/src/main/java/org/catrobat/catroid/io/SoundManager.java", "diffHunk": "@@ -74,6 +87,30 @@ public synchronized void playSoundFileWithStartTime(String pathToSoundfile,\n \t\t}\n \t}\n \n+\tprivate void stopSameSpritePlayingSameSound(String pathToSoundFile, Sprite spriteToStartSound,\n+\t\t\tBrick brickToStartSound) {\n+\t\tfor (MediaPlayerWithSoundDetails mediaPlayer : mediaPlayers) {\n+\t\t\tif (mediaPlayer.isPlaying() && mediaPlayer.getStartedBySprite() == spriteToStartSound\n+\t\t\t\t\t&& mediaPlayer.getPathToSoundFile().equals(pathToSoundFile)\n+\t\t\t\t\t&& checkStopWithStartedBrick(mediaPlayer, brickToStartSound)) {\n+\t\t\t\tmediaPlayer.stop();\n+\t\t\t\trecentlyStoppedSoundfilePaths.add(new SoundFilePathWithSprite(\n+\t\t\t\t\t\tmediaPlayer.getPathToSoundFile(), spriteToStartSound));\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate boolean checkStopWithStartedBrick(MediaPlayerWithSoundDetails mediaPlayer, Brick brickToStartSound) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODcxOTMzMg==", "url": "https://github.com/Catrobat/Catroid/pull/3568#discussion_r438719332", "bodyText": "I have found a better solution for the problem this function solved. I have deleted this function and the brickToStartSound.", "author": "maxf24", "createdAt": "2020-06-11T11:31:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODEyNjM5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODEyNzU2Mw==", "url": "https://github.com/Catrobat/Catroid/pull/3568#discussion_r438127563", "bodyText": "PLEASE-EXPLAIN: Why do you compare the Script pointers here?", "author": "gPathpp", "createdAt": "2020-06-10T13:37:05Z", "path": "catroid/src/main/java/org/catrobat/catroid/io/SoundManager.java", "diffHunk": "@@ -74,6 +87,30 @@ public synchronized void playSoundFileWithStartTime(String pathToSoundfile,\n \t\t}\n \t}\n \n+\tprivate void stopSameSpritePlayingSameSound(String pathToSoundFile, Sprite spriteToStartSound,\n+\t\t\tBrick brickToStartSound) {\n+\t\tfor (MediaPlayerWithSoundDetails mediaPlayer : mediaPlayers) {\n+\t\t\tif (mediaPlayer.isPlaying() && mediaPlayer.getStartedBySprite() == spriteToStartSound\n+\t\t\t\t\t&& mediaPlayer.getPathToSoundFile().equals(pathToSoundFile)\n+\t\t\t\t\t&& checkStopWithStartedBrick(mediaPlayer, brickToStartSound)) {\n+\t\t\t\tmediaPlayer.stop();\n+\t\t\t\trecentlyStoppedSoundfilePaths.add(new SoundFilePathWithSprite(\n+\t\t\t\t\t\tmediaPlayer.getPathToSoundFile(), spriteToStartSound));\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tprivate boolean checkStopWithStartedBrick(MediaPlayerWithSoundDetails mediaPlayer, Brick brickToStartSound) {\n+\t\tif (brickToStartSound instanceof PlaySoundAndWaitBrick || brickToStartSound instanceof SpeakAndWaitBrick) {\n+\t\t\treturn mediaPlayer.getStartedByBrick().getScript() != brickToStartSound.getScript();", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODE1NTcxOQ==", "url": "https://github.com/Catrobat/Catroid/pull/3568#discussion_r438155719", "bodyText": "This is the only (real) usage of the StartedByBrick. Is this line of code necessary or can this functionality be implemented in a better way?", "author": "gPathpp", "createdAt": "2020-06-10T14:15:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODEyNzU2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODEyOTA0Mw==", "url": "https://github.com/Catrobat/Catroid/pull/3568#discussion_r438129043", "bodyText": "Nice!", "author": "gPathpp", "createdAt": "2020-06-10T13:39:07Z", "path": "catroid/src/main/java/org/catrobat/catroid/io/SoundManager.java", "diffHunk": "@@ -42,9 +50,10 @@\n \tprivate static final String TAG = SoundManager.class.getSimpleName();\n \tprivate static final SoundManager INSTANCE = new SoundManager();\n \n-\tprivate final List<MediaPlayer> mediaPlayers = new ArrayList<MediaPlayer>(MAX_MEDIA_PLAYERS);\n+\tprivate final List<MediaPlayerWithSoundDetails> mediaPlayers = new ArrayList<>(MAX_MEDIA_PLAYERS);", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODEzMzY4MA==", "url": "https://github.com/Catrobat/Catroid/pull/3568#discussion_r438133680", "bodyText": "PLEASE-FIX:\n\nRename method. (it does not stop the sprite, or does it?)\nRename the parameters spriteToStartSound -> sprite (it doesn't start the sound in this method) and the same for the brick\nRename pathToSoundFile to soundFilePath", "author": "gPathpp", "createdAt": "2020-06-10T13:45:27Z", "path": "catroid/src/main/java/org/catrobat/catroid/io/SoundManager.java", "diffHunk": "@@ -74,6 +87,30 @@ public synchronized void playSoundFileWithStartTime(String pathToSoundfile,\n \t\t}\n \t}\n \n+\tprivate void stopSameSpritePlayingSameSound(String pathToSoundFile, Sprite spriteToStartSound,", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "c098498401236bbab03c2b992a55e66dae7ca0e2", "url": "https://github.com/Catrobat/Catroid/commit/c098498401236bbab03c2b992a55e66dae7ca0e2", "message": "CATROID-126 Fixed repeating sound to match scratch behavior", "committedDate": "2020-06-13T09:18:01Z", "type": "commit"}, {"oid": "c098498401236bbab03c2b992a55e66dae7ca0e2", "url": "https://github.com/Catrobat/Catroid/commit/c098498401236bbab03c2b992a55e66dae7ca0e2", "message": "CATROID-126 Fixed repeating sound to match scratch behavior", "committedDate": "2020-06-13T09:18:01Z", "type": "forcePushed"}]}