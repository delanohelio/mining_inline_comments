{"pr_number": 3577, "pr_title": "EffMessage - add support for optional sender", "pr_createdAt": "2020-11-27T23:14:37Z", "pr_url": "https://github.com/SkriptLang/Skript/pull/3577", "timeline": [{"oid": "395c43f6adf1d6decb500fe80017e355710b11cf", "url": "https://github.com/SkriptLang/Skript/commit/395c43f6adf1d6decb500fe80017e355710b11cf", "message": "build.gradle - update Paper version", "committedDate": "2020-11-27T23:03:16Z", "type": "commit"}, {"oid": "eff5c84698f38c62fcbc45a7f32d99935bdfdbb5", "url": "https://github.com/SkriptLang/Skript/commit/eff5c84698f38c62fcbc45a7f32d99935bdfdbb5", "message": "EffMessage - add support for optional sender\n- This allows the server to send a message as if a specific player sent it. Usefull with 1.16.4's new ignore player system.", "committedDate": "2020-11-27T23:11:19Z", "type": "commit"}, {"oid": "174d72825a6e1f34a7a39bb34f333f62b00e3bb6", "url": "https://github.com/SkriptLang/Skript/commit/174d72825a6e1f34a7a39bb34f333f62b00e3bb6", "message": "Merge branch 'dev-2.5' into feature/message-optional-sender", "committedDate": "2020-11-27T23:14:45Z", "type": "commit"}, {"oid": "1953e28eb8762d1a4febdfa5155c281b9a11bd86", "url": "https://github.com/SkriptLang/Skript/commit/1953e28eb8762d1a4febdfa5155c281b9a11bd86", "message": "EffMessage - add class check for CommandSender$Spigot (didnt exist in 1.9.4)", "committedDate": "2020-11-27T23:42:13Z", "type": "commit"}, {"oid": "4bb39f620936c6e6b94a42f77fdf8942b4be1fd4", "url": "https://github.com/SkriptLang/Skript/commit/4bb39f620936c6e6b94a42f77fdf8942b4be1fd4", "message": "EffMessage - fix a booboo i made", "committedDate": "2020-11-28T10:00:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwMzUwMA==", "url": "https://github.com/SkriptLang/Skript/pull/3577#discussion_r532103500", "bodyText": "The chat blocking system doesn't work if you don't send it as a player, right? If so, maybe it'd be better to say something like: This allows the chat ignore system added in Minecraft 1.16.4 to block these messages\nUp for discussion :D", "author": "APickledWalrus", "createdAt": "2020-11-28T20:32:03Z", "path": "src/main/java/ch/njol/skript/effects/EffMessage.java", "diffHunk": "@@ -37,20 +40,34 @@\n import ch.njol.skript.util.chat.BungeeConverter;\n import ch.njol.skript.util.chat.ChatMessages;\n import ch.njol.util.Kleenean;\n+import net.md_5.bungee.api.chat.BaseComponent;\n+import net.md_5.bungee.api.chat.TextComponent;\n \n @Name(\"Message\")\n @Description({\"Sends a message to the given player. Only styles written\",\n-\t\t\"in given string or in <a href=expressions.html#ExprColoured>formatted expressions</a> will be parsed.\"})\n+\t\t\"in given string or in <a href=expressions.html#ExprColoured>formatted expressions</a> will be parsed.\",\n+\t\t\"Adding an optional sender allows the messages to be sent as if a specific player sent them.\",\n+\t\t\"This is useful with Minecraft 1.16.4's new chat ignore system.\"})", "originalCommit": "4bb39f620936c6e6b94a42f77fdf8942b4be1fd4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwMzk5NA==", "url": "https://github.com/SkriptLang/Skript/pull/3577#discussion_r532103994", "bodyText": "Yes, Good call. Ill all a little more to the description.", "author": "ShaneBeee", "createdAt": "2020-11-28T20:37:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwMzUwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwNDIwMA==", "url": "https://github.com/SkriptLang/Skript/pull/3577#discussion_r532104200", "bodyText": "done \ud83d\udc4d", "author": "ShaneBeee", "createdAt": "2020-11-28T20:39:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwMzUwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwMzczMw==", "url": "https://github.com/SkriptLang/Skript/pull/3577#discussion_r532103733", "bodyText": "I don't know if this really matters, but would it be better to just initialize the variable above?", "author": "APickledWalrus", "createdAt": "2020-11-28T20:34:50Z", "path": "src/main/java/ch/njol/skript/effects/EffMessage.java", "diffHunk": "@@ -37,20 +40,34 @@\n import ch.njol.skript.util.chat.BungeeConverter;\n import ch.njol.skript.util.chat.ChatMessages;\n import ch.njol.util.Kleenean;\n+import net.md_5.bungee.api.chat.BaseComponent;\n+import net.md_5.bungee.api.chat.TextComponent;\n \n @Name(\"Message\")\n @Description({\"Sends a message to the given player. Only styles written\",\n-\t\t\"in given string or in <a href=expressions.html#ExprColoured>formatted expressions</a> will be parsed.\"})\n+\t\t\"in given string or in <a href=expressions.html#ExprColoured>formatted expressions</a> will be parsed.\",\n+\t\t\"Adding an optional sender allows the messages to be sent as if a specific player sent them.\",\n+\t\t\"This is useful with Minecraft 1.16.4's new chat ignore system.\"})\n @Examples({\"message \\\"A wild %player% appeared!\\\"\",\n \t\t\"message \\\"This message is a distraction. Mwahaha!\\\"\",\n \t\t\"send \\\"Your kill streak is %{kill streak::%uuid of player%}%.\\\" to player\",\n \t\t\"if the targeted entity exists:\",\n-\t\t\"\tmessage \\\"You're currently looking at a %type of the targeted entity%!\\\"\"})\n-@Since(\"1.0, 2.2-dev26 (advanced features)\")\n+\t\t\"\\tmessage \\\"You're currently looking at a %type of the targeted entity%!\\\"\",\n+\t\t\"on chat:\",\n+\t\t\"\\tcancel event\",\n+\t\t\"\\tsend \\\"[%player%] >> %message%\\\" to all players from player\"})\n+@RequiredPlugins(\"Minecraft 1.16.4+ for optional sender\")\n+@Since(\"1.0, 2.2-dev26 (advanced features), INSERT VERSION (optional sender)\")\n public class EffMessage extends Effect {\n \t\n+\tprivate static final boolean SUPPORTS_SENDER;\n+\t\n \tstatic {\n-\t\tSkript.registerEffect(EffMessage.class, \"(message|send [message[s]]) %strings% [to %commandsenders%]\");\n+\t\tSUPPORTS_SENDER = Skript.classExists(\"org.bukkit.command.CommandSender$Spigot\") && Skript.methodExists(CommandSender.Spigot.class, \"sendMessage\", UUID.class, BaseComponent.class);", "originalCommit": "4bb39f620936c6e6b94a42f77fdf8942b4be1fd4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwNDAyOQ==", "url": "https://github.com/SkriptLang/Skript/pull/3577#discussion_r532104029", "bodyText": "Yeah I could do that.", "author": "ShaneBeee", "createdAt": "2020-11-28T20:37:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwMzczMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwNDIxNQ==", "url": "https://github.com/SkriptLang/Skript/pull/3577#discussion_r532104215", "bodyText": "done \ud83d\udc4d", "author": "ShaneBeee", "createdAt": "2020-11-28T20:39:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEwMzczMw=="}], "type": "inlineReview"}, {"oid": "85116f2701e33dd6c0da20bd64d94bc00c0d2607", "url": "https://github.com/SkriptLang/Skript/commit/85116f2701e33dd6c0da20bd64d94bc00c0d2607", "message": "EffMessage - add better description", "committedDate": "2020-11-28T20:39:39Z", "type": "commit"}, {"oid": "d01bc128a6c1c6f94ffbaade57859934341bbc04", "url": "https://github.com/SkriptLang/Skript/commit/d01bc128a6c1c6f94ffbaade57859934341bbc04", "message": "Merge branch 'dev-2.5' into feature/message-optional-sender", "committedDate": "2020-11-28T21:07:36Z", "type": "commit"}]}