{"pr_number": 2761, "pr_title": "HealthUtils - Fix entity damage effect", "pr_createdAt": "2020-01-13T21:55:55Z", "pr_url": "https://github.com/SkriptLang/Skript/pull/2761", "timeline": [{"oid": "fee5120549ab23cfb11eba4f28db17127e0cff7b", "url": "https://github.com/SkriptLang/Skript/commit/fee5120549ab23cfb11eba4f28db17127e0cff7b", "message": "HealthUtils - fix an issue with entity not taking damage when using damage effect", "committedDate": "2020-01-13T21:52:36Z", "type": "commit"}, {"oid": "6152308a5289f4ec09d152cf1b7662dab4f3e727", "url": "https://github.com/SkriptLang/Skript/commit/6152308a5289f4ec09d152cf1b7662dab4f3e727", "message": "HealthUtils - fix CRLF", "committedDate": "2020-01-13T21:54:28Z", "type": "commit"}, {"oid": "ff6d907e3faeb6a06ec01ca064d871006a997c8b", "url": "https://github.com/SkriptLang/Skript/commit/ff6d907e3faeb6a06ec01ca064d871006a997c8b", "message": "EffHealth test - remove 1 line of damage\n- This is a spigot/MC issue (not a skript issue), damaging an entity in quick succession to many times causes the entity to not take all damage", "committedDate": "2020-01-14T22:18:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDA0Nw==", "url": "https://github.com/SkriptLang/Skript/pull/2761#discussion_r366920047", "bodyText": "Why does this change make tests pass? Is there a bug in test system or EffHealth?", "author": "bensku", "createdAt": "2020-01-15T14:56:00Z", "path": "src/test/skript/tests/syntaxes/effects/EffHealth.sk", "diffHunk": "@@ -8,12 +8,10 @@ test \"health effect\":\n \tspawn zombie at location(0, 64, 0, world \"world\")\n \tset {_m} to last spawned zombie\n \tassert health of {_m} is 10 with \"default zombie health failed\"\n-\tdamage {_m} by 2\n-\tassert health of {_m} is 8 with \"damage zombie ##1 failed\"\n \tdamage {_m} by 0.5", "originalCommit": "ff6d907e3faeb6a06ec01ca064d871006a997c8b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyNDc3OA==", "url": "https://github.com/SkriptLang/Skript/pull/2761#discussion_r366924778", "bodyText": "No, this even happens when using Skript + Skript-mirror. entity.damage(num) ... Damaging an entity in quick succession skips the 2nd damage when there is three. Im unsure why, but I would assume this is either a Spigot/CB or MC bugs/glitch.", "author": "ShaneBeee", "createdAt": "2020-01-15T15:04:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDA0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg3MTgyMQ==", "url": "https://github.com/SkriptLang/Skript/pull/2761#discussion_r367871821", "bodyText": "Call me crazy, but what if Skript fixed this issue by calling entity.damage() FOLLOWED BY setHealth()? That works because no extra damage will be applied, and:\n\nHealth is properly reported back to the user in Scripts & Java CI\nEntity will get the damaged visual effect\n\nEven though this may not strictly be a Skript issue, we can still workaround the issue to make sure that users aren't affected by the lack of entity damage visual effects or incorrect health being returned. Performance-wise, I don't think this would add much overhead either (correct me if I'm wrong here).", "author": "Wealthyturtle", "createdAt": "2020-01-17T10:40:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDA0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDA4NDMyNA==", "url": "https://github.com/SkriptLang/Skript/pull/2761#discussion_r374084324", "bodyText": "Sorry for inactivity. Minecraft has invulnerability ticks after taking damage, probably affects Bukkit API too. This is not a bug, so the changing test makes sense.\n@Wealthyturtle We could explore this in later release for 2.5. I'm a bit wary of it due to potential differences in MC versions supported by us.", "author": "bensku", "createdAt": "2020-02-03T12:51:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDA0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE1NzU3NA==", "url": "https://github.com/SkriptLang/Skript/pull/2761#discussion_r374157574", "bodyText": "Alright, no problem.", "author": "Wealthyturtle", "createdAt": "2020-02-03T15:12:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDA0Nw=="}], "type": "inlineReview"}]}