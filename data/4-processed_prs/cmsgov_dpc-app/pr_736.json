{"pr_number": 736, "pr_title": "DPC-1197: As an external user, I want an alert telling me if I'm trying to reuse a Public Key.", "pr_createdAt": "2020-04-08T13:04:40Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/736", "timeline": [{"oid": "7cb66cedb5014c609ec1fc3bd352a08d66843c40", "url": "https://github.com/CMSgov/dpc-app/commit/7cb66cedb5014c609ec1fc3bd352a08d66843c40", "message": "Alert for public key errors now visible", "committedDate": "2020-04-07T16:59:04Z", "type": "commit"}, {"oid": "8f118ad047514c0c8b4568fbf2272ce89e32c414", "url": "https://github.com/CMSgov/dpc-app/commit/8f118ad047514c0c8b4568fbf2272ce89e32c414", "message": "Errors for invalid public key submissions now visible\n\nAdded 'pry-nav' gem for easier debugging.\nAPI errors for invalid public keys now visible on public key form view.", "committedDate": "2020-04-07T20:58:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwODY4OQ==", "url": "https://github.com/CMSgov/dpc-app/pull/736#discussion_r405508689", "bodyText": "Trailing whitespace detected.", "author": "codeclimate", "createdAt": "2020-04-08T13:05:36Z", "path": "dpc-web/app/services/public_key_manager.rb", "diffHunk": "@@ -11,12 +11,18 @@ def initialize(api_env:, registered_organization:)\n \n   def create_public_key(public_key:, label:)\n     public_key = strip_carriage_returns(public_key)\n-    return false if invalid_encoding?(public_key)\n+    if invalid_encoding?(public_key)\n+      return { response: false,\n+               message: @errors[0] }\n+    end\n \n     api_client = APIClient.new(api_env)\n     api_client.create_public_key(registered_organization.api_id, params: { label: label, public_key: public_key })\n \n-    api_client.response_successful?\n+    pk_response = api_client.response_body\n+\n+    return { response: api_client.response_successful?, ", "originalCommit": "8f118ad047514c0c8b4568fbf2272ce89e32c414", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwODY5MQ==", "url": "https://github.com/CMSgov/dpc-app/pull/736#discussion_r405508691", "bodyText": "Redundant return detected.", "author": "codeclimate", "createdAt": "2020-04-08T13:05:36Z", "path": "dpc-web/app/services/public_key_manager.rb", "diffHunk": "@@ -11,12 +11,18 @@ def initialize(api_env:, registered_organization:)\n \n   def create_public_key(public_key:, label:)\n     public_key = strip_carriage_returns(public_key)\n-    return false if invalid_encoding?(public_key)\n+    if invalid_encoding?(public_key)\n+      return { response: false,\n+               message: @errors[0] }\n+    end\n \n     api_client = APIClient.new(api_env)\n     api_client.create_public_key(registered_organization.api_id, params: { label: label, public_key: public_key })\n \n-    api_client.response_successful?\n+    pk_response = api_client.response_body\n+\n+    return { response: api_client.response_successful?, ", "originalCommit": "8f118ad047514c0c8b4568fbf2272ce89e32c414", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "37ff0281320489cd8f9c1031afb081396f796f82", "url": "https://github.com/CMSgov/dpc-app/commit/37ff0281320489cd8f9c1031afb081396f796f82", "message": "Code Climate fixes of redundant 'return' and whitespace", "committedDate": "2020-04-08T13:08:24Z", "type": "commit"}, {"oid": "051b7f3eef35ed0c7f84221aba3e0ea3501a5cf8", "url": "https://github.com/CMSgov/dpc-app/commit/051b7f3eef35ed0c7f84221aba3e0ea3501a5cf8", "message": "Gem file conflicts resolved", "committedDate": "2020-04-08T13:09:38Z", "type": "commit"}, {"oid": "c88508d5304041a15a7570935ea232309a19a723", "url": "https://github.com/CMSgov/dpc-app/commit/c88508d5304041a15a7570935ea232309a19a723", "message": "Merge branch 'master' into nzonnenberg/dpc-1197-public-key-alert", "committedDate": "2020-04-08T13:11:21Z", "type": "commit"}, {"oid": "fa550a0daedef507a8d495337ec4d2f6b3d026fe", "url": "https://github.com/CMSgov/dpc-app/commit/fa550a0daedef507a8d495337ec4d2f6b3d026fe", "message": "Code cleanup - removed single use variable", "committedDate": "2020-04-08T13:34:05Z", "type": "commit"}, {"oid": "ff3b684a2a4c2d543fbe346fc97bda43b8ebd8cd", "url": "https://github.com/CMSgov/dpc-app/commit/ff3b684a2a4c2d543fbe346fc97bda43b8ebd8cd", "message": "Test fixes", "committedDate": "2020-04-08T14:39:17Z", "type": "commit"}, {"oid": "75f7844a81dca330d5557dc1f479744999dc64a2", "url": "https://github.com/CMSgov/dpc-app/commit/75f7844a81dca330d5557dc1f479744999dc64a2", "message": "Failed API request test fix", "committedDate": "2020-04-13T16:36:02Z", "type": "commit"}, {"oid": "beeb04516254d48b5d61e968eb50b3d8b1000a82", "url": "https://github.com/CMSgov/dpc-app/commit/beeb04516254d48b5d61e968eb50b3d8b1000a82", "message": "Merge branch 'master' into nzonnenberg/dpc-1197-public-key-alert", "committedDate": "2020-04-23T12:22:04Z", "type": "commit"}]}