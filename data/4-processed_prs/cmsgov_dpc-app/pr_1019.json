{"pr_number": 1019, "pr_title": "DPC-613: Build a basic performance test suite for attribution", "pr_createdAt": "2020-09-04T12:42:16Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/1019", "timeline": [{"oid": "a7daec7ad339078595dc2484f6b9301e3cef1308", "url": "https://github.com/CMSgov/dpc-app/commit/a7daec7ad339078595dc2484f6b9301e3cef1308", "message": "Basic performance and load test setup for metadata endpoint", "committedDate": "2020-09-04T12:52:50Z", "type": "commit"}, {"oid": "a7daec7ad339078595dc2484f6b9301e3cef1308", "url": "https://github.com/CMSgov/dpc-app/commit/a7daec7ad339078595dc2484f6b9301e3cef1308", "message": "Basic performance and load test setup for metadata endpoint", "committedDate": "2020-09-04T12:52:50Z", "type": "forcePushed"}, {"oid": "5b15b4ad2a5a2a3647a3e6cd31c20dce34e85eab", "url": "https://github.com/CMSgov/dpc-app/commit/5b15b4ad2a5a2a3647a3e6cd31c20dce34e85eab", "message": "Note environment options for running outside Docker", "committedDate": "2020-09-04T13:50:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyODE4Ng==", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483628186", "bodyText": "This is a pretty picky comment, so feel free to ignore. The name of that script is pretty long. I wonder if dpc-load-test.sh would be descriptive enough? I suppose we could eventually create a make command for it as well.", "author": "jonfulk", "createdAt": "2020-09-04T13:50:35Z", "path": "dpc-testing/performance/README.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# Performance and Load Tests\n+\n+DPC performance and load tests use [k6](https://k6.io/).\n+\n+## Running the tests\n+### Shell script\n+The performance and load tests may be run using the script `dpc-perf-load-test.sh`. This will run k6 with Docker. Specify the environment you wish to test by setting the environment variable `ENV`. The options are `docker`, `dev`, `test`, `sandbox`, and `prod`.", "originalCommit": "a7daec7ad339078595dc2484f6b9301e3cef1308", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyOTcwMg==", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483629702", "bodyText": "is local also an option for the shell script, or only with k6?", "author": "jonfulk", "createdAt": "2020-09-04T13:53:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyODE4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYzMjMzOA==", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483632338", "bodyText": "Great question! I was having some trouble with the naming. local will use localhost:3002, which won't work when running inside Docker. That's why I added the docker option, which uses host.docker.internal:3002. Would that make more sense as local-docker or another name?", "author": "em1", "createdAt": "2020-09-04T13:57:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyODE4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYzNDkyOQ==", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483634929", "bodyText": "That makes sense. I was mainly confused because you don't list local in the env options above, and you don't list docker in the env options below even though local and docker are both listed in config.js", "author": "jonfulk", "createdAt": "2020-09-04T14:01:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyODE4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYzNDk1NQ==", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483634955", "bodyText": "Regarding the script name, that's another open question. The ticket requested performance and load tests, but I don't know if the right approach is to put them in one script or split them up. I wanted to be clear that the shell script was doing both, but if we split them up, that solves the long name concern. \ud83e\udd14", "author": "em1", "createdAt": "2020-09-04T14:01:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyODE4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyOTg0NA==", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483629844", "bodyText": "is docker also an option here?", "author": "jonfulk", "createdAt": "2020-09-04T13:53:24Z", "path": "dpc-testing/performance/README.md", "diffHunk": "@@ -0,0 +1,16 @@\n+# Performance and Load Tests\n+\n+DPC performance and load tests use [k6](https://k6.io/).\n+\n+## Running the tests\n+### Shell script\n+The performance and load tests may be run using the script `dpc-perf-load-test.sh`. This will run k6 with Docker. Specify the environment you wish to test by setting the environment variable `ENV`. The options are `docker`, `dev`, `test`, `sandbox`, and `prod`.\n+```\n+ENV=docker ./dpc-perf-load-test.sh\n+```\n+\n+### With k6\n+After installing k6, you can run the tests directly. Specify the environment with the flag `-e env={environment}`, and the test script file. The environment options are `local`, `dev`, `test`, `sandbox`, and `prod`.", "originalCommit": "5b15b4ad2a5a2a3647a3e6cd31c20dce34e85eab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYzMjkzMQ==", "url": "https://github.com/CMSgov/dpc-app/pull/1019#discussion_r483632931", "bodyText": "(Answered above: #1019 (comment))", "author": "em1", "createdAt": "2020-09-04T13:58:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYyOTg0NA=="}], "type": "inlineReview"}, {"oid": "862e403495c82a6c3a60ebae3c2a4c8934020955", "url": "https://github.com/CMSgov/dpc-app/commit/862e403495c82a6c3a60ebae3c2a4c8934020955", "message": "Append /api to dev, test, sandbox, and prod base URLs", "committedDate": "2020-09-04T14:22:15Z", "type": "commit"}, {"oid": "2b32a4a6ceaba4018d3ac649aa2abbaa36590f47", "url": "https://github.com/CMSgov/dpc-app/commit/2b32a4a6ceaba4018d3ac649aa2abbaa36590f47", "message": "Tweak VUs and duration in load test, and request duration expectation in performance test", "committedDate": "2020-09-04T17:25:02Z", "type": "commit"}]}