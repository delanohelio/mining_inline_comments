{"pr_number": 586, "pr_title": "DPC-1027: Add Public Key operations to CLI", "pr_createdAt": "2020-02-04T16:31:56Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/586", "timeline": [{"oid": "959fde7d8a780ff8837dbc265d12527d0fc7a876", "url": "https://github.com/CMSgov/dpc-app/commit/959fde7d8a780ff8837dbc265d12527d0fc7a876", "message": "DPC-1027: Refactor admin operations\n\nCreated new public key admin endpoints and split them off from the previously existing token operations.\n\nAlso refactored some of the common parameter extraction logic.", "committedDate": "2020-02-04T16:30:32Z", "type": "commit"}, {"oid": "41bc83e584cd30595ebccaba412ad0146e1174c0", "url": "https://github.com/CMSgov/dpc-app/commit/41bc83e584cd30595ebccaba412ad0146e1174c0", "message": "DPC-1027: Create CLI operations for managing public keys\n\nAdded upload, delete and list command for organization public keys.", "committedDate": "2020-02-04T16:31:28Z", "type": "commit"}, {"oid": "5869a8f1e39ce49903a33f4cfd04e9485e79992d", "url": "https://github.com/CMSgov/dpc-app/commit/5869a8f1e39ce49903a33f4cfd04e9485e79992d", "message": "DPC-1027: Error Prone fixes", "committedDate": "2020-02-04T18:08:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0Mzg5Nw==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r374843897", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-04T18:25:57Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyList.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package gov.cms.dpc.api.cli.keys;\n+\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import com.jakewharton.fliptables.FlipTable;\n+import gov.cms.dpc.api.cli.AbstractAdminCommand;\n+import gov.cms.dpc.api.entities.PublicKeyEntity;\n+import gov.cms.dpc.api.models.CollectionResponse;\n+import io.dropwizard.setup.Bootstrap;\n+import net.sourceforge.argparse4j.inf.Namespace;\n+import net.sourceforge.argparse4j.inf.Subparser;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.utils.URIBuilder;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.eclipse.jetty.http.HttpStatus;\n+import org.hl7.fhir.dstu3.model.IdType;\n+\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.time.format.DateTimeFormatter;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+public class KeyList extends AbstractAdminCommand {\n+\n+    public KeyList() {\n+        super(\"list\", \"List public keys for registered Organization.\");\n+    }\n+\n+    @Override\n+    public void addAdditionalOptions(Subparser subparser) {\n+        subparser\n+                .addArgument(\"id\")\n+                .required(true)\n+                .dest(\"org-reference\")\n+                .help(\"ID of Organization to list tokens\");\n+    }\n+\n+    @Override\n+    public void run(Bootstrap<?> bootstrap, Namespace namespace) throws Exception {\n+        // Get the reference\n+        final String orgReference = namespace.getString(\"org-reference\");\n+        System.out.println(String.format(\"Listing keys for organization: %s.\", orgReference));\n+\n+        final String apiService = namespace.getString(API_HOSTNAME);\n+        System.out.println(String.format(\"Connecting to API service at: %s\", apiService));\n+        listKeys(apiService, orgReference);\n+    }\n+\n+    private void listKeys(String apiService, String organization) throws IOException, URISyntaxException {", "originalCommit": "5869a8f1e39ce49903a33f4cfd04e9485e79992d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0MzkwMw==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r374843903", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-04T18:25:58Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/tokens/TokenList.java", "diffHunk": "@@ -53,10 +49,10 @@ public void run(Bootstrap<?> bootstrap, Namespace namespace) throws IOException,\n         listTokens(apiService, orgReference);\n     }\n \n-    private void listTokens(String attributionService, String organization) throws IOException, URISyntaxException {\n-        // List all the tokens, switching\n+    private void listTokens(String apiService, String organization) throws IOException, URISyntaxException {", "originalCommit": "5869a8f1e39ce49903a33f4cfd04e9485e79992d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0MzkxMA==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r374843910", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-04T18:25:58Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyDelete.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package gov.cms.dpc.api.cli.keys;\n+\n+import gov.cms.dpc.api.cli.AbstractAdminCommand;\n+import io.dropwizard.setup.Bootstrap;\n+import net.sourceforge.argparse4j.inf.Namespace;\n+import net.sourceforge.argparse4j.inf.Subparser;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.utils.URIBuilder;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.eclipse.jetty.http.HttpStatus;\n+import org.hl7.fhir.dstu3.model.IdType;\n+\n+public class KeyDelete extends AbstractAdminCommand {\n+\n+    private static final String KEY_ID = \"key-id\";\n+    private static final String ORG_REFERENCE = \"org-reference\";\n+\n+    public KeyDelete() {\n+        super(\"delete\", \"Delete public key for registered Organization.\");\n+    }\n+\n+    @Override\n+    public void addAdditionalOptions(Subparser subparser) {\n+        subparser\n+                .addArgument(\"--org\", \"-o\")\n+                .dest(\"org-reference\")\n+                .required(true)\n+                .help(\"Organization entity\");\n+        subparser\n+                .addArgument(\"id\")\n+                .required(true)\n+                .dest(KEY_ID)\n+                .help(\"ID of Public Key to delete\");\n+    }\n+\n+    @Override\n+    public void run(Bootstrap<?> bootstrap, Namespace namespace) throws Exception {\n+        // Get the reference\n+        final String orgReference = namespace.getString(ORG_REFERENCE);\n+        final String keyID = namespace.getString(KEY_ID);\n+        System.out.println(String.format(\"Deleting public key %s for organization %s\", keyID, orgReference));\n+\n+        final String apiService = namespace.getString(API_HOSTNAME);\n+        System.out.println(String.format(\"Connecting to API service at: %s\", apiService));\n+\n+        // Delete the token\n+        try (final CloseableHttpClient httpClient = HttpClients.createDefault()) {", "originalCommit": "5869a8f1e39ce49903a33f4cfd04e9485e79992d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0MzkxNg==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r374843916", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-04T18:25:58Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/tasks/keys/DeletePublicKey.java", "diffHunk": "@@ -0,0 +1,50 @@\n+package gov.cms.dpc.api.tasks.keys;", "originalCommit": "5869a8f1e39ce49903a33f4cfd04e9485e79992d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0MzkyMQ==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r374843921", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-04T18:25:59Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/tasks/tokens/DeleteToken.java", "diffHunk": "@@ -1,4 +1,4 @@\n-package gov.cms.dpc.api.tasks;\n+package gov.cms.dpc.api.tasks.tokens;", "originalCommit": "5869a8f1e39ce49903a33f4cfd04e9485e79992d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a75cc4198998e57459448358e5d5f142d4f2ad68", "url": "https://github.com/CMSgov/dpc-app/commit/a75cc4198998e57459448358e5d5f142d4f2ad68", "message": "DPC-1027: Add test class for public key admin tasks\n\nMocking the key resource to ensure the admin tasks are covered.", "committedDate": "2020-02-07T17:45:19Z", "type": "commit"}, {"oid": "32b0a8f90565205bf3c47b85cec71136372c8b78", "url": "https://github.com/CMSgov/dpc-app/commit/32b0a8f90565205bf3c47b85cec71136372c8b78", "message": "DPC-1027: Added unit tests for client token tests\n\nAdded unit tests for the admin tasks, to ensure that they edge cases are covered. Nice to have good code coverage numbers and address some tech debt.", "committedDate": "2020-02-07T18:27:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU0Nzg5NA==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r376547894", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-07T18:46:46Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/tasks/keys/ListPublicKeys.java", "diffHunk": "@@ -0,0 +1,43 @@\n+package gov.cms.dpc.api.tasks.keys;", "originalCommit": "32b0a8f90565205bf3c47b85cec71136372c8b78", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU0Nzg5OQ==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r376547899", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-07T18:46:46Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/tasks/tokens/ListClientTokens.java", "diffHunk": "@@ -1,7 +1,6 @@\n-package gov.cms.dpc.api.tasks;\n+package gov.cms.dpc.api.tasks.tokens;", "originalCommit": "32b0a8f90565205bf3c47b85cec71136372c8b78", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU0NzkwMA==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r376547900", "bodyText": "Replace this use of System.out or System.err by a logger.", "author": "codeclimate", "createdAt": "2020-02-07T18:46:46Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyDelete.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package gov.cms.dpc.api.cli.keys;\n+\n+import gov.cms.dpc.api.cli.AbstractAdminCommand;\n+import io.dropwizard.setup.Bootstrap;\n+import net.sourceforge.argparse4j.inf.Namespace;\n+import net.sourceforge.argparse4j.inf.Subparser;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.utils.URIBuilder;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.eclipse.jetty.http.HttpStatus;\n+import org.hl7.fhir.dstu3.model.IdType;\n+\n+public class KeyDelete extends AbstractAdminCommand {\n+\n+    private static final String KEY_ID = \"key-id\";\n+    private static final String ORG_REFERENCE = \"org-reference\";\n+\n+    public KeyDelete() {\n+        super(\"delete\", \"Delete public key for registered Organization.\");\n+    }\n+\n+    @Override\n+    public void addAdditionalOptions(Subparser subparser) {\n+        subparser\n+                .addArgument(\"--org\", \"-o\")\n+                .dest(\"org-reference\")\n+                .required(true)\n+                .help(\"Organization entity\");\n+        subparser\n+                .addArgument(\"id\")\n+                .required(true)\n+                .dest(KEY_ID)\n+                .help(\"ID of Public Key to delete\");\n+    }\n+\n+    @Override\n+    public void run(Bootstrap<?> bootstrap, Namespace namespace) throws Exception {\n+        // Get the reference\n+        final String orgReference = namespace.getString(ORG_REFERENCE);\n+        final String keyID = namespace.getString(KEY_ID);\n+        System.out.println(String.format(\"Deleting public key %s for organization %s\", keyID, orgReference));", "originalCommit": "32b0a8f90565205bf3c47b85cec71136372c8b78", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU0NzkwMg==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r376547902", "bodyText": "Replace this use of System.out or System.err by a logger.", "author": "codeclimate", "createdAt": "2020-02-07T18:46:47Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyDelete.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package gov.cms.dpc.api.cli.keys;\n+\n+import gov.cms.dpc.api.cli.AbstractAdminCommand;\n+import io.dropwizard.setup.Bootstrap;\n+import net.sourceforge.argparse4j.inf.Namespace;\n+import net.sourceforge.argparse4j.inf.Subparser;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.utils.URIBuilder;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.eclipse.jetty.http.HttpStatus;\n+import org.hl7.fhir.dstu3.model.IdType;\n+\n+public class KeyDelete extends AbstractAdminCommand {\n+\n+    private static final String KEY_ID = \"key-id\";\n+    private static final String ORG_REFERENCE = \"org-reference\";\n+\n+    public KeyDelete() {\n+        super(\"delete\", \"Delete public key for registered Organization.\");\n+    }\n+\n+    @Override\n+    public void addAdditionalOptions(Subparser subparser) {\n+        subparser\n+                .addArgument(\"--org\", \"-o\")\n+                .dest(\"org-reference\")\n+                .required(true)\n+                .help(\"Organization entity\");\n+        subparser\n+                .addArgument(\"id\")\n+                .required(true)\n+                .dest(KEY_ID)\n+                .help(\"ID of Public Key to delete\");\n+    }\n+\n+    @Override\n+    public void run(Bootstrap<?> bootstrap, Namespace namespace) throws Exception {\n+        // Get the reference\n+        final String orgReference = namespace.getString(ORG_REFERENCE);\n+        final String keyID = namespace.getString(KEY_ID);\n+        System.out.println(String.format(\"Deleting public key %s for organization %s\", keyID, orgReference));\n+\n+        final String apiService = namespace.getString(API_HOSTNAME);\n+        System.out.println(String.format(\"Connecting to API service at: %s\", apiService));\n+\n+        // Delete the token\n+        try (final CloseableHttpClient httpClient = HttpClients.createDefault()) {\n+            final URIBuilder builder = new URIBuilder(String.format(\"%s/delete-key\", apiService));\n+            builder.setParameter(\"organization\", new IdType(orgReference).getIdPart());\n+            builder.setParameter(\"key\", keyID);\n+            final HttpPost keyDelete = new HttpPost(builder.build());\n+\n+            try (CloseableHttpResponse response = httpClient.execute(keyDelete)) {\n+                if (!HttpStatus.isSuccess(response.getStatusLine().getStatusCode())) {\n+                    System.err.println(\"Error deleting key: \" + response.getStatusLine().getReasonPhrase());\n+                    System.exit(1);\n+                }\n+            }\n+        }\n+\n+        System.out.println(\"Successfully deleted public key\");", "originalCommit": "32b0a8f90565205bf3c47b85cec71136372c8b78", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU0NzkwNg==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r376547906", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-07T18:46:47Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyList.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package gov.cms.dpc.api.cli.keys;\n+\n+import com.fasterxml.jackson.core.type.TypeReference;\n+import com.jakewharton.fliptables.FlipTable;\n+import gov.cms.dpc.api.cli.AbstractAdminCommand;\n+import gov.cms.dpc.api.entities.PublicKeyEntity;\n+import gov.cms.dpc.api.models.CollectionResponse;\n+import io.dropwizard.setup.Bootstrap;\n+import net.sourceforge.argparse4j.inf.Namespace;\n+import net.sourceforge.argparse4j.inf.Subparser;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.utils.URIBuilder;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.eclipse.jetty.http.HttpStatus;\n+import org.hl7.fhir.dstu3.model.IdType;\n+\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.time.format.DateTimeFormatter;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+public class KeyList extends AbstractAdminCommand {\n+\n+    public KeyList() {\n+        super(\"list\", \"List public keys for registered Organization.\");\n+    }\n+\n+    @Override\n+    public void addAdditionalOptions(Subparser subparser) {\n+        subparser\n+                .addArgument(\"id\")\n+                .required(true)\n+                .dest(\"org-reference\")\n+                .help(\"ID of Organization to list tokens\");\n+    }\n+\n+    @Override", "originalCommit": "32b0a8f90565205bf3c47b85cec71136372c8b78", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1d7c5974460ab89bf0388cc3fe2fa4c35963f69f", "url": "https://github.com/CMSgov/dpc-app/commit/1d7c5974460ab89bf0388cc3fe2fa4c35963f69f", "message": "Merge branch 'master' into nickrobison/DPC-1027-key-cli", "committedDate": "2020-02-07T20:41:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ2OTIxNw==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r379469217", "bodyText": "Register subcommands here. See details in other comment.", "author": "DeirdreHolub", "createdAt": "2020-02-14T14:48:14Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyCommand.java", "diffHunk": "@@ -0,0 +1,10 @@\n+package gov.cms.dpc.api.cli.keys;\n+\n+import gov.cms.dpc.api.cli.AbstractCommandTree;\n+\n+public class KeyCommand extends AbstractCommandTree {\n+\n+    protected KeyCommand() {\n+        super(\"key\", \"Public key related commands\");\n+    }", "originalCommit": "1d7c5974460ab89bf0388cc3fe2fa4c35963f69f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDcxNzE5Ng==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r380717196", "bodyText": "Well that was embarrassing, thanks for catching it!", "author": "nickrobison-usds", "createdAt": "2020-02-18T14:47:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ2OTIxNw=="}], "type": "inlineReview"}, {"oid": "0506769a4ba74fc861769b34ddcd0749b83f637f", "url": "https://github.com/CMSgov/dpc-app/commit/0506769a4ba74fc861769b34ddcd0749b83f637f", "message": "DPC-1027: Actually register CLI commands.\n\nRegister the key subcommands and the root command with the API service.", "committedDate": "2020-02-18T14:46:36Z", "type": "commit"}, {"oid": "7ea5e581b31a99f9fb71a7b6a5e37caa74278363", "url": "https://github.com/CMSgov/dpc-app/commit/7ea5e581b31a99f9fb71a7b6a5e37caa74278363", "message": "Merge branch 'master' into nickrobison/DPC-1027-key-cli", "committedDate": "2020-02-18T14:46:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTMxNjAwOA==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r381316008", "bodyText": "Should this say something more like, ID of organization to upload key for?", "author": "em1", "createdAt": "2020-02-19T14:15:05Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyUpload.java", "diffHunk": "@@ -0,0 +1,92 @@\n+package gov.cms.dpc.api.cli.keys;\n+\n+import gov.cms.dpc.api.cli.AbstractAdminCommand;\n+import io.dropwizard.setup.Bootstrap;\n+import net.sourceforge.argparse4j.inf.Namespace;\n+import net.sourceforge.argparse4j.inf.Subparser;\n+import org.apache.http.HttpHeaders;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.utils.URIBuilder;\n+import org.apache.http.entity.StringEntity;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.http.util.EntityUtils;\n+import org.eclipse.jetty.http.HttpStatus;\n+import org.hl7.fhir.dstu3.model.IdType;\n+\n+import javax.ws.rs.core.MediaType;\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.nio.file.FileSystems;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.Optional;\n+\n+public class KeyUpload extends AbstractAdminCommand {\n+\n+    private static final String KEY_FILE = \"key-file\";\n+\n+    public KeyUpload() {\n+        super(\"upload\", \"Upload organization public key\");\n+    }\n+\n+    @Override\n+    public void addAdditionalOptions(Subparser subparser) {\n+        subparser\n+                .addArgument(\"id\")\n+                .required(true)\n+                .dest(\"org-reference\")\n+                .help(\"ID of Organization to list tokens\");", "originalCommit": "7ea5e581b31a99f9fb71a7b6a5e37caa74278363", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "372f791f7d437d5f26bbf2c69fcded023eb1cd45", "url": "https://github.com/CMSgov/dpc-app/commit/372f791f7d437d5f26bbf2c69fcded023eb1cd45", "message": "DPC-1027: Fix CLI command labels", "committedDate": "2020-02-19T14:32:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQwODg1Nw==", "url": "https://github.com/CMSgov/dpc-app/pull/586#discussion_r381408857", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            .help(\"ID of Organization to upload keys tokens\");\n          \n          \n            \n                            .help(\"ID of Organization to upload key\");", "author": "em1", "createdAt": "2020-02-19T16:56:39Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/cli/keys/KeyUpload.java", "diffHunk": "@@ -0,0 +1,92 @@\n+package gov.cms.dpc.api.cli.keys;\n+\n+import gov.cms.dpc.api.cli.AbstractAdminCommand;\n+import io.dropwizard.setup.Bootstrap;\n+import net.sourceforge.argparse4j.inf.Namespace;\n+import net.sourceforge.argparse4j.inf.Subparser;\n+import org.apache.http.HttpHeaders;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.utils.URIBuilder;\n+import org.apache.http.entity.StringEntity;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.http.util.EntityUtils;\n+import org.eclipse.jetty.http.HttpStatus;\n+import org.hl7.fhir.dstu3.model.IdType;\n+\n+import javax.ws.rs.core.MediaType;\n+import java.io.IOException;\n+import java.net.URISyntaxException;\n+import java.nio.file.FileSystems;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.Optional;\n+\n+public class KeyUpload extends AbstractAdminCommand {\n+\n+    private static final String KEY_FILE = \"key-file\";\n+\n+    public KeyUpload() {\n+        super(\"upload\", \"Upload organization public key\");\n+    }\n+\n+    @Override\n+    public void addAdditionalOptions(Subparser subparser) {\n+        subparser\n+                .addArgument(\"id\")\n+                .required(true)\n+                .dest(\"org-reference\")\n+                .help(\"ID of Organization to upload keys tokens\");", "originalCommit": "372f791f7d437d5f26bbf2c69fcded023eb1cd45", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}