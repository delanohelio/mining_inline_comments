{"pr_number": 1135, "pr_title": "DPC-815 Feature: Add smoke test to Github Actions workflow", "pr_createdAt": "2020-12-06T22:35:30Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/1135", "timeline": [{"oid": "f7dad8825e76b3f417353a72479487ea9a790085", "url": "https://github.com/CMSgov/dpc-app/commit/f7dad8825e76b3f417353a72479487ea9a790085", "message": "add smoke test to gh workflow\n\nSigned-off-by: Jeff Corpuz <jeffcorpuz@icloud.com>", "committedDate": "2020-12-06T22:24:58Z", "type": "commit"}, {"oid": "0351e9e193ae8e18b8d106ef819b42f7d5694e5c", "url": "https://github.com/CMSgov/dpc-app/commit/0351e9e193ae8e18b8d106ef819b42f7d5694e5c", "message": "separate smoke test to own step\n\nSigned-off-by: Jeff Corpuz <jeffcorpuz@icloud.com>", "committedDate": "2020-12-06T22:38:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE3NzQwOA==", "url": "https://github.com/CMSgov/dpc-app/pull/1135#discussion_r537177408", "bodyText": "What is the difference between make smoke and make smoke/local?", "author": "msnook", "createdAt": "2020-12-07T01:43:21Z", "path": ".github/workflows/ci-workflow.yml", "diffHunk": "@@ -34,3 +35,22 @@ jobs:\n       - name: \"Website Build\"\n         run: |\n           make ci-web\n+          \n+  smoke-test:\n+    name: \"Run Smoke Test\"\n+    runs-on: ubuntu-latest\n+    steps:\n+      - name: \"Checkout code\"\n+        uses: actions/checkout@v1\n+      - name: \"Set up JDK 11\" \n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: '11.0.2'\n+      - name: \"Set up Python 3.8.1\"\n+        uses: actions/setup-python@v2\n+        with:\n+          python-version: '3.8.1'\n+      - name: \"Smoke Test\"\n+        run: |\n+          make smoke", "originalCommit": "0351e9e193ae8e18b8d106ef819b42f7d5694e5c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE4ODkzMg==", "url": "https://github.com/CMSgov/dpc-app/pull/1135#discussion_r537188932", "bodyText": "The difference between this and smoke/local is that it uses a spun up local environment from docker and runs it against it as well as skipping the djib tests which need to be enabled manually.\nIt will fail if we utilize smoke/local because it requires a person's input as well. You'd have to press enter to execute it as well as using an authenticated environment.\n\n=====\nThe Smoke Tests require an authenticated environment!\nVerify your local API environment has \"authenticationDisabled = false\" or these tests will fail.\n=====\n\nPress ENTER to run the tests...\n\n@dhgreene @DeirdreHolub can you provide more details than what I understand from reading the code?", "author": "jeffcorpuz", "createdAt": "2020-12-07T02:27:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE3NzQwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE3ODA5Mw==", "url": "https://github.com/CMSgov/dpc-app/pull/1135#discussion_r537178093", "bodyText": "The way this is configured, I think it will run in parallel with build-app and build-web.  Should we run it immediately after make ci-app since the job name is \"Build and Test API\".  I think that will reduce code redundancy (i.e., setting up JDK and Python multiple times) and also ensure that we're running smoke against the actual build.", "author": "msnook", "createdAt": "2020-12-07T01:46:05Z", "path": ".github/workflows/ci-workflow.yml", "diffHunk": "@@ -34,3 +35,22 @@ jobs:\n       - name: \"Website Build\"\n         run: |\n           make ci-web\n+          \n+  smoke-test:", "originalCommit": "0351e9e193ae8e18b8d106ef819b42f7d5694e5c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE4OTE5Nw==", "url": "https://github.com/CMSgov/dpc-app/pull/1135#discussion_r537189197", "bodyText": "Initially I chose that serial route, however I opted for this configuration to parallelize the build process. I chose this direction because I want the job to fail fast if one of the jobs failed.", "author": "jeffcorpuz", "createdAt": "2020-12-07T02:28:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE3ODA5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE5MjA2OQ==", "url": "https://github.com/CMSgov/dpc-app/pull/1135#discussion_r537192069", "bodyText": "Makes sense from a performance perspective.  But, typically the feedback loop is build, unit, integration.\nIt might be confusing to developers if the feedback loop results in integration tests failing earlier than the build/unit has even processed.", "author": "msnook", "createdAt": "2020-12-07T02:39:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE3ODA5Mw=="}], "type": "inlineReview"}, {"oid": "56e9bdc66f68ac43c2e477aeceb8717e0d34cbc9", "url": "https://github.com/CMSgov/dpc-app/commit/56e9bdc66f68ac43c2e477aeceb8717e0d34cbc9", "message": "run format, make smoke serial run after unit tests\n\nSigned-off-by: Jeff Corpuz <jeffcorpuz@icloud.com>", "committedDate": "2020-12-07T03:00:15Z", "type": "commit"}]}