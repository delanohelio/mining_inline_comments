{"pr_number": 1044, "pr_title": "DPC-573: Allow label creation from web app / Accept token label in body.", "pr_createdAt": "2020-09-15T21:31:25Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/1044", "timeline": [{"oid": "cbbabd1031bedfd15fbb924244e64d6c7c4fa527", "url": "https://github.com/CMSgov/dpc-app/commit/cbbabd1031bedfd15fbb924244e64d6c7c4fa527", "message": "Added TokenDTO to token resource.", "committedDate": "2020-09-15T21:27:30Z", "type": "commit"}, {"oid": "c3b4f7179e4190be5a0466f286a0f918fd0f5398", "url": "https://github.com/CMSgov/dpc-app/commit/c3b4f7179e4190be5a0466f286a0f918fd0f5398", "message": "Merge branch 'master' into sg/DPC-573-accept-body-in-token-creation-request", "committedDate": "2020-09-15T21:38:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk5MDY1Mw==", "url": "https://github.com/CMSgov/dpc-app/pull/1044#discussion_r488990653", "bodyText": "This file had been abandoned, deleted it since it was not being used.", "author": "MrMorie", "createdAt": "2020-09-15T21:39:52Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/models/TokenResponse.java", "diffHunk": "@@ -1,83 +0,0 @@\n-package gov.cms.dpc.api.models;", "originalCommit": "c3b4f7179e4190be5a0466f286a0f918fd0f5398", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "97b25848aed1fae7e8a1f075956d91d9cdce2fe1", "url": "https://github.com/CMSgov/dpc-app/commit/97b25848aed1fae7e8a1f075956d91d9cdce2fe1", "message": "Added TokenDto tests", "committedDate": "2020-09-15T22:36:39Z", "type": "commit"}, {"oid": "61c405cc2f43224b876b7a9975559d5bcdc9333b", "url": "https://github.com/CMSgov/dpc-app/commit/61c405cc2f43224b876b7a9975559d5bcdc9333b", "message": "Merge branch 'sg/DPC-573-accept-body-in-token-creation-request' of https://github.com/CMSgov/dpc-app into sg/DPC-573-accept-body-in-token-creation-request", "committedDate": "2020-09-15T22:37:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA2ODMwMw==", "url": "https://github.com/CMSgov/dpc-app/pull/1044#discussion_r489068303", "bodyText": "Method equals has a Cognitive Complexity of 10 (exceeds 9 allowed). Consider refactoring.", "author": "codeclimate", "createdAt": "2020-09-15T23:19:35Z", "path": "dpc-api/src/main/java/gov/cms/dpc/api/models/TokenDto.java", "diffHunk": "@@ -0,0 +1,117 @@\n+package gov.cms.dpc.api.models;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.databind.annotation.JsonDeserialize;\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n+import gov.cms.dpc.common.annotations.NoHtml;\n+import gov.cms.dpc.common.converters.jackson.OffsetDateTimeToStringConverter;\n+import gov.cms.dpc.common.converters.jackson.StringToOffsetDateTimeConverter;\n+\n+import java.io.Serializable;\n+import java.time.OffsetDateTime;\n+import java.util.Objects;\n+import java.util.UUID;\n+\n+\n+public class TokenDto implements Serializable {\n+\n+    private static final long serialVersionUID = 4464861101748469238L;\n+\n+    private String id;\n+\n+    private String tokenType;\n+\n+    @JsonIgnore\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    private UUID organizationID;\n+\n+    @NoHtml\n+    private String label;\n+\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    private String token;\n+\n+    @JsonSerialize(converter = OffsetDateTimeToStringConverter.class)\n+    @JsonDeserialize(converter = StringToOffsetDateTimeConverter.class)\n+    private OffsetDateTime createdAt;\n+\n+    @JsonSerialize(converter = OffsetDateTimeToStringConverter.class)\n+    @JsonDeserialize(converter = StringToOffsetDateTimeConverter.class)\n+    private OffsetDateTime expiresAt;\n+\n+    public TokenDto() {\n+        // Jackson required\n+    }\n+\n+    public String getId() {\n+        return id;\n+    }\n+\n+    public void setId(String id) {\n+        this.id = id;\n+    }\n+\n+    public String getTokenType() { return tokenType; }\n+\n+    public void setTokenType(String tokenType) { this.tokenType = tokenType; }\n+\n+    public UUID getOrganizationID() {\n+        return organizationID;\n+    }\n+\n+    public void setOrganizationID(UUID organizationID) {\n+        this.organizationID = organizationID;\n+    }\n+\n+    public String getLabel() {\n+        return label;\n+    }\n+\n+    public void setLabel(String label) {\n+        this.label = label;\n+    }\n+\n+    public String getToken() {\n+        return token;\n+    }\n+\n+    public void setToken(String token) {\n+        this.token = token;\n+    }\n+\n+    public OffsetDateTime getCreatedAt() {\n+        return createdAt;\n+    }\n+\n+    public void setCreatedAt(OffsetDateTime createdAt) {\n+        this.createdAt = createdAt;\n+    }\n+\n+    public OffsetDateTime getExpiresAt() {\n+        return expiresAt;\n+    }\n+\n+    public void setExpiresAt(OffsetDateTime expiresAt) {\n+        this.expiresAt = expiresAt;\n+    }\n+\n+    @Override", "originalCommit": "61c405cc2f43224b876b7a9975559d5bcdc9333b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6846f61ffa66d421a48b261a4eca5feb30044667", "url": "https://github.com/CMSgov/dpc-app/commit/6846f61ffa66d421a48b261a4eca5feb30044667", "message": "Fixed createdAt not being returned, Added proper response for offsetDateTime Deserialization", "committedDate": "2020-09-16T21:23:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTc3ODY0Ng==", "url": "https://github.com/CMSgov/dpc-app/pull/1044#discussion_r489778646", "bodyText": "Either remove or fill this block of code.", "author": "codeclimate", "createdAt": "2020-09-16T22:00:09Z", "path": "dpc-common/src/main/java/gov/cms/dpc/common/converters/jackson/MultiFormatOffsetDateTimeDeserializer.java", "diffHunk": "@@ -0,0 +1,29 @@\n+package gov.cms.dpc.common.converters.jackson;\n+\n+import com.fasterxml.jackson.databind.util.StdConverter;\n+import gov.cms.dpc.fhir.FHIRFormatters;\n+\n+import javax.ws.rs.WebApplicationException;\n+import javax.ws.rs.core.Response;\n+import java.time.OffsetDateTime;\n+import java.time.format.DateTimeFormatter;\n+import java.time.format.DateTimeParseException;\n+\n+/**\n+ * Deserialize from the format expected in the FHIR spec. For details see https://hl7.org/fhir/2018May/datatypes.html#instant\n+ */\n+public class MultiFormatOffsetDateTimeDeserializer extends StdConverter<String, OffsetDateTime> {\n+\n+    private static final DateTimeFormatter[] supportedFormats = {FHIRFormatters.INSTANT_FORMATTER, DateTimeFormatter.ISO_OFFSET_DATE_TIME};\n+\n+    @Override\n+    public OffsetDateTime convert(String s) {\n+\n+        for(DateTimeFormatter formatter:supportedFormats){\n+            try {\n+                return OffsetDateTime.parse(s, formatter);\n+            }catch (DateTimeParseException e){}", "originalCommit": "6846f61ffa66d421a48b261a4eca5feb30044667", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "642300f3b9f1c1dfa184b3bbbff8303f05edc2d6", "url": "https://github.com/CMSgov/dpc-app/commit/642300f3b9f1c1dfa184b3bbbff8303f05edc2d6", "message": "Merge branch 'master' into sg/DPC-573-accept-body-in-token-creation-request", "committedDate": "2020-09-16T23:17:35Z", "type": "commit"}, {"oid": "529adde963b45972d5af345c110dd9adffdde580", "url": "https://github.com/CMSgov/dpc-app/commit/529adde963b45972d5af345c110dd9adffdde580", "message": "+Added validation to token request body. +Added tests for nohtml validation. -Applied KISS principle due to hiberante and mapping issues", "committedDate": "2020-09-17T04:32:06Z", "type": "commit"}, {"oid": "39a2131eeecfeac9832f6e2fa12b845032859a01", "url": "https://github.com/CMSgov/dpc-app/commit/39a2131eeecfeac9832f6e2fa12b845032859a01", "message": "Merge branch 'sg/DPC-573-accept-body-in-token-creation-request' of https://github.com/CMSgov/dpc-app into sg/DPC-573-accept-body-in-token-creation-request", "committedDate": "2020-09-17T04:33:07Z", "type": "commit"}, {"oid": "23c5dba42d0096bf483a1023d32063ccb059bdf6", "url": "https://github.com/CMSgov/dpc-app/commit/23c5dba42d0096bf483a1023d32063ccb059bdf6", "message": "+Formating, +Renamed variables", "committedDate": "2020-09-17T04:42:49Z", "type": "commit"}, {"oid": "b549cf370349f8fe923d5989119f0fc7b6af0886", "url": "https://github.com/CMSgov/dpc-app/commit/b549cf370349f8fe923d5989119f0fc7b6af0886", "message": "Fixed javadoc missing param issue", "committedDate": "2020-09-17T04:52:59Z", "type": "commit"}, {"oid": "917df5c20b1fb5373d41aecd24cd0d4d3be5f4a3", "url": "https://github.com/CMSgov/dpc-app/commit/917df5c20b1fb5373d41aecd24cd0d4d3be5f4a3", "message": "added unit test for deserializer", "committedDate": "2020-09-17T05:49:19Z", "type": "commit"}, {"oid": "ba2f3a20023b471c70fbd04877ccffce193dcf41", "url": "https://github.com/CMSgov/dpc-app/commit/ba2f3a20023b471c70fbd04877ccffce193dcf41", "message": "Merge branch 'master' into sg/DPC-573-accept-body-in-token-creation-request", "committedDate": "2020-09-17T15:24:07Z", "type": "commit"}, {"oid": "038b39dfe4e7c0a655ae980486ea00bc56e166d8", "url": "https://github.com/CMSgov/dpc-app/commit/038b39dfe4e7c0a655ae980486ea00bc56e166d8", "message": "Merge branch 'master' into sg/DPC-573-accept-body-in-token-creation-request", "committedDate": "2020-09-17T16:12:19Z", "type": "commit"}]}