{"pr_number": 760, "pr_title": "Web app logging: JSON and log level", "pr_createdAt": "2020-04-20T19:19:36Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/760", "timeline": [{"oid": "4de2b17dffbae0dcde87d7a08ffe7acf944416f9", "url": "https://github.com/CMSgov/dpc-app/commit/4de2b17dffbae0dcde87d7a08ffe7acf944416f9", "message": "Change log level to info", "committedDate": "2020-04-20T18:48:48Z", "type": "commit"}, {"oid": "d94a72569d0255f03f5768046472ee2f325cec2e", "url": "https://github.com/CMSgov/dpc-app/commit/d94a72569d0255f03f5768046472ee2f325cec2e", "message": "JSON logging in production", "committedDate": "2020-04-21T02:14:28Z", "type": "commit"}, {"oid": "91ef6eac938d5392bfd4ffbfe40cd47248c3c512", "url": "https://github.com/CMSgov/dpc-app/commit/91ef6eac938d5392bfd4ffbfe40cd47248c3c512", "message": "Dynamically escalating log levels", "committedDate": "2020-04-21T02:42:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTgzMjYxMg==", "url": "https://github.com/CMSgov/dpc-app/pull/760#discussion_r411832612", "bodyText": "Indent when as deep as case.", "author": "codeclimate", "createdAt": "2020-04-21T03:00:16Z", "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -21,8 +21,21 @@ def configure_permitted_parameters\n       )\n     end\n   end\n-\n+  \n   def model_error_string(resource)\n     resource.errors.full_messages.join(', ')\n   end\n+\n+  # For increased logging on errors\n+  def append_info_to_payload(payload)\n+    super\n+    payload[:level] = case\n+    when payload[:status] == 200", "originalCommit": "91ef6eac938d5392bfd4ffbfe40cd47248c3c512", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTgzMjYxNg==", "url": "https://github.com/CMSgov/dpc-app/pull/760#discussion_r411832616", "bodyText": "Indent when as deep as case.", "author": "codeclimate", "createdAt": "2020-04-21T03:00:16Z", "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -21,8 +21,21 @@ def configure_permitted_parameters\n       )\n     end\n   end\n-\n+  \n   def model_error_string(resource)\n     resource.errors.full_messages.join(', ')\n   end\n+\n+  # For increased logging on errors\n+  def append_info_to_payload(payload)\n+    super\n+    payload[:level] = case\n+    when payload[:status] == 200\n+      \"INFO\"\n+    when payload[:status] == 302", "originalCommit": "91ef6eac938d5392bfd4ffbfe40cd47248c3c512", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTgzMjYyMA==", "url": "https://github.com/CMSgov/dpc-app/pull/760#discussion_r411832620", "bodyText": "end at 39, 4 is not aligned with case at 32, 22.", "author": "codeclimate", "createdAt": "2020-04-21T03:00:16Z", "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -21,8 +21,21 @@ def configure_permitted_parameters\n       )\n     end\n   end\n-\n+  \n   def model_error_string(resource)\n     resource.errors.full_messages.join(', ')\n   end\n+\n+  # For increased logging on errors\n+  def append_info_to_payload(payload)\n+    super\n+    payload[:level] = case\n+    when payload[:status] == 200\n+      \"INFO\"\n+    when payload[:status] == 302\n+      \"WARN\"\n+    else\n+      \"ERROR\"\n+    end", "originalCommit": "91ef6eac938d5392bfd4ffbfe40cd47248c3c512", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTgzMjYyMQ==", "url": "https://github.com/CMSgov/dpc-app/pull/760#discussion_r411832621", "bodyText": "Trailing whitespace detected.", "author": "codeclimate", "createdAt": "2020-04-21T03:00:16Z", "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -21,8 +21,21 @@ def configure_permitted_parameters\n       )\n     end\n   end\n-\n+  ", "originalCommit": "91ef6eac938d5392bfd4ffbfe40cd47248c3c512", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTgzMjYyMw==", "url": "https://github.com/CMSgov/dpc-app/pull/760#discussion_r411832623", "bodyText": "Do not use empty case condition, instead use an if expression.", "author": "codeclimate", "createdAt": "2020-04-21T03:00:16Z", "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -21,8 +21,21 @@ def configure_permitted_parameters\n       )\n     end\n   end\n-\n+  \n   def model_error_string(resource)\n     resource.errors.full_messages.join(', ')\n   end\n+\n+  # For increased logging on errors\n+  def append_info_to_payload(payload)\n+    super\n+    payload[:level] = case", "originalCommit": "91ef6eac938d5392bfd4ffbfe40cd47248c3c512", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "765c9977d3b8d332260cad812e65984b472483c9", "url": "https://github.com/CMSgov/dpc-app/commit/765c9977d3b8d332260cad812e65984b472483c9", "message": "Resolve intermittent NR config error", "committedDate": "2020-04-21T04:16:39Z", "type": "commit"}, {"oid": "cd1beab6c5836199a801028121e2f5a627c7d83d", "url": "https://github.com/CMSgov/dpc-app/commit/cd1beab6c5836199a801028121e2f5a627c7d83d", "message": "Lograge initializer correction", "committedDate": "2020-04-21T04:17:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTg2MTg0MQ==", "url": "https://github.com/CMSgov/dpc-app/pull/760#discussion_r411861841", "bodyText": "Prefer single-quoted strings when you don't need string interpolation or special symbols.", "author": "codeclimate", "createdAt": "2020-04-21T04:35:11Z", "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -21,8 +21,21 @@ def configure_permitted_parameters\n       )\n     end\n   end\n-\n+  \n   def model_error_string(resource)\n     resource.errors.full_messages.join(', ')\n   end\n+\n+  # For increased logging on errors\n+  def append_info_to_payload(payload)\n+    super\n+    payload[:level] = case\n+    when payload[:status] == 200\n+      \"INFO\"", "originalCommit": "cd1beab6c5836199a801028121e2f5a627c7d83d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTg2MTg0Mw==", "url": "https://github.com/CMSgov/dpc-app/pull/760#discussion_r411861843", "bodyText": "Prefer single-quoted strings when you don't need string interpolation or special symbols.", "author": "codeclimate", "createdAt": "2020-04-21T04:35:11Z", "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -21,8 +21,21 @@ def configure_permitted_parameters\n       )\n     end\n   end\n-\n+  \n   def model_error_string(resource)\n     resource.errors.full_messages.join(', ')\n   end\n+\n+  # For increased logging on errors\n+  def append_info_to_payload(payload)\n+    super\n+    payload[:level] = case\n+    when payload[:status] == 200\n+      \"INFO\"\n+    when payload[:status] == 302\n+      \"WARN\"", "originalCommit": "cd1beab6c5836199a801028121e2f5a627c7d83d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTg2MTg0NQ==", "url": "https://github.com/CMSgov/dpc-app/pull/760#discussion_r411861845", "bodyText": "Prefer single-quoted strings when you don't need string interpolation or special symbols.", "author": "codeclimate", "createdAt": "2020-04-21T04:35:11Z", "path": "dpc-web/app/controllers/application_controller.rb", "diffHunk": "@@ -21,8 +21,21 @@ def configure_permitted_parameters\n       )\n     end\n   end\n-\n+  \n   def model_error_string(resource)\n     resource.errors.full_messages.join(', ')\n   end\n+\n+  # For increased logging on errors\n+  def append_info_to_payload(payload)\n+    super\n+    payload[:level] = case\n+    when payload[:status] == 200\n+      \"INFO\"\n+    when payload[:status] == 302\n+      \"WARN\"\n+    else\n+      \"ERROR\"", "originalCommit": "cd1beab6c5836199a801028121e2f5a627c7d83d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ffde2f470b2f2f2e81d4a3d13983d65ce30876ea", "url": "https://github.com/CMSgov/dpc-app/commit/ffde2f470b2f2f2e81d4a3d13983d65ce30876ea", "message": "Code climate suggestions", "committedDate": "2020-04-21T05:14:15Z", "type": "commit"}, {"oid": "4d806efabb1a300be5d331f0aab77180e1caccfb", "url": "https://github.com/CMSgov/dpc-app/commit/4d806efabb1a300be5d331f0aab77180e1caccfb", "message": "Merge branch 'master' into dhg/web-log", "committedDate": "2020-04-21T05:15:43Z", "type": "commit"}, {"oid": "697ae12bd7cfd5438b5ac81e7bfe1f03bb6cf206", "url": "https://github.com/CMSgov/dpc-app/commit/697ae12bd7cfd5438b5ac81e7bfe1f03bb6cf206", "message": "Merge branch 'master' into dhg/web-log", "committedDate": "2020-04-21T13:31:29Z", "type": "commit"}]}