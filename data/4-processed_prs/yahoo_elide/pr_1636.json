{"pr_number": 1636, "pr_title": "Entity Models support in MetaDataStore", "pr_createdAt": "2020-11-04T19:32:45Z", "pr_url": "https://github.com/yahoo/elide/pull/1636", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzU4NjA0NA==", "url": "https://github.com/yahoo/elide/pull/1636#discussion_r517586044", "bodyText": "I think this file is no longer used, so can be deleted.", "author": "rishi-aga", "createdAt": "2020-11-04T19:38:32Z", "path": "elide-datastore/elide-datastore-aggregation/src/test/resources/create_tables.sql", "diffHunk": "@@ -27,6 +27,12 @@ CREATE TABLE IF NOT EXISTS players\n       name VARCHAR(255)\n     ) AS SELECT * FROM CSVREAD('classpath:player.csv');\n \n+CREATE TABLE IF NOT EXISTS playerRanking", "originalCommit": "d0816e7dafa0ecee046b81e78aae1f2249eb5894", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzYxMTY5MQ==", "url": "https://github.com/yahoo/elide/pull/1636#discussion_r517611691", "bodyText": "Class scanning is really time consuming.  We don't want to scan 100% of the classes three times to do this.  In the past, this has caused build times to go through the roof.  We should make maybe a new method in ClassScanner that looks for the classes we need in one pass.", "author": "aklish", "createdAt": "2020-11-04T20:27:25Z", "path": "elide-datastore/elide-datastore-aggregation/src/main/java/com/yahoo/elide/datastores/aggregation/metadata/MetaDataStore.java", "diffHunk": "@@ -80,12 +84,29 @@ public HashMapDataStore apply(String key) {\n     private Map<String, HashMapDataStore> hashMapDataStores = new HashMap<>();\n \n     public MetaDataStore() {\n-        this(ClassScanner.getAnnotatedClasses(METADATA_STORE_ANNOTATIONS));\n+        this(getAllAnnotatedClasses());\n+    }\n+\n+    /**\n+     * get all MetaDataStore supported annotated classes.\n+     * @return Set of Class with specific annotations.\n+     */\n+    private static Set<Class<?>> getAllAnnotatedClasses() {\n+        Set<Class<?>> metadataStoreResult = ClassScanner.getAnnotatedClasses(METADATA_STORE_ANNOTATIONS);\n+\n+        Set<Class<?>> entityResult = ClassScanner.getAnnotatedClasses(METADATA_STORE_ENTITY_ANNOTATION);", "originalCommit": "d0816e7dafa0ecee046b81e78aae1f2249eb5894", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d6c02e3e4f8c1da209cdcbd3b2b7f3d787347897", "url": "https://github.com/yahoo/elide/commit/d6c02e3e4f8c1da209cdcbd3b2b7f3d787347897", "message": "Review Comments for avoiding multiple scans", "committedDate": "2020-11-04T21:29:04Z", "type": "forcePushed"}, {"oid": "11edd80001b57ca74912e42250dec9abb3e0384f", "url": "https://github.com/yahoo/elide/commit/11edd80001b57ca74912e42250dec9abb3e0384f", "message": "Review Comments for avoiding multiple scans", "committedDate": "2020-11-04T21:32:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY3NzE3Nw==", "url": "https://github.com/yahoo/elide/pull/1636#discussion_r517677177", "bodyText": "nice", "author": "aklish", "createdAt": "2020-11-04T22:49:13Z", "path": "elide-core/src/main/java/com/yahoo/elide/utils/ClassScanner.java", "diffHunk": "@@ -83,4 +96,12 @@\n                     .collect(Collectors.toSet());\n         }\n     }\n+\n+    /**\n+     * Function which will be invoked for deciding to include the class in final results.\n+     */\n+    @FunctionalInterface", "originalCommit": "11edd80001b57ca74912e42250dec9abb3e0384f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "92fdf792125d25ebdc189ee6fa6d1df05f3bdb74", "url": "https://github.com/yahoo/elide/commit/92fdf792125d25ebdc189ee6fa6d1df05f3bdb74", "message": "Entity Models support in MetaDataStore", "committedDate": "2020-11-05T21:31:14Z", "type": "commit"}, {"oid": "6517318aac0cc155ceeff07894f6317a1813bb86", "url": "https://github.com/yahoo/elide/commit/6517318aac0cc155ceeff07894f6317a1813bb86", "message": "Review Comments for avoiding multiple scans", "committedDate": "2020-11-05T21:31:14Z", "type": "commit"}, {"oid": "6517318aac0cc155ceeff07894f6317a1813bb86", "url": "https://github.com/yahoo/elide/commit/6517318aac0cc155ceeff07894f6317a1813bb86", "message": "Review Comments for avoiding multiple scans", "committedDate": "2020-11-05T21:31:14Z", "type": "forcePushed"}]}