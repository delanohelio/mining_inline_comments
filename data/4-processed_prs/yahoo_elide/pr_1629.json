{"pr_number": 1629, "pr_title": "Provide Default time grain SQL expression", "pr_createdAt": "2020-11-02T21:54:12Z", "pr_url": "https://github.com/yahoo/elide/pull/1629", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI5MzQzOA==", "url": "https://github.com/yahoo/elide/pull/1629#discussion_r516293438", "bodyText": "What happens if we remove the grain definition here?  I would expect the developer to not put it here empty like this.", "author": "aklish", "createdAt": "2020-11-02T22:28:41Z", "path": "elide-datastore/elide-datastore-aggregation/src/test/resources/configs/models/tables/SalesView.hjson", "diffHunk": "@@ -165,6 +163,16 @@\n             sql: PARSEDATETIME(FORMATDATETIME({{}}, 'yyyy'), 'yyyy')\n           }\n         }\n+        {\n+          name: deliveryDefault\n+          type: TIME\n+          // Logical Column Reference in same table, which references another Logical Column in referred table, which references another Logical column in referred table, which references another Logical column in referred table, which references Physical column in referred table\n+          definition: '{{delivery.time}}'\n+          readAccess: Principal is guest user\n+          grain:", "originalCommit": "6af1729206ce05eb414fb8a2d1536cda50654038", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkwNTQ0NQ==", "url": "https://github.com/yahoo/elide/pull/1629#discussion_r516905445", "bodyText": "Let's remove the grain here.", "author": "aklish", "createdAt": "2020-11-03T19:28:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI5MzQzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI5NDE0Mg==", "url": "https://github.com/yahoo/elide/pull/1629#discussion_r516294142", "bodyText": "SQL can be provided even if type is not.", "author": "aklish", "createdAt": "2020-11-02T22:30:14Z", "path": "elide-model-config/src/main/resources/templates/table.hbs", "diffHunk": "@@ -74,7 +74,7 @@ public class <%#capitalizeFirstLetter name%><%/capitalizeFirstLetter%> <%#if ext\n <%/if%>\n <%#ifTypeMatches type \"TIME\"%>\n <%#with grain%>\n-    @Temporal(grain = @TimeGrainDefinition(grain = TimeGrain.<%type%>, expression = \"<%sql%>\"), timeZone = \"UTC\")\n+    @Temporal(grain = @TimeGrainDefinition(<%#if type%>grain = TimeGrain.<%type%><%/if%><%#if type%><%#if sql%>, <%/if%><%/if%><%#if sql%>expression = \"<%sql%>\"<%/if%>), timeZone = \"UTC\")", "originalCommit": "6af1729206ce05eb414fb8a2d1536cda50654038", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM1NjAwMw==", "url": "https://github.com/yahoo/elide/pull/1629#discussion_r516356003", "bodyText": "Can we can move this <%#if sql%>, <%/if%> within <%#if type%>grain = TimeGrain.<%type%><%/if%>?", "author": "moizarafat", "createdAt": "2020-11-03T00:20:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI5NDE0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI5NDYwNw==", "url": "https://github.com/yahoo/elide/pull/1629#discussion_r516294607", "bodyText": "Do we need to create such a complex model to test this?  THere is a lot of things unrelated to the test in this model.", "author": "aklish", "createdAt": "2020-11-02T22:31:20Z", "path": "elide-model-config/src/test/java/com/yahoo/elide/contrib/dynamicconfighelpers/parser/handlebars/HandlebarsHydratorTest.java", "diffHunk": "@@ -275,6 +275,183 @@\n             + \"\\n\"\n             + \"}\\n\";\n \n+    private static final String VALID_TABLE_GRAIN_JAVA_NAME = \"PlayerStatsGrain\";\n+    private static final String VALID_TABLE_GRAIN_CLASS = \"/*\\n\"", "originalCommit": "6af1729206ce05eb414fb8a2d1536cda50654038", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6d14c5e6bd961d48bbb9b111cf148e227bcf86f6", "url": "https://github.com/yahoo/elide/commit/6d14c5e6bd961d48bbb9b111cf148e227bcf86f6", "message": "changes to default sql and grain", "committedDate": "2020-11-05T21:59:49Z", "type": "commit"}, {"oid": "c22a218e576cc0f92dc56fd1f0181f4f5fb0e886", "url": "https://github.com/yahoo/elide/commit/c22a218e576cc0f92dc56fd1f0181f4f5fb0e886", "message": "review fixes", "committedDate": "2020-11-05T21:59:50Z", "type": "commit"}, {"oid": "aa6ffa0fa13bcecdbd9764adf589e6bb7e7e9a09", "url": "https://github.com/yahoo/elide/commit/aa6ffa0fa13bcecdbd9764adf589e6bb7e7e9a09", "message": "fix jetty dependency vulnerability", "committedDate": "2020-11-05T21:59:50Z", "type": "commit"}, {"oid": "43ea5ec3fa8c49d8e811f38b97842ca91ff6d165", "url": "https://github.com/yahoo/elide/commit/43ea5ec3fa8c49d8e811f38b97842ca91ff6d165", "message": "upgrade spring version instead of removing starter dependencies", "committedDate": "2020-11-05T21:59:50Z", "type": "commit"}, {"oid": "aa97e9f82e3bc882ffe7c976c4e0c40dd21e7904", "url": "https://github.com/yahoo/elide/commit/aa97e9f82e3bc882ffe7c976c4e0c40dd21e7904", "message": "remove incorrect example grain", "committedDate": "2020-11-05T21:59:51Z", "type": "commit"}, {"oid": "aa97e9f82e3bc882ffe7c976c4e0c40dd21e7904", "url": "https://github.com/yahoo/elide/commit/aa97e9f82e3bc882ffe7c976c4e0c40dd21e7904", "message": "remove incorrect example grain", "committedDate": "2020-11-05T21:59:51Z", "type": "forcePushed"}]}