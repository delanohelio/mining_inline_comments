{"pr_number": 6764, "pr_title": "[shelly]Enhancements and bug fixes", "pr_createdAt": "2020-01-05T03:47:46Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/6764", "timeline": [{"oid": "2dc615158829426aa79440aa7443cdc54d332633", "url": "https://github.com/openhab/openhab-addons/commit/2dc615158829426aa79440aa7443cdc54d332633", "message": "This is derived from PR #6592 - to get a clean status I open ths new\nPR\n\nSigned-off-by: markus7017 <markus7017@gmail.com>", "committedDate": "2020-01-05T03:10:12Z", "type": "commit"}, {"oid": "4b2eb431baee9fa1ee22ad1ac04fc777b8ef83d8", "url": "https://github.com/openhab/openhab-addons/commit/4b2eb431baee9fa1ee22ad1ac04fc777b8ef83d8", "message": "Adapted to 2.5.1-SNAPSHOT\n\nSigned-off-by: markus7017 <markus7017@gmail.com>", "committedDate": "2020-01-05T04:18:10Z", "type": "commit"}, {"oid": "5f35a909d05d75716c7bc0dfb2eb3b15173f4ec4", "url": "https://github.com/openhab/openhab-addons/commit/5f35a909d05d75716c7bc0dfb2eb3b15173f4ec4", "message": "Remove brightsnessAutoOn from non-light things; PREPARING 2.5.1 final\n\nSigned-off-by: markus7017 <markus7017@gmail.com>", "committedDate": "2020-01-05T23:03:54Z", "type": "commit"}, {"oid": "8a59b40c1e4a82eecbb9348ab5e917ac67e66af5", "url": "https://github.com/openhab/openhab-addons/commit/8a59b40c1e4a82eecbb9348ab5e917ac67e66af5", "message": "doc/* removed\n\nSigned-off-by: markus7017 <markus7017@gmail.com>", "committedDate": "2020-01-07T12:39:52Z", "type": "commit"}, {"oid": "6a0e327767f8abdc1f902dbfc6666a0d754410d8", "url": "https://github.com/openhab/openhab-addons/commit/6a0e327767f8abdc1f902dbfc6666a0d754410d8", "message": "Merge branch '2.5.x' of https://github.com/openhab/openhab-addons.git into 2.5.x", "committedDate": "2020-01-07T13:34:27Z", "type": "commit"}, {"oid": "e7fd54e0ac4fd03ddbba43e9479d77b95833497a", "url": "https://github.com/openhab/openhab-addons/commit/e7fd54e0ac4fd03ddbba43e9479d77b95833497a", "message": "FTR #6879: Temp sensors for Shelly 1/1PM added\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-01-24T19:45:17Z", "type": "commit"}, {"oid": "aa7837f9acdbe57eed3ba0fbec7447f3751de2f5", "url": "https://github.com/openhab/openhab-addons/commit/aa7837f9acdbe57eed3ba0fbec7447f3751de2f5", "message": "Merge branch '2.5.x' of https://github.com/openhab/openhab-addons into 2.5.x", "committedDate": "2020-01-24T19:49:08Z", "type": "commit"}, {"oid": "ac313446ba35c44e2f137029350aede2122e8d8a", "url": "https://github.com/openhab/openhab-addons/commit/ac313446ba35c44e2f137029350aede2122e8d8a", "message": "fixed\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-01-24T20:11:01Z", "type": "commit"}, {"oid": "c264a364f7a279e098dbc80c9342af786ad52dbb", "url": "https://github.com/openhab/openhab-addons/commit/c264a364f7a279e098dbc80c9342af786ad52dbb", "message": "adapted to 2.5.2\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-01-24T20:14:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDMzOA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r370954338", "bodyText": "Why did you remove this line?", "author": "kaikreuzer", "createdAt": "2020-01-25T20:32:25Z", "path": "bundles/org.openhab.binding.shelly/src/main/java/org/openhab/binding/shelly/internal/handler/ShellyBaseHandler.java", "diffHunk": "@@ -116,7 +118,6 @@ public ShellyBaseHandler(Thing thing, ShellyBindingConfiguration bindingConfig,\n      */\n     @Override\n     public void initialize() {\n-        updateStatus(ThingStatus.UNKNOWN);", "originalCommit": "c264a364f7a279e098dbc80c9342af786ad52dbb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyNTU5MA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371025590", "bodyText": "I keep the status INITIALIZING until the device is fully initialized. For non-battery devices this will be done with the next status update, for battery-powered devices this could take longer until the device wakes up. UNKOWN sounds like an error, even I now that the device is not yet initialized", "author": "markus7017", "createdAt": "2020-01-26T20:01:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDMzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM2MjIyMA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371362220", "bodyText": "I am pretty sure that we discussed this before (when adding that line), but I can certainly again point you to the developer docs: https://github.com/openhab/openhab-core/blob/master/tools/archetype/binding/src/main/resources/archetype-resources/src/main/java/internal/__bindingIdCamelCase__Handler.java#L69-L79", "author": "kaikreuzer", "createdAt": "2020-01-27T16:58:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDMzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA5MTgxMw==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r372091813", "bodyText": "ok, will be changed", "author": "markus7017", "createdAt": "2020-01-28T22:21:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDMzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE5NTAzMA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373195030", "bodyText": "I don't see any change?", "author": "kaikreuzer", "createdAt": "2020-01-30T21:10:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDMzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4MDI4MA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373880280", "bodyText": "done", "author": "markus7017", "createdAt": "2020-02-02T22:22:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDMzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDQxNg==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r370954416", "bodyText": "Why did you remove the message from the Thing status? The Thing status is the correct place for it.", "author": "kaikreuzer", "createdAt": "2020-01-25T20:34:02Z", "path": "bundles/org.openhab.binding.shelly/src/main/java/org/openhab/binding/shelly/internal/handler/ShellyBaseHandler.java", "diffHunk": "@@ -228,13 +235,14 @@ private void initializeThing() throws IOException {\n         profile = tmpPrf; // all initialization done, so keep the profile\n \n         // Validate device mode\n-        String thingType = getThing().getThingTypeUID().getId();\n         String reqMode = thingType.contains(\"-\") ? StringUtils.substringAfter(thingType, \"-\") : \"\";\n         if (!reqMode.isEmpty() && !tmpPrf.mode.equals(reqMode)) {\n+            logger.info(", "originalCommit": "c264a364f7a279e098dbc80c9342af786ad52dbb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAzMTU0MQ==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371031541", "bodyText": "My understanding is that\nupdateStatus(ThingStatus.OFFLINE, ThingStatusDetail.CONFIGURATION_ERROR,\n\"@text/offline.conf-error-wrong-mode\")\npulls up the language resource \"offline.conf-error-wrong-mode\" to get this messages from shelly_de.properties/shelly.properties. Isn't it this the case?\nSo a info message goes to the log and the thing status gets updated with the genral message - or is there a way to pass parameters to the messages retrived from the properties file?", "author": "markus7017", "createdAt": "2020-01-26T21:42:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDQxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM2NDQ2MQ==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371364461", "bodyText": "is there a way to pass parameters to the messages retrived from the properties file?\n\nThere is, see https://www.openhab.org/docs/developer/utils/i18n.html#i18n-text-provider-api.", "author": "kaikreuzer", "createdAt": "2020-01-27T17:02:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDQxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk1NDY3Mw==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373954673", "bodyText": "ok, I figured out the i18nProvider stuff, but how to format the message in the properties file to inject parameters?", "author": "markus7017", "createdAt": "2020-02-03T07:36:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDQxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg1OTAzNg==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r374859036", "bodyText": "@kaikreuzer could you point me to the solution?", "author": "markus7017", "createdAt": "2020-02-04T18:54:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDQxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDUzNA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r370954534", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t<unitLabel>sec</unitLabel>\n          \n          \n            \n            \t\t\t<unitLabel>s</unitLabel>", "author": "kaikreuzer", "createdAt": "2020-01-25T20:37:01Z", "path": "bundles/org.openhab.binding.shelly/src/main/resources/ESH-INF/config/config.xml", "diffHunk": "@@ -39,8 +45,71 @@\n \t\t\t<label>Enable Push Events (short/long)</label>\n \t\t\t<description>True if the binding should register to get the Short/Long Push Events.</description>\n \t\t\t<advanced>true</advanced>\n+\t\t\t<default>false</default>\n+\t\t</parameter>\n+\t\t<parameter name=\"eventsCoIoT\" type=\"boolean\" required=\"false\">\n+\t\t\t<label>Enable CoIoT Events</label>\n+\t\t\t<description>If enabled the Coap protocol will be used to receive status updates.</description>\n+\t\t\t<advanced>true</advanced>\n+\t\t\t<default>false</default>\n+\t\t</parameter>\n+\t\t<parameter name=\"updateInterval\" type=\"integer\" required=\"true\">\n+\t\t\t<label>Update Interval</label>\n+\t\t\t<description>Interval in seconds to query an update from the device.</description>\n+\t\t\t<default>60</default>\n+\t\t\t<unitLabel>sec</unitLabel>", "originalCommit": "c264a364f7a279e098dbc80c9342af786ad52dbb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA5MTQ0OA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r372091448", "bodyText": "changed", "author": "markus7017", "createdAt": "2020-01-28T22:20:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDUzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDU0Nw==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r370954547", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t<description>If enabled the Coap protocol will be used to receive status updates.</description>\n          \n          \n            \n            \t\t\t<description>If enabled, the CoAP protocol is used to receive status updates.</description>", "author": "kaikreuzer", "createdAt": "2020-01-25T20:37:25Z", "path": "bundles/org.openhab.binding.shelly/src/main/resources/ESH-INF/config/config.xml", "diffHunk": "@@ -39,8 +45,71 @@\n \t\t\t<label>Enable Push Events (short/long)</label>\n \t\t\t<description>True if the binding should register to get the Short/Long Push Events.</description>\n \t\t\t<advanced>true</advanced>\n+\t\t\t<default>false</default>\n+\t\t</parameter>\n+\t\t<parameter name=\"eventsCoIoT\" type=\"boolean\" required=\"false\">\n+\t\t\t<label>Enable CoIoT Events</label>\n+\t\t\t<description>If enabled the Coap protocol will be used to receive status updates.</description>", "originalCommit": "c264a364f7a279e098dbc80c9342af786ad52dbb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA5MTUwOA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r372091508", "bodyText": "changed", "author": "markus7017", "createdAt": "2020-01-28T22:20:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDU0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE5NjU4Mg==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373196582", "bodyText": "did you maybe miss to push your changes?", "author": "kaikreuzer", "createdAt": "2020-01-30T21:13:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDU0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY2OA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r370954668", "bodyText": "This feature does imho not make much sense in a binding - it is not at all specific here.\nIf a user wishes such an alarm, wouldn't it be hundred times better to have the alarm cover ALL devices that report their signal strength and not just the Shelly ones? This hence belongs into a rule and not in a binding.", "author": "kaikreuzer", "createdAt": "2020-01-25T20:40:20Z", "path": "bundles/org.openhab.binding.shelly/src/main/resources/ESH-INF/config/config.xml", "diffHunk": "@@ -23,6 +23,12 @@\n \t\t\t<description>IP-Address of the Shelly device.</description>\n \t\t\t<context>network-address</context>\n \t\t</parameter>\n+\t\t<parameter name=\"weakSignal\" type=\"integer\" required=\"false\">\n+\t\t\t<label>Weak Signal Threshold</label>\n+\t\t\t<description>An alarm is triggered if a device reports WiFi signal strength below this threshold. Default: -80 dBm</description>", "originalCommit": "c264a364f7a279e098dbc80c9342af786ad52dbb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyNTgwNg==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371025806", "bodyText": "ok, but then it should be a OH core feature. The binding can't monitor the wifi signal for other devices. Same argument: Wha does each user has to add a rule for each device (or one serving it all). Would be a cool feature for OH3 to extend the channel type with a health monitoring.", "author": "markus7017", "createdAt": "2020-01-26T20:04:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM2NjM4Nw==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371366387", "bodyText": "Yes, the signal strength has been defined as a system channel to allow such feature for the core. The new UI should definitely show the signal strength for things and we could also add further functionality for that.", "author": "kaikreuzer", "createdAt": "2020-01-27T17:06:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA5MTM0MA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r372091340", "bodyText": "ok, what do you think of\n\nkeep the feature in 2.5\nremove it for 3.0 and integrate such monitoring in core", "author": "markus7017", "createdAt": "2020-01-28T22:20:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzE5NjQ1Ng==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373196456", "bodyText": "Please no. Stuff that is there usually stays around far too long. And if it is even something that is a workaround for a missing feature, it will be copied by others and it'll be all over the place.", "author": "kaikreuzer", "createdAt": "2020-01-30T21:13:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NjA1Nw==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373866057", "bodyText": "This is still here...", "author": "kaikreuzer", "createdAt": "2020-02-02T18:39:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4MDc1OA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373880758", "bodyText": "removed even I don't agree", "author": "markus7017", "createdAt": "2020-02-02T22:28:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY4Ng==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r370954686", "bodyText": "see above", "author": "kaikreuzer", "createdAt": "2020-01-25T20:40:44Z", "path": "bundles/org.openhab.binding.shelly/src/main/resources/ESH-INF/config/config.xml", "diffHunk": "@@ -39,8 +45,71 @@\n \t\t\t<label>Enable Push Events (short/long)</label>\n \t\t\t<description>True if the binding should register to get the Short/Long Push Events.</description>\n \t\t\t<advanced>true</advanced>\n+\t\t\t<default>false</default>\n+\t\t</parameter>\n+\t\t<parameter name=\"eventsCoIoT\" type=\"boolean\" required=\"false\">\n+\t\t\t<label>Enable CoIoT Events</label>\n+\t\t\t<description>If enabled the Coap protocol will be used to receive status updates.</description>\n+\t\t\t<advanced>true</advanced>\n+\t\t\t<default>false</default>\n+\t\t</parameter>\n+\t\t<parameter name=\"updateInterval\" type=\"integer\" required=\"true\">\n+\t\t\t<label>Update Interval</label>\n+\t\t\t<description>Interval in seconds to query an update from the device.</description>\n+\t\t\t<default>60</default>\n+\t\t\t<unitLabel>sec</unitLabel>\n+\t\t\t<advanced>true</advanced>\n+\t\t</parameter>\n+\t</config-description>\n+\n+\t<config-description uri=\"thing-type:shelly:light\">\n+\t\t<parameter-group name=\"advancedOptions\">\n+\t\t\t<label>Advanced Options</label>\n+\t\t</parameter-group>\n+\n+\t\t<parameter name=\"userId\" type=\"text\" required=\"false\">\n+\t\t\t<label>User</label>\n+\t\t\t<description>User ID for HTTP API access.</description>\n+\t\t</parameter>\n+\t\t<parameter name=\"password\" type=\"text\" required=\"false\">\n+\t\t\t<label>Password</label>\n+\t\t\t<description>Password for HTTP API access.</description>\n+\t\t\t<context>password</context>\n+\t\t</parameter>\n+\t\t<parameter name=\"deviceIp\" type=\"text\" required=\"true\">\n+\t\t\t<label>Device IP Address</label>\n+\t\t\t<description>IP-Address of the Shelly device.</description>\n+\t\t\t<context>network-address</context>\n+\t\t</parameter>\n+\t\t<parameter name=\"weakSignal\" type=\"integer\" required=\"false\">", "originalCommit": "c264a364f7a279e098dbc80c9342af786ad52dbb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyNTgxMw==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371025813", "bodyText": "same :-)", "author": "markus7017", "createdAt": "2020-01-26T20:04:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NjA3OQ==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373866079", "bodyText": "Also still here...", "author": "kaikreuzer", "createdAt": "2020-02-02T18:40:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4MDc2Mg==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373880762", "bodyText": "dto", "author": "markus7017", "createdAt": "2020-02-02T22:28:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDY4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDc1MA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r370954750", "bodyText": "see above", "author": "kaikreuzer", "createdAt": "2020-01-25T20:41:43Z", "path": "bundles/org.openhab.binding.shelly/src/main/resources/ESH-INF/config/config.xml", "diffHunk": "@@ -89,11 +158,19 @@\n \t\t\t<advanced>true</advanced>\n \t\t\t<default>true</default>\n \t\t</parameter>\n+\t\t<parameter name=\"weakSignal\" type=\"integer\" required=\"false\">", "originalCommit": "c264a364f7a279e098dbc80c9342af786ad52dbb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyNTgzMg==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371025832", "bodyText": "dto", "author": "markus7017", "createdAt": "2020-01-26T20:05:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDc1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NjExNA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373866114", "bodyText": "dito", "author": "kaikreuzer", "createdAt": "2020-02-02T18:40:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDc1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4MDc2OA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373880768", "bodyText": "dito", "author": "markus7017", "createdAt": "2020-02-02T22:28:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDc1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDg2MA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r370954860", "bodyText": "No, please don't add such debugging channels to the Things, this really feels not right.\nDoing debug level logging should normally be enough. If you really want it somewhere else, maybe it would be ok to add it as Thing properties.", "author": "kaikreuzer", "createdAt": "2020-01-25T20:44:10Z", "path": "bundles/org.openhab.binding.shelly/src/main/resources/ESH-INF/thing/channels.xml", "diffHunk": "@@ -365,4 +353,20 @@\n \t\t\t</options>\n \t\t</event>\n \t</channel-type>\n+\n+\t<channel-type id=\"timeoutErrors\" advanced=\"true\">", "originalCommit": "c264a364f7a279e098dbc80c9342af786ad52dbb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyNTk3MA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r371025970", "bodyText": "ok, was designed as a temp at the beginning, but provided some good feedback\nnevertheless I'll move it to thing properties as stats values. I'm currently working with the community and the Shelly guys on REST timeouts. Various users are reporting issues whereas others (like me) see timeouts very rarely. Once the problem is fixed (maybe a firmware issue) I Could remove those counters anyways.", "author": "markus7017", "createdAt": "2020-01-26T20:07:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDg2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA5MjAxMg==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r372092012", "bodyText": "moved to thing properties", "author": "markus7017", "createdAt": "2020-01-28T22:22:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDg2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NjE3MQ==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373866171", "bodyText": "still here - more commits missing?", "author": "kaikreuzer", "createdAt": "2020-02-02T18:41:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDg2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk0MDE1NA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373940154", "bodyText": "left over, removed", "author": "markus7017", "createdAt": "2020-02-03T06:37:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk1NDg2MA=="}], "type": "inlineReview"}, {"oid": "605b05e68114f3b336417018ffd6dc862dd0a7d1", "url": "https://github.com/openhab/openhab-addons/commit/605b05e68114f3b336417018ffd6dc862dd0a7d1", "message": "Change requests from PR review; #6949 Fix for color updates via Coap;\nFix for #6950 Updating input states via Coap - both fixes need to be\nverified.\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-02-01T13:54:33Z", "type": "commit"}, {"oid": "9b0f00ba7c7c099146f391c4b968ef97f09b4939", "url": "https://github.com/openhab/openhab-addons/commit/9b0f00ba7c7c099146f391c4b968ef97f09b4939", "message": "property updated fixed\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-02-01T20:17:54Z", "type": "commit"}, {"oid": "574ff0b41bac69f4e12502c2339b0a011cdf1dfc", "url": "https://github.com/openhab/openhab-addons/commit/574ff0b41bac69f4e12502c2339b0a011cdf1dfc", "message": "some more debugging on HttpUtil exception, ext. temp sensor channels\nmarked as advanced; Typos in properties corrected\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-02-02T13:34:12Z", "type": "commit"}, {"oid": "70244750413be221c75fe9a1a8c5b6628ad222b0", "url": "https://github.com/openhab/openhab-addons/commit/70244750413be221c75fe9a1a8c5b6628ad222b0", "message": "Set initial status to UNKNOWN rather than keeping INITIALIZING\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-02-02T14:35:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NTk2Mw==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373865963", "bodyText": "Why do you have to suppress unused? Can't you simply remove unused variables?\nAlso, please try to avoid null suppressions and rather refactor the code to be fully null-safe.\nOk, if you address this in a future PR, no blocker wrt merging now.", "author": "kaikreuzer", "createdAt": "2020-02-02T18:38:11Z", "path": "bundles/org.openhab.binding.shelly/src/main/java/org/openhab/binding/shelly/internal/handler/ShellyBaseHandler.java", "diffHunk": "@@ -631,6 +683,39 @@ public boolean requestUpdates(int requestCount, boolean refreshSettings) {\n         return false;\n     }\n \n+    /**\n+     * Map input states to channels\n+     *\n+     * @param groupName Channel Group (relay / relay1...)\n+     *\n+     * @param status Shelly device status\n+     * @return true: one or more inputs were updated\n+     */\n+    @SuppressWarnings({ \"null\", \"unused\" })", "originalCommit": "70244750413be221c75fe9a1a8c5b6628ad222b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg4MDkyNA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373880924", "bodyText": "because Eclipse sometimes just report BS", "author": "markus7017", "createdAt": "2020-02-02T22:31:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NTk2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzk0NjI0MA==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r373946240", "bodyText": "example: For this statement Eclipse reports a redundant null check\nStrong thingName = properties.get(PROPERTY_SERVICE_NAME) != null ? properties.get(PROPERTY_SERVICE_NAME).toLowerCase() : thingType;\nhow to resolved those warnings?", "author": "markus7017", "createdAt": "2020-02-03T07:03:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NTk2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDYzMjc3Ng==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r374632776", "bodyText": "Which is correct, because theoretically another thread could meanwhile remove the property before you call the get.\nThis should solve those issues:\nString thingName = properties.get(PROPERTY_SERVICE_NAME);\nthingName = thingName!=null ? thingName.toLowerCase() : thingType;", "author": "kaikreuzer", "createdAt": "2020-02-04T12:08:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NTk2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg1Nzg1OQ==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r374857859", "bodyText": "nope, now it's \"thingName!=null\"", "author": "markus7017", "createdAt": "2020-02-04T18:52:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NTk2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTA5NjcwMw==", "url": "https://github.com/openhab/openhab-addons/pull/6764#discussion_r375096703", "bodyText": "Then probably this way:\nString serviceName = properties.get(PROPERTY_SERVICE_NAME);\nString thingName = serviceName!=null ? serviceName.toLowerCase() : thingType;\n\nThat's anyhow cleaner than my previous suggestion.", "author": "kaikreuzer", "createdAt": "2020-02-05T07:35:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NTk2Mw=="}], "type": "inlineReview"}, {"oid": "d3d13e8fb55436645f24433bd688f7c25f4642d7", "url": "https://github.com/openhab/openhab-addons/commit/d3d13e8fb55436645f24433bd688f7c25f4642d7", "message": "alarm type WAEK_SIGNAL removed as requested by review\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-02-02T22:28:25Z", "type": "commit"}, {"oid": "6318ee10b25b7517bc40ba09bf86d6dc6b8a9657", "url": "https://github.com/openhab/openhab-addons/commit/6318ee10b25b7517bc40ba09bf86d6dc6b8a9657", "message": "cleanup of removed channels\n\nSigned-off-by: Markus Michels <markus7017@gmail.com>", "committedDate": "2020-02-02T22:30:30Z", "type": "commit"}]}