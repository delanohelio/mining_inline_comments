{"pr_number": 6846, "pr_title": "[onewiregpio] Added precision parameter to OneWireGpio Binding", "pr_createdAt": "2020-01-16T16:00:06Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/6846", "timeline": [{"oid": "798efdfe35394295a956d4d7e2effae061acdd0f", "url": "https://github.com/openhab/openhab-addons/commit/798efdfe35394295a956d4d7e2effae061acdd0f", "message": "Added precision parameter to OneWire Binding\n\n* Added precision parameter which allows to lower precision of value\nread from the file system\n* Implemented configuration class for easier read of configuration\nthrough the reflection method in the framework\n* Moved the read of configuration parameters to initialize method\nleaving the checkConfiguration method to do only validation\n* Updated the README\n\nSigned-off-by: Konstantin Polihronov <polychronov@gmail.com>", "committedDate": "2020-01-16T15:49:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNTI5MA==", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367825290", "bodyText": "Please add the bounds also here", "author": "martinvw", "createdAt": "2020-01-17T08:51:36Z", "path": "bundles/org.openhab.binding.onewiregpio/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -22,6 +22,13 @@\n \t\t\t\t<default>600</default>\n \t\t\t</parameter>\n \n+\t\t\t<parameter name=\"precision\" type=\"integer\">", "originalCommit": "798efdfe35394295a956d4d7e2effae061acdd0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgzNTM2NA==", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367835364", "bodyText": "If I add bounds here, do I have to validate that the number is in these bounds in the code?", "author": "theater", "createdAt": "2020-01-17T09:17:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNTI5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg4ODI4OQ==", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367888289", "bodyText": "I think it makes sense to keep the bounds there, I'm in doubt whether it was used only for the UI or also enforced for textual configuration.", "author": "martinvw", "createdAt": "2020-01-17T11:19:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNTI5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkxNDY4Mw==", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367914683", "bodyText": "Hm... I just looked into the xsd and I'm not quite sure how to do that. Is it through options and writing down the possible values as string with limitToOptions=true afterwards or there is easier way to say it's integer with bounds 0-3?", "author": "theater", "createdAt": "2020-01-17T12:35:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNTI5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQzNzYwNw==", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r368437607", "bodyText": "Sorry I was a little bit sick the last few days so I failed to answer :-)\n\n  \n    \n      openhab-addons/bundles/org.openhab.binding.sensebox/src/main/resources/ESH-INF/config/config-description.xml\n    \n    \n         Line 15\n      in\n      88c4890\n    \n    \n    \n    \n\n        \n          \n           <parameter name=\"refreshInterval\" type=\"integer\" min=\"300\" max=\"86400\"> \n        \n    \n  \n\n\nJust provide min and max", "author": "martinvw", "createdAt": "2020-01-20T09:16:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNTI5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNTM2MQ==", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367825361", "bodyText": "Please capitalize the P", "author": "martinvw", "createdAt": "2020-01-17T08:51:49Z", "path": "bundles/org.openhab.binding.onewiregpio/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -22,6 +22,13 @@\n \t\t\t\t<default>600</default>\n \t\t\t</parameter>\n \n+\t\t\t<parameter name=\"precision\" type=\"integer\">\n+\t\t\t\t<label>Sensor precision</label>", "originalCommit": "798efdfe35394295a956d4d7e2effae061acdd0f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzgyNjAzNA==", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r367826034", "bodyText": "Consider using the constant 3 as well here to keep the logging correct when the constant is changes in the future", "author": "martinvw", "createdAt": "2020-01-17T08:53:31Z", "path": "bundles/org.openhab.binding.onewiregpio/src/main/java/org/openhab/binding/onewiregpio/internal/handler/OneWireGPIOHandler.java", "diffHunk": "@@ -84,21 +93,25 @@ public void initialize() {\n      * When invalid parameter is found, default value is assigned.\n      */\n     private boolean checkConfiguration() {\n-        Configuration configuration = getConfig();\n-        gpioBusFile = (String) configuration.get(GPIO_BUS_FILE);\n         if (StringUtils.isEmpty(gpioBusFile)) {\n             logger.debug(\"GPIO_BUS_FILE not set. Please check configuration, and set proper path to w1_slave file.\");\n             updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.CONFIGURATION_ERROR,\n                     \"The path to the w1_slave sensor data file is missing.\");\n             return false;\n         }\n \n-        refreshTime = ((Number) configuration.get(REFRESH_TIME)).intValue();\n-        if (refreshTime.intValue() <= 0) {\n-            logger.warn(\"Refresh time [{}] is not valid. Falling back to default value: {}.\", refreshTime,\n+        if (refreshTime <= 0) {\n+            logger.debug(\"Refresh time [{}] is not valid. Falling back to default value: {}.\", refreshTime,\n                     DEFAULT_REFRESH_TIME);\n             refreshTime = DEFAULT_REFRESH_TIME;\n         }\n+\n+        if (precision < 0 || precision > MAX_PRECISION_VALUE) {\n+            logger.debug(\"Precision value {} is outside allowed values [0 - 3]. Falling back to default value: {}.\",", "originalCommit": "798efdfe35394295a956d4d7e2effae061acdd0f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8363ed0d472d53d8da1d7533a9f9ae35061b8cfa", "url": "https://github.com/openhab/openhab-addons/commit/8363ed0d472d53d8da1d7533a9f9ae35061b8cfa", "message": "Two out of three changes from Martin's review\n\n* Fixed capital letter in parameter label\n* Fixed logging by providing max value as parameter\n\nSigned-off-by: Konstantin Polihronov <polychronov@gmail.com>", "committedDate": "2020-01-17T14:39:19Z", "type": "commit"}, {"oid": "5b83bd62ccd6db0794076f4d79a6018be937b570", "url": "https://github.com/openhab/openhab-addons/commit/5b83bd62ccd6db0794076f4d79a6018be937b570", "message": "Added fixed values for precision\n\nSigned-off-by: Konstantin Polihronov <polychronov@gmail.com>", "committedDate": "2020-01-17T17:24:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQzNzc3Nw==", "url": "https://github.com/openhab/openhab-addons/pull/6846#discussion_r368437777", "bodyText": "Options are only meant for string parameters", "author": "martinvw", "createdAt": "2020-01-20T09:17:20Z", "path": "bundles/org.openhab.binding.onewiregpio/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -22,6 +22,20 @@\n \t\t\t\t<default>600</default>\n \t\t\t</parameter>\n \n+\t\t\t<parameter name=\"precision\" type=\"integer\">\n+\t\t\t\t<label>Sensor Precision</label>\n+\t\t\t\t<description>Sensor precision after floating point.</description>\n+\t\t\t\t<required>false</required>\n+\t\t\t\t<options>\n+\t\t\t\t\t<option value=\"0\">0</option>", "originalCommit": "5b83bd62ccd6db0794076f4d79a6018be937b570", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "26cc4169d91b059241393333ea31787509ee3165", "url": "https://github.com/openhab/openhab-addons/commit/26cc4169d91b059241393333ea31787509ee3165", "message": "Add min/max values to precision parameter, remove options\n\nSigned-off-by: Konstantin Polihronov <polychronov@gmail.com>", "committedDate": "2020-01-20T09:20:49Z", "type": "commit"}]}