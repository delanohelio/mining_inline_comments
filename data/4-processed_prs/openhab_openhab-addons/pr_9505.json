{"pr_number": 9505, "pr_title": "[tr064] add rule action for phonebook", "pr_createdAt": "2020-12-24T11:53:24Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/9505", "timeline": [{"oid": "e13a328e35c32617ddac01fa289de09cf45b60dd", "url": "https://github.com/openhab/openhab-addons/commit/e13a328e35c32617ddac01fa289de09cf45b60dd", "message": "add rule action for phonebook\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>", "committedDate": "2020-12-24T11:52:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAzMTI1MQ==", "url": "https://github.com/openhab/openhab-addons/pull/9505#discussion_r549031251", "bodyText": "I just tested those changes and based on the description here would have expected that something like\nval tr064Actions = getActions(\"tr064\",\"tr064:fritzbox:2a28aee1ee\")\nval result = tr064Actions.phonebookLookup(\"01234567\")\n\nwould actually work as the other parameters are described as optional.\nBut the above rule code results in an error like\nScript execution of rule with UID 'fritzbox' failed: An error occurred during the script execution: index=3, size=3 in fritzbox\n\nUsing val result = tr064Actions.phonebookLookup(\"01234567\", null, null) works fine. Maybe might be good to update the readme here, so it's clear the parameters can't be ommited, but need to be set to null instead - or update the code if the parameters should be ommitable.", "author": "sgiehl", "createdAt": "2020-12-26T21:03:07Z", "path": "bundles/org.openhab.binding.tr064/README.md", "diffHunk": "@@ -127,4 +127,22 @@ If only a specific phonebook from the device should be used, this can be specifi\n The default is to use all available phonebooks from the specified thing.\n In case the format of the number in the phonebook and the format of the number from the channel are different (e.g. regarding country prefixes), the `matchCount` parameter can be used.\n The configured `matchCount` is counted from the right end and denotes the number of matching characters needed to consider this number as matching.\n+A `matchCount` of `0` is considered as \"match everything\".\n \n+## Rule Action\n+\n+The phonebooks of a `fritzbox` thing can be used to lookup a number from rules via a thing action:\n+\n+`String name = phonebookLookup(String number, String phonebook, int matchCount)`\n+\n+`phonebook` and `matchCount` are optional parameters.", "originalCommit": "e13a328e35c32617ddac01fa289de09cf45b60dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAzNTA5MA==", "url": "https://github.com/openhab/openhab-addons/pull/9505#discussion_r549035090", "bodyText": "Probably adding those methods would be the better option. Will do that tomorrow. Is it working otherwise as expected?", "author": "J-N-K", "createdAt": "2020-12-26T21:52:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAzMTI1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAzNTg3Nw==", "url": "https://github.com/openhab/openhab-addons/pull/9505#discussion_r549035877", "bodyText": "Only did some simple lookups of incoming call numbers in the phonebook. That worked as expected. But didn't test (yet) if the phonebook and matchCount parameters are working correctly.", "author": "sgiehl", "createdAt": "2020-12-26T22:03:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAzMTI1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAzODgyNQ==", "url": "https://github.com/openhab/openhab-addons/pull/9505#discussion_r549038825", "bodyText": "Just tested looking up with specific phonebooks. Seems to work as expected. But might be useful to mention it's selected by the phonebooks name (and not its id)", "author": "sgiehl", "createdAt": "2020-12-26T22:41:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTAzMTI1MQ=="}], "type": "inlineReview"}, {"oid": "a042309609a02f566a2772d77e151118b11d0fe7", "url": "https://github.com/openhab/openhab-addons/commit/a042309609a02f566a2772d77e151118b11d0fe7", "message": "address review comments\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>", "committedDate": "2020-12-27T09:12:24Z", "type": "commit"}]}