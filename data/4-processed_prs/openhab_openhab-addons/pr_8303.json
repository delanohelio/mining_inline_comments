{"pr_number": 8303, "pr_title": "[gree] Add channel for temperature sensor", "pr_createdAt": "2020-08-16T16:14:51Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/8303", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzI3MTg3MA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473271870", "bodyText": "that's technical information not relevant for the user, but valuable for the code, please move there", "author": "markus7017", "createdAt": "2020-08-19T19:34:34Z", "path": "bundles/org.openhab.binding.gree/README.md", "diffHunk": "@@ -19,41 +19,48 @@ No binding configuration is required.\n \n ## Thing Configuration\n \n-| Channel Name     | Type       | Description                                                                                   |\n-|------------------|------------|-----------------------------------------------------------------------------------------------|\n-| ipAddress        | IP Address | IP address of the unit.                                                                       |\n-| broadcastAddress | IP Address | Broadcast address being used for discovery, usually derived from the IP interface address.    |\n-| refresh          | Integer    | Refresh interval in seconds for polling the device status.                                    |\n+| Channel Name             | Type       | Description                                                                                   |\n+|--------------------------|------------|-----------------------------------------------------------------------------------------------|\n+| ipAddress                | IP Address | IP address of the unit.                                                                       |\n+| broadcastAddress         | IP Address | Broadcast address being used for discovery, usually derived from the IP interface address.    |\n+| refresh                  | Integer    | Refresh interval in seconds for polling the device status.                                    |\n+| currentTemperatureOffset | Decimal    | The offset in Celsius for the current temperature value received from the device.             |\n \n The Air Conditioner's IP address is mandatory, all other parameters are optional. \n If the broadcast is not set (default) it will be derived from openHAB's network setting (PaperUI:Configuration:System:Network Settings). \n Only change this if you have a good reason to.\n \n+The currentTemperatureOffset defaults to -40 degrees Celsius. GREE airconditioners usually return a value from the temperature sensor\n+which is offset by +40 degrees Celsius. The temperature value shown on the device LCD display should match the value shown by this binding.\n+See [here](https://github.com/tomikaa87/gree-remote#getting-the-current-temperature-reading-from-the-internal-sensor) for more details.\n+This currentTemperatureOffset configureable in case you would want to offset this temperature for calibration of the temperature sensor.", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY4OTc3Mg==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474689772", "bodyText": "Moved to Javadoc comments. Half the information is now in GreeBindingConstants and the other half in GreeConfiguration.", "author": "taboneclayton", "createdAt": "2020-08-21T13:17:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzI3MTg3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjI2OQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473946269", "bodyText": "please make the -40.0 a constant (not hard coded)\npublic static int ...", "author": "markus7017", "createdAt": "2020-08-20T12:53:28Z", "path": "bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/GreeConfiguration.java", "diffHunk": "@@ -25,9 +26,10 @@\n     public String ipAddress = \"\";\n     public String broadcastAddress = \"\";\n     public int refresh = 60;\n+    public BigDecimal currentTemperatureOffset = new BigDecimal(-40.0);", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5MDEwNg==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474690106", "bodyText": "Moved to a BigDecimal constant in GreeBindingConstants.", "author": "taboneclayton", "createdAt": "2020-08-21T13:17:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjI2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjcxNA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473946714", "bodyText": "I'm fine to mark it explicit as TARGET_TEMP, makes sense", "author": "markus7017", "createdAt": "2020-08-20T12:54:16Z", "path": "bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/handler/GreeHandler.java", "diffHunk": "@@ -153,7 +153,7 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n                     case LIGHT_CHANNEL:\n                         device.setDeviceLight(socket, getOnOff(command));\n                         break;\n-                    case TEMP_CHANNEL:\n+                    case TARGET_TEMP_CHANNEL:", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY3MTcxNw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474671717", "bodyText": "All the other constants which refer to channel names have the _CHANNEL suffix. Would you like me to drop the suffix from this constant name by renaming TARGET_TEMP_CHANNEL to TARGET_TEMP? Just wanted to make sure I understood before renaming this constant.", "author": "taboneclayton", "createdAt": "2020-08-21T12:42:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjcxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTI1MDQxOQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r475250419", "bodyText": "TARGET_TEMP_CHANNEL", "author": "markus7017", "createdAt": "2020-08-23T18:30:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjcxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NzI5NA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473947294", "bodyText": "maybe name it GREE_PROP_CURRENT_TEMP_SENSOR - then it's clear", "author": "markus7017", "createdAt": "2020-08-20T12:55:09Z", "path": "bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/handler/GreeHandler.java", "diffHunk": "@@ -514,6 +517,13 @@ private void publishChannel(ChannelUID channelUID) {\n         return null;\n     }\n \n+    private @Nullable State updateCurrentTemp() throws GreeException {\n+        if (device.hasStatusValChanged(GREE_PROP_TEMP_SENSOR)) {", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5MDI5NA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474690294", "bodyText": "Renamed as suggested", "author": "taboneclayton", "createdAt": "2020-08-21T13:18:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NzI5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0OTg2Nw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473949867", "bodyText": "Make it a short label, the description is more detailed, e.g. Offset for Current Temperature", "author": "markus7017", "createdAt": "2020-08-20T12:59:25Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/i18n/gree.properties", "diffHunk": "@@ -13,7 +13,8 @@ thing-type.config.gree.airconditioner.broadcastAddress.label = Subnet Broadcast\n thing-type.config.gree.airconditioner.broadcastAddress.description = Broadcast IP address of the local subnet.\n thing-type.config.gree.airconditioner.refresh.label = Refresh Interval\n thing-type.config.gree.airconditioner.refresh.description = Interval to query an update from the device.\n-\n+thing-type.config.gree.airconditioner.currentTemperatureOffset.label = Offset for temperature sensor reading", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5MDQyNA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474690424", "bodyText": "Changed as suggested", "author": "taboneclayton", "createdAt": "2020-08-21T13:18:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0OTg2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MDI5Nw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473950297", "bodyText": "invalid char:  {}\ufffdfor", "author": "markus7017", "createdAt": "2020-08-20T13:00:07Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/i18n/gree.properties", "diffHunk": "@@ -82,8 +85,8 @@ channel-type.gree.health.description = Set on/off the Air Conditioner's Health f\n message.thinginit.failed = Unable to connect to air conditioner\n message.thinginit.invconf = Invalid configuration data\n message.thinginit.exception = Thing initialization failed: {0}\n-message.command.invarg = Invalid command value {}\ufffdfor channel {}\n-message.command.exception = Unable to execute command {0}\ufffdfor channel {1}\n+message.command.invarg = Invalid command value {}\ufffdfor channel {}", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTI1MDQ5OQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r475250499", "bodyText": "should be fixed by restoring file encoding, correct?", "author": "markus7017", "createdAt": "2020-08-23T18:30:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MDI5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MDU1NQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473950555", "bodyText": "what happened with the encoding?", "author": "markus7017", "createdAt": "2020-08-20T13:00:32Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/i18n/gree_DE.properties", "diffHunk": "@@ -9,20 +9,21 @@ thing-type.gree.airconditioner.description = Eine GREE Klimaanlage mit WiFi Modu\n \n # thing type config description\n thing-type.config.gree.airconditioner.ipAddress.label = IP Adresse\n-thing-type.config.gree.airconditioner.ipAddress.description = IP Adresse des GREE-Ger\ufffdtes.\n+thing-type.config.gree.airconditioner.ipAddress.description = IP Adresse des GREE-Ger\ufffdtes.", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTI1MDUwNg==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r475250506", "bodyText": "should be fixed by restoring file encoding, correct?", "author": "markus7017", "createdAt": "2020-08-23T18:30:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MDU1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MTExMw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473951113", "bodyText": "this should be limited to steps of 0.5", "author": "markus7017", "createdAt": "2020-08-20T13:01:26Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -34,6 +35,11 @@\n \t\t\t\t<unitLabel>seconds</unitLabel>\n \t\t\t\t<advanced>true</advanced>\n \t\t\t</parameter>\n+\t\t\t<parameter name=\"currentTemperatureOffset\" type=\"decimal\" required=\"true\" unit=\"C\">", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5MDY4Mw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474690683", "bodyText": "Done", "author": "taboneclayton", "createdAt": "2020-08-21T13:19:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MTExMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MTgyOA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473951828", "bodyText": "The binding is not limited to Air Conditioner, this is a thing type\nwhere is the label required?", "author": "markus7017", "createdAt": "2020-08-20T13:02:38Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/i18n/gree.properties", "diffHunk": "@@ -1,5 +1,6 @@\n # GREE Binding\n binding.gree.name = GREE Binding\n+binding.gree.label = GREE Air Conditioner", "originalCommit": "84b8f9fcc5cb90253bf5b64875e5a69f8e210a13", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5Mjg1OQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474692859", "bodyText": "Not sure if it's used or not. This was set in gree_DE.properties but not in gree.properties. Since I synched these two il8n files I added it in gree.properties. Should I remove it from both files?", "author": "taboneclayton", "createdAt": "2020-08-21T13:22:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MTgyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MjMzNQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473952335", "bodyText": "where is the mode.* gone?", "author": "markus7017", "createdAt": "2020-08-20T13:03:28Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/i18n/gree.properties", "diffHunk": "@@ -48,9 +49,11 @@ channel-type.gree.windspeed.state.option.2 = Medium Low\n channel-type.gree.windspeed.state.option.3 = Medium\n channel-type.gree.windspeed.state.option.4 = Medium High\n channel-type.gree.windspeed.state.option.5 = High\n-channel-type.gree.mode.label = Unit Mode\n-channel-type.gree.mode.description = Operating mode of the Air Conditioner: Auto: 0, Cool: 1, Dry: 2, Fan: 3, Heat: 4\n-channel-type.gree.mode.state.option.auto = Auto\n+channel-type.gree.quiet.label = Quiet Mode", "originalCommit": "84b8f9fcc5cb90253bf5b64875e5a69f8e210a13", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5ODIwMw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474698203", "bodyText": "These three were also duplicated in lines 21-23. It looks like the ones deleted here were the old descriptions with numeric modes instead of auto/cool/eco/fan/dry/turbo or on/off. These descriptions were also missing the new on/off and turbo modes.", "author": "taboneclayton", "createdAt": "2020-08-21T13:30:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MjMzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1Mjg3Nw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473952877", "bodyText": "revert this change! It's a \"Klimaanlage\" (one specific thing type, maybe there will be others in the future)", "author": "markus7017", "createdAt": "2020-08-20T13:04:20Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/i18n/gree_DE.properties", "diffHunk": "@@ -4,90 +4,89 @@ binding.gree.label = GREE Air Conditioner\n binding.gree.description = Dieses Binding integriert Klimaanlagen der Marke GREE\n \n # thing types\n-thing-type.gree.airconditioner.label = GREE Klimaanlage\n+thing-type.gree.airconditioner.label = GREE ", "originalCommit": "84b8f9fcc5cb90253bf5b64875e5a69f8e210a13", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIxMDE1OQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r475210159", "bodyText": "Reverted as suggested", "author": "taboneclayton", "createdAt": "2020-08-23T11:52:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1Mjg3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473953734", "bodyText": "This file should have been resetted to the old one (with correct encoding) and then changes applied again. Now all the Umlaut characters show up as changes :-(", "author": "markus7017", "createdAt": "2020-08-20T13:05:45Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/i18n/gree_DE.properties", "diffHunk": "@@ -4,90 +4,89 @@ binding.gree.label = GREE Air Conditioner\n binding.gree.description = Dieses Binding integriert Klimaanlagen der Marke GREE\n \n # thing types\n-thing-type.gree.airconditioner.label = GREE Klimaanlage\n+thing-type.gree.airconditioner.label = GREE \n thing-type.gree.airconditioner.description = Eine GREE Klimaanlage mit WiFi Modul\n \n # thing type config description\n thing-type.config.gree.airconditioner.ipAddress.label = IP Adresse\n-thing-type.config.gree.airconditioner.ipAddress.description = IP Adresse des GREE-Ger\ufffdtes.\n+thing-type.config.gree.airconditioner.ipAddress.description = IP Adresse des GREE-Ger\u00e4tes.", "originalCommit": "84b8f9fcc5cb90253bf5b64875e5a69f8e210a13", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1NTU4MA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473955580", "bodyText": "@tobiasbayer I'm done with the review, please apply the requested changes and make sure that the encoding of the property files are UTF-8", "author": "markus7017", "createdAt": "2020-08-20T13:08:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA1NjQwNQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474056405", "bodyText": "The properties files should be encoded ISO-8859 as per definition of java properties files and not UTF-8.", "author": "Hilbrand", "createdAt": "2020-08-20T15:07:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDA2OTY0MQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474069641", "bodyText": "It's my fault, that the file is encoded in UTF-8. I wasn't aware that the spec states ISO-8859. Only from JDK 9 on it's UTF-8.", "author": "fwolter", "createdAt": "2020-08-20T15:27:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDcwMDM0Mg==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474700342", "bodyText": "I could not see the commits related to the file encoding changes. Unless I failed to rebase properly from upstream. Would you like me to apply the conversion to ISO-8859?", "author": "taboneclayton", "createdAt": "2020-08-21T13:33:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDcwMjY5Nw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474702697", "bodyText": "Also, in the parent pom, the project.build.sourceEncodingis currently set to UTF-8. Any idea if this would affect the encoding of any resources during packaging? Or that's just for source files?", "author": "taboneclayton", "createdAt": "2020-08-21T13:37:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDcwMjk3NQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474702975", "bodyText": "yes please convert to ISO-8859", "author": "Hilbrand", "createdAt": "2020-08-21T13:38:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIxMDIyMQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r475210221", "bodyText": "Changed the file encoding for both languages to ISO 8859-1 as per Oracle documentation.", "author": "taboneclayton", "createdAt": "2020-08-23T11:53:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTI1MDY5Ng==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r475250696", "bodyText": "should be fixed by restoring file encoding, correct?", "author": "markus7017", "createdAt": "2020-08-23T18:32:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1MzczNA=="}], "type": "inlineReview"}, {"oid": "30bd20546fd04b90b91f8cca02992aec6d956f55", "url": "https://github.com/openhab/openhab-addons/commit/30bd20546fd04b90b91f8cca02992aec6d956f55", "message": "Reverted value for thing-type.gree.airconditioner.label\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-08-23T21:09:03Z", "type": "forcePushed"}, {"oid": "d880546257c3ea52ffc74559caf6ff024f195b70", "url": "https://github.com/openhab/openhab-addons/commit/d880546257c3ea52ffc74559caf6ff024f195b70", "message": "Reverted value for thing-type.gree.airconditioner.label\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-08-29T13:28:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r479666315", "bodyText": "I don't think it's intuitive if configuring an offset of 0, would result in an offset of +40\u00b0C. Can you subtract the internal offset in the code, so an offset of 0 is really 0?", "author": "fwolter", "createdAt": "2020-08-29T16:32:31Z", "path": "bundles/org.openhab.binding.gree/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -34,6 +35,11 @@\n \t\t\t\t<unitLabel>seconds</unitLabel>\n \t\t\t\t<advanced>true</advanced>\n \t\t\t</parameter>\n+\t\t\t<parameter name=\"currentTemperatureOffset\" type=\"decimal\" step=\"0.5\" required=\"true\" unit=\"C\">\n+\t\t\t\t<default>-40</default>\n+\t\t\t\t<unitLabel>Degrees Celsius</unitLabel>\n+\t\t\t\t<advanced>true</advanced>\n+\t\t\t</parameter>", "originalCommit": "d880546257c3ea52ffc74559caf6ff024f195b70", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY3MDM5MA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r479670390", "bodyText": "I think the idea here is that the device returns the data with a 40 degree offset. But that value 40 is not guaranteed. So therefor this parameter is there correct that. If it would always be 40 this offset would not be needed or maybe could be a boolean. To switch between 40 and 0 in case there is no offset. So it very much depends if the 40 is fixed or not.", "author": "Hilbrand", "createdAt": "2020-08-29T17:16:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY4OTQ0MA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r479689440", "bodyText": "Yes this was the exact reasoning behind it. On the Gree devices which I have installed at home, the offset is that of +40\u00b0C. So the offset required for calibration for this particular device is actually -40 and not 0.\nJudging from online research this seems to be the case with the majority of devices but I cannot vouch for that since new models might behave differently.\nThe idea for this configuration parameter was that other devices might come with an offset which is different from +40\u00b0C. So the idea was that the binding would offset exactly by the amount which is specified in this parameter and not make any assumptions other than setting the default at -40 which seems to be the most common at the time.\nIf for some other Gree device, the offset is +30\u00b0C, the required value here would be -30 and not +10.", "author": "taboneclayton", "createdAt": "2020-08-29T20:56:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTgwMTE5MQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r479801191", "bodyText": "@markus7017 you as the codeowner, WDYT? Are you aware of any device type that has a different offset than -40\u00b0C?", "author": "fwolter", "createdAt": "2020-08-30T18:29:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxMzI4OA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r483713288", "bodyText": "Hmm, as you said it seems that all devices have an offset of 40\u00b0C. Having this offset configurable would allow the user to do adjustment when the temp is really 1\u00b0C off etc., which is a useful feature.\nWe have no proof that there are other offsets than 40\u00b0. Therefore I would make this assumption and do the math in the binding. In case a device has something != 40, this is adjustable as a work around. We could then decide how to model this (e.g,. by a different thing type), but so far I don't see this scenario.", "author": "markus7017", "createdAt": "2020-09-04T16:00:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgwNjMxNg==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r483806316", "bodyText": "Maybe just remove this parameter and hardcode the offset for now. It's always possible to add it later, but once added it's less convenient to change it if another design would have been beter.", "author": "Hilbrand", "createdAt": "2020-09-04T19:20:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkyMzM4MQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r483923381", "bodyText": "I favor\n\nkeeping the parameter, but as normalized offset\nhard code the -40 as constant in the code\n\nSo 0 means 0 for the user, but -40 for the binding, 1=-39, -2=-42 etc.\n@taboneclayton it might me that 0.5 steps are supported", "author": "markus7017", "createdAt": "2020-09-05T07:39:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTIyNzU1Ng==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r485227556", "bodyText": "@taboneclayton From my point of view this is the only open issue. Could you change it that way?", "author": "markus7017", "createdAt": "2020-09-08T22:22:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYwNzMzNw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r486607337", "bodyText": "Updated as suggested. I think this should address all requests for changes. However there is a merge conflict in thing-types.xml due to the introduction of spotless. Don't want to merge from upstream to avoid problems. Should I rebase to resolve the conflict?", "author": "taboneclayton", "createdAt": "2020-09-10T20:15:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYxMjYyMA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r486612620", "bodyText": "Yes do rebase and git push --force-with-lease back to GitHub.\nAlso do run mvn spotless:apply on your binding to make sure your changes also comply with the style, otherwise it might break the build of your binding.", "author": "Hilbrand", "createdAt": "2020-09-10T20:25:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjYzNzg4MA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r486637880", "bodyText": "Done", "author": "taboneclayton", "createdAt": "2020-09-10T21:15:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY2NjMxNQ=="}], "type": "inlineReview"}, {"oid": "4be725800635e1c2ef0c08d0db406b94cc6dcce6", "url": "https://github.com/openhab/openhab-addons/commit/4be725800635e1c2ef0c08d0db406b94cc6dcce6", "message": "Hiding the -40 implementation detail from the user. This offset is now an internal constant within the plugin and the external config parameter defaults to 0 degrees celsius. The sensor reading is then being added to the internal offset and the config parameter offset to come up with the final value.\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T20:05:29Z", "type": "forcePushed"}, {"oid": "93fb64deca5eebd5f08bb1734be2a7318ebd99dd", "url": "https://github.com/openhab/openhab-addons/commit/93fb64deca5eebd5f08bb1734be2a7318ebd99dd", "message": "Added channel for reading temperature for the temperature sensor which is available on GREE AC devices. New channel name is  currentTemperature. To avoid confusion between target and current temperature, the old channel has been renamed from temperature to targetTemperature.\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:06:59Z", "type": "commit"}, {"oid": "e928f0b5ea639efbdb4332020b8a75522eafbfc7", "url": "https://github.com/openhab/openhab-addons/commit/e928f0b5ea639efbdb4332020b8a75522eafbfc7", "message": "Fixed character encoding, removed duplicated il8n strings and re-ordered to match placement of strings between DE and EN.\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:07:23Z", "type": "commit"}, {"oid": "df43258729574079dd4f71e2cba8a5f1fc99b01c", "url": "https://github.com/openhab/openhab-addons/commit/df43258729574079dd4f71e2cba8a5f1fc99b01c", "message": "Reverted channel name from \"targetTemperature\" to \"temperature\"\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:23Z", "type": "commit"}, {"oid": "fe32ab8a76b6bfc59d3d8ce5eda619487459073f", "url": "https://github.com/openhab/openhab-addons/commit/fe32ab8a76b6bfc59d3d8ce5eda619487459073f", "message": "Reacting to PR comments:\n- Moved developer-related information from README to code.\n- Moved hardcoded default value for current temperature offset to a constant value\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:28Z", "type": "commit"}, {"oid": "3d4752249712c057df136de8d59c1d9116e43a2b", "url": "https://github.com/openhab/openhab-addons/commit/3d4752249712c057df136de8d59c1d9116e43a2b", "message": "Reacting to PR comments:\n- Renaming GREE_PROP_TEMP_SENSOR to GREE_PROP_CURRENT_TEMP_SENSOR\n- Simplified description for currentTemperatureOffset label\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:28Z", "type": "commit"}, {"oid": "47cc8d8d530da6705e1bea0b7709740b8bf8c02a", "url": "https://github.com/openhab/openhab-addons/commit/47cc8d8d530da6705e1bea0b7709740b8bf8c02a", "message": "Pushing an additional minor changes which were not staged by mistake\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:28Z", "type": "commit"}, {"oid": "f15e30e2d9694f7d316f9acae7b82484796c0c60", "url": "https://github.com/openhab/openhab-addons/commit/f15e30e2d9694f7d316f9acae7b82484796c0c60", "message": "Added a step value of 0.5 for the currentTemperatureOffset config parameter\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "ed501c68324069cf1c78f968e4ad09e537fb9fef", "url": "https://github.com/openhab/openhab-addons/commit/ed501c68324069cf1c78f968e4ad09e537fb9fef", "message": "Reverted files to the original version from upstream\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "6050bc8e02398ef213c26598c2bc2947d69e3baf", "url": "https://github.com/openhab/openhab-addons/commit/6050bc8e02398ef213c26598c2bc2947d69e3baf", "message": "Switched incoding to ISO 8859-1\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "d3d3d5672976fb848542f680ca337485cf632e08", "url": "https://github.com/openhab/openhab-addons/commit/d3d3d5672976fb848542f680ca337485cf632e08", "message": "Reverted value for thing-type.gree.airconditioner.label\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "6d367d737ddb4e604568f923f15217c33f2509d3", "url": "https://github.com/openhab/openhab-addons/commit/6d367d737ddb4e604568f923f15217c33f2509d3", "message": "Hiding the -40 implementation detail from the user. This offset is now an internal constant within the plugin and the external config parameter defaults to 0 degrees celsius. The sensor reading is then being added to the internal offset and the config parameter offset to come up with the final value.\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "b817f4c6a8e6bb558b79275f6353eb23d19088c0", "url": "https://github.com/openhab/openhab-addons/commit/b817f4c6a8e6bb558b79275f6353eb23d19088c0", "message": "Updated Javadoc for the internal binding constant INTERNAL_TEMP_SENSOR_OFFSET\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "c009648a073dd1602ca36c59ba75a5e624480612", "url": "https://github.com/openhab/openhab-addons/commit/c009648a073dd1602ca36c59ba75a5e624480612", "message": "Applied spotless formatting", "committedDate": "2020-09-10T21:13:36Z", "type": "forcePushed"}, {"oid": "50bf3e4dd7e1e180ef02af25af2301bc5cbbe41d", "url": "https://github.com/openhab/openhab-addons/commit/50bf3e4dd7e1e180ef02af25af2301bc5cbbe41d", "message": "Applied spotless formatting\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:16:53Z", "type": "commit"}, {"oid": "50bf3e4dd7e1e180ef02af25af2301bc5cbbe41d", "url": "https://github.com/openhab/openhab-addons/commit/50bf3e4dd7e1e180ef02af25af2301bc5cbbe41d", "message": "Applied spotless formatting\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:16:53Z", "type": "forcePushed"}]}