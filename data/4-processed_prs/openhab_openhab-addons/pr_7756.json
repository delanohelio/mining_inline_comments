{"pr_number": 7756, "pr_title": "[weatherunderground] Log URL with masked API key", "pr_createdAt": "2020-05-23T18:29:08Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/7756", "timeline": [{"oid": "c9448fec0331892b277fddfd604bbe3d6e569b66", "url": "https://github.com/openhab/openhab-addons/commit/c9448fec0331892b277fddfd604bbe3d6e569b66", "message": "[weatherunderground] Log URL with masked API key\n\nRelative to #3990\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>", "committedDate": "2020-05-23T18:26:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3MjgwMQ==", "url": "https://github.com/openhab/openhab-addons/pull/7756#discussion_r429572801", "bodyText": "We are currently in the process of removing use of apache commons.lang from addons, so please implement trimToEmpty by hand here.", "author": "cpmeister", "createdAt": "2020-05-23T19:40:54Z", "path": "bundles/org.openhab.binding.weatherunderground/src/main/java/org/openhab/binding/weatherunderground/internal/handler/WeatherUndergroundHandler.java", "diffHunk": "@@ -553,7 +551,9 @@ private boolean updateWeatherData(Set<String> features) {\n             }\n \n             urlStr = urlStr.replace(\"%QUERY%\", StringUtils.trimToEmpty(config.location));\n-            logger.debug(\"URL = {}\", urlStr);\n+            logger.debug(\"URL = {}\", urlStr.replace(\"%APIKEY%\", \"***\"));\n+\n+            urlStr = urlStr.replace(\"%APIKEY%\", StringUtils.trimToEmpty(bridgeHandler.getApikey()));", "originalCommit": "c9448fec0331892b277fddfd604bbe3d6e569b66", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3NDAwNg==", "url": "https://github.com/openhab/openhab-addons/pull/7756#discussion_r429574006", "bodyText": "I will do it in a separate PR please.\nAs you can see in my current PR, this line is not new but just moved.\nJust changing this line would have no sense as there are several similar lines to be changed.\nAnd I consider this PR as of a higher priority (security).", "author": "lolodomo", "createdAt": "2020-05-23T20:00:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3MjgwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3OTM3NA==", "url": "https://github.com/openhab/openhab-addons/pull/7756#discussion_r429579374", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        logger.debug(\"URL = {}\", urlStr.replace(\"%APIKEY%\", \"***\"));\n          \n          \n            \n                        if(logger.isDebugEnabled()){\n          \n          \n            \n                            logger.debug(\"URL = {}\", urlStr.replace(\"%APIKEY%\", \"***\"));\n          \n          \n            \n                        }", "author": "cpmeister", "createdAt": "2020-05-23T21:23:42Z", "path": "bundles/org.openhab.binding.weatherunderground/src/main/java/org/openhab/binding/weatherunderground/internal/handler/WeatherUndergroundHandler.java", "diffHunk": "@@ -553,7 +551,9 @@ private boolean updateWeatherData(Set<String> features) {\n             }\n \n             urlStr = urlStr.replace(\"%QUERY%\", StringUtils.trimToEmpty(config.location));\n-            logger.debug(\"URL = {}\", urlStr);\n+            logger.debug(\"URL = {}\", urlStr.replace(\"%APIKEY%\", \"***\"));", "originalCommit": "c9448fec0331892b277fddfd604bbe3d6e569b66", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU4MDY5MA==", "url": "https://github.com/openhab/openhab-addons/pull/7756#discussion_r429580690", "bodyText": "What's the interest to add this test?", "author": "lolodomo", "createdAt": "2020-05-23T21:46:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3OTM3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU4MjAwMg==", "url": "https://github.com/openhab/openhab-addons/pull/7756#discussion_r429582002", "bodyText": "Since users may not be interested in debug logging, and as such would be filtered out, you should try to minimize wasting computational resources on creating values to be logged.\nIn this case String.replace involves a search and replace, the result of which might not even be used. So in order to prevent unnecessary calls to this operation we just check if that logging level is even enabled in the first place.", "author": "cpmeister", "createdAt": "2020-05-23T22:09:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3OTM3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwNjMwNw==", "url": "https://github.com/openhab/openhab-addons/pull/7756#discussion_r429606307", "bodyText": "Ok, done.", "author": "lolodomo", "createdAt": "2020-05-24T07:02:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3OTM3NA=="}], "type": "inlineReview"}, {"oid": "2bb3390969893a3c4e4a7a852536bf99160d656e", "url": "https://github.com/openhab/openhab-addons/commit/2bb3390969893a3c4e4a7a852536bf99160d656e", "message": "Add isDebugEnabled\n\nSigned-off-by: Laurent Garnier <lg.hc@free.fr>", "committedDate": "2020-05-24T07:00:51Z", "type": "commit"}]}