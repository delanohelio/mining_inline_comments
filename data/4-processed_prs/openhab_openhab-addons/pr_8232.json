{"pr_number": 8232, "pr_title": "[opensprinkler] Add water level channel", "pr_createdAt": "2020-07-31T15:05:57Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/8232", "timeline": [{"oid": "adeab11bcf31139df2da5d4f27d4e1c50fcbc229", "url": "https://github.com/openhab/openhab-addons/commit/adeab11bcf31139df2da5d4f27d4e1c50fcbc229", "message": "Added channel for the water level\n\nSigned-off-by: Paul Frank <pail@gmx.net>", "committedDate": "2020-07-30T15:13:22Z", "type": "commit"}, {"oid": "4e934dd6c6cab6e40a6f3faf3d381794a4f6d88b", "url": "https://github.com/openhab/openhab-addons/commit/4e934dd6c6cab6e40a6f3faf3d381794a4f6d88b", "message": "Add documentation in README\n\nSigned-off-by: Paul Frank <pail@gmx.net>", "committedDate": "2020-07-31T14:57:54Z", "type": "commit"}, {"oid": "d6ad349a85aabf7609a3dcd12dfc3076c475116b", "url": "https://github.com/openhab/openhab-addons/commit/d6ad349a85aabf7609a3dcd12dfc3076c475116b", "message": "Undo changes in .clathpass\n\nSigned-off-by: Paul Frank <pail@gmx.net>", "committedDate": "2020-07-31T15:13:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc2NDEyOQ==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r470764129", "bodyText": "Can you mention that it is percent?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            | waterlevel      | Number                 | RO | This channel shows the current water level. The water level calculated    |\n          \n          \n            \n            | waterlevel      | Number:Dimensionless                 | RO | This channel shows the current water level. The water level calculated    |", "author": "fwolter", "createdAt": "2020-08-14T17:40:07Z", "path": "bundles/org.openhab.binding.opensprinkler/README.md", "diffHunk": "@@ -66,6 +66,8 @@ The following is supported by the `device` thing, but only when connected using\n | rainsensor      | Switch                 | RO | This channel indicates whether rain is detected by the device or not.     |\n | currentDraw     | Number:ElectricCurrent | RO | Shows the current draw of the device. If the device does not have sensors |\n |                 |                        |    | for this metric, the channel will not be available.                       |\n+| waterlevel      | Number                 | RO | This channel shows the current water level. The water level calculated    |", "originalCommit": "d6ad349a85aabf7609a3dcd12dfc3076c475116b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7c5c172a8a2318fa2481a03a0e3ff724d38d896b", "url": "https://github.com/openhab/openhab-addons/commit/7c5c172a8a2318fa2481a03a0e3ff724d38d896b", "message": "Update bundles/org.openhab.binding.opensprinkler/README.md\n\nCo-authored-by: Fabian Wolter <github@fabian-wolter.de>\nSigned-off-by: Paul Frank <pail@gmx.net>", "committedDate": "2020-08-16T18:03:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE2MDYyNg==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r471160626", "bodyText": "probably align with other cells :)", "author": "FlorianSW", "createdAt": "2020-08-16T21:25:37Z", "path": "bundles/org.openhab.binding.opensprinkler/README.md", "diffHunk": "@@ -66,6 +66,8 @@ The following is supported by the `device` thing, but only when connected using\n | rainsensor      | Switch                 | RO | This channel indicates whether rain is detected by the device or not.     |\n | currentDraw     | Number:ElectricCurrent | RO | Shows the current draw of the device. If the device does not have sensors |\n |                 |                        |    | for this metric, the channel will not be available.                       |\n+| waterlevel      | Number:Dimensionless                 | RO | This channel shows the current water level. The water level calculated    |", "originalCommit": "7c5c172a8a2318fa2481a03a0e3ff724d38d896b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI0MTI1Mg==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r471241252", "bodyText": "Fixed.", "author": "pail23", "createdAt": "2020-08-17T05:37:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE2MDYyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE2MDc5OQ==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r471160799", "bodyText": "awesome for refactoring this as well :)", "author": "FlorianSW", "createdAt": "2020-08-16T21:27:35Z", "path": "bundles/org.openhab.binding.opensprinkler/src/main/java/org/openhab/binding/opensprinkler/internal/api/OpenSprinklerHttpApiV100.java", "diffHunk": "@@ -208,17 +215,10 @@ public int getNumberOfStations() throws CommunicationApiException {\n \n     @Override\n     public int getFirmwareVersion() throws CommunicationApiException {\n-        String returnContent;\n-\n-        try {\n-            returnContent = http.sendHttpGet(getBaseUrl() + CMD_OPTIONS_INFO, null);\n-        } catch (Exception exp) {\n-            throw new CommunicationApiException(\n-                    \"There was a problem in the HTTP communication with the OpenSprinkler API: \" + exp.getMessage());\n-        }\n \n         try {\n-            this.firmwareVersion = Parse.jsonInt(returnContent, JSON_OPTION_FIRMWARE_VERSION);\n+            JoResponse info = getOptions();", "originalCommit": "7c5c172a8a2318fa2481a03a0e3ff724d38d896b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5d793f4d5d2238b63b32c6c63ef05da85e802d30", "url": "https://github.com/openhab/openhab-addons/commit/5d793f4d5d2238b63b32c6c63ef05da85e802d30", "message": "fixed aligment in the README\n\nSigned-off-by: Paul Frank <pail@gmx.net>", "committedDate": "2020-08-17T05:35:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEwNDI1NQ==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r474104255", "bodyText": "Can you mention, that this is percent?", "author": "fwolter", "createdAt": "2020-08-20T16:13:39Z", "path": "bundles/org.openhab.binding.opensprinkler/README.md", "diffHunk": "@@ -66,6 +66,8 @@ The following is supported by the `device` thing, but only when connected using\n | rainsensor      | Switch                 | RO | This channel indicates whether rain is detected by the device or not.     |\n | currentDraw     | Number:ElectricCurrent | RO | Shows the current draw of the device. If the device does not have sensors |\n |                 |                        |    | for this metric, the channel will not be available.                       |\n+| waterlevel      | Number:Dimensionless   | RO | This channel shows the current water level. The water level calculated    |\n+|                 |                        |    | based on the weather and influences the duration of the water programs.   |", "originalCommit": "5d793f4d5d2238b63b32c6c63ef05da85e802d30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIxMzYyMQ==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r474213621", "bodyText": "yes, done", "author": "pail23", "createdAt": "2020-08-20T19:17:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEwNDI1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEwNDk0MA==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r474104940", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t<description>The current water level</description>\n          \n          \n            \n            \t\t<description>The current water level in percent</description>", "author": "fwolter", "createdAt": "2020-08-20T16:14:49Z", "path": "bundles/org.openhab.binding.opensprinkler/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -85,6 +86,14 @@\n \t\t<state readOnly=\"true\"/>\n \t</channel-type>\n \n+\n+\t<channel-type id=\"waterlevel\">\n+\t\t<item-type>Number:Dimensionless</item-type>\n+\t\t<label>Water level</label>\n+\t\t<description>The current water level</description>", "originalCommit": "5d793f4d5d2238b63b32c6c63ef05da85e802d30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIxMzUwNg==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r474213506", "bodyText": "done", "author": "pail23", "createdAt": "2020-08-20T19:16:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEwNDk0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEwNTExMg==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r474105112", "bodyText": "Words in labels should be capitalized (except prepositions and so on). See https://www.openhab.org/docs/developer/bindings/thing-xml.html#formatting-labels-and-descriptions", "author": "fwolter", "createdAt": "2020-08-20T16:15:04Z", "path": "bundles/org.openhab.binding.opensprinkler/src/main/resources/ESH-INF/thing/thing-types.xml", "diffHunk": "@@ -85,6 +86,14 @@\n \t\t<state readOnly=\"true\"/>\n \t</channel-type>\n \n+\n+\t<channel-type id=\"waterlevel\">\n+\t\t<item-type>Number:Dimensionless</item-type>\n+\t\t<label>Water level</label>", "originalCommit": "5d793f4d5d2238b63b32c6c63ef05da85e802d30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIxMzQwNQ==", "url": "https://github.com/openhab/openhab-addons/pull/8232#discussion_r474213405", "bodyText": "Changed to \"Water Level\"", "author": "pail23", "createdAt": "2020-08-20T19:16:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEwNTExMg=="}], "type": "inlineReview"}, {"oid": "28c23fe010afc35e2799d93a041d9f778bd1670d", "url": "https://github.com/openhab/openhab-addons/commit/28c23fe010afc35e2799d93a041d9f778bd1670d", "message": "mvn spotless:apply and some documentation changes\n\nSigned-off-by: Paul Frank <pail@gmx.net>", "committedDate": "2020-08-20T19:09:09Z", "type": "commit"}]}