{"pr_number": 5016, "pr_title": "Adds lantern recipe to mechanic", "pr_createdAt": "2020-05-16T23:43:54Z", "pr_url": "https://github.com/ldtteam/minecolonies/pull/5016", "timeline": [{"oid": "82c2998fa31b496f5e80c3168cb3798a51105229", "url": "https://github.com/ldtteam/minecolonies/commit/82c2998fa31b496f5e80c3168cb3798a51105229", "message": "Adds lantern recipe to mechanic\n\nSigned-off-by: Mark E. Schill <Mark.Schill@cmschill.net>", "committedDate": "2020-05-16T23:43:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426236269", "bodyText": "Good catch.... However this is kind of way to complicated.\nWe are now way past the \"we can do this with select- or if-switches\"-case and I would rather see a proper registry in the API for this, then these (what feels like 20 but is more like) 6 if switches.\nI know this is a minor change, but all in all this is going a bit too far. Talk to @Raycoms or me @OrionOnline on discord to figure out what exactly we would need here.", "author": "OrionDevelopment", "createdAt": "2020-05-17T09:02:06Z", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingMechanic.java", "diffHunk": "@@ -109,7 +109,8 @@ public boolean canRecipeBeAdded(final IToken token)\n               || storage.getPrimaryOutput().getItem() == Items.JACK_O_LANTERN\n               || (storage.getPrimaryOutput().getItem() instanceof BlockItem && ((BlockItem) storage.getPrimaryOutput().getItem()).getBlock() instanceof HopperBlock)\n               || Tags.Items.STORAGE_BLOCKS.contains(storage.getPrimaryOutput().getItem())\n-              || storage.getPrimaryOutput().getItem() == Items.ENCHANTING_TABLE)\n+              || storage.getPrimaryOutput().getItem() == Items.ENCHANTING_TABLE\n+              || storage.getPrimaryOutput().getItem() == Items.LANTERN)", "originalCommit": "82c2998fa31b496f5e80c3168cb3798a51105229", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzODMwMA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426238300", "bodyText": "I don't think we can solve this too easily.\nProbably the only thing we can do is create a\n\"canBeCraftedByWorkerX\" tag that we then assign in the data to all the blocks we want. But that would also be a mayor pain to handle so I want to avoid this for now.\nI told him he can add it like this for now to the mechanist.", "author": "Raycoms", "createdAt": "2020-05-17T09:24:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzODUzOQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426238539", "bodyText": "It's in general far out of the scope of this PR.", "author": "Raycoms", "createdAt": "2020-05-17T09:26:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI0Mjg3OA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426242878", "bodyText": "Actually I think that is a great idea\nWhy is this out of scope?", "author": "OrionDevelopment", "createdAt": "2020-05-17T10:13:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI0NTM0MA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426245340", "bodyText": "Wouldn't the tag option just be moving the same rules to a single class that is loaded at startup or is there an alternative idea to the rules themselves?", "author": "PowerSchill", "createdAt": "2020-05-17T10:40:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI0NTk2Mg==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426245962", "bodyText": "We would have to create 20 tags and apply them to 100 items, that's why it's auto of scope for the PR.\n(1 tag per worker + 1 tag for each of the items the worker accepts).\nThen, we'd have to check through all the workers and check if they have \"single block\" accepts somewhere and add tags accordingly.", "author": "Raycoms", "createdAt": "2020-05-17T10:46:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI2NzEzNQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426267135", "bodyText": "So in my eyes this would be 1 Tag per worker.\nNot 1 Tag per worker + 1 tag per Item.", "author": "OrionDevelopment", "createdAt": "2020-05-17T14:20:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI2NzcxNw==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426267717", "bodyText": "1 tag per worker, and then we have to add this tag to all the items we want it in.", "author": "Raycoms", "createdAt": "2020-05-17T14:26:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI4NjQxOA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426286418", "bodyText": "that is a file per worker....", "author": "OrionDevelopment", "createdAt": "2020-05-17T17:41:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI4NzAxOA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r426287018", "bodyText": "No, that is a file per vanilla item to have a tag afaik.", "author": "Raycoms", "createdAt": "2020-05-17T17:48:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzc1NjYyNw==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r427756627", "bodyText": "No it is a file per tag. You list each item that you want to be part of the tag in that file.\nEasy as pie. For example there is a file for forge:ingot which lists all ingots.", "author": "OrionDevelopment", "createdAt": "2020-05-20T05:52:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg1NTk0Nw==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r427855947", "bodyText": "@PowerSchill can you for a test set up a tag for the Mechanic and add those items to it?", "author": "Raycoms", "createdAt": "2020-05-20T09:06:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE1NTQzNQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r428155435", "bodyText": "So would this be a single class that loads on startup and iterates through all allowed results and add a tag that is checked for by the mechanic?", "author": "PowerSchill", "createdAt": "2020-05-20T16:39:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE1NzgyNg==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r428157826", "bodyText": "Check how datapacks handle item tags. Then you create a new item tag for the mechanist, and apply it to all the items he should be able to craft.", "author": "Raycoms", "createdAt": "2020-05-20T16:43:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE3MDAyNg==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r428170026", "bodyText": "Just did a quick read on datapacks and item tags. The downside is that it would be static and require manual update. For example if I didn't want to have to code this by hand I would want to create a script to create all of the json files. storage.getPrimaryOutput().getItem().getRegistryName().getPath().contains(\"ice\")", "author": "PowerSchill", "createdAt": "2020-05-20T17:02:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE3MjQyMA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r428172420", "bodyText": "Yes, those would be the exceptions that would stay behind because tags don't handle this as well.\nThe building would check for a) Own tag and b) Some of these exceptions.\nBut the tags allow packmakers to add more items to it, so that definitely does make sense to have.", "author": "Raycoms", "createdAt": "2020-05-20T17:06:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MDM3OA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r428840378", "bodyText": "Hopefully this is what you had in mind.", "author": "PowerSchill", "createdAt": "2020-05-21T18:39:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzNjI2OQ=="}], "type": "inlineReview"}, {"oid": "ec140a3d8902870d3ffc86de677243235db069a1", "url": "https://github.com/ldtteam/minecolonies/commit/ec140a3d8902870d3ffc86de677243235db069a1", "message": "Merge branch 'version/1.15' into feature/lantern_recipe", "committedDate": "2020-05-17T09:26:37Z", "type": "commit"}, {"oid": "fa08745e4a28fb615fa78d9564893b2a710796ae", "url": "https://github.com/ldtteam/minecolonies/commit/fa08745e4a28fb615fa78d9564893b2a710796ae", "message": "Merge branch 'version/1.15' into feature/lantern_recipe", "committedDate": "2020-05-19T22:24:46Z", "type": "commit"}, {"oid": "8e8e1022ce185e2cf8f4028dcc7871d4e2f09df6", "url": "https://github.com/ldtteam/minecolonies/commit/8e8e1022ce185e2cf8f4028dcc7871d4e2f09df6", "message": "Merge branch 'version/1.15' into feature/lantern_recipe", "committedDate": "2020-05-20T09:56:50Z", "type": "commit"}, {"oid": "7d590c7128f4ee514d3e7bd4ddc08a6c52ae9fd4", "url": "https://github.com/ldtteam/minecolonies/commit/7d590c7128f4ee514d3e7bd4ddc08a6c52ae9fd4", "message": "Updates mechanic to use tags\n\nSigned-off-by: Mark E. Schill <Mark.Schill@cmschill.net>", "committedDate": "2020-05-21T18:37:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MjkzMA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r428842930", "bodyText": "Those have to be registered somewhere I believe and then be constants there, but the rest looks correct ys.", "author": "Raycoms", "createdAt": "2020-05-21T18:44:03Z", "path": "src/main/java/com/minecolonies/coremod/colony/buildings/workerbuildings/BuildingMechanic.java", "diffHunk": "@@ -91,40 +92,45 @@ public Skill getSecondarySkill()\n     @Override\n     public boolean canRecipeBeAdded(final IToken token)\n     {\n-        if(!super.canRecipeBeAdded(token))\n+        ResourceLocation builder_products = new ResourceLocation(\"minecolonies\", this.getJobName().toLowerCase().concat(\"_product\"));\n+        ResourceLocation builder_ingredients = new ResourceLocation(\"minecolonies\", this.getJobName().toLowerCase().concat(\"_ingredient\"));\n+", "originalCommit": "7d590c7128f4ee514d3e7bd4ddc08a6c52ae9fd4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0NTY4OA==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r428845688", "bodyText": "It works with it the way it is unless you are pointing out something I am missing.", "author": "PowerSchill", "createdAt": "2020-05-21T18:49:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MjkzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MDI4MQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5016#discussion_r428850281", "bodyText": "@OrionDevelopment I'm not 100% sure, wasn't there a registering steps with custom tags too?", "author": "Raycoms", "createdAt": "2020-05-21T18:57:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MjkzMA=="}], "type": "inlineReview"}]}