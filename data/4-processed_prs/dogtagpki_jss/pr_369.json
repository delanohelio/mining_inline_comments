{"pr_number": 369, "pr_title": "Track SSLCipher supported status", "pr_createdAt": "2020-01-16T20:14:05Z", "pr_url": "https://github.com/dogtagpki/jss/pull/369", "timeline": [{"oid": "e981eb1ba55b8f4360dbb7ad10d9fb14318b0542", "url": "https://github.com/dogtagpki/jss/commit/e981eb1ba55b8f4360dbb7ad10d9fb14318b0542", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>", "committedDate": "2020-01-16T20:15:59Z", "type": "forcePushed"}, {"oid": "62f00012b73bdefefbaa8d3ccbe0eeaba291b90f", "url": "https://github.com/dogtagpki/jss/commit/62f00012b73bdefefbaa8d3ccbe0eeaba291b90f", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>", "committedDate": "2020-01-16T20:17:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA4NDE4NQ==", "url": "https://github.com/dogtagpki/jss/pull/369#discussion_r368084185", "bodyText": "Shouldn't that be info.isFIPS != 0?\nThis expression is also a bit hard to read. Could we break it down maybe like this?\nif (info.nonStandard != 0) {\n    // non-standard ciphers are not supported\n    return JNI_FALSE;\n}\nif (info.isFIPS == 0 && PKI_IsFIPS()) {\n    // non-FIPS ciphers are not supported in FIPS mode\n    return JNI_FALSE;\n}\nreturn JNI_TRUE;", "author": "edewata", "createdAt": "2020-01-17T18:51:32Z", "path": "org/mozilla/jss/ssl/SSLCipher.c", "diffHunk": "@@ -0,0 +1,31 @@\n+#include <nspr.h>\n+#include <nss.h>\n+#include <ssl.h>\n+#include <pk11pub.h>\n+#include <jni.h>\n+\n+#include \"_jni/org_mozilla_jss_ssl_SSLCipher.h\"\n+\n+JNIEXPORT jboolean JNICALL\n+Java_org_mozilla_jss_ssl_SSLCipher_checkSupportedStatus(JNIEnv *env, jclass clazz, jint cipher_suite)\n+{\n+    SSLCipherSuiteInfo info = { 0 };\n+    jboolean found = JNI_FALSE;\n+\n+    for (PRUint16 index = 0; index < SSL_NumImplementedCiphers; index++) {\n+        if (SSL_ImplementedCiphers[index] == cipher_suite) {\n+            found = JNI_TRUE;\n+            break;\n+        }\n+    }\n+\n+    if (found == JNI_FALSE) {\n+        return found;\n+    }\n+\n+    if (SSL_GetCipherSuiteInfo(cipher_suite, &info, sizeof(info)) != SECSuccess || info.length < sizeof(info)) {\n+        return JNI_FALSE;\n+    }\n+\n+    return ((!PK11_IsFIPS() || (info.isFIPS == 0)) && (info.nonStandard == 0)) ? JNI_TRUE : JNI_FALSE;", "originalCommit": "62f00012b73bdefefbaa8d3ccbe0eeaba291b90f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA4NDMzMQ==", "url": "https://github.com/dogtagpki/jss/pull/369#discussion_r368084331", "bodyText": "Enums have built-in valueOf() so this method is redundant.\nhttps://www.tutorialspoint.com/java/lang/enum_valueof.htm", "author": "edewata", "createdAt": "2020-01-17T18:51:53Z", "path": "org/mozilla/jss/ssl/SSLCipher.java", "diffHunk": "@@ -365,10 +379,36 @@ public boolean isECC() {\n         return ecc;\n     }\n \n+    public boolean isTLSv13() {\n+        return tls13;\n+    }\n+\n+    public boolean isSupported() {\n+        return supported;\n+    }\n+\n+    public boolean requiresRSACert() {\n+        return this.name().contains(\"_RSA_\");\n+    }\n+\n+    public boolean requiresECDSACert() {\n+        return this.name().contains(\"_ECDSA_\");\n+    }\n+\n     public static SSLCipher valueOf(int id) {\n         for (SSLCipher cipher : SSLCipher.class.getEnumConstants()) {\n             if (cipher.id == id) return cipher;\n         }\n         return null;\n     }\n+\n+    public static SSLCipher fromName(String name) {", "originalCommit": "62f00012b73bdefefbaa8d3ccbe0eeaba291b90f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA4NzI1MQ==", "url": "https://github.com/dogtagpki/jss/pull/369#discussion_r368087251", "bodyText": "Ah sorry. I was thinking I was going to need to add aliases here (between IANA and JDK names -- kinda like SSLVersion has), but I don't think I need to actually. So I can remove this.", "author": "cipherboy", "createdAt": "2020-01-17T18:58:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA4NDMzMQ=="}], "type": "inlineReview"}, {"oid": "5cc58eb022bbc6e576a69f6ac7d11df5dd1af481", "url": "https://github.com/dogtagpki/jss/commit/5cc58eb022bbc6e576a69f6ac7d11df5dd1af481", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>", "committedDate": "2020-01-19T23:39:57Z", "type": "commit"}, {"oid": "5cc58eb022bbc6e576a69f6ac7d11df5dd1af481", "url": "https://github.com/dogtagpki/jss/commit/5cc58eb022bbc6e576a69f6ac7d11df5dd1af481", "message": "Track SSLCipher supported status\n\nThis allows consumers of SSLCipher to know whether or not a given\ncipher suite is supported in various conditions:\n\n - With TLSv1.3, or\n - In FIPS mode, or\n - With RSA or ECDSA certificates.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>", "committedDate": "2020-01-19T23:39:57Z", "type": "forcePushed"}]}