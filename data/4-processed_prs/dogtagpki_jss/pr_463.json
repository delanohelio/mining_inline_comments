{"pr_number": 463, "pr_title": "Add optional CI to check if PKI build is broken", "pr_createdAt": "2020-04-01T23:14:59Z", "pr_url": "https://github.com/dogtagpki/jss/pull/463", "timeline": [{"oid": "d5764edbed397867aad5678b78d473e2527ecbbb", "url": "https://github.com/dogtagpki/jss/commit/d5764edbed397867aad5678b78d473e2527ecbbb", "message": "Add optional CI to check if PKI is broken\n\nThis adds an optional CI check that builds JSS and then builds PKI,\ninstalling both sets of RPMs.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>", "committedDate": "2020-04-01T23:24:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk5NTY5MQ==", "url": "https://github.com/dogtagpki/jss/pull/463#discussion_r401995691", "bodyText": "I think it should be pki-core instead of pki.", "author": "edewata", "createdAt": "2020-04-02T01:02:59Z", "path": "tools/Dockerfiles/pki_build", "diffHunk": "@@ -0,0 +1,33 @@\n+FROM fedora:latest\n+\n+# Install generic dependencies to build jss and pki\n+RUN true \\\n+        && dnf update -y --refresh \\\n+        && dnf install -y dnf-plugins-core gcc make rpm-build \\\n+        && dnf copr -y enable ${JSS_4_6_REPO:-@pki/master} \\\n+        && dnf build-dep -y jss pki \\", "originalCommit": "d5764edbed397867aad5678b78d473e2527ecbbb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e7afae5423444bd978463d9f4cda0bb23417dab9", "url": "https://github.com/dogtagpki/jss/commit/e7afae5423444bd978463d9f4cda0bb23417dab9", "message": "Add optional CI to check if PKI is broken\n\nThis adds an optional CI check that builds JSS and then builds PKI,\ninstalling both sets of RPMs.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>", "committedDate": "2020-04-02T12:25:45Z", "type": "forcePushed"}, {"oid": "b32efafc7289f588597e432922e393094743a58d", "url": "https://github.com/dogtagpki/jss/commit/b32efafc7289f588597e432922e393094743a58d", "message": "Add optional CI to check if PKI is broken\n\nThis adds an optional CI check that builds JSS and then builds PKI,\ninstalling both sets of RPMs.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>", "committedDate": "2020-04-02T12:26:04Z", "type": "commit"}, {"oid": "b32efafc7289f588597e432922e393094743a58d", "url": "https://github.com/dogtagpki/jss/commit/b32efafc7289f588597e432922e393094743a58d", "message": "Add optional CI to check if PKI is broken\n\nThis adds an optional CI check that builds JSS and then builds PKI,\ninstalling both sets of RPMs.\n\nSigned-off-by: Alexander Scheel <ascheel@redhat.com>", "committedDate": "2020-04-02T12:26:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM1NDkwMQ==", "url": "https://github.com/dogtagpki/jss/pull/463#discussion_r402354901", "bodyText": "builddep is covered again in line 21 and 22, which will install any missing/updated deps. Do we want to remove this line?", "author": "SilleBille", "createdAt": "2020-04-02T14:25:46Z", "path": "tools/Dockerfiles/pki_build", "diffHunk": "@@ -0,0 +1,33 @@\n+FROM fedora:latest\n+\n+# Install generic dependencies to build jss and pki\n+RUN true \\\n+        && dnf update -y --refresh \\\n+        && dnf install -y dnf-plugins-core gcc make rpm-build \\\n+        && dnf copr -y enable ${JSS_4_6_REPO:-@pki/master} \\\n+        && dnf build-dep -y jss pki-core \\", "originalCommit": "b32efafc7289f588597e432922e393094743a58d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM2MTQ1MQ==", "url": "https://github.com/dogtagpki/jss/pull/463#discussion_r402361451", "bodyText": "This pulls in 99% of the deps in the first layer. The layer is cleaned (see dnf clean -y all -- though I had to keep tzinfo and the other directories unlike the other / container / images because PKI build fails without it for some reason).\nThis results in a smaller first layer with all the deps, and then only what is new (in these two versions of JSS/PKI) is pulled in during a separate layer.", "author": "cipherboy", "createdAt": "2020-04-02T14:34:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM1NDkwMQ=="}], "type": "inlineReview"}]}