{"pr_number": 5125, "pr_title": "Fix Atop predicate pushdown", "pr_createdAt": "2020-09-09T21:45:28Z", "pr_url": "https://github.com/trinodb/trino/pull/5125", "timeline": [{"oid": "e5548bcb9bbafcee398928af01447992134af4be", "url": "https://github.com/trinodb/trino/commit/e5548bcb9bbafcee398928af01447992134af4be", "message": "Remove duplicate assertion", "committedDate": "2020-09-09T21:37:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk0MDczOQ==", "url": "https://github.com/trinodb/trino/pull/5125#discussion_r485940739", "bodyText": "1000 -> MILLISECONDS_PER_SECOND", "author": "martint", "createdAt": "2020-09-09T21:47:39Z", "path": "presto-atop/src/main/java/io/prestosql/plugin/atop/AtopSplitManager.java", "diffHunk": "@@ -63,7 +65,14 @@ public ConnectorSplitSource getSplits(ConnectorTransactionHandle transactionHand\n             ZonedDateTime start = end.minusDays(maxHistoryDays - 1).withHour(0).withMinute(0).withSecond(0).withNano(0);\n             while (start.isBefore(end)) {\n                 ZonedDateTime splitEnd = start.withHour(23).withMinute(59).withSecond(59).withNano(0);\n-                Domain splitDomain = Domain.create(ValueSet.ofRanges(Range.range(TIMESTAMP_WITH_TIME_ZONE, 1000 * start.toEpochSecond(), true, 1000 * splitEnd.toEpochSecond(), true)), false);\n+                Domain splitDomain = Domain.create(\n+                        ValueSet.ofRanges(Range.range(\n+                                TIMESTAMP_TZ_MILLIS,\n+                                packDateTimeWithZone(1000 * start.toEpochSecond(), UTC_KEY),", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjExNTQzOQ==", "url": "https://github.com/trinodb/trino/pull/5125#discussion_r486115439", "bodyText": "changed to .toInstant().toEpochMilli() (relevant for end time, in case splitEnd is not whole seconds (not the case today))", "author": "findepi", "createdAt": "2020-09-10T07:13:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk0MDczOQ=="}], "type": "inlineReview"}, {"oid": "c6592696fa0c67b9d2c71957c99bfd9f068bd69f", "url": "https://github.com/trinodb/trino/commit/c6592696fa0c67b9d2c71957c99bfd9f068bd69f", "message": "Fix Atop predicate pushdown", "committedDate": "2020-09-10T07:13:18Z", "type": "commit"}, {"oid": "c6592696fa0c67b9d2c71957c99bfd9f068bd69f", "url": "https://github.com/trinodb/trino/commit/c6592696fa0c67b9d2c71957c99bfd9f068bd69f", "message": "Fix Atop predicate pushdown", "committedDate": "2020-09-10T07:13:18Z", "type": "forcePushed"}]}