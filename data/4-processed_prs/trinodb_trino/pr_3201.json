{"pr_number": 3201, "pr_title": "Move engine-only tests", "pr_createdAt": "2020-03-22T22:59:39Z", "pr_url": "https://github.com/trinodb/trino/pull/3201", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r397763512", "bodyText": "The problem with this test is that it stresses connector. It already was useful to find bugs in connectors implementation very often.", "author": "kokosing", "createdAt": "2020-03-25T10:51:58Z", "path": "presto-thrift/src/test/java/io/prestosql/plugin/thrift/integration/TestThriftDistributedQueries.java", "diffHunk": "@@ -28,10 +28,4 @@ protected QueryRunner createQueryRunner()\n     {\n         return createThriftQueryRunner(3, 3, false, ImmutableMap.of());\n     }\n-\n-    @Override\n-    public void testAssignUniqueId()", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc3MjYzNQ==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r397772635", "bodyText": "How did this find bugs in connectors? If that's the case, we should add an explicit test to smoke tests. Ideally, anything here that tests connectors will move to smoke tests (which are there as connector tests), but that's a larger project.", "author": "electrum", "createdAt": "2020-03-25T11:07:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc3ODMxNw==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r397778317", "bodyText": "It scans multiple tables at the same time (25x union). If connector for example implements pooling, this test will show if the pooling doesn't close connections etc.\nI think the test should be named differently, but it's valuable test.", "author": "sopel39", "createdAt": "2020-03-25T11:18:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc4MDcyMw==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r397780723", "bodyText": "Also it exposes issues with any other shared resources within connector implementation that are not handling concurrency correctly.", "author": "kokosing", "createdAt": "2020-03-25T11:22:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc4NjkwMg==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r397786902", "bodyText": "@kokosing @sopel39 let's copy the test do Distributed Queries. It can be outside of this PR", "author": "findepi", "createdAt": "2020-03-25T11:34:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTYyNDE5Nw==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r399624197", "bodyText": "@findepi Shouldn't it go in smoke tests so that it runs for all connectors?", "author": "electrum", "createdAt": "2020-03-28T05:50:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDA1ODM5NQ==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r400058395", "bodyText": "I think distributed queries is a better place. Smoke tests are not implemented for each connector I guess. Other than that I would merge smoke tests with Distributed queries, I don't follow the difference between them.", "author": "kokosing", "createdAt": "2020-03-30T09:42:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU1MDE2OA==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r400550168", "bodyText": "Which connectors don't have smoke tests that have distributed queries? I couldn't find any.", "author": "electrum", "createdAt": "2020-03-30T23:15:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY2MjI0NQ==", "url": "https://github.com/trinodb/trino/pull/3201#discussion_r400662245", "bodyText": "i confirm. every connector impl'ing distributed queries test also impls smoke test.\nsome (those read-only) connectors implement smoke test only.\n(can be that a connector doesn't impl any, i didn't check)", "author": "findepi", "createdAt": "2020-03-31T06:03:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc2MzUxMg=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "1d0df61a8c213616677b41fc221f35731f977c6a", "url": "https://github.com/trinodb/trino/commit/1d0df61a8c213616677b41fc221f35731f977c6a", "message": "Remove unused method", "committedDate": "2020-03-31T22:38:10Z", "type": "commit"}, {"oid": "ce8b3ba2e017696d3e72efc9f2de631f940089a7", "url": "https://github.com/trinodb/trino/commit/ce8b3ba2e017696d3e72efc9f2de631f940089a7", "message": "Test concurrent scans in AbstractTestIntegrationSmokeTest", "committedDate": "2020-03-31T22:38:10Z", "type": "commit"}, {"oid": "fd5c015fdc2c6fc606b6e864d84d93953af35533", "url": "https://github.com/trinodb/trino/commit/fd5c015fdc2c6fc606b6e864d84d93953af35533", "message": "Move engine-only tests", "committedDate": "2020-03-31T22:38:10Z", "type": "commit"}, {"oid": "fd5c015fdc2c6fc606b6e864d84d93953af35533", "url": "https://github.com/trinodb/trino/commit/fd5c015fdc2c6fc606b6e864d84d93953af35533", "message": "Move engine-only tests", "committedDate": "2020-03-31T22:38:10Z", "type": "forcePushed"}]}