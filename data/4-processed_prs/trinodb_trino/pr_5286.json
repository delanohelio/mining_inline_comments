{"pr_number": 5286, "pr_title": "Add docs for ABFS OAuth support", "pr_createdAt": "2020-09-24T15:12:23Z", "pr_url": "https://github.com/trinodb/trino/pull/5286", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQwNjkyNQ==", "url": "https://github.com/trinodb/trino/pull/5286#discussion_r494406925", "bodyText": "This link adds Hive Connector automatically...\nIf you want to control the text you can use\n:doc:`Hive connector <hive>`", "author": "mosabua", "createdAt": "2020-09-24T15:22:25Z", "path": "presto-docs/src/main/sphinx/connector/hive-azure.rst", "diffHunk": "@@ -2,7 +2,7 @@\n Hive Connector with Azure Storage\n =================================\n \n-The :doc:`hive` can be configured to query\n+The :doc:`hive` connector can be configured to query", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQwODYwOA==", "url": "https://github.com/trinodb/trino/pull/5286#discussion_r494408608", "bodyText": "Oops; fixed.", "author": "jirassimok", "createdAt": "2020-09-24T15:24:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQwNjkyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQwODEyNA==", "url": "https://github.com/trinodb/trino/pull/5286#discussion_r494408124", "bodyText": "as described in the preceding section.", "author": "mosabua", "createdAt": "2020-09-24T15:24:02Z", "path": "presto-docs/src/main/sphinx/connector/hive-azure.rst", "diffHunk": "@@ -31,12 +31,14 @@ configured independently with the storage credentials, you can use the following\n properties in the catalog configuration.\n \n We suggest to use this kind of configuration when you only have the Primary\n-Storage account linked to the cluster. When there are secondary storage accounts\n-involved, it is recommended to configure Presto using\n-``hive.config.resources=<path_to_hadoop_core-site.xml>``, provided\n-``core-site.xml`` has the all storage account credentials.\n+Storage account linked to the cluster. When there are secondary storage\n+accounts involved, we recommend configuring Presto using a ``core-site.xml``\n+containing the appropriate credentials for each account, as described above.", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDQwODM2OA==", "url": "https://github.com/trinodb/trino/pull/5286#discussion_r494408368", "bodyText": "key, or", "author": "mosabua", "createdAt": "2020-09-24T15:24:24Z", "path": "presto-docs/src/main/sphinx/connector/hive-azure.rst", "diffHunk": "@@ -47,21 +49,47 @@ involved, it is recommended to configure Presto using\n   * - ``hive.azure.wasb-access-key``\n     - The decrypted access key for the Azure Blob Storage\n \n-If you choose to use ADLS Gen2, you need to add the following properties:\n+ADLS Gen2 / ABFS Storage\n+^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+To connect to ABFS storage, you may either use the storage account's access\n+key or a service principal. Do not use both sets of properties at the", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "69f0f97c0d8621c56d969bd39eea1a8a823fd852", "url": "https://github.com/trinodb/trino/commit/69f0f97c0d8621c56d969bd39eea1a8a823fd852", "message": "Update Hive-Azure docs for ABFS OAuth", "committedDate": "2020-09-24T15:26:00Z", "type": "commit"}, {"oid": "69f0f97c0d8621c56d969bd39eea1a8a823fd852", "url": "https://github.com/trinodb/trino/commit/69f0f97c0d8621c56d969bd39eea1a8a823fd852", "message": "Update Hive-Azure docs for ABFS OAuth", "committedDate": "2020-09-24T15:26:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUxNjcxNQ==", "url": "https://github.com/trinodb/trino/pull/5286#discussion_r494516715", "bodyText": "depending on the planned operations.", "author": "mosabua", "createdAt": "2020-09-24T18:15:16Z", "path": "presto-docs/src/main/sphinx/connector/hive-azure.rst", "diffHunk": "@@ -47,21 +50,47 @@ involved, it is recommended to configure Presto using\n   * - ``hive.azure.wasb-access-key``\n     - The decrypted access key for the Azure Blob Storage\n \n-If you choose to use ADLS Gen2, you need to add the following properties:\n+ADLS Gen2 / ABFS Storage\n+^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+To connect to ABFS storage, you may either use the storage account's access\n+key, or a service principal. Do not use both sets of properties at the\n+same time.\n \n-.. list-table:: **ADLS Gen2 properties**\n+.. list-table:: ABFS Access Key\n   :widths: 30, 70\n   :header-rows: 1\n \n   * - Property name\n     - Description\n   * - ``hive.azure.abfs-storage-account``\n-    - Storage account name of Azure Data Lake Storage Gen2\n+    - The name of the ADLS Gen2 storage account\n   * - ``hive.azure.abfs-access-key``\n-    - The decrypted access key for the Azure Data Lake Storage Gen2\u00df\n+    - The decrypted access key for the ADLS Gen2 storage account\n+\n+.. list-table:: ABFS Service Principal OAuth\n+  :widths: 30, 70\n+  :header-rows: 1\n+\n+  * - Property name\n+    - Description\n+  * - ``hive.azure.abfs.oauth.endpoint``\n+    - The service principal / application's OAuth 2.0 token endpoint (v1).\n+  * - ``hive.azure.abfs.oauth.client-id``\n+    - The service principal's client/application ID.\n+  * - ``hive.azure.abfs.oauth.secret``\n+    - A client secret for the service principal.\n+\n+When using a service principal, it must have the Storage Blob Data Owner,\n+Contributor, or Reader role on the storage account you are using, depending on", "originalCommit": "69f0f97c0d8621c56d969bd39eea1a8a823fd852", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}