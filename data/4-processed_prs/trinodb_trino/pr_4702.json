{"pr_number": 4702, "pr_title": "Make product tests reports available on host machine", "pr_createdAt": "2020-08-05T18:23:49Z", "pr_url": "https://github.com/trinodb/trino/pull/4702", "timeline": [{"oid": "62d9243c959db6c349b90862b23e94a7b01f4e2c", "url": "https://github.com/trinodb/trino/commit/62d9243c959db6c349b90862b23e94a7b01f4e2c", "message": "Remove deprecated getExitCode method", "committedDate": "2020-08-05T14:51:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkyMzU4Mg==", "url": "https://github.com/trinodb/trino/pull/4702#discussion_r465923582", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        this.reportsDir = requireNonNull(testRunOptions, \"restRunOptions is null\").reportsDir;\n          \n          \n            \n                        this.reportsDir = requireNonNull(testRunOptions.reportsDir, \"testRunOptions.reportsDir is null\");", "author": "aalbu", "createdAt": "2020-08-05T18:32:16Z", "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/cli/TestRun.java", "diffHunk": "@@ -121,6 +130,7 @@ public Execution(EnvironmentFactory environmentFactory, PathResolver pathResolve\n             this.testJar = requireNonNull(testRunOptions.testJar, \"testOptions.testJar is null\");\n             this.testArguments = ImmutableList.copyOf(requireNonNull(testRunOptions.testArguments, \"testOptions.testArguments is null\"));\n             this.environment = requireNonNull(testRunOptions.environment, \"testRunOptions.environment is null\");\n+            this.reportsDir = requireNonNull(testRunOptions, \"restRunOptions is null\").reportsDir;", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkyNzA3Nw==", "url": "https://github.com/trinodb/trino/pull/4702#discussion_r465927077", "bodyText": "Why was this needed?", "author": "aalbu", "createdAt": "2020-08-05T18:39:05Z", "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/cli/TestRun.java", "diffHunk": "@@ -219,10 +263,10 @@ private void runTests(Environment environment)\n \n                 InspectContainerResponse containerInfo = container.getCurrentContainerInfo();\n                 ContainerState containerState = containerInfo.getState();\n-                Integer exitCode = containerState.getExitCode();\n+                Long exitCode = containerState.getExitCodeLong();", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk0NDc4OQ==", "url": "https://github.com/trinodb/trino/pull/4702#discussion_r465944789", "bodyText": "No. I've just seen a deprecated method use so I replaced it with non-deprecated one :)", "author": "wendigo", "createdAt": "2020-08-05T19:11:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkyNzA3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkzMTUyNg==", "url": "https://github.com/trinodb/trino/pull/4702#discussion_r465931526", "bodyText": "static import", "author": "kokosing", "createdAt": "2020-08-05T18:47:12Z", "path": "presto-product-tests-launcher/src/main/java/io/prestosql/tests/product/launcher/cli/TestRun.java", "diffHunk": "@@ -193,12 +204,45 @@ private Environment getEnvironment()\n                                                 .add(container.getEnvMap().getOrDefault(\"TEMPTO_CONFIG_FILES\", \"/dev/null\"))\n                                                 .build()))\n                                 .addAll(testArguments)\n+                                .addAll(reportsDirOptions())\n                                 .build().toArray(new String[0]));\n             });\n \n             return environment.build();\n         }\n \n+        private Iterable<? extends String> reportsDirOptions()\n+        {\n+            if (Strings.isNullOrEmpty(reportsDir)) {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "4dbadcda7afc58dde589b86dfd164ca5143dc23d", "url": "https://github.com/trinodb/trino/commit/4dbadcda7afc58dde589b86dfd164ca5143dc23d", "message": "Mount test report directory into tests container", "committedDate": "2020-08-05T19:17:13Z", "type": "commit"}, {"oid": "085703625b18974cd61f6de129b85b660f483ccb", "url": "https://github.com/trinodb/trino/commit/085703625b18974cd61f6de129b85b660f483ccb", "message": "Save product tests reports in host directory", "committedDate": "2020-08-05T19:17:13Z", "type": "commit"}, {"oid": "085703625b18974cd61f6de129b85b660f483ccb", "url": "https://github.com/trinodb/trino/commit/085703625b18974cd61f6de129b85b660f483ccb", "message": "Save product tests reports in host directory", "committedDate": "2020-08-05T19:17:13Z", "type": "forcePushed"}]}