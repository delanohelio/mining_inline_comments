{"pr_number": 4552, "pr_title": "Ignore empty folder placeholder files on S3", "pr_createdAt": "2020-07-23T16:37:42Z", "pr_url": "https://github.com/trinodb/trino/pull/4552", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYzMDQ5MA==", "url": "https://github.com/trinodb/trino/pull/4552#discussion_r459630490", "bodyText": "Probably copy/pasta, but can you use a different variable name?", "author": "aalbu", "createdAt": "2020-07-23T18:00:36Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/s3/MockAmazonS3.java", "diffHunk": "@@ -125,6 +131,14 @@ public ListObjectsV2Result listObjectsV2(ListObjectsV2Request listObjectsV2Reque\n             listingV2.getObjectSummaries().add(standardOne);\n             listingV2.setTruncated(true);\n             listingV2.setNextContinuationToken(continuationToken);\n+\n+            if (hasHadoopEmptyFolderObjects) {\n+                S3ObjectSummary glacier = new S3ObjectSummary();", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYzMjY5MA==", "url": "https://github.com/trinodb/trino/pull/4552#discussion_r459632690", "bodyText": "Thanks for catching that", "author": "alexjo2144", "createdAt": "2020-07-23T18:04:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYzMDQ5MA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDExNDQ0OA==", "url": "https://github.com/trinodb/trino/pull/4552#discussion_r460114448", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private static boolean isHadoopEmptyFolderObject(S3ObjectSummary object)\n          \n          \n            \n                private static boolean isHadoopFolderMarker(S3ObjectSummary object)", "author": "findepi", "createdAt": "2020-07-24T15:10:19Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/s3/PrestoS3FileSystem.java", "diffHunk": "@@ -591,6 +592,11 @@ private static boolean isGlacierObject(S3ObjectSummary object)\n         return Glacier.toString().equals(object.getStorageClass());\n     }\n \n+    private static boolean isHadoopEmptyFolderObject(S3ObjectSummary object)", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDExNDY5Mg==", "url": "https://github.com/trinodb/trino/pull/4552#discussion_r460114692", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private boolean hasHadoopEmptyFolderObjects;\n          \n          \n            \n                private boolean hasHadoopFolderMarkers;", "author": "findepi", "createdAt": "2020-07-24T15:10:44Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/s3/MockAmazonS3.java", "diffHunk": "@@ -39,6 +39,7 @@\n     private GetObjectMetadataRequest getObjectMetadataRequest;\n     private CannedAccessControlList acl;\n     private boolean hasGlacierObjects;\n+    private boolean hasHadoopEmptyFolderObjects;", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDExNTA5NA==", "url": "https://github.com/trinodb/trino/pull/4552#discussion_r460115094", "bodyText": "rename appropriately", "author": "findepi", "createdAt": "2020-07-24T15:11:25Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/s3/TestPrestoS3FileSystem.java", "diffHunk": "@@ -570,6 +570,22 @@ private static void assertSkipGlacierObjects(boolean skipGlacierObjects)\n         }\n     }\n \n+    @Test\n+    public void testSkipHadoopEmptyFolderObjectsEnabled()", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "c1ec76df5ddc77fd8ed06ef78879746d82dc3dd7", "url": "https://github.com/trinodb/trino/commit/c1ec76df5ddc77fd8ed06ef78879746d82dc3dd7", "message": "Ignore empty folder placeholder files on S3\n\nThese files are created by the Hadoop file system to indicate empty folders.", "committedDate": "2020-07-24T18:16:42Z", "type": "commit"}, {"oid": "c1ec76df5ddc77fd8ed06ef78879746d82dc3dd7", "url": "https://github.com/trinodb/trino/commit/c1ec76df5ddc77fd8ed06ef78879746d82dc3dd7", "message": "Ignore empty folder placeholder files on S3\n\nThese files are created by the Hadoop file system to indicate empty folders.", "committedDate": "2020-07-24T18:16:42Z", "type": "forcePushed"}]}