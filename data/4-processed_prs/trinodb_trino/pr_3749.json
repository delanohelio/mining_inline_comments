{"pr_number": 3749, "pr_title": "Wait for Rubix initialization in Hive connector", "pr_createdAt": "2020-05-15T14:38:33Z", "pr_url": "https://github.com/trinodb/trino/pull/3749", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg1MjUyNQ==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425852525", "bodyText": "this needs to stay for now as cacheReady is still not guaranteed to be true when getFileSystem is called for the first time", "author": "sopel39", "createdAt": "2020-05-15T14:47:10Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixConfigurationInitializer.java", "diffHunk": "@@ -81,7 +80,6 @@ public void updateConfiguration(Configuration config, HdfsContext context, URI u\n     {\n         if (!cacheReady) {\n             setCacheDataEnabled(config, false);\n-            setCacheKey(config, \"rubix_disabled\");", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3MTk5Nw==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425871997", "bodyText": "I do not understand what you mean here.", "author": "losipiuk", "createdAt": "2020-05-15T15:16:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg1MjUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4NDQxNw==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425884417", "bodyText": "I mean this code needs to stay, I've created and squashed fixup that brings these lines back.", "author": "sopel39", "createdAt": "2020-05-15T15:36:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg1MjUyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2ODIwMw==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425868203", "bodyText": "Why it's not readable? We use something similar in: io/prestosql/tests/product/launcher/testcontainers/SelectedPortWaitStrategy.java:70. This approach also provides nice exception message\n\nThe fact that you needed to put comment means it is not readable. We are throwing \"timout\" exception ever loop but retry.\nI would suggest to use Failesafe's timeout mechanism like described in https://jodah.net/failsafe/execution-cancellation/ . And then catch TimeoutExceededException and wrap it to PrestoException", "author": "losipiuk", "createdAt": "2020-05-15T15:11:03Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -64,17 +76,13 @@ public void initializeRubix(NodeManager nodeManager)\n     {\n         ExecutorService initializerService = Executors.newSingleThreadExecutor();\n         ListenableFuture<?> nodeJoinFuture = MoreExecutors.listeningDecorator(initializerService).submit(() ->\n-        {\n-            while (!(nodeManager.getAllNodes().contains(nodeManager.getCurrentNode()) &&\n-                    nodeManager.getAllNodes().stream().anyMatch(Node::isCoordinator))) {\n-                try {\n-                    Thread.sleep(100);\n-                }\n-                catch (InterruptedException e) {\n-                    throw new RuntimeException(e);\n-                }\n-            }\n-        });\n+                Failsafe.with(RETRY_POLICY).run(() -> {\n+                    if (!nodeManager.getAllNodes().contains(nodeManager.getCurrentNode()) ||\n+                            !nodeManager.getAllNodes().stream().anyMatch(Node::isCoordinator)) {\n+                        // Failsafe will propagate this exception only when timeout reached.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg5MjczMQ==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425892731", "bodyText": "The fact that you needed to put comment means it is not readable. We are throwing \"timout\" exception ever loop but retry.\n\nIf I use cancellation mechanism I would have to implement:\nwhile (!condition)\n  Thread.sleep()\n\nagain. I like how Failsafe manages that for me. Let's discuss", "author": "sopel39", "createdAt": "2020-05-15T15:50:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2ODIwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg5Njk4Mg==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425896982", "bodyText": "@findepi what do you think?", "author": "sopel39", "createdAt": "2020-05-15T15:57:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2ODIwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE0NzQ3Mg==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426147472", "bodyText": "@sopel39 i wish i could help. I would need to understand the mechanics better though. (#3749 (comment))", "author": "findepi", "createdAt": "2020-05-16T12:01:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2ODIwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3MTAyMQ==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425871021", "bodyText": "Why make a field out of it instead using a constant?", "author": "losipiuk", "createdAt": "2020-05-15T15:15:23Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -57,6 +53,7 @@\n \n     private static final Logger log = Logger.get(RubixInitializer.class);\n \n+    private final RetryPolicy retryPolicy;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4Mzc5Mg==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425883792", "bodyText": "This is so that different policy can be used in test", "author": "sopel39", "createdAt": "2020-05-15T15:35:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3MTAyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3MTgzMg==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425871832", "bodyText": "shouldn't we just throw here?", "author": "losipiuk", "createdAt": "2020-05-15T15:16:33Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixConfigurationInitializer.java", "diffHunk": "@@ -81,7 +80,6 @@ public void updateConfiguration(Configuration config, HdfsContext context, URI u\n     {\n         if (!cacheReady) {\n             setCacheDataEnabled(config, false);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4NjU4MQ==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425886581", "bodyText": "I prefer to be on safe-side (until RubixConfigurationInitializer is fully immutable) and just allow to create uncached FS until Rubix initializes. Rubix now initializes as part of @PostConstruct, but I guess there could be some other init method that needs FS before that happens.", "author": "sopel39", "createdAt": "2020-05-15T15:40:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3MTgzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3NDA5Nw==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425874097", "bodyText": "Did you test if breaks presto startup in case of failure with @PostConstruct. My understanding is it should but please verify.", "author": "losipiuk", "createdAt": "2020-05-15T15:19:55Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -54,39 +55,44 @@\n     private static final Logger log = Logger.get(RubixInitializer.class);\n \n     private final RetryPolicy retryPolicy;\n+    private final NodeManager nodeManager;\n     private final CatalogName catalogName;\n     private final RubixConfigurationInitializer rubixConfigurationInitializer;\n     private final HdfsConfigurationInitializer hdfsConfigurationInitializer;\n \n     @Inject\n     public RubixInitializer(\n+            NodeManager nodeManager,\n             CatalogName catalogName,\n             RubixConfigurationInitializer rubixConfigurationInitializer,\n             HdfsConfigurationInitializer hdfsConfigurationInitializer)\n     {\n-        this(RETRY_POLICY, catalogName, rubixConfigurationInitializer, hdfsConfigurationInitializer);\n+        this(RETRY_POLICY, nodeManager, catalogName, rubixConfigurationInitializer, hdfsConfigurationInitializer);\n     }\n \n     @VisibleForTesting\n     RubixInitializer(\n             RetryPolicy retryPolicy,\n+            NodeManager nodeManager,\n             CatalogName catalogName,\n             RubixConfigurationInitializer rubixConfigurationInitializer,\n             HdfsConfigurationInitializer hdfsConfigurationInitializer)\n     {\n         this.retryPolicy = retryPolicy;\n+        this.nodeManager = nodeManager;\n         this.catalogName = catalogName;\n         this.rubixConfigurationInitializer = rubixConfigurationInitializer;\n         this.hdfsConfigurationInitializer = hdfsConfigurationInitializer;\n     }\n \n-    public void initializeRubix(NodeManager nodeManager)\n+    @PostConstruct", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4NzUzMQ==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r425887531", "bodyText": "It does fail, checked", "author": "sopel39", "createdAt": "2020-05-15T15:41:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3NDA5Nw=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE0NzA0Mw==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426147043", "bodyText": "its mutable, so it better be a static factory method, not a constant", "author": "findepi", "createdAt": "2020-05-16T11:55:13Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -43,74 +45,87 @@\n  */\n public class RubixInitializer\n {\n+    private static final RetryPolicy<?> RETRY_POLICY =", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE0NzA4Mw==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426147083", "bodyText": "this is mutable, so you should make a defensive copy in the ctor", "author": "findepi", "createdAt": "2020-05-16T11:55:43Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -43,74 +45,87 @@\n  */\n public class RubixInitializer\n {\n+    private static final RetryPolicy<?> RETRY_POLICY =\n+            new RetryPolicy<>()\n+                    // unlimited attempts\n+                    .withMaxAttempts(-1)\n+                    .withDelay(Duration.ofMillis(100))\n+                    .withMaxDuration(Duration.ofMinutes(10));\n+\n     private static final Logger log = Logger.get(RubixInitializer.class);\n \n+    private final RetryPolicy retryPolicy;\n+    private final NodeManager nodeManager;\n     private final CatalogName catalogName;\n     private final RubixConfigurationInitializer rubixConfigurationInitializer;\n     private final HdfsConfigurationInitializer hdfsConfigurationInitializer;\n \n     @Inject\n     public RubixInitializer(\n+            NodeManager nodeManager,\n+            CatalogName catalogName,\n+            RubixConfigurationInitializer rubixConfigurationInitializer,\n+            HdfsConfigurationInitializer hdfsConfigurationInitializer)\n+    {\n+        this(RETRY_POLICY, nodeManager, catalogName, rubixConfigurationInitializer, hdfsConfigurationInitializer);\n+    }\n+\n+    @VisibleForTesting\n+    RubixInitializer(\n+            RetryPolicy retryPolicy,\n+            NodeManager nodeManager,\n             CatalogName catalogName,\n             RubixConfigurationInitializer rubixConfigurationInitializer,\n             HdfsConfigurationInitializer hdfsConfigurationInitializer)\n     {\n+        this.retryPolicy = retryPolicy;", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE0NzI1Mg==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426147252", "bodyText": "How does the hive connector work until rubix is started?\nThe code here fails after 10 minutes. Does it mean the node is unusable at this point?\nIf so, it should ... shut down?\nOr, maybe the caching is unusable, but the node is?", "author": "findepi", "createdAt": "2020-05-16T11:58:39Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -43,74 +45,87 @@\n  */\n public class RubixInitializer\n {\n+    private static final RetryPolicy<?> RETRY_POLICY =\n+            new RetryPolicy<>()\n+                    // unlimited attempts\n+                    .withMaxAttempts(-1)\n+                    .withDelay(Duration.ofMillis(100))\n+                    .withMaxDuration(Duration.ofMinutes(10));\n+\n     private static final Logger log = Logger.get(RubixInitializer.class);\n \n+    private final RetryPolicy retryPolicy;\n+    private final NodeManager nodeManager;\n     private final CatalogName catalogName;\n     private final RubixConfigurationInitializer rubixConfigurationInitializer;\n     private final HdfsConfigurationInitializer hdfsConfigurationInitializer;\n \n     @Inject\n     public RubixInitializer(\n+            NodeManager nodeManager,\n+            CatalogName catalogName,\n+            RubixConfigurationInitializer rubixConfigurationInitializer,\n+            HdfsConfigurationInitializer hdfsConfigurationInitializer)\n+    {\n+        this(RETRY_POLICY, nodeManager, catalogName, rubixConfigurationInitializer, hdfsConfigurationInitializer);\n+    }\n+\n+    @VisibleForTesting\n+    RubixInitializer(\n+            RetryPolicy retryPolicy,\n+            NodeManager nodeManager,\n             CatalogName catalogName,\n             RubixConfigurationInitializer rubixConfigurationInitializer,\n             HdfsConfigurationInitializer hdfsConfigurationInitializer)\n     {\n+        this.retryPolicy = retryPolicy;\n+        this.nodeManager = nodeManager;\n         this.catalogName = catalogName;\n         this.rubixConfigurationInitializer = rubixConfigurationInitializer;\n         this.hdfsConfigurationInitializer = hdfsConfigurationInitializer;\n     }\n \n-    public void initializeRubix(NodeManager nodeManager)\n+    @PostConstruct\n+    public void initializeRubix()\n+    {\n+        waitForCoordinator();\n+        startRubix();\n+    }\n+\n+    private void waitForCoordinator()", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUzNTczOA==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426535738", "bodyText": "When waiting for coordinator times-out then Presto node will fail to start. It will never announce itself as a worker", "author": "sopel39", "createdAt": "2020-05-18T10:46:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE0NzI1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIyNDE1OQ==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426224159", "bodyText": "We should drop Lazily from the comments now as initialisation is now synchronous", "author": "shubhamtagra", "createdAt": "2020-05-17T06:40:30Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -26,14 +24,18 @@\n import io.prestosql.plugin.hive.HdfsConfigurationInitializer;\n import io.prestosql.spi.Node;\n import io.prestosql.spi.NodeManager;\n+import io.prestosql.spi.PrestoException;\n+import net.jodah.failsafe.Failsafe;\n+import net.jodah.failsafe.RetryPolicy;\n import org.apache.hadoop.conf.Configuration;\n \n+import javax.annotation.PostConstruct;\n import javax.inject.Inject;\n \n-import java.util.concurrent.ExecutorService;\n-import java.util.concurrent.Executors;\n+import java.time.Duration;\n \n import static io.prestosql.plugin.hive.util.ConfigurationUtils.getInitialConfiguration;\n+import static io.prestosql.spi.StandardErrorCode.EXCEEDED_TIME_LIMIT;\n \n /*", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI5MTQwNA==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426291404", "bodyText": "The rest of the Hive connector uses RetryDriver, and I think we should stick with that, unless we cannot.  cc @electrum", "author": "dain", "createdAt": "2020-05-17T18:39:29Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -43,6 +48,13 @@\n  */\n public class RubixInitializer\n {\n+    private static final RetryPolicy<?> RETRY_POLICY =", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUzNDgxNg==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426534816", "bodyText": "switcher to RetryDriver", "author": "sopel39", "createdAt": "2020-05-18T10:44:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjI5MTQwNA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "a61e7749727520a6f6c496be4e1aad092b52cc0c", "url": "https://github.com/trinodb/trino/commit/a61e7749727520a6f6c496be4e1aad092b52cc0c", "message": "Simplify RubixInitializer#initializeRubix method", "committedDate": "2020-05-18T10:56:01Z", "type": "commit"}, {"oid": "3c985f300f271b045d2abf04ab0a07f4ec1f592f", "url": "https://github.com/trinodb/trino/commit/3c985f300f271b045d2abf04ab0a07f4ec1f592f", "message": "Reduce methods visibility", "committedDate": "2020-05-18T10:56:02Z", "type": "commit"}, {"oid": "179170dfcd971d45b4d2d91ad6e867c25ee1791b", "url": "https://github.com/trinodb/trino/commit/179170dfcd971d45b4d2d91ad6e867c25ee1791b", "message": "Mark fields as @Nullable", "committedDate": "2020-05-18T10:56:04Z", "type": "commit"}, {"oid": "96ae65d7161634ef4a4b160fdb9dcd2d67d3064d", "url": "https://github.com/trinodb/trino/commit/96ae65d7161634ef4a4b160fdb9dcd2d67d3064d", "message": "Add missing null checks", "committedDate": "2020-05-18T10:56:05Z", "type": "commit"}, {"oid": "feed9327813ed3e11cc7a00418e579b331d1dfc4", "url": "https://github.com/trinodb/trino/commit/feed9327813ed3e11cc7a00418e579b331d1dfc4", "message": "Fix formatting", "committedDate": "2020-05-18T10:56:06Z", "type": "commit"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjU0NDMzNw==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426544337", "bodyText": "commit message is wrong. Use method reference instead of lambda", "author": "losipiuk", "createdAt": "2020-05-18T11:02:53Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -79,7 +79,7 @@ public void initializeRubix(NodeManager nodeManager)\n         addSuccessCallback(\n                 nodeJoinFuture,\n                 () -> {\n-                    Node master = nodeManager.getAllNodes().stream().filter(node -> node.isCoordinator()).findFirst().get();\n+                    Node master = nodeManager.getAllNodes().stream().filter(Node::isCoordinator).findFirst().get();", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjU0NDU2NQ==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426544565", "bodyText": "// wait for up to 10 minutes", "author": "losipiuk", "createdAt": "2020-05-18T11:03:22Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -43,6 +52,16 @@\n  */\n public class RubixInitializer\n {\n+    private static final RetryDriver DEFAULT_COORDINATOR_RETRY_DRIVER = retry()\n+            // unlimited attempts\n+            .maxAttempts(MAX_VALUE)\n+            .exponentialBackoff(\n+                    new Duration(1, SECONDS),\n+                    new Duration(1, SECONDS),\n+                    // wait for 10 minutes for coordinator", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjU0NDg3OQ==", "url": "https://github.com/trinodb/trino/pull/3749#discussion_r426544879", "bodyText": "rename to WAIT_FOR_COORDINATOR_RETRY_DRIVER.\nedit; skip this. You allow for overriding it in followup commit", "author": "losipiuk", "createdAt": "2020-05-18T11:04:06Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/rubix/RubixInitializer.java", "diffHunk": "@@ -43,6 +52,16 @@\n  */\n public class RubixInitializer\n {\n+    private static final RetryDriver DEFAULT_COORDINATOR_RETRY_DRIVER = retry()", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fda569ad899ba08883201fd9a8eb8f0b7c24d897", "url": "https://github.com/trinodb/trino/commit/fda569ad899ba08883201fd9a8eb8f0b7c24d897", "message": "Use method reference instead of lambda", "committedDate": "2020-05-18T11:19:17Z", "type": "commit"}, {"oid": "ea4359c2c6ab42cbd093e5b306097858c23d5779", "url": "https://github.com/trinodb/trino/commit/ea4359c2c6ab42cbd093e5b306097858c23d5779", "message": "Use RetryDriver to wait for coordinator node", "committedDate": "2020-05-18T11:20:36Z", "type": "commit"}, {"oid": "7ccd8d43ecad9999d52a7592d2f2bf62aa074d85", "url": "https://github.com/trinodb/trino/commit/7ccd8d43ecad9999d52a7592d2f2bf62aa074d85", "message": "Extract Rubix startup into separate method", "committedDate": "2020-05-18T11:20:36Z", "type": "commit"}, {"oid": "7f6df600f1e1cbca8d555eff0be92a1bea17a489", "url": "https://github.com/trinodb/trino/commit/7f6df600f1e1cbca8d555eff0be92a1bea17a489", "message": "Initialize more fields in TestRubixCaching", "committedDate": "2020-05-18T11:20:36Z", "type": "commit"}, {"oid": "59b54b811c667c0cafa1e0f8d65aab4573f54834", "url": "https://github.com/trinodb/trino/commit/59b54b811c667c0cafa1e0f8d65aab4573f54834", "message": "Wait for Rubix to start during Hive connector initialization\n\nThis allows to fail-fast if Rubix cannot start of invalid\nconfiguration is provided.", "committedDate": "2020-05-18T11:22:10Z", "type": "commit"}, {"oid": "aab19ca825d68202f2436e1ed517eb49a3124f68", "url": "https://github.com/trinodb/trino/commit/aab19ca825d68202f2436e1ed517eb49a3124f68", "message": "Use @PostConstruct to initialize Rubix instead of explicit method call", "committedDate": "2020-05-18T11:22:32Z", "type": "commit"}, {"oid": "aab19ca825d68202f2436e1ed517eb49a3124f68", "url": "https://github.com/trinodb/trino/commit/aab19ca825d68202f2436e1ed517eb49a3124f68", "message": "Use @PostConstruct to initialize Rubix instead of explicit method call", "committedDate": "2020-05-18T11:22:32Z", "type": "forcePushed"}]}