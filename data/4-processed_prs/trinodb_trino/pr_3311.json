{"pr_number": 3311, "pr_title": "Add milliseconds to formatTime", "pr_createdAt": "2020-04-02T12:38:48Z", "pr_url": "https://github.com/trinodb/trino/pull/3311", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY1NDA4OA==", "url": "https://github.com/trinodb/trino/pull/3311#discussion_r402654088", "bodyText": "I don't think we want to round here, since that would mean 59.5 would be the effective cutoff. We can do\nif (duration.toMillis() >= MINUTES.toMillis(1)) {", "author": "electrum", "createdAt": "2020-04-02T23:30:00Z", "path": "presto-cli/src/main/java/io/prestosql/cli/FormatUtils.java", "diffHunk": "@@ -165,6 +165,24 @@ public static String formatTime(Duration duration)\n         return format(\"%s:%02d\", minutes, seconds);\n     }\n \n+    public static String formatFinalTime(Duration duration)\n+    {\n+        int totalSeconds = Ints.saturatedCast(duration.roundTo(SECONDS));", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY1NDI5Mg==", "url": "https://github.com/trinodb/trino/pull/3311#discussion_r402654292", "bodyText": "This can delegate to formatTime", "author": "electrum", "createdAt": "2020-04-02T23:30:44Z", "path": "presto-cli/src/main/java/io/prestosql/cli/FormatUtils.java", "diffHunk": "@@ -165,6 +165,24 @@ public static String formatTime(Duration duration)\n         return format(\"%s:%02d\", minutes, seconds);\n     }\n \n+    public static String formatFinalTime(Duration duration)\n+    {\n+        int totalSeconds = Ints.saturatedCast(duration.roundTo(SECONDS));\n+\n+        if (totalSeconds >= 60) {\n+            int minutes = totalSeconds / 60;", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjY1NDUzNQ==", "url": "https://github.com/trinodb/trino/pull/3311#discussion_r402654535", "bodyText": "Nit: the \"else\" is redundant, since the \"if\" always returns\nif (... above cutoff...) {\n    return formatTime(...);\n}\n\n... format with millis ...", "author": "electrum", "createdAt": "2020-04-02T23:31:34Z", "path": "presto-cli/src/main/java/io/prestosql/cli/FormatUtils.java", "diffHunk": "@@ -165,6 +165,24 @@ public static String formatTime(Duration duration)\n         return format(\"%s:%02d\", minutes, seconds);\n     }\n \n+    public static String formatFinalTime(Duration duration)\n+    {\n+        int totalSeconds = Ints.saturatedCast(duration.roundTo(SECONDS));\n+\n+        if (totalSeconds >= 60) {\n+            int minutes = totalSeconds / 60;\n+            int seconds = totalSeconds % 60;\n+\n+            return format(\"%s:%02d\", minutes, seconds);\n+        } else {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkyNTA5Mw==", "url": "https://github.com/trinodb/trino/pull/3311#discussion_r425925093", "bodyText": "Actually, this could be simplified to:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    int seconds = (int) (totalMillis / 1000);\n          \n          \n            \n                    int millis = (int) (totalMillis % 1000) / 10;\n          \n          \n            \n            \n          \n          \n            \n                    return format(\"%s.%02d\", seconds, millis);\n          \n          \n            \n                    return format(\"%.2f\", totalMillis / 1000.0);", "author": "martint", "createdAt": "2020-05-15T16:47:13Z", "path": "presto-cli/src/main/java/io/prestosql/cli/FormatUtils.java", "diffHunk": "@@ -165,6 +166,20 @@ public static String formatTime(Duration duration)\n         return format(\"%s:%02d\", minutes, seconds);\n     }\n \n+    public static String formatFinalTime(Duration duration)\n+    {\n+        long totalMillis = duration.toMillis();\n+\n+        if (totalMillis >= MINUTES.toMillis(1)) {\n+            return formatTime(duration);\n+        }\n+\n+        int seconds = (int) (totalMillis / 1000);\n+        int millis = (int) (totalMillis % 1000) / 10;\n+\n+        return format(\"%s.%02d\", seconds, millis);", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "88b38bfe1e1714044f4b56868af5e3ee3243a3b0", "url": "https://github.com/trinodb/trino/commit/88b38bfe1e1714044f4b56868af5e3ee3243a3b0", "message": "Add milliseconds to final time format in case of short queries", "committedDate": "2020-05-15T20:08:00Z", "type": "commit"}, {"oid": "88b38bfe1e1714044f4b56868af5e3ee3243a3b0", "url": "https://github.com/trinodb/trino/commit/88b38bfe1e1714044f4b56868af5e3ee3243a3b0", "message": "Add milliseconds to final time format in case of short queries", "committedDate": "2020-05-15T20:08:00Z", "type": "forcePushed"}]}