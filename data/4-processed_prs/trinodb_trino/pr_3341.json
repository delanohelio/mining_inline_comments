{"pr_number": 3341, "pr_title": "Add session token support to PrestoS3FileSystem", "pr_createdAt": "2020-04-04T20:00:27Z", "pr_url": "https://github.com/trinodb/trino/pull/3341", "timeline": [{"oid": "dc6b1ef17233b2b470ff33d04d5923a8e7f0c6d1", "url": "https://github.com/trinodb/trino/commit/dc6b1ef17233b2b470ff33d04d5923a8e7f0c6d1", "message": "Remove unnecessary test in TestPrestoS3FileSystem", "committedDate": "2020-04-04T18:53:22Z", "type": "commit"}, {"oid": "7ecd4814f05f910c022a2c526f36204ab9b6f115", "url": "https://github.com/trinodb/trino/commit/7ecd4814f05f910c022a2c526f36204ab9b6f115", "message": "Add session token support to PrestoS3FileSystem", "committedDate": "2020-04-04T19:03:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc1MTA0NQ==", "url": "https://github.com/trinodb/trino/pull/3341#discussion_r403751045", "bodyText": "nit, move AWSSessionCredentials.class, sessionCredentials -> as new lines", "author": "sopel39", "createdAt": "2020-04-05T20:12:30Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/s3/TestPrestoS3FileSystem.java", "diffHunk": "@@ -91,21 +94,31 @@ public void testStaticCredentials()\n         Configuration config = new Configuration(false);\n         config.set(S3_ACCESS_KEY, \"test_access_key\");\n         config.set(S3_SECRET_KEY, \"test_secret_key\");\n-        // the static credentials should be preferred\n \n         try (PrestoS3FileSystem fs = new PrestoS3FileSystem()) {\n-            verifyStaticCredentials(config, fs, \"s3n://test-bucket/\", \"test_access_key\", \"test_secret_key\");\n+            AWSCredentials credentials = getStaticCredentials(config, fs, \"s3n://test-bucket/\");\n+            assertEquals(credentials.getAWSAccessKeyId(), \"test_access_key\");\n+            assertEquals(credentials.getAWSSecretKey(), \"test_secret_key\");\n+            assertThat(credentials).isNotInstanceOf(AWSSessionCredentials.class);\n+        }\n+\n+        config.set(S3_SESSION_TOKEN, \"test_token\");\n+        try (PrestoS3FileSystem fs = new PrestoS3FileSystem()) {\n+            AWSCredentials credentials = getStaticCredentials(config, fs, \"s3n://test-bucket/\");\n+            assertEquals(credentials.getAWSAccessKeyId(), \"test_access_key\");\n+            assertEquals(credentials.getAWSSecretKey(), \"test_secret_key\");\n+            assertThat(credentials).isInstanceOfSatisfying(AWSSessionCredentials.class, sessionCredentials ->", "originalCommit": "7ecd4814f05f910c022a2c526f36204ab9b6f115", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc1Njc4Nw==", "url": "https://github.com/trinodb/trino/pull/3341#discussion_r403756787", "bodyText": "This seems worse:\nassertThat(credentials).isInstanceOfSatisfying(\n        AWSSessionCredentials.class,\n        sessionCredentials -> assertEquals(sessionCredentials.getSessionToken(), \"test_token\"));\nWith the above, the class name is close to the isInstanceOf call, and the assertEquals is by itself (easier to read than when preceded by a lambda argument).", "author": "electrum", "createdAt": "2020-04-05T21:05:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc1MTA0NQ=="}], "type": "inlineReview"}]}