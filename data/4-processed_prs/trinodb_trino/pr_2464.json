{"pr_number": 2464, "pr_title": "Do not setup hadoop for Kafka product tests", "pr_createdAt": "2020-01-10T13:08:34Z", "pr_url": "https://github.com/trinodb/trino/pull/2464", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "1bfa09d634e33a7005027e7de03c3815c0877581", "url": "https://github.com/trinodb/trino/commit/1bfa09d634e33a7005027e7de03c3815c0877581", "message": "Extract hadoop.yml from standard.yml", "committedDate": "2020-01-12T19:09:28Z", "type": "commit"}, {"oid": "6bbf23b114a80528eb9e39ad97682cd8b7ee6e0f", "url": "https://github.com/trinodb/trino/commit/6bbf23b114a80528eb9e39ad97682cd8b7ee6e0f", "message": "Fix formatting", "committedDate": "2020-01-12T19:09:28Z", "type": "commit"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "ad7d703db22a39b98b2bf413210d7e52dab998a5", "url": "https://github.com/trinodb/trino/commit/ad7d703db22a39b98b2bf413210d7e52dab998a5", "message": "Do not setup hadoop for Kafka product tests", "committedDate": "2020-01-12T20:07:24Z", "type": "commit"}, {"oid": "ad7d703db22a39b98b2bf413210d7e52dab998a5", "url": "https://github.com/trinodb/trino/commit/ad7d703db22a39b98b2bf413210d7e52dab998a5", "message": "Do not setup hadoop for Kafka product tests", "committedDate": "2020-01-12T20:07:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcyMzQ2Mw==", "url": "https://github.com/trinodb/trino/pull/2464#discussion_r365723463", "bodyText": "This is generally OK, but now in Kafka tests you're not waiting for anything.\nPreviously you waited for hadoop -- hadoop was not needed, but waiting could have been needed.\nThis may cause flakiness.\nHow long does it take Kafka to start, compared to Presto startup?\n(ie % rather than s)", "author": "findepi", "createdAt": "2020-01-13T10:09:28Z", "path": "presto-product-tests/bin/run_on_docker.sh", "diffHunk": "@@ -117,8 +117,10 @@ environment_compose up --no-color --abort-on-container-exit ${SERVICES} &\n # Otherwise docker-compose may created network twice and subsequently fail.\n retry check_any_container_is_up\n \n-# wait until hadoop processes are started\n-retry check_hadoop\n+if [[ $SERVICES == *\"hadoop-master\"* ]]; then\n+    # wait until hadoop processes are started\n+    retry check_hadoop\n+fi", "originalCommit": "ad7d703db22a39b98b2bf413210d7e52dab998a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcyOTU5OA==", "url": "https://github.com/trinodb/trino/pull/2464#discussion_r365729598", "bodyText": "ow in Kafka tests you're not waiting for anything.\n\nI wait for Presto.\n\nHow long does it take Kafka to start, compared to Presto startup?\n\nKafka starts an order of magnitude faster.", "author": "kokosing", "createdAt": "2020-01-13T10:23:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcyMzQ2Mw=="}], "type": "inlineReview"}]}