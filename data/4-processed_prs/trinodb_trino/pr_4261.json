{"pr_number": 4261, "pr_title": "Expose query state in ManagedQueryExecution", "pr_createdAt": "2020-06-29T16:06:27Z", "pr_url": "https://github.com/trinodb/trino/pull/4261", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA5MjQyNg==", "url": "https://github.com/trinodb/trino/pull/4261#discussion_r447092426", "bodyText": "obtaining query info is even more expensive than basic stats", "author": "sopel39", "createdAt": "2020-06-29T16:17:37Z", "path": "presto-main/src/main/java/io/prestosql/dispatcher/LocalDispatchQuery.java", "diffHunk": "@@ -250,6 +251,14 @@ public QueryInfo getFullQueryInfo()\n                 .orElseGet(() -> stateMachine.updateQueryInfo(Optional.empty()));\n     }\n \n+    @Override\n+    public QueryState getState()\n+    {\n+        return tryGetQueryExecution()\n+                .map(queryExecution -> queryExecution.getQueryInfo().getState())", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzExMTU2Ng==", "url": "https://github.com/trinodb/trino/pull/4261#discussion_r447111566", "bodyText": "Ugh.  stateMachine.getState()?", "author": "aalbu", "createdAt": "2020-06-29T16:48:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA5MjQyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzEyNTIwNQ==", "url": "https://github.com/trinodb/trino/pull/4261#discussion_r447125205", "bodyText": "Yes. That one is cheap", "author": "sopel39", "createdAt": "2020-06-29T17:11:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA5MjQyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE2NDc3NA==", "url": "https://github.com/trinodb/trino/pull/4261#discussion_r447164774", "bodyText": "Thanks for catching.", "author": "aalbu", "createdAt": "2020-06-29T18:21:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA5MjQyNg=="}], "type": "inlineReview"}, {"oid": "51aaa46cfeac79def992111cdf38d7c176c459c4", "url": "https://github.com/trinodb/trino/commit/51aaa46cfeac79def992111cdf38d7c176c459c4", "message": "Expose query state in ManagedQueryExecution", "committedDate": "2020-06-29T18:20:40Z", "type": "commit"}, {"oid": "51aaa46cfeac79def992111cdf38d7c176c459c4", "url": "https://github.com/trinodb/trino/commit/51aaa46cfeac79def992111cdf38d7c176c459c4", "message": "Expose query state in ManagedQueryExecution", "committedDate": "2020-06-29T18:20:40Z", "type": "forcePushed"}]}