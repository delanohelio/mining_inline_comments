{"pr_number": 2622, "pr_title": "Add unit test coverage for TABLESAMPLE query using filters", "pr_createdAt": "2020-01-24T18:27:58Z", "pr_url": "https://github.com/trinodb/trino/pull/2622", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDg1MzUxMg==", "url": "https://github.com/trinodb/trino/pull/2622#discussion_r370853512", "bodyText": "as discussed offline; please check whether WHERE clause is significant here\nmaybe add tests without filter to testTableSampleSystemBoundaryValues (renaming it to testTableSampleSystem)\nand keep your tests with filter here (renaming to testTableSampleWithFilter)", "author": "findepi", "createdAt": "2020-01-24T21:37:07Z", "path": "presto-testing/src/main/java/io/prestosql/testing/AbstractTestDistributedQueries.java", "diffHunk": "@@ -964,6 +964,19 @@ public void testTableSampleSystemBoundaryValues()\n         assertEquals(emptySample.getMaterializedRows().size(), 0);\n     }\n \n+    @Test\n+    public void testTableSampleFiltering()\n+    {\n+        MaterializedResult emptySample = computeActual(\"SELECT DISTINCT orderkey, orderdate FROM orders TABLESAMPLE BERNOULLI (99) WHERE orderkey BETWEEN 0 AND 0\");\n+        MaterializedResult halfSample = computeActual(\"SELECT DISTINCT orderkey, orderdate FROM orders TABLESAMPLE BERNOULLI (50) WHERE orderkey BETWEEN 0 AND 9999999999\");", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDg2NDg1Mw==", "url": "https://github.com/trinodb/trino/pull/2622#discussion_r370864853", "bodyText": "Looks like the WHERE is not significant, but I left them in and added another 50% ratio example to the other test.", "author": "alexjo2144", "createdAt": "2020-01-24T22:10:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDg1MzUxMg=="}], "type": "inlineReview"}, {"oid": "a5ba0e8713e1a90b642d4f37c51913ad2a430cad", "url": "https://github.com/trinodb/trino/commit/a5ba0e8713e1a90b642d4f37c51913ad2a430cad", "message": "Add unit test coverage for TABLESAMPLE query using filters", "committedDate": "2020-01-24T22:08:03Z", "type": "commit"}, {"oid": "a5ba0e8713e1a90b642d4f37c51913ad2a430cad", "url": "https://github.com/trinodb/trino/commit/a5ba0e8713e1a90b642d4f37c51913ad2a430cad", "message": "Add unit test coverage for TABLESAMPLE query using filters", "committedDate": "2020-01-24T22:08:03Z", "type": "forcePushed"}]}