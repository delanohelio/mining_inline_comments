{"pr_number": 4483, "pr_title": "Add max idle time as a configurable property for the mongodb connector", "pr_createdAt": "2020-07-17T17:56:48Z", "pr_url": "https://github.com/trinodb/trino/pull/4483", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc1MzUyMw==", "url": "https://github.com/trinodb/trino/pull/4483#discussion_r456753523", "bodyText": "nit: Let's move to under the maxWaitTime since it's timeout value (thus we can minimize the diff).", "author": "ebyhr", "createdAt": "2020-07-18T05:47:12Z", "path": "presto-mongodb/src/main/java/io/prestosql/plugin/mongodb/MongoClientModule.java", "diffHunk": "@@ -56,7 +56,8 @@ public static MongoSession createMongoSession(TypeManager typeManager, MongoClie\n                 .maxWaitTime(config.getMaxWaitTime())\n                 .minConnectionsPerHost(config.getMinConnectionsPerHost())\n                 .readPreference(config.getReadPreference().getReadPreference())\n-                .writeConcern(config.getWriteConcern().getWriteConcern());\n+                .writeConcern(config.getWriteConcern().getWriteConcern())\n+                .maxConnectionIdleTime(config.getMaxConnectionIdleTime());", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc5MDA3OA==", "url": "https://github.com/trinodb/trino/pull/4483#discussion_r456790078", "bodyText": "Done", "author": "jerroldlaw", "createdAt": "2020-07-18T13:26:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc1MzUyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc1Mzc2Nw==", "url": "https://github.com/trinodb/trino/pull/4483#discussion_r456753767", "bodyText": "Please add @Min(0) annotation.", "author": "ebyhr", "createdAt": "2020-07-18T05:50:25Z", "path": "presto-mongodb/src/main/java/io/prestosql/plugin/mongodb/MongoClientConfig.java", "diffHunk": "@@ -307,4 +308,16 @@ public MongoClientConfig setSslEnabled(boolean sslEnabled)\n         this.sslEnabled = sslEnabled;\n         return this;\n     }\n+\n+    public int getMaxConnectionIdleTime()", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc5MDA5MQ==", "url": "https://github.com/trinodb/trino/pull/4483#discussion_r456790091", "bodyText": "Added the annotation", "author": "jerroldlaw", "createdAt": "2020-07-18T13:26:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc1Mzc2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc1NDMzOQ==", "url": "https://github.com/trinodb/trino/pull/4483#discussion_r456754339", "bodyText": "Could you update mongodb.rst in presto-docs module?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Config(\"mongodb.max-connection-idle-time-ms\")\n          \n          \n            \n                @Config(\"mongodb.max-connection-idle-time\")\n          \n      \n    \n    \n  \n\n(Basically, we should use Duration type for this property, but understood the existing property in this connector are using int now)", "author": "ebyhr", "createdAt": "2020-07-18T05:58:11Z", "path": "presto-mongodb/src/main/java/io/prestosql/plugin/mongodb/MongoClientConfig.java", "diffHunk": "@@ -307,4 +308,16 @@ public MongoClientConfig setSslEnabled(boolean sslEnabled)\n         this.sslEnabled = sslEnabled;\n         return this;\n     }\n+\n+    public int getMaxConnectionIdleTime()\n+    {\n+        return maxConnectionIdleTime;\n+    }\n+\n+    @Config(\"mongodb.max-connection-idle-time-ms\")", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc5MDIxMw==", "url": "https://github.com/trinodb/trino/pull/4483#discussion_r456790213", "bodyText": "Yup agreed. Removed the \"-ms\" for more consistency with the rest of the configs. Thanks for taking time to review this @ebyhr \ud83d\ude04", "author": "jerroldlaw", "createdAt": "2020-07-18T13:27:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc1NDMzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc5MDI5MQ==", "url": "https://github.com/trinodb/trino/pull/4483#discussion_r456790291", "bodyText": "Updated mongodb.rst too.", "author": "jerroldlaw", "createdAt": "2020-07-18T13:28:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc1NDMzOQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "9541058241fa38a174411ec553b7f57de1b8479d", "url": "https://github.com/trinodb/trino/commit/9541058241fa38a174411ec553b7f57de1b8479d", "message": "Add max idle time configuration in MongoDB connector", "committedDate": "2020-07-21T12:50:16Z", "type": "commit"}, {"oid": "9541058241fa38a174411ec553b7f57de1b8479d", "url": "https://github.com/trinodb/trino/commit/9541058241fa38a174411ec553b7f57de1b8479d", "message": "Add max idle time configuration in MongoDB connector", "committedDate": "2020-07-21T12:50:16Z", "type": "forcePushed"}]}