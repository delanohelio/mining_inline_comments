{"pr_number": 3710, "pr_title": "Add ISO date and time examples", "pr_createdAt": "2020-05-12T22:11:13Z", "pr_url": "https://github.com/trinodb/trino/pull/3710", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA5Njg2MQ==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r424096861", "bodyText": "Let's write these as example queries with the output, like we do for other functions.", "author": "electrum", "createdAt": "2020-05-12T23:48:46Z", "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -65,11 +65,13 @@ Date and Time Functions\n \n .. function:: from_iso8601_timestamp(string) -> timestamp with time zone\n \n-    Parses the ISO 8601 formatted ``string`` into a ``timestamp with time zone``.\n+    Parses the ISO 8601 formatted date and time ``string``, such as\n+    ``2020-05-11T11:15:05.055-08:00``, into a ``timestamp with time zone``.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUxNzEzOQ==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r424517139", "bodyText": "ok", "author": "mosabua", "createdAt": "2020-05-13T15:12:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA5Njg2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDU2MDUyNw==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r424560527", "bodyText": "Done now ..", "author": "mosabua", "createdAt": "2020-05-13T16:11:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA5Njg2MQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcwOTE1Mg==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r424709152", "bodyText": "Remove \"time\" from \"date and time\", since it's optional and covered by the second part.", "author": "electrum", "createdAt": "2020-05-13T20:23:25Z", "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -65,11 +65,32 @@ Date and Time Functions\n \n .. function:: from_iso8601_timestamp(string) -> timestamp with time zone\n \n-    Parses the ISO 8601 formatted ``string`` into a ``timestamp with time zone``.\n+    Parses the ISO 8601 formatted date and time ``string``, optionally with", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MjQyMg==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r425262422", "bodyText": "done", "author": "mosabua", "createdAt": "2020-05-14T16:17:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcwOTE1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyMTYwMg==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r424721602", "bodyText": "\"time zone\" should be two words (other usages in this document are consistent in this regard)\nLet's clarify missing information:\n\nThe time defaults to zero, and the time zone defaults to the session time zone.\n\nI couldn't incorporate the word \"missing\" without having it twice, but I think the above is fine since we say \"optionally\" in the previous sentence.\nWe should also update the current_timestamp() documentation to say \"session time zone\" instead of \"current time zone\" (since it's not clear what \"current\" means).", "author": "electrum", "createdAt": "2020-05-13T20:47:48Z", "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -65,11 +65,32 @@ Date and Time Functions\n \n .. function:: from_iso8601_timestamp(string) -> timestamp with time zone\n \n-    Parses the ISO 8601 formatted ``string`` into a ``timestamp with time zone``.\n+    Parses the ISO 8601 formatted date and time ``string``, optionally with\n+    time and timezone, into a ``timestamp with time zone``. Missing", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2NjU4NQ==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r425266585", "bodyText": "sentence changed.\nI attempted the other one but the word current is used in many places where it would warrant clarification .. not sure if we want to include these changes in this PR", "author": "mosabua", "createdAt": "2020-05-14T16:23:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyMTYwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3NzQxOQ==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r425277419", "bodyText": "Maybe we should merge what there is now and create another PR after the merge to detail what \"current\" means (server or session or mixture)", "author": "mosabua", "createdAt": "2020-05-14T16:37:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyMTYwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyMjcxNQ==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r424722715", "bodyText": "We should format like the other examples:\nSELECT from_iso8601_timestamp('2020-05-11'); -- 2020-05-11 00:00:00.000 America/Vancouver\nSELECT from_iso8601_timestamp('2020-05-11T11:15:05'); -- 2020-05-11 11:15:05.000 America/Vancouver\nSELECT from_iso8601_timestamp('2020-05-11T11:15:05.055+01:00'); -- 2020-05-11 11:15:05.055 +01:00\nThe advantage of this formatting is that it's consistent and fully executable SQL (you can copy/paste into the CLI or another tool).", "author": "electrum", "createdAt": "2020-05-13T20:50:02Z", "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -65,11 +65,32 @@ Date and Time Functions\n \n .. function:: from_iso8601_timestamp(string) -> timestamp with time zone\n \n-    Parses the ISO 8601 formatted ``string`` into a ``timestamp with time zone``.\n+    Parses the ISO 8601 formatted date and time ``string``, optionally with\n+    time and timezone, into a ``timestamp with time zone``. Missing\n+    information is defaulted to zero and local information::\n+\n+        SELECT from_iso8601_timestamp('2020-05-11');", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2ODc0NA==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r425268744", "bodyText": "I used the same setup as in the Time Zone Conversion section above on the same page ...imho it should at least be in a separate line.. I did that for all snippets consistently on this page now.", "author": "mosabua", "createdAt": "2020-05-14T16:25:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyMjcxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyNDk2MA==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r424724960", "bodyText": "Instead of saying \"various\", which implies these are just some of the supported formats, let's change to enumerate them, using the language from standard (or at least what Wikipedia calls them):\n\nThe date can be a calendar date, a week date using ISO week numbering, or an ordinal date (year and day of year).", "author": "electrum", "createdAt": "2020-05-13T20:54:29Z", "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -65,11 +65,32 @@ Date and Time Functions\n \n .. function:: from_iso8601_timestamp(string) -> timestamp with time zone\n \n-    Parses the ISO 8601 formatted ``string`` into a ``timestamp with time zone``.\n+    Parses the ISO 8601 formatted date and time ``string``, optionally with\n+    time and timezone, into a ``timestamp with time zone``. Missing\n+    information is defaulted to zero and local information::\n+\n+        SELECT from_iso8601_timestamp('2020-05-11');\n+        2020-05-11 00:00:00.000 America/Vancouver\n+\n+        SELECT from_iso8601_timestamp('2020-05-11T11:15:05');\n+        2020-05-11 11:15:05.000 America/Vancouver\n+\n+        SELECT from_iso8601_timestamp('2020-05-11T11:15:05.055+01:00');\n+        2020-05-11 11:15:05.055 +01:00\n \n .. function:: from_iso8601_date(string) -> date\n \n-    Parses the ISO 8601 formatted ``string`` into a ``date``.\n+    Parses the ISO 8601 formatted date ``string`` into a ``date``. Various date", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyNTI3OQ==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r424725279", "bodyText": "SELECT from_iso8601_date('2020-05-11'); -- 2020-05-11\nSELECT from_iso8601_date('2020-123'); -- 2020-05-02\nSELECT from_iso8601_date('2020-W10'); -- 2020-03-02", "author": "electrum", "createdAt": "2020-05-13T20:55:02Z", "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -65,11 +65,32 @@ Date and Time Functions\n \n .. function:: from_iso8601_timestamp(string) -> timestamp with time zone\n \n-    Parses the ISO 8601 formatted ``string`` into a ``timestamp with time zone``.\n+    Parses the ISO 8601 formatted date and time ``string``, optionally with\n+    time and timezone, into a ``timestamp with time zone``. Missing\n+    information is defaulted to zero and local information::\n+\n+        SELECT from_iso8601_timestamp('2020-05-11');\n+        2020-05-11 00:00:00.000 America/Vancouver\n+\n+        SELECT from_iso8601_timestamp('2020-05-11T11:15:05');\n+        2020-05-11 11:15:05.000 America/Vancouver\n+\n+        SELECT from_iso8601_timestamp('2020-05-11T11:15:05.055+01:00');\n+        2020-05-11 11:15:05.055 +01:00\n \n .. function:: from_iso8601_date(string) -> date\n \n-    Parses the ISO 8601 formatted ``string`` into a ``date``.\n+    Parses the ISO 8601 formatted date ``string`` into a ``date``. Various date\n+    formats such as yyyy-mm-dd, day of year and week of year are supported::\n+\n+        SELECT from_iso8601_date('2020-05-11');", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3NDk4Nw==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r425274987", "bodyText": "same as above", "author": "mosabua", "createdAt": "2020-05-14T16:33:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDcyNTI3OQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM3ODYzNw==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r429378637", "bodyText": "Wrapping a single word decreases readability. We don't have a hard limit, so no need.", "author": "electrum", "createdAt": "2020-05-22T17:48:43Z", "path": "presto-docs/src/main/sphinx/functions/datetime.rst", "diffHunk": "@@ -44,11 +44,13 @@ Date and Time Functions\n \n .. data:: current_time\n \n-    Returns the current time with time zone as of the start of the query.\n+    Returns the current time with session time zone as of the start of the\n+    query.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM3OTk4NQ==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r429379985", "bodyText": "Actually, let's revert these changes for now. It reads strangely, since \"as of the start\" sounds like it binds/applies to the \"session time zone\" part. I'm actually more concerned about fixing the \"current time zone\" language for the current_timezone() function, but we can follow up on that.", "author": "electrum", "createdAt": "2020-05-22T17:51:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM3ODYzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM5NjYwNw==", "url": "https://github.com/trinodb/trino/pull/3710#discussion_r429396607", "bodyText": "Done", "author": "mosabua", "createdAt": "2020-05-22T18:31:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM3ODYzNw=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "e11b0dd76aed7270a86670361418ffb2a7eb20d0", "url": "https://github.com/trinodb/trino/commit/e11b0dd76aed7270a86670361418ffb2a7eb20d0", "message": "Add ISO date and time examples", "committedDate": "2020-05-22T18:31:11Z", "type": "commit"}, {"oid": "e11b0dd76aed7270a86670361418ffb2a7eb20d0", "url": "https://github.com/trinodb/trino/commit/e11b0dd76aed7270a86670361418ffb2a7eb20d0", "message": "Add ISO date and time examples", "committedDate": "2020-05-22T18:31:11Z", "type": "forcePushed"}]}