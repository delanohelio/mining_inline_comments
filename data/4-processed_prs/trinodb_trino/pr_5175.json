{"pr_number": 5175, "pr_title": "Fix misuse of HashSet::new", "pr_createdAt": "2020-09-15T17:37:55Z", "pr_url": "https://github.com/trinodb/trino/pull/5175", "timeline": [{"oid": "7229fbeaa617d907c3d3085d23dbfa1c8b8b1366", "url": "https://github.com/trinodb/trino/commit/7229fbeaa617d907c3d3085d23dbfa1c8b8b1366", "message": "Fix misuse of HashSet::new\n\nFix a case where the column index was misused as a\nHashSet capacity parameter.", "committedDate": "2020-09-15T17:34:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODkwOTU0Mw==", "url": "https://github.com/trinodb/trino/pull/5175#discussion_r488909543", "bodyText": "is it the only place where we use HashSet::new like that?", "author": "sopel39", "createdAt": "2020-09-15T19:20:04Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HivePageSourceProvider.java", "diffHunk": "@@ -362,7 +362,7 @@ public int getIndex()\n                     }\n \n                     checkArgument(\n-                            projectionsForColumn.computeIfAbsent(column.getBaseHiveColumnIndex(), HashSet::new).add(column.getHiveColumnProjectionInfo()),\n+                            projectionsForColumn.computeIfAbsent(column.getBaseHiveColumnIndex(), columnIndex -> new HashSet<>()).add(column.getHiveColumnProjectionInfo()),", "originalCommit": "7229fbeaa617d907c3d3085d23dbfa1c8b8b1366", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk3OTQ1NQ==", "url": "https://github.com/trinodb/trino/pull/5175#discussion_r488979455", "bodyText": "is it the only place where we use HashSet::new like that?\n\nIt's the only one I could find, @sopel39.  I also checked a couple of other cases, such as ArrayList::new, but didn't find any instances.", "author": "djsstarburst", "createdAt": "2020-09-15T21:19:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODkwOTU0Mw=="}], "type": "inlineReview"}]}