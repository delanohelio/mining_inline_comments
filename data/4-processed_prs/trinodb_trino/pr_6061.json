{"pr_number": 6061, "pr_title": "Add product test for nested Hive views", "pr_createdAt": "2020-11-23T16:18:03Z", "pr_url": "https://github.com/trinodb/trino/pull/6061", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA3NzM2Mw==", "url": "https://github.com/trinodb/trino/pull/6061#discussion_r529077363", "bodyText": "nit: Specify HIVE_VIEWS group.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Test\n          \n          \n            \n                @Test(groups = HIVE_VIEWS)", "author": "ebyhr", "createdAt": "2020-11-24T00:09:43Z", "path": "presto-product-tests/src/main/java/io/prestosql/tests/hive/TestHiveViews.java", "diffHunk": "@@ -264,6 +264,22 @@ public void testSimpleCoral()\n                 queryAssert -> queryAssert.containsOnly(row(\"hive\")));\n     }\n \n+    @Test", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA4ODIyNQ==", "url": "https://github.com/trinodb/trino/pull/6061#discussion_r529088225", "bodyText": "Prepend n_ to each column name. This is CI failure cause.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    onHive().executeQuery(\"CREATE VIEW nested_base_view AS SELECT nationkey as k, name as n, regionkey as r, comment as c FROM nation\");\n          \n          \n            \n                    onHive().executeQuery(\"CREATE VIEW nested_base_view AS SELECT n_nationkey AS k, n_name AS n, n_regionkey AS r, n_comment AS c FROM nation\");", "author": "ebyhr", "createdAt": "2020-11-24T00:41:21Z", "path": "presto-product-tests/src/main/java/io/prestosql/tests/hive/TestHiveViews.java", "diffHunk": "@@ -264,6 +264,22 @@ public void testSimpleCoral()\n                 queryAssert -> queryAssert.containsOnly(row(\"hive\")));\n     }\n \n+    @Test\n+    public void testNestedHiveViews()\n+    {\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_base_view\");\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_middle_view\");\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_top_view\");\n+\n+        onHive().executeQuery(\"CREATE VIEW nested_base_view AS SELECT nationkey as k, name as n, regionkey as r, comment as c FROM nation\");", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTQyODQ2MQ==", "url": "https://github.com/trinodb/trino/pull/6061#discussion_r529428461", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"SELECT * FROM nested_top_view\",\n          \n          \n            \n                            \"SELECT n_renamed FROM nested_top_view\",", "author": "findepi", "createdAt": "2020-11-24T10:36:10Z", "path": "presto-product-tests/src/main/java/io/prestosql/tests/hive/TestHiveViews.java", "diffHunk": "@@ -264,6 +264,22 @@ public void testSimpleCoral()\n                 queryAssert -> queryAssert.containsOnly(row(\"hive\")));\n     }\n \n+    @Test\n+    public void testNestedHiveViews()\n+    {\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_base_view\");\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_middle_view\");\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_top_view\");\n+\n+        onHive().executeQuery(\"CREATE VIEW nested_base_view AS SELECT nationkey as k, name as n, regionkey as r, comment as c FROM nation\");\n+        onHive().executeQuery(\"CREATE VIEW nested_middle_view AS SELECT n, c FROM nested_base_view WHERE k = 14\");\n+        onHive().executeQuery(\"CREATE VIEW nested_top_view AS SELECT n FROM nested_middle_view\");\n+\n+        assertViewQuery(\n+                \"SELECT * FROM nested_top_view\",", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTQyODU5MA==", "url": "https://github.com/trinodb/trino/pull/6061#discussion_r529428590", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    onHive().executeQuery(\"CREATE VIEW nested_top_view AS SELECT n FROM nested_middle_view\");\n          \n          \n            \n                    onHive().executeQuery(\"CREATE VIEW nested_top_view AS SELECT n AS n_renamed FROM nested_middle_view\");", "author": "findepi", "createdAt": "2020-11-24T10:36:18Z", "path": "presto-product-tests/src/main/java/io/prestosql/tests/hive/TestHiveViews.java", "diffHunk": "@@ -264,6 +264,22 @@ public void testSimpleCoral()\n                 queryAssert -> queryAssert.containsOnly(row(\"hive\")));\n     }\n \n+    @Test\n+    public void testNestedHiveViews()\n+    {\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_base_view\");\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_middle_view\");\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS nested_top_view\");\n+\n+        onHive().executeQuery(\"CREATE VIEW nested_base_view AS SELECT nationkey as k, name as n, regionkey as r, comment as c FROM nation\");\n+        onHive().executeQuery(\"CREATE VIEW nested_middle_view AS SELECT n, c FROM nested_base_view WHERE k = 14\");\n+        onHive().executeQuery(\"CREATE VIEW nested_top_view AS SELECT n FROM nested_middle_view\");", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3e0b1c12b23883309147d582848cdded47083881", "url": "https://github.com/trinodb/trino/commit/3e0b1c12b23883309147d582848cdded47083881", "message": "Add product test for nested Hive views", "committedDate": "2020-11-24T18:28:37Z", "type": "commit"}, {"oid": "3e0b1c12b23883309147d582848cdded47083881", "url": "https://github.com/trinodb/trino/commit/3e0b1c12b23883309147d582848cdded47083881", "message": "Add product test for nested Hive views", "committedDate": "2020-11-24T18:28:37Z", "type": "forcePushed"}]}