{"pr_number": 4752, "pr_title": "Return TIMESTAMP WITH TIME ZONE from Local File connector", "pr_createdAt": "2020-08-08T20:05:58Z", "pr_url": "https://github.com/trinodb/trino/pull/4752", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUwMjgxNQ==", "url": "https://github.com/trinodb/trino/pull/4752#discussion_r467502815", "bodyText": "Technically, we should round here in case the parsed instant has more precision that milliseconds.", "author": "martint", "createdAt": "2020-08-08T20:46:20Z", "path": "presto-local-file/src/main/java/io/prestosql/plugin/localfile/LocalFileRecordCursor.java", "diffHunk": "@@ -246,6 +248,14 @@ public void close()\n         reader.close();\n     }\n \n+    private static long parseTimestamp(String value)\n+    {\n+        OffsetDateTime time = OffsetDateTime.parse(value, ISO_FORMATTER);\n+        long epochMillis = time.toInstant().toEpochMilli();", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUwODk2MA==", "url": "https://github.com/trinodb/trino/pull/4752#discussion_r467508960", "bodyText": "for log parsing, the truncation (not rounding) may be a more expected behavior, as this is what log printer does", "author": "findepi", "createdAt": "2020-08-08T22:06:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUwMjgxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUxMzg5Mw==", "url": "https://github.com/trinodb/trino/pull/4752#discussion_r467513893", "bodyText": "The connector only parses Airlift HTTP logs which use milliseconds, but I can make this round:\nOffsetDateTime time = OffsetDateTime.parse(value, ISO_FORMATTER)\n        .plus(500, ChronoUnit.MICROS)\n        .truncatedTo(ChronoUnit.MILLIS);", "author": "electrum", "createdAt": "2020-08-08T23:18:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUwMjgxNQ=="}], "type": "inlineReview"}, {"oid": "ec51edf614dcf1c541142420f5741bb0eb6792a4", "url": "https://github.com/trinodb/trino/commit/ec51edf614dcf1c541142420f5741bb0eb6792a4", "message": "Return TIMESTAMP WITH TIME ZONE from Local File connector", "committedDate": "2020-08-08T23:18:03Z", "type": "commit"}, {"oid": "ec51edf614dcf1c541142420f5741bb0eb6792a4", "url": "https://github.com/trinodb/trino/commit/ec51edf614dcf1c541142420f5741bb0eb6792a4", "message": "Return TIMESTAMP WITH TIME ZONE from Local File connector", "committedDate": "2020-08-08T23:18:03Z", "type": "forcePushed"}]}