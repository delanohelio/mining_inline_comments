{"pr_number": 2669, "pr_title": "Allow for CTAS  table creation to external tables when write are enabled", "pr_createdAt": "2020-01-29T18:13:28Z", "pr_url": "https://github.com/trinodb/trino/pull/2669", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcwMDM2MA==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372700360", "bodyText": "Perhaps you could have just one test in TestHiveIntegrationSmokeTest that runs the CTAS with both the default/custom query runner and asserts failure or success depending on the configuration. assertUpdate() and assertQuery() both have signatures that accept a session argument and that session could be obtained from different query runners.", "author": "aalbu", "createdAt": "2020-01-30T00:12:55Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveCreateExternalTables.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package io.prestosql.plugin.hive;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+import io.prestosql.testing.AbstractTestQueryFramework;\n+import io.prestosql.testing.QueryRunner;\n+import org.apache.hadoop.fs.Path;\n+import org.intellij.lang.annotations.Language;\n+import org.testng.annotations.Test;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.util.Optional;\n+\n+import static com.google.common.io.Files.createTempDir;\n+import static com.google.common.io.MoreFiles.deleteRecursively;\n+import static com.google.common.io.RecursiveDeleteOption.ALLOW_INSECURE;\n+import static io.prestosql.tpch.TpchTable.CUSTOMER;\n+import static io.prestosql.tpch.TpchTable.ORDERS;\n+import static java.lang.String.format;\n+\n+public class TestHiveCreateExternalTables\n+        extends AbstractTestQueryFramework\n+{\n+    @Override\n+    protected QueryRunner createQueryRunner()\n+            throws Exception\n+    {\n+        return HiveQueryRunner.createQueryRunner(\n+                ImmutableList.of(ORDERS, CUSTOMER),\n+                ImmutableMap.of(),\n+                \"sql-standard\",\n+                ImmutableMap.of(\"hive.non-managed-table-writes-enabled\", \"true\"),\n+                Optional.empty());\n+    }\n+\n+    @Test\n+    public void testCreateExternalTableWithCTASWritesEnabled()", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxOTk2Nw==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372819967", "bodyText": "This may be confusing, especially since the new query runner would be independent from class-level query runner.\nI am leaning towards keeping the test classes separate", "author": "findepi", "createdAt": "2020-01-30T08:45:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcwMDM2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxMTg0NA==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372811844", "bodyText": "testCreateExternalTableWithDataNotAllowed", "author": "findepi", "createdAt": "2020-01-30T08:25:33Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -2285,6 +2286,29 @@ public void testCreateExternalTableTextFileFieldSeparatorEscape()\n         deleteRecursively(tempDir.toPath(), ALLOW_INSECURE);\n     }\n \n+    @Test\n+    public void testCreateExternalTableWithCTASWritesDisabled()", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxMzQ5Mg==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372813492", "bodyText": "format and textfile_field_separator are redundant from this test's point of view, so you can wrap this as:\n\"WITH (external_location = '%s') AS \" +", "author": "findepi", "createdAt": "2020-01-30T08:29:44Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -2285,6 +2286,29 @@ public void testCreateExternalTableTextFileFieldSeparatorEscape()\n         deleteRecursively(tempDir.toPath(), ALLOW_INSECURE);\n     }\n \n+    @Test\n+    public void testCreateExternalTableWithCTASWritesDisabled()\n+            throws IOException\n+    {\n+        File tempDir = createTempDir();\n+        File dataFile = new File(tempDir, \"test.txt\");\n+\n+        @Language(\"SQL\") String createTableSql = format(\"\" +\n+                        \"CREATE TABLE %s.%s.test_create_external \" +\n+                        \"WITH (\\n\" +\n+                        \"   external_location = '%s',\\n\" +\n+                        \"   format = 'TEXTFILE',\\n\" +\n+                        \"   textfile_field_separator = U&'\\\\0001'\\n\" +", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxMzgzOA==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372813838", "bodyText": "unused", "author": "findepi", "createdAt": "2020-01-30T08:30:35Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -2285,6 +2286,29 @@ public void testCreateExternalTableTextFileFieldSeparatorEscape()\n         deleteRecursively(tempDir.toPath(), ALLOW_INSECURE);\n     }\n \n+    @Test\n+    public void testCreateExternalTableWithCTASWritesDisabled()\n+            throws IOException\n+    {\n+        File tempDir = createTempDir();\n+        File dataFile = new File(tempDir, \"test.txt\");", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxNDEwNQ==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372814105", "bodyText": "I think %s.%s. is redundant -- since this is session's default, it's implict in SQL.\n(i know other tests are doing this, but... hm .... let's not do this here)", "author": "findepi", "createdAt": "2020-01-30T08:31:14Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -2285,6 +2286,29 @@ public void testCreateExternalTableTextFileFieldSeparatorEscape()\n         deleteRecursively(tempDir.toPath(), ALLOW_INSECURE);\n     }\n \n+    @Test\n+    public void testCreateExternalTableWithCTASWritesDisabled()\n+            throws IOException\n+    {\n+        File tempDir = createTempDir();\n+        File dataFile = new File(tempDir, \"test.txt\");\n+\n+        @Language(\"SQL\") String createTableSql = format(\"\" +\n+                        \"CREATE TABLE %s.%s.test_create_external \" +", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxNjA0Mw==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372816043", "bodyText": "since this ends up being formatted into string anyway, it should be enough to:\ntempDir.toURI().toASCIIString()", "author": "findepi", "createdAt": "2020-01-30T08:36:07Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -2285,6 +2286,29 @@ public void testCreateExternalTableTextFileFieldSeparatorEscape()\n         deleteRecursively(tempDir.toPath(), ALLOW_INSECURE);\n     }\n \n+    @Test\n+    public void testCreateExternalTableWithCTASWritesDisabled()\n+            throws IOException\n+    {\n+        File tempDir = createTempDir();\n+        File dataFile = new File(tempDir, \"test.txt\");\n+\n+        @Language(\"SQL\") String createTableSql = format(\"\" +\n+                        \"CREATE TABLE %s.%s.test_create_external \" +\n+                        \"WITH (\\n\" +\n+                        \"   external_location = '%s',\\n\" +\n+                        \"   format = 'TEXTFILE',\\n\" +\n+                        \"   textfile_field_separator = U&'\\\\0001'\\n\" +\n+                        \") AS \" +\n+                        \"SELECT * FROM orders LIMIT 5\",\n+                getSession().getCatalog().get(),\n+                getSession().getSchema().get(),\n+                new Path(tempDir.toURI().toASCIIString()).toString());", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxNzEzNw==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372817137", "bodyText": "use nation and without LIMIT 5.\nnation has 25 rows only", "author": "findepi", "createdAt": "2020-01-30T08:38:42Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -2285,6 +2286,29 @@ public void testCreateExternalTableTextFileFieldSeparatorEscape()\n         deleteRecursively(tempDir.toPath(), ALLOW_INSECURE);\n     }\n \n+    @Test\n+    public void testCreateExternalTableWithCTASWritesDisabled()\n+            throws IOException\n+    {\n+        File tempDir = createTempDir();\n+        File dataFile = new File(tempDir, \"test.txt\");\n+\n+        @Language(\"SQL\") String createTableSql = format(\"\" +\n+                        \"CREATE TABLE %s.%s.test_create_external \" +\n+                        \"WITH (\\n\" +\n+                        \"   external_location = '%s',\\n\" +\n+                        \"   format = 'TEXTFILE',\\n\" +\n+                        \"   textfile_field_separator = U&'\\\\0001'\\n\" +\n+                        \") AS \" +\n+                        \"SELECT * FROM orders LIMIT 5\",", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxODE2Mw==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372818163", "bodyText": "I think we should also update the message, to indicate that this is not a permanent condition and may be subject to configuration change\nie change\nExternal tables cannot be created using CREATE TABLE AS\n\nto\nCannot create a non-managed Hive table using CREATE TABLE AS", "author": "findepi", "createdAt": "2020-01-30T08:41:17Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveIntegrationSmokeTest.java", "diffHunk": "@@ -2285,6 +2286,29 @@ public void testCreateExternalTableTextFileFieldSeparatorEscape()\n         deleteRecursively(tempDir.toPath(), ALLOW_INSECURE);\n     }\n \n+    @Test\n+    public void testCreateExternalTableWithCTASWritesDisabled()\n+            throws IOException\n+    {\n+        File tempDir = createTempDir();\n+        File dataFile = new File(tempDir, \"test.txt\");\n+\n+        @Language(\"SQL\") String createTableSql = format(\"\" +\n+                        \"CREATE TABLE %s.%s.test_create_external \" +\n+                        \"WITH (\\n\" +\n+                        \"   external_location = '%s',\\n\" +\n+                        \"   format = 'TEXTFILE',\\n\" +\n+                        \"   textfile_field_separator = U&'\\\\0001'\\n\" +\n+                        \") AS \" +\n+                        \"SELECT * FROM orders LIMIT 5\",\n+                getSession().getCatalog().get(),\n+                getSession().getSchema().get(),\n+                new Path(tempDir.toURI().toASCIIString()).toString());\n+\n+        assertQueryFails(createTableSql, \"External tables cannot be created using CREATE TABLE AS\");", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgxOTM1NQ==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372819355", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public class TestHiveCreateExternalTables\n          \n          \n            \n            public class TestHiveCreateExternalTable", "author": "findepi", "createdAt": "2020-01-30T08:44:11Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveCreateExternalTables.java", "diffHunk": "@@ -0,0 +1,63 @@\n+package io.prestosql.plugin.hive;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+import io.prestosql.testing.AbstractTestQueryFramework;\n+import io.prestosql.testing.QueryRunner;\n+import org.apache.hadoop.fs.Path;\n+import org.intellij.lang.annotations.Language;\n+import org.testng.annotations.Test;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.util.Optional;\n+\n+import static com.google.common.io.Files.createTempDir;\n+import static com.google.common.io.MoreFiles.deleteRecursively;\n+import static com.google.common.io.RecursiveDeleteOption.ALLOW_INSECURE;\n+import static io.prestosql.tpch.TpchTable.CUSTOMER;\n+import static io.prestosql.tpch.TpchTable.ORDERS;\n+import static java.lang.String.format;\n+\n+public class TestHiveCreateExternalTables", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgyMDA3NA==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372820074", "bodyText": "all the comments from the other test method apply here", "author": "findepi", "createdAt": "2020-01-30T08:45:55Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveCreateExternalTables.java", "diffHunk": "@@ -0,0 +1,63 @@\n+package io.prestosql.plugin.hive;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+import io.prestosql.testing.AbstractTestQueryFramework;\n+import io.prestosql.testing.QueryRunner;\n+import org.apache.hadoop.fs.Path;\n+import org.intellij.lang.annotations.Language;\n+import org.testng.annotations.Test;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.util.Optional;\n+\n+import static com.google.common.io.Files.createTempDir;\n+import static com.google.common.io.MoreFiles.deleteRecursively;\n+import static com.google.common.io.RecursiveDeleteOption.ALLOW_INSECURE;\n+import static io.prestosql.tpch.TpchTable.CUSTOMER;\n+import static io.prestosql.tpch.TpchTable.ORDERS;\n+import static java.lang.String.format;\n+\n+public class TestHiveCreateExternalTables\n+        extends AbstractTestQueryFramework\n+{\n+    @Override\n+    protected QueryRunner createQueryRunner()\n+            throws Exception\n+    {\n+        return HiveQueryRunner.createQueryRunner(\n+                ImmutableList.of(ORDERS, CUSTOMER),\n+                ImmutableMap.of(),\n+                \"sql-standard\",\n+                ImmutableMap.of(\"hive.non-managed-table-writes-enabled\", \"true\"),\n+                Optional.empty());\n+    }\n+\n+    @Test\n+    public void testCreateExternalTableWithCTASWritesEnabled()\n+            throws IOException\n+    {\n+        File tempDir = createTempDir();\n+        File dataFile = new File(tempDir, \"test.txt\");", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgyMDMyNg==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r372820326", "bodyText": "testCreateExternalTableWithData", "author": "findepi", "createdAt": "2020-01-30T08:46:26Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveCreateExternalTables.java", "diffHunk": "@@ -0,0 +1,63 @@\n+package io.prestosql.plugin.hive;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+import io.prestosql.testing.AbstractTestQueryFramework;\n+import io.prestosql.testing.QueryRunner;\n+import org.apache.hadoop.fs.Path;\n+import org.intellij.lang.annotations.Language;\n+import org.testng.annotations.Test;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.util.Optional;\n+\n+import static com.google.common.io.Files.createTempDir;\n+import static com.google.common.io.MoreFiles.deleteRecursively;\n+import static com.google.common.io.RecursiveDeleteOption.ALLOW_INSECURE;\n+import static io.prestosql.tpch.TpchTable.CUSTOMER;\n+import static io.prestosql.tpch.TpchTable.ORDERS;\n+import static java.lang.String.format;\n+\n+public class TestHiveCreateExternalTables\n+        extends AbstractTestQueryFramework\n+{\n+    @Override\n+    protected QueryRunner createQueryRunner()\n+            throws Exception\n+    {\n+        return HiveQueryRunner.createQueryRunner(\n+                ImmutableList.of(ORDERS, CUSTOMER),\n+                ImmutableMap.of(),\n+                \"sql-standard\",\n+                ImmutableMap.of(\"hive.non-managed-table-writes-enabled\", \"true\"),\n+                Optional.empty());\n+    }\n+\n+    @Test\n+    public void testCreateExternalTableWithCTASWritesEnabled()", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM2MDY4Nw==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r373360687", "bodyText": "nit: we would typically static import a method like assertEqualsIgnoreOrder", "author": "findepi", "createdAt": "2020-01-31T08:21:33Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/TestHiveCreateExternalTable.java", "diffHunk": "@@ -48,29 +49,24 @@ protected QueryRunner createQueryRunner()\n     }\n \n     @Test\n-    public void testCreateExternalTableWithCTASWritesEnabled()\n+    public void testCreateExternalTableWithData()\n             throws IOException\n     {\n         File tempDir = createTempDir();\n-        File dataFile = new File(tempDir, \"test.txt\");\n \n         @Language(\"SQL\") String createTableSql = format(\"\" +\n-                        \"CREATE TABLE %s.%s.test_create_external \" +\n-                        \"WITH (\\n\" +\n-                        \"   external_location = '%s',\\n\" +\n-                        \"   format = 'TEXTFILE',\\n\" +\n-                        \"   textfile_field_separator = U&'\\\\0001'\\n\" +\n-                        \") AS \" +\n-                        \"SELECT * FROM orders LIMIT 5\",\n-                getSession().getCatalog().get(),\n-                getSession().getSchema().get(),\n-                new Path(tempDir.toURI().toASCIIString()).toString());\n+                        \"CREATE TABLE test_create_external \" +\n+                        \"WITH (external_location = '%s') AS \" +\n+                        \"SELECT * FROM tpch.tiny.nation\",\n+                tempDir.toURI().toASCIIString());\n \n-        assertUpdate(createTableSql, 5);\n+        assertUpdate(createTableSql, 25);\n \n-        assertQuery(\"SELECT count(*) FROM test_create_external\", \"VALUES (5)\");\n-        assertUpdate(\"DROP TABLE test_create_external\");\n+        MaterializedResult expected = computeActual(\"SELECT * FROM tpch.tiny.nation\");\n+        MaterializedResult actual = computeActual(\"SELECT * FROM test_create_external\");\n+        Assertions.assertEqualsIgnoreOrder(actual.getMaterializedRows(), expected.getMaterializedRows());", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM2Mjg3Mg==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r373362872", "bodyText": "One more thing, I think here we should check both: writesToNonManagedTablesEnabled and createsOfNonManagedTablesEnabled", "author": "findepi", "createdAt": "2020-01-31T08:28:22Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "diffHunk": "@@ -1173,8 +1173,8 @@ public HiveOutputTableHandle beginCreateTable(ConnectorSession session, Connecto\n     {\n         verifyJvmTimeZone();\n \n-        if (getExternalLocation(tableMetadata.getProperties()) != null) {\n-            throw new PrestoException(NOT_SUPPORTED, \"External tables cannot be created using CREATE TABLE AS\");\n+        if (!writesToNonManagedTablesEnabled && getExternalLocation(tableMetadata.getProperties()) != null) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzU0MzI5Mg==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r373543292", "bodyText": "You're right, but any idea why that case isn't being caught by https://github.com/prestosql/presto/blob/master/presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java#L789", "author": "alexjo2144", "createdAt": "2020-01-31T15:39:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM2Mjg3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzU0NjM0Nw==", "url": "https://github.com/trinodb/trino/pull/2669#discussion_r373546347", "bodyText": "AFAIR that place is only for create without data (one-off create)\nand this code is only for create with data (prepare-write-commit)", "author": "findepi", "createdAt": "2020-01-31T15:46:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzM2Mjg3Mg=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "855a9d2df6fec0c7930033071532b2c42f6ed8d9", "url": "https://github.com/trinodb/trino/commit/855a9d2df6fec0c7930033071532b2c42f6ed8d9", "message": "Allow for CTAS  table creation to external tables when writes and creates are enabled.\n\nWhen hive.non-managed-table-writes-enabled and hive.non-managed-table-creates-enabled\nare both set to true, external tables can be created and inserted into. This change\nallows for that to be done in one step using the `CREATE TABLE AS` syntax.", "committedDate": "2020-01-31T16:10:12Z", "type": "commit"}, {"oid": "855a9d2df6fec0c7930033071532b2c42f6ed8d9", "url": "https://github.com/trinodb/trino/commit/855a9d2df6fec0c7930033071532b2c42f6ed8d9", "message": "Allow for CTAS  table creation to external tables when writes and creates are enabled.\n\nWhen hive.non-managed-table-writes-enabled and hive.non-managed-table-creates-enabled\nare both set to true, external tables can be created and inserted into. This change\nallows for that to be done in one step using the `CREATE TABLE AS` syntax.", "committedDate": "2020-01-31T16:10:12Z", "type": "forcePushed"}]}