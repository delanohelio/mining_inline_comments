{"pr_number": 5851, "pr_title": "Use consistent NaN behavior for max functions", "pr_createdAt": "2020-11-06T01:44:01Z", "pr_url": "https://github.com/trinodb/trino/pull/5851", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODQ4MDA5Ng==", "url": "https://github.com/trinodb/trino/pull/5851#discussion_r518480096", "bodyText": "maybe add a test with multiple NaNs", "author": "dain", "createdAt": "2020-11-06T02:01:31Z", "path": "presto-main/src/test/java/io/prestosql/operator/scalar/TestMathFunctions.java", "diffHunk": "@@ -1169,15 +1169,23 @@ public void testGreatest()\n         assertFunction(\"greatest(1.5E0, 2.3E0)\", DOUBLE, 2.3);\n         assertFunction(\"greatest(-1.5E0, -2.3E0)\", DOUBLE, -1.5);\n         assertFunction(\"greatest(-1.5E0, -2.3E0, -5/3)\", DOUBLE, -1.0);\n-        assertFunction(\"greatest(1.5E0, -1.0E0 / 0.0E0, 1.0E0 / 0.0E0)\", DOUBLE, Double.POSITIVE_INFINITY);\n+        assertFunction(\"greatest(1.5E0, -infinity(), infinity())\", DOUBLE, Double.POSITIVE_INFINITY);\n         assertFunction(\"greatest(5, 4, CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n-\n-        // float\n-        assertFunction(\"greatest(REAL '1.5', 2.3E0)\", DOUBLE, 2.3);\n-        assertFunction(\"greatest(REAL '-1.5', -2.3E0)\", DOUBLE, (double) -1.5f);\n-        assertFunction(\"greatest(-1.5E0, REAL '-2.3', -5/3)\", DOUBLE, -1.0);\n-        assertFunction(\"greatest(REAL '1.5', REAL '-1.0' / 0.0E0, 1.0E0 / REAL '0.0')\", DOUBLE, (double) (1.0f / 0.0f));\n-        assertFunction(\"greatest(5, REAL '4', CAST(NULL as DOUBLE), 3)\", DOUBLE, null);\n+        assertFunction(\"greatest(NaN(), 5, 4, 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, 4, NaN(), 3)\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(5, 4, 3, NaN())\", DOUBLE, 5.0);\n+        assertFunction(\"greatest(NaN())\", DOUBLE, Double.NaN);", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "c2afb9b6dd52b46484bf61e243dcd5545cf232f3", "url": "https://github.com/trinodb/trino/commit/c2afb9b6dd52b46484bf61e243dcd5545cf232f3", "message": "Use consistent NaN behavior for max functions", "committedDate": "2020-11-06T20:45:00Z", "type": "commit"}, {"oid": "c2afb9b6dd52b46484bf61e243dcd5545cf232f3", "url": "https://github.com/trinodb/trino/commit/c2afb9b6dd52b46484bf61e243dcd5545cf232f3", "message": "Use consistent NaN behavior for max functions", "committedDate": "2020-11-06T20:45:00Z", "type": "forcePushed"}]}