{"pr_number": 4951, "pr_title": "Fail test run when testng listener fails", "pr_createdAt": "2020-08-24T10:53:39Z", "pr_url": "https://github.com/trinodb/trino/pull/4951", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUxODg0NA==", "url": "https://github.com/trinodb/trino/pull/4951#discussion_r475518844", "bodyText": "Can you move wrapping into try/catch to Listeners class", "author": "losipiuk", "createdAt": "2020-08-24T10:57:14Z", "path": "presto-testng-services/src/main/java/io/prestosql/testng/services/ReportIllNamedTest.java", "diffHunk": "@@ -16,14 +16,24 @@\n import org.testng.IClassListener;\n import org.testng.ITestClass;\n \n+import static io.prestosql.testng.services.Listeners.reportListenerFailure;\n import static io.prestosql.testng.services.ReportUnannotatedMethods.isTemptoClass;\n-import static java.lang.String.format;\n \n public class ReportIllNamedTest\n         implements IClassListener\n {\n     @Override\n     public void onBeforeClass(ITestClass testClass)\n+    {\n+        try {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUyMzAyMA==", "url": "https://github.com/trinodb/trino/pull/4951#discussion_r475523020", "bodyText": "I don't think it buys us anything. The mechanism still needs to be opted in by a listener.\nThis way is IMO more readable. (exception flow is not really FP friendly)", "author": "findepi", "createdAt": "2020-08-24T11:06:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUxODg0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU0MTYzMA==", "url": "https://github.com/trinodb/trino/pull/4951#discussion_r475541630", "bodyText": "Yeah. The buy in is negligible. Possible we can avoid a bit of repetition from catch clause", "author": "losipiuk", "createdAt": "2020-08-24T11:45:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTUxODg0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU2MjMxNA==", "url": "https://github.com/trinodb/trino/pull/4951#discussion_r475562314", "bodyText": "I think it is too simple.\nIf it helps for now we could leave it.\nConvention tests do not fail because they are convention tests, but because they are using constructions that are problematic. Such construction could happen in the wild without convention tests.", "author": "kokosing", "createdAt": "2020-08-24T12:27:52Z", "path": "presto-testng-services/src/main/java/io/prestosql/testng/services/ReportUnannotatedMethods.java", "diffHunk": "@@ -50,6 +50,13 @@ public void onBeforeClass(ITestClass testClass)\n     private void reportUnannotatedTestMethods(ITestClass testClass)\n     {\n         Class<?> realClass = testClass.getRealClass();\n+\n+        if (realClass.getSuperclass() != null &&", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU2MzA5NA==", "url": "https://github.com/trinodb/trino/pull/4951#discussion_r475563094", "bodyText": "Totally agree. This is a stop gap.\nAt the same time, inspecting generated class is not very helpful and I did not intend to do this.", "author": "findepi", "createdAt": "2020-08-24T12:29:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU2MjMxNA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "94c173ef9b3ac92d41b5ccdc866c437aeae12b62", "url": "https://github.com/trinodb/trino/commit/94c173ef9b3ac92d41b5ccdc866c437aeae12b62", "message": "Fail test run when testng listener fails", "committedDate": "2020-08-24T13:26:52Z", "type": "commit"}, {"oid": "a09b7487f526ef365921c78310753ebcde67fcde", "url": "https://github.com/trinodb/trino/commit/a09b7487f526ef365921c78310753ebcde67fcde", "message": "Ignore tempto generated convention tests", "committedDate": "2020-08-24T13:26:52Z", "type": "commit"}, {"oid": "a09b7487f526ef365921c78310753ebcde67fcde", "url": "https://github.com/trinodb/trino/commit/a09b7487f526ef365921c78310753ebcde67fcde", "message": "Ignore tempto generated convention tests", "committedDate": "2020-08-24T13:26:52Z", "type": "forcePushed"}]}