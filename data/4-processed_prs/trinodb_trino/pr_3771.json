{"pr_number": 3771, "pr_title": "Add cache for delegation token in Hive thrift metastore", "pr_createdAt": "2020-05-18T13:17:30Z", "pr_url": "https://github.com/trinodb/trino/pull/3771", "timeline": [{"oid": "1ca32b869a7322c8d4f88d5e5178e3109c07cb65", "url": "https://github.com/trinodb/trino/commit/1ca32b869a7322c8d4f88d5e5178e3109c07cb65", "message": "Make table wider in Hive Thrift Metastore document", "committedDate": "2020-05-18T13:12:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg1NjEyMg==", "url": "https://github.com/trinodb/trino/pull/3771#discussion_r429856122", "bodyText": "@NotNull @MinDuration(0)", "author": "findepi", "createdAt": "2020-05-25T10:15:58Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/thrift/ThriftMetastoreConfig.java", "diffHunk": "@@ -151,6 +153,32 @@ public ThriftMetastoreConfig setImpersonationEnabled(boolean impersonationEnable\n         return this;\n     }\n \n+    public Duration getDelegationTokenCacheTtl()", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg1NjE2NQ==", "url": "https://github.com/trinodb/trino/pull/3771#discussion_r429856165", "bodyText": "@NotNull @Min(0)", "author": "findepi", "createdAt": "2020-05-25T10:16:03Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/thrift/ThriftMetastoreConfig.java", "diffHunk": "@@ -151,6 +153,32 @@ public ThriftMetastoreConfig setImpersonationEnabled(boolean impersonationEnable\n         return this;\n     }\n \n+    public Duration getDelegationTokenCacheTtl()\n+    {\n+        return delegationTokenCacheTtl;\n+    }\n+\n+    @Config(\"hive.metastore.thrift.delegation-token.cache-ttl\")\n+    @ConfigDescription(\"Time to live delegation token cache for metastore\")\n+    public ThriftMetastoreConfig setDelegationTokenCacheTtl(Duration delegationTokenCacheTtl)\n+    {\n+        this.delegationTokenCacheTtl = delegationTokenCacheTtl;\n+        return this;\n+    }\n+\n+    public long getDelegationTokenCacheMaximumSize()", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg1NjU5NA==", "url": "https://github.com/trinodb/trino/pull/3771#discussion_r429856594", "bodyText": "Add  a code comment what's default expiry of these tokens on the hive side.", "author": "findepi", "createdAt": "2020-05-25T10:17:07Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/metastore/thrift/ThriftMetastoreConfig.java", "diffHunk": "@@ -37,6 +37,8 @@\n     private Duration maxBackoffDelay = RetryDriver.DEFAULT_SLEEP_TIME;\n     private Duration maxRetryTime = RetryDriver.DEFAULT_MAX_RETRY_TIME;\n     private boolean impersonationEnabled;\n+    private Duration delegationTokenCacheTtl = new Duration(1, TimeUnit.HOURS);", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a63d67268d88f9c84803829d68641f4b869e2d87", "url": "https://github.com/trinodb/trino/commit/a63d67268d88f9c84803829d68641f4b869e2d87", "message": "Add cache for delegation token in Hive thrift metastore", "committedDate": "2020-05-25T10:57:23Z", "type": "commit"}, {"oid": "a63d67268d88f9c84803829d68641f4b869e2d87", "url": "https://github.com/trinodb/trino/commit/a63d67268d88f9c84803829d68641f4b869e2d87", "message": "Add cache for delegation token in Hive thrift metastore", "committedDate": "2020-05-25T10:57:23Z", "type": "forcePushed"}]}