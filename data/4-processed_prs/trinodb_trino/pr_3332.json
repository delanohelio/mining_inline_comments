{"pr_number": 3332, "pr_title": "Report field name when decoding Elasticsearch value fails", "pr_createdAt": "2020-04-03T17:40:00Z", "pr_url": "https://github.com/trinodb/trino/pull/3332", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMxNjQwMg==", "url": "https://github.com/trinodb/trino/pull/3332#discussion_r403316402", "bodyText": "i think value.getClass() is more helpful than value.toString()\nfor example you may get\nExpected a numeric value for field 'my_col' of type BIGINT: 42\n\nand this would be not much more useful than the message without \"42\"\ni saw your comment  in #3321 (comment)\ni still think we should include both: value.toString and value type.\nIf not for end-users, this be useful for us to provide help when they show up with an error.", "author": "findepi", "createdAt": "2020-04-03T20:37:53Z", "path": "presto-elasticsearch/src/main/java/io/prestosql/elasticsearch/decoders/BigintDecoder.java", "diffHunk": "@@ -36,7 +45,7 @@ else if (value instanceof Number) {\n             BIGINT.writeLong(output, ((Number) value).longValue());\n         }\n         else {\n-            throw new PrestoException(TYPE_MISMATCH, \"Expected a numeric value for BIGINT field\");\n+            throw new PrestoException(TYPE_MISMATCH, format(\"Expected a numeric value for field '%s' of type BIGINT: %s\", path, value));", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMxOTA4MQ==", "url": "https://github.com/trinodb/trino/pull/3332#discussion_r403319081", "bodyText": "ok, fair enough.", "author": "martint", "createdAt": "2020-04-03T20:41:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMxNjQwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMxNzE2OQ==", "url": "https://github.com/trinodb/trino/pull/3332#discussion_r403317169", "bodyText": "uppercase timestamp?", "author": "findepi", "createdAt": "2020-04-03T20:38:49Z", "path": "presto-elasticsearch/src/main/java/io/prestosql/elasticsearch/decoders/TimestampDecoder.java", "diffHunk": "@@ -72,7 +73,8 @@ else if (value instanceof Number) {\n             }\n             else {\n                 throw new PrestoException(NOT_SUPPORTED, format(\n-                        \"Unsupported representation for timestamp type: %s [%s]\",\n+                        \"Unsupported representation for field '%s' of type timestamp: %s [%s]\",", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cce86ea7e9cdc7a56d8c93a2611444e2204d133c", "url": "https://github.com/trinodb/trino/commit/cce86ea7e9cdc7a56d8c93a2611444e2204d133c", "message": "Report field name when decoding Elasticsearch value fails", "committedDate": "2020-04-03T21:26:21Z", "type": "commit"}, {"oid": "cce86ea7e9cdc7a56d8c93a2611444e2204d133c", "url": "https://github.com/trinodb/trino/commit/cce86ea7e9cdc7a56d8c93a2611444e2204d133c", "message": "Report field name when decoding Elasticsearch value fails", "committedDate": "2020-04-03T21:26:21Z", "type": "forcePushed"}]}