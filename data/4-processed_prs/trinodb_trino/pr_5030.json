{"pr_number": 5030, "pr_title": "Fix race condition in unregisterDynamicFilteringQuery listener", "pr_createdAt": "2020-08-31T10:00:11Z", "pr_url": "https://github.com/trinodb/trino/pull/5030", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDAyNTgzNQ==", "url": "https://github.com/trinodb/trino/pull/5030#discussion_r480025835", "bodyText": "Please add checkState(isDone(), \"Expected query to be in done state\") so that the reader knows unregisterDynamicFilteringQuery is called from done state. This is important to understand dependencies between registerDynamicFilteringQuery and unregisterDynamicFilteringQuery", "author": "sopel39", "createdAt": "2020-08-31T10:06:03Z", "path": "presto-main/src/main/java/io/prestosql/execution/SqlQueryExecution.java", "diffHunk": "@@ -221,9 +226,6 @@ private synchronized void registerDynamicFilteringQuery(PlanRoot plan)\n \n     private synchronized void unregisterDynamicFilteringQuery(DynamicFiltersStats finalDynamicFiltersStats)\n     {\n-        if (!isDone()) {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "dec5e4a0edebb255f0f3c9ef91831fd0d6bb93f2", "url": "https://github.com/trinodb/trino/commit/dec5e4a0edebb255f0f3c9ef91831fd0d6bb93f2", "message": "Fix race condition in unregisterDynamicFilteringQuery listener\n\n(cherry picked from commit 08839def0fad3861e2d076594e2146f85414133b)", "committedDate": "2020-08-31T11:56:06Z", "type": "commit"}, {"oid": "dec5e4a0edebb255f0f3c9ef91831fd0d6bb93f2", "url": "https://github.com/trinodb/trino/commit/dec5e4a0edebb255f0f3c9ef91831fd0d6bb93f2", "message": "Fix race condition in unregisterDynamicFilteringQuery listener\n\n(cherry picked from commit 08839def0fad3861e2d076594e2146f85414133b)", "committedDate": "2020-08-31T11:56:06Z", "type": "forcePushed"}]}