{"pr_number": 6402, "pr_title": "Verify supportsArrays correctness", "pr_createdAt": "2020-12-21T08:26:09Z", "pr_url": "https://github.com/trinodb/trino/pull/6402", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE5NDQ4NQ==", "url": "https://github.com/trinodb/trino/pull/6402#discussion_r547194485", "bodyText": "#6421", "author": "findepi", "createdAt": "2020-12-22T10:24:31Z", "path": "presto-phoenix/src/test/java/io/prestosql/plugin/phoenix/TestPhoenixDistributedQueries.java", "diffHunk": "@@ -126,6 +127,17 @@ public void testInsert()\n         assertUpdate(\"DROP TABLE test_insert\");\n     }\n \n+    @Override\n+    public void testInsertArray()\n+    {\n+        assertThatThrownBy(super::testInsertArray)\n+                // TODO (https://github.com/prestosql/presto/issues/6421) array with double null stored as array with 0", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5MTc5NA==", "url": "https://github.com/trinodb/trino/pull/6402#discussion_r552391794", "bodyText": "nit: Update URL \ud83d\ude80", "author": "phd3", "createdAt": "2021-01-06T06:22:50Z", "path": "plugin/trino-phoenix/src/test/java/io/trino/plugin/phoenix/TestPhoenixDistributedQueries.java", "diffHunk": "@@ -126,6 +127,17 @@ public void testInsert()\n         assertUpdate(\"DROP TABLE test_insert\");\n     }\n \n+    @Override\n+    public void testInsertArray()\n+    {\n+        assertThatThrownBy(super::testInsertArray)\n+                // TODO (https://github.com/prestosql/presto/issues/6421) array with double null stored as array with 0", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzAwNTg2OQ==", "url": "https://github.com/trinodb/trino/pull/6402#discussion_r553005869", "bodyText": "updated, thanks", "author": "findepi", "createdAt": "2021-01-06T22:56:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5MTc5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5NTAyMg==", "url": "https://github.com/trinodb/trino/pull/6402#discussion_r552395022", "bodyText": "can we use try/finally in AbstractTestDistributedQueries#testInsertArray to force drop tables since this now exits midway?", "author": "phd3", "createdAt": "2021-01-06T06:34:12Z", "path": "plugin/trino-phoenix/src/test/java/io/trino/plugin/phoenix/TestPhoenixDistributedQueries.java", "diffHunk": "@@ -126,6 +127,17 @@ public void testInsert()\n         assertUpdate(\"DROP TABLE test_insert\");\n     }\n \n+    @Override\n+    public void testInsertArray()\n+    {\n+        assertThatThrownBy(super::testInsertArray)", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzAwNjE5Mw==", "url": "https://github.com/trinodb/trino/pull/6402#discussion_r553006193", "bodyText": "i don't think it matters in this case (no shared resources used in the test), and try/finally doesn't help read the test code, so i would rather avoid it", "author": "findepi", "createdAt": "2021-01-06T22:56:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5NTAyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5NjM0Mw==", "url": "https://github.com/trinodb/trino/pull/6402#discussion_r552396343", "bodyText": "is double significant? I got the same error with array(BIGINT) typed a column. May be we can generalize the issue and todo.", "author": "phd3", "createdAt": "2021-01-06T06:38:36Z", "path": "plugin/trino-phoenix/src/test/java/io/trino/plugin/phoenix/TestPhoenixDistributedQueries.java", "diffHunk": "@@ -126,6 +127,17 @@ public void testInsert()\n         assertUpdate(\"DROP TABLE test_insert\");\n     }\n \n+    @Override\n+    public void testInsertArray()\n+    {\n+        assertThatThrownBy(super::testInsertArray)\n+                // TODO (https://github.com/prestosql/presto/issues/6421) array with double null stored as array with 0", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzAwNjQ4MA==", "url": "https://github.com/trinodb/trino/pull/6402#discussion_r553006480", "bodyText": "I didn' test this thoroughly. Added a comment in the issue, but otherwise kept the comment message intact, as it is not incorrect and describes the test's problem precisely.", "author": "findepi", "createdAt": "2021-01-06T22:57:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjM5NjM0Mw=="}], "type": "inlineReview"}, {"oid": "a9110db939930cac540b2ef133e59b34696aa195", "url": "https://github.com/trinodb/trino/commit/a9110db939930cac540b2ef133e59b34696aa195", "message": "Disable array test in Cassandra more properly", "committedDate": "2021-01-06T22:54:08Z", "type": "commit"}, {"oid": "47c61bb0242b97206953c2b592a258a88ea11e0a", "url": "https://github.com/trinodb/trino/commit/47c61bb0242b97206953c2b592a258a88ea11e0a", "message": "Fix supportsArrays declaration in Phoenix tests", "committedDate": "2021-01-06T22:54:55Z", "type": "commit"}, {"oid": "0a6e8a794222ff2f3febf597947a976a3e890861", "url": "https://github.com/trinodb/trino/commit/0a6e8a794222ff2f3febf597947a976a3e890861", "message": "Verify supportsArrays correctness", "committedDate": "2021-01-06T22:54:55Z", "type": "commit"}, {"oid": "0a6e8a794222ff2f3febf597947a976a3e890861", "url": "https://github.com/trinodb/trino/commit/0a6e8a794222ff2f3febf597947a976a3e890861", "message": "Verify supportsArrays correctness", "committedDate": "2021-01-06T22:54:55Z", "type": "forcePushed"}]}