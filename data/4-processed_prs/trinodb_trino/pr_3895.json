{"pr_number": 3895, "pr_title": "Document new argument (case_sensitive) for sync_partition_metadata", "pr_createdAt": "2020-06-01T15:18:34Z", "pr_url": "https://github.com/trinodb/trino/pull/3895", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQwNjk0OQ==", "url": "https://github.com/trinodb/trino/pull/3895#discussion_r433406949", "bodyText": "The ``case_sensitive`` argument is optional. The default value is ``true`` and compatible \nwith Hive's ``MSCK REPAIR TABLE``. Partition names, and therefore the directory names \non the file system, need to use lowercase such as ``col_x=my-value``.  Mixed case \npartitions are ignored, unless the argument is set to ``false``.", "author": "mosabua", "createdAt": "2020-06-01T18:19:40Z", "path": "presto-docs/src/main/sphinx/connector/hive.rst", "diffHunk": "@@ -945,14 +945,20 @@ Procedures\n \n     Create an empty partition in the specified table.\n \n-* ``system.sync_partition_metadata(schema_name, table_name, mode)``\n+* ``system.sync_partition_metadata(schema_name, table_name, mode, case_sensitive)``\n \n     Check and update partitions list in metastore. There are three modes available:\n \n     * ``ADD`` : add any partitions that exist on the file system, but not in the metastore.\n     * ``DROP``: drop any partitions that exist in the metastore, but not on the file system.\n     * ``FULL``: perform both ``ADD`` and ``DROP``.\n \n+    The `case_sensitive` argument is optional and has a default value of `true`. For compatibility\n+    with Hive's `MSCK REPAIR TABLE`, the partition names on the file system (the directory name\n+    part corresponding to the column name) are expected to be in lowercase (e.g. `col_x=SomeValue`).\n+    If that is not the case, those paths will be ignored, unless a value of `false` is passed for", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQwNzIyNA==", "url": "https://github.com/trinodb/trino/pull/3895#discussion_r433407224", "bodyText": "the above should fix grammar, clarity and source formatting issues. I have not test it though..", "author": "mosabua", "createdAt": "2020-06-01T18:20:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQwNjk0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQ1MzI0Ng==", "url": "https://github.com/trinodb/trino/pull/3895#discussion_r433453246", "bodyText": "Thanks for fixing the formatting. I picked col_x=SomeValue deliberately as an example, to make it clear that the part corresponding to the column name is what needs to be lower case in Hive compatibility mode.  The actual partition value can have any capitalization.\nI am open to suggestions, but this is neither accurate nor clear:\n\nPartition names, and therefore the directory names on the file system, need to use lowercase", "author": "aalbu", "createdAt": "2020-06-01T19:51:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQwNjk0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzk1MzAzOQ==", "url": "https://github.com/trinodb/trino/pull/3895#discussion_r433953039", "bodyText": "Feel free to merge the two as desired ... but you need to fix the syntax to ensure this builds.", "author": "mosabua", "createdAt": "2020-06-02T15:12:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQwNjk0OQ=="}], "type": "inlineReview"}, {"oid": "5460731629bebc1f296bed4b4a8a67e4d5b82659", "url": "https://github.com/trinodb/trino/commit/5460731629bebc1f296bed4b4a8a67e4d5b82659", "message": "Document new argument (case_sensitive) for sync_partition_metadata", "committedDate": "2020-06-02T15:53:06Z", "type": "commit"}, {"oid": "5460731629bebc1f296bed4b4a8a67e4d5b82659", "url": "https://github.com/trinodb/trino/commit/5460731629bebc1f296bed4b4a8a67e4d5b82659", "message": "Document new argument (case_sensitive) for sync_partition_metadata", "committedDate": "2020-06-02T15:53:06Z", "type": "forcePushed"}]}