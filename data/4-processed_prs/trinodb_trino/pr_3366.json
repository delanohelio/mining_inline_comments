{"pr_number": 3366, "pr_title": "Disallow reading from Delta Lake tables in hive connector", "pr_createdAt": "2020-04-07T10:04:42Z", "pr_url": "https://github.com/trinodb/trino/pull/3366", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0Mjc5Ng==", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404842796", "bodyText": "just use HIVE_UNSUPPORTED_FORMAT instead", "author": "findepi", "createdAt": "2020-04-07T14:14:58Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveErrorCode.java", "diffHunk": "@@ -64,7 +64,8 @@\n     HIVE_CORRUPTED_COLUMN_STATISTICS(37, EXTERNAL),\n     HIVE_EXCEEDED_SPLIT_BUFFERING_LIMIT(38, USER_ERROR),\n     HIVE_UNKNOWN_COLUMN_STATISTIC_TYPE(39, INTERNAL_ERROR),\n-    HIVE_TABLE_LOCK_NOT_ACQUIRED(40, EXTERNAL)\n+    HIVE_TABLE_LOCK_NOT_ACQUIRED(40, EXTERNAL),\n+    HIVE_DELTA_LAKE_TABLE(40, USER_ERROR),", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0MzAxMQ==", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404843011", "bodyText": "rm \"Managed\"", "author": "findepi", "createdAt": "2020-04-07T14:15:15Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "diffHunk": "@@ -2296,6 +2303,12 @@ private static void validateBucketColumns(ConnectorTableMetadata tableMetadata)\n         }\n     }\n \n+    private static boolean isDeltaLakeManagedTable(Table table)", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg0MzMzMQ==", "url": "https://github.com/trinodb/trino/pull/3366#discussion_r404843331", "bodyText": "rm \"managed\"", "author": "findepi", "createdAt": "2020-04-07T14:15:39Z", "path": "presto-hive/src/main/java/io/prestosql/plugin/hive/HiveMetadata.java", "diffHunk": "@@ -341,6 +344,10 @@ public HiveTableHandle getTableHandle(ConnectorSession session, SchemaTableName\n             return null;\n         }\n \n+        if (isDeltaLakeManagedTable(table.get())) {\n+            throw new PrestoException(HIVE_DELTA_LAKE_TABLE, \"Cannot query Delta Lake managed table\");", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "6796776bb5edcff998b9eb62afdf76b7dee53a5a", "url": "https://github.com/trinodb/trino/commit/6796776bb5edcff998b9eb62afdf76b7dee53a5a", "message": "Disallow reading from Delta Lake tables in hive connector", "committedDate": "2020-04-07T18:14:38Z", "type": "commit"}, {"oid": "6796776bb5edcff998b9eb62afdf76b7dee53a5a", "url": "https://github.com/trinodb/trino/commit/6796776bb5edcff998b9eb62afdf76b7dee53a5a", "message": "Disallow reading from Delta Lake tables in hive connector", "committedDate": "2020-04-07T18:14:38Z", "type": "forcePushed"}]}