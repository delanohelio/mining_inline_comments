{"pr_number": 5366, "pr_title": "Disable min/max collection for dynamic filters", "pr_createdAt": "2020-09-30T20:55:22Z", "pr_url": "https://github.com/trinodb/trino/pull/5366", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1MDY1Ng==", "url": "https://github.com/trinodb/trino/pull/5366#discussion_r498150656", "bodyText": "let's disable min/max collection due to: #5368", "author": "sopel39", "createdAt": "2020-10-01T10:44:19Z", "path": "presto-main/src/main/java/io/prestosql/execution/DynamicFilterConfig.java", "diffHunk": "@@ -37,12 +37,12 @@\n     private boolean enableLargeDynamicFilters;\n     private int serviceThreadCount = 2;\n \n-    private int smallBroadcastMaxDistinctValuesPerDriver = 100;\n-    private DataSize smallBroadcastMaxSizePerDriver = DataSize.of(10, KILOBYTE);\n-    private int smallBroadcastRangeRowLimitPerDriver;\n-    private int smallPartitionedMaxDistinctValuesPerDriver = 10;\n+    private int smallBroadcastMaxDistinctValuesPerDriver = 200;\n+    private DataSize smallBroadcastMaxSizePerDriver = DataSize.of(20, KILOBYTE);\n+    private int smallBroadcastRangeRowLimitPerDriver = 5000;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1NjQ4Nw==", "url": "https://github.com/trinodb/trino/pull/5366#discussion_r498156487", "bodyText": "done", "author": "raunaqmorarka", "createdAt": "2020-10-01T10:56:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1MDY1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1MDc4OA==", "url": "https://github.com/trinodb/trino/pull/5366#discussion_r498150788", "bodyText": "let's disable min/max collection due to: #5368", "author": "sopel39", "createdAt": "2020-10-01T10:44:37Z", "path": "presto-main/src/main/java/io/prestosql/execution/DynamicFilterConfig.java", "diffHunk": "@@ -37,12 +37,12 @@\n     private boolean enableLargeDynamicFilters;\n     private int serviceThreadCount = 2;\n \n-    private int smallBroadcastMaxDistinctValuesPerDriver = 100;\n-    private DataSize smallBroadcastMaxSizePerDriver = DataSize.of(10, KILOBYTE);\n-    private int smallBroadcastRangeRowLimitPerDriver;\n-    private int smallPartitionedMaxDistinctValuesPerDriver = 10;\n+    private int smallBroadcastMaxDistinctValuesPerDriver = 200;\n+    private DataSize smallBroadcastMaxSizePerDriver = DataSize.of(20, KILOBYTE);\n+    private int smallBroadcastRangeRowLimitPerDriver = 5000;\n+    private int smallPartitionedMaxDistinctValuesPerDriver = 20;\n     private DataSize smallPartitionedMaxSizePerDriver = DataSize.of(10, KILOBYTE);\n-    private int smallPartitionedRangeRowLimitPerDriver = 100;\n+    private int smallPartitionedRangeRowLimitPerDriver = 500;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1MjA1Ng==", "url": "https://github.com/trinodb/trino/pull/5366#discussion_r498152056", "bodyText": "let's also disable min/max collection for large DFs for now.", "author": "sopel39", "createdAt": "2020-10-01T10:47:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1MDc4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1NzM4Nw==", "url": "https://github.com/trinodb/trino/pull/5366#discussion_r498157387", "bodyText": "I've disabled for small and large DF in case of broadcast joins. I think for partitioned joins we might still be ok as each driver is collecting a disjoint range ?", "author": "raunaqmorarka", "createdAt": "2020-10-01T10:57:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1MDc4OA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1NjYxOA==", "url": "https://github.com/trinodb/trino/pull/5366#discussion_r498156618", "bodyText": "let's disable it too", "author": "sopel39", "createdAt": "2020-10-01T10:56:18Z", "path": "presto-main/src/main/java/io/prestosql/execution/DynamicFilterConfig.java", "diffHunk": "@@ -37,16 +37,16 @@\n     private boolean enableLargeDynamicFilters;\n     private int serviceThreadCount = 2;\n \n-    private int smallBroadcastMaxDistinctValuesPerDriver = 100;\n-    private DataSize smallBroadcastMaxSizePerDriver = DataSize.of(10, KILOBYTE);\n+    private int smallBroadcastMaxDistinctValuesPerDriver = 200;\n+    private DataSize smallBroadcastMaxSizePerDriver = DataSize.of(20, KILOBYTE);\n     private int smallBroadcastRangeRowLimitPerDriver;\n-    private int smallPartitionedMaxDistinctValuesPerDriver = 10;\n+    private int smallPartitionedMaxDistinctValuesPerDriver = 20;\n     private DataSize smallPartitionedMaxSizePerDriver = DataSize.of(10, KILOBYTE);\n-    private int smallPartitionedRangeRowLimitPerDriver = 100;\n+    private int smallPartitionedRangeRowLimitPerDriver = 500;\n \n     private int largeBroadcastMaxDistinctValuesPerDriver = 5_000;\n     private DataSize largeBroadcastMaxSizePerDriver = DataSize.of(500, KILOBYTE);\n-    private int largeBroadcastRangeRowLimitPerDriver = 50_000;\n+    private int largeBroadcastRangeRowLimitPerDriver;\n     private int largePartitionedMaxDistinctValuesPerDriver = 500;\n     private DataSize largePartitionedMaxSizePerDriver = DataSize.of(50, KILOBYTE);\n     private int largePartitionedRangeRowLimitPerDriver = 5_000;", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODIyMDg0MQ==", "url": "https://github.com/trinodb/trino/pull/5366#discussion_r498220841", "bodyText": "done", "author": "raunaqmorarka", "createdAt": "2020-10-01T12:54:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE1NjYxOA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "fef8647ab3fdbe6da1f2909b5d061625da25b09f", "url": "https://github.com/trinodb/trino/commit/fef8647ab3fdbe6da1f2909b5d061625da25b09f", "message": "Disable min/max collection for dynamic filters", "committedDate": "2020-10-01T15:22:48Z", "type": "commit"}, {"oid": "fef8647ab3fdbe6da1f2909b5d061625da25b09f", "url": "https://github.com/trinodb/trino/commit/fef8647ab3fdbe6da1f2909b5d061625da25b09f", "message": "Disable min/max collection for dynamic filters", "committedDate": "2020-10-01T15:22:48Z", "type": "forcePushed"}]}