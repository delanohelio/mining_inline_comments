{"pr_number": 4023, "pr_title": "Expose types with Parameters for DESCRIBE INPUT", "pr_createdAt": "2020-06-14T07:03:13Z", "pr_url": "https://github.com/trinodb/trino/pull/4023", "timeline": [{"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk4OTE0NA==", "url": "https://github.com/trinodb/trino/pull/4023#discussion_r439989144", "bodyText": "It looks like we are missing dedicated test for this feature. Can you please add it where you could also test other parametric types including timestamp, char and decimal?", "author": "kokosing", "createdAt": "2020-06-15T07:48:12Z", "path": "presto-tests/src/test/java/io/prestosql/tests/AbstractTestEngineOnlyQueries.java", "diffHunk": "@@ -730,7 +730,7 @@ public void testDescribeInput()\n         MaterializedResult expected = resultBuilder(session, BIGINT, VARCHAR)\n                 .row(0, \"unknown\")\n                 .row(1, \"bigint\")\n-                .row(2, \"varchar\")\n+                .row(2, \"varchar(25)\")", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE4MTI4Mw==", "url": "https://github.com/trinodb/trino/pull/4023#discussion_r440181283", "bodyText": "Thanks for your insight. Fixed it", "author": "Praveen2112", "createdAt": "2020-06-15T13:38:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk4OTE0NA=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM1NTQ3Nw==", "url": "https://github.com/trinodb/trino/pull/4023#discussion_r440355477", "bodyText": "can you have a test with  timestamp(6) as well as unbound varchar?", "author": "kokosing", "createdAt": "2020-06-15T18:09:11Z", "path": "presto-tests/src/test/java/io/prestosql/tests/AbstractTestEngineOnlyQueries.java", "diffHunk": "@@ -730,7 +730,18 @@ public void testDescribeInput()\n         MaterializedResult expected = resultBuilder(session, BIGINT, VARCHAR)\n                 .row(0, \"unknown\")\n                 .row(1, \"bigint\")\n-                .row(2, \"varchar\")\n+                .row(2, \"varchar(25)\")\n+                .build();\n+        assertEqualsIgnoreOrder(actual, expected);\n+\n+        session = Session.builder(getSession())\n+                .addPreparedStatement(\"my_query\", \"SELECT 1 from (VALUES (CHAR 'Pi', TIMESTAMP '2012-03-14 1:59:26.535', DECIMAL '3.14')) AS t (t_varchar, t_timestamp, t_decimal) WHERE t_varchar = ? AND t_timestamp = ? AND t_decimal = ?\")\n+                .build();\n+        actual = computeActual(session, \"DESCRIBE INPUT my_query\");\n+        expected = resultBuilder(session, BIGINT, VARCHAR)\n+                .row(0, \"char(2)\")\n+                .row(1, \"timestamp(3)\")", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY3NDczNg==", "url": "https://github.com/trinodb/trino/pull/4023#discussion_r440674736", "bodyText": "I have added test for timestamp and unbounded varchar", "author": "Praveen2112", "createdAt": "2020-06-16T08:25:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM1NTQ3Nw=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzAzOTk5NQ==", "url": "https://github.com/trinodb/trino/pull/4023#discussion_r443039995", "bodyText": "This is hard to read due to the length -- try to wrap it somehow", "author": "electrum", "createdAt": "2020-06-19T20:54:37Z", "path": "presto-tests/src/test/java/io/prestosql/tests/AbstractTestEngineOnlyQueries.java", "diffHunk": "@@ -730,7 +730,24 @@ public void testDescribeInput()\n         MaterializedResult expected = resultBuilder(session, BIGINT, VARCHAR)\n                 .row(0, \"unknown\")\n                 .row(1, \"bigint\")\n-                .row(2, \"varchar\")\n+                .row(2, \"varchar(25)\")\n+                .build();\n+        assertEqualsIgnoreOrder(actual, expected);\n+\n+        session = Session.builder(getSession())\n+                .addPreparedStatement(\n+                        \"my_query\",\n+                        \"SELECT 1 from \" +\n+                        \"    (VALUES (CHAR 'Pi', CAST ('PI' AS VARCHAR), TIMESTAMP '2012-03-14 1:59:26.535', TIMESTAMP '2012-03-14 1:59:26.535897', DECIMAL '3.14')) AS t (t_char, t_varchar, t_timestamp, t_timestamp_2, t_decimal) \" +", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "a6e0331a737f1ce7fcdbf21ff7be3ceaddf487f2", "url": "https://github.com/trinodb/trino/commit/a6e0331a737f1ce7fcdbf21ff7be3ceaddf487f2", "message": "Expose types with Parameters for DESCRIBE INPUT", "committedDate": "2020-06-20T14:28:42Z", "type": "commit"}, {"oid": "a6e0331a737f1ce7fcdbf21ff7be3ceaddf487f2", "url": "https://github.com/trinodb/trino/commit/a6e0331a737f1ce7fcdbf21ff7be3ceaddf487f2", "message": "Expose types with Parameters for DESCRIBE INPUT", "committedDate": "2020-06-20T14:28:42Z", "type": "forcePushed"}]}