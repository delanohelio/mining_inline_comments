{"pr_number": 2829, "pr_title": "Document query management properties", "pr_createdAt": "2020-02-13T23:36:52Z", "pr_url": "https://github.com/trinodb/trino/pull/2829", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMwNzA3Mg==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r379307072", "bodyText": "The  \"about\" at the end sounds strange to me. Is it correct?", "author": "findepi", "createdAt": "2020-02-14T08:41:13Z", "path": "presto-docs/src/main/sphinx/admin/properties.rst", "diffHunk": "@@ -116,6 +116,27 @@ Memory Management Properties\n     This is the amount of memory set aside as headroom/buffer in the JVM heap\n     for allocations that are not tracked by Presto.\n \n+\n+Query Management Properties\n+---------------------------\n+\n+``query.max-history``\n+^^^^^^^^^^^^^^^^^^^^^\n+    * **Type:** ``integer``\n+    * **Default value:** ``100``\n+\n+    The maximum amount of queries to keep in the query history to access\n+    statistics and other information about.", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMwNzEyMA==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r379307120", "bodyText": "amount -> number?", "author": "findepi", "createdAt": "2020-02-14T08:41:21Z", "path": "presto-docs/src/main/sphinx/admin/properties.rst", "diffHunk": "@@ -116,6 +116,27 @@ Memory Management Properties\n     This is the amount of memory set aside as headroom/buffer in the JVM heap\n     for allocations that are not tracked by Presto.\n \n+\n+Query Management Properties\n+---------------------------\n+\n+``query.max-history``\n+^^^^^^^^^^^^^^^^^^^^^\n+    * **Type:** ``integer``\n+    * **Default value:** ``100``\n+\n+    The maximum amount of queries to keep in the query history to access", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMwNzMyMg==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r379307322", "bodyText": "No need to document legacy property name IMO.", "author": "findepi", "createdAt": "2020-02-14T08:41:51Z", "path": "presto-docs/src/main/sphinx/admin/properties.rst", "diffHunk": "@@ -116,6 +116,27 @@ Memory Management Properties\n     This is the amount of memory set aside as headroom/buffer in the JVM heap\n     for allocations that are not tracked by Presto.\n \n+\n+Query Management Properties\n+---------------------------\n+\n+``query.max-history``\n+^^^^^^^^^^^^^^^^^^^^^\n+    * **Type:** ``integer``\n+    * **Default value:** ``100``\n+\n+    The maximum amount of queries to keep in the query history to access\n+    statistics and other information about.\n+\n+``query.min-expire-age``\n+^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+    * **Type:** ``duration``\n+    * **Default value:** ``15 min``\n+\n+    The minimal age of a query before it is expired. The supported, but legacy\n+    property name is ``query.max-age``.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMwNzQ4MA==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r379307480", "bodyText": "Also, would be good to document interaction between max-history and min-expiry-age -- which \"wins\"", "author": "findepi", "createdAt": "2020-02-14T08:42:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMwNzMyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTcwMzM4OA==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r379703388", "bodyText": "its min-expire-age btw..", "author": "mosabua", "createdAt": "2020-02-15T00:53:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMwNzMyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTcwMzc3MQ==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r379703771", "bodyText": "And in terms of interaction ... dont know. I am guessing that queries that reach their expire age get removed from history no matter if it is full or not..  and once buffer is full even younger queries queries get killed based on age. But thats just a guess... so .. is this correct? And is it really worth documenting?", "author": "mosabua", "createdAt": "2020-02-15T00:57:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMwNzMyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTcwNDAyMQ==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r379704021", "bodyText": "I added some more description for each so things should be clear imho.", "author": "mosabua", "createdAt": "2020-02-15T00:59:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTMwNzMyMg=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg1Njg3OQ==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r379856879", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                from the query history buffer.\n          \n          \n            \n                from the query history buffer and is no longer displayed in the cluster web UI.\n          \n      \n    \n    \n  \n\n?", "author": "findepi", "createdAt": "2020-02-15T21:21:13Z", "path": "presto-docs/src/main/sphinx/admin/properties.rst", "diffHunk": "@@ -116,6 +116,28 @@ Memory Management Properties\n     This is the amount of memory set aside as headroom/buffer in the JVM heap\n     for allocations that are not tracked by Presto.\n \n+\n+Query Management Properties\n+---------------------------\n+\n+``query.max-history``\n+^^^^^^^^^^^^^^^^^^^^^\n+    * **Type:** ``integer``\n+    * **Default value:** ``100``\n+\n+    The maximum number of queries to keep in the query history to provide\n+    statistics and other information. If this amount is reached, queries are\n+    removed based on age.\n+\n+``query.min-expire-age``\n+^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+    * **Type:** ``duration``\n+    * **Default value:** ``15 min``\n+\n+    The minimal age of a query before it is expired. An expired query is removed\n+    from the query history buffer.", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU1NTQwMA==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r382555400", "bodyText": "can be overridden with query_max_run_time session\n\"max run time\" is misnomer... this includes analysis, queuing & planning time as well. Of these, queuing is the most important and should be mentioned here. Or you can say this is \"max time since query creation\".", "author": "findepi", "createdAt": "2020-02-21T12:27:55Z", "path": "presto-docs/src/main/sphinx/admin/properties.rst", "diffHunk": "@@ -116,6 +116,47 @@ Memory Management Properties\n     This is the amount of memory set aside as headroom/buffer in the JVM heap\n     for allocations that are not tracked by Presto.\n \n+\n+Query Management Properties\n+---------------------------\n+\n+``query.max-execution-time``\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+    * **Type:** ``duration``\n+    * **Default value:** ``100 days``\n+\n+    The maxiumum allowed time for a query to be actively executing across the\n+    cluster on all nodes, before it is terminated.\n+\n+``query.max-run-time``\n+^^^^^^^^^^^^^^^^^^^^^^\n+\n+    * **Type:** ``duration``\n+    * **Default value:** ``100 days``\n+\n+    The maxiumum allowed time for a query to be running on the cluster, before\n+    it is terminated.", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU1NjI3NA==", "url": "https://github.com/trinodb/trino/pull/2829#discussion_r382556274", "bodyText": "can be overridden with query_max_execution_time\n\"on all nodes\" may be misleading, suggesting this is \"concurrent time\" (wall time * number of nodes); This limit is \"normal time\" (just wall time since actual execution start). Queue, analysis, planning time are excluded (of which queuing time should be mentioned here)", "author": "findepi", "createdAt": "2020-02-21T12:30:15Z", "path": "presto-docs/src/main/sphinx/admin/properties.rst", "diffHunk": "@@ -116,6 +116,47 @@ Memory Management Properties\n     This is the amount of memory set aside as headroom/buffer in the JVM heap\n     for allocations that are not tracked by Presto.\n \n+\n+Query Management Properties\n+---------------------------\n+\n+``query.max-execution-time``\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+    * **Type:** ``duration``\n+    * **Default value:** ``100 days``\n+\n+    The maxiumum allowed time for a query to be actively executing across the\n+    cluster on all nodes, before it is terminated.\n+", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0a9fcfacea0acab9745da2d815aba9d3e54bba06", "url": "https://github.com/trinodb/trino/commit/0a9fcfacea0acab9745da2d815aba9d3e54bba06", "message": "Document query management properties", "committedDate": "2020-02-21T17:26:11Z", "type": "commit"}, {"oid": "0a9fcfacea0acab9745da2d815aba9d3e54bba06", "url": "https://github.com/trinodb/trino/commit/0a9fcfacea0acab9745da2d815aba9d3e54bba06", "message": "Document query management properties", "committedDate": "2020-02-21T17:26:11Z", "type": "forcePushed"}]}