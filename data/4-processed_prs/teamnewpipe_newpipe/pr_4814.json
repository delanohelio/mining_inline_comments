{"pr_number": 4814, "pr_title": "Use view binding in fragments.", "pr_createdAt": "2020-11-06T02:07:19Z", "pr_url": "https://github.com/TeamNewPipe/NewPipe/pull/4814", "timeline": [{"oid": "f46a5f6a641182cbb3d8772e6cf73e2306ad8817", "url": "https://github.com/TeamNewPipe/NewPipe/commit/f46a5f6a641182cbb3d8772e6cf73e2306ad8817", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-11-13T06:34:28Z", "type": "forcePushed"}, {"oid": "8650962bd73b7c86eb5ddc9cd627d42215140d2b", "url": "https://github.com/TeamNewPipe/NewPipe/commit/8650962bd73b7c86eb5ddc9cd627d42215140d2b", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-11-19T02:08:07Z", "type": "forcePushed"}, {"oid": "b72885185f78c3b97301d4c136f6aed3fbd47f0e", "url": "https://github.com/TeamNewPipe/NewPipe/commit/b72885185f78c3b97301d4c136f6aed3fbd47f0e", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-11-21T07:05:53Z", "type": "forcePushed"}, {"oid": "b6876c61c0e7db08640d9526b8c25c7a10a72c4a", "url": "https://github.com/TeamNewPipe/NewPipe/commit/b6876c61c0e7db08640d9526b8c25c7a10a72c4a", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-11-21T08:10:52Z", "type": "forcePushed"}, {"oid": "93d4b1f62d84053e3e0639f52c5a352c9a8b0607", "url": "https://github.com/TeamNewPipe/NewPipe/commit/93d4b1f62d84053e3e0639f52c5a352c9a8b0607", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-11-21T09:52:11Z", "type": "forcePushed"}, {"oid": "21b90fc4813f00d2fe5e83f7896c91010bf19287", "url": "https://github.com/TeamNewPipe/NewPipe/commit/21b90fc4813f00d2fe5e83f7896c91010bf19287", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-11-23T00:50:41Z", "type": "forcePushed"}, {"oid": "6c21e33a0f25628253d536afbb6c0446973419f1", "url": "https://github.com/TeamNewPipe/NewPipe/commit/6c21e33a0f25628253d536afbb6c0446973419f1", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-11-23T01:14:32Z", "type": "forcePushed"}, {"oid": "88e459566c6dde5704c709442e1c914767775cdc", "url": "https://github.com/TeamNewPipe/NewPipe/commit/88e459566c6dde5704c709442e1c914767775cdc", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-11-28T12:47:21Z", "type": "forcePushed"}, {"oid": "cb01548851dfa42cba24128392c11b06158c552c", "url": "https://github.com/TeamNewPipe/NewPipe/commit/cb01548851dfa42cba24128392c11b06158c552c", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-12-12T23:46:41Z", "type": "forcePushed"}, {"oid": "3a0c2977875192ce9eb004c22d54a5b51af7214d", "url": "https://github.com/TeamNewPipe/NewPipe/commit/3a0c2977875192ce9eb004c22d54a5b51af7214d", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-12-15T09:01:21Z", "type": "forcePushed"}, {"oid": "53b82b00d4bc16b39aadd735865f5fa4f8b2aa40", "url": "https://github.com/TeamNewPipe/NewPipe/commit/53b82b00d4bc16b39aadd735865f5fa4f8b2aa40", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-12-16T01:01:55Z", "type": "forcePushed"}, {"oid": "b31ca51d1e1b177673536477ddcb864f6769e173", "url": "https://github.com/TeamNewPipe/NewPipe/commit/b31ca51d1e1b177673536477ddcb864f6769e173", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-12-19T01:23:19Z", "type": "forcePushed"}, {"oid": "08bb597e4defa80a4e3d7b15e8048d4326fb672c", "url": "https://github.com/TeamNewPipe/NewPipe/commit/08bb597e4defa80a4e3d7b15e8048d4326fb672c", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-12-19T07:53:39Z", "type": "forcePushed"}, {"oid": "2d6831fd61c52c3bc1b8e0a99a1d44e9618c6acf", "url": "https://github.com/TeamNewPipe/NewPipe/commit/2d6831fd61c52c3bc1b8e0a99a1d44e9618c6acf", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-12-19T23:06:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1NjQ1OA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r546356458", "bodyText": "Why are you setting binding = null here and not in onDestroyView like all other fragments?\n(unrelated to this PR, just a note for the future) pagerAdapter should be set to null here, as LeakCanary reports it as leaking.", "author": "Stypox", "createdAt": "2020-12-20T10:27:36Z", "path": "app/src/main/java/org/schabi/newpipe/fragments/MainFragment.java", "diffHunk": "@@ -120,8 +117,9 @@ public void onResume() {\n     public void onDestroy() {\n         super.onDestroy();\n         tabsManager.unsetSavedTabsListener();\n-        if (viewPager != null) {\n-            viewPager.setAdapter(null);\n+        if (binding != null) {\n+            binding.pager.setAdapter(null);\n+            binding = null;", "originalCommit": "2d6831fd61c52c3bc1b8e0a99a1d44e9618c6acf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI1MDEzNw==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r547250137", "bodyText": "Because the pager adapter is being set to null in that method, and the onDestroyView method is called before onDestroy: https://developer.android.com/guide/fragments/lifecycle.", "author": "Isira-Seneviratne", "createdAt": "2020-12-22T12:28:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1NjQ1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI1MzgwMQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r547253801", "bodyText": "That logic should be in onDestroyView, since the view gets re-created all the time.\nonDestroy happens when the fragment is killed, what does that mean?\nonDestroyView is called everytime whilst onDestroy isn't.\nYou should move it to onDestroyView", "author": "FunkyMuse", "createdAt": "2020-12-22T12:36:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1NjQ1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI1NzUxOA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r547257518", "bodyText": "Okay.", "author": "Isira-Seneviratne", "createdAt": "2020-12-22T12:45:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1NjQ1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1Nzc2NQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r546357765", "bodyText": "Can't you just make them lateinit to prevent having to use asserting getters? Though I have little experience in Kotlin, so I may be wrong ;-)", "author": "Stypox", "createdAt": "2020-12-20T10:38:40Z", "path": "app/src/main/java/org/schabi/newpipe/local/feed/FeedFragment.kt", "diffHunk": "@@ -57,6 +49,12 @@ import org.schabi.newpipe.util.Localization\n import java.util.Calendar\n \n class FeedFragment : BaseListFragment<FeedState, Unit>() {\n+    private var _feedBinding: FragmentFeedBinding? = null\n+    private val feedBinding get() = _feedBinding!!", "originalCommit": "2d6831fd61c52c3bc1b8e0a99a1d44e9618c6acf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI1MDUyOA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r547250528", "bodyText": "lateinit variables can't have null assigned to them, and the variable needs to be set to null to allow the binding to be garbage collected: https://developer.android.com/topic/libraries/view-binding#fragments.", "author": "Isira-Seneviratne", "createdAt": "2020-12-22T12:29:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1Nzc2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI3NTUwMg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r547275502", "bodyText": "Ok, I see", "author": "Stypox", "createdAt": "2020-12-22T13:24:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1Nzc2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1NzkyMw==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r546357923", "bodyText": "Why are you not using feedBinding.loadingProgressText. here and below?", "author": "Stypox", "createdAt": "2020-12-20T10:40:05Z", "path": "app/src/main/java/org/schabi/newpipe/local/feed/FeedFragment.kt", "diffHunk": "@@ -237,33 +243,34 @@ class FeedFragment : BaseListFragment<FeedState, Unit>() {\n             progressState.maxProgress == -1\n \n         if (!isIndeterminate) {\n-            loading_progress_text.text = \"${progressState.currentProgress}/${progressState.maxProgress}\"\n+            feedBinding.loadingProgressText.text = \"${progressState.currentProgress}/${progressState.maxProgress}\"\n         } else if (progressState.progressMessage > 0) {\n-            loading_progress_text?.setText(progressState.progressMessage)\n+            _feedBinding?.loadingProgressText?.setText(progressState.progressMessage)", "originalCommit": "2d6831fd61c52c3bc1b8e0a99a1d44e9618c6acf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzI1MTAwNQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r547251005", "bodyText": "I was getting a NullPointerException when using the non-null feedBinding property.", "author": "Isira-Seneviratne", "createdAt": "2020-12-22T12:30:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1NzkyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM1ODAzMA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4814#discussion_r546358030", "bodyText": "Also here and in other places", "author": "Stypox", "createdAt": "2020-12-20T10:41:09Z", "path": "app/src/main/java/org/schabi/newpipe/local/subscription/SubscriptionFragment.kt", "diffHunk": "@@ -70,6 +70,9 @@ import kotlin.math.floor\n import kotlin.math.max\n \n class SubscriptionFragment : BaseStateFragment<SubscriptionState>() {\n+    private var _binding: FragmentSubscriptionBinding? = null\n+    private val binding get() = _binding!!", "originalCommit": "2d6831fd61c52c3bc1b8e0a99a1d44e9618c6acf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c8baef048092a58e88e79151ce056c48f390c18b", "url": "https://github.com/TeamNewPipe/NewPipe/commit/c8baef048092a58e88e79151ce056c48f390c18b", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-12-22T12:47:06Z", "type": "forcePushed"}, {"oid": "8735de7f6eebea8b5c48c3557568dcf4537022ce", "url": "https://github.com/TeamNewPipe/NewPipe/commit/8735de7f6eebea8b5c48c3557568dcf4537022ce", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2020-12-24T00:02:36Z", "type": "forcePushed"}, {"oid": "0e2e4dbcde79404dcc9fd71fc8db3d0d04700b3e", "url": "https://github.com/TeamNewPipe/NewPipe/commit/0e2e4dbcde79404dcc9fd71fc8db3d0d04700b3e", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2021-01-02T03:53:32Z", "type": "forcePushed"}, {"oid": "98be89a20ac833bf9ec7af55e8d71ea8c0477766", "url": "https://github.com/TeamNewPipe/NewPipe/commit/98be89a20ac833bf9ec7af55e8d71ea8c0477766", "message": "Return ViewBinding instead of View in BaseLocalListFragment's getListHeader() and getListFooter() methods.", "committedDate": "2021-01-14T05:45:54Z", "type": "commit"}, {"oid": "979102a2d932cd17ce58d367244c6c906dcc81a8", "url": "https://github.com/TeamNewPipe/NewPipe/commit/979102a2d932cd17ce58d367244c6c906dcc81a8", "message": "Return ViewBinding instead of View in BaseListFragment's getListHeader() and getListFooter() methods.", "committedDate": "2021-01-14T05:45:57Z", "type": "commit"}, {"oid": "910d22daa6dcccdb6b21213ab02da1eed1842047", "url": "https://github.com/TeamNewPipe/NewPipe/commit/910d22daa6dcccdb6b21213ab02da1eed1842047", "message": "Use view binding in MainFragment.", "committedDate": "2021-01-14T05:45:58Z", "type": "commit"}, {"oid": "7c581ec108e84fa4c15b720520a0004dd3ed88b7", "url": "https://github.com/TeamNewPipe/NewPipe/commit/7c581ec108e84fa4c15b720520a0004dd3ed88b7", "message": "Use view binding in LicenseFragment.", "committedDate": "2021-01-14T05:46:00Z", "type": "commit"}, {"oid": "7682ebd245a55261e2c5737f305d35b2ab37d441", "url": "https://github.com/TeamNewPipe/NewPipe/commit/7682ebd245a55261e2c5737f305d35b2ab37d441", "message": "Use view binding in DownloadDialog.", "committedDate": "2021-01-14T05:46:01Z", "type": "commit"}, {"oid": "6039484a02bda6eeef9633c46fd5edfc4eb6311d", "url": "https://github.com/TeamNewPipe/NewPipe/commit/6039484a02bda6eeef9633c46fd5edfc4eb6311d", "message": "Use view binding in ChannelFragment.", "committedDate": "2021-01-14T05:46:03Z", "type": "commit"}, {"oid": "97672f06de29fb5f5def106a03fcc5d9c8ce938d", "url": "https://github.com/TeamNewPipe/NewPipe/commit/97672f06de29fb5f5def106a03fcc5d9c8ce938d", "message": "Use view binding in SearchFragment.", "committedDate": "2021-01-14T05:46:04Z", "type": "commit"}, {"oid": "f80e1bd214ca7db29d58229a2428dc8b82533e08", "url": "https://github.com/TeamNewPipe/NewPipe/commit/f80e1bd214ca7db29d58229a2428dc8b82533e08", "message": "Use view binding in FeedFragment.", "committedDate": "2021-01-14T05:46:05Z", "type": "commit"}, {"oid": "83f33a7d1b45b4378de197f490542628a4413274", "url": "https://github.com/TeamNewPipe/NewPipe/commit/83f33a7d1b45b4378de197f490542628a4413274", "message": "Use view binding in SubscriptionFragment.", "committedDate": "2021-01-14T05:46:06Z", "type": "commit"}, {"oid": "5994cd8ea24c1216a771a99258bafc7ffd846675", "url": "https://github.com/TeamNewPipe/NewPipe/commit/5994cd8ea24c1216a771a99258bafc7ffd846675", "message": "Use view binding in FeedGroupDialog.", "committedDate": "2021-01-14T05:46:07Z", "type": "commit"}, {"oid": "f04b5fd42f493df0dc6b35c8c45b3b498f4ef9f5", "url": "https://github.com/TeamNewPipe/NewPipe/commit/f04b5fd42f493df0dc6b35c8c45b3b498f4ef9f5", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2021-01-14T05:46:08Z", "type": "commit"}, {"oid": "f04b5fd42f493df0dc6b35c8c45b3b498f4ef9f5", "url": "https://github.com/TeamNewPipe/NewPipe/commit/f04b5fd42f493df0dc6b35c8c45b3b498f4ef9f5", "message": "Use view binding in FeedGroupReorderDialog.", "committedDate": "2021-01-14T05:46:08Z", "type": "forcePushed"}]}