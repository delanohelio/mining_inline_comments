{"pr_number": 3909, "pr_title": "Deprecations and cleanup", "pr_createdAt": "2020-07-19T04:38:34Z", "pr_url": "https://github.com/TeamNewPipe/NewPipe/pull/3909", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNDgxMA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478414810", "bodyText": "No need for the double (( and ))", "author": "wb9688", "createdAt": "2020-08-27T13:22:22Z", "path": "app/src/main/java/org/schabi/newpipe/util/TLSSocketFactoryCompat.java", "diffHunk": "@@ -106,7 +106,7 @@ public Socket createSocket(final InetAddress address, final int port,\n     }\n \n     private Socket enableTLSOnSocket(final Socket socket) {\n-        if (socket != null && (socket instanceof SSLSocket)) {\n+        if ((socket instanceof SSLSocket)) {", "originalCommit": "0e8964227bcf437e2d701f41ff0b575c5f4cb678", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY1MTY1OA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478651658", "bodyText": "Whoops.", "author": "TacoTheDank", "createdAt": "2020-08-27T19:39:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNDgxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNDk5Mw==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478414993", "bodyText": "Why was this changed?", "author": "wb9688", "createdAt": "2020-08-27T13:22:40Z", "path": "app/src/main/java/org/schabi/newpipe/RouterActivity.java", "diffHunk": "@@ -572,7 +568,7 @@ private String trim(final String input) {\n                 }\n             }\n         }\n-        return result.toArray(new String[result.size()]);\n+        return result.toArray(new String[0]);", "originalCommit": "0e8964227bcf437e2d701f41ff0b575c5f4cb678", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY1MTQyMg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478651422", "bodyText": "", "author": "TacoTheDank", "createdAt": "2020-08-27T19:38:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNDk5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY1Mjk4Mg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478652982", "bodyText": "Oh, OK", "author": "wb9688", "createdAt": "2020-08-27T19:41:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNDk5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNTA2MQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478415061", "bodyText": "Why was this changed?", "author": "wb9688", "createdAt": "2020-08-27T13:22:46Z", "path": "app/src/main/java/org/schabi/newpipe/player/resolver/VideoPlaybackResolver.java", "diffHunk": "@@ -115,7 +115,7 @@ public MediaSource resolve(@NonNull final StreamInfo info) {\n             return mediaSources.get(0);\n         } else {\n             return new MergingMediaSource(mediaSources.toArray(\n-                    new MediaSource[mediaSources.size()]));\n+                    new MediaSource[0]));", "originalCommit": "0e8964227bcf437e2d701f41ff0b575c5f4cb678", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY1MTQ2OA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r478651468", "bodyText": "See above.", "author": "TacoTheDank", "createdAt": "2020-08-27T19:38:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQxNTA2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMDUzMg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483110532", "bodyText": "Heads up @friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:33:59Z", "path": "app/src/main/java/org/schabi/newpipe/player/MainPlayer.java", "diffHunk": "@@ -307,9 +307,7 @@ void resetNotification() {\n             setLockScreenThumbnail(builder);\n         }\n \n-        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.JELLY_BEAN) {\n-            builder.setPriority(NotificationCompat.PRIORITY_MAX);\n-        }\n+        builder.setPriority(NotificationCompat.PRIORITY_MAX);", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMDgyMg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483110822", "bodyText": "Heads up @friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:34:27Z", "path": "app/src/main/java/org/schabi/newpipe/player/helper/PlayerHelper.java", "diffHunk": "@@ -303,10 +302,6 @@ public static int getTossFlingVelocity(@NonNull final Context context) {\n \n     @NonNull\n     public static CaptionStyleCompat getCaptionStyle(@NonNull final Context context) {\n-        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.KITKAT) {\n-            return CaptionStyleCompat.DEFAULT;\n-        }", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMDk3NA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483110974", "bodyText": "Heads up @friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:34:41Z", "path": "app/src/main/java/org/schabi/newpipe/player/helper/PlayerHelper.java", "diffHunk": "@@ -331,10 +326,6 @@ public static CaptionStyleCompat getCaptionStyle(@NonNull final Context context)\n      * @return caption scaling\n      */\n     public static float getCaptionScale(@NonNull final Context context) {\n-        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.KITKAT) {\n-            return 1f;\n-        }", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMTMxMg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483111312", "bodyText": "@friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:35:13Z", "path": "app/src/main/java/org/schabi/newpipe/util/PermissionHelper.java", "diffHunk": "@@ -26,10 +26,8 @@\n     private PermissionHelper() { }\n \n     public static boolean checkStoragePermissions(final Activity activity, final int requestCode) {\n-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n-            if (!checkReadStoragePermissions(activity, requestCode)) {\n-                return false;\n-            }\n+        if (!checkReadStoragePermissions(activity, requestCode)) {\n+            return false;", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExMTcxNQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483111715", "bodyText": "Heads up @friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:35:49Z", "path": "app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java", "diffHunk": "@@ -1105,7 +1105,7 @@ private void openBackgroundPlayer(final boolean append) {\n             player.toggleFullscreen();\n         }\n \n-        if (!useExternalAudioPlayer && android.os.Build.VERSION.SDK_INT >= 16) {\n+        if (!useExternalAudioPlayer) {", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExNjU2NA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483116564", "bodyText": "@friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:43:36Z", "path": "app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java", "diffHunk": "@@ -1302,16 +1302,9 @@ private void prepareDescription(final Description description) {\n \n         if (description.getType() == Description.HTML) {\n             disposables.add(Single.just(description.getContent())\n-                    .map((@NonNull String descriptionText) -> {\n-                        final Spanned parsedDescription;\n-                        if (Build.VERSION.SDK_INT >= 24) {\n-                            parsedDescription = Html.fromHtml(descriptionText, 0);\n-                        } else {\n-                            //noinspection deprecation\n-                            parsedDescription = Html.fromHtml(descriptionText);\n-                        }\n-                        return parsedDescription;\n-                    })\n+                    .map((@NonNull String descriptionText) ->\n+                            HtmlCompat.fromHtml(descriptionText,\n+                                    HtmlCompat.FROM_HTML_MODE_LEGACY))", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExNzU2MA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483117560", "bodyText": "@friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:45:11Z", "path": "app/src/main/java/org/schabi/newpipe/player/VideoPlayer.java", "diffHunk": "@@ -476,11 +474,8 @@ public void onPlaying() {\n         showAndAnimateControl(-1, true);\n \n         playbackSeekBar.setEnabled(true);\n-        // Bug on lower api, disabling and enabling the seekBar resets the thumb color -.-,\n-        // so sets the color again\n-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n-            playbackSeekBar.getThumb().setColorFilter(Color.RED, PorterDuff.Mode.SRC_IN);\n-        }\n+        playbackSeekBar.getThumb()\n+                .setColorFilter(new PorterDuffColorFilter(Color.RED, PorterDuff.Mode.SRC_IN));", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExNzcyMA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483117720", "bodyText": "@friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:45:26Z", "path": "app/src/main/java/org/schabi/newpipe/player/VideoPlayer.java", "diffHunk": "@@ -456,11 +457,8 @@ public void onBlocked() {\n         animateView(controlsRoot, false, DEFAULT_CONTROLS_DURATION);\n \n         playbackSeekBar.setEnabled(false);\n-        // Bug on lower api, disabling and enabling the seekBar resets the thumb color -.-,\n-        // so sets the color again\n-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n-            playbackSeekBar.getThumb().setColorFilter(Color.RED, PorterDuff.Mode.SRC_IN);\n-        }\n+        playbackSeekBar.getThumb()\n+                .setColorFilter(new PorterDuffColorFilter(Color.RED, PorterDuff.Mode.SRC_IN));", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExNzkxMQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483117911", "bodyText": "@friendlyanon", "author": "TobiGr", "createdAt": "2020-09-03T16:45:47Z", "path": "app/src/main/java/org/schabi/newpipe/player/VideoPlayer.java", "diffHunk": "@@ -210,18 +211,18 @@ public void initViews(final View view) {\n \n         this.captionTextView = view.findViewById(R.id.captionTextView);\n \n-        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n-            playbackSeekBar.getThumb().setColorFilter(Color.RED, PorterDuff.Mode.SRC_IN);\n-        }\n-        this.playbackSeekBar.getProgressDrawable().\n-                setColorFilter(Color.RED, PorterDuff.Mode.MULTIPLY);\n+        playbackSeekBar.getThumb()\n+                .setColorFilter(new PorterDuffColorFilter(Color.RED, PorterDuff.Mode.SRC_IN));", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzExODkyNw==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3909#discussion_r483118927", "bodyText": "@friendlyanon StandardCharsets was added with API 19", "author": "TobiGr", "createdAt": "2020-09-03T16:47:40Z", "path": "app/src/main/java/org/schabi/newpipe/streams/Mp4DashReader.java", "diffHunk": "@@ -259,11 +259,7 @@ private String boxName(final Box ref) {\n     }\n \n     private String boxName(final int type) {\n-        try {\n-            return new String(ByteBuffer.allocate(4).putInt(type).array(), \"UTF-8\");\n-        } catch (final UnsupportedEncodingException e) {\n-            return \"0x\" + Integer.toHexString(type);\n-        }\n+        return new String(ByteBuffer.allocate(4).putInt(type).array(), StandardCharsets.UTF_8);", "originalCommit": "1da206363eee8acd4ab2a2d325f84cdcdcacf31e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "79e2bb382f83b8fe53c261cf482735ae0df30b7b", "url": "https://github.com/TeamNewPipe/NewPipe/commit/79e2bb382f83b8fe53c261cf482735ae0df30b7b", "message": "Update ExoPlayer, OkHttp, use Kotlin JDK8", "committedDate": "2020-09-06T10:48:35Z", "type": "commit"}, {"oid": "ba6c7de35a87c92f65a3b5d9f0f65d3c0aaa22c7", "url": "https://github.com/TeamNewPipe/NewPipe/commit/ba6c7de35a87c92f65a3b5d9f0f65d3c0aaa22c7", "message": "Use AndroidX preference", "committedDate": "2020-09-06T10:52:42Z", "type": "commit"}, {"oid": "a4feb3fc09b734d4365bc498ed0289c7dc3558cf", "url": "https://github.com/TeamNewPipe/NewPipe/commit/a4feb3fc09b734d4365bc498ed0289c7dc3558cf", "message": "Fix some deprecations", "committedDate": "2020-09-06T10:52:43Z", "type": "commit"}, {"oid": "6cb16be5dfad60d0d5333d6b789affdd524a73af", "url": "https://github.com/TeamNewPipe/NewPipe/commit/6cb16be5dfad60d0d5333d6b789affdd524a73af", "message": "Use enhanced 'for' loops", "committedDate": "2020-09-06T10:52:43Z", "type": "commit"}, {"oid": "273c287fbf7c6306ab6f3b4ec15be7dbf63b6bbd", "url": "https://github.com/TeamNewPipe/NewPipe/commit/273c287fbf7c6306ab6f3b4ec15be7dbf63b6bbd", "message": "Fix some lambdas", "committedDate": "2020-09-06T10:52:43Z", "type": "commit"}, {"oid": "f86b40302d35915ed9d058de6d37a2ba291117da", "url": "https://github.com/TeamNewPipe/NewPipe/commit/f86b40302d35915ed9d058de6d37a2ba291117da", "message": "Some general-purpose lint cleanup", "committedDate": "2020-09-06T10:55:26Z", "type": "commit"}, {"oid": "6c5ef567edecbc084aa6919fdeea21b757ed1b3a", "url": "https://github.com/TeamNewPipe/NewPipe/commit/6c5ef567edecbc084aa6919fdeea21b757ed1b3a", "message": "Replace deprecated Html#fromHtml with HtmlCompat#fromHtml", "committedDate": "2020-09-06T10:55:30Z", "type": "commit"}, {"oid": "06d54ef77ea33117237cd89aa5fc10fc4d2a0e23", "url": "https://github.com/TeamNewPipe/NewPipe/commit/06d54ef77ea33117237cd89aa5fc10fc4d2a0e23", "message": "Clean up SDK version checks", "committedDate": "2020-09-06T10:55:30Z", "type": "commit"}, {"oid": "5b631e0387140a396ce2d1f465a0d04366b004bf", "url": "https://github.com/TeamNewPipe/NewPipe/commit/5b631e0387140a396ce2d1f465a0d04366b004bf", "message": "Revert to deprecated BEHAVIOR_SET_USER_VISIBLE_HINT in TabAdapter\n\nAlso added comment explaining why", "committedDate": "2020-09-06T12:02:25Z", "type": "commit"}]}