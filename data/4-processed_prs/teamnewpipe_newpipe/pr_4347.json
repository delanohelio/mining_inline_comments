{"pr_number": 4347, "pr_title": "Player rebind", "pr_createdAt": "2020-09-29T03:38:48Z", "pr_url": "https://github.com/TeamNewPipe/NewPipe/pull/4347", "timeline": [{"oid": "c1d5a5cd987104b93b8b952bf318cde24e0314bb", "url": "https://github.com/TeamNewPipe/NewPipe/commit/c1d5a5cd987104b93b8b952bf318cde24e0314bb", "message": "Player will be rebound when needed, prev/next/queue buttons, preserving paused state\n- each time something starts to play in any player VideoDetailFragment will be started (if not yet started) and mini player will show up. It makes possible to see a playing stream in mini player even if the stream was started without using fragment or after player service was closed somehow\n- play/next/queue buttons will be updated in realtime when stream was added/removed from queue instead of waiting for a onPlay/onPause action to happen\n- when popup or background players start the stream will start playing only if paused state wasn't requested. Which means, for example, if a user opens popup it will be started when START_PAUSED is false. If, for example, the stream was played in main player and then popup was started the stream will still be playing, but if it was paused it still be paused in popup (or background) in APPEND_ONLY mode (but will be playing on new queue initialization)", "committedDate": "2020-09-29T03:22:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcxMzMzMQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4347#discussion_r496713331", "bodyText": "I'd call this newCollapsedInstance", "author": "Stypox", "createdAt": "2020-09-29T13:24:47Z", "path": "app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java", "diffHunk": "@@ -302,6 +304,12 @@ public static VideoDetailFragment getInstance(final int serviceId, final String\n         return instance;\n     }\n \n+    public static VideoDetailFragment getInstanceCollapsed() {", "originalCommit": "c1d5a5cd987104b93b8b952bf318cde24e0314bb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA4MjgwOQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4347#discussion_r497082809", "bodyText": "new means that can be another instance, but it's not possible here. Instance can not be collapsed. So I just named it getInstanceInCollapsedState. Ok?", "author": "avently", "createdAt": "2020-09-29T21:53:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcxMzMzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcxNjM2MA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4347#discussion_r496716360", "bodyText": "Could you add a comment explaining what this piece of code does?\nIs the following interpretation correct? \"If a player is started when there is no VideoDetailFragment active, the bottom sheet is initialized.\"", "author": "Stypox", "createdAt": "2020-09-29T13:28:47Z", "path": "app/src/main/java/org/schabi/newpipe/MainActivity.java", "diffHunk": "@@ -795,9 +802,24 @@ private void handleIntent(final Intent intent) {\n             ErrorActivity.reportUiError(this, e);\n         }\n     }\n-    /*\n-     * Utils\n-     * */\n+\n+    private void setupBroadcastReceiver() {\n+        broadcastReceiver = new BroadcastReceiver() {\n+            @Override\n+            public void onReceive(final Context context, final Intent intent) {\n+                if (intent.getAction().equals(VideoDetailFragment.ACTION_PLAYER_STARTED)) {\n+                    final Fragment fragmentPlayer = getSupportFragmentManager()\n+                            .findFragmentById(R.id.fragment_player_holder);\n+                    if (fragmentPlayer == null) {\n+                        NavigationHelper.showMiniPlayer(getSupportFragmentManager());\n+                    }", "originalCommit": "c1d5a5cd987104b93b8b952bf318cde24e0314bb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA4MzA4OQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/4347#discussion_r497083089", "bodyText": "Added comments with some contextual explanation", "author": "avently", "createdAt": "2020-09-29T21:54:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcxNjM2MA=="}], "type": "inlineReview"}, {"oid": "6665d630ec7e104e35514e85a0b79376584cda3a", "url": "https://github.com/TeamNewPipe/NewPipe/commit/6665d630ec7e104e35514e85a0b79376584cda3a", "message": "Added comments and improved the code", "committedDate": "2020-09-29T21:49:34Z", "type": "commit"}]}