{"pr_number": 1240, "pr_title": "X-wso2-basepath support for Api definition", "pr_createdAt": "2020-05-20T14:20:35Z", "pr_url": "https://github.com/wso2/product-microgateway/pull/1240", "timeline": [{"oid": "24cdcb15d1227297db2df1b69f89fc85b8098fc7", "url": "https://github.com/wso2/product-microgateway/commit/24cdcb15d1227297db2df1b69f89fc85b8098fc7", "message": "implement support of x-wso2-basepath", "committedDate": "2020-05-19T20:21:22Z", "type": "commit"}, {"oid": "e049a17a008110372bc950e7164224443d87c192", "url": "https://github.com/wso2/product-microgateway/commit/e049a17a008110372bc950e7164224443d87c192", "message": "fix bug x-wso2basepath path regex rewrite", "committedDate": "2020-05-20T08:03:44Z", "type": "commit"}, {"oid": "47273acc1412bb5fa35485a8f9e2954da1222220", "url": "https://github.com/wso2/product-microgateway/commit/47273acc1412bb5fa35485a8f9e2954da1222220", "message": "add hostrewrite to avoid bad requests", "committedDate": "2020-05-20T13:49:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA2NzQ1Mg==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r428067452", "bodyText": "Remove these empty lines", "author": "menakaj", "createdAt": "2020-05-20T14:40:17Z", "path": "internal/pkg/oasparser/models/apiDefinition/openApi.go", "diffHunk": "@@ -126,3 +126,5 @@ func IsServerUrlIsAvailable(swagger3 openapi3.Swagger) bool {\n \t}\n }\n \n+\n+", "originalCommit": "47273acc1412bb5fa35485a8f9e2954da1222220", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA2ODEwMQ==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r428068101", "bodyText": "These should be taken from a configuration file.", "author": "menakaj", "createdAt": "2020-05-20T14:41:08Z", "path": "internal/pkg/oasparser/config/config.go", "diffHunk": "@@ -23,5 +23,5 @@ const (\n \tLISTENER_PORT     uint32 = 10000\n \tAPI_DEFAULT_PORT   uint32 = 8080\n \tMANAGER_STATPREFIX    string = \"ingress_http\"\n-\tCLUSTER_CONNECT_TIMEOUT    = 5 * time.Second\n+\tCLUSTER_CONNECT_TIMEOUT    = 20 * time.Second", "originalCommit": "47273acc1412bb5fa35485a8f9e2954da1222220", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4MjY0Mg==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r428082642", "bodyText": "that means config.toml ?  so everything should be moved to config.toml ?", "author": "chashikajw", "createdAt": "2020-05-20T14:59:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA2ODEwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODIzNTQ5NA==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r428235494", "bodyText": "Need to move configurations that should be done by users. Like Listener port, connection timeout etc.\nWe can keep a default value and use it if not configured.", "author": "menakaj", "createdAt": "2020-05-20T18:48:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA2ODEwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ4ODM5Mg==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r428488392", "bodyText": "done", "author": "chashikajw", "createdAt": "2020-05-21T07:22:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA2ODEwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA2ODQzOA==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r428068438", "bodyText": "Remove unnecessary lines. Fix in other places as well.", "author": "menakaj", "createdAt": "2020-05-20T14:41:33Z", "path": "internal/pkg/oasparser/configGenerator.go", "diffHunk": "@@ -51,20 +51,28 @@ func GetProductionSources(location string) ([]types.Resource, []types.Resource,\n \t\tendpointsP = append(endpointsP,endpoints...)\n \t}\n \n-\tvHost_NameP := \"serviceProd_\" + strings.Replace(mgwSwaggers[0].GetTitle(), \" \", \"\", -1) + mgwSwaggers[0].GetVersion()\n+\tenvoyNodeProd := new(envoy.EnvoyNode)\n \n-\tvHostP, _ := e.CreateVirtualHost(vHost_NameP, routesP)\n+\tif len(mgwSwaggers) > 0 {\n+\t\tvHost_NameP := \"serviceProd_\" + strings.Replace(mgwSwaggers[0].GetTitle(), \" \", \"\", -1) + mgwSwaggers[0].GetVersion()\n \n-\tlistenerNameP := \"listenerProd_1\"\n-\trouteConfigNameP := \"routeProd_\" + strings.Replace(mgwSwaggers[0].GetTitle(), \" \", \"\", -1) + mgwSwaggers[0].GetVersion()\n+\t\tvHostP, _ := e.CreateVirtualHost(vHost_NameP, routesP)\n \n-\tlistnerProd := e.CreateListener(listenerNameP, routeConfigNameP, vHostP)\n+\t\tlistenerNameP := \"listenerProd_1\"\n+\t\trouteConfigNameP := \"routeProd_\" + strings.Replace(mgwSwaggers[0].GetTitle(), \" \", \"\", -1) + mgwSwaggers[0].GetVersion()\n+\n+\t\tlistnerProd := e.CreateListener(listenerNameP, routeConfigNameP, vHostP)\n+\n+", "originalCommit": "47273acc1412bb5fa35485a8f9e2954da1222220", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODQ4ODQ0MA==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r428488440", "bodyText": "done", "author": "chashikajw", "createdAt": "2020-05-21T07:22:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA2ODQzOA=="}], "type": "inlineReview"}, {"oid": "7e6ee1cd96a052633d185da4b33ffc9ce01772aa", "url": "https://github.com/wso2/product-microgateway/commit/7e6ee1cd96a052633d185da4b33ffc9ce01772aa", "message": "add project level config reader and set envoy configs", "committedDate": "2020-05-21T07:04:27Z", "type": "commit"}, {"oid": "9e148ecf6679b50a0483070077bddb0f29b9c2f7", "url": "https://github.com/wso2/product-microgateway/commit/9e148ecf6679b50a0483070077bddb0f29b9c2f7", "message": "add new line at the end of files", "committedDate": "2020-05-21T07:37:01Z", "type": "commit"}, {"oid": "8c841c5f7cab1e026b3ae47085b5735a4e72ba4d", "url": "https://github.com/wso2/product-microgateway/commit/8c841c5f7cab1e026b3ae47085b5735a4e72ba4d", "message": "avoid conflicting path for paths which not have path parameters", "committedDate": "2020-05-22T07:45:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NjYyNzkyNQ==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r566627925", "bodyText": "Add the license header.", "author": "pubudu538", "createdAt": "2021-01-29T07:34:15Z", "path": "config/tomlConfigParser.go", "diffHunk": "@@ -0,0 +1,36 @@\n+package config", "originalCommit": "8c841c5f7cab1e026b3ae47085b5735a4e72ba4d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTQ1NTI1NA==", "url": "https://github.com/wso2/product-microgateway/pull/1240#discussion_r569455254", "bodyText": "This is already fixed", "author": "chashikajw", "createdAt": "2021-02-03T14:24:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NjYyNzkyNQ=="}], "type": "inlineReview"}]}