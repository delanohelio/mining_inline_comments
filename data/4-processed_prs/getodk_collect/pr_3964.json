{"pr_number": 3964, "pr_title": "Add support for combination of minimal and autocomplete appearances", "pr_createdAt": "2020-07-09T15:42:55Z", "pr_url": "https://github.com/getodk/collect/pull/3964", "timeline": [{"oid": "e612ecefe47b73a2e7d72a3cb65af8939ee148d1", "url": "https://github.com/getodk/collect/commit/e612ecefe47b73a2e7d72a3cb65af8939ee148d1", "message": "Improved tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "c011d64ebed3a3e5779f581e3ca6085f82933590", "url": "https://github.com/getodk/collect/commit/c011d64ebed3a3e5779f581e3ca6085f82933590", "message": "Fixed readonly in select minimal widgets", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "d2a1db6543aff1e8a0f35a2e060238a2f3331217", "url": "https://github.com/getodk/collect/commit/d2a1db6543aff1e8a0f35a2e060238a2f3331217", "message": "Show searchbar only if autocomplete appearance is used", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "f9e0045d9e343bcfb1f345ede180b5d966d00398", "url": "https://github.com/getodk/collect/commit/f9e0045d9e343bcfb1f345ede180b5d966d00398", "message": "Fixed NPE in no-buttons appearances", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "f8def70be16e642bd098dafed7f290c6c9176ec5", "url": "https://github.com/getodk/collect/commit/f8def70be16e642bd098dafed7f290c6c9176ec5", "message": "Removed unused code", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "ce20748bdc3526ac228efbd49364174628c38573", "url": "https://github.com/getodk/collect/commit/ce20748bdc3526ac228efbd49364174628c38573", "message": "Reworked using listeners", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "b9c712d19e8eaefad53f94673eb9a8ef6d55e5ff", "url": "https://github.com/getodk/collect/commit/b9c712d19e8eaefad53f94673eb9a8ef6d55e5ff", "message": "Added tests to SelectOneMinimalWidgetTest", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "be668371b30db7fef5fbada903fd2779e8c22b24", "url": "https://github.com/getodk/collect/commit/be668371b30db7fef5fbada903fd2779e8c22b24", "message": "Added tests for select minimal widgets", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "ff604a576caaa3915e7b703bc171eddc5a991899", "url": "https://github.com/getodk/collect/commit/ff604a576caaa3915e7b703bc171eddc5a991899", "message": "Fixed clearing answers in SelectMultiMinimalWidget", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "c79f83bed4c95a69df7ffd2e90f2f27500a0ea3f", "url": "https://github.com/getodk/collect/commit/c79f83bed4c95a69df7ffd2e90f2f27500a0ea3f", "message": "Added ChoicesRecyclerViewTest", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "b91abf0a7c942e696876add99a6834813b091ac0", "url": "https://github.com/getodk/collect/commit/b91abf0a7c942e696876add99a6834813b091ac0", "message": "Improved padding in SelectMinimalWidget answer", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "f31dc22645cefd315b22584a5467635f076b1e8b", "url": "https://github.com/getodk/collect/commit/f31dc22645cefd315b22584a5467635f076b1e8b", "message": "Naming improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "e3096ac6a8c56761890c3dadd2aea72d957a8acd", "url": "https://github.com/getodk/collect/commit/e3096ac6a8c56761890c3dadd2aea72d957a8acd", "message": "Updated androidx.appcompat:appcompat to 1.2.0-rc02 insetad of alpha", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "d0d59849fe25efb750cae16c27fd3cdf375d1a13", "url": "https://github.com/getodk/collect/commit/d0d59849fe25efb750cae16c27fd3cdf375d1a13", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "e3b69c5175c613af6d9d8f48b4aa03c99a6d5fd0", "url": "https://github.com/getodk/collect/commit/e3b69c5175c613af6d9d8f48b4aa03c99a6d5fd0", "message": "Removed redundant populateRecyclerView() calls", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "b1d1f94810e786cf75bfc9f23f60a6898917f17c", "url": "https://github.com/getodk/collect/commit/b1d1f94810e786cf75bfc9f23f60a6898917f17c", "message": "Moved items widget to one package", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "fae36ccf876fcf23de0d85c51270b7a708736666", "url": "https://github.com/getodk/collect/commit/fae36ccf876fcf23de0d85c51270b7a708736666", "message": "Replaced bothClickingRadioButtonAndImage_shouldSelectItem espresso tests with robolectric", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "bc6271424927fc938ef5620175e8573ee89c42f6", "url": "https://github.com/getodk/collect/commit/bc6271424927fc938ef5620175e8573ee89c42f6", "message": "Moved tests that check displayed items and filtering to robolectric", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "d428de69878f29a4a34325f8477eb057f20b8548", "url": "https://github.com/getodk/collect/commit/d428de69878f29a4a34325f8477eb057f20b8548", "message": "Moved testing quick appearance to robolectric", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "d9fee44edbee9abaffd24541eaba95bbb63d219b", "url": "https://github.com/getodk/collect/commit/d9fee44edbee9abaffd24541eaba95bbb63d219b", "message": "Improved timber logs", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "e4b767868fd65cb4d03b927d4694fb127df1c8f4", "url": "https://github.com/getodk/collect/commit/e4b767868fd65cb4d03b927d4694fb127df1c8f4", "message": "Fixed tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "c989945ae5ddff64cfdfdfcdd5bc102ef8f22e56", "url": "https://github.com/getodk/collect/commit/c989945ae5ddff64cfdfdfcdd5bc102ef8f22e56", "message": "Removed ChoicesRecyclerViewAdapterProps", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "d4d45f679502e2154ff977c04609a69a9e36ebc9", "url": "https://github.com/getodk/collect/commit/d4d45f679502e2154ff977c04609a69a9e36ebc9", "message": "Improved tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "cd8c2f0897ac65bf692aa9849c4c5328855bab4d", "url": "https://github.com/getodk/collect/commit/cd8c2f0897ac65bf692aa9849c4c5328855bab4d", "message": "Removed redundant listener", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "b2c34375ef2f5af1cc85be2a624f3d1ad3f6403c", "url": "https://github.com/getodk/collect/commit/b2c34375ef2f5af1cc85be2a624f3d1ad3f6403c", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "bf8aa0e9ed4931729c66ed29391fdab855bd7766", "url": "https://github.com/getodk/collect/commit/bf8aa0e9ed4931729c66ed29391fdab855bd7766", "message": "Fixed problems with recreation", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "af31f6513c908dc6fe6e0d8fd39034efc9bf1879", "url": "https://github.com/getodk/collect/commit/af31f6513c908dc6fe6e0d8fd39034efc9bf1879", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "edc74f2170463e976d9b0d755a779fb6e24d4fb1", "url": "https://github.com/getodk/collect/commit/edc74f2170463e976d9b0d755a779fb6e24d4fb1", "message": "Removed unused methods from FormEntryPage", "committedDate": "2020-08-25T06:32:40Z", "type": "commit"}, {"oid": "2afdc35269b945b0a6eb675aa957b9c5d481a6cc", "url": "https://github.com/getodk/collect/commit/2afdc35269b945b0a6eb675aa957b9c5d481a6cc", "message": "Removed unused classes", "committedDate": "2020-08-25T06:33:44Z", "type": "commit"}, {"oid": "0d39634e28ceba8eda0307e8aa448e5e8fec9e74", "url": "https://github.com/getodk/collect/commit/0d39634e28ceba8eda0307e8aa448e5e8fec9e74", "message": "Code improvements", "committedDate": "2020-08-25T06:46:59Z", "type": "commit"}, {"oid": "0d39634e28ceba8eda0307e8aa448e5e8fec9e74", "url": "https://github.com/getodk/collect/commit/0d39634e28ceba8eda0307e8aa448e5e8fec9e74", "message": "Code improvements", "committedDate": "2020-08-25T06:46:59Z", "type": "forcePushed"}, {"oid": "d5a1ace236efe723c2036695d46421ee7d811abe", "url": "https://github.com/getodk/collect/commit/d5a1ace236efe723c2036695d46421ee7d811abe", "message": "Introduced new navigation icon", "committedDate": "2020-07-27T19:16:02Z", "type": "forcePushed"}, {"oid": "3c4b0b95db1548c6a4245fb185486111bf8fe09c", "url": "https://github.com/getodk/collect/commit/3c4b0b95db1548c6a4245fb185486111bf8fe09c", "message": "Code improvements", "committedDate": "2020-07-27T20:39:29Z", "type": "forcePushed"}, {"oid": "0472d3b04dc90387d9a33d984ba531ae7247c55c", "url": "https://github.com/getodk/collect/commit/0472d3b04dc90387d9a33d984ba531ae7247c55c", "message": "Code improvements", "committedDate": "2020-07-27T20:42:03Z", "type": "forcePushed"}, {"oid": "6dee19475b7ff16c6e067c6f5984bd6312c462e0", "url": "https://github.com/getodk/collect/commit/6dee19475b7ff16c6e067c6f5984bd6312c462e0", "message": "Code improvements", "committedDate": "2020-07-27T23:05:48Z", "type": "forcePushed"}, {"oid": "6f8318d0ee368e5fd3dcdc29a76f374d0ff63bb1", "url": "https://github.com/getodk/collect/commit/6f8318d0ee368e5fd3dcdc29a76f374d0ff63bb1", "message": "Code improvements", "committedDate": "2020-07-28T14:23:49Z", "type": "forcePushed"}, {"oid": "4197b4e8c4c5e5f2980a8edb5f76876815c49473", "url": "https://github.com/getodk/collect/commit/4197b4e8c4c5e5f2980a8edb5f76876815c49473", "message": "Added support for quick minimal appearance", "committedDate": "2020-07-28T17:55:00Z", "type": "forcePushed"}, {"oid": "99ee1c0da2ac4782094655d7189f26e694fa216b", "url": "https://github.com/getodk/collect/commit/99ee1c0da2ac4782094655d7189f26e694fa216b", "message": "Added support for quick minimal appearance", "committedDate": "2020-07-28T17:58:38Z", "type": "forcePushed"}, {"oid": "07364b75f3608d73fb0d657a721f30d6863c9595", "url": "https://github.com/getodk/collect/commit/07364b75f3608d73fb0d657a721f30d6863c9595", "message": "Added support for quick minimal appearance", "committedDate": "2020-07-28T18:00:00Z", "type": "forcePushed"}, {"oid": "f944818fb8b2fc106e0da77c2987ae98b0c77e52", "url": "https://github.com/getodk/collect/commit/f944818fb8b2fc106e0da77c2987ae98b0c77e52", "message": "Updated appcompat to fix inflating webView for selectImageMap widgets", "committedDate": "2020-07-28T18:14:56Z", "type": "forcePushed"}, {"oid": "b78af01329ad607f59962fd440adb6522c2a3aa4", "url": "https://github.com/getodk/collect/commit/b78af01329ad607f59962fd440adb6522c2a3aa4", "message": "Code improvements", "committedDate": "2020-07-30T09:32:01Z", "type": "forcePushed"}, {"oid": "d5e146656658a9f43f8ff80431109ed0f05828aa", "url": "https://github.com/getodk/collect/commit/d5e146656658a9f43f8ff80431109ed0f05828aa", "message": "Code improvements", "committedDate": "2020-07-30T09:32:37Z", "type": "forcePushed"}, {"oid": "95e1d1202968d4f256fb02096ab76cee567b2bd5", "url": "https://github.com/getodk/collect/commit/95e1d1202968d4f256fb02096ab76cee567b2bd5", "message": "Fixed context passed to AudioVideoImageTextLabel", "committedDate": "2020-07-30T18:56:42Z", "type": "forcePushed"}, {"oid": "90719e7d4230a8b5dd8aed481b3971ed29ef63ef", "url": "https://github.com/getodk/collect/commit/90719e7d4230a8b5dd8aed481b3971ed29ef63ef", "message": "Fixed context passed to AudioVideoImageTextLabel", "committedDate": "2020-07-30T18:57:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyNTAwNg==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r464125006", "bodyText": "From the commit message: \"to fix inflating webView for selectImageMap widgets\". Is this fixed in 1.2.0-rc02? In general, I think we should really avoid things off the alpha channel. Ideally we wouldn't have to include any unreleased versions but I understand that's not always possible. Using a release candidate seems less dangerous than a first alpha.", "author": "lognaturel", "createdAt": "2020-08-02T21:24:10Z", "path": "collect_app/build.gradle", "diffHunk": "@@ -199,7 +199,7 @@ dependencies {\n \n     implementation 'androidx.legacy:legacy-support-v13:1.0.0'\n     implementation 'androidx.browser:browser:1.2.0'\n-    implementation 'androidx.appcompat:appcompat:1.1.0'\n+    implementation 'androidx.appcompat:appcompat:1.3.0-alpha01'", "originalCommit": "70b2d9c856f41f9afc7d231d32bd8f7a403f526f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA0MTU3MA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r465041570", "bodyText": "Right, 1.2.0-rc02 also works well so I changed it. Thanks!", "author": "grzesiek2010", "createdAt": "2020-08-04T13:15:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyNTAwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyNzQxNQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r464127415", "bodyText": "\"bounces\" implies the input becomes the output. Maybe rename to textToHtml_nullBecomesEmptyString?", "author": "lognaturel", "createdAt": "2020-08-02T21:49:18Z", "path": "collect_app/src/test/java/org/odk/collect/android/utilities/StringUtilsTest.java", "diffHunk": "@@ -1,29 +1,22 @@\n package org.odk.collect.android.utilities;\n \n-import org.junit.Assert;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.robolectric.RobolectricTestRunner;\n \n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.equalTo;\n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertFalse;\n import static org.junit.Assert.assertTrue;\n \n @RunWith(RobolectricTestRunner.class)\n public class StringUtilsTest {\n \n-    /**\n-     * Should return null if provided with null and not throw a NPE.\n-     * <p>\n-     * This is a silly test but it is here to guarantee this behaviour,\n-     * since without it the method causes a crash when processing text for\n-     * questions with no plain text label. See getodk/getodk#1247.\n-     */\n     @Test\n-    public void textToHtml_BouncesNullInput() {\n-        String input = null;\n-        CharSequence observed = StringUtils.textToHtml(input);\n-        Assert.assertNull(observed);\n+    public void textToHtml_BouncesEmptyString() {", "originalCommit": "70b2d9c856f41f9afc7d231d32bd8f7a403f526f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA0MDU1NA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r465040554", "bodyText": "Right, fixed.", "author": "grzesiek2010", "createdAt": "2020-08-04T13:14:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyNzQxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzNzc4OQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466137789", "bodyText": "Should always be set from the constructor?", "author": "lognaturel", "createdAt": "2020-08-06T04:24:59Z", "path": "collect_app/src/main/java/org/odk/collect/android/adapters/SelectOneListAdapter.java", "diffHunk": "@@ -16,86 +16,78 @@\n \n package org.odk.collect.android.adapters;\n \n-import android.content.Context;\n import android.view.LayoutInflater;\n import android.view.View;\n import android.view.ViewGroup;\n import android.widget.CompoundButton;\n import android.widget.FrameLayout;\n-import android.widget.ImageView;\n import android.widget.RadioButton;\n \n import androidx.annotation.NonNull;\n import androidx.core.content.ContextCompat;\n \n import org.javarosa.core.model.SelectChoice;\n import org.javarosa.core.model.data.helper.Selection;\n-import org.javarosa.core.reference.ReferenceManager;\n-import org.javarosa.form.api.FormEntryPrompt;\n import org.odk.collect.android.R;\n-import org.odk.collect.android.audio.AudioHelper;\n import org.odk.collect.android.formentry.questions.AudioVideoImageTextLabel;\n-import org.odk.collect.android.widgets.AbstractSelectOneWidget;\n+import org.odk.collect.android.listeners.SelectOneItemClickListener;\n+import org.odk.collect.android.logic.ChoicesRecyclerViewAdapterProps;\n \n+import java.util.Collections;\n import java.util.List;\n \n-public class SelectOneListAdapter extends AbstractSelectListAdapter\n-        implements View.OnClickListener, CompoundButton.OnCheckedChangeListener {\n-\n+public class SelectOneListAdapter extends AbstractSelectListAdapter implements CompoundButton.OnCheckedChangeListener {\n     private String selectedValue;\n-    private final int playColor;\n     private RadioButton selectedRadioButton;\n     private View selectedItem;\n+    private SelectOneItemClickListener listener;\n \n-    @SuppressWarnings(\"PMD.ExcessiveParameterList\")\n-    public SelectOneListAdapter(List<SelectChoice> items, String selectedValue, AbstractSelectOneWidget widget, int numColumns, FormEntryPrompt formEntryPrompt, ReferenceManager referenceManager, int answerFontSize, AudioHelper audioHelper, int playColor, Context context) {\n-        super(items, widget, numColumns, formEntryPrompt, referenceManager, answerFontSize, audioHelper, context);\n+    public SelectOneListAdapter(String selectedValue, SelectOneItemClickListener listener, ChoicesRecyclerViewAdapterProps props) {\n+        super(props);\n         this.selectedValue = selectedValue;\n-        this.playColor = playColor;\n+        this.listener = listener;\n     }\n \n     @Override\n     public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {\n-        return new ViewHolder(noButtonsMode\n+        return new ViewHolder(props.isNoButtonsMode()\n                 ? new FrameLayout(parent.getContext())\n-                : new AudioVideoImageTextLabel(parent.getContext()));\n-    }\n-\n-    @Override\n-    public void onClick(View v) {\n-        ((AbstractSelectOneWidget) widget).onClick();\n+                : new AudioVideoImageTextLabel(props.getContext()));\n     }\n \n     @Override\n     public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {\n         if (isChecked) {\n             if (selectedRadioButton != null && buttonView != selectedRadioButton) {\n                 selectedRadioButton.setChecked(false);\n-                ((AbstractSelectOneWidget) widget).clearNextLevelsOfCascadingSelect();\n+                listener.onClearNextLevelsOfCascadingSelect();\n             }\n             selectedRadioButton = (RadioButton) buttonView;\n-            selectedValue = items.get((int) selectedRadioButton.getTag()).getValue();\n+            selectedValue = props.getItems().get((int) selectedRadioButton.getTag()).getValue();\n         }\n     }\n \n-    class ViewHolder extends AbstractSelectListAdapter.ViewHolder {\n-        ImageView autoAdvanceIcon;\n+    public void setSelectItemClickListener(SelectOneItemClickListener listener) {", "originalCommit": "6f2a42aef63fa0d590e4718d5fa4e940c899c020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1ODMyNw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466158327", "bodyText": "I see, this is for rotation. Note to self: think through alternatives for this a bit.", "author": "lognaturel", "createdAt": "2020-08-06T05:40:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzNzc4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk1NTUxMQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r473955511", "bodyText": "Can't see any simpler solution.", "author": "grzesiek2010", "createdAt": "2020-08-20T13:08:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzNzc4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzODk1Nw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466138957", "bodyText": "Why is this a separate interface and method from SelectItemClickListener? Can't the onItemClicked implementation for SelectOneWidget include the call? Only one class that implements this interface has a definition for the method which doesn't feel great.\nNote to self: I also reviewed the implementation and I think we should consider revising it. It currently blindly clears any \"external itemset\" questions after a select one, whether or not they're actually linked or not.", "author": "lognaturel", "createdAt": "2020-08-06T04:29:47Z", "path": "collect_app/src/main/java/org/odk/collect/android/listeners/SelectOneItemClickListener.java", "diffHunk": "@@ -0,0 +1,5 @@\n+package org.odk.collect.android.listeners;\n+\n+public interface SelectOneItemClickListener extends SelectItemClickListener {\n+    void onClearNextLevelsOfCascadingSelect();", "originalCommit": "6f2a42aef63fa0d590e4718d5fa4e940c899c020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODU4ODE5OQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r468588199", "bodyText": "I think this is broken either way even on master and w didn't have any test for that clearing. Can I file a separate issue for that to fix it and handle in a better way and here just remove?", "author": "grzesiek2010", "createdAt": "2020-08-11T13:42:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzODk1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI2NDU1NA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r472264554", "bodyText": "Unfortunately, I don't think we should just remove it because it does address a real issue and works well in the common case. Is it not possible to move the behavior just into the onItemClicked implementation for ItemsetWidget?\nDefinitely good to file an issue to review it and add tests, though. \ud83d\udc4d", "author": "lognaturel", "createdAt": "2020-08-18T15:00:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzODk1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkzOTcwMA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r473939700", "bodyText": "Ok I made a mistake (clearing works as before) I used the form from the doc https://docs.google.com/spreadsheets/d/1CCjRRHCyJXaSEBHPjMWrGotnORR4BI49PoON6qK01BE/edit#gid=1 which seems broken because it doesn't display the last level. It's called new cascading select so it indicates that something has changed do you know anything about it? I know that the old version  has two columns (for filters) and I was able to transform it and now it works but I'm curious what's going on.\nRegarding the listener you are right I don't need that second listener. I already removed it.", "author": "grzesiek2010", "createdAt": "2020-08-20T12:42:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzODk1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3MTUzNg==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r474171536", "bodyText": "That form is just crazy. I have no idea why it was like that and I just merged XLSForm/xlsform.github.io#196 to improve it.\nI don't think onClearNextLevelsOfCascadingSelect would be relevant to that form, though. It's a special case only for \"external itemsets\" that cascade (http://xlsform.org/en/#external-selects).", "author": "lognaturel", "createdAt": "2020-08-20T17:58:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzODk1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3MzU2Nw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r474173567", "bodyText": "Yea I agree with internal choices it works without that fix but now I can confirm that it also works with external choices. At least as it worked before.", "author": "grzesiek2010", "createdAt": "2020-08-20T18:02:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzODk1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3NjU1MA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r474176550", "bodyText": "Great. Just be careful when saying \"external choices\" because that can mean three things: search(), \"external itemsets\" (ItemsetWidget) or external secondary instances.", "author": "lognaturel", "createdAt": "2020-08-20T18:08:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzODk1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzOTczMg==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466139732", "bodyText": "Why have it implement the interface, then? Can you pass in a null listener when creating the adapter (and make sure that the adapter can handle a null listener)?", "author": "lognaturel", "createdAt": "2020-08-06T04:32:45Z", "path": "collect_app/src/main/java/org/odk/collect/android/fragments/dialogs/SelectMultiMinimalDialog.java", "diffHunk": "@@ -0,0 +1,42 @@\n+package org.odk.collect.android.fragments.dialogs;\n+\n+import android.os.Bundle;\n+import android.view.View;\n+\n+import org.javarosa.core.model.data.helper.Selection;\n+import org.jetbrains.annotations.NotNull;\n+import org.odk.collect.android.adapters.AbstractSelectListAdapter;\n+import org.odk.collect.android.adapters.SelectMultipleListAdapter;\n+import org.odk.collect.android.listeners.SelectItemClickListener;\n+import org.odk.collect.android.logic.ChoicesRecyclerViewAdapterProps;\n+\n+import java.util.List;\n+\n+public class SelectMultiMinimalDialog extends SelectMinimalDialog implements SelectItemClickListener {\n+    private SelectMultipleListAdapter adapter;\n+\n+    public SelectMultiMinimalDialog() {\n+    }\n+\n+    public SelectMultiMinimalDialog(List<Selection> selectedItems, boolean isFlex, boolean isAutoComplete, ChoicesRecyclerViewAdapterProps props) {\n+        super(isFlex, isAutoComplete);\n+        adapter = new SelectMultipleListAdapter(selectedItems, this, props);\n+    }\n+\n+    @Override\n+    public void onViewCreated(@NotNull View view, Bundle savedInstanceState) {\n+        super.onViewCreated(view, savedInstanceState);\n+        // update the listener on dialog recreation (screen rotation for example)\n+        ((SelectMultipleListAdapter) viewModel.getSelectListAdapter()).setSelectItemClickListener(this);\n+    }\n+\n+    @Override\n+    protected AbstractSelectListAdapter getAdapter() {\n+        return adapter;\n+    }\n+\n+    @Override\n+    public void onItemClicked() {\n+        // do nothing", "originalCommit": "6f2a42aef63fa0d590e4718d5fa4e940c899c020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwODQwMg==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466508402", "bodyText": "Right.", "author": "grzesiek2010", "createdAt": "2020-08-06T15:45:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEzOTczMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1MjEwNA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466152104", "bodyText": "How did you decide what goes in the props record vs. not? Why not include flex and autocomplete appearances?", "author": "lognaturel", "createdAt": "2020-08-06T05:19:47Z", "path": "collect_app/src/main/java/org/odk/collect/android/widgets/SelectMultiMinimalWidget.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package org.odk.collect.android.widgets;\n+\n+import android.content.Context;\n+\n+import org.javarosa.core.model.data.IAnswerData;\n+import org.javarosa.core.model.data.SelectMultiData;\n+import org.javarosa.core.model.data.helper.Selection;\n+import org.odk.collect.android.R;\n+import org.odk.collect.android.activities.FormEntryActivity;\n+import org.odk.collect.android.formentry.questions.QuestionDetails;\n+import org.odk.collect.android.fragments.dialogs.SelectMinimalDialog;\n+import org.odk.collect.android.fragments.dialogs.SelectMultiMinimalDialog;\n+import org.odk.collect.android.utilities.StringUtils;\n+import org.odk.collect.android.utilities.WidgetAppearanceUtils;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+public class SelectMultiMinimalWidget extends SelectMinimalWidget {\n+    private List<Selection> selectedItems;\n+\n+    public SelectMultiMinimalWidget(Context context, QuestionDetails prompt) {\n+        super(context, prompt);\n+        selectedItems = getFormEntryPrompt().getAnswerValue() == null\n+                ? new ArrayList<>() :\n+                (List<Selection>) getFormEntryPrompt().getAnswerValue().getValue();\n+        updateAnswerLabel();\n+    }\n+\n+    @Override\n+    protected void showDialog() {\n+        SelectMultiMinimalDialog dialog = new SelectMultiMinimalDialog(getSavedSelectedItems(), WidgetAppearanceUtils.isFlexAppearance(getFormEntryPrompt()), WidgetAppearanceUtils.isAutocomplete(getFormEntryPrompt()), getChoicesRecyclerViewProps());", "originalCommit": "6f2a42aef63fa0d590e4718d5fa4e940c899c020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM4NzQxNw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466387417", "bodyText": "Because flex and autocomplete appearances are used in SelectMinimalDialog but props are passed to an adapter\nhttps://github.com/getodk/collect/pull/3964/files#diff-c84dd1657c1e1200edf5f3ca7b8f062aR23 that was my reasoning.", "author": "grzesiek2010", "createdAt": "2020-08-06T12:49:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1MjEwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUxMjUwMQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466512501", "bodyText": "I see, that makes sense. You know, the more I think about this the more it feels like a pattern we don't want to introduce. It's not very Java/Android idiomatic and I don't think there's much advantage to it. It's ok to have long parameter lists! You could also consider something like a SelectQuestionPrompt object that wraps the form entry prompt and booleans for the different appearances. When that object is created with a FormEntryPrompt, the appearance is read and sanitized once and all the booleans are set. That also has the advantage of moving away from the static WidgetAppearanceUtils.", "author": "lognaturel", "createdAt": "2020-08-06T15:51:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1MjEwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODYwNDg5Ng==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r468604896", "bodyText": "I agree it's not good I didn't like the long list of parameters and wanted to improve it somehow but ended up with another approach that is not perfect. I'll take another look maybe we can improve it or just pass all parameters directly as you said it's not that bad.", "author": "grzesiek2010", "createdAt": "2020-08-11T14:04:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1MjEwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1NDA0Nw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466154047", "bodyText": "Could you use getSelectedItems().get(0) instead to avoid having to cast? Generally having to cast is dangerous because it can lead to runtime errors. This same pattern shows up in a couple other places.", "author": "lognaturel", "createdAt": "2020-08-06T05:26:54Z", "path": "collect_app/src/main/java/org/odk/collect/android/widgets/ItemsetWidget.java", "diffHunk": "@@ -75,15 +79,29 @@ public ItemsetWidget(Context context,\n         this.fileUtil = fileUtil;\n \n         items = getItems();\n+    }\n+\n+    @Override\n+    public IAnswerData getAnswer() {\n+        Selection selectedItem =  ((SelectOneListAdapter) recyclerViewAdapter).getSelectedItem();", "originalCommit": "6f2a42aef63fa0d590e4718d5fa4e940c899c020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM5MDQ2MA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466390460", "bodyText": "Maybe not directly getSelectedItems().get(0) because it might be empty but yeah something like:\nrecyclerViewAdapter.getSelectedItems().isEmpty() ? null : recyclerViewAdapter.getSelectedItems().get(0);\n\nwill be possible.", "author": "grzesiek2010", "createdAt": "2020-08-06T12:54:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1NDA0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUyMDU2Mw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466520563", "bodyText": "Fixed in e757ea8", "author": "grzesiek2010", "createdAt": "2020-08-06T16:03:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1NDA0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1NTMxNA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466155314", "bodyText": "I don't think this is needed.", "author": "lognaturel", "createdAt": "2020-08-06T05:31:03Z", "path": "collect_app/src/main/java/org/odk/collect/android/fragments/dialogs/SelectMultiMinimalDialog.java", "diffHunk": "@@ -0,0 +1,42 @@\n+package org.odk.collect.android.fragments.dialogs;\n+\n+import android.os.Bundle;\n+import android.view.View;\n+\n+import org.javarosa.core.model.data.helper.Selection;\n+import org.jetbrains.annotations.NotNull;\n+import org.odk.collect.android.adapters.AbstractSelectListAdapter;\n+import org.odk.collect.android.adapters.SelectMultipleListAdapter;\n+import org.odk.collect.android.listeners.SelectItemClickListener;\n+import org.odk.collect.android.logic.ChoicesRecyclerViewAdapterProps;\n+\n+import java.util.List;\n+\n+public class SelectMultiMinimalDialog extends SelectMinimalDialog implements SelectItemClickListener {\n+    private SelectMultipleListAdapter adapter;\n+\n+    public SelectMultiMinimalDialog() {\n+    }\n+\n+    public SelectMultiMinimalDialog(List<Selection> selectedItems, boolean isFlex, boolean isAutoComplete, ChoicesRecyclerViewAdapterProps props) {\n+        super(isFlex, isAutoComplete);\n+        adapter = new SelectMultipleListAdapter(selectedItems, this, props);\n+    }\n+\n+    @Override\n+    public void onViewCreated(@NotNull View view, Bundle savedInstanceState) {", "originalCommit": "6f2a42aef63fa0d590e4718d5fa4e940c899c020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM4NTQzMw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466385433", "bodyText": "Why? Have you seen the comment below?", "author": "grzesiek2010", "createdAt": "2020-08-06T12:45:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1NTMxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUwMDUzMA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466500530", "bodyText": "Ahh I see because we don't use it either way right right...", "author": "grzesiek2010", "createdAt": "2020-08-06T15:34:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE1NTMxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5MjU5MA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466592590", "bodyText": "These all look to me like they could be robolectric tests entirely within the context of the dialog. Did you try to go that direction and run into issues?\nFor the last test which verifies the back button and return arrow behavior, I think you can also stay in the dialog and make sure that some method is called to commit the change. How exactly you do that will depend on some of the architecture changes we're discussing. Then there also needs to be a test on the FormEntryActivity that verifies that if an answer is set by the mechanism used in the prior test, it's displayed as expected. Depending on what mechanism that ends up being, it may or may not already be addressed.\nFor the missing audio toast, there's already some coverage in the tests for AudioPlayerViewModel. However, there is no test that currently ensures the error is shown as a toast. I think you should be able to do that within the context of the dialog but it looks like setting up the dependencies might be impractical.", "author": "lognaturel", "createdAt": "2020-08-06T18:03:51Z", "path": "collect_app/src/androidTest/java/org/odk/collect/android/feature/formentry/SelectMultiMinimalWidgetTest.java", "diffHunk": "@@ -0,0 +1,224 @@\n+package org.odk.collect.android.feature.formentry;\n+\n+import android.Manifest;\n+\n+import androidx.test.espresso.intent.rule.IntentsTestRule;\n+import androidx.test.rule.GrantPermissionRule;\n+\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.RuleChain;\n+import org.odk.collect.android.activities.FormEntryActivity;\n+import org.odk.collect.android.support.CopyFormRule;\n+import org.odk.collect.android.support.FormLoadingUtils;\n+import org.odk.collect.android.support.ResetStateRule;\n+import org.odk.collect.android.support.pages.FormEntryPage;\n+\n+import static java.util.Arrays.asList;\n+\n+public class SelectMultiMinimalWidgetTest {", "originalCommit": "e757ea8213db99fe18d88133e6bda0687b232878", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYyNTQyNA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466625424", "bodyText": "I don't think there's any reason for populating the recycler view for tests that look at the layout manager.", "author": "lognaturel", "createdAt": "2020-08-06T19:05:05Z", "path": "collect_app/src/test/java/org/odk/collect/android/widgets/SelectMultiWidgetTest.java", "diffHunk": "@@ -71,6 +82,194 @@ public void setup() throws Exception {\n         when(audioHelper.setAudio(any(AudioButton.class), any())).thenReturn(new MutableLiveData<>());\n     }\n \n+    @Test\n+    public void byDefault_shouldGridLayoutManagerBeUsed() {\n+        populateRecyclerView(getWidget());", "originalCommit": "e757ea8213db99fe18d88133e6bda0687b232878", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg3MTg1NQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466871855", "bodyText": "Right.", "author": "grzesiek2010", "createdAt": "2020-08-07T07:32:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjYyNTQyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4OTExNw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466689117", "bodyText": "Nit: I got really confused about this name because I thought it was related to the search/autocomplete appearance. This represents the answer, right? Or the selection?", "author": "lognaturel", "createdAt": "2020-08-06T21:12:17Z", "path": "collect_app/src/main/res/layout/select_minimal_widget_answer.xml", "diffHunk": "@@ -0,0 +1,20 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<FrameLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"wrap_content\"\n+    android:paddingHorizontal=\"@dimen/margin_standard\"\n+    android:paddingVertical=\"@dimen/margin_small\">\n+\n+    <com.google.android.material.textfield.TextInputEditText\n+        android:id=\"@+id/choices_search_box\"", "originalCommit": "e757ea8213db99fe18d88133e6bda0687b232878", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njg2NTg3Mg==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r466865872", "bodyText": "This is that spinner button which contains answers inside. I wasn't sure about its name, would spinner_button be better or something else?", "author": "grzesiek2010", "createdAt": "2020-08-07T07:19:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4OTExNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI2MjA5MA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r472262090", "bodyText": "I would just call it something like answer but spinner_button feels like a big improvement, too.", "author": "lognaturel", "createdAt": "2020-08-18T14:57:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4OTExNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3OTUxOQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r472379519", "bodyText": "Done.", "author": "grzesiek2010", "createdAt": "2020-08-18T17:55:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4OTExNw=="}], "type": "inlineReview"}, {"oid": "822d958b3af0bb2c77b92a9f619d0717c3b21112", "url": "https://github.com/getodk/collect/commit/822d958b3af0bb2c77b92a9f619d0717c3b21112", "message": "Moved items widget to one package", "committedDate": "2020-08-17T10:32:43Z", "type": "forcePushed"}, {"oid": "aadb8ec9abd79f21be50abae5a38575fbcf955f3", "url": "https://github.com/getodk/collect/commit/aadb8ec9abd79f21be50abae5a38575fbcf955f3", "message": "Moved items widget to one package", "committedDate": "2020-08-17T11:05:12Z", "type": "forcePushed"}, {"oid": "da51c5ab95a79a555aad3152b45ba197c92d94ac", "url": "https://github.com/getodk/collect/commit/da51c5ab95a79a555aad3152b45ba197c92d94ac", "message": "Removed duplicated tests", "committedDate": "2020-08-18T00:00:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMwMTg2MA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r472301860", "bodyText": "While here, change to Timber.d since it's not developer-actionable. Message should also probably be \"Invalid media ref\"", "author": "lognaturel", "createdAt": "2020-08-18T15:52:30Z", "path": "collect_app/src/main/java/org/odk/collect/android/adapters/AbstractSelectListAdapter.java", "diffHunk": "@@ -227,11 +227,22 @@ public void addMediaFromChoice(AudioVideoImageTextLabel audioVideoImageTextLabel\n             String imageURI = getImageURI(index, items);\n             String videoURI = props.getPrompt().getSpecialFormSelectChoiceText(item, \"video\");\n             String bigImageURI = props.getPrompt().getSpecialFormSelectChoiceText(item, \"big-image\");\n-            audioVideoImageTextLabel.setImageVideo(imageURI, videoURI, bigImageURI, props.getReferenceManager());\n-\n             String audioURI = getPlayableAudioURI(props.getPrompt(), item, props.getReferenceManager());\n-            if (audioURI != null) {\n-                audioVideoImageTextLabel.setAudio(audioURI, props.getAudioHelper());\n+            try {\n+                if (imageURI != null) {\n+                    audioVideoImageTextLabel.setImage(new File(props.getReferenceManager().deriveReference(imageURI).getLocalURI()));\n+                }\n+                if (bigImageURI != null) {\n+                    audioVideoImageTextLabel.setBigImage(new File(props.getReferenceManager().deriveReference(bigImageURI).getLocalURI()));\n+                }\n+                if (videoURI != null) {\n+                    audioVideoImageTextLabel.setVideo(new File(props.getReferenceManager().deriveReference(videoURI).getLocalURI()));\n+                }\n+                if (audioURI != null) {\n+                    audioVideoImageTextLabel.setAudio(audioURI, props.getAudioHelper());\n+                }\n+            } catch (InvalidReferenceException e) {\n+                Timber.e(e, \"Invalid image reference due to %s \", e.getMessage());", "originalCommit": "51ce61116b132d18954f27fde5b61462d42bc1cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3OTY0NA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r472379644", "bodyText": "Done.", "author": "grzesiek2010", "createdAt": "2020-08-18T17:55:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMwMTg2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMwMjc0MA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r472302740", "bodyText": "My preference would be for all the setters to handle possible nulls so these null checks don't have to be here. Alternately the setters could have @NonNull parameter annotations and these null checks could stay but come out of the setters.", "author": "lognaturel", "createdAt": "2020-08-18T15:53:38Z", "path": "collect_app/src/main/java/org/odk/collect/android/adapters/AbstractSelectListAdapter.java", "diffHunk": "@@ -227,11 +227,22 @@ public void addMediaFromChoice(AudioVideoImageTextLabel audioVideoImageTextLabel\n             String imageURI = getImageURI(index, items);\n             String videoURI = props.getPrompt().getSpecialFormSelectChoiceText(item, \"video\");\n             String bigImageURI = props.getPrompt().getSpecialFormSelectChoiceText(item, \"big-image\");\n-            audioVideoImageTextLabel.setImageVideo(imageURI, videoURI, bigImageURI, props.getReferenceManager());\n-\n             String audioURI = getPlayableAudioURI(props.getPrompt(), item, props.getReferenceManager());\n-            if (audioURI != null) {\n-                audioVideoImageTextLabel.setAudio(audioURI, props.getAudioHelper());\n+            try {\n+                if (imageURI != null) {", "originalCommit": "51ce61116b132d18954f27fde5b61462d42bc1cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg5NTk5MA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r473895990", "bodyText": "I need to have those checks here not in setters because I want to pass files to those setters not URIs so that I can mock such files for tests (if a file exist or not).", "author": "grzesiek2010", "createdAt": "2020-08-20T11:20:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMwMjc0MA=="}], "type": "inlineReview"}, {"oid": "2559c55da02e2ffecb65daa87a0d8c698a0ff52b", "url": "https://github.com/getodk/collect/commit/2559c55da02e2ffecb65daa87a0d8c698a0ff52b", "message": "Naming improvements", "committedDate": "2020-08-18T17:52:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3NTgxNw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r474175817", "bodyText": "You can go further and move this to ItemsetWidget. Then you can name it something like clearNextLevelsOfCascade and remove the comment which is a little misleading because there are three things that are \"external choices.\"", "author": "lognaturel", "createdAt": "2020-08-20T18:06:36Z", "path": "collect_app/src/main/java/org/odk/collect/android/widgets/items/SelectOneWidget.java", "diffHunk": "@@ -100,15 +99,21 @@ public void onItemClicked() {\n             listener.advance();\n         }\n \n+        onClearNextLevelsOfCascadingSelect();\n         widgetValueChanged();\n     }\n \n+    @Override\n+    public void clearAnswer() {\n+        onClearNextLevelsOfCascadingSelect();\n+        super.clearAnswer();\n+    }\n+\n     /**\n      * It's needed only for external choices. Everything works well and\n      * out of the box when we use internal choices instead\n      */\n-    @Override\n-    public void onClearNextLevelsOfCascadingSelect() {\n+    private void onClearNextLevelsOfCascadingSelect() {", "originalCommit": "dad40c05e340924997614d2a29d7380bbbe46263", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4NDQyNw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r474184427", "bodyText": "I'm afraid it must be in this widget because the first level of cascading select is always SelectOneWidget and then next levels are represented by ItemsetWidgets. So if I change it like that it won't work.", "author": "grzesiek2010", "createdAt": "2020-08-20T18:22:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3NTgxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4NjUyOA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r474186528", "bodyText": "I see. I guess that's what the provided examples do show though it's certainly not a requirement. This is all kind of crazy so let's at least improve the comment and naming. How about clearFollowingItemsetWidgets and something like \"If there are \"fast external itemset\" selects right after this select, assume that they are linked to the current question and clear them.\"", "author": "lognaturel", "createdAt": "2020-08-20T18:26:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3NTgxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4NzU2OQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r474187569", "bodyText": "Sounds good, will do.", "author": "grzesiek2010", "createdAt": "2020-08-20T18:28:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE3NTgxNw=="}], "type": "inlineReview"}, {"oid": "be8e841dbb20a8a83357a632d42779d1b3fa053c", "url": "https://github.com/getodk/collect/commit/be8e841dbb20a8a83357a632d42779d1b3fa053c", "message": "Code improvements", "committedDate": "2020-08-20T21:29:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMTQ2Mw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r475901463", "bodyText": "I think this may no longer be needed? It's not currently used so I think it makes sense to remove it for now and re-introduced if it's useful in the future.", "author": "lognaturel", "createdAt": "2020-08-24T21:21:14Z", "path": "collect_app/src/androidTest/java/org/odk/collect/android/support/actions/RecyclerViewAction.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package org.odk.collect.android.support.actions;\n+\n+import android.view.View;\n+\n+import androidx.test.espresso.UiController;\n+import androidx.test.espresso.ViewAction;\n+\n+import org.hamcrest.Matcher;\n+\n+public class RecyclerViewAction {", "originalCommit": "03661435917f01298aa156eb41547c958a19580b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjIxNTA5OQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r476215099", "bodyText": "Fixed.", "author": "grzesiek2010", "createdAt": "2020-08-25T06:49:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMTQ2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMTk2Mw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r475901963", "bodyText": "No longer needed.", "author": "lognaturel", "createdAt": "2020-08-24T21:22:17Z", "path": "collect_app/src/androidTest/java/org/odk/collect/android/support/assertions/RecyclerViewAssertions.java", "diffHunk": "@@ -0,0 +1,24 @@\n+package org.odk.collect.android.support.assertions;\n+\n+import android.widget.FrameLayout;\n+\n+import androidx.test.espresso.ViewAssertion;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.is;\n+import static org.hamcrest.Matchers.notNullValue;\n+import static org.hamcrest.Matchers.nullValue;\n+\n+public class RecyclerViewAssertions {", "originalCommit": "03661435917f01298aa156eb41547c958a19580b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjIxNTE0OA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r476215148", "bodyText": "Fixed.", "author": "grzesiek2010", "createdAt": "2020-08-25T06:49:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMTk2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMjcwNw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r475902707", "bodyText": "A few methods starting here are no longer used.", "author": "lognaturel", "createdAt": "2020-08-24T21:23:53Z", "path": "collect_app/src/androidTest/java/org/odk/collect/android/support/pages/FormEntryPage.java", "diffHunk": "@@ -291,4 +297,99 @@ private void flingLeft() {\n             });\n         }, 5);\n     }\n+\n+    public FormEntryPage openSelectMinimalDialog() {\n+        openSelectMinimalDialog(0);\n+        return this;\n+    }\n+\n+    public FormEntryPage openSelectMinimalDialog(int index) {\n+        onView(withIndex(withClassName(Matchers.endsWith(\"TextInputEditText\")), index)).perform(click());\n+        return this;\n+    }\n+\n+    public FormEntryPage closeSelectMinimalDialog() {\n+        onView(allOf(instanceOf(AppCompatImageButton.class), withParent(withId(R.id.toolbar)))).perform(click());\n+        return this;\n+    }\n+\n+    public FormEntryPage assertSelectMinimalDialogAnswer(String answer) {\n+        onView(withId(R.id.answer)).check(matches(withText(answer)));\n+        return this;\n+    }\n+\n+    public FormEntryPage assertSearchBoxIsHidden(boolean minimalAppearance) {", "originalCommit": "03661435917f01298aa156eb41547c958a19580b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjIxNTIwMA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r476215200", "bodyText": "Fixed.", "author": "grzesiek2010", "createdAt": "2020-08-25T06:49:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMjcwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMzk3OQ==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r475903979", "bodyText": "How about adding a TODO with some of the discussion we had about this? Just a quick note to help the next person puzzling over this code realize that it's not in an ideal state. Something like \"replace SelectMinimalDialogListener and use of the binary data flow, likely with a ViewModel\"", "author": "lognaturel", "createdAt": "2020-08-24T21:26:23Z", "path": "collect_app/src/main/java/org/odk/collect/android/activities/FormEntryActivity.java", "diffHunk": "@@ -2662,6 +2665,16 @@ public void onRankingChanged(List<SelectChoice> items) {\n         }\n     }\n \n+    @Override\n+    public void updateSelectedItems(List<Selection> items) {", "originalCommit": "03661435917f01298aa156eb41547c958a19580b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjIxNTUzOA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r476215538", "bodyText": "Fixed.", "author": "grzesiek2010", "createdAt": "2020-08-25T06:49:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMzk3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwODkzOA==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r475908938", "bodyText": "If you're going to have the callers check for null, can you mark the params as @NonNull and not have additional null checks here?", "author": "lognaturel", "createdAt": "2020-08-24T21:37:46Z", "path": "collect_app/src/main/java/org/odk/collect/android/formentry/questions/AudioVideoImageTextLabel.java", "diffHunk": "@@ -136,22 +141,22 @@ public void setAudio(String audioURI, AudioHelper audioHelper) {\n         setupAudioButton(audioURI, audioHelper);\n     }\n \n-    /**\n-     * This should move to separate setters like {@link #setAudio(String, AudioHelper)}\n-     */\n-    @Deprecated\n-    public void setImageVideo(String imageURI, String videoURI,\n-                              String bigImageURI, ReferenceManager referenceManager) {\n-        this.bigImageURI = bigImageURI;\n-        this.videoURI = videoURI;\n-        this.referenceManager = referenceManager;\n-\n-        if (videoURI != null) {\n-            setupVideoButton();\n+    public void setImage(File imageFile) {\n+        if (imageFile != null) {", "originalCommit": "03661435917f01298aa156eb41547c958a19580b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjIxNTQ3Mw==", "url": "https://github.com/getodk/collect/pull/3964#discussion_r476215473", "bodyText": "Fixed.", "author": "grzesiek2010", "createdAt": "2020-08-25T06:49:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwODkzOA=="}], "type": "inlineReview"}, {"oid": "e3b2ed7bfdf9564eb234edfdc562663a46d3dfcd", "url": "https://github.com/getodk/collect/commit/e3b2ed7bfdf9564eb234edfdc562663a46d3dfcd", "message": "Implemented custom recyclerview class", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "567aa0c91953de90ee9d472fa6a67aa60e5f2df1", "url": "https://github.com/getodk/collect/commit/567aa0c91953de90ee9d472fa6a67aa60e5f2df1", "message": "Code improvements", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "cd3fc27c11e3bccba18e42a6e61c13601e0d57ff", "url": "https://github.com/getodk/collect/commit/cd3fc27c11e3bccba18e42a6e61c13601e0d57ff", "message": "Removed redundant SelectTextWidget", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "07a191301a464b7ee62a88f62bf237b2a029af79", "url": "https://github.com/getodk/collect/commit/07a191301a464b7ee62a88f62bf237b2a029af79", "message": "Naming improvements", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "b8f81c93fb7b45c98d10b691b06edb8e45ea2777", "url": "https://github.com/getodk/collect/commit/b8f81c93fb7b45c98d10b691b06edb8e45ea2777", "message": "Fixed access modifiers", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "fd4b80d65057631d9d6b2588385fed2e182840f5", "url": "https://github.com/getodk/collect/commit/fd4b80d65057631d9d6b2588385fed2e182840f5", "message": "Improved ChoicesRecyclerView.adjustRecyclerViewSize() method", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "1548b3e17d7265406bc269b12b3af56bb61ac8c0", "url": "https://github.com/getodk/collect/commit/1548b3e17d7265406bc269b12b3af56bb61ac8c0", "message": "Factored out enableDivider() method", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "8accfb2b3ce888377136f814b6a9d001fe188059", "url": "https://github.com/getodk/collect/commit/8accfb2b3ce888377136f814b6a9d001fe188059", "message": "Removed old spinner widgets", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "1d94bd9863422d2ed6d4ead154f811a098e6d6d2", "url": "https://github.com/getodk/collect/commit/1d94bd9863422d2ed6d4ead154f811a098e6d6d2", "message": "Refactored hierarchy of select widgets", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "48f5fb8cf60c54b7c74927e044292fe1e75b78ab", "url": "https://github.com/getodk/collect/commit/48f5fb8cf60c54b7c74927e044292fe1e75b78ab", "message": "Code improvements", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "ce1d676d3a5f7821b8a1487ac93b6c5bb7bdea60", "url": "https://github.com/getodk/collect/commit/ce1d676d3a5f7821b8a1487ac93b6c5bb7bdea60", "message": "Implemented select minimal widgets", "committedDate": "2020-08-25T06:30:17Z", "type": "commit"}, {"oid": "e612ecefe47b73a2e7d72a3cb65af8939ee148d1", "url": "https://github.com/getodk/collect/commit/e612ecefe47b73a2e7d72a3cb65af8939ee148d1", "message": "Improved tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "187e8bf6c81e1ca7c89f70d9b16edcfc74c7498c", "url": "https://github.com/getodk/collect/commit/187e8bf6c81e1ca7c89f70d9b16edcfc74c7498c", "message": "Fixed unit tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "768f77161c106408a19199cda42c35337da7bd0a", "url": "https://github.com/getodk/collect/commit/768f77161c106408a19199cda42c35337da7bd0a", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "2b42d853b155fce6038aec32c24ca1898c5e58a0", "url": "https://github.com/getodk/collect/commit/2b42d853b155fce6038aec32c24ca1898c5e58a0", "message": "Added tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "c011d64ebed3a3e5779f581e3ca6085f82933590", "url": "https://github.com/getodk/collect/commit/c011d64ebed3a3e5779f581e3ca6085f82933590", "message": "Fixed readonly in select minimal widgets", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "d2a1db6543aff1e8a0f35a2e060238a2f3331217", "url": "https://github.com/getodk/collect/commit/d2a1db6543aff1e8a0f35a2e060238a2f3331217", "message": "Show searchbar only if autocomplete appearance is used", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "21e2f01b8d745cb765637dea2324a939125d1545", "url": "https://github.com/getodk/collect/commit/21e2f01b8d745cb765637dea2324a939125d1545", "message": "Fixed detecting minimal appearance for select_multiple while creating a widget", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "4a713a864963fe8be249d65fc67a2894da448bb7", "url": "https://github.com/getodk/collect/commit/4a713a864963fe8be249d65fc67a2894da448bb7", "message": "removed unused class", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "817afbfb03c27cc8f772cd5d4431a28750576f32", "url": "https://github.com/getodk/collect/commit/817afbfb03c27cc8f772cd5d4431a28750576f32", "message": "Improved minimal widget layout", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "36cb9e82f4329440f3486f2fbb6322ca565c360f", "url": "https://github.com/getodk/collect/commit/36cb9e82f4329440f3486f2fbb6322ca565c360f", "message": "Added needed translations back", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "84e0ab9266b61024623bc8445d0210383150328a", "url": "https://github.com/getodk/collect/commit/84e0ab9266b61024623bc8445d0210383150328a", "message": "Display default Select answer text if there is no asnwer", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "4de7a86209f00ee68371e91175f7af0c8734054e", "url": "https://github.com/getodk/collect/commit/4de7a86209f00ee68371e91175f7af0c8734054e", "message": "Set font size of answers in SelectMinimalWidget according to the value from settings", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "50074739f37baffba0d5099b3ca23cb4f14e4a43", "url": "https://github.com/getodk/collect/commit/50074739f37baffba0d5099b3ca23cb4f14e4a43", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "5fd9e70d8261f25d28b3eaae813bf158ac28e643", "url": "https://github.com/getodk/collect/commit/5fd9e70d8261f25d28b3eaae813bf158ac28e643", "message": "Fixed conflicts", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "548964b649f52d8012c4f71645ba3dbffeaed3f1", "url": "https://github.com/getodk/collect/commit/548964b649f52d8012c4f71645ba3dbffeaed3f1", "message": "Close dialog when select-one question is selected", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "4e2ac2dadfbabf9c1693bb3537f44be0c7ac727a", "url": "https://github.com/getodk/collect/commit/4e2ac2dadfbabf9c1693bb3537f44be0c7ac727a", "message": "Fixed setting the default select answer text", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "139ea432aa13b7bc493bada40074e37684691ba0", "url": "https://github.com/getodk/collect/commit/139ea432aa13b7bc493bada40074e37684691ba0", "message": "Improved displaying answers in minimal widgets", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "30e3b66cfddf609c4dfe3164f012c4aeefa6495f", "url": "https://github.com/getodk/collect/commit/30e3b66cfddf609c4dfe3164f012c4aeefa6495f", "message": "Don't change answers if device back button is pressed", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "25c9ff7d893f6ea5eaa448907d7753665d9656ee", "url": "https://github.com/getodk/collect/commit/25c9ff7d893f6ea5eaa448907d7753665d9656ee", "message": "Introduced new navigation icon", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "82f7e3dd2acabff491916618ea58796467720114", "url": "https://github.com/getodk/collect/commit/82f7e3dd2acabff491916618ea58796467720114", "message": "Added null check to avoid npe while selecting an answer", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "2a1e4cff592ef61a82b4dc56c3b4a042f9af0387", "url": "https://github.com/getodk/collect/commit/2a1e4cff592ef61a82b4dc56c3b4a042f9af0387", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "24f372a62a97cf26efe568c6a0e799c4dc0f3413", "url": "https://github.com/getodk/collect/commit/24f372a62a97cf26efe568c6a0e799c4dc0f3413", "message": "Save answers on clickin device back button", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "f9e0045d9e343bcfb1f345ede180b5d966d00398", "url": "https://github.com/getodk/collect/commit/f9e0045d9e343bcfb1f345ede180b5d966d00398", "message": "Fixed NPE in no-buttons appearances", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "6482f4d01f1867bd905f40dd9dd11909efef562e", "url": "https://github.com/getodk/collect/commit/6482f4d01f1867bd905f40dd9dd11909efef562e", "message": "Fixed closing dialog automatically in select_one with no-buttons", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "f8def70be16e642bd098dafed7f290c6c9176ec5", "url": "https://github.com/getodk/collect/commit/f8def70be16e642bd098dafed7f290c6c9176ec5", "message": "Removed unused code", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "ce20748bdc3526ac228efbd49364174628c38573", "url": "https://github.com/getodk/collect/commit/ce20748bdc3526ac228efbd49364174628c38573", "message": "Reworked using listeners", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "63d8aacd181243acda09f27b72b453ca0bf865f1", "url": "https://github.com/getodk/collect/commit/63d8aacd181243acda09f27b72b453ca0bf865f1", "message": "Removed redundant code", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "84165b44fb507aade4f85239e5adff25dab647ea", "url": "https://github.com/getodk/collect/commit/84165b44fb507aade4f85239e5adff25dab647ea", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "26f79c555c17dc7674c802a5346158a8de1441bf", "url": "https://github.com/getodk/collect/commit/26f79c555c17dc7674c802a5346158a8de1441bf", "message": "Added support for quick minimal appearance", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "219e28c81337324e21bee56b8ba200114810a16c", "url": "https://github.com/getodk/collect/commit/219e28c81337324e21bee56b8ba200114810a16c", "message": "Updated appcompat to fix inflating webView for selectImageMap widgets", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "8bad3078fd5e02521222471409f2a811ace0dde1", "url": "https://github.com/getodk/collect/commit/8bad3078fd5e02521222471409f2a811ace0dde1", "message": "Fixed closing dialog after screen rotating", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "73e65b358b45d1e9f1e4894b888a303108bdd416", "url": "https://github.com/getodk/collect/commit/73e65b358b45d1e9f1e4894b888a303108bdd416", "message": "Improved select minimal widget's UI", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "42613b7ecc612d266de41a5582b99aa397a3f3c1", "url": "https://github.com/getodk/collect/commit/42613b7ecc612d266de41a5582b99aa397a3f3c1", "message": "Added comments", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "102fe6da6ca96662ef7cdda36fd47cc6211ce2ad", "url": "https://github.com/getodk/collect/commit/102fe6da6ca96662ef7cdda36fd47cc6211ce2ad", "message": "Moved playColor field up in hierarchy", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "6ecf6a55ce9a9eeac7eee17b4ac2408677d8c416", "url": "https://github.com/getodk/collect/commit/6ecf6a55ce9a9eeac7eee17b4ac2408677d8c416", "message": "Removed unused file", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "1571c1932655ec0ff711d2312012af7d80853a43", "url": "https://github.com/getodk/collect/commit/1571c1932655ec0ff711d2312012af7d80853a43", "message": "Removed redundant getItemText() method", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "a92c6938c4ffdfc79ff64f44da6f50bcef5c325e", "url": "https://github.com/getodk/collect/commit/a92c6938c4ffdfc79ff64f44da6f50bcef5c325e", "message": "Added tests to SelectMultiMinimalWidgetTest", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "60453da181a3d66b3f92b3904b8b8cf66d7c001c", "url": "https://github.com/getodk/collect/commit/60453da181a3d66b3f92b3904b8b8cf66d7c001c", "message": "Added callingClearShouldCallValueChangeListeners tests for all widgets", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "5bbb4dabfc6afb579609d3c84328eeb7b08269eb", "url": "https://github.com/getodk/collect/commit/5bbb4dabfc6afb579609d3c84328eeb7b08269eb", "message": "Removed redundant tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "b9c712d19e8eaefad53f94673eb9a8ef6d55e5ff", "url": "https://github.com/getodk/collect/commit/b9c712d19e8eaefad53f94673eb9a8ef6d55e5ff", "message": "Added tests to SelectOneMinimalWidgetTest", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "be668371b30db7fef5fbada903fd2779e8c22b24", "url": "https://github.com/getodk/collect/commit/be668371b30db7fef5fbada903fd2779e8c22b24", "message": "Added tests for select minimal widgets", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "400b527144b93b788a3a16252ec8efedb5bb78d0", "url": "https://github.com/getodk/collect/commit/400b527144b93b788a3a16252ec8efedb5bb78d0", "message": "Avoid returning null in StringUtils.textToHtml()", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "ff604a576caaa3915e7b703bc171eddc5a991899", "url": "https://github.com/getodk/collect/commit/ff604a576caaa3915e7b703bc171eddc5a991899", "message": "Fixed clearing answers in SelectMultiMinimalWidget", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "c79f83bed4c95a69df7ffd2e90f2f27500a0ea3f", "url": "https://github.com/getodk/collect/commit/c79f83bed4c95a69df7ffd2e90f2f27500a0ea3f", "message": "Added ChoicesRecyclerViewTest", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "6b4960932c0511390e8ce6a75afd274a910e53dd", "url": "https://github.com/getodk/collect/commit/6b4960932c0511390e8ce6a75afd274a910e53dd", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "9e09ae2cea05050084311db0c513606971fcb5d9", "url": "https://github.com/getodk/collect/commit/9e09ae2cea05050084311db0c513606971fcb5d9", "message": "Fixed clearingParentSelect_ShouldUpdateAllDependentLevels test", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "0f7734378d9a99f8c28bbd5c0066545f2fd1181b", "url": "https://github.com/getodk/collect/commit/0f7734378d9a99f8c28bbd5c0066545f2fd1181b", "message": "Fixed context passed to AudioVideoImageTextLabel", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "85b5965c0ec60f955c3c38b3b5add16225af445b", "url": "https://github.com/getodk/collect/commit/85b5965c0ec60f955c3c38b3b5add16225af445b", "message": "Added tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "2fd21b2473546ce991f2c8b9d7e145539b9c68d8", "url": "https://github.com/getodk/collect/commit/2fd21b2473546ce991f2c8b9d7e145539b9c68d8", "message": "More tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "6a71bf8291891cb4b1670b6894392b2381649071", "url": "https://github.com/getodk/collect/commit/6a71bf8291891cb4b1670b6894392b2381649071", "message": "Use back arrow icon in SelectMinimalDialog", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "b91abf0a7c942e696876add99a6834813b091ac0", "url": "https://github.com/getodk/collect/commit/b91abf0a7c942e696876add99a6834813b091ac0", "message": "Improved padding in SelectMinimalWidget answer", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "f31dc22645cefd315b22584a5467635f076b1e8b", "url": "https://github.com/getodk/collect/commit/f31dc22645cefd315b22584a5467635f076b1e8b", "message": "Naming improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "e3096ac6a8c56761890c3dadd2aea72d957a8acd", "url": "https://github.com/getodk/collect/commit/e3096ac6a8c56761890c3dadd2aea72d957a8acd", "message": "Updated androidx.appcompat:appcompat to 1.2.0-rc02 insetad of alpha", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "12f50bf12a96d0c3628d7c7ffe9f5de9f95bc340", "url": "https://github.com/getodk/collect/commit/12f50bf12a96d0c3628d7c7ffe9f5de9f95bc340", "message": "Improved tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "a64d5711a47c77aee239d3d89c0b965ca7b9ede6", "url": "https://github.com/getodk/collect/commit/a64d5711a47c77aee239d3d89c0b965ca7b9ede6", "message": "Fixed lint", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "3b7fd21a4cf9f13b186e713cf9f83d884511c6c9", "url": "https://github.com/getodk/collect/commit/3b7fd21a4cf9f13b186e713cf9f83d884511c6c9", "message": "Added tests", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "4cac47a0a47e3b101e9cc559fc1d18efe7d60f8d", "url": "https://github.com/getodk/collect/commit/4cac47a0a47e3b101e9cc559fc1d18efe7d60f8d", "message": "Removed redundant code", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "d0d59849fe25efb750cae16c27fd3cdf375d1a13", "url": "https://github.com/getodk/collect/commit/d0d59849fe25efb750cae16c27fd3cdf375d1a13", "message": "Code improvements", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "e3b69c5175c613af6d9d8f48b4aa03c99a6d5fd0", "url": "https://github.com/getodk/collect/commit/e3b69c5175c613af6d9d8f48b4aa03c99a6d5fd0", "message": "Removed redundant populateRecyclerView() calls", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "b1d1f94810e786cf75bfc9f23f60a6898917f17c", "url": "https://github.com/getodk/collect/commit/b1d1f94810e786cf75bfc9f23f60a6898917f17c", "message": "Moved items widget to one package", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "8499507eff7d20b964946a1a1d047c026733a389", "url": "https://github.com/getodk/collect/commit/8499507eff7d20b964946a1a1d047c026733a389", "message": "Allow mocking choice labels", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "969fa9fba5c0322f4f01db9adf618a4b56d08ddb", "url": "https://github.com/getodk/collect/commit/969fa9fba5c0322f4f01db9adf618a4b56d08ddb", "message": "Improved setting media in AudioVideoImageTextLabel", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "4a2ca39d29dfef30088077323285644886bf2c8e", "url": "https://github.com/getodk/collect/commit/4a2ca39d29dfef30088077323285644886bf2c8e", "message": "Improved viewShouldBecomeVisibleIfUriPresent", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "fae36ccf876fcf23de0d85c51270b7a708736666", "url": "https://github.com/getodk/collect/commit/fae36ccf876fcf23de0d85c51270b7a708736666", "message": "Replaced bothClickingRadioButtonAndImage_shouldSelectItem espresso tests with robolectric", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}, {"oid": "aebaaafa7e7ac92c5084a753d3eb8e4fc6007791", "url": "https://github.com/getodk/collect/commit/aebaaafa7e7ac92c5084a753d3eb8e4fc6007791", "message": "Moved some tests from widget tests to AudioVideoImageTextLabelTest", "committedDate": "2020-08-25T06:30:18Z", "type": "commit"}]}