{"pr_number": 4326, "pr_title": "Always update formController for viewmodels when singleton is updated", "pr_createdAt": "2020-12-18T19:39:02Z", "pr_url": "https://github.com/getodk/collect/pull/4326", "timeline": [{"oid": "04346f95ae83ca66b6a26527762d6c0fc0e6224a", "url": "https://github.com/getodk/collect/commit/04346f95ae83ca66b6a26527762d6c0fc0e6224a", "message": "Always update formController for viewmodels when singleton is updated", "committedDate": "2020-12-18T19:39:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1Mzk5NA==", "url": "https://github.com/getodk/collect/pull/4326#discussion_r546053994", "bodyText": "I see this in a lot of our logs and I can't tell if it's actually meaningful. Hopefully seeing the exception will give us some insights. I'm hoping it turns out to be expected and we can just remove the logging.", "author": "lognaturel", "createdAt": "2020-12-18T19:41:12Z", "path": "collect_app/src/main/java/org/odk/collect/android/activities/FormEntryActivity.java", "diffHunk": "@@ -2297,7 +2301,7 @@ public void denied() {\n                         formController.setLanguage(newLanguage);\n                     } catch (Exception e) {\n                         // if somehow we end up with a bad language, set it to the default\n-                        Timber.e(\"Ended up with a bad language. %s\", newLanguage);\n+                        Timber.e(e, \"Ended up with a bad language. %s\", newLanguage);", "originalCommit": "04346f95ae83ca66b6a26527762d6c0fc0e6224a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjExNTkxOQ==", "url": "https://github.com/getodk/collect/pull/4326#discussion_r546115919", "bodyText": "It takes place every time I open the demo form. I think it's caused by language code, we have just label but it should be label::English (en) https://xlsform.org/en/#multiple-language-support", "author": "grzesiek2010", "createdAt": "2020-12-18T22:14:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1Mzk5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjExNjY0NA==", "url": "https://github.com/getodk/collect/pull/4326#discussion_r546116644", "bodyText": "Yeah, I saw the stacktrace locally and realized it's really nothing so I should take this change out.\nIt doesn't have to do with language codes because those are ignored in JR/Collect for now. I think it's just that because no language was explicitly chosen from the menu the database column for language has a null value.", "author": "lognaturel", "createdAt": "2020-12-18T22:16:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1Mzk5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjExNzM0MA==", "url": "https://github.com/getodk/collect/pull/4326#discussion_r546117340", "bodyText": "To be explicit, I think it's important to clarify/clean up this logging because it can waste our time when troubleshooting logs on Crashlytics.", "author": "lognaturel", "createdAt": "2020-12-18T22:18:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjA1Mzk5NA=="}], "type": "inlineReview"}, {"oid": "882b36b9d6f7911ff2460f2afdaa933f9043c36c", "url": "https://github.com/getodk/collect/commit/882b36b9d6f7911ff2460f2afdaa933f9043c36c", "message": "Always update formController for viewmodels when singleton is updated", "committedDate": "2020-12-18T21:49:53Z", "type": "commit"}, {"oid": "d285482fa900eb10b4b785d3cc6cf21f3a589995", "url": "https://github.com/getodk/collect/commit/d285482fa900eb10b4b785d3cc6cf21f3a589995", "message": "Add more logging for attachControlsToInstanceData crash", "committedDate": "2020-12-18T21:50:04Z", "type": "commit"}, {"oid": "8a42eeec4d8a25a50d19c5a9448fb63f389b4926", "url": "https://github.com/getodk/collect/commit/8a42eeec4d8a25a50d19c5a9448fb63f389b4926", "message": "Improve ContentUriProvider logging", "committedDate": "2020-12-18T21:50:04Z", "type": "commit"}, {"oid": "8a42eeec4d8a25a50d19c5a9448fb63f389b4926", "url": "https://github.com/getodk/collect/commit/8a42eeec4d8a25a50d19c5a9448fb63f389b4926", "message": "Improve ContentUriProvider logging", "committedDate": "2020-12-18T21:50:04Z", "type": "forcePushed"}, {"oid": "f11048ec70df535a1b3dcf69b08b37f98a9e16d4", "url": "https://github.com/getodk/collect/commit/f11048ec70df535a1b3dcf69b08b37f98a9e16d4", "message": "Don't remotely log bad language\n\nThis is guaranteed to happen any time a language hasn't been explicitly set by the user.", "committedDate": "2020-12-18T22:17:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjEzNDY2OQ==", "url": "https://github.com/getodk/collect/pull/4326#discussion_r546134669", "bodyText": "This change makes sense. I wonder if we should also maybe dismiss the loading dialog later once we set everything because now we do that at the beginning of this method what unblocks the UI and if the rest of the job we do in this method takes some time it's dangerous.", "author": "grzesiek2010", "createdAt": "2020-12-18T23:02:47Z", "path": "collect_app/src/main/java/org/odk/collect/android/activities/FormEntryActivity.java", "diffHunk": "@@ -2282,6 +2283,8 @@ public void denied() {\n                 t.destroy();\n \n                 Collect.getInstance().setFormController(formController);\n+                formControllerAvailable(formController);", "originalCommit": "f11048ec70df535a1b3dcf69b08b37f98a9e16d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}