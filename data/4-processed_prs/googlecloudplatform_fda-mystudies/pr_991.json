{"pr_number": 991, "pr_title": "Participant manager webapp header changes based on logged in user", "pr_createdAt": "2020-09-18T15:55:57Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991", "timeline": [{"oid": "7afeb5443e4b2ff7af5303dac46e9bcc83fbcf56", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7afeb5443e4b2ff7af5303dac46e9bcc83fbcf56", "message": "header implementation for permission", "committedDate": "2020-09-18T10:55:01Z", "type": "commit"}, {"oid": "ba6875eae701e668f8612eef3b96e9a358f25af0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ba6875eae701e668f8612eef3b96e9a358f25af0", "message": "Merge branch 'participant-manager-webapp-Login-Setup-implementation' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant-manager-webapp-header-changes\n\n# Conflicts:\n#\tUR-web-app/src/app/auth/login-callback/login-callback.component.ts", "committedDate": "2020-09-18T15:54:36Z", "type": "commit"}, {"oid": "bec996851b7855ba9461982e66c8ee98f39b9072", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bec996851b7855ba9461982e66c8ee98f39b9072", "message": "formatting has been dobe", "committedDate": "2020-09-18T15:59:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3MzQzMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#discussion_r491173433", "bodyText": "nit: use ?. to avoid having multiple checks, i.e. user?.manageLocations !== null", "author": "nikklassen", "createdAt": "2020-09-18T20:24:51Z", "path": "UR-web-app/src/app/site-coordinator/mobile-menu/mobile-menu.component.html", "diffHunk": "@@ -75,6 +75,10 @@\n         </li>\n         <li>\n           <a\n+            *ngIf=\"\n+              (user && user.manageLocations !== null) ||", "originalCommit": "bec996851b7855ba9461982e66c8ee98f39b9072", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NDcxNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#discussion_r491174717", "bodyText": "Can you move this to the UserService and use it here and in mobile-menu? Centralizing the logic ensures: the key doesn't change, parsing doesn't change, the default is consistently {}, etc. Basically sessionStorage.getItem(key) should only be called in one place for each key.", "author": "nikklassen", "createdAt": "2020-09-18T20:27:53Z", "path": "UR-web-app/src/app/site-coordinator/sitecoordinator.component.ts", "diffHunk": "@@ -12,10 +13,14 @@ export class SiteCoordinatorComponent implements OnInit {\n   showSearchBar = false;\n   filterQuery = '';\n   searchBar: SearchBar | undefined;\n+  user = {} as Profile;\n \n   constructor(private readonly searchService: SearchService) {}\n \n   ngOnInit(): void {\n+    const userObject = sessionStorage.getItem('user');", "originalCommit": "bec996851b7855ba9461982e66c8ee98f39b9072", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1e70bf6cc3bf6f154388e64918a53812fb0e3470", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1e70bf6cc3bf6f154388e64918a53812fb0e3470", "message": "code review comments has been resolved", "committedDate": "2020-09-21T10:15:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0MzI1OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#discussion_r492043259", "bodyText": "You don't need to save this as a property. It can just be a local variable with how this is written.", "author": "nikklassen", "createdAt": "2020-09-21T13:27:22Z", "path": "UR-web-app/src/app/service/user.service.ts", "diffHunk": "@@ -3,11 +3,20 @@ import {HttpClient} from '@angular/common/http';\n import {User} from '../entity/user';\n import {Observable} from 'rxjs';\n import {environment} from 'src/environments/environment';\n+import {Profile} from '../site-coordinator/account/shared/profile.model';\n @Injectable({providedIn: 'root'})\n export class UserService {\n+  user = {} as Profile;\n+\n   constructor(private readonly http: HttpClient) {}\n \n   getUserDetails(): Observable<User> {\n     return this.http.get<User>(`${environment.baseUrl}/users/profile`);\n   }\n+\n+  getUserProfile(): Profile {\n+    const userObject = sessionStorage.getItem('user');\n+    if (userObject) this.user = JSON.parse(userObject) as Profile;", "originalCommit": "1e70bf6cc3bf6f154388e64918a53812fb0e3470", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ4OTkwNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#discussion_r492489906", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-09-22T06:01:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0MzI1OQ=="}], "type": "inlineReview"}, {"oid": "c97998d7ef5f4a8ac56d968576e875c687357514", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c97998d7ef5f4a8ac56d968576e875c687357514", "message": "code review comments has been resolved", "committedDate": "2020-09-21T15:42:16Z", "type": "commit"}, {"oid": "2ba5a56b0fca7a72824e56bfacc162e42c0270b3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2ba5a56b0fca7a72824e56bfacc162e42c0270b3", "message": "build issue fix\n\nbuild issue fix", "committedDate": "2020-09-21T15:47:13Z", "type": "commit"}, {"oid": "45aa0e5333ea76c97a00f52c2fa20287cbd0b6c1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/45aa0e5333ea76c97a00f52c2fa20287cbd0b6c1", "message": "test build issues fixed", "committedDate": "2020-09-21T16:17:30Z", "type": "commit"}]}