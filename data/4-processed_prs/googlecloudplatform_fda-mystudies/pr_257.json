{"pr_number": 257, "pr_title": "iOS Internal bug fixes.", "pr_createdAt": "2020-04-28T15:02:10Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257", "timeline": [{"oid": "21e5b27b6e95241dbd477aba8782f07dc75482cc", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/21e5b27b6e95241dbd477aba8782f07dc75482cc", "message": "Fix loading responses back to dashboard.", "committedDate": "2020-04-28T06:13:55Z", "type": "commit"}, {"oid": "cc17c2f365f29051dc3e2075eb7c72f55cb6e09f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/cc17c2f365f29051dc3e2075eb7c72f55cb6e09f", "message": "Update activity state to complete after processing the response.", "committedDate": "2020-04-28T14:32:38Z", "type": "commit"}, {"oid": "b3ced6b41e3a346c797d48475eb1f3c8993dfb3e", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b3ced6b41e3a346c797d48475eb1f3c8993dfb3e", "message": "Fix duplication of charts.", "committedDate": "2020-04-28T14:35:22Z", "type": "commit"}, {"oid": "46589e921f464149540bb5e7c975745f13bb96fd", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/46589e921f464149540bb5e7c975745f13bb96fd", "message": "Data should be retained with no action.", "committedDate": "2020-04-28T14:37:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxMDE0Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416710146", "bodyText": "why does this need to be lazy if it's a primitive?", "author": "nikklassen", "createdAt": "2020-04-28T15:31:07Z", "path": "iOS/HPHC/HPHC/Controllers/StudyUI/StudyOverviewUI/StudyHomeViewController.swift", "diffHunk": "@@ -72,6 +72,7 @@ class StudyHomeViewController: UIViewController {\n   var isUpdatingIneligibility: Bool = false\n \n   var consentRestorationData: Data?\n+  lazy var isStudyActivitiesPresented = false", "originalCommit": "46589e921f464149540bb5e7c975745f13bb96fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5ODYyOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416798629", "bodyText": "I see It's not required here. Thanks.", "author": "tushar-boston", "createdAt": "2020-04-28T17:35:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxMDE0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxMzI2Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416713263", "bodyText": "fix indentation here", "author": "nikklassen", "createdAt": "2020-04-28T15:35:11Z", "path": "iOS/HPHC/HPHC/Views/Cells/LineChartCell.swift", "diffHunk": "@@ -296,37 +298,11 @@ class LineChartCell: GraphChartTableViewCell {\n       self.handleWeeksOfMonthForDate(date: hourOfDayDate)\n \n     case .runs:\n-      self.buttonForward.isEnabled = true\n+     self.buttonForward.isEnabled = true", "originalCommit": "46589e921f464149540bb5e7c975745f13bb96fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5Njg4NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416796885", "bodyText": "Done.", "author": "tushar-boston", "createdAt": "2020-04-28T17:32:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxMzI2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxNjAyMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416716023", "bodyText": "This can more cleanly be written as\nif frequencySet.isEmpty {\n  self.graphView.reloadData()\n  return false\n}\nlet sTime = ...\n\nThis reduces nesting and positive conditions are easier to read.", "author": "nikklassen", "createdAt": "2020-04-28T15:37:53Z", "path": "iOS/HPHC/HPHC/Views/Cells/LineChartCell.swift", "diffHunk": "@@ -479,6 +430,40 @@ class LineChartCell: GraphChartTableViewCell {\n     return frequencyRunsSet\n   }\n \n+  @discardableResult\n+  private func plotForRunsType() -> Bool {\n+\n+    frequencyPageIndex = frequencyPageSize * pageNumber\n+    let frequencySet = self.getNextSetOfFrequencyRuns()\n+\n+    if !frequencySet.isEmpty {", "originalCommit": "46589e921f464149540bb5e7c975745f13bb96fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5NjgwOA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416796808", "bodyText": "Yes, Updated.", "author": "tushar-boston", "createdAt": "2020-04-28T17:32:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxNjAyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxNjcwNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416716706", "bodyText": "Combine let and return", "author": "nikklassen", "createdAt": "2020-04-28T15:38:38Z", "path": "iOS/HPHC/HPHC/Utils/Helpers/DateHelper.swift", "diffHunk": "@@ -0,0 +1,48 @@\n+//  Copyright 2020 Google LLC\n+//\n+//  Use of this source code is governed by an MIT-style\n+//  license that can be found in the LICENSE file or at\n+//  https://opensource.org/licenses/MIT.\n+\n+import Foundation\n+\n+enum DateHelper {\n+\n+  static private let runDateFormat = \"yyyy-MM-dd HH:mm:ss Z\"\n+\n+  enum DateType { case date, time }\n+\n+  static var iso8601DateFormatter: DateFormatter {\n+    let dateFormatter = DateFormatter()\n+    let locale = Locale(identifier: \"en_US_POSIX\")\n+    dateFormatter.timeZone = TimeZone.current\n+    dateFormatter.locale = locale\n+    dateFormatter.dateFormat = \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"\n+    return dateFormatter\n+  }\n+\n+  static func stringFromDate(date: Date, format: String) -> String {\n+    let dateFormatter = DateFormatter()\n+    dateFormatter.dateFormat = format\n+    dateFormatter.timeZone = TimeZone.current\n+    dateFormatter.locale = Locale(identifier: \"en_US_POSIX\")\n+    let dateString = dateFormatter.string(from: date)\n+\n+    return dateString", "originalCommit": "46589e921f464149540bb5e7c975745f13bb96fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5NjYyMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416796620", "bodyText": "Done.", "author": "tushar-boston", "createdAt": "2020-04-28T17:32:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxNjcwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxNjc3Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416716772", "bodyText": "Combine let and return", "author": "nikklassen", "createdAt": "2020-04-28T15:38:43Z", "path": "iOS/HPHC/HPHC/Utils/Helpers/DateHelper.swift", "diffHunk": "@@ -0,0 +1,48 @@\n+//  Copyright 2020 Google LLC\n+//\n+//  Use of this source code is governed by an MIT-style\n+//  license that can be found in the LICENSE file or at\n+//  https://opensource.org/licenses/MIT.\n+\n+import Foundation\n+\n+enum DateHelper {\n+\n+  static private let runDateFormat = \"yyyy-MM-dd HH:mm:ss Z\"\n+\n+  enum DateType { case date, time }\n+\n+  static var iso8601DateFormatter: DateFormatter {\n+    let dateFormatter = DateFormatter()\n+    let locale = Locale(identifier: \"en_US_POSIX\")\n+    dateFormatter.timeZone = TimeZone.current\n+    dateFormatter.locale = locale\n+    dateFormatter.dateFormat = \"yyyy-MM-dd'T'HH:mm:ss.SSSZ\"\n+    return dateFormatter\n+  }\n+\n+  static func stringFromDate(date: Date, format: String) -> String {\n+    let dateFormatter = DateFormatter()\n+    dateFormatter.dateFormat = format\n+    dateFormatter.timeZone = TimeZone.current\n+    dateFormatter.locale = Locale(identifier: \"en_US_POSIX\")\n+    let dateString = dateFormatter.string(from: date)\n+\n+    return dateString\n+  }\n+\n+  static func dateFromString(date: String, format: String) -> Date? {\n+    let dateFormatter = DateFormatter()\n+    dateFormatter.dateFormat = format\n+    dateFormatter.timeZone = TimeZone.current\n+    dateFormatter.locale = Locale(identifier: \"en_US_POSIX\")\n+    let date = dateFormatter.date(from: date)\n+\n+    return date", "originalCommit": "46589e921f464149540bb5e7c975745f13bb96fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5NjU4Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416796586", "bodyText": "Done.", "author": "tushar-boston", "createdAt": "2020-04-28T17:32:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxNjc3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxNzU4NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416717585", "bodyText": "Can you rewrite this to remove the force-cast?", "author": "nikklassen", "createdAt": "2020-04-28T15:39:36Z", "path": "iOS/HPHC/HPHC/Controllers/StudyUI/ChartsUI/ChartsViewController.swift", "diffHunk": "@@ -111,26 +111,21 @@ class ChartsViewController: UIViewController {\n extension ChartsViewController: UITableViewDataSource {\n \n   func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {\n-    return 1\n-  }\n-\n-  func numberOfSections(in tableView: UITableView) -> Int {\n     return StudyDashboard.instance.charts.count\n   }\n \n   func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {\n \n-    let chart = StudyDashboard.instance.charts[indexPath.section]\n+    let chart = StudyDashboard.instance.charts[indexPath.row]\n \n     if chart.chartType == \"line-chart\" {\n-\n-      let cell = tableView.dequeueReusableCell(withIdentifier: \"lineChart\") as! LineChartCell\n+      let cell = tableView.dequeueReusableCell(withIdentifier: \"lineChart\", for: indexPath) as! LineChartCell", "originalCommit": "46589e921f464149540bb5e7c975745f13bb96fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5NjU2MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/257#discussion_r416796560", "bodyText": "Done.", "author": "tushar-boston", "createdAt": "2020-04-28T17:32:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjcxNzU4NQ=="}], "type": "inlineReview"}, {"oid": "587065e7cb1ddf0ea04969f9dbd4be1d64f04a59", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/587065e7cb1ddf0ea04969f9dbd4be1d64f04a59", "message": "Style guide cleanup.", "committedDate": "2020-04-28T17:30:37Z", "type": "commit"}, {"oid": "c07b4f05732719d0f7512231673a5518bb7e3f70", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c07b4f05732719d0f7512231673a5518bb7e3f70", "message": "Update project.pbxproj\n\nBuild fix.", "committedDate": "2020-04-28T17:51:57Z", "type": "commit"}, {"oid": "2288ece1a33621367a495d425c973e781d385635", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2288ece1a33621367a495d425c973e781d385635", "message": "Merge branch 'early-access' into ios-ui-update", "committedDate": "2020-04-28T17:52:30Z", "type": "commit"}, {"oid": "995b92f42561fc37e44459a7f0b5de1fbfa97447", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/995b92f42561fc37e44459a7f0b5de1fbfa97447", "message": "Merge branch 'early-access' into ios-ui-update", "committedDate": "2020-04-29T13:47:45Z", "type": "commit"}]}