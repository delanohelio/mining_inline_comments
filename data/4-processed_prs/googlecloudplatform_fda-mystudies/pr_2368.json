{"pr_number": 2368, "pr_title": "PM web app issue #1722 fixed", "pr_createdAt": "2020-12-14T13:56:04Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368", "timeline": [{"oid": "a735dd7dbc63098e93489ed9f061bdd199ae8c2a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a735dd7dbc63098e93489ed9f061bdd199ae8c2a", "message": "issue #1722 fixed", "committedDate": "2020-12-14T13:53:05Z", "type": "commit"}, {"oid": "46970cdd7feca8ff5d258f60eb97a049416b64a7", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/46970cdd7feca8ff5d258f60eb97a049416b64a7", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into pm-webapp-issue-fixing-dec14", "committedDate": "2020-12-14T13:54:10Z", "type": "commit"}, {"oid": "70356cddb64af7dd845cefc4aeacfd063e9328a9", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/70356cddb64af7dd845cefc4aeacfd063e9328a9", "message": "Merge branch 'develop' into pm-webapp-issue-fixing-dec14", "committedDate": "2020-12-14T14:55:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyNTU4NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368#discussion_r542525584", "bodyText": "At first glance looks like you are allowing both view and edit permissions to activate location. The question that comes up is what is then being excluded?\nin other words, what values can manageLocations have and what do each of them mean?\nYou can move these values into well defined constants to make the code more readable.", "author": "zohrehj", "createdAt": "2020-12-14T16:33:00Z", "path": "participant-manager/src/app/service/locations.guard.ts", "diffHunk": "@@ -0,0 +1,23 @@\n+import {Injectable} from '@angular/core';\n+import {CanActivate, UrlTree} from '@angular/router';\n+import {UserService} from '../service/user.service';\n+import {Profile} from '../site-coordinator/account/shared/profile.model';\n+\n+@Injectable({\n+  providedIn: 'root',\n+})\n+export class LocationsGuard implements CanActivate {\n+  user = {} as Profile;\n+\n+  constructor(private readonly userService: UserService) {\n+    this.user = this.userService.getUserProfile();\n+  }\n+\n+  canActivate(): boolean | UrlTree {\n+    return (\n+      this.user.superAdmin ||\n+      this.user.manageLocations === 1 ||\n+      this.user.manageLocations === 0", "originalCommit": "70356cddb64af7dd845cefc4aeacfd063e9328a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUzOTY1Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368#discussion_r542539652", "bodyText": "if manageLocations value is null, it means user has no permissions to manage locations and updated code to check null instead of view or viewAndEdit permission", "author": "firdosebtc1", "createdAt": "2020-12-14T16:50:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyNTU4NA=="}], "type": "inlineReview"}, {"oid": "291174eee660e581770f9f35a5413ba9c20d68c2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/291174eee660e581770f9f35a5413ba9c20d68c2", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into pm-webapp-issue-fixing-dec14\n\n# Conflicts:\n#\tparticipant-manager/src/app/site-coordinator/site-coordinator.module.ts", "committedDate": "2020-12-15T06:22:39Z", "type": "commit"}, {"oid": "7c7eb16e85177cfb7b0e3579c3604bd1cadaa42f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7c7eb16e85177cfb7b0e3579c3604bd1cadaa42f", "message": "code review comments has been fixed", "committedDate": "2020-12-15T06:33:59Z", "type": "commit"}, {"oid": "da3b71361769d6949489a8588ca1b7e46bd8c39c", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/da3b71361769d6949489a8588ca1b7e46bd8c39c", "message": "Merge branch 'develop' into pm-webapp-issue-fixing-dec14", "committedDate": "2020-12-15T14:46:51Z", "type": "commit"}, {"oid": "11a96ecb808ea4535a632bbd3471a869995fc093", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/11a96ecb808ea4535a632bbd3471a869995fc093", "message": "Merge branch 'develop' into pm-webapp-issue-fixing-dec14", "committedDate": "2020-12-15T14:49:24Z", "type": "commit"}]}