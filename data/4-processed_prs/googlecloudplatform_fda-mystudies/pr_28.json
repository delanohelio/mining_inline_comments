{"pr_number": 28, "pr_title": "GKE LoadBalance service for Response server.", "pr_createdAt": "2020-03-26T22:55:22Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28", "timeline": [{"oid": "87e176c3fb33d38fc5a66ce0fb66f8b1c81a3210", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/87e176c3fb33d38fc5a66ce0fb66f8b1c81a3210", "message": "GKE LoadBalance service for Response server.", "committedDate": "2020-03-26T22:51:52Z", "type": "commit"}, {"oid": "8aed38388bb7937c07505b607c132c75a4c0748b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8aed38388bb7937c07505b607c132c75a4c0748b", "message": "Update pom.xml. Add Dockerfile.", "committedDate": "2020-03-27T05:17:35Z", "type": "commit"}, {"oid": "077ea727e44093ddb86ffd3d66c8e356181744db", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/077ea727e44093ddb86ffd3d66c8e356181744db", "message": "Use env variables for db username and password", "committedDate": "2020-03-27T05:48:28Z", "type": "commit"}, {"oid": "f358673a970f1d3354e70acbce6a585a8a1ae238", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f358673a970f1d3354e70acbce6a585a8a1ae238", "message": "add deployment.yaml", "committedDate": "2020-03-27T05:48:45Z", "type": "commit"}, {"oid": "ceec550ed735479c8595346dc8bd5b8b02318729", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ceec550ed735479c8595346dc8bd5b8b02318729", "message": "Remove typo file ParticipanDaoImpl", "committedDate": "2020-03-27T06:09:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNDI5OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399334299", "bodyText": "how come this file was deleted, and not renamed?", "author": "zohrehj", "createdAt": "2020-03-27T15:08:58Z", "path": "response-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/ParticipanDaoImpl.java", "diffHunk": "@@ -1,135 +0,0 @@\n-/**", "originalCommit": "ceec550ed735479c8595346dc8bd5b8b02318729", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM5MTc4OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399391788", "bodyText": "I'm not sure either and this was the error I saw when bringing up the server without removing this file:\nCaused by: org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type 'com.google.cloud.healthcare.fdamystudies.dao.ParticipantDao' available: expected single matching bean but found 2: participanDaoImpl,participantDaoImpl", "author": "kuoyuchi", "createdAt": "2020-03-27T16:32:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNDI5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNDc3Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399334777", "bodyText": "nit: I noticed spacing is not consistent. Is that something that's been addressed in the other PR?", "author": "zohrehj", "createdAt": "2020-03-27T15:09:42Z", "path": "response-server-ws/pom.xml", "diffHunk": "@@ -29,6 +29,17 @@ https://opensource.org/licenses/MIT.  -->\n \t\t\t<plugin>\n \t\t\t\t<groupId>org.springframework.boot</groupId>\n \t\t\t\t<artifactId>spring-boot-maven-plugin</artifactId>\n+        <configuration>\n+          <mainClass>om.google.cloud.healthcare.fdamystudies.FdaMystudiesResponseServerApplication</mainClass>\n+          <layout>WAR</layout>\n+        </configuration>\n+        <executions>\n+          <execution>\n+            <goals>\n+              <goal>repackage</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n \t\t\t</plugin>", "originalCommit": "ceec550ed735479c8595346dc8bd5b8b02318729", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM5OTAzNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399399036", "bodyText": "A classic space vs tab issue here. It rendered the same on my editor so I didn't even notice :) Fixed this now.", "author": "kuoyuchi", "createdAt": "2020-03-27T16:42:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNDc3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNTk1NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399335955", "bodyText": "please add a comment that the value should be changed prior to deployment", "author": "zohrehj", "createdAt": "2020-03-27T15:11:26Z", "path": "response-server-ws/src/main/resources/application.properties", "diffHunk": "@@ -10,9 +10,9 @@ spring.jpa.show-sql=true\n spring.jpa.hibernate.ddl-auto=update\n \n #Database details\n-spring.datasource.url=jdbc:mysql://dummy-value/mystudies_response_server?autoReconnect=true&characterEncoding=utf8&useSSL=false\n-spring.datasource.username=dummy-value\n-spring.datasource.password=dummy-value\n+spring.datasource.url=jdbc:mysql://127.0.0.1:3306/mystudies_response_server?autoReconnect=true&characterEncoding=utf8&useSSL=false", "originalCommit": "ceec550ed735479c8595346dc8bd5b8b02318729", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNDIxOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399404219", "bodyText": "Done. Added a TODO to make these a env variable.", "author": "kuoyuchi", "createdAt": "2020-03-27T16:50:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNTk1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4ODk2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399388962", "bodyText": "typo", "author": "wamills", "createdAt": "2020-03-27T16:27:58Z", "path": "response-server-ws/pom.xml", "diffHunk": "@@ -29,6 +29,17 @@ https://opensource.org/licenses/MIT.  -->\n \t\t\t<plugin>\n \t\t\t\t<groupId>org.springframework.boot</groupId>\n \t\t\t\t<artifactId>spring-boot-maven-plugin</artifactId>\n+        <configuration>\n+          <mainClass>om.google.cloud.healthcare.fdamystudies.FdaMystudiesResponseServerApplication</mainClass>", "originalCommit": "ceec550ed735479c8595346dc8bd5b8b02318729", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM5OTM4OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399399388", "bodyText": "Good catch! Fixed.", "author": "kuoyuchi", "createdAt": "2020-03-27T16:43:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4ODk2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4OTMyNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399389324", "bodyText": "Were you able to get this to compile with this plugin? Myself and others were getting an error of no main file found.", "author": "wamills", "createdAt": "2020-03-27T16:28:35Z", "path": "response-server-ws/pom.xml", "diffHunk": "@@ -29,6 +29,17 @@ https://opensource.org/licenses/MIT.  -->\n \t\t\t<plugin>\n \t\t\t\t<groupId>org.springframework.boot</groupId>", "originalCommit": "ceec550ed735479c8595346dc8bd5b8b02318729", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM5MzY5MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399393691", "bodyText": "It works with the  tag specified below. See here for more details: https://docs.spring.io/spring-boot/docs/current/maven-plugin/usage.html", "author": "kuoyuchi", "createdAt": "2020-03-27T16:35:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4OTMyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4OTkwMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399389903", "bodyText": "Do you think it matters that the example used port 50000? We could update both here and in deployment yaml if so. But that may also involve modifying the tomcat port so probably not worth it.", "author": "wamills", "createdAt": "2020-03-27T16:29:23Z", "path": "response-server-ws/service.yaml", "diffHunk": "@@ -0,0 +1,14 @@\n+# LoadBalancer service for Response server.\n+# See https://cloud.google.com/kubernetes-engine/docs/how-to/exposing-apps#creating_a_service_of_type_loadbalancer\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: response-server-lb\n+spec:\n+  type: LoadBalancer\n+  selector:\n+    app: response-server\n+  ports:\n+  - protocol: TCP\n+    port: 60000\n+    targetPort: 8080", "originalCommit": "ceec550ed735479c8595346dc8bd5b8b02318729", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNDM1Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399404352", "bodyText": "Changed to 50000.", "author": "kuoyuchi", "createdAt": "2020-03-27T16:51:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4OTkwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM5MDU3OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399390578", "bodyText": "Can you add a comment that this is for connecting to the Google SQL proxy?\nI had some comments for which plugins to use for which properties here: 22d9449", "author": "wamills", "createdAt": "2020-03-27T16:30:25Z", "path": "response-server-ws/src/main/resources/application.properties", "diffHunk": "@@ -10,9 +10,9 @@ spring.jpa.show-sql=true\n spring.jpa.hibernate.ddl-auto=update\n \n #Database details\n-spring.datasource.url=jdbc:mysql://dummy-value/mystudies_response_server?autoReconnect=true&characterEncoding=utf8&useSSL=false\n-spring.datasource.username=dummy-value\n-spring.datasource.password=dummy-value\n+spring.datasource.url=jdbc:mysql://127.0.0.1:3306/mystudies_response_server?autoReconnect=true&characterEncoding=utf8&useSSL=false", "originalCommit": "ceec550ed735479c8595346dc8bd5b8b02318729", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQwNDUzMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/28#discussion_r399404530", "bodyText": "Done. Copied from your commit to here. Thanks!", "author": "kuoyuchi", "createdAt": "2020-03-27T16:51:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM5MDU3OA=="}], "type": "inlineReview"}, {"oid": "80fa3129503732a7562a3b8d12cff1d07ec724a2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/80fa3129503732a7562a3b8d12cff1d07ec724a2", "message": "Add port in deployment.yaml", "committedDate": "2020-03-27T16:34:23Z", "type": "commit"}, {"oid": "e68bf66b147a69361158279debc3da25e84a3fca", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e68bf66b147a69361158279debc3da25e84a3fca", "message": "Fix format and typo in pom.xml", "committedDate": "2020-03-27T16:37:03Z", "type": "commit"}, {"oid": "895326395d2b9db69defbe4668c5cab511b9f904", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/895326395d2b9db69defbe4668c5cab511b9f904", "message": "s/60000/50000/ for service port.", "committedDate": "2020-03-27T16:38:08Z", "type": "commit"}, {"oid": "6ce919ba6468472cb3aacdc284222f522bc7af11", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6ce919ba6468472cb3aacdc284222f522bc7af11", "message": "change spaces to tabs", "committedDate": "2020-03-27T16:48:53Z", "type": "commit"}, {"oid": "a79c78695036bf5391b24fbf4c8249ffe9bb07b1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a79c78695036bf5391b24fbf4c8249ffe9bb07b1", "message": "Add comment in properties file.", "committedDate": "2020-03-27T16:49:07Z", "type": "commit"}, {"oid": "f94f78a09bec0ba86b9659424aa10161ae0461a9", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f94f78a09bec0ba86b9659424aa10161ae0461a9", "message": "update dev properties file", "committedDate": "2020-03-27T16:49:51Z", "type": "commit"}]}