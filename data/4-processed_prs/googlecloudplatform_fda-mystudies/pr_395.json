{"pr_number": 395, "pr_title": "Make UserInstitution user_institution_id and user_details_id unique.", "pr_createdAt": "2020-05-13T22:29:31Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/395", "timeline": [{"oid": "3c387a39eede808e35c991be3346642ac020c2c8", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3c387a39eede808e35c991be3346642ac020c2c8", "message": "ake UserInstitution id unique.", "committedDate": "2020-05-13T22:27:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MTkxNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/395#discussion_r424771914", "bodyText": "Can we put these under the CREATE TABLE IF NOT EXISTS user_institution statement?", "author": "kuoyuchi", "createdAt": "2020-05-13T22:41:54Z", "path": "user-registration-server-ws/sqlscript/mystudies_user_registration_db_script.sql", "diffHunk": "@@ -456,6 +464,9 @@ CREATE TABLE IF NOT EXISTS `user_institution` (\n \r\n -- Data exporting was unselected.\r\n \r\n+ALTER TABLE user_institution ADD CONSTRAINT  user_institution_id_unique UNIQUE (user_institution_id);\r", "originalCommit": "3c387a39eede808e35c991be3346642ac020c2c8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3NDM2OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/395#discussion_r424774368", "bodyText": "Like this?", "author": "wamills", "createdAt": "2020-05-13T22:48:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3NTM1OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/395#discussion_r424775359", "bodyText": "I meant something like:\nCREATE TABLE IF NOT EXISTS `user_institution` (\n  `user_institution_id` BIGINT NOT NULL AUTO_INCREMENT,\n  ...\n  PRIMARY KEY (`user_institution_id`),\n CONSTRAINT  user_institution_id_unique UNIQUE (user_institution_id),\n  CONSTRAINT  user_details_id_unique UNIQUE (user_details_id)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\nPlease ignore if this doesn't work. Thanks!", "author": "kuoyuchi", "createdAt": "2020-05-13T22:51:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc4ODU0MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/395#discussion_r424788540", "bodyText": "+1 I think you should be able to do this when creating the table.", "author": "karepker", "createdAt": "2020-05-13T23:31:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MTkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIxNDE2NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/395#discussion_r425214165", "bodyText": "Done, added. Did the same for the personalization table.", "author": "wamills", "createdAt": "2020-05-14T15:11:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc3MTkxNA=="}], "type": "inlineReview"}, {"oid": "38f1220941f19ad3070ebf333dcd93cee8547c52", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/38f1220941f19ad3070ebf333dcd93cee8547c52", "message": "Move alter table statements under table creation statement.", "committedDate": "2020-05-13T22:47:46Z", "type": "commit"}, {"oid": "2fe951e79e5f28682fcf5f8406462cc139c697a2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2fe951e79e5f28682fcf5f8406462cc139c697a2", "message": "Combine constraints with table creation.", "committedDate": "2020-05-14T15:08:03Z", "type": "commit"}, {"oid": "3811aed38e03b1ce2af7232e84fbb5417f11bf09", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3811aed38e03b1ce2af7232e84fbb5417f11bf09", "message": "Merge branch 'early-access' into institution_uniqueness_fix", "committedDate": "2020-05-14T16:23:17Z", "type": "commit"}, {"oid": "3430e7245fba6fbbca5ee007db575ea6181fddda", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3430e7245fba6fbbca5ee007db575ea6181fddda", "message": "Merge branch 'early-access' into institution_uniqueness_fix", "committedDate": "2020-05-14T16:32:43Z", "type": "commit"}]}