{"pr_number": 849, "pr_title": "Participant Manager Webapp update user", "pr_createdAt": "2020-08-28T16:06:57Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/849", "timeline": [{"oid": "0e4277d5a870338245a217407c69382d72610e1c", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0e4277d5a870338245a217407c69382d72610e1c", "message": "update user has been implemented", "committedDate": "2020-08-28T16:02:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQyOTQ1OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/849#discussion_r479429459", "bodyText": "Don't return a boolean from a ternary operator. This is exactly the same as this.user.manageLocationsSelected = this.user.manageLocations", "author": "nikklassen", "createdAt": "2020-08-28T17:04:09Z", "path": "UR-web-app/src/app/site-coordinator/user/update-user/update-user.component.ts", "diffHunk": "@@ -1,8 +1,213 @@\n-import {Component} from '@angular/core';\n+import {Component, OnInit} from '@angular/core';\n+import {UserService} from '../shared/user.service';\n+import {Router, ActivatedRoute} from '@angular/router';\n+import {ToastrService} from 'ngx-toastr';\n+import {AppDetails, App, Study, Site} from '../shared/app-details';\n+import {User} from 'src/app/entity/user';\n+import {ApiResponse} from 'src/app/entity/api.response.model';\n+import {getMessage} from 'src/app/shared/success.codes.enum';\n+import {Permission} from 'src/app/shared/permission-enums';\n+import {AppsService} from '../../apps/shared/apps.service';\n+import {UnsubscribeOnDestroyAdapter} from 'src/app/unsubscribe-on-destroy-adapter';\n+import {\n+  ManageUserDetails,\n+  UpdateStatusRequest,\n+} from '../shared/manage-user-details';\n+import {Status} from 'src/app/shared/enums';\n \n @Component({\n   selector: 'user-update',\n   templateUrl: './update-user.component.html',\n-  styleUrls: ['./update-user.component.scss'],\n })\n-export class UpdateUserComponent {}\n+export class UpdateUserComponent extends UnsubscribeOnDestroyAdapter\n+  implements OnInit {\n+  appDetails = {} as AppDetails;\n+  selectedApps: App[] = [];\n+  user = {} as User;\n+  permission = Permission;\n+  adminId = '';\n+  userStatus = Status;\n+  sitesMessageMapping: {[k: string]: string} = {\n+    '=0': '0 Sites',\n+    '=1': '1 Site',\n+    'other': '# Sites',\n+  };\n+\n+  constructor(\n+    private readonly router: Router,\n+    private readonly userService: UserService,\n+    private readonly appsService: AppsService,\n+    private readonly toastr: ToastrService,\n+    private readonly route: ActivatedRoute,\n+  ) {\n+    super();\n+  }\n+\n+  ngOnInit(): void {\n+    this.subs.add(\n+      this.route.params.subscribe((params) => {\n+        if (params.userId) {\n+          this.adminId = params.userId as string;\n+        }\n+        this.getUserDetails();\n+      }),\n+    );\n+  }\n+\n+  getUserDetails(): void {\n+    this.subs.add(\n+      this.userService\n+        .getUserDetails(this.adminId)\n+        .subscribe((data: ManageUserDetails) => {\n+          this.user = data.user;\n+          this.user.manageLocationsSelected = this.user.manageLocations\n+            ? true\n+            : false;", "originalCommit": "0e4277d5a870338245a217407c69382d72610e1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc0NjE3Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/849#discussion_r483746173", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-09-04T16:55:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQyOTQ1OQ=="}], "type": "inlineReview"}, {"oid": "dce29b1f4f7f5dbbeb575698b3f26903a2fad9d7", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/dce29b1f4f7f5dbbeb575698b3f26903a2fad9d7", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant-manager-webapp-update-user", "committedDate": "2020-09-04T05:55:57Z", "type": "commit"}, {"oid": "59620a5495e0a87efcea8edecec53000dfc78278", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/59620a5495e0a87efcea8edecec53000dfc78278", "message": "code review comments and testing has been done", "committedDate": "2020-09-04T16:17:28Z", "type": "commit"}, {"oid": "42a8adde3485f1472529845a92164a5b43856b7c", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/42a8adde3485f1472529845a92164a5b43856b7c", "message": "removed unwanted attrbutes before making API call", "committedDate": "2020-09-07T11:45:20Z", "type": "commit"}, {"oid": "2043305d1204cec7da4642484fb08663b8ddb841", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2043305d1204cec7da4642484fb08663b8ddb841", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant-manager-webapp-update-user", "committedDate": "2020-09-07T11:45:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTAyMjgxOA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/849#discussion_r485022818", "bodyText": "Why are they unwanted? Remove from what? Please make this function name clearer", "author": "nikklassen", "createdAt": "2020-09-08T15:47:24Z", "path": "UR-web-app/src/app/site-coordinator/user/update-user/update-user.component.ts", "diffHunk": "@@ -210,4 +213,12 @@ export class UpdateUserComponent extends UnsubscribeOnDestroyAdapter\n             : this.userStatus.Deactivated;\n       });\n   }\n+  removeUnwantedAttributes(): void {", "originalCommit": "2043305d1204cec7da4642484fb08663b8ddb841", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTY1NjkwNQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/849#discussion_r485656905", "bodyText": "getUserDetails api response has status, selectedStudiesCount, totalStudiesCount attributes along with other attributes and same response is displayed in update user form and same response  will go to update user API as a request body but we are getting violation exception from web service and as per discussion with web service team we need to remove that status, selectedStudiesCoun, totalStudiesCount attributes from JSON before making  update user API call as it is not required in web service side and these attributes are not present in the request bean", "author": "firdosebtc1", "createdAt": "2020-09-09T14:28:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTAyMjgxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgzNjI0MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/849#discussion_r485836241", "bodyText": "Can you update the function name to answer these questions?", "author": "nikklassen", "createdAt": "2020-09-09T18:44:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTAyMjgxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA4MjU4MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/849#discussion_r487082581", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-09-11T14:28:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTAyMjgxOA=="}], "type": "inlineReview"}, {"oid": "b4c5337f2f8a7662c4bafd0318bd689c384c18c2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b4c5337f2f8a7662c4bafd0318bd689c384c18c2", "message": "updated method name", "committedDate": "2020-09-11T14:25:31Z", "type": "commit"}, {"oid": "cb023c639eea5a33342a99376c1b7b6d86e4d97e", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/cb023c639eea5a33342a99376c1b7b6d86e4d97e", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant-manager-webapp-update-user", "committedDate": "2020-09-11T14:25:54Z", "type": "commit"}]}