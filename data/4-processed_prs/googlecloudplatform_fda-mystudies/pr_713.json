{"pr_number": 713, "pr_title": "Data integrity checks for entities", "pr_createdAt": "2020-07-31T15:14:02Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713", "timeline": [{"oid": "f805f60cfbb3bf086c48d6a91ac257296571afa7", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f805f60cfbb3bf086c48d6a91ac257296571afa7", "message": "data integrity checks for all the entity classes", "committedDate": "2020-07-31T14:50:56Z", "type": "commit"}, {"oid": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "message": "modified with string comparison", "committedDate": "2020-07-31T15:10:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MDgzMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463680832", "bodyText": "please remove these line breaks. Import statements should be added in only two blocks, one for static and one for non static imports. Please refer to the style guide for more detail.", "author": "zohrehj", "createdAt": "2020-07-31T15:32:35Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -12,6 +12,7 @@\n import java.sql.Timestamp;\n import java.util.ArrayList;\n import java.util.List;\n+", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA2ODI4Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465068287", "bodyText": "please address all formatting issues across the PR.", "author": "zohrehj", "createdAt": "2020-08-04T13:56:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MDgzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTgzMDc1Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465830757", "bodyText": "formatted Import statements with only two blocks, one for static and one for non static imports.", "author": "aswinijena100", "createdAt": "2020-08-05T15:55:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MDgzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MTE4OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463681189", "bodyText": "doesn't look in scope, also not why we should ignore the case here?\nIgnoring the code significantly reduces the complexity of the code and makes it much easier to brute force.", "author": "zohrehj", "createdAt": "2020-07-31T15:33:15Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/OnboardingStatus.java", "diffHunk": "@@ -28,7 +28,7 @@ private OnboardingStatus(String code, String status) {\n \n   public static OnboardingStatus fromCode(String code) {\n     for (OnboardingStatus e : OnboardingStatus.values()) {\n-      if (e.code == code) {\n+      if (e.code.equalsIgnoreCase(code)) {", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4NDUwNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464284506", "bodyText": "One of the test cases were failing for participant-manager , hence the change. Also replaced equalsIgnoreCase with equals .", "author": "aswinijena100", "createdAt": "2020-08-03T09:01:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MTE4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ4NzAwMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r469487002", "bodyText": "I am still seeing equalsIgnoreCase here. Please change back to ==", "author": "zohrehj", "createdAt": "2020-08-12T19:22:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MTE4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MjE1MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463682151", "bodyText": "I am fairly sure that study builder UI limits this to 15 characters.\nPlease make sure these conditions are exactly the same.", "author": "zohrehj", "createdAt": "2020-07-31T15:34:58Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -44,18 +50,27 @@\n   @Id\n   @GeneratedValue(generator = \"system-uuid\")\n   @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n-  @Column(name = \"app_info_id\", updatable = false, nullable = false)\n+  @Column(\n+      name = \"app_info_id\",\n+      updatable = false,\n+      nullable = false,\n+      length = ColumnConstraints.ID_LENGTH)\n   private String id;\n \n   @ToString.Exclude\n-  @Column(name = \"custom_app_id\")\n+  @Column(\n+      name = \"custom_app_id\",\n+      nullable = false,\n+      unique = true,\n+      length = ColumnConstraints.XS_LENGTH)", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4NTI5MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464285290", "bodyText": "created new constant with name APP_STUDY_ID_LENGTH = 15 in ColumnConstraints.java class for custom_app_id and custom_study_id.", "author": "aswinijena100", "createdAt": "2020-08-03T09:02:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MjE1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MzAwMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463683003", "bodyText": "No need to add a length constraint for autogenerated values. Let's go with the default.", "author": "zohrehj", "createdAt": "2020-07-31T15:36:26Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -44,18 +50,27 @@\n   @Id\n   @GeneratedValue(generator = \"system-uuid\")\n   @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n-  @Column(name = \"app_info_id\", updatable = false, nullable = false)\n+  @Column(\n+      name = \"app_info_id\",\n+      updatable = false,\n+      nullable = false,\n+      length = ColumnConstraints.ID_LENGTH)", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTgzMTE1Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465831152", "bodyText": "removed length for auto generated values", "author": "aswinijena100", "createdAt": "2020-08-05T15:56:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY4MzAwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcwODkwNQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463708905", "bodyText": "this column should not be null, we need to start pulling this value for the branding text so makes sense to ensure its not empty.", "author": "zohrehj", "createdAt": "2020-07-31T16:26:39Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -44,18 +50,27 @@\n   @Id\n   @GeneratedValue(generator = \"system-uuid\")\n   @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n-  @Column(name = \"app_info_id\", updatable = false, nullable = false)\n+  @Column(\n+      name = \"app_info_id\",\n+      updatable = false,\n+      nullable = false,\n+      length = ColumnConstraints.ID_LENGTH)\n   private String id;\n \n   @ToString.Exclude\n-  @Column(name = \"custom_app_id\")\n+  @Column(\n+      name = \"custom_app_id\",\n+      nullable = false,\n+      unique = true,\n+      length = ColumnConstraints.XS_LENGTH)\n   private String appId;\n \n   @ToString.Exclude\n-  @Column(name = \"app_name\")\n+  @Column(name = \"app_name\", length = ColumnConstraints.SMALL_LENGTH)", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4NTgwMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464285800", "bodyText": "added not null constraint for this column.", "author": "aswinijena100", "createdAt": "2020-08-03T09:03:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcwODkwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxMTk0Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463711947", "bodyText": "feel free to remove all org related information for now", "author": "zohrehj", "createdAt": "2020-07-31T16:32:58Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -64,61 +79,64 @@\n   private OrgInfoEntity orgInfo;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4NjQwMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464286400", "bodyText": "We'll address this issue once all the Participant Manager PR's are approved/merged into develop to avoid too many conflicts during merge. Already one issue #688 created for this.", "author": "aswinijena100", "createdAt": "2020-08-03T09:04:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxMTk0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxNDE2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463714162", "bodyText": "I had assumed this would be foreign key to a user table etc\nWhat is expected to be stored here that requires large amount of space?", "author": "zohrehj", "createdAt": "2020-07-31T16:37:41Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -64,61 +79,64 @@\n   private OrgInfoEntity orgInfo;\n \n   @ToString.Exclude\n-  @Column(name = \"ios_bundle_id\")\n+  @Column(name = \"ios_bundle_id\", length = ColumnConstraints.SMALL_LENGTH)\n   private String iosBundleId;\n \n   @ToString.Exclude\n-  @Column(name = \"android_bundle_id\")\n+  @Column(name = \"android_bundle_id\", length = ColumnConstraints.SMALL_LENGTH)\n   private String androidBundleId;\n \n   @ToString.Exclude\n   @Column(name = \"ios_certificate\")\n+  @Type(type = \"text\")\n   private String iosCertificate;\n \n   @ToString.Exclude\n-  @Column(name = \"ios_certificate_password\")\n+  @Column(name = \"ios_certificate_password\", length = ColumnConstraints.SMALL_LENGTH)\n   private String iosCertificatePassword;\n \n   @ToString.Exclude\n-  @Column(name = \"android_server_key\")\n+  @Column(name = \"android_server_key\", length = ColumnConstraints.LARGE_LENGTH)\n   private String androidServerKey;\n \n   @ToString.Exclude\n-  @Column(name = \"from_email_id\")\n+  @Column(name = \"from_email_id\", length = ColumnConstraints.LARGE_LENGTH)\n   private String formEmailId;\n \n   @ToString.Exclude\n-  @Column(name = \"from_email_password\")\n+  @Column(name = \"from_email_password\", length = ColumnConstraints.LARGE_LENGTH)\n   private String fromEmailPassword;\n \n   @ToString.Exclude\n-  @Column(name = \"reg_email_sub\")\n+  @Column(name = \"reg_email_sub\", length = ColumnConstraints.LARGE_LENGTH)\n   private String regEmailSub;\n \n   @ToString.Exclude\n   @Column(name = \"reg_email_body\")\n+  @Type(type = \"text\")\n   private String regEmailBody;\n \n   @ToString.Exclude\n-  @Column(name = \"forgot_email_sub\")\n+  @Column(name = \"forgot_email_sub\", length = ColumnConstraints.LARGE_LENGTH)\n   private String forgotEmailSub;\n \n   @Column(name = \"forgot_email_body\")\n+  @Type(type = \"text\")\n   private String forgotEmailBody;\n \n-  @Column(name = \"method_handler\")\n+  @Column(name = \"method_handler\", length = ColumnConstraints.TINY_LENGTH)\n   private Integer methodHandler;\n \n-  @Column(name = \"created_by\")\n+  @Column(name = \"created_by\", length = ColumnConstraints.LARGE_LENGTH)\n   private String createdBy;\n \n-  @Column(name = \"modified_by\")\n+  @Column(name = \"modified_by\", length = ColumnConstraints.LARGE_LENGTH)\n   private String modifiedBy;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4NzEzMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464287131", "bodyText": "created_by and modified_by will be the user id created by the Auth server after registration", "author": "aswinijena100", "createdAt": "2020-08-03T09:05:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxNDE2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxNTg4OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463715889", "bodyText": "Should probably use @UpdateTimestamp instead of manually updating this", "author": "zohrehj", "createdAt": "2020-07-31T16:41:24Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -64,61 +79,64 @@\n   private OrgInfoEntity orgInfo;\n \n   @ToString.Exclude\n-  @Column(name = \"ios_bundle_id\")\n+  @Column(name = \"ios_bundle_id\", length = ColumnConstraints.SMALL_LENGTH)\n   private String iosBundleId;\n \n   @ToString.Exclude\n-  @Column(name = \"android_bundle_id\")\n+  @Column(name = \"android_bundle_id\", length = ColumnConstraints.SMALL_LENGTH)\n   private String androidBundleId;\n \n   @ToString.Exclude\n   @Column(name = \"ios_certificate\")\n+  @Type(type = \"text\")\n   private String iosCertificate;\n \n   @ToString.Exclude\n-  @Column(name = \"ios_certificate_password\")\n+  @Column(name = \"ios_certificate_password\", length = ColumnConstraints.SMALL_LENGTH)\n   private String iosCertificatePassword;\n \n   @ToString.Exclude\n-  @Column(name = \"android_server_key\")\n+  @Column(name = \"android_server_key\", length = ColumnConstraints.LARGE_LENGTH)\n   private String androidServerKey;\n \n   @ToString.Exclude\n-  @Column(name = \"from_email_id\")\n+  @Column(name = \"from_email_id\", length = ColumnConstraints.LARGE_LENGTH)\n   private String formEmailId;\n \n   @ToString.Exclude\n-  @Column(name = \"from_email_password\")\n+  @Column(name = \"from_email_password\", length = ColumnConstraints.LARGE_LENGTH)\n   private String fromEmailPassword;\n \n   @ToString.Exclude\n-  @Column(name = \"reg_email_sub\")\n+  @Column(name = \"reg_email_sub\", length = ColumnConstraints.LARGE_LENGTH)\n   private String regEmailSub;\n \n   @ToString.Exclude\n   @Column(name = \"reg_email_body\")\n+  @Type(type = \"text\")\n   private String regEmailBody;\n \n   @ToString.Exclude\n-  @Column(name = \"forgot_email_sub\")\n+  @Column(name = \"forgot_email_sub\", length = ColumnConstraints.LARGE_LENGTH)\n   private String forgotEmailSub;\n \n   @Column(name = \"forgot_email_body\")\n+  @Type(type = \"text\")\n   private String forgotEmailBody;\n \n-  @Column(name = \"method_handler\")\n+  @Column(name = \"method_handler\", length = ColumnConstraints.TINY_LENGTH)\n   private Integer methodHandler;\n \n-  @Column(name = \"created_by\")\n+  @Column(name = \"created_by\", length = ColumnConstraints.LARGE_LENGTH)\n   private String createdBy;\n \n-  @Column(name = \"modified_by\")\n+  @Column(name = \"modified_by\", length = ColumnConstraints.LARGE_LENGTH)\n   private String modifiedBy;\n \n   @Column(\n       name = \"modified_date\",\n       insertable = false,\n-      updatable = false,\n+      updatable = true,\n       columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n   private Timestamp modified;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4NzU2OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464287569", "bodyText": "added @UpdateTimestamp for modified date column for all entities", "author": "aswinijena100", "createdAt": "2020-08-03T09:06:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxNTg4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyMDk4Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463720983", "bodyText": "why change this?\nAlso you can probably use @CreateTimestamp annotation here", "author": "zohrehj", "createdAt": "2020-07-31T16:52:26Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppPermissionEntity.java", "diffHunk": "@@ -56,12 +61,12 @@\n   private Integer edit;\n \n   @Column(\n-      name = \"created\",\n+      name = \"created_on\",", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4ODMxMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464288311", "bodyText": "To make it consistent across all the entities changed to created_on. Also added @CreationTimestamp for all the entities.", "author": "aswinijena100", "createdAt": "2020-08-03T09:08:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyMDk4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyMzgyNQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463723825", "bodyText": "please remove orgId", "author": "zohrehj", "createdAt": "2020-07-31T16:58:31Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/OrgInfoEntity.java", "diffHunk": "@@ -45,13 +47,17 @@\n   @Id\n   @GeneratedValue(generator = \"system-uuid\")\n   @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n-  @Column(name = \"id\", updatable = false, nullable = false)\n+  @Column(\n+      name = \"org_info_id\",\n+      updatable = false,\n+      nullable = false,\n+      length = ColumnConstraints.ID_LENGTH)\n   private String id;\n \n-  @Column(name = \"name\")\n+  @Column(name = \"name\", length = ColumnConstraints.SMALL_LENGTH)\n   private String name;\n \n-  @Column(name = \"org_id\")\n+  @Column(name = \"org_id\", nullable = false, unique = true, length = ColumnConstraints.XS_LENGTH)\n   private String orgId;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4ODU2NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464288565", "bodyText": "We'll address this issue once all the Participant Manager PR's are approved/merged into develop to avoid too many conflicts during merge. Already one issue #688  created for this.", "author": "aswinijena100", "createdAt": "2020-08-03T09:08:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyMzgyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNjc5MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463726791", "bodyText": "I think the length of enrollment token in the code is significantly smaller.", "author": "zohrehj", "createdAt": "2020-07-31T17:04:39Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantRegistrySiteEntity.java", "diffHunk": "@@ -90,22 +99,32 @@\n   private Timestamp enrollmentTokenExpiry;\n \n   @ToString.Exclude\n-  @Column(name = \"onboarding_status\")\n+  @Column(name = \"onboarding_status\", length = ColumnConstraints.TINY_LENGTH)\n   private String onboardingStatus;\n \n-  @Column(name = \"enrollment_token\")\n+  @Column(name = \"enrollment_token\", unique = true, length = ColumnConstraints.SMALL_LENGTH)", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI4OTc4MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464289780", "bodyText": "Please let us know fixed length for this property. For now we are creating 8 characters token for testing purpose However it can be any length by considering this token needs to enter by the user by enrolling into a study.", "author": "aswinijena100", "createdAt": "2020-08-03T09:11:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNjc5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNzYyMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463727621", "bodyText": "I was under the impression that participant_id would be unique across entire table.\nThis constraint means that you could have the same participant registered under more than one site. Is that what we want?", "author": "zohrehj", "createdAt": "2020-07-31T17:06:25Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantStudyEntity.java", "diffHunk": "@@ -36,7 +40,13 @@\n @Setter\n @Getter\n @Entity\n-@Table(name = \"participant_study_info\")\n+@Table(\n+    name = \"participant_study_info\",\n+    uniqueConstraints = {\n+      @UniqueConstraint(\n+          columnNames = {\"participant_id\", \"site_id\"},", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI5MTA5MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464291091", "bodyText": "Yes, participant id is uniquely generated by response server using UUID. However added additional check for the same.\nPlease let me know if you want me to remove this constraint .", "author": "aswinijena100", "createdAt": "2020-08-03T09:13:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNzYyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA2Njc4NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465066785", "bodyText": "let me rephrase: is it okay for one participant_id to be registered in more than one site?\nif that's not what we want, then we could make it unique per study_id instead. or unique on its own, if it gets generated within a study context, i.e. if new participant_id is generated per user, per study", "author": "zohrehj", "createdAt": "2020-08-04T13:53:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNzYyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTgzOTIwMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465839202", "bodyText": "Yes participant_id is generated per user, per study .Hence participant_id will be unique always when ever user enroll into a study.", "author": "aswinijena100", "createdAt": "2020-08-05T16:08:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNzYyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk4MDQ5MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465980490", "bodyText": "and my original question:\n\" is it okay for one participant_id to be registered in more than one site?\"", "author": "zohrehj", "createdAt": "2020-08-05T20:20:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNzYyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5NjY4MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r467696681", "bodyText": "One participant_id  will not be registered in more than one site . Each time a user a enroll into a study we will having a unique participant_id per user per study per site", "author": "aswinijena100", "createdAt": "2020-08-10T05:42:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNzYyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzNzEyMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468037123", "bodyText": "This index is only useful if a participant might be added to the same site more than once; it will prevent that form happening.\nHowever from what you are explaining you need a restrictive rule; you need to make sure that a participant does not get added to a study more than once. It is more restrictive because since sites belong to studies, uniqueness at site level will make sure that the user is also not added to ant site more than once either.\nNow, you are saying that participant_id is recreated per user and study, so this is what you need:\n\n\nuniqueConstraint on the participants table for user_id and study_id (make sure a user_study combo is only ever associated with one participant_id)\n\n\nuniqueConstraint on participants table on participant_id column if it's different than the primary key of the table; since it's an ID after all.\n\n\nuniqueConstraint on participant_study_info table on participant_id column. Since there should be only one record per participant there, and we have already made sure that it is unique per study with the previous conditions.", "author": "zohrehj", "createdAt": "2020-08-10T16:41:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNzYyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQxNDU5Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468414592", "bodyText": "Created an Unique constraint for the combo user_id and study_id. Also added unique constraint for participant_id  .", "author": "aswinijena100", "createdAt": "2020-08-11T08:30:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyNzYyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMTM3MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463731370", "bodyText": "what is an example of the content of sharing column?\nI know we had a boolean field to enable sharing of data for each participant, this is however a text column; please explain what this is used for.", "author": "zohrehj", "createdAt": "2020-07-31T17:14:43Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantStudyEntity.java", "diffHunk": "@@ -87,6 +97,7 @@\n   private Timestamp enrolledDate;\n \n   @Column(name = \"sharing\")\n+  @Type(type = \"text\")\n   private String sharing;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA2NzE5Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465067192", "bodyText": "I believe you missed this question.", "author": "zohrehj", "createdAt": "2020-08-04T13:54:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMTM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTgzMzU1OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465833559", "bodyText": "Sorry for that. Please find the expected values for this property n/a,true,false and provided. I have cross checked from the mobile team also. Hence refactor the size to XS from text type", "author": "aswinijena100", "createdAt": "2020-08-05T15:59:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMTM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk4MTYzNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465981636", "bodyText": "I don't remember ever hearing about these four values. Can you please describe what each one is used for and why we do not simply use boolean? null (not provided or not applicable) and true or false for provided values?", "author": "zohrehj", "createdAt": "2020-08-05T20:22:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMTM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzg3NTIyNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r467875226", "bodyText": "As implemented in FDA, we need just 3 values here : true. false, n/a\nTrue = user has provided data-sharing permission\nFalse = not provided\nn/a = data-sharing consent is not configured for the study in WCP", "author": "aswinijena100", "createdAt": "2020-08-10T12:41:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMTM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA0MzEyNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468043127", "bodyText": "then you should use Boolean:\nhttps://www.mysqltutorial.org/mysql-boolean/\nSince we want to allow for null values (\"n/a\") then it should be implemented with @Type(type=\"java.lang.Boolean\") which supports Nulls.\nThis way at the db level this would be the mapping:\n\n\n\nMySQL DB\nMyStudies Application\n\n\n\n\n0\nFALSE\n\n\n1\nTRUE\n\n\nNULL\nn/a", "author": "zohrehj", "createdAt": "2020-08-10T16:51:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMTM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQyMzUyNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468423526", "bodyText": "Implemented @type(type=\"java.lang.Boolean\") and changed the data type to Boolean from String", "author": "aswinijena100", "createdAt": "2020-08-11T08:45:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMTM3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMjk1MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463732951", "bodyText": "why not use @UpdateTimestamp?", "author": "zohrehj", "createdAt": "2020-07-31T17:18:11Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/SiteEntity.java", "diffHunk": "@@ -63,27 +72,27 @@\n   @Column(name = \"target_enrollment\")\n   private Integer targetEnrollment;\n \n-  @Column(name = \"name\")\n+  @Column(name = \"name\", length = ColumnConstraints.SMALL_LENGTH)\n   private String name;\n \n   @Column(\n-      name = \"created\",\n+      name = \"created_on\",\n       insertable = false,\n       updatable = false,\n       columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n   private Timestamp created;\n \n-  @Column(name = \"created_by\")\n+  @Column(name = \"created_by\", length = ColumnConstraints.LARGE_LENGTH)\n   private String createdBy;\n \n   @Column(", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI5ODc2MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464298760", "bodyText": "used @CreationTimestamp for created property  across all the entities.", "author": "aswinijena100", "createdAt": "2020-08-03T09:27:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMjk1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0MjI2Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463742267", "bodyText": "how about using this pattern for naming this unique constraints:\n${table_name}__#{columns names joined via \"_\"}_uidx\ne.g.\nparticipant_registry_site__email_study_info_id_uidx ?\nPlease rename other instances using the same pattern.", "author": "zohrehj", "createdAt": "2020-07-31T17:38:19Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantRegistrySiteEntity.java", "diffHunk": "@@ -38,15 +41,21 @@\n @Setter\n @Getter\n @Entity\n-@Table(name = \"participant_registry_site\")\n+@Table(\n+    name = \"participant_registry_site\",\n+    uniqueConstraints = {\n+      @UniqueConstraint(\n+          columnNames = {\"email\", \"study_info_id\"},\n+          name = \"uk_participant_registry_site_email_study\")", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI5ODk1Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464298952", "bodyText": "rename all the constraints as suggested", "author": "aswinijena100", "createdAt": "2020-08-03T09:28:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0MjI2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0MzI0MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463743241", "bodyText": "what happens if this flag is false here?\nWould the table not be rendered?", "author": "zohrehj", "createdAt": "2020-07-31T17:40:23Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/StudyConsentEntity.java", "diffHunk": "@@ -21,20 +21,23 @@\n import javax.persistence.Table;\n \n import org.hibernate.annotations.GenericGenerator;\n+import org.hibernate.annotations.Type;\n import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n \n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n import lombok.Getter;\n import lombok.Setter;\n import lombok.ToString;\n \n-@ConditionalOnProperty(\n-    value = \"participant.manager.entities.enabled\",\n-    havingValue = \"true\",\n-    matchIfMissing = false)\n @Setter\n @Getter\n @Entity\n @Table(name = \"study_consent\")\n+@ConditionalOnProperty(\n+    value = \"participant.manager.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTAzMTI0Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465031243", "bodyText": "Yes, if this property is false in respective services , then the entities will not be created.", "author": "aswinijena100", "createdAt": "2020-08-04T12:59:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0MzI0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0NDU3Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463744576", "bodyText": "user details table has a user_id in addition to the default Id.  what is user_id used for?", "author": "zohrehj", "createdAt": "2020-07-31T17:43:17Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/UserDetailsEntity.java", "diffHunk": "@@ -113,39 +112,53 @@\n   private Timestamp verificationDate;\n \n   @Column(\n-      name = \"temp_password_date\",\n+      name = \"code_expire_date\",\n       insertable = false,\n       updatable = false,\n       columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n-  private Timestamp tempPasswordDate;\n+  private Timestamp codeExpireDate;\n \n-  @Column(\n-      name = \"password_updated_date\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n-  private Timestamp passwordUpdatedDate;\n-\n-  @Column(name = \"reminder_lead_time\")\n+  @Column(name = \"reminder_lead_time\", length = ColumnConstraints.SMALL_LENGTH)\n   private String reminderLeadTime;\n \n   @ToString.Exclude\n-  @Column(name = \"security_token\")\n+  @Column(name = \"security_token\", length = ColumnConstraints.MEDIUM_LENGTH)\n   private String securityToken;\n \n   @ToString.Exclude\n-  @Column(name = \"email_code\")\n+  @Column(name = \"email_code\", length = ColumnConstraints.XS_LENGTH)\n   private String emailCode;\n \n   @ToString.Exclude\n-  @Column(name = \"user_id\")\n+  @Column(name = \"user_id\", length = ColumnConstraints.SMALL_LENGTH)\n   private String userId;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwMzUwNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464303504", "bodyText": "user_id is user id received from Auth server after successful registration.", "author": "aswinijena100", "createdAt": "2020-08-03T09:36:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0NDU3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0NDk2NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463744964", "bodyText": "this change seems like it should have a corresponding code change", "author": "zohrehj", "createdAt": "2020-07-31T17:44:08Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/UserDetailsEntity.java", "diffHunk": "@@ -113,39 +112,53 @@\n   private Timestamp verificationDate;\n \n   @Column(\n-      name = \"temp_password_date\",\n+      name = \"code_expire_date\",\n       insertable = false,\n       updatable = false,\n       columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n-  private Timestamp tempPasswordDate;\n+  private Timestamp codeExpireDate;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwNDk5Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464304996", "bodyText": "tempPasswordDate is an used column, hence removed now.It  wont be impacting any code.", "author": "aswinijena100", "createdAt": "2020-08-03T09:39:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc0NDk2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY5Mzc2MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463693760", "bodyText": "Can we create a new attribute that combines all of these attributes?", "author": "nikklassen", "createdAt": "2020-07-31T15:56:10Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -44,18 +50,27 @@\n   @Id\n   @GeneratedValue(generator = \"system-uuid\")\n   @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTAzMjc1OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465032758", "bodyText": "I tried but din find any solution for this . I refer this urlhttps://stackoverflow.com/questions/51801494/jpa-create-a-custom-id-annotation  it is not possible it seems.", "author": "aswinijena100", "createdAt": "2020-08-04T13:02:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY5Mzc2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA5NDc1Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465094752", "bodyText": "Unfortunate, Spring seems to allow this pattern so I thought it would work. Nevermind then.", "author": "nikklassen", "createdAt": "2020-08-04T14:30:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY5Mzc2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY5NDMzMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463694332", "bodyText": "This is the default so I'd just remove it", "author": "nikklassen", "createdAt": "2020-07-31T15:57:13Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -64,61 +79,64 @@\n   private OrgInfoEntity orgInfo;\n \n   @ToString.Exclude\n-  @Column(name = \"ios_bundle_id\")\n+  @Column(name = \"ios_bundle_id\", length = ColumnConstraints.SMALL_LENGTH)\n   private String iosBundleId;\n \n   @ToString.Exclude\n-  @Column(name = \"android_bundle_id\")\n+  @Column(name = \"android_bundle_id\", length = ColumnConstraints.SMALL_LENGTH)\n   private String androidBundleId;\n \n   @ToString.Exclude\n   @Column(name = \"ios_certificate\")\n+  @Type(type = \"text\")\n   private String iosCertificate;\n \n   @ToString.Exclude\n-  @Column(name = \"ios_certificate_password\")\n+  @Column(name = \"ios_certificate_password\", length = ColumnConstraints.SMALL_LENGTH)\n   private String iosCertificatePassword;\n \n   @ToString.Exclude\n-  @Column(name = \"android_server_key\")\n+  @Column(name = \"android_server_key\", length = ColumnConstraints.LARGE_LENGTH)\n   private String androidServerKey;\n \n   @ToString.Exclude\n-  @Column(name = \"from_email_id\")\n+  @Column(name = \"from_email_id\", length = ColumnConstraints.LARGE_LENGTH)\n   private String formEmailId;\n \n   @ToString.Exclude\n-  @Column(name = \"from_email_password\")\n+  @Column(name = \"from_email_password\", length = ColumnConstraints.LARGE_LENGTH)\n   private String fromEmailPassword;\n \n   @ToString.Exclude\n-  @Column(name = \"reg_email_sub\")\n+  @Column(name = \"reg_email_sub\", length = ColumnConstraints.LARGE_LENGTH)\n   private String regEmailSub;\n \n   @ToString.Exclude\n   @Column(name = \"reg_email_body\")\n+  @Type(type = \"text\")\n   private String regEmailBody;\n \n   @ToString.Exclude\n-  @Column(name = \"forgot_email_sub\")\n+  @Column(name = \"forgot_email_sub\", length = ColumnConstraints.LARGE_LENGTH)\n   private String forgotEmailSub;\n \n   @Column(name = \"forgot_email_body\")\n+  @Type(type = \"text\")\n   private String forgotEmailBody;\n \n-  @Column(name = \"method_handler\")\n+  @Column(name = \"method_handler\", length = ColumnConstraints.TINY_LENGTH)\n   private Integer methodHandler;\n \n-  @Column(name = \"created_by\")\n+  @Column(name = \"created_by\", length = ColumnConstraints.LARGE_LENGTH)\n   private String createdBy;\n \n-  @Column(name = \"modified_by\")\n+  @Column(name = \"modified_by\", length = ColumnConstraints.LARGE_LENGTH)\n   private String modifiedBy;\n \n   @Column(\n       name = \"modified_date\",\n       insertable = false,\n-      updatable = false,\n+      updatable = true,", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwNTMzMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464305333", "bodyText": "Removed this attribute", "author": "aswinijena100", "createdAt": "2020-08-03T09:39:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzY5NDMzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyODIxNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463728214", "bodyText": "This is handled by the DB, so unless you need the back reference right away this probably isn't necessary.", "author": "nikklassen", "createdAt": "2020-07-31T17:07:43Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AppEntity.java", "diffHunk": "@@ -180,4 +198,20 @@ public void addStudyEntity(StudyEntity study) {\n     studies.add(study);\n     study.setAppInfo(this);\n   }\n+\n+  @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = \"appInfo\")\n+  private List<AuthInfoEntity> apps = new ArrayList<>();\n+\n+  public void addAuthInfoEntity(AuthInfoEntity authInfoEntity) {\n+    apps.add(authInfoEntity);\n+    authInfoEntity.setAppInfo(this);", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyODc2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463728762", "bodyText": "This class is called AppInfo. Shouldn't this be AppEntity app?", "author": "nikklassen", "createdAt": "2020-07-31T17:09:05Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuthInfoEntity.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.hibernate.annotations.Type;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"auth_info\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class AuthInfoEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(name = \"auth_id\", nullable = false, length = ColumnConstraints.ID_LENGTH)\n+  private Integer authId;\n+\n+  @ManyToOne(cascade = CascadeType.MERGE)\n+  @JoinColumn(name = \"app_info_id\", nullable = false)\n+  private AppEntity appInfo;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwNTcyNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464305724", "bodyText": "changed to app now", "author": "aswinijena100", "createdAt": "2020-08-03T09:40:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyODc2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyOTU4OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463729588", "bodyText": "UUIDs are strings", "author": "nikklassen", "createdAt": "2020-07-31T17:10:46Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuthInfoEntity.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.hibernate.annotations.Type;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"auth_info\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class AuthInfoEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(name = \"auth_id\", nullable = false, length = ColumnConstraints.ID_LENGTH)\n+  private Integer authId;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwNTg4OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464305888", "bodyText": "My bad. Changed to String now", "author": "aswinijena100", "createdAt": "2020-08-03T09:40:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcyOTU4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMDg2Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463730866", "bodyText": "Why exclude the id? Here and elsewhere", "author": "nikklassen", "createdAt": "2020-07-31T17:13:36Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuthInfoEntity.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.hibernate.annotations.Type;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"auth_info\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class AuthInfoEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5MjM0MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464992341", "bodyText": "Not to include in logs", "author": "aswinijena100", "createdAt": "2020-08-04T11:49:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMDg2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMzA0OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463733049", "bodyText": "It looks like we are using @CreationTimestamp in PersonalizedUserReportEntity.java. Can this and @UpdateTimestamp be applied everywhere?\nCan we consistent also be consistent in how we name these? It seems like it should be created_on and updated_on, or created_date and updated_date. Personally I like createdTime and updatedTime best because it's a date and time, not just a date, but use whatever you prefer, as long as it's consistent. Final note though, is there any reason we can't just use the automatically generated column names for these? Using created seems fine if that's what the name of this Java field is.", "author": "nikklassen", "createdAt": "2020-07-31T17:18:25Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuthInfoEntity.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.hibernate.annotations.Type;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"auth_info\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class AuthInfoEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(name = \"auth_id\", nullable = false, length = ColumnConstraints.ID_LENGTH)\n+  private Integer authId;\n+\n+  @ManyToOne(cascade = CascadeType.MERGE)\n+  @JoinColumn(name = \"app_info_id\", nullable = false)\n+  private AppEntity appInfo;\n+\n+  @ManyToOne(cascade = CascadeType.MERGE)\n+  @JoinColumn(name = \"user_details_id\", nullable = false)\n+  private UserDetailsEntity userDetails;\n+\n+  @Column(name = \"auth_key\", length = ColumnConstraints.SMALL_LENGTH)\n+  private String authKey;\n+\n+  @Column(name = \"device_token\")\n+  @Type(type = \"text\")\n+  private String deviceToken;\n+\n+  @Column(name = \"device_type\", length = ColumnConstraints.SMALL_LENGTH)\n+  private String deviceType;\n+\n+  @Column(name = \"android_app_version\", length = ColumnConstraints.SMALL_LENGTH)\n+  private String androidAppVersion;\n+\n+  @Column(name = \"ios_app_version\", length = ColumnConstraints.SMALL_LENGTH)\n+  private String iosAppVersion;\n+\n+  @Column(\n+      name = \"created_on\",\n+      insertable = false,\n+      updatable = false,\n+      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  private Timestamp created;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwNjkxMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464306911", "bodyText": "modified the column name to created_time and updated_time", "author": "aswinijena100", "createdAt": "2020-08-03T09:42:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMzA0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMzU3MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463733570", "bodyText": "What is this timestamp for? You've already got created", "author": "nikklassen", "createdAt": "2020-07-31T17:19:32Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuthInfoEntity.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.hibernate.annotations.Type;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"auth_info\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class AuthInfoEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(name = \"auth_id\", nullable = false, length = ColumnConstraints.ID_LENGTH)\n+  private Integer authId;\n+\n+  @ManyToOne(cascade = CascadeType.MERGE)\n+  @JoinColumn(name = \"app_info_id\", nullable = false)\n+  private AppEntity appInfo;\n+\n+  @ManyToOne(cascade = CascadeType.MERGE)\n+  @JoinColumn(name = \"user_details_id\", nullable = false)\n+  private UserDetailsEntity userDetails;\n+\n+  @Column(name = \"auth_key\", length = ColumnConstraints.SMALL_LENGTH)\n+  private String authKey;\n+\n+  @Column(name = \"device_token\")\n+  @Type(type = \"text\")\n+  private String deviceToken;\n+\n+  @Column(name = \"device_type\", length = ColumnConstraints.SMALL_LENGTH)\n+  private String deviceType;\n+\n+  @Column(name = \"android_app_version\", length = ColumnConstraints.SMALL_LENGTH)\n+  private String androidAppVersion;\n+\n+  @Column(name = \"ios_app_version\", length = ColumnConstraints.SMALL_LENGTH)\n+  private String iosAppVersion;\n+\n+  @Column(\n+      name = \"created_on\",\n+      insertable = false,\n+      updatable = false,\n+      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  private Timestamp created;\n+\n+  @Column(\n+      name = \"modified_date\",\n+      insertable = false,\n+      updatable = true,\n+      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  private Timestamp modified;\n+\n+  @Column(name = \"remote_notification_flag\", length = ColumnConstraints.TINY_LENGTH)\n+  private Boolean remoteNotificationFlag = false;\n+\n+  @Column(\n+      name = \"timestamp\",\n+      insertable = false,\n+      updatable = false,\n+      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  private Timestamp timestamp;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwODE0Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464308146", "bodyText": "It is similar to created only. However removed now as it is not used in code.", "author": "aswinijena100", "createdAt": "2020-08-03T09:45:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMzU3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMzg3MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463733870", "bodyText": "modified_on for consistency?", "author": "nikklassen", "createdAt": "2020-07-31T17:20:07Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuditEventEntity.java", "diffHunk": "@@ -48,14 +53,14 @@\n   private long retryCount;\n \n   @Column(\n-      name = \"created\",\n+      name = \"created_on\",\n       insertable = false,\n       updatable = false,\n       columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n   private Timestamp created;\n \n   @Column(\n-      name = \"modified\",\n+      name = \"modified_date\",", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDMwODMyNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464308327", "bodyText": "changed to updated_time as per the suggestion", "author": "aswinijena100", "createdAt": "2020-08-03T09:45:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczMzg3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNDU2NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463734564", "bodyText": "I think we need greater consistency on how booleans are represented. Sometimes they are Integer, sometimes TINYINT, sometimes 'N'.", "author": "nikklassen", "createdAt": "2020-07-31T17:21:44Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/LocationEntity.java", "diffHunk": "@@ -43,35 +50,47 @@\n   @Id\n   @GeneratedValue(generator = \"system-uuid\")\n   @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n-  @Column(name = \"id\", updatable = false, nullable = false)\n+  @Column(name = \"id\", updatable = false, nullable = false, length = ColumnConstraints.ID_LENGTH)\n   private String id;\n \n-  @Column(name = \"custom_id\", length = 200)\n+  @Column(name = \"custom_id\", nullable = false, length = ColumnConstraints.SMALL_LENGTH)\n   private String customId;\n \n-  @Column(name = \"status\", length = 1)\n+  @Column(name = \"status\", length = ColumnConstraints.TINY_LENGTH)\n   private Integer status;\n \n-  @Column(name = \"name\", length = 200)\n+  @Column(name = \"name\", length = ColumnConstraints.LARGE_LENGTH)\n   private String name;\n \n-  @Column(name = \"description\", length = 500)\n+  @Column(name = \"description\")\n+  @Type(type = \"text\")\n   private String description;\n \n-  @Column(name = \"is_default\", length = 1)\n+  @Column(name = \"is_default\", nullable = false, columnDefinition = \"Varchar(1) default 'N'\")", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5NDQyOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464994429", "bodyText": "To represent the integer value such as permissions(e.g read only(0) and read edit(1) we have used Integers. For the value such as true false, we have  used boolean . Also created Permission enum class to represent these values.", "author": "aswinijena100", "createdAt": "2020-08-04T11:52:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNDU2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNDAwMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465104001", "bodyText": "My apologies, for the old schemas we were using TINYINT, but I see it's done with the automatic mapping for boolean in this PR, so that's good. But for permissions, can you use enums with @Enumerated(EnumType.STRING) then? It's not clear what values this field can take just from looking at this class.", "author": "nikklassen", "createdAt": "2020-08-04T14:42:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNDU2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTgzNDYzNQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465834635", "bodyText": "Included @Enumerated(EnumType.ORDINAL) now for permission related properties.", "author": "aswinijena100", "createdAt": "2020-08-05T16:01:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNDU2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNTIzMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463735231", "bodyText": "The other data object use \"id\" as the name for their ID. Can this one by changed without too much trouble? Ideally every data object has a primary identifier called \"id\"", "author": "nikklassen", "createdAt": "2020-07-31T17:23:11Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuthInfoEntity.java", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.hibernate.annotations.Type;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"auth_info\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class AuthInfoEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(name = \"auth_id\", nullable = false, length = ColumnConstraints.ID_LENGTH)\n+  private Integer authId;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5NDc4NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464994785", "bodyText": "Now changed the primary key column name id for all the entity classes.", "author": "aswinijena100", "createdAt": "2020-08-04T11:53:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNTIzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNzAyMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465107021", "bodyText": "What about the field name?", "author": "nikklassen", "createdAt": "2020-08-04T14:46:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNTIzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0MzQwNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465143406", "bodyText": "Changing the field name will lead to code refactor. For this particular entity can be done without any further changes , however for other entity classes it require code changes", "author": "aswinijena100", "createdAt": "2020-08-04T15:37:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNTIzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNTk4Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463735982", "bodyText": "Can these be non-nullable? What is their primary purpose?", "author": "nikklassen", "createdAt": "2020-07-31T17:24:42Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/LocationEntity.java", "diffHunk": "@@ -43,35 +50,47 @@\n   @Id\n   @GeneratedValue(generator = \"system-uuid\")\n   @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n-  @Column(name = \"id\", updatable = false, nullable = false)\n+  @Column(name = \"id\", updatable = false, nullable = false, length = ColumnConstraints.ID_LENGTH)\n   private String id;\n \n-  @Column(name = \"custom_id\", length = 200)\n+  @Column(name = \"custom_id\", nullable = false, length = ColumnConstraints.SMALL_LENGTH)\n   private String customId;\n \n-  @Column(name = \"status\", length = 1)\n+  @Column(name = \"status\", length = ColumnConstraints.TINY_LENGTH)\n   private Integer status;\n \n-  @Column(name = \"name\", length = 200)\n+  @Column(name = \"name\", length = ColumnConstraints.LARGE_LENGTH)\n   private String name;\n \n-  @Column(name = \"description\", length = 500)\n+  @Column(name = \"description\")\n+  @Type(type = \"text\")\n   private String description;\n \n-  @Column(name = \"is_default\", length = 1)\n+  @Column(name = \"is_default\", nullable = false, columnDefinition = \"Varchar(1) default 'N'\")\n   private String isDefault;\n \n   @Column(\n-      name = \"created\",\n+      name = \"created_on\",\n       insertable = false,\n       updatable = false,\n       columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n   private Timestamp created;\n \n   @ToString.Exclude\n-  @Column(name = \"created_by\", length = 64)\n+  @Column(name = \"created_by\", length = ColumnConstraints.LARGE_LENGTH)", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5NTUyMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464995520", "bodyText": "This is the column to represent who created(logged in user of participant manager) this entity data.", "author": "aswinijena100", "createdAt": "2020-08-04T11:54:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNTk4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNzQzMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465107430", "bodyText": "So is this something that needs to be filled in for compliance?", "author": "nikklassen", "createdAt": "2020-08-04T14:47:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNTk4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE0NTQzNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465145436", "bodyText": "yes to keep a track", "author": "aswinijena100", "createdAt": "2020-08-04T15:40:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzczNTk4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3MDY0MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463770640", "bodyText": "This is the issue I was referring to on Thursday. Looks like we aren't doing this anymore", "author": "nikklassen", "createdAt": "2020-07-31T18:39:29Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/PersonalizedUserReportEntity.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.CreationTimestamp;\n+import org.hibernate.annotations.GenericGenerator;\n+import org.hibernate.annotations.Type;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Builder;\n+import lombok.Getter;\n+import lombok.NoArgsConstructor;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@AllArgsConstructor\n+@Builder\n+@Setter\n+@Getter\n+@Entity\n+@NoArgsConstructor\n+@Table(name = \"personalized_user_report\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class PersonalizedUserReportEntity implements Serializable {\n+\n+  private static final long serialVersionUID = -3019529323339411129L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(name = \"id\", updatable = false, nullable = false, length = ColumnConstraints.ID_LENGTH)\n+  private String id;\n+\n+  @ManyToOne\n+  @JoinColumn(name = \"user_id\")\n+  private UserDetailsEntity userDetails;\n+\n+  @ManyToOne\n+  @JoinColumn(name = \"study_info_id\")\n+  private StudyEntity studyInfo;\n+\n+  @Column(name = \"report_title\", length = ColumnConstraints.MEDIUM_LENGTH)\n+  private String reportTitle;\n+\n+  // Length is an arbitrary multiple of 100 > 2^15 and < 2^16 to guarantee we", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5NjM2NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464996365", "bodyText": "So in this case what exactly needs to be done . If we not consider text data type , we need explicitly define the size of the column which may be huge .", "author": "aswinijena100", "createdAt": "2020-08-04T11:56:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3MDY0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg0Njc4OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465846788", "bodyText": "I don't understand, you've marked the column as \"text\". But then you say Marking \"columnDefinition = Text\" is not portable and doesn't work in tests.. My issue is only regarding this comment, if the text is big then fine, but this comment doesn't make sense.", "author": "nikklassen", "createdAt": "2020-08-05T16:20:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3MDY0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY5Mjg3Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r467692873", "bodyText": "This particular entity was introduced by UNC team along with some added functionality and comment was added them only .  However I did the change to modify the datatype from VARCHAR to text as they have mentioned huge length of 6500. Is it okay to remove the comment if it is confusing ?", "author": "aswinijena100", "createdAt": "2020-08-10T05:24:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3MDY0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzk1MzI2Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r467953266", "bodyText": "Yes, please remove comments like this if/when they are no longer relevant", "author": "nikklassen", "createdAt": "2020-08-10T14:42:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3MDY0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzk1OTcyNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r467959724", "bodyText": "removed not relevant comment from the entity class", "author": "aswinijena100", "createdAt": "2020-08-10T14:52:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3MDY0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NDIzOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463774239", "bodyText": "Mentioned in my comment on the create/update timestamps, can we just remove the name attribute when it matches the property name? I don't think we need to explicitly name every column.", "author": "nikklassen", "createdAt": "2020-07-31T18:47:53Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/StudyEntity.java", "diffHunk": "@@ -84,25 +100,25 @@\n       columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n   private Timestamp modified;\n \n-  @Column(name = \"modified_by\")\n+  @Column(name = \"modified_by\", length = ColumnConstraints.LARGE_LENGTH)\n   private String modifiedBy;\n \n   @Column(name = \"version\")\n   private Float version;\n \n-  @Column(name = \"status\")\n+  @Column(name = \"status\", length = ColumnConstraints.XS_LENGTH)", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5NzA2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464997062", "bodyText": "Removed name attribute if column name and property name are same.", "author": "aswinijena100", "createdAt": "2020-08-04T11:57:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NDIzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NDMxNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463774317", "bodyText": "String?", "author": "nikklassen", "createdAt": "2020-07-31T18:48:05Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/UserAppDetailsEntity.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"user_app_details\")\n+@ConditionalOnProperty(\n+    value = \"participant.manager.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class UserAppDetailsEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(\n+      name = \"user_app_details_id\",\n+      updatable = false,\n+      nullable = false,\n+      length = ColumnConstraints.ID_LENGTH)\n+  private Integer userAppDetailsId;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5NzE3Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464997176", "bodyText": "Changed to String now", "author": "aswinijena100", "createdAt": "2020-08-04T11:57:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NDMxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NDM2Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463774367", "bodyText": "app?", "author": "nikklassen", "createdAt": "2020-07-31T18:48:15Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/UserAppDetailsEntity.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"user_app_details\")\n+@ConditionalOnProperty(\n+    value = \"participant.manager.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class UserAppDetailsEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(\n+      name = \"user_app_details_id\",\n+      updatable = false,\n+      nullable = false,\n+      length = ColumnConstraints.ID_LENGTH)\n+  private Integer userAppDetailsId;\n+\n+  @ManyToOne\n+  @JoinColumn(name = \"app_info_id\", insertable = true, updatable = false)\n+  private AppEntity appInfo;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5NzMxMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464997312", "bodyText": "Changed to app now.", "author": "aswinijena100", "createdAt": "2020-08-04T11:57:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NDM2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NDYzOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463774639", "bodyText": "I don't think the insertable annotation is necessary", "author": "nikklassen", "createdAt": "2020-07-31T18:48:54Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/UserAppDetailsEntity.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.io.Serializable;\n+import java.sql.Timestamp;\n+\n+import javax.persistence.CascadeType;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+\n+import org.hibernate.annotations.GenericGenerator;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.ColumnConstraints;\n+\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"user_app_details\")\n+@ConditionalOnProperty(\n+    value = \"participant.manager.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class UserAppDetailsEntity implements Serializable {\n+\n+  private static final long serialVersionUID = 4985607753888575491L;\n+\n+  @ToString.Exclude\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(\n+      name = \"user_app_details_id\",\n+      updatable = false,\n+      nullable = false,\n+      length = ColumnConstraints.ID_LENGTH)\n+  private Integer userAppDetailsId;\n+\n+  @ManyToOne\n+  @JoinColumn(name = \"app_info_id\", insertable = true, updatable = false)", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5NzY0MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464997640", "bodyText": "removed insertable =true and updatable = true , as these are by default true", "author": "aswinijena100", "createdAt": "2020-08-04T11:58:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NDYzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NTY4OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463775689", "bodyText": "UUID?", "author": "nikklassen", "createdAt": "2020-07-31T18:51:22Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/UserInstitutionEntity.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.FetchType;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.GenerationType;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.OneToOne;\n+import javax.persistence.Table;\n+import javax.validation.constraints.NotNull;\n+\n+import org.hibernate.annotations.OnDelete;\n+import org.hibernate.annotations.OnDeleteAction;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Builder;\n+import lombok.Getter;\n+import lombok.NoArgsConstructor;\n+import lombok.Setter;\n+\n+@Setter\n+@Getter\n+@Entity\n+@AllArgsConstructor\n+@Builder\n+@NoArgsConstructor\n+@Table(name = \"user_institution\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class UserInstitutionEntity {\n+  @Id\n+  @Column(name = \"user_institution_id\", unique = true)\n+  @GeneratedValue(strategy = GenerationType.IDENTITY)\n+  private Long userInstitutionId;", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5Nzg3Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464997877", "bodyText": "Modified and used UUID", "author": "aswinijena100", "createdAt": "2020-08-04T11:59:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NTY4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NjkxNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463776916", "bodyText": "Does this actually add a non-null constraint to the table?", "author": "nikklassen", "createdAt": "2020-07-31T18:54:13Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/UserInstitutionEntity.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.FetchType;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.GenerationType;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.OneToOne;\n+import javax.persistence.Table;\n+import javax.validation.constraints.NotNull;\n+\n+import org.hibernate.annotations.OnDelete;\n+import org.hibernate.annotations.OnDeleteAction;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Builder;\n+import lombok.Getter;\n+import lombok.NoArgsConstructor;\n+import lombok.Setter;\n+\n+@Setter\n+@Getter\n+@Entity\n+@AllArgsConstructor\n+@Builder\n+@NoArgsConstructor\n+@Table(name = \"user_institution\")\n+@ConditionalOnProperty(\n+    value = \"participant.datastore.entities.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = false)\n+public class UserInstitutionEntity {\n+  @Id\n+  @Column(name = \"user_institution_id\", unique = true)\n+  @GeneratedValue(strategy = GenerationType.IDENTITY)\n+  private Long userInstitutionId;\n+\n+  @NotNull", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk5ODExNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r464998117", "bodyText": "yes this annotation is creating a Not Null Constraint", "author": "aswinijena100", "createdAt": "2020-08-04T11:59:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NjkxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NzMwOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r463777309", "bodyText": "Can you put all these deletes in a helper function on testDataHelper?", "author": "nikklassen", "createdAt": "2020-07-31T18:54:59Z", "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/SitesControllerTest.java", "diffHunk": "@@ -732,10 +731,6 @@ public void shouldInviteParticipant() throws Exception {\n \n   @AfterEach\n   public void cleanUp() {\n-    if (StringUtils.isNotEmpty(siteId)) {\n-      siteRepository.deleteById(siteId);\n-      siteId = null;\n-    }\n     testDataHelper.getStudyConsentRepository().deleteAll();", "originalCommit": "ec1c42537c2ae6e9cd789ab7a45ba10c5891dac9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTAwMDA0Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465000043", "bodyText": "Can we do this change in the upcoming PR, as this change will not be part of this PR scope.", "author": "aswinijena100", "createdAt": "2020-08-04T12:03:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NzMwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNDgyMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465104820", "bodyText": "OK", "author": "nikklassen", "createdAt": "2020-08-04T14:44:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc3NzMwOQ=="}], "type": "inlineReview"}, {"oid": "a2aea29d61f60d56494d19cfbed92cb2905be21b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a2aea29d61f60d56494d19cfbed92cb2905be21b", "message": "review comment fix", "committedDate": "2020-08-03T15:25:42Z", "type": "commit"}, {"oid": "8292d3f30dbff9790fa53a0daf318e2b4e7024d8", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8292d3f30dbff9790fa53a0daf318e2b4e7024d8", "message": "review comments fixes", "committedDate": "2020-08-04T05:01:10Z", "type": "commit"}, {"oid": "d6d4480a4d3d4b911b7aefb3e7dbeb237d7230db", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d6d4480a4d3d4b911b7aefb3e7dbeb237d7230db", "message": "review comment fixes for remaining entities\n\nreview comment fixes for remaining entities", "committedDate": "2020-08-04T09:47:43Z", "type": "commit"}, {"oid": "60139c8d5ca2a067be8d0a5b554168db0f1c958a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/60139c8d5ca2a067be8d0a5b554168db0f1c958a", "message": "Merge branch 'participant-manager-invite-participants' into data-integrity-checks-entities", "committedDate": "2020-08-04T11:05:06Z", "type": "commit"}, {"oid": "4fbbf2c9cd9c8bf7f6ad851be7401b72393ad4f4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/4fbbf2c9cd9c8bf7f6ad851be7401b72393ad4f4", "message": "changes after resolved conflict\n\nchanges after resolved conflict", "committedDate": "2020-08-04T12:51:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwODc5NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465108795", "bodyText": "Booleans shouldn't need a length. You've only specified it on some of them as well.", "author": "nikklassen", "createdAt": "2020-08-04T14:49:25Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuthInfoEntity.java", "diffHunk": "@@ -46,54 +49,41 @@\n   @Id\n   @GeneratedValue(generator = \"system-uuid\")\n   @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n-  @Column(name = \"auth_id\", nullable = false, length = ColumnConstraints.ID_LENGTH)\n-  private Integer authId;\n+  @Column(name = \"id\", nullable = false)\n+  private String authId;\n \n   @ManyToOne(cascade = CascadeType.MERGE)\n   @JoinColumn(name = \"app_info_id\", nullable = false)\n-  private AppEntity appInfo;\n+  private AppEntity app;\n \n   @ManyToOne(cascade = CascadeType.MERGE)\n   @JoinColumn(name = \"user_details_id\", nullable = false)\n   private UserDetailsEntity userDetails;\n \n-  @Column(name = \"auth_key\", length = ColumnConstraints.SMALL_LENGTH)\n+  @Column(name = \"auth_key\", length = SMALL_LENGTH)\n   private String authKey;\n \n   @Column(name = \"device_token\")\n   @Type(type = \"text\")\n   private String deviceToken;\n \n-  @Column(name = \"device_type\", length = ColumnConstraints.SMALL_LENGTH)\n+  @Column(name = \"device_type\", length = SMALL_LENGTH)\n   private String deviceType;\n \n-  @Column(name = \"android_app_version\", length = ColumnConstraints.SMALL_LENGTH)\n+  @Column(name = \"android_app_version\", length = SMALL_LENGTH)\n   private String androidAppVersion;\n \n-  @Column(name = \"ios_app_version\", length = ColumnConstraints.SMALL_LENGTH)\n+  @Column(name = \"ios_app_version\", length = SMALL_LENGTH)\n   private String iosAppVersion;\n \n-  @Column(\n-      name = \"created_on\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"created_time\")\n+  @CreationTimestamp\n   private Timestamp created;\n \n-  @Column(\n-      name = \"modified_date\",\n-      insertable = false,\n-      updatable = true,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"updated_time\")\n+  @UpdateTimestamp\n   private Timestamp modified;\n \n-  @Column(name = \"remote_notification_flag\", length = ColumnConstraints.TINY_LENGTH)\n+  @Column(name = \"remote_notification_flag\", length = TINY_LENGTH)", "originalCommit": "4fbbf2c9cd9c8bf7f6ad851be7401b72393ad4f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg0MDMyMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465840323", "bodyText": "Removed length for Booleans", "author": "aswinijena100", "createdAt": "2020-08-05T16:10:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwODc5NQ=="}], "type": "inlineReview"}, {"oid": "cd6d7c00e718cdeda7babb06e581b30766beea5b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/cd6d7c00e718cdeda7babb06e581b30766beea5b", "message": "Review comment fixes on 5thAug2020\n\nReview comment fixes on 5thAug2020", "committedDate": "2020-08-05T14:30:57Z", "type": "commit"}, {"oid": "cf183e56c5d9c18c4fe5c565d1d99b3eae708c0f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/cf183e56c5d9c18c4fe5c565d1d99b3eae708c0f", "message": "PR review comment fix to implement  @Enumerated(EnumType.ORDINAL)\n\nPR review comment fix to implement  @Enumerated(EnumType.ORDINAL)", "committedDate": "2020-08-05T15:32:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg1MjUzNQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465852535", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                int edit = site != null && site.getPermission() == 1 ? 0 : 1;\n          \n          \n            \n                sitePermission.setCanEdit(edit);\n          \n          \n            \n                sitePermission.setCanEdit(edit == 0 ? Permission.READ_VIEW : Permission.READ_EDIT);\n          \n          \n            \n            Permission edit = site != null && site.getPermission() == 1 ? Permission.READ_VIEW : Permission.READ_EDIT;\n          \n          \n            \n            sitePermission.setCanEdit(edit);", "author": "nikklassen", "createdAt": "2020-08-05T16:29:08Z", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/mapper/UserMapper.java", "diffHunk": "@@ -75,7 +74,7 @@ public static SitePermissionEntity newSitePermissionEntity(\n     sitePermission.setSite(siteDetails);\n     sitePermission.setCreatedBy(user.getSuperAdminUserId());\n     int edit = site != null && site.getPermission() == 1 ? 0 : 1;\n-    sitePermission.setCanEdit(edit);\n+    sitePermission.setCanEdit(edit == 0 ? Permission.READ_VIEW : Permission.READ_EDIT);", "originalCommit": "cf183e56c5d9c18c4fe5c565d1d99b3eae708c0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY4OTYxMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r467689613", "bodyText": "Thanks for the suggestion and same is implemented now.", "author": "aswinijena100", "createdAt": "2020-08-10T05:06:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg1MjUzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg1MjY3Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465852676", "bodyText": "Same as above. Throughtout file", "author": "nikklassen", "createdAt": "2020-08-05T16:29:21Z", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/mapper/UserMapper.java", "diffHunk": "@@ -90,7 +89,7 @@ public static SitePermissionEntity newSitePermissionEntity(\n     sitePermission.setApp(studyDetails.getApp());\n     sitePermission.setCreatedBy(user.getSuperAdminUserId());\n     int edit = study.getPermission() == 1 ? 0 : 1;\n-    sitePermission.setCanEdit(edit);\n+    sitePermission.setCanEdit(edit == 0 ? Permission.READ_VIEW : Permission.READ_EDIT);", "originalCommit": "cf183e56c5d9c18c4fe5c565d1d99b3eae708c0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY4OTY3Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r467689676", "bodyText": "implemented as above comment and pushed the changes", "author": "aswinijena100", "createdAt": "2020-08-10T05:07:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg1MjY3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk4MjAzOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r465982039", "bodyText": "this should be renamed too. If it takes a lot of work, please file a bug", "author": "zohrehj", "createdAt": "2020-08-05T20:23:22Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantStudyEntity.java", "diffHunk": "@@ -68,38 +76,28 @@\n   private UserDetailsEntity userDetails;\n \n   @Column(name = \"consent_status\")\n-  private Boolean consentStatus;\n+  private Boolean consentStatus = false;\n \n-  @Column(name = \"status\")\n+  @Column(length = SMALL_LENGTH)\n   private String status;\n \n-  @Column(name = \"bookmark\")\n   private Boolean bookmark;\n \n-  @Column(name = \"eligibility\")\n   private Boolean eligibility;\n \n-  @Column(\n-      name = \"enrolled_date\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"enrolled_time\")\n+  @CreationTimestamp\n   private Timestamp enrolledDate;\n \n-  @Column(name = \"sharing\")\n+  @Column(length = XS_LENGTH)\n   private String sharing;\n \n-  @Column(name = \"completion\")\n   private Integer completion;\n \n-  @Column(name = \"adherence\")\n   private Integer adherence;\n \n-  @Column(\n-      name = \"withdrawal_date\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"withdrawal_time\")\n+  @CreationTimestamp\n   private Timestamp withdrawalDate;", "originalCommit": "cf183e56c5d9c18c4fe5c565d1d99b3eae708c0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY4OTQ3Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r467689472", "bodyText": "Created a bug for this and will be taking care of this change in later stage of development #733", "author": "aswinijena100", "createdAt": "2020-08-10T05:06:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk4MjAzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA0MzM1Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468043357", "bodyText": "\ud83d\udc4d", "author": "zohrehj", "createdAt": "2020-08-10T16:52:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk4MjAzOQ=="}], "type": "inlineReview"}, {"oid": "27a1f058e81af4d962eeda2922903199ae3fb705", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/27a1f058e81af4d962eeda2922903199ae3fb705", "message": "Added Permission type instead of int type\n\nAdded Permission type instead of int type", "committedDate": "2020-08-10T05:35:03Z", "type": "commit"}, {"oid": "2bde28b8b28266211c828b0254359ee3b852dc43", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2bde28b8b28266211c828b0254359ee3b852dc43", "message": "removed unwanted comment\n\nremoved unwanted comment", "committedDate": "2020-08-10T14:48:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyNjY2OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468026668", "bodyText": "nit: can these permissions be renamed to simply VIEW and EDIT ?", "author": "zohrehj", "createdAt": "2020-08-10T16:23:46Z", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/mapper/UserMapper.java", "diffHunk": "@@ -108,15 +110,15 @@ public static SitePermissionEntity newSitePermissionEntity(\n         SitePermissionEntity sitePermission = new SitePermissionEntity();\n         sitePermission.setApp(appDetails);\n         sitePermission.setCreatedBy(user.getSuperAdminUserId());\n-        int edit = app != null && app.getPermission() == 1 ? 0 : 1;\n-        sitePermission.setCanEdit(edit == 0 ? Permission.READ_VIEW : Permission.READ_EDIT);\n+        Permission edit =\n+            app != null && app.getPermission() == 1 ? Permission.READ_VIEW : Permission.READ_EDIT;", "originalCommit": "2bde28b8b28266211c828b0254359ee3b852dc43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ4NDg1NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r469484855", "bodyText": "I believe you missed this comment as well", "author": "zohrehj", "createdAt": "2020-08-12T19:18:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyNjY2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc1NjE1Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r469756152", "bodyText": "rename this to VIEW and EDIT", "author": "aswinijena100", "createdAt": "2020-08-13T07:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyNjY2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyOTczNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468029734", "bodyText": "this looks like a bug to me. We have a column disabled_time, it's set to the creation time and it is not updatable.\nIs this column ever used? if not, it should be removed.\nIf it is used, how do we change the value?", "author": "zohrehj", "createdAt": "2020-08-10T16:28:54Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantRegistrySiteEntity.java", "diffHunk": "@@ -50,62 +61,57 @@\n   private String id;\n \n   @ManyToOne(cascade = CascadeType.MERGE)\n-  @JoinColumn(name = \"site_id\", insertable = true, updatable = false)\n+  @JoinColumn(name = \"site_id\", updatable = false)\n   private SiteEntity site;\n \n   @ManyToOne(cascade = CascadeType.MERGE)\n-  @JoinColumn(name = \"study_info_id\", insertable = true, updatable = true)\n+  @JoinColumn(name = \"study_info_id\")\n   private StudyEntity study;\n \n   @ToString.Exclude\n-  @Column(name = \"email\")\n+  @Column(length = LARGE_LENGTH)\n   private String email;\n \n   @ToString.Exclude\n-  @Column(name = \"name\")\n+  @Column(length = MEDIUM_LENGTH)\n   private String name;\n \n-  @Column(\n-      name = \"invitation_date\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"invitation_time\")\n+  @CreationTimestamp\n   private Timestamp invitationDate;\n \n   @Column(name = \"invitation_count\", columnDefinition = \"BIGINT DEFAULT 0\")\n   private Long invitationCount;\n \n-  @Column(\n-      name = \"disabled_date\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"disabled_time\")\n+  @CreationTimestamp\n   private Timestamp disabledDate;", "originalCommit": "2bde28b8b28266211c828b0254359ee3b852dc43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQxMjcwNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468412707", "bodyText": "This column should not be creation time . I revisited the implementation logic for this and found the column will only be updated when participant manager will disable a user . Hence I have removed @CreationTimestamp and added\n@Column(name = \"disabled_time\", columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")", "author": "aswinijena100", "createdAt": "2020-08-11T08:27:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyOTczNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDUyMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468030522", "bodyText": "this also looks like a bug. Token is immediately expired? why exactly do we need to store this time in the database then? doesn't its existence alone not indicate that it is expired?", "author": "zohrehj", "createdAt": "2020-08-10T16:30:13Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantRegistrySiteEntity.java", "diffHunk": "@@ -50,62 +61,57 @@\n   private String id;\n \n   @ManyToOne(cascade = CascadeType.MERGE)\n-  @JoinColumn(name = \"site_id\", insertable = true, updatable = false)\n+  @JoinColumn(name = \"site_id\", updatable = false)\n   private SiteEntity site;\n \n   @ManyToOne(cascade = CascadeType.MERGE)\n-  @JoinColumn(name = \"study_info_id\", insertable = true, updatable = true)\n+  @JoinColumn(name = \"study_info_id\")\n   private StudyEntity study;\n \n   @ToString.Exclude\n-  @Column(name = \"email\")\n+  @Column(length = LARGE_LENGTH)\n   private String email;\n \n   @ToString.Exclude\n-  @Column(name = \"name\")\n+  @Column(length = MEDIUM_LENGTH)\n   private String name;\n \n-  @Column(\n-      name = \"invitation_date\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"invitation_time\")\n+  @CreationTimestamp\n   private Timestamp invitationDate;\n \n   @Column(name = \"invitation_count\", columnDefinition = \"BIGINT DEFAULT 0\")\n   private Long invitationCount;\n \n-  @Column(\n-      name = \"disabled_date\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"disabled_time\")\n+  @CreationTimestamp\n   private Timestamp disabledDate;\n \n-  @Column(\n-      name = \"enrollment_token_expiry\",\n-      insertable = false,\n-      updatable = false,\n-      columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n+  @Column(name = \"enrollment_token_expiry\")\n+  @CreationTimestamp\n   private Timestamp enrollmentTokenExpiry;", "originalCommit": "2bde28b8b28266211c828b0254359ee3b852dc43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQwOTc4MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r468409780", "bodyText": "I have gone through the implementation again , this column should not be populated with default current time stamp. Participant Manager will be updating this value to 48 hrs from the time of invitation sent with enrollment token to a participant.", "author": "aswinijena100", "createdAt": "2020-08-11T08:23:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTI3ODY3Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r469278676", "bodyText": "then why is it still set to columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\" ?", "author": "zohrehj", "createdAt": "2020-08-12T13:56:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ4NTQ4OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r469485489", "bodyText": "please fix", "author": "zohrehj", "createdAt": "2020-08-12T19:19:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc4MDkxNQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r469780915", "bodyText": "My bad. I have removed this now .", "author": "aswinijena100", "createdAt": "2020-08-13T08:23:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDUyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTc5MDc5Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r469790796", "bodyText": "My Bad, removed columnDefination now.", "author": "aswinijena100", "createdAt": "2020-08-13T08:40:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMDUyMg=="}], "type": "inlineReview"}, {"oid": "c77eef69e3222be0ec044af59f2c7235e1dab99b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c77eef69e3222be0ec044af59f2c7235e1dab99b", "message": "Review Comment fixes\n\nReview Comment fixes", "committedDate": "2020-08-11T07:28:08Z", "type": "commit"}, {"oid": "cf3504822bbc791f0b288bc7eb78a9a4fc3abc91", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/cf3504822bbc791f0b288bc7eb78a9a4fc3abc91", "message": "removed insert/update false not required.\n\nremoved insert/update false not required.", "committedDate": "2020-08-11T08:05:18Z", "type": "commit"}, {"oid": "9e6f0a0422183e5c0716a61c62f6d9668aa28cf0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9e6f0a0422183e5c0716a61c62f6d9668aa28cf0", "message": "changed type for sharing\n\nchanged type for sharing", "committedDate": "2020-08-11T08:43:42Z", "type": "commit"}, {"oid": "7e1fccb2f56f8e791aae5702804bd6486538166a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7e1fccb2f56f8e791aae5702804bd6486538166a", "message": "Review comment fixes to rename Read_VIEW to VIEW\n\nReview comment fixes to rename Read_VIEW to VIEW", "committedDate": "2020-08-13T07:36:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA5MzE2NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r470093165", "bodyText": "please remove extra line", "author": "zohrehj", "createdAt": "2020-08-13T16:56:55Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/repository/StudyRepository.java", "diffHunk": "@@ -10,11 +10,13 @@\n \n import java.util.List;\n import java.util.Optional;\n+", "originalCommit": "7e1fccb2f56f8e791aae5702804bd6486538166a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA5MzI5NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r470093294", "bodyText": "same here, please remove the unnecessary separation", "author": "zohrehj", "createdAt": "2020-08-13T16:57:09Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/repository/StudyRepository.java", "diffHunk": "@@ -28,22 +30,22 @@\n   @Query(\"SELECT study from StudyEntity study where study.id=:studyId\")\n   public Optional<StudyEntity> findByStudyId(String studyId);\n ", "originalCommit": "7e1fccb2f56f8e791aae5702804bd6486538166a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA5MzgyNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/713#discussion_r470093826", "bodyText": "please remove all these unrelated formatting changes out of this CL.", "author": "zohrehj", "createdAt": "2020-08-13T16:58:02Z", "path": "common-modules/common-tests/pom.xml", "diffHunk": "@@ -88,10 +88,10 @@\n \t\t\t<groupId>org.assertj</groupId>\n \t\t\t<artifactId>assertj-core</artifactId>\n \t\t</dependency>\n-        <dependency>\n-      <groupId>org.slf4j</groupId>\n-      <artifactId>slf4j-ext</artifactId>\n-    </dependency>\n+\t\t<dependency>\n+\t\t\t<groupId>org.slf4j</groupId>\n+\t\t\t<artifactId>slf4j-ext</artifactId>\n+\t\t</dependency>", "originalCommit": "7e1fccb2f56f8e791aae5702804bd6486538166a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "37e6f7a1b0704e458b925f1cd2760fc846a96c1a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/37e6f7a1b0704e458b925f1cd2760fc846a96c1a", "message": "formatted all the source files\n\nformatted all the source files", "committedDate": "2020-08-14T06:15:42Z", "type": "commit"}, {"oid": "05e6b9132b9d077bc8e2cd628d55f2240f3b406a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/05e6b9132b9d077bc8e2cd628d55f2240f3b406a", "message": "Merge branch 'participant-manager-invite-participants' into data-integrity-checks-entities", "committedDate": "2020-08-14T06:18:23Z", "type": "commit"}, {"oid": "bd3dc71d84f0edf8a99fefca21553dadde6faf57", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bd3dc71d84f0edf8a99fefca21553dadde6faf57", "message": "Merge branch 'develop' into data-integrity-checks-entities", "committedDate": "2020-08-20T07:05:14Z", "type": "commit"}, {"oid": "d445bd137289c8ba3573251f8be6729eb19ef71b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d445bd137289c8ba3573251f8be6729eb19ef71b", "message": "Conflict issue fixes", "committedDate": "2020-08-20T07:45:43Z", "type": "commit"}, {"oid": "ba31806ed07bdb859a71e11237dc30232d95fc2c", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ba31806ed07bdb859a71e11237dc30232d95fc2c", "message": "test case failed issue fix after resolving conflict issue\n\ntest case failed issue fix after resolving conflict issue", "committedDate": "2020-08-20T08:22:32Z", "type": "commit"}]}