{"pr_number": 192, "pr_title": "iOS - Hide categories from Filters", "pr_createdAt": "2020-04-21T07:46:53Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/192", "timeline": [{"oid": "6a24a7e28e221b965a9fd92229fe4c8c9a993713", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6a24a7e28e221b965a9fd92229fe4c8c9a993713", "message": "Remove the study category label from the studies list.", "committedDate": "2020-04-17T15:41:52Z", "type": "commit"}, {"oid": "ea3113ac2558e9d7f8c373bfb8b0b3249e65c904", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ea3113ac2558e9d7f8c373bfb8b0b3249e65c904", "message": "Update copyrights for PR #166", "committedDate": "2020-04-20T08:55:34Z", "type": "commit"}, {"oid": "5343b6f2af194195da6f4898a785d742d03961c5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/5343b6f2af194195da6f4898a785d742d03961c5", "message": "Merge branch 'early-access' of https://github.com/GoogleCloudPlatform/fda-mystudies into ios-ui-update", "committedDate": "2020-04-20T09:05:55Z", "type": "commit"}, {"oid": "9284ee0519565dea5e3f9ec9c78259267a310695", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9284ee0519565dea5e3f9ec9c78259267a310695", "message": "Add Pod Toast-Swift.", "committedDate": "2020-04-20T13:09:58Z", "type": "commit"}, {"oid": "bcf04cb417a3e4c0f9aa892d9ab9c5f5e8df0322", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bcf04cb417a3e4c0f9aa892d9ab9c5f5e8df0322", "message": "- Hide studies categories from the filters.\n- Show toast on logout success.", "committedDate": "2020-04-21T07:30:44Z", "type": "commit"}, {"oid": "3391e1e72cd2cd00928bcebb3dc7d8e4e3ac1386", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3391e1e72cd2cd00928bcebb3dc7d8e4e3ac1386", "message": "Renamed AnonymousFilterData.plist", "committedDate": "2020-04-21T07:33:06Z", "type": "commit"}, {"oid": "c79543b42a78dab391652f9aca465f445e17a48e", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c79543b42a78dab391652f9aca465f445e17a48e", "message": "import Toast Swift.", "committedDate": "2020-04-21T07:42:18Z", "type": "commit"}, {"oid": "500b02e1cce452f1947968a68056ea79de894e1d", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/500b02e1cce452f1947968a68056ea79de894e1d", "message": "Merge branch 'early-access' into ios-ui-update", "committedDate": "2020-04-21T07:47:17Z", "type": "commit"}, {"oid": "250fd3ad6e2440cd243cc69ab8cf712b6d5e1e9d", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/250fd3ad6e2440cd243cc69ab8cf712b6d5e1e9d", "message": "Update filters when user login or signup.", "committedDate": "2020-04-21T08:19:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMzNjE5MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/192#discussion_r412336191", "bodyText": "you can just assign to the boolean value", "author": "nikklassen", "createdAt": "2020-04-21T17:08:28Z", "path": "iOS/HPHC/HPHC/Controllers/GatewayUI/StudyUI/StudyFilterViewController.swift", "diffHunk": "@@ -235,62 +245,56 @@ extension AppDelegate {\n   /// setter method to set the default filter options if none are selected.\n   func setDefaultFilters(previousCollectionData: [[String]]) {\n \n-    var filterData: NSMutableArray?\n-    var resource = \"AnanomousFilterData\"\n-\n-    if User.currentUser.userType == .FDAUser {\n-      resource = \"FilterData\"\n-    }\n+    let resource = (User.currentUser.userType == .FDAUser) ? \"FilterData\" : \"AnonymousFilterData\"\n \n-    let plistPath = Bundle.main.path(forResource: resource, ofType: \".plist\", inDirectory: nil)\n-    filterData = NSMutableArray.init(contentsOfFile: plistPath!)!\n+    let plistPath = Bundle.main.path(forResource: resource, ofType: \".plist\", inDirectory: nil) ?? \"\"\n+    guard let filterData = NSMutableArray.init(contentsOfFile: plistPath) else { return }\n \n     StudyFilterHandler.instance.filterOptions = []\n     var filterOptionsList: [FilterOptions] = []\n-    var i = 0\n \n-    for options in filterData! {\n-      let values = ((options as? [String: Any])![\"studyData\"] as? [[String: Any]])!\n-      let filterOptions = FilterOptions()\n-      filterOptions.title = ((options as? [String: Any])![\"headerText\"] as? String)!\n+    for (index, options) in filterData.enumerated() {\n+\n+      guard let dataDict = options as? JSONDictionary,\n+        let valuesDict = dataDict[\"studyData\"] as? [JSONDictionary]\n+      else { continue }\n+\n+      let headerTitle = dataDict[\"headerText\"] as? String ?? \"\"\n+      let type = dataDict[\"type\"] as? String ?? \"\"\n+\n+      guard let filterType = FilterType(rawValue: type) else { continue }\n+\n+      let filterOptions = FilterOptions(title: headerTitle, type: filterType)\n \n       var selectedValues: [String] = []\n       if previousCollectionData.count > 0 {\n-        selectedValues = previousCollectionData[i]\n+        selectedValues = previousCollectionData[index]\n       }\n \n       var filterValues: [FilterValues] = []\n-      for value in values {\n-\n-        var isContained = false\n+      for value in valuesDict {\n \n         let filterValue = FilterValues()\n-        filterValue.title = (value[\"name\"] as? String)!\n-\n-        if selectedValues.count > 0 {\n-          isContained = selectedValues.contains((value[\"name\"] as? String)!)\n-        }\n+        let name = value[\"name\"] as? String ?? \"\"\n+        filterValue.title = name\n+        let isContained = selectedValues.contains(name) ? true : false", "originalCommit": "250fd3ad6e2440cd243cc69ab8cf712b6d5e1e9d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY5NTk5OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/192#discussion_r412695999", "bodyText": "Thanks, I see that the operator isn't required.", "author": "tushar-boston", "createdAt": "2020-04-22T06:09:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMzNjE5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY5NzIyMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/192#discussion_r412697220", "bodyText": "I've fixed this in new PR as already made a couple of more commits in this same branch.", "author": "tushar-boston", "createdAt": "2020-04-22T06:11:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMzNjE5MQ=="}], "type": "inlineReview"}]}