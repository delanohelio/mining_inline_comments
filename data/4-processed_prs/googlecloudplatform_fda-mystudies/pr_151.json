{"pr_number": 151, "pr_title": "add bastion service account as sql client", "pr_createdAt": "2020-04-15T17:50:45Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151", "timeline": [{"oid": "6afed7b59c21184fd58bd049ccf1c40a5d994159", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6afed7b59c21184fd58bd049ccf1c40a5d994159", "message": "add bastion service account as sql client", "committedDate": "2020-04-15T17:50:03Z", "type": "commit"}, {"oid": "51e02753dfdbc741e713232071e2f07d470846bf", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/51e02753dfdbc741e713232071e2f07d470846bf", "message": "fix var", "committedDate": "2020-04-15T17:51:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyNzY5Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#discussion_r409027693", "bodyText": "Can you update the connect instruction above as well? Proxy wasn't necessary when I try to connect from bastion using mysql", "author": "xingao267", "createdAt": "2020-04-15T17:54:21Z", "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-networks/networks/bastion.tf", "diffHunk": "@@ -26,14 +26,15 @@ module \"bastion\" {\n   subnet         = module.private.subnets[\"${var.region}/${local.bastion_subnet_name}\"].self_link\n   image_family   = \"ubuntu-1804-lts\"\n   members        = var.bastion_users\n+  scopes         = [\n+    \"https://www.googleapis.com/auth/sqlservice.admin\",\n+  ]\n   startup_script = <<EOF\n #!/bin/bash\n-if dpkg -l mysql-client-core-5.7; then\n-  echo \"mysql-client already installed\"\n-else\n-  sudo apt-get -y update\n-  sudo apt-get -y install mysql-client-core-5.7\n-fi\n+sudo apt-get -y update\n+sudo apt-get -y install mysql-client-core-5.7\n+wget https://dl.google.com/cloudsql/cloud_sql_proxy.linux.amd64 -O cloud_sql_proxy", "originalCommit": "51e02753dfdbc741e713232071e2f07d470846bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAzMzU2OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#discussion_r409033568", "bodyText": "Done", "author": "umairidris", "createdAt": "2020-04-15T18:04:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyNzY5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyODU1Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#discussion_r409028556", "bodyText": "maybe sql_client_service_accounts to be clear they should only be SAs.", "author": "xingao267", "createdAt": "2020-04-15T17:55:44Z", "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/iam/variables.tf", "diffHunk": "@@ -2,8 +2,7 @@ variable \"project_id\" {\n   type = string\n }\n \n-variable \"gke_service_account\" {\n-  description = \"The service account used by the GKE cluster\"\n-  type        = string\n+variable \"sql_clients\" {", "originalCommit": "51e02753dfdbc741e713232071e2f07d470846bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAzMzUyMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#discussion_r409033522", "bodyText": "Done", "author": "umairidris", "createdAt": "2020-04-15T18:04:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyODU1Ng=="}], "type": "inlineReview"}, {"oid": "54b289f919b1cbded56d600b4c0378a362fda8f3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/54b289f919b1cbded56d600b4c0378a362fda8f3", "message": "update sql connectionon instructions", "committedDate": "2020-04-15T18:02:06Z", "type": "commit"}, {"oid": "4661312a33de7a07790466fa64d956982824cdc8", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/4661312a33de7a07790466fa64d956982824cdc8", "message": "rename sql_clients to sql_client_service_accounts", "committedDate": "2020-04-15T18:03:42Z", "type": "commit"}, {"oid": "97ce05400fd660c31d892c2580c2a66d6993a9fa", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/97ce05400fd660c31d892c2580c2a66d6993a9fa", "message": "fix gke apps terragrunt", "committedDate": "2020-04-15T19:24:50Z", "type": "commit"}, {"oid": "dd2ac0dcef02ca8a8ed5bdacfcf68c6c8cdcd3ad", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/dd2ac0dcef02ca8a8ed5bdacfcf68c6c8cdcd3ad", "message": "Merge branch 'terraform' into bastion_sql", "committedDate": "2020-04-15T20:35:46Z", "type": "commit"}, {"oid": "e6eb3458f5b4f52271e66a62d312e76b4a9a7444", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e6eb3458f5b4f52271e66a62d312e76b4a9a7444", "message": "fmt", "committedDate": "2020-04-15T20:39:45Z", "type": "commit"}, {"oid": "54c3eaf839ec11528f62498eeeadf5138f091cbb", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/54c3eaf839ec11528f62498eeeadf5138f091cbb", "message": "Merge branch 'bastion_sql' of https://github.com/GoogleCloudPlatform/fda-mystudies into bastion_sql", "committedDate": "2020-04-15T20:39:52Z", "type": "commit"}]}