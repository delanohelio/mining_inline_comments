{"pr_number": 1731, "pr_title": "Use a wrapper template to make values to be change more obvious.", "pr_createdAt": "2020-10-29T17:04:26Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1731", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ0Njk3NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1731#discussion_r514446974", "bodyText": "by do not specify, do you mean leaving as is? or commenting it out in the recipe?", "author": "zohrehj", "createdAt": "2020-10-29T17:40:21Z", "path": "deployment.hcl", "diffHunk": "@@ -1,1032 +1,27 @@\n-# {{$recipes := \"git://github.com/GoogleCloudPlatform/healthcare-data-protection-suite//templates/tfengine/recipes\"}}\n-# {{$ref := \"ref=templates-v0.4.0\"}}\n-\n-# The following values are placeholder values, change and adjust them according to\n-# your use case and organization needs.\n-# {{$prefix := \"example\"}}\n-# {{$env := \"dev\"}}\n-# {{$domain := \"example.com\"}}\n-# {{$default_location := \"us-central1\"}}\n-# {{$default_zone := \"a\"}}\n-# {{$github_owner := \"GoogleCloudPlatform\"}}\n-# {{$github_repo := \"example\"}}\n-# {{$github_branch := \"master\" }}\n-# If you would like to allow connection from anywhere, remove the entire\n-# 'master_authorized_networks' block in the 'project_apps' template below.\n-# {{$master_authorized_network_cidr_block := \"0.0.0.0/0\"}}\n-# {{$master_authorized_network_display_name := \"Example diplay name\"}}\n-\n-data = {\n-  parent_type     = \"folder\"\n-  parent_id       = \"0000000000\"\n-  billing_account = \"XXXXXX-XXXXXX-XXXXXX\"\n-  state_bucket    = \"{{$prefix}}-{{$env}}-terraform-state\"\n-\n-  # Default locations for resources. Can be overridden in individual templates.\n-  bigquery_location   = \"us-east1\" # BigQuery is not available in \"us-central1\"\n-  cloud_sql_region    = \"{{$default_location}}\"\n-  cloud_sql_zone      = \"{{$default_zone}}\"\n-  compute_region      = \"{{$default_location}}\"\n-  compute_zone        = \"{{$default_zone}}\"\n-  gke_region          = \"{{$default_location}}\"\n-  healthcare_location = \"{{$default_location}}\"\n-  storage_location    = \"{{$default_location}}\"\n-  secret_locations    = [\"{{$default_location}}\"]\n-}\n-\n-# Central devops project for Terraform state management and CI/CD.\n-template \"devops\" {\n-  recipe_path = \"{{$recipes}}/devops.hcl?{{$ref}}\"\n-  output_path = \"./devops\"\n-  data = {\n-    # During Step 1, set to `true` and re-run the engine after generated devops module has been deployed.\n-    # Run `terraform init` in the devops module to backup its state to GCS.\n-    enable_gcs_backend = false\n-\n-    admins_group = \"{{$prefix}}-{{$env}}-folder-admins@{{$domain}}\"\n-\n-    project = {\n-      project_id = \"{{$prefix}}-{{$env}}-devops\"\n-      owners = [\n-        \"group:{{$prefix}}-{{$env}}-devops-owners@{{$domain}}\",\n-      ]\n-      apis = [\n-        \"container.googleapis.com\",\n-        \"firebase.googleapis.com\",\n-        \"iap.googleapis.com\",\n-        \"secretmanager.googleapis.com\",\n-      ]\n-    }\n-  }\n-}\n-\n-template \"cicd\" {\n-  recipe_path = \"{{$recipes}}/cicd.hcl?{{$ref}}\"\n-  output_path = \"./cicd\"\n-  data = {\n-    project_id = \"{{$prefix}}-{{$env}}-devops\"\n-    github = {\n-      owner = \"{{$github_owner}}\"\n-      name  = \"{{$github_repo}}\"\n-    }\n-    branch_name    = \"{{$github_branch}}\"\n-    terraform_root = \"terraform\"\n-\n-    # Prepare and enable default triggers.\n-    triggers = {\n-      validate = {}\n-      plan     = {}\n-      apply    = {}\n-    }\n-\n-    # IAM members to give the roles/cloudbuild.builds.viewer permission so they can see build results.\n-    build_viewers = [\n-      \"group:{{$prefix}}-{{$env}}-cicd-viewers@{{$domain}}\",\n+# Top level template to instantiate MyStudies template with organization\n+# and study specific values.\n+template \"mystudies\" {\n+  # MyStudies template.\n+  recipe_path = \"./mystudies.hcl\"\n+  # The following values are placeholder values, change and adjust them according to\n+  # your use case and organization needs.\n+  data = {\n+    prefix           = \"example\"\n+    env              = \"dev\"\n+    folder_id        = \"0000000000\"\n+    billing_account  = \"XXXXXX-XXXXXX-XXXXXX\"\n+    domain           = \"example.com\"\n+    default_location = \"us-central1\"\n+    default_zone     = \"a\"\n+    github_owner     = \"GoogleCloudPlatform\"\n+    github_repo      = \"example\"\n+    github_branch    = \"master\"\n+    # GKE master authorized networks. Do not specify if you would like to allow connection from anywhere.\n+    master_authorized_networks = [\n+      {\n+        cidr_block   = \"0.0.0.0/0\"\n+        display_name = \"Example diplay name\"\n+      },", "originalCommit": "260a7b0e2bbf2cf41ef86954feae37a21274b2a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ3NTc5Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1731#discussion_r514475792", "bodyText": "Commenting it out. Reworded.", "author": "xingao267", "createdAt": "2020-10-29T18:25:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ0Njk3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ0ODIwNQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1731#discussion_r514448205", "bodyText": "nit: can you create this using git mv deployment.hcl mystudies.hcl and then modifying it?", "author": "zohrehj", "createdAt": "2020-10-29T17:42:11Z", "path": "mystudies.hcl", "diffHunk": "@@ -0,0 +1,1009 @@\n+# This is the solution template for MyStudies. Deployment specific", "originalCommit": "260a7b0e2bbf2cf41ef86954feae37a21274b2a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "496c1497960ed5ece3b10f9249dccadc4fa9fca4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/496c1497960ed5ece3b10f9249dccadc4fa9fca4", "message": "Use a wrapper template to make values to be change more obvious.", "committedDate": "2020-10-29T18:19:40Z", "type": "forcePushed"}, {"oid": "1d01d1813ba12d27399aaf88c61ea032c3fd45ce", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1d01d1813ba12d27399aaf88c61ea032c3fd45ce", "message": "Use a wrapper template to make values to be change more obvious.", "committedDate": "2020-10-29T18:22:09Z", "type": "commit"}, {"oid": "1d01d1813ba12d27399aaf88c61ea032c3fd45ce", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1d01d1813ba12d27399aaf88c61ea032c3fd45ce", "message": "Use a wrapper template to make values to be change more obvious.", "committedDate": "2020-10-29T18:22:09Z", "type": "forcePushed"}, {"oid": "22d206e53588ee03dc8596f12a846f6c0b031852", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/22d206e53588ee03dc8596f12a846f6c0b031852", "message": "wording", "committedDate": "2020-10-29T18:25:01Z", "type": "commit"}]}