{"pr_number": 1174, "pr_title": "iOS - Hydra Refresh token ", "pr_createdAt": "2020-10-07T16:05:04Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1174", "timeline": [{"oid": "2e21d58fcbcd3c98aab3e012e31bb1079f13d40b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2e21d58fcbcd3c98aab3e012e31bb1079f13d40b", "message": "Add refresh token hydra API", "committedDate": "2020-10-07T10:38:22Z", "type": "commit"}, {"oid": "becd4360bb62879e671691ef658154097522e7f2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/becd4360bb62879e671691ef658154097522e7f2", "message": "- Integrate refresh token with other services and error handling\n- Remove Org Id", "committedDate": "2020-10-07T11:30:03Z", "type": "commit"}, {"oid": "21d2c4603d876adcd44fab606227802372460ade", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/21d2c4603d876adcd44fab606227802372460ade", "message": "Remove Org ID", "committedDate": "2020-10-07T15:59:55Z", "type": "commit"}, {"oid": "9dcbf4cb80d0a2b4a9e109b883d185fe3e752810", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9dcbf4cb80d0a2b4a9e109b883d185fe3e752810", "message": "Error cleanup", "committedDate": "2020-10-07T16:13:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk2MDgxNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1174#discussion_r501960817", "bodyText": "missed this one?", "author": "zohrehj", "createdAt": "2020-10-08T19:25:53Z", "path": "iOS/HPHC/HPHC/Networking/APIs/UserServices.swift", "diffHunk": "@@ -519,41 +542,16 @@ extension UserServices: NMWebServiceDelegate {\n \n   func failedRequest(_ manager: NetworkManager, requestName: NSString, error: NSError) {\n \n-    if requestName as String == AuthServerMethods.getRefreshedToken.description && error.code == 401 {  //unauthorized\n-      delegate?.failedRequest(manager, requestName: requestName, error: error)\n-    } else if error.code == 401 {\n-\n-      self.failedRequestServices.headerParams = self.headerParams\n-      self.failedRequestServices.requestParams = self.requestParams\n-      self.failedRequestServices.method = self.method\n-\n-      if User.currentUser.refreshToken == \"\"\n-        && requestName as String\n-          != AuthServerMethods\n-          .login\n-          .description\n-      {\n-        // Unauthorized Access\n-        let errorInfo = [\"NSLocalizedDescription\": \"Your Session is Expired\"]\n-        let localError = NSError.init(domain: error.domain, code: 403, userInfo: errorInfo)\n-        delegate?.failedRequest(manager, requestName: requestName, error: localError)\n-\n-      } else {\n-        // Update Refresh Token\n-        AuthServices().updateToken(delegate: self)\n-      }\n-\n+    if error.code == 401 {", "originalCommit": "9dcbf4cb80d0a2b4a9e109b883d185fe3e752810", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzEwODk2Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1174#discussion_r503108963", "bodyText": "This check is ok.", "author": "tushar-boston", "createdAt": "2020-10-12T08:02:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk2MDgxNw=="}], "type": "inlineReview"}, {"oid": "3b51e1a39cd2b47d6884b9757b366103709680bc", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3b51e1a39cd2b47d6884b9757b366103709680bc", "message": "Update hardcoded error codes with enum values", "committedDate": "2020-10-12T08:10:33Z", "type": "commit"}, {"oid": "61d2f772ab7b3260c579c2fedaae9db6b4018fb9", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/61d2f772ab7b3260c579c2fedaae9db6b4018fb9", "message": "Update authorization token to get response service.", "committedDate": "2020-10-14T09:19:29Z", "type": "commit"}, {"oid": "ba9fbc5aca611d0c6b247c8a4ef7c1810a214ed3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ba9fbc5aca611d0c6b247c8a4ef7c1810a214ed3", "message": "Fix callback navigation.", "committedDate": "2020-10-14T09:24:46Z", "type": "commit"}, {"oid": "e718c6eee96c6dffd54fa2065a2fb0826bde665a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e718c6eee96c6dffd54fa2065a2fb0826bde665a", "message": "Update authorization token for response service. (#1367)", "committedDate": "2020-10-15T05:51:42Z", "type": "commit"}, {"oid": "55db1ee4cc8e2566adb62f94bd4e8ff680186aaa", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/55db1ee4cc8e2566adb62f94bd4e8ff680186aaa", "message": "Fix Login callback navigation (#1368)", "committedDate": "2020-10-15T05:52:25Z", "type": "commit"}]}