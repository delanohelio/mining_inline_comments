{"pr_number": 588, "pr_title": "Urwebapp addlocation implementation", "pr_createdAt": "2020-07-02T14:48:17Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588", "timeline": [{"oid": "45ea67c9eaaffbf7f58452985cccf322d6b6d9ca", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/45ea67c9eaaffbf7f58452985cccf322d6b6d9ca", "message": "AddLocation Components and Test cases", "committedDate": "2020-06-24T12:35:01Z", "type": "commit"}, {"oid": "8f3d68d8ea629e97c7ca32215705dc78d5b969ca", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8f3d68d8ea629e97c7ca32215705dc78d5b969ca", "message": "Test Case Changes", "committedDate": "2020-06-24T13:32:50Z", "type": "commit"}, {"oid": "a628ca8b2e2c470363230f9ee6b6fb64c08aea87", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a628ca8b2e2c470363230f9ee6b6fb64c08aea87", "message": "addLocation service layer implemented", "committedDate": "2020-06-24T13:54:38Z", "type": "commit"}, {"oid": "5bfb54b5c3eb1be2e67d1914da9ba6476fc7e9a5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/5bfb54b5c3eb1be2e67d1914da9ba6476fc7e9a5", "message": "Merge branch 'urwebapp-addlocation-implementation' of https://github.com/GoogleCloudPlatform/fda-mystudies into urwebapp-addlocation-implementation\n\n# Conflicts:\n#\tUR-web-app/src/app/site-coordinator/location/add-location/add-location.component.ts", "committedDate": "2020-06-24T13:57:12Z", "type": "commit"}, {"oid": "8f3f9f97fdcdb6f93140de83eb33dedc9964b7f9", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8f3f9f97fdcdb6f93140de83eb33dedc9964b7f9", "message": "add location html changes with back arrow image", "committedDate": "2020-06-24T14:05:35Z", "type": "commit"}, {"oid": "bcb958d681633eadf5978439bc52baf2942c5822", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bcb958d681633eadf5978439bc52baf2942c5822", "message": "linter fixes has been done", "committedDate": "2020-06-24T15:17:58Z", "type": "commit"}, {"oid": "8ac0b0727af404ee826ff38333674dd1738a8379", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8ac0b0727af404ee826ff38333674dd1738a8379", "message": "Add location functionality and Test cases", "committedDate": "2020-06-29T09:59:00Z", "type": "commit"}, {"oid": "a6d2ff1c105bd69af067be7536324ce242013933", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a6d2ff1c105bd69af067be7536324ce242013933", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into urwebapp-addlocation-implementation", "committedDate": "2020-06-30T14:23:42Z", "type": "commit"}, {"oid": "a9d9af15b93179872d7f6e18db7b904f1815ad6c", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a9d9af15b93179872d7f6e18db7b904f1815ad6c", "message": "cancel button implementation has been changed", "committedDate": "2020-07-02T13:57:25Z", "type": "commit"}, {"oid": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "message": "added sorter for table", "committedDate": "2020-07-02T14:45:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3OTI1MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449079251", "bodyText": "Does our API really return the key successBean? That should be changed on the server side.", "author": "nikklassen", "createdAt": "2020-07-02T15:21:38Z", "path": "UR-web-app/src/app/entity/sucess.model.ts", "diffHunk": "@@ -0,0 +1,7 @@\n+export interface ApiSuccessResponse {\n+  successBean: Success;", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5NTUxOA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449095518", "bodyText": "Yeah it is returning successBean key,I will ask server side team to change it.", "author": "firdosebtc1", "createdAt": "2020-07-02T15:37:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3OTI1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE5NDQ0OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449194449", "bodyText": "We don't actually need this Success object at all, it's not good API design. We know it's successful because of the 200 OK response, and the message isn't super helpful because we might theoretically have to translate it on the front end, so we don't need the server's message.", "author": "nikklassen", "createdAt": "2020-07-02T18:21:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3OTI1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM3NDUyMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450374522", "bodyText": "Success messages and error messages are managed in server side for all the web services as any front end application can utilize the web services and another reason is to avoid logic in front end as front end is just displaying messages which is coming from server side,\nfor example updateLocation web service will be updating a location or decommission the location or reactivating the location so based on the functionality front end will be getting success message", "author": "firdosebtc1", "createdAt": "2020-07-06T17:29:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3OTI1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM5MTQzNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450391436", "bodyText": "I understand your reasoning, but it's not the best way to do things. The main reason is translations, and the level of detail. Your user usually can't do anything about what went wrong, that's why we display error messages like \"An error has occurred\" or \"Please retry later\". But an application developer wants greater detail for their logs. If we are going to open source this platform then non-English speakers may pick it up and write their own app, and they will definitely be writing their own error messages. If the server is returning multiple messages then it should use a status enum, or the frontend should be able to infer what the state transition is.", "author": "nikklassen", "createdAt": "2020-07-06T18:01:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3OTI1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyMjE2Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451022163", "bodyText": "updated.", "author": "firdosebtc1", "createdAt": "2020-07-07T17:17:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3OTI1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3OTkwOA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449079908", "bodyText": "I assume this was for testing? If so please remove.", "author": "nikklassen", "createdAt": "2020-07-02T15:22:38Z", "path": "UR-web-app/src/app/http-interceptors/auth.interceptor.ts", "diffHunk": "@@ -27,7 +27,12 @@ export class AuthInterceptor implements HttpInterceptor {\n     void this.spinner.show();\n     const user = this.getUserDetails();\n     if (user === null) {\n-      return next.handle(req).pipe(\n+      const headers = req.headers\n+        .set('Content-Type', 'application/json')\n+        .set('userId', '1');", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MjA4MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450382080", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:44:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA3OTkwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4MDIxMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449080212", "bodyText": "This should be in environment.ts.", "author": "nikklassen", "createdAt": "2020-07-02T15:23:06Z", "path": "UR-web-app/src/app/service/entity.service.ts", "diffHunk": "@@ -5,7 +5,7 @@ import {Location} from '@angular/common';\n \n @Injectable()\n export class EntityService<T> {\n-  baseUrl = 'http://<IP>:<port>/urwebappws';\n+  baseUrl = 'http://35.222.67.4:8086/urwebappws';", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MjIxMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450382212", "bodyText": "Updated env file", "author": "rohithd-btc", "createdAt": "2020-07-06T17:44:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4MDIxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4MDc4Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449080782", "bodyText": "Templates that are more than a couple lines should be in a separate file.", "author": "nikklassen", "createdAt": "2020-07-02T15:24:01Z", "path": "UR-web-app/src/app/shared/myDefaultSorterComponent.ts", "diffHunk": "@@ -0,0 +1,54 @@\n+import {Component, Input, OnInit} from '@angular/core';\n+import {SortEvent, DataTable} from 'angular-9-datatable';\n+\n+@Component({\n+  selector: 'mySorter',\n+  template: `<a style=\"cursor: pointer\" (click)=\"sort()\" class=\"text-nowrap\">", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyMjU1OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451022559", "bodyText": "this file has been removed as we will be using the defaultSorter provided by angular data table", "author": "firdosebtc1", "createdAt": "2020-07-07T17:18:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4MDc4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4MDg5NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449080895", "bodyText": "Don't use my.", "author": "nikklassen", "createdAt": "2020-07-02T15:24:10Z", "path": "UR-web-app/src/app/shared/myDefaultSorterComponent.ts", "diffHunk": "@@ -0,0 +1,54 @@\n+import {Component, Input, OnInit} from '@angular/core';\n+import {SortEvent, DataTable} from 'angular-9-datatable';\n+\n+@Component({\n+  selector: 'mySorter',", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4MTE5Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449081197", "bodyText": "Don't use me.", "author": "nikklassen", "createdAt": "2020-07-02T15:24:34Z", "path": "UR-web-app/src/app/shared/myDefaultSorterComponent.ts", "diffHunk": "@@ -0,0 +1,54 @@\n+import {Component, Input, OnInit} from '@angular/core';\n+import {SortEvent, DataTable} from 'angular-9-datatable';\n+\n+@Component({\n+  selector: 'mySorter',\n+  template: `<a style=\"cursor: pointer\" (click)=\"sort()\" class=\"text-nowrap\">\n+    <ng-content></ng-content>\n+    <span\n+      *ngIf=\"isSortedByMeAsc\"\n+      class=\"glyphicon glyphicon-triangle-top\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <i\n+      *ngIf=\"!isSortedByMeAsc && !isSortedByMeDesc\"\n+      class=\"fa fa-sort-desc\"\n+      aria-hidden=\"true\"\n+    ></i>\n+    <span\n+      *ngIf=\"isSortedByMeDesc\"\n+      class=\"glyphicon glyphicon-triangle-bottom\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <span\n+      *ngIf=\"!isSortedByMeAsc && !isSortedByMeDesc\"\n+      class=\"glyphicon glyphicon-sort\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <i *ngIf=\"isSortedByMeAsc\" class=\"fa fa-sort-asc\" aria-hidden=\"true\"></i>\n+  </a>`,\n+})\n+export class MyDefaultSorterComponent implements OnInit {\n+  @Input('by') sortBy = '';\n+  isSortedByMeAsc = false;", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4MTc4Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449081783", "bodyText": "Instead of two booleans you should use an enum, for example type SortDirection = 'ASC' | 'DESC' | 'UNSORTED'", "author": "nikklassen", "createdAt": "2020-07-02T15:25:28Z", "path": "UR-web-app/src/app/shared/myDefaultSorterComponent.ts", "diffHunk": "@@ -0,0 +1,54 @@\n+import {Component, Input, OnInit} from '@angular/core';\n+import {SortEvent, DataTable} from 'angular-9-datatable';\n+\n+@Component({\n+  selector: 'mySorter',\n+  template: `<a style=\"cursor: pointer\" (click)=\"sort()\" class=\"text-nowrap\">\n+    <ng-content></ng-content>\n+    <span\n+      *ngIf=\"isSortedByMeAsc\"\n+      class=\"glyphicon glyphicon-triangle-top\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <i\n+      *ngIf=\"!isSortedByMeAsc && !isSortedByMeDesc\"\n+      class=\"fa fa-sort-desc\"\n+      aria-hidden=\"true\"\n+    ></i>\n+    <span\n+      *ngIf=\"isSortedByMeDesc\"\n+      class=\"glyphicon glyphicon-triangle-bottom\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <span\n+      *ngIf=\"!isSortedByMeAsc && !isSortedByMeDesc\"\n+      class=\"glyphicon glyphicon-sort\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <i *ngIf=\"isSortedByMeAsc\" class=\"fa fa-sort-asc\" aria-hidden=\"true\"></i>\n+  </a>`,\n+})\n+export class MyDefaultSorterComponent implements OnInit {\n+  @Input('by') sortBy = '';\n+  isSortedByMeAsc = false;\n+  isSortedByMeDesc = false;", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4MzA1NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449083054", "bodyText": "Use a pipe and async. Otherwise you need to unsubscribe.", "author": "nikklassen", "createdAt": "2020-07-02T15:26:35Z", "path": "UR-web-app/src/app/shared/myDefaultSorterComponent.ts", "diffHunk": "@@ -0,0 +1,54 @@\n+import {Component, Input, OnInit} from '@angular/core';\n+import {SortEvent, DataTable} from 'angular-9-datatable';\n+\n+@Component({\n+  selector: 'mySorter',\n+  template: `<a style=\"cursor: pointer\" (click)=\"sort()\" class=\"text-nowrap\">\n+    <ng-content></ng-content>\n+    <span\n+      *ngIf=\"isSortedByMeAsc\"\n+      class=\"glyphicon glyphicon-triangle-top\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <i\n+      *ngIf=\"!isSortedByMeAsc && !isSortedByMeDesc\"\n+      class=\"fa fa-sort-desc\"\n+      aria-hidden=\"true\"\n+    ></i>\n+    <span\n+      *ngIf=\"isSortedByMeDesc\"\n+      class=\"glyphicon glyphicon-triangle-bottom\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <span\n+      *ngIf=\"!isSortedByMeAsc && !isSortedByMeDesc\"\n+      class=\"glyphicon glyphicon-sort\"\n+      aria-hidden=\"true\"\n+    ></span>\n+    <i *ngIf=\"isSortedByMeAsc\" class=\"fa fa-sort-asc\" aria-hidden=\"true\"></i>\n+  </a>`,\n+})\n+export class MyDefaultSorterComponent implements OnInit {\n+  @Input('by') sortBy = '';\n+  isSortedByMeAsc = false;\n+  isSortedByMeDesc = false;\n+\n+  constructor(private readonly mfTable: DataTable) {}\n+\n+  public ngOnInit(): void {\n+    this.mfTable.onSortChange.subscribe((event: SortEvent) => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4NDk4OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449084989", "bodyText": "What about the maxLength error?", "author": "nikklassen", "createdAt": "2020-07-02T15:28:15Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.html", "diffHunk": "@@ -1 +1,78 @@\n-<p>add-location works!</p>\n+<div class=\"subheader p-none pl-none\">\n+    <div class=\"max__w__850 m-none\">\n+        <div class=\"row\">\n+            <div>\n+                <a routerLink=\"/coordinator/locations\" class=\"subheader__title\">\n+                    <img src=\"assets/svgs/back-arrow.svg\" />\n+                    <span>Add New Location</span>\n+                </a>\n+            </div>\n+        </div>\n+    </div>\n+</div>\n+\n+<div class=\"max__w__850 add__location\">\n+    <form ngForm #addLocationForm=\"ngForm\" (ngSubmit)=\"addLocation()\" autocomplete=\"off\">\n+        <div class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+            <div class=\"row border-bottom__c4d1e6\">\n+                <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+                    <div class=\"form-group\">\n+                        <label for=\"study\">Location ID</label>\n+                        <input type=\"text\" class=\"form-control\" id=\"locationCustomId\" placeholder=\"Enter Location ID\"\n+                            [(ngModel)]=\"location.customId\" maxlength=\"15\" required name=\"locationCustomId\"\n+                            #locationCustomId=\"ngModel\" />\n+                    </div>\n+                    <div *ngIf=\"\n+              locationCustomId.invalid &&\n+              (locationCustomId.dirty || locationCustomId.touched)\n+            \">\n+                        <span class=\"help-block with-errors error__msg\" *ngIf=\"locationCustomId.errors.required\">", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyMjY2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451022662", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-07-07T17:18:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4NDk4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4OTcyMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449089722", "bodyText": "You don't need an id attribute and a name attribute. Just name is fine. Also adding location to every variable is redundant, this is the location form. Just use customId.", "author": "nikklassen", "createdAt": "2020-07-02T15:32:10Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.html", "diffHunk": "@@ -1 +1,78 @@\n-<p>add-location works!</p>\n+<div class=\"subheader p-none pl-none\">\n+    <div class=\"max__w__850 m-none\">\n+        <div class=\"row\">\n+            <div>\n+                <a routerLink=\"/coordinator/locations\" class=\"subheader__title\">\n+                    <img src=\"assets/svgs/back-arrow.svg\" />\n+                    <span>Add New Location</span>\n+                </a>\n+            </div>\n+        </div>\n+    </div>\n+</div>\n+\n+<div class=\"max__w__850 add__location\">\n+    <form ngForm #addLocationForm=\"ngForm\" (ngSubmit)=\"addLocation()\" autocomplete=\"off\">\n+        <div class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+            <div class=\"row border-bottom__c4d1e6\">\n+                <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+                    <div class=\"form-group\">\n+                        <label for=\"study\">Location ID</label>\n+                        <input type=\"text\" class=\"form-control\" id=\"locationCustomId\" placeholder=\"Enter Location ID\"", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyMjczMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451022733", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-07-07T17:18:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA4OTcyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MDU4NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449090585", "bodyText": "Same as customId", "author": "nikklassen", "createdAt": "2020-07-02T15:32:55Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.html", "diffHunk": "@@ -1 +1,78 @@\n-<p>add-location works!</p>\n+<div class=\"subheader p-none pl-none\">\n+    <div class=\"max__w__850 m-none\">\n+        <div class=\"row\">\n+            <div>\n+                <a routerLink=\"/coordinator/locations\" class=\"subheader__title\">\n+                    <img src=\"assets/svgs/back-arrow.svg\" />\n+                    <span>Add New Location</span>\n+                </a>\n+            </div>\n+        </div>\n+    </div>\n+</div>\n+\n+<div class=\"max__w__850 add__location\">\n+    <form ngForm #addLocationForm=\"ngForm\" (ngSubmit)=\"addLocation()\" autocomplete=\"off\">\n+        <div class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+            <div class=\"row border-bottom__c4d1e6\">\n+                <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+                    <div class=\"form-group\">\n+                        <label for=\"study\">Location ID</label>\n+                        <input type=\"text\" class=\"form-control\" id=\"locationCustomId\" placeholder=\"Enter Location ID\"\n+                            [(ngModel)]=\"location.customId\" maxlength=\"15\" required name=\"locationCustomId\"\n+                            #locationCustomId=\"ngModel\" />\n+                    </div>\n+                    <div *ngIf=\"\n+              locationCustomId.invalid &&\n+              (locationCustomId.dirty || locationCustomId.touched)\n+            \">\n+                        <span class=\"help-block with-errors error__msg\" *ngIf=\"locationCustomId.errors.required\">\n+                            Location ID is required.\n+                        </span>\n+                    </div>\n+                </div>\n+                <div class=\"col-xs-12 col-md-6 p-none\">\n+                    <div class=\"form-group\">\n+                        <label for=\"app\">Location Name</label>\n+                        <input type=\"text\" class=\"form-control\" id=\"locationName\" placeholder=\"Enter Location Name\"", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyMjc5MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451022791", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-07-07T17:19:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MDU4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MTExMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449091113", "bodyText": "customIdInput", "author": "nikklassen", "createdAt": "2020-07-02T15:33:22Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAzMTA4MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451031081", "bodyText": "Updated", "author": "rohithd-btc", "createdAt": "2020-07-07T17:33:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MTExMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MTI3MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449091270", "bodyText": "nameInput", "author": "nikklassen", "createdAt": "2020-07-02T15:33:30Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyNTM0NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451025345", "bodyText": "Updated", "author": "rohithd-btc", "createdAt": "2020-07-07T17:23:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MTI3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MjY0OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449092648", "bodyText": "You aren't using ReactiveForms", "author": "nikklassen", "createdAt": "2020-07-02T15:34:43Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MjYyNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450382626", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:45:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MjY0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MzE4OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449093189", "bodyText": "Use [name=\"\"] selector", "author": "nikklassen", "createdAt": "2020-07-02T15:35:09Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyNTQ0OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451025448", "bodyText": "updated", "author": "rohithd-btc", "createdAt": "2020-07-07T17:23:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5MzE4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5NTc3Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449095776", "bodyText": "What is this test for? You're not testing the logic of this component. Please remove.", "author": "nikklassen", "createdAt": "2020-07-02T15:37:22Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4Mjc2Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450382763", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:45:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTA5NTc3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE2OTYxMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449169611", "bodyText": "Use a pipe and async. Otherwise you need to unsubscribe.", "author": "nikklassen", "createdAt": "2020-07-02T17:31:39Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.ts", "diffHunk": "@@ -1,8 +1,37 @@\n-import {Component} from '@angular/core';\n+import {Component, Input, Output, EventEmitter} from '@angular/core';\n+import {Router} from '@angular/router';\n+import {Location} from '../shared/location.model';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrService} from 'ngx-toastr';\n+import {ApiResponse} from 'src/app/entity/error.model';\n+import {ApiSuccessResponse} from 'src/app/entity/sucess.model';\n \n @Component({\n   selector: 'location-add',\n   templateUrl: './add-location.component.html',\n   styleUrls: ['./add-location.component.scss'],\n })\n-export class AddLocationComponent {}\n+export class AddLocationComponent {\n+  @Input() enabled = true;\n+  @Output() onFormSubmit: EventEmitter<unknown> = new EventEmitter<unknown>();\n+  location: Location = new Location();\n+  constructor(\n+    private readonly router: Router,\n+    private readonly locationService: LocationService,\n+    private readonly toastr: ToastrService,\n+  ) {}\n+\n+  addLocation(): void {\n+    this.locationService.addLocation(this.location).subscribe(", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyNjExMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451026110", "bodyText": "Updated", "author": "firdosebtc1", "createdAt": "2020-07-07T17:24:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE2OTYxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MDAwNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449170006", "bodyText": "This isn't unknown, it's Location.", "author": "nikklassen", "createdAt": "2020-07-02T17:32:25Z", "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.ts", "diffHunk": "@@ -2,12 +2,16 @@ import {Injectable} from '@angular/core';\n import {EntityService} from '../../../service/entity.service';\n import {Observable} from 'rxjs';\n import {Location} from '../shared/location.model';\n+\n @Injectable({\n   providedIn: 'root',\n })\n export class LocationService {\n-  constructor(private readonly entityService: EntityService<Location>) {}\n-  getLocations(): Observable<Location[]> {\n+  constructor(private readonly entityService: EntityService<unknown>) {}\n+  getLocations(): Observable<unknown[]> {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM3NDk2NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450374965", "bodyText": "Updated in the latest commit ,please check", "author": "firdosebtc1", "createdAt": "2020-07-06T17:30:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MDAwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MDUzNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449170537", "bodyText": "I assume that this is why you changed the type to unknown. If post isn't returning the created Location then you need to change the type in entityService to something else. You also don't need to stringify, the http client will take care of that for you.", "author": "nikklassen", "createdAt": "2020-07-02T17:33:29Z", "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.ts", "diffHunk": "@@ -2,12 +2,16 @@ import {Injectable} from '@angular/core';\n import {EntityService} from '../../../service/entity.service';\n import {Observable} from 'rxjs';\n import {Location} from '../shared/location.model';\n+\n @Injectable({\n   providedIn: 'root',\n })\n export class LocationService {\n-  constructor(private readonly entityService: EntityService<Location>) {}\n-  getLocations(): Observable<Location[]> {\n+  constructor(private readonly entityService: EntityService<unknown>) {}\n+  getLocations(): Observable<unknown[]> {\n     return this.entityService.getCollection('locations');\n   }\n+  addLocation(location: Location): Observable<unknown> {\n+    return this.entityService.post(JSON.stringify(location), 'locations');", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM3NTAxMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450375012", "bodyText": "Updated in the latest commit ,please check", "author": "firdosebtc1", "createdAt": "2020-07-06T17:30:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MDUzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MDg4MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449170880", "bodyText": "Formatting", "author": "nikklassen", "createdAt": "2020-07-02T17:34:08Z", "path": "UR-web-app/src/assets/svgs/back-arrow.svg", "diffHunk": "@@ -0,0 +1,4 @@\n+<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MzAxMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450383010", "bodyText": "Updated", "author": "rohithd-btc", "createdAt": "2020-07-06T17:46:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MDg4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MTc0OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449171748", "bodyText": "The service doesn't have mandatory field logic. The test is effectively the same as the previous test. Please remove.", "author": "nikklassen", "createdAt": "2020-07-02T17:35:50Z", "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts", "diffHunk": "@@ -118,4 +150,121 @@ describe('LocationService', () => {\n       },\n     );\n   }));\n+\n+  it('add location should return an error when the server returns a 400 ', fakeAsync(() => {\n+    const entityServicespy = jasmine.createSpyObj<EntityService<Location>>(\n+      'EntityService',\n+      ['post'],\n+    );\n+    locationService = new LocationService(entityServicespy);\n+    const errorResponses: ApiResponse = {\n+      error: {\n+        userMessage: 'customId already exists',\n+        type: 'error',\n+        detailMessage: 'customId already exists',\n+      },\n+    };\n+\n+    entityServicespy.post.and.returnValue(throwError(errorResponses));\n+    tick(40);\n+    locationService.addLocation(expectedNewPostData).subscribe(\n+      () => fail('expected an error'),\n+      (error: ApiResponse) => {\n+        expect(error.error.userMessage).toBe('customId already exists');\n+      },\n+    );\n+  }));\n+  it('add location should return an error when mandatory field customId is empty/null ', fakeAsync(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MzE2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450383162", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:46:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MTc0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MTgxMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449171811", "bodyText": "Same here, remove.", "author": "nikklassen", "createdAt": "2020-07-02T17:35:57Z", "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts", "diffHunk": "@@ -118,4 +150,121 @@ describe('LocationService', () => {\n       },\n     );\n   }));\n+\n+  it('add location should return an error when the server returns a 400 ', fakeAsync(() => {\n+    const entityServicespy = jasmine.createSpyObj<EntityService<Location>>(\n+      'EntityService',\n+      ['post'],\n+    );\n+    locationService = new LocationService(entityServicespy);\n+    const errorResponses: ApiResponse = {\n+      error: {\n+        userMessage: 'customId already exists',\n+        type: 'error',\n+        detailMessage: 'customId already exists',\n+      },\n+    };\n+\n+    entityServicespy.post.and.returnValue(throwError(errorResponses));\n+    tick(40);\n+    locationService.addLocation(expectedNewPostData).subscribe(\n+      () => fail('expected an error'),\n+      (error: ApiResponse) => {\n+        expect(error.error.userMessage).toBe('customId already exists');\n+      },\n+    );\n+  }));\n+  it('add location should return an error when mandatory field customId is empty/null ', fakeAsync(() => {\n+    const entityServicespy = jasmine.createSpyObj<EntityService<Location>>(\n+      'EntityService',\n+      ['post'],\n+    );\n+    const expectedMissingPostData = {\n+      id: 0,\n+      status: '0',\n+      customId: '',\n+      name: 'Location Name',\n+      description: 'location Decription',\n+      studiesCount: 0,\n+    };\n+    locationService = new LocationService(entityServicespy);\n+    const errorResponses: ApiResponse = {\n+      error: {\n+        userMessage: 'Missing required argument',\n+        type: 'error',\n+        detailMessage: 'Missing required argument',\n+      },\n+    };\n+\n+    entityServicespy.post.and.returnValue(throwError(errorResponses));\n+    tick(40);\n+    locationService.addLocation(expectedMissingPostData).subscribe(\n+      () => fail('expected an error'),\n+      (error: ApiResponse) => {\n+        expect(error.error.userMessage).toBe('Missing required argument');\n+      },\n+    );\n+  }));\n+  it('add location should return an error when mandatory name field is empty/null ', fakeAsync(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MzIwMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450383201", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:46:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MTgxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MTg3OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449171878", "bodyText": "Same here", "author": "nikklassen", "createdAt": "2020-07-02T17:36:04Z", "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts", "diffHunk": "@@ -118,4 +150,121 @@ describe('LocationService', () => {\n       },\n     );\n   }));\n+\n+  it('add location should return an error when the server returns a 400 ', fakeAsync(() => {\n+    const entityServicespy = jasmine.createSpyObj<EntityService<Location>>(\n+      'EntityService',\n+      ['post'],\n+    );\n+    locationService = new LocationService(entityServicespy);\n+    const errorResponses: ApiResponse = {\n+      error: {\n+        userMessage: 'customId already exists',\n+        type: 'error',\n+        detailMessage: 'customId already exists',\n+      },\n+    };\n+\n+    entityServicespy.post.and.returnValue(throwError(errorResponses));\n+    tick(40);\n+    locationService.addLocation(expectedNewPostData).subscribe(\n+      () => fail('expected an error'),\n+      (error: ApiResponse) => {\n+        expect(error.error.userMessage).toBe('customId already exists');\n+      },\n+    );\n+  }));\n+  it('add location should return an error when mandatory field customId is empty/null ', fakeAsync(() => {\n+    const entityServicespy = jasmine.createSpyObj<EntityService<Location>>(\n+      'EntityService',\n+      ['post'],\n+    );\n+    const expectedMissingPostData = {\n+      id: 0,\n+      status: '0',\n+      customId: '',\n+      name: 'Location Name',\n+      description: 'location Decription',\n+      studiesCount: 0,\n+    };\n+    locationService = new LocationService(entityServicespy);\n+    const errorResponses: ApiResponse = {\n+      error: {\n+        userMessage: 'Missing required argument',\n+        type: 'error',\n+        detailMessage: 'Missing required argument',\n+      },\n+    };\n+\n+    entityServicespy.post.and.returnValue(throwError(errorResponses));\n+    tick(40);\n+    locationService.addLocation(expectedMissingPostData).subscribe(\n+      () => fail('expected an error'),\n+      (error: ApiResponse) => {\n+        expect(error.error.userMessage).toBe('Missing required argument');\n+      },\n+    );\n+  }));\n+  it('add location should return an error when mandatory name field is empty/null ', fakeAsync(() => {\n+    const entityServicespy = jasmine.createSpyObj<EntityService<Location>>(\n+      'EntityService',\n+      ['post'],\n+    );\n+    const expectedMissingPostData = {\n+      id: 0,\n+      status: '0',\n+      customId: 'customID',\n+      name: '',\n+      description: 'location Decription',\n+      studiesCount: 0,\n+    };\n+    locationService = new LocationService(entityServicespy);\n+    const errorResponses: ApiResponse = {\n+      error: {\n+        userMessage: 'Missing required argument',\n+        type: 'error',\n+        detailMessage: 'Missing required argument',\n+      },\n+    };\n+\n+    entityServicespy.post.and.returnValue(throwError(errorResponses));\n+    tick(40);\n+    locationService.addLocation(expectedMissingPostData).subscribe(\n+      () => fail('expected an error'),\n+      (error: ApiResponse) => {\n+        expect(error.error.userMessage).toBe('Missing required argument');\n+      },\n+    );\n+  }));\n+  it('add location should return an error when mandatory description field is empty/null ', fakeAsync(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MzI0Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450383246", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:46:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MTg3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MjQwNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449172407", "bodyText": "Use more meaningful variable names, like expectedLocation.", "author": "nikklassen", "createdAt": "2020-07-02T17:37:11Z", "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts", "diffHunk": "@@ -29,9 +27,20 @@ describe('LocationService', () => {\n       description: 'location-descp-updated',\n       status: '0',\n       studiesCount: 0,\n-      studies: [],\n     },\n   ];\n+  const expectedNewPostData = {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyNTkxOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451025919", "bodyText": "updated", "author": "rohithd-btc", "createdAt": "2020-07-07T17:24:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MjQwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MjYzOA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449172638", "bodyText": "If you are converting this to a class you have to call new Location in LocationService like I told you", "author": "nikklassen", "createdAt": "2020-07-02T17:37:40Z", "path": "UR-web-app/src/app/site-coordinator/location/shared/location.model.ts", "diffHunk": "@@ -1,13 +1,13 @@\n-export interface Location {\n-  id: number;\n+export class Location {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM3NTE4MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450375181", "bodyText": "Updated in the latest commit ,please check", "author": "firdosebtc1", "createdAt": "2020-07-06T17:30:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE3MjYzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MDEyMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449180120", "bodyText": "I don't really like template-driven forms because you end up with hacks like this. But that's just my opinion. If you want to use template driven forms though you should be making your assertions against the DOM. So instead of checking if it's valid check if the error message that you want is displayed.", "author": "nikklassen", "createdAt": "2020-07-02T17:52:27Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {\n+    fixture.detectChanges();\n+    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+  });\n+  it('Locations value to input properties on form load', () => {\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    component.enabled = false;\n+    fixture.detectChanges();\n+    expect(submitButton.disabled).toBeTruthy();\n+  });\n+  it('should add novalidate by default to form element', fakeAsync(() => {\n+    fixture.detectChanges();\n+    tick();\n+    const formTest = form.nativeElement as HTMLFormElement;\n+    expect(formTest.getAttribute('novalidate')).toEqual('');\n+  }));\n+\n+  it('should set status classes with ngModelGroup and ngForm', fakeAsync(() => {\n+    fixture.detectChanges();\n+\n+    const input = fixture.debugElement.query(By.css('input'));\n+    const inputFormElement = input.nativeElement as HTMLElement;\n+\n+    void fixture.whenStable().then(() => {\n+      fixture.detectChanges();\n+\n+      expect(inputFormElement.classList.length).toEqual(4);\n+      expect(inputFormElement.classList.value).toEqual(\n+        'form-control ng-untouched ng-pristine ng-invalid',\n+      );\n+\n+      dispatchEvent(new Event('input'));\n+      tick();\n+      fixture.detectChanges();\n+    });\n+  }));\n+\n+  it('Entering value in input controls and emit output events', fakeAsync(() => {\n+    fixture.componentInstance.location.customId = 'customid3';\n+    fixture.componentInstance.location.name = 'Location Name';\n+    fixture.componentInstance.location.description =\n+      'This is location Description';\n+    void fixture.whenStable().then(() => {\n+      const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+      const customIdInput = locationCustomIde1.nativeElement as HTMLInputElement;\n+      const nameInput = locationNamee1.nativeElement as HTMLInputElement;\n+      const descriptionInput = locationDescriptione1.nativeElement as HTMLInputElement;\n+      customIdInput.value = 'customid3';\n+      nameInput.value = 'Location Name';\n+      descriptionInput.value = 'This is location Description';\n+      dispatchEvent(new Event('input'));\n+      fixture.detectChanges();\n+      tick();\n+      submitButton.click();\n+      fixture.detectChanges();\n+      expect(component.location.customId).toEqual('customid3');\n+      expect(component.location.name).toEqual('Location Name');\n+      expect(component.location.description).toEqual(\n+        'This is location Description',\n+      );\n+    });\n+  }));\n+\n+  it('should reset the form submit state when reset button is clicked', fakeAsync(() => {\n+    const forms = fixture.debugElement.children[0].injector.get(NgForm);", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyOTYwOQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451029609", "bodyText": "This test case has been removed as we are directly navigating to location list page on click of cancel button", "author": "firdosebtc1", "createdAt": "2020-07-07T17:30:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MDEyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MDI5NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449180294", "bodyText": "This isn't what this test is doing, the state doesn't change.", "author": "nikklassen", "createdAt": "2020-07-02T17:52:47Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {\n+    fixture.detectChanges();\n+    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+  });\n+  it('Locations value to input properties on form load', () => {\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    component.enabled = false;\n+    fixture.detectChanges();\n+    expect(submitButton.disabled).toBeTruthy();\n+  });\n+  it('should add novalidate by default to form element', fakeAsync(() => {\n+    fixture.detectChanges();\n+    tick();\n+    const formTest = form.nativeElement as HTMLFormElement;\n+    expect(formTest.getAttribute('novalidate')).toEqual('');\n+  }));\n+\n+  it('should set status classes with ngModelGroup and ngForm', fakeAsync(() => {\n+    fixture.detectChanges();\n+\n+    const input = fixture.debugElement.query(By.css('input'));\n+    const inputFormElement = input.nativeElement as HTMLElement;\n+\n+    void fixture.whenStable().then(() => {\n+      fixture.detectChanges();\n+\n+      expect(inputFormElement.classList.length).toEqual(4);\n+      expect(inputFormElement.classList.value).toEqual(\n+        'form-control ng-untouched ng-pristine ng-invalid',\n+      );\n+\n+      dispatchEvent(new Event('input'));\n+      tick();\n+      fixture.detectChanges();\n+    });\n+  }));\n+\n+  it('Entering value in input controls and emit output events', fakeAsync(() => {\n+    fixture.componentInstance.location.customId = 'customid3';\n+    fixture.componentInstance.location.name = 'Location Name';\n+    fixture.componentInstance.location.description =\n+      'This is location Description';\n+    void fixture.whenStable().then(() => {\n+      const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+      const customIdInput = locationCustomIde1.nativeElement as HTMLInputElement;\n+      const nameInput = locationNamee1.nativeElement as HTMLInputElement;\n+      const descriptionInput = locationDescriptione1.nativeElement as HTMLInputElement;\n+      customIdInput.value = 'customid3';\n+      nameInput.value = 'Location Name';\n+      descriptionInput.value = 'This is location Description';\n+      dispatchEvent(new Event('input'));\n+      fixture.detectChanges();\n+      tick();\n+      submitButton.click();\n+      fixture.detectChanges();\n+      expect(component.location.customId).toEqual('customid3');\n+      expect(component.location.name).toEqual('Location Name');\n+      expect(component.location.description).toEqual(\n+        'This is location Description',\n+      );\n+    });\n+  }));\n+\n+  it('should reset the form submit state when reset button is clicked', fakeAsync(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAzMjEyMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451032120", "bodyText": "We have removed the test cases as when the cancel button is clicked the page is redirecting to location list.", "author": "rohithd-btc", "createdAt": "2020-07-07T17:35:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MDI5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MDYzNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449180636", "bodyText": "These tests are easier to read using async/await instead of .then", "author": "nikklassen", "createdAt": "2020-07-02T17:53:29Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {\n+    fixture.detectChanges();\n+    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+  });\n+  it('Locations value to input properties on form load', () => {\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    component.enabled = false;\n+    fixture.detectChanges();\n+    expect(submitButton.disabled).toBeTruthy();\n+  });\n+  it('should add novalidate by default to form element', fakeAsync(() => {\n+    fixture.detectChanges();\n+    tick();\n+    const formTest = form.nativeElement as HTMLFormElement;\n+    expect(formTest.getAttribute('novalidate')).toEqual('');\n+  }));\n+\n+  it('should set status classes with ngModelGroup and ngForm', fakeAsync(() => {\n+    fixture.detectChanges();\n+\n+    const input = fixture.debugElement.query(By.css('input'));\n+    const inputFormElement = input.nativeElement as HTMLElement;\n+\n+    void fixture.whenStable().then(() => {\n+      fixture.detectChanges();\n+\n+      expect(inputFormElement.classList.length).toEqual(4);\n+      expect(inputFormElement.classList.value).toEqual(\n+        'form-control ng-untouched ng-pristine ng-invalid',\n+      );\n+\n+      dispatchEvent(new Event('input'));\n+      tick();\n+      fixture.detectChanges();\n+    });\n+  }));\n+\n+  it('Entering value in input controls and emit output events', fakeAsync(() => {\n+    fixture.componentInstance.location.customId = 'customid3';\n+    fixture.componentInstance.location.name = 'Location Name';\n+    fixture.componentInstance.location.description =\n+      'This is location Description';\n+    void fixture.whenStable().then(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcwNzg3OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451707878", "bodyText": "Updated in the latest commit", "author": "rohithd-btc", "createdAt": "2020-07-08T17:24:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MDYzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MTM5NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449181395", "bodyText": "Don't test the Angular framework. Please remove this test.", "author": "nikklassen", "createdAt": "2020-07-02T17:54:58Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {\n+    fixture.detectChanges();\n+    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+  });\n+  it('Locations value to input properties on form load', () => {\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    component.enabled = false;\n+    fixture.detectChanges();\n+    expect(submitButton.disabled).toBeTruthy();\n+  });\n+  it('should add novalidate by default to form element', fakeAsync(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MzQ2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450383462", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:46:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MTM5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MTU4OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449181588", "bodyText": "This isn't what this test is testing", "author": "nikklassen", "createdAt": "2020-07-02T17:55:22Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {\n+    fixture.detectChanges();\n+    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+  });\n+  it('Locations value to input properties on form load', () => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAzMDQ4Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451030482", "bodyText": "This test is to check the submit form disabled on form load.", "author": "rohithd-btc", "createdAt": "2020-07-07T17:32:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MTU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA2NDUzMA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451064530", "bodyText": "That's not what the title of the test says.", "author": "nikklassen", "createdAt": "2020-07-07T18:33:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MTU4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcwNzQ2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451707462", "bodyText": "Updated in the latest commit", "author": "rohithd-btc", "createdAt": "2020-07-08T17:23:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MTU4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MTc5Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449181793", "bodyText": "Don't test the Angular framework. Please remove this test.", "author": "nikklassen", "createdAt": "2020-07-02T17:55:49Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {\n+    fixture.detectChanges();\n+    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+  });\n+  it('Locations value to input properties on form load', () => {\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    component.enabled = false;\n+    fixture.detectChanges();\n+    expect(submitButton.disabled).toBeTruthy();\n+  });\n+  it('should add novalidate by default to form element', fakeAsync(() => {\n+    fixture.detectChanges();\n+    tick();\n+    const formTest = form.nativeElement as HTMLFormElement;\n+    expect(formTest.getAttribute('novalidate')).toEqual('');\n+  }));\n+\n+  it('should set status classes with ngModelGroup and ngForm', fakeAsync(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MzU2MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450383560", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:47:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MTc5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MjU1NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449182555", "bodyText": "There is no output check in this test.", "author": "nikklassen", "createdAt": "2020-07-02T17:57:16Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {\n+    fixture.detectChanges();\n+    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+  });\n+  it('Locations value to input properties on form load', () => {\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    component.enabled = false;\n+    fixture.detectChanges();\n+    expect(submitButton.disabled).toBeTruthy();\n+  });\n+  it('should add novalidate by default to form element', fakeAsync(() => {\n+    fixture.detectChanges();\n+    tick();\n+    const formTest = form.nativeElement as HTMLFormElement;\n+    expect(formTest.getAttribute('novalidate')).toEqual('');\n+  }));\n+\n+  it('should set status classes with ngModelGroup and ngForm', fakeAsync(() => {\n+    fixture.detectChanges();\n+\n+    const input = fixture.debugElement.query(By.css('input'));\n+    const inputFormElement = input.nativeElement as HTMLElement;\n+\n+    void fixture.whenStable().then(() => {\n+      fixture.detectChanges();\n+\n+      expect(inputFormElement.classList.length).toEqual(4);\n+      expect(inputFormElement.classList.value).toEqual(\n+        'form-control ng-untouched ng-pristine ng-invalid',\n+      );\n+\n+      dispatchEvent(new Event('input'));\n+      tick();\n+      fixture.detectChanges();\n+    });\n+  }));\n+\n+  it('Entering value in input controls and emit output events', fakeAsync(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyNTA4OA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451025088", "bodyText": "This test case is for to check the input filed with the fake/hardcoded value and expect the same string", "author": "rohithd-btc", "createdAt": "2020-07-07T17:23:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MjU1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MjkyMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449182923", "bodyText": "If you're testing that submit works you should also be checking that the locationService was called.", "author": "nikklassen", "createdAt": "2020-07-02T17:58:01Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -1,24 +1,149 @@\n-import {async, ComponentFixture, TestBed} from '@angular/core/testing';\n-\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+  tick,\n+} from '@angular/core/testing';\n+import {DebugElement} from '@angular/core';\n import {AddLocationComponent} from './add-location.component';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {LocationModule} from '../location.module';\n+import {FormsModule, ReactiveFormsModule, NgForm} from '@angular/forms';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n \n describe('AddLocationComponent', () => {\n   let component: AddLocationComponent;\n   let fixture: ComponentFixture<AddLocationComponent>;\n+  let form: DebugElement;\n+  let submitLocation: DebugElement;\n+  let locationCustomIde1: DebugElement;\n+  let locationNamee1: DebugElement;\n+  let locationDescriptione1: DebugElement;\n \n-  beforeEach(async(async () => {\n-    await TestBed.configureTestingModule({\n+  beforeEach(async(() => {\n+    TestBed.configureTestingModule({\n       declarations: [AddLocationComponent],\n-    }).compileComponents();\n+      imports: [\n+        ModalModule.forRoot(),\n+        RouterTestingModule,\n+        LocationModule,\n+        HttpClientModule,\n+        FormsModule,\n+        ReactiveFormsModule,\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [NgForm, EntityService, LocationService, BsModalService],\n+    });\n   }));\n \n-  beforeEach(() => {\n+  beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n+    form = fixture.debugElement.query(By.css('form'));\n+    submitLocation = fixture.debugElement.query(\n+      By.css('button[type=\"submit\"]'),\n+    );\n+    locationCustomIde1 = fixture.debugElement.query(\n+      By.css('input[id=locationCustomId]'),\n+    );\n+    locationNamee1 = fixture.debugElement.query(\n+      By.css('input[id=locationName]'),\n+    );\n+    locationDescriptione1 = fixture.debugElement.query(\n+      By.css('input[id=locationDescription]'),\n+    );\n+\n     fixture.detectChanges();\n-  });\n+  }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n+  it('should not create a template-driven form when ngNoForm is used', () => {\n+    fixture.detectChanges();\n+    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+  });\n+  it('Locations value to input properties on form load', () => {\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    component.enabled = false;\n+    fixture.detectChanges();\n+    expect(submitButton.disabled).toBeTruthy();\n+  });\n+  it('should add novalidate by default to form element', fakeAsync(() => {\n+    fixture.detectChanges();\n+    tick();\n+    const formTest = form.nativeElement as HTMLFormElement;\n+    expect(formTest.getAttribute('novalidate')).toEqual('');\n+  }));\n+\n+  it('should set status classes with ngModelGroup and ngForm', fakeAsync(() => {\n+    fixture.detectChanges();\n+\n+    const input = fixture.debugElement.query(By.css('input'));\n+    const inputFormElement = input.nativeElement as HTMLElement;\n+\n+    void fixture.whenStable().then(() => {\n+      fixture.detectChanges();\n+\n+      expect(inputFormElement.classList.length).toEqual(4);\n+      expect(inputFormElement.classList.value).toEqual(\n+        'form-control ng-untouched ng-pristine ng-invalid',\n+      );\n+\n+      dispatchEvent(new Event('input'));\n+      tick();\n+      fixture.detectChanges();\n+    });\n+  }));\n+\n+  it('Entering value in input controls and emit output events', fakeAsync(() => {\n+    fixture.componentInstance.location.customId = 'customid3';\n+    fixture.componentInstance.location.name = 'Location Name';\n+    fixture.componentInstance.location.description =\n+      'This is location Description';\n+    void fixture.whenStable().then(() => {\n+      const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+      const customIdInput = locationCustomIde1.nativeElement as HTMLInputElement;\n+      const nameInput = locationNamee1.nativeElement as HTMLInputElement;\n+      const descriptionInput = locationDescriptione1.nativeElement as HTMLInputElement;\n+      customIdInput.value = 'customid3';\n+      nameInput.value = 'Location Name';\n+      descriptionInput.value = 'This is location Description';\n+      dispatchEvent(new Event('input'));\n+      fixture.detectChanges();\n+      tick();\n+      submitButton.click();", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcwNzQxMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451707413", "bodyText": "Updated in the latest commit", "author": "rohithd-btc", "createdAt": "2020-07-08T17:23:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MjkyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MzE5Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449183193", "bodyText": "This is never used.", "author": "nikklassen", "createdAt": "2020-07-02T17:58:32Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.ts", "diffHunk": "@@ -1,8 +1,37 @@\n-import {Component} from '@angular/core';\n+import {Component, Input, Output, EventEmitter} from '@angular/core';\n+import {Router} from '@angular/router';\n+import {Location} from '../shared/location.model';\n+import {LocationService} from '../shared/location.service';\n+import {ToastrService} from 'ngx-toastr';\n+import {ApiResponse} from 'src/app/entity/error.model';\n+import {ApiSuccessResponse} from 'src/app/entity/sucess.model';\n \n @Component({\n   selector: 'location-add',\n   templateUrl: './add-location.component.html',\n   styleUrls: ['./add-location.component.scss'],\n })\n-export class AddLocationComponent {}\n+export class AddLocationComponent {\n+  @Input() enabled = true;\n+  @Output() onFormSubmit: EventEmitter<unknown> = new EventEmitter<unknown>();", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4MzY0Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450383643", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:47:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4MzE5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4OTQ4OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r449189489", "bodyText": "401 is basically the same as 400. You don't need a test for every status code if you don't have any logic that cares", "author": "nikklassen", "createdAt": "2020-07-02T18:10:52Z", "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts", "diffHunk": "@@ -118,4 +150,121 @@ describe('LocationService', () => {\n       },\n     );\n   }));\n+\n+  it('add location should return an error when the server returns a 400 ', fakeAsync(() => {", "originalCommit": "a2ba3a7364d59347f3bcc5bc6640e3cd0ed61b82", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDM4Mzc1OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r450383759", "bodyText": "Removed", "author": "rohithd-btc", "createdAt": "2020-07-06T17:47:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4OTQ4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA2MzY0OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451063649", "bodyText": "I don't see a change", "author": "nikklassen", "createdAt": "2020-07-07T18:31:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4OTQ4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcwNzI3OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451707279", "bodyText": "Updated in the latest commit", "author": "rohithd-btc", "createdAt": "2020-07-08T17:23:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE4OTQ4OQ=="}], "type": "inlineReview"}, {"oid": "f147ddf57726a488aec3858c64d8238fee488611", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f147ddf57726a488aec3858c64d8238fee488611", "message": "Location Model has been used in locationService", "committedDate": "2020-07-06T13:51:58Z", "type": "commit"}, {"oid": "db3ac3d8199f25431303f2d9a9a68d10eecfed1f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/db3ac3d8199f25431303f2d9a9a68d10eecfed1f", "message": "Few code review comments has been resolved", "committedDate": "2020-07-06T17:05:36Z", "type": "commit"}, {"oid": "8d8efce2a32993d9b7c72554b45814ab718ee0bc", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8d8efce2a32993d9b7c72554b45814ab718ee0bc", "message": "Merge branch 'urwebapp-addlocation-implementation' of https://github.com/GoogleCloudPlatform/fda-mystudies into urwebapp-addlocation-implementation\n\n# Conflicts:\n#\tUR-web-app/src/app/site-coordinator/location/add-location/add-location.component.ts", "committedDate": "2020-07-06T17:39:47Z", "type": "commit"}, {"oid": "154be9ce20ba3ce7751e302f25a24e5676716756", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/154be9ce20ba3ce7751e302f25a24e5676716756", "message": "Merge branch 'develop' into urwebapp-addlocation-implementation", "committedDate": "2020-07-07T14:19:38Z", "type": "commit"}, {"oid": "fae74cfe537a06cc5f60be6b8991708fdd47a71e", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/fae74cfe537a06cc5f60be6b8991708fdd47a71e", "message": "code review comments has been resolved", "committedDate": "2020-07-07T17:23:27Z", "type": "commit"}, {"oid": "bc098f48f81653aa74eb86fe2b3e514482b9c218", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bc098f48f81653aa74eb86fe2b3e514482b9c218", "message": "Chnaged test case name", "committedDate": "2020-07-07T17:23:46Z", "type": "commit"}, {"oid": "1516b986848506affda69fb6c267b99dfdf8228a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1516b986848506affda69fb6c267b99dfdf8228a", "message": "Reset Form test case has been removed", "committedDate": "2020-07-07T17:29:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyODk4MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451028980", "bodyText": "\"Successfully\" should not be capitalized.", "author": "nikklassen", "createdAt": "2020-07-07T17:29:36Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.ts", "diffHunk": "@@ -12,23 +13,20 @@ import {ToastrService} from 'ngx-toastr';\n export class AddLocationComponent {\n   @Input() enabled = true;\n   location = <Location>{};\n+  sub: Subscription = new Subscription();\n   constructor(\n     private readonly router: Router,\n     private readonly locationService: LocationService,\n     private readonly toastr: ToastrService,\n   ) {}\n \n   addLocation(): void {\n-    this.locationService.addLocation(this.location).subscribe(\n-      (succesResponse: Location) => {\n-        const success = succesResponse.successBean;\n-        this.toastr.success(success.message);\n-        void this.router.navigate(['/coordinator/locations']);\n-      },\n-      (errorResponse: Location) => {\n-        const errs = errorResponse.error;\n-        this.toastr.error(errs.userMessage);\n-      },\n-    );\n+    this.sub = this.locationService.addLocation(this.location).subscribe(() => {\n+      this.toastr.success('New location added Successfully');", "originalCommit": "bc098f48f81653aa74eb86fe2b3e514482b9c218", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcwNTg1MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451705850", "bodyText": "Updated in the latest commit", "author": "rohithd-btc", "createdAt": "2020-07-08T17:20:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyODk4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyOTU3Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451029576", "bodyText": "Don't use capitals for local variables.", "author": "nikklassen", "createdAt": "2020-07-07T17:30:33Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -47,49 +47,49 @@ describe('AddLocationComponent', () => {\n   beforeEach(async(() => {\n     fixture = TestBed.createComponent(AddLocationComponent);\n     component = fixture.componentInstance;\n-    submitLocation = fixture.debugElement.query(\n-      By.css('button[type=\"submit\"]'),\n-    );\n-    locationCustomIde1 = fixture.debugElement.query(\n-      By.css('input[id=locationCustomId]'),\n-    );\n-    locationNamee1 = fixture.debugElement.query(\n-      By.css('input[id=locationName]'),\n-    );\n-    locationDescriptione1 = fixture.debugElement.query(\n-      By.css('input[id=locationDescription]'),\n-    );\n \n+    submitLocation = fixture.debugElement.query(By.css('[name=\"add\"]'));\n+    customIdInput = fixture.debugElement.query(By.css('[name=\"customId\"]'));\n+    nameInput = fixture.debugElement.query(By.css('[name=\"name\"]'));\n+    descriptionInput = fixture.debugElement.query(\n+      By.css('[name=\"description\"]'),\n+    );\n     fixture.detectChanges();\n   }));\n \n   it('should create', () => {\n     expect(component).toBeTruthy();\n   });\n-  it('should not create a template-driven form when ngNoForm is used', () => {\n+\n+  it('should not show a validation error if the input field is filled', () => {\n+    component.location.customId = 'customid3';\n+    component.location.name = 'Location Name';\n+    component.location.description = 'This is location Description';\n     fixture.detectChanges();\n-    expect(fixture.debugElement.children[0].providerTokens.length).toEqual(0);\n+    const Errormsg = fixture.debugElement.query(By.css('.validation-error'));", "originalCommit": "bc098f48f81653aa74eb86fe2b3e514482b9c218", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcwNTc4Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451705783", "bodyText": "Updated in the latest commit", "author": "rohithd-btc", "createdAt": "2020-07-08T17:20:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTAyOTU3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA2MjYxOA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451062618", "bodyText": "where is this.locations being used other than here?", "author": "nikklassen", "createdAt": "2020-07-07T18:29:50Z", "path": "UR-web-app/src/app/site-coordinator/location/location-list/location-list.component.ts", "diffHunk": "@@ -33,7 +33,7 @@ export class LocationListComponent implements OnInit {\n     ).pipe(\n       map(([locations, query]) => {\n         this.locations = locations;\n-        return locations.filter(\n+        return this.locations.filter(", "originalCommit": "1516b986848506affda69fb6c267b99dfdf8228a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcwNzA2Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451707067", "bodyText": "In test case also this is being used", "author": "rohithd-btc", "createdAt": "2020-07-08T17:23:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA2MjYxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgxMDY1Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451810656", "bodyText": "You should just be accessing the locations observable. If your code doesn't use it you shouldn't be adding it just to test it.", "author": "nikklassen", "createdAt": "2020-07-08T20:36:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA2MjYxOA=="}], "type": "inlineReview"}, {"oid": "00844dd1e26d9a194c45084bdc59038270b01fb9", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/00844dd1e26d9a194c45084bdc59038270b01fb9", "message": "Comments has been resolved", "committedDate": "2020-07-08T17:20:00Z", "type": "commit"}, {"oid": "2bf88bf2e688a3e8ff6c0909d3d0ffadb9ba23e4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2bf88bf2e688a3e8ff6c0909d3d0ffadb9ba23e4", "message": "Comments has been resolved", "committedDate": "2020-07-08T17:25:15Z", "type": "commit"}, {"oid": "328ab5e9df28edfd99102aaee6c2be5fef83ccc4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/328ab5e9df28edfd99102aaee6c2be5fef83ccc4", "message": "Removed unused variable", "committedDate": "2020-07-08T17:28:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgwMzQ1Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451803453", "bodyText": "You're calling this function on line 118, you shouldn't be calling this API in this test.\nYou need to make sure your tests are working correctly. A bug in a test is the same as a bug anywhere else in the code.", "author": "nikklassen", "createdAt": "2020-07-08T20:22:19Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -66,55 +77,52 @@ describe('AddLocationComponent', () => {\n     component.location.name = 'Location Name';\n     component.location.description = 'This is location Description';\n     fixture.detectChanges();\n-    const Errormsg = fixture.debugElement.query(By.css('.validation-error'));\n-    expect(Errormsg).toBeFalsy();\n+    const errorMsg = fixture.debugElement.query(By.css('.validation-error'));\n+    expect(errorMsg).toBeFalsy();\n   });\n \n-  it('Locations value to input properties on form load', () => {\n+  it('should check form submit button is disabled when loaded', () => {\n     const submitButton = submitLocation.nativeElement as HTMLInputElement;\n     component.enabled = false;\n     fixture.detectChanges();\n     expect(submitButton.disabled).toBeTruthy();\n   });\n \n-  it('Entering value in input controls and check the same value', fakeAsync(() => {\n+  it('Entering value in input controls and check the same value and submit', fakeAsync(async () => {\n+    const expectedResponse = {\n+      id: 0,\n+      customId: 'customid3',\n+      name: 'Location Name',\n+      description: 'This is location Description',\n+      status: '1',\n+      studiesCount: 0,\n+      successBean: {message: 'location added successfully', code: '200 ok'},\n+      error: {detailMessage: '', type: '', userMessage: ''},\n+    };\n     fixture.componentInstance.location.customId = 'customid3';\n     fixture.componentInstance.location.name = 'Location Name';\n     fixture.componentInstance.location.description =\n       'This is location Description';\n-    void fixture.whenStable().then(() => {\n-      const submitButton = submitLocation.nativeElement as HTMLInputElement;\n-      const customIdInputs = customIdInput.nativeElement as HTMLInputElement;\n-      const nameInputs = nameInput.nativeElement as HTMLInputElement;\n-      const descriptionInputs = descriptionInput.nativeElement as HTMLInputElement;\n-      customIdInputs.value = 'customid3';\n-      nameInputs.value = 'Location Name';\n-      descriptionInputs.value = 'This is location Description';\n-      dispatchEvent(new Event('input'));\n-      fixture.detectChanges();\n-      tick();\n-      submitButton.click();\n-      fixture.detectChanges();\n-      expect(component.location.customId).toEqual('customid3');\n-      expect(component.location.name).toEqual('Location Name');\n-      expect(component.location.description).toEqual(\n-        'This is location Description',\n-      );\n-    });\n-  }));\n-\n-  it('should reset the form submit state when reset button is clicked', fakeAsync(() => {\n-    const forms = fixture.debugElement.children[0].injector.get(NgForm);\n-    const formEl = fixture.debugElement.query(By.css('form'));\n-\n-    dispatchEvent(new Event(formEl.nativeElement));\n+    await fixture.whenStable();\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    const customIdInputs = customIdInput.nativeElement as HTMLInputElement;\n+    const nameInputs = nameInput.nativeElement as HTMLInputElement;\n+    const descriptionInputs = descriptionInput.nativeElement as HTMLInputElement;\n+    customIdInputs.value = 'customid3';\n+    nameInputs.value = 'Location Name';\n+    descriptionInputs.value = 'This is location Description';\n+    dispatchEvent(new Event('input'));\n     fixture.detectChanges();\n     tick();\n-    expect(forms.valid).toBe(true);\n-\n-    dispatchEvent(new Event(formEl.nativeElement));\n+    submitButton.click();\n+    locationsServiceSpy.addLocation(expectedResponse);\n     fixture.detectChanges();\n-    tick();\n-    expect(forms.valid).toBe(true);\n+    expect(locationsServiceSpy.addLocation).toHaveBeenCalled();", "originalCommit": "328ab5e9df28edfd99102aaee6c2be5fef83ccc4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTkwMTU3Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r455901572", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-07-16T16:07:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgwMzQ1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgwMzgzMw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451803833", "bodyText": "prefer toHaveBeenCalledTimes(1)", "author": "nikklassen", "createdAt": "2020-07-08T20:22:57Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.spec.ts", "diffHunk": "@@ -66,55 +77,52 @@ describe('AddLocationComponent', () => {\n     component.location.name = 'Location Name';\n     component.location.description = 'This is location Description';\n     fixture.detectChanges();\n-    const Errormsg = fixture.debugElement.query(By.css('.validation-error'));\n-    expect(Errormsg).toBeFalsy();\n+    const errorMsg = fixture.debugElement.query(By.css('.validation-error'));\n+    expect(errorMsg).toBeFalsy();\n   });\n \n-  it('Locations value to input properties on form load', () => {\n+  it('should check form submit button is disabled when loaded', () => {\n     const submitButton = submitLocation.nativeElement as HTMLInputElement;\n     component.enabled = false;\n     fixture.detectChanges();\n     expect(submitButton.disabled).toBeTruthy();\n   });\n \n-  it('Entering value in input controls and check the same value', fakeAsync(() => {\n+  it('Entering value in input controls and check the same value and submit', fakeAsync(async () => {\n+    const expectedResponse = {\n+      id: 0,\n+      customId: 'customid3',\n+      name: 'Location Name',\n+      description: 'This is location Description',\n+      status: '1',\n+      studiesCount: 0,\n+      successBean: {message: 'location added successfully', code: '200 ok'},\n+      error: {detailMessage: '', type: '', userMessage: ''},\n+    };\n     fixture.componentInstance.location.customId = 'customid3';\n     fixture.componentInstance.location.name = 'Location Name';\n     fixture.componentInstance.location.description =\n       'This is location Description';\n-    void fixture.whenStable().then(() => {\n-      const submitButton = submitLocation.nativeElement as HTMLInputElement;\n-      const customIdInputs = customIdInput.nativeElement as HTMLInputElement;\n-      const nameInputs = nameInput.nativeElement as HTMLInputElement;\n-      const descriptionInputs = descriptionInput.nativeElement as HTMLInputElement;\n-      customIdInputs.value = 'customid3';\n-      nameInputs.value = 'Location Name';\n-      descriptionInputs.value = 'This is location Description';\n-      dispatchEvent(new Event('input'));\n-      fixture.detectChanges();\n-      tick();\n-      submitButton.click();\n-      fixture.detectChanges();\n-      expect(component.location.customId).toEqual('customid3');\n-      expect(component.location.name).toEqual('Location Name');\n-      expect(component.location.description).toEqual(\n-        'This is location Description',\n-      );\n-    });\n-  }));\n-\n-  it('should reset the form submit state when reset button is clicked', fakeAsync(() => {\n-    const forms = fixture.debugElement.children[0].injector.get(NgForm);\n-    const formEl = fixture.debugElement.query(By.css('form'));\n-\n-    dispatchEvent(new Event(formEl.nativeElement));\n+    await fixture.whenStable();\n+    const submitButton = submitLocation.nativeElement as HTMLInputElement;\n+    const customIdInputs = customIdInput.nativeElement as HTMLInputElement;\n+    const nameInputs = nameInput.nativeElement as HTMLInputElement;\n+    const descriptionInputs = descriptionInput.nativeElement as HTMLInputElement;\n+    customIdInputs.value = 'customid3';\n+    nameInputs.value = 'Location Name';\n+    descriptionInputs.value = 'This is location Description';\n+    dispatchEvent(new Event('input'));\n     fixture.detectChanges();\n     tick();\n-    expect(forms.valid).toBe(true);\n-\n-    dispatchEvent(new Event(formEl.nativeElement));\n+    submitButton.click();\n+    locationsServiceSpy.addLocation(expectedResponse);\n     fixture.detectChanges();\n-    tick();\n-    expect(forms.valid).toBe(true);\n+    expect(locationsServiceSpy.addLocation).toHaveBeenCalled();\n+    expect(locationsServiceSpy.addLocation.calls.count()).toBe(1, 'one call');", "originalCommit": "328ab5e9df28edfd99102aaee6c2be5fef83ccc4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTkwMTUzNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r455901536", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-07-16T16:07:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgwMzgzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgxMDk4Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r451810987", "bodyText": "You deleted the subscription.", "author": "nikklassen", "createdAt": "2020-07-08T20:37:15Z", "path": "UR-web-app/src/app/site-coordinator/location/add-location/add-location.component.ts", "diffHunk": "@@ -21,8 +21,8 @@ export class AddLocationComponent {\n   ) {}\n \n   addLocation(): void {\n-    this.sub = this.locationService.addLocation(this.location).subscribe(() => {\n-      this.toastr.success('New location added Successfully');\n+    this.locationService.addLocation(this.location).subscribe(() => {", "originalCommit": "328ab5e9df28edfd99102aaee6c2be5fef83ccc4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTkwMTI2Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/588#discussion_r455901266", "bodyText": "Updated.", "author": "firdosebtc1", "createdAt": "2020-07-16T16:06:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgxMDk4Nw=="}], "type": "inlineReview"}, {"oid": "4dc8822e92510fd0e42ffca2a434eb3881f6373d", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/4dc8822e92510fd0e42ffca2a434eb3881f6373d", "message": "Code review comments has been resolved,", "committedDate": "2020-07-16T16:02:14Z", "type": "commit"}, {"oid": "d18db402c542613064b9d69db3459a03ec3d7e52", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d18db402c542613064b9d69db3459a03ec3d7e52", "message": "handled button with name attribute", "committedDate": "2020-07-17T15:09:54Z", "type": "commit"}, {"oid": "ae191fae433ab72bc58d8f7049888cca80b65eca", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ae191fae433ab72bc58d8f7049888cca80b65eca", "message": "Merge branch 'develop' into urwebapp-addlocation-implementation", "committedDate": "2020-07-22T09:25:24Z", "type": "commit"}]}