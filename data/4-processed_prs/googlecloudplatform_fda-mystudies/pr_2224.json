{"pr_number": 2224, "pr_title": "Participant Manager Datastore : GET /{studyId}/participants endpoint pagination", "pr_createdAt": "2020-12-02T14:56:44Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2224", "timeline": [{"oid": "b1beec7d561091076baaa51a37472fee2cca6cd4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b1beec7d561091076baaa51a37472fee2cca6cd4", "message": "study participant pagination", "committedDate": "2020-12-02T14:54:04Z", "type": "commit"}, {"oid": "13cbbc1f4b0396759147696a5b69a0e5610288cb", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/13cbbc1f4b0396759147696a5b69a0e5610288cb", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-02T15:02:41Z", "type": "commit"}, {"oid": "7dd0cb9a5bfd16828a07d05b4f1cadceda34393f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7dd0cb9a5bfd16828a07d05b4f1cadceda34393f", "message": "updated sorting and serach term", "committedDate": "2020-12-07T13:16:22Z", "type": "commit"}, {"oid": "d432cda5f7acf877c139195ca9dec915886a3a03", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d432cda5f7acf877c139195ca9dec915886a3a03", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-07T13:21:52Z", "type": "commit"}, {"oid": "f2f01ce7928cd0f938b31bb332bb03d8a92fdfcf", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f2f01ce7928cd0f938b31bb332bb03d8a92fdfcf", "message": "Update StudyController.java", "committedDate": "2020-12-07T13:52:59Z", "type": "commit"}, {"oid": "a8185661c04a949df4d661407a5f0280c450f6b4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a8185661c04a949df4d661407a5f0280c450f6b4", "message": "sorting", "committedDate": "2020-12-07T14:08:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkzNzc0Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2224#discussion_r537937743", "bodyText": "sortBy/sort by ?", "author": "saminguyen", "createdAt": "2020-12-08T00:26:29Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java", "diffHunk": "@@ -329,6 +329,12 @@\n       HttpStatus.NOT_FOUND.toString(),\n       \"This view displays app-wise enrollment if you manage multiple studies.\"),\n \n+  UNSUPPORTED_SORTBY_VALUE(\n+      400, \"EC_0076\", HttpStatus.BAD_REQUEST.toString(), \"Invalid sortby value\"),", "originalCommit": "a8185661c04a949df4d661407a5f0280c450f6b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODAzODU4Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2224#discussion_r538038582", "bodyText": "Changed to sortBy.", "author": "navya-BTC", "createdAt": "2020-12-08T05:07:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkzNzc0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzk0MjYzMQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2224#discussion_r537942631", "bodyText": "verify returned values are actually sorted by siteId", "author": "saminguyen", "createdAt": "2020-12-08T00:38:43Z", "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/StudyControllerTest.java", "diffHunk": "@@ -515,23 +553,50 @@ public void shouldReturnStudyParticipantsForPagination() throws Exception {\n       participantStudyEntity =\n           testDataHelper.createParticipantStudyEntity(\n               siteEntity, studyEntity, participantRegistrySiteEntity);\n+      // Pagination records should be in descending order of created timestamp\n+      // Entities are not saved in sequential order so adding delay\n+      Thread.sleep(5);\n     }\n \n-    // get study participant if page and limit values are null\n+    // Step 2: Call API and expect GET_PARTICIPANT_REGISTRY_SUCCESS message and fetch only 10 data\n+    // out of 21\n     mockMvc\n         .perform(\n             get(ApiEndpoint.GET_STUDY_PARTICIPANT.getPath(), studyEntity.getId())\n                 .headers(headers)\n+                .param(\"limit\", \"10\")\n+                .param(\"offset\", \"0\")\n+                .param(\"sortBy\", \"siteId\")\n+                .param(\"sortDirection\", \"desc\")", "originalCommit": "a8185661c04a949df4d661407a5f0280c450f6b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODA0MDY2Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2224#discussion_r538040662", "bodyText": "In Study Participant Registry page we have siteId column which is locationName in backend, hence verified locationName as below code\n .andExpect(\n            jsonPath(\"$.participantRegistryDetail.registryParticipants[0].locationName\")\n                .value(LOCATION_NAME_VALUE + String.valueOf(9)))", "author": "navya-BTC", "createdAt": "2020-12-08T05:13:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzk0MjYzMQ=="}], "type": "inlineReview"}, {"oid": "67e8d395fc4214a1c752448f8c8ead08aaca64e3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/67e8d395fc4214a1c752448f8c8ead08aaca64e3", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-08T04:56:58Z", "type": "commit"}, {"oid": "19146ee5aa1b943c8412af7ade73d2e51b617ab5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/19146ee5aa1b943c8412af7ade73d2e51b617ab5", "message": "Update ErrorCode.java", "committedDate": "2020-12-08T05:02:07Z", "type": "commit"}, {"oid": "183a6692c5701d5461f830f33aa0d1d2b6df1ea1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/183a6692c5701d5461f830f33aa0d1d2b6df1ea1", "message": "Merge branch 'participant-manager-studyParticipant-pagination' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-08T05:02:14Z", "type": "commit"}, {"oid": "9b305ad5b49ac52e088cb92488356e0c2cc93e52", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9b305ad5b49ac52e088cb92488356e0c2cc93e52", "message": "Update StudyControllerTest.java", "committedDate": "2020-12-08T12:23:59Z", "type": "commit"}, {"oid": "5c34f808b90d09eef8ce93a8a92cf508e62c4fa1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/5c34f808b90d09eef8ce93a8a92cf508e62c4fa1", "message": "siteId changed to locationName", "committedDate": "2020-12-09T13:32:58Z", "type": "commit"}, {"oid": "a50f071fb884c25cf579e17ba55a5546fc6651cb", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a50f071fb884c25cf579e17ba55a5546fc6651cb", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-11T13:09:11Z", "type": "commit"}, {"oid": "f498d73856f883584f07992f1e5978a291a98ed5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f498d73856f883584f07992f1e5978a291a98ed5", "message": "fixed build issue\n\nfixed build issue", "committedDate": "2020-12-11T13:13:31Z", "type": "commit"}, {"oid": "509837dc8738901d2c22537780d6d7548c0cd060", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/509837dc8738901d2c22537780d6d7548c0cd060", "message": "Update StudyServiceImpl.java", "committedDate": "2020-12-14T05:54:49Z", "type": "commit"}, {"oid": "ac91bc75cc1ba66fa647deb8fcd8ee7317f9adce", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ac91bc75cc1ba66fa647deb8fcd8ee7317f9adce", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-14T05:58:13Z", "type": "commit"}, {"oid": "a506952ff278bca89ff3c386157fda3d87c3e2d3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a506952ff278bca89ff3c386157fda3d87c3e2d3", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-14T21:32:08Z", "type": "commit"}, {"oid": "3be72f897c2585f48dd41d89894a25e53f5f36c1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3be72f897c2585f48dd41d89894a25e53f5f36c1", "message": "Update StudyRepository.java", "committedDate": "2020-12-14T21:46:36Z", "type": "commit"}, {"oid": "9199df6485b75c9e964c50be704e65f6a4042f11", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9199df6485b75c9e964c50be704e65f6a4042f11", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-15T02:00:47Z", "type": "commit"}, {"oid": "7b111f4f35a41137174b56b4abae26b2671c7437", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7b111f4f35a41137174b56b4abae26b2671c7437", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-15T05:22:05Z", "type": "commit"}, {"oid": "0c6f823e57d2460ddcd9ecdedc1b7823bda9c6a1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0c6f823e57d2460ddcd9ecdedc1b7823bda9c6a1", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-15T05:22:38Z", "type": "commit"}, {"oid": "46f7e6ec932c8f05ee54a061b7fb614df6b794af", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/46f7e6ec932c8f05ee54a061b7fb614df6b794af", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-15T06:46:21Z", "type": "commit"}, {"oid": "fbaf0b6c348b3d612f6b8ca4edd76d12ce16eaa5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/fbaf0b6c348b3d612f6b8ca4edd76d12ce16eaa5", "message": "Merge branch 'develop' into participant-manager-studyParticipant-pagination", "committedDate": "2020-12-15T13:48:04Z", "type": "commit"}]}