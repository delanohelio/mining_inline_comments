{"pr_number": 889, "pr_title": "Participant Manager Service - Externalized configuration", "pr_createdAt": "2020-09-06T13:30:10Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889", "timeline": [{"oid": "d6887ee9ed92b44ae740385e915694f79f478fee", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d6887ee9ed92b44ae740385e915694f79f478fee", "message": "Participant Manager Service - Externalized configuration\n\nParticipant Manager Service - Externalized configuration\nCode Format + Organize Imports", "committedDate": "2020-09-06T13:28:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUzMDc1Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889#discussion_r484530757", "bodyText": "Might be better to use local path here, e.g. ./logs.\nThis won't work in different operating systems", "author": "zohrehj", "createdAt": "2020-09-07T17:32:39Z", "path": "common-modules/common-tests/src/main/resources/application-mockit-common.properties", "diffHunk": "@@ -3,6 +3,7 @@ logging.level.root=INFO\n logging.level.com.google.cloud.healthcare.fdamystudies=ERROR\n logging.level.org.apache.http=ERROR\n logging.level.org.springframework.web.client.RestTemplate=ERROR\n+logging.path=C:/logs", "originalCommit": "d6887ee9ed92b44ae740385e915694f79f478fee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDc1NDA5Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889#discussion_r484754097", "bodyText": "Fixed review comment", "author": "dhanyak-btc", "createdAt": "2020-09-08T08:46:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUzMDc1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUzMTE1NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889#discussion_r484531155", "bodyText": "please add documentation as to what these values should hold.\nFor the default flag, I would suggest just adding the value we recommend for most users and let them to modify it if they need to.", "author": "zohrehj", "createdAt": "2020-09-07T17:34:53Z", "path": "participant-manager-module/participant-manager-service/src/main/resources/application.properties", "diffHunk": "@@ -39,6 +42,28 @@ smtp.hostname=${SMTP_HOSTNAME}\n smtp.port=465\n factory.value=javax.net.ssl.SSLSocketFactory\n \n-bucket.name=consent-test-pdf\n+bucket.name=${GCP_BUCKET_NAME}\n+\n+org.name=${ORG_NAME}\n+\n+## Spring DATASOURCE (DataSourceAutoConfiguration & DataSourceProperties)\n+spring.datasource.url=jdbc:mysql://${CLOUD_SQL_INSTANCE_IP}/${DB_NAME}?createDatabaseIfNotExist=false&autoReconnect=true&characterEncoding=utf8&useSSL=true&allowPublicKeyRetrieval=true\n+spring.datasource.username=${DB_USER}\n+spring.datasource.password=${DB_PASS}\n+spring.datasource.driverClassName=com.mysql.cj.jdbc.Driver\n+spring.jpa.database-platform=org.hibernate.dialect.MySQL55Dialect\n+spring.jpa.hibernate.ddl-auto=none\n+spring.jpa.show-sql=false\n+\n+# hikari   \n+spring.datasource.type=com.zaxxer.hikari.HikariDataSource\n+spring.datasource.hikari.connection-test-query=SELECT 1\n+spring.datasource.hikari.idle-timeout=600000\n+spring.datasource.hikari.minimum-idle=10\n+spring.datasource.hikari.maximum-pool-size=100\n+spring.datasource.hikari.connectionTimeout=30000\n+spring.datasource.hikari.maxLifetime=1800000\n \n-org.name=Org Name\n+# Spring Boot Actuator configs, check the details at http://localhost:8003/participant-manager-service/actuator\n+management.endpoints.enabled-by-default=${ACTUATOR_ENABLED_BY_DEFAULT}\n+management.endpoints.web.exposure.include=${ACTUATOR_EXPOSE_ENDPOINTS}", "originalCommit": "d6887ee9ed92b44ae740385e915694f79f478fee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDc1NTQyNg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889#discussion_r484755426", "bodyText": "Added a comment to refer Spring Actuator Exposing Endpoints for more details on available endpoints. Changed the prop values as below:\nmanagement.endpoints.enabled-by-default=true\nmanagement.endpoints.web.exposure.include=logfile,loggers", "author": "dhanyak-btc", "createdAt": "2020-09-08T08:48:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUzMTE1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUzMTQyNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889#discussion_r484531424", "bodyText": "why are these values being passed in the datasource url? Is this a workaround?\nIs there any other, more descriptive  way of setting these properties?\nalso we need to keep track of all new deployment variables, please document how these values should be set either here or in the quick start guide.", "author": "zohrehj", "createdAt": "2020-09-07T17:36:12Z", "path": "participant-manager-module/participant-manager-service/src/main/resources/application.properties", "diffHunk": "@@ -39,6 +42,28 @@ smtp.hostname=${SMTP_HOSTNAME}\n smtp.port=465\n factory.value=javax.net.ssl.SSLSocketFactory\n \n-bucket.name=consent-test-pdf\n+bucket.name=${GCP_BUCKET_NAME}\n+\n+org.name=${ORG_NAME}\n+\n+## Spring DATASOURCE (DataSourceAutoConfiguration & DataSourceProperties)\n+spring.datasource.url=jdbc:mysql://${CLOUD_SQL_INSTANCE_IP}/${DB_NAME}?createDatabaseIfNotExist=false&autoReconnect=true&characterEncoding=utf8&useSSL=true&allowPublicKeyRetrieval=true", "originalCommit": "d6887ee9ed92b44ae740385e915694f79f478fee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDgyMzU3MQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889#discussion_r484823571", "bodyText": "My bad, I referred early-access branch for correct url and replaced it.\nI also read Google Cloud SQL \u2014 4 ways (Spring) and since we're using cloud sql proxy in tf-deployment.yaml , we don't need to provide ${CLOUD_SQL_INSTANCE_IP}", "author": "dhanyak-btc", "createdAt": "2020-09-08T10:44:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUzMTQyNA=="}], "type": "inlineReview"}, {"oid": "79f0c1888667755761d576323480af4764de7bc8", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/79f0c1888667755761d576323480af4764de7bc8", "message": "Fixed Review Comments on Actuator endpoints\n\nFixed Review Comments on Actuator endpoints", "committedDate": "2020-09-08T08:45:40Z", "type": "commit"}, {"oid": "62edcc50e44f1505ac42590b907d44f59cd20e24", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/62edcc50e44f1505ac42590b907d44f59cd20e24", "message": "Changed database url\n\nChanged database url", "committedDate": "2020-09-08T10:41:30Z", "type": "commit"}, {"oid": "7974406d0c9961be379940c692ea1648340cc88f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7974406d0c9961be379940c692ea1648340cc88f", "message": "Removed properties from database connection url\n\nRemoved properties from database connection url", "committedDate": "2020-09-18T12:08:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk4NTUwNw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889#discussion_r490985507", "bodyText": "please add a comment describing what this bucket name is used for", "author": "zohrehj", "createdAt": "2020-09-18T14:23:23Z", "path": "participant-manager-module/participant-manager-service/src/main/resources/application.properties", "diffHunk": "@@ -39,6 +39,30 @@ smtp.hostname=${SMTP_HOSTNAME}\n smtp.port=465\n factory.value=javax.net.ssl.SSLSocketFactory\n \n-bucket.name=consent-test-pdf\n+bucket.name=${GCP_BUCKET_NAME}", "originalCommit": "7974406d0c9961be379940c692ea1648340cc88f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDE2Nzk3Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/889#discussion_r494167973", "bodyText": "Fixed review comment.", "author": "madhurya-btc", "createdAt": "2020-09-24T09:23:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDk4NTUwNw=="}], "type": "inlineReview"}, {"oid": "5f90f898453051a28324e89d2a7f359bd9f30c8b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/5f90f898453051a28324e89d2a7f359bd9f30c8b", "message": "Merge branch 'develop' into participant_manager_externalized_configuration", "committedDate": "2020-09-24T09:03:40Z", "type": "commit"}, {"oid": "1ee8f8d0e6060ddca483b57ccb60b6b5ab915c25", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1ee8f8d0e6060ddca483b57ccb60b6b5ab915c25", "message": "added comment for bucket.name", "committedDate": "2020-09-24T09:17:19Z", "type": "commit"}, {"oid": "87847808ad59b6361926ed2ecdbf0ed84614e16e", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/87847808ad59b6361926ed2ecdbf0ed84614e16e", "message": "cloud storage bucket name comment in property file", "committedDate": "2020-09-24T12:22:08Z", "type": "commit"}, {"oid": "7325a0cdf0b9d939091c84d46f7c89a1550f4e1f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7325a0cdf0b9d939091c84d46f7c89a1550f4e1f", "message": "Merge branch 'develop' into participant_manager_externalized_configuration", "committedDate": "2020-09-24T14:20:28Z", "type": "commit"}, {"oid": "944912ef2724aab6407e8e49a0b8b14dd49d92b6", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/944912ef2724aab6407e8e49a0b8b14dd49d92b6", "message": "Build issue fix", "committedDate": "2020-09-24T14:33:03Z", "type": "commit"}, {"oid": "65d6bc2e877b0924950914bc27ce8545f889fa9b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/65d6bc2e877b0924950914bc27ce8545f889fa9b", "message": "Merge branch 'participant_manager_externalized_configuration' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant_manager_externalized_configuration", "committedDate": "2020-09-24T14:37:22Z", "type": "commit"}, {"oid": "8cf2b3a9b5f46d361bd2104830f1cd9932d0ff79", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8cf2b3a9b5f46d361bd2104830f1cd9932d0ff79", "message": "Fixed test cases failure", "committedDate": "2020-09-24T14:57:11Z", "type": "commit"}, {"oid": "2855aeb105e7fbba4b79cb5e7c8f730d0134a185", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2855aeb105e7fbba4b79cb5e7c8f730d0134a185", "message": "Merge branch 'develop' into participant_manager_externalized_configuration", "committedDate": "2020-09-24T16:16:42Z", "type": "commit"}, {"oid": "2f2e752f02fb37b0516e193702f0a3dd5f9be16d", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2f2e752f02fb37b0516e193702f0a3dd5f9be16d", "message": "Merge branch 'develop' into participant_manager_externalized_configuration", "committedDate": "2020-09-25T14:17:44Z", "type": "commit"}]}