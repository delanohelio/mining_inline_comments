{"pr_number": 753, "pr_title": "GHRepository.createCheckRun", "pr_createdAt": "2020-03-25T03:59:22Z", "pr_url": "https://github.com/hub4j/github-api/pull/753", "timeline": [{"oid": "7d5a39ed896708787b0abc50f069aa1517c4fd8b", "url": "https://github.com/hub4j/github-api/commit/7d5a39ed896708787b0abc50f069aa1517c4fd8b", "message": "GHRepository.createCheckRun", "committedDate": "2020-03-25T03:51:38Z", "type": "commit"}, {"oid": "36ab2a889fe4a52c103c6a0603081271f059c9ec", "url": "https://github.com/hub4j/github-api/commit/36ab2a889fe4a52c103c6a0603081271f059c9ec", "message": "Redesigned using a fluent builder idiom", "committedDate": "2020-03-25T17:14:06Z", "type": "commit"}, {"oid": "b715e0cef7fea6aaf9b3aa47a6fe1850bc09cee2", "url": "https://github.com/hub4j/github-api/commit/b715e0cef7fea6aaf9b3aa47a6fe1850bc09cee2", "message": "Reformatted", "committedDate": "2020-03-25T17:18:11Z", "type": "commit"}, {"oid": "572ff9df19cd0148662f24a8d0cda74aec84091f", "url": "https://github.com/hub4j/github-api/commit/572ff9df19cd0148662f24a8d0cda74aec84091f", "message": "I guess nullability annotations can be omitted from internal members", "committedDate": "2020-03-25T17:20:33Z", "type": "commit"}, {"oid": "c7fb390c3801b0d5a16270b3917f01e391daefe5", "url": "https://github.com/hub4j/github-api/commit/c7fb390c3801b0d5a16270b3917f01e391daefe5", "message": "Introduced enums", "committedDate": "2020-03-25T17:40:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA0OTY5OA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r398049698", "bodyText": "queued actually", "author": "jglick", "createdAt": "2020-03-25T17:45:34Z", "path": "src/main/java/org/kohsuke/github/GHCheckRun.java", "diffHunk": "@@ -51,19 +51,20 @@ GHCheckRun wrap(GitHub root) {\n     }\n \n     /**\n-     * Gets status of the check run. It can be one of \"queue\", \"in_progress\", or \"completed\"", "originalCommit": "c7fb390c3801b0d5a16270b3917f01e391daefe5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA0OTgwMg==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r398049802", "bodyText": "timed_out actually", "author": "jglick", "createdAt": "2020-03-25T17:45:44Z", "path": "src/main/java/org/kohsuke/github/GHCheckRun.java", "diffHunk": "@@ -51,19 +51,20 @@ GHCheckRun wrap(GitHub root) {\n     }\n \n     /**\n-     * Gets status of the check run. It can be one of \"queue\", \"in_progress\", or \"completed\"\n+     * Gets status of the check run.\n      *\n      * @return Status of the check run\n+     * @see GHCheckRunStatus\n      */\n     public String getStatus() {\n         return status;\n     }\n \n     /**\n-     * Gets conclusion of a completed check run. It can be one of \"success\", \"failure\", \"neutral\", \"cancelled\",\n-     * \"time_out\", or \"action_required\".", "originalCommit": "c7fb390c3801b0d5a16270b3917f01e391daefe5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA5MDY4Mw==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r398090683", "bodyText": "Out of curiosity, why not make this an inner class of GHCheckRun?  (GHCheckRun.AnnotationLevel)", "author": "bitwiseman", "createdAt": "2020-03-25T18:48:04Z", "path": "src/main/java/org/kohsuke/github/GHCheckRunAnnotationLevel.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+public enum GHCheckRunAnnotationLevel {", "originalCommit": "c7fb390c3801b0d5a16270b3917f01e391daefe5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI0MjI2Nw==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r398242267", "bodyText": "I could. Did not see a clear convention here.", "author": "jglick", "createdAt": "2020-03-26T00:00:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA5MDY4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY1NzYxNw==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r398657617", "bodyText": "I was more interested in what your reasoning was. In this case I would lean towards the inner class since it is the AnnotationLevel for  GHCheckRun only, not for any other class, but that feels like a somewhat weak reason.", "author": "bitwiseman", "createdAt": "2020-03-26T15:20:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA5MDY4Mw=="}], "type": "inlineReview"}, {"oid": "cd7963b30d2f0b26ae6720ecacc3f8e43f284c77", "url": "https://github.com/hub4j/github-api/commit/cd7963b30d2f0b26ae6720ecacc3f8e43f284c77", "message": "Acc to https://github.com/github-api/github-api/blob/7a650132c52d40c50173268b3cee368c009b7637/src/main/java/org/kohsuke/github/GitHubBuilder.java#L221 it is GITHUB_LOGIN not GITHUB_USER", "committedDate": "2020-03-25T21:52:32Z", "type": "commit"}, {"oid": "e8b4de00d218d64fdb5b170009e04cebaf99befd", "url": "https://github.com/hub4j/github-api/commit/e8b4de00d218d64fdb5b170009e04cebaf99befd", "message": "WireMock coverage", "committedDate": "2020-03-25T23:18:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIyOTEwMQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r398229101", "bodyText": "The formatter plugin obliterates attempts to indent this readably.", "author": "jglick", "createdAt": "2020-03-25T23:20:47Z", "path": "src/test/java/org/kohsuke/github/GHCheckRunBuilderTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import org.junit.Test;\n+\n+import java.util.Date;\n+\n+@SuppressWarnings(\"deprecation\") // preview\n+public class GHCheckRunBuilderTest extends AbstractGitHubWireMockTest {\n+\n+    @Test\n+    public void createCheckRun() throws Exception {\n+        GHCheckRun checkRun = gitHub.getRepository(\"jglick/github-api-test\")\n+                .createCheckRun(\"foo\", \"4a929d464a2fae7ee899ce603250f7dab304bc4b\")\n+                .withStatus(GHCheckRunStatus.COMPLETED)\n+                .withConclusion(GHCheckRunConclusion.SUCCESS)\n+                .withDetailsURL(\"http://nowhere.net/stuff\")\n+                .withExternalID(\"whatever\")\n+                .withStartedAt(new Date(999_999_000))\n+                .withCompletedAt(new Date(999_999_999))\n+                .withOutput(\"Some Title\", \"what happened\u2026\")\n+                .withAnnotation(\"stuff.txt\", 1, GHCheckRunAnnotationLevel.NOTICE, \"hello to you too\")", "originalCommit": "e8b4de00d218d64fdb5b170009e04cebaf99befd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7ae96388e3bcc255c0bf1f162462b23a5f6ca712", "url": "https://github.com/hub4j/github-api/commit/7ae96388e3bcc255c0bf1f162462b23a5f6ca712", "message": "Merge branch 'master' of github.com:github-api/github-api into createCheckRun", "committedDate": "2020-03-25T23:21:46Z", "type": "commit"}, {"oid": "6c41f22b57c190d4112c41f71136407d87f53357", "url": "https://github.com/hub4j/github-api/commit/6c41f22b57c190d4112c41f71136407d87f53357", "message": "Coverage of DraftImage", "committedDate": "2020-03-25T23:59:42Z", "type": "commit"}, {"oid": "03de12c2213e6afa7dd1c367db0de0e494b4fa5b", "url": "https://github.com/hub4j/github-api/commit/03de12c2213e6afa7dd1c367db0de0e494b4fa5b", "message": "SpotBugs", "committedDate": "2020-03-26T00:03:18Z", "type": "commit"}, {"oid": "26b80821550f1a54bf167a75af31fc0e11f46fe2", "url": "https://github.com/hub4j/github-api/commit/26b80821550f1a54bf167a75af31fc0e11f46fe2", "message": "Handle >50 annotations", "committedDate": "2020-03-26T20:14:39Z", "type": "commit"}, {"oid": "b5dc3c4366e964db170fdab3be5d5deb5ba70a97", "url": "https://github.com/hub4j/github-api/commit/b5dc3c4366e964db170fdab3be5d5deb5ba70a97", "message": "Added some Javadoc.", "committedDate": "2020-03-26T20:22:04Z", "type": "commit"}, {"oid": "d8274ac2d4dec2e283034cc60d70fe16d42a5433", "url": "https://github.com/hub4j/github-api/commit/d8274ac2d4dec2e283034cc60d70fe16d42a5433", "message": "Merge branch 'javadoc' into createCheckRun", "committedDate": "2020-03-26T20:26:52Z", "type": "commit"}, {"oid": "fd3c36a259be250b9325df97fa1fa2c766f6bfa1", "url": "https://github.com/hub4j/github-api/commit/fd3c36a259be250b9325df97fa1fa2c766f6bfa1", "message": "IMHO treating Javadoc warnings as fatal makes sources less legible and does not improve API comprehension at all", "committedDate": "2020-03-26T20:33:57Z", "type": "commit"}, {"oid": "b4c4a05f3bd903254dacc4ac9dc5de3c4da80645", "url": "https://github.com/hub4j/github-api/commit/b4c4a05f3bd903254dacc4ac9dc5de3c4da80645", "message": "Moving enums inside GHCheckRun", "committedDate": "2020-03-26T20:44:01Z", "type": "commit"}, {"oid": "b2c513ea4256035bfe039ea2120ff6ddf4fed499", "url": "https://github.com/hub4j/github-api/commit/b2c513ea4256035bfe039ea2120ff6ddf4fed499", "message": "Merge branch 'master' into createCheckRun", "committedDate": "2020-03-26T21:10:29Z", "type": "commit"}, {"oid": "c01f3f5e8ace2279a797d9fb391f798354101241", "url": "https://github.com/hub4j/github-api/commit/c01f3f5e8ace2279a797d9fb391f798354101241", "message": "NPE when there are no annotations", "committedDate": "2020-03-26T23:07:35Z", "type": "commit"}, {"oid": "c499c73dccdaf2cc808d84de9efe7ea84fbb0659", "url": "https://github.com/hub4j/github-api/commit/c499c73dccdaf2cc808d84de9efe7ea84fbb0659", "message": "Merge branch 'master' of github.com:github-api/github-api into createCheckRun", "committedDate": "2020-03-26T23:09:13Z", "type": "commit"}, {"oid": "8b51a44b7c7536b5cbb7f24de32a6519126224ad", "url": "https://github.com/hub4j/github-api/commit/8b51a44b7c7536b5cbb7f24de32a6519126224ad", "message": "Merge branch 'createCheckRun' of github.com:jglick/github-api into createCheckRun", "committedDate": "2020-03-26T23:10:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNzA5Ng==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399337096", "bodyText": "Add links to the pertinent GitHub docs, such as https://developer.github.com/v3/checks/runs/#actions-object.", "author": "bitwiseman", "createdAt": "2020-03-27T15:13:02Z", "path": "src/main/java/org/kohsuke/github/GHCheckRunBuilder.java", "diffHunk": "@@ -0,0 +1,358 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import edu.umd.cs.findbugs.annotations.CheckForNull;\n+import edu.umd.cs.findbugs.annotations.NonNull;\n+import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.Date;\n+import java.util.LinkedList;\n+import java.util.List;\n+import java.util.Locale;\n+\n+/**\n+ * Drafts a check run.\n+ *\n+ * @see GHCheckRun\n+ * @see GHRepository#createCheckRun\n+ * @see <a href=\"https://developer.github.com/v3/checks/runs/\">documentation</a>\n+ */\n+@SuppressFBWarnings(value = \"URF_UNREAD_FIELD\", justification = \"Jackson serializes these even without a getter\")\n+@Preview\n+@Deprecated\n+public final class GHCheckRunBuilder {\n+\n+    private final GHRepository repo;\n+    private final Requester requester;\n+    DraftOutput output;\n+    List<DraftAction> actions;\n+\n+    GHCheckRunBuilder(GHRepository repo, String name, String headSHA) {\n+        this.repo = repo;\n+        requester = repo.root.createRequest()\n+                .withPreview(Previews.ANTIOPE)\n+                .method(\"POST\")\n+                .with(\"name\", name)\n+                .with(\"head_sha\", headSHA)\n+                .withUrlPath(repo.getApiTailUrl(\"check-runs\"));\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withDetailsURL(@CheckForNull String detailsURL) {\n+        requester.with(\"details_url\", detailsURL);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withExternalID(@CheckForNull String externalID) {\n+        requester.with(\"external_id\", externalID);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStatus(@CheckForNull GHCheckRun.Status status) {\n+        if (status != null) {\n+            // Do *not* use the overload taking Enum, as that s/_/-/g which would be wrong here.\n+            requester.with(\"status\", status.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withConclusion(@CheckForNull GHCheckRun.Conclusion conclusion) {\n+        if (conclusion != null) {\n+            requester.with(\"conclusion\", conclusion.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStartedAt(@CheckForNull Date startedAt) {\n+        if (startedAt != null) {\n+            requester.with(\"started_at\", GitHubClient.printDate(startedAt));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withCompletedAt(@CheckForNull Date completedAt) {\n+        if (completedAt != null) {\n+            requester.with(\"completed_at\", GitHubClient.printDate(completedAt));\n+        }\n+        return this;\n+    }\n+\n+    /**\n+     * Drafts the output section.\n+     *\n+     * @param title\n+     *            as in GitHub documentation\n+     * @param summary\n+     *            as in GitHub documentation\n+     * @return use {@link DraftOutput#done} to continue\n+     */\n+    public @NonNull DraftOutput withOutput(@NonNull String title, @NonNull String summary) {\n+        return new DraftOutput(this, title, summary);\n+    }\n+\n+    /**\n+     * Drafts an action section.", "originalCommit": "8b51a44b7c7536b5cbb7f24de32a6519126224ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU5NTM1MA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399595350", "bodyText": "There's a maximum of three actions allowed.  But the GitHub docs do not make it clear what happens when actions are exceeded.  We should at least mention the limit here.", "author": "bitwiseman", "createdAt": "2020-03-28T00:40:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNzA5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxOTA3OQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r400419079", "bodyText": "As elsewhere, I think it is pointless to even mention these sorts of limitations in Javadoc here, as the limits could be changed at any time and the code in this repository would become stale and misleading. (For example, some fields accept quite arbitrary-seeming lengths such as 20 characters.) It is the caller\u2019s responsibility to follow GitHub\u2019s current limits, and deal with whatever errors result if those are exceeded.", "author": "jglick", "createdAt": "2020-03-30T18:53:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNzA5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxOTczOA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r400419738", "bodyText": "(The exception being the 50 annotation limit, since that has a documented and tested solution\u2014adding annotations in batches of 50 or less\u2014which can be implemented in the library.)", "author": "jglick", "createdAt": "2020-03-30T18:54:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMzNzA5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM0NTgyNA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399345824", "bodyText": "Since this is an inner class could this be shortened to Output?", "author": "bitwiseman", "createdAt": "2020-03-27T15:25:11Z", "path": "src/main/java/org/kohsuke/github/GHCheckRunBuilder.java", "diffHunk": "@@ -0,0 +1,358 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import edu.umd.cs.findbugs.annotations.CheckForNull;\n+import edu.umd.cs.findbugs.annotations.NonNull;\n+import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.Date;\n+import java.util.LinkedList;\n+import java.util.List;\n+import java.util.Locale;\n+\n+/**\n+ * Drafts a check run.\n+ *\n+ * @see GHCheckRun\n+ * @see GHRepository#createCheckRun\n+ * @see <a href=\"https://developer.github.com/v3/checks/runs/\">documentation</a>\n+ */\n+@SuppressFBWarnings(value = \"URF_UNREAD_FIELD\", justification = \"Jackson serializes these even without a getter\")\n+@Preview\n+@Deprecated\n+public final class GHCheckRunBuilder {\n+\n+    private final GHRepository repo;\n+    private final Requester requester;\n+    DraftOutput output;\n+    List<DraftAction> actions;\n+\n+    GHCheckRunBuilder(GHRepository repo, String name, String headSHA) {\n+        this.repo = repo;\n+        requester = repo.root.createRequest()\n+                .withPreview(Previews.ANTIOPE)\n+                .method(\"POST\")\n+                .with(\"name\", name)\n+                .with(\"head_sha\", headSHA)\n+                .withUrlPath(repo.getApiTailUrl(\"check-runs\"));\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withDetailsURL(@CheckForNull String detailsURL) {\n+        requester.with(\"details_url\", detailsURL);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withExternalID(@CheckForNull String externalID) {\n+        requester.with(\"external_id\", externalID);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStatus(@CheckForNull GHCheckRun.Status status) {\n+        if (status != null) {\n+            // Do *not* use the overload taking Enum, as that s/_/-/g which would be wrong here.\n+            requester.with(\"status\", status.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withConclusion(@CheckForNull GHCheckRun.Conclusion conclusion) {\n+        if (conclusion != null) {\n+            requester.with(\"conclusion\", conclusion.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStartedAt(@CheckForNull Date startedAt) {\n+        if (startedAt != null) {\n+            requester.with(\"started_at\", GitHubClient.printDate(startedAt));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withCompletedAt(@CheckForNull Date completedAt) {\n+        if (completedAt != null) {\n+            requester.with(\"completed_at\", GitHubClient.printDate(completedAt));\n+        }\n+        return this;\n+    }\n+\n+    /**\n+     * Drafts the output section.\n+     *\n+     * @param title\n+     *            as in GitHub documentation\n+     * @param summary\n+     *            as in GitHub documentation\n+     * @return use {@link DraftOutput#done} to continue\n+     */\n+    public @NonNull DraftOutput withOutput(@NonNull String title, @NonNull String summary) {", "originalCommit": "8b51a44b7c7536b5cbb7f24de32a6519126224ad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NDAxNg==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399374016", "bodyText": "Check OutputSummary as well.", "author": "bitwiseman", "createdAt": "2020-03-27T16:05:33Z", "path": "src/test/java/org/kohsuke/github/GHCheckRunBuilderTest.java", "diffHunk": "@@ -0,0 +1,88 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import org.junit.Test;\n+\n+import java.util.Date;\n+\n+@SuppressWarnings(\"deprecation\") // preview\n+public class GHCheckRunBuilderTest extends AbstractGitHubWireMockTest {\n+\n+    @Test\n+    public void createCheckRun() throws Exception {\n+        GHCheckRun checkRun = gitHub.getRepository(\"jglick/github-api-test\")\n+                .createCheckRun(\"foo\", \"4a929d464a2fae7ee899ce603250f7dab304bc4b\")\n+                .withStatus(GHCheckRun.Status.COMPLETED)\n+                .withConclusion(GHCheckRun.Conclusion.SUCCESS)\n+                .withDetailsURL(\"http://nowhere.net/stuff\")\n+                .withExternalID(\"whatever\")\n+                .withStartedAt(new Date(999_999_000))\n+                .withCompletedAt(new Date(999_999_999))\n+                .withOutput(\"Some Title\", \"what happened\u2026\")\n+                .withAnnotation(\"stuff.txt\", 1, GHCheckRun.AnnotationLevel.NOTICE, \"hello to you too\")\n+                .withTitle(\"Look here\")\n+                .done()\n+                .withImage(\"Unikitty\", \"https://i.pinimg.com/474x/9e/65/c0/9e65c0972294f1e10f648c9780a79fab.jpg\")\n+                .withCaption(\"Princess Unikitty\")\n+                .done()\n+                .done()\n+                .withAction(\"Help\", \"what I need help with\", \"doit\")\n+                .create();\n+        assertEquals(\"completed\", checkRun.getStatus());\n+        assertEquals(1, checkRun.getOutput().getAnnotationsCount());\n+        assertEquals(535049329, checkRun.id);\n+    }\n+\n+    @Test\n+    public void createCheckRunManyAnnotations() throws Exception {\n+        GHCheckRunBuilder.DraftOutput output = gitHub.getRepository(\"jglick/github-api-test\")\n+                .createCheckRun(\"big\", \"4a929d464a2fae7ee899ce603250f7dab304bc4b\")\n+                .withConclusion(GHCheckRun.Conclusion.SUCCESS)\n+                .withOutput(\"Big Run\", \"Lots of stuff here \u00bb\");\n+        for (int i = 0; i < 101; i++) {\n+            output.withAnnotation(\"stuff.txt\", 1, GHCheckRun.AnnotationLevel.NOTICE, \"hello #\" + i).done();\n+        }\n+        GHCheckRun checkRun = output.done().create();\n+        assertEquals(\"completed\", checkRun.getStatus());\n+        assertEquals(\"Big Run\", checkRun.getOutput().getTitle());", "originalCommit": "8b51a44b7c7536b5cbb7f24de32a6519126224ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ1MzA5Ng==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399453096", "bodyText": "Not intending to verify every single field here, only the parts that involve subtle logic.", "author": "jglick", "createdAt": "2020-03-27T18:11:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NDAxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ4MzI2OQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399483269", "bodyText": "It looks like there is a special character in the OutputSummary.  I'd like to see that it works. I'd also be fine you made the summary simple text.", "author": "bitwiseman", "createdAt": "2020-03-27T19:08:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NDAxNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NDY1OQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399374659", "bodyText": "Conclusion is optional when competedAt is not set.  need test for that.", "author": "bitwiseman", "createdAt": "2020-03-27T16:06:35Z", "path": "src/test/java/org/kohsuke/github/GHCheckRunBuilderTest.java", "diffHunk": "@@ -0,0 +1,88 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import org.junit.Test;\n+\n+import java.util.Date;\n+\n+@SuppressWarnings(\"deprecation\") // preview\n+public class GHCheckRunBuilderTest extends AbstractGitHubWireMockTest {\n+\n+    @Test\n+    public void createCheckRun() throws Exception {\n+        GHCheckRun checkRun = gitHub.getRepository(\"jglick/github-api-test\")\n+                .createCheckRun(\"foo\", \"4a929d464a2fae7ee899ce603250f7dab304bc4b\")\n+                .withStatus(GHCheckRun.Status.COMPLETED)\n+                .withConclusion(GHCheckRun.Conclusion.SUCCESS)\n+                .withDetailsURL(\"http://nowhere.net/stuff\")\n+                .withExternalID(\"whatever\")\n+                .withStartedAt(new Date(999_999_000))\n+                .withCompletedAt(new Date(999_999_999))\n+                .withOutput(\"Some Title\", \"what happened\u2026\")\n+                .withAnnotation(\"stuff.txt\", 1, GHCheckRun.AnnotationLevel.NOTICE, \"hello to you too\")\n+                .withTitle(\"Look here\")\n+                .done()\n+                .withImage(\"Unikitty\", \"https://i.pinimg.com/474x/9e/65/c0/9e65c0972294f1e10f648c9780a79fab.jpg\")\n+                .withCaption(\"Princess Unikitty\")\n+                .done()\n+                .done()\n+                .withAction(\"Help\", \"what I need help with\", \"doit\")\n+                .create();\n+        assertEquals(\"completed\", checkRun.getStatus());\n+        assertEquals(1, checkRun.getOutput().getAnnotationsCount());\n+        assertEquals(535049329, checkRun.id);\n+    }\n+\n+    @Test\n+    public void createCheckRunManyAnnotations() throws Exception {\n+        GHCheckRunBuilder.DraftOutput output = gitHub.getRepository(\"jglick/github-api-test\")\n+                .createCheckRun(\"big\", \"4a929d464a2fae7ee899ce603250f7dab304bc4b\")\n+                .withConclusion(GHCheckRun.Conclusion.SUCCESS)\n+                .withOutput(\"Big Run\", \"Lots of stuff here \u00bb\");\n+        for (int i = 0; i < 101; i++) {\n+            output.withAnnotation(\"stuff.txt\", 1, GHCheckRun.AnnotationLevel.NOTICE, \"hello #\" + i).done();\n+        }\n+        GHCheckRun checkRun = output.done().create();\n+        assertEquals(\"completed\", checkRun.getStatus());\n+        assertEquals(\"Big Run\", checkRun.getOutput().getTitle());\n+        assertEquals(101, checkRun.getOutput().getAnnotationsCount());\n+        assertEquals(537614832, checkRun.id);\n+    }\n+\n+    @Test\n+    public void createCheckRunNoAnnotations() throws Exception {\n+        GHCheckRun checkRun = gitHub.getRepository(\"jglick/github-api-test\")\n+                .createCheckRun(\"quick\", \"4a929d464a2fae7ee899ce603250f7dab304bc4b\")\n+                .withConclusion(GHCheckRun.Conclusion.NEUTRAL)", "originalCommit": "8b51a44b7c7536b5cbb7f24de32a6519126224ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ1Mzk4NA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399453984", "bodyText": "You mean when status is not completed? Again, these are just aspects of the GitHub semantics which are uninteresting to test here since they are not exercising novel and subtle code idioms.", "author": "jglick", "createdAt": "2020-03-27T18:13:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NDY1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ4OTUzOQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399489539", "bodyText": "@jglick\nI'm looking at https://developer.github.com/v3/checks/runs/#parameters\n\nRequired if you provide completed_at or a status of completed.\n\nMay not be super interesting but we should verify this not providing conclusion works.  If you remove this line from this test, we get that.\nFrankly, we should also have a test verifying the error returned when conclusion is not set but status is completed.  The test framework makes adding tests pretty quick.", "author": "bitwiseman", "createdAt": "2020-03-27T19:20:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NDY1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI1MjU4Mw==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r400252583", "bodyText": "we should verify this not providing conclusion works\n\nSure.\n\nIf you remove this line from this test\n\nYeah, so long as the code coverage report does not then start complaining that there is insufficient coverage percentage for some nested class, as it was yelling at me before\u2026\n\nwe should also have a test verifying the error returned when\u2026\n\nCan do that. As a general observation, GitHub does not document error codes. Even when I have raised support requests and specifically complained that documentation neglects to specify the error code for some corner case, they have rejected the request saying that their general guidelines mention error responses (when in fact those guidelines are so vague that they could easily be interpreted in several ways).", "author": "jglick", "createdAt": "2020-03-30T14:49:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NDY1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NjEyNw==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399376127", "bodyText": "Image only has one optional field maybe it doesn't need a builder?\nAre images not readable via api? I didn't see them...", "author": "bitwiseman", "createdAt": "2020-03-27T16:08:46Z", "path": "src/test/java/org/kohsuke/github/GHCheckRunBuilderTest.java", "diffHunk": "@@ -0,0 +1,88 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import org.junit.Test;\n+\n+import java.util.Date;\n+\n+@SuppressWarnings(\"deprecation\") // preview\n+public class GHCheckRunBuilderTest extends AbstractGitHubWireMockTest {\n+\n+    @Test\n+    public void createCheckRun() throws Exception {\n+        GHCheckRun checkRun = gitHub.getRepository(\"jglick/github-api-test\")\n+                .createCheckRun(\"foo\", \"4a929d464a2fae7ee899ce603250f7dab304bc4b\")\n+                .withStatus(GHCheckRun.Status.COMPLETED)\n+                .withConclusion(GHCheckRun.Conclusion.SUCCESS)\n+                .withDetailsURL(\"http://nowhere.net/stuff\")\n+                .withExternalID(\"whatever\")\n+                .withStartedAt(new Date(999_999_000))\n+                .withCompletedAt(new Date(999_999_999))\n+                .withOutput(\"Some Title\", \"what happened\u2026\")\n+                .withAnnotation(\"stuff.txt\", 1, GHCheckRun.AnnotationLevel.NOTICE, \"hello to you too\")\n+                .withTitle(\"Look here\")\n+                .done()\n+                .withImage(\"Unikitty\", \"https://i.pinimg.com/474x/9e/65/c0/9e65c0972294f1e10f648c9780a79fab.jpg\")", "originalCommit": "8b51a44b7c7536b5cbb7f24de32a6519126224ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4Mjk1NA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399382954", "bodyText": "Also same comment as for withAnnotation() method signature.", "author": "bitwiseman", "createdAt": "2020-03-27T16:19:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NjEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ1MjI4NQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399452285", "bodyText": "Image only has one optional field maybe it doesn't need a builder?\n\nPreferred to be consistent.\n\nAre images not readable via api?\n\nNot sure offhand. For purposes of this PR I am focussing on creating check runs, not loading them.", "author": "jglick", "createdAt": "2020-03-27T18:10:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM3NjEyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4MjE5Nw==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399382197", "bodyText": "maybe .addAnnotation(...) or even addAnnotations(DraftAnnotation... annotations).  Then you wouldn't need to be calling done() after each one.", "author": "bitwiseman", "createdAt": "2020-03-27T16:17:57Z", "path": "src/test/java/org/kohsuke/github/GHCheckRunBuilderTest.java", "diffHunk": "@@ -0,0 +1,88 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import org.junit.Test;\n+\n+import java.util.Date;\n+\n+@SuppressWarnings(\"deprecation\") // preview\n+public class GHCheckRunBuilderTest extends AbstractGitHubWireMockTest {\n+\n+    @Test\n+    public void createCheckRun() throws Exception {\n+        GHCheckRun checkRun = gitHub.getRepository(\"jglick/github-api-test\")\n+                .createCheckRun(\"foo\", \"4a929d464a2fae7ee899ce603250f7dab304bc4b\")\n+                .withStatus(GHCheckRun.Status.COMPLETED)\n+                .withConclusion(GHCheckRun.Conclusion.SUCCESS)\n+                .withDetailsURL(\"http://nowhere.net/stuff\")\n+                .withExternalID(\"whatever\")\n+                .withStartedAt(new Date(999_999_000))\n+                .withCompletedAt(new Date(999_999_999))\n+                .withOutput(\"Some Title\", \"what happened\u2026\")\n+                .withAnnotation(\"stuff.txt\", 1, GHCheckRun.AnnotationLevel.NOTICE, \"hello to you too\")", "originalCommit": "8b51a44b7c7536b5cbb7f24de32a6519126224ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ1MTc2OA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399451768", "bodyText": ".addAnnotation(\u2026) as an alias for .done().withAnnotation(\u2026) is possible, but does not improve clarity to my mind. addAnnotations makes it harder to customize each one, and anyway the typical caller is going to be creating these one by one in a loop, not hard-coded.", "author": "jglick", "createdAt": "2020-03-27T18:09:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4MjE5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ5NzIwMQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399497201", "bodyText": "Okay, so:\n.add(new Annotation(\"stuff.txt\", 1, GHCheckRun.AnnotationLevel.NOTICE, \"hello to you too\")\n    .withTitle(\"Look here\"))\n.add(new Annotation(\"stuff.txt\", 3, GHCheckRun.AnnotationLevel.NOTICE, \"bye\")\n    .withTitle(\"Look there\"))\n.add(new Image(\"Unikitty\", \"https://i.pinimg.com/474x/9e/65/c0/9e65c0972294f1e10f648c9780a79fab.jpg\")\n    .withCaption(\"Princess Unikitty\"))\n\nOr something like it.", "author": "bitwiseman", "createdAt": "2020-03-27T19:35:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4MjE5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI0Nzc2Mw==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r400247763", "bodyText": "Perhaps. Not quite as friendly to code completion. Can look into it.", "author": "jglick", "createdAt": "2020-03-30T14:43:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTM4MjE5Nw=="}], "type": "inlineReview"}, {"oid": "30d792d6e1f44bb800ec5bd3d29a1b74a0468367", "url": "https://github.com/hub4j/github-api/commit/30d792d6e1f44bb800ec5bd3d29a1b74a0468367", "message": "Remove \u2018Draft\u2019 from nested data class names", "committedDate": "2020-03-27T18:04:42Z", "type": "commit"}, {"oid": "89a6664e4507aef8a6f9605baec10ae9e464442f", "url": "https://github.com/hub4j/github-api/commit/89a6664e4507aef8a6f9605baec10ae9e464442f", "message": "More links to GH docs from Javadoc", "committedDate": "2020-03-27T18:07:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU5NTE4NQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399595185", "bodyText": "What happens when the max size of this is exceeded?  Not mentioning that limit here will cause more pain for consumers of this library.", "author": "bitwiseman", "createdAt": "2020-03-28T00:39:58Z", "path": "src/main/java/org/kohsuke/github/GHCheckRunBuilder.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import edu.umd.cs.findbugs.annotations.CheckForNull;\n+import edu.umd.cs.findbugs.annotations.NonNull;\n+import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.Date;\n+import java.util.LinkedList;\n+import java.util.List;\n+import java.util.Locale;\n+\n+/**\n+ * Drafts a check run.\n+ *\n+ * @see GHCheckRun\n+ * @see GHRepository#createCheckRun\n+ * @see <a href=\"https://developer.github.com/v3/checks/runs/#create-a-check-run\">documentation</a>\n+ */\n+@SuppressFBWarnings(value = \"URF_UNREAD_FIELD\", justification = \"Jackson serializes these even without a getter\")\n+@Preview\n+@Deprecated\n+public final class GHCheckRunBuilder {\n+\n+    private final GHRepository repo;\n+    private final Requester requester;\n+    Output output;\n+    List<Action> actions;\n+\n+    GHCheckRunBuilder(GHRepository repo, String name, String headSHA) {\n+        this.repo = repo;\n+        requester = repo.root.createRequest()\n+                .withPreview(Previews.ANTIOPE)\n+                .method(\"POST\")\n+                .with(\"name\", name)\n+                .with(\"head_sha\", headSHA)\n+                .withUrlPath(repo.getApiTailUrl(\"check-runs\"));\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withDetailsURL(@CheckForNull String detailsURL) {\n+        requester.with(\"details_url\", detailsURL);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withExternalID(@CheckForNull String externalID) {\n+        requester.with(\"external_id\", externalID);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStatus(@CheckForNull GHCheckRun.Status status) {\n+        if (status != null) {\n+            // Do *not* use the overload taking Enum, as that s/_/-/g which would be wrong here.\n+            requester.with(\"status\", status.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withConclusion(@CheckForNull GHCheckRun.Conclusion conclusion) {\n+        if (conclusion != null) {\n+            requester.with(\"conclusion\", conclusion.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStartedAt(@CheckForNull Date startedAt) {\n+        if (startedAt != null) {\n+            requester.with(\"started_at\", GitHubClient.printDate(startedAt));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withCompletedAt(@CheckForNull Date completedAt) {\n+        if (completedAt != null) {\n+            requester.with(\"completed_at\", GitHubClient.printDate(completedAt));\n+        }\n+        return this;\n+    }\n+\n+    /**\n+     * Drafts the output section.\n+     *\n+     * @param title\n+     *            as in GitHub documentation\n+     * @param summary\n+     *            as in GitHub documentation\n+     * @return use {@link Output#done} to continue\n+     */\n+    public @NonNull Output withOutput(@NonNull String title, @NonNull String summary) {\n+        return new Output(this, title, summary);\n+    }\n+\n+    /**\n+     * Drafts an action section.\n+     *\n+     * @param label\n+     *            as in GitHub documentation", "originalCommit": "89a6664e4507aef8a6f9605baec10ae9e464442f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI0NTQ0MQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r400245441", "bodyText": "I would rather not duplicate backend logic here. It is up to callers to read the GitHub documentation and supply appropriate parameters accordingly. The limits may change over time, remember, and since Checks is still in preview there could be new restrictions later. The library should limit itself to collecting data and shipping it off.", "author": "jglick", "createdAt": "2020-03-30T14:40:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU5NTE4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU5NTc5OA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399595798", "bodyText": "Does this need to be public?  It is never needed by users.", "author": "bitwiseman", "createdAt": "2020-03-28T00:43:45Z", "path": "src/main/java/org/kohsuke/github/GHCheckRunBuilder.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import edu.umd.cs.findbugs.annotations.CheckForNull;\n+import edu.umd.cs.findbugs.annotations.NonNull;\n+import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.Date;\n+import java.util.LinkedList;\n+import java.util.List;\n+import java.util.Locale;\n+\n+/**\n+ * Drafts a check run.\n+ *\n+ * @see GHCheckRun\n+ * @see GHRepository#createCheckRun\n+ * @see <a href=\"https://developer.github.com/v3/checks/runs/#create-a-check-run\">documentation</a>\n+ */\n+@SuppressFBWarnings(value = \"URF_UNREAD_FIELD\", justification = \"Jackson serializes these even without a getter\")\n+@Preview\n+@Deprecated\n+public final class GHCheckRunBuilder {\n+\n+    private final GHRepository repo;\n+    private final Requester requester;\n+    Output output;\n+    List<Action> actions;\n+\n+    GHCheckRunBuilder(GHRepository repo, String name, String headSHA) {\n+        this.repo = repo;\n+        requester = repo.root.createRequest()\n+                .withPreview(Previews.ANTIOPE)\n+                .method(\"POST\")\n+                .with(\"name\", name)\n+                .with(\"head_sha\", headSHA)\n+                .withUrlPath(repo.getApiTailUrl(\"check-runs\"));\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withDetailsURL(@CheckForNull String detailsURL) {\n+        requester.with(\"details_url\", detailsURL);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withExternalID(@CheckForNull String externalID) {\n+        requester.with(\"external_id\", externalID);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStatus(@CheckForNull GHCheckRun.Status status) {\n+        if (status != null) {\n+            // Do *not* use the overload taking Enum, as that s/_/-/g which would be wrong here.\n+            requester.with(\"status\", status.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withConclusion(@CheckForNull GHCheckRun.Conclusion conclusion) {\n+        if (conclusion != null) {\n+            requester.with(\"conclusion\", conclusion.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStartedAt(@CheckForNull Date startedAt) {\n+        if (startedAt != null) {\n+            requester.with(\"started_at\", GitHubClient.printDate(startedAt));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withCompletedAt(@CheckForNull Date completedAt) {\n+        if (completedAt != null) {\n+            requester.with(\"completed_at\", GitHubClient.printDate(completedAt));\n+        }\n+        return this;\n+    }\n+\n+    /**\n+     * Drafts the output section.\n+     *\n+     * @param title\n+     *            as in GitHub documentation\n+     * @param summary\n+     *            as in GitHub documentation\n+     * @return use {@link Output#done} to continue\n+     */\n+    public @NonNull Output withOutput(@NonNull String title, @NonNull String summary) {\n+        return new Output(this, title, summary);\n+    }\n+\n+    /**\n+     * Drafts an action section.\n+     *\n+     * @param label\n+     *            as in GitHub documentation\n+     * @param description\n+     *            as in GitHub documentation\n+     * @param identifier\n+     *            as in GitHub documentation\n+     * @return use {@link Output#done} to continue\n+     */\n+    public @NonNull GHCheckRunBuilder withAction(@NonNull String label,\n+            @NonNull String description,\n+            @NonNull String identifier) {\n+        if (actions == null) {\n+            actions = new LinkedList<>();\n+        }\n+        actions.add(new Action(label, description, identifier));\n+        return this;\n+    }\n+\n+    private static final int MAX_ANNOTATIONS = 50;\n+    /**\n+     * Actually creates the check run. (If more than fifty annotations were requested, this is done in batches.)\n+     *\n+     * @return the resulting run\n+     * @throws IOException\n+     *             for the usual reasons\n+     */\n+    public @NonNull GHCheckRun create() throws IOException {\n+        List<Annotation> extraAnnotations;\n+        if (output != null && output.annotations != null && output.annotations.size() > MAX_ANNOTATIONS) {\n+            extraAnnotations = output.annotations.subList(MAX_ANNOTATIONS, output.annotations.size());\n+            output.annotations = output.annotations.subList(0, MAX_ANNOTATIONS);\n+        } else {\n+            extraAnnotations = Collections.emptyList();\n+        }\n+        GHCheckRun run = requester.with(\"output\", output).with(\"actions\", actions).fetch(GHCheckRun.class).wrap(repo);\n+        while (!extraAnnotations.isEmpty()) {\n+            Output output2 = new Output(null, output.title, output.summary);\n+            int i = Math.min(extraAnnotations.size(), MAX_ANNOTATIONS);\n+            output2.annotations = extraAnnotations.subList(0, i);\n+            extraAnnotations = extraAnnotations.subList(i, extraAnnotations.size());\n+            run = repo.root.createRequest()\n+                    .withPreview(Previews.ANTIOPE)\n+                    .method(\"PATCH\")\n+                    .with(\"output\", output2)\n+                    .withUrlPath(repo.getApiTailUrl(\"check-runs/\" + run.id))\n+                    .fetch(GHCheckRun.class)\n+                    .wrap(repo);\n+        }\n+        return run;\n+    }\n+\n+    /**\n+     * @see <a href=\"https://developer.github.com/v3/checks/runs/#output-object\">documentation</a>\n+     */\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public static final class Output {\n+\n+        private final transient GHCheckRunBuilder builder;\n+        private final String title;\n+        private final String summary;\n+        private String text;\n+        List<Annotation> annotations;\n+        List<Image> images;\n+\n+        Output(GHCheckRunBuilder builder, String title, String summary) {\n+            this.builder = builder;\n+            this.title = title;\n+            this.summary = summary;\n+        }\n+\n+        public @NonNull Output withText(@CheckForNull String text) {\n+            this.text = text;\n+            return this;\n+        }\n+\n+        /**\n+         * Drafts a single-line annotation section.\n+         *\n+         * @param path\n+         *            as in GitHub documentation\n+         * @param line\n+         *            {@code startLine} and {@code endLine} together\n+         * @param annotationLevel\n+         *            as in GitHub documentation\n+         * @param message\n+         *            as in GitHub documentation\n+         * @return use {@link Annotation#done} to continue\n+         */\n+        public @NonNull Annotation withAnnotation(@NonNull String path,\n+                int line,\n+                @NonNull GHCheckRun.AnnotationLevel annotationLevel,\n+                @NonNull String message) {\n+            return withAnnotation(path, line, line, annotationLevel, message);\n+        }\n+\n+        /**\n+         * Drafts a potentially multiline annotation section.\n+         *\n+         * @param path\n+         *            as in GitHub documentation\n+         * @param startLine\n+         *            as in GitHub documentation\n+         * @param endLine\n+         *            as in GitHub documentation\n+         * @param annotationLevel\n+         *            as in GitHub documentation\n+         * @param message\n+         *            as in GitHub documentation\n+         * @return use {@link Annotation#done} to continue\n+         */\n+        public @NonNull Annotation withAnnotation(@NonNull String path,\n+                int startLine,\n+                int endLine,\n+                @NonNull GHCheckRun.AnnotationLevel annotationLevel,\n+                @NonNull String message) {\n+            return new Annotation(this, path, startLine, endLine, annotationLevel, message);\n+        }\n+\n+        /**\n+         * Drafts an image section.\n+         *\n+         * @param alt\n+         *            as in GitHub documentation\n+         * @param imageURL\n+         *            as in GitHub documentation\n+         * @return use {@link Image#done} to continue\n+         */\n+        public @NonNull Image withImage(@NonNull String alt, @NonNull String imageURL) {\n+            return new Image(this, alt, imageURL);\n+        }\n+\n+        public @NonNull GHCheckRunBuilder done() {\n+            builder.output = this;\n+            return builder;\n+        }\n+\n+    }\n+\n+    /**\n+     * @see <a href=\"https://developer.github.com/v3/checks/runs/#annotations-object\">documentation</a>\n+     */\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public static final class Annotation {\n+\n+        private final transient Output output;\n+        private final String path;\n+        private final int start_line;\n+        private final int end_line;\n+        private final String annotation_level;\n+        private final String message;\n+        private Integer start_column;\n+        private Integer end_column;\n+        private String title;\n+        private String raw_details;\n+\n+        Annotation(Output output,\n+                String path,\n+                int start_line,\n+                int end_line,\n+                GHCheckRun.AnnotationLevel annotation_level,\n+                String message) {\n+            this.output = output;\n+            this.path = path;\n+            this.start_line = start_line;\n+            this.end_line = end_line;\n+            this.annotation_level = annotation_level.toString().toLowerCase(Locale.ROOT);\n+            this.message = message;\n+        }\n+\n+        public @NonNull Annotation withStartColumn(@CheckForNull Integer startColumn) {\n+            start_column = startColumn;\n+            return this;\n+        }\n+\n+        public @NonNull Annotation withEndColumn(@CheckForNull Integer endColumn) {\n+            end_column = endColumn;\n+            return this;\n+        }\n+\n+        public @NonNull Annotation withTitle(@CheckForNull String title) {\n+            this.title = title;\n+            return this;\n+        }\n+\n+        public @NonNull Annotation withRawDetails(@CheckForNull String rawDetails) {\n+            raw_details = rawDetails;\n+            return this;\n+        }\n+\n+        public @NonNull Output done() {\n+            if (output.annotations == null) {\n+                output.annotations = new LinkedList<>();\n+            }\n+            output.annotations.add(this);\n+            return output;\n+        }\n+\n+    }\n+\n+    /**\n+     * @see <a href=\"https://developer.github.com/v3/checks/runs/#images-object\">documentation</a>\n+     */\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public static final class Image {\n+\n+        private final transient Output output;\n+        private final String alt;\n+        private final String image_url;\n+        private String caption;\n+\n+        Image(Output output, String alt, String image_url) {\n+            this.output = output;\n+            this.alt = alt;\n+            this.image_url = image_url;\n+        }\n+\n+        public @NonNull Image withCaption(@CheckForNull String caption) {\n+            this.caption = caption;\n+            return this;\n+        }\n+\n+        public @NonNull Output done() {\n+            if (output.images == null) {\n+                output.images = new LinkedList<>();\n+            }\n+            output.images.add(this);\n+            return output;\n+        }\n+\n+    }\n+\n+    /**\n+     * @see <a href=\"https://developer.github.com/v3/checks/runs/#actions-object\">documentation</a>\n+     */\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public static final class Action {", "originalCommit": "89a6664e4507aef8a6f9605baec10ae9e464442f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI0NjkyNA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r400246924", "bodyText": "I was leaving it public in case the Jackson databinding required it to be, but can check if tests still pass if it is made less accessible.", "author": "jglick", "createdAt": "2020-03-30T14:42:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU5NTc5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY5MTMzMA==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r399691330", "bodyText": "Max limit for annotations ?", "author": "sladyn98", "createdAt": "2020-03-28T18:03:13Z", "path": "src/main/java/org/kohsuke/github/GHCheckRunBuilder.java", "diffHunk": "@@ -0,0 +1,370 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2020 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package org.kohsuke.github;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import edu.umd.cs.findbugs.annotations.CheckForNull;\n+import edu.umd.cs.findbugs.annotations.NonNull;\n+import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.Date;\n+import java.util.LinkedList;\n+import java.util.List;\n+import java.util.Locale;\n+\n+/**\n+ * Drafts a check run.\n+ *\n+ * @see GHCheckRun\n+ * @see GHRepository#createCheckRun\n+ * @see <a href=\"https://developer.github.com/v3/checks/runs/#create-a-check-run\">documentation</a>\n+ */\n+@SuppressFBWarnings(value = \"URF_UNREAD_FIELD\", justification = \"Jackson serializes these even without a getter\")\n+@Preview\n+@Deprecated\n+public final class GHCheckRunBuilder {\n+\n+    private final GHRepository repo;\n+    private final Requester requester;\n+    Output output;\n+    List<Action> actions;\n+\n+    GHCheckRunBuilder(GHRepository repo, String name, String headSHA) {\n+        this.repo = repo;\n+        requester = repo.root.createRequest()\n+                .withPreview(Previews.ANTIOPE)\n+                .method(\"POST\")\n+                .with(\"name\", name)\n+                .with(\"head_sha\", headSHA)\n+                .withUrlPath(repo.getApiTailUrl(\"check-runs\"));\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withDetailsURL(@CheckForNull String detailsURL) {\n+        requester.with(\"details_url\", detailsURL);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withExternalID(@CheckForNull String externalID) {\n+        requester.with(\"external_id\", externalID);\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStatus(@CheckForNull GHCheckRun.Status status) {\n+        if (status != null) {\n+            // Do *not* use the overload taking Enum, as that s/_/-/g which would be wrong here.\n+            requester.with(\"status\", status.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withConclusion(@CheckForNull GHCheckRun.Conclusion conclusion) {\n+        if (conclusion != null) {\n+            requester.with(\"conclusion\", conclusion.toString().toLowerCase(Locale.ROOT));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withStartedAt(@CheckForNull Date startedAt) {\n+        if (startedAt != null) {\n+            requester.with(\"started_at\", GitHubClient.printDate(startedAt));\n+        }\n+        return this;\n+    }\n+\n+    public @NonNull GHCheckRunBuilder withCompletedAt(@CheckForNull Date completedAt) {\n+        if (completedAt != null) {\n+            requester.with(\"completed_at\", GitHubClient.printDate(completedAt));\n+        }\n+        return this;\n+    }\n+\n+    /**\n+     * Drafts the output section.\n+     *\n+     * @param title\n+     *            as in GitHub documentation\n+     * @param summary\n+     *            as in GitHub documentation\n+     * @return use {@link Output#done} to continue\n+     */\n+    public @NonNull Output withOutput(@NonNull String title, @NonNull String summary) {\n+        return new Output(this, title, summary);\n+    }\n+\n+    /**\n+     * Drafts an action section.\n+     *\n+     * @param label\n+     *            as in GitHub documentation\n+     * @param description\n+     *            as in GitHub documentation\n+     * @param identifier\n+     *            as in GitHub documentation\n+     * @return use {@link Output#done} to continue\n+     */\n+    public @NonNull GHCheckRunBuilder withAction(@NonNull String label,\n+            @NonNull String description,\n+            @NonNull String identifier) {\n+        if (actions == null) {\n+            actions = new LinkedList<>();\n+        }\n+        actions.add(new Action(label, description, identifier));\n+        return this;\n+    }\n+\n+    private static final int MAX_ANNOTATIONS = 50;\n+    /**\n+     * Actually creates the check run. (If more than fifty annotations were requested, this is done in batches.)\n+     *\n+     * @return the resulting run\n+     * @throws IOException\n+     *             for the usual reasons\n+     */\n+    public @NonNull GHCheckRun create() throws IOException {\n+        List<Annotation> extraAnnotations;\n+        if (output != null && output.annotations != null && output.annotations.size() > MAX_ANNOTATIONS) {\n+            extraAnnotations = output.annotations.subList(MAX_ANNOTATIONS, output.annotations.size());\n+            output.annotations = output.annotations.subList(0, MAX_ANNOTATIONS);\n+        } else {\n+            extraAnnotations = Collections.emptyList();\n+        }\n+        GHCheckRun run = requester.with(\"output\", output).with(\"actions\", actions).fetch(GHCheckRun.class).wrap(repo);\n+        while (!extraAnnotations.isEmpty()) {\n+            Output output2 = new Output(null, output.title, output.summary);\n+            int i = Math.min(extraAnnotations.size(), MAX_ANNOTATIONS);\n+            output2.annotations = extraAnnotations.subList(0, i);\n+            extraAnnotations = extraAnnotations.subList(i, extraAnnotations.size());\n+            run = repo.root.createRequest()\n+                    .withPreview(Previews.ANTIOPE)\n+                    .method(\"PATCH\")\n+                    .with(\"output\", output2)\n+                    .withUrlPath(repo.getApiTailUrl(\"check-runs/\" + run.id))\n+                    .fetch(GHCheckRun.class)\n+                    .wrap(repo);\n+        }\n+        return run;\n+    }\n+\n+    /**\n+     * @see <a href=\"https://developer.github.com/v3/checks/runs/#output-object\">documentation</a>\n+     */\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public static final class Output {\n+\n+        private final transient GHCheckRunBuilder builder;\n+        private final String title;\n+        private final String summary;\n+        private String text;\n+        List<Annotation> annotations;\n+        List<Image> images;\n+\n+        Output(GHCheckRunBuilder builder, String title, String summary) {\n+            this.builder = builder;\n+            this.title = title;\n+            this.summary = summary;\n+        }\n+\n+        public @NonNull Output withText(@CheckForNull String text) {\n+            this.text = text;\n+            return this;\n+        }\n+\n+        /**\n+         * Drafts a single-line annotation section.\n+         *\n+         * @param path\n+         *            as in GitHub documentation\n+         * @param line\n+         *            {@code startLine} and {@code endLine} together\n+         * @param annotationLevel\n+         *            as in GitHub documentation\n+         * @param message\n+         *            as in GitHub documentation\n+         * @return use {@link Annotation#done} to continue\n+         */\n+        public @NonNull Annotation withAnnotation(@NonNull String path,\n+                int line,\n+                @NonNull GHCheckRun.AnnotationLevel annotationLevel,\n+                @NonNull String message) {\n+            return withAnnotation(path, line, line, annotationLevel, message);", "originalCommit": "89a6664e4507aef8a6f9605baec10ae9e464442f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDI0NjMzNQ==", "url": "https://github.com/hub4j/github-api/pull/753#discussion_r400246335", "bodyText": "Nope, >50 is automatically handled, see above.", "author": "jglick", "createdAt": "2020-03-30T14:41:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY5MTMzMA=="}], "type": "inlineReview"}, {"oid": "883c8cc4c8baff718f47b48f1b9540d322f8e581", "url": "https://github.com/hub4j/github-api/commit/883c8cc4c8baff718f47b48f1b9540d322f8e581", "message": "Merge branch 'master' of github.com:github-api/github-api into createCheckRun", "committedDate": "2020-03-30T18:20:05Z", "type": "commit"}, {"oid": "6214b6a3ffb12367a642e05890d77475088cb044", "url": "https://github.com/hub4j/github-api/commit/6214b6a3ffb12367a642e05890d77475088cb044", "message": "Regenerated WireMock metadata", "committedDate": "2020-03-30T18:26:23Z", "type": "commit"}, {"oid": "7c9397f7f60f20e0bcac4898ea931438505a9260", "url": "https://github.com/hub4j/github-api/commit/7c9397f7f60f20e0bcac4898ea931438505a9260", "message": "Switched from fluent style with .done() to accessible constructors", "committedDate": "2020-03-30T18:46:56Z", "type": "commit"}, {"oid": "82b9c05d0f9e512986dddbad8eae2dda0fe0d3f2", "url": "https://github.com/hub4j/github-api/commit/82b9c05d0f9e512986dddbad8eae2dda0fe0d3f2", "message": "Strengthened test a bit", "committedDate": "2020-03-30T18:49:37Z", "type": "commit"}, {"oid": "58f1fe0671de8d6b46eb78b7ede3d3819b417348", "url": "https://github.com/hub4j/github-api/commit/58f1fe0671de8d6b46eb78b7ede3d3819b417348", "message": "createPendingCheckRun", "committedDate": "2020-03-30T18:58:58Z", "type": "commit"}, {"oid": "3ab9381d0a69ddf7afb06afd5218c66e9e037714", "url": "https://github.com/hub4j/github-api/commit/3ab9381d0a69ddf7afb06afd5218c66e9e037714", "message": "createCheckRunErrMissingConclusion", "committedDate": "2020-03-30T19:06:01Z", "type": "commit"}]}