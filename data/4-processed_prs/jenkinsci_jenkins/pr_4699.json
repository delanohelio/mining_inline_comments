{"pr_number": 4699, "pr_title": "Converting tests to junit5", "pr_createdAt": "2020-04-30T08:55:11Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4699", "timeline": [{"oid": "418ba081d3aac7013dca7268d3f930b64a5efa61", "url": "https://github.com/jenkinsci/jenkins/commit/418ba081d3aac7013dca7268d3f930b64a5efa61", "message": "started converting tests to junit5", "committedDate": "2020-04-30T08:52:40Z", "type": "commit"}, {"oid": "09787468d65e56376ab8badb41e60e660488b00f", "url": "https://github.com/jenkinsci/jenkins/commit/09787468d65e56376ab8badb41e60e660488b00f", "message": "replaced TempFolder with JUnit TempDir", "committedDate": "2020-04-30T10:43:57Z", "type": "commit"}, {"oid": "9f1f9ae7d1713bd4e82f541f08db8cc0fa6f8e31", "url": "https://github.com/jenkinsci/jenkins/commit/9f1f9ae7d1713bd4e82f541f08db8cc0fa6f8e31", "message": "migrated some test classes to JUnit5", "committedDate": "2020-04-30T10:44:48Z", "type": "commit"}, {"oid": "bc8f5a54634fc7f4bfa51950fccd85e7d57cb122", "url": "https://github.com/jenkinsci/jenkins/commit/bc8f5a54634fc7f4bfa51950fccd85e7d57cb122", "message": "migrated a parameterized testclass to junit5", "committedDate": "2020-05-04T16:38:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY1ODQ5Mw==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r419658493", "bodyText": "Any particular reason you've chosen 5.5.2 instead of the 5.6.2 release from April 2020?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <junit.jupiter.version>5.5.2</junit.jupiter.version>\n          \n          \n            \n                <junit.jupiter.version>5.6.2</junit.jupiter.version>", "author": "MarkEWaite", "createdAt": "2020-05-04T19:00:23Z", "path": "core/pom.xml", "diffHunk": "@@ -43,6 +43,7 @@ THE SOFTWARE.\n     <spring.version>2.5.6.SEC03</spring.version>\n     <groovy.version>2.4.12</groovy.version>\n     <hamcrest.version>2.2</hamcrest.version>\n+    <junit.jupiter.version>5.5.2</junit.jupiter.version>", "originalCommit": "bc8f5a54634fc7f4bfa51950fccd85e7d57cb122", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY2NTk3Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r419665972", "bodyText": "I just copied the version from the cli. I plan to move the version to the parent-pom or the bom.", "author": "StefanSpieker", "createdAt": "2020-05-04T19:13:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTY1ODQ5Mw=="}], "type": "inlineReview"}, {"oid": "a0da9bf37603b09d77da0397c922bd4673edb6c9", "url": "https://github.com/jenkinsci/jenkins/commit/a0da9bf37603b09d77da0397c922bd4673edb6c9", "message": "Update core/pom.xml\n\nCo-authored-by: Mark Waite <mark.earl.waite@gmail.com>", "committedDate": "2020-05-04T19:12:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDk5ODMxNg==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r424998316", "bodyText": "If we want to migrate our test base, we should remove this library all together.", "author": "alecharp", "createdAt": "2020-05-14T09:28:19Z", "path": "core/pom.xml", "diffHunk": "@@ -482,6 +483,24 @@ THE SOFTWARE.\n       <artifactId>junit</artifactId>\n       <scope>test</scope>\n     </dependency>", "originalCommit": "a0da9bf37603b09d77da0397c922bd4673edb6c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkyNDI3Mw==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r432924273", "bodyText": "Thanks for pointing that out, I removed junit4 and added the vintage engine", "author": "StefanSpieker", "createdAt": "2020-05-31T08:43:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDk5ODMxNg=="}], "type": "inlineReview"}, {"oid": "4ca7a6e83555175e23c70afab5d2129ee940c80f", "url": "https://github.com/jenkinsci/jenkins/commit/4ca7a6e83555175e23c70afab5d2129ee940c80f", "message": "merged master and fixed conflicts", "committedDate": "2020-05-31T08:29:29Z", "type": "commit"}, {"oid": "4866d8d90eb5e066da788d52428b67530ae18c0f", "url": "https://github.com/jenkinsci/jenkins/commit/4866d8d90eb5e066da788d52428b67530ae18c0f", "message": "replaced junit4 with junit5-vintage engine", "committedDate": "2020-05-31T08:42:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM4MTQ2OQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r437381469", "bodyText": "I take it you have not tried to convert the test module with JenkinsRule? That is where most test coverage lies, but I wonder if a migration is practical.\nTBH other than assertThrows (which could equally be a static utility method anywhere and used with JUnit 4) I have not seen a compelling advantage to using JUnit 5. It does not correct the main sin of JUnit 4, which is the abuse of annotations.", "author": "jglick", "createdAt": "2020-06-09T12:42:14Z", "path": "core/pom.xml", "diffHunk": "@@ -40,6 +40,7 @@ THE SOFTWARE.\n   <properties>\n     <staplerFork>true</staplerFork>\n     <hamcrest.version>2.2</hamcrest.version>\n+    <junit.jupiter.version>5.6.2</junit.jupiter.version>", "originalCommit": "4866d8d90eb5e066da788d52428b67530ae18c0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM4NTA1MQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r437385051", "bodyText": "assertThrows is in junit 4.13", "author": "timja", "createdAt": "2020-06-09T12:48:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM4MTQ2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgxOTMwNw==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r439819307", "bodyText": "Actually I took a look at the test module, but this might take a little longer, because the JenkinsRule has to be changed to an Extension. If this would be needed before this PR can be merged, I can spend there some time.\nBut to answer the question about JUnit5 in general: I think there are a few things which are easier with JUnit5 than JUnit4, but that is only my opinion. Some examples:\n\nTests enabled for a specified JRE range \ndynamic tests with @testfactory\n\nAnother nice blog I stumbled upon is this one: why you should migrate to junit-5", "author": "StefanSpieker", "createdAt": "2020-06-14T11:24:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM4MTQ2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDIxNTU3Ng==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r440215576", "bodyText": "If this would be needed before this PR can be merged\n\nNo, just wondering if that is part of the plan.\n@TestFactory does sound easier to work with than JUnit 4 parameterized tests.\nMy experience with tests in @jenkinsci is that it is tough to make various systems interoperate cleanly, due to the misguided attempt by test frameworks to make things look declarative using annotations and reflection. Thus there are problems mixing JenkinsRule or RestartableJenkinsRule with timeouts, abstract base classes, LoggerRule, docker-fixtures, before/after class/method, parameters, ad nauseam. As a developer I know exactly what I want to happen in what order but the framework, or perhaps misuse of the framework, is an obstacle rather than a convenience.", "author": "jglick", "createdAt": "2020-06-15T14:26:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM4MTQ2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA0MTUyOQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r445041529", "bodyText": "@jglick would you approve it after the discussion?", "author": "oleg-nenashev", "createdAt": "2020-06-24T17:02:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM4MTQ2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA0OTE0OQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r445049149", "bodyText": "I was never blocking anything here, just discussing possibilities and plans.", "author": "jglick", "createdAt": "2020-06-24T17:16:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM4MTQ2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4OTUxOQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r455489519", "bodyText": "Importing necessary classes is preferred", "author": "stellargo", "createdAt": "2020-07-16T03:34:55Z", "path": "core/src/test/java/hudson/PluginWrapperTest.java", "diffHunk": "@@ -10,36 +10,35 @@\n import java.util.jar.Manifest;\n \n import jenkins.model.Jenkins;\n-import org.junit.After;\n-import org.junit.Before;\n-import org.junit.Test;\n+import org.junit.jupiter.api.*;", "originalCommit": "4866d8d90eb5e066da788d52428b67530ae18c0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg3MzQwNQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r456873405", "bodyText": "Thanks, removed the star import", "author": "StefanSpieker", "createdAt": "2020-07-19T07:33:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4OTUxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4OTgwMw==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r455489803", "bodyText": "I am not sure if this is used", "author": "stellargo", "createdAt": "2020-07-16T03:35:54Z", "path": "core/src/test/java/hudson/PluginWrapperTest.java", "diffHunk": "@@ -10,36 +10,35 @@\n import java.util.jar.Manifest;\n \n import jenkins.model.Jenkins;\n-import org.junit.After;\n-import org.junit.Before;\n-import org.junit.Test;\n+import org.junit.jupiter.api.*;\n import org.mockito.invocation.InvocationOnMock;\n import org.mockito.stubbing.Answer;\n \n+import org.jvnet.hudson.test.Issue;", "originalCommit": "4866d8d90eb5e066da788d52428b67530ae18c0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg3MzM3Nw==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r456873377", "bodyText": "It is, because of Line 198:    @issue(\"JENKINS-52665\")", "author": "StefanSpieker", "createdAt": "2020-07-19T07:32:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4OTgwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5MTI2Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4699#discussion_r456891262", "bodyText": "Ahhh, nevermind then :)", "author": "stellargo", "createdAt": "2020-07-19T10:31:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ4OTgwMw=="}], "type": "inlineReview"}, {"oid": "09838acbdb4a66c5fabeb5ed70dfca7de84c2ba2", "url": "https://github.com/jenkinsci/jenkins/commit/09838acbdb4a66c5fabeb5ed70dfca7de84c2ba2", "message": "merged with master", "committedDate": "2020-07-19T07:32:08Z", "type": "commit"}]}