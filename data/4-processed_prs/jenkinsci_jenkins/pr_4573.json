{"pr_number": 4573, "pr_title": "[JENKINS-61465] Make checkAnyPermission work on non-AccessControlled", "pr_createdAt": "2020-03-13T11:40:20Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4573", "timeline": [{"oid": "7259d8698cf207cfdf6756de57006a93bfbaa5d0", "url": "https://github.com/jenkinsci/jenkins/commit/7259d8698cf207cfdf6756de57006a93bfbaa5d0", "message": "[JENKINS-61465] Make checkAnyPermission work on non-AccessControlled", "committedDate": "2020-03-13T11:31:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjE3OTU5NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4573#discussion_r392179595", "bodyText": "No {... my eyes are burning...", "author": "amuniz", "createdAt": "2020-03-13T11:44:43Z", "path": "core/src/main/java/hudson/Functions.java", "diffHunk": "@@ -1172,6 +1172,31 @@ public static void checkAnyPermission(AccessControlled ac, Permission[] permissi\n         ac.checkAnyPermission(permissions);\n     }\n \n+    /**\n+     * This version is so that the 'checkAnyPermission' on {@code layout.jelly}\n+     * degrades gracefully if \"it\" is not an {@link AccessControlled} object.\n+     * Otherwise it will perform no check and that problem is hard to notice.\n+     */\n+    public static void checkAnyPermission(Object object, Permission[] permissions) throws IOException, ServletException {\n+        if (permissions == null || permissions.length == 0) {\n+            return;\n+        }\n+\n+        if (object instanceof AccessControlled)", "originalCommit": "7259d8698cf207cfdf6756de57006a93bfbaa5d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjE4MDA3MQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4573#discussion_r392180071", "bodyText": "Consistent with the original \ud83d\ude01", "author": "daniel-beck", "createdAt": "2020-03-13T11:45:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjE3OTU5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjE3OTk5Mw==", "url": "https://github.com/jenkinsci/jenkins/pull/4573#discussion_r392179993", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (object instanceof AccessControlled)\n          \n          \n            \n                    if (object instanceof AccessControlled) {", "author": "timja", "createdAt": "2020-03-13T11:45:32Z", "path": "core/src/main/java/hudson/Functions.java", "diffHunk": "@@ -1172,6 +1172,31 @@ public static void checkAnyPermission(AccessControlled ac, Permission[] permissi\n         ac.checkAnyPermission(permissions);\n     }\n \n+    /**\n+     * This version is so that the 'checkAnyPermission' on {@code layout.jelly}\n+     * degrades gracefully if \"it\" is not an {@link AccessControlled} object.\n+     * Otherwise it will perform no check and that problem is hard to notice.\n+     */\n+    public static void checkAnyPermission(Object object, Permission[] permissions) throws IOException, ServletException {\n+        if (permissions == null || permissions.length == 0) {\n+            return;\n+        }\n+\n+        if (object instanceof AccessControlled)", "originalCommit": "7259d8698cf207cfdf6756de57006a93bfbaa5d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjE4MDA0Mw==", "url": "https://github.com/jenkinsci/jenkins/pull/4573#discussion_r392180043", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    else {\n          \n          \n            \n                   } else {", "author": "timja", "createdAt": "2020-03-13T11:45:40Z", "path": "core/src/main/java/hudson/Functions.java", "diffHunk": "@@ -1172,6 +1172,31 @@ public static void checkAnyPermission(AccessControlled ac, Permission[] permissi\n         ac.checkAnyPermission(permissions);\n     }\n \n+    /**\n+     * This version is so that the 'checkAnyPermission' on {@code layout.jelly}\n+     * degrades gracefully if \"it\" is not an {@link AccessControlled} object.\n+     * Otherwise it will perform no check and that problem is hard to notice.\n+     */\n+    public static void checkAnyPermission(Object object, Permission[] permissions) throws IOException, ServletException {\n+        if (permissions == null || permissions.length == 0) {\n+            return;\n+        }\n+\n+        if (object instanceof AccessControlled)\n+            checkAnyPermission((AccessControlled) object, permissions);\n+        else {", "originalCommit": "7259d8698cf207cfdf6756de57006a93bfbaa5d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}