{"pr_number": 5033, "pr_title": "JDK 11.0.9 / 8.0.272+ compatible FunctionsTest#printThrowable()", "pr_createdAt": "2020-10-26T07:52:08Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/5033", "timeline": [{"oid": "13f43c5aa96830fa29484da9e3237421d3e2881c", "url": "https://github.com/jenkinsci/jenkins/commit/13f43c5aa96830fa29484da9e3237421d3e2881c", "message": "JDK 11.0.9 / 8.0.272+ FunctionsTest#printThrowable()", "committedDate": "2020-10-26T07:50:59Z", "type": "commit"}, {"oid": "2fe12782da7d019d33d8792f1cfeece0d6ff66df", "url": "https://github.com/jenkinsci/jenkins/commit/2fe12782da7d019d33d8792f1cfeece0d6ff66df", "message": "Ensure proper older java 11 backwards compatibility", "committedDate": "2020-10-26T08:56:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMyOTQwNw==", "url": "https://github.com/jenkinsci/jenkins/pull/5033#discussion_r517329407", "bodyText": "Seems pretty fragile. Maybe better to just alter the assertPrintThrowable utility to tolerate either format.", "author": "jglick", "createdAt": "2020-11-04T13:07:34Z", "path": "core/src/test/java/hudson/FunctionsTest.java", "diffHunk": "@@ -510,24 +512,45 @@ public void printStackTrace(PrintWriter s) {\n                 s.println(\"Some custom exception\");\n             }\n         }, \"Some custom exception\\n\", \"Some custom exception\\n\");\n-        /* TODO exact format changed in 11.0.9 (JDK-8226809 / JDK-8252444)\n         // Circular references:\n         Stack stack1 = new Stack(\"p.Exc1\", \"p.C.method1:17\");\n         Stack stack2 = new Stack(\"p.Exc2\", \"p.C.method2:27\");\n         stack1.cause(stack2);\n         stack2.cause(stack1);\n-        assertPrintThrowable(stack1,\n-            \"p.Exc1\\n\" +\n-            \"\\tat p.C.method1(C.java:17)\\n\" +\n-            \"Caused by: p.Exc2\\n\" +\n-            \"\\tat p.C.method2(C.java:27)\\n\" +\n-            \"\\t[CIRCULAR REFERENCE:p.Exc1]\\n\",\n-            \"<cycle to p.Exc1>\\n\" +\n-            \"Caused: p.Exc2\\n\" +\n-            \"\\tat p.C.method2(C.java:27)\\n\" +\n-            \"Caused: p.Exc1\\n\" +\n-            \"\\tat p.C.method1(C.java:17)\\n\");\n-        */\n+        //Format changed in 11.0.9 / 8.0.272 (JDK-8226809 / JDK-8252444 / JDK-8252489)\n+        if ((getVersion().getDigitAt(0) == 11 && getVersion().isNewerThanOrEqualTo(new VersionNumber(\"11.0.9\"))) ||\n+                (getVersion().getDigitAt(0) == 8 && getVersion().isNewerThanOrEqualTo(new VersionNumber(\"8.0.272\")))) {", "originalCommit": "2fe12782da7d019d33d8792f1cfeece0d6ff66df", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}