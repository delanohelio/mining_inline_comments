{"pr_number": 4425, "pr_title": "[JENKINS-60734] Replace jsbuilder with webpack", "pr_createdAt": "2020-01-10T16:40:12Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4425", "timeline": [{"oid": "ff4b561211de5c94e8e21b133fe888e6e16c2b2c", "url": "https://github.com/jenkinsci/jenkins/commit/ff4b561211de5c94e8e21b133fe888e6e16c2b2c", "message": "set up webpack", "committedDate": "2020-01-09T17:32:31Z", "type": "commit"}, {"oid": "7f6bd4dde1ec5d994f14225f1f0d4456dbfd267d", "url": "https://github.com/jenkinsci/jenkins/commit/7f6bd4dde1ec5d994f14225f1f0d4456dbfd267d", "message": "add pluginsetupwizard.less to webpack", "committedDate": "2020-01-09T17:32:31Z", "type": "commit"}, {"oid": "f88d1f87712c9616c24d1c0e25c3dd2d83b71457", "url": "https://github.com/jenkinsci/jenkins/commit/f88d1f87712c9616c24d1c0e25c3dd2d83b71457", "message": "Migrates all JS code to webpack\n\n- moves the fonts back to the war/src/main/webapp/css folder", "committedDate": "2020-01-09T17:32:31Z", "type": "commit"}, {"oid": "17f575b45016dbb28811aee9a12b7da576d402fd", "url": "https://github.com/jenkinsci/jenkins/commit/17f575b45016dbb28811aee9a12b7da576d402fd", "message": "Uses the fonts just once. They are copied to the webapp/css folder on build time", "committedDate": "2020-01-09T17:32:31Z", "type": "commit"}, {"oid": "6251151fff686a33e381b012649f48c4d8ccdf3d", "url": "https://github.com/jenkinsci/jenkins/commit/6251151fff686a33e381b012649f48c4d8ccdf3d", "message": "Separates vendor scripts", "committedDate": "2020-01-09T17:32:32Z", "type": "commit"}, {"oid": "cb4ea8d6e784e5179e4b00460a59ce663b1bc20a", "url": "https://github.com/jenkinsci/jenkins/commit/cb4ea8d6e784e5179e4b00460a59ce663b1bc20a", "message": "Adds source build to maven and adds a yarn start command", "committedDate": "2020-01-09T17:32:32Z", "type": "commit"}, {"oid": "902763a0d88d0d95dd4cc5d47b8da7bd9399941c", "url": "https://github.com/jenkinsci/jenkins/commit/902763a0d88d0d95dd4cc5d47b8da7bd9399941c", "message": " Remove vscode config", "committedDate": "2020-01-09T17:32:32Z", "type": "commit"}, {"oid": "1f51d0d77471ee1da805702f8cfe79509e62b154", "url": "https://github.com/jenkinsci/jenkins/commit/1f51d0d77471ee1da805702f8cfe79509e62b154", "message": "Remove debug console statement", "committedDate": "2020-01-09T17:32:32Z", "type": "commit"}, {"oid": "7a998ddc995bfc0493319d61afd0808fd05561c5", "url": "https://github.com/jenkinsci/jenkins/commit/7a998ddc995bfc0493319d61afd0808fd05561c5", "message": "Bumping the Jenkins version to make it work on CI", "committedDate": "2020-01-09T17:32:32Z", "type": "commit"}, {"oid": "6107891cca155dd0a3d1859e91726e7a9a79873a", "url": "https://github.com/jenkinsci/jenkins/commit/6107891cca155dd0a3d1859e91726e7a9a79873a", "message": "Removes gulp, js-builder and other unused packages", "committedDate": "2020-01-10T11:53:34Z", "type": "commit"}, {"oid": "430f780719888a6016a29f4332441d24720fef6a", "url": "https://github.com/jenkinsci/jenkins/commit/430f780719888a6016a29f4332441d24720fef6a", "message": "Spacing and comment fixes", "committedDate": "2020-01-10T12:11:44Z", "type": "commit"}, {"oid": "402c00bb4e4b950c388f0c27b671d42ef5a031fd", "url": "https://github.com/jenkinsci/jenkins/commit/402c00bb4e4b950c388f0c27b671d42ef5a031fd", "message": "Revert more whitespace-only changes", "committedDate": "2020-01-10T12:37:22Z", "type": "commit"}, {"oid": "cded1818a45a2b3fa736b171a740b7c4d2a5cb4e", "url": "https://github.com/jenkinsci/jenkins/commit/cded1818a45a2b3fa736b171a740b7c4d2a5cb4e", "message": "Adds some codestyle changes", "committedDate": "2020-01-10T12:37:52Z", "type": "commit"}, {"oid": "8cf0394e1bc98716b7dc2defa472fb98f2f9caba", "url": "https://github.com/jenkinsci/jenkins/commit/8cf0394e1bc98716b7dc2defa472fb98f2f9caba", "message": "Removes more whitespace changes", "committedDate": "2020-01-10T15:11:51Z", "type": "commit"}, {"oid": "d294b5f57d9caad3ecf08a1aea8de6cc21ab927a", "url": "https://github.com/jenkinsci/jenkins/commit/d294b5f57d9caad3ecf08a1aea8de6cc21ab927a", "message": "Undo changes to the setup wizard test file", "committedDate": "2020-01-10T15:22:42Z", "type": "commit"}, {"oid": "0956410f1a2d928ceffae733e482fca76a17d772", "url": "https://github.com/jenkinsci/jenkins/commit/0956410f1a2d928ceffae733e482fca76a17d772", "message": "Fix: broken reference on the setup wizard progress page", "committedDate": "2020-01-10T15:36:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTMyNjYxMQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365326611", "bodyText": "Question: is Jenkins built on an environment where this cp command would fail?", "author": "fqueiruga", "createdAt": "2020-01-10T16:43:53Z", "path": "war/package.json", "diffHunk": "@@ -9,18 +9,38 @@\n     \"url\": \"https://github.com/tfennelly\"\n   },\n   \"private\": true,\n+  \"scripts\": {\n+    \"copy-fonts\": \"cp -rp src/main/fonts/* src/main/webapp/css\",", "originalCommit": "0956410f1a2d928ceffae733e482fca76a17d772", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM5ODUzNQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365398535", "bodyText": "Yea. It's tested on windows.\nTheres a webpack copy plugin that works really well", "author": "halkeye", "createdAt": "2020-01-10T19:37:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTMyNjYxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTA4MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365779080", "bodyText": "I have added the webpack copy plugin. Thanks!", "author": "fqueiruga", "createdAt": "2020-01-13T12:30:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTMyNjYxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3Mjk5Ng==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365772996", "bodyText": "Does it matter that potentially multiple values share the same ID with this replacement scheme?", "author": "daniel-beck", "createdAt": "2020-01-13T12:15:15Z", "path": "war/src/main/js/handlebars-helpers/id.js", "diffHunk": "@@ -0,0 +1,3 @@\n+export default function id(str) {\n+\treturn (''+str).replace(/\\W+/g, '_');", "originalCommit": "0956410f1a2d928ceffae733e482fca76a17d772", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3ODc1OA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365778758", "bodyText": "TBH I don't know. I limited the scope of this PR to just maintain current behaviour. I extracted the function as it is.", "author": "fqueiruga", "createdAt": "2020-01-13T12:30:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3Mjk5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAyOTY5OA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369029698", "bodyText": "I'm resolving this one, feel free to reopen it if you disagree!", "author": "fqueiruga", "createdAt": "2020-01-21T14:24:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3Mjk5Ng=="}], "type": "inlineReview"}, {"oid": "296d38b3501bbcc987657105cf5f06306ea13ab0", "url": "https://github.com/jenkinsci/jenkins/commit/296d38b3501bbcc987657105cf5f06306ea13ab0", "message": "Moved the font copying to webpack\n\n- It was previously done using cli, which could fail on windows\n- Added plugin to clean up webpack build folder\n- Cleaup on the package.json", "committedDate": "2020-01-13T12:28:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTQ2NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365779465", "bodyText": "While we are piling on wishlist items, can you switch to eslint because... well i have actually no solid reasons, i just like it a lot better and it has way more configuration options. https://github.com/jenkins-infra/plugin-site/blob/master/.eslintrc.js as an example", "author": "halkeye", "createdAt": "2020-01-13T12:31:58Z", "path": "war/.jshintrc.json", "diffHunk": "@@ -0,0 +1,11 @@\n+{", "originalCommit": "296d38b3501bbcc987657105cf5f06306ea13ab0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMTQyMA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365821420", "bodyText": "I'd also suggest going for eslint. My concern would be that there would suddenly be 100s of new lint warnings. From what I see I would also need to disable all styling rules.\nDo you think there would be any problem in this regard?", "author": "fqueiruga", "createdAt": "2020-01-13T14:07:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTQ2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTkzMDIwOQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365930209", "bodyText": "Just set everything to warn to start. When fix the warnings in a future pr", "author": "halkeye", "createdAt": "2020-01-13T17:28:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTQ2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkxMTk4NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r367911985", "bodyText": "@halkeye is there any eslint preset you recommend that can be good fit this project. I have only used the react-app one for the past year or so (which I think it's quite good).", "author": "fqueiruga", "createdAt": "2020-01-17T12:28:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTQ2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAzNjA5NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r368036095", "bodyText": "I don't have strong opinions about it. But if you run eslint --init you can infer all the rules based on the current codebase, so would allow things to be linted without making changes", "author": "halkeye", "createdAt": "2020-01-17T16:53:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTQ2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA4MDk2OA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369080968", "bodyText": "or like activating sonar on legacy code: limit the number of rules you activate, do the fixes, then activate new rules and so on.", "author": "alecharp", "createdAt": "2020-01-21T15:47:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTQ2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA4Mzk4MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369083980", "bodyText": "I have enabled eslint and stylelint with default configs", "author": "fqueiruga", "createdAt": "2020-01-21T15:52:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTQ2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365779682", "bodyText": "if your going to use env (which is +1 from me) make sure you have browserlist defined, i'm pretty sure core needs to support at least ie11", "author": "halkeye", "createdAt": "2020-01-13T12:32:35Z", "path": "war/.babelrc", "diffHunk": "@@ -0,0 +1,3 @@\n+{\n+  \"presets\": [\"@babel/preset-env\"],", "originalCommit": "296d38b3501bbcc987657105cf5f06306ea13ab0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTgyMTk0Nw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365821947", "bodyText": "Will do! Do you think I should make the move to env more visible? I was thinking that it could deserve it's own changelog entry.", "author": "fqueiruga", "createdAt": "2020-01-13T14:08:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTkzMjcwMQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r365932701", "bodyText": "I kinda want to say delay using babel for a future pr,\nScratch that.\nhttps://jenkins.io/doc/administration/requirements/web-browsers/ needs to be followed. After that your probably fine. So if your browser list matches up then probably no real concern.\nIt could potentially break JavaScript for older browsers, but since we don't say we support them, and people using ie10 are unlikely to upgrade Jenkins, I think your fine, but a note certainly wouldn't hurt\nCc @oleg-negashev who updated the list last", "author": "halkeye", "createdAt": "2020-01-13T17:33:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjMxNTU2MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r366315560", "bodyText": "+1 for following the policy or noting a breaking change if needed", "author": "oleg-nenashev", "createdAt": "2020-01-14T12:40:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkxNjI1Nw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r367916257", "bodyText": "I'll write an explanation about the change to babel. Is there any place other than the JIRA ticket and changelog entry where I would need to write about it (or where can I consult the policy).\nFWIW, I have tested on a IE VM and it seems to work on IE10, but I agree a disclaimer can be good just in case.", "author": "fqueiruga", "createdAt": "2020-01-17T12:40:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkzMjY0NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r367932645", "bodyText": "possibly here:\nhttps://jenkins.io/doc/developer/building/\nor somewhere near here:\nhttps://jenkins.io/doc/developer/views/\nBut I can't see any existing docs", "author": "timja", "createdAt": "2020-01-17T13:24:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA0MjkyMQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369042921", "bodyText": "Some plugins include frontend dev instructions on the package README (https://github.com/jenkinsci/pipeline-stage-view-plugin/tree/master/ui).\nI guess this is not the way that's done on Jenkins core. Are doc pages on jenkins.io preferred?\nIf this is this the case, I suppose I'd need to create a PR on https://github.com/jenkins-infra/jenkins.io right?", "author": "fqueiruga", "createdAt": "2020-01-21T14:46:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA0NTAyMA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369045020", "bodyText": "jenkins.io would be preferred for docs that affect multiple plugins, developer experience, and guides on how to do things.\nif it's very specific to core, it could just be documented in this repo\nand yes a PR to that repo if going to jenkins.io", "author": "timja", "createdAt": "2020-01-21T14:49:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE0MDkyNw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369140927", "bodyText": "I have updated the CONTRIBUTING.md with instructions specific to frontend work: b58ea61", "author": "fqueiruga", "createdAt": "2020-01-21T17:30:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTYxMjc2Mw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369612763", "bodyText": "Resolving this one, I'll send a PR to the jenkins.io repo if more docs are needed.", "author": "fqueiruga", "createdAt": "2020-01-22T15:03:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTc3OTY4Mg=="}], "type": "inlineReview"}, {"oid": "965dbafd6376f62588f2bae871193863069254b1", "url": "https://github.com/jenkinsci/jenkins/commit/965dbafd6376f62588f2bae871193863069254b1", "message": "Adds browserslist config (defaults + ie11)", "committedDate": "2020-01-13T15:49:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxNTczMQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r366915731", "bodyText": "I guess it can probably be found easily in the documentation, but maybe a comment explaining what each option means would be helpful. This is a quite big project and not everybody could be knowledgeable about this.", "author": "varyvol", "createdAt": "2020-01-15T14:48:30Z", "path": "war/.jshintrc.json", "diffHunk": "@@ -0,0 +1,11 @@\n+{\n+  \"curly\": true,", "originalCommit": "965dbafd6376f62588f2bae871193863069254b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkzNjc2MQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r366936761", "bodyText": "this is a json file, is it possible to add comments?", "author": "timja", "createdAt": "2020-01-15T15:24:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxNTczMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkxNzE2Ng==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r367917166", "bodyText": "You cannot leave comments in these files.\nThis config file belongs to jshint, it's the default one. I'll remove it as I'll try to replace jshint with eslint. On eslint, I'm partial too looking for a standard config, so that developers don't need to worry about the reasoning for each specific rule.", "author": "fqueiruga", "createdAt": "2020-01-17T12:42:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxNTczMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxNzkxNQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r366917915", "bodyText": "Why are these functions necessary?", "author": "varyvol", "createdAt": "2020-01-15T14:52:11Z", "path": "war/src/main/js/handlebars-helpers/ifneq.js", "diffHunk": "@@ -0,0 +1,5 @@\n+export default function ifneq(o1, o2, options) {", "originalCommit": "965dbafd6376f62588f2bae871193863069254b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDg2Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r366920862", "bodyText": "I mean: they were in a another file before. But do you think there could be places where they are used from outside?", "author": "varyvol", "createdAt": "2020-01-15T14:57:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxNzkxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkxODczNw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r367918737", "bodyText": "Handlebars templates are compiled and processed by webpack. In order to do this, Handlebars needs to know which helpers are available at compile time. That's why I extracted as many helpers as possible to this dir. Note that they can still be\nEvery helper that is registered at runtime must be listed on the webpack.config.js file. Only a small set of helpers are still registered this way, and the reason for that is that they break when extracted (due to their use of closure scope).", "author": "fqueiruga", "createdAt": "2020-01-17T12:47:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxNzkxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA4NDM2NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369084365", "bodyText": "Resolving this one. Feel free to unresolve it if you think further discussion is needed.", "author": "fqueiruga", "createdAt": "2020-01-21T15:53:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxNzkxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxOTM5Nw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r366919397", "bodyText": "Is this comment still valid?", "author": "varyvol", "createdAt": "2020-01-15T14:54:43Z", "path": "war/src/test/js/widgets/config/mocks.js", "diffHunk": "@@ -1,17 +1,18 @@\n+// TODO: remove or do something about this when reenabling the unit tests", "originalCommit": "965dbafd6376f62588f2bae871193863069254b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzk3MzEyMA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r367973120", "bodyText": "Not anymore :D good catch, I'll remove it", "author": "fqueiruga", "createdAt": "2020-01-17T14:49:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkxOTM5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDQ5Mw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r366920493", "bodyText": "Is this file necessary? It seems like something automatically generated?", "author": "varyvol", "createdAt": "2020-01-15T14:56:48Z", "path": "war/yarn.lock", "diffHunk": "@@ -2,31 +2,904 @@\n # yarn lockfile v1\n \n \n+\"@babel/cli@^7.7.4\":", "originalCommit": "965dbafd6376f62588f2bae871193863069254b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkxOTE2NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r367919165", "bodyText": "This file is autogenerated, so I guess yarn considers it as a needed dependency.", "author": "fqueiruga", "createdAt": "2020-01-17T12:48:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDQ5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzkyNjE1Mw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r367926153", "bodyText": "It\u2019s a lock file for repeatable builds and should be checked in", "author": "timja", "createdAt": "2020-01-17T13:07:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDQ5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQyNzk5Nw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r368427997", "bodyText": "I'm not sure of understanding. It's autogenerated but it needs to be checked in?", "author": "varyvol", "createdAt": "2020-01-20T08:55:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjkyMDQ5Mw=="}], "type": "inlineReview"}, {"oid": "b52bd327d589d637680da559007125cae5e2d544", "url": "https://github.com/jenkinsci/jenkins/commit/b52bd327d589d637680da559007125cae5e2d544", "message": "Migrates unit tests to Jest\n\n- Jest was chosen because it's the most feature-complete one\n- Fixes tests so that they would work with the new JS modules\n- Removed the gulpfile unused test dependencies\n- Enabled tests in maven", "committedDate": "2020-01-17T11:54:16Z", "type": "commit"}, {"oid": "c2e8ac13d4f2767874010158ad226dfb06ec32d1", "url": "https://github.com/jenkinsci/jenkins/commit/c2e8ac13d4f2767874010158ad226dfb06ec32d1", "message": "Adds a reporter because jest will output messages to stderr", "committedDate": "2020-01-17T11:56:48Z", "type": "commit"}, {"oid": "9c1ed1958cb51b34751b0cd46930cf14e3974dfb", "url": "https://github.com/jenkinsci/jenkins/commit/9c1ed1958cb51b34751b0cd46930cf14e3974dfb", "message": "Remove outdated comment", "committedDate": "2020-01-17T14:49:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUzNTQxNA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r368535414", "bodyText": "Maybe make clear that this file is generated during the build.", "author": "uhafner", "createdAt": "2020-01-20T13:01:09Z", "path": "core/src/main/resources/lib/layout/html.jelly", "diffHunk": "@@ -161,6 +161,8 @@ THE SOFTWARE.\n       <script src=\"${resURL}/scripts/msie.js\" type=\"text/javascript\"/>\n     </j:if>\n \n+    <!-- Load vendor scripts common to all JS modules -->", "originalCommit": "9c1ed1958cb51b34751b0cd46930cf14e3974dfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAzMDU0OQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369030549", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <!-- Load vendor scripts common to all JS modules -->\n          \n          \n            \n                <!-- Load bundled vendor scripts common to all JS modules -->", "author": "alecharp", "createdAt": "2020-01-21T14:26:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUzNTQxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTEyODI4NA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369128284", "bodyText": "I have updated the comment on 99832f1 .\nMarking it as resolved. Feel free to unresolve it if you'd like further change!", "author": "fqueiruga", "createdAt": "2020-01-21T17:05:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUzNTQxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODU0MjcxOQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r368542719", "bodyText": "Do plugins that depend on jquery-detached need updates as well?", "author": "uhafner", "createdAt": "2020-01-20T13:19:06Z", "path": "war/src/main/js/add-item.js", "diffHunk": "@@ -1,5 +1,4 @@\n-// Initialize all modules by requiring them. Also makes sure they get bundled (see gulpfile.js).\n-var $ = require('jquery-detached').getJQuery();", "originalCommit": "9c1ed1958cb51b34751b0cd46930cf14e3974dfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA4NTcwNQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369085705", "bodyText": "They don't. The code still works for plugins that use js-builder, js-modules and jquery-detached. With this update, Jenkins core just bundles its own dependencies on the vendors.js file. Plugins using the older system still work as expected.\nFWIW, I have manually verified that the pipeline stageview and warnings-ng plugins still work.", "author": "fqueiruga", "createdAt": "2020-01-21T15:55:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODU0MjcxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTIyNDUyMQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369224521", "bodyText": "Yes, I also checked that my plugin is still working \ud83c\udf89.", "author": "uhafner", "createdAt": "2020-01-21T20:24:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODU0MjcxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQ3NTA2Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369475062", "bodyText": "Closing this one then!", "author": "fqueiruga", "createdAt": "2020-01-22T10:19:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODU0MjcxOQ=="}], "type": "inlineReview"}, {"oid": "d4addbbd99ebb853c551187871b3af0ef0648609", "url": "https://github.com/jenkinsci/jenkins/commit/d4addbbd99ebb853c551187871b3af0ef0648609", "message": "Enables linting for JS and LESS files\n\n- Uses eslint for JS and stylelint for LESS\n- Uses default configs\n- Default severity set to warn to avoid breaking current builds", "committedDate": "2020-01-21T15:48:26Z", "type": "commit"}, {"oid": "1887edbd449f039ee8a6c08a72ee0240ff01b39a", "url": "https://github.com/jenkinsci/jenkins/commit/1887edbd449f039ee8a6c08a72ee0240ff01b39a", "message": " Fixes typo", "committedDate": "2020-01-21T15:50:26Z", "type": "commit"}, {"oid": "99832f1b9460d4c60cd4ca84762adebba0aacdc6", "url": "https://github.com/jenkinsci/jenkins/commit/99832f1b9460d4c60cd4ca84762adebba0aacdc6", "message": "Adds clarification that the vendors.js file is built by webpack", "committedDate": "2020-01-21T17:03:27Z", "type": "commit"}, {"oid": "b58ea61223a16868a263ce06f0c76dbc2d7686c0", "url": "https://github.com/jenkinsci/jenkins/commit/b58ea61223a16868a263ce06f0c76dbc2d7686c0", "message": "Add development instructions and bump the node versions", "committedDate": "2020-01-21T17:27:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAzMTY1MQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369031651", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <!-- Load vendor scripts common to all JS modules -->\n          \n          \n            \n                <!-- Load bundled vendor scripts common to all JS modules -->", "author": "alecharp", "createdAt": "2020-01-21T14:28:08Z", "path": "core/src/main/resources/lib/layout/layout.jelly", "diffHunk": "@@ -173,6 +173,8 @@ THE SOFTWARE.\n       <script src=\"${resURL}/scripts/msie.js\" type=\"text/javascript\"/>\n     </j:if>\n \n+    <!-- Load vendor scripts common to all JS modules -->", "originalCommit": "9c1ed1958cb51b34751b0cd46930cf14e3974dfb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQ3NjI3MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369476270", "bodyText": "I have added this clarification as per Ulli's feedback 99832f1", "author": "fqueiruga", "createdAt": "2020-01-22T10:21:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTAzMTY1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA5MjA0OQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369092049", "bodyText": "Based on nodejs.org, 12.14.1 is the current recommended version.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <node.version>12.14.0</node.version>\n          \n          \n            \n                <node.version>12.14.1</node.version>", "author": "alecharp", "createdAt": "2020-01-21T16:05:12Z", "path": "war/pom.xml", "diffHunk": "@@ -41,8 +41,8 @@ THE SOFTWARE.\n     <JENKINS_HOME>${basedir}/work</JENKINS_HOME>\n     <contextPath>/jenkins</contextPath><!-- context path during test -->\n     <port>8080</port><!-- HTTP listener port -->\n-    <node.version>6.10.2</node.version>\n-    <yarn.version>0.24.5</yarn.version>\n+    <node.version>12.14.0</node.version>", "originalCommit": "1887edbd449f039ee8a6c08a72ee0240ff01b39a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQ3NTc4Ng==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369475786", "bodyText": "Done", "author": "fqueiruga", "createdAt": "2020-01-22T10:20:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA5MjA0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA5NzQ4NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369097485", "bodyText": "this is good. We can have a round of fixing issues / warning then add a new rules, etc. I would suggest to look at having the same syntax for function definition. We have a mix of var foo = function() {} and function foo() {}. We can also tend to have the same declaration style for exports.", "author": "alecharp", "createdAt": "2020-01-21T16:14:18Z", "path": "war/.eslintrc.js", "diffHunk": "@@ -0,0 +1,35 @@\n+module.exports = {\n+    env: {\n+        browser: true,\n+        es6: true\n+    },\n+    // Uses eslint default ruleset\n+    extends: \"eslint:recommended\",\n+    plugins: [\n+        // Keeps the default level to warn to avoid breaking the current\n+        // CI build environment\n+        \"only-warn\"\n+    ],\n+    parserOptions: {\n+        ecmaVersion: 2018,\n+        sourceType: \"module\"\n+    },\n+    rules: {", "originalCommit": "1887edbd449f039ee8a6c08a72ee0240ff01b39a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA5OTQ0NA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369099444", "bodyText": "couldn't we have use\nexport default { createPluginSetupWizard };\n\nand have the same result?", "author": "alecharp", "createdAt": "2020-01-21T16:17:34Z", "path": "war/src/main/js/pluginSetupWizardGui.js", "diffHunk": "@@ -1266,5 +1266,7 @@ var createPluginSetupWizard = function(appendTarget) {\n \t}));\n };\n \n+var exports = {};\n // export wizard creation method\n exports.init = createPluginSetupWizard;\n+export default exports;", "originalCommit": "1887edbd449f039ee8a6c08a72ee0240ff01b39a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQ3NzE2MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369477160", "bodyText": "I guess I can change it to\nexport default { init: createPluginSetupWizard };", "author": "fqueiruga", "createdAt": "2020-01-22T10:23:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA5OTQ0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTU2MzAwMQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369563001", "bodyText": "yes correct. But it's good as it is. We will in the future I guess revisit some of the JS / UI code.", "author": "alecharp", "createdAt": "2020-01-22T13:39:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA5OTQ0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTYxMzEwMw==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369613103", "bodyText": "Done!", "author": "fqueiruga", "createdAt": "2020-01-22T15:04:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTA5OTQ0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE3MzA3NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369173075", "bodyText": "Suggested change", "author": "alecharp", "createdAt": "2020-01-21T18:36:56Z", "path": "CONTRIBUTING.md", "diffHunk": "@@ -49,6 +51,21 @@ mvn -pl war jetty:run\n \n (Beware that `maven-plugin` builds will not work in this mode due to class loading conflicts.)\n \n+### Building frontend assets\n+\n+To work on the `war` module frontend assets two processes are needed at the same time:\n+\n+On one terminal, start a development server that will not process frontend assets:\n+```sh\n+mvn -pl war jetty:run -Dskip.yarn\n+```\n+\n+On another terminal, move to the war folder and start a [webpack](https://webpack.js.org/) dev server:\n+```sh\n+cd war; yarn start\n+```\n+\n+", "originalCommit": "b58ea61223a16868a263ce06f0c76dbc2d7686c0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTMyMDc4Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369320782", "bodyText": "for consistency can you move the two requires up to import at the top?", "author": "halkeye", "createdAt": "2020-01-22T00:47:13Z", "path": "war/src/main/js/api/securityConfig.js", "diffHunk": "@@ -1,13 +1,12 @@\n /**\n  * Provides a wrapper to interact with the security configuration\n  */\n-\n-var jenkins = require('../util/jenkins');\n+import jenkins from '../util/jenkins';", "originalCommit": "b58ea61223a16868a263ce06f0c76dbc2d7686c0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTYxMjE3NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369612175", "bodyText": "I have done it in this commit: 6cccb69\nWhat do you think of the result?", "author": "fqueiruga", "createdAt": "2020-01-22T15:02:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTMyMDc4Mg=="}], "type": "inlineReview"}, {"oid": "e3e0497960cba089c21f3a3e0941ec85f17603fe", "url": "https://github.com/jenkinsci/jenkins/commit/e3e0497960cba089c21f3a3e0941ec85f17603fe", "message": "Update CONTRIBUTING.md\n\nCo-Authored-By: Adrien Lecharpentier <adrien.lecharpentier@gmail.com>", "committedDate": "2020-01-22T10:23:48Z", "type": "commit"}, {"oid": "b1dd0d294d77f2711112e68ada3a153f7e8fe415", "url": "https://github.com/jenkinsci/jenkins/commit/b1dd0d294d77f2711112e68ada3a153f7e8fe415", "message": "Migrates from requires to imports\n\n- Fixes some related linter errors in the way", "committedDate": "2020-01-22T14:42:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTYwODcyOQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369608729", "bodyText": "did you mean not deterministic?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                // This test may be deterministic, as it breaks if jest.resetModules is called on afterEach\n          \n          \n            \n                // This test may not be deterministic, as it breaks if jest.resetModules is called on afterEach", "author": "timja", "createdAt": "2020-01-22T14:57:14Z", "path": "war/src/test/js/widgets/config/tabbar.spec.js", "diffHunk": "@@ -1,31 +1,79 @@\n-var jsTest = require(\"jenkins-js-test\");\n-\n-require('./mocks');\n+import fs from 'fs';\n+import path from 'path';\n+import $ from 'jquery';\n+import jsTest from '@jenkins-cd/js-test';\n+import { mockBehaviorShim } from './mocks';\n+\n+const htmlConfigTabbedContent = fs.readFileSync(\n+    path.resolve(__dirname, './freestyle-config-tabbed.html'),\n+    'utf8'\n+);\n+\n+function getConfigTabbar() {\n+    // eslint-disable-next-line no-undef\n+    return require('../../../../main/js/config-tabbar');\n+}\n+\n+function getConfigTabbarWidget() {\n+    // eslint-disable-next-line no-undef\n+    return require('../../../../main/js/widgets/config/tabbar');\n+}\n \n describe(\"tabbar-spec tests\", function () {\n+    // Need to mock the utils/page module because we will hijack the scroll events\n+    const mockPageUtils = jest.requireActual('../../../../main/js/util/page');\n+\n+    beforeEach(() => {\n+        mockBehaviorShim();\n+\n+        jest.mock('../../../../main/js/util/page', () => ({\n+            __esModule: true,\n+            ...mockPageUtils,\n+            default: {\n+                ...mockPageUtils.default,\n+                fireBottomStickerAdjustEvent: jest.fn(),\n+            }\n+        }));\n+    });\n+\n+    afterEach(() => {\n+        jest.resetAllMocks()\n+    });\n+\n+    afterAll(() => {\n+        // Should call resetModules on afterAll because the test \"test section activation\"\n+        // will break if resetModules is called on afterEach.\n+        jest.resetModules();\n+    });\n \n     it(\"- test section count\", function (done) {\n         jsTest.onPage(function() {\n-            var tabbars = jsTest.requireSrcModule('config-tabbar.js');\n-            var firstTableMetadata = tabbars.tabs[0];\n+            document.documentElement.innerHTML = htmlConfigTabbedContent;\n \n-            var jQD = require('jquery-detached');\n-            var $ = jQD.getJQuery();\n+            var tabbars = getConfigTabbar();\n+            var firstTableMetadata = tabbars.tabs[0];\n \n-            expect($('.section-header-row', firstTableMetadata.configTable).size()).toBe(4);\n+            expect(firstTableMetadata.configTable.find('.section-header-row').length).toBe(4);\n             expect(firstTableMetadata.sectionCount()).toBe(4);\n             expect($('.tabBar .tab').size()).toBe(4);\n \n-            expect(firstTableMetadata.sectionIds().toString())\n-                .toBe('config_general,config__advanced_project_options,config__build_triggers,config__build');\n+            expect(firstTableMetadata.sectionIds()).toEqual([\n+                'config_general',\n+                'config__advanced_project_options',\n+                'config__build_triggers',\n+                'config__build'\n+            ])\n \n             done();\n-        }, 'widgets/config/freestyle-config-tabbed.html');\n+        }, htmlConfigTabbedContent);\n     });\n \n+    // This test may be deterministic, as it breaks if jest.resetModules is called on afterEach", "originalCommit": "b1dd0d294d77f2711112e68ada3a153f7e8fe415", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTYxMTI0NA==", "url": "https://github.com/jenkinsci/jenkins/pull/4425#discussion_r369611244", "bodyText": "Yeah, exactly", "author": "fqueiruga", "createdAt": "2020-01-22T15:01:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTYwODcyOQ=="}], "type": "inlineReview"}, {"oid": "6cccb699697374b54470db95c2f6043168b88c8d", "url": "https://github.com/jenkinsci/jenkins/commit/6cccb699697374b54470db95c2f6043168b88c8d", "message": "Move module-level comments to underneath the imports", "committedDate": "2020-01-22T14:59:55Z", "type": "commit"}, {"oid": "f7b961d548d37080a850b7a065aa2999504eef67", "url": "https://github.com/jenkinsci/jenkins/commit/f7b961d548d37080a850b7a065aa2999504eef67", "message": "Update war/src/test/js/widgets/config/tabbar.spec.js\n\nCo-Authored-By: Tim Jacomb <t.jacomb@kainos.com>", "committedDate": "2020-01-22T15:00:42Z", "type": "commit"}, {"oid": "d1b833deb66f88b50af79469b6c47735333dccfc", "url": "https://github.com/jenkinsci/jenkins/commit/d1b833deb66f88b50af79469b6c47735333dccfc", "message": "Adds .eslintignore file and changes the way eslint is run", "committedDate": "2020-01-22T16:54:12Z", "type": "commit"}, {"oid": "60a0816cc0b4d7c43dfb990cf0aeffe9177dd91c", "url": "https://github.com/jenkinsci/jenkins/commit/60a0816cc0b4d7c43dfb990cf0aeffe9177dd91c", "message": "Fix: broken interface of the jenkins object yielded by the setupWizard\n\n- Callbacks registered with `onSetupWizardInitialized` are yielded a `wizard` parameter, that contained a reference to the jenkins object.\n- Some plugins called the method `jenkins.initHandlebars` from this callback, to receive a Handlebars intance.\n- Added a unit test to ensure this regression does not happen again", "committedDate": "2020-01-22T17:47:15Z", "type": "commit"}]}