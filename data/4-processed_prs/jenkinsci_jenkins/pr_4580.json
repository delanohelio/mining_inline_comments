{"pr_number": 4580, "pr_title": "Pre-filter the 'Available' plugin manager tab, allow multiple terms", "pr_createdAt": "2020-03-14T23:16:06Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4580", "timeline": [{"oid": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3", "url": "https://github.com/jenkinsci/jenkins/commit/b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3", "message": "Pre-filter the 'Available' plugin manager tab, allow multiple terms", "committedDate": "2020-03-14T22:58:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjYyNjk3NA==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r392626974", "bodyText": "encountered and TR.plugin-category have been obsolete since #4534.", "author": "daniel-beck", "createdAt": "2020-03-14T23:17:07Z", "path": "core/src/main/resources/hudson/PluginManager/_table.js", "diffHunk": "@@ -9,30 +9,42 @@ function checkPluginsWithoutWarnings() {\n }\n \n Behaviour.specify(\"#filter-box\", '_table', 0, function(e) {\n-      function applyFilter() {\n-          var filter = e.value.toLowerCase();\n-          [\"TR.plugin\",\"TR.plugin-category\"].each(function(clz) {\n-            var encountered = {};", "originalCommit": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MDczOQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r392660739", "bodyText": "The search input doesn't seem to fit with the rest of the page to me, did its size need to be increased?", "author": "timja", "createdAt": "2020-03-15T10:34:34Z", "path": "core/src/main/resources/hudson/PluginManager/_table.css", "diffHunk": "@@ -10,7 +11,8 @@ time {\n \n #filter-container {\n     margin: 1em;\n-    text-align: right;\n+    text-align: center;\n+    font-size: 2em;", "originalCommit": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MTAzNA==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r392661034", "bodyText": "I did these changes to make it more noticeable. Now there's no way to use the \"Available\" tab without it, after all. Also larger font size for the placeholder list item.\nWhether these need to apply to other tabs too is more questionable.", "author": "daniel-beck", "createdAt": "2020-03-15T10:38:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MDczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2Njc5Nw==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r392666797", "bodyText": "alternative design:\ndaniel-beck#2", "author": "timja", "createdAt": "2020-03-15T11:58:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MDczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2NzExMw==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r392667113", "bodyText": "@fqueiruga PTAL", "author": "daniel-beck", "createdAt": "2020-03-15T12:03:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MDczOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzMTQwNw==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r393531407", "bodyText": "I'd just go with Tim's design, it's more consistent with the header one. We could also extract it into a searchbox widget in the future.", "author": "fqueiruga", "createdAt": "2020-03-17T09:05:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY2MDczOQ=="}], "type": "inlineReview"}, {"oid": "42cfea9cd56c6da00ae528b53953d49120f04b25", "url": "https://github.com/jenkinsci/jenkins/commit/42cfea9cd56c6da00ae528b53953d49120f04b25", "message": "Re-work search / filter input", "committedDate": "2020-03-15T11:56:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzMjUyNw==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r393532527", "bodyText": "I think this is a case for using the font-size in rems. ems should only be used when the element size depends on where they are (such as hyperlinks or inline monospaced elements)\nRecommended font sizes are located on the font.less file", "author": "fqueiruga", "createdAt": "2020-03-17T09:07:07Z", "path": "core/src/main/resources/hudson/PluginManager/_table.css", "diffHunk": "@@ -2,6 +2,7 @@\n     background: white url('search.gif') no-repeat 2px center;\n     padding-left: 20px;\n     width: 15em;\n+    font-size: 1em;", "originalCommit": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzNDc0Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r393534742", "bodyText": "getElementsBySelector is a prototype.js function, and should be avoided. The alternatives are using querySelectorAll (https://caniuse.com/#search=querySelectorAll). If the browser support is not good enough (especially due to Baidu-browser support, then I suggest using getElementsByClassName('plugin') and filter out the elements that are not <tr> within the function.", "author": "fqueiruga", "createdAt": "2020-03-17T09:11:23Z", "path": "core/src/main/resources/hudson/PluginManager/_table.js", "diffHunk": "@@ -9,30 +9,42 @@ function checkPluginsWithoutWarnings() {\n }\n \n Behaviour.specify(\"#filter-box\", '_table', 0, function(e) {\n-      function applyFilter() {\n-          var filter = e.value.toLowerCase();\n-          [\"TR.plugin\",\"TR.plugin-category\"].each(function(clz) {\n-            var encountered = {};\n-            var items = document.getElementsBySelector(clz);\n-            for (var i=0; i<items.length; i++) {\n-                var visible = (filter==\"\" || items[i].innerHTML.toLowerCase().indexOf(filter)>=0);\n-                var name = items[i].cells && items[i].cells.length > 1\n-                        ? items[i].cells[1].getAttribute('data-id')\n-                        : items[i].getAttribute(\"name\");\n-                if (visible && name != null) {\n-                    if (encountered[name]) {\n-                        visible = false;\n-                    }\n-                    encountered[name] = true;\n+    function applyFilter() {\n+        var filter = e.value.toLowerCase().trim();\n+        var filterParts = filter.split(/ +/).filter (word => word.length > 0);\n+        var items = document.getElementsBySelector(\"TR.plugin\");", "originalCommit": "b9e4d4c0a80ede667f387d43dc71e4d8b004e0a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU3Nzc3MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r393577770", "bodyText": "Unchanged from before, just threw out the other, obsolete selector \u2639\ufe0f", "author": "daniel-beck", "createdAt": "2020-03-17T10:26:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzNDc0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU4NzQyNA==", "url": "https://github.com/jenkinsci/jenkins/pull/4580#discussion_r393587424", "bodyText": "Looks like I didn't read the diff properly then \ud83d\udc4d", "author": "fqueiruga", "createdAt": "2020-03-17T10:43:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzNDc0Mg=="}], "type": "inlineReview"}, {"oid": "03d2937d0cfa874a2afcab1431c26489fa178766", "url": "https://github.com/jenkinsci/jenkins/commit/03d2937d0cfa874a2afcab1431c26489fa178766", "message": "Focus the filter/search field once the page is loaded.", "committedDate": "2020-03-28T01:55:02Z", "type": "commit"}, {"oid": "142a78653f711aa42446c1f534da2ee9f268935e", "url": "https://github.com/jenkinsci/jenkins/commit/142a78653f711aa42446c1f534da2ee9f268935e", "message": "Look at innerHTML as before, rather than textContent\n\nWill cause lots of 'false positives' for some search terms, but\ncan always be cleaned up later through more fine-grained control\nwhat can be searched (e.g. textContent + artifactId)", "committedDate": "2020-04-01T00:10:42Z", "type": "commit"}, {"oid": "a73f86c1afb563717f5d4bdb12061f5ff8acbf2b", "url": "https://github.com/jenkinsci/jenkins/commit/a73f86c1afb563717f5d4bdb12061f5ff8acbf2b", "message": "Merge branch 'master' into prefiltered-available", "committedDate": "2020-04-10T07:43:50Z", "type": "commit"}, {"oid": "104e7451ed60e400825257950312eddc5074b07a", "url": "https://github.com/jenkinsci/jenkins/commit/104e7451ed60e400825257950312eddc5074b07a", "message": "Update table.jelly", "committedDate": "2020-04-10T08:00:36Z", "type": "commit"}, {"oid": "dd0c8d08ddbb06bd61085c8d5448c38e94f28e12", "url": "https://github.com/jenkinsci/jenkins/commit/dd0c8d08ddbb06bd61085c8d5448c38e94f28e12", "message": "Fix quoting", "committedDate": "2020-04-10T08:37:37Z", "type": "commit"}]}