{"pr_number": 4987, "pr_title": "Reduce the prototype.js usage", "pr_createdAt": "2020-10-11T16:09:41Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4987", "timeline": [{"oid": "1a20e5cdab4a98790a4d642d96a86f1f01df815a", "url": "https://github.com/jenkinsci/jenkins/commit/1a20e5cdab4a98790a4d642d96a86f1f01df815a", "message": "Reduce the prototype.js usage\n\nOnly cover the Element.xxxClassName in hudson-behavior. The related methods can be easily replaced by vanilla JavaScript.\nFor compatibility: https://caniuse.com/classlist (add, remove and contains with single argument is supported by all supported browsers)", "committedDate": "2020-10-11T16:02:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNTA5OA==", "url": "https://github.com/jenkinsci/jenkins/pull/4987#discussion_r503425098", "bodyText": "Is it certain that rows[0] is not undefined?", "author": "zbynek", "createdAt": "2020-10-12T17:04:26Z", "path": "war/src/main/webapp/scripts/hudson-behavior.js", "diffHunk": "@@ -2222,7 +2220,7 @@ function updateBuildHistory(ajaxUrl,nBuild) {\n \n                     // delete all rows\n                     var searchRow;\n-                    if (Element.hasClassName(rows[0], \"build-search-row\")) {\n+                    if (rows[0].classList.contains('build-search-row')) {", "originalCommit": "1a20e5cdab4a98790a4d642d96a86f1f01df815a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU1ODM5MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4987#discussion_r505558390", "bodyText": "It must be given it was also used before?", "author": "varyvol", "createdAt": "2020-10-15T13:50:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNTA5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyNTYxMg==", "url": "https://github.com/jenkinsci/jenkins/pull/4987#discussion_r503425612", "bodyText": "Is it certain that el1 and el2 are not undefined?", "author": "zbynek", "createdAt": "2020-10-12T17:05:26Z", "path": "war/src/main/webapp/scripts/hudson-behavior.js", "diffHunk": "@@ -1781,30 +1787,30 @@ function updateBuildHistory(ajaxUrl,nBuild) {\n             return;\n         }\n \n-        if (Element.hasClassName(row, \"overflow-checked\")) {\n+        if (row.classList.contains('overflow-checked')) {\n             // already done.\n             return;\n         }\n \n         function markSingleline() {\n-            Element.addClassName(row, \"single-line\");\n-            Element.removeClassName(row, \"multi-line\");\n+            row.classList.add('single-line');\n+            row.classList.remove('multi-line');\n         }\n         function markMultiline() {\n-            Element.removeClassName(row, \"single-line\");\n-            Element.addClassName(row, \"multi-line\");\n+            row.classList.remove('single-line');\n+            row.classList.add('multi-line');\n         }\n         function indentMultiline(element) {\n-            Element.addClassName(element, \"indent-multiline\");\n+            element.classList.add('indent-multiline');\n         }\n \n         function blockWrap(el1, el2) {\n             var div = document.createElement('div');\n \n-            Element.addClassName(div, \"block\");\n-            Element.addClassName(div, \"wrap\");\n-            Element.addClassName(el1, \"wrapped\");\n-            Element.addClassName(el2, \"wrapped\");\n+            div.classList.add('block');\n+            div.classList.add('wrap');\n+            el1.classList.add('wrapped');", "originalCommit": "1a20e5cdab4a98790a4d642d96a86f1f01df815a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc3OTgzOQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4987#discussion_r504779839", "bodyText": "Could this be replaced by something like clsName.split(' ').forEach(function (className) { if (className) be.classList.add(className) }) ?", "author": "fqueiruga", "createdAt": "2020-10-14T15:39:29Z", "path": "war/src/main/webapp/scripts/hudson-behavior.js", "diffHunk": "@@ -616,7 +616,13 @@ function makeButton(e,onclick) {\n     if(h!=null)\n         btn.addListener(\"click\",h);\n     var be = btn.get(\"element\");\n-    Element.addClassName(be,clsName);\n+    var classesSeparatedByWhitespace = clsName.split(' ');\n+    for (var i = 0; i < classesSeparatedByWhitespace.length; i++) {\n+        var singleClass = classesSeparatedByWhitespace[i];\n+        if (singleClass) {\n+            be.classList.add(singleClass);\n+        }\n+    }", "originalCommit": "1a20e5cdab4a98790a4d642d96a86f1f01df815a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}