{"pr_number": 4926, "pr_title": "[JENKINS-63592] Revamp empty states", "pr_createdAt": "2020-09-04T13:04:25Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4926", "timeline": [{"oid": "df5af8d28d5fa52eef4c9b1265abe4730da35a76", "url": "https://github.com/jenkinsci/jenkins/commit/df5af8d28d5fa52eef4c9b1265abe4730da35a76", "message": "wip - extract conditional vars", "committedDate": "2020-09-01T15:16:12Z", "type": "commit"}, {"oid": "1560e1eb68c1cf1c031631020a88352467a937c6", "url": "https://github.com/jenkinsci/jenkins/commit/1560e1eb68c1cf1c031631020a88352467a937c6", "message": "Rework the empty state screends\n\n- Create content block components for the sectioning and hyperlinks\n- Reorganize the conditional logic to use the new sectioning", "committedDate": "2020-09-04T10:02:12Z", "type": "commit"}, {"oid": "f86ca6b279565643c114c5a6ba7fe325ff8f3a68", "url": "https://github.com/jenkinsci/jenkins/commit/f86ca6b279565643c114c5a6ba7fe325ff8f3a68", "message": "Set up i18n and clear outdated strings", "committedDate": "2020-09-04T10:02:18Z", "type": "commit"}, {"oid": "f34b7950a8d83167fa25ade7509ee54c4a0822b5", "url": "https://github.com/jenkinsci/jenkins/commit/f34b7950a8d83167fa25ade7509ee54c4a0822b5", "message": "Fix broken build for empty state styles", "committedDate": "2020-09-07T09:05:24Z", "type": "commit"}, {"oid": "d00812704001aa0f995f454b3932829da63d07bd", "url": "https://github.com/jenkinsci/jenkins/commit/d00812704001aa0f995f454b3932829da63d07bd", "message": "Undo unintended change to global hyperlinks\n\n- I added a CSS class for generic dark links that should be left for a different PR", "committedDate": "2020-09-07T09:05:55Z", "type": "commit"}, {"oid": "7f9db67f5f67eee1d3079d8b0e88b7dd0a2cae1d", "url": "https://github.com/jenkinsci/jenkins/commit/7f9db67f5f67eee1d3079d8b0e88b7dd0a2cae1d", "message": "UI touches for the empty state styles\n\n- No longer show welcome message for empty folders\n- Update link focus outline color to palette", "committedDate": "2020-09-07T09:06:35Z", "type": "commit"}, {"oid": "92513c7f6564471ca594ec8d230af26b2ed36c6c", "url": "https://github.com/jenkinsci/jenkins/commit/92513c7f6564471ca594ec8d230af26b2ed36c6c", "message": "Try to fix encoding issues", "committedDate": "2020-09-07T09:40:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMwMzc0Mw==", "url": "https://github.com/jenkinsci/jenkins/pull/4926#discussion_r487303743", "bodyText": "Hmm this doesn't seem right,\n\nit's just linking to new computer, not the cloud configuration screen.\nit's showing up when I don't have a cloud plugin installed\n\nAlthough 2 probably isn't too bad as there's docs on the configure Clouds page saying what to do:\n\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                                a(href: \"computer/new\", class: \"content-block__link\") {\n          \n          \n            \n                                                a(href: \"configureClouds\", class: \"content-block__link\") {", "author": "timja", "createdAt": "2020-09-11T21:42:32Z", "path": "core/src/main/resources/hudson/model/AllView/noJob.groovy", "diffHunk": "@@ -4,40 +4,142 @@ import hudson.model.Computer\n import hudson.model.Item\n import jenkins.model.Jenkins\n \n+def l = namespace(lib.LayoutTagLib)\n+\n+def isTopLevelAllView = my.owner == Jenkins.get();\n+def canSetUpDistributedBuilds = Jenkins.get().hasPermission(Computer.CREATE) &&\n+        Jenkins.get().clouds.isEmpty() &&\n+        Jenkins.get().getNodes().isEmpty();\n+def hasAdministerJenkinsPermission = Jenkins.get().hasPermission(Jenkins.ADMINISTER);\n+def hasItemCreatePermission = my.owner.hasPermission(Item.CREATE);\n+\n div {\n-    h1(_(\"Welcome to Jenkins!\"))\n-\n-    if (my.owner == Jenkins.get()) {\n-        // we're a top-level 'All' view\n-        if (Jenkins.get().hasPermission(Computer.CREATE) && Jenkins.get().clouds.isEmpty() && Jenkins.get().getNodes().isEmpty()) {\n-            div(class: 'call-to-action') {\n-                if (Jenkins.get().hasPermission(Jenkins.ADMINISTER)) {\n-                    raw(_(\"distributedBuildsWithCloud\"))\n-                } else {\n-                    raw(_(\"distributedBuilds\"))\n+\n+    div(class: \"empty-state-block\") {\n+        if (isTopLevelAllView) {\n+            if (canSetUpDistributedBuilds || hasItemCreatePermission) {\n+                h1(_(\"Welcome to Jenkins!\"))\n+\n+                p(_(\"noJobDescription\"))\n+\n+                if (canSetUpDistributedBuilds) {\n+                    section(class: \"empty-state-section\") {\n+                        h2(_(\"setUpDistributedBuilds\"), class: \"h4\")\n+                        ul(class: \"empty-state-section-list\") {\n+                            li(class: \"content-block\") {\n+                                a(href: \"computer/new\", class: \"content-block__link\") {\n+                                    span(_(\"setUpAgent\"))\n+                                    span(class: \"trailing-icon\") {\n+                                        l.svgIcon(\n+                                                class: \"icon-sm\",\n+                                                href: \"${resURL}/images/material-icons/svg-sprite-navigation-symbol.svg#ic_arrow_forward_24px\")\n+                                    }\n+                                }\n+                            }\n+\n+                            if (hasAdministerJenkinsPermission) {\n+                                li(class: \"content-block\") {\n+                                    a(href: \"computer/new\", class: \"content-block__link\") {", "originalCommit": "92513c7f6564471ca594ec8d230af26b2ed36c6c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM4OTg4OA==", "url": "https://github.com/jenkinsci/jenkins/pull/4926#discussion_r487389888", "bodyText": "Maybe I messed something up", "author": "fqueiruga", "createdAt": "2020-09-12T09:24:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMwMzc0Mw=="}], "type": "inlineReview"}, {"oid": "b46d5fb1b8fadc5de925945cbf2dbc1d030d2965", "url": "https://github.com/jenkinsci/jenkins/commit/b46d5fb1b8fadc5de925945cbf2dbc1d030d2965", "message": "Update core/src/main/resources/hudson/model/AllView/noJob.groovy\n\nCo-authored-by: Tim Jacomb <timjacomb1+github@gmail.com>", "committedDate": "2020-09-12T09:24:41Z", "type": "commit"}, {"oid": "12cb16bbd5f1eea056f6ed6afea12a758a9acb15", "url": "https://github.com/jenkinsci/jenkins/commit/12cb16bbd5f1eea056f6ed6afea12a758a9acb15", "message": "Move create job to top and change section title", "committedDate": "2020-09-12T09:42:46Z", "type": "commit"}]}