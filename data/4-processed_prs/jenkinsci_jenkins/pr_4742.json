{"pr_number": 4742, "pr_title": "[JENKINS-62332] Show when a plugin version newer than offered exists", "pr_createdAt": "2020-05-25T20:40:40Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4742", "timeline": [{"oid": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4", "url": "https://github.com/jenkinsci/jenkins/commit/c1f4f8dcc81b605f16776eec3d677e2e0b1347c4", "message": "[JENKINS-62332] Show when a plugin version newer than offered exists", "committedDate": "2020-05-25T20:39:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDEyNDI0Nw==", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430124247", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied.\n          \n          \n            \n              This is typically the case when plugin's requirements are not satisfied. e.g. a more recent version of Jenkins", "author": "res0nance", "createdAt": "2020-05-26T02:18:58Z", "path": "core/src/main/resources/hudson/PluginManager/table.properties", "diffHunk": "@@ -51,6 +51,13 @@ ago={0} ago\n adoptThisPlugin=\\\n   <strong>This plugin is up for adoption!</strong> We are looking for new maintainers. \\\n   Visit our <a href=\"https://jenkins.io/doc/developer/plugin-governance/adopt-a-plugin/\" target=\"_blank\">Adopt a Plugin</a> initiative for more information.\n+newerVersionExists=\\\n+  A newer version than being offered for installation exists (version {0}). \\\n+  This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied.", "originalCommit": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDEyNDM4Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430124382", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied. \\\n          \n          \n            \n              This is typically the case when plugin's requirements are not satisfied. e.g. a more recent version of Jenkins. \\", "author": "res0nance", "createdAt": "2020-05-26T02:19:36Z", "path": "core/src/main/resources/hudson/PluginManager/table.properties", "diffHunk": "@@ -51,6 +51,13 @@ ago={0} ago\n adoptThisPlugin=\\\n   <strong>This plugin is up for adoption!</strong> We are looking for new maintainers. \\\n   Visit our <a href=\"https://jenkins.io/doc/developer/plugin-governance/adopt-a-plugin/\" target=\"_blank\">Adopt a Plugin</a> initiative for more information.\n+newerVersionExists=\\\n+  A newer version than being offered for installation exists (version {0}). \\\n+  This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied.\n+newerVersionEntry=\\\n+  This version of the plugin exists but it is not being offered as an update. \\\n+  This is typically the case when plugin requirements, e.g. a recent version of Jenkins, are not satisfied. \\", "originalCommit": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI1NjgyMQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430256821", "bodyText": "Isn't this taken care of in the plugin.latest calculation?", "author": "varyvol", "createdAt": "2020-05-26T08:52:46Z", "path": "core/src/main/java/hudson/PluginManager.java", "diffHunk": "@@ -2266,6 +2266,14 @@ public boolean hasAdoptThisPluginLabel(UpdateSite.Plugin plugin) {\n         return Arrays.asList(categories).contains(\"adopt-this-plugin\");\n     }\n \n+    @Restricted(DoNotUse.class) // Used from table.jelly\n+    public boolean hasLatestVersionNewerThanOffered(UpdateSite.Plugin plugin) {\n+        if (plugin.latest == null) {\n+            return false;\n+        }\n+        return !plugin.latest.equalsIgnoreCase(plugin.version); // we can assume that any defined 'latest' will be newer than the actual offered version", "originalCommit": "c1f4f8dcc81b605f16776eec3d677e2e0b1347c4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3MTgxMg==", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430271812", "bodyText": "This code supports latest being added to JSON even if the latest release is being offered. While that's not the behavior of update-center2 in the linked PR, I wouldn't consider it wrong.", "author": "daniel-beck", "createdAt": "2020-05-26T09:17:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI1NjgyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM1MzE1OA==", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430353158", "bodyText": "Maybe it's not wrong, but isn't it more sensible to make both sides have the same behaviour? I believe it's easier to undertand.", "author": "varyvol", "createdAt": "2020-05-26T11:49:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI1NjgyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM3MjA3Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r430372072", "bodyText": "https://en.wikipedia.org/wiki/Robustness_principle", "author": "daniel-beck", "createdAt": "2020-05-26T12:25:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI1NjgyMQ=="}], "type": "inlineReview"}, {"oid": "fc4b0c36d85a1a9d01bf1cda8ec5e6c6e53f0db8", "url": "https://github.com/jenkinsci/jenkins/commit/fc4b0c36d85a1a9d01bf1cda8ec5e6c6e53f0db8", "message": "Add more obvious label/tag to entries that cannot be installed\n\nAlso link to plugin documentation from the detail message", "committedDate": "2020-05-29T06:54:50Z", "type": "commit"}, {"oid": "65bd0f8e6443a437f1bddbc460e8af4ee29588ff", "url": "https://github.com/jenkinsci/jenkins/commit/65bd0f8e6443a437f1bddbc460e8af4ee29588ff", "message": "Also show the list if there are any unavailable updates", "committedDate": "2020-05-29T15:34:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU2MTUzMg==", "url": "https://github.com/jenkinsci/jenkins/pull/4742#discussion_r435561532", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            }\n          \n          \n            \n            }", "author": "oleg-nenashev", "createdAt": "2020-06-04T21:24:22Z", "path": "core/src/main/resources/hudson/PluginManager/_table.css", "diffHunk": "@@ -76,3 +76,23 @@ time {\n .hidden {\n     display: none;\n }\n+\n+#plugins tr.unavailable {\n+  background-color: #f4f4f4;\n+}\n+tr.unavailable span.unavailable-label {\n+    display: inline-block;\n+    border: 1px solid #666;\n+    background-color: #fcc;\n+    color: #333;\n+    border-radius: 4px;\n+    font-size: 0.75rem;\n+    font-weight: 500;\n+    padding: 0 0.5rem;\n+    margin: 0.25rem 0.5rem;\n+    text-decoration: none;\n+    text-align: center;\n+    white-space: nowrap;\n+    vertical-align: baseline;\n+    text-transform: uppercase;\n+}", "originalCommit": "65bd0f8e6443a437f1bddbc460e8af4ee29588ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}