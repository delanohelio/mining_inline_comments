{"pr_number": 4603, "pr_title": "Let ConfidentialKey & Secret do something from unit tests", "pr_createdAt": "2020-03-26T16:25:50Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4603", "timeline": [{"oid": "d845ac9e937110c7e7e88d75156271e60a7a1d2b", "url": "https://github.com/jenkinsci/jenkins/commit/d845ac9e937110c7e7e88d75156271e60a7a1d2b", "message": "Delete ConfidentialStoreRule", "committedDate": "2020-03-26T16:08:07Z", "type": "commit"}, {"oid": "d2f8515c6c1ab537b6603dbb9385622e9bc68db2", "url": "https://github.com/jenkinsci/jenkins/commit/d2f8515c6c1ab537b6603dbb9385622e9bc68db2", "message": "Also delete MockSecretRule so Secret.fromString works", "committedDate": "2020-03-26T16:25:08Z", "type": "commit"}, {"oid": "84118166b8d9250e28c7e8902fcbcf2c21b3bbeb", "url": "https://github.com/jenkinsci/jenkins/commit/84118166b8d9250e28c7e8902fcbcf2c21b3bbeb", "message": "Secret.SECRET still referenced by SecretHelper in jenkins-test-harness, used by RekeySecretAdminMonitorTest, also copied in publish-over-*-plugin", "committedDate": "2020-03-26T22:13:46Z", "type": "commit"}, {"oid": "4ca122664a1b8bee8952dddbcaaa9ab1f9ffe731", "url": "https://github.com/jenkinsci/jenkins/commit/4ca122664a1b8bee8952dddbcaaa9ab1f9ffe731", "message": "Merge branch 'master' of github.com:jenkinsci/jenkins into ConfidentialStoreRule", "committedDate": "2020-03-27T12:47:36Z", "type": "commit"}, {"oid": "8672e47968dd0883921ab1a12d48475dea6ecfba", "url": "https://github.com/jenkinsci/jenkins/commit/8672e47968dd0883921ab1a12d48475dea6ecfba", "message": "RSAConfidentialKey ought to use the same SecureRandom as the ConfidentialStore; this also lets the mock use a fixed seed", "committedDate": "2020-03-27T14:53:45Z", "type": "commit"}, {"oid": "50034fb8a59387cf38eae88694188f3622d659c2", "url": "https://github.com/jenkinsci/jenkins/commit/50034fb8a59387cf38eae88694188f3622d659c2", "message": "For now ConfidentialStore.secureRandom can be abstract", "committedDate": "2020-03-27T15:24:22Z", "type": "commit"}, {"oid": "4cacf1c9bc54c1e5a1f226a577128aef8ad4f926", "url": "https://github.com/jenkinsci/jenkins/commit/4cacf1c9bc54c1e5a1f226a577128aef8ad4f926", "message": "Some core unit tests can be rather verbose; set maven.test.redirectTestOutputToFile", "committedDate": "2020-03-27T17:33:02Z", "type": "commit"}, {"oid": "244a9c7351cc2dc807d1f3d21810be6465275976", "url": "https://github.com/jenkinsci/jenkins/commit/244a9c7351cc2dc807d1f3d21810be6465275976", "message": "Looks like we need a ConfidentialStoreRule after all", "committedDate": "2020-03-27T17:56:11Z", "type": "commit"}, {"oid": "dfc5bb9c06d163ee999dc3f15ba2d712e551bc8e", "url": "https://github.com/jenkinsci/jenkins/commit/dfc5bb9c06d163ee999dc3f15ba2d712e551bc8e", "message": "Restored another couple of usages", "committedDate": "2020-03-27T17:59:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ5MDg2MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4603#discussion_r399490860", "bodyText": "Being a public API, this would sort of break it, though I have no idea if anyone besides me has even tried extending this class besides the default one.", "author": "jvz", "createdAt": "2020-03-27T19:23:13Z", "path": "core/src/main/java/jenkins/security/ConfidentialStore.java", "diffHunk": "@@ -51,6 +55,9 @@\n      */\n     protected abstract @CheckForNull byte[] load(ConfidentialKey key) throws IOException;\n \n+    // TODO consider promoting to public, and offering a default implementation of randomBytes (via the usual Util.isOverridden binary compat trick)\n+    abstract SecureRandom secureRandom();", "originalCommit": "dfc5bb9c06d163ee999dc3f15ba2d712e551bc8e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ5NTMzMg==", "url": "https://github.com/jenkinsci/jenkins/pull/4603#discussion_r399495332", "bodyText": "this would sort of break it\n\nNot if you used the usual Util.isOverridden trick. Both methods concrete, one unconditionally delegates to the other, vice-versa conditionally, else throw AbstractMethodError or supply a default implementation.", "author": "jglick", "createdAt": "2020-03-27T19:31:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ5MDg2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ5NzE1NQ==", "url": "https://github.com/jenkinsci/jenkins/pull/4603#discussion_r399497155", "bodyText": "Oh, that's a new trick to me.", "author": "jvz", "createdAt": "2020-03-27T19:35:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ5MDg2MA=="}], "type": "inlineReview"}]}