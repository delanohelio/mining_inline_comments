{"pr_number": 838, "pr_title": "CLDR-14268 improve vetting participation page", "pr_createdAt": "2020-11-11T00:33:15Z", "pr_url": "https://github.com/unicode-org/cldr/pull/838", "timeline": [{"oid": "41c885dc2abd6efc34857c12b8161b6137db4df1", "url": "https://github.com/unicode-org/cldr/commit/41c885dc2abd6efc34857c12b8161b6137db4df1", "message": "CLDR-14268 improve vetting participation page\n\n- major rewrite of 'vetting participation' to a speedy query + new UI (non JSP)\n- also fix Utilka CLDR-6320\n- also cleanup a leaking Statement from UserRegistry", "committedDate": "2020-11-11T15:03:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ1ODk3NQ==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521458975", "bodyText": "getJson is over 100 lines, way more than one screenful -- shorter methods with subroutines are more maintainable", "author": "btangmu", "createdAt": "2020-11-11T15:58:17Z", "path": "tools/cldr-apps/src/main/java/org/unicode/cldr/web/SurveyVettingParticipation.java", "diffHunk": "@@ -0,0 +1,175 @@\n+package org.unicode.cldr.web;\n+\n+import java.sql.Connection;\n+import java.sql.PreparedStatement;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+import java.util.HashSet;\n+import java.util.Hashtable;\n+import java.util.Iterator;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.TreeMap;\n+import java.util.TreeSet;\n+\n+import org.json.JSONArray;\n+import org.json.JSONException;\n+import org.json.JSONObject;\n+import org.unicode.cldr.util.CLDRLocale;\n+import org.unicode.cldr.util.StandardCodes;\n+import org.unicode.cldr.util.VoteResolver;\n+import org.unicode.cldr.web.SurveyAjax.JSONWriter;\n+import org.unicode.cldr.web.UserRegistry.User;\n+\n+\n+public class SurveyVettingParticipation {\n+    static final int STREET_STLEVEL = VoteResolver.Level.street.getSTLevel();\n+\n+    final private String org;\n+    final String missingLocalesForOrg;\n+    private SurveyMain sm;\n+    boolean showCodes = false;\n+\n+    public SurveyVettingParticipation(String org, SurveyMain sm) {\n+        this.sm = sm;\n+        this.org = org;\n+        this.missingLocalesForOrg = org; // TODO\n+    }\n+\n+    public void getJson(JSONWriter r) throws SQLException, JSONException {\n+       final StandardCodes sc = StandardCodes.make();", "originalCommit": "41c885dc2abd6efc34857c12b8161b6137db4df1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU3MzcyMA==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521573720", "bodyText": "done", "author": "srl295", "createdAt": "2020-11-11T19:00:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ1ODk3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ2MjQ4Mg==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521462482", "bodyText": "Hard to see what changed other than whitespace...", "author": "btangmu", "createdAt": "2020-11-11T16:03:32Z", "path": "tools/cldr-apps/src/main/webapp/js/CldrSurveyVettingLoader.js", "diffHunk": "@@ -641,141 +641,146 @@ function showV() {\n \t\t\t\t\tvar specialItems = new Array();\n \t\t\t\t\tif (surveyUser != null) {\n \t\t\t\t\t\tspecialItems = [{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Admin Panel',\n-\t\t\t\t\t\t\t\turl: surveyUserURL.adminPanel,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'My Account'\n-\t\t\t\t\t\t\t}, // My Account section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Settings',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.myAccountSetting,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Lock (Disable) My Account',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.disableMyAccount,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'My Votes'\n-\t\t\t\t\t\t\t}, // My Votes section\n+\t\t\t\t\t\t\tdivider: true", "originalCommit": "41c885dc2abd6efc34857c12b8161b6137db4df1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ2MzgzNA==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521463834", "bodyText": "is this block for vetting_participation the only non-whitespace change in this function?", "author": "btangmu", "createdAt": "2020-11-11T16:05:32Z", "path": "tools/cldr-apps/src/main/webapp/js/CldrSurveyVettingLoader.js", "diffHunk": "@@ -641,141 +641,146 @@ function showV() {\n \t\t\t\t\tvar specialItems = new Array();\n \t\t\t\t\tif (surveyUser != null) {\n \t\t\t\t\t\tspecialItems = [{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Admin Panel',\n-\t\t\t\t\t\t\t\turl: surveyUserURL.adminPanel,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'My Account'\n-\t\t\t\t\t\t\t}, // My Account section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Settings',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.myAccountSetting,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Lock (Disable) My Account',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.disableMyAccount,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'My Votes'\n-\t\t\t\t\t\t\t}, // My Votes section\n+\t\t\t\t\t\t\tdivider: true\n+\t\t\t\t\t\t},\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'Admin Panel',\n+\t\t\t\t\t\t\turl: surveyUserURL.adminPanel,\n+\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tdivider: true,\n+\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n+\t\t\t\t\t\t},\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'My Account'\n+\t\t\t\t\t\t}, // My Account section\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'Settings',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.myAccountSetting,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'Lock (Disable) My Account',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.disableMyAccount,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n+\t\t\t\t\t\t},\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tdivider: true\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'My Votes'\n+\t\t\t\t\t\t}, // My Votes section\n \n-\t\t\t\t\t\t\t/*\n-\t\t\t\t\t\t\t * This indirectly references \"special_oldvotes\" in stui.js\n-\t\t\t\t\t\t\t */\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'oldvotes',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanImportOldVotes\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'See My Recent Activity',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.recentActivity\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Upload XML',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.xmlUpload\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'My Organization(' + organizationName + ')'\n-\t\t\t\t\t\t\t}, // My Organization section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'vsummary', /* Cf. special_vsummary */\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanUseVettingSummary\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'List ' + org + ' Users',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.manageUser,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUserPerms.userIsTC || surveyUserPerms.userIsVetter)\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'forum_participation', /* Cf. special_forum_participation */\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanMonitorForum\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'LOCKED: Note: your account is currently locked.',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userIsLocked,\n-\t\t\t\t\t\t\t\tbold: true\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Forum'\n-\t\t\t\t\t\t\t}, // Forum section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'flagged',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\timg: surveyImgInfo.flag\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'mail',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: !surveyOfficial\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'bulk_close_posts', /* Cf. special_bulk_close_posts */\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Informational'\n-\t\t\t\t\t\t\t}, // Informational section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'statistics',\n-\t\t\t\t\t\t\t\tlevel: 2\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'About',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.about\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Lookup a code or xpath',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.browse,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.hasDataSource\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n+\t\t\t\t\t\t/*\n+\t\t\t\t\t\t * This indirectly references \"special_oldvotes\" in stui.js\n+\t\t\t\t\t\t */\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tspecial: 'oldvotes',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanImportOldVotes\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'See My Recent Activity',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.recentActivity\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'Upload XML',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.xmlUpload\n+\t\t\t\t\t\t},\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tdivider: true\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'My Organization(' + organizationName + ')'\n+\t\t\t\t\t\t}, // My Organization section\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tspecial: 'vsummary', /* Cf. special_vsummary */\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanUseVettingSummary\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'List ' + org + ' Users', // 'org' from ajax_status.jsp\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.manageUser,\n+\t\t\t\t\t\t\tdisplay: (surveyUserPerms.userIsTC || surveyUserPerms.userIsVetter)\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tspecial: 'forum_participation', /* Cf. special_forum_participation */\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanMonitorForum\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{", "originalCommit": "41c885dc2abd6efc34857c12b8161b6137db4df1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU3NTA2MA==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521575060", "bodyText": "I don't know what happened with the whitespace here. Can you hit the Gear and review with 'ignore whitespace'?", "author": "srl295", "createdAt": "2020-11-11T19:02:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ2MzgzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ2NDc1OQ==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521464759", "bodyText": "\"Vetting\" not \"Forum\"", "author": "btangmu", "createdAt": "2020-11-11T16:06:55Z", "path": "tools/cldr-apps/src/main/webapp/js/special/vetting_participation.js", "diffHunk": "@@ -0,0 +1,208 @@\n+'use strict';\n+\n+/**\n+ * Based on specials/forum.js\n+ *\n+ * TODO: use modern JavaScript -- import/export, not define\n+ * TODO: avoid dependencies on legacy code\n+ * TODO: put code for progress bar, etc., in a shared module, share with, e.g., vsummary.js\n+ */\n+define(\"js/special/vetting_participation.js\", [\"js/special/SpecialPage.js\"], function(SpecialPage) {\n+\tvar _super;\n+\t\n+\t'use strict';\n+\n+\tconst tableId = \"vettingParticipationTable\";\n+\tconst fileName = \"vettingParticipation.csv\";\n+\tconst onclick = \"cldrStCsvFromTable.downloadCsv(\"\n+\t\t+ \"\\\"\" + tableId + \"\\\"\"\n+\t\t+ \", \"\n+\t\t+ \"\\\"\" + fileName + \"\\\"\"\n+\t\t+ \")\";\n+\n+\n+\n+\tfunction Page() {\n+\t\t// constructor\n+\t}\n+\t\n+\t/**\n+\t * Fetch the Forum Participation data from the server, and \"load\" it", "originalCommit": "41c885dc2abd6efc34857c12b8161b6137db4df1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ2NzE5NQ==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521467195", "bodyText": "show() is over 100 lines, way more than one screenful -- could improve with subroutines", "author": "btangmu", "createdAt": "2020-11-11T16:10:26Z", "path": "tools/cldr-apps/src/main/webapp/js/special/vetting_participation.js", "diffHunk": "@@ -0,0 +1,208 @@\n+'use strict';\n+\n+/**\n+ * Based on specials/forum.js\n+ *\n+ * TODO: use modern JavaScript -- import/export, not define\n+ * TODO: avoid dependencies on legacy code\n+ * TODO: put code for progress bar, etc., in a shared module, share with, e.g., vsummary.js\n+ */\n+define(\"js/special/vetting_participation.js\", [\"js/special/SpecialPage.js\"], function(SpecialPage) {\n+\tvar _super;\n+\t\n+\t'use strict';\n+\n+\tconst tableId = \"vettingParticipationTable\";\n+\tconst fileName = \"vettingParticipation.csv\";\n+\tconst onclick = \"cldrStCsvFromTable.downloadCsv(\"\n+\t\t+ \"\\\"\" + tableId + \"\\\"\"\n+\t\t+ \", \"\n+\t\t+ \"\\\"\" + fileName + \"\\\"\"\n+\t\t+ \")\";\n+\n+\n+\n+\tfunction Page() {\n+\t\t// constructor\n+\t}\n+\t\n+\t/**\n+\t * Fetch the Forum Participation data from the server, and \"load\" it\n+\t *\n+\t * @param params an object with various properties; see SpecialPage.js\n+\t */\n+\tfunction show(params) {", "originalCommit": "41c885dc2abd6efc34857c12b8161b6137db4df1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU3NTM5Ng==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521575396", "bodyText": "fixed", "author": "srl295", "createdAt": "2020-11-11T19:03:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ2NzE5NQ=="}], "type": "inlineReview"}, {"oid": "5a53e2d2d5baa1e4cad4ef0e452edc25d49f0058", "url": "https://github.com/unicode-org/cldr/commit/5a53e2d2d5baa1e4cad4ef0e452edc25d49f0058", "message": "CLDR-14268 improve vetting participation page\n\n- major rewrite of 'vetting participation' to a speedy query + new UI (non JSP)\n- also fix Utilka CLDR-6320\n- also cleanup a leaking Statement from UserRegistry", "committedDate": "2020-11-11T18:59:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU3NTI4NQ==", "url": "https://github.com/unicode-org/cldr/pull/838#discussion_r521575285", "bodyText": "undefined was being interpreted as true (probably comparing to ! == false", "author": "srl295", "createdAt": "2020-11-11T19:03:22Z", "path": "tools/cldr-apps/src/main/webapp/js/CldrSurveyVettingLoader.js", "diffHunk": "@@ -641,141 +641,146 @@ function showV() {\n \t\t\t\t\tvar specialItems = new Array();\n \t\t\t\t\tif (surveyUser != null) {\n \t\t\t\t\t\tspecialItems = [{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Admin Panel',\n-\t\t\t\t\t\t\t\turl: surveyUserURL.adminPanel,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'My Account'\n-\t\t\t\t\t\t\t}, // My Account section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Settings',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.myAccountSetting,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Lock (Disable) My Account',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.disableMyAccount,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'My Votes'\n-\t\t\t\t\t\t\t}, // My Votes section\n+\t\t\t\t\t\t\tdivider: true\n+\t\t\t\t\t\t},\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'Admin Panel',\n+\t\t\t\t\t\t\turl: surveyUserURL.adminPanel,\n+\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tdivider: true,\n+\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n+\t\t\t\t\t\t},\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'My Account'\n+\t\t\t\t\t\t}, // My Account section\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'Settings',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.myAccountSetting,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'Lock (Disable) My Account',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.disableMyAccount,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userExist\n+\t\t\t\t\t\t},\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tdivider: true\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'My Votes'\n+\t\t\t\t\t\t}, // My Votes section\n \n-\t\t\t\t\t\t\t/*\n-\t\t\t\t\t\t\t * This indirectly references \"special_oldvotes\" in stui.js\n-\t\t\t\t\t\t\t */\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'oldvotes',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanImportOldVotes\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'See My Recent Activity',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.recentActivity\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Upload XML',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.xmlUpload\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'My Organization(' + organizationName + ')'\n-\t\t\t\t\t\t\t}, // My Organization section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'vsummary', /* Cf. special_vsummary */\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanUseVettingSummary\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'List ' + org + ' Users',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.manageUser,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUserPerms.userIsTC || surveyUserPerms.userIsVetter)\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'forum_participation', /* Cf. special_forum_participation */\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanMonitorForum\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'LOCKED: Note: your account is currently locked.',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.userIsLocked,\n-\t\t\t\t\t\t\t\tbold: true\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Forum'\n-\t\t\t\t\t\t\t}, // Forum section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'flagged',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\timg: surveyImgInfo.flag\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'mail',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: !surveyOfficial\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'bulk_close_posts', /* Cf. special_bulk_close_posts */\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\tdisplay: (surveyUser && surveyUser.userlevelName === 'ADMIN')\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Informational'\n-\t\t\t\t\t\t\t}, // Informational section\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tspecial: 'statistics',\n-\t\t\t\t\t\t\t\tlevel: 2\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'About',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.about\n-\t\t\t\t\t\t\t},\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\ttitle: 'Lookup a code or xpath',\n-\t\t\t\t\t\t\t\tlevel: 2,\n-\t\t\t\t\t\t\t\turl: surveyUserURL.browse,\n-\t\t\t\t\t\t\t\tdisplay: surveyUserPerms.hasDataSource\n-\t\t\t\t\t\t\t},\n-\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\tdivider: true\n-\t\t\t\t\t\t\t},\n+\t\t\t\t\t\t/*\n+\t\t\t\t\t\t * This indirectly references \"special_oldvotes\" in stui.js\n+\t\t\t\t\t\t */\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tspecial: 'oldvotes',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanImportOldVotes\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'See My Recent Activity',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.recentActivity\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'Upload XML',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.xmlUpload\n+\t\t\t\t\t\t},\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tdivider: true\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'My Organization(' + organizationName + ')'\n+\t\t\t\t\t\t}, // My Organization section\n+\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tspecial: 'vsummary', /* Cf. special_vsummary */\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanUseVettingSummary\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'List ' + org + ' Users', // 'org' from ajax_status.jsp\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\turl: surveyUserURL.manageUser,\n+\t\t\t\t\t\t\tdisplay: (surveyUserPerms.userIsTC || surveyUserPerms.userIsVetter)\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tspecial: 'forum_participation', /* Cf. special_forum_participation */\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userCanMonitorForum\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tspecial: 'vetting_participation', /* Cf. special_vetting_participation */\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\tdisplay: surveyUserPerms.userIsTC || surveyUserPerms.userIsVetter\n+\t\t\t\t\t\t},\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\ttitle: 'LOCKED: Note: your account is currently locked.',\n+\t\t\t\t\t\t\tlevel: 2,\n+\t\t\t\t\t\t\tdisplay: (surveyUserPerms.userIsLocked || false),", "originalCommit": "5a53e2d2d5baa1e4cad4ef0e452edc25d49f0058", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b19105ad0d1b09506f6e6a8cd4f592e83b9b21b2", "url": "https://github.com/unicode-org/cldr/commit/b19105ad0d1b09506f6e6a8cd4f592e83b9b21b2", "message": "CLDR-14268 improve vetting participation page\n\n- major rewrite of 'vetting participation' to a speedy query + new UI (non JSP)\n- also fix Utilka CLDR-6320\n- also cleanup a leaking Statement from UserRegistry", "committedDate": "2020-11-11T20:48:52Z", "type": "commit"}, {"oid": "b19105ad0d1b09506f6e6a8cd4f592e83b9b21b2", "url": "https://github.com/unicode-org/cldr/commit/b19105ad0d1b09506f6e6a8cd4f592e83b9b21b2", "message": "CLDR-14268 improve vetting participation page\n\n- major rewrite of 'vetting participation' to a speedy query + new UI (non JSP)\n- also fix Utilka CLDR-6320\n- also cleanup a leaking Statement from UserRegistry", "committedDate": "2020-11-11T20:48:52Z", "type": "forcePushed"}]}