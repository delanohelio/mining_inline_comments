{"pr_number": 822, "pr_title": "CLDR-14212 finalize move to Maven", "pr_createdAt": "2020-11-02T17:26:47Z", "pr_url": "https://github.com/unicode-org/cldr/pull/822", "timeline": [{"oid": "80805b86204a3b0e66886c5af81b299a05de0636", "url": "https://github.com/unicode-org/cldr/commit/80805b86204a3b0e66886c5af81b299a05de0636", "message": "CLDR-14212 final maven move\n\n- get rid of ant build files, .classpath, .project, .settings\n- for Eclipse, all of these are synthesized from maven (and .gitignored)\n\nSome TODOs around testing flow, push to production, etc.", "committedDate": "2020-11-02T17:24:49Z", "type": "forcePushed"}, {"oid": "844f8d492bb16935268065a986d3e61fc10f4727", "url": "https://github.com/unicode-org/cldr/commit/844f8d492bb16935268065a986d3e61fc10f4727", "message": "CLDR-14212 final maven move\n\n- get rid of ant build files, .classpath, .project, .settings\n- for Eclipse, all of these are synthesized from maven (and .gitignored)\n- CLDR no longer requires git-lfs\n- deploy and consolecheck are now a part of the maven build\n- cldr-tools (cldr.jar) and cldr-apps (cldr-apps.war) artifacts are generated on each build", "committedDate": "2020-11-02T20:01:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzk2OA==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516223968", "bodyText": "disabling these for now so that no new files are added to lfs.", "author": "srl295", "createdAt": "2020-11-02T20:04:56Z", "path": ".gitattributes", "diffHunk": "@@ -1,5 +1,5 @@\n-*.jar filter=lfs diff=lfs merge=lfs -text\n-*.dat filter=lfs diff=lfs merge=lfs -text\n-*.zip filter=lfs diff=lfs merge=lfs -text\n-*.gz filter=lfs diff=lfs merge=lfs -text\n-*.bz2 filter=lfs diff=lfs merge=lfs -text\n+# *.jar filter=lfs diff=lfs merge=lfs -text", "originalCommit": "844f8d492bb16935268065a986d3e61fc10f4727", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk1MDQyMA==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516950420", "bodyText": "\"for now\" -- and how will it be in the long term?", "author": "btangmu", "createdAt": "2020-11-03T20:56:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzk2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk1MjU0NQ==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516952545", "bodyText": "If we no longer need lfs, how about deleting rather than commenting out?", "author": "btangmu", "createdAt": "2020-11-03T21:00:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzk2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk5MjEzNQ==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516992135", "bodyText": "sure, I will just delete it.", "author": "srl295", "createdAt": "2020-11-03T22:27:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzk2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAwNjA5NQ==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r517006095", "bodyText": "[x] push to production needs to move from ant to maven\n\ndone", "author": "srl295", "createdAt": "2020-11-03T23:02:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjIyMzk2OA=="}], "type": "inlineReview"}, {"oid": "382bfad94d4b21be7b6e3a935dfc40b94d1da533", "url": "https://github.com/unicode-org/cldr/commit/382bfad94d4b21be7b6e3a935dfc40b94d1da533", "message": "CLDR-14212 final maven move\n\n- get rid of ant build files, .classpath, .project, but keep .settings\n- for Eclipse, all of these are synthesized from maven (and .gitignored)\n- CLDR no longer requires git-lfs\n- deploy and consolecheck are now a part of the maven build\n- cldr-tools (cldr.jar) and cldr-apps (cldr-apps.war) artifacts are generated on each build", "committedDate": "2020-11-02T20:33:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0NzMzNg==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516947336", "bodyText": "How will this dependency on the version -- here 39.0 -- be handled? Is this set within the Eclipse interface, or ...?", "author": "btangmu", "createdAt": "2020-11-03T20:50:06Z", "path": "tools/cldr-apps/.settings/org.eclipse.wst.common.component", "diffHunk": "@@ -1,35 +1,48 @@\n <?xml version=\"1.0\" encoding=\"UTF-8\"?><project-modules id=\"moduleCoreId\" project-version=\"1.5.0\">\n-            \n+                \n+    \n     \n     <wb-module deploy-name=\"cldr-apps\">\n-                        \n+        <wb-resource deploy-path=\"/\" source-path=\"/target/m2e-wtp/web-resources\"/>\n+                                \n+        \n+        \n+        <wb-resource deploy-path=\"/\" source-path=\"/src/main/webapp\" tag=\"defaultRootSource\"/>\n+                                \n         \n-        <wb-resource deploy-path=\"/\" source-path=\"/src/main/webapp\"/>\n-                        \n         \n         <wb-resource deploy-path=\"/WEB-INF/lib\" source-path=\"/WebContent/WEB-INF/lib\"/>\n-                 \n+                         \n+        \n         \n         <!-- needed?\u00a0-->\n-                        \n+                                \n+        \n         \n         <wb-resource deploy-path=\"/WEB-INF/classes\" source-path=\"/src/main/java\"/>\n-                        \n+                                \n+        \n         \n         <wb-resource deploy-path=\"/WEB-INF/classes\" source-path=\"/.apt_generated\"/>\n                 \n-        <wb-resource deploy-path=\"/WEB-INF/classes\" source-path=\"/src/test/java\"/>\n-        <wb-resource deploy-path=\"/WEB-INF/classes\" source-path=\"/src/test/resources\"/>\n         <wb-resource deploy-path=\"/WEB-INF/classes\" source-path=\"/src/main/resources\"/>\n-                        \n+        <wb-resource deploy-path=\"/WEB-INF/classes\" source-path=\"/.apt_generated_tests\"/>\n+        <dependent-module archiveName=\"cldr-39.0-SNAPSHOT.jar\" deploy-path=\"/WEB-INF/lib\" handle=\"module:/resource/cldr/cldr\">", "originalCommit": "382bfad94d4b21be7b6e3a935dfc40b94d1da533", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk5MjM2Nw==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516992367", "bodyText": "this should get automatically updated by eclipse.", "author": "srl295", "createdAt": "2020-11-03T22:27:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0NzMzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0ODAyNQ==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516948025", "bodyText": "How does the versioning work?", "author": "btangmu", "createdAt": "2020-11-03T20:51:29Z", "path": "tools/cldr-apps/pom.xml", "diffHunk": "@@ -18,7 +18,7 @@\n \t<parent>\n \t\t<groupId>org.unicode.cldr</groupId>\n \t\t<artifactId>cldr-all</artifactId>\n-\t\t<version>38.0-SNAPSHOT</version>\n+\t\t<version>39.0-SNAPSHOT</version>", "originalCommit": "382bfad94d4b21be7b6e3a935dfc40b94d1da533", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk4NjEwMw==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516986103", "bodyText": "Use of maven release plugin to drop snapshot, tag and bump a version is a popular way to do this.\nAlternatively, we may have parent pom to manage single version across modules.", "author": "yumaoka", "createdAt": "2020-11-03T22:13:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0ODAyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk5MzEyMA==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516993120", "bodyText": "you can't have a single version in the parent AND use the version for submodules to find the parent.\n[ERROR] [ERROR] Some problems were encountered while processing the POMs:\n[FATAL] 'parent.version' is missing. @ line 22, column 10\n[FATAL] 'parent.version' is missing. @ line 18, column 10", "author": "srl295", "createdAt": "2020-11-03T22:29:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0ODAyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk5MzQ5Mw==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516993493", "bodyText": "I think we can just bump the version whenever a new release is cut .  actually, when the maint branch is cut it can be manually updated.", "author": "srl295", "createdAt": "2020-11-03T22:30:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0ODAyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0OTY0NQ==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516949645", "bodyText": "What is this about: project-version=\"1.5.0\"?", "author": "btangmu", "createdAt": "2020-11-03T20:54:52Z", "path": "tools/java/.settings/org.eclipse.wst.common.component", "diffHunk": "@@ -0,0 +1,6 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?><project-modules id=\"moduleCoreId\" project-version=\"1.5.0\">", "originalCommit": "382bfad94d4b21be7b6e3a935dfc40b94d1da533", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk4NzE3MQ==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516987171", "bodyText": "It's managed by Eclipse. This is automatically generated file, so I think we don't need to worry about version much.", "author": "yumaoka", "createdAt": "2020-11-03T22:15:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0OTY0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk5NDE2Mw==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516994163", "bodyText": "Looks good to me.\nOne comment - do we want to use \"java\" as component folder name? I prefer to use folder name matching artifact ID.\n\nYes, I'd like to rename it, maybe cldr-utils? Not sure.", "author": "srl295", "createdAt": "2020-11-03T22:31:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0OTY0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk1MTI1Mw==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516951253", "bodyText": "How is this triggered and how does it relate to other ways of deployment?", "author": "btangmu", "createdAt": "2020-11-03T20:57:58Z", "path": ".github/workflows/maven.yml", "diffHunk": "@@ -51,4 +64,50 @@ jobs:\n           '-Dorg.unicode.cldr.unittest.web.KeepDb=true'\n         env:\n           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n-\n+  check:\n+    needs: build\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v2\n+        with:\n+          lfs: false\n+      - name: Set up JDK 1.8\n+        uses: actions/setup-java@v1\n+        with:\n+          java-version: 1.8\n+      - name: Download cldr.jar\n+        uses: actions/download-artifact@v2\n+        with:\n+          name: cldr-tools\n+          path: tools/java/target/\n+      - name: run CLDR console check\n+        run: java -DCLDR_DIR=$(pwd) -jar tools/java/target/cldr.jar check -S common,seed -e -z FINAL_TESTING \n+  deploy:\n+    if: github.repository == 'unicode-org/cldr' && github.event_name == 'push' && github.ref == 'refs/heads/master'\n+    needs:\n+      - build\n+      - check\n+    runs-on: ubuntu-latest\n+    steps:\n+    - name: Download cldr-apps.war\n+      uses: actions/download-artifact@v2\n+      with:\n+        name: cldr-apps\n+    - name: Deploy to cldr-smoke (experimental)", "originalCommit": "382bfad94d4b21be7b6e3a935dfc40b94d1da533", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk5Mzk3NQ==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516993975", "bodyText": "This is the deploy to smoketest on merge that currently is done with ant.  It's triggered the same way.", "author": "srl295", "createdAt": "2020-11-03T22:31:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk1MTI1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk4MzY2Mw==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516983663", "bodyText": "Eclipse insert extra blank lines when a configuration file is updated. This is probably a bug in Eclipse. You may get rid of these unnecessary blank lines inserted automatically.", "author": "yumaoka", "createdAt": "2020-11-03T22:07:27Z", "path": "tools/cldr-apps/.settings/org.eclipse.wst.common.component", "diffHunk": "@@ -1,35 +1,48 @@\n <?xml version=\"1.0\" encoding=\"UTF-8\"?><project-modules id=\"moduleCoreId\" project-version=\"1.5.0\">\n-            \n+                ", "originalCommit": "382bfad94d4b21be7b6e3a935dfc40b94d1da533", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk5NDM2OQ==", "url": "https://github.com/unicode-org/cldr/pull/822#discussion_r516994369", "bodyText": "yeah. I was going to ignore these files originally, but I think we should just let them get updated\u2026", "author": "srl295", "createdAt": "2020-11-03T22:32:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk4MzY2Mw=="}], "type": "inlineReview"}, {"oid": "7813cc8c6195b3fe2fb4c95b9f5b03bcabc19856", "url": "https://github.com/unicode-org/cldr/commit/7813cc8c6195b3fe2fb4c95b9f5b03bcabc19856", "message": "CLDR-14212 final maven move\n\n- get rid of ant build files, .classpath, .project, but keep .settings\n- for Eclipse, all of these are synthesized from maven (and .gitignored)\n- CLDR no longer requires git-lfs\n- deploy and consolecheck are now a part of the maven build\n- cldr-tools (cldr.jar) and cldr-apps (cldr-apps.war) artifacts are generated on each build", "committedDate": "2020-11-03T22:34:47Z", "type": "forcePushed"}, {"oid": "c77b5b53df3510e33308616b279e4d3e022edfbc", "url": "https://github.com/unicode-org/cldr/commit/c77b5b53df3510e33308616b279e4d3e022edfbc", "message": "CLDR-14212 final maven move\n\n- get rid of ant build files, .classpath, .project, but keep .settings\n- for Eclipse, all of these are synthesized from maven (and .gitignored)\n- CLDR no longer requires git-lfs, removed .gitattributes\n- deploy and consolecheck are now a part of the maven build\n- cldr-tools (cldr.jar) and cldr-apps (cldr-apps.war) artifacts are generated on each build\n- updated push to production", "committedDate": "2020-11-03T22:42:47Z", "type": "forcePushed"}, {"oid": "bff1be0a8f66346a2b5f75e02175585155aa721f", "url": "https://github.com/unicode-org/cldr/commit/bff1be0a8f66346a2b5f75e02175585155aa721f", "message": "CLDR-14212 final maven move\n\n- get rid of ant build files, .classpath, .project, but keep .settings\n- for Eclipse, all of these are synthesized from maven (and .gitignored)\n- CLDR no longer requires git-lfs, removed .gitattributes\n- deploy and consolecheck are now a part of the maven build\n- cldr-tools (cldr.jar) and cldr-apps (cldr-apps.war) artifacts are generated on each build\n- updated push to production", "committedDate": "2020-11-03T22:45:21Z", "type": "forcePushed"}, {"oid": "d38b71f3fb4c79598678e02320a4eda415efbbcd", "url": "https://github.com/unicode-org/cldr/commit/d38b71f3fb4c79598678e02320a4eda415efbbcd", "message": "CLDR-14212 final maven move\n\n- get rid of ant build files, .classpath, .project, but keep .settings\n- for Eclipse, all of these are synthesized from maven (and .gitignored)\n- CLDR no longer requires git-lfs, removed .gitattributes\n- deploy and consolecheck are now a part of the maven build\n- cldr-tools (cldr.jar) and cldr-apps (cldr-apps.war) artifacts are generated on each build\n- updated push to production", "committedDate": "2020-11-03T22:52:09Z", "type": "commit"}, {"oid": "d38b71f3fb4c79598678e02320a4eda415efbbcd", "url": "https://github.com/unicode-org/cldr/commit/d38b71f3fb4c79598678e02320a4eda415efbbcd", "message": "CLDR-14212 final maven move\n\n- get rid of ant build files, .classpath, .project, but keep .settings\n- for Eclipse, all of these are synthesized from maven (and .gitignored)\n- CLDR no longer requires git-lfs, removed .gitattributes\n- deploy and consolecheck are now a part of the maven build\n- cldr-tools (cldr.jar) and cldr-apps (cldr-apps.war) artifacts are generated on each build\n- updated push to production", "committedDate": "2020-11-03T22:52:09Z", "type": "forcePushed"}]}