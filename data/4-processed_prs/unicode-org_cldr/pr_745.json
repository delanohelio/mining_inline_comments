{"pr_number": 745, "pr_title": "CLDR-11585 maven: single jar assembly, mysql, cleanup", "pr_createdAt": "2020-09-29T00:10:09Z", "pr_url": "https://github.com/unicode-org/cldr/pull/745", "timeline": [{"oid": "804ed4681ebc22b4a0a1d9141c56211b0c131c40", "url": "https://github.com/unicode-org/cldr/commit/804ed4681ebc22b4a0a1d9141c56211b0c131c40", "message": "CLDR-11585 maven: single jar assembly, mysql, cleanup\n\n- create an uber-jar for cldr.jar with:\n\n    mvn -pl java package assembly:single -DskipTests=true\n\n- fix a comment in TestShim.java (missed in #741)\n\n- run Maven test against MySQL\n(this is an update to CLDR-8383 CI against mysql (#705) and\ncorrects 6adc82b6b6116bb67e046ec129adb66f4aa6aac4 which introduced\nMaven CI against Derby)\n\n- Move more pluginDependencies up from cldr-apps/pom.xml to tools/pom.xml\n\nNo plugin versions are specified in sub-poms now.", "committedDate": "2020-09-29T00:06:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4NTc4Ng==", "url": "https://github.com/unicode-org/cldr/pull/745#discussion_r496885786", "bodyText": "What's VbrB3LFCr6A!\n?", "author": "btangmu", "createdAt": "2020-09-29T16:41:45Z", "path": ".github/workflows/maven.yml", "diffHunk": "@@ -27,11 +27,21 @@ jobs:\n           restore-keys: |\n             ${{ runner.os }}-maven-\n       - name: Build with Maven\n-        run: mvn -s .github/workflows/mvn-settings.xml -B package --file tools/pom.xml -DskipTests=true\n+        run: >\n+          mvn -s .github/workflows/mvn-settings.xml -B package --file tools/pom.xml\n+          -DskipTests=true\n         env:\n           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n+      - name: Setup MySQL\n+        run: |\n+          sudo systemctl start mysql.service\n+          sleep 3\n+          mysql --user=root --password=root < tools/cldr-apps/test-setup.sql\n       - name: Test with maven\n-        run: mvn -s .github/workflows/mvn-settings.xml -B test --file tools/pom.xml\n+        run: >\n+          mvn -s .github/workflows/mvn-settings.xml -B test --file tools/pom.xml\n+          '-Dorg.unicode.cldr.unittest.web.jdbcurl=jdbc:mysql://cldrtest:VbrB3LFCr6A!@localhost/cldrtest?useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=UTC'", "originalCommit": "804ed4681ebc22b4a0a1d9141c56211b0c131c40", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg5MDMyNQ==", "url": "https://github.com/unicode-org/cldr/pull/745#discussion_r496890325", "bodyText": "I see now it's in test-setup.sql. Is there any security risk in having that in git? And, could we define it once and name it, rather than repeating it in these two files?", "author": "btangmu", "createdAt": "2020-09-29T16:48:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4NTc4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg5MTc3MA==", "url": "https://github.com/unicode-org/cldr/pull/745#discussion_r496891770", "bodyText": "@btangmu There isn't a risk, because that user is only setup within the git envinronment.", "author": "srl295", "createdAt": "2020-09-29T16:50:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4NTc4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg5Mjk5NA==", "url": "https://github.com/unicode-org/cldr/pull/745#discussion_r496892994", "bodyText": "@btangmu I captured your comment in https://unicode-org.atlassian.net/browse/CLDR-8383 - can we merge this (not a regressin in this respect) and fix in the future?)", "author": "srl295", "createdAt": "2020-09-29T16:52:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4NTc4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg5NDA2OQ==", "url": "https://github.com/unicode-org/cldr/pull/745#discussion_r496894069", "bodyText": "Here it's version 3.2.2, while in cldr-apps/pom.xml the version is removed above. Why the difference? In general if version is omitted would we get the most recent?", "author": "btangmu", "createdAt": "2020-09-29T16:54:22Z", "path": "tools/pom.xml", "diffHunk": "@@ -237,6 +236,10 @@\n \t\t\t\t\t<artifactId>maven-jar-plugin</artifactId>\n \t\t\t\t\t<version>3.0.2</version>\n \t\t\t\t</plugin>\n+\t\t\t\t<plugin>\n+\t\t\t\t\t<artifactId>maven-war-plugin</artifactId>\n+\t\t\t\t\t<version>3.2.2</version>", "originalCommit": "804ed4681ebc22b4a0a1d9141c56211b0c131c40", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg5NDU4Ng==", "url": "https://github.com/unicode-org/cldr/pull/745#discussion_r496894586", "bodyText": "cldr-apps is a child and inherits from the parent.  this way we only have one place to maintain all the version numbers", "author": "srl295", "createdAt": "2020-09-29T16:55:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg5NDA2OQ=="}], "type": "inlineReview"}]}