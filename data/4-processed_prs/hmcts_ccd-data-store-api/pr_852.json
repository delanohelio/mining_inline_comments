{"pr_number": 852, "pr_title": "Assign Jurisdiction Functional Tests", "pr_createdAt": "2020-03-19T14:28:45Z", "pr_url": "https://github.com/hmcts/ccd-data-store-api/pull/852", "timeline": [{"oid": "55f329e8b3016d3fcb41171f4fd268715dd2c093", "url": "https://github.com/hmcts/ccd-data-store-api/commit/55f329e8b3016d3fcb41171f4fd268715dd2c093", "message": "RDM-7162: Automate Jurisdiction assignment \u2013 tactical solution\n\n    \u00a0\u00a0[RDM-7162] (https://tools.hmcts.net/jira/browse/RDM-7162).", "committedDate": "2020-02-18T14:47:56Z", "type": "commit"}, {"oid": "38f18e5774f32a88e52b4fa1e5001d3498d327a3", "url": "https://github.com/hmcts/ccd-data-store-api/commit/38f18e5774f32a88e52b4fa1e5001d3498d327a3", "message": "Merge branch 'develop' of https://github.com/hmcts/ccd-data-store-api into RDM-7162", "committedDate": "2020-02-18T14:48:32Z", "type": "commit"}, {"oid": "1362733ac7f52c9305de6d64257609a66b4d231c", "url": "https://github.com/hmcts/ccd-data-store-api/commit/1362733ac7f52c9305de6d64257609a66b4d231c", "message": "RDM-7416: CCD throws NoHttpResponse when calling available services.\n\n    \u00a0\u00a0[RDM-7416] (https://tools.hmcts.net/jira/browse/RDM-7416).", "committedDate": "2020-02-20T12:43:36Z", "type": "commit"}, {"oid": "9b3c829bfc5d9b630b251fc69a55c56ffb3e67cd", "url": "https://github.com/hmcts/ccd-data-store-api/commit/9b3c829bfc5d9b630b251fc69a55c56ffb3e67cd", "message": "RDM-7162: Automate Jurisdiction assignment \u2013 tactical solution\n\n    \u00a0\u00a0[RDM-7162] (https://tools.hmcts.net/jira/browse/RDM-7162).", "committedDate": "2020-02-21T11:57:02Z", "type": "commit"}, {"oid": "99b4400320f563da22905c418cf03b373307a8e6", "url": "https://github.com/hmcts/ccd-data-store-api/commit/99b4400320f563da22905c418cf03b373307a8e6", "message": "RDM-7162: Automate Jurisdiction assignment \u2013 tactical solution", "committedDate": "2020-02-25T14:33:53Z", "type": "commit"}, {"oid": "fe06fce9e123154f90e519c7ff9f8d0de627ec3b", "url": "https://github.com/hmcts/ccd-data-store-api/commit/fe06fce9e123154f90e519c7ff9f8d0de627ec3b", "message": "Merge branch 'develop' into RDM-7162", "committedDate": "2020-03-02T15:15:09Z", "type": "commit"}, {"oid": "1d1d70518c9899174cf6e61393e6ab3953149f9e", "url": "https://github.com/hmcts/ccd-data-store-api/commit/1d1d70518c9899174cf6e61393e6ab3953149f9e", "message": "Merge branch 'develop' into RDM-7162", "committedDate": "2020-03-10T06:21:56Z", "type": "commit"}, {"oid": "edb6ee43c9353ebf9c78cf44c185edf0e606ca89", "url": "https://github.com/hmcts/ccd-data-store-api/commit/edb6ee43c9353ebf9c78cf44c185edf0e606ca89", "message": "RDM-7162: Automate Jurisdiction assignment \u2013 tactical solution\nFixed UserProfile throwing exception when user doesn't exist on ccd", "committedDate": "2020-03-11T19:57:15Z", "type": "commit"}, {"oid": "818e62a67fb1b661f11abf453b908a33425c4995", "url": "https://github.com/hmcts/ccd-data-store-api/commit/818e62a67fb1b661f11abf453b908a33425c4995", "message": "RDM-7162: fixed failing test cases", "committedDate": "2020-03-11T22:55:10Z", "type": "commit"}, {"oid": "962e02631c27ce4559d8e5c7a8d87d5f1b665337", "url": "https://github.com/hmcts/ccd-data-store-api/commit/962e02631c27ce4559d8e5c7a8d87d5f1b665337", "message": "RDM-7162: Changed exception handling logic", "committedDate": "2020-03-12T12:36:07Z", "type": "commit"}, {"oid": "3bbcecbe84305d7a54968728b3cd4c13d1136020", "url": "https://github.com/hmcts/ccd-data-store-api/commit/3bbcecbe84305d7a54968728b3cd4c13d1136020", "message": "RDM-7162: fixed checkstyle issues (unused imports)", "committedDate": "2020-03-13T09:15:47Z", "type": "commit"}, {"oid": "5e441a9a629eaa1dfa02d6d8cfc215a2831e2297", "url": "https://github.com/hmcts/ccd-data-store-api/commit/5e441a9a629eaa1dfa02d6d8cfc215a2831e2297", "message": "Merge branch 'develop' into RDM-7162", "committedDate": "2020-03-13T13:32:15Z", "type": "commit"}, {"oid": "37a30b672a70373c1be6e840ccdabea54fc19aba", "url": "https://github.com/hmcts/ccd-data-store-api/commit/37a30b672a70373c1be6e840ccdabea54fc19aba", "message": "Merge branch 'RDM-7162' of git@github.com:hmcts/ccd-data-store-api.git into RDM-7162", "committedDate": "2020-03-13T13:32:22Z", "type": "commit"}, {"oid": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "url": "https://github.com/hmcts/ccd-data-store-api/commit/109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "message": "assign jurisdiction functional tests added", "committedDate": "2020-03-19T14:08:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTE2NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161164", "bodyText": "This shouldn't be ANYTHING_PRESENT. We can know what to expect for this attribute in the response, and it is the same env variable as what we used for the request.", "author": "MSancaktutar", "createdAt": "2020-03-22T23:39:07Z", "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",\n+          \"email\": \"[[ANYTHING_PRESENT]]\",", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTE5NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161194", "bodyText": "This shouldn't be ANYTHING_PRESENT. We can know what to expect for this attribute in the response, and it is the same uid as what we used for the request.", "author": "MSancaktutar", "createdAt": "2020-03-22T23:39:30Z", "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc1NDYzOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r397754638", "bodyText": "${[scenarioContext][theInvokingUser][id]}", "author": "MSancaktutar", "createdAt": "2020-03-25T10:36:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTE5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTI5MQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161291", "bodyText": "These should also be consistent predefined values we can specifically expect in the response.", "author": "MSancaktutar", "createdAt": "2020-03-22T23:40:35Z", "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",\n+          \"email\": \"[[ANYTHING_PRESENT]]\",\n+          \"forename\": \"[[ANYTHING_PRESENT]]\",\n+          \"surname\": \"[[ANYTHING_PRESENT]]\",", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTMxOA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161318", "bodyText": "same as above", "author": "MSancaktutar", "createdAt": "2020-03-22T23:40:48Z", "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",\n+          \"email\": \"[[ANYTHING_PRESENT]]\",\n+          \"forename\": \"[[ANYTHING_PRESENT]]\",\n+          \"surname\": \"[[ANYTHING_PRESENT]]\",\n+          \"roles\": \"[[ANYTHING_PRESENT]]\",", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTM5NA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161394", "bodyText": "casetypes under BEFTA_JURISDICTION_1 are predefined. Please expressly list them as expected.", "author": "MSancaktutar", "createdAt": "2020-03-22T23:41:35Z", "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"[[ANYTHING_PRESENT]]\",\n+          \"email\": \"[[ANYTHING_PRESENT]]\",\n+          \"forename\": \"[[ANYTHING_PRESENT]]\",\n+          \"surname\": \"[[ANYTHING_PRESENT]]\",\n+          \"roles\": \"[[ANYTHING_PRESENT]]\",\n+          \"defaultService\": null\n+        }\n+      },\n+      \"channels\": null,\n+      \"jurisdictions\": [\n+        {\n+          \"id\": \"BEFTA_JURISDICTION_1\",\n+          \"name\": \"BEFTA_JURISDICTION_1\",\n+          \"description\": \"Content for the Test Jurisdiction.\",\n+          \"caseTypes\": \"[[ANYTHING_PRESENT]]\"", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTc4MQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396161781", "bodyText": "This is a potential breaking change and should be checked if there is any consumer of this operation relying on the previous behaviour.", "author": "MSancaktutar", "createdAt": "2020-03-22T23:45:42Z", "path": "src/aat/resources/features/F-051/F-051.feature", "diffHunk": "@@ -16,13 +16,12 @@ Background:\n \n \n   @S-109\n-  Scenario: must return appropriate negative response for a user not having a profile in CCD\n+  Scenario: must return appropriate user setting from idam role for a user not having a profile in CCD\n     Given a user with [no profile in CCD]\n     When a request is prepared with appropriate values\n-    And the request [uses a Case ID that doesn\u2019t exist in CCD]\n     And it is submitted to call the [Get default settings for user] operation of [CCD Data Store]\n-    Then a negative response is received\n-    And the response [has the 403 return code]\n+    Then a positive response is received\n+    And the response [has the 200 return code]", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjAzOQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162039", "bodyText": "The line 24 can be removed, since, from a behavioural specification point of view, \"Then a positive response is received\" would be sufficient.", "author": "MSancaktutar", "createdAt": "2020-03-22T23:48:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUzMzc4MQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396533781", "bodyText": "will do, someone may need to retrospectively go through all current scenarios as those 2 lines are seen together throughout the test suite", "author": "noronhaa", "createdAt": "2020-03-23T15:23:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njc3MzcxOQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396773719", "bodyText": "you're right in that.", "author": "MSancaktutar", "createdAt": "2020-03-23T21:41:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MTc4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjEwMw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162103", "bodyText": "line 61 can be removed", "author": "MSancaktutar", "createdAt": "2020-03-22T23:48:55Z", "path": "src/aat/resources/features/F-102/F-102.feature", "diffHunk": "@@ -50,3 +50,14 @@ Feature: F-102: Get jurisdictions available to the user\n     And the response [contains HTTP 400 Bad Request]\n     And the response [contains an error message : Access can only be 'create', 'read' or 'update']\n     And the response has all other details as expected\n+\n+  @S-580\n+  Scenario: must return a list of jurisdictions for a valid user with no user profile\n+    Given a user with [appropriate idam roles but no CCD user profile]\n+    When a request is prepared with appropriate values\n+    And the request [has CREATE as case access parameter]\n+    And it is submitted to call the [Get jurisdictions available to the user] operation of [CCD Data Store]\n+    Then a positive response is received\n+    And the response [contains HTTP 200 Ok status code]", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjE2Ng==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162166", "bodyText": "password used is for another user", "author": "MSancaktutar", "createdAt": "2020-03-22T23:49:39Z", "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,54 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_PWD]]\"", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjM0MA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162340", "bodyText": "this will inherit the password of another user specified in the parent object, which is not good. every user should use its own password env variable.", "author": "MSancaktutar", "createdAt": "2020-03-22T23:51:30Z", "path": "src/aat/resources/features/F-102/S-580.td.json", "diffHunk": "@@ -0,0 +1,78 @@\n+{\n+  \"_guid_\": \"S-580\",\n+  \"_extends_\": \"F-102_Test_Data_Base\",\n+  \"title\": \"Get jurisdictions available to the user\",\n+  \"specs\": [\n+    \"appropriate idam roles but no CCD user profile\",\n+    \"has CREATE as case access parameter\",\n+    \"contains HTTP 200 Ok status code\",\n+    \"contains the list of jurisdictions a user has access to\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\"\n+  },", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjQzMQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162431", "bodyText": "these can be expected to be specific values, couldn't them?", "author": "MSancaktutar", "createdAt": "2020-03-22T23:52:24Z", "path": "src/aat/resources/features/F-102/S-580.td.json", "diffHunk": "@@ -0,0 +1,78 @@\n+{\n+  \"_guid_\": \"S-580\",\n+  \"_extends_\": \"F-102_Test_Data_Base\",\n+  \"title\": \"Get jurisdictions available to the user\",\n+  \"specs\": [\n+    \"appropriate idam roles but no CCD user profile\",\n+    \"has CREATE as case access parameter\",\n+    \"contains HTTP 200 Ok status code\",\n+    \"contains the list of jurisdictions a user has access to\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\"\n+  },\n+  \"request\": {\n+    \"_extends_\": \"Common_Request\",\n+    \"queryParams\": {\n+      \"access\": \"create\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"_extends_\": \"Common_200_Response\",\n+    \"body\": {\n+      \"arrayInMap\": [\n+        {\n+          \"id\": \"BEFTA_JURISDICTION_1\",\n+          \"name\": \"BEFTA_JURISDICTION_1\",\n+          \"description\": \"Content for the Test Jurisdiction.\",\n+          \"caseTypes\": [\n+            {\n+              \"id\": \"BEFTA_CASETYPE_1_1\",\n+              \"description\": \"Create a case of type BEFTA_CASETYPE_1_1\",\n+              \"version\": null,\n+              \"name\": \"BEFTA Case Type 1 1\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU0MzIyNg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396543226", "bodyText": "we are specifically looking for the list of jurisdictions here specifically rather than the entire list of events and states etc", "author": "noronhaa", "createdAt": "2020-03-23T15:35:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjQzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njc3MzA5MQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396773091", "bodyText": "The response should be checked in full. Returning a wrong list of events and states is a bug in the api even if we return the correct data in the rest of the response.", "author": "MSancaktutar", "createdAt": "2020-03-23T21:39:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjQzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjQ0Nw==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162447", "bodyText": "these can be expected to be specific values, couldn't they?", "author": "MSancaktutar", "createdAt": "2020-03-22T23:52:31Z", "path": "src/aat/resources/features/F-102/S-580.td.json", "diffHunk": "@@ -0,0 +1,78 @@\n+{\n+  \"_guid_\": \"S-580\",\n+  \"_extends_\": \"F-102_Test_Data_Base\",\n+  \"title\": \"Get jurisdictions available to the user\",\n+  \"specs\": [\n+    \"appropriate idam roles but no CCD user profile\",\n+    \"has CREATE as case access parameter\",\n+    \"contains HTTP 200 Ok status code\",\n+    \"contains the list of jurisdictions a user has access to\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\"\n+  },\n+  \"request\": {\n+    \"_extends_\": \"Common_Request\",\n+    \"queryParams\": {\n+      \"access\": \"create\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"_extends_\": \"Common_200_Response\",\n+    \"body\": {\n+      \"arrayInMap\": [\n+        {\n+          \"id\": \"BEFTA_JURISDICTION_1\",\n+          \"name\": \"BEFTA_JURISDICTION_1\",\n+          \"description\": \"Content for the Test Jurisdiction.\",\n+          \"caseTypes\": [\n+            {\n+              \"id\": \"BEFTA_CASETYPE_1_1\",\n+              \"description\": \"Create a case of type BEFTA_CASETYPE_1_1\",\n+              \"version\": null,\n+              \"name\": \"BEFTA Case Type 1 1\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",\n+              \"searchAliasFields\": [],\n+              \"security_classification\": null,\n+              \"case_fields\": [],\n+              \"printable_document_url\": null,\n+              \"acls\": [\n+                {\n+                  \"role\": \"caseworker-befta_jurisdiction_1\",\n+                  \"create\": true,\n+                  \"read\": true,\n+                  \"update\": true,\n+                  \"delete\": false\n+                }\n+              ]\n+            },\n+            {\n+              \"id\": \"CASE_TYPE_WITH_NO_CASES\",\n+              \"description\": \"Create a case of type CASE_TYPE_WITH_NO_CASES\",\n+              \"version\": null,\n+              \"name\": \"CT With No Cases -Don't Create\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjU1NQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r396162555", "bodyText": "better make a dynamic reference to the field in the request, to avoid copy-paste duplication of the same value.", "author": "MSancaktutar", "createdAt": "2020-03-22T23:53:21Z", "path": "src/aat/resources/features/F-102/S-580.td.json", "diffHunk": "@@ -0,0 +1,78 @@\n+{\n+  \"_guid_\": \"S-580\",\n+  \"_extends_\": \"F-102_Test_Data_Base\",\n+  \"title\": \"Get jurisdictions available to the user\",\n+  \"specs\": [\n+    \"appropriate idam roles but no CCD user profile\",\n+    \"has CREATE as case access parameter\",\n+    \"contains HTTP 200 Ok status code\",\n+    \"contains the list of jurisdictions a user has access to\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\"\n+  },\n+  \"request\": {\n+    \"_extends_\": \"Common_Request\",\n+    \"queryParams\": {\n+      \"access\": \"create\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"_extends_\": \"Common_200_Response\",\n+    \"body\": {\n+      \"arrayInMap\": [\n+        {\n+          \"id\": \"BEFTA_JURISDICTION_1\",\n+          \"name\": \"BEFTA_JURISDICTION_1\",\n+          \"description\": \"Content for the Test Jurisdiction.\",\n+          \"caseTypes\": [\n+            {\n+              \"id\": \"BEFTA_CASETYPE_1_1\",\n+              \"description\": \"Create a case of type BEFTA_CASETYPE_1_1\",\n+              \"version\": null,\n+              \"name\": \"BEFTA Case Type 1 1\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",\n+              \"searchAliasFields\": [],\n+              \"security_classification\": null,\n+              \"case_fields\": [],\n+              \"printable_document_url\": null,\n+              \"acls\": [\n+                {\n+                  \"role\": \"caseworker-befta_jurisdiction_1\",\n+                  \"create\": true,\n+                  \"read\": true,\n+                  \"update\": true,\n+                  \"delete\": false\n+                }\n+              ]\n+            },\n+            {\n+              \"id\": \"CASE_TYPE_WITH_NO_CASES\",\n+              \"description\": \"Create a case of type CASE_TYPE_WITH_NO_CASES\",\n+              \"version\": null,\n+              \"name\": \"CT With No Cases -Don't Create\",\n+              \"jurisdiction\": null,\n+              \"events\": \"[[ANYTHING_PRESENT]]\",\n+              \"states\": \"[[ANYTHING_PRESENT]]\",\n+              \"searchAliasFields\": [],\n+              \"security_classification\": null,\n+              \"case_fields\": [],\n+              \"printable_document_url\": null,\n+              \"acls\": [\n+                {\n+                  \"role\": \"caseworker-befta_jurisdiction_1\",", "originalCommit": "109f2c4b8097ed5ca80591cf47ec7d898758d0d1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzc1NTY3MQ==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r397755671", "bodyText": "forget about it. that is not a data in the scenario context", "author": "MSancaktutar", "createdAt": "2020-03-25T10:38:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2MjU1NQ=="}], "type": "inlineReview"}, {"oid": "e842b5cde4c49f8bc35635f80bced56e7a420283", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e842b5cde4c49f8bc35635f80bced56e7a420283", "message": "adress review comments", "committedDate": "2020-03-25T11:50:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzgyMjk4Mg==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r397822982", "bodyText": "we could use\n\"email\": \"${[scenarioContext][theInvokingUser][username]}\",", "author": "MSancaktutar", "createdAt": "2020-03-25T12:41:56Z", "path": "src/aat/resources/features/F-051/S-109.td.json", "diffHunk": "@@ -1,36 +1,481 @@\n {\n-\t\"_guid_\": \"S-109\",\n-\t\"_extends_\": \"Base_Expecting_403\",\n-\t\"title\": \"must return appropriate negative response for a user not having a profile in CCD\",\n+  \"_guid_\": \"S-109\",\n+  \"title\": \"must return appropriate user setting from idam role for a user not having a profile in CCD\",\n+  \"_extends_\": \"Base_Expecting_200\",\n+  \"productName\": \"CCD Data Store\",\n+  \"operationName\": \"Get default settings for user\",\n+  \"method\": \"GET\",\n+  \"uri\": \"/caseworkers/{uid}/profile\",\n+  \"specs\": [\n+    \"no profile in CCD\",\n+    \"uses the Case ID of the case just created\",\n+    \"has the 200 return code\"\n+  ],\n+  \"user\": {\n+    \"username\": \"befta.caseworker.1.noprofile@gmail.com\",\n+    \"password\": \"[[$CCD_BEFTA_CASEWORKER_1_NO_PROFILE_PWD]]\"\n+  },\n+  \"request\": {\n+    \"pathVariables\": {\n+      \"uid\": \"[[DYNAMIC]]\"\n+    }\n+  },\n+  \"expectedResponse\": {\n+    \"body\": {\n+      \"user\": {\n+        \"idam\": {\n+          \"id\": \"${[scenarioContext][theInvokingUser][id]}\",\n+          \"email\": \"befta.caseworker.1.noprofile@gmail.com\",", "originalCommit": "e842b5cde4c49f8bc35635f80bced56e7a420283", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6cc32ec3e938de56ea09c77f731b8cae2c46e68b", "url": "https://github.com/hmcts/ccd-data-store-api/commit/6cc32ec3e938de56ea09c77f731b8cae2c46e68b", "message": "Merge branch 'develop' into RDM-7926", "committedDate": "2020-03-25T13:19:37Z", "type": "commit"}, {"oid": "faa08eec5b1efce641abbdbb03f7b3c232067ad2", "url": "https://github.com/hmcts/ccd-data-store-api/commit/faa08eec5b1efce641abbdbb03f7b3c232067ad2", "message": "add headers to data file", "committedDate": "2020-03-25T17:05:17Z", "type": "commit"}, {"oid": "1df9babbd464c7ef9da03089313dc6a80be8dc80", "url": "https://github.com/hmcts/ccd-data-store-api/commit/1df9babbd464c7ef9da03089313dc6a80be8dc80", "message": "Merge branch 'RDM-7926' of github.com:hmcts/ccd-data-store-api into RDM-7926", "committedDate": "2020-03-25T17:07:05Z", "type": "commit"}, {"oid": "25d1cde3b84088fba686a81e596bf0637a512176", "url": "https://github.com/hmcts/ccd-data-store-api/commit/25d1cde3b84088fba686a81e596bf0637a512176", "message": "updated datat file", "committedDate": "2020-03-26T07:47:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODQzNDAzNA==", "url": "https://github.com/hmcts/ccd-data-store-api/pull/852#discussion_r398434034", "bodyText": "must return a list of jurisdictions for a valid user with no CCD user profile", "author": "MSancaktutar", "createdAt": "2020-03-26T09:39:19Z", "path": "src/aat/resources/features/F-102/F-102.feature", "diffHunk": "@@ -50,3 +50,13 @@ Feature: F-102: Get jurisdictions available to the user\n     And the response [contains HTTP 400 Bad Request]\n     And the response [contains an error message : Access can only be 'create', 'read' or 'update']\n     And the response has all other details as expected\n+\n+  @S-580\n+  Scenario: must return a list of jurisdictions for a valid user with no user profile", "originalCommit": "25d1cde3b84088fba686a81e596bf0637a512176", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e2dc84e2dca4767f65a104cb141184ec882344b0", "url": "https://github.com/hmcts/ccd-data-store-api/commit/e2dc84e2dca4767f65a104cb141184ec882344b0", "message": "updated datat file", "committedDate": "2020-03-26T09:47:54Z", "type": "commit"}]}