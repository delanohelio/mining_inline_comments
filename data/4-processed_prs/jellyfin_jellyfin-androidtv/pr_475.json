{"pr_number": 475, "pr_title": "Add support for vertical grids", "pr_createdAt": "2020-05-14T12:59:16Z", "pr_url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475", "timeline": [{"oid": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba", "message": "Fix TODO", "committedDate": "2020-05-17T14:31:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4Mjc0Mw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428082743", "bodyText": "todo?", "author": "thornbill", "createdAt": "2020-05-20T14:59:23Z", "path": "app/src/main/java/org/jellyfin/androidtv/browsing/StdGridFragment.java", "diffHunk": "@@ -594,7 +602,12 @@ public void run() {\n     private void refreshCurrentItem() {\n         if (MediaManager.getCurrentMediaPosition() >= 0) {\n             mCurrentItem = MediaManager.getCurrentMediaItem();\n-            getGridPresenter().setPosition(MediaManager.getCurrentMediaPosition());\n+\n+            Presenter presenter = getGridPresenter();\n+            if (presenter instanceof HorizontalGridPresenter)\n+                ((HorizontalGridPresenter) presenter).setPosition(MediaManager.getCurrentMediaPosition());\n+            //tood vertical?", "originalCommit": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODExODcyMQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428118721", "bodyText": "If I misspell it my IDE won't catch it when committing... Damn past me. I don't think I need to add something for the vertical presenter though, as I did not notice any different behavior.", "author": "nielsvanvelzen", "createdAt": "2020-05-20T15:47:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4Mjc0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NDM3MQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428084371", "bodyText": "I think this does need to change based on the image size selected. For example small images look rather strange currently...", "author": "thornbill", "createdAt": "2020-05-20T15:01:01Z", "path": "app/src/main/java/org/jellyfin/androidtv/browsing/StdGridFragment.java", "diffHunk": "@@ -131,15 +134,27 @@ public void onCreate(Bundle savedInstanceState) {\n \n         mCardHeight = getCardHeight(mPosterSizeSetting);\n \n-        setupUIElements();\n+        if (mApplication.getUserPreferences().getGridDirection() == GridDirection.HORIZONTAL) {\n+            HorizontalGridPresenter gridPresenter = new HorizontalGridPresenter();\n+            gridPresenter.setNumberOfRows(getGridHeight() / getCardHeight());\n+            setGridPresenter(gridPresenter);\n+        }else {\n+            VerticalGridPresenter gridPresenter = new VerticalGridPresenter();\n+            // Why is this hardcoded you ask? Well did you ever look at getGridHeight()? Yup that one is hardcoded too\n+            // This whole fragment is only optimized for 16:9 screens anyway\n+            // is this bad? Yup it definitely is, we'll fix it when this screen is rewritten\n+            // - Niels, 2020\n+            gridPresenter.setNumberOfColumns(5);", "originalCommit": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODExNzkzNQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428117935", "bodyText": "I think I can add something for that but it will still be hardcoded so using a screen that's not 16:9 (or rather, 1920dp wide) or using images that are not poster-size (banners etc.) will make it glitch. This is unfortunately really hard to fix in this mess.", "author": "nielsvanvelzen", "createdAt": "2020-05-20T15:46:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NDM3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NTI1MQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428085251", "bodyText": "Should we default to horizontal since that is the current layout? I honestly don't know lol", "author": "thornbill", "createdAt": "2020-05-20T15:02:15Z", "path": "app/src/main/java/org/jellyfin/androidtv/preferences/UserPreferences.kt", "diffHunk": "@@ -43,6 +40,11 @@ class UserPreferences(context: Context) : SharedPreferenceStore(PreferenceManage\n \t */\n \tvar backdropEnabled by booleanPreference(\"pref_show_backdrop\", true)\n \n+\t/**\n+\t * Enable background images while browsing\n+\t */\n+\tvar gridDirection by enumPreference(\"grid_direction\", GridDirection.VERTICAL)", "originalCommit": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODExNjY5Mg==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428116692", "bodyText": "Vertical is basically the same as web so it makes it \"more consistent\". Also, I just noted the description for this property is wrong lol, can you find out where I copied the code from? \ud83e\udd23", "author": "nielsvanvelzen", "createdAt": "2020-05-20T15:44:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NTI1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU5NjM0Nw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428596347", "bodyText": "I did change it to horizontal because the vertical one won't work that well until we rewrite the code, I also marked it as \"experimental\".", "author": "nielsvanvelzen", "createdAt": "2020-05-21T11:28:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODA4NTI1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODExNjg3Nw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428116877", "bodyText": "Description is wrong", "author": "nielsvanvelzen", "createdAt": "2020-05-20T15:44:35Z", "path": "app/src/main/java/org/jellyfin/androidtv/preferences/UserPreferences.kt", "diffHunk": "@@ -43,6 +40,11 @@ class UserPreferences(context: Context) : SharedPreferenceStore(PreferenceManage\n \t */\n \tvar backdropEnabled by booleanPreference(\"pref_show_backdrop\", true)\n \n+\t/**\n+\t * Enable background images while browsing", "originalCommit": "ca9b4e33e5c3fb4040cb2c98ecdcd528ef69eeba", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODc4MTEwMw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428781103", "bodyText": "You missed changing the default here \ud83d\ude09", "author": "thornbill", "createdAt": "2020-05-21T16:51:53Z", "path": "app/src/main/res/xml/preferences.xml", "diffHunk": "@@ -37,6 +37,13 @@\n             android:defaultValue=\"true\"\n             android:key=\"pref_show_backdrop\"\n             android:title=\"@string/lbl_show_backdrop\" />\n+        <ListPreference\n+            android:defaultValue=\"VERTICAL\"", "originalCommit": "ae06654a1d3179fcdb8e9d1e94274525972377af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg3ODYwMA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/475#discussion_r428878600", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        android:defaultValue=\"VERTICAL\"\n          \n          \n            \n                        android:defaultValue=\"HORIZONTAL\"", "author": "nielsvanvelzen", "createdAt": "2020-05-21T19:53:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODc4MTEwMw=="}], "type": "inlineReview"}, {"oid": "d2c5ba8190300def9a31991563c95cb4c952f3b0", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/d2c5ba8190300def9a31991563c95cb4c952f3b0", "message": "Add support for vertical grids", "committedDate": "2020-05-22T16:45:06Z", "type": "commit"}, {"oid": "cc5e5494ea646415c331bf87587e34504b0c62ba", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/cc5e5494ea646415c331bf87587e34504b0c62ba", "message": "Fix TODO", "committedDate": "2020-05-22T16:45:06Z", "type": "commit"}, {"oid": "850ae900a9c21339decba4d168be5cbf7dd9a394", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/850ae900a9c21339decba4d168be5cbf7dd9a394", "message": "Fix some bugs, marked the vertical grid as experimental, determine column count based on image size", "committedDate": "2020-05-22T16:45:06Z", "type": "commit"}, {"oid": "b552d3a455ee3cff1d9dc84cb7a6f3767e74e629", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/b552d3a455ee3cff1d9dc84cb7a6f3767e74e629", "message": "Change default to horizontal in XML", "committedDate": "2020-05-22T16:45:07Z", "type": "commit"}, {"oid": "b552d3a455ee3cff1d9dc84cb7a6f3767e74e629", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/b552d3a455ee3cff1d9dc84cb7a6f3767e74e629", "message": "Change default to horizontal in XML", "committedDate": "2020-05-22T16:45:07Z", "type": "forcePushed"}]}