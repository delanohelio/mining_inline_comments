{"pr_number": 321, "pr_title": "Chapter cards", "pr_createdAt": "2020-02-08T16:58:02Z", "pr_url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321", "timeline": [{"oid": "05fb074baeeec4585bd962fcc7a4aeb7619c087d", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/05fb074baeeec4585bd962fcc7a4aeb7619c087d", "message": "Actor Cards are now 2:3 aspect ratio", "committedDate": "2020-02-08T14:58:22Z", "type": "commit"}, {"oid": "aa3723541e1cecc279eac76d21bc9bc78734f1d5", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/aa3723541e1cecc279eac76d21bc9bc78734f1d5", "message": "Rough implementation of chapter selection cards", "committedDate": "2020-02-08T16:56:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcyMDkxNA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321#discussion_r376720914", "bodyText": "Can't you get the image from the data inside ChapterInfoDto?", "author": "nielsvanvelzen", "createdAt": "2020-02-08T17:01:39Z", "path": "app/src/main/java/org/jellyfin/androidtv/model/itemtypes/ChapterInfo.kt", "diffHunk": "@@ -0,0 +1,10 @@\n+package org.jellyfin.androidtv.model.itemtypes\n+\n+import org.jellyfin.apiclient.model.dto.ChapterInfoDto\n+import org.jellyfin.apiclient.model.entities.ImageType\n+\n+class ChapterInfo(originalChapterInfoDto: ChapterInfoDto, val baseItem: BaseItem, index: Int) {", "originalCommit": "aa3723541e1cecc279eac76d21bc9bc78734f1d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcyODIzNQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321#discussion_r376728235", "bodyText": "Sadly not. A ChapterInfoDto doesn't contain the ID of the item it belongs to, and the index is also required by the server, inquiring with tag is not enough :/", "author": "AndreasGB", "createdAt": "2020-02-08T19:17:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcyMDkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczMzI0Mw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321#discussion_r376733243", "bodyText": "Oh that's unfortunate. Can't do anything about it though :(", "author": "nielsvanvelzen", "createdAt": "2020-02-08T20:44:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcyMDkxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczNDU2OA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321#discussion_r376734568", "bodyText": "Yeh, bummed me out as well that this old API is sabotaging us here. At least it's clean on the lifted ones", "author": "AndreasGB", "createdAt": "2020-02-08T21:09:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcyMDkxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcyMTIzMw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321#discussion_r376721233", "bodyText": "Add the index option as nullable to the constructor", "author": "nielsvanvelzen", "createdAt": "2020-02-08T17:07:33Z", "path": "app/src/main/java/org/jellyfin/androidtv/model/itemtypes/ImageCollection.kt", "diffHunk": "@@ -15,14 +16,28 @@ class ImageCollection(original: BaseItemDto) {\n \tval backdrops = original.backdropImageTags.map { Image(original.id, ImageType.Backdrop, it) }.toList()\n \n \tclass Image(private val itemId: String, private val type: ImageType, private val tag: String) {", "originalCommit": "aa3723541e1cecc279eac76d21bc9bc78734f1d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcyMTI4Nw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321#discussion_r376721287", "bodyText": "Just add the index here:\nif(imageIndex != null) it.index = imageIndex\nMight even be possible to do it without  the if statement (I think null is the default value)", "author": "nielsvanvelzen", "createdAt": "2020-02-08T17:08:30Z", "path": "app/src/main/java/org/jellyfin/androidtv/model/itemtypes/ImageCollection.kt", "diffHunk": "@@ -15,14 +16,28 @@ class ImageCollection(original: BaseItemDto) {\n \tval backdrops = original.backdropImageTags.map { Image(original.id, ImageType.Backdrop, it) }.toList()\n \n \tclass Image(private val itemId: String, private val type: ImageType, private val tag: String) {\n+\t\tvar index = 0\n+\n \t\tval url: String by lazy {\n+\t\t\tif (type == ImageType.Chapter)\n+\t\t\t\tTvApp.getApplication().apiClient.GetImageUrl(itemId, ImageOptions().also {\n+\t\t\t\t\tit.imageType = type\n+\t\t\t\t\tit.tag = tag\n+\t\t\t\t\tit.imageIndex = index\n+\t\t\t\t})\n+\t\t\telse\n \t\t\tTvApp.getApplication().apiClient.GetImageUrl(itemId, ImageOptions().also {\n \t\t\t\tit.imageType = type\n \t\t\t\tit.tag = tag", "originalCommit": "aa3723541e1cecc279eac76d21bc9bc78734f1d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcyMTMxMw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321#discussion_r376721313", "bodyText": "Remove this constructor in favor of the other one I mentioned", "author": "nielsvanvelzen", "createdAt": "2020-02-08T17:08:47Z", "path": "app/src/main/java/org/jellyfin/androidtv/model/itemtypes/ImageCollection.kt", "diffHunk": "@@ -15,14 +16,28 @@ class ImageCollection(original: BaseItemDto) {\n \tval backdrops = original.backdropImageTags.map { Image(original.id, ImageType.Backdrop, it) }.toList()\n \n \tclass Image(private val itemId: String, private val type: ImageType, private val tag: String) {\n+\t\tvar index = 0\n+\n \t\tval url: String by lazy {\n+\t\t\tif (type == ImageType.Chapter)\n+\t\t\t\tTvApp.getApplication().apiClient.GetImageUrl(itemId, ImageOptions().also {\n+\t\t\t\t\tit.imageType = type\n+\t\t\t\t\tit.tag = tag\n+\t\t\t\t\tit.imageIndex = index\n+\t\t\t\t})\n+\t\t\telse\n \t\t\tTvApp.getApplication().apiClient.GetImageUrl(itemId, ImageOptions().also {\n \t\t\t\tit.imageType = type\n \t\t\t\tit.tag = tag\n \t\t\t})\n \t\t}\n \n+\t\tconstructor(itemId: String, type: ImageType, tag: String, index: Int) : this(itemId, type, tag) {", "originalCommit": "aa3723541e1cecc279eac76d21bc9bc78734f1d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "877e28f5987a0c539c0a571de4f39ff92cd7fbe9", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/877e28f5987a0c539c0a571de4f39ff92cd7fbe9", "message": "Refactor ImageCollection.Image", "committedDate": "2020-02-08T19:24:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczMzI2OQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/321#discussion_r376733269", "bodyText": "You can remove the if statement as the default value if imageIndex is null", "author": "nielsvanvelzen", "createdAt": "2020-02-08T20:45:05Z", "path": "app/src/main/java/org/jellyfin/androidtv/model/itemtypes/ImageCollection.kt", "diffHunk": "@@ -14,15 +15,18 @@ class ImageCollection(original: BaseItemDto) {\n \tval logo = original.imageTags[ImageType.Logo]?.let { Image(original.id, ImageType.Logo, it) }\n \tval backdrops = original.backdropImageTags.map { Image(original.id, ImageType.Backdrop, it) }.toList()\n \n-\tclass Image(private val itemId: String, private val type: ImageType, private val tag: String) {\n+\tclass Image(private val itemId: String, private val type: ImageType, private val tag: String, private val index: Int? = null) {\n+\n \t\tval url: String by lazy {\n \t\t\tTvApp.getApplication().apiClient.GetImageUrl(itemId, ImageOptions().also {\n \t\t\t\tit.imageType = type\n \t\t\t\tit.tag = tag\n+\t\t\t\tif (index != null) it.imageIndex = index", "originalCommit": "877e28f5987a0c539c0a571de4f39ff92cd7fbe9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2994ac060bef29704a3fa019990fc9371ee6ada2", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/2994ac060bef29704a3fa019990fc9371ee6ada2", "message": "Tiny refactor", "committedDate": "2020-02-08T21:08:34Z", "type": "commit"}]}