{"pr_number": 630, "pr_title": "Add the ability to change the rating type shown on cards", "pr_createdAt": "2020-11-15T17:31:00Z", "pr_url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630", "timeline": [{"oid": "139a6ef59be59380b66ffc64807cd3ea1373d2f1", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/139a6ef59be59380b66ffc64807cd3ea1373d2f1", "message": "Add the ability to choose IMDb as the default rating provider", "committedDate": "2020-11-15T17:57:31Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg0ODIxNA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r524848214", "bodyText": "Looks like you could use holder here instead of casting repeatedly \ud83d\ude09 .", "author": "thornbill", "createdAt": "2020-11-17T02:41:07Z", "path": "app/src/main/java/org/jellyfin/androidtv/ui/presentation/CardPresenter.java", "diffHunk": "@@ -394,9 +398,17 @@ public void onBindViewHolder(Presenter.ViewHolder viewHolder, Object item) {\n             holder.mCardView.setPlayingIndicator(true);\n         } else {\n             holder.mCardView.setPlayingIndicator(false);\n-            Drawable badge = rowItem.getBadgeImage();\n-            if (badge != null) {\n-                ((ViewHolder) viewHolder).mCardView.setBadgeImage(badge);\n+\n+            if (get(UserPreferences.class).get(UserPreferences.Companion.getDefaultRatingProvider()) == RatingProvider.RATING_RT) {\n+                Drawable badge = rowItem.getBadgeImage();\n+                ((ViewHolder) viewHolder).mCardView.setRating(null);", "originalCommit": "139a6ef59be59380b66ffc64807cd3ea1373d2f1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDkwMjcxMQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r524902711", "bodyText": "ah yes. it appears I started with some copy pasta and rolled with it \ud83e\udd26\u200d\u2642\ufe0f", "author": "MrChip53", "createdAt": "2020-11-17T06:02:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg0ODIxNA=="}], "type": "inlineReview"}, {"oid": "7550a0cb690fe8aa09b39a952fdcbd9f3d02108b", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/7550a0cb690fe8aa09b39a952fdcbd9f3d02108b", "message": "Add the ability to choose IMDb as the default rating provider", "committedDate": "2020-11-17T06:33:06Z", "type": "forcePushed"}, {"oid": "373acc8958f6f267f6d4d2e59422936f1cf20dcb", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/373acc8958f6f267f6d4d2e59422936f1cf20dcb", "message": "Change strings to be more provider agnostic", "committedDate": "2020-11-28T15:24:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU5NjQyOQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r543596429", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Sets default rating provider to Rotten tomatoes.\n          \n          \n            \n            \t * Sets default rating provider to tomatoes.", "author": "nielsvanvelzen", "createdAt": "2020-12-15T18:46:06Z", "path": "app/src/main/java/org/jellyfin/androidtv/preference/constant/RatingProvider.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package org.jellyfin.androidtv.preference.constant\n+\n+import org.jellyfin.androidtv.R\n+import org.jellyfin.androidtv.ui.preference.dsl.EnumDisplayOptions\n+\n+enum class RatingProvider {\n+\t/**\n+\t * Sets default rating provider to Rotten tomatoes.", "originalCommit": "373acc8958f6f267f6d4d2e59422936f1cf20dcb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU5NjUwOA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r543596508", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Sets the default rating provider to IMDb.\n          \n          \n            \n            \t * Sets the default rating provider to stars.", "author": "nielsvanvelzen", "createdAt": "2020-12-15T18:46:14Z", "path": "app/src/main/java/org/jellyfin/androidtv/preference/constant/RatingProvider.kt", "diffHunk": "@@ -0,0 +1,18 @@\n+package org.jellyfin.androidtv.preference.constant\n+\n+import org.jellyfin.androidtv.R\n+import org.jellyfin.androidtv.ui.preference.dsl.EnumDisplayOptions\n+\n+enum class RatingProvider {\n+\t/**\n+\t * Sets default rating provider to Rotten tomatoes.\n+\t */\n+\t@EnumDisplayOptions(R.string.lbl_tomatoes)\n+\tRATING_TOMATOES,\n+\n+\t/**\n+\t * Sets the default rating provider to IMDb.", "originalCommit": "373acc8958f6f267f6d4d2e59422936f1cf20dcb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU5NzM3OA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r543597378", "bodyText": "I think the code will be more readable if the result of the get(UserPreferences.class).get(UserPreferences.Companion.getDefaultRatingProvider()) part is moved to a variable before the if statement.", "author": "nielsvanvelzen", "createdAt": "2020-12-15T18:47:24Z", "path": "app/src/main/java/org/jellyfin/androidtv/ui/presentation/CardPresenter.java", "diffHunk": "@@ -394,13 +398,21 @@ public void onBindViewHolder(Presenter.ViewHolder viewHolder, Object item) {\n             holder.mCardView.setPlayingIndicator(true);\n         } else {\n             holder.mCardView.setPlayingIndicator(false);\n-            Drawable badge = rowItem.getBadgeImage();\n-            if (badge != null) {\n-                ((ViewHolder) viewHolder).mCardView.setBadgeImage(badge);\n+\n+            if (get(UserPreferences.class).get(UserPreferences.Companion.getDefaultRatingProvider()) == RatingProvider.RATING_TOMATOES) {", "originalCommit": "373acc8958f6f267f6d4d2e59422936f1cf20dcb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzYwMDQ3OQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r543600479", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <string name=\"pref_default_rating\">Default Ratings Scale</string>\n          \n          \n            \n                <string name=\"pref_default_rating\">Default rating type</string>\n          \n      \n    \n    \n  \n\nCould apply this consistently in the code too", "author": "nielsvanvelzen", "createdAt": "2020-12-15T18:52:02Z", "path": "app/src/main/res/values/strings.xml", "diffHunk": "@@ -418,4 +418,7 @@\n     <string name=\"lbl_manual_login\">Manual Login</string>\n     <string name=\"lbl_playback_control_ends\">Ends at %1$s</string>\n     <string name=\"watch_count_overflow\">99+</string>\n+    <string name=\"lbl_stars\">Stars</string>\n+    <string name=\"lbl_tomatoes\">Tomatoes</string>\n+    <string name=\"pref_default_rating\">Default Ratings Scale</string>", "originalCommit": "373acc8958f6f267f6d4d2e59422936f1cf20dcb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDgwMzI5Mw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/630#discussion_r544803293", "bodyText": "Changed all references of \"RatingProvider\" or any variation of \"RatingProvider\" to \"RatingType\". I assume that is what you meant here. And the string ofc.", "author": "MrChip53", "createdAt": "2020-12-17T04:27:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzYwMDQ3OQ=="}], "type": "inlineReview"}, {"oid": "12fc12f124226350569a539aa76041dbbb79d0de", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/12fc12f124226350569a539aa76041dbbb79d0de", "message": "Add the ability to change the default rating type displayed on cards", "committedDate": "2020-12-17T04:24:22Z", "type": "commit"}, {"oid": "12fc12f124226350569a539aa76041dbbb79d0de", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/12fc12f124226350569a539aa76041dbbb79d0de", "message": "Add the ability to change the default rating type displayed on cards", "committedDate": "2020-12-17T04:24:22Z", "type": "forcePushed"}]}