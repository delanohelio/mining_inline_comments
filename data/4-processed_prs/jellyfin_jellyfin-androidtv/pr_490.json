{"pr_number": 490, "pr_title": "Removed Picasso to be replaced by Glide.", "pr_createdAt": "2020-05-30T13:51:11Z", "pr_url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490", "timeline": [{"oid": "76387cae8ed3cf5ef94c61586367333e9d90dde6", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/76387cae8ed3cf5ef94c61586367333e9d90dde6", "message": "Glide migrated from 3 to 4. Removed Picasso to be replaced by Glide.", "committedDate": "2020-05-30T13:37:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg0NDY2OQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432844669", "bodyText": "We don't add \"created by\" comments to files. We only have them in some other files that were inherited from the old Emby code.", "author": "nielsvanvelzen", "createdAt": "2020-05-30T14:12:29Z", "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,42 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.app.Activity\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.load.resource.bitmap.BitmapTransformation\n+import com.bumptech.glide.load.resource.bitmap.CenterInside\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+\n+/** Created by Oriol on 30/05/20. **/", "originalCommit": "76387cae8ed3cf5ef94c61586367333e9d90dde6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg0NDc1NA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432844754", "bodyText": "This could be a context", "author": "nielsvanvelzen", "createdAt": "2020-05-30T14:13:23Z", "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,42 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.app.Activity\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.load.resource.bitmap.BitmapTransformation\n+import com.bumptech.glide.load.resource.bitmap.CenterInside\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+\n+/** Created by Oriol on 30/05/20. **/\n+\n+fun BackgroundManager.drawable(\n+\tactivity: Activity,", "originalCommit": "76387cae8ed3cf5ef94c61586367333e9d90dde6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg2NzYxNw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432867617", "bodyText": "indeed, what a mistake", "author": "tukilo", "createdAt": "2020-05-30T16:22:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg0NDc1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg0NDkxMQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432844911", "bodyText": "We should return true here", "author": "nielsvanvelzen", "createdAt": "2020-05-30T14:15:35Z", "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,42 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.app.Activity\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.load.resource.bitmap.BitmapTransformation\n+import com.bumptech.glide.load.resource.bitmap.CenterInside\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+\n+/** Created by Oriol on 30/05/20. **/\n+\n+fun BackgroundManager.drawable(\n+\tactivity: Activity,\n+\turl: String,\n+\tskipMemoryCache: Boolean = true,\n+\ttransformation: BitmapTransformation = CenterInside(),\n+\twidthPixels: Int,\n+\theightPixels: Int\n+) {\n+\n+\tGlide.with(activity)\n+\t\t.load(url)\n+\t\t.skipMemoryCache(skipMemoryCache)\n+\t\t.override(widthPixels, heightPixels)\n+\t\t.transform(transformation)\n+\t\t.listener(object : RequestListener<Drawable?> {\n+\t\t\toverride fun onLoadFailed(e: GlideException?, model: Any, target: Target<Drawable?>, isFirstResource: Boolean): Boolean {\n+\t\t\t\treturn false\n+\t\t\t}\n+\n+\t\t\toverride fun onResourceReady(resource: Drawable?, model: Any, target: Target<Drawable?>, dataSource: DataSource, isFirstResource: Boolean): Boolean {\n+\t\t\t\tdrawable = resource\n+\t\t\t\treturn false", "originalCommit": "76387cae8ed3cf5ef94c61586367333e9d90dde6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9f01b88996d7ddcfacaef28711af6a5b55ee4b77", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/9f01b88996d7ddcfacaef28711af6a5b55ee4b77", "message": "Removed template by default \"Created by\". Removed all skipMemoryCache() calls. Removed unused imports. Removed SkipMemoryCache and Transformation params from BackgroundUtils. Added Timber.e in onLoadFailed", "committedDate": "2020-05-30T16:32:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg3NTg1Ng==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432875856", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t.override(widthPixels, heightPixels)\n          \n          \n            \n            \t\t.override(widthPixels, heightPixels)\n          \n          \n            \n            \t\t.centerCrop()\n          \n      \n    \n    \n  \n\nWhen testing I noticed some backdrops getting stretched which did not happen before this PR. Adding the centerCrop function here fixed it.", "author": "nielsvanvelzen", "createdAt": "2020-05-30T18:19:15Z", "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.content.Context\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+import timber.log.Timber\n+\n+fun BackgroundManager.drawable(\n+\tcontext: Context,\n+\turl: String,\n+\twidthPixels: Int,\n+\theightPixels: Int\n+) {\n+\n+\tGlide.with(context)\n+\t\t.load(url)\n+\t\t.override(widthPixels, heightPixels)", "originalCommit": "9f01b88996d7ddcfacaef28711af6a5b55ee4b77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg3ODQzNg==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432878436", "bodyText": "And it makes sense because I eliminated it without realizing", "author": "tukilo", "createdAt": "2020-05-30T18:52:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjg3NTg1Ng=="}], "type": "inlineReview"}, {"oid": "d21b97be9c204d2ef54d9b6a238be25217886499", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/d21b97be9c204d2ef54d9b6a238be25217886499", "message": "Update app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt\n\nCo-authored-by: Niels van Velzen <nielsvanvelzen@users.noreply.github.com>", "committedDate": "2020-05-30T18:36:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1NTk0OQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432955949", "bodyText": "As this file only contains a single extension function I'd recommend renaming it to \"BackgroundManagerExtensions\" to stay consistent with the other file(s)", "author": "nielsvanvelzen", "createdAt": "2020-05-31T15:05:29Z", "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.content.Context\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+import timber.log.Timber\n+\n+fun BackgroundManager.drawable(", "originalCommit": "d21b97be9c204d2ef54d9b6a238be25217886499", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1NTk3Nw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432955977", "bodyText": "Unnecessary whitespace", "author": "nielsvanvelzen", "createdAt": "2020-05-31T15:05:42Z", "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.content.Context\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+import timber.log.Timber\n+\n+fun BackgroundManager.drawable(\n+\tcontext: Context,\n+\turl: String,\n+\twidthPixels: Int,\n+\theightPixels: Int\n+) {\n+", "originalCommit": "d21b97be9c204d2ef54d9b6a238be25217886499", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1NTk4Ng==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/490#discussion_r432955986", "bodyText": "Unnecessary whitespace", "author": "nielsvanvelzen", "createdAt": "2020-05-31T15:05:52Z", "path": "app/src/main/java/org/jellyfin/androidtv/util/BackgroundManagerUtils.kt", "diffHunk": "@@ -0,0 +1,37 @@\n+package org.jellyfin.androidtv.util\n+\n+import android.content.Context\n+import android.graphics.drawable.Drawable\n+import androidx.leanback.app.BackgroundManager\n+import com.bumptech.glide.Glide\n+import com.bumptech.glide.load.DataSource\n+import com.bumptech.glide.load.engine.GlideException\n+import com.bumptech.glide.request.RequestListener\n+import com.bumptech.glide.request.target.Target\n+import timber.log.Timber\n+\n+fun BackgroundManager.drawable(\n+\tcontext: Context,\n+\turl: String,\n+\twidthPixels: Int,\n+\theightPixels: Int\n+) {\n+\n+\tGlide.with(context)\n+\t\t.load(url)\n+\t\t.override(widthPixels, heightPixels)\n+\t\t.centerCrop()\n+\t\t.listener(object : RequestListener<Drawable?> {\n+\t\t\toverride fun onLoadFailed(e: GlideException?, model: Any, target: Target<Drawable?>, isFirstResource: Boolean): Boolean {\n+\t\t\t\tTimber.e(e)\n+\t\t\t\treturn false\n+\t\t\t}\n+\n+\t\t\toverride fun onResourceReady(resource: Drawable?, model: Any, target: Target<Drawable?>, dataSource: DataSource, isFirstResource: Boolean): Boolean {\n+\t\t\t\tdrawable = resource\n+\t\t\t\treturn true\n+\t\t\t}\n+\t\t}).submit()\n+\n+", "originalCommit": "d21b97be9c204d2ef54d9b6a238be25217886499", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bbfceb501fd0e622b09069ef1ed01404f70f467d", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/bbfceb501fd0e622b09069ef1ed01404f70f467d", "message": "Small details", "committedDate": "2020-05-31T16:40:53Z", "type": "commit"}]}