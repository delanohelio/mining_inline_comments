{"pr_number": 7982, "pr_title": "make it possible to interrupt readLines(stdin())", "pr_createdAt": "2020-10-06T20:30:48Z", "pr_url": "https://github.com/rstudio/rstudio/pull/7982", "timeline": [{"oid": "f487fa27aee8fd9aa30d339ba22710b5210eaf85", "url": "https://github.com/rstudio/rstudio/commit/f487fa27aee8fd9aa30d339ba22710b5210eaf85", "message": "make it possible to interrupt readLines(stdin())", "committedDate": "2020-10-06T20:27:03Z", "type": "commit"}, {"oid": "7e7b7ab2c1a0172c26bcf2a6be618509e26037f2", "url": "https://github.com/rstudio/rstudio/commit/7e7b7ab2c1a0172c26bcf2a6be618509e26037f2", "message": "reformat", "committedDate": "2020-10-06T20:32:16Z", "type": "commit"}, {"oid": "fe5ffb18a6c1d05c84a914551a530f023e6f9744", "url": "https://github.com/rstudio/rstudio/commit/fe5ffb18a6c1d05c84a914551a530f023e6f9744", "message": "remove output suppression", "committedDate": "2020-10-06T21:20:46Z", "type": "commit"}, {"oid": "1a615a0b85e8d201ee4352def2f2babd1c83755e", "url": "https://github.com/rstudio/rstudio/commit/1a615a0b85e8d201ee4352def2f2babd1c83755e", "message": "document motivation", "committedDate": "2020-10-06T22:09:09Z", "type": "commit"}, {"oid": "047ddc91bad2dca590b919aeb4d3c1b0b698512c", "url": "https://github.com/rstudio/rstudio/commit/047ddc91bad2dca590b919aeb4d3c1b0b698512c", "message": "update NEWS", "committedDate": "2020-10-06T22:11:15Z", "type": "commit"}, {"oid": "3f239473babc0182c780d937239179fbf86da1a3", "url": "https://github.com/rstudio/rstudio/commit/3f239473babc0182c780d937239179fbf86da1a3", "message": "suppress newlines printed by Rf_onintr", "committedDate": "2020-10-06T22:25:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDc0NTA0Nw==", "url": "https://github.com/rstudio/rstudio/pull/7982#discussion_r500745047", "bodyText": "This is sort of a hack based on how we draw the prompt. In a regular R session, when an interrupt is issued, R writes a single newline:\nhttps://github.com/wch/r-source/blob/819477cd6dbefb8fae61a07fc13064faa29a2714/src/main/errors.c#L188\nwith the intention of having that ensure the input prompt is then drawn on its own line. The net result is that interrupting a command gives you a \"new\" prompt to work on.\nRStudio instead tries a little harder to ensure the prompt is always shown on its own line, which means an extraneous newline is written to the console history in these cases. Hence, this is ultimately a hack to ensure that RStudio's output more closely mimics that of R.", "author": "kevinushey", "createdAt": "2020-10-07T05:26:05Z", "path": "src/cpp/r/session/RStdCallbacks.cpp", "diffHunk": "@@ -426,8 +426,20 @@ void RWriteConsoleEx (const char *buf, int buflen, int otype)\n    {\n       if (!s_suppressOutput)\n       {\n+         bool isInterruptOutput =", "originalCommit": "3f239473babc0182c780d937239179fbf86da1a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}