{"pr_number": 8334, "pr_title": "Fix jumpy scroll/cursor/selection action with large code chunks", "pr_createdAt": "2020-11-10T18:58:28Z", "pr_url": "https://github.com/rstudio/rstudio/pull/8334", "timeline": [{"oid": "55ab22cdf07860f8ebe838d5b9425fe5056cb263", "url": "https://github.com/rstudio/rstudio/commit/55ab22cdf07860f8ebe838d5b9425fe5056cb263", "message": "obtain cursor geometry from virtual cursor; ignore mouse", "committedDate": "2020-11-10T18:46:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgwNzM0Ng==", "url": "https://github.com/rstudio/rstudio/pull/8334#discussion_r520807346", "bodyText": "What happens if you initiate a click / mousedown within the visual editor surface, but then later mouseup somewhere else? Does this event handler still see the mouseup event?", "author": "kevinushey", "createdAt": "2020-11-10T19:05:37Z", "path": "src/gwt/panmirror/src/editor/src/optional/ace/ace.ts", "diffHunk": "@@ -711,6 +716,15 @@ export class AceNodeView implements NodeView {\n         this.scrollRow = -1;\n       }),\n     );\n+\n+    // Keep track of mouse state so we can avoid e.g., autoscrolling while the\n+    // mouse is down\n+    this.dom.addEventListener(\"mousedown\", (evt) => {\n+      this.mouseDown = true;\n+    });\n+    this.dom.addEventListener(\"mouseup\", (evt) => {", "originalCommit": "55ab22cdf07860f8ebe838d5b9425fe5056cb263", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgxMTM4OQ==", "url": "https://github.com/rstudio/rstudio/pull/8334#discussion_r520811389", "bodyText": "It's a weird thing to do (you'd be generating a selection with one foot in code and the other in prose), but it would indeed leave this flag stuck if you did. I'll add a mouseleave handler to guard against this.", "author": "jmcphers", "createdAt": "2020-11-10T19:13:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgwNzM0Ng=="}], "type": "inlineReview"}, {"oid": "14d58cdacbd8cf4ea27fea61073becd3b5992874", "url": "https://github.com/rstudio/rstudio/commit/14d58cdacbd8cf4ea27fea61073becd3b5992874", "message": "clear mousedown flag when mouse leaves", "committedDate": "2020-11-10T19:15:28Z", "type": "commit"}]}