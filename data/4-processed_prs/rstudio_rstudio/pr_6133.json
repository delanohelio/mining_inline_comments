{"pr_number": 6133, "pr_title": "utility command to help search for available keyboard shortcuts", "pr_createdAt": "2020-02-01T01:55:51Z", "pr_url": "https://github.com/rstudio/rstudio/pull/6133", "timeline": [{"oid": "350f46ebcfe3bfb895fc55a0650732a06e77b6c8", "url": "https://github.com/rstudio/rstudio/commit/350f46ebcfe3bfb895fc55a0650732a06e77b6c8", "message": "utility command to help search for available keyboard shortcuts\n\n- Toggle via Help / Diagnostics / Short Keyboard Shortcut Command\n- When on, a message bar is shown at bottom of main window, and any shortcuts typed will report their bound command (or \"Shortcut not bound\") but not fire the command\n- Shows mappings even if command is currently disabled\n- Could be the basis of a \"real\" feature (what does this shortcut do), and as a bonus it will read the results via screen reader due to message bar being a live region, but for now just considering a dev tool\n- Doesn't account for platform differences (Windows vs Mac vs Linux, desktop vs browser), so there are some edge cases you won't catch unless you try on all those, or at least double-check in commands.cmd.xml\n- When you turn off this mode, it hides the warning bar for you", "committedDate": "2020-02-01T01:53:04Z", "type": "commit"}, {"oid": "dae26480afa76f6638755f1c4d69238472b11cf2", "url": "https://github.com/rstudio/rstudio/commit/dae26480afa76f6638755f1c4d69238472b11cf2", "message": "fix typo", "committedDate": "2020-02-01T19:42:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMyMDQ4Mg==", "url": "https://github.com/rstudio/rstudio/pull/6133#discussion_r374320482", "bodyText": "I think that it should be clearer whether we're at leaf node in the shortcut tree (i.e. if you have a shortcut that uses C-X as a prefix, C-X should show that it's putting us in pending mode rather than reporting C-X as totally unbound)", "author": "jmcphers", "createdAt": "2020-02-03T20:21:21Z", "path": "src/gwt/src/org/rstudio/core/client/command/ShortcutManager.java", "diffHunk": "@@ -528,10 +529,11 @@ else if (binding.getId() == \"closeSourceDoc\")\n             }\n             \n             event.stopPropagation();\n-            binding.execute();\n+            if (!reportShortcutBinding(binding.getId()))\n+               binding.execute();\n             return true;\n          }\n-         \n+         reportShortcutBinding(\"Shortcut not bound\"); \n          if (map.isPrefix(keyBuffer_))", "originalCommit": "dae26480afa76f6638755f1c4d69238472b11cf2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQxNDcwMg==", "url": "https://github.com/rstudio/rstudio/pull/6133#discussion_r374414702", "bodyText": "Good idea, now implemented.", "author": "gtritchie", "createdAt": "2020-02-04T00:18:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMyMDQ4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMyMjM1OQ==", "url": "https://github.com/rstudio/rstudio/pull/6133#discussion_r374322359", "bodyText": "When unchecked, checkable menu items look exactly like regular menu items so I don't think most people will know the first time that they invoke this mode that they need to go back to the menu to turn it off.\nI think that this should either be (a) self-cancelling (it just reports one shortcut and quits) or advertise a way to quit in the message itself (a special shortcut or a reference to the menu item).", "author": "jmcphers", "createdAt": "2020-02-03T20:25:24Z", "path": "src/gwt/src/org/rstudio/core/client/command/ShortcutManager.java", "diffHunk": "@@ -718,6 +720,18 @@ public final boolean isIgnoredKeyCombination(KeyCombination keys)\n       return ignoredKeys_.isIgnoredKeyCombination(keys);\n    }\n    \n+   public void setReportShortcutBinding(boolean report)\n+   {\n+      reportShortcutBinding_ = report;\n+   }\n+\n+   private boolean reportShortcutBinding(String message)\n+   {\n+      if (reportShortcutBinding_)", "originalCommit": "dae26480afa76f6638755f1c4d69238472b11cf2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQxNDkxOQ==", "url": "https://github.com/rstudio/rstudio/pull/6133#discussion_r374414919", "bodyText": "Good point, switched to a regular menu item, and rely on closing the MessageBar to turn off this mode (and mention that in the initial MessageBar text shown when activating this mode).", "author": "gtritchie", "createdAt": "2020-02-04T00:19:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMyMjM1OQ=="}], "type": "inlineReview"}, {"oid": "8ed60735f583e9f8a416ab8535ca66fe03294d8f", "url": "https://github.com/rstudio/rstudio/commit/8ed60735f583e9f8a416ab8535ca66fe03294d8f", "message": "tweaks based on PR feedback\n\n- instead of using a checkbox menu-item to toggle on/off, closing the messagebar will exit this mode\n- show a message when shortcut resolution still pending (e.g. multi-gesture shortcuts)\n- cleanup ShowWarningBarEvent to use our single-file model instead of separate Event, Handler, Data source files", "committedDate": "2020-02-04T00:17:19Z", "type": "commit"}, {"oid": "d6e324796c518c5078e8f21986034047923e448e", "url": "https://github.com/rstudio/rstudio/commit/d6e324796c518c5078e8f21986034047923e448e", "message": "remove gratuitous whitespace change", "committedDate": "2020-02-04T00:21:32Z", "type": "commit"}, {"oid": "0416e94452dc99074f522bc18b95e7a781f485f9", "url": "https://github.com/rstudio/rstudio/commit/0416e94452dc99074f522bc18b95e7a781f485f9", "message": "clear pending message after timeout, put back original instructions", "committedDate": "2020-02-04T01:48:01Z", "type": "commit"}]}