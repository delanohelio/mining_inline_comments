{"pr_number": 7916, "pr_title": "annotate inotify errors with better message", "pr_createdAt": "2020-09-29T23:55:12Z", "pr_url": "https://github.com/rstudio/rstudio/pull/7916", "timeline": [{"oid": "0ad0038476e6744bc4af6f7e0a33108c8f9829db", "url": "https://github.com/rstudio/rstudio/commit/0ad0038476e6744bc4af6f7e0a33108c8f9829db", "message": "annotate inotify errors with better message", "committedDate": "2020-09-29T23:55:58Z", "type": "forcePushed"}, {"oid": "10cb77ee823f47571087d9a71e097d56b79b1af2", "url": "https://github.com/rstudio/rstudio/commit/10cb77ee823f47571087d9a71e097d56b79b1af2", "message": "annotate inotify errors with better message", "committedDate": "2020-09-29T23:57:04Z", "type": "commit"}, {"oid": "10cb77ee823f47571087d9a71e097d56b79b1af2", "url": "https://github.com/rstudio/rstudio/commit/10cb77ee823f47571087d9a71e097d56b79b1af2", "message": "annotate inotify errors with better message", "committedDate": "2020-09-29T23:57:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc4MzczMg==", "url": "https://github.com/rstudio/rstudio/pull/7916#discussion_r497783732", "bodyText": "Could we call this systemCallError instead?", "author": "MariaSemple", "createdAt": "2020-09-30T20:34:07Z", "path": "src/cpp/shared_core/include/shared_core/Error.hpp", "diffHunk": "@@ -709,6 +709,36 @@ Error systemError(\n    const Error& in_cause,\n    const ErrorLocation& in_location);\n \n+/**\n+ * @brief Function which creates a system error associated with a particular system call.\n+ *\n+ * @param in_function        The error message to associate with this error.\n+ * @param in_code            The error code (typically errno).\n+ * @param in_location        The location of the error.\n+ *\n+ * @return A system error.\n+ */\n+Error syscallError(", "originalCommit": "10cb77ee823f47571087d9a71e097d56b79b1af2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc4NDY3MA==", "url": "https://github.com/rstudio/rstudio/pull/7916#discussion_r497784670", "bodyText": "I think the description here would be more accurate if it were something like The system function for which this error occurred.", "author": "MariaSemple", "createdAt": "2020-09-30T20:35:59Z", "path": "src/cpp/shared_core/include/shared_core/Error.hpp", "diffHunk": "@@ -709,6 +709,36 @@ Error systemError(\n    const Error& in_cause,\n    const ErrorLocation& in_location);\n \n+/**\n+ * @brief Function which creates a system error associated with a particular system call.\n+ *\n+ * @param in_function        The error message to associate with this error.", "originalCommit": "10cb77ee823f47571087d9a71e097d56b79b1af2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwMTQyNQ==", "url": "https://github.com/rstudio/rstudio/pull/7916#discussion_r497801425", "bodyText": "You're right -- I had forgotten to update the text here; thanks for catching that.", "author": "kevinushey", "createdAt": "2020-09-30T21:08:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc4NDY3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc4Nzc1Mw==", "url": "https://github.com/rstudio/rstudio/pull/7916#discussion_r497787753", "bodyText": "Can this be entirely defined in the cpp file? Once I pull these changes to the SDK (and release it) it will become very difficult to make signature changes to any functions in public headers (Error.hpp is a public header in the SDK).", "author": "MariaSemple", "createdAt": "2020-09-30T20:42:08Z", "path": "src/cpp/shared_core/include/shared_core/Error.hpp", "diffHunk": "@@ -735,6 +765,8 @@ Error unknownError(const std::string& in_message, const ErrorLocation& in_locati\n  */\n Error unknownError(const std::string& in_message, const Error& in_cause, const ErrorLocation& in_location);\n \n+// returns the error message associated with a particular system error code\n+std::string systemErrorMessage(int code);", "originalCommit": "10cb77ee823f47571087d9a71e097d56b79b1af2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgwNjMwMA==", "url": "https://github.com/rstudio/rstudio/pull/7916#discussion_r497806300", "bodyText": "I've made a compromise here:\n\nError.cpp (in shared_core) gets its own inline version, just so that we avoid changing the public interface for the SDK;\nSystem.hpp (in core) gets a public version, which can be used by other 'core' utilities (and so LinuxFileMonitor).\n\nDoes that sound reasonable?", "author": "kevinushey", "createdAt": "2020-09-30T21:18:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc4Nzc1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgzOTkxNw==", "url": "https://github.com/rstudio/rstudio/pull/7916#discussion_r497839917", "bodyText": "Ah - I missed that usage in LinuxFileMonitor, my mistake. I think it's fine to leave it the other way. I should be able move the declaration to the cpp file with my pull-shared-core.sh script. I believe I'm doing that for another function elsewhere already.", "author": "MariaSemple", "createdAt": "2020-09-30T22:38:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc4Nzc1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg1Mjg1MA==", "url": "https://github.com/rstudio/rstudio/pull/7916#discussion_r497852850", "bodyText": "Done -- thanks!", "author": "kevinushey", "createdAt": "2020-09-30T23:18:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc4Nzc1Mw=="}], "type": "inlineReview"}, {"oid": "b790d8810484500633a60b4f1114916611c63bac", "url": "https://github.com/rstudio/rstudio/commit/b790d8810484500633a60b4f1114916611c63bac", "message": "address PR feedback", "committedDate": "2020-09-30T21:06:21Z", "type": "commit"}, {"oid": "615fc44f8e01e184997f85dab23830854984c25f", "url": "https://github.com/rstudio/rstudio/commit/615fc44f8e01e184997f85dab23830854984c25f", "message": "move back to shared_core", "committedDate": "2020-09-30T23:17:08Z", "type": "commit"}, {"oid": "601eba3c82be5c567b04a1001f17c990e6e8290b", "url": "https://github.com/rstudio/rstudio/commit/601eba3c82be5c567b04a1001f17c990e6e8290b", "message": "missed rename", "committedDate": "2020-09-30T23:18:02Z", "type": "commit"}]}