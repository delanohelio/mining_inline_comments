{"pr_number": 1705, "pr_title": "Fix and cleanup logging in ExecUtil", "pr_createdAt": "2020-10-08T20:39:58Z", "pr_url": "https://github.com/openhab/openhab-core/pull/1705", "timeline": [{"oid": "37bd9abbdc992a0aa50f543569cddf5eaf7079b9", "url": "https://github.com/openhab/openhab-core/commit/37bd9abbdc992a0aa50f543569cddf5eaf7079b9", "message": "Fix and cleanup logging in ExecUtil\n\nSigned-off-by: Connor Petty <mistercpp2000+gitsignoff@gmail.com>", "committedDate": "2020-10-08T20:39:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4MTE2MQ==", "url": "https://github.com/openhab/openhab-core/pull/1705#discussion_r502881161", "bodyText": "I would keep logging this as WARN level here as the severity isn't reduced, just because debug logging is enabled. All that is added is that the exception will be logged in that case.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            logger.debug(\"Error occurred when executing commandLine '{}'\", Arrays.toString(commandLine),\n          \n          \n            \n                            logger.warn(\"Error occurred when executing commandLine '{}'\", Arrays.toString(commandLine),", "author": "kaikreuzer", "createdAt": "2020-10-11T08:01:03Z", "path": "bundles/org.openhab.core.io.net/src/main/java/org/openhab/core/io/net/exec/ExecUtil.java", "diffHunk": "@@ -104,22 +105,33 @@ public static void executeCommandLine(String... commandLine) {\n             } else if (process.waitFor(timeout.toMillis(), TimeUnit.MILLISECONDS)) {\n                 exitCode = process.exitValue();\n             } else {\n-                logger.warn(\"Timeout occurred when executing commandLine '{}'\", commandLine);\n+                logger.warn(\"Timeout occurred when executing commandLine '{}'\", Arrays.toString(commandLine));\n                 break cleanup;\n             }\n             if (exitCode == 0) {\n                 return outputFuture.get();\n             } else {\n-                logger.debug(\"exit code '{}', result '{}', errors '{}'\", exitCode, outputFuture.get(),\n-                        errorFuture.get());\n+                if (logger.isDebugEnabled()) {\n+                    logger.debug(\"exit code '{}', result '{}', errors '{}'\", exitCode, outputFuture.get(),\n+                            errorFuture.get());\n+                }\n                 return null;\n             }\n         } catch (ExecutionException e) {\n-            logger.warn(\"Error occurred when executing commandLine '{}'\", commandLine, e.getCause());\n+            if (logger.isDebugEnabled()) {\n+                logger.debug(\"Error occurred when executing commandLine '{}'\", Arrays.toString(commandLine),", "originalCommit": "37bd9abbdc992a0aa50f543569cddf5eaf7079b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk0NzU4MA==", "url": "https://github.com/openhab/openhab-core/pull/1705#discussion_r502947580", "bodyText": "done", "author": "cpmeister", "createdAt": "2020-10-11T18:09:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4MTE2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4MTIwMQ==", "url": "https://github.com/openhab/openhab-core/pull/1705#discussion_r502881201", "bodyText": "dito\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            logger.debug(\"Failed to execute commandLine '{}'\", Arrays.toString(commandLine), e);\n          \n          \n            \n                            logger.warn(\"Failed to execute commandLine '{}'\", Arrays.toString(commandLine), e);", "author": "kaikreuzer", "createdAt": "2020-10-11T08:01:17Z", "path": "bundles/org.openhab.core.io.net/src/main/java/org/openhab/core/io/net/exec/ExecUtil.java", "diffHunk": "@@ -104,22 +105,33 @@ public static void executeCommandLine(String... commandLine) {\n             } else if (process.waitFor(timeout.toMillis(), TimeUnit.MILLISECONDS)) {\n                 exitCode = process.exitValue();\n             } else {\n-                logger.warn(\"Timeout occurred when executing commandLine '{}'\", commandLine);\n+                logger.warn(\"Timeout occurred when executing commandLine '{}'\", Arrays.toString(commandLine));\n                 break cleanup;\n             }\n             if (exitCode == 0) {\n                 return outputFuture.get();\n             } else {\n-                logger.debug(\"exit code '{}', result '{}', errors '{}'\", exitCode, outputFuture.get(),\n-                        errorFuture.get());\n+                if (logger.isDebugEnabled()) {\n+                    logger.debug(\"exit code '{}', result '{}', errors '{}'\", exitCode, outputFuture.get(),\n+                            errorFuture.get());\n+                }\n                 return null;\n             }\n         } catch (ExecutionException e) {\n-            logger.warn(\"Error occurred when executing commandLine '{}'\", commandLine, e.getCause());\n+            if (logger.isDebugEnabled()) {\n+                logger.debug(\"Error occurred when executing commandLine '{}'\", Arrays.toString(commandLine),\n+                        e.getCause());\n+            } else {\n+                logger.warn(\"Error occurred when executing commandLine '{}'\", Arrays.toString(commandLine));\n+            }\n         } catch (InterruptedException e) {\n-            logger.debug(\"commandLine '{}' was interrupted\", commandLine, e);\n+            logger.debug(\"commandLine '{}' was interrupted\", Arrays.toString(commandLine), e);\n         } catch (IOException e) {\n-            logger.warn(\"Error occurred when executing commandLine '{}'\", commandLine, e);\n+            if (logger.isDebugEnabled()) {\n+                logger.debug(\"Failed to execute commandLine '{}'\", Arrays.toString(commandLine), e);", "originalCommit": "37bd9abbdc992a0aa50f543569cddf5eaf7079b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk0NzU5OQ==", "url": "https://github.com/openhab/openhab-core/pull/1705#discussion_r502947599", "bodyText": "done", "author": "cpmeister", "createdAt": "2020-10-11T18:10:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4MTIwMQ=="}], "type": "inlineReview"}, {"oid": "1ad284c8ad8bf7584160567707a37f0d0a07d503", "url": "https://github.com/openhab/openhab-core/commit/1ad284c8ad8bf7584160567707a37f0d0a07d503", "message": "Change suggestions\n\nSigned-off-by: Connor Petty <mistercpp2000+gitsignoff@gmail.com>", "committedDate": "2020-10-11T18:09:15Z", "type": "commit"}]}