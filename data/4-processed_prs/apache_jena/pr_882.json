{"pr_number": 882, "pr_title": "JENA-2009: Implement Visitor Pattern for SHACL Constraints", "pr_createdAt": "2020-12-07T13:19:23Z", "pr_url": "https://github.com/apache/jena/pull/882", "timeline": [{"oid": "9cb9c55084d8321e0078fcce7d5b23b013ac7085", "url": "https://github.com/apache/jena/commit/9cb9c55084d8321e0078fcce7d5b23b013ac7085", "message": "Implement Visitor Pattern for SHACL Constraints", "committedDate": "2020-12-07T13:05:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzUzNDIyMQ==", "url": "https://github.com/apache/jena/pull/882#discussion_r537534221", "bodyText": "This one can be skipped.  It's a dummy that only exists to carry a message. It can't be an executable constraint.", "author": "afs", "createdAt": "2020-12-07T14:09:19Z", "path": "jena-shacl/src/main/java/org/apache/jena/shacl/parser/ConstraintVisitor.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.jena.shacl.parser;\n+\n+import org.apache.jena.shacl.engine.constraint.*;\n+\n+public interface ConstraintVisitor {\n+    default void visit(ReportConstraint constraint){}", "originalCommit": "9cb9c55084d8321e0078fcce7d5b23b013ac7085", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU2MDU1NQ==", "url": "https://github.com/apache/jena/pull/882#discussion_r537560555", "bodyText": "We must implement ReportConstraint.visit(ConstraintVisitor), though. Empty implementation for minimal friction?", "author": "fkleedorfer", "createdAt": "2020-12-07T14:43:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzUzNDIyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzYyNzIwMA==", "url": "https://github.com/apache/jena/pull/882#discussion_r537627200", "bodyText": "That'll do fine. The validation operations are throw new UnsupportedOperationException() but no-op works just as well for the visitor. (I suspect that ReportConstraint shouldn't exist at all! But from memory, passing the information it carries means adding other parameters in many places which even if purer, is verbose.)", "author": "afs", "createdAt": "2020-12-07T16:07:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzUzNDIyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzUzNjk1MQ==", "url": "https://github.com/apache/jena/pull/882#discussion_r537536951", "bodyText": "Move to be with ClassConstaint.  (The ideal order is as in section 4: https://www.w3.org/TR/shacl/#core-components).\nThe J* then go separately.\nWe'll need a \"ConstraitExt\" for extensions (not a strong point of the visitor pattern!) but that can wait for now.", "author": "afs", "createdAt": "2020-12-07T14:12:50Z", "path": "jena-shacl/src/main/java/org/apache/jena/shacl/parser/ConstraintVisitor.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.jena.shacl.parser;\n+\n+import org.apache.jena.shacl.engine.constraint.*;\n+\n+public interface ConstraintVisitor {\n+    default void visit(ReportConstraint constraint){}\n+    default void visit(SparqlConstraint constraint){}\n+    default void visit(ConstraintComponentSPARQL constraint){}\n+    default void visit(UniqueLangConstraint constraint){}\n+    default void visit(HasValueConstraint constraint){}\n+    default void visit(MinCount constraint){}\n+    default void visit(MaxCount constraint){}\n+    default void visit(ShXone constraint){}\n+    default void visit(ShAnd constraint){}\n+    default void visit(ShOr constraint){}\n+    default void visit(ShNot constraint){}\n+    default void visit(ShNode constraint){}\n+    default void visit(QualifiedValueShape constraint){}\n+    default void visit(LessThanOrEqualsConstraint constraint){}\n+    default void visit(DisjointConstraint constraint){}\n+    default void visit(EqualsConstraint constraint){}\n+    default void visit(LessThanConstraint constraint){}\n+    default void visit(ClosedConstraint constraint){}\n+    default void visit(ClassConstraint constraint){}\n+    default void visit(StrMaxLengthConstraint constraint){}\n+    default void visit(StrLanguageIn constraint){}\n+    default void visit(StrMinLengthConstraint constraint){}\n+    default void visit(JViolationConstraint constraint){}\n+    default void visit(DatatypeConstraint constraint){}", "originalCommit": "9cb9c55084d8321e0078fcce7d5b23b013ac7085", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8d644606b43f81296435d797d530f086c806724a", "url": "https://github.com/apache/jena/commit/8d644606b43f81296435d797d530f086c806724a", "message": "Move visit method to consistent position in class", "committedDate": "2020-12-07T14:26:00Z", "type": "commit"}, {"oid": "adf4149e1856c639429f5a76753523d56d1dfd12", "url": "https://github.com/apache/jena/commit/adf4149e1856c639429f5a76753523d56d1dfd12", "message": "Add ConstraintVisitorBase\n\nAlso remove empty default implementations in ConstraintVisitor", "committedDate": "2020-12-07T14:37:01Z", "type": "commit"}, {"oid": "93071ce4adc1d249d5867bbed9459afaa0be73c7", "url": "https://github.com/apache/jena/commit/93071ce4adc1d249d5867bbed9459afaa0be73c7", "message": "Exclude ReportConstraint from VisitorPattern", "committedDate": "2020-12-07T14:44:46Z", "type": "commit"}, {"oid": "563a500af04896b495e513faf45a8cff53210c6a", "url": "https://github.com/apache/jena/commit/563a500af04896b495e513faf45a8cff53210c6a", "message": "Reorder visitor methods\n\n... to reflect order in in W3C SHACL 1.0 Recommendation", "committedDate": "2020-12-07T14:59:05Z", "type": "commit"}]}