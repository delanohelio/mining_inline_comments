{"pr_number": 12046, "pr_title": "Fixed GSON parsing error when using configuration string", "pr_createdAt": "2020-04-10T01:20:10Z", "pr_url": "https://github.com/cdapio/cdap/pull/12046", "timeline": [{"oid": "3bc579b878aae4c35ae9f97f39e1083c52597e2f", "url": "https://github.com/cdapio/cdap/commit/3bc579b878aae4c35ae9f97f39e1083c52597e2f", "message": "Fixed JSON parsing error and added tests for deploying with configuration", "committedDate": "2020-04-10T01:18:29Z", "type": "commit"}, {"oid": "04aeca5d86a93462532273e307298ba8fd81409a", "url": "https://github.com/cdapio/cdap/commit/04aeca5d86a93462532273e307298ba8fd81409a", "message": "Minor renaming", "committedDate": "2020-04-10T01:27:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MDI2Mw==", "url": "https://github.com/cdapio/cdap/pull/12046#discussion_r406560263", "bodyText": "nit - I dont think we need this", "author": "yaojiefeng", "createdAt": "2020-04-10T01:28:45Z", "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/gateway/handlers/AppLifecycleHttpHandler.java", "diffHunk": "@@ -391,7 +391,7 @@ public void updateApp(FullHttpRequest request, HttpResponder responder,\n    * ]\n    * }\n    * </pre>\n-   *\n+   * <p>", "originalCommit": "04aeca5d86a93462532273e307298ba8fd81409a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MDkzNg==", "url": "https://github.com/cdapio/cdap/pull/12046#discussion_r406560936", "bodyText": "Removed", "author": "MEseifan", "createdAt": "2020-04-10T01:32:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MDI2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MDUzMw==", "url": "https://github.com/cdapio/cdap/pull/12046#discussion_r406560533", "bodyText": "This might break unit test as some test might depend on the config, is this required for your unit test? If not lets not make this change", "author": "yaojiefeng", "createdAt": "2020-04-10T01:29:50Z", "path": "cdap-app-fabric/src/test/java/io/cdap/cdap/internal/app/services/http/AppFabricTestBase.java", "diffHunk": "@@ -530,7 +530,7 @@ protected HttpResponse deploy(Class<?> application, int expectedCode, @Nullable\n   }\n \n   protected HttpResponse deploy(Id.Application appId,\n-                                AppRequest<? extends Config> appRequest) throws Exception {\n+                                AppRequest<?> appRequest) throws Exception {", "originalCommit": "04aeca5d86a93462532273e307298ba8fd81409a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MTIyNg==", "url": "https://github.com/cdapio/cdap/pull/12046#discussion_r406561226", "bodyText": "This is needed for my test since I need to test with a configuration of type String which doesnt work with ? extends Config. I'm running all other tests that use this base to verify it didnt break them", "author": "MEseifan", "createdAt": "2020-04-10T01:33:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MDUzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MjMwNw==", "url": "https://github.com/cdapio/cdap/pull/12046#discussion_r406562307", "bodyText": "ok, let's just ensure the bamboo build passes.", "author": "yaojiefeng", "createdAt": "2020-04-10T01:38:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MDUzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MDY1Ng==", "url": "https://github.com/cdapio/cdap/pull/12046#discussion_r406560656", "bodyText": "just want to check - this test will fail without the fix right?", "author": "yaojiefeng", "createdAt": "2020-04-10T01:30:29Z", "path": "cdap-app-fabric/src/test/java/io/cdap/cdap/internal/app/services/http/handlers/AppLifecycleHttpHandlerTest.java", "diffHunk": "@@ -115,6 +115,43 @@ public void testAppWithConfig() throws Exception {\n     deleteArtifact(artifactId, 200);\n   }\n \n+  @Test\n+  public void testAppWithConfigurationString() throws Exception {\n+    Id.Application appId = Id.Application.from(Id.Namespace.DEFAULT, \"ConfigApp\");\n+    Id.Artifact artifactId = Id.Artifact.from(Id.Namespace.DEFAULT, \"appWithConfig\", \"1.0.0-SNAPSHOT\");\n+    HttpResponse response = addAppArtifact(artifactId, ConfigTestApp.class);\n+    Assert.assertEquals(200, response.getResponseCode());\n+\n+    ConfigTestApp.ConfigClass configuration = new ConfigTestApp.ConfigClass(\"abc\", \"def\");\n+    String configurationString = GSON.toJson(configuration);\n+    response = deploy(appId, new AppRequest<>(ArtifactSummary.from(artifactId.toArtifactId()), null, null, null, null,\n+                                              configurationString));", "originalCommit": "04aeca5d86a93462532273e307298ba8fd81409a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MTI5Nw==", "url": "https://github.com/cdapio/cdap/pull/12046#discussion_r406561297", "bodyText": "yes I removed the change and ran this test and it failed", "author": "MEseifan", "createdAt": "2020-04-10T01:33:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU2MDY1Ng=="}], "type": "inlineReview"}, {"oid": "d9883a6a15d16d2b6b57cfb57353331811adcb5e", "url": "https://github.com/cdapio/cdap/commit/d9883a6a15d16d2b6b57cfb57353331811adcb5e", "message": "Removed random p tag that was added", "committedDate": "2020-04-10T02:08:05Z", "type": "commit"}]}