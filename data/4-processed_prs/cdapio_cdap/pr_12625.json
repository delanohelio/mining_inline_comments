{"pr_number": 12625, "pr_title": "[CDAP-17142] Fixes deleting all the rows in a schema", "pr_createdAt": "2020-08-11T18:06:31Z", "pr_url": "https://github.com/cdapio/cdap/pull/12625", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgxMjUzNg==", "url": "https://github.com/cdapio/cdap/pull/12625#discussion_r468812536", "bodyText": "I believe if (!Array.isArray(fields) || !fields) could also work.", "author": "jennac3", "createdAt": "2020-08-11T19:24:08Z", "path": "cdap-ui/app/cdap/components/PluginSchemaEditor/index.tsx", "diffHunk": "@@ -441,7 +441,12 @@ class PluginSchemaEditorBase extends React.PureComponent<\n           disabled={this.props.disabled}\n           onChange={({ avroSchema }) => {\n             const newSchemas = [...this.props.schemas];\n-            newSchemas[i] = avroSchema;\n+            const fields = objectQuery(avroSchema, 'schema', 'fields');\n+            if (!Array.isArray(fields) || !fields.length) {", "originalCommit": "ab80d5807c9874e11f452210baf1db6599b9cfe0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ2NzM1Mg==", "url": "https://github.com/cdapio/cdap/pull/12625#discussion_r477467352", "bodyText": "This will not check for empty arrays", "author": "ajainarayanan", "createdAt": "2020-08-26T17:26:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgxMjUzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgxMjc2Ng==", "url": "https://github.com/cdapio/cdap/pull/12625#discussion_r468812766", "bodyText": "maybe we can try something like const fields = (avroSchema || getDefaultEmptyAvroSchema()).schema.fields;, if this does not work we can also try ternary.", "author": "jennac3", "createdAt": "2020-08-11T19:24:33Z", "path": "cdap-ui/app/cdap/components/AbstractWidget/SchemaEditor/Context/SchemaParser.ts", "diffHunk": "@@ -412,7 +412,10 @@ function parseSubTree(field: IFieldType | IFieldTypeNullable): INode {\n  */\n function parseSchema(avroSchema: ISchemaType): INode {\n   const name = avroSchema.name || 'etlSchemaBody';\n-  const fields = avroSchema.schema.fields;\n+  let fields = avroSchema.schema.fields;", "originalCommit": "ab80d5807c9874e11f452210baf1db6599b9cfe0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ2Nzc2Nw==", "url": "https://github.com/cdapio/cdap/pull/12625#discussion_r477467767", "bodyText": "Checking for fields seemed more specific and easier to read. But I see the concern of using dot operator and have used objectQuery to make sure it is safe.", "author": "ajainarayanan", "createdAt": "2020-08-26T17:27:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgxMjc2Ng=="}], "type": "inlineReview"}, {"oid": "0776f5dae7a43d9f39dfac013aaa946c27a34099", "url": "https://github.com/cdapio/cdap/commit/0776f5dae7a43d9f39dfac013aaa946c27a34099", "message": "[CDAP-17142] Fixes deleting all the rows in a schema", "committedDate": "2020-08-26T17:26:00Z", "type": "commit"}, {"oid": "0776f5dae7a43d9f39dfac013aaa946c27a34099", "url": "https://github.com/cdapio/cdap/commit/0776f5dae7a43d9f39dfac013aaa946c27a34099", "message": "[CDAP-17142] Fixes deleting all the rows in a schema", "committedDate": "2020-08-26T17:26:00Z", "type": "forcePushed"}]}