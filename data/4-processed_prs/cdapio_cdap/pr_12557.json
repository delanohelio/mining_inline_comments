{"pr_number": 12557, "pr_title": "[CDAP-17150] Avoid displaying JSON in schema validation errors", "pr_createdAt": "2020-08-03T20:31:50Z", "pr_url": "https://github.com/cdapio/cdap/pull/12557", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0ODY5Mw==", "url": "https://github.com/cdapio/cdap/pull/12557#discussion_r464648693", "bodyText": "nit: we may also do if (e.message.includes('duplicate field name')", "author": "jennac3", "createdAt": "2020-08-03T20:37:03Z", "path": "cdap-ui/app/cdap/components/AbstractWidget/SchemaEditor/SchemaValidator/index.tsx", "diffHunk": "@@ -101,6 +101,11 @@ class SchemaValidatorProvider extends React.Component<ISchemaValidatorProviderPr\n         const entireSchema = SchemaGenerator(schemaTree);\n         cdapavsc.parse(entireSchema.schema, { wrapUnions: true });\n       } catch (e) {\n+        // TODO: CDAP-17152. We don't have specific fields that are duplicate today.\n+        // We should improve the way we validate the avro schema\n+        if (e.message.indexOf('duplicate field name') !== -1) {", "originalCommit": "e01745028d7534e7b549328c3b8fd174352e8c69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY1MjExNw==", "url": "https://github.com/cdapio/cdap/pull/12557#discussion_r464652117", "bodyText": "We could but I don't see any specific advantage of using includes over indexOf. Do you see it as a better API?", "author": "ajainarayanan", "createdAt": "2020-08-03T20:44:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0ODY5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY1NDM4MA==", "url": "https://github.com/cdapio/cdap/pull/12557#discussion_r464654380", "bodyText": "Since we're checking whether it includes plain string, I don't think it matters too much.", "author": "jennac3", "createdAt": "2020-08-03T20:49:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0ODY5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0ODcyNw==", "url": "https://github.com/cdapio/cdap/pull/12557#discussion_r464648727", "bodyText": "nit: we may also do if (e.message.includes('duplicate field name')", "author": "jennac3", "createdAt": "2020-08-03T20:37:07Z", "path": "cdap-ui/app/cdap/components/AbstractWidget/SchemaEditor/SchemaValidator/index.tsx", "diffHunk": "@@ -110,6 +115,11 @@ class SchemaValidatorProvider extends React.Component<ISchemaValidatorProviderPr\n       try {\n         cdapavsc.parse(avroSchema, { wrapUnions: true });\n       } catch (e) {\n+        // TODO: CDAP-17152. We don't have specific fields that are duplicate today.\n+        // We should improve the way we validate the avro schema\n+        if (e.message.indexOf('duplicate field name') !== -1) {", "originalCommit": "e01745028d7534e7b549328c3b8fd174352e8c69", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "90c8b0c705f7c1de4d77ab0dffc1821efb230009", "url": "https://github.com/cdapio/cdap/commit/90c8b0c705f7c1de4d77ab0dffc1821efb230009", "message": "[CDAP-17150] Avoid displaying JSON in schema validation errors", "committedDate": "2020-08-04T00:21:37Z", "type": "commit"}, {"oid": "90c8b0c705f7c1de4d77ab0dffc1821efb230009", "url": "https://github.com/cdapio/cdap/commit/90c8b0c705f7c1de4d77ab0dffc1821efb230009", "message": "[CDAP-17150] Avoid displaying JSON in schema validation errors", "committedDate": "2020-08-04T00:21:37Z", "type": "forcePushed"}]}