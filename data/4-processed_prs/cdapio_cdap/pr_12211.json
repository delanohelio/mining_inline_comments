{"pr_number": 12211, "pr_title": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)", "pr_createdAt": "2020-05-27T17:33:43Z", "pr_url": "https://github.com/cdapio/cdap/pull/12211", "timeline": [{"oid": "99b7f5b1bb2ad7d963af40f0313b546ce42207d3", "url": "https://github.com/cdapio/cdap/commit/99b7f5b1bb2ad7d963af40f0313b546ce42207d3", "message": "[CDAP-16862] Define properties under each configuration group (widget JSON)", "committedDate": "2020-05-27T20:33:09Z", "type": "forcePushed"}, {"oid": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "url": "https://github.com/cdapio/cdap/commit/f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)", "committedDate": "2020-06-01T19:05:02Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNTY4Nw==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434305687", "bodyText": "Thats a little dangerous and takes away the essential use of css-in-js. This one component controls every single element rendered within itself. Will introduce issues when things change in unexpected places. Can we reconsider this?", "author": "ajainarayanan", "createdAt": "2020-06-03T04:49:07Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput/index.tsx", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { WIDGET_TYPES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    widgetInput: {\n+      '& > *': {", "originalCommit": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwMjc1OA==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r435902758", "bodyText": "I assigned widgetInput to each child instead, so that it has the same styling without  using & > *'.", "author": "jennac3", "createdAt": "2020-06-05T12:56:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNTY4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwMjgwNg==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r435902806", "bodyText": "changed!", "author": "jennac3", "createdAt": "2020-06-05T12:56:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNTY4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjM1NQ==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434306355", "bodyText": "nit: Is the category plugin? Can this be a dropdown with only one value. We really don't want the user to type this in.", "author": "ajainarayanan", "createdAt": "2020-06-03T04:51:34Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput/index.tsx", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { WIDGET_TYPES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    widgetInput: {\n+      '& > *': {\n+        width: '100%',\n+        marginTop: '10px',\n+        marginBottom: '10px',\n+      },\n+    },\n+  };\n+};\n+\n+interface IWidgetInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  widgetID: number;\n+}\n+\n+const WidgetInputView: React.FC<IWidgetInputProps> = ({\n+  classes,\n+  widgetID,\n+  widgetToInfo,\n+  setWidgetToInfo,\n+}) => {\n+  function onNameChange(obj, id) {\n+    return (name) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, name } }));\n+    };\n+  }\n+\n+  function onLabelChange(obj, id) {\n+    return (label) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, label } }));\n+    };\n+  }\n+\n+  function onWidgetTypeChange(obj, id) {\n+    return (widgetType) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, widgetType } }));\n+    };\n+  }\n+\n+  function onWidgetCategoryChange(obj, id) {\n+    return (widgetCategory) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, widgetCategory } }));\n+    };\n+  }\n+\n+  const widgetInfo = widgetToInfo[widgetID];\n+\n+  return (\n+    <If condition={widgetInfo}>\n+      <div className={classes.widgetInput}>\n+        <PluginInput\n+          widgetType={'textbox'}\n+          value={widgetInfo.name}\n+          setValue={onNameChange(widgetInfo, widgetID)}\n+          label={'Name'}\n+          placeholder={'Name a Widget'}\n+          required={false}\n+        />\n+        <PluginInput\n+          widgetType={'textbox'}\n+          value={widgetInfo.label}\n+          setValue={onLabelChange(widgetInfo, widgetID)}\n+          label={'Label'}\n+          placeholder={'Label a Widget'}\n+          required={false}\n+        />\n+        <PluginInput\n+          widgetType={'textbox'}", "originalCommit": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwMzIyMw==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r435903223", "bodyText": "changed!\nNow it is a select widget with options=['plugin'].", "author": "jennac3", "createdAt": "2020-06-05T12:57:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjM1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjQzNw==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434306437", "bodyText": "nit: relative to components path.", "author": "ajainarayanan", "createdAt": "2020-06-03T04:51:57Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+import WidgetActionButtons from './WidgetActionButtons';", "originalCommit": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwMzU3OQ==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r435903579", "bodyText": "Changed!", "author": "jennac3", "createdAt": "2020-06-05T12:58:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjQzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjQ5NA==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434306494", "bodyText": "Same here.", "author": "ajainarayanan", "createdAt": "2020-06-03T04:52:08Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+import WidgetActionButtons from './WidgetActionButtons';\n+import WidgetInput from './WidgetInput';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    widgetInputs: {\n+      '& > *': {", "originalCommit": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNDAwNQ==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r435904005", "bodyText": "Changed!", "author": "jennac3", "createdAt": "2020-06-05T12:58:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNjQ5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzAyNQ==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434307025", "bodyText": "Can we pull this style into this component and remove plain css or scss usage?", "author": "ajainarayanan", "createdAt": "2020-06-03T04:54:18Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,178 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+import WidgetActionButtons from './WidgetActionButtons';\n+import WidgetInput from './WidgetInput';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    widgetInputs: {\n+      '& > *': {\n+        marginTop: '20px',\n+        marginBottom: '20px',\n+      },\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+    widgetDivider: {\n+      width: '100%',\n+    },\n+  };\n+};\n+\n+interface IWidgetCollectionProps extends WithStyles<typeof styles>, ICreateContext {\n+  groupID: number;\n+}\n+\n+const WidgetCollectionView: React.FC<IWidgetCollectionProps> = ({\n+  classes,\n+  groupID,\n+  widgetToInfo,\n+  groupToWidgets,\n+  setWidgetToInfo,\n+  setGroupToWidgets,\n+}) => {\n+  const [activeWidgets, setActiveWidgets] = React.useState(groupID ? groupToWidgets[groupID] : []);\n+\n+  React.useEffect(() => {\n+    if (groupID) {\n+      setActiveWidgets(groupToWidgets[groupID]);\n+    } else {\n+      setActiveWidgets([]);\n+    }\n+  }, [groupToWidgets]);\n+\n+  function addWidgetToGroup(index: number) {\n+    return () => {\n+      const newWidgetID = 'Widget_' + uuidV4();\n+\n+      // Add a new widget's ID at the specified index\n+      const newWidgets = [...activeWidgets];\n+      if (newWidgets.length === 0) {\n+        newWidgets.splice(0, 0, newWidgetID);\n+      } else {\n+        newWidgets.splice(index + 1, 0, newWidgetID);\n+      }\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      // Set the default empty properties of the widget\n+      setWidgetToInfo({\n+        ...widgetToInfo,\n+        [newWidgetID]: {\n+          widgetType: '',\n+          label: '',\n+          name: '',\n+        } as IWidgetInfo,\n+      });\n+    };\n+  }\n+\n+  function deleteWidgetFromGroup(widgetIndex) {\n+    return () => {\n+      // Grab the widget ID to delete\n+      const widgetToDelete = activeWidgets[widgetIndex];\n+\n+      const newWidgets = [...activeWidgets];\n+      newWidgets.splice(widgetIndex, 1);\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      const { [widgetToDelete]: info, ...restWidgetToInfo } = widgetToInfo;\n+      setWidgetToInfo(restWidgetToInfo);\n+    };\n+  }\n+\n+  return (\n+    <div className={classes.nestedWidgets} data-cy=\"widget-wrapper-container\">\n+      <div className={`widget-wrapper-label ${classes.addWidgetLabel}`}>", "originalCommit": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNDI5MQ==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r435904291", "bodyText": "Changed!", "author": "jennac3", "createdAt": "2020-06-05T12:59:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzAyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzQ2Mw==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434307463", "bodyText": "Is it possible to type this? Typing this partially atleast would be helpful. Using typescript and using any takes away the advantage of using typescript.", "author": "ajainarayanan", "createdAt": "2020-06-03T04:55:58Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/index.tsx", "diffHunk": "@@ -67,6 +67,14 @@ class CreateView extends React.PureComponent<ICreateContext & WithStyles<typeof\n     this.setState({ groupToInfo });\n   };\n \n+  public setGroupToWidgets = (groupToWidgets: any) => {", "originalCommit": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDgzMzk2Mg==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434833962", "bodyText": "#12251 addresses this issue by defining types more specifically! For instance, groupToWidgets is going to be Map<string, List<string>>.", "author": "jennac3", "createdAt": "2020-06-03T20:27:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzQ2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzUxMw==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r434307513", "bodyText": "nit: components relative path.", "author": "ajainarayanan", "createdAt": "2020-06-03T04:56:14Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/steps.tsx", "diffHunk": "@@ -14,8 +14,8 @@\n  * the License.\n  */\n \n-import BasicPluginInfo from 'components/PluginJSONCreator/Create/Content/BasicPluginInfo';\n import ConfigurationGroupsCollection from 'components/PluginJSONCreator/Create/Content/ConfigurationGroupsCollection';\n+import BasicPluginInfo from './Content/BasicPluginInfo';", "originalCommit": "f3cdee8cbf7384c9ca988cb6665bcc8fc6c2e812", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNDg1Nw==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r435904857", "bodyText": "Changed!", "author": "jennac3", "createdAt": "2020-06-05T13:00:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwNzUxMw=="}], "type": "inlineReview"}, {"oid": "4eb68c6d18782a0e1ec14476b940dabde623f50d", "url": "https://github.com/cdapio/cdap/commit/4eb68c6d18782a0e1ec14476b940dabde623f50d", "message": "address comments", "committedDate": "2020-06-03T20:54:51Z", "type": "forcePushed"}, {"oid": "872de537f8f0931c2c7ffe55b55bf92592443080", "url": "https://github.com/cdapio/cdap/commit/872de537f8f0931c2c7ffe55b55bf92592443080", "message": "pull from develop", "committedDate": "2020-06-08T19:45:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkyODc1NQ==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438928755", "bodyText": "this should use forEach", "author": "elfenheart", "createdAt": "2020-06-11T16:49:11Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/ConfigurationGroupsCollection/index.tsx", "diffHunk": "@@ -57,54 +56,74 @@ const ConfigurationGroupsCollectionView: React.FC<ICreateContext & WithStyles<ty\n   setConfigurationGroups,\n   groupToInfo,\n   setGroupToInfo,\n+  groupToWidgets,\n+  setGroupToWidgets,\n+  widgetToInfo,\n+  setWidgetToInfo,\n }) => {\n+  const [activeGroupIndex, setActiveGroupIndex] = React.useState(null);\n   const [localConfigurationGroups, setLocalConfigurationGroups] = React.useState(\n     configurationGroups\n   );\n-  const [activeGroupIndex, setActiveGroupIndex] = React.useState(null);\n   const [localGroupToInfo, setLocalGroupToInfo] = React.useState(groupToInfo);\n+  const [localGroupToWidgets, setLocalGroupToWidgets] = React.useState(groupToWidgets);\n+  const [localWidgetToInfo, setLocalWidgetToInfo] = React.useState(widgetToInfo);\n \n   function addConfigurationGroup(index: number) {\n-    const newGroupID = 'ConfigGroup_' + uuidV4();\n-\n-    // add a new group's ID at the specified index\n-    const newGroups = [...localConfigurationGroups];\n-    if (newGroups.length === 0) {\n-      newGroups.splice(0, 0, newGroupID);\n-    } else {\n-      newGroups.splice(index + 1, 0, newGroupID);\n-    }\n-    setLocalConfigurationGroups(newGroups);\n-\n-    // set the activeGroupIndex to the new group's index\n-    if (newGroups.length <= 1) {\n-      setActiveGroupIndex(0);\n-    } else {\n-      setActiveGroupIndex(index + 1);\n-    }\n-\n-    // set the default label and description of the group\n-    setLocalGroupToInfo({\n-      ...localGroupToInfo,\n-      [newGroupID]: {\n-        label: '',\n-        description: '',\n-      } as IConfigurationGroupInfo,\n-    });\n+    return () => {\n+      const newGroupID = 'ConfigGroup_' + uuidV4();\n+\n+      // Add a new group's ID at the specified index\n+      const newGroups = [...localConfigurationGroups];\n+      if (newGroups.length === 0) {\n+        newGroups.splice(0, 0, newGroupID);\n+      } else {\n+        newGroups.splice(index + 1, 0, newGroupID);\n+      }\n+      setLocalConfigurationGroups(newGroups);\n+\n+      // Set the activeGroupIndex to the new group's index\n+      if (newGroups.length <= 1) {\n+        setActiveGroupIndex(0);\n+      } else {\n+        setActiveGroupIndex(index + 1);\n+      }\n+\n+      // Set the mappings for the newly added group\n+      setLocalGroupToInfo({\n+        ...localGroupToInfo,\n+        [newGroupID]: {\n+          label: '',\n+          description: '',\n+        } as IConfigurationGroupInfo,\n+      });\n+      setLocalGroupToWidgets({ ...localGroupToWidgets, [newGroupID]: [] });\n+    };\n   }\n \n   function deleteConfigurationGroup(index: number) {\n-    setActiveGroupIndex(null);\n-\n-    // delete a group at the specified index\n-    const newGroups = [...localConfigurationGroups];\n-    const groupToDelete = newGroups[index];\n-    newGroups.splice(index, 1);\n-    setLocalConfigurationGroups(newGroups);\n+    return () => {\n+      setActiveGroupIndex(null);\n \n-    // delete the corresponding information of the group\n-    const { [groupToDelete]: info, ...restGroupToInfo } = localGroupToInfo;\n-    setLocalGroupToInfo(restGroupToInfo);\n+      // Delete a group at the specified index\n+      const newGroups = [...localConfigurationGroups];\n+      const groupToDelete = newGroups[index];\n+      newGroups.splice(index, 1);\n+      setLocalConfigurationGroups(newGroups);\n+\n+      // Delete the corresponding data of the group\n+      const { [groupToDelete]: info, ...restGroupToInfo } = localGroupToInfo;\n+      const { [groupToDelete]: widgets, ...restGroupToWidgets } = localGroupToWidgets;\n+      setLocalGroupToInfo(restGroupToInfo);\n+      setLocalGroupToWidgets(restGroupToWidgets);\n+\n+      // Delete all the widget information that belong to the group\n+      const newWidgetToInfo = localWidgetToInfo;\n+      widgets.map((widget) => {", "originalCommit": "aa90989dabe4b1cff0944141cabee82f55d5a46a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ1OTc3Ng==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r439459776", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-12T14:39:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkyODc1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMTEwOQ==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438931109", "bodyText": "the setWidgetToInfo function should only accept the id and the modified object for the argument. The handling of the prevObjs should happen in the implementation of this function for the context", "author": "elfenheart", "createdAt": "2020-06-11T16:53:12Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput/index.tsx", "diffHunk": "@@ -0,0 +1,123 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import { WIDGET_CATEGORY, WIDGET_TYPES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    widgetInput: {\n+      marginTop: '20px',\n+      marginBottom: '20px',\n+    },\n+    widgetField: {\n+      width: '100%',\n+      marginTop: '10px',\n+      marginBottom: '10px',\n+    },\n+  };\n+};\n+\n+interface IWidgetInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  widgetID: number;\n+}\n+\n+const WidgetInputView: React.FC<IWidgetInputProps> = ({\n+  classes,\n+  widgetID,\n+  widgetToInfo,\n+  setWidgetToInfo,\n+}) => {\n+  function onNameChange(obj, id) {\n+    return (name) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, name } }));\n+    };\n+  }\n+\n+  function onLabelChange(obj, id) {\n+    return (label) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, label } }));\n+    };\n+  }\n+\n+  function onWidgetTypeChange(obj, id) {\n+    return (widgetType) => {\n+      setWidgetToInfo((prevObjs) => ({ ...prevObjs, [id]: { ...obj, widgetType } }));", "originalCommit": "aa90989dabe4b1cff0944141cabee82f55d5a46a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ1OTE2NA==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r439459164", "bodyText": "This has been resolved in the PR #12310.\n\n  \n    \n      cdap/cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/ConfigurationGroupPage/GroupPanel/WidgetCollection/WidgetPanel/WidgetInfoInput/index.tsx\n    \n    \n         Line 49\n      in\n      e8a2a5c\n    \n    \n    \n    \n\n        \n          \n           function onNameChange() {", "author": "jennac3", "createdAt": "2020-06-12T14:38:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMTEwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMTYyNA==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438931624", "bodyText": "this seemed dangerous if the screen size is small", "author": "elfenheart", "createdAt": "2020-06-11T16:54:06Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,170 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import WidgetActionButtons from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetActionButtons';\n+import WidgetInput from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',", "originalCommit": "aa90989dabe4b1cff0944141cabee82f55d5a46a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ3MjkwNg==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r439472906", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-12T15:00:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMTYyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMzg5OA==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438933898", "bodyText": "this comment doesn't have to be done in this PR.\nThis useEffect is one source of performance bottleneck. Every time user makes an edit to a widget, the groupToWidgets will get updated, and this useEffect gets triggered everytime. There's probably a better way to set the the activeWidget to prevent rerendering.", "author": "elfenheart", "createdAt": "2020-06-11T16:58:00Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,170 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import WidgetActionButtons from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetActionButtons';\n+import WidgetInput from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+    widgetDivider: {\n+      width: '100%',\n+    },\n+  };\n+};\n+\n+interface IWidgetCollectionProps extends WithStyles<typeof styles>, ICreateContext {\n+  groupID: number;\n+}\n+\n+const WidgetCollectionView: React.FC<IWidgetCollectionProps> = ({\n+  classes,\n+  groupID,\n+  widgetToInfo,\n+  groupToWidgets,\n+  setWidgetToInfo,\n+  setGroupToWidgets,\n+}) => {\n+  const [activeWidgets, setActiveWidgets] = React.useState(groupID ? groupToWidgets[groupID] : []);\n+\n+  React.useEffect(() => {\n+    if (groupID) {\n+      setActiveWidgets(groupToWidgets[groupID]);\n+    } else {\n+      setActiveWidgets([]);\n+    }\n+  }, [groupToWidgets]);", "originalCommit": "aa90989dabe4b1cff0944141cabee82f55d5a46a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ1OTYxMw==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r439459613", "bodyText": "This has been resolved in the PR #12310.\n\n  \n    \n      cdap/cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/ConfigurationGroupPage/GroupPanel/WidgetCollection/index.tsx\n    \n    \n         Line 72\n      in\n      e8a2a5c\n    \n    \n    \n    \n\n        \n          \n           const activeWidgets = groupID ? groupToWidgets.get(groupID) : fromJS([]);", "author": "jennac3", "createdAt": "2020-06-12T14:39:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMzg5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzNDU5OA==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438934598", "bodyText": "did you check javascript console for this? I think <If> expects only 1 children component", "author": "elfenheart", "createdAt": "2020-06-11T16:59:13Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,170 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import WidgetActionButtons from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetActionButtons';\n+import WidgetInput from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+    widgetDivider: {\n+      width: '100%',\n+    },\n+  };\n+};\n+\n+interface IWidgetCollectionProps extends WithStyles<typeof styles>, ICreateContext {\n+  groupID: number;\n+}\n+\n+const WidgetCollectionView: React.FC<IWidgetCollectionProps> = ({\n+  classes,\n+  groupID,\n+  widgetToInfo,\n+  groupToWidgets,\n+  setWidgetToInfo,\n+  setGroupToWidgets,\n+}) => {\n+  const [activeWidgets, setActiveWidgets] = React.useState(groupID ? groupToWidgets[groupID] : []);\n+\n+  React.useEffect(() => {\n+    if (groupID) {\n+      setActiveWidgets(groupToWidgets[groupID]);\n+    } else {\n+      setActiveWidgets([]);\n+    }\n+  }, [groupToWidgets]);\n+\n+  function addWidgetToGroup(index: number) {\n+    return () => {\n+      const newWidgetID = 'Widget_' + uuidV4();\n+\n+      // Add a new widget's ID at the specified index\n+      const newWidgets = [...activeWidgets];\n+      if (newWidgets.length === 0) {\n+        newWidgets.splice(0, 0, newWidgetID);\n+      } else {\n+        newWidgets.splice(index + 1, 0, newWidgetID);\n+      }\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      // Set the default empty properties of the widget\n+      setWidgetToInfo({\n+        ...widgetToInfo,\n+        [newWidgetID]: {\n+          widgetType: '',\n+          label: '',\n+          name: '',\n+        } as IWidgetInfo,\n+      });\n+    };\n+  }\n+\n+  function deleteWidgetFromGroup(widgetIndex) {\n+    return () => {\n+      // Grab the widget ID to delete\n+      const widgetToDelete = activeWidgets[widgetIndex];\n+\n+      const newWidgets = [...activeWidgets];\n+      newWidgets.splice(widgetIndex, 1);\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      const { [widgetToDelete]: info, ...restWidgetToInfo } = widgetToInfo;\n+      setWidgetToInfo(restWidgetToInfo);\n+    };\n+  }\n+\n+  return (\n+    <div className={classes.nestedWidgets} data-cy=\"widget-wrapper-container\">\n+      <div className={classes.addWidgetLabel}>\n+        Add Widgets\n+        <span className={classes.required}>*</span>\n+      </div>\n+      <div className={classes.widgetContainer}>\n+        {activeWidgets.map((widgetID, widgetIndex) => {\n+          return (\n+            <If condition={widgetToInfo[widgetID]}>\n+              <div className={classes.eachWidget}>\n+                <WidgetInput\n+                  widgetToInfo={widgetToInfo}\n+                  widgetID={widgetID}\n+                  setWidgetToInfo={setWidgetToInfo}\n+                />\n+                <WidgetActionButtons\n+                  onAddWidgetToGroup={addWidgetToGroup(widgetIndex)}\n+                  onDeleteWidgetFromGroup={deleteWidgetFromGroup(widgetIndex)}\n+                />\n+              </div>\n+              <If condition={activeWidgets && widgetIndex < activeWidgets.length - 1}>", "originalCommit": "aa90989dabe4b1cff0944141cabee82f55d5a46a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ2NjUwOQ==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r439466509", "bodyText": "Because I have deleted <If condition={widgetToInfo[widgetID]}> in later PR (as noted in the comment above https://github.com/cdapio/cdap/pull/12211/files/aa90989dabe4b1cff0944141cabee82f55d5a46a#r439463982), we no longer have nested If component.", "author": "jennac3", "createdAt": "2020-06-12T14:50:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzNDU5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzNDkyNg==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r438934926", "bodyText": "can widgetToInfo[widgetID] ever not exist?", "author": "elfenheart", "createdAt": "2020-06-11T16:59:51Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/WidgetCollection/index.tsx", "diffHunk": "@@ -0,0 +1,170 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Divider } from '@material-ui/core';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import If from 'components/If';\n+import WidgetActionButtons from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetActionButtons';\n+import WidgetInput from 'components/PluginJSONCreator/Create/Content/WidgetCollection/WidgetInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    eachWidget: {\n+      display: 'grid',\n+      gridTemplateColumns: '5fr 1fr',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+    },\n+    nestedWidgets: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    addWidgetLabel: {\n+      fontSize: '12px',\n+      position: 'absolute',\n+      top: '-10px',\n+      left: '15px',\n+      padding: '0 5px',\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    required: {\n+      fontSize: '14px',\n+      marginLeft: '5px',\n+      lineHeight: '12px',\n+      verticalAlign: 'middle',\n+    },\n+    widgetContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+    widgetDivider: {\n+      width: '100%',\n+    },\n+  };\n+};\n+\n+interface IWidgetCollectionProps extends WithStyles<typeof styles>, ICreateContext {\n+  groupID: number;\n+}\n+\n+const WidgetCollectionView: React.FC<IWidgetCollectionProps> = ({\n+  classes,\n+  groupID,\n+  widgetToInfo,\n+  groupToWidgets,\n+  setWidgetToInfo,\n+  setGroupToWidgets,\n+}) => {\n+  const [activeWidgets, setActiveWidgets] = React.useState(groupID ? groupToWidgets[groupID] : []);\n+\n+  React.useEffect(() => {\n+    if (groupID) {\n+      setActiveWidgets(groupToWidgets[groupID]);\n+    } else {\n+      setActiveWidgets([]);\n+    }\n+  }, [groupToWidgets]);\n+\n+  function addWidgetToGroup(index: number) {\n+    return () => {\n+      const newWidgetID = 'Widget_' + uuidV4();\n+\n+      // Add a new widget's ID at the specified index\n+      const newWidgets = [...activeWidgets];\n+      if (newWidgets.length === 0) {\n+        newWidgets.splice(0, 0, newWidgetID);\n+      } else {\n+        newWidgets.splice(index + 1, 0, newWidgetID);\n+      }\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      // Set the default empty properties of the widget\n+      setWidgetToInfo({\n+        ...widgetToInfo,\n+        [newWidgetID]: {\n+          widgetType: '',\n+          label: '',\n+          name: '',\n+        } as IWidgetInfo,\n+      });\n+    };\n+  }\n+\n+  function deleteWidgetFromGroup(widgetIndex) {\n+    return () => {\n+      // Grab the widget ID to delete\n+      const widgetToDelete = activeWidgets[widgetIndex];\n+\n+      const newWidgets = [...activeWidgets];\n+      newWidgets.splice(widgetIndex, 1);\n+      setGroupToWidgets({\n+        ...groupToWidgets,\n+        [groupID]: newWidgets,\n+      });\n+\n+      const { [widgetToDelete]: info, ...restWidgetToInfo } = widgetToInfo;\n+      setWidgetToInfo(restWidgetToInfo);\n+    };\n+  }\n+\n+  return (\n+    <div className={classes.nestedWidgets} data-cy=\"widget-wrapper-container\">\n+      <div className={classes.addWidgetLabel}>\n+        Add Widgets\n+        <span className={classes.required}>*</span>\n+      </div>\n+      <div className={classes.widgetContainer}>\n+        {activeWidgets.map((widgetID, widgetIndex) => {\n+          return (\n+            <If condition={widgetToInfo[widgetID]}>", "originalCommit": "aa90989dabe4b1cff0944141cabee82f55d5a46a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ2Mzk4Mg==", "url": "https://github.com/cdapio/cdap/pull/12211#discussion_r439463982", "bodyText": "This has been resolved in the PR #12310.\n\n  \n    \n      cdap/cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/ConfigurationGroupPage/GroupPanel/WidgetCollection/index.tsx\n    \n    \n         Line 130\n      in\n      e8a2a5c\n    \n    \n    \n    \n\n        \n          \n           return (", "author": "jennac3", "createdAt": "2020-06-12T14:46:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzNDkyNg=="}], "type": "inlineReview"}, {"oid": "d8b952ec7d189c157ad4ae55a1b996dc16f0982d", "url": "https://github.com/cdapio/cdap/commit/d8b952ec7d189c157ad4ae55a1b996dc16f0982d", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)", "committedDate": "2020-06-15T14:58:15Z", "type": "forcePushed"}, {"oid": "2634c6f30e22ac926b19b4d7403d40d876f9d7ba", "url": "https://github.com/cdapio/cdap/commit/2634c6f30e22ac926b19b4d7403d40d876f9d7ba", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)", "committedDate": "2020-06-15T15:12:58Z", "type": "forcePushed"}, {"oid": "f014e652e30e06813a4873fe7918a9e7fb2944a3", "url": "https://github.com/cdapio/cdap/commit/f014e652e30e06813a4873fe7918a9e7fb2944a3", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)", "committedDate": "2020-06-15T15:34:52Z", "type": "forcePushed"}, {"oid": "577649e4cecff4c0af925b2a31e5f5d37646e2c0", "url": "https://github.com/cdapio/cdap/commit/577649e4cecff4c0af925b2a31e5f5d37646e2c0", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)", "committedDate": "2020-06-15T15:43:57Z", "type": "commit"}, {"oid": "577649e4cecff4c0af925b2a31e5f5d37646e2c0", "url": "https://github.com/cdapio/cdap/commit/577649e4cecff4c0af925b2a31e5f5d37646e2c0", "message": "[CDAP-16862] Define properties under each configuration group (plugin JSON creator)", "committedDate": "2020-06-15T15:43:57Z", "type": "forcePushed"}]}