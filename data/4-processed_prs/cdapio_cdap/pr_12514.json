{"pr_number": 12514, "pr_title": "[CDAP-17111] Revamp + Refactor Plugin JSON Creator", "pr_createdAt": "2020-07-28T15:44:15Z", "pr_url": "https://github.com/cdapio/cdap/pull/12514", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc4MTI1MA==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r461781250", "bodyText": "Why customize the styles for the button and tooltip?", "author": "njbriggs", "createdAt": "2020-07-28T18:19:59Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/LiveJSONButton/index.tsx", "diffHunk": "@@ -14,35 +14,55 @@\n  * the License.\n  */\n \n-import Button from '@material-ui/core/Button';\n+import * as React from 'react';\n+\n import withStyles, { StyleRules } from '@material-ui/core/styles/withStyles';\n-import Tooltip from '@material-ui/core/Tooltip';\n+\n import CodeIcon from '@material-ui/icons/Code';\n-import * as React from 'react';\n+import IconButton from '@material-ui/core/IconButton';\n+import { LiveViewMode } from 'components/PluginJSONCreator/Create/PluginJSONMenu';\n+import Tooltip from '@material-ui/core/Tooltip';\n+import classnames from 'classnames';\n \n const styles = (theme): StyleRules => {\n   return {\n     buttonTooltip: {\n-      fontSize: '14px',\n-      backgroundColor: theme.palette.grey[500],\n+      fontSize: '13px',\n+      backgroundColor: theme.palette.grey[50],\n+    },\n+    liveJSONButton: {\n+      '&:focus': {\n+        outline: 'none',\n+      },\n+    },\n+    clickedButton: {\n+      backgroundColor: 'rgb(26,115,232,0.2)',", "originalCommit": "5465c59a83c5efa2d2c5e9a29bdd1cd3db08ad4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc5NzMzNQ==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r461797335", "bodyText": "I wanted to override the material-ui  styling to emphasize the currently selected button.", "author": "jennac3", "createdAt": "2020-07-28T18:48:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc4MTI1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg0ODIxMQ==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r461848211", "bodyText": "I asked because I'm concerned about the one-off styling. Material UI has a ToggleButton in the lab https://material-ui.com/components/toggle-button/ but I don't know that we want to add the lab (yet). Is it worth adding a component for this?", "author": "njbriggs", "createdAt": "2020-07-28T20:12:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc4MTI1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg4NDE0OQ==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r461884149", "bodyText": "I've considered that alternative as well but decided against it since 1) we currently do not have @material-ui/lab and 2) even if we add ToggleButton we may need to add additional stylings.", "author": "jennac3", "createdAt": "2020-07-28T21:15:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc4MTI1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NDIyOA==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r463094228", "bodyText": "Can we get this from theme.palette? (It looks like theme.palette.primary.main)", "author": "yukiej", "createdAt": "2020-07-30T15:47:03Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/LiveConfigurationGroupButton/index.tsx", "diffHunk": "@@ -0,0 +1,74 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import * as React from 'react';\n+\n+import withStyles, { StyleRules } from '@material-ui/core/styles/withStyles';\n+\n+import IconButton from '@material-ui/core/IconButton';\n+import ImportContactsIcon from '@material-ui/icons/ImportContacts';\n+import { LiveViewMode } from 'components/PluginJSONCreator/Create/PluginJSONMenu';\n+import Tooltip from '@material-ui/core/Tooltip';\n+import classnames from 'classnames';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    buttonTooltip: {\n+      fontSize: '13px',\n+      backgroundColor: theme.palette.grey[50],\n+    },\n+    liveConfigurationGroupButton: {\n+      '&:focus': {\n+        outline: 'none',\n+      },\n+    },\n+    clickedButton: {\n+      backgroundColor: 'rgb(26,115,232,0.2)',", "originalCommit": "5465c59a83c5efa2d2c5e9a29bdd1cd3db08ad4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU4ODk4OQ==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r464588989", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-08-03T18:28:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NDIyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NDg0MQ==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r463094841", "bodyText": "See previous comment about getting this from theme.palette", "author": "yukiej", "createdAt": "2020-07-30T15:47:55Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/LiveJSONButton/index.tsx", "diffHunk": "@@ -14,35 +14,55 @@\n  * the License.\n  */\n \n-import Button from '@material-ui/core/Button';\n+import * as React from 'react';\n+\n import withStyles, { StyleRules } from '@material-ui/core/styles/withStyles';\n-import Tooltip from '@material-ui/core/Tooltip';\n+\n import CodeIcon from '@material-ui/icons/Code';\n-import * as React from 'react';\n+import IconButton from '@material-ui/core/IconButton';\n+import { LiveViewMode } from 'components/PluginJSONCreator/Create/PluginJSONMenu';\n+import Tooltip from '@material-ui/core/Tooltip';\n+import classnames from 'classnames';\n \n const styles = (theme): StyleRules => {\n   return {\n     buttonTooltip: {\n-      fontSize: '14px',\n-      backgroundColor: theme.palette.grey[500],\n+      fontSize: '13px',\n+      backgroundColor: theme.palette.grey[50],\n+    },\n+    liveJSONButton: {\n+      '&:focus': {\n+        outline: 'none',\n+      },\n+    },\n+    clickedButton: {\n+      backgroundColor: 'rgb(26,115,232,0.2)',", "originalCommit": "5465c59a83c5efa2d2c5e9a29bdd1cd3db08ad4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU4OTQ0NA==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r464589444", "bodyText": "done", "author": "jennac3", "createdAt": "2020-08-03T18:29:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NDg0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NjU0Ng==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r463096546", "bodyText": "can we use config.hasOwnProperty here instead? Same for line 95", "author": "yukiej", "createdAt": "2020-07-30T15:50:22Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/LiveView/LiveConfigurationGroup/index.tsx", "diffHunk": "@@ -62,7 +74,7 @@ const LiveConfigurationGroupView: React.FC<ILiveConfigurationGroup> = ({ classes\n    * Get pluginProperties, which is required for ConfigurationGroups component.\n    */\n   function getNewPluginProperties(config) {\n-    if (!config['configuration-groups']) {\n+    if (!config || !config['configuration-groups']) {", "originalCommit": "5465c59a83c5efa2d2c5e9a29bdd1cd3db08ad4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU4OTQyOA==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r464589428", "bodyText": "done", "author": "jennac3", "createdAt": "2020-08-03T18:29:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5NjU0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5Nzc0Mg==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r463097742", "bodyText": "These comments are helpful!", "author": "yukiej", "createdAt": "2020-07-30T15:52:06Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/index.tsx", "diffHunk": "@@ -28,43 +29,56 @@ import {\n   usePluginInfoState,\n   useWidgetState,\n } from 'components/PluginJSONCreator/Create';\n-import CollapsedMenu from 'components/PluginJSONCreator/Create/PluginJSONMenu/CollapsedMenu';\n-import LiveViewMenu from 'components/PluginJSONCreator/Create/PluginJSONMenu/LiveViewMenu';\n-import {\n-  downloadPluginJSON,\n-  getJSONOutput,\n-  parsePluginJSON,\n-} from 'components/PluginJSONCreator/utilities';\n-import * as React from 'react';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+\n+import Alert from 'components/Alert';\n+import Drawer from '@material-ui/core/Drawer';\n+import If from 'components/If';\n+import JSONActionButtons from 'components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons';\n+import { JSONStatusMessage } from 'components/PluginJSONCreator/constants';\n+import LiveView from 'components/PluginJSONCreator/Create/PluginJSONMenu/LiveView';\n+\n+export enum LiveViewMode {\n+  JSONView = 'JSON_VIEW',\n+  ConfigurationGroupsView = 'CONFIGURATION_GROUPS',\n+  None = 'NONE',\n+}\n \n-const LIVE_VIEWER_WIDTH = '600px';\n+const LIVE_VIEWER_WIDTH = '550px';\n \n const styles = (theme): StyleRules => {\n   return {\n     mainMenu: {\n+      display: 'grid',\n+      gridTemplateColumns: '1fr 9fr',\n       width: '100%',\n       height: '100%',\n       borderTop: `1px solid ${theme.palette.grey['500']}`,\n-      paddingTop: theme.Spacing(1),\n-      paddingBottom: theme.Spacing(1),\n+    },\n+    jsonActionButtons: {\n+      margin: 'auto',\n+      padding: '0',\n+    },\n+    liveView: {\n+      width: '100%',\n     },\n     toolbar: {\n       minHeight: '48px',\n     },\n-    closedPluginJSONMenu: {\n+    closedMenu: {\n       zIndex: 1000, // lower than '1061', which is Alert component's z-index", "originalCommit": "5465c59a83c5efa2d2c5e9a29bdd1cd3db08ad4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU4OTI0MQ==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r464589241", "bodyText": "Thank you!", "author": "jennac3", "createdAt": "2020-08-03T18:29:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5Nzc0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5ODU3Mw==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r463098573", "bodyText": "Update license year?", "author": "yukiej", "createdAt": "2020-07-30T15:53:14Z", "path": "cdap-ui/app/cdap/components/StandardModal/index.tsx", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Copyright \u00a9 2016-2017 Cask Data, Inc.", "originalCommit": "5465c59a83c5efa2d2c5e9a29bdd1cd3db08ad4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU4OTM5Nw==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r464589397", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-08-03T18:29:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA5ODU3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MTg0Mw==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r464761843", "bodyText": "nit: consolidate these into a single class", "author": "elfenheart", "createdAt": "2020-08-04T02:27:45Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/StepButtons/index.tsx", "diffHunk": "@@ -31,6 +33,12 @@ const styles = (theme): StyleRules => {\n         marginRight: '50px',\n       },\n     },\n+    previousButton: {\n+      textTransform: 'none',\n+    },\n+    nextButton: {\n+      textTransform: 'none',\n+    },", "originalCommit": "beea721bca4bcb4bcb0106b09fbb481d230d8381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwMjE0OQ==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r465102149", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-08-04T14:40:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MTg0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MjEwMQ==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r464762101", "bodyText": "what about header?", "author": "elfenheart", "createdAt": "2020-08-04T02:28:54Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/index.tsx", "diffHunk": "@@ -14,48 +14,73 @@\n  * the License.\n  */\n \n-import Divider from '@material-ui/core/Divider';\n+import * as React from 'react';\n+\n import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n-import ExpandLiveViewButton from 'components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/ExpandLiveViewButtton';\n+\n+import Divider from '@material-ui/core/Divider';\n import JSONDownloadButton from 'components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/JSONDownloadButton';\n import JSONImportButton from 'components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/JSONImportButton';\n-import * as React from 'react';\n+import LiveConfigurationGroupButton from 'components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/LiveConfigurationGroupButton';\n+import LiveJSONButton from 'components/PluginJSONCreator/Create/PluginJSONMenu/JSONActionButtons/LiveJSONButton';\n+import { LiveViewMode } from 'components/PluginJSONCreator/Create/PluginJSONMenu';\n+import classnames from 'classnames';\n \n const styles = (theme): StyleRules => {\n   return {\n     JSONActionButtons: {\n-      padding: '15px',\n       flexDirection: 'column',\n+      borderRight: `1px solid ${theme.palette.divider}`,\n+      height: 'calc(100vh - 53px)', // height excluding footer", "originalCommit": "beea721bca4bcb4bcb0106b09fbb481d230d8381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTEwNjA0Mw==", "url": "https://github.com/cdapio/cdap/pull/12514#discussion_r465106043", "bodyText": "It has to be height excluding header instead of footer, since JSON action buttons are located in live viewer component.\nChanged it to height: 'calc(100vh - 48px)', // height excluding header\nResolved.", "author": "jennac3", "createdAt": "2020-08-04T14:45:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDc2MjEwMQ=="}], "type": "inlineReview"}, {"oid": "921a01ca2204d31ef7b857fadf9681b051a8a2bc", "url": "https://github.com/cdapio/cdap/commit/921a01ca2204d31ef7b857fadf9681b051a8a2bc", "message": "[CDAP-17111] Revamp + Refactor Plugin JSON Creator", "committedDate": "2020-08-04T15:25:46Z", "type": "commit"}, {"oid": "921a01ca2204d31ef7b857fadf9681b051a8a2bc", "url": "https://github.com/cdapio/cdap/commit/921a01ca2204d31ef7b857fadf9681b051a8a2bc", "message": "[CDAP-17111] Revamp + Refactor Plugin JSON Creator", "committedDate": "2020-08-04T15:25:46Z", "type": "forcePushed"}]}