{"pr_number": 12244, "pr_title": "[CDAP-16890] Create a page for filters configuration (widget JSON creator)", "pr_createdAt": "2020-06-02T16:50:20Z", "pr_url": "https://github.com/cdapio/cdap/pull/12244", "timeline": [{"oid": "0b26efdc4835aefa76584346a0ef989a86a31cf8", "url": "https://github.com/cdapio/cdap/commit/0b26efdc4835aefa76584346a0ef989a86a31cf8", "message": "rebase in order to do demo", "committedDate": "2020-06-08T20:50:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzMjE2Nw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r438832167", "bodyText": "Total nit: 2020?", "author": "yukiej", "createdAt": "2020-06-11T14:33:47Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput/index.tsx", "diffHunk": "@@ -0,0 +1,150 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUyNTI0MQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441525241", "bodyText": "Resolved!", "author": "jennac3", "createdAt": "2020-06-17T12:59:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzMjE2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0NzU4OQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440547589", "bodyText": "We should probably think about putting all these in a single object and passing the object. As a component I don't know if it makes sense to have this much props. The component says JsonMenu .. The first thing I would expect when using the component would be a json which is kind of hidden under all these props..", "author": "ajainarayanan", "createdAt": "2020-06-16T02:18:02Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/BasicPluginInfo/index.tsx", "diffHunk": "@@ -95,6 +100,11 @@ const BasicPluginInfoView: React.FC<ICreateContext & WithStyles<typeof styles>>\n         setPluginState={setPluginState}\n         JSONStatus={JSONStatus}\n         setJSONStatus={setJSONStatus}\n+        filters={filters}", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0Nzk5OA==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440547998", "bodyText": "If we move it to an object then we define a type for the object and then ts can validate changes that can happen tomorrow if the contract (props to the component) changes.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:19:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0NzU4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUxODE3OA==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441518178", "bodyText": "After future PR #12310 and PR #12291  where we refactor and optimize performance for the Plugin JSON Creator, this issue has been resolved.\nWe no longer pass a lot of states to the JsonMenu, and the component is only initialized once so that we don't have to pass these many props from each page.\n\n  \n    \n      cdap/cdap-ui/app/cdap/components/PluginJSONCreator/Create/index.tsx\n    \n    \n         Line 271\n      in\n      882eb81\n    \n    \n    \n    \n\n        \n          \n           <PluginJSONMenu />", "author": "jennac3", "createdAt": "2020-06-17T12:48:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0NzU4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0Nzc4Nw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440547787", "bodyText": "We should avoid this.. If this component will have child component this basically affects all. This defeats the purpose of using css-in-js.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:18:54Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput/index.tsx", "diffHunk": "@@ -0,0 +1,150 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { StyleRules, withStyles, WithStyles } from '@material-ui/core/styles';\n+import { CustomOperator } from 'components/ConfigurationGroup/types';\n+import Heading, { HeadingTypes } from 'components/Heading';\n+import If from 'components/If';\n+import { OPERATOR_VALUES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    filterConditionInput: {\n+      '& > *': {", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUyNTQzOQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441525439", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-17T13:00:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0Nzc4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUyOTIwOQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441529209", "bodyText": "My bad! I made these changes in later PRs but I must have missed it in this PR.", "author": "jennac3", "createdAt": "2020-06-17T13:06:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0Nzc4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0ODIwMA==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440548200", "bodyText": "nit: there is a isNil from lodash that we can use.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:20:36Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput/index.tsx", "diffHunk": "@@ -0,0 +1,150 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { StyleRules, withStyles, WithStyles } from '@material-ui/core/styles';\n+import { CustomOperator } from 'components/ConfigurationGroup/types';\n+import Heading, { HeadingTypes } from 'components/Heading';\n+import If from 'components/If';\n+import { OPERATOR_VALUES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    filterConditionInput: {\n+      '& > *': {\n+        marginTop: '10px',\n+        marginBottom: '10px',\n+      },\n+    },\n+  };\n+};\n+\n+export enum FilterConditionMode {\n+  Operator = 'operator',\n+  Expression = 'expression',\n+}\n+\n+interface IFilterConditionInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  filterID: string;\n+}\n+\n+const FilterConditionInputview: React.FC<IFilterConditionInputProps> = ({\n+  classes,\n+  filterID,\n+  filterToCondition,\n+  setFilterToCondition,\n+  widgetInfo,\n+}) => {\n+  const existingCondition = filterToCondition[filterID];\n+\n+  const [conditionMode, setConditionMode] = React.useState(\n+    existingCondition.expression ? FilterConditionMode.Expression : FilterConditionMode.Operator\n+  );\n+\n+  const allWidgetNames = widgetInfo\n+    ? Object.values(widgetInfo)\n+        .map((info: IWidgetInfo) => info.name)\n+        .filter((widgetName) => widgetName !== undefined && widgetName !== null)", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUyNTUwOA==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441525508", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-17T13:00:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0ODIwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0ODcxMw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440548713", "bodyText": "If there is no enum for expression and  condition then we should probably introduce it. Loosely using strings for types might introduce problems if we miss consistency.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:22:14Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput/index.tsx", "diffHunk": "@@ -0,0 +1,150 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { StyleRules, withStyles, WithStyles } from '@material-ui/core/styles';\n+import { CustomOperator } from 'components/ConfigurationGroup/types';\n+import Heading, { HeadingTypes } from 'components/Heading';\n+import If from 'components/If';\n+import { OPERATOR_VALUES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    filterConditionInput: {\n+      '& > *': {\n+        marginTop: '10px',\n+        marginBottom: '10px',\n+      },\n+    },\n+  };\n+};\n+\n+export enum FilterConditionMode {\n+  Operator = 'operator',\n+  Expression = 'expression',\n+}\n+\n+interface IFilterConditionInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  filterID: string;\n+}\n+\n+const FilterConditionInputview: React.FC<IFilterConditionInputProps> = ({\n+  classes,\n+  filterID,\n+  filterToCondition,\n+  setFilterToCondition,\n+  widgetInfo,\n+}) => {\n+  const existingCondition = filterToCondition[filterID];\n+\n+  const [conditionMode, setConditionMode] = React.useState(\n+    existingCondition.expression ? FilterConditionMode.Expression : FilterConditionMode.Operator\n+  );\n+\n+  const allWidgetNames = widgetInfo\n+    ? Object.values(widgetInfo)\n+        .map((info: IWidgetInfo) => info.name)\n+        .filter((widgetName) => widgetName !== undefined && widgetName !== null)\n+    : [];\n+\n+  React.useEffect(() => {\n+    // reset condition data\n+    if (conditionMode === FilterConditionMode.Expression) {\n+      setFilterToCondition((prevObjs) => ({\n+        ...prevObjs,\n+        [filterID]: { expression: existingCondition.expression },\n+      }));\n+    } else {\n+      setFilterToCondition((prevObjs) => ({\n+        ...prevObjs,\n+        [filterID]: {\n+          property: existingCondition.property,\n+          operator: existingCondition.operator,\n+          value: existingCondition.value,\n+        },\n+      }));\n+    }\n+  }, [conditionMode]);\n+\n+  function setFilterCondition(conditionProperty: string) {\n+    return (val) => {\n+      setFilterToCondition((prevObjs) => ({\n+        ...prevObjs,\n+        [filterID]: { ...prevObjs[filterID], [conditionProperty]: val },\n+      }));\n+    };\n+  }\n+\n+  return (\n+    <If condition={existingCondition}>\n+      <div className={classes.filterConditionInput}>\n+        <Heading type={HeadingTypes.h6} label=\"Show these widgets by the following condition...\" />\n+        <PluginInput\n+          widgetType={'radio-group'}\n+          value={conditionMode}\n+          onChange={setConditionMode}\n+          label={'Condition Type'}\n+          options={Object.values(FilterConditionMode).map((mode) => ({ id: mode, label: mode }))}\n+          layout={'inline'}\n+        />\n+        <If condition={conditionMode === FilterConditionMode.Expression}>\n+          <PluginInput\n+            widgetType={'textbox'}\n+            value={existingCondition.expression ? existingCondition.expression : ''}\n+            onChange={setFilterCondition('expression')}", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUyNTU0Ng==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441525546", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-17T13:00:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0ODcxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0OTE2MQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440549161", "bodyText": "I think I mentioned this in other PRs, if not please use individual sub-modules from material-ui.\nimport IconButton from '@material-ui/core/IconButton'\nimport { WithStyles } from '@material-ui/core/styles/withStyles';", "author": "ajainarayanan", "createdAt": "2020-06-16T02:24:03Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput/index.tsx", "diffHunk": "@@ -0,0 +1,189 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { IconButton, WithStyles } from '@material-ui/core';", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0OTMxMw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440549313", "bodyText": "Adding as an umbrella comment for all the imports.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:24:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0OTE2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0OTcwNw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440549707", "bodyText": "Would need a key property for react.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:26:05Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput/index.tsx", "diffHunk": "@@ -0,0 +1,189 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { IconButton, WithStyles } from '@material-ui/core';\n+import { StyleRules, withStyles } from '@material-ui/core/styles';\n+import AddIcon from '@material-ui/icons/Add';\n+import DeleteIcon from '@material-ui/icons/Delete';\n+import classnames from 'classnames';\n+import Heading, { HeadingTypes } from 'components/Heading';\n+import If from 'components/If';\n+import { SHOW_TYPE_VALUES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    showConfigCollection: {\n+      display: 'grid',\n+      gridAutoFlow: 'column',\n+      width: '100%',\n+    },\n+    showConfigInput: {\n+      gridRow: '1',\n+      width: '100%',\n+    },\n+    showConfigNameInput: {\n+      gridColumnStart: '1',\n+      gridColumnEnd: '8',\n+    },\n+    showConfigTypeInput: {\n+      gridColumnStart: '9',\n+      gridColumnEnd: '15',\n+    },\n+    showAddDeleteButtonInput: {\n+      gridColumnStart: '19',\n+      gridColumnEnd: '20',\n+    },\n+    showAddDeleteButton: {\n+      float: 'right',\n+    },\n+  };\n+};\n+\n+interface IFilterShowlistInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  filterID: string;\n+}\n+\n+const FilterShowlistInputView: React.FC<IFilterShowlistInputProps> = ({\n+  classes,\n+  filterID,\n+  filterToShowList,\n+  setFilterToShowList,\n+  showToInfo,\n+  setShowToInfo,\n+  widgetInfo,\n+}) => {\n+  const allWidgetNames = widgetInfo\n+    ? Object.values(widgetInfo)\n+        .map((info: IWidgetInfo) => info.name)\n+        .filter((widgetName) => widgetName !== undefined && widgetName !== null)\n+    : [];\n+\n+  function setShowProperty(showID: string, property: string) {\n+    return (val) => {\n+      setShowToInfo((prevObjs) => ({\n+        ...prevObjs,\n+        [showID]: { ...prevObjs[showID], [property]: val },\n+      }));\n+    };\n+  }\n+\n+  function addShowToFilter(filterObjID: string, index?: number) {\n+    const newShowID = 'Show_' + uuidV4();\n+\n+    setShowToInfo({\n+      ...showToInfo,\n+      [newShowID]: {\n+        name: '',\n+      } as IPropertyShowConfig,\n+    });\n+\n+    if (index === undefined) {\n+      setFilterToShowList({\n+        ...filterToShowList,\n+        [filterObjID]: [...filterToShowList[filterObjID], newShowID],\n+      });\n+    } else {\n+      const showList = filterToShowList[filterObjID];\n+\n+      if (showList.length === 0) {\n+        showList.splice(0, 0, newShowID);\n+      } else {\n+        showList.splice(index + 1, 0, newShowID);\n+      }\n+\n+      setFilterToShowList({\n+        ...filterToShowList,\n+        [filterObjID]: showList,\n+      });\n+    }\n+  }\n+\n+  function deleteShowFromFilter(filterObjID: string, index: number) {\n+    const showList = filterToShowList[filterObjID];\n+\n+    const showToDelete = showList[index];\n+\n+    showList.splice(index, 1);\n+\n+    setFilterToShowList({\n+      ...filterToShowList,\n+      [filterObjID]: showList,\n+    });\n+\n+    const { [showToDelete]: tmp, ...restShowToInfo } = showToInfo;\n+    setShowToInfo(restShowToInfo);\n+  }\n+\n+  return (\n+    <If condition={filterToShowList[filterID] !== undefined}>\n+      <Heading type={HeadingTypes.h6} label=\"Add widgets to configure\" />\n+      {filterToShowList[filterID].map((showID: string, showIndex: number) => {\n+        return (\n+          <If condition={showToInfo[showID]}>", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0OTc5MQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440549791", "bodyText": "Same here.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:26:21Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/index.tsx", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import Button from '@material-ui/core/Button';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import WidgetWrapper from 'components/ConfigurationGroup/WidgetWrapper';\n+import If from 'components/If';\n+import FilterConditionInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput';\n+import FilterShowlistInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    filterInput: {\n+      display: 'block',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+      marginTop: '10px',\n+      marginBottom: '10px',\n+      '& > *': {", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0OTg4Nw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440549887", "bodyText": "Are we sure this is required? Where is this 1000px coming from?", "author": "ajainarayanan", "createdAt": "2020-06-16T02:26:42Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/index.tsx", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import Button from '@material-ui/core/Button';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import WidgetWrapper from 'components/ConfigurationGroup/WidgetWrapper';\n+import If from 'components/If';\n+import FilterConditionInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput';\n+import FilterShowlistInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    filterInput: {\n+      display: 'block',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+      marginTop: '10px',\n+      marginBottom: '10px',\n+      '& > *': {\n+        marginTop: '15px',\n+        marginBottom: '15px',\n+      },\n+    },\n+    nestedFilters: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    filterContainer: {\n+      width: 'calc(100%-1000px)',", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUzMDY1Mw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441530653", "bodyText": "changed this to 90%.", "author": "jennac3", "createdAt": "2020-06-17T13:08:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU0OTg4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1MDEwNA==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440550104", "bodyText": "Same here. Missing key prop.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:27:25Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/index.tsx", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import Button from '@material-ui/core/Button';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import WidgetWrapper from 'components/ConfigurationGroup/WidgetWrapper';\n+import If from 'components/If';\n+import FilterConditionInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput';\n+import FilterShowlistInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    filterInput: {\n+      display: 'block',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+      marginTop: '10px',\n+      marginBottom: '10px',\n+      '& > *': {\n+        marginTop: '15px',\n+        marginBottom: '15px',\n+      },\n+    },\n+    nestedFilters: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],\n+      borderRadius: '6px',\n+      position: 'relative',\n+      padding: '7px 10px 5px',\n+      margin: '25px',\n+    },\n+    filterContainer: {\n+      width: 'calc(100%-1000px)',\n+    },\n+  };\n+};\n+\n+const FilterNameInput = ({ filterID, filterToName, setFilterToName }) => {\n+  function setFilterName(filterObjID: string) {\n+    return (name) => {\n+      setFilterToName((prevObjs) => ({ ...prevObjs, [filterObjID]: name }));\n+    };\n+  }\n+\n+  const label = 'Filter Name';\n+\n+  const widget = {\n+    label,\n+    'widget-type': 'textbox',\n+  };\n+\n+  const property = {\n+    required: false,\n+    name: label,\n+  };\n+\n+  return (\n+    <WidgetWrapper\n+      widgetProperty={widget}\n+      pluginProperty={property}\n+      value={filterToName[filterID]}\n+      onChange={setFilterName(filterID)}\n+    />\n+  );\n+};\n+\n+const FilterCollectionView: React.FC<ICreateContext & WithStyles<typeof styles>> = ({\n+  classes,\n+  filters,\n+  setFilters,\n+  filterToName,\n+  setFilterToName,\n+  filterToCondition,\n+  setFilterToCondition,\n+  filterToShowList,\n+  setFilterToShowList,\n+  showToInfo,\n+  setShowToInfo,\n+  widgetInfo,\n+}) => {\n+  function addFilter(index: number) {\n+    const newFilterID = 'Filter_' + uuidV4();\n+\n+    const newFilters = [...filters];\n+\n+    if (newFilters.length === 0) {\n+      newFilters.splice(0, 0, newFilterID);\n+    } else {\n+      newFilters.splice(index + 1, 0, newFilterID);\n+    }\n+\n+    setFilters(newFilters);\n+\n+    setFilterToName({ ...filterToName, [newFilterID]: '' });\n+    setFilterToCondition({ ...filterToCondition, [newFilterID]: {} });\n+\n+    // put one empty show as a placeholder\n+    const newShowID = 'Show_' + uuidV4();\n+    setFilterToShowList({\n+      ...filterToShowList,\n+      [newFilterID]: [newShowID],\n+    });\n+    setShowToInfo({\n+      ...showToInfo,\n+      [newShowID]: {\n+        name: '',\n+      } as IPropertyShowConfig,\n+    });\n+  }\n+\n+  function deleteFilter(index: number) {\n+    const newFilters = [...filters];\n+    const filterToDelete = newFilters[index];\n+    newFilters.splice(index, 1);\n+    setFilters(newFilters);\n+\n+    const { [filterToDelete]: name, ...restFilterToName } = filterToName;\n+    setFilterToName(restFilterToName);\n+\n+    const { [filterToDelete]: condition, ...restFilterToCondition } = filterToCondition;\n+    setFilterToCondition(restFilterToCondition);\n+\n+    const { [filterToDelete]: showList, ...restFilterToShowList } = filterToShowList;\n+    setFilterToShowList(restFilterToShowList);\n+\n+    showList.map((show) => {\n+      const { [show]: info, ...rest } = showToInfo;\n+      setShowToInfo(rest);\n+    });\n+  }\n+\n+  return (\n+    <div>\n+      {filters.map((filterID: string, filterIndex: number) => {\n+        return (\n+          <div className={classes.nestedFilters} data-cy=\"widget-wrapper-container\">", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUzMDc1Mw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441530753", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-17T13:08:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1MDEwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1MDIwOQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440550209", "bodyText": "Same here.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:27:47Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/ClosedJsonMenu/index.tsx", "diffHunk": "@@ -30,6 +30,9 @@ const styles = (theme): StyleRules => {\n     jsonActionButtons: {\n       padding: '15px',\n       flexDirection: 'column',\n+      '& > *': {", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1MDM1OA==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440550358", "bodyText": "Could you please extract this out as an if condition? IMHO it is easier to read.", "author": "ajainarayanan", "createdAt": "2020-06-16T02:28:23Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/utilities.ts", "diffHunk": "@@ -47,9 +51,25 @@ function getJSONConfig(widgetJSONData) {\n     ...(outputName && { name: outputName }),\n   };\n \n+  const filtersData = filters.map((filterID) => {\n+    const filterToShowListData = filterToShowList[filterID].map((showID) => {\n+      return {\n+        name: showToInfo[showID].name,\n+        ...(showToInfo[showID].type && {", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUzMDkxMQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441530911", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-17T13:08:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1MDM1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1MTk4NQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r440551985", "bodyText": "Do we need to hardcode it?", "author": "ajainarayanan", "createdAt": "2020-06-16T02:35:09Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/utilities.ts", "diffHunk": "@@ -47,9 +51,25 @@ function getJSONConfig(widgetJSONData) {\n     ...(outputName && { name: outputName }),\n   };\n \n+  const filtersData = filters.map((filterID) => {\n+    const filterToShowListData = filterToShowList[filterID].map((showID) => {\n+      return {\n+        name: showToInfo[showID].name,\n+        ...(showToInfo[showID].type && {\n+          type: showToInfo[showID].type,\n+        }),\n+      };\n+    });\n+    return {\n+      name: filterToName[filterID],\n+      condition: filterToCondition[filterID],\n+      show: filterToShowListData,\n+    };\n+  });\n+\n   const config = {\n     metadata: {\n-      'spec-version': SPEC_VERSION,\n+      'spec-version': '1.5',", "originalCommit": "5e3d3d79b4b184e3d2ad9efcf9155c358f4ad93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUzMDk2OA==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r441530968", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-17T13:08:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU1MTk4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNTU1Nw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442015557", "bodyText": "why is the !isNil(widgetName) being done twice with AND?", "author": "elfenheart", "createdAt": "2020-06-18T07:14:51Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput/index.tsx", "diffHunk": "@@ -0,0 +1,164 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { StyleRules, withStyles, WithStyles } from '@material-ui/core/styles';\n+import { CustomOperator } from 'components/ConfigurationGroup/types';\n+import Heading, { HeadingTypes } from 'components/Heading';\n+import If from 'components/If';\n+import { OPERATOR_VALUES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import isNil from 'lodash/isNil';\n+import * as React from 'react';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    filterConditionInput: {\n+      marginTop: '10px',\n+      marginBottom: '10px',\n+    },\n+  };\n+};\n+\n+export enum FilterConditionMode {\n+  Operator = 'operator',\n+  Expression = 'expression',\n+}\n+\n+enum FilterConditionProperty {\n+  Expression = 'expression',\n+  Property = 'property',\n+  Operator = 'operator',\n+  Value = 'value',\n+}\n+\n+interface IFilterConditionInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  filterID: string;\n+}\n+\n+const FilterConditionInputview: React.FC<IFilterConditionInputProps> = ({\n+  classes,\n+  filterID,\n+  filterToCondition,\n+  setFilterToCondition,\n+  widgetInfo,\n+}) => {\n+  const existingCondition = filterToCondition[filterID];\n+\n+  const [conditionMode, setConditionMode] = React.useState(\n+    existingCondition.expression ? FilterConditionMode.Expression : FilterConditionMode.Operator\n+  );\n+\n+  const allWidgetNames = widgetInfo\n+    ? Object.values(widgetInfo)\n+        .map((info: IWidgetInfo) => info.name)\n+        .filter((widgetName) => !isNil(widgetName) && !isNil(widgetName))", "originalCommit": "9b664285b6426902f7720f57412daa97b694e951", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE3NzY3MQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442177671", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-18T12:09:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNTU1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNjYzNQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442016635", "bodyText": "same here regarding the isNil check", "author": "elfenheart", "createdAt": "2020-06-18T07:16:58Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput/index.tsx", "diffHunk": "@@ -0,0 +1,191 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import IconButton from '@material-ui/core/IconButton';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import AddIcon from '@material-ui/icons/Add';\n+import DeleteIcon from '@material-ui/icons/Delete';\n+import classnames from 'classnames';\n+import { IPropertyShowConfig } from 'components/ConfigurationGroup/types';\n+import Heading, { HeadingTypes } from 'components/Heading';\n+import If from 'components/If';\n+import { SHOW_TYPE_VALUES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import isNil from 'lodash/isNil';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    showConfigCollection: {\n+      display: 'grid',\n+      gridAutoFlow: 'column',\n+      width: '100%',\n+    },\n+    showConfigInput: {\n+      gridRow: '1',\n+      width: '100%',\n+    },\n+    showConfigNameInput: {\n+      gridColumnStart: '1',\n+      gridColumnEnd: '8',\n+    },\n+    showConfigTypeInput: {\n+      gridColumnStart: '9',\n+      gridColumnEnd: '15',\n+    },\n+    showAddDeleteButtonInput: {\n+      gridColumnStart: '19',\n+      gridColumnEnd: '20',\n+    },\n+    showAddDeleteButton: {\n+      float: 'right',\n+    },\n+  };\n+};\n+\n+interface IFilterShowlistInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  filterID: string;\n+}\n+\n+const FilterShowlistInputView: React.FC<IFilterShowlistInputProps> = ({\n+  classes,\n+  filterID,\n+  filterToShowList,\n+  setFilterToShowList,\n+  showToInfo,\n+  setShowToInfo,\n+  widgetInfo,\n+}) => {\n+  const allWidgetNames = widgetInfo\n+    ? Object.values(widgetInfo)\n+        .map((info: IWidgetInfo) => info.name)\n+        .filter((widgetName) => !isNil(widgetName) && !isNil(widgetName))", "originalCommit": "9b664285b6426902f7720f57412daa97b694e951", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE3NzcxMA==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442177710", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-18T12:09:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNjYzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNzE5NQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442017195", "bodyText": "you might have change this in immutableJS PR, but just to make sure - this is mutating the original array, we should clone the array first", "author": "elfenheart", "createdAt": "2020-06-18T07:18:05Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput/index.tsx", "diffHunk": "@@ -0,0 +1,191 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import IconButton from '@material-ui/core/IconButton';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import AddIcon from '@material-ui/icons/Add';\n+import DeleteIcon from '@material-ui/icons/Delete';\n+import classnames from 'classnames';\n+import { IPropertyShowConfig } from 'components/ConfigurationGroup/types';\n+import Heading, { HeadingTypes } from 'components/Heading';\n+import If from 'components/If';\n+import { SHOW_TYPE_VALUES } from 'components/PluginJSONCreator/constants';\n+import PluginInput from 'components/PluginJSONCreator/Create/Content/PluginInput';\n+import { ICreateContext, IWidgetInfo } from 'components/PluginJSONCreator/CreateContextConnect';\n+import isNil from 'lodash/isNil';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (): StyleRules => {\n+  return {\n+    showConfigCollection: {\n+      display: 'grid',\n+      gridAutoFlow: 'column',\n+      width: '100%',\n+    },\n+    showConfigInput: {\n+      gridRow: '1',\n+      width: '100%',\n+    },\n+    showConfigNameInput: {\n+      gridColumnStart: '1',\n+      gridColumnEnd: '8',\n+    },\n+    showConfigTypeInput: {\n+      gridColumnStart: '9',\n+      gridColumnEnd: '15',\n+    },\n+    showAddDeleteButtonInput: {\n+      gridColumnStart: '19',\n+      gridColumnEnd: '20',\n+    },\n+    showAddDeleteButton: {\n+      float: 'right',\n+    },\n+  };\n+};\n+\n+interface IFilterShowlistInputProps extends WithStyles<typeof styles>, ICreateContext {\n+  filterID: string;\n+}\n+\n+const FilterShowlistInputView: React.FC<IFilterShowlistInputProps> = ({\n+  classes,\n+  filterID,\n+  filterToShowList,\n+  setFilterToShowList,\n+  showToInfo,\n+  setShowToInfo,\n+  widgetInfo,\n+}) => {\n+  const allWidgetNames = widgetInfo\n+    ? Object.values(widgetInfo)\n+        .map((info: IWidgetInfo) => info.name)\n+        .filter((widgetName) => !isNil(widgetName) && !isNil(widgetName))\n+    : [];\n+\n+  function setShowProperty(showID: string, property: string) {\n+    return (val) => {\n+      setShowToInfo((prevObjs) => ({\n+        ...prevObjs,\n+        [showID]: { ...prevObjs[showID], [property]: val },\n+      }));\n+    };\n+  }\n+\n+  function addShowToFilter(filterObjID: string, index?: number) {\n+    const newShowID = 'Show_' + uuidV4();\n+\n+    setShowToInfo({\n+      ...showToInfo,\n+      [newShowID]: {\n+        name: '',\n+      } as IPropertyShowConfig,\n+    });\n+\n+    if (index === undefined) {\n+      setFilterToShowList({\n+        ...filterToShowList,\n+        [filterObjID]: [...filterToShowList[filterObjID], newShowID],\n+      });\n+    } else {\n+      const showList = filterToShowList[filterObjID];\n+\n+      if (showList.length === 0) {\n+        showList.splice(0, 0, newShowID);\n+      } else {\n+        showList.splice(index + 1, 0, newShowID);", "originalCommit": "9b664285b6426902f7720f57412daa97b694e951", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE3NzIzMg==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442177232", "bodyText": "This is resolved through immutable PR #12251  and refactor PR #12310\n\n  \n    \n      cdap/cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/FilterPage/FilterPanel/FilterShowlistInput/index.tsx\n    \n    \n         Line 43\n      in\n      882eb81\n    \n    \n    \n    \n\n        \n          \n           const newShowlist = showlist.insert(index + 1, newShowID);", "author": "jennac3", "createdAt": "2020-06-18T12:08:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNzE5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNzU0Nw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442017547", "bodyText": "consolidate these to the margin property", "author": "elfenheart", "createdAt": "2020-06-18T07:18:46Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/index.tsx", "diffHunk": "@@ -0,0 +1,205 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import Button from '@material-ui/core/Button';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import { IPropertyShowConfig } from 'components/ConfigurationGroup/types';\n+import WidgetWrapper from 'components/ConfigurationGroup/WidgetWrapper';\n+import If from 'components/If';\n+import FilterConditionInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput';\n+import FilterShowlistInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    filterInput: {\n+      display: 'block',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+      marginTop: '30px',\n+      marginBottom: '30px',", "originalCommit": "9b664285b6426902f7720f57412daa97b694e951", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE3ODc3Nw==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442178777", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-18T12:11:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNzU0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNzc5Mg==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442017792", "bodyText": "border: 1px solid ${theme.palette.grey[300]}", "author": "elfenheart", "createdAt": "2020-06-18T07:19:15Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/Filters/FilterCollection/index.tsx", "diffHunk": "@@ -0,0 +1,205 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import Button from '@material-ui/core/Button';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import { IPropertyShowConfig } from 'components/ConfigurationGroup/types';\n+import WidgetWrapper from 'components/ConfigurationGroup/WidgetWrapper';\n+import If from 'components/If';\n+import FilterConditionInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterConditionInput';\n+import FilterShowlistInput from 'components/PluginJSONCreator/Create/Content/Filters/FilterCollection/FilterShowlistInput';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+import uuidV4 from 'uuid/v4';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    filterInput: {\n+      display: 'block',\n+      marginLeft: 'auto',\n+      marginRight: 'auto',\n+      marginTop: '30px',\n+      marginBottom: '30px',\n+    },\n+    nestedFilters: {\n+      border: `1px solid`,\n+      borderColor: theme.palette.grey[300],", "originalCommit": "9b664285b6426902f7720f57412daa97b694e951", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE3NzU4OQ==", "url": "https://github.com/cdapio/cdap/pull/12244#discussion_r442177589", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-18T12:09:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxNzc5Mg=="}], "type": "inlineReview"}, {"oid": "157ae8c15cb7974ae6fbcc12c05beefe8b92f756", "url": "https://github.com/cdapio/cdap/commit/157ae8c15cb7974ae6fbcc12c05beefe8b92f756", "message": "fix", "committedDate": "2020-06-18T13:11:29Z", "type": "forcePushed"}, {"oid": "730b6da8fecb40c4e0b3cfb362b230b70975e470", "url": "https://github.com/cdapio/cdap/commit/730b6da8fecb40c4e0b3cfb362b230b70975e470", "message": "[CDAP-16890] Create a page for filters configuration (plugin JSON creator)", "committedDate": "2020-06-18T13:25:47Z", "type": "forcePushed"}, {"oid": "8610424a215260f19c2cea84f4958ae3cb72181d", "url": "https://github.com/cdapio/cdap/commit/8610424a215260f19c2cea84f4958ae3cb72181d", "message": "[CDAP-16890] Create a page for filters configuration (plugin JSON creator)", "committedDate": "2020-06-19T14:45:08Z", "type": "commit"}, {"oid": "8610424a215260f19c2cea84f4958ae3cb72181d", "url": "https://github.com/cdapio/cdap/commit/8610424a215260f19c2cea84f4958ae3cb72181d", "message": "[CDAP-16890] Create a page for filters configuration (plugin JSON creator)", "committedDate": "2020-06-19T14:45:08Z", "type": "forcePushed"}]}