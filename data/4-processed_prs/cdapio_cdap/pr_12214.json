{"pr_number": 12214, "pr_title": "[CDAP-16863] Show the live JSON view (plugin JSON Creator)", "pr_createdAt": "2020-05-27T21:03:16Z", "pr_url": "https://github.com/cdapio/cdap/pull/12214", "timeline": [{"oid": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "url": "https://github.com/cdapio/cdap/commit/b68b04d60ed094c0d97f4c5abbee24a782dadae3", "message": "[CDAP-16863] Show the live JSON view (plugin JSON Creator)", "committedDate": "2020-06-01T19:48:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwODEyOA==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434308128", "bodyText": "nit: I noticed this in the previous PR too. What does widgetToInfo mean? I can understand groupToWidgets as a map. If its a map of widget information may be just widgetInfo?", "author": "ajainarayanan", "createdAt": "2020-06-03T04:58:53Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/BasicPluginInfo/index.tsx", "diffHunk": "@@ -68,6 +75,19 @@ const BasicPluginInfoView: React.FC<ICreateContext & WithStyles<typeof styles>>\n \n   return (\n     <div>\n+      <JsonMenu\n+        pluginName={localPluginName}\n+        pluginType={localPluginType}\n+        displayName={localDisplayName}\n+        emitAlerts={localEmitAlerts}\n+        emitErrors={localEmitErrors}\n+        configurationGroups={configurationGroups}\n+        groupToInfo={groupToInfo}\n+        groupToWidgets={groupToWidgets}\n+        widgetToInfo={widgetToInfo}", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDg1OTUwNg==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434859506", "bodyText": "widgetToInfo is a map of widget information. It maps widgetID to {widgetCategory: '', name: '', label: '', widgetType: ''}. I renamed it as widgetInfo!", "author": "jennac3", "createdAt": "2020-06-03T21:10:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwODEyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwODMyMw==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434308323", "bodyText": "nit: import it from specific submodule rather than the core.", "author": "ajainarayanan", "createdAt": "2020-06-03T04:59:39Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/ClosedJsonMenu/index.tsx", "diffHunk": "@@ -0,0 +1,138 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Divider, IconButton, Tooltip } from '@material-ui/core';", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNTU4Ng==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435905586", "bodyText": "Changed!", "author": "jennac3", "createdAt": "2020-06-05T13:01:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwODMyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwODYwMw==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434308603", "bodyText": "nit: Same here.", "author": "ajainarayanan", "createdAt": "2020-06-03T05:00:39Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/JsonLiveViewer/index.tsx", "diffHunk": "@@ -0,0 +1,152 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Tooltip } from '@material-ui/core';", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNTcwMQ==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435905701", "bodyText": "Changed!", "author": "jennac3", "createdAt": "2020-06-05T13:01:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwODYwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwODk0Ng==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434308946", "bodyText": "If all this component is doing is view/download the JSON can we pass that as one single prop? Do we need to pass it individually to combine them here and form the object?", "author": "ajainarayanan", "createdAt": "2020-06-03T05:02:04Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/JsonLiveViewer/index.tsx", "diffHunk": "@@ -0,0 +1,152 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Tooltip } from '@material-ui/core';\n+import Drawer from '@material-ui/core/Drawer';\n+import List from '@material-ui/core/List';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\n+import SaveAltIcon from '@material-ui/icons/SaveAlt';\n+import JsonEditorWidget from 'components/AbstractWidget/CodeEditorWidget/JsonEditorWidget';\n+import {\n+  downloadPluginJSON,\n+  getJSONConfig,\n+} from 'components/PluginJSONCreator/Create/Content/JsonMenu/utilities';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const JSON_VIEWER_WIDTH = '600px';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    jsonViewer: {\n+      zIndex: theme.zIndex.drawer,\n+      width: JSON_VIEWER_WIDTH,\n+    },\n+    jsonViewerPaper: {\n+      width: JSON_VIEWER_WIDTH,\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    toolbar: {\n+      minHeight: '48px',\n+    },\n+    mainMenu: {\n+      borderTop: `1px solid ${theme.palette.grey['500']}`,\n+      paddingTop: theme.Spacing(1),\n+      paddingBottom: theme.Spacing(1),\n+    },\n+    jsonActionButtons: {\n+      padding: '5px',\n+      display: 'flex',\n+    },\n+    closeJSONViewerButon: {\n+      marginLeft: 'auto',\n+    },\n+    jsonViewerTooltip: {\n+      fontSize: '14px',\n+      backgroundColor: theme.palette.grey[500],\n+    },\n+  };\n+};\n+\n+const JsonLiveViewerView: React.FC<ICreateContext & WithStyles<typeof styles>> = ({\n+  classes,\n+  pluginName,\n+  pluginType,\n+  displayName,\n+  emitAlerts,\n+  emitErrors,\n+  configurationGroups,\n+  groupToInfo,\n+  groupToWidgets,\n+  widgetToInfo,\n+  jsonView,\n+  setJsonView,\n+}) => {\n+  const widgetJSONData = {", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNzQ4OA==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435907488", "bodyText": "Resolved", "author": "jennac3", "createdAt": "2020-06-05T13:05:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwODk0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTE1NA==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434309154", "bodyText": "Could this be static or is it just a placeholder for now? What happens on different browser heights?", "author": "ajainarayanan", "createdAt": "2020-06-03T05:02:49Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/JsonLiveViewer/index.tsx", "diffHunk": "@@ -0,0 +1,152 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { Button, Tooltip } from '@material-ui/core';\n+import Drawer from '@material-ui/core/Drawer';\n+import List from '@material-ui/core/List';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\n+import SaveAltIcon from '@material-ui/icons/SaveAlt';\n+import JsonEditorWidget from 'components/AbstractWidget/CodeEditorWidget/JsonEditorWidget';\n+import {\n+  downloadPluginJSON,\n+  getJSONConfig,\n+} from 'components/PluginJSONCreator/Create/Content/JsonMenu/utilities';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const JSON_VIEWER_WIDTH = '600px';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    jsonViewer: {\n+      zIndex: theme.zIndex.drawer,\n+      width: JSON_VIEWER_WIDTH,\n+    },\n+    jsonViewerPaper: {\n+      width: JSON_VIEWER_WIDTH,\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    toolbar: {\n+      minHeight: '48px',\n+    },\n+    mainMenu: {\n+      borderTop: `1px solid ${theme.palette.grey['500']}`,\n+      paddingTop: theme.Spacing(1),\n+      paddingBottom: theme.Spacing(1),\n+    },\n+    jsonActionButtons: {\n+      padding: '5px',\n+      display: 'flex',\n+    },\n+    closeJSONViewerButon: {\n+      marginLeft: 'auto',\n+    },\n+    jsonViewerTooltip: {\n+      fontSize: '14px',\n+      backgroundColor: theme.palette.grey[500],\n+    },\n+  };\n+};\n+\n+const JsonLiveViewerView: React.FC<ICreateContext & WithStyles<typeof styles>> = ({\n+  classes,\n+  pluginName,\n+  pluginType,\n+  displayName,\n+  emitAlerts,\n+  emitErrors,\n+  configurationGroups,\n+  groupToInfo,\n+  groupToWidgets,\n+  widgetToInfo,\n+  jsonView,\n+  setJsonView,\n+}) => {\n+  const widgetJSONData = {\n+    pluginName,\n+    pluginType,\n+    displayName,\n+    emitAlerts,\n+    emitErrors,\n+    configurationGroups,\n+    groupToInfo,\n+    groupToWidgets,\n+    widgetToInfo,\n+  };\n+  const JSONConfig = getJSONConfig(widgetJSONData);\n+  const downloadDisabled = pluginName.length === 0 || pluginType.length === 0;\n+  return (\n+    <div>\n+      <Drawer\n+        open={jsonView}\n+        variant=\"persistent\"\n+        className={classes.jsonViewer}\n+        anchor=\"right\"\n+        disableEnforceFocus={true}\n+        ModalProps={{\n+          keepMounted: true,\n+        }}\n+        classes={{\n+          paper: classes.jsonViewerPaper,\n+        }}\n+        data-cy=\"navbar-drawer\"\n+      >\n+        <div className={classes.toolbar} />\n+        <List component=\"nav\" dense={true} className={classes.mainMenu}>\n+          <div className={classes.jsonActionButtons}>\n+            <Tooltip\n+              classes={{\n+                tooltip: classes.jsonViewerTooltip,\n+              }}\n+              title={\n+                downloadDisabled\n+                  ? 'Download is disabled until the required fields are filled in'\n+                  : 'Download Plugin JSON'\n+              }\n+            >\n+              <span>\n+                <Button\n+                  disabled={downloadDisabled}\n+                  onClick={() => downloadPluginJSON(widgetJSONData)}\n+                >\n+                  <SaveAltIcon />\n+                </Button>\n+              </span>\n+            </Tooltip>\n+            <Tooltip\n+              classes={{\n+                tooltip: classes.jsonViewerTooltip,\n+              }}\n+              title=\"Close JSON View\"\n+            >\n+              <Button className={classes.closeJSONViewerButon} onClick={() => setJsonView(false)}>\n+                <FullscreenExitIcon />\n+              </Button>\n+            </Tooltip>\n+          </div>\n+          <JsonEditorWidget\n+            rows={50}", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDg1NzMxOA==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434857318", "bodyText": "I set it as a placeholder, but I will use the code editor component directly and style that according to Edwin's suggestion!", "author": "jennac3", "createdAt": "2020-06-03T21:08:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTE1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNjM0Ng==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435906346", "bodyText": "We ended up using <pre> element instead, so this won't be an issue anymore.", "author": "jennac3", "createdAt": "2020-06-05T13:03:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTE1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNjM4Ng==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435906386", "bodyText": "Resolved!", "author": "jennac3", "createdAt": "2020-06-05T13:03:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTE1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTE4MA==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434309180", "bodyText": "nit: 2020", "author": "ajainarayanan", "createdAt": "2020-06-03T05:02:57Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/index.tsx", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNjUxNw==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435906517", "bodyText": "Resolved!", "author": "jennac3", "createdAt": "2020-06-05T13:03:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTE4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTIyOA==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434309228", "bodyText": "Same here.", "author": "ajainarayanan", "createdAt": "2020-06-03T05:03:05Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/JsonLiveViewer/index.tsx", "diffHunk": "@@ -0,0 +1,152 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNjU1Mg==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435906552", "bodyText": "Resolved!", "author": "jennac3", "createdAt": "2020-06-05T13:03:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTIyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTI1Nw==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434309257", "bodyText": "Same here.", "author": "ajainarayanan", "createdAt": "2020-06-03T05:03:12Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/ClosedJsonMenu/index.tsx", "diffHunk": "@@ -0,0 +1,138 @@\n+/*\n+ * Copyright \u00a9 2018 Cask Data, Inc.", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNjYwMQ==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435906601", "bodyText": "Resolved!", "author": "jennac3", "createdAt": "2020-06-05T13:03:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTI1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTYxNw==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434309617", "bodyText": "Is this being used anywhere?", "author": "ajainarayanan", "createdAt": "2020-06-03T05:04:53Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/constants.tsx", "diffHunk": "@@ -22,3 +22,5 @@ export const PluginTypes = Object.keys(GLOBALS.pluginTypeToLabel).filter(\n );\n \n export const WIDGET_TYPES = Object.keys(WIDGET_FACTORY);\n+\n+export const SPEC_VERSION = '1.5';", "originalCommit": "b68b04d60ed094c0d97f4c5abbee24a782dadae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDg2Mjc4Mg==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r434862782", "bodyText": "Oops, I forgot to use it!\nI changed the code to use the constant at https://github.com/cdapio/cdap/pull/12214/files#diff-513ea481c1f91c43f68a702547a59be0", "author": "jennac3", "createdAt": "2020-06-03T21:17:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTYxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwNzAxMg==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r435907012", "bodyText": "Resolved!", "author": "jennac3", "createdAt": "2020-06-05T13:04:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMwOTYxNw=="}], "type": "inlineReview"}, {"oid": "8ad1ccd8c6f601ea6a95a12feefbdde777576f16", "url": "https://github.com/cdapio/cdap/commit/8ad1ccd8c6f601ea6a95a12feefbdde777576f16", "message": "address comments", "committedDate": "2020-06-03T21:29:06Z", "type": "forcePushed"}, {"oid": "7b15b8693a875a19af121303d141c768da79c689", "url": "https://github.com/cdapio/cdap/commit/7b15b8693a875a19af121303d141c768da79c689", "message": "address comments", "committedDate": "2020-06-03T21:34:30Z", "type": "forcePushed"}, {"oid": "f93cae7486386216fc9fca39b93d621af11cf692", "url": "https://github.com/cdapio/cdap/commit/f93cae7486386216fc9fca39b93d621af11cf692", "message": "address comments", "committedDate": "2020-06-03T21:35:55Z", "type": "forcePushed"}, {"oid": "72934dc2ebee2b31d0cee71fc284055718ef706d", "url": "https://github.com/cdapio/cdap/commit/72934dc2ebee2b31d0cee71fc284055718ef706d", "message": "adddress comments", "committedDate": "2020-06-03T22:47:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ0MDAxMw==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r440440013", "bodyText": "should be forEach", "author": "elfenheart", "createdAt": "2020-06-15T20:52:32Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/ConfigurationGroupsCollection/index.tsx", "diffHunk": "@@ -118,11 +126,11 @@ const ConfigurationGroupsCollectionView: React.FC<ICreateContext & WithStyles<ty\n       setLocalGroupToWidgets(restGroupToWidgets);\n \n       // Delete all the widget information that belong to the group\n-      const newWidgetToInfo = localWidgetToInfo;\n-      widgets.forEach((widget) => {\n-        delete newWidgetToInfo[widget];\n+      const newWidgetInfo = localWidgetInfo;\n+      widgets.map((widget) => {", "originalCommit": "756300b8e7a79a288720c7914cccbf68371362d8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ0MDg1OA==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r440440858", "bodyText": "nit: erase the in --> required fields are filled", "author": "elfenheart", "createdAt": "2020-06-15T20:54:09Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/ClosedJsonMenu/index.tsx", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import Divider from '@material-ui/core/Divider';\n+import Drawer from '@material-ui/core/Drawer';\n+import IconButton from '@material-ui/core/IconButton';\n+import List from '@material-ui/core/List';\n+import withStyles, { StyleRules, WithStyles } from '@material-ui/core/styles/withStyles';\n+import Tooltip from '@material-ui/core/Tooltip';\n+import CodeIcon from '@material-ui/icons/Code';\n+import GetAppIcon from '@material-ui/icons/GetApp';\n+import { downloadPluginJSON } from 'components/PluginJSONCreator/Create/Content/JsonMenu/utilities';\n+import { ICreateContext } from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const styles = (theme): StyleRules => {\n+  return {\n+    closedJsonMenu: {\n+      zIndex: theme.zIndex.drawer,\n+    },\n+    closedJsonMenuPaper: {\n+      backgroundColor: theme.palette.white[50],\n+    },\n+    toolbar: {\n+      minHeight: '48px',\n+    },\n+    mainMenu: {\n+      borderTop: `1px solid ${theme.palette.grey['500']}`,\n+      paddingTop: theme.Spacing(1),\n+      paddingBottom: theme.Spacing(1),\n+    },\n+    jsonCollapseActionButtons: {\n+      padding: '15px',\n+      flexDirection: 'column',\n+    },\n+    jsonViewerTooltip: {\n+      fontSize: '14px',\n+      backgroundColor: theme.palette.grey[500],\n+    },\n+  };\n+};\n+\n+const ClosedJsonMenuView: React.FC<ICreateContext & WithStyles<typeof styles>> = (\n+  widgetJSONData\n+) => {\n+  const { classes, pluginName, pluginType, jsonView, setJsonView } = widgetJSONData;\n+  const downloadDisabled = pluginName.length === 0 || pluginType.length === 0;\n+  return (\n+    <div>\n+      <Drawer\n+        open={!jsonView}\n+        variant=\"persistent\"\n+        className={classes.closedJsonMenu}\n+        anchor=\"right\"\n+        ModalProps={{\n+          keepMounted: true,\n+        }}\n+        classes={{\n+          paper: classes.closedJsonMenuPaper,\n+        }}\n+        data-cy=\"navbar-jsonViewer\"\n+      >\n+        <div className={classes.toolbar} />\n+        <List component=\"nav\" dense={true} className={classes.mainMenu}>\n+          <div className={classes.jsonCollapseActionButtons}>\n+            <Tooltip\n+              title=\"Open JSON View\"\n+              classes={{\n+                tooltip: classes.jsonViewerTooltip,\n+              }}\n+            >\n+              <IconButton onClick={() => setJsonView(true)}>\n+                <CodeIcon />\n+              </IconButton>\n+            </Tooltip>\n+            <Divider />\n+\n+            <Tooltip\n+              title={\n+                downloadDisabled\n+                  ? 'Download is disabled until the required fields are filled in'", "originalCommit": "756300b8e7a79a288720c7914cccbf68371362d8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ0MjEzNw==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r440442137", "bodyText": "Can the liveviewer and closed json menu component be combined? It seemed like the contents are very similar", "author": "elfenheart", "createdAt": "2020-06-15T20:56:44Z", "path": "cdap-ui/app/cdap/components/PluginJSONCreator/Create/Content/JsonMenu/index.tsx", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright \u00a9 2020 Cask Data, Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import If from 'components/If';\n+import ClosedJsonMenu from 'components/PluginJSONCreator/Create/Content/JsonMenu/ClosedJsonMenu';\n+import JsonLiveViewer from 'components/PluginJSONCreator/Create/Content/JsonMenu/JsonLiveViewer';\n+import {\n+  CreateContext,\n+  createContextConnect,\n+  ICreateContext,\n+} from 'components/PluginJSONCreator/CreateContextConnect';\n+import * as React from 'react';\n+\n+const JsonMenuView: React.FC<ICreateContext> = ({\n+  pluginName,\n+  pluginType,\n+  displayName,\n+  emitAlerts,\n+  emitErrors,\n+  configurationGroups,\n+  groupToInfo,\n+  groupToWidgets,\n+  widgetInfo,\n+  jsonView,\n+  setJsonView,\n+}) => {\n+  return (\n+    <div>\n+      <If condition={jsonView}>\n+        <JsonLiveViewer\n+          pluginName={pluginName}\n+          pluginType={pluginType}\n+          displayName={displayName}\n+          emitAlerts={emitAlerts}\n+          emitErrors={emitErrors}\n+          configurationGroups={configurationGroups}\n+          groupToInfo={groupToInfo}\n+          groupToWidgets={groupToWidgets}\n+          widgetInfo={widgetInfo}\n+          jsonView={jsonView}\n+          setJsonView={setJsonView}\n+        />\n+      </If>\n+      <If condition={!jsonView}>\n+        <ClosedJsonMenu", "originalCommit": "756300b8e7a79a288720c7914cccbf68371362d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ1NzM4MA==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r440457380", "bodyText": "The PR #12310  addresses this issue with a lot of their content being similar. For all the contents that are being shared between liveviewer and closed json menu, it is shared at \n  \n    \n      cdap/cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/index.tsx\n    \n    \n         Line 234\n      in\n      882eb81\n    \n    \n    \n    \n\n        \n          \n           <Drawer \n        \n    \n  \n\n.", "author": "jennac3", "createdAt": "2020-06-15T21:28:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ0MjEzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ1NzU5OQ==", "url": "https://github.com/cdapio/cdap/pull/12214#discussion_r440457599", "bodyText": "This minimizes repeating code between two components, and now each of these components do not share any same contents.\nAt PR #12310\nLiveViewMenu:\nhttps://github.com/cdapio/cdap/blob/882eb810d3291ed6b39efaf6394a932584abb867/cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/LiveViewMenu/index.tsx\nCollapsedMenu:\nhttps://github.com/cdapio/cdap/blob/882eb810d3291ed6b39efaf6394a932584abb867/cdap-ui/app/cdap/components/PluginJSONCreator/Create/PluginJSONMenu/CollapsedMenu/index.tsx", "author": "jennac3", "createdAt": "2020-06-15T21:28:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ0MjEzNw=="}], "type": "inlineReview"}, {"oid": "d2db2752d6c0224678eaf935cae0212880771b86", "url": "https://github.com/cdapio/cdap/commit/d2db2752d6c0224678eaf935cae0212880771b86", "message": "[CDAP-16863] Show the live JSON view (plugin JSON Creator)", "committedDate": "2020-06-15T22:29:04Z", "type": "forcePushed"}, {"oid": "a17fea4f353c986fd9d885fb05233a424a40a1b3", "url": "https://github.com/cdapio/cdap/commit/a17fea4f353c986fd9d885fb05233a424a40a1b3", "message": "[CDAP-16863] Show the live JSON view (plugin JSON Creator)", "committedDate": "2020-06-15T22:37:55Z", "type": "commit"}, {"oid": "a17fea4f353c986fd9d885fb05233a424a40a1b3", "url": "https://github.com/cdapio/cdap/commit/a17fea4f353c986fd9d885fb05233a424a40a1b3", "message": "[CDAP-16863] Show the live JSON view (plugin JSON Creator)", "committedDate": "2020-06-15T22:37:55Z", "type": "forcePushed"}]}