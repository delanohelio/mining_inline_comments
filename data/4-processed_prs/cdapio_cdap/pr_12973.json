{"pr_number": 12973, "pr_title": "(CDAP-16008) Added pre-job validation for kerberos information", "pr_createdAt": "2020-12-21T21:07:35Z", "pr_url": "https://github.com/cdapio/cdap/pull/12973", "timeline": [{"oid": "735da537a580425636849151203604410218eb24", "url": "https://github.com/cdapio/cdap/commit/735da537a580425636849151203604410218eb24", "message": "(CDAP-16008) Added pre-job validation for kerberos information", "committedDate": "2020-12-21T21:06:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkzMzk3OA==", "url": "https://github.com/cdapio/cdap/pull/12973#discussion_r546933978", "bodyText": "should we check for null or empty?", "author": "CuriousVini", "createdAt": "2020-12-21T21:17:57Z", "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/distributed/remote/RemoteExecutionTwillPreparer.java", "diffHunk": "@@ -147,6 +155,30 @@ protected void launch(TwillRuntimeSpecification twillRuntimeSpec, RuntimeSpecifi\n     }\n   }\n \n+  private void validateKerberos(@Nullable String principal, @Nullable String keytab, SSHSession session) {\n+    if (principal == null || keytab == null) {", "originalCommit": "735da537a580425636849151203604410218eb24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkzNDM3NA==", "url": "https://github.com/cdapio/cdap/pull/12973#discussion_r546934374", "bodyText": "should this message include error message from e?", "author": "CuriousVini", "createdAt": "2020-12-21T21:18:54Z", "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/distributed/remote/RemoteExecutionTwillPreparer.java", "diffHunk": "@@ -147,6 +155,30 @@ protected void launch(TwillRuntimeSpecification twillRuntimeSpec, RuntimeSpecifi\n     }\n   }\n \n+  private void validateKerberos(@Nullable String principal, @Nullable String keytab, SSHSession session) {\n+    if (principal == null || keytab == null) {\n+      return;\n+    }\n+\n+    String klistPath;\n+    try {\n+      klistPath = session.executeAndWait(\"which klist\").trim();\n+    } catch (IOException e) {\n+      LOG.warn(\"Failed to locate klist command for Kerberos validation. \" +\n+                 \"If the Kerberos principal and keytab are mis-configured, program execution will fail.\", e);", "originalCommit": "735da537a580425636849151203604410218eb24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkzNDg1Ng==", "url": "https://github.com/cdapio/cdap/pull/12973#discussion_r546934856", "bodyText": "Why do we just log and return here?", "author": "yaojiefeng", "createdAt": "2020-12-21T21:20:08Z", "path": "cdap-app-fabric/src/main/java/io/cdap/cdap/internal/app/runtime/distributed/remote/RemoteExecutionTwillPreparer.java", "diffHunk": "@@ -147,6 +155,30 @@ protected void launch(TwillRuntimeSpecification twillRuntimeSpec, RuntimeSpecifi\n     }\n   }\n \n+  private void validateKerberos(@Nullable String principal, @Nullable String keytab, SSHSession session) {\n+    if (principal == null || keytab == null) {\n+      return;\n+    }\n+\n+    String klistPath;\n+    try {\n+      klistPath = session.executeAndWait(\"which klist\").trim();\n+    } catch (IOException e) {\n+      LOG.warn(\"Failed to locate klist command for Kerberos validation. \" +", "originalCommit": "735da537a580425636849151203604410218eb24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}