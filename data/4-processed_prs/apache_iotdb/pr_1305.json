{"pr_number": 1305, "pr_title": "IOTDB-734 Add Support for NaN in Double / Floats in SQL Syntax.", "pr_createdAt": "2020-06-02T10:54:13Z", "pr_url": "https://github.com/apache/iotdb/pull/1305", "timeline": [{"oid": "0f70ac1da37d1a588be23ebc01a6549a1b823a06", "url": "https://github.com/apache/iotdb/commit/0f70ac1da37d1a588be23ebc01a6549a1b823a06", "message": "IOTDB-734 Add Support for NaN in Double / Floats in SQL Syntax.", "committedDate": "2020-06-02T10:53:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1Mzg2Mw==", "url": "https://github.com/apache/iotdb/pull/1305#discussion_r434953863", "bodyText": "Hi, there are some configurations for type inference, such as floating_string_infer_type, integer_string_infer_type, and boolean_string_infer_type. Do we need to add a nan_string_infer_type configuration?", "author": "qiaojialin", "createdAt": "2020-06-04T02:15:35Z", "path": "server/src/main/java/org/apache/iotdb/db/utils/TypeInferenceUtils.java", "diffHunk": "@@ -65,6 +64,9 @@ public static TSDataType getPredictedDataType(Object value, boolean inferType) {\n         } else {\n           return floatingStringInferType;\n         }\n+        // \"NaN\" is returned if the NaN Literal is given in Parser\n+      } else if (\"NaN\".equals(strValue)) {\n+        return TSDataType.DOUBLE;", "originalCommit": "0f70ac1da37d1a588be23ebc01a6549a1b823a06", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTAxMzE2OQ==", "url": "https://github.com/apache/iotdb/pull/1305#discussion_r435013169", "bodyText": "Good Hint. Personally I would see Nan as a Double Literal and thus probably use the check on floating_string_infer_type. WDYT?", "author": "JulianFeinauer", "createdAt": "2020-06-04T06:10:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1Mzg2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIwNzk2MQ==", "url": "https://github.com/apache/iotdb/pull/1305#discussion_r435207961", "bodyText": "I prefer to add a configuration nan_string_infer_type=DOUBLE  by default and enable users to change this to TEXT.", "author": "qiaojialin", "createdAt": "2020-06-04T12:17:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1Mzg2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTIwODgzOQ==", "url": "https://github.com/apache/iotdb/pull/1305#discussion_r435208839", "bodyText": "Yes, that makes sense to me. I will add that option (if I find out how this works...:D).", "author": "JulianFeinauer", "createdAt": "2020-06-04T12:18:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1Mzg2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTMzMzA3MA==", "url": "https://github.com/apache/iotdb/pull/1305#discussion_r435333070", "bodyText": "You could add nan_string_infer_type=DOUBLE in server/src/assembly/resources/conf/iotdb-engine.properties\uff0c Then add itmes in IoTDBDescriptor and IoTDBConfig class.\nAfter adding this, the docs should be updated in docs/UserGuide/Server/Config Manual.md.\nI will add some system design doc for how to do these things.", "author": "qiaojialin", "createdAt": "2020-06-04T15:08:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1Mzg2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI1MDk3NQ==", "url": "https://github.com/apache/iotdb/pull/1305#discussion_r436250975", "bodyText": "Thanks for the advice, I have done it. And also added notes for the other inference config properties as they were missing so far.", "author": "JulianFeinauer", "createdAt": "2020-06-06T08:33:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1Mzg2Mw=="}], "type": "inlineReview"}, {"oid": "6cd82ddc49d1528ee37293a1f2fee1a313ec9a92", "url": "https://github.com/apache/iotdb/commit/6cd82ddc49d1528ee37293a1f2fee1a313ec9a92", "message": "IOTDB-734 Added Configuration Item nan_string_infer_type and added it also in documentation.", "committedDate": "2020-06-06T08:33:00Z", "type": "commit"}, {"oid": "40ad4f8bf781d3760877b5b6385b78247cc70c85", "url": "https://github.com/apache/iotdb/commit/40ad4f8bf781d3760877b5b6385b78247cc70c85", "message": "add Chinese user guide", "committedDate": "2020-06-08T10:33:54Z", "type": "commit"}, {"oid": "f59b3963c3ed641b8794f1f4c10d101702b86d7d", "url": "https://github.com/apache/iotdb/commit/f59b3963c3ed641b8794f1f4c10d101702b86d7d", "message": "add more user guide for enable auto create schema", "committedDate": "2020-06-08T10:42:31Z", "type": "commit"}]}