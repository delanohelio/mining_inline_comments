{"pr_number": 1060, "pr_title": "[IOTDB-597] Rename methods in Session", "pr_createdAt": "2020-04-16T05:11:49Z", "pr_url": "https://github.com/apache/iotdb/pull/1060", "timeline": [{"oid": "df8f1e74dfe74d5a59541de352c7882dc3786853", "url": "https://github.com/apache/iotdb/commit/df8f1e74dfe74d5a59541de352c7882dc3786853", "message": "add insertMultiple batch in SessionPool", "committedDate": "2020-04-16T05:11:22Z", "type": "commit"}, {"oid": "bc641cdeffd3ba26662c6178094bc93362776637", "url": "https://github.com/apache/iotdb/commit/bc641cdeffd3ba26662c6178094bc93362776637", "message": "rename session method", "committedDate": "2020-04-16T05:33:16Z", "type": "commit"}, {"oid": "e88e0de2a9a67f73b3305bcd99171c5acf2369d1", "url": "https://github.com/apache/iotdb/commit/e88e0de2a9a67f73b3305bcd99171c5acf2369d1", "message": "fix flink sink", "committedDate": "2020-04-16T08:37:54Z", "type": "commit"}, {"oid": "1312b31b9477787e99ca1df6c4345ee0139bb21f", "url": "https://github.com/apache/iotdb/commit/1312b31b9477787e99ca1df6c4345ee0139bb21f", "message": "fix test", "committedDate": "2020-04-16T12:17:07Z", "type": "commit"}, {"oid": "d29e9c3e696b3f8ac26db9ad8fe9a2e71f599f4b", "url": "https://github.com/apache/iotdb/commit/d29e9c3e696b3f8ac26db9ad8fe9a2e71f599f4b", "message": "rename and refactor", "committedDate": "2020-04-16T15:07:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3NDM3MQ==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r410874371", "bodyText": "don't forget to change the method name of  this. insertInBatch()", "author": "liutaohua", "createdAt": "2020-04-19T10:38:14Z", "path": "example/session/src/main/java/org/apache/iotdb/SessionExample.java", "diffHunk": "@@ -125,20 +125,19 @@ private static void insertInBatch() throws IoTDBConnectionException, BatchExecut\n       valuesList.add(values);\n       timestamps.add(time);\n       if (time != 0 && time % 100 == 0) {\n-        session.insertInBatch(deviceIds, timestamps, measurementsList, valuesList);\n+        session.insertRows(deviceIds, timestamps, measurementsList, valuesList);\n         deviceIds.clear();\n         measurementsList.clear();\n         valuesList.clear();\n         timestamps.clear();\n       }\n     }\n \n-    session.insertInBatch(deviceIds, timestamps, measurementsList, valuesList);\n+    session.insertRows(deviceIds, timestamps, measurementsList, valuesList);", "originalCommit": "d29e9c3e696b3f8ac26db9ad8fe9a2e71f599f4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM1MDEzNA==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414350134", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-24T07:16:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3NDM3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3NTA3MQ==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r410875071", "bodyText": "rowBatchList", "author": "liutaohua", "createdAt": "2020-04-19T10:42:13Z", "path": "example/session/src/main/java/org/apache/iotdb/SessionExample.java", "diffHunk": "@@ -211,10 +209,10 @@ private static void insertMultipleDeviceRowBatch()\n     \n     RowBatch rowBatch3 = schema3.createRowBatch(\"root.sg1.d3\", 100);\n     \n-    Map<String, RowBatch> rowBatchMap = new HashMap<>();\n-    rowBatchMap.put(\"root.sg1.d1\", rowBatch1);\n-    rowBatchMap.put(\"root.sg1.d2\", rowBatch2);\n-    rowBatchMap.put(\"root.sg1.d3\", rowBatch3);\n+    List<RowBatch> rowBatchMap = new ArrayList<>();", "originalCommit": "d29e9c3e696b3f8ac26db9ad8fe9a2e71f599f4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDM1MDE3Ng==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414350176", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-24T07:16:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3NTA3MQ=="}], "type": "inlineReview"}, {"oid": "d05860224677aed881957cdb3f04b78dbff859db", "url": "https://github.com/apache/iotdb/commit/d05860224677aed881957cdb3f04b78dbff859db", "message": "rename records tablet", "committedDate": "2020-04-24T06:03:24Z", "type": "commit"}, {"oid": "c62feb7018fade1f4e7f39097d7d0b254ead0d3e", "url": "https://github.com/apache/iotdb/commit/c62feb7018fade1f4e7f39097d7d0b254ead0d3e", "message": "rename records tablet", "committedDate": "2020-04-24T06:10:22Z", "type": "commit"}, {"oid": "c08c91bec189757b7adce73049e85ad7aca34e67", "url": "https://github.com/apache/iotdb/commit/c08c91bec189757b7adce73049e85ad7aca34e67", "message": "update doc", "committedDate": "2020-04-24T07:01:51Z", "type": "commit"}, {"oid": "820f653c0b215c5238d0dcf60e0b3f2ffadfd44b", "url": "https://github.com/apache/iotdb/commit/820f653c0b215c5238d0dcf60e0b3f2ffadfd44b", "message": "fix sonar", "committedDate": "2020-04-24T07:15:24Z", "type": "commit"}, {"oid": "1d4d7e206e93ce0dc91aaa613a7ef3c1b0209064", "url": "https://github.com/apache/iotdb/commit/1d4d7e206e93ce0dc91aaa613a7ef3c1b0209064", "message": "add insertTables rpc interface", "committedDate": "2020-04-24T07:56:06Z", "type": "commit"}, {"oid": "9743126073f7a134a0d992beba805c36a98dc52e", "url": "https://github.com/apache/iotdb/commit/9743126073f7a134a0d992beba805c36a98dc52e", "message": "fix python interface", "committedDate": "2020-04-24T07:58:48Z", "type": "commit"}, {"oid": "880a8fb67f9744e8dc431071f459f9deaf4f8307", "url": "https://github.com/apache/iotdb/commit/880a8fb67f9744e8dc431071f459f9deaf4f8307", "message": "fix sonar", "committedDate": "2020-04-24T08:03:02Z", "type": "commit"}, {"oid": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "url": "https://github.com/apache/iotdb/commit/b94f4f72703e074ba78c4b3efeccd30391cc17b8", "message": "fix pool return", "committedDate": "2020-04-24T14:37:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcxNjE3Mw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414716173", "bodyText": "I think we should also change the java doc to insert tablet plan.", "author": "HTHou", "createdAt": "2020-04-24T16:45:23Z", "path": "server/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java", "diffHunk": "@@ -576,12 +576,12 @@ private boolean checkTTL(long time) {\n   /**\n    * insert batch to tsfile processor thread-safety that the caller need to guarantee\n    *\n-   * @param batchInsertPlan batch insert plan\n+   * @param insertTabletPlan batch insert plan", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NjU3MA==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414946570", "bodyText": "thanks! fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:32:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcxNjE3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcxOTk0Mg==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414719942", "bodyText": "The comment should be // test insert tablet now.", "author": "HTHou", "createdAt": "2020-04-24T16:51:26Z", "path": "session/src/test/java/org/apache/iotdb/session/IoTDBSessionIT.java", "diffHunk": "@@ -206,14 +202,14 @@ public void testTestMethod()\n     createTimeseries();\n \n     // test insert batch\n-    Schema schema = new Schema();\n-    schema.registerTimeseries(new Path(deviceId, \"s1\"), new MeasurementSchema(\"s1\", TSDataType.INT64, TSEncoding.RLE));\n-    schema.registerTimeseries(new Path(deviceId, \"s2\"), new MeasurementSchema(\"s2\", TSDataType.INT64, TSEncoding.RLE));\n-    schema.registerTimeseries(new Path(deviceId, \"s3\"), new MeasurementSchema(\"s3\", TSDataType.INT64, TSEncoding.RLE));\n+    List<MeasurementSchema> schemaList = new ArrayList<>();", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NjcyMw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414946723", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:33:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcxOTk0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMDgyMQ==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414720821", "bodyText": "// test inset records", "author": "HTHou", "createdAt": "2020-04-24T16:52:54Z", "path": "session/src/test/java/org/apache/iotdb/session/IoTDBSessionIT.java", "diffHunk": "@@ -225,7 +221,7 @@ public void testTestMethod()\n       values.add(\"1\");\n       values.add(\"2\");\n       values.add(\"3\");\n-      session.testInsert(deviceId, time, measurements, values);\n+      session.testInsertRecord(deviceId, time, measurements, values);\n     }\n \n     // test insert row in batch", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NjgxNw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414946817", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:33:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMDgyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMjAyOA==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414722028", "bodyText": "Confirm whether the tablet is legal.", "author": "HTHou", "createdAt": "2020-04-24T16:54:47Z", "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/write/TsFileWriter.java", "diffHunk": "@@ -208,22 +208,22 @@ private boolean checkIsTimeSeriesExist(TSRecord record) throws WriteProcessExcep\n   /**\n    * Confirm whether the row batch is legal.\n    *\n-   * @param rowBatch - a row batch responding multiple columns\n+   * @param tablet - a row batch responding multiple columns\n    * @return - whether the row batch has been added into RecordWriter legally", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NzEwMw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414947103", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:35:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMjAyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMjQwMw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414722403", "bodyText": "write a tablet", "author": "HTHou", "createdAt": "2020-04-24T16:55:23Z", "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/write/TsFileWriter.java", "diffHunk": "@@ -254,16 +254,16 @@ public boolean write(TSRecord record) throws IOException, WriteProcessException\n   /**\n    * write a row batch\n    *\n-   * @param rowBatch - multiple time series of one device that share a time column\n+   * @param tablet - multiple time series of one device that share a time column", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NzE1Mw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414947153", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:35:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMjQwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMjc4NQ==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414722785", "bodyText": "receive a tablet, write it to timeseries writers", "author": "HTHou", "createdAt": "2020-04-24T16:56:03Z", "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/write/chunk/IChunkGroupWriter.java", "diffHunk": "@@ -51,14 +51,14 @@\n   /**\n    * receive a row batch, write it to timeseries writers\n    *\n-   * @param rowBatch\n+   * @param tablet", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NzQwNg==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414947406", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:36:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMjc4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMzQzNQ==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414723435", "bodyText": "Return a tablet", "author": "HTHou", "createdAt": "2020-04-24T16:57:02Z", "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/write/record/Tablet.java", "diffHunk": "@@ -46,49 +57,43 @@\n    */\n   public long[] timestamps;\n   /**\n-   * each object is a primitive type array, which represents values of one\n-   * measurement\n+   * each object is a primitive type array, which represents values of one measurement\n    */\n   public Object[] values;\n   /**\n-   * the number of rows to include in this row batch\n+   * the number of rows to include in this tablet\n    */\n-  public int batchSize;\n+  public int rowSize;\n   /**\n    * the maximum number of rows for this row batch\n    */\n-  private int maxBatchSize;\n-\n-  /**\n-   * total byte size that values occupies\n-   */\n-  private int valueOccupation = -1;\n+  private int maxRowNumber;\n \n   /**\n    * Return a row batch with default specified row number. This is the standard\n-   * constructor (all RowBatch should be the same size).\n+   * constructor (all Tablet should be the same size).", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NzQ2NA==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414947464", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:37:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMzQzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMzYwMw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414723603", "bodyText": "Return a tablet", "author": "HTHou", "createdAt": "2020-04-24T16:57:21Z", "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/write/record/Tablet.java", "diffHunk": "@@ -46,49 +57,43 @@\n    */\n   public long[] timestamps;\n   /**\n-   * each object is a primitive type array, which represents values of one\n-   * measurement\n+   * each object is a primitive type array, which represents values of one measurement\n    */\n   public Object[] values;\n   /**\n-   * the number of rows to include in this row batch\n+   * the number of rows to include in this tablet\n    */\n-  public int batchSize;\n+  public int rowSize;\n   /**\n    * the maximum number of rows for this row batch\n    */\n-  private int maxBatchSize;\n-\n-  /**\n-   * total byte size that values occupies\n-   */\n-  private int valueOccupation = -1;\n+  private int maxRowNumber;\n \n   /**\n    * Return a row batch with default specified row number. This is the standard\n-   * constructor (all RowBatch should be the same size).\n+   * constructor (all Tablet should be the same size).\n    *\n    * @param deviceId   the name of the device specified to be written in\n    * @param timeseries the list of measurement schemas for creating the row batch\n    */\n-  public RowBatch(String deviceId, List<MeasurementSchema> timeseries) {\n+  public Tablet(String deviceId, List<MeasurementSchema> timeseries) {\n     this(deviceId, timeseries, DEFAULT_SIZE);\n   }\n \n   /**\n    * Return a row batch with the specified number of rows (maxBatchSize). Only\n-   * call this constructor directly for testing purposes. RowBatch should normally\n+   * call this constructor directly for testing purposes. Tablet should normally", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NzUwNg==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414947506", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:37:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMzYwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMzkzNw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414723937", "bodyText": "Return the maximum number of rows for this tablet", "author": "HTHou", "createdAt": "2020-04-24T16:57:57Z", "path": "tsfile/src/main/java/org/apache/iotdb/tsfile/write/record/Tablet.java", "diffHunk": "@@ -102,42 +107,42 @@ public RowBatch(String deviceId, List<MeasurementSchema> schemas, int maxBatchSi\n   /**\n    * Return the maximum number of rows for this row batch\n    */", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NzU1Nw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414947557", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:37:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyMzkzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyNDg3MA==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414724870", "bodyText": "// construct the tablet", "author": "HTHou", "createdAt": "2020-04-24T16:59:26Z", "path": "hive-connector/src/test/java/org/apache/iotdb/hive/TsFileTestHelper.java", "diffHunk": "@@ -61,40 +64,42 @@ public static void writeTsFile(String filePath) {\n \n       // add measurements into file schema (all with INT64 data type)\n       for (int i = 0; i < sensorNum; i++) {\n+        MeasurementSchema measurementSchema = new MeasurementSchema(\"sensor_\" + (i + 1),\n+            TSDataType.INT64, TSEncoding.TS_2DIFF, CompressionType.UNCOMPRESSED);\n         schema.registerTimeseries(new Path(\"device_1\", \"sensor_\" + (i + 1)),\n-            new MeasurementSchema(\"sensor_\" + (i + 1), TSDataType.INT64, TSEncoding.TS_2DIFF,\n-                CompressionType.UNCOMPRESSED));\n+            measurementSchema);\n+        schemaList.add(measurementSchema);\n       }\n \n       // add measurements into TSFileWriter\n       TsFileWriter tsFileWriter = new TsFileWriter(file, schema);\n \n       // construct the row batch\n-      RowBatch rowBatch = schema.createRowBatch(\"device_1\");\n+      Tablet tablet = new Tablet(\"device_1\", schemaList);", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0NzY3Mg==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414947672", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:38:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyNDg3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyNTA4Nw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414725087", "bodyText": "// construct the tablet", "author": "HTHou", "createdAt": "2020-04-24T16:59:50Z", "path": "hadoop/src/test/java/org/apache/iotdb/hadoop/tsfile/TsFileTestHelper.java", "diffHunk": "@@ -61,39 +64,42 @@ public static void writeTsFile(String filePath) {\n \n       // add timeseries into file schema (all with INT64 data type)\n       for (int i = 0; i < sensorNum; i++) {\n+        MeasurementSchema measurementSchema = new MeasurementSchema(\"sensor_\" + (i + 1),\n+            TSDataType.INT64, TSEncoding.TS_2DIFF);\n         schema.registerTimeseries(new Path(\"device_1\", \"sensor_\" + (i + 1)),\n-                new MeasurementSchema(\"sensor_\" + (i + 1), TSDataType.INT64, TSEncoding.TS_2DIFF));\n+            measurementSchema);\n+        schemaList.add(measurementSchema);\n       }\n \n       // add timeseries into TSFileWriter\n       TsFileWriter tsFileWriter = new TsFileWriter(file, schema);\n \n       // construct the row batch\n-      RowBatch rowBatch = schema.createRowBatch(\"device_1\");\n+      Tablet tablet = new Tablet(\"device_1\", schemaList);", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk0Nzg2Mw==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414947863", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:39:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyNTA4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyNTYzOA==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414725638", "bodyText": "// construct the tablet", "author": "HTHou", "createdAt": "2020-04-24T17:00:41Z", "path": "example/hadoop/src/main/java/org/apache/iotdb/hadoop/tsfile/TsFileHelper.java", "diffHunk": "@@ -52,39 +54,47 @@ public static void writeTsFile(String filePath) {\n \n       Schema schema = new Schema();\n \n+      List<MeasurementSchema> schemaList = new ArrayList<>();\n+\n       // the number of rows to include in the row batch\n       int rowNum = 1000000;\n       // the number of values to include in the row batch\n       int sensorNum = 10;\n \n       // add measurements into file schema (all with INT64 data type)\n       for (int i = 0; i < 2; i++) {\n+        MeasurementSchema measurementSchema = new MeasurementSchema(\n+            Constant.SENSOR_PREFIX + (i + 1), TSDataType.INT64,\n+            TSEncoding.TS_2DIFF);\n         schema.registerTimeseries(new Path(Constant.DEVICE_1, Constant.SENSOR_PREFIX + (i + 1)),\n-            new MeasurementSchema(Constant.SENSOR_PREFIX + (i + 1), TSDataType.INT64,\n-                TSEncoding.TS_2DIFF));\n+            measurementSchema);\n+        schemaList.add(measurementSchema);\n       }\n \n       for (int i = 2; i < sensorNum; i++) {\n+        MeasurementSchema measurementSchema = new MeasurementSchema(\n+            Constant.SENSOR_PREFIX + (i + 1), TSDataType.DOUBLE,\n+            TSEncoding.TS_2DIFF);\n         schema.registerTimeseries(new Path(Constant.DEVICE_1, Constant.SENSOR_PREFIX + (i + 1)),\n-            new MeasurementSchema(Constant.SENSOR_PREFIX + (i + 1), TSDataType.DOUBLE,\n-                TSEncoding.TS_2DIFF));\n+            measurementSchema);\n+        schemaList.add(measurementSchema);\n       }\n \n       // add measurements into TSFileWriter\n       TsFileWriter tsFileWriter = new TsFileWriter(file, schema);\n \n       // construct the row batch\n-      RowBatch rowBatch = schema.createRowBatch(Constant.DEVICE_1);\n+      Tablet tablet = new Tablet(Constant.DEVICE_1, schemaList);", "originalCommit": "b94f4f72703e074ba78c4b3efeccd30391cc17b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDk1MDAzNQ==", "url": "https://github.com/apache/iotdb/pull/1060#discussion_r414950035", "bodyText": "fixed", "author": "qiaojialin", "createdAt": "2020-04-25T01:51:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDcyNTYzOA=="}], "type": "inlineReview"}, {"oid": "cd980727382f2c911886ebfbf340756049bc041a", "url": "https://github.com/apache/iotdb/commit/cd980727382f2c911886ebfbf340756049bc041a", "message": "rename all row batch to tablet", "committedDate": "2020-04-25T01:40:47Z", "type": "commit"}]}