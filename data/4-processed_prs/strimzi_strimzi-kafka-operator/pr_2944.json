{"pr_number": 2944, "pr_title": "[DOC] update the Using the User Operator section", "pr_createdAt": "2020-05-04T15:56:09Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944", "timeline": [{"oid": "62f43384440d15f452a16f5827c45c66636bfc4f", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/62f43384440d15f452a16f5827c45c66636bfc4f", "message": "update the using the user operator section\n\nSigned-off-by: prmellor <pmellor@redhat.com>", "committedDate": "2020-05-04T15:42:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNTk0Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419635947", "bodyText": "I think this is confusing and the reader might not understand what he should do. Eben I'm not completely sure what does this refer to. Does it refer to the KAfkaUser authentication section?", "author": "scholzj", "createdAt": "2020-05-04T18:22:47Z", "path": "documentation/modules/proc-configuring-kafka-user.adoc", "diffHunk": "@@ -0,0 +1,68 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-using-the-user-operator.adoc\n+\n+[id='proc-configuring-kafka-user-{context}']\n+= Configuring a Kafka user\n+\n+Use the properties of the `KafkaUser` resource to configure a Kafka user.\n+\n+You can use `kubectl apply` to create or modify users, and `kubectl delete` to delete existing users.\n+\n+* `kubectl apply -f _<user-config-file>_`\n+* `kubectl delete KafkaUser _<user-name>_`\n+\n+When you create a user, you must configure the authentication and authorization mechanisms required when connecting to Kafka brokers using a listener.", "originalCommit": "62f43384440d15f452a16f5827c45c66636bfc4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxNzI2OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419917268", "bodyText": "Is this clearer:\n\nWhen you configure a KafkaUser, you use the spec property to define the authentication and authorization mechanisms required for the Kafka user to be able to connect to Kafka brokers.", "author": "PaulRMellor", "createdAt": "2020-05-05T07:36:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNTk0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxOTU1NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419919555", "bodyText": "Sorry, no. It isn't. What are you trying to say? that the KafkaUser.spec.authntication should match Kafka.spec.kafka.listeners.*.authentication? And that Kafka.spec.kafka.authorization needs to be configured to use KafkaUser.spec.authorization? Then we should probably list this. I do not think this is really clear from it.", "author": "scholzj", "createdAt": "2020-05-05T07:41:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNTk0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY0MTY2Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r420641662", "bodyText": "Okay. How about:\n\nWhen you configure the KafkaUser authentication and authorization mechanisms, ensure they match the equivalent Kafka configuration:\n\nKafkaUser.spec.authentication matches Kafka.spec.kafka.listeners.*.authentication\nKafkaUser.spec.authorization matches Kafka.spec.kafka.authorization", "author": "PaulRMellor", "createdAt": "2020-05-06T08:59:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNTk0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNjM5Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419636396", "bodyText": "It does and it doesn't .... the user will not get any error when such authentication is not enabled in the broker. There is no check for that. So this might be a bit confusing.", "author": "scholzj", "createdAt": "2020-05-04T18:23:36Z", "path": "documentation/modules/proc-configuring-kafka-user.adoc", "diffHunk": "@@ -0,0 +1,68 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-using-the-user-operator.adoc\n+\n+[id='proc-configuring-kafka-user-{context}']\n+= Configuring a Kafka user\n+\n+Use the properties of the `KafkaUser` resource to configure a Kafka user.\n+\n+You can use `kubectl apply` to create or modify users, and `kubectl delete` to delete existing users.\n+\n+* `kubectl apply -f _<user-config-file>_`\n+* `kubectl delete KafkaUser _<user-name>_`\n+\n+When you create a user, you must configure the authentication and authorization mechanisms required when connecting to Kafka brokers using a listener.\n+\n+This procedure shows how a user is created with TLS authentication.\n+The authentication required depends on the xref:assembly-kafka-broker-listener-authentication-deployment-configuration-kafka[type of authentication configured for the Kafka broker listener].", "originalCommit": "62f43384440d15f452a16f5827c45c66636bfc4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg4MDI2Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419880267", "bodyText": "The user won't get an error but anyway user authentication depends on the authentication settings in Kafka, of course, you cannot authenticate a user via TLS if it's not enabled in the Kafka configuration. I think that this sentence is appropriate here.", "author": "ppatierno", "createdAt": "2020-05-05T06:03:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNjM5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkyMzQ1MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419923451", "bodyText": "Maybe we could add a note:\n\nNOTE: Authentication between Kafka users and Kafka brokers depends on the authentication settings for each. For example, it is not possible to authenticate a user through TLS if it is not also enabled in the Kafka configuration.\n\nNot sure if this is too much or makes things clearer?", "author": "PaulRMellor", "createdAt": "2020-05-05T07:49:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNjM5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkyNjg5MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419926890", "bodyText": "I think this is good. I would also add similar note on authorization since that seems to be a common mistake among users that they do not enable it and wonder why it does not work.", "author": "scholzj", "createdAt": "2020-05-05T07:56:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNjM5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk5Mjc1Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419992752", "bodyText": "Yes it's good for me as well.", "author": "ppatierno", "createdAt": "2020-05-05T09:55:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNjM5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDYzMDg2NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r420630865", "bodyText": "\ud83d\udc4d", "author": "PaulRMellor", "createdAt": "2020-05-06T08:40:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNjM5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNzE0Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419637143", "bodyText": "I wonder if everyone will understand that this is not the only option.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * A running Kafka cluster xref:con-mutual-tls-authentication-deployment-configuration-kafka[configured with a Kafka broker listener using TLS authentication and encryption].\n          \n          \n            \n            * A running Kafka cluster xref:con-mutual-tls-authentication-deployment-configuration-kafka[configured with a Kafka broker listener using for example TLS authentication and encryption].", "author": "scholzj", "createdAt": "2020-05-04T18:24:43Z", "path": "documentation/modules/proc-configuring-kafka-user.adoc", "diffHunk": "@@ -0,0 +1,68 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-using-the-user-operator.adoc\n+\n+[id='proc-configuring-kafka-user-{context}']\n+= Configuring a Kafka user\n+\n+Use the properties of the `KafkaUser` resource to configure a Kafka user.\n+\n+You can use `kubectl apply` to create or modify users, and `kubectl delete` to delete existing users.\n+\n+* `kubectl apply -f _<user-config-file>_`\n+* `kubectl delete KafkaUser _<user-name>_`\n+\n+When you create a user, you must configure the authentication and authorization mechanisms required when connecting to Kafka brokers using a listener.\n+\n+This procedure shows how a user is created with TLS authentication.\n+The authentication required depends on the xref:assembly-kafka-broker-listener-authentication-deployment-configuration-kafka[type of authentication configured for the Kafka broker listener].\n+\n+.Prerequisites\n+\n+* A running Kafka cluster xref:con-mutual-tls-authentication-deployment-configuration-kafka[configured with a Kafka broker listener using TLS authentication and encryption].", "originalCommit": "62f43384440d15f452a16f5827c45c66636bfc4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk1MzY1NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419953654", "bodyText": "I've changed this a little to make it more clear on the types of authentication:", "author": "PaulRMellor", "createdAt": "2020-05-05T08:45:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNzE0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk3MDQ0MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419970441", "bodyText": "That looks good.", "author": "scholzj", "createdAt": "2020-05-05T09:15:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzNzE0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzODI0Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419638247", "bodyText": "I think that the change of the title is misleading since this only one of the ways. It doesn't cover for example OAuth. So I think this should be still abotu the KafkaUser resource.", "author": "scholzj", "createdAt": "2020-05-04T18:26:34Z", "path": "documentation/modules/ref-kafka-user.adoc", "diffHunk": "@@ -3,30 +3,34 @@\n // assembly-using-the-user-operator.adoc\n \n [id='ref-kafka-user-{context}']\n-= Kafka User resource\n+= Securing user access to Kafka", "originalCommit": "62f43384440d15f452a16f5827c45c66636bfc4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk1NjMyOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419956329", "bodyText": "Good point, though we do mention oauth. Reverted.", "author": "PaulRMellor", "createdAt": "2020-05-05T08:50:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzODI0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzODkzNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419638934", "bodyText": "The example seems to be missing the p12 file and password. We should add it. Please let me or @ppatierno know if you need the example.", "author": "scholzj", "createdAt": "2020-05-04T18:27:38Z", "path": "documentation/modules/ref-kafka-user.adoc", "diffHunk": "@@ -41,12 +45,12 @@ spec:\n   # ...\n ----\n \n-When the user is created by the User Operator, it will create a new secret with the same name as the `KafkaUser` resource.\n-The secret will contain a public and private key which should be used for the TLS Client Authentication.\n-Bundled with them will be the public key of the client certification authority which was used to sign the user certificate.\n-All keys will be in X509 format.\n+When the user is created by the User Operator, it creates a new secret with the same name as the `KafkaUser` resource.\n+The secret contains a public and private key to use for TLS client authentication.\n+Bundled with the keys is the public key of the client Certificate Authority (CA) used to sign the user certificate.\n+All keys are in X.509 format.\n \n-.An example of the `Secret` with user credentials\n+.An example `Secret` with user credentials", "originalCommit": "62f43384440d15f452a16f5827c45c66636bfc4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkwMDMyMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419900322", "bodyText": "Thanks @scholzj . I was going to ask about P12. Example would be useful.", "author": "PaulRMellor", "createdAt": "2020-05-05T06:57:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzODkzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkxNDIwNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419914204", "bodyText": "The data section now looks something like this:\ndata:\n  ca.crt: # ...\n  user.crt: # ...\n  user.key: # ...\n  user.p12: # ...\n  user.password: # ...", "author": "scholzj", "createdAt": "2020-05-05T07:30:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzODkzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY4NTYzMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r420685631", "bodyText": "Updated:\n\nSecrets provide private keys and certificates in PEM and PKCS #12 formats.\nFor more information on securing Kafka communication with Secrets, see xref:security-{context}[].\ndata:\n  ca.crt: # Public key of the client CA\n  user.crt: # User certificate that contains the public key of the user\n  user.key: # Private key of the user\n  user.p12: # PKCS #12 archive file for storing certificates and keys\n  user.password: # Password for protecting the PKCS #12 archive file", "author": "PaulRMellor", "createdAt": "2020-05-06T10:21:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTYzODkzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg4MTU0MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419881540", "bodyText": "you mention the \"user certificate\" here which is actually the \"public key\" mentioned in the line above.\nWe should always remember that a certificate contains a public key signed by another certificate coming from a CA.\nSo the user certificate is/contains actually the public key which is signed by the client CA certificate (which is itself a public key but self-signed in our case).", "author": "ppatierno", "createdAt": "2020-05-05T06:07:18Z", "path": "documentation/modules/ref-kafka-user.adoc", "diffHunk": "@@ -41,12 +45,12 @@ spec:\n   # ...\n ----\n \n-When the user is created by the User Operator, it will create a new secret with the same name as the `KafkaUser` resource.\n-The secret will contain a public and private key which should be used for the TLS Client Authentication.\n-Bundled with them will be the public key of the client certification authority which was used to sign the user certificate.\n-All keys will be in X509 format.\n+When the user is created by the User Operator, it creates a new secret with the same name as the `KafkaUser` resource.\n+The secret contains a public and private key to use for TLS client authentication.\n+Bundled with the keys is the public key of the client Certificate Authority (CA) used to sign the user certificate.", "originalCommit": "62f43384440d15f452a16f5827c45c66636bfc4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk2NjI1NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419966255", "bodyText": "I'm hoping this is clearer:\n\nThe public key is contained in a user certificate, which is signed by the client Certificate Authority (CA).", "author": "PaulRMellor", "createdAt": "2020-05-05T09:08:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg4MTU0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk5MzA5Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r419993092", "bodyText": "it's better yes.", "author": "ppatierno", "createdAt": "2020-05-05T09:56:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTg4MTU0MA=="}], "type": "inlineReview"}, {"oid": "f214d843cab23a94b6a7423bd364983c73d29bd2", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f214d843cab23a94b6a7423bd364983c73d29bd2", "message": "review edits JS\n\nSigned-off-by: prmellor <pmellor@redhat.com>", "committedDate": "2020-05-06T10:22:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg4MzgwOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r420883809", "bodyText": "I guess one empty line would be enough", "author": "scholzj", "createdAt": "2020-05-06T15:29:23Z", "path": "documentation/modules/proc-configuring-kafka-user.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-using-the-user-operator.adoc\n+\n+[id='proc-configuring-kafka-user-{context}']\n+= Configuring a Kafka user\n+\n+Use the properties of the `KafkaUser` resource to configure a Kafka user.\n+\n+You can use `kubectl apply` to create or modify users, and `kubectl delete` to delete existing users.\n+\n+For example:\n+\n+* `kubectl apply -f _<user-config-file>_`\n+* `kubectl delete KafkaUser _<user-name>_`\n+\n+When you configure the `KafkaUser` authentication and authorization mechanisms, ensure they match the equivalent `Kafka` configuration:\n+\n+* `KafkaUser.spec.authentication` matches `Kafka.spec.kafka.listeners.*.authentication`\n+* `KafkaUser.spec.authorization` matches `Kafka.spec.kafka.authorization`\n+", "originalCommit": "f214d843cab23a94b6a7423bd364983c73d29bd2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk1MzMwMA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r420953300", "bodyText": "As a KafkaUser...", "author": "laidan6000", "createdAt": "2020-05-06T17:10:10Z", "path": "documentation/modules/proc-configuring-kafka-user.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-using-the-user-operator.adoc\n+\n+[id='proc-configuring-kafka-user-{context}']\n+= Configuring a Kafka user\n+\n+Use the properties of the `KafkaUser` resource to configure a Kafka user.\n+\n+You can use `kubectl apply` to create or modify users, and `kubectl delete` to delete existing users.\n+\n+For example:\n+\n+* `kubectl apply -f _<user-config-file>_`\n+* `kubectl delete KafkaUser _<user-name>_`\n+\n+When you configure the `KafkaUser` authentication and authorization mechanisms, ensure they match the equivalent `Kafka` configuration:\n+\n+* `KafkaUser.spec.authentication` matches `Kafka.spec.kafka.listeners.*.authentication`\n+* `KafkaUser.spec.authorization` matches `Kafka.spec.kafka.authorization`\n+\n+\n+a `KafkaUser`, you use the `spec` property to define the `authentication` and `authorization` mechanisms required for the Kafka user to be able to connect to Kafka brokers.", "originalCommit": "f214d843cab23a94b6a7423bd364983c73d29bd2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM1NzUyMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r421357523", "bodyText": "Actually, that line was meant to be taken out pending changes in previous paragraph. Removed now.", "author": "PaulRMellor", "createdAt": "2020-05-07T09:12:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk1MzMwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk1NDI1OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2944#discussion_r420954259", "bodyText": "Suggested change:\nfrom the secret my-user > from the my-user secret", "author": "laidan6000", "createdAt": "2020-05-06T17:11:38Z", "path": "documentation/modules/proc-configuring-kafka-user.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-using-the-user-operator.adoc\n+\n+[id='proc-configuring-kafka-user-{context}']\n+= Configuring a Kafka user\n+\n+Use the properties of the `KafkaUser` resource to configure a Kafka user.\n+\n+You can use `kubectl apply` to create or modify users, and `kubectl delete` to delete existing users.\n+\n+For example:\n+\n+* `kubectl apply -f _<user-config-file>_`\n+* `kubectl delete KafkaUser _<user-name>_`\n+\n+When you configure the `KafkaUser` authentication and authorization mechanisms, ensure they match the equivalent `Kafka` configuration:\n+\n+* `KafkaUser.spec.authentication` matches `Kafka.spec.kafka.listeners.*.authentication`\n+* `KafkaUser.spec.authorization` matches `Kafka.spec.kafka.authorization`\n+\n+\n+a `KafkaUser`, you use the `spec` property to define the `authentication` and `authorization` mechanisms required for the Kafka user to be able to connect to Kafka brokers.\n+\n+This procedure shows how a user is created with TLS authentication.\n+You can also create a user with SCRAM-SHA authentication.\n+\n+The authentication required depends on the xref:assembly-kafka-broker-listener-authentication-deployment-configuration-kafka[type of authentication configured for the Kafka broker listener].\n+\n+NOTE: Authentication between Kafka users and Kafka brokers depends on the authentication settings for each.\n+For example, it is not possible to authenticate a user with TLS if it is not also enabled in the Kafka configuration.\n+\n+.Prerequisites\n+\n+* A running Kafka cluster xref:con-mutual-tls-authentication-deployment-configuration-kafka[configured with a Kafka broker listener using TLS authentication and encryption].\n+* A running User Operator (typically xref:assembly-kafka-entity-operator-deployment-configuration-kafka[deployed with the Entity Operator]).\n+\n+If you are using SCRAM-SHA authentication, you need a running Kafka cluster xref:con-scram-sha-authentication-deployment-configuration-kafka[configured with a Kafka broker listener using SCRAM-SHA authentication].\n+\n+.Procedure\n+\n+. Prepare a YAML file containing the `KafkaUser` to be created.\n++\n+.An example `KafkaUser`\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaUserApiVersion}\n+kind: KafkaUser\n+metadata:\n+  name: my-user\n+  labels:\n+    strimzi.io/cluster: my-cluster\n+spec:\n+  authentication: <1>\n+    type: tls\n+  authorization:\n+    type: simple <2>\n+    acls:\n+      - resource:\n+          type: topic\n+          name: my-topic\n+          patternType: literal\n+        operation: Read\n+      - resource:\n+          type: topic\n+          name: my-topic\n+          patternType: literal\n+        operation: Describe\n+      - resource:\n+          type: group\n+          name: my-group\n+          patternType: literal\n+        operation: Read\n+----\n+<1> User authentication mechanism, defined as mutual `tls` or `scram-sha-512`.\n+<2> Simple authorization, which requires an accompanying list of ACL rules.\n+\n+. Create the `KafkaUser` resource in Kubernetes.\n++\n+[source,shell,subs=+quotes]\n+kubectl apply -f _<user-config-file>_\n+\n+. Use the credentials from the secret `my-user` in your client application.", "originalCommit": "f214d843cab23a94b6a7423bd364983c73d29bd2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b1517f15dcab0317669425bb7ea5202da654a161", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b1517f15dcab0317669425bb7ea5202da654a161", "message": "review edits DL\n\nSigned-off-by: prmellor <pmellor@redhat.com>", "committedDate": "2020-05-07T09:16:06Z", "type": "commit"}, {"oid": "bb00bf8a4915538f51ed19ef71829205b7f6244e", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/bb00bf8a4915538f51ed19ef71829205b7f6244e", "message": "change order of additional deployment options\n\nSigned-off-by: prmellor <pmellor@redhat.com>", "committedDate": "2020-05-11T10:12:05Z", "type": "commit"}]}