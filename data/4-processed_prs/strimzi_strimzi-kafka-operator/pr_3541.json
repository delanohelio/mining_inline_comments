{"pr_number": 3541, "pr_title": "[DOC] Contributing guide update to describe Custom Resource API Reference build", "pr_createdAt": "2020-08-24T16:33:51Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3541", "timeline": [{"oid": "f385b8d6546e4ab9e0306f5b491ee0c8dadc2ec2", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f385b8d6546e4ab9e0306f5b491ee0c8dadc2ec2", "message": "[DOC] Contributing guide update to describe Custom Resource API Reference build\n\nSigned-off-by: prmellor <pmellor@redhat.com>", "committedDate": "2020-08-24T16:30:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTc4NzQwNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3541#discussion_r475787405", "bodyText": "I think you should make it clear that this is generated automatically by the Maven build and does not have to be done manually.", "author": "scholzj", "createdAt": "2020-08-24T17:43:49Z", "path": "documentation/contributing/introduction.adoc", "diffHunk": "@@ -80,4 +82,57 @@ In contrast to the _Deploying_ guide, this guide provides a reduced set of instr\n \n The _Using Strimzi_ guide provides configuration instructions for Kafka components, and instructions for using Strimzi Operators.\n The majority of the content relates to how you might want to modify your deployment and introduce additional features, such as Cruise Control or distributed tracing.\n-The _Using Strimzi_ guide also contains the API reference guide which is generated directly from the Java code of the operators.\n+\n+=== Custom Resource API Reference\n+\n+The _Using Strimzi_ guide (documentation/using/master.adoc) also contains a _Custom Resource API Reference_ that describes the configuration properties for custom resources.\n+\n+The _Custom Resource API Reference_ is built from two files.\n+\n+.Custom Resource API Reference files\n+[source,asciidoc,options=\"nowrap\"]\n+----\n+\\include::modules/con-common-configuration-properties.adoc[leveloffset=+1]\n+\\include::modules/appendix_crds.adoc[]\n+----\n+\n+The `con-common-configuration-properties.adoc` file contains descriptions of common configuration properties.\n+The content for the `documentation/modules/appendix_crds.adoc` file is generated directly from descriptions in the Java code.\n+\n+Java files in the `api/` folder are annotated so that the descriptions are picked up in the build.\n+\n+.Java annotations for documentation\n+[source,java,options=\"nowrap\"]\n+----\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+----\n+\n+The tables in `appendix_crds.adoc` are built from `@Description` annotations in the Java files.\n+\n+Additional information is included by adding:\n+\n+. An `@DescriptionFile` annotation to the Java file\n+. A corresponding description file (`.adoc`) in the `documentation/api/` folder\n+. An `include:__DESCRIPTION-FILE-NAME__` reference in `appendix_crds.adoc`", "originalCommit": "f385b8d6546e4ab9e0306f5b491ee0c8dadc2ec2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMwNzY5NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3541#discussion_r476307694", "bodyText": "The include:__DESCRIPTION-FILE-NAME__ reference is added automatically by the Maven build, so you do not need to add it manually.", "author": "PaulRMellor", "createdAt": "2020-08-25T09:23:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTc4NzQwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI3MzQ4MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3541#discussion_r476273481", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            api/                                 # Property descriptions for the Custom Resource API Reference\n          \n          \n            \n            api/                                 # Property descriptions for the Custom Resource API Reference section of the _Using Strimzi_ guide", "author": "laidan6000", "createdAt": "2020-08-25T08:31:50Z", "path": "documentation/contributing/introduction.adoc", "diffHunk": "@@ -36,8 +36,10 @@ Assemblies, which usually encapsulate a feature or process, bring the related co\n An assembly is like a sub-section or chapter in a book.\n For example, the _Deploying Strimzi_ guide has a chapter called _Verifying the Strimzi deployment_, which is contained in its own assembly.\n \n+.Documentation folder descriptions\n [source,options=\"nowrap\",subs=\"+quotes\"]\n ----\n+api/                                 # Property descriptions for the Custom Resource API Reference", "originalCommit": "f385b8d6546e4ab9e0306f5b491ee0c8dadc2ec2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI3NjAwOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3541#discussion_r476276009", "bodyText": "The KafkaUserQuotas object / resource?", "author": "laidan6000", "createdAt": "2020-08-25T08:35:50Z", "path": "documentation/contributing/introduction.adoc", "diffHunk": "@@ -80,4 +82,57 @@ In contrast to the _Deploying_ guide, this guide provides a reduced set of instr\n \n The _Using Strimzi_ guide provides configuration instructions for Kafka components, and instructions for using Strimzi Operators.\n The majority of the content relates to how you might want to modify your deployment and introduce additional features, such as Cruise Control or distributed tracing.\n-The _Using Strimzi_ guide also contains the API reference guide which is generated directly from the Java code of the operators.\n+\n+=== Custom Resource API Reference\n+\n+The _Using Strimzi_ guide (documentation/using/master.adoc) also contains a _Custom Resource API Reference_ that describes the configuration properties for custom resources.\n+\n+The _Custom Resource API Reference_ is built from two files.\n+\n+.Custom Resource API Reference files\n+[source,asciidoc,options=\"nowrap\"]\n+----\n+\\include::modules/con-common-configuration-properties.adoc[leveloffset=+1]\n+\\include::modules/appendix_crds.adoc[]\n+----\n+\n+The `con-common-configuration-properties.adoc` file contains descriptions of common configuration properties.\n+The content for the `documentation/modules/appendix_crds.adoc` file is generated directly from descriptions in the Java code.\n+\n+Java files in the `api/` folder are annotated so that the descriptions are picked up in the build.\n+\n+.Java annotations for documentation\n+[source,java,options=\"nowrap\"]\n+----\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+----\n+\n+The tables in `appendix_crds.adoc` are built from `@Description` annotations in the Java files.\n+\n+Additional information is included by adding:\n+\n+. An `@DescriptionFile` annotation to the Java file\n+. A corresponding description file (`.adoc`) in the `documentation/api/` folder\n+. An `include:__DESCRIPTION-FILE-NAME__` reference in `appendix_crds.adoc`\n+\n+For example, to add additional configuration for `KafkaUserQuotas`:", "originalCommit": "f385b8d6546e4ab9e0306f5b491ee0c8dadc2ec2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMwOTc5NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3541#discussion_r476309795", "bodyText": "KafkaUserQuotas custom resource", "author": "PaulRMellor", "createdAt": "2020-08-25T09:26:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI3NjAwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI3NzU0OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3541#discussion_r476277548", "bodyText": "Typo: any\nYou must rebuild the API Reference before submitting the PR?", "author": "laidan6000", "createdAt": "2020-08-25T08:38:28Z", "path": "documentation/contributing/introduction.adoc", "diffHunk": "@@ -80,4 +82,57 @@ In contrast to the _Deploying_ guide, this guide provides a reduced set of instr\n \n The _Using Strimzi_ guide provides configuration instructions for Kafka components, and instructions for using Strimzi Operators.\n The majority of the content relates to how you might want to modify your deployment and introduce additional features, such as Cruise Control or distributed tracing.\n-The _Using Strimzi_ guide also contains the API reference guide which is generated directly from the Java code of the operators.\n+\n+=== Custom Resource API Reference\n+\n+The _Using Strimzi_ guide (documentation/using/master.adoc) also contains a _Custom Resource API Reference_ that describes the configuration properties for custom resources.\n+\n+The _Custom Resource API Reference_ is built from two files.\n+\n+.Custom Resource API Reference files\n+[source,asciidoc,options=\"nowrap\"]\n+----\n+\\include::modules/con-common-configuration-properties.adoc[leveloffset=+1]\n+\\include::modules/appendix_crds.adoc[]\n+----\n+\n+The `con-common-configuration-properties.adoc` file contains descriptions of common configuration properties.\n+The content for the `documentation/modules/appendix_crds.adoc` file is generated directly from descriptions in the Java code.\n+\n+Java files in the `api/` folder are annotated so that the descriptions are picked up in the build.\n+\n+.Java annotations for documentation\n+[source,java,options=\"nowrap\"]\n+----\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+----\n+\n+The tables in `appendix_crds.adoc` are built from `@Description` annotations in the Java files.\n+\n+Additional information is included by adding:\n+\n+. An `@DescriptionFile` annotation to the Java file\n+. A corresponding description file (`.adoc`) in the `documentation/api/` folder\n+. An `include:__DESCRIPTION-FILE-NAME__` reference in `appendix_crds.adoc`\n+\n+For example, to add additional configuration for `KafkaUserQuotas`:\n+\n+. `api/src/main/java/io/strimzi/api/kafka/model/KafkaUserQuotas.java` contains:\n+** `import io.strimzi.crdgenerator.annotations.Description`\n+** `import io.strimzi.crdgenerator.annotations.DescriptionFile`\n+** `@Description(\"_descriptions for individual properties..._\");`\n+** An `@DescriptionFile` annotation\n+. `documentation/api` includes the `io.strimzi.api.kafka.model.KafkaUserQuotas.adoc` file containing the additional configuration description.\n++\n+The description file requires the same name as the related Java package.\n+. `appendix_crds.adoc` contains a reference to include the additional configuration description:\n++\n+[source,asciidoc,options=\"nowrap\"]\n+----\n+### `KafkaUserQuotas` schema reference\n+\n+/include::../api/io.strimzi.api.kafka.model.KafkaUserQuotas.adoc[leveloffset=+1]\n+----\n+\n+If you change any anything in the `api` module of the Java code, you must rebuild the _Custom Resource API Reference_ using a xref:make-tooling[make command].", "originalCommit": "f385b8d6546e4ab9e0306f5b491ee0c8dadc2ec2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMxMTk4Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3541#discussion_r476311983", "bodyText": "\ud83d\udc4d  I added to the build section\n\nIf you change the Strimzi API, you need to regenerate the API Reference before submitting your PR by running the following from the root:", "author": "PaulRMellor", "createdAt": "2020-08-25T09:30:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI3NzU0OA=="}], "type": "inlineReview"}, {"oid": "478ac6d63092e7e9b113d16bbfb1863e3b060a4e", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/478ac6d63092e7e9b113d16bbfb1863e3b060a4e", "message": "review edits JS\n\nSigned-off-by: prmellor <pmellor@redhat.com>", "committedDate": "2020-08-25T09:24:10Z", "type": "commit"}, {"oid": "fe19553222433206920b76dffa2c5ffce3064c04", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fe19553222433206920b76dffa2c5ffce3064c04", "message": "review edits DL\n\nSigned-off-by: prmellor <pmellor@redhat.com>", "committedDate": "2020-08-25T09:34:15Z", "type": "commit"}]}