{"pr_number": 3738, "pr_title": "Let the new listeners use only ports 9092 and higher", "pr_createdAt": "2020-10-01T15:30:42Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738", "timeline": [{"oid": "63ce670a4ab0458a779b6a713f3cf32763e94d94", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/63ce670a4ab0458a779b6a713f3cf32763e94d94", "message": "Let the new listeners use only ports 9092 and higher\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-10-01T15:21:43Z", "type": "commit"}, {"oid": "040c949f590d7a86d98c19f455455df814975a16", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/040c949f590d7a86d98c19f455455df814975a16", "message": "Improve tests\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-10-01T15:29:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0NjE2Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498746163", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX.\n          \n          \n            \n            Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999, which are already used for Prometheus and JMX.", "author": "PaulRMellor", "createdAt": "2020-10-02T10:39:03Z", "path": "documentation/api/io.strimzi.api.kafka.model.listener.arraylistener.GenericKafkaListener.adoc", "diffHunk": "@@ -63,6 +63,7 @@ listeners:\n \n The name and port must be unique within the Kafka cluster.\n The name can be up to 25 characters long, comprising lower-case letters and numbers.\n+Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX.", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0NjI5OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498746298", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. \" +\n          \n          \n            \n                        \"Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999, which are already used for Prometheus and JMX. \" +", "author": "PaulRMellor", "createdAt": "2020-10-02T10:39:20Z", "path": "api/src/main/java/io/strimzi/api/kafka/model/listener/arraylistener/GenericKafkaListener.java", "diffHunk": "@@ -66,8 +67,10 @@ public void setName(String name) {\n     @Description(\"Port number used by the listener. \" +\n             \"The port number has to be unique within a given Kafka cluster. \" +\n             \"The port number will be used for the listener inside Kafka. \" +\n+            \"Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. \" +", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0Njc0OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498746749", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |port                1.2+<.<|Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, it might not be the port number where the Kafka clients connect.\n          \n          \n            \n            |port                1.2+<.<|Port number used by the listener inside Kafka. The port number has to be unique within a given Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999, which are already used for Prometheus and JMX. Depending on the listener type, it might not be the port number where the Kafka clients connect.", "author": "PaulRMellor", "createdAt": "2020-10-02T10:40:30Z", "path": "documentation/modules/appendix_crds.adoc", "diffHunk": "@@ -193,7 +193,7 @@ include::../api/io.strimzi.api.kafka.model.listener.arraylistener.GenericKafkaLi\n |Property                   |Description\n |name                1.2+<.<|Name of the listener. The name will be used to identify the listener and the related Kubernetes objects. The name has to be unique within given a Kafka cluster. The name can consist of lowercase characters and numbers and be up to 11 characters long.\n |string\n-|port                1.2+<.<|Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Depending on the listener type, it might not be the port number where the Kafka clients connect.\n+|port                1.2+<.<|Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, it might not be the port number where the Kafka clients connect.", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0NzQ0NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498747444", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <3> Port number for the listener. Must be unique within the Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.\n          \n          \n            \n            <3> Port number used by the listener inside Kafka. The port number has to be unique within a given Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999, which are already used for Prometheus and JMX. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.", "author": "PaulRMellor", "createdAt": "2020-10-02T10:42:07Z", "path": "documentation/modules/deploying/proc-deploy-setup-external-clients.adoc", "diffHunk": "@@ -93,7 +93,7 @@ spec:\n ----\n <1> Configuration options for enabling external listeners are described in the link:{BookURLUsing}#type-GenericKafkaListener-reference[Generic Kafka listener schema reference^].\n <2> Name to identify the listener. Must be unique within the Kafka cluster.\n-<3> Port number for the listener. Must be unique within the Kafka cluster. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.\n+<3> Port number for the listener. Must be unique within the Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0NzgzMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498747833", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <8> Port number for the listener. Must be unique within the Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.\n          \n          \n            \n            <8> Port number used by the listener inside Kafka. The port number has to be unique within a given Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999, which are already used for Prometheus and JMX. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.", "author": "PaulRMellor", "createdAt": "2020-10-02T10:43:05Z", "path": "documentation/modules/ref-sample-kafka-resource-config.adoc", "diffHunk": "@@ -132,7 +132,7 @@ spec:\n <5> JVM options can xref:ref-jvm-options-{context}[specify the minimum (`-Xms`) and maximum (`-Xmx`) memory allocation for JVM].\n <6> Listeners configure how clients connect to the Kafka cluster via bootstrap addresses. Listeners are xref:assembly-securing-kafka-brokers-str[configured as _internal_ or _external_ listeners for connection inside or outside the Kubernetes cluster].\n <7> Name to identify the listener. Must be unique within the Kafka cluster.\n-<8> Port number for the listener. Must be unique within the Kafka cluster. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.\n+<8> Port number for the listener. Must be unique within the Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0OTA1MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498749050", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Description(\"Port number used by the listener. \" +\n          \n          \n            \n                @Description(\"Port number used by the listener inside Kafka. \" +", "author": "PaulRMellor", "createdAt": "2020-10-02T10:46:08Z", "path": "api/src/main/java/io/strimzi/api/kafka/model/listener/arraylistener/GenericKafkaListener.java", "diffHunk": "@@ -66,8 +67,10 @@ public void setName(String name) {\n     @Description(\"Port number used by the listener. \" +", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0OTE5Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498749197", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"The port number will be used for the listener inside Kafka. \" +", "author": "PaulRMellor", "createdAt": "2020-10-02T10:46:30Z", "path": "api/src/main/java/io/strimzi/api/kafka/model/listener/arraylistener/GenericKafkaListener.java", "diffHunk": "@@ -66,8 +67,10 @@ public void setName(String name) {\n     @Description(\"Port number used by the listener. \" +\n             \"The port number has to be unique within a given Kafka cluster. \" +\n             \"The port number will be used for the listener inside Kafka. \" +", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc1MTU1Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498751557", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        description: Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, it might not be the port number where the Kafka clients connect.\n          \n          \n            \n                                        description: Port number used by the listener inside Kafka. The port number has to be unique within a given Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999, which are already used for Prometheus and JMX. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.", "author": "PaulRMellor", "createdAt": "2020-10-02T10:52:14Z", "path": "helm-charts/helm2/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -160,7 +160,8 @@ spec:\n                             description: Name of the listener. The name will be used to identify the listener and the related Kubernetes objects. The name has to be unique within given a Kafka cluster. The name can consist of lowercase characters and numbers and be up to 11 characters long.\n                           port:\n                             type: integer\n-                            description: Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Depending on the listener type, it might not be the port number where the Kafka clients connect.\n+                            minimum: 9092\n+                            description: Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, it might not be the port number where the Kafka clients connect.", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc1MTk2Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498751962", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        description: Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, it might not be the port number where the Kafka clients connect.\n          \n          \n            \n                                        description: Port number used by the listener inside Kafka. The port number has to be unique within a given Kafka cluster. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999, which are already used for Prometheus and JMX. Depending on the listener type, the port number might not be the same as the port number that connects Kafka clients.", "author": "PaulRMellor", "createdAt": "2020-10-02T10:53:12Z", "path": "helm-charts/helm3/strimzi-kafka-operator/crds/040-Crd-kafka.yaml", "diffHunk": "@@ -156,7 +156,8 @@ spec:\n                             description: Name of the listener. The name will be used to identify the listener and the related Kubernetes objects. The name has to be unique within given a Kafka cluster. The name can consist of lowercase characters and numbers and be up to 11 characters long.\n                           port:\n                             type: integer\n-                            description: Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Depending on the listener type, it might not be the port number where the Kafka clients connect.\n+                            minimum: 9092\n+                            description: Port number used by the listener. The port number has to be unique within a given Kafka cluster. The port number will be used for the listener inside Kafka. Allowed port numbers are 9092 and higher with the exception of ports 9404 and 9999 which are already used for Prometheus and JMX. Depending on the listener type, it might not be the port number where the Kafka clients connect.", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc1MzIwMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498753203", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                      description: Port number used by the listener. The port\n          \n          \n            \n                                      description: Port number used by the listener inside Kafka. \n          \n          \n            \n                                      The port", "author": "PaulRMellor", "createdAt": "2020-10-02T10:56:30Z", "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -186,11 +186,14 @@ spec:\n                             and be up to 11 characters long.\n                         port:\n                           type: integer\n+                          minimum: 9092\n                           description: Port number used by the listener. The port", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc1MzI5NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498753294", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        The port number will be used for the listener inside Kafka.", "author": "PaulRMellor", "createdAt": "2020-10-02T10:56:44Z", "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -186,11 +186,14 @@ spec:\n                             and be up to 11 characters long.\n                         port:\n                           type: integer\n+                          minimum: 9092\n                           description: Port number used by the listener. The port\n                             number has to be unique within a given Kafka cluster.\n                             The port number will be used for the listener inside Kafka.", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc1NDE1Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3738#discussion_r498754157", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        Allowed port numbers are 9092 and higher with the exception\n          \n          \n            \n                                        of ports 9404 and 9999 which are already used for Prometheus\n          \n          \n            \n                                        and JMX. Depending on the listener type, it might not\n          \n          \n            \n                                        be the port number where the Kafka clients connect.\n          \n          \n            \n                                        Allowed port numbers are 9092 and higher with the \n          \n          \n            \n                                        exception of ports 9404 and 9999, which are already used \n          \n          \n            \n                                        for Prometheus and JMX. Depending on the listener type, \n          \n          \n            \n                                        the port number might not be the same as the port \n          \n          \n            \n                                        number that connects Kafka clients.", "author": "PaulRMellor", "createdAt": "2020-10-02T10:58:45Z", "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -186,11 +186,14 @@ spec:\n                             and be up to 11 characters long.\n                         port:\n                           type: integer\n+                          minimum: 9092\n                           description: Port number used by the listener. The port\n                             number has to be unique within a given Kafka cluster.\n                             The port number will be used for the listener inside Kafka.\n-                            Depending on the listener type, it might not be the port\n-                            number where the Kafka clients connect.\n+                            Allowed port numbers are 9092 and higher with the exception\n+                            of ports 9404 and 9999 which are already used for Prometheus\n+                            and JMX. Depending on the listener type, it might not\n+                            be the port number where the Kafka clients connect.", "originalCommit": "040c949f590d7a86d98c19f455455df814975a16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "55c8b6b774c5e726f904d5c564912955a0b8b919", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/55c8b6b774c5e726f904d5c564912955a0b8b919", "message": "Review comments\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-10-02T11:39:50Z", "type": "commit"}]}