{"pr_number": 3252, "pr_title": "[DOC] Use the new zone label in documentation", "pr_createdAt": "2020-06-26T21:17:16Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252", "timeline": [{"oid": "66757d6f1fef6d3b45b56bee1a225d4fb080253b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/66757d6f1fef6d3b45b56bee1a225d4fb080253b", "message": "Use the new zone label in documentation\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-06-26T20:24:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUwNTY3Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r446505673", "bodyText": "maybe we can specify what is the latest Kubernetes version still supporting the old label?", "author": "ppatierno", "createdAt": "2020-06-27T09:26:46Z", "path": "documentation/modules/proc-configuring-kafka-rack-awareness.adoc", "diffHunk": "@@ -10,7 +10,7 @@ The `rack` object has one mandatory field named `topologyKey`.\n This key needs to match one of the labels assigned to the Kubernetes cluster nodes.\n The label is used by Kubernetes when scheduling the Kafka broker pods to nodes.\n If the Kubernetes cluster is running on a cloud provider platform, that label should represent the availability zone where the node is running.\n-Usually, the nodes are labeled with `failure-domain.beta.kubernetes.io/zone` that can be easily used as the `topologyKey` value.\n+Usually, the nodes are labeled with `topology.kubernetes.io/zone` label (or `failure-domain.beta.kubernetes.io/zone` on older Kubernetes versions) that can be easily used as the `topologyKey` value.", "originalCommit": "66757d6f1fef6d3b45b56bee1a225d4fb080253b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNjg5Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r446516896", "bodyText": "AFAIK it is only deperecated. Not yet removed.", "author": "scholzj", "createdAt": "2020-06-27T11:50:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUwNTY3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNzY2Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r446517662", "bodyText": "Yes you are right, as I read here [1] \"Starting in v1.17, this label is deprecated in favor of topology.kubernetes.io/zone\". I would add the same note in our documentation. At least that it's deprecated starting in v1.17.\n[1] https://kubernetes.io/docs/reference/kubernetes-api/labels-annotations-taints/", "author": "ppatierno", "createdAt": "2020-06-27T12:00:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUwNTY3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU0NzkwOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r446547909", "bodyText": "I added there a link to the Kubernetes page - it might have the version where they remove it in the future. Is that ok?", "author": "scholzj", "createdAt": "2020-06-27T17:27:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUwNTY3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ4MjY2MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r447482660", "bodyText": "That's fine thanks.", "author": "ppatierno", "createdAt": "2020-06-30T07:51:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUwNTY3Mw=="}], "type": "inlineReview"}, {"oid": "2ed1f03125653c95564002b02dfa4cca78205106", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2ed1f03125653c95564002b02dfa4cca78205106", "message": "Review comments\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-06-27T17:27:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ1MjA2Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r447452062", "bodyText": "Do we need the 'Usually'?  Nodes are assigned a topology.kubernetes.io/zone label (or failure-domain.beta.kubernetes.io/zone on older Kubernetes versions), which can be used as the topologyKey value.", "author": "PaulRMellor", "createdAt": "2020-06-30T06:56:19Z", "path": "documentation/modules/proc-configuring-kafka-rack-awareness.adoc", "diffHunk": "@@ -10,7 +10,8 @@ The `rack` object has one mandatory field named `topologyKey`.\n This key needs to match one of the labels assigned to the Kubernetes cluster nodes.\n The label is used by Kubernetes when scheduling the Kafka broker pods to nodes.\n If the Kubernetes cluster is running on a cloud provider platform, that label should represent the availability zone where the node is running.\n-Usually, the nodes are labeled with `failure-domain.beta.kubernetes.io/zone` that can be easily used as the `topologyKey` value.\n+Usually, the nodes are labeled with `topology.kubernetes.io/zone` label (or `failure-domain.beta.kubernetes.io/zone` on older Kubernetes versions) that can be easily used as the `topologyKey` value.", "originalCommit": "2ed1f03125653c95564002b02dfa4cca78205106", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzUyNzE2Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r447527166", "bodyText": "Well, it is usually - it can happen that the nodes will use different or no label as well. So I think removing it will suggests that it is always the case which it is not.", "author": "scholzj", "createdAt": "2020-06-30T09:00:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ1MjA2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ1MjcxOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r447452719", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            For more details about the Kubernetes node labels, see {K8sWellKnownLabelsAnnotationsAndTaints}.\n          \n          \n            \n            For more information about Kubernetes node labels, see {K8sWellKnownLabelsAnnotationsAndTaints}.", "author": "PaulRMellor", "createdAt": "2020-06-30T06:57:42Z", "path": "documentation/modules/proc-configuring-kafka-rack-awareness.adoc", "diffHunk": "@@ -10,7 +10,8 @@ The `rack` object has one mandatory field named `topologyKey`.\n This key needs to match one of the labels assigned to the Kubernetes cluster nodes.\n The label is used by Kubernetes when scheduling the Kafka broker pods to nodes.\n If the Kubernetes cluster is running on a cloud provider platform, that label should represent the availability zone where the node is running.\n-Usually, the nodes are labeled with `failure-domain.beta.kubernetes.io/zone` that can be easily used as the `topologyKey` value.\n+Usually, the nodes are labeled with `topology.kubernetes.io/zone` label (or `failure-domain.beta.kubernetes.io/zone` on older Kubernetes versions) that can be easily used as the `topologyKey` value.\n+For more details about the Kubernetes node labels, see {K8sWellKnownLabelsAnnotationsAndTaints}.", "originalCommit": "2ed1f03125653c95564002b02dfa4cca78205106", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ1MzE2MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r447453160", "bodyText": "Same comment as above", "author": "PaulRMellor", "createdAt": "2020-06-30T06:58:34Z", "path": "documentation/modules/ref-kafka-rack.adoc", "diffHunk": "@@ -11,7 +11,7 @@ The label is used by Kubernetes when scheduling the Kafka broker pods to nodes.\n \n If the Kubernetes cluster is running on a cloud provider platform, that label should represent the availability zone where the node is running.\n If the Kubernetes cluster is running on a cloud provider platform, that label should represent the availability zone where the node is running.\n-Usually, the nodes are labelled with `failure-domain.beta.kubernetes.io/zone` that can be easily used as the `topologyKey` value.\n+Usually, the nodes are labeled with `topology.kubernetes.io/zone` label (or `failure-domain.beta.kubernetes.io/zone` on older Kubernetes versions) that can be easily used as the `topologyKey` value.", "originalCommit": "2ed1f03125653c95564002b02dfa4cca78205106", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzQ1NDE1OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3252#discussion_r447454158", "bodyText": "Better placed before the example?  Above might not be on same page in PDF.\nIn the following example, the topology.kubernetes.io/zone node label is used for scheduling Kafka broker Pods.", "author": "PaulRMellor", "createdAt": "2020-06-30T07:00:34Z", "path": "documentation/modules/ref-kafka-rack.adoc", "diffHunk": "@@ -25,11 +25,11 @@ spec:\n   kafka:\n     # ...\n     rack:\n-      topologyKey: failure-domain.beta.kubernetes.io/zone\n+      topologyKey: topology.kubernetes.io/zone\n     # ...\n ----\n \n-In the above example, the `failure-domain.beta.kubernetes.io/zone` node label will be used for scheduling Kafka broker Pods.\n+In the above example, the `topology.kubernetes.io/zone` node label will be used for scheduling Kafka broker Pods.", "originalCommit": "2ed1f03125653c95564002b02dfa4cca78205106", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "16f7b9e0b316cad2a40e0d0712f7314f8db06aa5", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/16f7b9e0b316cad2a40e0d0712f7314f8db06aa5", "message": "Review comments\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-06-30T09:25:58Z", "type": "commit"}]}