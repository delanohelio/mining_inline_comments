{"pr_number": 3212, "pr_title": "Remove CPUCapacity Goal from default master goals and hard goals list", "pr_createdAt": "2020-06-18T10:42:39Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE2MzU4Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212#discussion_r442163582", "bodyText": "Should we maybe add the same explnatory comment as we have above?", "author": "scholzj", "createdAt": "2020-06-18T11:41:16Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/CruiseControlConfiguration.java", "diffHunk": "@@ -46,6 +47,23 @@\n \n     public static final String CRUISE_CONTROL_GOALS = String.join(\",\", CRUISE_CONTROL_GOALS_LIST);\n \n+    /**\n+     * A list of case insensitive goals that Cruise Control will use as hard goals that must all be met for an optimization\n+     * proppsal to be valid.\n+     */\n+    protected static final List<String> CRUISE_CONTROL_HARD_GOALS_LIST = Collections.unmodifiableList(\n+            Arrays.asList(\n+                    CruiseControl.RACK_AWARENESS_GOAL,\n+                    CruiseControl.REPLICA_CAPACITY_GOAL,\n+                    CruiseControl.DISK_CAPACITY_GOAL,\n+                    CruiseControl.NETWORK_INBOUND_CAPACITY_GOAL,\n+                    CruiseControl.NETWORK_OUTBOUND_CAPACITY_GOAL\n+                    //CruiseControl.CPU_CAPACITY_GOAL", "originalCommit": "abfe5f5aa8af4b9be878a33c0f1f59027d736e83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE3OTAxNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212#discussion_r442179015", "bodyText": "Will do.", "author": "tomncooper", "createdAt": "2020-06-18T12:12:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjE2MzU4Mg=="}], "type": "inlineReview"}, {"oid": "0428db2162ebc24faa82d365bff7188a6307a04b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/0428db2162ebc24faa82d365bff7188a6307a04b", "message": "Removed CPUCapacity Goal from default master goals and hard goals list\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-06-18T12:13:31Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI4MjI1Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212#discussion_r442282257", "bodyText": "if we have an upstream issue I would add the link here as well, otherwise we should open one and linking it here?", "author": "ppatierno", "createdAt": "2020-06-18T14:44:43Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/CruiseControlConfiguration.java", "diffHunk": "@@ -30,7 +30,9 @@\n                 CruiseControl.DISK_CAPACITY_GOAL,\n                 CruiseControl.NETWORK_INBOUND_CAPACITY_GOAL,\n                 CruiseControl.NETWORK_OUTBOUND_CAPACITY_GOAL,\n-                CruiseControl.CPU_CAPACITY_GOAL,\n+                // TODO: The CPU metric are currently not reported correctly when running on Kubernetes\n+                //       we should add this back in once fixed upstream\n+                //CruiseControl.CPU_CAPACITY_GOAL,", "originalCommit": "0428db2162ebc24faa82d365bff7188a6307a04b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI5NjMzNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212#discussion_r442296334", "bodyText": "I added a link to the issue @kyguy made in the upstream repo", "author": "tomncooper", "createdAt": "2020-06-18T15:03:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI4MjI1Nw=="}], "type": "inlineReview"}, {"oid": "fa2e9eaf9fb879a1b03779d543a48fa43a111a23", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fa2e9eaf9fb879a1b03779d543a48fa43a111a23", "message": "Removed CPUCapacity Goal from default master goals and hard goals list\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-06-18T15:02:53Z", "type": "forcePushed"}, {"oid": "5274f3bb30a16bebfbe29013fe9f8af40feb38fa", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5274f3bb30a16bebfbe29013fe9f8af40feb38fa", "message": "Removed CPUCapacity Goal from default master goals and hard goals list\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-06-18T16:36:38Z", "type": "forcePushed"}, {"oid": "c418b8b46529d4acac58047df21af5fc67c2d1c4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c418b8b46529d4acac58047df21af5fc67c2d1c4", "message": "Removed CPUCapacity Goal from default master goals and hard goals list\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-06-18T16:40:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM5ODYzMA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212#discussion_r442398630", "bodyText": "Is there a Strimzi issue connected to this also?", "author": "samuel-hawker", "createdAt": "2020-06-18T17:46:27Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/CruiseControlConfiguration.java", "diffHunk": "@@ -30,7 +30,9 @@\n                 CruiseControl.DISK_CAPACITY_GOAL,\n                 CruiseControl.NETWORK_INBOUND_CAPACITY_GOAL,\n                 CruiseControl.NETWORK_OUTBOUND_CAPACITY_GOAL,\n-                CruiseControl.CPU_CAPACITY_GOAL,\n+                // TODO: The CPU metric are currently not reported correctly when running on Kubernetes\n+                //       we should add this back in once fixed upstream, see https://github.com/linkedin/cruise-control/issues/1242", "originalCommit": "c418b8b46529d4acac58047df21af5fc67c2d1c4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjczNDg1MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212#discussion_r442734850", "bodyText": "That is an interesting point, this is not an issue with Strimzi but with CC, so its not an \"issue\" more of a TODO? I can make one if you think it needs tracking?", "author": "tomncooper", "createdAt": "2020-06-19T09:32:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM5ODYzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjc0MzU0MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212#discussion_r442743541", "bodyText": "Added #3215", "author": "tomncooper", "createdAt": "2020-06-19T09:50:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM5ODYzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM5ODg0NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3212#discussion_r442398844", "bodyText": "*proposal", "author": "samuel-hawker", "createdAt": "2020-06-18T17:46:49Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/CruiseControlConfiguration.java", "diffHunk": "@@ -46,6 +48,25 @@\n \n     public static final String CRUISE_CONTROL_GOALS = String.join(\",\", CRUISE_CONTROL_GOALS_LIST);\n \n+    /**\n+     * A list of case insensitive goals that Cruise Control will use as hard goals that must all be met for an optimization\n+     * proppsal to be valid.", "originalCommit": "c418b8b46529d4acac58047df21af5fc67c2d1c4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c342d4d7591e25fa7ca6a3854fe764bbd533fe90", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c342d4d7591e25fa7ca6a3854fe764bbd533fe90", "message": "Removed CPUCapacity Goal from default master goals and hard goals list\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-06-19T09:48:12Z", "type": "commit"}, {"oid": "c342d4d7591e25fa7ca6a3854fe764bbd533fe90", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c342d4d7591e25fa7ca6a3854fe764bbd533fe90", "message": "Removed CPUCapacity Goal from default master goals and hard goals list\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>", "committedDate": "2020-06-19T09:48:12Z", "type": "forcePushed"}]}