{"pr_number": 3819, "pr_title": "[DOC] Kafka Bridge - document message format including Kafka headers ", "pr_createdAt": "2020-10-15T13:26:09Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819", "timeline": [{"oid": "1d95700db0244663bbc0d9d6cd1b0a3768553524", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1d95700db0244663bbc0d9d6cd1b0a3768553524", "message": "updates for kafka headers, message format\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-10-15T13:16:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU2MTY5MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#discussion_r505561690", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * When performing producer operations, `POST` requests must provide `Content-Type` headers specifying the desired _embedded data format_ of the messages produced. This can be either `json` or `binary`.\n          \n          \n            \n            * When performing producer operations, `POST` requests must provide `Content-Type` headers specifying the  _embedded data format_ of the messages produced. This can be either `json` or `binary`.", "author": "PaulRMellor", "createdAt": "2020-10-15T13:54:32Z", "path": "documentation/modules/con-requests-kafka-bridge.adoc", "diffHunk": "@@ -18,9 +18,9 @@ API request and response bodies are always encoded as JSON.\n Content-Type: application/vnd.kafka.v2+json\n ----\n \n-* When performing producer operations, `POST` requests must provide `Content-Type` headers specifying the desired _embedded data format_, either `json` or `binary`, as shown in the following table.\n+* When performing producer operations, `POST` requests must provide `Content-Type` headers specifying the desired _embedded data format_ of the messages produced. This can be either `json` or `binary`.", "originalCommit": "1d95700db0244663bbc0d9d6cd1b0a3768553524", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e0c31f60465548dcbfd8156a1447373d0fb33eb9", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e0c31f60465548dcbfd8156a1447373d0fb33eb9", "message": "review comment PM\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-10-15T14:02:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYzNDI0NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#discussion_r505634244", "bodyText": "@ppatierno Was the value not supposed to be base64 encoded?", "author": "scholzj", "createdAt": "2020-10-15T15:25:20Z", "path": "documentation/modules/con-requests-kafka-bridge.adoc", "diffHunk": "@@ -74,16 +74,50 @@ If you choose to specify a binary embedded data format, subsequent producer requ\n \n Producer requests must also provide a `Content-Type` header that corresponds to the embedded data format, for example, `Content-Type: application/vnd.kafka.binary.v2+json`.\n \n+== Message format\n+\n+When sending messages using the `/topics/` endpoint, you enter the message payload in the `records` parameter in the request body.\n+\n+The `records` parameter can contain any of these optional fields:\n+\n+* Message `headers`\n+* Message `key`\n+* Message `value`\n+* Destination `partition`\n+\n+.Example `POST` request\n+[source,curl,subs=attributes+]\n+----\n+curl -X POST \\\n+  http://localhost:8080/topics/my-topic \\\n+  -H 'content-type: application/vnd.kafka.json.v2+json' \\\n+  -d '{\n+    \"records\": [\n+        {\n+            \"key\": \"my-key\",\n+            \"value\": \"sales-lead-0001\"\n+            \"partition\": 2\n+            \"headers\": [\n+              {\n+                \"key\": \"key1\",\n+                \"value\": \"value1\"", "originalCommit": "e0c31f60465548dcbfd8156a1447373d0fb33eb9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzU0NDM2Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#discussion_r507544367", "bodyText": "@scholzj yes it has to be a base64 encoded value.", "author": "ppatierno", "createdAt": "2020-10-19T07:56:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYzNDI0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjA3Mjc1MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#discussion_r512072751", "bodyText": "I've changed this to Base64 and added a call-out.\nDoes the value on line 98 also need to be Base64 encoded? @ppatierno", "author": "laidan6000", "createdAt": "2020-10-26T15:56:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYzNDI0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjE5OTY5NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#discussion_r512199694", "bodyText": "no that's the value of the message and depends on the embedded format chosen for the created consumer.", "author": "ppatierno", "createdAt": "2020-10-26T19:01:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYzNDI0NA=="}], "type": "inlineReview"}, {"oid": "689d330145299506f3e553716a59fe3a72db81f3", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/689d330145299506f3e553716a59fe3a72db81f3", "message": "review comments\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-10-26T15:54:18Z", "type": "commit"}]}