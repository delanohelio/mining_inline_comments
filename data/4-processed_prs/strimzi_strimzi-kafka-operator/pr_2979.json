{"pr_number": 2979, "pr_title": "feat: add support for Helm 3", "pr_createdAt": "2020-05-08T13:40:31Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979", "timeline": [{"oid": "a66f282c0627f6383250d06fc26360cfac045c69", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a66f282c0627f6383250d06fc26360cfac045c69", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-08T14:16:19Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIxNjQxNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422216417", "bodyText": "I would recommend something slightly less confusing to a reader, easier as well to pick this out if we ever deprecate the helm 2 charts\n- If you are using the Helm version 2 charts, after installing the Helm CLI ensure you run `helm init` to configure to your cluster.", "author": "samuel-hawker", "createdAt": "2020-05-08T15:42:01Z", "path": "HACKING.md", "diffHunk": "@@ -24,7 +24,7 @@ To build this project you must first install several command line utilities and\n - [`make`](https://www.gnu.org/software/make/) - Make build system\n - [`mvn`](https://maven.apache.org/index.html) (version 3.5 and above) - Maven CLI\n - [`helm`](https://helm.sh/) - Helm Package Management System for Kubernetes\n-    - After installing Helm be sure to run `helm init`.\n+    - If you are using any Helm 2+ (exluding Helm 3+ versions), after installing Helm be sure to run `helm init`.", "originalCommit": "a66f282c0627f6383250d06fc26360cfac045c69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIyMjkwMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422222902", "bodyText": "Sure, will do.", "author": "sgkiokas", "createdAt": "2020-05-08T15:54:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIxNjQxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIxNzAzMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422217032", "bodyText": "For the Helm version 2 chart, run:", "author": "samuel-hawker", "createdAt": "2020-05-08T15:43:09Z", "path": "HACKING.md", "diffHunk": "@@ -233,7 +233,13 @@ This labels your latest container build as `strimzi/operator:latest` and you can\n \n The `strimzi-kafka-operator` Helm Chart can be installed directly from its source.\n \n-    helm install ./helm-charts/strimzi-kafka-operator\n+For any Helm 2+ version, run:", "originalCommit": "a66f282c0627f6383250d06fc26360cfac045c69", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIxNzA3Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422217077", "bodyText": "For the Helm version 3 chart, run:", "author": "samuel-hawker", "createdAt": "2020-05-08T15:43:14Z", "path": "HACKING.md", "diffHunk": "@@ -233,7 +233,13 @@ This labels your latest container build as `strimzi/operator:latest` and you can\n \n The `strimzi-kafka-operator` Helm Chart can be installed directly from its source.\n \n-    helm install ./helm-charts/strimzi-kafka-operator\n+For any Helm 2+ version, run:\n+\n+    `helm install ./helm-charts/helm2/strimzi-kafka-operator`\n+\n+For any Helm 3+ version, run:", "originalCommit": "a66f282c0627f6383250d06fc26360cfac045c69", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIxODkzMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422218933", "bodyText": "Probably will alleviate confusion if you doc as a comment above this that this is used both as the path to the specific chart as well as the name of the cli tool you are using to package/install it.\nNow that I think on it more deeply I do wonder if we should split this out to:\nHELM_CLI ?= helm\nCHART_PATH ?= ./helm-charts/helm3/strimzi-kafka-operator/\n\nAnd we override in travis HELM_CLI to be helm2/helm3", "author": "samuel-hawker", "createdAt": "2020-05-08T15:46:49Z", "path": "helm-charts/Makefile", "diffHunk": "@@ -5,7 +5,8 @@ include ../Makefile.os\n RELEASE_VERSION ?= latest\n CHART_SEMANTIC_RELEASE_VERSION ?= $(shell cat ../release.version | tr A-Z a-z)\n CHART_NAME=strimzi-kafka-operator\n-CHART_PATH=./$(CHART_NAME)/\n+HELM_VERSION ?= helm3", "originalCommit": "a66f282c0627f6383250d06fc26360cfac045c69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIzMDE4MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422230180", "bodyText": "I am slightly confused with the suggestion here... Do you mean to have something like the following?\nHELM_CLI ?= helm\nHELM_VERSION ?= 3\nCHART_PATH ?= ./helm-charts/$(HELM_CLI)$(HELM_VERSION)/strimzi-kafka-operator/\n\nWhat I am missing is how in this pipeline passes those env vars down to the Makefile. Are we talking about the\n  - TEST_HELM_VERSION=v2.16.3\n  - TEST_HELM3_VERSION=v3.2.0\n\nas well?", "author": "sgkiokas", "createdAt": "2020-05-08T16:08:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIxODkzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM3MzY1MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r424373651", "bodyText": "I think TEST_HELM_VERSION -> should go to TEST_HELM2_VERSION\nAnd I think the chart path should just be a single string that defaults to thje second chart, i.e.\nHELM_CLI ?= helm\nCHART_PATH ?= ./helm-charts/helm2/strimzi-kafka-operator/\n\nThis means we can still build the helm3 chart by overriding the path and we can apply different paths to the cli for instance to build helm3 chart you could run\nHELM_CLI=\"/usr/bin/local/helm3\" CHART_PATH=\"./helm-charts/helm3/strimzi-kafka-operator/\" make ...\n\nBut maybe I am misunderstanding something here...", "author": "samuel-hawker", "createdAt": "2020-05-13T11:45:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIxODkzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIyMTYzMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422221631", "bodyText": "Similarly this should maybe split out into two variables similar to described above", "author": "samuel-hawker", "createdAt": "2020-05-08T15:51:57Z", "path": "install/Makefile", "diffHunk": "@@ -4,34 +4,35 @@ include ../Makefile.os\n \n RELEASE_VERSION ?= latest\n RELEASE_PATH ?= ../strimzi-$(RELEASE_VERSION)/$(PROJECT_NAME)\n+HELM_VERSION ?= helm3", "originalCommit": "a66f282c0627f6383250d06fc26360cfac045c69", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f6c3a2b9d82c34cc1980522bd59fc58c1e2bb514", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f6c3a2b9d82c34cc1980522bd59fc58c1e2bb514", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-08T16:51:27Z", "type": "forcePushed"}, {"oid": "b22621e6bfadc1261e9d602a0004824bfeb8d802", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b22621e6bfadc1261e9d602a0004824bfeb8d802", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-08T19:10:48Z", "type": "forcePushed"}, {"oid": "2c2225101e548daeb83a2083daa433a25702f15b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2c2225101e548daeb83a2083daa433a25702f15b", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-08T19:14:23Z", "type": "forcePushed"}, {"oid": "e9978937ba7aec474ea11b61087a864907c495a4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e9978937ba7aec474ea11b61087a864907c495a4", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-08T19:45:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg5NzYzNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422897635", "bodyText": "I wonder if the right solution here is to move the Makefile one level down and have a separate Makefile for Helm2 and sepaarte one for Helm 3? With some modification to the SUBDIRS in the main make file, that should also allow to build both helm charts in single run I assume.", "author": "scholzj", "createdAt": "2020-05-11T09:12:16Z", "path": "helm-charts/Makefile", "diffHunk": "@@ -5,7 +5,8 @@ include ../Makefile.os\n RELEASE_VERSION ?= latest\n CHART_SEMANTIC_RELEASE_VERSION ?= $(shell cat ../release.version | tr A-Z a-z)\n CHART_NAME=strimzi-kafka-operator\n-CHART_PATH=./$(CHART_NAME)/\n+HELM_VERSION ?= helm3", "originalCommit": "e9978937ba7aec474ea11b61087a864907c495a4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE0NDg4Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r426144886", "bodyText": "Yes, that was my initial thought as well, but I was trying to keep everything slightly more minimal. I will give that a go.", "author": "sgkiokas", "createdAt": "2020-05-16T11:21:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg5NzYzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg5OTg5OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422899899", "bodyText": "I think this always needs to be done twice - once for Helm2 and once for Helm3. Might be eaisest to just coy paste the lines?", "author": "scholzj", "createdAt": "2020-05-11T09:16:06Z", "path": "install/Makefile", "diffHunk": "@@ -4,34 +4,35 @@ include ../Makefile.os\n \n RELEASE_VERSION ?= latest\n RELEASE_PATH ?= ../strimzi-$(RELEASE_VERSION)/$(PROJECT_NAME)\n+HELM_VERSION ?= helm3\n \n crd_install:\n \t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ./topic-operator/04-Crd-kafkatopic.yaml\n \t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ./user-operator/04-Crd-kafkauser.yaml\n-\t$(CP) ./cluster-operator/040-Crd-kafka.yaml ../helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml\n-\t$(CP) ./cluster-operator/041-Crd-kafkaconnect.yaml ../helm-charts/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml\n-\t$(CP) ./cluster-operator/042-Crd-kafkaconnects2i.yaml ../helm-charts/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml\n-\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ../helm-charts/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml\n-\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ../helm-charts/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml\n-\t$(CP) ./cluster-operator/045-Crd-kafkamirrormaker.yaml ../helm-charts/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml\n-\t$(CP) ./cluster-operator/046-Crd-kafkabridge.yaml ../helm-charts/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml\n-\t$(CP) ./cluster-operator/047-Crd-kafkaconnector.yaml ../helm-charts/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml\n-\t$(CP) ./cluster-operator/048-Crd-kafkamirrormaker2.yaml ../helm-charts/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.app \"{{ template \\\"strimzi.name\\\" . }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.chart \"{{ template \\\"strimzi.chart\\\" . }}\" \\; && cd $$oldpath\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml metadata.labels.component \"kafkas.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml metadata.labels.component \"kafkaconnects.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml metadata.labels.component \"kafkaconnects2is.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml metadata.labels.component \"kafkatopics.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml metadata.labels.component \"kafkausers.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml metadata.labels.component \"kafkamirrormakers.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml metadata.labels.component \"kafkabridges.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml metadata.labels.component \"kafkaconnectors.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml metadata.labels.component \"kafkamirrormaker2.kafka.strimzi.io-crd\"\n+\t$(CP) ./cluster-operator/040-Crd-kafka.yaml ../helm-charts/$(HELM_VERSION)/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "originalCommit": "e9978937ba7aec474ea11b61087a864907c495a4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYzOTg4OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437639889", "bodyText": "I think this comment still applies? We still need to copy them for both Helm 2 and Helm 3.", "author": "scholzj", "createdAt": "2020-06-09T18:39:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg5OTg5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjkwMjE5NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r422902194", "bodyText": "I think this will need some thoughts. Right now, the Helm2 chart holds the master copy to all installation files which are not CRD. So if you for example want to change something in the deployment (e.g. install/cluster-operator/050-...yaml), you edit it in the Helm Chart and run make helm_install whcih renders the regular YAML from the Helm Chart. Now the problem is, we cannot do this twice - once with Helm2 and once with Helm3. So I think we need to decide which one will be the master and generate the install files from it but also the other Helm Chart from it if possible.", "author": "scholzj", "createdAt": "2020-05-11T09:19:52Z", "path": "helm-charts/Makefile", "diffHunk": "@@ -17,13 +18,13 @@ helm_clean:\n \n helm_lint:\n \t# Linting Helm Chart\n-\thelm lint --debug $(CHART_PATH)\n+\t$(HELM_VERSION) lint --debug $(CHART_PATH)\n \n helm_template:\n-\t./kafka-version-tpl.sh strimzi-kafka-operator/templates/_kafka_image_map.tpl\n+\t./kafka-version-tpl.sh $(HELM_VERSION)/strimzi-kafka-operator/templates/_kafka_image_map.tpl\n \t# Generating rendered template files to: $(CHART_RENDERED_TEMPLATES_TMP)\n \tmkdir -p $(CHART_RENDERED_TEMPLATES_TMP)\n-\thelm template --namespace myproject --output-dir $(CHART_RENDERED_TEMPLATES_TMP) $(CHART_PATH)\n+\t$(HELM_VERSION) template --namespace myproject --output-dir $(CHART_RENDERED_TEMPLATES_TMP) $(CHART_PATH)\n \n helm_install: helm_clean helm_template", "originalCommit": "e9978937ba7aec474ea11b61087a864907c495a4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "523cecab715b3cef77a272194a011e6c41a691f4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/523cecab715b3cef77a272194a011e6c41a691f4", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-16T19:31:19Z", "type": "forcePushed"}, {"oid": "cc9f59c4ede81e6734beee0a0c35a114d111213a", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/cc9f59c4ede81e6734beee0a0c35a114d111213a", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-16T21:00:06Z", "type": "forcePushed"}, {"oid": "cdcf6c0f55a64790bb68640c14228502aa3dabd8", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/cdcf6c0f55a64790bb68640c14228502aa3dabd8", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-16T21:03:04Z", "type": "forcePushed"}, {"oid": "9d4acf89efcde3a93f15eaba58c93277e4d141a1", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9d4acf89efcde3a93f15eaba58c93277e4d141a1", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-16T21:40:09Z", "type": "forcePushed"}, {"oid": "082fb04278d6dc0c6041e6e70a9fe269df4cdbee", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/082fb04278d6dc0c6041e6e70a9fe269df4cdbee", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-17T12:37:34Z", "type": "forcePushed"}, {"oid": "9baa3d7d3f43b96fc6c62c738288f1fc03a41643", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9baa3d7d3f43b96fc6c62c738288f1fc03a41643", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-17T14:30:02Z", "type": "forcePushed"}, {"oid": "e25b507f4f22b8bd705af71087d3c8542e29b2f2", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e25b507f4f22b8bd705af71087d3c8542e29b2f2", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-17T21:31:28Z", "type": "forcePushed"}, {"oid": "838c56bc154e9000e0a387382a933bc5dee6f9a1", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/838c56bc154e9000e0a387382a933bc5dee6f9a1", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-18T21:13:54Z", "type": "forcePushed"}, {"oid": "55885157fd5dd7dd695890c8198b9e99ef28c82f", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/55885157fd5dd7dd695890c8198b9e99ef28c82f", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-18T22:00:24Z", "type": "forcePushed"}, {"oid": "11c9f0a4f6b85c164349aaf9b4cfdba6614f6e01", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/11c9f0a4f6b85c164349aaf9b4cfdba6614f6e01", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-21T19:12:49Z", "type": "forcePushed"}, {"oid": "b992352a8d795ab55432afc8f15ba2c05b29de25", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b992352a8d795ab55432afc8f15ba2c05b29de25", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\nHelm 2* and Helm 3 for some time\n- Updates the Chart mainteners list\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-25T16:04:52Z", "type": "forcePushed"}, {"oid": "48bd8f5f95043c7c8414f628639460ef11d2b09d", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/48bd8f5f95043c7c8414f628639460ef11d2b09d", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-25T17:19:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0NTM3Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r430045377", "bodyText": "I think here you are missing the 049 file with the KafkaRebalance resource.", "author": "scholzj", "createdAt": "2020-05-25T18:45:24Z", "path": "install/Makefile", "diffHunk": "@@ -6,34 +6,46 @@ RELEASE_VERSION ?= latest\n RELEASE_PATH ?= ../strimzi-$(RELEASE_VERSION)/$(PROJECT_NAME)\n \n crd_install:\n-\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ./topic-operator/04-Crd-kafkatopic.yaml\n-\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ./user-operator/04-Crd-kafkauser.yaml\n-\t$(CP) ./cluster-operator/040-Crd-kafka.yaml ../helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml\n-\t$(CP) ./cluster-operator/041-Crd-kafkaconnect.yaml ../helm-charts/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml\n-\t$(CP) ./cluster-operator/042-Crd-kafkaconnects2i.yaml ../helm-charts/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml\n-\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ../helm-charts/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml\n-\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ../helm-charts/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml\n-\t$(CP) ./cluster-operator/045-Crd-kafkamirrormaker.yaml ../helm-charts/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml\n-\t$(CP) ./cluster-operator/046-Crd-kafkabridge.yaml ../helm-charts/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml\n-\t$(CP) ./cluster-operator/047-Crd-kafkaconnector.yaml ../helm-charts/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml\n-\t$(CP) ./cluster-operator/048-Crd-kafkamirrormaker2.yaml ../helm-charts/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml\n-\t$(CP) ./cluster-operator/049-Crd-kafkarebalance.yaml ../helm-charts/strimzi-kafka-operator/templates/049-Crd-kafkarebalance.yaml\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.app \"{{ template \\\"strimzi.name\\\" . }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.chart \"{{ template \\\"strimzi.chart\\\" . }}\" \\; && cd $$oldpath\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml metadata.labels.component \"kafkas.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml metadata.labels.component \"kafkaconnects.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml metadata.labels.component \"kafkaconnects2is.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml metadata.labels.component \"kafkatopics.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml metadata.labels.component \"kafkausers.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml metadata.labels.component \"kafkamirrormakers.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml metadata.labels.component \"kafkabridges.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml metadata.labels.component \"kafkaconnectors.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml metadata.labels.component \"kafkamirrormaker2.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/049-Crd-kafkarebalance.yaml metadata.labels.component \"kafkarebalances.kafka.strimzi.io-crd\"\n-\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.release \"{{ .Release.Name }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.heritage \"{{ .Release.Service }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec $(SED) -i -e '1s/^/{{- if .Values.createGlobalResources -}}\\n/' -e '$$s/$$/\\n{{- end -}}/' {} \\; && cd $$oldpath\n+\tfor HELM_VERSION in 2 3\t; do\t\\\n+\t\tHELM_CHART_SUBFOLDER=helm$$HELM_VERSION\t;\t\\\n+\t\toldpath=`pwd`\t;\t\\\n+\t\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ./topic-operator/04-Crd-kafkatopic.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ./user-operator/04-Crd-kafkauser.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/040-Crd-kafka.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/040-Crd-kafka.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/041-Crd-kafkaconnect.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/042-Crd-kafkaconnects2i.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/045-Crd-kafkamirrormaker.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/046-Crd-kafkabridge.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/047-Crd-kafkaconnector.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/048-Crd-kafkamirrormaker2.yaml ../helm-charts/$$HELM_CHART_SUBFOLDER/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml\t;\t\\", "originalCommit": "48bd8f5f95043c7c8414f628639460ef11d2b09d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM5MDYwOA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r431390608", "bodyText": "I have rebased to the latest and, you are right I missed it...", "author": "sgkiokas", "createdAt": "2020-05-27T19:25:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0NTM3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0NjIyMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r430046222", "bodyText": "Something in this block does not work - it throws error in Travis which is not handled properly somewhere and the build continues. But the yq is not used properly here somewhere- I wonder if this can be done somehow more elegantly. Right now it is one huge command. So from the error you don't even know which exact lines is causeng the issue.\nIf the files the same for Helm 2 and Helm 3, would it be easier to render it once e.g. for Helm3 and than just copy it to Helm2?", "author": "scholzj", "createdAt": "2020-05-25T18:48:58Z", "path": "install/Makefile", "diffHunk": "@@ -6,34 +6,46 @@ RELEASE_VERSION ?= latest\n RELEASE_PATH ?= ../strimzi-$(RELEASE_VERSION)/$(PROJECT_NAME)\n \n crd_install:\n-\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ./topic-operator/04-Crd-kafkatopic.yaml\n-\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ./user-operator/04-Crd-kafkauser.yaml\n-\t$(CP) ./cluster-operator/040-Crd-kafka.yaml ../helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml\n-\t$(CP) ./cluster-operator/041-Crd-kafkaconnect.yaml ../helm-charts/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml\n-\t$(CP) ./cluster-operator/042-Crd-kafkaconnects2i.yaml ../helm-charts/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml\n-\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ../helm-charts/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml\n-\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ../helm-charts/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml\n-\t$(CP) ./cluster-operator/045-Crd-kafkamirrormaker.yaml ../helm-charts/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml\n-\t$(CP) ./cluster-operator/046-Crd-kafkabridge.yaml ../helm-charts/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml\n-\t$(CP) ./cluster-operator/047-Crd-kafkaconnector.yaml ../helm-charts/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml\n-\t$(CP) ./cluster-operator/048-Crd-kafkamirrormaker2.yaml ../helm-charts/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml\n-\t$(CP) ./cluster-operator/049-Crd-kafkarebalance.yaml ../helm-charts/strimzi-kafka-operator/templates/049-Crd-kafkarebalance.yaml\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.app \"{{ template \\\"strimzi.name\\\" . }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.chart \"{{ template \\\"strimzi.chart\\\" . }}\" \\; && cd $$oldpath\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml metadata.labels.component \"kafkas.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml metadata.labels.component \"kafkaconnects.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml metadata.labels.component \"kafkaconnects2is.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml metadata.labels.component \"kafkatopics.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml metadata.labels.component \"kafkausers.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml metadata.labels.component \"kafkamirrormakers.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml metadata.labels.component \"kafkabridges.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml metadata.labels.component \"kafkaconnectors.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml metadata.labels.component \"kafkamirrormaker2.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/049-Crd-kafkarebalance.yaml metadata.labels.component \"kafkarebalances.kafka.strimzi.io-crd\"\n-\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.release \"{{ .Release.Name }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.heritage \"{{ .Release.Service }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec $(SED) -i -e '1s/^/{{- if .Values.createGlobalResources -}}\\n/' -e '$$s/$$/\\n{{- end -}}/' {} \\; && cd $$oldpath\n+\tfor HELM_VERSION in 2 3\t; do\t\\", "originalCommit": "48bd8f5f95043c7c8414f628639460ef11d2b09d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM5MjY2OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r431392669", "bodyText": "I had massive problems with loops in a recipe. I thought that it would be more consistent to keep everything in a loop, but I will follow your suggestion in order to finally get Travis to pass.", "author": "sgkiokas", "createdAt": "2020-05-27T19:29:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0NjIyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0NjI3OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r430046279", "bodyText": "Thsi looks unrelated to the Helm Charts - should it be outside the loop?", "author": "scholzj", "createdAt": "2020-05-25T18:49:15Z", "path": "install/Makefile", "diffHunk": "@@ -6,34 +6,46 @@ RELEASE_VERSION ?= latest\n RELEASE_PATH ?= ../strimzi-$(RELEASE_VERSION)/$(PROJECT_NAME)\n \n crd_install:\n-\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ./topic-operator/04-Crd-kafkatopic.yaml\n-\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ./user-operator/04-Crd-kafkauser.yaml\n-\t$(CP) ./cluster-operator/040-Crd-kafka.yaml ../helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml\n-\t$(CP) ./cluster-operator/041-Crd-kafkaconnect.yaml ../helm-charts/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml\n-\t$(CP) ./cluster-operator/042-Crd-kafkaconnects2i.yaml ../helm-charts/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml\n-\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ../helm-charts/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml\n-\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ../helm-charts/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml\n-\t$(CP) ./cluster-operator/045-Crd-kafkamirrormaker.yaml ../helm-charts/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml\n-\t$(CP) ./cluster-operator/046-Crd-kafkabridge.yaml ../helm-charts/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml\n-\t$(CP) ./cluster-operator/047-Crd-kafkaconnector.yaml ../helm-charts/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml\n-\t$(CP) ./cluster-operator/048-Crd-kafkamirrormaker2.yaml ../helm-charts/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml\n-\t$(CP) ./cluster-operator/049-Crd-kafkarebalance.yaml ../helm-charts/strimzi-kafka-operator/templates/049-Crd-kafkarebalance.yaml\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.app \"{{ template \\\"strimzi.name\\\" . }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.chart \"{{ template \\\"strimzi.chart\\\" . }}\" \\; && cd $$oldpath\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml metadata.labels.component \"kafkas.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml metadata.labels.component \"kafkaconnects.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml metadata.labels.component \"kafkaconnects2is.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml metadata.labels.component \"kafkatopics.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml metadata.labels.component \"kafkausers.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml metadata.labels.component \"kafkamirrormakers.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml metadata.labels.component \"kafkabridges.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml metadata.labels.component \"kafkaconnectors.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml metadata.labels.component \"kafkamirrormaker2.kafka.strimzi.io-crd\"\n-\tyq write -i ../helm-charts/strimzi-kafka-operator/templates/049-Crd-kafkarebalance.yaml metadata.labels.component \"kafkarebalances.kafka.strimzi.io-crd\"\n-\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.release \"{{ .Release.Name }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.heritage \"{{ .Release.Service }}\" \\; && cd $$oldpath\n-\toldpath=`pwd` && cd ../helm-charts/strimzi-kafka-operator/templates/ &&  $(FIND) . -type f -name '04*-Crd-*.yaml' -exec $(SED) -i -e '1s/^/{{- if .Values.createGlobalResources -}}\\n/' -e '$$s/$$/\\n{{- end -}}/' {} \\; && cd $$oldpath\n+\tfor HELM_VERSION in 2 3\t; do\t\\\n+\t\tHELM_CHART_SUBFOLDER=helm$$HELM_VERSION\t;\t\\\n+\t\toldpath=`pwd`\t;\t\\\n+\t\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ./topic-operator/04-Crd-kafkatopic.yaml\t;\t\\\n+\t\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ./user-operator/04-Crd-kafkauser.yaml\t;\t\\", "originalCommit": "48bd8f5f95043c7c8414f628639460ef11d2b09d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM5MTIzNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r431391237", "bodyText": "Good spot, removed out of the loop.", "author": "sgkiokas", "createdAt": "2020-05-27T19:26:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0NjI3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0ODE4NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r430048185", "bodyText": "Should the helm_install be removed here? It looks like that target does not exist anymore. Or is it taken from somewhere else?", "author": "scholzj", "createdAt": "2020-05-25T18:57:27Z", "path": "helm-charts/helm2/Makefile", "diffHunk": "@@ -0,0 +1,38 @@\n+PROJECT_NAME=helm-charts\n+\n+include ../../Makefile.os\n+\n+RELEASE_VERSION ?= latest\n+CHART_SEMANTIC_RELEASE_VERSION ?= $(shell cat ../../release.version | tr A-Z a-z)\n+CHART_NAME=strimzi-kafka-operator\n+CHART_PATH ?= ../helm2/strimzi-kafka-operator/\n+CHART_RENDERED_TEMPLATES_TMP=../../target/charts\n+CHART_RENDERED_TEMPLATES_CLUSTERROLES=../../cluster-operator/src/main/resources/cluster-roles/\n+CHART_RENDERED_TEMPLATES_INSTALL=../../install/cluster-operator/\n+HELM_CLI=helm2\n+\n+helm_clean:\n+\trm -rf $(CHART_RENDERED_TEMPLATES_TMP)\n+\trm -rf strimzi-$(RELEASE_VERSION)/charts/\n+\trm -f $(CHART_NAME)-*.tgz\n+\n+helm_lint:\n+\t# Linting Helm Chart\n+\t$(HELM_CLI) lint --debug $(CHART_PATH)\n+\n+helm_pkg: helm_lint helm_install", "originalCommit": "48bd8f5f95043c7c8414f628639460ef11d2b09d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM5MTYwMA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r431391600", "bodyText": "It should. I kept helm3 as default, so you are right.", "author": "sgkiokas", "createdAt": "2020-05-27T19:27:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA0ODE4NQ=="}], "type": "inlineReview"}, {"oid": "34856feafdcd072f3d1d4ee3b27df536f84870f2", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/34856feafdcd072f3d1d4ee3b27df536f84870f2", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-27T20:04:36Z", "type": "forcePushed"}, {"oid": "8c11fb871c615936d0281841c4ca6962e8ee437b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8c11fb871c615936d0281841c4ca6962e8ee437b", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-28T19:17:12Z", "type": "forcePushed"}, {"oid": "69ab6534f03d148505a0d66cbe4b6bb9002b1c92", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/69ab6534f03d148505a0d66cbe4b6bb9002b1c92", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-28T20:14:21Z", "type": "forcePushed"}, {"oid": "8b2a660601ebfc8525840cb9d5069ba561fdfbfc", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8b2a660601ebfc8525840cb9d5069ba561fdfbfc", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-30T10:42:32Z", "type": "forcePushed"}, {"oid": "b132d873e942134298ad1f7cbce0285b6e78efbb", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b132d873e942134298ad1f7cbce0285b6e78efbb", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-30T10:48:18Z", "type": "forcePushed"}, {"oid": "4ef9d309d3c87d5d60ac8c61bdc10dd488d16726", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/4ef9d309d3c87d5d60ac8c61bdc10dd488d16726", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-30T11:30:44Z", "type": "forcePushed"}, {"oid": "0e8925ddab0097b95441f67656fdc178861a3a6c", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/0e8925ddab0097b95441f67656fdc178861a3a6c", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-30T12:43:47Z", "type": "forcePushed"}, {"oid": "9f0d2bd793a27d6a45858fdb58fb9ab0f4b22298", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9f0d2bd793a27d6a45858fdb58fb9ab0f4b22298", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-30T13:45:45Z", "type": "forcePushed"}, {"oid": "624171bb8dd4645344420bad601fc580fd5c7892", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/624171bb8dd4645344420bad601fc580fd5c7892", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-30T14:18:00Z", "type": "forcePushed"}, {"oid": "e5bd2b21bd2e5ac4b35e23bd9983175fc6f86a97", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e5bd2b21bd2e5ac4b35e23bd9983175fc6f86a97", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-05-30T14:28:14Z", "type": "forcePushed"}, {"oid": "d3ca73304b8c07eb628b4e09e2cbed2b94d6d704", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d3ca73304b8c07eb628b4e09e2cbed2b94d6d704", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-02T18:51:49Z", "type": "forcePushed"}, {"oid": "78e4ba44c447b2068c6130ae1690e18cacacd8a7", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/78e4ba44c447b2068c6130ae1690e18cacacd8a7", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-03T08:15:11Z", "type": "forcePushed"}, {"oid": "86a94f0008a2495e4415d392c3d21ff76916204e", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/86a94f0008a2495e4415d392c3d21ff76916204e", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-04T20:08:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM3NjE2NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r436376165", "bodyText": "This doc is targeted to developers - so I guess they need to also have both versions of Helm installed as helm2 and helm3 to be able to run make all etc.? I guess that should be mentioned here.", "author": "scholzj", "createdAt": "2020-06-07T15:45:54Z", "path": "HACKING.md", "diffHunk": "@@ -24,7 +24,7 @@ To build this project you must first install several command line utilities and\n - [`make`](https://www.gnu.org/software/make/) - Make build system\n - [`mvn`](https://maven.apache.org/index.html) (version 3.5 and above) - Maven CLI\n - [`helm`](https://helm.sh/) - Helm Package Management System for Kubernetes\n-    - After installing Helm be sure to run `helm init`.\n+    - If you are using the Helm version 2 charts, after installing the Helm CLI, ensure you run `helm init` to configure to your cluster.", "originalCommit": "86a94f0008a2495e4415d392c3d21ff76916204e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM3NjUyNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r436376527", "bodyText": "I think all these changes in the RBAC files are because you are rewriting some other changes done while the PR was opened. Maybe you need torefesh the Helm3 files?", "author": "scholzj", "createdAt": "2020-06-07T15:50:32Z", "path": "cluster-operator/src/main/resources/cluster-roles/020-ClusterRole-strimzi-cluster-operator-role.yaml", "diffHunk": "@@ -8,7 +8,6 @@ rules:\n - apiGroups:\n   - \"\"\n   resources:\n-  # The cluster operator needs to access and manage service accounts to grant Strimzi components cluster permissions", "originalCommit": "86a94f0008a2495e4415d392c3d21ff76916204e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d229b06e832e8f98923e7631aef2734611237cc4", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d229b06e832e8f98923e7631aef2734611237cc4", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-07T17:05:13Z", "type": "forcePushed"}, {"oid": "8ff96c02cb52fa47a7ab1cdd7092a2228e14ca5a", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8ff96c02cb52fa47a7ab1cdd7092a2228e14ca5a", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-08T08:08:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYzODgwNg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437638806", "bodyText": "Can you revert this to get back to 384?", "author": "scholzj", "createdAt": "2020-06-09T18:37:02Z", "path": "install/cluster-operator/050-Deployment-strimzi-cluster-operator.yaml", "diffHunk": "@@ -96,9 +96,9 @@ spec:\n         resources:\n           limits:\n             cpu: 1000m\n-            memory: 384Mi\n+            memory: 256Mi\n           requests:\n             cpu: 200m\n-            memory: 384Mi\n+            memory: 256Mi", "originalCommit": "8ff96c02cb52fa47a7ab1cdd7092a2228e14ca5a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYzOTE5Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437639193", "bodyText": "Can we get the comments back?", "author": "scholzj", "createdAt": "2020-06-09T18:37:42Z", "path": "install/cluster-operator/030-ClusterRoleBinding-strimzi-cluster-operator-kafka-broker-delegation.yaml", "diffHunk": "@@ -4,8 +4,6 @@ metadata:\n   name: strimzi-cluster-operator-kafka-broker-delegation\n   labels:\n     app: strimzi\n-# The Kafka broker cluster role must be bound to the cluster operator service account so that it can delegate the cluster role to the Kafka brokers.\n-# This must be done to avoid escalating privileges which would be blocked by Kubernetes.", "originalCommit": "8ff96c02cb52fa47a7ab1cdd7092a2228e14ca5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY1MTQxNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437651415", "bodyText": "Not sure how this was removed... Fixed.", "author": "sgkiokas", "createdAt": "2020-06-09T18:59:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYzOTE5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYzOTI3OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437639279", "bodyText": "Can we get the comments back?", "author": "scholzj", "createdAt": "2020-06-09T18:37:53Z", "path": "install/cluster-operator/031-RoleBinding-strimzi-cluster-operator-entity-operator-delegation.yaml", "diffHunk": "@@ -4,8 +4,6 @@ metadata:\n   name: strimzi-cluster-operator-entity-operator-delegation\n   labels:\n     app: strimzi\n-# The Entity Operator cluster role must be bound to the cluster operator service account so that it can delegate the cluster role to the Entity Operator.\n-# This must be done to avoid escalating privileges which would be blocked by Kubernetes.", "originalCommit": "8ff96c02cb52fa47a7ab1cdd7092a2228e14ca5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY1MTQ4MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437651480", "bodyText": "As above.", "author": "sgkiokas", "createdAt": "2020-06-09T18:59:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYzOTI3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY0MDE2OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437640168", "bodyText": "Can we use the 384Mi here?", "author": "scholzj", "createdAt": "2020-06-09T18:39:28Z", "path": "helm-charts/helm3/strimzi-kafka-operator/values.yaml", "diffHunk": "@@ -0,0 +1,123 @@\n+# Default values for strimzi-kafka-operator.\n+\n+# If you set `watchNamespaces` to the same value as ``.Release.Namespace` (e.g. `helm ... --namespace $NAMESPACE`), \n+# the chart will fail because duplicate RoleBindings will be attempted to be created in the same namespace\n+watchNamespaces: []\n+watchAnyNamespace: false\n+\n+image:\n+  repository: strimzi\n+  name: operator\n+  tag: latest\n+logLevel: INFO\n+fullReconciliationIntervalMs: 120000\n+operationTimeoutMs: 300000\n+kubernetesServiceDnsDomain: cluster.local\n+\n+tolerations: []\n+affinity: {}\n+nodeSelector: {}\n+\n+\n+# Docker images that operator uses to provision various components of Strimzi.  To use your own registry prefix the\n+# repository name with your registry URL.\n+# Ex) repository: registry.xyzcorp.com/strimzi/zookeeper\n+zookeeper:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+kafka:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+kafkaConnect:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+kafkaConnects2i:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+topicOperator:\n+  image:\n+    repository: strimzi\n+    name: operator\n+    tag: latest\n+userOperator:\n+  image:\n+    repository: strimzi\n+    name: operator\n+    tag: latest\n+kafkaInit:\n+  image:\n+    repository: strimzi\n+    name: operator\n+    tag: latest\n+tlsSidecarKafka:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+tlsSidecarEntityOperator:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+kafkaMirrorMaker:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+kafkaBridge:\n+  image:\n+    repository: strimzi\n+    name: kafka-bridge\n+    tag: 0.16.0\n+kafkaExporter:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+jmxTrans:\n+  image:\n+    repository: strimzi\n+    name: jmxtrans\n+    tag: latest\n+kafkaMirrorMaker2:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+cruiseControl:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+tlsSidecarCruiseControl:\n+  image:\n+    repository: strimzi\n+    name: kafka\n+    tagPrefix: latest\n+resources:\n+  limits:\n+    memory: 256Mi\n+    cpu: 1000m\n+  requests:\n+    memory: 256Mi\n+    cpu: 200m", "originalCommit": "8ff96c02cb52fa47a7ab1cdd7092a2228e14ca5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY1MDY0Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437650643", "bodyText": "Fixed.", "author": "sgkiokas", "createdAt": "2020-06-09T18:57:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY0MDE2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY0MTI1NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437641254", "bodyText": "I think this is here twice now - probably some error in rebasing or something.", "author": "scholzj", "createdAt": "2020-06-09T18:41:18Z", "path": "CHANGELOG.md", "diffHunk": "@@ -5,6 +5,8 @@\n \n * Remove deprecated `Kafka.spec.topicOperator` classes and deployment logic\n * Use Java 11 as the Java runtime\n+* Remove deprecated `Kafka.spec.topicOperator` classes and deployment logic ", "originalCommit": "8ff96c02cb52fa47a7ab1cdd7092a2228e14ca5a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY1MDYwNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r437650604", "bodyText": "Fixed.", "author": "sgkiokas", "createdAt": "2020-06-09T18:57:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY0MTI1NA=="}], "type": "inlineReview"}, {"oid": "e32e6d47db28ca3b78d41d58a93c1034c86eb039", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e32e6d47db28ca3b78d41d58a93c1034c86eb039", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-09T23:04:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQzNDk4Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438434983", "bodyText": "I guess this can be removed? Or maybe better - can you keep the crd_install target which will call the two subtargets?", "author": "scholzj", "createdAt": "2020-06-10T22:08:17Z", "path": "install/Makefile", "diffHunk": "@@ -5,35 +5,111 @@ include ../Makefile.os\n RELEASE_VERSION ?= latest\n RELEASE_PATH ?= ../strimzi-$(RELEASE_VERSION)/$(PROJECT_NAME)\n \n-crd_install:\n+# crd_install:\n+# \tfor HELM_VERSION in 2 3\t; do\t\\\n+# \t\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ./topic-operator/04-Crd-kafkatopic.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ./user-operator/04-Crd-kafkauser.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/040-Crd-kafka.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/040-Crd-kafka.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/041-Crd-kafkaconnect.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/042-Crd-kafkaconnects2i.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/043-Crd-kafkatopic.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/044-Crd-kafkauser.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/045-Crd-kafkamirrormaker.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/046-Crd-kafkabridge.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/047-Crd-kafkaconnector.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/048-Crd-kafkamirrormaker2.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml\t;\t\\\n+# \t\t$(CP) ./cluster-operator/049-Crd-kafkarebalance.yaml ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/049-Crd-kafkarebalance.yaml\t;\t\\\n+# \t\toldpath=`pwd`\t;\t\\\n+# \t\tcd ../helm-charts/strimzi-kafka-operator/templates/\t;\t\\\n+# \t\t$(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.app \"{{ template \\\"strimzi.name\\\" . }}\"\t;\t\\\n+# \t\tcd $$oldpath\t;\t\\\n+# \t\toldpath=`pwd`\t;\t\\\n+# \t\tcd ../helm-charts/strimzi-kafka-operator/templates/\t;\t\\\n+# \t\t$(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.chart \"{{ template \\\"strimzi.chart\\\" . }}\"\t;\t\\\n+# \t\tcd $$oldpath\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/040-Crd-kafka.yaml metadata.labels.component \"kafkas.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/041-Crd-kafkaconnect.yaml metadata.labels.component \"kafkaconnects.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/042-Crd-kafkaconnects2i.yaml metadata.labels.component \"kafkaconnects2is.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/043-Crd-kafkatopic.yaml metadata.labels.component \"kafkatopics.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/044-Crd-kafkauser.yaml metadata.labels.component \"kafkausers.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/045-Crd-kafkamirrormaker.yaml metadata.labels.component \"kafkamirrormakers.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/046-Crd-kafkabridge.yaml metadata.labels.component \"kafkabridges.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/047-Crd-kafkaconnector.yaml metadata.labels.component \"kafkaconnectors.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/048-Crd-kafkamirrormaker2.yaml metadata.labels.component \"kafkamirrormaker2.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\tyq write -i ../helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator/templates/049-Crd-kafkarebalance.yaml metadata.labels.component \"kafkarebalances.kafka.strimzi.io-crd\"\t;\t\\\n+# \t\toldpath=`pwd`\t;\t\\\n+# \t\tcd ../helm-charts/strimzi-kafka-operator/templates/\t;\t\\\n+# \t\t$(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.release \"{{ .Release.Name }}\"\t;\t\\\n+# \t\tcd $$oldpath\t;\t\\\n+# \t\toldpath=`pwd`\t;\t\\\n+# \t\tcd ../helm-charts/strimzi-kafka-operator/templates/\t;\t\\\n+# \t\t$(FIND) . -type f -name '04*-Crd-*.yaml' -exec yq write -i {} metadata.labels.heritage \"{{ .Release.Service }}\"\t;\t\\\n+# \t\tcd $$oldpath\t;\t\\\t\n+# \t\toldpath=`pwd`\t;\t\\\n+# \t\tcd ../helm-charts/strimzi-kafka-operator/templates/\t;\t\\\n+# \t\t$(FIND) . -type f -name '04*-Crd-*.yaml' -exec $(SED) -i -e '1s/^/{{- if .Values.createGlobalResources -}}\\n/' -e '$$s/$$/\\n{{- end -}}/' {}\t;\t\\\n+# \t\tcd $$oldpath\t;\t\\\n+# \tdone", "originalCommit": "e32e6d47db28ca3b78d41d58a93c1034c86eb039", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1NDYwMA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438654600", "bodyText": "Sorry, completely forgot to remove the comment!", "author": "sgkiokas", "createdAt": "2020-06-11T09:20:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQzNDk4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU5ODk5MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438598990", "bodyText": "I think it would make sense to factor this into two functions, one for installing each.", "author": "tombentley", "createdAt": "2020-06-11T07:37:54Z", "path": ".travis/setup-kubernetes.sh", "diffHunk": "@@ -22,12 +22,38 @@ function install_nsenter {\n \n function install_helm {\n     install_nsenter\n-    # Set `TEST_HELM_VERSION` to `latest` to get latest version\n-    HELM_INSTALL_DIR=/usr/bin\n+\n+    export HELM_INSTALL_DIR=/usr/bin\n     curl https://raw.githubusercontent.com/kubernetes/helm/master/scripts/get > get_helm.sh\n+    # we need to modify the script with a different path because on the Azure pipelines the HELM_INSTALL_DIR env var is not honoured\n+    sed -i 's#/usr/local/bin#/usr/bin#g' get_helm.sh\n     chmod 700 get_helm.sh\n-    sudo ./get_helm.sh --version ${TEST_HELM_VERSION}\n-    helm init --client-only\n+\n+    echo \"Installing helm 2...\"\n+    sudo ./get_helm.sh --version \"${TEST_HELM2_VERSION}\"\n+    sudo mv ${HELM_INSTALL_DIR}/helm ${HELM_INSTALL_DIR}/helm2\n+\n+    echo \"Installing helm 3...\"\n+    sudo ./get_helm.sh --version \"${TEST_HELM3_VERSION}\"\n+    sudo mv ${HELM_INSTALL_DIR}/helm ${HELM_INSTALL_DIR}/helm3\n+\n+    echo \"Verifying the installation of both helm binaries\"\n+    # run a proper helm command instead of, for example, \"which helm\", to verify that we can call the binary\n+    helm2 --help\n+    helmCommandOutput=$?\n+\n+    if [ $helmCommandOutput != 0 ]; then\n+        echo \"helm2 binary hasn't been installed properly - exiting...\"\n+        exit 1\n+    fi\n+\n+    helm3 --help\n+    helmCommandOutput=$?\n+\n+    if [ $helmCommandOutput != 0 ]; then\n+        echo \"helm3 binary hasn't been installed properly - exiting...\"\n+        exit 1\n+    fi\n }", "originalCommit": "e32e6d47db28ca3b78d41d58a93c1034c86eb039", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY1NDcwMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438654702", "bodyText": "Will do.", "author": "sgkiokas", "createdAt": "2020-06-11T09:20:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU5ODk5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU5OTgyOA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438599828", "bodyText": "What's with all the whitespace around ;  and before \\? This comment applies to the other change in this file too, of course.", "author": "tombentley", "createdAt": "2020-06-11T07:39:36Z", "path": "Makefile", "diffHunk": "@@ -29,10 +28,11 @@ next_version:\n bridge_version:\n \t# Set Kafka Bridge version to its own version\n \t$(FIND) ./install -name '*.yaml' -type f -exec $(SED) -i '/value: \"\\?strimzi\\/kafka-bridge:[a-zA-Z0-9_.-]\\+\"\\?/s/strimzi\\/kafka-bridge:[a-zA-Z0-9_.-]\\+/strimzi\\/kafka-bridge:$(BRIDGE_VERSION)/g' {} \\;\n-\t# Update Kafka Bridge image tag in chart values.yaml to BRIDGE_VERSION\n-\t$(SED) -i '/name: kafka-bridge/{n;s/\\(tag: \\).*/\\1$(BRIDGE_VERSION)/g}' $(CHART_PATH)values.yaml\n-\t# Update Kafka Bridge image tag in chart README.md config grid with BRIDGE_VERSION\n-\t$(SED) -i 's/\\(kafkaBridge.image\\.tag[^\\n]*| \\)`.*`/\\1`$(BRIDGE_VERSION)`/g' $(CHART_PATH)README.md\n+\tfor HELM_VERSION in 2 3\t; do\t\\\n+\t\tCHART_PATH=./helm-charts/helm$$HELM_VERSION/strimzi-kafka-operator\t;\t\\\n+\t\t$(SED) -i '/name: kafka-bridge/{n;s/\\(tag: \\).*/\\1$(BRIDGE_VERSION)/g}' $$CHART_PATH/values.yaml\t;\t\\\n+\t\t$(SED) -i 's/\\(kafkaBridge.image\\.tag[^\\n]*| \\)`.*`/\\1`$(BRIDGE_VERSION)`/g' $$CHART_PATH/README.md\t;\t\\\n+\tdone", "originalCommit": "e32e6d47db28ca3b78d41d58a93c1034c86eb039", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY3MTQ1Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438671456", "bodyText": "Fixed.", "author": "sgkiokas", "createdAt": "2020-06-11T09:51:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODU5OTgyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYwMDcwNg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438600706", "bodyText": "Inconsistent whitespace\u2013you have it around ?=, but not =.", "author": "tombentley", "createdAt": "2020-06-11T07:41:14Z", "path": "helm-charts/helm2/Makefile", "diffHunk": "@@ -0,0 +1,39 @@\n+PROJECT_NAME=helm-charts\n+\n+include ../../Makefile.os\n+\n+RELEASE_VERSION ?= latest\n+CHART_SEMANTIC_RELEASE_VERSION ?= $(shell cat ../../release.version | tr A-Z a-z)\n+CHART_NAME=strimzi-kafka-operator\n+CHART_PATH ?= ../helm2/strimzi-kafka-operator/", "originalCommit": "e32e6d47db28ca3b78d41d58a93c1034c86eb039", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY3MTM5Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438671393", "bodyText": "Fixed.", "author": "sgkiokas", "createdAt": "2020-06-11T09:51:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYwMDcwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYwNDM5OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438604399", "bodyText": "I this is a broken link. I'm guessing the helm2 NOTES.txt will have the same broken link\nBonus points are available if there's some way to test this link so we catch regressions in the future.", "author": "tombentley", "createdAt": "2020-06-11T07:48:31Z", "path": "helm-charts/helm3/strimzi-kafka-operator/templates/NOTES.txt", "diffHunk": "@@ -0,0 +1,5 @@\n+Thank you for installing {{ .Chart.Name }}-{{ .Chart.Version }}\n+\n+To create a Kafka cluster refer to the following documentation.\n+\n+https://strimzi.io/docs/{{ .Chart.Version }}/#kafka-cluster-str", "originalCommit": "e32e6d47db28ca3b78d41d58a93c1034c86eb039", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY3NzQ3OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438677478", "bodyText": "I updated it to https://strimzi.io/docs/operators/latest/using.html#deploying-cluster-operator-helm-chart-str since this is the only one I found close to helm-related docs. If the chart version has to be referenced somehow, I image a relevant check can be added to check_docs.sh. Please do let me know and I will see what I can do.", "author": "sgkiokas", "createdAt": "2020-06-11T10:02:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYwNDM5OQ=="}], "type": "inlineReview"}, {"oid": "54d8ae59b387ad3a95331272f363ffa8176889f6", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/54d8ae59b387ad3a95331272f363ffa8176889f6", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-11T09:50:44Z", "type": "forcePushed"}, {"oid": "ae28cd001a2c41933c4f920568d37bf8c5f41288", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ae28cd001a2c41933c4f920568d37bf8c5f41288", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-11T09:59:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzODY5OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438838699", "bodyText": "It's not just recommended that both versions are installed, make helm_install or make all will fail if you don't have a helm3 on your path. And since helm3 is not the normal name of the binary, meeting these environmental requirements is actually quite a high barrier for new contributors to get over. I wonder if we can make the build:\n\nPass (maybe with a warning) if there is no helm\nCope with the non-presence of helm2 and helm3\nIf there is a helm detect its version and use that if it's 2 or 3", "author": "tombentley", "createdAt": "2020-06-11T14:43:15Z", "path": "HACKING.md", "diffHunk": "@@ -24,7 +24,9 @@ To build this project you must first install several command line utilities and\n - [`make`](https://www.gnu.org/software/make/) - Make build system\n - [`mvn`](https://maven.apache.org/index.html) (version 3.5 and above) - Maven CLI\n - [`helm`](https://helm.sh/) - Helm Package Management System for Kubernetes\n-    - After installing Helm be sure to run `helm init`.\n+    - Both Helm 2 and Helm 3 are supported. In order to use either two, it is recommended that you download both versions. A convenient way to do so is to download the [get_helm.sh](https://helm.sh/docs/intro/install/#from-script) script and specify the version you want to download either for Helm 2 or Helm 3.", "originalCommit": "ae28cd001a2c41933c4f920568d37bf8c5f41288", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODkzMzI4OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438933288", "bodyText": "I will give that a go and come back.", "author": "sgkiokas", "createdAt": "2020-06-11T16:56:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzODY5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODgzOTA4Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2979#discussion_r438839087", "bodyText": "Those are instructions for installing the CO using helm. IDK when a user of the chart would see these notes, but the sentence \"to create a Kafka cluster refer to the following documentation\" suggests it would be after they've installed the CO, therefore, would https://strimzi.io/docs/operators/0.18.0/using.html#kafka-cluster-str not be a better place to refer them to?\nI think we should use {{ .Chart.Version }} rather than latest.", "author": "tombentley", "createdAt": "2020-06-11T14:43:47Z", "path": "helm-charts/helm3/strimzi-kafka-operator/templates/NOTES.txt", "diffHunk": "@@ -0,0 +1,5 @@\n+Thank you for installing {{ .Chart.Name }}-{{ .Chart.Version }}\n+\n+To create a Kafka cluster refer to the following documentation.\n+\n+https://strimzi.io/docs/operators/latest/using.html#deploying-cluster-operator-helm-chart-str", "originalCommit": "ae28cd001a2c41933c4f920568d37bf8c5f41288", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "49dd743354c352ee3f9920e1ba03880fa6202a52", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/49dd743354c352ee3f9920e1ba03880fa6202a52", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-12T15:39:47Z", "type": "commit"}, {"oid": "49dd743354c352ee3f9920e1ba03880fa6202a52", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/49dd743354c352ee3f9920e1ba03880fa6202a52", "message": "feat: Migrate to Helm 3\n\nThis commit:\n\n- Introduces support for Helm 3\n- Modifies the current folder structure in order to support both\n  Helm 2+ and Helm 3 for some time\n- Updates the Chart's Maintainers list\n- Updates the Chart's Owners list\n- Updates the relevant READMEs and the HACKING page\n\nContributes to: #2895\n\nSigned-off-by: Stelios Gkiokas <Stylianos.Gkiokas@ibm.com>", "committedDate": "2020-06-12T15:39:47Z", "type": "forcePushed"}]}