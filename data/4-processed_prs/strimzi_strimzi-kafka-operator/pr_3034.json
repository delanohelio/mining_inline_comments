{"pr_number": 3034, "pr_title": "Make sure all examples end up in the distribution archives", "pr_createdAt": "2020-05-15T14:42:09Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034", "timeline": [{"oid": "2e5647e66378160bc8afcbe23eb3f4543bbe9b9b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2e5647e66378160bc8afcbe23eb3f4543bbe9b9b", "message": "Make sure all examples end up in the distribution archives\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-15T14:40:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2OTA3Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425869076", "bodyText": "Can't we write it to just copy everything (or blacklist what we don't want), rather than having to whitelist everything we do want?", "author": "tombentley", "createdAt": "2020-05-15T15:12:21Z", "path": "examples/Makefile", "diffHunk": "@@ -13,8 +13,12 @@ release:\n \t$(CP) -r ./kafka-mirror-maker $(RELEASE_PATH)/\n \t$(CP) -r ./kafka-mirror-maker-2 $(RELEASE_PATH)/\n \t$(CP) -r ./kafka-bridge $(RELEASE_PATH)/\n+\t$(CP) -r ./connector $(RELEASE_PATH)/\n+\t$(CP) -r ./cruise-control $(RELEASE_PATH)/\n+\t$(CP) -r ./security $(RELEASE_PATH)/\n \t$(CP) -r ./user $(RELEASE_PATH)/\n \t$(CP) -r ./topic $(RELEASE_PATH)/\n \t$(CP) -r ./metrics $(RELEASE_PATH)/\n+\t$(CP) -r ./README.md $(RELEASE_PATH)/", "originalCommit": "2e5647e66378160bc8afcbe23eb3f4543bbe9b9b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3MTY1NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425871655", "bodyText": "I'm in agreement with Tom here. And if you want a finer audit of what exactly that means would be going into the distribution archive then as part of the  build we could ls the path and print it to a file that would act as a manifest so come release time we know with relative certainty what has creeped in or left", "author": "samuel-hawker", "createdAt": "2020-05-15T15:16:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2OTA3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg3NzAyMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425877022", "bodyText": "There is no exclude in copy command AFAIK and we need to exclude at least the Makefile file and I really prefer to keep things readable rather than build sophisticated complex constructs.", "author": "scholzj", "createdAt": "2020-05-15T15:24:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2OTA3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4MDI5MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425880290", "bodyText": "I believe you can blacklist with the find command and then pipe the filtered list to cp - but you are right this may be needlessly complicated. Maybe a thought for future releases", "author": "samuel-hawker", "createdAt": "2020-05-15T15:29:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2OTA3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4MzMyMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425883321", "bodyText": "$(CP) -r $$(ls | $(GREP) -Ev '^Makefile$$') $(RELEASE_PATH)/", "author": "tombentley", "createdAt": "2020-05-15T15:35:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2OTA3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg4NjI2NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425886265", "bodyText": "I'm sure that works. But I would still prefer to have commands which I actually understand and know what they do when I run into problems.", "author": "scholzj", "createdAt": "2020-05-15T15:39:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2OTA3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg5MzA0OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425893048", "bodyText": "Because this is in a Makefile $(...) is interpreted as replacement by make parameters (e.g. $(CP), as you already know). You have to use $$ to generate a literal $, so the $$(...) construct just means that $(...) gets passed to the shell to execute, and that's just a subshell (as you already know). Similarly what would be $ in the regex to match the end of input is quoted to $$.", "author": "tombentley", "createdAt": "2020-05-15T15:51:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2OTA3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkwNTAwNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425905005", "bodyText": "Happy?", "author": "scholzj", "createdAt": "2020-05-15T16:12:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg2OTA3Ng=="}], "type": "inlineReview"}, {"oid": "de6ab0d693f63dfdc5dc106e9c0ea01637ee7681", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/de6ab0d693f63dfdc5dc106e9c0ea01637ee7681", "message": "Add something I don't understand\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>", "committedDate": "2020-05-15T16:11:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkxNTI4NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425915285", "bodyText": "the previous version was understandable :-) I have doubts about this one ... but if Tom is happy ;-)", "author": "ppatierno", "createdAt": "2020-05-15T16:30:09Z", "path": "examples/Makefile", "diffHunk": "@@ -7,14 +7,6 @@ RELEASE_PATH ?= ../strimzi-$(RELEASE_VERSION)/$(PROJECT_NAME)\n \n release:\n \tmkdir -p $(RELEASE_PATH)\n-\t$(CP) -r ./templates $(RELEASE_PATH)/\n-\t$(CP) -r ./kafka $(RELEASE_PATH)/\n-\t$(CP) -r ./kafka-connect $(RELEASE_PATH)/\n-\t$(CP) -r ./kafka-mirror-maker $(RELEASE_PATH)/\n-\t$(CP) -r ./kafka-mirror-maker-2 $(RELEASE_PATH)/\n-\t$(CP) -r ./kafka-bridge $(RELEASE_PATH)/\n-\t$(CP) -r ./user $(RELEASE_PATH)/\n-\t$(CP) -r ./topic $(RELEASE_PATH)/\n-\t$(CP) -r ./metrics $(RELEASE_PATH)/\n+\t$(CP) -r $$(ls | $(GREP) -Ev '^Makefile$$') $(RELEASE_PATH)/", "originalCommit": "de6ab0d693f63dfdc5dc106e9c0ea01637ee7681", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkxOTc3Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425919776", "bodyText": "If our collective knowledge of make is so poor that we're not prepared to do sensible things to make our own lives easier and avoid making stupid errors (i.e. whitelist vs blacklist) then we need to think about whether make is really the right tool for the job.", "author": "tombentley", "createdAt": "2020-05-15T16:37:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkxNTI4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkyMDA1Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3034#discussion_r425920053", "bodyText": "Let\u00a8s hope it doesn't need changing for another few years :-o", "author": "scholzj", "createdAt": "2020-05-15T16:37:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTkxNTI4NQ=="}], "type": "inlineReview"}]}