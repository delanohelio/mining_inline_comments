{"pr_number": 3005, "pr_title": "feat: Use util function for hostname building", "pr_createdAt": "2020-05-13T09:45:16Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005", "timeline": [{"oid": "ac78a777640693c5d073344d6889eab672fd0777", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ac78a777640693c5d073344d6889eab672fd0777", "message": "feat: Use util function for hostname building\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-05-13T09:41:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM0MzI4Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#discussion_r424343287", "bodyText": "Should this be podDnsNameWithoutClusterDomain?", "author": "scholzj", "createdAt": "2020-05-13T10:44:14Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/KafkaBrokerConfigurationBuilder.java", "diffHunk": "@@ -136,7 +136,12 @@ public KafkaBrokerConfigurationBuilder withListeners(String clusterName, String\n \n         // Replication listener\n         listeners.add(\"REPLICATION-9091://0.0.0.0:9091\");\n-        advertisedListeners.add(String.format(\"REPLICATION-9091://%s-${STRIMZI_BROKER_ID}.%s-brokers.%s.svc:9091\", KafkaResources.kafkaStatefulSetName(clusterName), KafkaResources.kafkaStatefulSetName(clusterName), namespace));\n+        advertisedListeners.add(String.format(\"REPLICATION-9091://%s:9091\",\n+                ModelUtils.podDnsName(namespace,", "originalCommit": "ac78a777640693c5d073344d6889eab672fd0777", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM0NjA0MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#discussion_r424346040", "bodyText": "You're absolutely right, I made these changes prior to our conversation and misunderstood. whether they should be long or short.", "author": "samuel-hawker", "createdAt": "2020-05-13T10:49:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM0MzI4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM0MzQ2NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#discussion_r424343464", "bodyText": "Same as above - should this be podDnsNameWithoutClusterDomain?", "author": "scholzj", "createdAt": "2020-05-13T10:44:39Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/KafkaBrokerConfigurationBuilder.java", "diffHunk": "@@ -273,7 +278,13 @@ private void configureReplicationListener() {\n      * @return  String with advertised listener configuration\n      */\n     private String getAdvertisedListener(String clusterName, String namespace, String listenerName, int port)    {\n-        return String.format(\"%s://%s-${STRIMZI_BROKER_ID}.%s-brokers.%s.svc:%d\", listenerName, KafkaResources.kafkaStatefulSetName(clusterName), KafkaResources.kafkaStatefulSetName(clusterName), namespace, port);\n+        return String.format(\"%s://%s:%d\",\n+                listenerName,\n+                ModelUtils.podDnsName(namespace,", "originalCommit": "ac78a777640693c5d073344d6889eab672fd0777", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM0NDQzNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#discussion_r424344434", "bodyText": "Same as above - should this be podDnsNameWithoutClusterDomain?", "author": "scholzj", "createdAt": "2020-05-13T10:46:38Z", "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/operator/assembly/KafkaAssemblyOperator.java", "diffHunk": "@@ -1478,10 +1478,10 @@ String zkConnectionString(int connectToReplicas, Function<Integer, String> zkNod\n                             return Future.failedFuture(Util.missingSecretException(namespace, ClusterOperator.secretName(name)));\n                         }\n \n-                        Function<Integer, String> zkNodeAddress = (Integer i) -> String.format(\"%s.%s.%s.svc\",\n-                                zkCluster.getPodName(i),\n+                        Function<Integer, String> zkNodeAddress = (Integer i) -> ModelUtils.podDnsName(", "originalCommit": "ac78a777640693c5d073344d6889eab672fd0777", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e895ddedf5d10c27ae6d2c6471474ddb2a772185", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e895ddedf5d10c27ae6d2c6471474ddb2a772185", "message": "fix: Use without cluster domain\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-05-13T10:51:09Z", "type": "commit"}, {"oid": "119f5e7887a7d7af543324acbf60a3173c6962ac", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/119f5e7887a7d7af543324acbf60a3173c6962ac", "message": "feat: Replace calls in cert\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>", "committedDate": "2020-05-13T11:13:13Z", "type": "commit"}]}