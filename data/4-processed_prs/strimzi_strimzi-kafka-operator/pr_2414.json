{"pr_number": 2414, "pr_title": "[DOC] Configure broker certificates per listener", "pr_createdAt": "2020-01-16T16:12:06Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414", "timeline": [{"oid": "a50e7bf37fd02b5a717569090867a141af1d8ad5", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a50e7bf37fd02b5a717569090867a141af1d8ad5", "message": "Initial edits.\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-15T12:21:47Z", "type": "commit"}, {"oid": "fa02bba7831f1fed73df84925f97a20e1dff5de9", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fa02bba7831f1fed73df84925f97a20e1dff5de9", "message": "New procedure - installing per-listener certs\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-15T17:44:06Z", "type": "commit"}, {"oid": "7035bd06f54c41ceccb24025ad1239a5c509448f", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7035bd06f54c41ceccb24025ad1239a5c509448f", "message": "Further updates\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-16T15:53:32Z", "type": "commit"}, {"oid": "789e6416a33b6cbb87f44a797c8ff10d531a0f3e", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/789e6416a33b6cbb87f44a797c8ff10d531a0f3e", "message": "Minor change to wording\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-16T16:12:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc5NjM2NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r367796364", "bodyText": "I am not sure about mentioning Strimzi here. Should we use {ProductName}?", "author": "sknot-rh", "createdAt": "2020-01-17T07:14:53Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to Strimzi). Installing per-listener certificates is supported for two types of listeners:", "originalCommit": "789e6416a33b6cbb87f44a797c8ff10d531a0f3e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg2MTU5Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r367861597", "bodyText": "Good spot - thank you!", "author": "laidan6000", "createdAt": "2020-01-17T10:15:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc5NjM2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5MTk4NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r367891984", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * At a cluster level--see xref:installing-your-own-ca-certificates-{context}[].\n          \n          \n            \n            * At the cluster level--see xref:installing-your-own-ca-certificates-{context}[].", "author": "PaulRMellor", "createdAt": "2020-01-17T11:29:50Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -26,3 +26,15 @@ You can configure the validity period of:\n \n * Cluster CA certificates in `Kafka.spec.clusterCa.validityDays`\n * Client CA certificates in `Kafka.spec.clientsCa.validityDays`\n+\n+== Options for installing your own CA certificates\n+\n+In your security model, client applications might need to trust certificates that were issued by an external CA, such as your company's internal CA or a public CA, in order to connect to external systems. {ProductName} provides two methods for configuring your Kafka client applications to connect to the brokers in your Kafka cluster using your own certificates.\n+\n+You can install your own certificates at two levels:\n+\n+* At a cluster level--see xref:installing-your-own-ca-certificates-{context}[].", "originalCommit": "789e6416a33b6cbb87f44a797c8ff10d531a0f3e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQ3MzUyOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368473529", "bodyText": "Updated.", "author": "laidan6000", "createdAt": "2020-01-20T10:29:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5MTk4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5MjYwNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r367892604", "bodyText": "TLS and external or TLS or external?", "author": "PaulRMellor", "createdAt": "2020-01-17T11:31:28Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -26,3 +26,15 @@ You can configure the validity period of:\n \n * Cluster CA certificates in `Kafka.spec.clusterCa.validityDays`\n * Client CA certificates in `Kafka.spec.clientsCa.validityDays`\n+\n+== Options for installing your own CA certificates\n+\n+In your security model, client applications might need to trust certificates that were issued by an external CA, such as your company's internal CA or a public CA, in order to connect to external systems. {ProductName} provides two methods for configuring your Kafka client applications to connect to the brokers in your Kafka cluster using your own certificates.\n+\n+You can install your own certificates at two levels:\n+\n+* At a cluster level--see xref:installing-your-own-ca-certificates-{context}[].\n+\n+* For each listener (TLS and external) in a Kafka broker--see xref:proc-installing-certs-per-listener-{context}[].", "originalCommit": "789e6416a33b6cbb87f44a797c8ff10d531a0f3e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQ3NjIxOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368476219", "bodyText": "Good spot. I've reworded as follows:\n\"For each listener (TLS or external listener, or both) in a Kafka broker...\"", "author": "laidan6000", "createdAt": "2020-01-20T10:34:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5MjYwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5MzY4OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r367893689", "bodyText": "Couple of mentions of security model. Would that be understood? How might it reflect on the manual renewal? Maybe we can drop and just say you need to manually renew the certs.", "author": "PaulRMellor", "createdAt": "2020-01-17T11:34:30Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -26,3 +26,15 @@ You can configure the validity period of:\n \n * Cluster CA certificates in `Kafka.spec.clusterCa.validityDays`\n * Client CA certificates in `Kafka.spec.clientsCa.validityDays`\n+\n+== Options for installing your own CA certificates\n+\n+In your security model, client applications might need to trust certificates that were issued by an external CA, such as your company's internal CA or a public CA, in order to connect to external systems. {ProductName} provides two methods for configuring your Kafka client applications to connect to the brokers in your Kafka cluster using your own certificates.\n+\n+You can install your own certificates at two levels:\n+\n+* At a cluster level--see xref:installing-your-own-ca-certificates-{context}[].\n+\n+* For each listener (TLS and external) in a Kafka broker--see xref:proc-installing-certs-per-listener-{context}[].\n+\n+If you install your own certificates using one or both of these methods, they are not automatically renewed by the Cluster Operator. You must manually renew certificates according to your security model.", "originalCommit": "789e6416a33b6cbb87f44a797c8ff10d531a0f3e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTEwNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229105", "bodyText": "I would probably just say You must manually renew certificates when needed. Which could be expiration or whatever security policy the user follows. I would be a bit worried that security model might not have clear meaning and understanding for everyone.", "author": "scholzj", "createdAt": "2020-01-18T14:16:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5MzY4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQ3OTkyNg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368479926", "bodyText": "Removed \"security model\" and reworded to improve the flow. Revised version:\n\nIn order to connect to external systems, your client applications might need to trust certificates that were issued by an external CA, such as your company's internal CA or a public CA. To support this requirement, {ProductName} provides two methods for configuring your Kafka client applications to connect to the brokers in your Kafka cluster using your own certificates.\nYou can install your own certificates at two levels:\n\n\nAt the cluster level--see xref:installing-your-own-ca-certificates-{context}[].\n\n\nFor each listener (TLS or external listener, or both) in a Kafka broker--see xref:proc-installing-certs-per-listener-{context}[].\n\n\nIf you install your own certificates, they are not automatically renewed by the Cluster Operator. In this case, you must manually renew certificates when needed.", "author": "laidan6000", "createdAt": "2020-01-20T10:42:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5MzY4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODkwNDk1Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368904952", "bodyText": "This was refactored again in response to Jakub's comment that the above module \"mixes together\" the two types of certificates in a confusing way.", "author": "laidan6000", "createdAt": "2020-01-21T09:57:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5MzY4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzg5Mzk4Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r367893987", "bodyText": "Not sure this needs to be in brackets: (which are internal to Strimzi)", "author": "PaulRMellor", "createdAt": "2020-01-17T11:35:27Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to Strimzi). Installing per-listener certificates is supported for two types of listeners:", "originalCommit": "789e6416a33b6cbb87f44a797c8ff10d531a0f3e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/4c39fe0461f71379d2efa9e4cdb408efefd8f266", "message": "Missing ProductName attribute\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-17T12:29:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNjcxMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368216712", "bodyText": "I think this part is misleading. This section talks about broker specific config properties that you find in the official Apache Kafka documentation. There is no parameter for specifying \"per-broker certificates\" which is something that Strimzi adds. The sentece in parenthesis let me think that I can, in this config section, set \"per-broker certificates\" as the only listener configuration part. It's not clear that this happens in a different way and not here.", "author": "ppatierno", "createdAt": "2020-01-18T09:14:43Z", "path": "documentation/assemblies/assembly-kafka-broker-configuration.adoc", "diffHunk": "@@ -14,7 +14,7 @@\n You can specify and configure most of the options listed in the \"Broker Configs\" section of the {ApacheKafkaBrokerConfig}. You cannot configure options that are related to the following areas:\n \n * Security (Encryption, Authentication, and Authorization)\n-* Listener configuration\n+* Listener configuration (apart from installing per-broker certificates)", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyODc4MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368228780", "bodyText": "Agree with Paolo, his think this should remain unchanged - ntohing really changed to this and you cannot configure the custom certificates in the config section anyway.", "author": "scholzj", "createdAt": "2020-01-18T14:09:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNjcxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUwMTAxNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368501014", "bodyText": "Thanks for the explanation. I've removed the parentheses.", "author": "laidan6000", "createdAt": "2020-01-20T11:33:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNjcxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNjc3Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368216776", "bodyText": "why these two changes in this PR. I am for avoiding stuff not related to the PR but opening a new one.", "author": "ppatierno", "createdAt": "2020-01-18T09:16:06Z", "path": "documentation/modules/kafkaconnectors/proc-deploying-kafkaconnector.adoc", "diffHunk": "@@ -43,12 +43,12 @@ spec:\n +\n [source,shell,subs=\"+quotes\"]\n ----\n-oc apply -f examples/connector/source-connector.yaml\n+kubectl apply -f examples/connector/source-connector.yaml\n ----\n \n . Check that the resource was created:\n +\n [source,shell,subs=\"+quotes\"]\n ----\n-oc get all --selector strimzi.io/cluster: my-connect-cluster -o name\n+kubectl get all --selector strimzi.io/cluster: my-connect-cluster -o name", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyMDQ5NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368220494", "bodyText": "I would revert this change here. It's addressed by PR #2422", "author": "ppatierno", "createdAt": "2020-01-18T10:48:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNjc3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUwMTQ0NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368501444", "bodyText": "I'll avoid doing this in the future.\nI'll attempt to revert the change now that #2422 has been submitted.", "author": "laidan6000", "createdAt": "2020-01-20T11:34:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNjc3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNjk1Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368216953", "bodyText": "\"Client applications that perform mutual TLS authentication must trust the certificates signed by the cluster CA.\".\nMutual TLS authentication is about having the TLS encryption (so somehow trusting the server) but even using TLS client authentication. The client applications must trust the certificates signed by the cluster CA not necessarily for mutual authentication, it's enough you want TLS encryption for having the need of trusting certificates signed by the cluster CA.", "author": "ppatierno", "createdAt": "2020-01-18T09:19:53Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -6,16 +6,16 @@\n = Certificate Authorities\n \n To support encryption, each {ProductName} component needs its own private keys and public key certificates.\n-All component certificates are signed by a Certificate Authority (CA) called the _cluster CA_.\n+All component certificates are signed by an internal Certificate Authority (CA) called the _cluster CA_.\n \n-Similarly, each Kafka client application connecting using TLS client authentication needs private keys and certificates.\n-The _clients CA_ is used to sign the certificates for the Kafka clients.\n+Similarly, each Kafka client application connecting to {ProductName} using TLS client authentication needs to provide private keys and certificates.\n+A second internal CA, named the _clients CA_, is used to sign certificates for the Kafka clients. \n \n == CA certificates\n \n-Each CA has a self-signed public key certificate.\n+Both the cluster CA and the clients CA have a self-signed public key certificate.\n \n-Kafka brokers are configured to trust certificates signed by either the clients CA or the cluster CA. Components to which clients do not need to connect, such as ZooKeeper, only trust certificates signed by the cluster CA. Client applications that perform mutual TLS authentication have to trust the certificates signed by the cluster CA.\n+Kafka brokers are configured to trust certificates signed by either the clients CA or the cluster CA. Components that clients do not need to connect to, such as ZooKeeper, only trust certificates signed by the cluster CA. Client applications that perform mutual TLS authentication must trust the certificates signed by the cluster CA.", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUwOTY3MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368509671", "bodyText": "I think I understand now. I've rephrased the information and included a cross-ref to the new concept on mutual TLS authentication.\n\nUnless TLS encryption for external listeners is disabled, client applications must trust certificates signed by the cluster CA. This is also true for client applications that perform mutual TLS authentication.\n\n^ Please suggest further edits if needed.", "author": "laidan6000", "createdAt": "2020-01-20T11:55:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNjk1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNzA3Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368217077", "bodyText": "I don't think this sentence is needed. Plain listeners aren't encrypted ... they are plain so TLS isn't in place, so having certificates don't make sense.", "author": "ppatierno", "createdAt": "2020-01-18T09:21:54Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to {ProductName}). Installing per-listener certificates is supported for two types of listeners:\n+\n+* TLS listeners for inter-cluster communication\n+\n+* External listeners (including `route`, `loadbalancer`, and `nodeport` types) for communication between Kafka clients and Kafka brokers\n+\n+Installing your own certificates and keys for plain listeners is not supported.", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODUxMzY1MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368513650", "bodyText": "Ah, I see. I'll remove this sentence.", "author": "laidan6000", "createdAt": "2020-01-20T12:05:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNzA3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIxNzE5MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368217191", "bodyText": "CRT is not a format. It's just a possible file extension for a certificate formatted with PEM. Just fyi, other formats are DER, PKCS12, etc etc. In this guess it's enough saying \"...in PEM format\".", "author": "ppatierno", "createdAt": "2020-01-18T09:24:17Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to {ProductName}). Installing per-listener certificates is supported for two types of listeners:\n+\n+* TLS listeners for inter-cluster communication\n+\n+* External listeners (including `route`, `loadbalancer`, and `nodeport` types) for communication between Kafka clients and Kafka brokers\n+\n+Installing your own certificates and keys for plain listeners is not supported.\n+\n+.Prerequisites\n+\n+* A Kubernetes cluster.\n+* The Cluster Operator is running.\n+* Public key of the external CA.  \n+* Your own X.509 certificate in CRT or PEM format.", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyODgxNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368228815", "bodyText": "I wonder if we should call it your own Kafka listener certificates instead. Broker certificates might be confusing since they are not per-broker but per-listener.", "author": "scholzj", "createdAt": "2020-01-18T14:10:27Z", "path": "documentation/assemblies/security/assembly-security.adoc", "diffHunk": "@@ -10,9 +10,11 @@ Communication between Kafka brokers (interbroker communication), between ZooKeep\n Communication between Kafka clients and Kafka brokers is encrypted according to how the cluster is configured.\n For the Kafka and {ProductName} components, TLS certificates are also used for authentication.\n \n-The Cluster Operator automatically sets up TLS certificates to enable encryption and authentication within your cluster.\n+The Cluster Operator automatically sets up and renews TLS certificates to enable encryption and authentication within your cluster.\n It also sets up other TLS certificates if you want to enable encryption or TLS authentication between Kafka brokers and clients.\n \n+You can install your own Kafka broker certificates on a per-listener basis.", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQ5ODE1Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368498152", "bodyText": "I like Kafka listener certificates, as long as we explain that they are installed for each broker.\nChoosing the right terminology is so important.", "author": "laidan6000", "createdAt": "2020-01-20T11:25:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyODgxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyODk2MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368228960", "bodyText": "I think this mixes two things which are separate concepts:\n\nSuplying your own CA certificates\nSuplying server certficates for the TLS and External listeners.\nThey should either no be mixed into the same chapter named after nly one of these or we need to find new name.", "author": "scholzj", "createdAt": "2020-01-18T14:13:34Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -26,3 +26,15 @@ You can configure the validity period of:\n \n * Cluster CA certificates in `Kafka.spec.clusterCa.validityDays`\n * Client CA certificates in `Kafka.spec.clientsCa.validityDays`\n+\n+== Options for installing your own CA certificates", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODYxMjgwNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368612807", "bodyText": "Thanks for the clarification. Tom thought that we needed a short concept to distinguish between these two separate but related tasks.\nI'll re-word and ask you to re-review.", "author": "laidan6000", "createdAt": "2020-01-20T15:43:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyODk2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyODk5OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368228999", "bodyText": "I'm not sure the cluster level make sense as a name for it. I would call it Providing your own CA or something.", "author": "scholzj", "createdAt": "2020-01-18T14:14:28Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -26,3 +26,15 @@ You can configure the validity period of:\n \n * Cluster CA certificates in `Kafka.spec.clusterCa.validityDays`\n * Client CA certificates in `Kafka.spec.clientsCa.validityDays`\n+\n+== Options for installing your own CA certificates\n+\n+In your security model, client applications might need to trust certificates that were issued by an external CA, such as your company's internal CA or a public CA, in order to connect to external systems. {ProductName} provides two methods for configuring your Kafka client applications to connect to the brokers in your Kafka cluster using your own certificates.\n+\n+You can install your own certificates at two levels:\n+\n+* At a cluster level--see xref:installing-your-own-ca-certificates-{context}[].", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTA1Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229052", "bodyText": "I perosnally would probably leave out the in a Kafka broker part.\nAlso - and I'm not sure we need to mention it here - it applies to external listeners using TLS only. But I guess that migth be obvious and does nto need to be mentioned here, or?", "author": "scholzj", "createdAt": "2020-01-18T14:15:42Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -26,3 +26,15 @@ You can configure the validity period of:\n \n * Cluster CA certificates in `Kafka.spec.clusterCa.validityDays`\n * Client CA certificates in `Kafka.spec.clientsCa.validityDays`\n+\n+== Options for installing your own CA certificates\n+\n+In your security model, client applications might need to trust certificates that were issued by an external CA, such as your company's internal CA or a public CA, in order to connect to external systems. {ProductName} provides two methods for configuring your Kafka client applications to connect to the brokers in your Kafka cluster using your own certificates.\n+\n+You can install your own certificates at two levels:\n+\n+* At a cluster level--see xref:installing-your-own-ca-certificates-{context}[].\n+\n+* For each listener (TLS and external) in a Kafka broker--see xref:proc-installing-certs-per-listener-{context}[].", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTE4NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229184", "bodyText": "These would be server certificates, not CA certificates. We need to distinguish the two options properly.", "author": "scholzj", "createdAt": "2020-01-18T14:18:20Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTIxNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229214", "bodyText": "Should we use configure instead of install? The install doesn't sound right here, I would say the operator installs them,m the user just configures them.", "author": "scholzj", "createdAt": "2020-01-18T14:18:58Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to {ProductName}). Installing per-listener certificates is supported for two types of listeners:", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODYzOTU0Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368639547", "bodyText": "Sounds good to me.", "author": "laidan6000", "createdAt": "2020-01-20T16:36:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTIxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTMxMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229311", "bodyText": "Thsi would be much easier to comment on if you followed the one sentence per line policy. We should mention somewhere here that the certificates should be either wildcard certificates with appropriatte subject or have SANs matching all possibl broker names. We should possibly include some examples of how the addresses would look like so that the user knows what should be used.", "author": "scholzj", "createdAt": "2020-01-18T14:21:06Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to {ProductName}). Installing per-listener certificates is supported for two types of listeners:", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODY0MDkzNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368640934", "bodyText": "OK. I'll use one sentence per line as much as possible.\n@stanlyDoge - Can you provide some example addresses in the correct format?", "author": "laidan6000", "createdAt": "2020-01-20T16:39:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTMxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTUyMDM0Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369520346", "bodyText": "I've added a new module named \"SAN certificates for Kafka listeners\" containing the example addresses.", "author": "laidan6000", "createdAt": "2020-01-22T12:00:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTMxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTM0MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229341", "bodyText": "Maybe we can add here that the external listeners only as long as they use TLS. It is also missing ingress type.", "author": "scholzj", "createdAt": "2020-01-18T14:21:37Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to {ProductName}). Installing per-listener certificates is supported for two types of listeners:\n+\n+* TLS listeners for inter-cluster communication\n+\n+* External listeners (including `route`, `loadbalancer`, and `nodeport` types) for communication between Kafka clients and Kafka brokers", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTM3NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229375", "bodyText": "You should clarify that Your own certificate has to be signed by the CA maybe.", "author": "scholzj", "createdAt": "2020-01-18T14:22:32Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to {ProductName}). Installing per-listener certificates is supported for two types of listeners:\n+\n+* TLS listeners for inter-cluster communication\n+\n+* External listeners (including `route`, `loadbalancer`, and `nodeport` types) for communication between Kafka clients and Kafka brokers\n+\n+Installing your own certificates and keys for plain listeners is not supported.\n+\n+.Prerequisites\n+\n+* A Kubernetes cluster.\n+* The Cluster Operator is running.\n+* Public key of the external CA.  \n+* Your own X.509 certificate in CRT or PEM format.", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTQwOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229409", "bodyText": "So do we need to clarify how the CA public key should be used? You listed it as prerequisite so it probably should be explained.", "author": "scholzj", "createdAt": "2020-01-18T14:23:18Z", "path": "documentation/modules/security/proc-installing-certs-per-listener.adoc", "diffHunk": "@@ -0,0 +1,83 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='proc-installing-certs-per-listener-{context}']\n+= Installing your own CA certificates for listeners\n+\n+You can install your own certificates and public keys for Kafka brokers on a per-listener basis. These certificates can be signed by an external Certificate Authority (CA), such as your company's internal CA or a public CA, rather than the cluster or clients CAs (which are internal to {ProductName}). Installing per-listener certificates is supported for two types of listeners:\n+\n+* TLS listeners for inter-cluster communication\n+\n+* External listeners (including `route`, `loadbalancer`, and `nodeport` types) for communication between Kafka clients and Kafka brokers\n+\n+Installing your own certificates and keys for plain listeners is not supported.\n+\n+.Prerequisites\n+\n+* A Kubernetes cluster.\n+* The Cluster Operator is running.\n+* Public key of the external CA.  \n+* Your own X.509 certificate in CRT or PEM format.\n+\n+.Procedure\n+\n+. Create a `Secret` containing your public key and certificate:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl create secret generic _my-secret_ --from-file=_my-listener-key.key_ --from-file=_my-listener-certificate.crt_", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODY0MjM4MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368642380", "bodyText": "Can you give me a few pointers here, @stanlyDoge ?", "author": "laidan6000", "createdAt": "2020-01-20T16:42:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTQwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTUyNDYxMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369524611", "bodyText": "I removed the prerequisite and added the following text:\n\nYour client applications should use the CA public key as a trusted certificate in order to verify the identity of the Kafka broker.", "author": "laidan6000", "createdAt": "2020-01-22T12:11:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTQwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyOTQ2MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r368229460", "bodyText": "Again, I would probably leave out the cluster level. I do not think it is understandable what it means but people not really familiar with Strimzi.", "author": "scholzj", "createdAt": "2020-01-18T14:24:17Z", "path": "documentation/modules/security/proc-installing-your-own-ca-certificates.adoc", "diffHunk": "@@ -3,9 +3,9 @@\n // assembly-security.adoc\n \n [id='installing-your-own-ca-certificates-{context}']\n-= Installing your own CA certificates\n+= Installing your own CA certificates for a Kafka cluster\n \n-This procedure describes how to install your own CA certificates and private keys instead of using CA certificates and private keys generated by the Cluster Operator.\n+This procedure describes how to install your own CA certificates and private keys at the cluster level instead of using CA certificates and private keys generated by the Cluster Operator.", "originalCommit": "4c39fe0461f71379d2efa9e4cdb408efefd8f266", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "022ac4f36d06e98cbe455f902f0dd4f87b257d50", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/022ac4f36d06e98cbe455f902f0dd4f87b257d50", "message": "Review comments PM\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-20T11:21:27Z", "type": "commit"}, {"oid": "3a189b9e4df0f77a22b89d1fcabd4e9e30bbc130", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3a189b9e4df0f77a22b89d1fcabd4e9e30bbc130", "message": "Review comments PP\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-20T12:07:28Z", "type": "commit"}, {"oid": "a896215989c196301293a5d2496fc33d2d9a9c50", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a896215989c196301293a5d2496fc33d2d9a9c50", "message": "1st batch of review comments JS\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-20T16:58:12Z", "type": "commit"}, {"oid": "a469fd3b5b33e910dbbb4597c88cef1a09bdd18c", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a469fd3b5b33e910dbbb4597c88cef1a09bdd18c", "message": "2nd batch of review comments JS\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-21T14:10:33Z", "type": "commit"}, {"oid": "2150fa2c9002a12771ee9ef6cf11c90354d4326f", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2150fa2c9002a12771ee9ef6cf11c90354d4326f", "message": "3rd batch of review comments JS - SAN certs\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-22T11:50:23Z", "type": "commit"}, {"oid": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/32bead545ea562e18b4d917b1b6e7d3b202f9773", "message": "Added info on public key\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-22T12:11:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTU0NzY3Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369547677", "bodyText": "why we added \"CA\" ... so starting to use \"CA certificates\" instead of \"certificates\". A client should trust a broker certificates (which is not a CA certificate) signed by the cluster CA.", "author": "ppatierno", "createdAt": "2020-01-22T13:07:00Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -6,20 +6,28 @@\n = Certificate Authorities\n \n To support encryption, each {ProductName} component needs its own private keys and public key certificates.\n-All component certificates are signed by a Certificate Authority (CA) called the _cluster CA_.\n+All component certificates are signed by an internal Certificate Authority (CA) called the _cluster CA_.\n \n-Similarly, each Kafka client application connecting using TLS client authentication needs private keys and certificates.\n-The _clients CA_ is used to sign the certificates for the Kafka clients.\n+Similarly, each Kafka client application connecting to {ProductName} using TLS client authentication needs to provide private keys and certificates.\n+A second internal CA, named the _clients CA_, is used to sign certificates for the Kafka clients. \n \n == CA certificates\n \n-Each CA has a self-signed public key certificate.\n+Both the cluster CA and clients CA have a self-signed public key certificate.\n \n-Kafka brokers are configured to trust certificates signed by either the clients CA or the cluster CA. Components to which clients do not need to connect, such as ZooKeeper, only trust certificates signed by the cluster CA. Client applications that perform mutual TLS authentication have to trust the certificates signed by the cluster CA.\n+Kafka brokers are configured to trust CA certificates signed by either the cluster CA or clients CA.\n+Components that clients do not need to connect to, such as ZooKeeper, only trust CA certificates signed by the cluster CA.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDAxNzcyNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r370017724", "bodyText": "I've ended up confusing myself with the terminology :(\nI'll remove the \"CA\".", "author": "laidan6000", "createdAt": "2020-01-23T09:45:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTU0NzY3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTU0NzgwNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369547805", "bodyText": "I am fine with this one but still this usage of \"CA certificates\".", "author": "ppatierno", "createdAt": "2020-01-22T13:07:17Z", "path": "documentation/modules/security/con-certificate-authorities.adoc", "diffHunk": "@@ -6,20 +6,28 @@\n = Certificate Authorities\n \n To support encryption, each {ProductName} component needs its own private keys and public key certificates.\n-All component certificates are signed by a Certificate Authority (CA) called the _cluster CA_.\n+All component certificates are signed by an internal Certificate Authority (CA) called the _cluster CA_.\n \n-Similarly, each Kafka client application connecting using TLS client authentication needs private keys and certificates.\n-The _clients CA_ is used to sign the certificates for the Kafka clients.\n+Similarly, each Kafka client application connecting to {ProductName} using TLS client authentication needs to provide private keys and certificates.\n+A second internal CA, named the _clients CA_, is used to sign certificates for the Kafka clients. \n \n == CA certificates\n \n-Each CA has a self-signed public key certificate.\n+Both the cluster CA and clients CA have a self-signed public key certificate.\n \n-Kafka brokers are configured to trust certificates signed by either the clients CA or the cluster CA. Components to which clients do not need to connect, such as ZooKeeper, only trust certificates signed by the cluster CA. Client applications that perform mutual TLS authentication have to trust the certificates signed by the cluster CA.\n+Kafka brokers are configured to trust CA certificates signed by either the cluster CA or clients CA.\n+Components that clients do not need to connect to, such as ZooKeeper, only trust CA certificates signed by the cluster CA.\n+Unless TLS encryption for external listeners is disabled, client applications must trust CA certificates signed by the cluster CA.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDAxODgzOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r370018839", "bodyText": "Removed.", "author": "laidan6000", "createdAt": "2020-01-23T09:47:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTU0NzgwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk3Njk2MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369976960", "bodyText": "Do we need to clarify that it renews only its own certificates? Not any supplied by the user?", "author": "scholzj", "createdAt": "2020-01-23T08:11:55Z", "path": "documentation/assemblies/security/assembly-security.adoc", "diffHunk": "@@ -10,9 +10,12 @@ Communication between Kafka brokers (interbroker communication), between ZooKeep\n Communication between Kafka clients and Kafka brokers is encrypted according to how the cluster is configured.\n For the Kafka and {ProductName} components, TLS certificates are also used for authentication.\n \n-The Cluster Operator automatically sets up TLS certificates to enable encryption and authentication within your cluster.\n+The Cluster Operator automatically sets up and renews TLS certificates to enable encryption and authentication within your cluster.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk3ODUxMA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369978510", "bodyText": "I do not think this sentence makes sense. I think it should say something like this:\nSometimes, you might want to use {ProductName} with your own CA such as  your company's private CA or a public CA.\nor maybe:\nSometimes you want to leverage your existing security infrastructure such as your company's private CA or a public CA.", "author": "scholzj", "createdAt": "2020-01-23T08:16:30Z", "path": "documentation/modules/security/con-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,15 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='kafka-listener-certificates-{context}']\n+\n+= Kafka listener certificates\n+\n+In order to connect to external systems such as {ProductName}, your client applications might need to trust server certificates that were issued by an external CA, such as your company's private CA or a public CA.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDAyOTYwMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r370029602", "bodyText": "Very nice. I feel that the verb leverage demands an action.\n\nSometimes you might want to leverage your existing security infrastructure, such as your company's private CA or a public CA, when integrating your client applications with {ProductName}.\n\nI'll remove the whole sentence beginning with \"In order to...\".", "author": "laidan6000", "createdAt": "2020-01-23T10:08:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk3ODUxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk3OTE4Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369979183", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            = SAN certificates for Kafka listeners\n          \n          \n            \n            = Alternative subjects in server certificates for Kafka listeners", "author": "scholzj", "createdAt": "2020-01-23T08:18:28Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk3OTk1Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369979952", "bodyText": "Sorry if I confused you about this. The SANs are a feature/configuration  of the certificate. It is not certificate type. So I think it should sound something like this:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n          \n          \n            \n            In order to use TLS hostname verification with your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use the correct Subject Alternative Names (SAN) for each listener. The certificate SANs must specify hostnames for:", "author": "scholzj", "createdAt": "2020-01-23T08:20:42Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MDU0MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369980540", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The Kafka broker hostnames can contain wildcard names.\n          \n          \n            \n            You can use wildcsard certificates if supported by your CA.", "author": "scholzj", "createdAt": "2020-01-23T08:22:22Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MDcxNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369980714", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Using SAN certificates is required for TLS hostname verification.\n          \n          \n            \n            Using certificates with the coorrect SANs is required for TLS hostname verification.", "author": "scholzj", "createdAt": "2020-01-23T08:22:50Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.\n+\n+Using SAN certificates is required for TLS hostname verification.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDAzMjQyOA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r370032428", "bodyText": "I'll remove this sentence because we now mention TLS hostname verification right at the start.", "author": "laidan6000", "createdAt": "2020-01-23T10:14:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MDcxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MDgzMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369980832", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            == TLS listener SAN certificate examples\n          \n          \n            \n            == TLS listener SAN examples", "author": "scholzj", "createdAt": "2020-01-23T08:23:08Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.\n+\n+Using SAN certificates is required for TLS hostname verification.\n+\n+== TLS listener SAN certificate examples", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MDk1Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369980953", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Use the following examples to help you specify hostnames in SAN certificates for TLS listeners.\n          \n          \n            \n            Use the following examples to help you specify hostnames the SANs in your certificates for TLS listeners.", "author": "scholzj", "createdAt": "2020-01-23T08:23:27Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.\n+\n+Using SAN certificates is required for TLS hostname verification.\n+\n+== TLS listener SAN certificate examples\n+\n+Use the following examples to help you specify hostnames in SAN certificates for TLS listeners.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MTE2MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369981160", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            == External listener SAN certificate examples\n          \n          \n            \n            == External listener SAN examples", "author": "scholzj", "createdAt": "2020-01-23T08:23:58Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.\n+\n+Using SAN certificates is required for TLS hostname verification.\n+\n+== TLS listener SAN certificate examples\n+\n+Use the following examples to help you specify hostnames in SAN certificates for TLS listeners.\n+\n+.Wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+//Kafka brokers\n+*._<cluster-name>_-kafka-brokers\n+*._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+.Non-wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+// Kafka brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+# ...\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+== External listener SAN certificate examples", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MTMyNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369981325", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            For external listeners which have TLS encryption enabled, the hostnames you need to specify in SAN certificates depends on the external listener `type`.\n          \n          \n            \n            For external listeners which have TLS encryption enabled, the hostnames you need to specify in certificates depends on the external listener `type`.", "author": "scholzj", "createdAt": "2020-01-23T08:24:23Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.\n+\n+Using SAN certificates is required for TLS hostname verification.\n+\n+== TLS listener SAN certificate examples\n+\n+Use the following examples to help you specify hostnames in SAN certificates for TLS listeners.\n+\n+.Wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+//Kafka brokers\n+*._<cluster-name>_-kafka-brokers\n+*._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+.Non-wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+// Kafka brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+# ...\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+== External listener SAN certificate examples\n+\n+For external listeners which have TLS encryption enabled, the hostnames you need to specify in SAN certificates depends on the external listener `type`.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MTQ0NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369981445", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u00a6In the SAN certificate, specify...\n          \n          \n            \n            \u00a6In the SANs, specify...", "author": "scholzj", "createdAt": "2020-01-23T08:24:44Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.\n+\n+Using SAN certificates is required for TLS hostname verification.\n+\n+== TLS listener SAN certificate examples\n+\n+Use the following examples to help you specify hostnames in SAN certificates for TLS listeners.\n+\n+.Wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+//Kafka brokers\n+*._<cluster-name>_-kafka-brokers\n+*._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+.Non-wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+// Kafka brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+# ...\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+== External listener SAN certificate examples\n+\n+For external listeners which have TLS encryption enabled, the hostnames you need to specify in SAN certificates depends on the external listener `type`.\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6External listener type\n+\u00a6In the SAN certificate, specify...", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MTYyNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369981627", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u00a6Addresses of all Kafka broker `Routes` and the address of the bootstrap service `Route`.\n          \n          \n            \n            \u00a6Addresses of all Kafka broker `Routes` and the address of the bootstrap `Route`.", "author": "scholzj", "createdAt": "2020-01-23T08:25:15Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.\n+\n+Using SAN certificates is required for TLS hostname verification.\n+\n+== TLS listener SAN certificate examples\n+\n+Use the following examples to help you specify hostnames in SAN certificates for TLS listeners.\n+\n+.Wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+//Kafka brokers\n+*._<cluster-name>_-kafka-brokers\n+*._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+.Non-wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+// Kafka brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+# ...\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+== External listener SAN certificate examples\n+\n+For external listeners which have TLS encryption enabled, the hostnames you need to specify in SAN certificates depends on the external listener `type`.\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6External listener type\n+\u00a6In the SAN certificate, specify...\n+\n+m\u00a6Route\n+\u00a6Addresses of all Kafka broker `Routes` and the address of the bootstrap service `Route`.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4MTczMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r369981733", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \u00a6Addresses of all Kafka broker `loadbalancers` and the `loadbalancer` bootstrap address.\n          \n          \n            \n            \u00a6Addresses of all Kafka broker `loadbalancers` and the bootstrap `loadbalancer` address.", "author": "scholzj", "createdAt": "2020-01-23T08:25:32Z", "path": "documentation/modules/security/ref-formats-kafka-listener-certificates.adoc", "diffHunk": "@@ -0,0 +1,77 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-security.adoc\n+\n+[id='ref-formats-kafka-listener-certificates-{context}']\n+\n+= SAN certificates for Kafka listeners\n+\n+If you provide your own xref:kafka-listener-certificates-{context}[Kafka listener certificates], you must use a Subject Alternative Name (SAN) certificate for each listener. The SAN certificate must specify hostnames for:\n+\n+* All of the Kafka brokers in your cluster\n+\n+* The Kafka cluster bootstrap service\n+\n+The Kafka broker hostnames can contain wildcard names.\n+\n+Using SAN certificates is required for TLS hostname verification.\n+\n+== TLS listener SAN certificate examples\n+\n+Use the following examples to help you specify hostnames in SAN certificates for TLS listeners.\n+\n+.Wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+//Kafka brokers\n+*._<cluster-name>_-kafka-brokers\n+*._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+.Non-wildcards example\n+\n+[source,shell,subs=\"+quotes,attributes+\"]\n+----\n+// Kafka brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-0._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers\n+_<cluster-name>_-kafka-1._<cluster-name>_-kafka-brokers._<namespace>_.svc\n+# ...\n+\n+// Bootstrap service\n+_<cluster-name>_-kafka-bootstrap\n+_<cluster-name>_-kafka-bootstrap._<namespace>_.svc\n+----\n+\n+== External listener SAN certificate examples\n+\n+For external listeners which have TLS encryption enabled, the hostnames you need to specify in SAN certificates depends on the external listener `type`.\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6External listener type\n+\u00a6In the SAN certificate, specify...\n+\n+m\u00a6Route\n+\u00a6Addresses of all Kafka broker `Routes` and the address of the bootstrap service `Route`.\n+\n+You can use a matching wildcard name.\n+\n+m\u00a6loadbalancer\n+\u00a6Addresses of all Kafka broker `loadbalancers` and the `loadbalancer` bootstrap address.", "originalCommit": "32bead545ea562e18b4d917b1b6e7d3b202f9773", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6e8b8d2d87f11bd6998f86e924a6a516cec3ae51", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/6e8b8d2d87f11bd6998f86e924a6a516cec3ae51", "message": "Additional comments from JS and PP\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-23T10:19:13Z", "type": "commit"}, {"oid": "0f1241f5ba82490c78787ea6b3dba095d97dede0", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/0f1241f5ba82490c78787ea6b3dba095d97dede0", "message": "Changes cross-ref in procedure\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-23T10:56:17Z", "type": "commit"}, {"oid": "f0915d1aee6b9a6703637e158fb212f939c341a6", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f0915d1aee6b9a6703637e158fb212f939c341a6", "message": "Changes to support mininimalism principles\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-24T11:28:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk5Mjk1NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r370992955", "bodyText": "Sorry, I had to get back to this. I do not think the CA belongs here.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            You can provide your own server certificates and CA public keys for the following types of listeners:\n          \n          \n            \n            You can provide your own server certificates and public keys for the following types of listeners:", "author": "scholzj", "createdAt": "2020-01-26T11:53:22Z", "path": "documentation/modules/security/con-kafka-listener-certificates.adoc", "diffHunk": "@@ -6,10 +6,15 @@\n \n = Kafka listener certificates\n \n-Sometimes you might want to leverage your existing security infrastructure, such as your company's private CA or a public CA, when integrating your client applications with {ProductName}. \n-To support this requirement, {ProductName} allows you to provide your own _Kafka listener certificates_ and public keys for external listeners which have TLS encryption enabled.\n-Your Kafka client applications will connect to Kafka brokers using Kafka listener certificates rather than CA certificates signed by the cluster CA or clients CA.\n+You can provide your own server certificates and CA public keys for the following types of listeners:", "originalCommit": "f0915d1aee6b9a6703637e158fb212f939c341a6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTE0NjI3MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2414#discussion_r371146271", "bodyText": "OK, that's updated now.", "author": "laidan6000", "createdAt": "2020-01-27T09:55:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDk5Mjk1NQ=="}], "type": "inlineReview"}, {"oid": "07af21886bd3561a6396c331f797d856a49996b1", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/07af21886bd3561a6396c331f797d856a49996b1", "message": "Public keys not CA public keys\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>", "committedDate": "2020-01-27T09:55:53Z", "type": "commit"}]}