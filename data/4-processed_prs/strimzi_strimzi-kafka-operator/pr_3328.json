{"pr_number": 3328, "pr_title": "Cluster Operator dynamic logging configuration", "pr_createdAt": "2020-07-16T12:08:19Z", "pr_url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA5ODgyMA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456098820", "bodyText": "So, why does this still use the env vars? It should just have the log levels, or?", "author": "scholzj", "createdAt": "2020-07-16T21:51:35Z", "path": "cluster-operator/src/main/resources/config-maps/050-ConfigMap-strimzi-cluster-operator-logging.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+kind: ConfigMap\n+apiVersion: v1\n+metadata:\n+  name: strimzi-cluster-operator-logging\n+data:\n+  log4j2.properties: |\n+    name = COConfig\n+\n+    appender.console.type = Console\n+    appender.console.name = STDOUT\n+    appender.console.layout.type = PatternLayout\n+    appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n\n+\n+    rootLogger.level = ${env:STRIMZI_LOG_LEVEL:-INFO}\n+    rootLogger.appenderRefs = stdout\n+    rootLogger.appenderRef.console.ref = STDOUT\n+    rootLogger.additivity = false\n+\n+    # Kafka AdminClient logging is a bit noisy at INFO level\n+    logger.kafka.name = org.apache.kafka\n+    logger.kafka.level = ${env:STRIMZI_AC_LOG_LEVEL:-WARN}\n+    logger.kafka.additivity = false\n+\n+    # Zookeeper is very verbose even on INFO level -> We set it to WARN by default\n+    logger.zookeepertrustmanager.name = org.apache.zookeeper\n+    logger.zookeepertrustmanager.level = ${env:STRIMZI_ZOOKEEPER_LOG_LEVEL:-WARN}", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzNzU4NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456237585", "bodyText": "All the envvars are kept for compatibility with older versions of deployment file. Isn't it something we want?", "author": "sknot-rh", "createdAt": "2020-07-17T06:09:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA5ODgyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI1ODIxMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456258212", "bodyText": "I do not understand what do you mean with compatibility. To get the config from the configmap you need to apply the changes and use new operator basically. So what kind of compatibility are we talking about?", "author": "scholzj", "createdAt": "2020-07-17T07:06:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA5ODgyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI2MDc1NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456260754", "bodyText": "If users wants to use envvars to set the logging, this allows it. Of course with rolling update.", "author": "sknot-rh", "createdAt": "2020-07-17T07:12:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA5ODgyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA5OTA5MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456099090", "bodyText": "Should we still have some defaults when the config map is for whatever reason not mounted?", "author": "scholzj", "createdAt": "2020-07-16T21:52:09Z", "path": "cluster-operator/src/main/resources/log4j2.properties", "diffHunk": "@@ -1,21 +0,0 @@\n-name = COConfig\n- \n-appender.console.type = Console\n-appender.console.name = STDOUT\n-appender.console.layout.type = PatternLayout\n-appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n\n-\n-rootLogger.level = ${env:STRIMZI_LOG_LEVEL:-INFO}\n-rootLogger.appenderRefs = stdout\n-rootLogger.appenderRef.console.ref = STDOUT\n-rootLogger.additivity = false\n-\n-# Kafka AdminClient logging is a bit noisy at INFO level\n-logger.kafka.name = org.apache.kafka\n-logger.kafka.level = ${env:STRIMZI_AC_LOG_LEVEL:-WARN}\n-logger.kafka.additivity = false\n-\n-# Zookeeper is very verbose even on INFO level -> We set it to WARN by default\n-logger.zookeepertrustmanager.name = org.apache.zookeeper\n-logger.zookeepertrustmanager.level = ${env:STRIMZI_ZOOKEEPER_LOG_LEVEL:-WARN}\n-logger.zookeepertrustmanager.additivity = false", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA5OTY0NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456099644", "bodyText": "Same as above - why do we have these env vars here?", "author": "scholzj", "createdAt": "2020-07-16T21:53:20Z", "path": "helm-charts/helm2/strimzi-kafka-operator/templates/050-ConfigMap-strimzi-cluster-operator-logging.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+kind: ConfigMap\n+apiVersion: v1\n+metadata:\n+  name: {{ .Values.logConfigMap }}\n+data:\n+  log4j2.properties: |\n+    name = COConfig\n+\n+    appender.console.type = Console\n+    appender.console.name = STDOUT\n+    appender.console.layout.type = PatternLayout\n+    appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n\n+\n+    rootLogger.level = ${env:STRIMZI_LOG_LEVEL:-INFO}\n+    rootLogger.appenderRefs = stdout\n+    rootLogger.appenderRef.console.ref = STDOUT\n+    rootLogger.additivity = false\n+\n+    # Kafka AdminClient logging is a bit noisy at INFO level\n+    logger.kafka.name = org.apache.kafka\n+    logger.kafka.level = ${env:STRIMZI_AC_LOG_LEVEL:-WARN}\n+    logger.kafka.additivity = false\n+\n+    # Zookeeper is very verbose even on INFO level -> We set it to WARN by default\n+    logger.zookeepertrustmanager.name = org.apache.zookeeper\n+    logger.zookeepertrustmanager.level = ${env:STRIMZI_ZOOKEEPER_LOG_LEVEL:-WARN}", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMDI5Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456100292", "bodyText": "Why is this needed? It does not seem to be used?", "author": "scholzj", "createdAt": "2020-07-16T21:54:31Z", "path": "helm-charts/helm2/Makefile", "diffHunk": "@@ -8,6 +8,7 @@ CHART_NAME = strimzi-kafka-operator\n CHART_PATH ?= ../helm2/strimzi-kafka-operator/\n CHART_RENDERED_TEMPLATES_TMP = ../../target/charts\n CHART_RENDERED_TEMPLATES_CLUSTERROLES = ../../cluster-operator/src/main/resources/cluster-roles/\n+CHART_RENDERED_TEMPLATES_CONFIGMAPS = ../../cluster-operator/src/main/resources/config-maps/", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMDQ0MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456100440", "bodyText": "Could you explain what does this do? It is not really clear to me.", "author": "scholzj", "createdAt": "2020-07-16T21:54:50Z", "path": "helm-charts/helm3/Makefile", "diffHunk": "@@ -48,6 +49,12 @@ helm_install: helm_clean helm_template\n \t$(FIND) $(CHART_RENDERED_TEMPLATES_TMP) -type f -name '*ClusterRole-*.yaml' -printf \"%p \" -exec yq r {} kind \\; \\\n \t| $(SED) -E 's/([^ ]*) ([a-zA-Z0-9]*)$$/\\1/' \\\n \t| xargs -IFILE $(CP) FILE $(CHART_RENDERED_TEMPLATES_CLUSTERROLES)\n+\t# Copying rendered template files to: $(CHART_RENDERED_TEMPLATES_CONFIGMAPS)\n+\tmkdir -p $(CHART_RENDERED_TEMPLATES_CONFIGMAPS)\n+\t# Find rendered resources which are ConfigMaps and move them\n+\t$(FIND) $(CHART_RENDERED_TEMPLATES_TMP) -type f -name '*ConfigMap-*.yaml' -printf \"%p \" -exec yq r {} kind \\; \\\n+\t| $(SED) -E 's/([^ ]*) ([a-zA-Z0-9]*)$$/\\1/' \\\n+\t| xargs -IFILE $(CP) FILE $(CHART_RENDERED_TEMPLATES_CONFIGMAPS)", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMxMzgxNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456313815", "bodyText": "It copies rendered ConfigMap files into cluster-operator/src/main/resources/config-maps/", "author": "sknot-rh", "createdAt": "2020-07-17T08:57:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMDQ0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMxNzQwNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456317407", "bodyText": "But why?", "author": "scholzj", "createdAt": "2020-07-17T09:05:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMDQ0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMDU3MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456100571", "bodyText": "Env vars again.", "author": "scholzj", "createdAt": "2020-07-16T21:55:04Z", "path": "helm-charts/helm3/strimzi-kafka-operator/templates/050-ConfigMap-strimzi-cluster-operator-logging.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+kind: ConfigMap\n+apiVersion: v1\n+metadata:\n+  name: {{ .Values.logConfigMap }}\n+data:\n+  log4j2.properties: |\n+    name = COConfig\n+\n+    appender.console.type = Console\n+    appender.console.name = STDOUT\n+    appender.console.layout.type = PatternLayout\n+    appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n\n+\n+    rootLogger.level = ${env:STRIMZI_LOG_LEVEL:-INFO}\n+    rootLogger.appenderRefs = stdout\n+    rootLogger.appenderRef.console.ref = STDOUT\n+    rootLogger.additivity = false\n+\n+    # Kafka AdminClient logging is a bit noisy at INFO level\n+    logger.kafka.name = org.apache.kafka\n+    logger.kafka.level = ${env:STRIMZI_AC_LOG_LEVEL:-WARN}\n+    logger.kafka.additivity = false\n+\n+    # Zookeeper is very verbose even on INFO level -> We set it to WARN by default\n+    logger.zookeepertrustmanager.name = org.apache.zookeeper\n+    logger.zookeepertrustmanager.level = ${env:STRIMZI_ZOOKEEPER_LOG_LEVEL:-WARN}\n+    logger.zookeepertrustmanager.additivity = false", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMDc4NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456100784", "bodyText": "Env Vars again", "author": "scholzj", "createdAt": "2020-07-16T21:55:30Z", "path": "install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+kind: ConfigMap\n+apiVersion: v1\n+metadata:\n+  name: strimzi-cluster-operator-logging\n+data:\n+  log4j2.properties: |\n+    name = COConfig\n+\n+    appender.console.type = Console\n+    appender.console.name = STDOUT\n+    appender.console.layout.type = PatternLayout\n+    appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n\n+\n+    rootLogger.level = ${env:STRIMZI_LOG_LEVEL:-INFO}\n+    rootLogger.appenderRefs = stdout\n+    rootLogger.appenderRef.console.ref = STDOUT\n+    rootLogger.additivity = false\n+\n+    # Kafka AdminClient logging is a bit noisy at INFO level\n+    logger.kafka.name = org.apache.kafka\n+    logger.kafka.level = ${env:STRIMZI_AC_LOG_LEVEL:-WARN}\n+    logger.kafka.additivity = false\n+\n+    # Zookeeper is very verbose even on INFO level -> We set it to WARN by default\n+    logger.zookeepertrustmanager.name = org.apache.zookeeper\n+    logger.zookeepertrustmanager.level = ${env:STRIMZI_ZOOKEEPER_LOG_LEVEL:-WARN}", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMTE5MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456101191", "bodyText": "We seem to have this file as 051. And below this a new file as 060 ... should this one be deleted?", "author": "scholzj", "createdAt": "2020-07-16T21:56:27Z", "path": "install/cluster-operator/051-Deployment-strimzi-cluster-operator.yaml", "diffHunk": "@@ -17,6 +17,10 @@ spec:\n         strimzi.io/kind: cluster-operator\n     spec:\n       serviceAccountName: strimzi-cluster-operator\n+      volumes:", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMTcyOA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456101728", "bodyText": "@Frawless Will these renamings play well with upgrade tests which use different versions?", "author": "scholzj", "createdAt": "2020-07-16T21:57:40Z", "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/operator/BundleResource.java", "diffHunk": "@@ -20,7 +20,7 @@\n public class BundleResource {\n     private static final Logger LOGGER = LogManager.getLogger(BundleResource.class);\n \n-    public static final String PATH_TO_CO_CONFIG = \"../install/cluster-operator/050-Deployment-strimzi-cluster-operator.yaml\";\n+    public static final String PATH_TO_CO_CONFIG = \"../install/cluster-operator/060-Deployment-strimzi-cluster-operator.yaml\";", "originalCommit": "23fbd5e8bee1a3e6eac0202e888b518d2367afc6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjMxNjA3Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456316072", "bodyText": "Interesting question, in upgrade tests, we change this file only for upgrade to HEAD, for older versions we basically do kubectl apply -f /tmp/upgrade-54556445/strimzi-0.x.y/install/cluster-operator and for HEAD Standa did proper changes from my POV. Let's try to run upgrade tests and we will see.", "author": "Frawless", "createdAt": "2020-07-17T09:02:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjEwMTcyOA=="}], "type": "inlineReview"}, {"oid": "4213fd675b6429c031ceeeb970bb882553aaaaca", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/4213fd675b6429c031ceeeb970bb882553aaaaca", "message": "remove redundant vars\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-07-17T09:39:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxNTM4MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456415381", "bodyText": "Why are we switching 50 to 60? Are none of the numbers between 40-50 appropriate for the new CM?", "author": "samuel-hawker", "createdAt": "2020-07-17T12:39:03Z", "path": "install/cluster-operator/060-Deployment-strimzi-cluster-operator.yaml", "diffHunk": "@@ -17,6 +17,10 @@ spec:\n         strimzi.io/kind: cluster-operator", "originalCommit": "4213fd675b6429c031ceeeb970bb882553aaaaca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxNjYzMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456416631", "bodyText": "04x are for the CRDs. The numbers are basically just an aid for listing files. We need to have ConfigMap file before Deployment. Switching Deployment to 060 makes some space to any future ConfigMap. Maybe @scholzj has more comments.", "author": "sknot-rh", "createdAt": "2020-07-17T12:41:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxNTM4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxODUwNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456418505", "bodyText": "I'd also argue 51 would also be appropriate for the CM (keeping deployment as 50) as the CM should not need to be created prior to the deployment due to the dynamic file watcher?", "author": "samuel-hawker", "createdAt": "2020-07-17T12:45:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxNTM4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMjAyNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456422027", "bodyText": "Well, we used different numbers for different types of resources so far. This really just continues.", "author": "scholzj", "createdAt": "2020-07-17T12:51:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxNTM4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMTAxOA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456421018", "bodyText": "I think we want to label this with:\n  labels:\n    app: strimzi", "author": "samuel-hawker", "createdAt": "2020-07-17T12:50:00Z", "path": "install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+kind: ConfigMap\n+apiVersion: v1\n+metadata:\n+  name: strimzi-cluster-operator-logging", "originalCommit": "4213fd675b6429c031ceeeb970bb882553aaaaca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMTQ1NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456421454", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                # Zookeeper is very verbose even on INFO level -> We set it to WARN by default\n          \n          \n            \n                # Zookeeper is very verbose on INFO level , set it to WARN by default", "author": "samuel-hawker", "createdAt": "2020-07-17T12:50:50Z", "path": "helm-charts/helm3/strimzi-kafka-operator/templates/050-ConfigMap-strimzi-cluster-operator-logging.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+kind: ConfigMap\n+apiVersion: v1\n+metadata:\n+  name: {{ .Values.logConfigMap }}\n+data:\n+  log4j2.properties: |\n+    name = COConfig\n+\n+    appender.console.type = Console\n+    appender.console.name = STDOUT\n+    appender.console.layout.type = PatternLayout\n+    appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n\n+\n+    rootLogger.level = INFO\n+    rootLogger.appenderRefs = stdout\n+    rootLogger.appenderRef.console.ref = STDOUT\n+    rootLogger.additivity = false\n+\n+    # Kafka AdminClient logging is a bit noisy at INFO level\n+    logger.kafka.name = org.apache.kafka\n+    logger.kafka.level = WARN\n+    logger.kafka.additivity = false\n+\n+    # Zookeeper is very verbose even on INFO level -> We set it to WARN by default", "originalCommit": "4213fd675b6429c031ceeeb970bb882553aaaaca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMTczOA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456421738", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                name = COConfig\n          \n          \n            \n                name = ClusterOperatorConfig\n          \n      \n    \n    \n  \n\nbrevity here seems unnecessary", "author": "samuel-hawker", "createdAt": "2020-07-17T12:51:23Z", "path": "helm-charts/helm3/strimzi-kafka-operator/templates/050-ConfigMap-strimzi-cluster-operator-logging.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+kind: ConfigMap\n+apiVersion: v1\n+metadata:\n+  name: {{ .Values.logConfigMap }}\n+data:\n+  log4j2.properties: |\n+    name = COConfig", "originalCommit": "4213fd675b6429c031ceeeb970bb882553aaaaca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMjQ2OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456422468", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            logVolume: co-logging-volume\n          \n          \n            \n            logVolume: cluster-operator-logging-volume", "author": "samuel-hawker", "createdAt": "2020-07-17T12:52:41Z", "path": "helm-charts/helm2/strimzi-kafka-operator/values.yaml", "diffHunk": "@@ -9,7 +9,8 @@ image:\n   repository: strimzi\n   name: operator\n   tag: latest\n-logLevel: INFO\n+logVolume: co-logging-volume", "originalCommit": "4213fd675b6429c031ceeeb970bb882553aaaaca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMzg5Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456423893", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          mountPath: /opt/strimzi/custom-config/\n          \n          \n            \n                          mountPath: /opt/strimzi/log-config/\n          \n      \n    \n    \n  \n\nCustom config is a strange name, I'd probably call it log-config as we are always applying it (so not necessarily custom) and it only is relevant for logs.", "author": "samuel-hawker", "createdAt": "2020-07-17T12:55:30Z", "path": "helm-charts/helm2/strimzi-kafka-operator/templates/060-Deployment-strimzi-cluster-operator.yaml", "diffHunk": "@@ -36,6 +40,9 @@ spec:\n           {{- end }}\n           args:\n             - /opt/strimzi/bin/cluster_operator_run.sh\n+          volumeMounts:\n+            - name: {{ .Values.logVolume }}\n+              mountPath: /opt/strimzi/custom-config/", "originalCommit": "4213fd675b6429c031ceeeb970bb882553aaaaca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyNzU2NA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456427564", "bodyText": "custom-config is used in other operators, so I just wanted to keep it consistent.", "author": "sknot-rh", "createdAt": "2020-07-17T13:02:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyMzg5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyNDcxNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r456424717", "bodyText": "Should we not instead always deploy the CM and pre-seed the CM with the properties from the properties file?\nEasier to predict behaviour if we don't have this if check here, I can imagine us having to suggets users restart operator pod to make the operator run through this logic again.", "author": "samuel-hawker", "createdAt": "2020-07-17T12:57:06Z", "path": "cluster-operator/scripts/cluster_operator_run.sh", "diffHunk": "@@ -1,4 +1,9 @@\n #!/usr/bin/env bash\n export JAVA_CLASSPATH=lib/io.strimzi.@project.build.finalName@.@project.packaging@:@project.dist.classpath@\n export JAVA_MAIN=io.strimzi.operator.cluster.Main\n+\n+if [ -f /opt/strimzi/custom-config/log4j2.properties ]; then\n+    # if ConfigMap was not mounted and thus this file was not created, use properties file from the classpath\n+    export JAVA_OPTS=\"${JAVA_OPTS} -Dlog4j2.configurationFile=file:/opt/strimzi/custom-config/log4j2.properties\"", "originalCommit": "4213fd675b6429c031ceeeb970bb882553aaaaca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA2ODU2MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r457068560", "bodyText": "We are deploying it always. @scholzj thinks there may be some edge cases when the CM is not deployed/mounted as a volume. In that case, we should use at least some defaults (what is done by loading log4j2.properties from classpath).", "author": "sknot-rh", "createdAt": "2020-07-20T05:37:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyNDcxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE4MDQ0MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r465180440", "bodyText": "Can we echo something to say that a static logging configuration is being used because no config was found, and therefore that dynamic log config update won't work.", "author": "tombentley", "createdAt": "2020-08-04T16:33:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQyNDcxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA3NjE5MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r457076191", "bodyText": "it was COConfig in the main one above. How are we naming the others, TOConfig? UOConfig? Even in the Helm2 templating we are using COConfig.", "author": "ppatierno", "createdAt": "2020-07-20T05:53:36Z", "path": "cluster-operator/src/test/resources/log4j2-test.properties", "diffHunk": "@@ -1,4 +1,4 @@\n-name = COConfig\n+name = ClusterOperatorConfig", "originalCommit": "0e5da89332658e457466eef5008253c21cd99c15", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA3OTIzMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r457079231", "bodyText": "Yes, the others use abbreviations.", "author": "sknot-rh", "createdAt": "2020-07-20T05:59:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA3NjE5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA3OTczNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r457079737", "bodyText": "So I would be consistent across components and between main code and tests.", "author": "ppatierno", "createdAt": "2020-07-20T06:00:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA3NjE5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI5OTQ3Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r459299477", "bodyText": "I think that the change here is more significant and deserves some more detailed explanation. You do not just make it dynamically changeable. You change the way it is configured.", "author": "scholzj", "createdAt": "2020-07-23T08:43:26Z", "path": "CHANGELOG.md", "diffHunk": "@@ -21,7 +21,7 @@\n * Strimzi Kafka Bridge metrics integration:\n   * enable/disable metrics in the KafkaBridge custom resource\n   * new Grafana dashboard for the bridge metrics\n-* Support dynamically changeable logging in the Entity Operator and Kafka Bridge \n+* Support dynamically changeable logging in the Entity Operator, Kafka Bridge and Cluster Operator", "originalCommit": "fedfb219bc4abab8a52ebaa0dcd2b6dae3925115", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTU1NjE3OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r459556179", "bodyText": "@PaulRMellor @laidan6000\nCould you please check these changes?", "author": "sknot-rh", "createdAt": "2020-07-23T15:56:37Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration", "originalCommit": "513d92043245194a577bffb4158f2ddaf7c20257", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5MTAwMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461391002", "bodyText": "@stanlyDoge \ud83d\udc4d", "author": "PaulRMellor", "createdAt": "2020-07-28T07:58:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTU1NjE3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyMDI2Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r459620263", "bodyText": "Thsi would sound better to me personally at least.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Together with Cluster Operator, `ConfigMap` containing its logging configuration is created.\n          \n          \n            \n            When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.", "author": "scholzj", "createdAt": "2020-07-23T17:43:05Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+Together with Cluster Operator, `ConfigMap` containing its logging configuration is created.", "originalCommit": "513d92043245194a577bffb4158f2ddaf7c20257", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyMDk1Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r459620957", "bodyText": "Maybe better this way?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            After `ConfigMap` recreation, the new configuration is loaded.\n          \n          \n            \n            After recreating the `ConfigMap`, the new configuration is loaded.", "author": "scholzj", "createdAt": "2020-07-23T17:44:19Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+Together with Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n+\n+NOTE: Created `ConfigMap` contains entry `monitorInterval`.\n+Please ensure yourself you are not removing this entry as it serves for dynamic reloading of logging configuration.\n+Entry `monitorInterval` configures frequency of logging reloading in the seconds (see link:https://logging.apache.org/log4j/2.x/manual/configuration.html#Automatic_Reconfiguration[Log4j2 Automatic Reconfiguration^]).\n+\n+If the `ConfigMap` is not present during deploying of Cluster Operator, default logging values are used.\n+\n+If the `ConfigMap` is deleted by an accident after the Cluster Operator was deployed, the last loaded configuration is used.\n+After `ConfigMap` recreation, the new configuration is loaded.", "originalCommit": "513d92043245194a577bffb4158f2ddaf7c20257", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc0NzQ3OQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r459747479", "bodyText": "FYI: Looks like this will not get into 0.19.0, so you might need to move this to 0.20.0.", "author": "scholzj", "createdAt": "2020-07-23T21:49:10Z", "path": "CHANGELOG.md", "diffHunk": "@@ -22,6 +22,7 @@\n   * enable/disable metrics in the KafkaBridge custom resource\n   * new Grafana dashboard for the bridge metrics\n * Support dynamically changeable logging in the Entity Operator and Kafka Bridge \n+* Configure Cluster Operator logging using ConfigMap instead of environment variable and support dynamic changes", "originalCommit": "513d92043245194a577bffb4158f2ddaf7c20257", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA2MTkwMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r465061901", "bodyText": "@stanlyDoge I still see this here in 0.19.0, should you remove it as asked by Jakub?", "author": "ppatierno", "createdAt": "2020-08-04T13:47:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTc0NzQ3OQ=="}], "type": "inlineReview"}, {"oid": "a1838312e119818e20fdcb311810ba801b1d91c2", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a1838312e119818e20fdcb311810ba801b1d91c2", "message": "rebase + move to 0.20.0\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-07-24T06:00:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDY5MDc2OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460690768", "bodyText": "we are using \"COConfig\" everywhere right now, why changing in the test?", "author": "ppatierno", "createdAt": "2020-07-27T07:16:48Z", "path": "systemtest/src/test/java/io/strimzi/systemtest/log/LoggingChangeST.java", "diffHunk": "@@ -81,7 +81,7 @@ void testJSONFormatLogging() {\n             \"zookeeper.root.logger=INFO\\n\" +\n             \"log4j.rootLogger=${zookeeper.root.logger}, CONSOLE\";\n \n-        String loggersConfigCO = \"name = COConfig\\n\" +\n+        String loggersConfigCO = \"name = ClusterOperatorConfig\\n\" +", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc2NzkzNg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460767936", "bodyText": "Mention the new section in line 8:\n\"The Cluster Operator can be configured through the following supported environment variables and through the logging configuration. \"", "author": "laidan6000", "createdAt": "2020-07-27T09:36:55Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc2ODA3MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460768071", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            == Logging configuration\n          \n          \n            \n            [discrete]\n          \n          \n            \n            == Logging configuration", "author": "laidan6000", "createdAt": "2020-07-27T09:37:11Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc2OTE3Nw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460769177", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n          \n          \n            \n            A `ConfigMap` containing logging configuration is created when installing the Cluster Operator.", "author": "laidan6000", "createdAt": "2020-07-27T09:39:09Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc3NDA3MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460774071", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Cluster Operator logging is then configured by changing this `ConfigMap`.\n          \n          \n            \n            You configure Cluster Operator logging by changing the `ConfigMap`.", "author": "laidan6000", "createdAt": "2020-07-27T09:47:45Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc3NjQyMA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460776420", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            You can change the file and then use:\n          \n          \n            \n            To update the logging configuration, you can edit the `050-ConfigMap-strimzi-cluster-operator-logging.yaml` file and then run the following command:", "author": "laidan6000", "createdAt": "2020-07-27T09:51:50Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc3NjgwMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460776803", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Or you can edit the `ConfigMap` by:\n          \n          \n            \n            Alternatively, edit the `ConfigMap` directly:", "author": "laidan6000", "createdAt": "2020-07-27T09:52:30Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc4MTk2Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460781966", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n          \n          \n            \n            After the `ConfigMap` is changed, the logging configuration of the Cluster Operator is reloaded at the next interval.", "author": "laidan6000", "createdAt": "2020-07-27T10:01:38Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc4Mjk4OA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460782988", "bodyText": "To change the frequency of the reload interval, set a time in seconds in the monitorInterval option in the created ConfigMap.", "author": "laidan6000", "createdAt": "2020-07-27T10:03:32Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n+", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc4NjI4NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460786285", "bodyText": "Avoid including key information in notes. Please edit this note as follows:\nNOTE: Do not remove the monitorInterval option from the ConfigMap.\nQ: Is it essential to link to the Log4j2 documentation?", "author": "laidan6000", "createdAt": "2020-07-27T10:09:44Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n+\n+NOTE: Created `ConfigMap` contains entry `monitorInterval`.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgyMDk2Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460820963", "bodyText": "Also, I suggest moving the note to the end of this section, i.e. line 145.", "author": "laidan6000", "createdAt": "2020-07-27T11:21:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDc4NjI4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgyMDYzNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460820634", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If the `ConfigMap` is not present during deploying of Cluster Operator, default logging values are used.\n          \n          \n            \n            If the `ConfigMap` is missing when the Cluster Operator is deployed, the default logging values are used.", "author": "laidan6000", "createdAt": "2020-07-27T11:20:45Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n+\n+NOTE: Created `ConfigMap` contains entry `monitorInterval`.\n+Please ensure yourself you are not removing this entry as it serves for dynamic reloading of logging configuration.\n+Entry `monitorInterval` configures frequency of logging reloading in the seconds (see link:https://logging.apache.org/log4j/2.x/manual/configuration.html#Automatic_Reconfiguration[Log4j2 Automatic Reconfiguration^]).\n+\n+If the `ConfigMap` is not present during deploying of Cluster Operator, default logging values are used.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgyMTk5MQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460821991", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If the `ConfigMap` is deleted by an accident after the Cluster Operator was deployed, the last loaded configuration is used.\n          \n          \n            \n            If the `ConfigMap` is accidentally deleted after the Cluster Operator is deployed, the most recently loaded logging configuration is used.", "author": "laidan6000", "createdAt": "2020-07-27T11:23:10Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n+\n+NOTE: Created `ConfigMap` contains entry `monitorInterval`.\n+Please ensure yourself you are not removing this entry as it serves for dynamic reloading of logging configuration.\n+Entry `monitorInterval` configures frequency of logging reloading in the seconds (see link:https://logging.apache.org/log4j/2.x/manual/configuration.html#Automatic_Reconfiguration[Log4j2 Automatic Reconfiguration^]).\n+\n+If the `ConfigMap` is not present during deploying of Cluster Operator, default logging values are used.\n+\n+If the `ConfigMap` is deleted by an accident after the Cluster Operator was deployed, the last loaded configuration is used.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDgyMjM3Mg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r460822372", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            After recreating the `ConfigMap`, the new configuration is loaded.\n          \n          \n            \n            Create a new `ConfigMap` to load a new logging configuration.", "author": "laidan6000", "createdAt": "2020-07-27T11:24:04Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n+\n+NOTE: Created `ConfigMap` contains entry `monitorInterval`.\n+Please ensure yourself you are not removing this entry as it serves for dynamic reloading of logging configuration.\n+Entry `monitorInterval` configures frequency of logging reloading in the seconds (see link:https://logging.apache.org/log4j/2.x/manual/configuration.html#Automatic_Reconfiguration[Log4j2 Automatic Reconfiguration^]).\n+\n+If the `ConfigMap` is not present during deploying of Cluster Operator, default logging values are used.\n+\n+If the `ConfigMap` is deleted by an accident after the Cluster Operator was deployed, the last loaded configuration is used.\n+After recreating the `ConfigMap`, the new configuration is loaded.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4NzE4Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461387186", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            4. In order to use the newly built images, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command:\n          \n          \n            \n            4. To use the newly built images, update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images:", "author": "PaulRMellor", "createdAt": "2020-07-28T07:51:27Z", "path": "development-docs/DEV_GUIDE.md", "diffHunk": "@@ -47,15 +47,15 @@ To build Strimzi from source the operator and Kafka code needs to be compiled in\n         make clean\n         make MVN_ARGS='-DskipTests -DskipIT' all\n \n-4. In order to use the newly built images, you need to update the `install/cluster-operator/050-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command:\n+4. In order to use the newly built images, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command:", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4ODA2MA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461388060", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               This will update `060-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name but with the repository changed.\n          \n          \n            \n               This updates `060-Deployment-strimzi-cluster-operator.yaml`, replacing all the image references (in `image` and `value` properties) with ones with the same name but with the repository changed.", "author": "PaulRMellor", "createdAt": "2020-07-28T07:52:57Z", "path": "development-docs/DEV_GUIDE.md", "diffHunk": "@@ -47,15 +47,15 @@ To build Strimzi from source the operator and Kafka code needs to be compiled in\n         make clean\n         make MVN_ARGS='-DskipTests -DskipIT' all\n \n-4. In order to use the newly built images, you need to update the `install/cluster-operator/050-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command:\n+4. In order to use the newly built images, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command:\n \n     ```\n     sed -Ei -e \"s#(image|value): strimzi/([a-z0-9-]+):latest#\\1: $DOCKER_ORG/\\2:latest#\" \\\n             -e \"s#([0-9.]+)=strimzi/([a-zA-Z0-9-]+:[a-zA-Z0-9.-]+-kafka-[0-9.]+)#\\1=$DOCKER_ORG/\\2#\" \\\n-            install/cluster-operator/050-Deployment-strimzi-cluster-operator.yaml\n+            install/cluster-operator/060-Deployment-strimzi-cluster-operator.yaml\n     ```\n \n-   This will update `050-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name but with the repository changed.\n+   This will update `060-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name but with the repository changed.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4OTA4Ng==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461389086", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In order to use these newly built images, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command and replacing `docker_hub_username` with the relevant value:\n          \n          \n            \n            To use these newly built images, update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images, replacing `docker_hub_username` with the relevant value:", "author": "PaulRMellor", "createdAt": "2020-07-28T07:54:44Z", "path": "development-docs/DEV_GUIDE.md", "diffHunk": "@@ -232,15 +232,15 @@ By default the `docker_push` target will build the images under the strimzi orga\n \n When the Docker images are build, they will be labeled in the form: `docker_hub_username/operator:latest` in your local repository and pushed to your Docker Hub account under the same label.\n \n-In order to use these newly built images, you need to update the `install/cluster-operator/050-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command and replacing `docker_hub_username` with the relevant value:\n+In order to use these newly built images, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command and replacing `docker_hub_username` with the relevant value:", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4OTM5Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461389393", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            This will update `060-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name but with the repository changed.\n          \n          \n            \n            This updates `060-Deployment-strimzi-cluster-operator.yaml`, replacing all the image references (in `image` and `value` properties) with ones with the same name but with the repository changed.", "author": "PaulRMellor", "createdAt": "2020-07-28T07:55:14Z", "path": "development-docs/DEV_GUIDE.md", "diffHunk": "@@ -232,15 +232,15 @@ By default the `docker_push` target will build the images under the strimzi orga\n \n When the Docker images are build, they will be labeled in the form: `docker_hub_username/operator:latest` in your local repository and pushed to your Docker Hub account under the same label.\n \n-In order to use these newly built images, you need to update the `install/cluster-operator/050-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command and replacing `docker_hub_username` with the relevant value:\n+In order to use these newly built images, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from your repositories on Docker Hub rather than the official Strimzi images. That can be done using the following command and replacing `docker_hub_username` with the relevant value:\n \n ```\n sed -Ei -e 's#(image|value): strimzi/([a-z0-9-]+):latest#\\1: docker_hub_username/\\2:latest#' \\\n         -e 's#([0-9.]+)=strimzi/([a-zA-Z0-9-]+:[a-zA-Z0-9.-]+-kafka-[0-9.]+)#\\1=docker_hub_username/\\2#' \\\n-        install/cluster-operator/050-Deployment-strimzi-cluster-operator.yaml\n+        install/cluster-operator/060-Deployment-strimzi-cluster-operator.yaml\n ```\n \n-This will update `050-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name but with the repository changed.\n+This will update `060-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name but with the repository changed.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4OTcyNw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461389727", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            5. In order to use the built images in a deployment, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from the registry at `172.30.1.1:5000`, rather than from DockerHub. That can be done using the following command:\n          \n          \n            \n            5. To use the built images in a deployment, update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from the registry at `172.30.1.1:5000`, rather than from DockerHub:", "author": "PaulRMellor", "createdAt": "2020-07-28T07:55:49Z", "path": "development-docs/DEV_GUIDE.md", "diffHunk": "@@ -279,15 +279,15 @@ Assuming your OpenShift login is `developer` (a user with the `cluster-admin` ro\n \n         DOCKER_REGISTRY=172.30.1.1:5000 DOCKER_ORG=$(oc project -q) make docker_push\n         \n-5. In order to use the built images in a deployment, you need to update the `install/cluster-operator/050-Deployment-strimzi-cluster-operator.yml` to obtain the images from the registry at `172.30.1.1:5000`, rather than from DockerHub. That can be done using the following command:\n+5. In order to use the built images in a deployment, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from the registry at `172.30.1.1:5000`, rather than from DockerHub. That can be done using the following command:", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5MDYxNA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461390614", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                This will update `060-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name from `172.30.1.1:5000/myproject`.\n          \n          \n            \n                This updates `060-Deployment-strimzi-cluster-operator.yaml`, replacing all the image references (in `image` and `value` properties) with ones with the same name from `172.30.1.1:5000/myproject`.", "author": "PaulRMellor", "createdAt": "2020-07-28T07:57:27Z", "path": "development-docs/DEV_GUIDE.md", "diffHunk": "@@ -279,15 +279,15 @@ Assuming your OpenShift login is `developer` (a user with the `cluster-admin` ro\n \n         DOCKER_REGISTRY=172.30.1.1:5000 DOCKER_ORG=$(oc project -q) make docker_push\n         \n-5. In order to use the built images in a deployment, you need to update the `install/cluster-operator/050-Deployment-strimzi-cluster-operator.yml` to obtain the images from the registry at `172.30.1.1:5000`, rather than from DockerHub. That can be done using the following command:\n+5. In order to use the built images in a deployment, you need to update the `install/cluster-operator/060-Deployment-strimzi-cluster-operator.yml` to obtain the images from the registry at `172.30.1.1:5000`, rather than from DockerHub. That can be done using the following command:\n \n     ```\n     sed -Ei -e 's#(image|value): strimzi/([a-z0-9-]+):latest#\\1: 172.30.1.1:5000/myproject/\\2:latest#' \\\n             -e 's#([0-9.]+)=strimzi/([a-zA-Z0-9-]+:[a-zA-Z0-9.-]+-kafka-[0-9.]+)#\\1=172.30.1.1:5000/myproject/\\2#' \\\n-            install/cluster-operator/050-Deployment-strimzi-cluster-operator.yaml\n+            install/cluster-operator/060-Deployment-strimzi-cluster-operator.yaml\n     ```\n \n-    This will update `050-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name from `172.30.1.1:5000/myproject`.\n+    This will update `060-Deployment-strimzi-cluster-operator.yaml` replacing all the image references (in `image` and `value` properties) with ones with the same name from `172.30.1.1:5000/myproject`.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5MjEwNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461392105", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Please ensure yourself you are not removing this entry as it serves for dynamic reloading of logging configuration.\n          \n          \n            \n            Check you are not removing this entry as it serves for dynamic reloading of logging configuration.", "author": "PaulRMellor", "createdAt": "2020-07-28T08:00:02Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n+\n+NOTE: Created `ConfigMap` contains entry `monitorInterval`.\n+Please ensure yourself you are not removing this entry as it serves for dynamic reloading of logging configuration.", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYyNjYyMg==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r463626622", "bodyText": "Removed in #3328 (comment)", "author": "sknot-rh", "createdAt": "2020-07-31T13:56:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5MjEwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5MzIyMw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r461393223", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Entry `monitorInterval` configures frequency of logging reloading in the seconds (see link:https://logging.apache.org/log4j/2.x/manual/configuration.html#Automatic_Reconfiguration[Log4j2 Automatic Reconfiguration^]).\n          \n          \n            \n            Use `monitorInterval` to configure the frequency of logging reloads in seconds (see link:https://logging.apache.org/log4j/2.x/manual/configuration.html#Automatic_Reconfiguration[Log4j2 Automatic Reconfiguration^]).", "author": "PaulRMellor", "createdAt": "2020-07-28T08:01:59Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,31 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+== Logging configuration\n+\n+When installing Cluster Operator, `ConfigMap` containing its logging configuration is created.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+Cluster Operator logging is then configured by changing this `ConfigMap`.\n+\n+You can change the file and then use:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml_\n+\n+Or you can edit the `ConfigMap` by:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator-logging\n+\n+After the changes are done in the `ConfigMap`, the logging configuration is reloaded in time interval of specified `monitorInterval` seconds.\n+\n+NOTE: Created `ConfigMap` contains entry `monitorInterval`.\n+Please ensure yourself you are not removing this entry as it serves for dynamic reloading of logging configuration.\n+Entry `monitorInterval` configures frequency of logging reloading in the seconds (see link:https://logging.apache.org/log4j/2.x/manual/configuration.html#Automatic_Reconfiguration[Log4j2 Automatic Reconfiguration^]).", "originalCommit": "a1838312e119818e20fdcb311810ba801b1d91c2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYyNjcyMQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r463626721", "bodyText": "Removed in #3328 (comment)", "author": "sknot-rh", "createdAt": "2020-07-31T13:56:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM5MzIyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg1MjkzOQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r464852939", "bodyText": "I would avoid using \"logging\" in the name tbh. We don't know if at some point we will need to add more into this ConfigMap and having \"logging\" in the name could be misleading. Wdyt?", "author": "ppatierno", "createdAt": "2020-08-04T07:26:33Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,30 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+[discrete]\n+== Logging configuration\n+\n+A `ConfigMap` containing logging configuration is created when installing the Cluster Operator.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.", "originalCommit": "f3c5fc3b835ec2aaa73453cc750cca5cbe79651e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDg1MzYwMA==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r464853600", "bodyText": "I think you should mention that the logging configuration is in the log4j2.properties data field.\nIf in the future we will use the ConfigMap for something more, we will have more data fields.", "author": "ppatierno", "createdAt": "2020-08-04T07:27:55Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,30 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+[discrete]\n+== Logging configuration\n+\n+A `ConfigMap` containing logging configuration is created when installing the Cluster Operator.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator-logging.yaml`.\n+You configure Cluster Operator logging by changing the `ConfigMap`.\n+\n+To update the logging configuration, you can edit the `050-ConfigMap-strimzi-cluster-operator-logging.yaml` file and then run the following command:", "originalCommit": "f3c5fc3b835ec2aaa73453cc750cca5cbe79651e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4070c2753167d7349a1a42e59e09cac30e77794f", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/4070c2753167d7349a1a42e59e09cac30e77794f", "message": "co dyn log\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "71d17415978e1007399fa8865f5d25cd0055bf89", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/71d17415978e1007399fa8865f5d25cd0055bf89", "message": "rename files\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "ba67fbeb656bad5d786f6c39325756629a800db3", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ba67fbeb656bad5d786f6c39325756629a800db3", "message": "delete file\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "29b5ef6f7370f8adef14855b9382a57a1389a781", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/29b5ef6f7370f8adef14855b9382a57a1389a781", "message": "default conf\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "4a93f45dcbfd710a7c4c842ab55dfe0c82ec5a5d", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/4a93f45dcbfd710a7c4c842ab55dfe0c82ec5a5d", "message": "commit\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "c73aa664e01dd03df932074bc04658a87dca0cf9", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c73aa664e01dd03df932074bc04658a87dca0cf9", "message": "remove redundant vars\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "e56fb577c30fb9be52dbee01ea06d05b67d61f7b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e56fb577c30fb9be52dbee01ea06d05b67d61f7b", "message": "Sam's comments\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "7ecf87873ae4f5a587478b1eafd846beba83196e", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7ecf87873ae4f5a587478b1eafd846beba83196e", "message": "consistency\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "7e8be1178c3aead909d73c7efb23f16013fd4088", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7e8be1178c3aead909d73c7efb23f16013fd4088", "message": "comment\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "ad7cdfaedb6d8843c13b539d66ca22a69d4eca68", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ad7cdfaedb6d8843c13b539d66ca22a69d4eca68", "message": "docu\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "c24a8d653e63005c83d72f8075d8325065052640", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c24a8d653e63005c83d72f8075d8325065052640", "message": "docomments\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:46:31Z", "type": "commit"}, {"oid": "eff4bd226a87e72942e81c70c6755e11e1dc3dd7", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/eff4bd226a87e72942e81c70c6755e11e1dc3dd7", "message": "rebase + move to 0.20.0\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:47:56Z", "type": "commit"}, {"oid": "276ae0a6646a8b43aa5b1267dadd26f7a6cc49bb", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/276ae0a6646a8b43aa5b1267dadd26f7a6cc49bb", "message": "addressing comments\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:47:56Z", "type": "commit"}, {"oid": "961c6745dcacba123e0e3b2f4eed3ab4214ba0b9", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/961c6745dcacba123e0e3b2f4eed3ab4214ba0b9", "message": "avoid logging\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:58:32Z", "type": "commit"}, {"oid": "961c6745dcacba123e0e3b2f4eed3ab4214ba0b9", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/961c6745dcacba123e0e3b2f4eed3ab4214ba0b9", "message": "avoid logging\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T07:58:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA0NjY1NQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r465046655", "bodyText": "even in this case the volume could be about co-configuration not just logging?", "author": "ppatierno", "createdAt": "2020-08-04T13:23:51Z", "path": "install/cluster-operator/060-Deployment-strimzi-cluster-operator.yaml", "diffHunk": "@@ -17,6 +17,10 @@ spec:\n         strimzi.io/kind: cluster-operator\n     spec:\n       serviceAccountName: strimzi-cluster-operator\n+      volumes:\n+        - name: co-logging-volume", "originalCommit": "961c6745dcacba123e0e3b2f4eed3ab4214ba0b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTA1NTYxNQ==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r465055615", "bodyText": "should be co-config-volume as for the Helm 3 values YAML.", "author": "ppatierno", "createdAt": "2020-08-04T13:37:39Z", "path": "helm-charts/helm2/strimzi-kafka-operator/values.yaml", "diffHunk": "@@ -9,7 +9,8 @@ image:\n   repository: strimzi\n   name: operator\n   tag: latest\n-logLevel: INFO\n+logVolume: cluster-operator-logging-volume", "originalCommit": "1eddc72cdf4422a17d7726f3564f7c499b9e6ccd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b40f901bb9de8c243b70306d2a3da86ff4cc2564", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b40f901bb9de8c243b70306d2a3da86ff4cc2564", "message": "another comment\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T13:41:28Z", "type": "forcePushed"}, {"oid": "a89fc7e29252b19084016f67c7f54037f92bd97b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a89fc7e29252b19084016f67c7f54037f92bd97b", "message": "another comment\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T13:52:21Z", "type": "commit"}, {"oid": "a89fc7e29252b19084016f67c7f54037f92bd97b", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a89fc7e29252b19084016f67c7f54037f92bd97b", "message": "another comment\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-04T13:52:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE4MTc3Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r465181773", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Currently only Cluster Operator logging can be configured by ConfigMap.\n          \n          \n            \n            The Cluster Operator's logging is configured by the XXX_CM_name_XXX ConfigMap.", "author": "tombentley", "createdAt": "2020-08-04T16:35:45Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,32 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+[discrete]\n+== Configuration by ConfigMap\n+\n+Currently only Cluster Operator logging can be configured by ConfigMap.", "originalCommit": "a89fc7e29252b19084016f67c7f54037f92bd97b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE4MjE2Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r465182163", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To change the frequency of the reload interval, set a time in seconds in the monitorInterval option in the created ConfigMap.\n          \n          \n            \n            To change the frequency of the reload interval, set a time in seconds in the `monitorInterval` option in the created `ConfigMap`.", "author": "tombentley", "createdAt": "2020-08-04T16:36:22Z", "path": "documentation/modules/ref-operator-cluster.adoc", "diffHunk": "@@ -121,6 +118,32 @@ The DNS domain name is added to the Kafka broker certificates used for hostname\n +\n If you are using a different DNS domain name suffix in your cluster, change the `KUBERNETES_SERVICE_DNS_DOMAIN` environment variable from the default to the one you are using in order to establish a connection with the Kafka brokers.\n \n+[discrete]\n+== Configuration by ConfigMap\n+\n+Currently only Cluster Operator logging can be configured by ConfigMap.\n+\n+A `ConfigMap` containing logging configuration is created when installing the Cluster Operator.\n+This `ConfigMap` is described in the file `install/cluster-operator/050-ConfigMap-strimzi-cluster-operator.yaml`.\n+You configure Cluster Operator logging by changing the data field `log4j2.properties` in this `ConfigMap`.\n+\n+To update the logging configuration, you can edit the `050-ConfigMap-strimzi-cluster-operator.yaml` file and then run the following command:\n+[source,shell,subs=+quotes]\n+kubectl apply -f _install/cluster-operator/050-ConfigMap-strimzi-cluster-operator.yaml_\n+\n+Alternatively, edit the `ConfigMap` directly:\n+[source,shell,subs=+quotes]\n+kubectl edit cm strimzi-cluster-operator\n+\n+To change the frequency of the reload interval, set a time in seconds in the monitorInterval option in the created ConfigMap.", "originalCommit": "a89fc7e29252b19084016f67c7f54037f92bd97b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE4Nzg2Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r465187863", "bodyText": "I feel this would be better after name", "author": "tombentley", "createdAt": "2020-08-04T16:45:56Z", "path": "helm-charts/helm2/strimzi-kafka-operator/templates/050-ConfigMap-strimzi-cluster-operator.yaml", "diffHunk": "@@ -0,0 +1,28 @@\n+kind: ConfigMap\n+apiVersion: v1\n+metadata:\n+  name: {{ .Values.logConfigMap }}\n+data:\n+  log4j2.properties: |\n+    name = COConfig\n+\n+    appender.console.type = Console\n+    appender.console.name = STDOUT\n+    appender.console.layout.type = PatternLayout\n+    appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n\n+\n+    rootLogger.level = INFO\n+    rootLogger.appenderRefs = stdout\n+    rootLogger.appenderRef.console.ref = STDOUT\n+    rootLogger.additivity = false\n+\n+    # Kafka AdminClient logging is a bit noisy at INFO level\n+    logger.kafka.name = org.apache.kafka\n+    logger.kafka.level = WARN\n+    logger.kafka.additivity = false\n+\n+    # Zookeeper is very verbose even on INFO level -> We set it to WARN by default\n+    logger.zookeepertrustmanager.name = org.apache.zookeeper\n+    logger.zookeepertrustmanager.level = WARN\n+    logger.zookeepertrustmanager.additivity = false\n+    monitorInterval = 30", "originalCommit": "a89fc7e29252b19084016f67c7f54037f92bd97b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "69f6a4f219451c82b7bc26a7925ed3225d03edd1", "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/69f6a4f219451c82b7bc26a7925ed3225d03edd1", "message": "Tom's comments\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>", "committedDate": "2020-08-05T06:42:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjkyNDk2Mw==", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3328#discussion_r466924963", "bodyText": "@laidan6000 Can you please review this message?", "author": "sknot-rh", "createdAt": "2020-08-07T09:20:21Z", "path": "cluster-operator/scripts/cluster_operator_run.sh", "diffHunk": "@@ -1,4 +1,11 @@\n #!/usr/bin/env bash\n export JAVA_CLASSPATH=lib/io.strimzi.@project.build.finalName@.@project.packaging@:@project.dist.classpath@\n export JAVA_MAIN=io.strimzi.operator.cluster.Main\n+\n+if [ -f /opt/strimzi/custom-config/log4j2.properties ]; then\n+    # if ConfigMap was not mounted and thus this file was not created, use properties file from the classpath\n+    export JAVA_OPTS=\"${JAVA_OPTS} -Dlog4j2.configurationFile=file:/opt/strimzi/custom-config/log4j2.properties\"\n+else\n+    echo \"Configuration file log4j2.properties not found. Using default static logging setting. Dynamic updates of logging configuration will not work.\"", "originalCommit": "69f6a4f219451c82b7bc26a7925ed3225d03edd1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}