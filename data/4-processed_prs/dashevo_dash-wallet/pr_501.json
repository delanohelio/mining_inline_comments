{"pr_number": 501, "pr_title": "NMA-407 - Scan QR Code | Strangers", "pr_createdAt": "2020-09-02T01:29:08Z", "pr_url": "https://github.com/dashevo/dash-wallet/pull/501", "timeline": [{"oid": "0698f10691401a2f64d22286107d2ef518ee5775", "url": "https://github.com/dashevo/dash-wallet/commit/0698f10691401a2f64d22286107d2ef518ee5775", "message": "Removing wallet fragment before recreating activity", "committedDate": "2020-07-29T03:29:45Z", "type": "commit"}, {"oid": "6f0887126c03331e63c5729290419fcbb5575141", "url": "https://github.com/dashevo/dash-wallet/commit/6f0887126c03331e63c5729290419fcbb5575141", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop", "committedDate": "2020-07-30T13:41:11Z", "type": "commit"}, {"oid": "6bbb7598abab4ffc34bd3c578cda2496b50c0421", "url": "https://github.com/dashevo/dash-wallet/commit/6bbb7598abab4ffc34bd3c578cda2496b50c0421", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop", "committedDate": "2020-08-05T17:08:30Z", "type": "commit"}, {"oid": "42c99c400b9faed66507cd112361e0eb460cd554", "url": "https://github.com/dashevo/dash-wallet/commit/42c99c400b9faed66507cd112361e0eb460cd554", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop", "committedDate": "2020-08-06T18:55:08Z", "type": "commit"}, {"oid": "af16683d92f479f92f64fa02ef78592c37abbd44", "url": "https://github.com/dashevo/dash-wallet/commit/af16683d92f479f92f64fa02ef78592c37abbd44", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop", "committedDate": "2020-08-18T00:28:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2NTQ2MQ==", "url": "https://github.com/dashevo/dash-wallet/pull/501#discussion_r482165461", "bodyText": "This should be a liveData similar to searchUsernames/searchUsernamesLiveData.\nIf a user scans one user's QR code follows by a second QR code that results in an error, then once the payment completes, the first user's profile page will be displayed.", "author": "HashEngineering", "createdAt": "2020-09-02T15:32:06Z", "path": "wallet/src/de/schildbach/wallet/ui/dashpay/DashPayViewModel.kt", "diffHunk": "@@ -96,6 +96,16 @@ class DashPayViewModel(application: Application) : AndroidViewModel(application)\n         userSearchLiveData.value = text\n     }\n \n+    fun loadUser(username: String) {\n+        getUserLiveData.value = username\n+        viewModelScope.launch(Dispatchers.IO) {\n+            val result = platformRepo.searchUsernames(username, true)\n+            if (result.exception == null && result.data != null && result.data.isNotEmpty()) {\n+                platformRepo.lastLoadedUser = result.data.first()\n+            }\n+        }\n+    }\n+", "originalCommit": "821007f27568c7c560626e2ca4140f2dfe1429ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2NTc4NQ==", "url": "https://github.com/dashevo/dash-wallet/pull/501#discussion_r482165785", "bodyText": "great idea.", "author": "HashEngineering", "createdAt": "2020-09-02T15:32:36Z", "path": "wallet/src/de/schildbach/wallet/ui/dashpay/PlatformRepo.kt", "diffHunk": "@@ -164,13 +166,17 @@ class PlatformRepo private constructor(val walletApplication: WalletApplication)\n         }\n     }\n \n+    suspend fun getUser(username: String): Resource<List<UsernameSearchResult>> {\n+        return searchUsernames(username, true)\n+    }\n+\n     /**\n      * gets all the name documents for usernames starting with text\n      *\n      * @param text The beginning of a username to search for\n      * @return\n      */\n-    suspend fun searchUsernames(text: String): Resource<List<UsernameSearchResult>> {\n+    suspend fun searchUsernames(text: String, onlyExactUsername: Boolean = false): Resource<List<UsernameSearchResult>> {", "originalCommit": "821007f27568c7c560626e2ca4140f2dfe1429ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2NzIwMw==", "url": "https://github.com/dashevo/dash-wallet/pull/501#discussion_r482167203", "bodyText": "lastLoadedUser should come from observing liveData. https://github.com/dashevo/dash-wallet/pull/501/files#r482165461", "author": "HashEngineering", "createdAt": "2020-09-02T15:34:36Z", "path": "wallet/src/de/schildbach/wallet/ui/TransactionResultActivity.kt", "diffHunk": "@@ -164,6 +172,15 @@ class TransactionResultActivity : AbstractWalletActivity() {\n         dashPayViewModel = ViewModelProvider(this).get(DashPayViewModel::class.java)\n     }\n \n+    override fun finish() {\n+        val dashPayUsername = intent.extras?.getString(EXTRA_DASHPAY_USERNAME)\n+        val lastLoadedUser = PlatformRepo.getInstance().lastLoadedUser", "originalCommit": "821007f27568c7c560626e2ca4140f2dfe1429ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM3NzQ1MA==", "url": "https://github.com/dashevo/dash-wallet/pull/501#discussion_r483377450", "bodyText": "In my Story for paying pending contacts (and also Contacts) from a QR code, I will need an observer.  Maybe you don't need to change this to use an observer, since I will be doing it.", "author": "HashEngineering", "createdAt": "2020-09-04T04:22:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2NzIwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM5MzMzMw==", "url": "https://github.com/dashevo/dash-wallet/pull/501#discussion_r483393333", "bodyText": "Nevermind, my liveData doesn't work for your case because my liveData is from the local database, but stranger data comes from Platform.", "author": "HashEngineering", "createdAt": "2020-09-04T05:22:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE2NzIwMw=="}], "type": "inlineReview"}, {"oid": "4dde9e07014e2e918d2f7efbb9b0fc71207c5778", "url": "https://github.com/dashevo/dash-wallet/commit/4dde9e07014e2e918d2f7efbb9b0fc71207c5778", "message": "Merge remote-tracking branch 'upstream/evonet-develop' into evonet-develop", "committedDate": "2020-09-08T01:25:25Z", "type": "commit"}, {"oid": "3622f6c519060a3c379ef8bd9405c2f604b99c6e", "url": "https://github.com/dashevo/dash-wallet/commit/3622f6c519060a3c379ef8bd9405c2f604b99c6e", "message": "Added contact suggestion layout", "committedDate": "2020-09-08T01:34:04Z", "type": "commit"}, {"oid": "72126ed8b7b6827f2f26be53dd3539b2be033b12", "url": "https://github.com/dashevo/dash-wallet/commit/72126ed8b7b6827f2f26be53dd3539b2be033b12", "message": "Showing User activity after paying to qr with username", "committedDate": "2020-09-08T01:34:04Z", "type": "commit"}, {"oid": "c174a3e3f729060862b2a5606bf827cbfbf3aaf8", "url": "https://github.com/dashevo/dash-wallet/commit/c174a3e3f729060862b2a5606bf827cbfbf3aaf8", "message": "Showing disclaimer when paying to non-contact", "committedDate": "2020-09-08T01:34:05Z", "type": "commit"}, {"oid": "8ff3db55c2958bd9a7344cc9bfd254de7c14ffa8", "url": "https://github.com/dashevo/dash-wallet/commit/8ff3db55c2958bd9a7344cc9bfd254de7c14ffa8", "message": "Layout adjustments", "committedDate": "2020-09-08T01:34:05Z", "type": "commit"}, {"oid": "761a51dc9f9b4000883724ffcf0587a18acc5459", "url": "https://github.com/dashevo/dash-wallet/commit/761a51dc9f9b4000883724ffcf0587a18acc5459", "message": "Notifications livedata trigger and layout fix", "committedDate": "2020-09-08T01:34:05Z", "type": "commit"}, {"oid": "3496ae9c2366e14bbeb17c076f8068288946a992", "url": "https://github.com/dashevo/dash-wallet/commit/3496ae9c2366e14bbeb17c076f8068288946a992", "message": "organize imports on PaymentIntent.java", "committedDate": "2020-09-08T01:34:05Z", "type": "commit"}, {"oid": "5f92492512e1d9b3bf80554cd0f6c84ea3959125", "url": "https://github.com/dashevo/dash-wallet/commit/5f92492512e1d9b3bf80554cd0f6c84ea3959125", "message": "Disclaimer layout and scrolling", "committedDate": "2020-09-10T00:35:52Z", "type": "commit"}]}