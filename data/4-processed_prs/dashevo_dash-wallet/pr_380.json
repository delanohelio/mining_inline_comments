{"pr_number": 380, "pr_title": "NMA-444: Connect UI to backend Part I: Check username existance", "pr_createdAt": "2020-04-21T04:50:45Z", "pr_url": "https://github.com/dashevo/dash-wallet/pull/380", "timeline": [{"oid": "930fa7c2278a9e46c886011a492f9a816bdfff4e", "url": "https://github.com/dashevo/dash-wallet/commit/930fa7c2278a9e46c886011a492f9a816bdfff4e", "message": "Replace okhttp with okhttp3", "committedDate": "2020-04-21T04:29:05Z", "type": "commit"}, {"oid": "8e7aef75ab9918693883d454d35c5b6a42513eb2", "url": "https://github.com/dashevo/dash-wallet/commit/8e7aef75ab9918693883d454d35c5b6a42513eb2", "message": "Add dpp, dapi-client, dashpay, platform-core libraries and disable inappmessaging", "committedDate": "2020-04-21T04:30:25Z", "type": "commit"}, {"oid": "b4c6bee555b266655e0f646ce3bb5c6428125510", "url": "https://github.com/dashevo/dash-wallet/commit/b4c6bee555b266655e0f646ce3bb5c6428125510", "message": "Connect Platform to background task, live data, view model to getusername data", "committedDate": "2020-04-21T04:32:42Z", "type": "commit"}, {"oid": "595bb432651d68badd5ddbbf575be627b8ab29fe", "url": "https://github.com/dashevo/dash-wallet/commit/595bb432651d68badd5ddbbf575be627b8ab29fe", "message": "CreateUsernameActivity: Check for username existance", "committedDate": "2020-04-21T04:33:21Z", "type": "commit"}, {"oid": "675faf0e747901a0e96bf95964ceac1328c4a3a7", "url": "https://github.com/dashevo/dash-wallet/commit/675faf0e747901a0e96bf95964ceac1328c4a3a7", "message": "Use 0.11 dpp", "committedDate": "2020-04-21T16:12:38Z", "type": "commit"}, {"oid": "bf32a839a0ba33adb9fff9269afafe77ede02221", "url": "https://github.com/dashevo/dash-wallet/commit/bf32a839a0ba33adb9fff9269afafe77ede02221", "message": "Use Coroutines based Platform communication model (#382)\n\n* Delay the call of getUsernameViewModel.getUsername(username) until user stop typing\r\n\r\n* Updated the incorrect dpp version\r\n\r\n* Updated some dependencies in order to be able use androidx.lifecycle:lifecycle-livedata-ktx\r\n\r\n* Replaced GetUsernameViewModel with less generic DashPayViewModel which can be used to handle multiple Platform-related LiveDates\r\nMoved the code related to retrieving the data from Platform into PlatformRepo (repository pattern)\r\nFinally replaced Handler based async processing of Platform requests with kotlin coroutines\r\n\r\n* Cancel the previous getUsername call if new one arrived", "committedDate": "2020-04-23T03:33:20Z", "type": "commit"}, {"oid": "acccbcd93dbafbfeb447bd8497609217f61349f7", "url": "https://github.com/dashevo/dash-wallet/commit/acccbcd93dbafbfeb447bd8497609217f61349f7", "message": "Merge branch 'evonet-username-exists' of http://github.com/dashevo/dash-wallet into evonet-username-exists", "committedDate": "2020-04-23T03:33:53Z", "type": "commit"}, {"oid": "cef488bfb597a37ad1fa711cc4afc83f14c22685", "url": "https://github.com/dashevo/dash-wallet/commit/cef488bfb597a37ad1fa711cc4afc83f14c22685", "message": "Add methods to check for platform availability", "committedDate": "2020-04-23T04:20:56Z", "type": "commit"}, {"oid": "c686b648b5f714fc6dfcc079c68b563e6d468bae", "url": "https://github.com/dashevo/dash-wallet/commit/c686b648b5f714fc6dfcc079c68b563e6d468bae", "message": "Call showHideJoinDashPayAction() + add comments", "committedDate": "2020-04-23T04:27:10Z", "type": "commit"}, {"oid": "addd5e1ce23219bb7b63dff65325f2e8eab0d2ce", "url": "https://github.com/dashevo/dash-wallet/commit/addd5e1ce23219bb7b63dff65325f2e8eab0d2ce", "message": "Simplified isPlatformAvailableLiveData, upgraded deprecated code and removed temporary debugging change", "committedDate": "2020-04-24T06:14:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDMyNTUzMg==", "url": "https://github.com/dashevo/dash-wallet/pull/380#discussion_r414325532", "bodyText": "This old way of retrieving ViewModels is deprecated in 'androidx.core:core:1.2.0', I applied the recommended one.", "author": "tomasz-ludek", "createdAt": "2020-04-24T06:25:19Z", "path": "wallet/src/de/schildbach/wallet/ui/WalletActivity.java", "diffHunk": "@@ -320,7 +321,7 @@ private void initViewModel() {\n         // the Join DashPay (evolution) button on the shortcuts bar.\n         // If that is the only function that the platform required for, then we can\n         // conditionally execute this code when a username hasn't been registered.\n-        dashPayViewModel = ViewModelProviders.of(this).get(DashPayViewModel.class);\n+        dashPayViewModel = new ViewModelProvider(this).get(DashPayViewModel.class);", "originalCommit": "addd5e1ce23219bb7b63dff65325f2e8eab0d2ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDMyNTk1MA==", "url": "https://github.com/dashevo/dash-wallet/pull/380#discussion_r414325950", "bodyText": "Last time I forgot to revert this temporary debugging change.", "author": "tomasz-ludek", "createdAt": "2020-04-24T06:26:14Z", "path": "wallet/src/de/schildbach/wallet/ui/WalletActivity.java", "diffHunk": "@@ -345,7 +345,7 @@ private void showHideJoinDashPayAction() {\n             boolean canAffordIt = walletBalance.isGreaterThan(Constants.DASH_PAY_FEE)\n                     || walletBalance.equals(Constants.DASH_PAY_FEE);\n             boolean visible = canAffordIt && config.getShowJoinDashPay();\n-            joinDashPayAction.setVisibility(View.VISIBLE);//visible ? View.VISIBLE : View.GONE);\n+            joinDashPayAction.setVisibility(visible ? View.VISIBLE : View.GONE);", "originalCommit": "addd5e1ce23219bb7b63dff65325f2e8eab0d2ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDMyNzk3Mw==", "url": "https://github.com/dashevo/dash-wallet/pull/380#discussion_r414327973", "bodyText": "This field and all related code is only needed if you want to be able to reload the value of related LiveData multiple times and each time cancel previous request is it wasn't yet finished. I'll try to explain it in more details on Slack.", "author": "tomasz-ludek", "createdAt": "2020-04-24T06:30:50Z", "path": "wallet/src/de/schildbach/wallet/ui/dashpay/DashPayViewModel.kt", "diffHunk": "@@ -29,13 +29,10 @@ class DashPayViewModel(application: Application) : AndroidViewModel(application)\n \n     private val platformRepo = PlatformRepo(application as WalletApplication)\n \n-\n     private val usernameLiveData = MutableLiveData<String>()\n-    private val platformStatusLiveData = MutableLiveData<Boolean>()\n \n     // Job instance (https://stackoverflow.com/questions/57723714/how-to-cancel-a-running-livedata-coroutine-block/57726583#57726583)\n     private var getUsernameJob = Job()\n-    private var isPlatformAvailableJob = Job()", "originalCommit": "addd5e1ce23219bb7b63dff65325f2e8eab0d2ce", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY1NTU5OA==", "url": "https://github.com/dashevo/dash-wallet/pull/380#discussion_r414655598", "bodyText": "I am curious about this change.  How do we trigger this call?", "author": "HashEngineering", "createdAt": "2020-04-24T15:15:50Z", "path": "wallet/src/de/schildbach/wallet/ui/WalletActivity.java", "diffHunk": "@@ -330,7 +331,6 @@ public void onChanged(Resource<Boolean> status) {\n                 showHideJoinDashPayAction();\n             }\n         });\n-        dashPayViewModel.isPlatformAvailable();", "originalCommit": "addd5e1ce23219bb7b63dff65325f2e8eab0d2ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY2MDI2OA==", "url": "https://github.com/dashevo/dash-wallet/pull/380#discussion_r414660268", "bodyText": "It is trigger automatically by the SDK when you starting observing on it:\ndashPayViewModel.isPlatformAvailableLiveData().observe(...)", "author": "tomasz-ludek", "createdAt": "2020-04-24T15:22:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY1NTU5OA=="}], "type": "inlineReview"}, {"oid": "0c8f3c610ea3867c73e4b32f9ce973b21ce8a4cf", "url": "https://github.com/dashevo/dash-wallet/commit/0c8f3c610ea3867c73e4b32f9ce973b21ce8a4cf", "message": "Update username exists error text", "committedDate": "2020-04-24T20:14:31Z", "type": "commit"}, {"oid": "5a5c81ab29d8c36dc6a4ae6d533cb1fb3a5db14f", "url": "https://github.com/dashevo/dash-wallet/commit/5a5c81ab29d8c36dc6a4ae6d533cb1fb3a5db14f", "message": "Merge branch 'evonet-develop' of http://github.com/dashevo/dash-wallet into evonet-username-exists", "committedDate": "2020-04-24T20:54:24Z", "type": "commit"}, {"oid": "b03b08468186adc4387d03d63f95149c3944c832", "url": "https://github.com/dashevo/dash-wallet/commit/b03b08468186adc4387d03d63f95149c3944c832", "message": "this file got left out of the merge", "committedDate": "2020-04-24T20:56:07Z", "type": "commit"}]}