{"pr_number": 4465, "pr_title": "fix(TUP-26156)tCreateTable change DBType and Property Type not work", "pr_createdAt": "2020-02-19T10:00:48Z", "pr_url": "https://github.com/Talend/tdi-studio-se/pull/4465", "timeline": [{"oid": "1db9d70d565e6e93884bb0d900f4d19b0f0f0d20", "url": "https://github.com/Talend/tdi-studio-se/commit/1db9d70d565e6e93884bb0d900f4d19b0f0f0d20", "message": "fix(TUP-26156)tCreateTable: change \"DBType\" and \"Property Type\" not work\nhttps://jira.talendforge.org/browse/TUP-26156", "committedDate": "2020-02-19T09:53:24Z", "type": "commit"}, {"oid": "28a85c9c196bef3fce5d5e4f1d6e6602c4ccf2c9", "url": "https://github.com/Talend/tdi-studio-se/commit/28a85c9c196bef3fce5d5e4f1d6e6602c4ccf2c9", "message": "fix(TUP-26156)tCreateTable: change \"DBType\" and \"Property Type\" not work\nhttps://jira.talendforge.org/browse/TUP-26156", "committedDate": "2020-02-19T11:16:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTgxOTQ3Ng==", "url": "https://github.com/Talend/tdi-studio-se/pull/4465#discussion_r381819476", "bodyText": "I think no need to check if it is \"tCreateTable\"  ,we set value when it is show should be ok.", "author": "wchen-talend", "createdAt": "2020-02-20T07:16:49Z", "path": "main/plugins/org.talend.designer.core/src/main/java/org/talend/designer/core/ui/editor/cmd/ChangeValuesFromRepository.java", "diffHunk": "@@ -625,6 +625,16 @@ else if (connection instanceof SalesforceSchemaConnection && \"CUSTOM_MODULE_NAME\n                                 objectValue = newValue;\n                             }\n \n+                            /**\n+                             * For tCreateTable, several parameter have the same repository value\n+                             * (e.g.DB_MYSQL_VERSION/DB_POSTGRE_VERSION/...=>DB_VERSION), avoid to set all...\n+                             */\n+                            if (\"tCreateTable\".equals(elem.getPropertyValue(EParameterName.COMPONENT_NAME.getName())) //$NON-NLS-1$\n+                                    && EParameterName.DB_VERSION.getName().equals(param.getRepositoryValue())\n+                                    && !param.isShow(elem.getElementParameters())) {\n+                                continue;", "originalCommit": "28a85c9c196bef3fce5d5e4f1d6e6602c4ccf2c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2MzA1Nw==", "url": "https://github.com/Talend/tdi-studio-se/pull/4465#discussion_r381863057", "bodyText": "ah ok, I'll modify, thanks", "author": "jding-tlnd", "createdAt": "2020-02-20T09:01:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTgxOTQ3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTgxOTczOA==", "url": "https://github.com/Talend/tdi-studio-se/pull/4465#discussion_r381819738", "bodyText": "I'm not quite understand how it works for other components and why only problem for tCreateTable.", "author": "wchen-talend", "createdAt": "2020-02-20T07:17:37Z", "path": "main/plugins/org.talend.designer.core/src/main/java/org/talend/designer/core/ui/editor/cmd/PropertyChangeCommand.java", "diffHunk": "@@ -238,6 +238,15 @@ public void execute() {\n                 Object value = elem.getPropertyValue(propName);\n                 if (value == null || (!value.toString().endsWith(\"xsd\") && !value.toString().endsWith(\"xsd\\\"\"))) {\n                     elem.setPropertyValue(propertyTypeName, EmfComponent.BUILTIN);\n+\n+                    /**\n+                     * For tCreateTable, DbType changed need to clean repository connection id stored, or it will get\n+                     * original DbType repository connection when click to Repository property type from built-in\n+                     */\n+                    if (\"tCreateTable\".equals(elem.getPropertyValue(EParameterName.COMPONENT_NAME.getName()))\n+                            && \"DBTYPE\".equals(propName)) {\n+                        elem.setPropertyValue(EParameterName.REPOSITORY_PROPERTY_TYPE.getName(), \"\");\n+                    }", "originalCommit": "28a85c9c196bef3fce5d5e4f1d6e6602c4ccf2c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg2NzA0Ng==", "url": "https://github.com/Talend/tdi-studio-se/pull/4465#discussion_r381867046", "bodyText": "For other component e.g.  tDBInput(Mysql), once click to Repository property type and settled the repository connection, will store it in parameter, after click built-in and then click Repository, will show the stored connection, so as tCreateTable. But after change the DB type, tDBInput will change to another component while tCreateTable not. So that after click to choose aother DB type and choose Repository in tCreateTable, will get original DB repository connection.", "author": "jding-tlnd", "createdAt": "2020-02-20T09:08:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTgxOTczOA=="}], "type": "inlineReview"}, {"oid": "3be7688f76977d9897057cda62aa1bf55bff68e0", "url": "https://github.com/Talend/tdi-studio-se/commit/3be7688f76977d9897057cda62aa1bf55bff68e0", "message": "fix(TUP-26156)tCreateTable change DBType and Property Type not work\nhttps://jira.talendforge.org/browse/TUP-26156", "committedDate": "2020-02-20T09:41:02Z", "type": "commit"}]}