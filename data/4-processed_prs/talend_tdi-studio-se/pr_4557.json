{"pr_number": 4557, "pr_title": "fix(TDI-43785) - big query repeated value managed", "pr_createdAt": "2020-03-25T08:10:30Z", "pr_url": "https://github.com/Talend/tdi-studio-se/pull/4557", "timeline": [{"oid": "3d77442ee674d194d89d65536e5805ffd58a1792", "url": "https://github.com/Talend/tdi-studio-se/commit/3d77442ee674d194d89d65536e5805ffd58a1792", "message": "fix(TDI-43785) - big query repeated value managed", "committedDate": "2020-03-25T07:45:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzY3NzM4Nw==", "url": "https://github.com/Talend/tdi-studio-se/pull/4557#discussion_r397677387", "bodyText": "indentation", "author": "undx", "createdAt": "2020-03-25T08:26:27Z", "path": "main/plugins/org.talend.designer.components.localprovider/components/tBigQueryInput/tBigQueryInput_begin.javajet", "diffHunk": "@@ -395,13 +395,18 @@\n \t\t\t    int colsLen_<%=cid %> = schema_<%=cid%>.getFields().size();\n \t\t\t    for (int i = <%=dynamic_index-1%>; i < colsLen_<%=cid %>-<%=columnList.size()-dynamic_index%>; i++) {\n \t\t\t    \troutines.system.DynamicMetadata dynamicMetadata_<%=cid%> = new routines.system.DynamicMetadata();\n-\t\t\t    \tdynamicMetadata_<%=cid%>.setName(schema_<%=cid%>.getFields().get(i).getName());\n+\t\t\t    \tcom.google.cloud.bigquery.Field field_<%=cid%> = schema_<%=cid%>.getFields().get(i);\n+\t\t\t    \tdynamicMetadata_<%=cid%>.setName(field_<%=cid%>.getName());\n \t\t\t    \tdynamicMetadata_<%=cid%>.setDbName(dynamicMetadata_<%=cid%>.getName());\n-\t\t\t    \tcom.google.cloud.bigquery.StandardSQLTypeName typeName_<%=cid%> = schema_<%=cid%>.getFields().get(i).getType().getStandardType();\n-\t\t\t    \tString typeNameString_<%=cid%> = (typeName_<%=cid%> != null) ? typeName_<%=cid%>.name() : schema_<%=cid%>.getFields().get(i).getType().name();\n+\t\t\t    \tcom.google.cloud.bigquery.StandardSQLTypeName typeName_<%=cid%> = field_<%=cid%>.getType().getStandardType();\n+\t\t\t    \tString typeNameString_<%=cid%> = (typeName_<%=cid%> != null) ? typeName_<%=cid%>.name() : field_<%=cid%>.getType().name();\n+\t\t\t    \tif (field_<%=cid%>.getMode() == com.google.cloud.bigquery.Field.Mode.REPEATED) { // list of values.\n+                \t\ttypeNameString_<%=cid%> = \"ARRAY\";\n+\t\t\t\t\t}", "originalCommit": "3d77442ee674d194d89d65536e5805ffd58a1792", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzY3NzgwMA==", "url": "https://github.com/Talend/tdi-studio-se/pull/4557#discussion_r397677800", "bodyText": "same", "author": "undx", "createdAt": "2020-03-25T08:27:14Z", "path": "main/plugins/org.talend.designer.components.localprovider/components/templates/DB/Input/BigQuery/BigQueryHelper_ServiceAccount.javajet", "diffHunk": "@@ -17,7 +17,14 @@ class BigQueryHelper_<%=cid%> {\n \t\t\t\tcolumn.addColumnValue(null);\n \t\t\t\tcontinue;\n \t\t\t}\n-\t\t\tif (\"id_String\".equals(dcm.getType())) {\n+\t\t\tif (\"id_List\".equals(dcm.getType())) {\n+\t\t\t\tjava.util.List<com.google.cloud.bigquery.FieldValue> bigQueryValues = rs.get(colNum).getRepeatedValue();\n+\t\t\t\tjava.util.List<Object> values = bigQueryValues.stream()\n+\t\t\t\t                                              .map(com.google.cloud.bigquery.FieldValue::getValue)\n+\t\t\t\t                                              .collect(java.util.stream.Collectors.toList());\n+\t\t\t\tcolumn.addColumnValue(values);", "originalCommit": "3d77442ee674d194d89d65536e5805ffd58a1792", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}