{"pr_number": 4530, "pr_title": "fix(TUP-26231)Relative path not working in Talend v721", "pr_createdAt": "2020-03-16T00:22:06Z", "pr_url": "https://github.com/Talend/tdi-studio-se/pull/4530", "timeline": [{"oid": "cd706dfc40e27de0a2ce1f173a36318d43a0ee45", "url": "https://github.com/Talend/tdi-studio-se/commit/cd706dfc40e27de0a2ce1f173a36318d43a0ee45", "message": "fix(TUP-26231)Relative path not working in Talend v721\nhttps://jira.talendforge.org/browse/TUP-26231", "committedDate": "2020-03-16T00:14:51Z", "type": "commit"}, {"oid": "62c842532639398ae40a1c876a99209b7cabee9a", "url": "https://github.com/Talend/tdi-studio-se/commit/62c842532639398ae40a1c876a99209b7cabee9a", "message": "fix(TUP-26231)Relative path not working in Talend v721\nhttps://jira.talendforge.org/browse/TUP-26231", "committedDate": "2020-03-17T17:13:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMTQ5Nw==", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r394831497", "bodyText": "missing one caller of BigDataCodeGenerator, can move the isExportConfig to resourceService.getResourcePathForContext, no need add another api getFullResourcePathForContext", "author": "zwxue", "createdAt": "2020-03-19T07:24:15Z", "path": "main/plugins/org.talend.designer.codegen/src/main/java/org/talend/designer/codegen/CodeGenerator.java", "diffHunk": "@@ -353,8 +354,14 @@ public String generateContextCode(IContext designerContext) throws CodeGenerator\n                                     .getDefault().getService(IResourcesDependenciesService.class);\n                             String resourcePathForContext = null;\n                             if (process instanceof IProcess2) {\n-                                resourcePathForContext = resourceService.getResourcePathForContext(process,\n-                                        contextPar.getValue());\n+                                String value = contextPar.getValue();\n+                                // for runtime\n+                                if (!ProcessorUtilities.isExportConfig()) {\n+                                    contextPar.setType(JavaTypesManager.FILE.getId());\n+                                    resourcePathForContext = resourceService.getFullResourcePathForContext(process, value);\n+                                } else {\n+                                    resourcePathForContext = resourceService.getResourcePathForContext(process, value);", "originalCommit": "62c842532639398ae40a1c876a99209b7cabee9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTUwMjkxOA==", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r395502918", "bodyText": "Modified, thanks", "author": "jding-tlnd", "createdAt": "2020-03-20T08:52:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMTQ5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMTgxMg==", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r394831812", "bodyText": "can use RunprocessService.getTalendJobJavaProject.getExtsourceFolder() here", "author": "zwxue", "createdAt": "2020-03-19T07:25:12Z", "path": "main/plugins/org.talend.designer.core/src/main/java/org/talend/designer/core/ui/editor/dependencies/util/ResourceDependenciesUtil.java", "diffHunk": "@@ -310,6 +310,21 @@ public static void copyToExtResourceFolder(JobResourceDependencyModel model, Str\n         }\r\n     }\r\n \r\n+    public static String getJobExecuteResourceFilePath(JobResourceDependencyModel model, IRepositoryViewObject jobObject,\r\n+            String jobLabel,\r\n+            String resourceVersion) {\r\n+        String path = null;\r\n+        String extResPath = getProcessFolder(jobObject) + jobLabel.toLowerCase() + SRC_EXTRESOURCE_FOLDER;\r", "originalCommit": "62c842532639398ae40a1c876a99209b7cabee9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTUwMjk5Ng==", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r395502996", "bodyText": "Modified, thanks", "author": "jding-tlnd", "createdAt": "2020-03-20T08:52:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgzMTgxMg=="}], "type": "inlineReview"}, {"oid": "ead8edcd482077270bd04905a48de5107c1de7d7", "url": "https://github.com/Talend/tdi-studio-se/commit/ead8edcd482077270bd04905a48de5107c1de7d7", "message": "fix(TUP-26231)Relative path not working in Talend v721\nhttps://jira.talendforge.org/browse/TUP-26231", "committedDate": "2020-03-20T01:07:10Z", "type": "commit"}, {"oid": "9c918e647d731c33c22d8e6d919e08d62b1490fb", "url": "https://github.com/Talend/tdi-studio-se/commit/9c918e647d731c33c22d8e6d919e08d62b1490fb", "message": "fix(TUP-26231):Relative path not working in Talend v721\nhttps://jira.talendforge.org/browse/TUP-26231", "committedDate": "2020-03-20T08:48:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA2NDg3Nw==", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r396064877", "bodyText": "if(!ProcessorUtilities.isExportConfig())  ?", "author": "zwxue", "createdAt": "2020-03-22T07:55:58Z", "path": "main/plugins/org.talend.designer.core/src/main/java/org/talend/designer/core/ui/editor/dependencies/service/ResourcesDependenciesService.java", "diffHunk": "@@ -89,12 +91,12 @@ public String getResourcePathForContext(IProcess process, String resourceContext\n                     if (repoObject != null) {\r\n                         JobResourceDependencyModel model = new JobResourceDependencyModel(\r\n                                 (ResourceItem) repoObject.getProperty().getItem());\r\n-                        StringBuffer joblabel = new StringBuffer();\r\n-                        if (StringUtils.isNotBlank(property.getItem().getState().getPath())) {\r\n-                            joblabel.append(property.getItem().getState().getPath() + \"/\");\r\n+                        String jobLabel = JavaResourcesHelper.getJobFolderName(property.getLabel(), property.getVersion());\r\n+                        if (ProcessorUtilities.isExportConfig()) {\r", "originalCommit": "9c918e647d731c33c22d8e6d919e08d62b1490fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE2NTI2Nw==", "url": "https://github.com/Talend/tdi-studio-se/pull/4530#discussion_r396165267", "bodyText": "if(ProcessorUtilities.isExportConfig()) relativePath else fullPath", "author": "jding-tlnd", "createdAt": "2020-03-23T00:19:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA2NDg3Nw=="}], "type": "inlineReview"}]}