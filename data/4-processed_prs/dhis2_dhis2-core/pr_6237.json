{"pr_number": 6237, "pr_title": "fix: DHIS2-9519 different error message when a TEI has already been d\u2026", "pr_createdAt": "2020-09-24T11:48:56Z", "pr_url": "https://github.com/dhis2/dhis2-core/pull/6237", "timeline": [{"oid": "1eb9477544d70a1d503be5c98f8ff38298151e54", "url": "https://github.com/dhis2/dhis2-core/commit/1eb9477544d70a1d503be5c98f8ff38298151e54", "message": "fix: DHIS2-9519 different error message when a TEI has already been deleted", "committedDate": "2020-09-24T11:47:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM2MDg2Ng==", "url": "https://github.com/dhis2/dhis2-core/pull/6237#discussion_r494360866", "bodyText": "In this case @gnespolino , you are also saying its not allowed to update a tei. You can update a tei, as long as it is not soft deleted. The null-check you had before did exactly that :) So if you only do the null check, we know that the tei exists in the DB (done earlier in the code) and now it is null meaning it's soft deleted .", "author": "stian-sandvold", "createdAt": "2020-09-24T14:22:31Z", "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/events/trackedentity/AbstractTrackedEntityInstanceService.java", "diffHunk": "@@ -720,6 +720,12 @@ private ImportSummary updateTrackedEntityInstance( TrackedEntityInstance dtoEnti\n             {\n                 String message = \"Tracked entity instance \" + dtoEntityInstance.getTrackedEntityInstance()\n                     + \" does not exist\";\n+\n+                if ( teiService.trackedEntityInstanceExistsIncludingDeleted( dtoEntityInstance.getTrackedEntityInstance() ) )", "originalCommit": "1eb9477544d70a1d503be5c98f8ff38298151e54", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9888ea68043496fa50e1f4bdc2be7df792b27755", "url": "https://github.com/dhis2/dhis2-core/commit/9888ea68043496fa50e1f4bdc2be7df792b27755", "message": "fix: daoEntityInstance null check (#6158)\n\n* fix: deoEntityInstance null check\n\n* Update dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/events/trackedentity/AbstractTrackedEntityInstanceService.java\n\nCo-authored-by: Stian Sandvold <stian@dhis2.org>\n(cherry picked from commit c3ab110d72f55cf3f97a7166b80531d3f452aeb1)", "committedDate": "2020-09-25T08:45:06Z", "type": "commit"}, {"oid": "578021adc02e2537529bc0dade42197d7f800317", "url": "https://github.com/dhis2/dhis2-core/commit/578021adc02e2537529bc0dade42197d7f800317", "message": "fix: DHIS2-9519 avoiding unnecessary query", "committedDate": "2020-09-25T08:46:59Z", "type": "commit"}]}