{"pr_number": 5159, "pr_title": "fix: Update SMS compression listeners to use new event/enrollment schemas", "pr_createdAt": "2020-03-22T04:51:47Z", "pr_url": "https://github.com/dhis2/dhis2-core/pull/5159", "timeline": [{"oid": "4a2bf1380f3278b2e46181d7117b310ed5f2e533", "url": "https://github.com/dhis2/dhis2-core/commit/4a2bf1380f3278b2e46181d7117b310ed5f2e533", "message": "Update Comp SMS listeners for event lists", "committedDate": "2020-03-22T04:39:46Z", "type": "commit"}, {"oid": "4cac191ade2cf616ed714334bc504b48cd216b9f", "url": "https://github.com/dhis2/dhis2-core/commit/4cac191ade2cf616ed714334bc504b48cd216b9f", "message": "Refactor process SMS events and add tests for event lists", "committedDate": "2020-03-22T04:40:07Z", "type": "commit"}, {"oid": "eb94595d14f5d4cc87904479a0234d2d022d4cc9", "url": "https://github.com/dhis2/dhis2-core/commit/eb94595d14f5d4cc87904479a0234d2d022d4cc9", "message": "feat: update enrollments and events with geopoints and status", "committedDate": "2020-03-22T04:40:19Z", "type": "commit"}, {"oid": "6b8f77fe2c28526b28c5eb87a7bfacbba6450294", "url": "https://github.com/dhis2/dhis2-core/commit/6b8f77fe2c28526b28c5eb87a7bfacbba6450294", "message": "tests: update SMS listener tests for event schema changes", "committedDate": "2020-03-22T04:40:31Z", "type": "commit"}, {"oid": "f51b5d0c837d3d6e8bfe821c7983a5c01149c3ae", "url": "https://github.com/dhis2/dhis2-core/commit/f51b5d0c837d3d6e8bfe821c7983a5c01149c3ae", "message": "tests: improve SMS listener tests with null tests", "committedDate": "2020-03-22T04:40:41Z", "type": "commit"}, {"oid": "173e77ea493dfb4d1046adcb1f082b3cbe794345", "url": "https://github.com/dhis2/dhis2-core/commit/173e77ea493dfb4d1046adcb1f082b3cbe794345", "message": "fix: remove unnecessary ref in SMS tests", "committedDate": "2020-03-22T04:40:50Z", "type": "commit"}, {"oid": "cfebdcb688dacba92725ffd1f8825a6f79d94c84", "url": "https://github.com/dhis2/dhis2-core/commit/cfebdcb688dacba92725ffd1f8825a6f79d94c84", "message": "fix: fix and improve SMS listener tests", "committedDate": "2020-03-22T04:41:03Z", "type": "commit"}, {"oid": "09bbdbc31dbad600e4f032e1a3d8622d1c27db99", "url": "https://github.com/dhis2/dhis2-core/commit/09bbdbc31dbad600e4f032e1a3d8622d1c27db99", "message": "move copyright to top of file", "committedDate": "2020-03-22T04:41:18Z", "type": "commit"}, {"oid": "680d69b76bb01b4367b441f9ad1e3495e260f1ba", "url": "https://github.com/dhis2/dhis2-core/commit/680d69b76bb01b4367b441f9ad1e3495e260f1ba", "message": "tests: add one small SMS listener test", "committedDate": "2020-03-22T04:41:29Z", "type": "commit"}, {"oid": "76b875d4e70bff625404e1081c06956b31140fbc", "url": "https://github.com/dhis2/dhis2-core/commit/76b875d4e70bff625404e1081c06956b31140fbc", "message": "update: change sms comp lib ref to dhis2 org", "committedDate": "2020-03-23T10:39:45Z", "type": "commit"}, {"oid": "5f5241586773f076d69b6850e69d35e1b9dceeab", "url": "https://github.com/dhis2/dhis2-core/commit/5f5241586773f076d69b6850e69d35e1b9dceeab", "message": "fix: ensure existing events are updates in SMS listeners", "committedDate": "2020-03-29T09:35:32Z", "type": "commit"}, {"oid": "f4521a6635fc825e5d2a5d745dbb31164cc4a6d9", "url": "https://github.com/dhis2/dhis2-core/commit/f4521a6635fc825e5d2a5d745dbb31164cc4a6d9", "message": "fix: ensure UID is used when enrolling TEIs in SMS", "committedDate": "2020-04-01T13:42:30Z", "type": "commit"}, {"oid": "e37dcfecd52d0aee767ad5fb1bf43134fe687662", "url": "https://github.com/dhis2/dhis2-core/commit/e37dcfecd52d0aee767ad5fb1bf43134fe687662", "message": "Merge branch 'master' of github.com:dhis2/dhis2-core into master-sms-event-schema", "committedDate": "2020-04-11T03:00:36Z", "type": "commit"}, {"oid": "3bc457e37b4c9b11427d13b594b916f72a8e1554", "url": "https://github.com/dhis2/dhis2-core/commit/3bc457e37b4c9b11427d13b594b916f72a8e1554", "message": "fix: Use TrackedEntityAttributeValueService to update values in SMS submissions\n\nFix will make sure that values updated through SMS are also reflected on the web.", "committedDate": "2020-04-11T03:01:05Z", "type": "commit"}, {"oid": "28acaf78022ddedea6dcc45153b701e3a3694628", "url": "https://github.com/dhis2/dhis2-core/commit/28acaf78022ddedea6dcc45153b701e3a3694628", "message": "refactor: reduce metadata calls for SMS", "committedDate": "2020-04-11T03:01:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIxNjk1MA==", "url": "https://github.com/dhis2/dhis2-core/pull/5159#discussion_r412216950", "bodyText": "Use .getUid() consistently.", "author": "larshelge", "createdAt": "2020-04-21T14:08:01Z", "path": "dhis-2/dhis-services/dhis-service-core/src/main/java/org/hisp/dhis/sms/listener/AggregateDataSetSMSListener.java", "diffHunk": "@@ -110,10 +110,10 @@ protected SMSResponse postProcess( IncomingSms sms, SMSSubmission submission )\n         String per = subm.getPeriod();\n         UID aocid = subm.getAttributeOptionCombo();\n \n-        OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouid.uid );\n-        User user = userService.getUser( subm.getUserID().uid );\n+        OrganisationUnit orgUnit = organisationUnitService.getOrganisationUnit( ouid.getUID() );\n+        User user = userService.getUser( subm.getUserID().getUID() );", "originalCommit": "28acaf78022ddedea6dcc45153b701e3a3694628", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjc1NTUyNg==", "url": "https://github.com/dhis2/dhis2-core/pull/5159#discussion_r412755526", "bodyText": "@larshelge - case of acronym PR here: #5423", "author": "JasperTimm", "createdAt": "2020-04-22T07:53:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIxNjk1MA=="}], "type": "inlineReview"}]}