{"pr_number": 5766, "pr_title": "feat: adds uuid to userCredentials and userGroups", "pr_createdAt": "2020-06-22T09:59:06Z", "pr_url": "https://github.com/dhis2/dhis2-core/pull/5766", "timeline": [{"oid": "28f135e867f8f84fd4184c566604bc93cfbb6e72", "url": "https://github.com/dhis2/dhis2-core/commit/28f135e867f8f84fd4184c566604bc93cfbb6e72", "message": "feat: adds uuid to userCredentials/userGroups (and flyway migration script)", "committedDate": "2020-06-22T09:56:58Z", "type": "commit"}, {"oid": "7cf2cb235570ee8c82354931b27e6d398bb33a0b", "url": "https://github.com/dhis2/dhis2-core/commit/7cf2cb235570ee8c82354931b27e6d398bb33a0b", "message": "fix: change flyway migration versions", "committedDate": "2020-06-22T10:05:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2NzYzMw==", "url": "https://github.com/dhis2/dhis2-core/pull/5766#discussion_r443467633", "bodyText": "Check if we potentially could map to PostgreSQL uuid data type.", "author": "larshelge", "createdAt": "2020-06-22T10:35:27Z", "path": "dhis-2/dhis-support/dhis-support-db-migration/src/main/resources/org/hisp/dhis/db/migration/2.35/V2_35_7__Add_Uuid_User_Columns.sql", "diffHunk": "@@ -0,0 +1,7 @@\n+\n+\n+ALTER TABLE users ADD COLUMN IF NOT EXISTS \"uuid\" VARCHAR(36);", "originalCommit": "7cf2cb235570ee8c82354931b27e6d398bb33a0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ4NjAxMA==", "url": "https://github.com/dhis2/dhis2-core/pull/5766#discussion_r443486010", "bodyText": "Please check again, its now using uuid type instead, and using pg-uuid hibernate type for conversion.", "author": "mortenoh", "createdAt": "2020-06-22T11:13:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2NzYzMw=="}], "type": "inlineReview"}, {"oid": "59541e8c3c0cd2ddae3c6cdd91cdf31d27ddce3d", "url": "https://github.com/dhis2/dhis2-core/commit/59541e8c3c0cd2ddae3c6cdd91cdf31d27ddce3d", "message": "fix: switch to using uuid field type in postgres, uses pg-uuid hibernate type for pg mapping", "committedDate": "2020-06-22T11:13:02Z", "type": "commit"}, {"oid": "fd56f9603e76d550062ed53da2a91ac2f0350804", "url": "https://github.com/dhis2/dhis2-core/commit/fd56f9603e76d550062ed53da2a91ac2f0350804", "message": "fix: H2 dialect fixes to allow for pg-uuid/uuid type", "committedDate": "2020-06-22T12:14:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDAwMTQyNg==", "url": "https://github.com/dhis2/dhis2-core/pull/5766#discussion_r444001426", "bodyText": "I'm not 100% sure I understand all parts of this function.\nDo you have any links/urls to where you found it or if you made it yourself may write some comments to what is going on.\nA test for its uniqueness properties would also be nice.", "author": "netroms", "createdAt": "2020-06-23T06:56:27Z", "path": "dhis-2/dhis-support/dhis-support-db-migration/src/main/resources/org/hisp/dhis/db/migration/2.35/V2_35_6__Add_Uuid_Generator.sql", "diffHunk": "@@ -0,0 +1,12 @@\n+\n+\n+CREATE OR REPLACE FUNCTION gen_random_uuid() RETURNS uuid\n+    AS $$\n+        SELECT uuid_in(\n+            overlay(\n+                overlay(md5(random()::text || ':' || clock_timestamp()::text) placing '4' from 13)\n+                placing to_hex(floor(random()*(11-8+1) + 8)::int)::text from 17\n+            )::cstring\n+        )::uuid\n+    $$\n+    LANGUAGE SQL;", "originalCommit": "fd56f9603e76d550062ed53da2a91ac2f0350804", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ef09185b59f2c2e2977bab7ac6a923d3d96d02b6", "url": "https://github.com/dhis2/dhis2-core/commit/ef09185b59f2c2e2977bab7ac6a923d3d96d02b6", "message": "fix: simplified sql uuid random generator", "committedDate": "2020-06-23T10:38:17Z", "type": "commit"}, {"oid": "57f01e68249e28ff8b1cc0351644ff4d891c2fa0", "url": "https://github.com/dhis2/dhis2-core/commit/57f01e68249e28ff8b1cc0351644ff4d891c2fa0", "message": "chore: remove commented out old random generator", "committedDate": "2020-06-23T10:38:44Z", "type": "commit"}]}