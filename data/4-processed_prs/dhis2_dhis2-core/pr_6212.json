{"pr_number": 6212, "pr_title": "[2.35] fix: allow updating an Event with File data type", "pr_createdAt": "2020-09-23T06:43:51Z", "pr_url": "https://github.com/dhis2/dhis2-core/pull/6212", "timeline": [{"oid": "eceb4078bdba0a47a4d83a07eb64a7c819a66c7f", "url": "https://github.com/dhis2/dhis2-core/commit/eceb4078bdba0a47a4d83a07eb64a7c819a66c7f", "message": "fix: allow updating an Event with File data type\n\nData Value of type File Type were making the update process to fail.\nIntroduced a more solid handling of mandatory data (e.g. Program Instance, Org Unit) since we can't always assume that the client will send all the required data.\nAdded some tests.\nAdded new test library to assert dates.\n\nref: DHIS2-9559\n(cherry picked from commit: e522e985d6d4fcd5bc5d6546b9337d6ab07dcfe7)\n\n(cherry picked from commit b618019119fe87c4f0c4f24b7d2a7de313ea4006)", "committedDate": "2020-09-23T07:12:53Z", "type": "commit"}, {"oid": "eceb4078bdba0a47a4d83a07eb64a7c819a66c7f", "url": "https://github.com/dhis2/dhis2-core/commit/eceb4078bdba0a47a4d83a07eb64a7c819a66c7f", "message": "fix: allow updating an Event with File data type\n\nData Value of type File Type were making the update process to fail.\nIntroduced a more solid handling of mandatory data (e.g. Program Instance, Org Unit) since we can't always assume that the client will send all the required data.\nAdded some tests.\nAdded new test library to assert dates.\n\nref: DHIS2-9559\n(cherry picked from commit: e522e985d6d4fcd5bc5d6546b9337d6ab07dcfe7)\n\n(cherry picked from commit b618019119fe87c4f0c4f24b7d2a7de313ea4006)", "committedDate": "2020-09-23T07:12:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzQ4ODI1Nw==", "url": "https://github.com/dhis2/dhis2-core/pull/6212#discussion_r493488257", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                PGgeometry toGeometry(Geometry geometry ) throws SQLException\n          \n          \n            \n                PGgeometry toGeometry( Geometry geometry ) throws SQLException", "author": "stian-sandvold", "createdAt": "2020-09-23T11:42:47Z", "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/events/event/JdbcEventSupport.java", "diffHunk": "@@ -13,4 +16,9 @@ Timestamp toTimestamp( Date date )\n     {\n         return date != null ? new Timestamp( date.getTime() ) : null;\n     }\n+\n+    PGgeometry toGeometry(Geometry geometry ) throws SQLException", "originalCommit": "eceb4078bdba0a47a4d83a07eb64a7c819a66c7f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzQ4OTUxNQ==", "url": "https://github.com/dhis2/dhis2-core/pull/6212#discussion_r493489515", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            psi.setAttributeOptionCombo( getCatOptionCombo ( rs ));\n          \n          \n            \n                            psi.setAttributeOptionCombo( getCatOptionCombo ( rs ) );", "author": "stian-sandvold", "createdAt": "2020-09-23T11:44:20Z", "path": "dhis-2/dhis-services/dhis-service-dxf2/src/main/java/org/hisp/dhis/dxf2/events/importer/context/ProgramStageInstanceSupplier.java", "diffHunk": "@@ -106,6 +117,11 @@ public ProgramStageInstanceSupplier( NamedParameterJdbcTemplate jdbcTemplate,\n                 psi.setStatus( EventStatus.valueOf( rs.getString( \"status\" ) ) );\n                 psi.setDeleted( rs.getBoolean( \"deleted\" ) );\n                 psi.setProgramStage( getProgramStage( importOptions, rs.getLong( \"programstageid\" ) ) );\n+                psi.setOrganisationUnit( getOu( rs ) );\n+                psi.setDueDate( rs.getDate( \"duedate\" ) );\n+                psi.setExecutionDate( rs.getDate( \"executiondate\" ) );\n+                psi.setCompletedDate( rs.getDate( \"completeddate\" ) );\n+                psi.setAttributeOptionCombo( getCatOptionCombo ( rs ));", "originalCommit": "eceb4078bdba0a47a4d83a07eb64a7c819a66c7f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "325cd496067346bb12696975ae2e060099a3472f", "url": "https://github.com/dhis2/dhis2-core/commit/325cd496067346bb12696975ae2e060099a3472f", "message": "Apply suggestions from code review", "committedDate": "2020-09-23T11:50:48Z", "type": "commit"}]}