{"pr_number": 7463, "pr_title": "7457 introduce mpconfig", "pr_createdAt": "2020-12-08T00:30:54Z", "pr_url": "https://github.com/IQSS/dataverse/pull/7463", "timeline": [{"oid": "74f35d82cfd29f8a2ecaff2982207e63eea4afc5", "url": "https://github.com/IQSS/dataverse/commit/74f35d82cfd29f8a2ecaff2982207e63eea4afc5", "message": "Introduce Eclipse MicroProfile Config API to the project. #7000", "committedDate": "2020-12-04T12:27:22Z", "type": "commit"}, {"oid": "13447f9cd3e27b78834b41520449424c57f3b6f4", "url": "https://github.com/IQSS/dataverse/commit/13447f9cd3e27b78834b41520449424c57f3b6f4", "message": "Add MicroBean MicroProfile Config API implementation as a test dependency to enable unit and integration testing without deployments. #7000", "committedDate": "2020-12-04T12:30:59Z", "type": "commit"}, {"oid": "a74cc52331cee3a7fa58497dfa0f99b6ec33d6d3", "url": "https://github.com/IQSS/dataverse/commit/a74cc52331cee3a7fa58497dfa0f99b6ec33d6d3", "message": "Update Testcontainers to 1.15.0.", "committedDate": "2020-12-04T12:31:26Z", "type": "commit"}, {"oid": "a535ce84583dbbe461e2a20a5b1437fdc1506457", "url": "https://github.com/IQSS/dataverse/commit/a535ce84583dbbe461e2a20a5b1437fdc1506457", "message": "Introducing an MPCONFIG alias config source. #7457", "committedDate": "2020-12-07T21:14:28Z", "type": "commit"}, {"oid": "5cd0ee99d5d729319d7e6ff1bd131869003d597d", "url": "https://github.com/IQSS/dataverse/commit/5cd0ee99d5d729319d7e6ff1bd131869003d597d", "message": "Merge branch 'develop' into 7457-introduce-mpconfig", "committedDate": "2020-12-07T21:15:10Z", "type": "commit"}, {"oid": "7a2433eb32559203be94ac872b43b7ee1cef5081", "url": "https://github.com/IQSS/dataverse/commit/7a2433eb32559203be94ac872b43b7ee1cef5081", "message": "Add missing name to AliasConfigSource. #7457", "committedDate": "2020-12-07T22:06:44Z", "type": "commit"}, {"oid": "f7407e359c5fd64d32ef7a64bcc575783667a8e9", "url": "https://github.com/IQSS/dataverse/commit/f7407e359c5fd64d32ef7a64bcc575783667a8e9", "message": "Adding a config source to retrieve Dataverse DB settings from MicroProfile Config API", "committedDate": "2020-12-07T22:09:05Z", "type": "commit"}, {"oid": "620e9abb8d52741786217ec84fd0a8a9cf9bcd51", "url": "https://github.com/IQSS/dataverse/commit/620e9abb8d52741786217ec84fd0a8a9cf9bcd51", "message": "Refactor AliasConfigSource to be more testable and rename aliases file to microprofile-aliases.properties. #7457", "committedDate": "2020-12-07T22:35:08Z", "type": "commit"}, {"oid": "ebf83e22ab8681ece09d45b9a957abb4a7aeaf12", "url": "https://github.com/IQSS/dataverse/commit/ebf83e22ab8681ece09d45b9a957abb4a7aeaf12", "message": "Fix error in AliasConfigSource, not looking at keys but values of the map. #7457", "committedDate": "2020-12-07T22:55:41Z", "type": "commit"}, {"oid": "e1cb339b8650629ca93381d8e50479af6ecaa488", "url": "https://github.com/IQSS/dataverse/commit/e1cb339b8650629ca93381d8e50479af6ecaa488", "message": "Add tests for AliasConfigSource. #7457", "committedDate": "2020-12-07T22:56:05Z", "type": "commit"}, {"oid": "fdb043d82e77e4c5a8c65d1ab448f4ba83a1cc3f", "url": "https://github.com/IQSS/dataverse/commit/fdb043d82e77e4c5a8c65d1ab448f4ba83a1cc3f", "message": "Add integration testing for DbSettingConfigSource to ensure data retrieval works. Fixing a typo, too. #7457", "committedDate": "2020-12-08T00:39:52Z", "type": "commit"}, {"oid": "b1ea8463e7bd2a499c59d58cee8c6130148cf4a1", "url": "https://github.com/IQSS/dataverse/commit/b1ea8463e7bd2a499c59d58cee8c6130148cf4a1", "message": "Change pom.xml to include the MicroProfile Config API SPI definitions. #7457", "committedDate": "2020-12-08T00:40:42Z", "type": "commit"}, {"oid": "b1ea8463e7bd2a499c59d58cee8c6130148cf4a1", "url": "https://github.com/IQSS/dataverse/commit/b1ea8463e7bd2a499c59d58cee8c6130148cf4a1", "message": "Change pom.xml to include the MicroProfile Config API SPI definitions. #7457", "committedDate": "2020-12-08T00:40:42Z", "type": "forcePushed"}, {"oid": "429ea21f911313b22bbd5c13f14b1a4023aebb61", "url": "https://github.com/IQSS/dataverse/commit/429ea21f911313b22bbd5c13f14b1a4023aebb61", "message": "Add some docs about introducing MPCONFIG to the dev guide.", "committedDate": "2020-12-08T00:55:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODU4MTc4OQ==", "url": "https://github.com/IQSS/dataverse/pull/7463#discussion_r538581789", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            and developers it get's much easier to provide their configuration.\n          \n          \n            \n            and developers it gets much easier to provide their configuration.", "author": "pdurbin", "createdAt": "2020-12-08T16:41:18Z", "path": "doc/sphinx-guides/source/developers/configuration.rst", "diffHunk": "@@ -0,0 +1,12 @@\n+Consuming Configuration\n+=======================\n+\n+By using `MicroProfile Config <https://github.com/eclipse/microprofile-config>`_, we start to move away from\n+direct ``System.getProperty()`` calls, replacing it with either injected or programmatic config retrieval.\n+\n+The API of MPCONFIG allows for great flexibility, type-safety, defaults etc. For system administrators\n+and developers it get's much easier to provide their configuration.", "originalCommit": "429ea21f911313b22bbd5c13f14b1a4023aebb61", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODU4NzY5Nw==", "url": "https://github.com/IQSS/dataverse/pull/7463#discussion_r538587697", "bodyText": "Should this postgres server version be moved up to be near the client version (around line 30)?", "author": "pdurbin", "createdAt": "2020-12-08T16:46:37Z", "path": "pom.xml", "diffHunk": "@@ -844,6 +861,7 @@\n             <id>tc</id>\n             <properties>\n                 <skipUnitTests>true</skipUnitTests>\n+                <postgresql.server.version>9.6</postgresql.server.version>", "originalCommit": "429ea21f911313b22bbd5c13f14b1a4023aebb61", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYzMjM4NA==", "url": "https://github.com/IQSS/dataverse/pull/7463#discussion_r538632384", "bodyText": "Preferably, yes. But I didn't want to bother others, so I left it in the profile. Would you prefer it in the upper place, too?", "author": "poikilotherm", "createdAt": "2020-12-08T17:26:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODU4NzY5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODc1Njk5MQ==", "url": "https://github.com/IQSS/dataverse/pull/7463#discussion_r538756991", "bodyText": "Hmm. Well, I don't want it in two places, if that's what you mean. But sure, if it can be in a single place, I'd prefer the single place to be at the top of the file with the other properties. (I just tried this locally and it seemed to work.). With the settings side by side, it's a little confusing what's what:\n    <postgresql.server.version>9.6</postgresql.server.version>\n    <postgresql.version>42.2.18</postgresql.version>\n\nMaybe at some point we should rename the \"42\" one to something more specific.", "author": "pdurbin", "createdAt": "2020-12-08T19:45:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODU4NzY5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODc3MTc3Nw==", "url": "https://github.com/IQSS/dataverse/pull/7463#discussion_r538771777", "bodyText": "OK if it confuses people, maybe we should leave it in the profile then. It's only used with testcontainers, so it would make sense to leave it there.", "author": "poikilotherm", "createdAt": "2020-12-08T20:09:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODU4NzY5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODgyNDY0MQ==", "url": "https://github.com/IQSS/dataverse/pull/7463#discussion_r538824641", "bodyText": "That's fine.", "author": "pdurbin", "createdAt": "2020-12-08T21:35:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODU4NzY5Nw=="}], "type": "inlineReview"}, {"oid": "5f73b45a6822083265e4226f8589000c03076a1c", "url": "https://github.com/IQSS/dataverse/commit/5f73b45a6822083265e4226f8589000c03076a1c", "message": "Extend dev docs about MPCONFIG. #7457", "committedDate": "2020-12-08T18:42:06Z", "type": "commit"}, {"oid": "2ffa4c120852b42752ebe47e6978355584123ac5", "url": "https://github.com/IQSS/dataverse/commit/2ffa4c120852b42752ebe47e6978355584123ac5", "message": "Fix DbSettingConfigSource not to throw an exception if the DataSource JNDI could not be found or injected. Will result empty properties for this source. #7457", "committedDate": "2020-12-08T19:59:09Z", "type": "commit"}, {"oid": "a44b0a413438c606098c06aada910aa3813b25ed", "url": "https://github.com/IQSS/dataverse/commit/a44b0a413438c606098c06aada910aa3813b25ed", "message": "Refactor DbSettingConfigSource to rely on the SettingsServiceBean, injected by a singleton on startup.", "committedDate": "2020-12-08T22:18:25Z", "type": "commit"}, {"oid": "ecc277c999b861a2953b4c456626b5788e8021bf", "url": "https://github.com/IQSS/dataverse/commit/ecc277c999b861a2953b4c456626b5788e8021bf", "message": "Log warning message for DbSettingConfigSource if the settings service has not been injected yet, but values are requested already.", "committedDate": "2020-12-08T22:44:32Z", "type": "commit"}, {"oid": "e6f38ee3abd6a4bf43664fce03cb51356100c6f5", "url": "https://github.com/IQSS/dataverse/commit/e6f38ee3abd6a4bf43664fce03cb51356100c6f5", "message": "More dev documentation of MPCONFIG usage and sources. #7457", "committedDate": "2020-12-08T23:08:17Z", "type": "commit"}, {"oid": "ffe775ef82a36fcc7c83375583214914c690b415", "url": "https://github.com/IQSS/dataverse/commit/ffe775ef82a36fcc7c83375583214914c690b415", "message": "Add release notes for #7457", "committedDate": "2020-12-08T23:13:43Z", "type": "commit"}, {"oid": "00b95335e0fd312bc4649c116a06ca6470391e8e", "url": "https://github.com/IQSS/dataverse/commit/00b95335e0fd312bc4649c116a06ca6470391e8e", "message": "Add javadoc about what is DbSettingConfigHelper. #7457", "committedDate": "2020-12-08T23:18:33Z", "type": "commit"}, {"oid": "f4a88a12d0e995994e3e7fd589baadf861040cc5", "url": "https://github.com/IQSS/dataverse/commit/f4a88a12d0e995994e3e7fd589baadf861040cc5", "message": "Make Sphinx happy by removing a redundant space in dev docs about configuration.", "committedDate": "2020-12-09T17:48:25Z", "type": "commit"}, {"oid": "f1350509d37f9fcb4c7993f45cc61dc28151806f", "url": "https://github.com/IQSS/dataverse/commit/f1350509d37f9fcb4c7993f45cc61dc28151806f", "message": "add toc #7457", "committedDate": "2020-12-09T18:29:45Z", "type": "commit"}]}