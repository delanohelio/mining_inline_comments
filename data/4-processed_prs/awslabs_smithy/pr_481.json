{"pr_number": 481, "pr_title": "Update opinionated protocol tests to not describe optional behavior", "pr_createdAt": "2020-07-02T00:54:09Z", "pr_url": "https://github.com/awslabs/smithy/pull/481", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgzMzUyOQ==", "url": "https://github.com/awslabs/smithy/pull/481#discussion_r449833529", "bodyText": "Nit: we use \"Json\" everywhere else in these tests, so \"RestJsonEmptyInputAndEmptyJsonObjectOutput\"", "author": "mtdowling", "createdAt": "2020-07-05T04:41:36Z", "path": "smithy-aws-protocol-tests/model/restJson1/empty-input-output.smithy", "diffHunk": "@@ -83,20 +83,28 @@ apply EmptyInputAndEmptyOutput @httpRequestTests([\n         protocol: restJson1,\n         method: \"POST\",\n         uri: \"/EmptyInputAndEmptyOutput\",\n-        body: \"{}\",\n+        body: \"\",\n         bodyMediaType: \"application/json\"\n     },\n ])\n \n apply EmptyInputAndEmptyOutput @httpResponseTests([\n     {\n         id: \"RestJsonEmptyInputAndEmptyOutput\",\n-        documentation: \"Empty output serializes no payload\",\n+        documentation: \"Empty output deserializes no payload\",\n         protocol: restJson1,\n         code: 200,\n         body: \"\",\n         bodyMediaType: \"application/json\"\n     },\n+    {\n+        id: \"RestJsonEmptyInputAndEmptyJSONObjectOutput\",", "originalCommit": "381e9567b7bfa890f382fbf51efb49b057bb1567", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgzMzU5Nw==", "url": "https://github.com/awslabs/smithy/pull/481#discussion_r449833597", "bodyText": "not an issue, just a clarification: these tests are about serializing requests and responses. They aren't meant to be oriented towards clients or servers, but rather just about how messages are serialized. So a service should be able to take these tests and make sure the service is implemented correctly. That's why I used the word serialized here instead of deseralize.", "author": "mtdowling", "createdAt": "2020-07-05T04:42:53Z", "path": "smithy-aws-protocol-tests/model/restJson1/empty-input-output.smithy", "diffHunk": "@@ -83,20 +83,28 @@ apply EmptyInputAndEmptyOutput @httpRequestTests([\n         protocol: restJson1,\n         method: \"POST\",\n         uri: \"/EmptyInputAndEmptyOutput\",\n-        body: \"{}\",\n+        body: \"\",\n         bodyMediaType: \"application/json\"\n     },\n ])\n \n apply EmptyInputAndEmptyOutput @httpResponseTests([\n     {\n         id: \"RestJsonEmptyInputAndEmptyOutput\",\n-        documentation: \"Empty output serializes no payload\",\n+        documentation: \"Empty output deserializes no payload\",", "originalCommit": "381e9567b7bfa890f382fbf51efb49b057bb1567", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5NzkyMw==", "url": "https://github.com/awslabs/smithy/pull/481#discussion_r450497923", "bodyText": "Thanks for clarifying that. Updating this one thinking it was a copy/paste bug. Can revert this back.", "author": "jasdel", "createdAt": "2020-07-06T21:49:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgzMzU5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgzMzYxOQ==", "url": "https://github.com/awslabs/smithy/pull/481#discussion_r449833619", "bodyText": "\ud83d\udc4d we found out that this test was incorrectly copied from the RPC protocols.", "author": "mtdowling", "createdAt": "2020-07-05T04:43:21Z", "path": "smithy-aws-protocol-tests/model/restJson1/empty-input-output.smithy", "diffHunk": "@@ -83,20 +83,28 @@ apply EmptyInputAndEmptyOutput @httpRequestTests([\n         protocol: restJson1,\n         method: \"POST\",\n         uri: \"/EmptyInputAndEmptyOutput\",\n-        body: \"{}\",\n+        body: \"\",", "originalCommit": "381e9567b7bfa890f382fbf51efb49b057bb1567", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0153c5446349fdb6354ca6512647a7affe32c5e1", "url": "https://github.com/awslabs/smithy/commit/0153c5446349fdb6354ca6512647a7affe32c5e1", "message": "Update opinionated protocol tests to not describe optional behavior\n\nRemoves the protocol tests for HTTP Prefix Header deserialization,\ndeserializing to an empty map vs null value. Null vs empty map will be\nSDK implementation specific distinction. If there was a way to model\n`empty` as an expectation that would encompass both null and empty but\ninitialized map this test would be more portable.\n\nUpdates the empty input output serialization protocol test to expect\nempty payload not empty JSON object as the serialized result. It doesn't\nlook like the REST-JSON protocol should be serializing empty JSON\nobject when no members are serialized.", "committedDate": "2020-07-06T17:08:48Z", "type": "commit"}, {"oid": "7ff4c45fcd078ed71b275dea61f8296ee2bbba63", "url": "https://github.com/awslabs/smithy/commit/7ff4c45fcd078ed71b275dea61f8296ee2bbba63", "message": "add test for empty json object deserialize", "committedDate": "2020-07-06T17:08:48Z", "type": "commit"}, {"oid": "b8a4ffe8b04b39f8dd03597e3ba0250c593fbcc6", "url": "https://github.com/awslabs/smithy/commit/b8a4ffe8b04b39f8dd03597e3ba0250c593fbcc6", "message": "fixup unique test case name", "committedDate": "2020-07-06T17:08:48Z", "type": "commit"}, {"oid": "254f730a43253a0fcf8ff256555073189842f08c", "url": "https://github.com/awslabs/smithy/commit/254f730a43253a0fcf8ff256555073189842f08c", "message": "fixup PR feedback", "committedDate": "2020-07-06T21:53:07Z", "type": "commit"}, {"oid": "254f730a43253a0fcf8ff256555073189842f08c", "url": "https://github.com/awslabs/smithy/commit/254f730a43253a0fcf8ff256555073189842f08c", "message": "fixup PR feedback", "committedDate": "2020-07-06T21:53:07Z", "type": "forcePushed"}]}