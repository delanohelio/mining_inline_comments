{"pr_number": 496, "pr_title": "Add protocol tests for Aws Json 1.0", "pr_createdAt": "2020-07-14T21:54:33Z", "pr_url": "https://github.com/awslabs/smithy/pull/496", "timeline": [{"oid": "2d2b66a2971440bf4270162af5101023b7eb745b", "url": "https://github.com/awslabs/smithy/commit/2d2b66a2971440bf4270162af5101023b7eb745b", "message": "Add protocol tests for Aws Json 1.0\n\nThis adds basic protocol tests for AWS JSON 1.0. In the future there\nwill be a full set of tests, but for now there are only tests that\ncover the cases where it differs from 1.1, namely errors and content\ntype.", "committedDate": "2020-07-14T21:51:00Z", "type": "commit"}, {"oid": "53b9bb6fa3b8fb6575e1098cd818f6aebc7cc618", "url": "https://github.com/awslabs/smithy/commit/53b9bb6fa3b8fb6575e1098cd818f6aebc7cc618", "message": "Add expected params for json rpc tests", "committedDate": "2020-07-15T23:18:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg5MTg1Mw==", "url": "https://github.com/awslabs/smithy/pull/496#discussion_r455891853", "bodyText": "Case is missing documentation.", "author": "kstich", "createdAt": "2020-07-16T15:53:07Z", "path": "smithy-aws-protocol-tests/model/awsJson1_0/errors.smithy", "diffHunk": "@@ -0,0 +1,248 @@\n+// This file defines test cases that test error serialization.\n+\n+$version: \"1.0\"\n+\n+namespace aws.protocoltests.json10\n+\n+use aws.protocols#awsJson1_0\n+use smithy.test#httpRequestTests\n+use smithy.test#httpResponseTests\n+\n+/// This operation has three possible return values:\n+///\n+/// 1. A successful response in the form of GreetingWithErrorsOutput\n+/// 2. An InvalidGreeting error.\n+/// 3. A ComplexError error.\n+///\n+/// Implementations must be able to successfully take a response and\n+/// properly deserialize successful and error responses.\n+@idempotent\n+operation GreetingWithErrors {\n+    output: GreetingWithErrorsOutput,\n+    errors: [InvalidGreeting, ComplexError, FooError]\n+}\n+\n+structure GreetingWithErrorsOutput {\n+    greeting: String,\n+}\n+\n+/// This error is thrown when an invalid greeting value is provided.\n+@error(\"client\")\n+structure InvalidGreeting {\n+    Message: String,\n+}\n+\n+apply InvalidGreeting @httpResponseTests([\n+    {\n+        id: \"AwsJson10InvalidGreetingError\",\n+        documentation: \"Parses simple JSON errors\",\n+        protocol: awsJson1_0,\n+        params: {\n+            Message: \"Hi\"\n+        },\n+        code: 400,\n+        headers: {\n+            \"Content-Type\": \"application/x-amz-json-1.0\"\n+        },\n+        body: \"\"\"\n+              {\n+                  \"__type\": \"aws.protocoltests.json10#InvalidGreeting\",\n+                  \"Message\": \"Hi\"\n+              }\"\"\",\n+        bodyMediaType: \"application/json\",\n+    },\n+])\n+\n+/// This error is thrown when a request is invalid.\n+@error(\"client\")\n+structure ComplexError {\n+    TopLevel: String,\n+    Nested: ComplexNestedErrorData,\n+}\n+\n+structure ComplexNestedErrorData {\n+    @jsonName(\"Fooooo\")\n+    Foo: String,\n+}\n+\n+apply ComplexError @httpResponseTests([\n+    {\n+        id: \"AwsJson10ComplexError\",\n+        documentation: \"Parses a complex error with no message member\",\n+        protocol: awsJson1_0,\n+        params: {\n+            TopLevel: \"Top level\",\n+            Nested: {\n+                Foo: \"bar\"\n+            }\n+        },\n+        code: 400,\n+        headers: {\n+            \"Content-Type\": \"application/x-amz-json-1.0\"\n+        },\n+        body: \"\"\"\n+              {\n+                  \"__type\": \"aws.protocoltests.json10#ComplexError\",\n+                  \"TopLevel\": \"Top level\",\n+                  \"Nested\": {\n+                      \"Fooooo\": \"bar\"\n+                  }\n+              }\"\"\",\n+        bodyMediaType: \"application/json\",\n+    },\n+    {\n+        id: \"AwsJson10EmptyComplexError\",\n+        protocol: awsJson1_0,", "originalCommit": "53b9bb6fa3b8fb6575e1098cd818f6aebc7cc618", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9d4b6e4d8b87154f1a8ee5bb536203eee276c2d5", "url": "https://github.com/awslabs/smithy/commit/9d4b6e4d8b87154f1a8ee5bb536203eee276c2d5", "message": "Add more json1.0 protocol test documentation", "committedDate": "2020-07-16T17:13:53Z", "type": "commit"}, {"oid": "9d4b6e4d8b87154f1a8ee5bb536203eee276c2d5", "url": "https://github.com/awslabs/smithy/commit/9d4b6e4d8b87154f1a8ee5bb536203eee276c2d5", "message": "Add more json1.0 protocol test documentation", "committedDate": "2020-07-16T17:13:53Z", "type": "forcePushed"}]}