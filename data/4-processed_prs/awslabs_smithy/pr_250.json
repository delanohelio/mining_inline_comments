{"pr_number": 250, "pr_title": "Add AWS query protocol tests", "pr_createdAt": "2020-01-09T22:49:18Z", "pr_url": "https://github.com/awslabs/smithy/pull/250", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTk2NjA3Nw==", "url": "https://github.com/awslabs/smithy/pull/250#discussion_r365966077", "bodyText": "Closing tags for </myMap> should be </KVP> for both traits (below) applied to this operation.", "author": "kstich", "createdAt": "2020-01-13T18:46:54Z", "path": "smithy-aws-protocol-tests/model/query/xml-maps.smithy", "diffHunk": "@@ -0,0 +1,211 @@\n+// This file defines test cases that serialize maps in XML payloads.\n+\n+$version: \"0.5.0\"\n+\n+namespace aws.protocols.tests.query\n+\n+use aws.protocols.tests.shared#FooEnumMap\n+use aws.protocols.tests.shared#GreetingStruct\n+use smithy.test#httpResponseTests\n+\n+/// The example tests basic map serialization.\n+operation XmlMaps() -> XmlMapsOutput\n+\n+apply XmlMaps @httpResponseTests([\n+    {\n+        id: \"QueryXmlMaps\",\n+        description: \"Serializes XML maps\",\n+        protocol: \"aws.query\",\n+        code: 200,\n+        body: \"\"\"\n+              <XmlMapsResponse xmlns=\"https://example.com/\">\n+                  <XmlMapsResult>\n+                      <myMap>\n+                          <entry>\n+                              <key>foo</key>\n+                              <value>\n+                                  <hi>there</hi>\n+                              </value>\n+                          </entry>\n+                          <entry>\n+                              <key>baz</key>\n+                              <value>\n+                                  <hi>bye</hi>\n+                              </value>\n+                          </entry>\n+                      </myMap>\n+                  </XmlMapsResult>\n+              </XmlMapsResponse>\n+              \"\"\",\n+        bodyMediaType: \"application/xml\",\n+        headers: {\n+            \"Content-Type\": \"text/xml\"\n+        },\n+        params: {\n+            myMap: {\n+                foo: {\n+                    hi: \"there\"\n+                },\n+                baz: {\n+                    hi: \"bye\"\n+                }\n+            }\n+        }\n+    }\n+])\n+\n+structure XmlMapsOutput {\n+    myMap: XmlMapsOutputMap,\n+}\n+\n+map XmlMapsOutputMap {\n+    key: String,\n+    value: GreetingStruct\n+}\n+\n+// This example tests maps with @xmlName on members.\n+operation XmlMapsXmlName() -> XmlMapsXmlNameOutput\n+\n+apply XmlMapsXmlName @httpResponseTests([\n+    {\n+        id: \"QueryQueryXmlMapsXmlName\",\n+        description: \"Serializes XML lists\",\n+        protocol: \"aws.query\",\n+        code: 200,\n+        body: \"\"\"\n+              <XmlMapsXmlNameResponse xmlns=\"https://example.com/\">\n+                  <XmlMapsXmlNameResult>\n+                      <myMap>\n+                          <entry>\n+                              <Name>foo</Name>\n+                              <Setting>\n+                                  <hi>there</hi>\n+                              </Setting>\n+                          </entry>\n+                          <entry>\n+                              <Name>baz</Name>\n+                              <Setting>\n+                                  <hi>bye</hi>\n+                              </Setting>\n+                          </entry>\n+                      </myMap>\n+                  </XmlMapsXmlNameResult>\n+              </XmlMapsXmlNameResponse>\n+              \"\"\",\n+        bodyMediaType: \"application/xml\",\n+        headers: {\n+            \"Content-Type\": \"text/xml\"\n+        },\n+        params: {\n+            myMap: {\n+                foo: {\n+                    hi: \"there\"\n+                },\n+                baz: {\n+                    hi: \"bye\"\n+                }\n+            }\n+        }\n+    }\n+])\n+\n+structure XmlMapsXmlNameOutput {\n+    myMap: XmlMapsXmlNameOutputMap,\n+}\n+\n+map XmlMapsXmlNameOutputMap {\n+    @xmlName(\"Attribute\")\n+    key: String,\n+\n+    @xmlName(\"Setting\")\n+    value: GreetingStruct\n+}\n+\n+/// Flattened maps\n+operation FlattenedXmlMap() -> FlattenedXmlMapOutput\n+\n+apply FlattenedXmlMap @httpResponseTests([\n+    {\n+        id: \"QueryQueryFlattenedXmlMap\",\n+        description: \"Serializes flattened XML maps in responses\",\n+        protocol: \"aws.query\",\n+        code: 200,\n+        body: \"\"\"\n+              <FlattenedXmlMapResponse xmlns=\"https://example.com/\">\n+                  <FlattenedXmlMapResult>\n+                      <myMap>\n+                          <key>foo</key>\n+                          <value>Foo</value>\n+                      </myMap>\n+                      <myMap>\n+                          <key>baz</key>\n+                          <value>Baz</value>\n+                      </myMap>\n+                  </FlattenedXmlMapResult>\n+              </FlattenedXmlMapResponse>\"\"\",\n+        bodyMediaType: \"application/xml\",\n+        headers: {\n+            \"Content-Type\": \"text/xml\"\n+        },\n+        params: {\n+            myMap: {\n+                foo: \"Foo\",\n+                baz: \"Baz\"\n+            }\n+        }\n+    }\n+])\n+\n+structure FlattenedXmlMapOutput {\n+    @xmlFlattened\n+    myMap: FooEnumMap,\n+}\n+\n+/// Flattened maps with @xmlName\n+operation FlattenedXmlMapWithXmlName() -> FlattenedXmlMapWithXmlNameOutput", "originalCommit": "0d4fe5d9bd321313d5a33de4872f01de404227de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2ed228970c992bce2c39c05f82b74cbcf22247d6", "url": "https://github.com/awslabs/smithy/commit/2ed228970c992bce2c39c05f82b74cbcf22247d6", "message": "Add AWS query protocol tests", "committedDate": "2020-01-13T19:33:46Z", "type": "forcePushed"}, {"oid": "31bc9a5ee9af49e7eedf3c5368c1cd73c9808b94", "url": "https://github.com/awslabs/smithy/commit/31bc9a5ee9af49e7eedf3c5368c1cd73c9808b94", "message": "Add AWS query protocol tests", "committedDate": "2020-01-13T19:36:02Z", "type": "forcePushed"}, {"oid": "c482c24fcf5cad4b2f8eb7e226a3f88b32a6dde8", "url": "https://github.com/awslabs/smithy/commit/c482c24fcf5cad4b2f8eb7e226a3f88b32a6dde8", "message": "Add AWS query protocol tests", "committedDate": "2020-01-13T19:38:47Z", "type": "commit"}, {"oid": "c482c24fcf5cad4b2f8eb7e226a3f88b32a6dde8", "url": "https://github.com/awslabs/smithy/commit/c482c24fcf5cad4b2f8eb7e226a3f88b32a6dde8", "message": "Add AWS query protocol tests", "committedDate": "2020-01-13T19:38:47Z", "type": "forcePushed"}]}