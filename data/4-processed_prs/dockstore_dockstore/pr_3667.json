{"pr_number": 3667, "pr_title": "Feature/seab 1401/collect emails", "pr_createdAt": "2020-07-15T20:29:52Z", "pr_url": "https://github.com/dockstore/dockstore/pull/3667", "timeline": [{"oid": "7efc0c457144dee1e03e3cf97f8d585d20139904", "url": "https://github.com/dockstore/dockstore/commit/7efc0c457144dee1e03e3cf97f8d585d20139904", "message": "Collect User Emails From GitHub\n\nSEAB#1401\n\nImplemented a getEmail() method that goes through every single email\nfrom a GitHub user (regardless if they have private email turned on/off)\nand returns their primary email\n\nCreated a integration test to verify that the fields of object Profile\nis correct after updating the logged in user's metadata", "committedDate": "2020-07-14T00:11:56Z", "type": "commit"}, {"oid": "b217f4e1db656acce75cf78371960a8ebaad663a", "url": "https://github.com/dockstore/dockstore/commit/b217f4e1db656acce75cf78371960a8ebaad663a", "message": "Addressed tests failing for API call on user/emails\n\nIncluded a new fixture 'GitHubEmail.json' for Hoverfly\n\nImplemented a new case for Hoverfly to check for the new endpoint\n'/user/emails'", "committedDate": "2020-07-15T18:14:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM2MTIzMw==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455361233", "bodyText": "I wonder if to be safe, you shouldn't do getEmail(myself) || myself.getEmail()? Would that ever happen, that there's not a primary email, but the profile has an email?", "author": "coverbeck", "createdAt": "2020-07-15T21:25:33Z", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/helpers/GitHubSourceCodeRepo.java", "diffHunk": "@@ -895,7 +905,7 @@ public void syncUserMetadataFromGitHub(User user) {\n             GHMyself myself = github.getMyself();\n             User.Profile profile = new User.Profile();\n             profile.name = myself.getName();\n-            profile.email = myself.getEmail();\n+            profile.email = getEmail(myself);", "originalCommit": "b217f4e1db656acce75cf78371960a8ebaad663a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM2NDU2MA==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455364560", "bodyText": "Is it possible to have an email thats not primary? I thought GitHub automatically sets your only email as the primary email, or the first email you listed as the primary.", "author": "ByteMap", "createdAt": "2020-07-15T21:31:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM2MTIzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM3MDQwOA==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455370408", "bodyText": "I don't know, I'm just asking. :) Can you remove all your emails from your GitHub account, or does it require you to have at least one?", "author": "coverbeck", "createdAt": "2020-07-15T21:37:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM2MTIzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM4ODUxNQ==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455388515", "bodyText": "GitHub requires me to have at least one email. I am unable to remove all of my emails.", "author": "ByteMap", "createdAt": "2020-07-15T21:56:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM2MTIzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM2MjU0NQ==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455362545", "bodyText": "Does getEmails2 always return a collection? Take a look at code to be sure. Concerned about possible NPE.", "author": "coverbeck", "createdAt": "2020-07-15T21:28:12Z", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/helpers/GitHubSourceCodeRepo.java", "diffHunk": "@@ -885,6 +886,15 @@ protected String getCommitID(String repositoryId, Version version) {\n         return null;\n     }\n \n+    public String getEmail(GHMyself myself) throws IOException {\n+        for (GHEmail email: myself.getEmails2()) {", "originalCommit": "b217f4e1db656acce75cf78371960a8ebaad663a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM3MzY3Mw==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455373673", "bodyText": "From the documentation, getEmails2 always return a collection. The code throws a IOException, but I do not see a NPE being thrown in the code, or in the methods that it uses. This documentation says the method returns 'always non-null': https://github-api.kohsuke.org/apidocs/org/kohsuke/github/GHMyself.html#getEmails2()", "author": "ByteMap", "createdAt": "2020-07-15T21:40:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM2MjU0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM5NDE5Mg==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455394192", "bodyText": "Is this public for a reason?", "author": "denis-yuen", "createdAt": "2020-07-15T22:10:15Z", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/helpers/GitHubSourceCodeRepo.java", "diffHunk": "@@ -885,6 +886,15 @@ protected String getCommitID(String repositoryId, Version version) {\n         return null;\n     }\n \n+    public String getEmail(GHMyself myself) throws IOException {", "originalCommit": "b217f4e1db656acce75cf78371960a8ebaad663a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM5NTQ5Mw==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455395493", "bodyText": "No reason at all, nothing outside of the class is using the getEmail() method. Is it best to change it to private?", "author": "ByteMap", "createdAt": "2020-07-15T22:13:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM5NDE5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQxOTYwNw==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455419607", "bodyText": "Changed it to private.", "author": "ByteMap", "createdAt": "2020-07-15T23:20:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM5NDE5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQyMDI0NA==", "url": "https://github.com/dockstore/dockstore/pull/3667#discussion_r455420244", "bodyText": "Yeah, just makes things easier to reason about.\ne.g. when refactoring, I know I can change this method without breaking anything outside of this class, the IDE can tell me when the method is un-used, etc.", "author": "denis-yuen", "createdAt": "2020-07-15T23:22:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM5NDE5Mg=="}], "type": "inlineReview"}, {"oid": "13a4de73815b9f5fc7514de466b0d6671774bba5", "url": "https://github.com/dockstore/dockstore/commit/13a4de73815b9f5fc7514de466b0d6671774bba5", "message": "Changed \"getEmail\" helper method to private", "committedDate": "2020-07-15T23:19:34Z", "type": "commit"}, {"oid": "8468b590a1a7c7973c65a9a90dd58829dd4de62a", "url": "https://github.com/dockstore/dockstore/commit/8468b590a1a7c7973c65a9a90dd58829dd4de62a", "message": "Merge branch 'develop' into feature/SEAB-1401/collectEmails", "committedDate": "2020-07-15T23:24:24Z", "type": "commit"}, {"oid": "d5afc549ceabb2053a5b859eb799ad156031a5ab", "url": "https://github.com/dockstore/dockstore/commit/d5afc549ceabb2053a5b859eb799ad156031a5ab", "message": "Merge branch 'develop' into feature/SEAB-1401/collectEmails", "committedDate": "2020-07-17T19:49:29Z", "type": "commit"}]}