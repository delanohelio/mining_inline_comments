{"pr_number": 3321, "pr_title": "Fix broken elastic search and my workflows", "pr_createdAt": "2020-03-13T05:22:55Z", "pr_url": "https://github.com/dockstore/dockstore/pull/3321", "timeline": [{"oid": "afc281d3a48cbe9d1934254d34cb523e9068d562", "url": "https://github.com/dockstore/dockstore/commit/afc281d3a48cbe9d1934254d34cb523e9068d562", "message": "Quick fix for broken elastic search and my workflows\n\n#3310\n\nAttempts were being made to assign null to the Java primitive boolean\nisLegacyVersion field in WorkflowVersion. This would happen when\nfetching workflows, which would at least cause ES reindex\nand My Workflows to fail.\n\nDon't allow nulls in the table.\n\nQuick fix because I don't know how it got into the state where the value\nis null. But it makes sense to not allow nulls in any case. Nor did I\nadd a test. But I would like to get dev.dockstore.net working again.", "committedDate": "2020-03-13T00:26:23Z", "type": "commit"}, {"oid": "a222d8e7ea4fe910a09504c294c29485833418aa", "url": "https://github.com/dockstore/dockstore/commit/a222d8e7ea4fe910a09504c294c29485833418aa", "message": "Hopefully the cause of check_migrations failing", "committedDate": "2020-03-13T05:21:54Z", "type": "commit"}, {"oid": "08193594ef2de6294267e80c8cf82a022fa2f5cb", "url": "https://github.com/dockstore/dockstore/commit/08193594ef2de6294267e80c8cf82a022fa2f5cb", "message": "Print out detected migrations", "committedDate": "2020-03-13T05:41:23Z", "type": "commit"}, {"oid": "892e319f2820b4f8ec3058956b17150412bd00e5", "url": "https://github.com/dockstore/dockstore/commit/892e319f2820b4f8ec3058956b17150412bd00e5", "message": "ColumnDefinition needs to match migrations.xml", "committedDate": "2020-03-13T05:58:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjI3MTA3NQ==", "url": "https://github.com/dockstore/dockstore/pull/3321#discussion_r392271075", "bodyText": "FYI, this could lead to some subtle errors. My understanding is that if someone (e.g. a developer or staging) has run this migration already.\nLiquibase will not re-run it with these changes. So they may think they have an up-to-date database but actually something slightly different.", "author": "denis-yuen", "createdAt": "2020-03-13T14:43:24Z", "path": "dockstore-webservice/src/main/resources/migrations.1.9.0.xml", "diffHunk": "@@ -50,10 +50,11 @@\n \n     <changeSet author=\"aduncan (generated)\" id=\"addLegacyVersionColumn\">", "originalCommit": "892e319f2820b4f8ec3058956b17150412bd00e5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjMyNjIzMA==", "url": "https://github.com/dockstore/dockstore/pull/3321#discussion_r392326230", "bodyText": "I figured we had leeway until an actual release; I personally reload the data and run the migrations all the time, so it wouldn't have affected me. :) I'll move it out", "author": "coverbeck", "createdAt": "2020-03-13T16:11:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjI3MTA3NQ=="}], "type": "inlineReview"}, {"oid": "25e5c8a1c4ee9111f50ce6db6734c908bdac5565", "url": "https://github.com/dockstore/dockstore/commit/25e5c8a1c4ee9111f50ce6db6734c908bdac5565", "message": "Move changes into a new changeset\n\nBTW, this branch also tackles #3253", "committedDate": "2020-03-13T19:39:01Z", "type": "commit"}]}