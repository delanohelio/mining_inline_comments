{"pr_number": 3347, "pr_title": "Fix up 1.9.0 migration for new parentid", "pr_createdAt": "2020-03-25T18:20:28Z", "pr_url": "https://github.com/dockstore/dockstore/pull/3347", "timeline": [{"oid": "4d6b96a84d86024191baf13778f9dbadf9a5cdbc", "url": "https://github.com/dockstore/dockstore/commit/4d6b96a84d86024191baf13778f9dbadf9a5cdbc", "message": "Seems to work locally", "committedDate": "2020-03-25T18:19:12Z", "type": "commit"}, {"oid": "b571e4c1364d1333937c08f46c6e9b5834e60b28", "url": "https://github.com/dockstore/dockstore/commit/b571e4c1364d1333937c08f46c6e9b5834e60b28", "message": "Revert \"Switch to postgres 11.6 (#3285)\"\n\nThis reverts commit 135d3687c1fc4721ea630d3108a2530cb24b43cf.", "committedDate": "2020-03-26T19:02:43Z", "type": "commit"}, {"oid": "4aa934fd66185f6cc7b7d3c38e89f993201d2bdc", "url": "https://github.com/dockstore/dockstore/commit/4aa934fd66185f6cc7b7d3c38e89f993201d2bdc", "message": "Try this temporarily", "committedDate": "2020-03-26T21:18:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk0MTU4Mg==", "url": "https://github.com/dockstore/dockstore/pull/3347#discussion_r398941582", "bodyText": "FYI @agduncan94  looks like handleGitHubRelease might be creating duplicates", "author": "denis-yuen", "createdAt": "2020-03-26T22:58:53Z", "path": "dockstore-integration-testing/src/test/java/io/dockstore/webservice/WebhookIT.java", "diffHunk": "@@ -97,10 +97,14 @@ public void testWorkflowMigration() throws Exception {\n         // Refresh should work\n         workflow = workflowApi.refresh(workflow.getId());\n         assertEquals(\"Workflow should be FULL mode\", Workflow.ModeEnum.FULL, workflow.getMode());\n-        assertTrue(\"All versions should be legacy\", workflow.getWorkflowVersions().stream().allMatch(workflowVersion -> workflowVersion.isLegacyVersion()));\n+        assertTrue(\"All versions should be legacy\", workflow.getWorkflowVersions().stream().allMatch(WorkflowVersion::isLegacyVersion));\n+\n+        // seems like handleGitHubRelease has issue with versions that already exist\n+        testingPostgres.runUpdateStatement(\"delete from workflowversion where parentid = \" + workflow.getId());", "originalCommit": "4aa934fd66185f6cc7b7d3c38e89f993201d2bdc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk2MTcxOQ==", "url": "https://github.com/dockstore/dockstore/pull/3347#discussion_r398961719", "bodyText": "Andrew and I were looking at this and I'm trying to fix.", "author": "coverbeck", "createdAt": "2020-03-27T00:00:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk0MTU4Mg=="}], "type": "inlineReview"}]}