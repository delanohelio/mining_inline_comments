{"pr_number": 3748, "pr_title": "App shortcuts", "pr_createdAt": "2020-01-10T15:21:05Z", "pr_url": "https://github.com/AntennaPod/AntennaPod/pull/3748", "timeline": [{"oid": "e84da4c6d652704c0f7288e795036ad5728e7c6b", "url": "https://github.com/AntennaPod/AntennaPod/commit/e84da4c6d652704c0f7288e795036ad5728e7c6b", "message": "Added static shortcuts", "committedDate": "2020-01-10T15:18:06Z", "type": "commit"}, {"oid": "88fc5170def78a425800cc6e699300d3baca5bc9", "url": "https://github.com/AntennaPod/AntennaPod/commit/88fc5170def78a425800cc6e699300d3baca5bc9", "message": "Added Refresh shortcut", "committedDate": "2020-01-10T15:18:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM2Mjk1Ng==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3748#discussion_r365362956", "bodyText": "Do you know another way to do this? I don't really like copying files with only little differences.", "author": "ByteHamster", "createdAt": "2020-01-10T18:11:57Z", "path": "app/src/debug/res/xml/shortcuts.xml", "diffHunk": "@@ -0,0 +1,71 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<shortcuts xmlns:android=\"http://schemas.android.com/apk/res/android\">\n+    <shortcut\n+        android:enabled=\"true\"\n+        android:icon=\"@drawable/ic_list_grey600_24dp\"\n+        android:shortcutId=\"queue\"\n+        android:shortcutShortLabel=\"@string/queue_label\">\n+        <intent\n+            android:action=\"android.intent.action.VIEW\"\n+            android:targetClass=\"de.danoeh.antennapod.activity.MainActivity\"\n+            android:targetPackage=\"de.danoeh.antennapod.debug\">", "originalCommit": "88fc5170def78a425800cc6e699300d3baca5bc9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjM1Mjk1Mg==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3748#discussion_r366352952", "bodyText": "@ByteHamster\nThanks for your comments!\nThis article says,\n\nxml - Static android shortcuts for multiple flavors? - Stack Overflow\nhttps://stackoverflow.com/questions/40361296/static-android-shortcuts-for-multiple-flavors\n\n\nthe package name in the intent can not refer to a string resource and must be hardcoded in the xml.\n\nResourcePlaceholdersPlugin plugin can be used for this problem.\ntimfreiheit/ResourcePlaceholdersPlugin: use manifest placeholders in android resources\nhttps://github.com/timfreiheit/ResourcePlaceholdersPlugin\n789af2b uses this plugin, and app shortcut works well without copying shortcuts.xml.", "author": "mamehacker", "createdAt": "2020-01-14T14:00:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM2Mjk1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM2MzIyOQ==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3748#discussion_r365363229", "bodyText": "Would it be possible to just call AutoUpdateManager.runImmediate(requireContext()); here directly instead of passing it to the queue?", "author": "ByteHamster", "createdAt": "2020-01-10T18:12:45Z", "path": "app/src/main/java/de/danoeh/antennapod/activity/MainActivity.java", "diffHunk": "@@ -826,12 +827,19 @@ public void onFeedListChanged(FeedListUpdateEvent event) {\n     private void handleNavIntent() {\n         Log.d(TAG, \"handleNavIntent()\");\n         Intent intent = getIntent();\n-        if (intent.hasExtra(EXTRA_FEED_ID) ||\n+        if (intent.hasExtra(EXTRA_FEED_ID) || intent.hasExtra(EXTRA_REFRESH_ON_START) ||\n                 (intent.hasExtra(EXTRA_NAV_TYPE) &&\n                         (intent.hasExtra(EXTRA_NAV_INDEX) || intent.hasExtra(EXTRA_FRAGMENT_TAG)))) {\n             int index = intent.getIntExtra(EXTRA_NAV_INDEX, -1);\n             String tag = intent.getStringExtra(EXTRA_FRAGMENT_TAG);\n             Bundle args = intent.getBundleExtra(EXTRA_FRAGMENT_ARGS);\n+            boolean refreshOnStart = intent.getBooleanExtra(EXTRA_REFRESH_ON_START, false);\n+            if (refreshOnStart) {\n+                tag = QueueFragment.TAG;\n+                args = new Bundle();\n+                args.putBoolean(QueueFragment.ARG_REFRESH_ON_START, true);", "originalCommit": "88fc5170def78a425800cc6e699300d3baca5bc9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjM2NjUwMA==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3748#discussion_r366366500", "bodyText": "@ByteHamster\nThat would be better, and fixed at 1167958.\nSome fragments have menu item for refresh, and that is started to animate when app starts via shortcut.\n    <item\n        android:id=\"@+id/refresh_item\"\n        android:title=\"@string/refresh_label\"\n        android:menuCategory=\"container\"\n        custom:showAsAction=\"always\"\n        android:icon=\"?attr/navigation_refresh\"/>\nBut some screens have no menu item for that, like PlaybackHistoryFragment.\nWhen app has been started already and the last screen have no menu item,  user cannot know that app is refreshing all feeds in background.\nShowing toast or something might be helpful to know that.", "author": "mamehacker", "createdAt": "2020-01-14T14:25:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTM2MzIyOQ=="}], "type": "inlineReview"}, {"oid": "789af2b929f244cf4d6724bc38ec55bca606c7b1", "url": "https://github.com/AntennaPod/AntennaPod/commit/789af2b929f244cf4d6724bc38ec55bca606c7b1", "message": "Use ResourcesPlaceholders plugin for shortcuts.xml", "committedDate": "2020-01-14T13:50:29Z", "type": "commit"}, {"oid": "1167958cf58d5faafd41dae7a9ab16d92c440522", "url": "https://github.com/AntennaPod/AntennaPod/commit/1167958cf58d5faafd41dae7a9ab16d92c440522", "message": "Refresh directly on MainActivity", "committedDate": "2020-01-14T13:53:39Z", "type": "commit"}, {"oid": "4aec7bba8c385034cd8c03a5773fbcdd8e4d659c", "url": "https://github.com/AntennaPod/AntennaPod/commit/4aec7bba8c385034cd8c03a5773fbcdd8e4d659c", "message": "Merge branch 'develop' into app-shortcuts", "committedDate": "2020-03-27T23:16:37Z", "type": "commit"}, {"oid": "697bb2a7a6dbba51e366db6cafb7d1dc921466a4", "url": "https://github.com/AntennaPod/AntennaPod/commit/697bb2a7a6dbba51e366db6cafb7d1dc921466a4", "message": "Fix outdated drawables", "committedDate": "2020-03-27T23:17:47Z", "type": "commit"}, {"oid": "b9d3b47f28dde330b1d5305c38384da2b0e15ac3", "url": "https://github.com/AntennaPod/AntennaPod/commit/b9d3b47f28dde330b1d5305c38384da2b0e15ac3", "message": "Add background shape for app shortcut icons", "committedDate": "2020-03-28T03:38:31Z", "type": "commit"}, {"oid": "4a03b3e047b8f00949c9ab559900afee75c43ee7", "url": "https://github.com/AntennaPod/AntennaPod/commit/4a03b3e047b8f00949c9ab559900afee75c43ee7", "message": "Add adaptive icons for shortcuts", "committedDate": "2020-03-28T04:10:43Z", "type": "commit"}, {"oid": "c15701ba53b6f3325a7ffd09cbf97562ab5968aa", "url": "https://github.com/AntennaPod/AntennaPod/commit/c15701ba53b6f3325a7ffd09cbf97562ab5968aa", "message": "Change background color for shortcut icons", "committedDate": "2020-03-28T04:30:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3NTk4MA==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3748#discussion_r399675980", "bodyText": "This argument is now unused. Could you please remove it from all intents in that file?", "author": "ByteHamster", "createdAt": "2020-03-28T15:41:59Z", "path": "app/src/main/res/xml/shortcuts.xml", "diffHunk": "@@ -0,0 +1,71 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<shortcuts xmlns:android=\"http://schemas.android.com/apk/res/android\">\n+    <shortcut\n+        android:enabled=\"true\"\n+        android:icon=\"@drawable/ic_playlist_shortcut\"\n+        android:shortcutId=\"queue\"\n+        android:shortcutShortLabel=\"@string/queue_label\">\n+        <intent\n+            android:action=\"android.intent.action.VIEW\"\n+            android:targetClass=\"de.danoeh.antennapod.activity.MainActivity\"\n+            android:targetPackage=\"${applicationId}\">\n+            <extra\n+                android:name=\"fragment_tag\"\n+                android:value=\"QueueFragment\" />\n+            <extra\n+                android:name=\"nav_type\"\n+                android:value=\"0\" />\n+        </intent>\n+    </shortcut>\n+\n+    <shortcut\n+        android:enabled=\"true\"\n+        android:icon=\"@drawable/ic_feed_shortcut\"\n+        android:shortcutId=\"episodes\"\n+        android:shortcutShortLabel=\"@string/episodes_label\">\n+        <intent\n+            android:action=\"android.intent.action.VIEW\"\n+            android:targetClass=\"de.danoeh.antennapod.activity.MainActivity\"\n+            android:targetPackage=\"${applicationId}\">\n+            <extra\n+                android:name=\"fragment_tag\"\n+                android:value=\"EpisodesFragment\" />\n+            <extra\n+                android:name=\"nav_type\"\n+                android:value=\"0\" />\n+        </intent>\n+    </shortcut>\n+\n+    <shortcut\n+        android:enabled=\"true\"\n+        android:icon=\"@drawable/ic_folder_shortcut\"\n+        android:shortcutId=\"subscriptions\"\n+        android:shortcutShortLabel=\"@string/subscriptions_label\">\n+        <intent\n+            android:action=\"android.intent.action.VIEW\"\n+            android:targetClass=\"de.danoeh.antennapod.activity.MainActivity\"\n+            android:targetPackage=\"${applicationId}\">\n+            <extra\n+                android:name=\"fragment_tag\"\n+                android:value=\"SubscriptionFragment\" />\n+            <extra\n+                android:name=\"nav_type\"\n+                android:value=\"0\" />", "originalCommit": "c15701ba53b6f3325a7ffd09cbf97562ab5968aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxNTcwMw==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3748#discussion_r399715703", "bodyText": "Thank you for pointing this out. This argument has certainly been removed in #3943 . Fixed in 1ac2ef7 .", "author": "mamehacker", "createdAt": "2020-03-28T22:11:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3NTk4MA=="}], "type": "inlineReview"}, {"oid": "1ac2ef753817c814eb84b29ff5d0ec67f4e305a5", "url": "https://github.com/AntennaPod/AntennaPod/commit/1ac2ef753817c814eb84b29ff5d0ec67f4e305a5", "message": "Remove unused intent extras", "committedDate": "2020-03-28T22:02:25Z", "type": "commit"}]}