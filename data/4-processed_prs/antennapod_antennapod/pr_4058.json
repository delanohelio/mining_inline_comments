{"pr_number": 4058, "pr_title": "added media to queue when playing", "pr_createdAt": "2020-04-14T17:55:38Z", "pr_url": "https://github.com/AntennaPod/AntennaPod/pull/4058", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMyOTMzNA==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4058#discussion_r408329334", "bodyText": "Of the 4 cases where playMediaObject() is called, this was the only case I was able to trigger when testing - how do I call OnPlayFromSearch(), OnPlayFromMediaId(), and StartPlayingFromPreferences()?", "author": "michaelmwhite", "createdAt": "2020-04-14T17:58:01Z", "path": "core/src/main/java/de/danoeh/antennapod/core/service/playback/PlaybackService.java", "diffHunk": "@@ -497,6 +497,7 @@ public int onStartCommand(Intent intent, int flags, int startId) {\n                     return Service.START_NOT_STICKY;\n                 }\n                 mediaPlayer.playMediaObject(playable, stream, startWhenPrepared, prepareImmediately);\n+                AddPlayableToQueue(playable);", "originalCommit": "849756933bd0d2bd8a5f6ea6409c8a200e1de4fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM1NzI1Ng==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4058#discussion_r408357256", "bodyText": "Thanks for your pull request. I like the fact that you added a test and try to increase the test coverage \ud83d\udc4d\nStartPlayingFromPreferences can be triggered by sending a Play button keycode to the service without specifying a media file (see PlaybackServiceNotificationBuilder.getPendingIntentForMediaAction).\nThe other methods are related to Android Auto, I think. Not sure how to test those.", "author": "ByteHamster", "createdAt": "2020-04-14T18:45:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMyOTMzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE0Njk3NQ==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4058#discussion_r409146975", "bodyText": "It's hard to write tests for the other cases since they require a lot of internal states within the app to be configured appropriately, so I think this is the only test I'm going to add for now. Is that ok/do you think the PR can be merged in?", "author": "michaelmwhite", "createdAt": "2020-04-15T21:33:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMyOTMzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTE2MDM2Mw==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4058#discussion_r409160363", "bodyText": "Is that ok/do you think the PR can be merged in?\n\nTotally ok :) I did not expect a test in the first place, so even a single one is really nice to have \ud83d\udc4d\nI will have a closer look at the PR soon.", "author": "ByteHamster", "createdAt": "2020-04-15T22:02:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMyOTMzNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTY4MzU3Mg==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4058#discussion_r411683572", "bodyText": "@ByteHamster Have you gotten a chance to look over the pr?", "author": "michaelmwhite", "createdAt": "2020-04-20T20:51:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMyOTMzNA=="}], "type": "inlineReview"}, {"oid": "12a8f05905d0c40e56008cfb6960ba3b2223d14a", "url": "https://github.com/AntennaPod/AntennaPod/commit/12a8f05905d0c40e56008cfb6960ba3b2223d14a", "message": "added media to queue when playing", "committedDate": "2020-04-14T18:01:40Z", "type": "commit"}, {"oid": "12a8f05905d0c40e56008cfb6960ba3b2223d14a", "url": "https://github.com/AntennaPod/AntennaPod/commit/12a8f05905d0c40e56008cfb6960ba3b2223d14a", "message": "added media to queue when playing", "committedDate": "2020-04-14T18:01:40Z", "type": "forcePushed"}, {"oid": "ed0402d53ff023f7ac95711a25a81252f742b366", "url": "https://github.com/AntennaPod/AntennaPod/commit/ed0402d53ff023f7ac95711a25a81252f742b366", "message": "cleaned up imports", "committedDate": "2020-04-14T18:20:17Z", "type": "commit"}, {"oid": "ed0402d53ff023f7ac95711a25a81252f742b366", "url": "https://github.com/AntennaPod/AntennaPod/commit/ed0402d53ff023f7ac95711a25a81252f742b366", "message": "cleaned up imports", "committedDate": "2020-04-14T18:20:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcxODU0OA==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4058#discussion_r411718548", "bodyText": "Sorry for taking so long to respond.\nIf you use addQueueItem(this, false, false, ((FeedMedia) playable).getId()) instead, it does not need to do the database query that retrieves the item.\nBy the way, this also fixes #3277 :) \ud83d\udc4d", "author": "ByteHamster", "createdAt": "2020-04-20T21:55:02Z", "path": "core/src/main/java/de/danoeh/antennapod/core/service/playback/PlaybackService.java", "diffHunk": "@@ -1636,6 +1638,13 @@ private void cancelPositionObserver() {\n         }\n     }\n \n+    private void addPlayableToQueue(Playable playable) {\n+        if (playable instanceof FeedMedia) {\n+            FeedItem feedItem = DBReader.getFeedItem(((FeedMedia) playable).getId());\n+            DBWriter.addQueueItem(this, feedItem);", "originalCommit": "ed0402d53ff023f7ac95711a25a81252f742b366", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjE5MDk0NQ==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4058#discussion_r412190945", "bodyText": "Good call, I updated the pr", "author": "michaelmwhite", "createdAt": "2020-04-21T13:36:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcxODU0OA=="}], "type": "inlineReview"}, {"oid": "47127994b40fa3b25544e0c13c41684a6bff4dea", "url": "https://github.com/AntennaPod/AntennaPod/commit/47127994b40fa3b25544e0c13c41684a6bff4dea", "message": "used id to add item to queue", "committedDate": "2020-04-21T13:25:04Z", "type": "commit"}]}