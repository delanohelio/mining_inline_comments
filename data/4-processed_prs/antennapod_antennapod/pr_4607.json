{"pr_number": 4607, "pr_title": "Local feeds: honor file creation date", "pr_createdAt": "2020-10-27T02:58:31Z", "pr_url": "https://github.com/AntennaPod/AntennaPod/pull/4607", "timeline": [{"oid": "727a5f61c985ad5026e94a7308341bcdc637d072", "url": "https://github.com/AntennaPod/AntennaPod/commit/727a5f61c985ad5026e94a7308341bcdc637d072", "message": "Fix #4598", "committedDate": "2020-10-27T02:50:39Z", "type": "commit"}, {"oid": "ab255afe68485976467e84806734fc83097e053a", "url": "https://github.com/AntennaPod/AntennaPod/commit/ab255afe68485976467e84806734fc83097e053a", "message": "Fix #4598, checkstyle fixed", "committedDate": "2020-10-27T03:21:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzNTA2OQ==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4607#discussion_r512535069", "bodyText": "The METADATA_KEY_DATE format is not specified, so I think it is good to try falling back to DateUtils.parse here. Only if that one returns null either, I would use the file last modified date.", "author": "ByteHamster", "createdAt": "2020-10-27T09:29:09Z", "path": "core/src/main/java/de/danoeh/antennapod/core/feed/LocalFeedUpdater.java", "diffHunk": "@@ -130,12 +134,28 @@ private static FeedItem feedContainsFile(Feed feed, String filename) {\n \n     private static FeedItem createFeedItem(Feed feed, DocumentFile file, Context context) {\n         String uuid = UUID.randomUUID().toString();\n-        FeedItem item = new FeedItem(0, file.getName(), uuid, file.getName(), new Date(),\n-                FeedItem.UNPLAYED, feed);\n-        item.setAutoDownload(false);\n \n         MediaMetadataRetriever mediaMetadataRetriever = new MediaMetadataRetriever();\n         mediaMetadataRetriever.setDataSource(context, file.getUri());\n+        String dateStr = mediaMetadataRetriever.extractMetadata(MediaMetadataRetriever.METADATA_KEY_DATE);\n+\n+        Date date = null;\n+        if (!TextUtils.isEmpty(dateStr)) {\n+            try {\n+                SimpleDateFormat simpleDateFormat = new SimpleDateFormat(\"yyyyMMdd'T'HHmmss\", Locale.getDefault());\n+                date = simpleDateFormat.parse(dateStr);\n+            } catch (ParseException parseException) {", "originalCommit": "ab255afe68485976467e84806734fc83097e053a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjYzOTg0Mw==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4607#discussion_r512639843", "bodyText": "fixed", "author": "moralesg", "createdAt": "2020-10-27T12:09:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzNTA2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzNTI3Ng==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4607#discussion_r512535276", "bodyText": "The comment needs to be updated", "author": "ByteHamster", "createdAt": "2020-10-27T09:29:25Z", "path": "core/src/test/java/de/danoeh/antennapod/core/feed/LocalFeedUpdaterTest.java", "diffHunk": "@@ -149,6 +153,28 @@ public void testUpdateFeed_FeedIconDefault() {\n         assertTrue(feedAfter.getImageUrl().contains(resourceEntryName));\n     }\n \n+    /**\n+     * Test default feed icon if there is no matching file in the local feed media folder.", "originalCommit": "ab255afe68485976467e84806734fc83097e053a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY0MDEzNg==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4607#discussion_r512640136", "bodyText": "fixed", "author": "moralesg", "createdAt": "2020-10-27T12:09:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUzNTI3Ng=="}], "type": "inlineReview"}, {"oid": "731224074534bc92f646495de9f1362d3b4c1715", "url": "https://github.com/AntennaPod/AntennaPod/commit/731224074534bc92f646495de9f1362d3b4c1715", "message": "Fix #4598, defaults to DateUtils in case of exception, checkstyle fixed, test comment fixed", "committedDate": "2020-10-27T12:03:27Z", "type": "commit"}, {"oid": "895e4e7817b33c81c9b89c9afde5652015aca2d4", "url": "https://github.com/AntennaPod/AntennaPod/commit/895e4e7817b33c81c9b89c9afde5652015aca2d4", "message": "Fix #4598, removed unused import", "committedDate": "2020-10-27T22:57:55Z", "type": "commit"}]}