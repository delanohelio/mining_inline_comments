{"pr_number": 2160, "pr_title": "Tekton Backwards Compatibility & Code Sharing", "pr_createdAt": "2020-04-23T10:11:01Z", "pr_url": "https://github.com/fabric8io/kubernetes-client/pull/2160", "timeline": [{"oid": "12ce385d5f899e24e53c07afd2d3c80d8ad0930a", "url": "https://github.com/fabric8io/kubernetes-client/commit/12ce385d5f899e24e53c07afd2d3c80d8ad0930a", "message": "[common]\n- extract go generation logic to shared package\n- extract common model-annotator\n- support for omitempty in the shared generator and model-annotator logic\n- added required indentation style for Makefile in the .editorconfig\n\n[tekton-annotator]\n- replace tekton-annotator with shared model-annotator\n\n[tekton-generator]\n- generate separate tekton schema for versions using different go source dependency version\n- use shared go generation logic for tekton generators\n- use go vendor directory for tekton generators\n- skip building the generator binary for tekton, instead only run the code\n\n[tekton-model]\n- split tekton model by version into v1alpha1 and v1beta1\n- remove the generated *Schema class for tekton", "committedDate": "2020-04-24T08:20:29Z", "type": "commit"}, {"oid": "f6075e9d0f2cec1139d2aa4d56f40620a96e2f49", "url": "https://github.com/fabric8io/kubernetes-client/commit/f6075e9d0f2cec1139d2aa4d56f40620a96e2f49", "message": "tekton: fix wrong MappingProvider registrations causing #2158", "committedDate": "2020-04-24T08:22:10Z", "type": "commit"}, {"oid": "d67bd94275d427ccd0577586ac33be82a7266f6d", "url": "https://github.com/fabric8io/kubernetes-client/commit/d67bd94275d427ccd0577586ac33be82a7266f6d", "message": "tekton: update dependency to kubernetes model after split", "committedDate": "2020-04-24T08:44:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUwNTg5Mg==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416505892", "bodyText": "I remember you said v1alpha1  needed to be built under go 1.13, Does v1beta1 requires it too?", "author": "rohanKanojia", "createdAt": "2020-04-28T10:30:26Z", "path": "extensions/tekton/generator-v1beta1/go.mod", "diffHunk": "@@ -0,0 +1,11 @@\n+module github.com/fabric8io/kubernetes-client/extensions/tekton/generator\n+\n+require (\n+\tgithub.com/fabric8io/kubernetes-client/generator v0.0.0\n+\tgithub.com/tektoncd/pipeline v0.11.2\n+\tk8s.io/apimachinery v0.17.2\n+)\n+\n+replace github.com/fabric8io/kubernetes-client/generator v0.0.0 => ./../../../generator\n+\n+go 1.13", "originalCommit": "d67bd94275d427ccd0577586ac33be82a7266f6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU1NDE4NA==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416554184", "bodyText": "\u00d6hm.. did I? To be honest I can\u00b4t remember and currently also can\u00b4t think of a reason for requiring a specific go version", "author": "Fabian-K", "createdAt": "2020-04-28T11:58:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUwNTg5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUxMTgxMQ==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416511811", "bodyText": "Umm, the same goes for having a global generator. I would rather have it inside extensions rather than at the root of kubernetes client", "author": "rohanKanojia", "createdAt": "2020-04-28T10:40:53Z", "path": "generator/go.mod", "diffHunk": "@@ -0,0 +1,3 @@\n+module github.com/fabric8io/kubernetes-client/generator", "originalCommit": "d67bd94275d427ccd0577586ac33be82a7266f6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU1NjcxOA==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416556718", "bodyText": "Same comment as below :)", "author": "Fabian-K", "createdAt": "2020-04-28T12:02:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUxMTgxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUxMjQ2OQ==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416512469", "bodyText": "Umm, not sure whether it's a good idea to have global model-annotator. I would rather keep an annotator specific to all extensions or maybe to tekton only as it was earlier", "author": "rohanKanojia", "createdAt": "2020-04-28T10:41:54Z", "path": "model-annotator/pom.xml", "diffHunk": "@@ -16,17 +16,18 @@\n     limitations under the License.\n \n -->\n-<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n   <modelVersion>4.0.0</modelVersion>\n   <parent>\n     <groupId>io.fabric8</groupId>\n-    <artifactId>tekton-extension-pom</artifactId>\n+    <artifactId>kubernetes-client-project</artifactId>\n     <version>4.9-SNAPSHOT</version>\n   </parent>\n \n-  <artifactId>tekton-model-annotator</artifactId>\n+  <artifactId>model-annotator</artifactId>", "originalCommit": "d67bd94275d427ccd0577586ac33be82a7266f6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU1NjQ1OQ==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416556459", "bodyText": "I think that with a good model-annotator there is no reason to have specific (currently just copy&pasted implementations) for the modules (tekon, knative, ...). I know that this implementation at the current point can at least be used for tekton and knative and maybe even further (including default k8s).\nBut I\u00b4m open to moving it somewhere else :)", "author": "Fabian-K", "createdAt": "2020-04-28T12:02:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUxMjQ2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUyMjI4Nw==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416522287", "bodyText": "I remember @iocanel added our own ArrayOrString #2140 Maybe it got lost when we merged some changes", "author": "rohanKanojia", "createdAt": "2020-04-28T10:59:24Z", "path": "extensions/tekton/generator-v1alpha1/cmd/generate/generate.go", "diffHunk": "@@ -16,48 +16,41 @@\n package main\n \n import (\n-\t\"bytes\"\n-\t\"encoding/json\"\n \t\"fmt\"\n-\t\"github.com/fabric8io/kubernetes-client/extensions/tekton/generator/pkg/schemagen\"\n+\t\"github.com/fabric8io/kubernetes-client/generator/pkg/schemagen\"\n \t\"github.com/tektoncd/pipeline/pkg/apis/pipeline/v1alpha1\"\n-\t\"github.com/tektoncd/pipeline/pkg/apis/pipeline/v1beta1\"\n \tresource \"github.com/tektoncd/pipeline/pkg/apis/resource/v1alpha1\"\n \tmachinery \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n-\t\"log\"\n \t\"reflect\"\n )\n \n func main() {\n \n+\t// continue from here -> somehow the ArrayOrString is fucked up\n+\t// and local changes of common part are not considered ?!\n+", "originalCommit": "d67bd94275d427ccd0577586ac33be82a7266f6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU1ODI3Mg==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2160#discussion_r416558272", "bodyText": "ups, that comment should not be in there \ud83d\ude48 - it was only temporary as a reminder for myself and is resolved. I\u00b4ll remove it.", "author": "Fabian-K", "createdAt": "2020-04-28T12:05:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjUyMjI4Nw=="}], "type": "inlineReview"}, {"oid": "24720d570b0788e182cb29e7c0e2757ffdca2731", "url": "https://github.com/fabric8io/kubernetes-client/commit/24720d570b0788e182cb29e7c0e2757ffdca2731", "message": "tekton: update dependency to kubernetes model after split", "committedDate": "2020-04-29T08:05:13Z", "type": "commit"}, {"oid": "24720d570b0788e182cb29e7c0e2757ffdca2731", "url": "https://github.com/fabric8io/kubernetes-client/commit/24720d570b0788e182cb29e7c0e2757ffdca2731", "message": "tekton: update dependency to kubernetes model after split", "committedDate": "2020-04-29T08:05:13Z", "type": "forcePushed"}]}