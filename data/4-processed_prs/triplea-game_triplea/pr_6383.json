{"pr_number": 6383, "pr_title": "Fix MoveValidator.java NPEs from player.getData()", "pr_createdAt": "2020-05-04T20:46:02Z", "pr_url": "https://github.com/triplea-game/triplea/pull/6383", "timeline": [{"oid": "a36c423cf39440a138b8958f6abb441cc4e5fcf8", "url": "https://github.com/triplea-game/triplea/commit/a36c423cf39440a138b8958f6abb441cc4e5fcf8", "message": "Fix NPE from player.getData()\n\n- Marked GameDataComponent#getGameData as nullable\n- The NULL_PLAYER is initialized with a nulled game data, which is then\n  retrieved via 'GameDataComponent#getGameData' making it nullable.\n  This implies any calls to 'player.getData()' can return a null reference.\n- Fix NPE from 'player.getData()' in MoveValidator by making MoveValidator\n  stateful, initialize it with a non-null 'GameData' and then use that\n  gameData object instead of the potentially null 'player.getGameData'\n\nFix NPE reported in: https://github.com/triplea-game/triplea/issues/6365", "committedDate": "2020-05-04T20:44:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTcxODM4NA==", "url": "https://github.com/triplea-game/triplea/pull/6383#discussion_r419718384", "bodyText": "Avoid deeply nested control flow statements.", "author": "codeclimate", "createdAt": "2020-05-04T20:47:53Z", "path": "game-core/src/main/java/games/strategy/triplea/ai/pro/ProTechAi.java", "diffHunk": "@@ -433,7 +433,7 @@ private static float determineEnemyBlitzStrength(\n           }\n           if (sea) {\n             final Route r = new Route(neighbor, current);\n-            if (MoveValidator.validateCanal(r, null, player) != null) {\n+            if (new MoveValidator(data).validateCanal(r, null, player) != null) {", "originalCommit": "a36c423cf39440a138b8958f6abb441cc4e5fcf8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1bcc0fd769a8adc77e458a18997e520c76439163", "url": "https://github.com/triplea-game/triplea/commit/1bcc0fd769a8adc77e458a18997e520c76439163", "message": "Update tests", "committedDate": "2020-05-04T21:13:54Z", "type": "commit"}]}