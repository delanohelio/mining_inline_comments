{"pr_number": 7799, "pr_title": "Add preliminary Dockerfile for Node-BB", "pr_createdAt": "2020-09-27T18:40:35Z", "pr_url": "https://github.com/triplea-game/triplea/pull/7799", "timeline": [{"oid": "e93e1db772531937ccacc52c1a9ac0d449fbb1c8", "url": "https://github.com/triplea-game/triplea/commit/e93e1db772531937ccacc52c1a9ac0d449fbb1c8", "message": "Add preliminary Dockerfile for Node-BB\n\n- Allows for a container to be built\n- Getting errors on run", "committedDate": "2020-09-27T18:39:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY0MjQyOQ==", "url": "https://github.com/triplea-game/triplea/pull/7799#discussion_r495642429", "bodyText": "I'm not 100% sure if \"nodebb start\" (works without specifying node because of shebang) works as expected inside docker-\nIIRC ./nodebb start just spins up a daemon service and terminates itself soon after.\nThe current systemd script runs /usr/bin/env node loader.js, which spins up the process directly.", "author": "RoiEXLab", "createdAt": "2020-09-28T00:55:03Z", "path": "node-bb/Dockerfile", "diffHunk": "@@ -0,0 +1,23 @@\n+FROM node:lts\n+\n+RUN mkdir -p /usr/src/app\n+WORKDIR /usr/src/app\n+\n+ARG NODE_ENV\n+ENV NODE_ENV $NODE_ENV\n+\n+COPY install/package.json /usr/src/app/package.json\n+\n+RUN npm install --only=prod && \\\n+    npm cache clean --force\n+    \n+COPY . /usr/src/app\n+\n+ENV NODE_ENV=production \\\n+    daemon=false \\\n+    silent=false\n+\n+EXPOSE 4567\n+\n+CMD node ./nodebb build ;  node ./nodebb start", "originalCommit": "e93e1db772531937ccacc52c1a9ac0d449fbb1c8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY0MzI2Nw==", "url": "https://github.com/triplea-game/triplea/pull/7799#discussion_r495643267", "bodyText": "This docker file is verbatim from: https://hub.docker.com/r/nodebb/docker/\nYour guess is as good as mine if there is anything missing.", "author": "DanVanAtta", "createdAt": "2020-09-28T01:00:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTY0MjQyOQ=="}], "type": "inlineReview"}, {"oid": "c192be865599f2aa62879d44ae882aa4f68a0d61", "url": "https://github.com/triplea-game/triplea/commit/c192be865599f2aa62879d44ae882aa4f68a0d61", "message": "Update Node-BB Dockerfile. Add README.md, and example config.json (#7906)\n\n* NodeBB Dockerfile, README.md, and example config.json\r\n\r\n* Adding more info to the configuration section.\r\n\r\n* Updated README.md and config.json for running Mongo", "committedDate": "2020-10-27T19:38:15Z", "type": "commit"}]}