{"pr_number": 7241, "pr_title": "Break up Help Menu & Replace About Menu Item with link to license", "pr_createdAt": "2020-07-25T02:15:52Z", "pr_url": "https://github.com/triplea-game/triplea/pull/7241", "timeline": [{"oid": "36efc858ed63ad2324c7fe801547a11e949d1cbd", "url": "https://github.com/triplea-game/triplea/commit/36efc858ed63ad2324c7fe801547a11e949d1cbd", "message": "Move 'HelpMenu' to its own package", "committedDate": "2020-07-25T00:43:34Z", "type": "commit"}, {"oid": "0c8fd34a3eafd56b63eeeb2bd89f54440ba26e2a", "url": "https://github.com/triplea-game/triplea/commit/0c8fd34a3eafd56b63eeeb2bd89f54440ba26e2a", "message": "Split up HelpMenu into package-protected classes per menu-item", "committedDate": "2020-07-25T02:02:11Z", "type": "commit"}, {"oid": "96edd86d642477ab3bfbbf69f27cebbedf082cc9", "url": "https://github.com/triplea-game/triplea/commit/96edd86d642477ab3bfbbf69f27cebbedf082cc9", "message": "Drop AboutMenu\n\n- Engine and map information are displayed in other locations,\n  this makes most of the information in About Menu redundant\n- The about menu duplicates the license text, that is already\n  found in other locations. We can link to it instead\n- The 'license' link in the about menu is not useful, it can\n  neither be clicked nor copy-pasted\n- The menu has an incorrect title, should be \"about TripleA\"\n  rather than \"about <Game>\".\n- It is a point of maintenance, the accreditation is out of\n  date.\n\nBeyond the above, it the about menu does not contain very\nmuch information. The website link is perhaps the only\nthing beyond this..", "committedDate": "2020-07-25T02:12:36Z", "type": "commit"}, {"oid": "24b78dee36ccdc42f810f96a85493567c5553a50", "url": "https://github.com/triplea-game/triplea/commit/24b78dee36ccdc42f810f96a85493567c5553a50", "message": "Minor finishing fixes and formatting.", "committedDate": "2020-07-25T02:12:36Z", "type": "commit"}, {"oid": "6fe4d466be565cf17ac85cec2a5aafc666023c96", "url": "https://github.com/triplea-game/triplea/commit/6fe4d466be565cf17ac85cec2a5aafc666023c96", "message": "Inline bug report menu and add menu item to open the game license", "committedDate": "2020-07-25T02:12:36Z", "type": "commit"}, {"oid": "71ea73e7716af209a7c7760df8f96433dc5aa3bb", "url": "https://github.com/triplea-game/triplea/commit/71ea73e7716af209a7c7760df8f96433dc5aa3bb", "message": "Formatting", "committedDate": "2020-07-25T02:12:36Z", "type": "commit"}, {"oid": "3f92cb40146a5de481e5ba4392d3c55f45825034", "url": "https://github.com/triplea-game/triplea/commit/3f92cb40146a5de481e5ba4392d3c55f45825034", "message": "Mark UnitStatsTable as @UtilityClass", "committedDate": "2020-07-25T04:19:20Z", "type": "commit"}, {"oid": "2c895c4048ecd8df243526fb2b6301f249df31b5", "url": "https://github.com/triplea-game/triplea/commit/2c895c4048ecd8df243526fb2b6301f249df31b5", "message": "Remove unnecessary extends JMenu", "committedDate": "2020-07-25T04:28:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM2NDYwNQ==", "url": "https://github.com/triplea-game/triplea/pull/7241#discussion_r460364605", "bodyText": "Method getUnitStatsTable has 60 lines of code (exceeds 30 allowed). Consider refactoring.", "author": "codeclimate", "createdAt": "2020-07-25T04:45:54Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/menubar/help/UnitStatsTable.java", "diffHunk": "@@ -0,0 +1,95 @@\n+package games.strategy.triplea.ui.menubar.help;\n+\n+import games.strategy.engine.data.GameData;\n+import games.strategy.engine.data.GamePlayer;\n+import games.strategy.engine.data.ResourceCollection;\n+import games.strategy.engine.data.UnitType;\n+import games.strategy.triplea.image.UnitImageFactory;\n+import games.strategy.triplea.ui.TooltipProperties;\n+import games.strategy.triplea.ui.UiContext;\n+import games.strategy.triplea.util.TuvUtils;\n+import java.net.URL;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import lombok.experimental.UtilityClass;\n+\n+@UtilityClass\n+public class UnitStatsTable {\n+\n+  public static String getUnitStatsTable(final GameData gameData, final UiContext uiContext) {", "originalCommit": "2c895c4048ecd8df243526fb2b6301f249df31b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM2NDYwNw==", "url": "https://github.com/triplea-game/triplea/pull/7241#discussion_r460364607", "bodyText": "Method buildMenu has 59 lines of code (exceeds 30 allowed). Consider refactoring.", "author": "codeclimate", "createdAt": "2020-07-25T04:45:54Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/menubar/help/MoveHelpMenu.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package games.strategy.triplea.ui.menubar.help;\n+\n+import javax.swing.Action;\n+import javax.swing.JEditorPane;\n+import javax.swing.JOptionPane;\n+import javax.swing.JScrollPane;\n+import lombok.experimental.UtilityClass;\n+import org.triplea.swing.SwingAction;\n+\n+@UtilityClass\n+class MoveHelpMenu {\n+  private static final String moveSelectionHelpTitle = \"Movement/Selection Help\";\n+\n+  Action buildMenu() {", "originalCommit": "2c895c4048ecd8df243526fb2b6301f249df31b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM2NDYwOA==", "url": "https://github.com/triplea-game/triplea/pull/7241#discussion_r460364608", "bodyText": "Similar blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-07-25T04:45:54Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/menubar/help/MoveHelpMenu.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package games.strategy.triplea.ui.menubar.help;\n+\n+import javax.swing.Action;\n+import javax.swing.JEditorPane;\n+import javax.swing.JOptionPane;\n+import javax.swing.JScrollPane;\n+import lombok.experimental.UtilityClass;\n+import org.triplea.swing.SwingAction;\n+\n+@UtilityClass\n+class MoveHelpMenu {\n+  private static final String moveSelectionHelpTitle = \"Movement/Selection Help\";\n+\n+  Action buildMenu() {\n+    return SwingAction.of(\n+        moveSelectionHelpTitle,\n+        e -> {\n+          // html formatted string\n+          final JEditorPane editorPane = new JEditorPane();\n+          editorPane.setEditable(false);\n+          editorPane.setContentType(\"text/html\");\n+          final String hints =\n+              \"<b> Selecting Units</b><br>\"", "originalCommit": "2c895c4048ecd8df243526fb2b6301f249df31b5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM5NjAyOA==", "url": "https://github.com/triplea-game/triplea/pull/7241#discussion_r460396028", "bodyText": "Not related to this PR, but ((i & 1) == 0) is way more complicated than using i % 2 == 0", "author": "RoiEXLab", "createdAt": "2020-07-25T11:33:20Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/menubar/help/UnitStatsTable.java", "diffHunk": "@@ -0,0 +1,93 @@\n+package games.strategy.triplea.ui.menubar.help;\n+\n+import games.strategy.engine.data.GameData;\n+import games.strategy.engine.data.GamePlayer;\n+import games.strategy.engine.data.ResourceCollection;\n+import games.strategy.engine.data.UnitType;\n+import games.strategy.triplea.image.UnitImageFactory;\n+import games.strategy.triplea.ui.TooltipProperties;\n+import games.strategy.triplea.ui.UiContext;\n+import games.strategy.triplea.util.TuvUtils;\n+import java.net.URL;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+public class UnitStatsTable {\n+\n+  public static String getUnitStatsTable(final GameData gameData, final UiContext uiContext) {\n+    // html formatted string\n+    final StringBuilder hints = new StringBuilder();\n+    hints.append(\"<html>\");\n+    hints.append(\"<head><style>th, tr{color:black}</style></head>\");\n+    try {\n+      gameData.acquireReadLock();\n+      final Map<GamePlayer, Map<UnitType, ResourceCollection>> costs =\n+          TuvUtils.getResourceCostsForTuv(gameData, true);\n+      final Map<GamePlayer, List<UnitType>> playerUnitTypes =\n+          UnitType.getAllPlayerUnitsWithImages(gameData, uiContext, true);\n+      final String color3 = \"FEECE2\";\n+      final String color2 = \"BDBDBD\";\n+      final String color1 = \"ABABAB\";\n+      int i = 0;\n+      for (final Map.Entry<GamePlayer, List<UnitType>> entry : playerUnitTypes.entrySet()) {\n+        final GamePlayer player = entry.getKey();\n+        hints.append(\"<p><table border=\\\"1\\\" bgcolor=\\\"\" + color1 + \"\\\">\");\n+        hints\n+            .append(\n+                \"<tr><th style=\\\"font-size:120%;000000\\\" bgcolor=\\\"\" + color3 + \"\\\" colspan=\\\"4\\\">\")\n+            .append(player == null ? \"NULL\" : player.getName())\n+            .append(\" Units</th></tr>\");\n+        hints\n+            .append(\"<tr\")\n+            .append(((i & 1) == 0) ? \" bgcolor=\\\"\" + color1 + \"\\\"\" : \" bgcolor=\\\"\" + color2 + \"\\\"\")\n+            .append(\"><td>Unit</td><td>Name</td><td>Cost</td><td>Tool Tip</td></tr>\");\n+        for (final UnitType ut : entry.getValue()) {\n+          if (uiContext.getMapData().shouldDrawUnit(ut.getName())) {\n+            i++;\n+            hints\n+                .append(\"<tr\")\n+                .append(\n+                    ((i & 1) == 0) ? \" bgcolor=\\\"\" + color1 + \"\\\"\" : \" bgcolor=\\\"\" + color2 + \"\\\"\")", "originalCommit": "0c8fd34a3eafd56b63eeeb2bd89f54440ba26e2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM5NjY1MA==", "url": "https://github.com/triplea-game/triplea/pull/7241#discussion_r460396650", "bodyText": "Another Side-Note:\nThe ternary expression could also just be used for the actual color, to avoid the duplicate bgcolor= part around it.\nRant Warning!\nWe use a lot of HTML inside swing, which makes this kind of stuff easier to layout but at the same time I think this is a place where simply going with a lot of swing objects would be the best move.\nAlso in the HTML world using stuff like bgcolor is only done for legacy browser engines, nowadays you'd just write something like\ntr {\n  background-color: /*color 1 */;\n}\ntr:nth-child(2n) {\n  background-color: /* color 2 */;\n}\n\nwhich makes the browser alternate between the colors automatically", "author": "RoiEXLab", "createdAt": "2020-07-25T11:41:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM5NjAyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM5NzE4OA==", "url": "https://github.com/triplea-game/triplea/pull/7241#discussion_r460397188", "bodyText": "Unrelated too, I just don't get it though\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"<tr><th style=\\\"font-size:120%;000000\\\" bgcolor=\\\"\" + color3 + \"\\\" colspan=\\\"4\\\">\")\n          \n          \n            \n                            \"<tr><th style=\\\"font-size:120%;\\\" bgcolor=\\\"\" + color3 + \"\\\" colspan=\\\"4\\\">\")", "author": "RoiEXLab", "createdAt": "2020-07-25T11:48:12Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/menubar/help/UnitStatsTable.java", "diffHunk": "@@ -0,0 +1,93 @@\n+package games.strategy.triplea.ui.menubar.help;\n+\n+import games.strategy.engine.data.GameData;\n+import games.strategy.engine.data.GamePlayer;\n+import games.strategy.engine.data.ResourceCollection;\n+import games.strategy.engine.data.UnitType;\n+import games.strategy.triplea.image.UnitImageFactory;\n+import games.strategy.triplea.ui.TooltipProperties;\n+import games.strategy.triplea.ui.UiContext;\n+import games.strategy.triplea.util.TuvUtils;\n+import java.net.URL;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+public class UnitStatsTable {\n+\n+  public static String getUnitStatsTable(final GameData gameData, final UiContext uiContext) {\n+    // html formatted string\n+    final StringBuilder hints = new StringBuilder();\n+    hints.append(\"<html>\");\n+    hints.append(\"<head><style>th, tr{color:black}</style></head>\");\n+    try {\n+      gameData.acquireReadLock();\n+      final Map<GamePlayer, Map<UnitType, ResourceCollection>> costs =\n+          TuvUtils.getResourceCostsForTuv(gameData, true);\n+      final Map<GamePlayer, List<UnitType>> playerUnitTypes =\n+          UnitType.getAllPlayerUnitsWithImages(gameData, uiContext, true);\n+      final String color3 = \"FEECE2\";\n+      final String color2 = \"BDBDBD\";\n+      final String color1 = \"ABABAB\";\n+      int i = 0;\n+      for (final Map.Entry<GamePlayer, List<UnitType>> entry : playerUnitTypes.entrySet()) {\n+        final GamePlayer player = entry.getKey();\n+        hints.append(\"<p><table border=\\\"1\\\" bgcolor=\\\"\" + color1 + \"\\\">\");\n+        hints\n+            .append(\n+                \"<tr><th style=\\\"font-size:120%;000000\\\" bgcolor=\\\"\" + color3 + \"\\\" colspan=\\\"4\\\">\")", "originalCommit": "0c8fd34a3eafd56b63eeeb2bd89f54440ba26e2a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}