{"pr_number": 6556, "pr_title": "Update Flyway deployment", "pr_createdAt": "2020-06-01T03:57:13Z", "pr_url": "https://github.com/triplea-game/triplea/pull/6556", "timeline": [{"oid": "c0697b3a7abb04d79afa0da7db00a219872e4440", "url": "https://github.com/triplea-game/triplea/commit/c0697b3a7abb04d79afa0da7db00a219872e4440", "message": "Update Flyway deployment\n\n- Instead of changing user to flyway (brittle if not already root),\n  instead use explicit ownership commands to change ownership\n  of flyway download artifacts.\n- Inline deployment zip variable (to simplify)", "committedDate": "2020-06-01T03:53:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzUxNjE5OQ==", "url": "https://github.com/triplea-game/triplea/pull/6556#discussion_r433516199", "bodyText": "Curious to know why you decided inlining this variable would be a better choice", "author": "RoiEXLab", "createdAt": "2020-06-01T22:07:58Z", "path": "infrastructure/ansible/roles/flyway/tasks/main.yml", "diffHunk": "@@ -7,47 +7,46 @@\n \n - name: Download flyway CLI\n   become: true\n-  become_user: flyway\n   get_url:\n     url: \"{{ flyway_download_location }}\"\n-    dest: \"{{ flyway_downloaded_file_location }}\"\n+    dest: \"/home/flyway/flyway-cli.tar.gz\"\n     mode: \"644\"\n     checksum: \"md5:57f496acc6399fe30ee1fd957545abf1\"\n+    owner: flyway\n+    group: flyway\n \n - name: extract flyway\n   become: true\n-  become_user: flyway\n   unarchive:\n     copy: no\n-    src: \"{{ flyway_downloaded_file_location }}\"", "originalCommit": "c0697b3a7abb04d79afa0da7db00a219872e4440", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzU1OTQwNA==", "url": "https://github.com/triplea-game/triplea/pull/6556#discussion_r433559404", "bodyText": "I think it was a bit over-zeolous using of variables. Reducing this level of duplication is not worth very much, and it was more confusing to know where the file was being created which made it harder to diagnose permission errors writing to that location. There is also about zero chance we would want to override it, so that in combination with the little de-duping value and that it's used in close proximity; it's a case where a variable does not really help IMO. I think to another extent key configurations are better as variables as well, things that are duplicated a lot or do have overrides. To another extent keeping the variables to a shorter list is a good thing, this one is more of an intermediate value as well and the path could almost just as well be /tmp (so it's not the most valuable of abstractions).", "author": "DanVanAtta", "createdAt": "2020-06-02T00:35:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzUxNjE5OQ=="}], "type": "inlineReview"}, {"oid": "2334e9782b6ee742ea2afb54461785b8299b8f25", "url": "https://github.com/triplea-game/triplea/commit/2334e9782b6ee742ea2afb54461785b8299b8f25", "message": "Merge branch 'master' into ansible-flyway", "committedDate": "2020-06-02T00:36:28Z", "type": "commit"}]}