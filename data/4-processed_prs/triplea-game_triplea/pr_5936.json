{"pr_number": 5936, "pr_title": "Forum poster structure", "pr_createdAt": "2020-02-15T20:58:14Z", "pr_url": "https://github.com/triplea-game/triplea/pull/5936", "timeline": [{"oid": "13c4497f9df28ec0352ae9de740f9f35e770d89f", "url": "https://github.com/triplea-game/triplea/commit/13c4497f9df28ec0352ae9de740f9f35e770d89f", "message": "Collapse forum poster heirarchy to be configuration injection instead of inheritance.", "committedDate": "2020-02-15T20:54:06Z", "type": "commit"}, {"oid": "86d51a5ad72e23e2df8b9421823b18134a5e4ba3", "url": "https://github.com/triplea-game/triplea/commit/86d51a5ad72e23e2df8b9421823b18134a5e4ba3", "message": "Finish combining IForum interface into NodeBbForumPoster", "committedDate": "2020-02-15T20:54:09Z", "type": "commit"}, {"oid": "a2b2055d847d35acab20b98b793ad467fcf40259", "url": "https://github.com/triplea-game/triplea/commit/a2b2055d847d35acab20b98b793ad467fcf40259", "message": "Add TODO to merge IForumPoster constants to another class", "committedDate": "2020-02-15T20:54:09Z", "type": "commit"}, {"oid": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3", "url": "https://github.com/triplea-game/triplea/commit/7d18143f2e9be2c54dfce6dda8c55c7345dd98b3", "message": "Update javadoc method to be current", "committedDate": "2020-02-15T20:55:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg1NTg1NQ==", "url": "https://github.com/triplea-game/triplea/pull/5936#discussion_r379855855", "bodyText": "Identical blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-15T21:01:56Z", "path": "game-core/src/main/java/games/strategy/engine/posted/game/pbf/NodeBbForumPoster.java", "diffHunk": "@@ -29,24 +32,92 @@\n import org.snakeyaml.engine.v2.api.Load;\n import org.snakeyaml.engine.v2.api.LoadSettings;\n import org.triplea.awt.OpenFileUtility;\n+import org.triplea.util.Arrays;\n \n /**\n  * Posts turn summaries to a NodeBB based forum of your choice.\n  *\n  * <p>URL format is {@code https://your.forumurl.com/api/v2/topics/<topicID>}.\n  */\n @Log\n-@AllArgsConstructor(access = AccessLevel.PACKAGE)\n-abstract class NodeBbForumPoster implements IForumPoster {\n+public class NodeBbForumPoster {\n+\n+  public static final String AXIS_AND_ALLIES_ORG_DISPLAY_NAME = \"www.axisandallies.org/forums/\";\n+  public static final String TRIPLEA_FORUM_DISPLAY_NAME = \"forums.triplea-game.org\";\n \n   private final Load load = new Load(LoadSettings.builder().build());\n   private final int topicId;\n   private final String username;\n   private final String password;\n+  private final String forumUrl;\n+\n+  @Builder\n+  public static class ForumPostingParameters {\n+    @Nonnull private final Integer topicId;\n+    @Nonnull private final char[] username;\n+    @Nonnull private final char[] password;\n+    @Nonnull private final String forumUrl;\n+  }\n+\n+  private NodeBbForumPoster(final ForumPostingParameters forumPostingParameters) {\n+    this.topicId = forumPostingParameters.topicId;\n+    this.forumUrl = forumPostingParameters.forumUrl;\n+    this.username =\n+        Arrays.withSensitiveArrayAndReturn(() -> forumPostingParameters.username, String::new);\n+    this.password =\n+        Arrays.withSensitiveArrayAndReturn(() -> forumPostingParameters.password, String::new);\n+  }\n+\n+  /**\n+   * Creates a {@link NodeBbForumPoster} instance based on the given arguments and the configured\n+   * settings.\n+   */\n+  public static NodeBbForumPoster newInstanceByName(final String name, final int topicId) {\n+    switch (name) {\n+      case NodeBbForumPoster.TRIPLEA_FORUM_DISPLAY_NAME:", "originalCommit": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg1NTg1Ng==", "url": "https://github.com/triplea-game/triplea/pull/5936#discussion_r379855856", "bodyText": "Identical blocks of code found in 2 locations. Consider refactoring.", "author": "codeclimate", "createdAt": "2020-02-15T21:01:57Z", "path": "game-core/src/main/java/games/strategy/engine/posted/game/pbf/NodeBbForumPoster.java", "diffHunk": "@@ -29,24 +32,92 @@\n import org.snakeyaml.engine.v2.api.Load;\n import org.snakeyaml.engine.v2.api.LoadSettings;\n import org.triplea.awt.OpenFileUtility;\n+import org.triplea.util.Arrays;\n \n /**\n  * Posts turn summaries to a NodeBB based forum of your choice.\n  *\n  * <p>URL format is {@code https://your.forumurl.com/api/v2/topics/<topicID>}.\n  */\n @Log\n-@AllArgsConstructor(access = AccessLevel.PACKAGE)\n-abstract class NodeBbForumPoster implements IForumPoster {\n+public class NodeBbForumPoster {\n+\n+  public static final String AXIS_AND_ALLIES_ORG_DISPLAY_NAME = \"www.axisandallies.org/forums/\";\n+  public static final String TRIPLEA_FORUM_DISPLAY_NAME = \"forums.triplea-game.org\";\n \n   private final Load load = new Load(LoadSettings.builder().build());\n   private final int topicId;\n   private final String username;\n   private final String password;\n+  private final String forumUrl;\n+\n+  @Builder\n+  public static class ForumPostingParameters {\n+    @Nonnull private final Integer topicId;\n+    @Nonnull private final char[] username;\n+    @Nonnull private final char[] password;\n+    @Nonnull private final String forumUrl;\n+  }\n+\n+  private NodeBbForumPoster(final ForumPostingParameters forumPostingParameters) {\n+    this.topicId = forumPostingParameters.topicId;\n+    this.forumUrl = forumPostingParameters.forumUrl;\n+    this.username =\n+        Arrays.withSensitiveArrayAndReturn(() -> forumPostingParameters.username, String::new);\n+    this.password =\n+        Arrays.withSensitiveArrayAndReturn(() -> forumPostingParameters.password, String::new);\n+  }\n+\n+  /**\n+   * Creates a {@link NodeBbForumPoster} instance based on the given arguments and the configured\n+   * settings.\n+   */\n+  public static NodeBbForumPoster newInstanceByName(final String name, final int topicId) {\n+    switch (name) {\n+      case NodeBbForumPoster.TRIPLEA_FORUM_DISPLAY_NAME:\n+        return new NodeBbForumPoster(\n+            ForumPostingParameters.builder()\n+                .topicId(topicId)\n+                .username(ClientSetting.tripleaForumUsername.getValueOrThrow())\n+                .password(ClientSetting.tripleaForumPassword.getValueOrThrow())\n+                .forumUrl(UrlConstants.TRIPLEA_FORUM)\n+                .build());\n+      case NodeBbForumPoster.AXIS_AND_ALLIES_ORG_DISPLAY_NAME:", "originalCommit": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg1NTg1Nw==", "url": "https://github.com/triplea-game/triplea/pull/5936#discussion_r379855857", "bodyText": "TODO found", "author": "codeclimate", "createdAt": "2020-02-15T21:01:57Z", "path": "game-core/src/main/java/games/strategy/engine/posted/game/pbf/IForumPoster.java", "diffHunk": "@@ -1,79 +1,13 @@\n package games.strategy.engine.posted.game.pbf;\n \n-import com.google.common.collect.ImmutableSet;\n-import games.strategy.triplea.settings.ClientSetting;\n-import java.nio.file.Path;\n-import java.util.concurrent.CompletableFuture;\n-import org.triplea.util.Arrays;\n-\n /**\n  * An interface for classes that can post a turn summary, the summary may also include a save game\n  * if the implementing class supports this.\n  */\n+// TODO: merge these constants into another class, perhaps GameProperties or NodeBbForumPoster", "originalCommit": "7d18143f2e9be2c54dfce6dda8c55c7345dd98b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "274aa72b1a4c47d1b45b240a3cbed62a45821c7e", "url": "https://github.com/triplea-game/triplea/commit/274aa72b1a4c47d1b45b240a3cbed62a45821c7e", "message": "Update PbemMessagePoster to reflect restructure", "committedDate": "2020-02-15T21:11:14Z", "type": "commit"}]}