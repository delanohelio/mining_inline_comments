{"pr_number": 6664, "pr_title": "Remove legacy MD5Crypt Password", "pr_createdAt": "2020-06-10T03:57:08Z", "pr_url": "https://github.com/triplea-game/triplea/pull/6664", "timeline": [{"oid": "213fefb517a89006fc8b169ad60f08e22eefcc0c", "url": "https://github.com/triplea-game/triplea/commit/213fefb517a89006fc8b169ad60f08e22eefcc0c", "message": "Remove legacy MD5Crypt Password\n\nAll accounts being migrated to 2.0 have a bcrypt password, we\nno longer need the legacy 'password' column on lobby_user\nwhich stored passes as MD5Crypt.\n\nThis update:\n- removes the md5crypt'ed password column\n- adds a non-null constraint to the bcrypt_password column\n- moves SHA512 password hashing from server to client.\n  The SHA512 password hash is simply so that those that\n  control the server cannot know the plain-text password\n  of a user. The SHA512 hash is *not* intended to protect\n  the password on the client-side.\n- Simplifies some of the password hash verification logic\n  by collapsing intermediary function objects.", "committedDate": "2020-06-10T03:51:45Z", "type": "commit"}, {"oid": "f73a1ec9bd40fa9c00ce51e837ad34d0696c0926", "url": "https://github.com/triplea-game/triplea/commit/f73a1ec9bd40fa9c00ce51e837ad34d0696c0926", "message": "Auto-Formatting", "committedDate": "2020-06-10T03:56:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODMwMTcxNw==", "url": "https://github.com/triplea-game/triplea/pull/6664#discussion_r438301717", "bodyText": "IIRC we have a constraint that ensures that at least one of the password fields has to be filled.\nIs this constraint properly removed along with the password column?", "author": "RoiEXLab", "createdAt": "2020-06-10T17:44:26Z", "path": "lobby-db/src/main/resources/db/migration/V2.00.05__drop_legacy_password.sql", "diffHunk": "@@ -0,0 +1,2 @@\n+alter table lobby_user drop column password;\n+alter table lobby_user alter column bcrypt_password set not null;", "originalCommit": "f73a1ec9bd40fa9c00ce51e837ad34d0696c0926", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ3MzIyOA==", "url": "https://github.com/triplea-game/triplea/pull/6664#discussion_r438473228", "bodyText": "Good consideration. I thought it would not have been dropped, but it appears it is dropped. When I try to drop the constraint after the column is dropped, I get a SQL error:\n\nERROR: constraint \"lobby_user_pass_check\" of relation \"lobby_user\" does not exist", "author": "DanVanAtta", "createdAt": "2020-06-11T00:09:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODMwMTcxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ3MzYzMQ==", "url": "https://github.com/triplea-game/triplea/pull/6664#discussion_r438473631", "bodyText": "Smart Database", "author": "RoiEXLab", "createdAt": "2020-06-11T00:11:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODMwMTcxNw=="}], "type": "inlineReview"}]}