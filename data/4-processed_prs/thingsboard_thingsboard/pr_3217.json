{"pr_number": 3217, "pr_title": "created procedure insert_tb_schema_settings", "pr_createdAt": "2020-08-03T09:26:24Z", "pr_url": "https://github.com/thingsboard/thingsboard/pull/3217", "timeline": [{"oid": "d315156204bd21d46a6c6f5a8cb93936e2939216", "url": "https://github.com/thingsboard/thingsboard/commit/d315156204bd21d46a6c6f5a8cb93936e2939216", "message": "created procedure insert_tb_schema_settings", "committedDate": "2020-08-03T09:25:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDQ1MDk5Mg==", "url": "https://github.com/thingsboard/thingsboard/pull/3217#discussion_r464450992", "bodyText": "else - update?", "author": "ashvayka", "createdAt": "2020-08-03T14:30:26Z", "path": "dao/src/main/resources/sql/schema-entities.sql", "diffHunk": "@@ -20,7 +20,17 @@ CREATE TABLE IF NOT EXISTS tb_schema_settings\n     CONSTRAINT tb_schema_settings_pkey PRIMARY KEY (schema_version)\n );\n \n-INSERT INTO tb_schema_settings (schema_version) VALUES (3001000) ON CONFLICT (schema_version) DO UPDATE SET schema_version = 3001000;\n+CREATE OR REPLACE PROCEDURE insert_tb_schema_settings()\n+    LANGUAGE plpgsql AS\n+$$\n+BEGIN\n+    IF (SELECT COUNT(*) FROM tb_schema_settings) = 0 THEN\n+        INSERT INTO tb_schema_settings (schema_version) VALUES (3001000);", "originalCommit": "d315156204bd21d46a6c6f5a8cb93936e2939216", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}