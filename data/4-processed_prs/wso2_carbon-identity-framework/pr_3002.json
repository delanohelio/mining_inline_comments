{"pr_number": 3002, "pr_title": "[Fix]Local Roles are not deleted in JIT provisioning flow when the federated IDP roles are removed", "pr_createdAt": "2020-07-06T13:41:31Z", "pr_url": "https://github.com/wso2/carbon-identity-framework/pull/3002", "timeline": [{"oid": "c3a883a7063524d403ccfb6dfa1b0ebb1abfe68b", "url": "https://github.com/wso2/carbon-identity-framework/commit/c3a883a7063524d403ccfb6dfa1b0ebb1abfe68b", "message": "Fix federated role remove issue.", "committedDate": "2020-07-06T13:39:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDYzNzA1NA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3002#discussion_r450637054", "bodyText": "A little bit confused about what's happening here. Though we check roles != null, roles variable is not considered within the if block.", "author": "madurangasiriwardena", "createdAt": "2020-07-07T06:26:49Z", "path": "components/authentication-framework/org.wso2.carbon.identity.application.authentication.framework/src/main/java/org/wso2/carbon/identity/application/authentication/framework/handler/provisioning/impl/DefaultProvisioningHandler.java", "diffHunk": "@@ -165,7 +165,7 @@ public void handle(List<String> roles, String subject, Map<String, String> attri\n                 }\n             }\n \n-            if (roles != null && !roles.isEmpty()) {\n+            if (roles != null) {", "originalCommit": "c3a883a7063524d403ccfb6dfa1b0ebb1abfe68b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDY1NzAzMg==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3002#discussion_r450657032", "bodyText": "This roles is used in the above lines to create the list of roles to add list, then that list is used inside this IF block to update the user's new role set. If the roles is null we don't update the user's roles.\nThough the order seems a bit confusing !roles.isEmpty() check always become false if we have only user role and later remove that role.", "author": "inthirakumaaran", "createdAt": "2020-07-07T07:15:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDYzNzA1NA=="}], "type": "inlineReview"}]}