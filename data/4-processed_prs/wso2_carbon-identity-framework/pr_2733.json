{"pr_number": 2733, "pr_title": "[FIX] Encoding password regex", "pr_createdAt": "2020-02-10T02:42:37Z", "pr_url": "https://github.com/wso2/carbon-identity-framework/pull/2733", "timeline": [{"oid": "cd36da93861278b0a2d836e00e34dfcb3784925c", "url": "https://github.com/wso2/carbon-identity-framework/commit/cd36da93861278b0a2d836e00e34dfcb3784925c", "message": "[FIX] Encoding password regex", "committedDate": "2020-02-10T04:48:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg4MzEwMw==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2733#discussion_r376883103", "bodyText": "Formatting issues.", "author": "vihanga-liyanage", "createdAt": "2020-02-10T06:18:22Z", "path": "components/user-mgt/org.wso2.carbon.user.mgt.ui/src/main/resources/web/user/add-step1.jsp", "diffHunk": "@@ -360,11 +365,11 @@\n                 <input type=\"hidden\"\n                        id=\"pwd_<%=Encode.forHtmlAttribute(allUserStoreInfo[i].getDomainName().toUpperCase())%>\"\n                        name=\"pwd_<%=Encode.forHtmlAttribute(allUserStoreInfo[i].getDomainName().toUpperCase())%>\"\n-                       value=<%=Encode.forHtmlAttribute(pwdRegEx)%>>\n+                       value=<%=Encode.forHtmlAttribute(pwdRegEx).replace(REATER_THAN_CHARACTER,GREATER_THAN_ENCODING_STRING)%>>", "originalCommit": "cd36da93861278b0a2d836e00e34dfcb3784925c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkxMDE1Mg==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2733#discussion_r376910152", "bodyText": "Fixed", "author": "somindatommy", "createdAt": "2020-02-10T08:03:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg4MzEwMw=="}], "type": "inlineReview"}, {"oid": "4ebd36578c1f04e955b04459c23661f8ebc14a98", "url": "https://github.com/wso2/carbon-identity-framework/commit/4ebd36578c1f04e955b04459c23661f8ebc14a98", "message": "[FIX] Encoding password regex", "committedDate": "2020-02-10T08:01:52Z", "type": "commit"}, {"oid": "4ebd36578c1f04e955b04459c23661f8ebc14a98", "url": "https://github.com/wso2/carbon-identity-framework/commit/4ebd36578c1f04e955b04459c23661f8ebc14a98", "message": "[FIX] Encoding password regex", "committedDate": "2020-02-10T08:01:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkxNDA5OA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2733#discussion_r376914098", "bodyText": "@somindatommy\nThis is fixing only the character >. Is that intentional?\nMeans the only character is not encoded is >", "author": "tharindu-bandara", "createdAt": "2020-02-10T08:15:20Z", "path": "components/user-mgt/org.wso2.carbon.user.mgt.ui/src/main/resources/web/user/add-step1.jsp", "diffHunk": "@@ -59,6 +59,9 @@\n     boolean isAskPasswordEnabled = false;\n     boolean isUserOnBoardingEnabled = false;\n \n+    String GREATER_THAN_CHARACTER = \">\";", "originalCommit": "4ebd36578c1f04e955b04459c23661f8ebc14a98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkxNjA0NA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2733#discussion_r376916044", "bodyText": "@tharindu-bandara yes. Other characters such as \",',& and < are encoded properly. Issue arises as > is not encoded.", "author": "somindatommy", "createdAt": "2020-02-10T08:20:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkxNDA5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkyNDE0Nw==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2733#discussion_r376924147", "bodyText": "In the API docs, it says,\n\nThe encoding of the greater-than sign (>) is not required for attributes.\n\nI'm wondering what could be the reason behind this.\nMaybe the encoding that we do here does not meet the expectation? For instance, Encode.forHtmlContent does encode the character >.\n[1] https://www2.owasp.org/owasp-java-encoder/encoder/apidocs/org/owasp/encoder/Encode.html#forHtmlAttribute-java.lang.String-", "author": "tharindu-bandara", "createdAt": "2020-02-10T08:41:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkxNDA5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkzMDAyMA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2733#discussion_r376930020", "bodyText": "In the API docs, it says the following about Encode.forHtmlContent [1]\n\nIt does not escape quotation characters and is thus unsafe for use with HTML attributes. Use either forHtml or forHtmlAttribute for those methods.\n\nHence Encode.forHtmlAttribute is used. To prevent HTML injection, encoding < as &lt; is enough. Therefore encoding > is not mandatory.\nWhen > is not encoded, it is considered as a closing tag causing rendering errors in the web page. That's why encoding is necessary.\n[1] - https://www2.owasp.org/owasp-java-encoder/encoder/apidocs/org/owasp/encoder/Encode.html#forHtmlContent-java.lang.String-", "author": "somindatommy", "createdAt": "2020-02-10T08:54:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkxNDA5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkzMjc0MA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2733#discussion_r376932740", "bodyText": "@somindatommy Thanks for the findings and the explanation!\nThen we can use the encoding for html ? Seems like this addressed the greater than the character as well.", "author": "tharindu-bandara", "createdAt": "2020-02-10T09:00:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkxNDA5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njk5MzQzNA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/2733#discussion_r376993434", "bodyText": "Fixed: 225deac", "author": "somindatommy", "createdAt": "2020-02-10T10:58:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkxNDA5OA=="}], "type": "inlineReview"}, {"oid": "225deac693d3998c3919586cdf7b829647e41a9c", "url": "https://github.com/wso2/carbon-identity-framework/commit/225deac693d3998c3919586cdf7b829647e41a9c", "message": "Changing forHtmlAttribute encoding to forHtml encoding", "committedDate": "2020-02-10T10:56:30Z", "type": "commit"}, {"oid": "225deac693d3998c3919586cdf7b829647e41a9c", "url": "https://github.com/wso2/carbon-identity-framework/commit/225deac693d3998c3919586cdf7b829647e41a9c", "message": "Changing forHtmlAttribute encoding to forHtml encoding", "committedDate": "2020-02-10T10:56:30Z", "type": "forcePushed"}]}