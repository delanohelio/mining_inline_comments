{"pr_number": 3011, "pr_title": "Fix service url builder unnecessarily encoding query param string", "pr_createdAt": "2020-07-09T11:46:07Z", "pr_url": "https://github.com/wso2/carbon-identity-framework/pull/3011", "timeline": [{"oid": "5df4f449d62b08eb3777fc38e6c2c536d4b5c530", "url": "https://github.com/wso2/carbon-identity-framework/commit/5df4f449d62b08eb3777fc38e6c2c536d4b5c530", "message": "Fix service url builder unnecessarily encoding query param string", "committedDate": "2020-07-09T11:18:52Z", "type": "commit"}, {"oid": "5a4fa8362e80a66ddb6c8277384bc525bd3b9162", "url": "https://github.com/wso2/carbon-identity-framework/commit/5a4fa8362e80a66ddb6c8277384bc525bd3b9162", "message": "Fix unit tests", "committedDate": "2020-07-09T11:40:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDk2NA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452164964", "bodyText": "Do we encode the parameters when building resolvedParamsString?", "author": "mefarazath", "createdAt": "2020-07-09T11:59:58Z", "path": "components/identity-core/org.wso2.carbon.identity.core/src/main/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilder.java", "diffHunk": "@@ -501,13 +501,7 @@ private void appendParamsToUri(StringBuilder serverUrl, String resolvedParamsStr\n                 serverUrl.setLength(serverUrl.length() - 1);\n             }\n             if (StringUtils.isNotBlank(resolvedParamsString)) {\n-                try {\n-                    serverUrl.append(delimiter).append(URLEncoder.encode(resolvedParamsString,\n-                            StandardCharsets.UTF_8.name()));\n-                } catch (UnsupportedEncodingException e) {\n-                    throw new URLBuilderException(String.format(\"Error while trying to build url. %s is not supported\" +\n-                            \".\", StandardCharsets.UTF_8.name()), e);\n-                }\n+                serverUrl.append(delimiter).append(resolvedParamsString);", "originalCommit": "5a4fa8362e80a66ddb6c8277384bc525bd3b9162", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2ODM4OA==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452168388", "bodyText": "do you mean individual parameters?", "author": "emswbandara", "createdAt": "2020-07-09T12:06:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDk2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE3MDcxNg==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452170716", "bodyText": "Yes", "author": "mefarazath", "createdAt": "2020-07-09T12:11:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDk2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE3NjA1Mw==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452176053", "bodyText": "It was not encoded previously. Added fix at f4f1ea2", "author": "emswbandara", "createdAt": "2020-07-09T12:21:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE2NDk2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE4NTk2Ng==", "url": "https://github.com/wso2/carbon-identity-framework/pull/3011#discussion_r452185966", "bodyText": "Can we add a test case where a parameter has a special character like \"space\" or some character that needs encoding?", "author": "mefarazath", "createdAt": "2020-07-09T12:38:41Z", "path": "components/identity-core/org.wso2.carbon.identity.core/src/test/java/org/wso2/carbon/identity/core/internal/DefaultServiceURLBuilderTest.java", "diffHunk": "@@ -260,33 +260,32 @@ public void testBuild() {\n \n         return new Object[][]{\n                 {\"https\", \"www.wso2.com\", 9443, \"/proxyContext\", \"abc\", false, null, \"\", fragmentParams,\n-                        \"https://www.wso2.com:9443/proxyContext#key1%3Dfragment%26key2%3Dfragment%26key3%3Dfragment\" +\n-                                \"%26key4%3Dfragment\", \"\"},\n+                        \"https://www.wso2.com:9443/proxyContext#key1=fragment&key2=fragment&key3=fragment&key4\" +", "originalCommit": "f4f1ea2d22cbde21781861b96a7a230a312daada", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6b5224523ce58f94b71b419e60d7ed12a2dce295", "url": "https://github.com/wso2/carbon-identity-framework/commit/6b5224523ce58f94b71b419e60d7ed12a2dce295", "message": "Encode parameter names and values", "committedDate": "2020-07-09T13:14:05Z", "type": "commit"}]}