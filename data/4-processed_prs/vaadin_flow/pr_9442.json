{"pr_number": 9442, "pr_title": "fix: made VaadinRequest available in endpoint", "pr_createdAt": "2020-11-19T13:41:20Z", "pr_url": "https://github.com/vaadin/flow/pull/9442", "timeline": [{"oid": "8d9b197a32b6fd33be1bcc0c7884bde430866c18", "url": "https://github.com/vaadin/flow/commit/8d9b197a32b6fd33be1bcc0c7884bde430866c18", "message": "fix: made vaadinrequest avaialbe in endpoint", "committedDate": "2020-11-19T13:39:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODUzODkxMA==", "url": "https://github.com/vaadin/flow/pull/9442#discussion_r528538910", "bodyText": "Could perhaps clear the instance in a finally block to avoid memory leaks?", "author": "joheriks", "createdAt": "2020-11-23T08:39:12Z", "path": "flow-server/src/main/java/com/vaadin/flow/server/connect/VaadinConnectController.java", "diffHunk": "@@ -277,9 +279,7 @@ void validateEndpointBean(EndpointNameChecker endpointNameChecker,\n             // Put a VaadinRequest in the instances object so as the request is\n             // available in the end-point method\n             VaadinServletService service = (VaadinServletService)VaadinService.getCurrent();\n-            if (service != null) {\n-                service.setCurrentInstances(new VaadinServletRequest(request, service), null);\n-            }\n+            CurrentInstance.set(VaadinRequest.class, new VaadinServletRequest(request, service));", "originalCommit": "8d9b197a32b6fd33be1bcc0c7884bde430866c18", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODYyNTI5MQ==", "url": "https://github.com/vaadin/flow/pull/9442#discussion_r528625291", "bodyText": "That's very good point, thanks. Done", "author": "haijian-vaadin", "createdAt": "2020-11-23T11:08:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODUzODkxMA=="}], "type": "inlineReview"}, {"oid": "46bb566ce4c87e70551676c3720a274be54b948c", "url": "https://github.com/vaadin/flow/commit/46bb566ce4c87e70551676c3720a274be54b948c", "message": "clear VaadinRequest instance after endpoint call", "committedDate": "2020-11-23T11:08:13Z", "type": "commit"}, {"oid": "c6f6288df953b49659f69e75d23ea784f0adba58", "url": "https://github.com/vaadin/flow/commit/c6f6288df953b49659f69e75d23ea784f0adba58", "message": "Merge branch 'master' into haijian/vaadin-request-available-for-endpoint", "committedDate": "2020-11-23T13:18:24Z", "type": "commit"}]}