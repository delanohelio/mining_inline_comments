{"pr_number": 9592, "pr_title": "feat: allow endpoints to work on non-public classes", "pr_createdAt": "2020-12-07T20:20:27Z", "pr_url": "https://github.com/vaadin/flow/pull/9592", "timeline": [{"oid": "b5beff92a9fa8c753eafea608ffec133c39901d3", "url": "https://github.com/vaadin/flow/commit/b5beff92a9fa8c753eafea608ffec133c39901d3", "message": "Allow endpoints to work on non-public classes.\nFixes #8168", "committedDate": "2020-12-07T20:15:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI1MTY2Ng==", "url": "https://github.com/vaadin/flow/pull/9592#discussion_r540251666", "bodyText": "This does set the accessible override flag on all public methods in the class, including those inherited from Object (wait, toString, ...) even though these are from being exposed as endpoints later on. Seems it would be safer to flag only the methods that can actually be called as endpoints.", "author": "joheriks", "createdAt": "2020-12-10T15:16:53Z", "path": "flow-server/src/main/java/com/vaadin/flow/server/connect/VaadinConnectController.java", "diffHunk": "@@ -221,8 +222,11 @@ void validateEndpointBean(EndpointNameChecker endpointNameChecker,\n                             endpointName, validationError));\n         }\n \n+        Method[] endpointPublicMethods = beanType.getMethods();\n+        AccessibleObject.setAccessible(endpointPublicMethods, true);", "originalCommit": "b5beff92a9fa8c753eafea608ffec133c39901d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDMxMzY3OQ==", "url": "https://github.com/vaadin/flow/pull/9592#discussion_r540313679", "bodyText": "setAccessible is not changing method itself, it's changing only instance of that Method (it's not singleton). The rest of security checks is done in com.vaadin.flow.server.connect.auth.VaadinConnectAccessChecker which is not changed in this PR.", "author": "tdq", "createdAt": "2020-12-10T16:31:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI1MTY2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDMzMDUzMg==", "url": "https://github.com/vaadin/flow/pull/9592#discussion_r540330532", "bodyText": "Right. I missed that getMethods returns copies so the override has only local impact. This looks fine then.", "author": "joheriks", "createdAt": "2020-12-10T16:50:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI1MTY2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDMzMDg2OQ==", "url": "https://github.com/vaadin/flow/pull/9592#discussion_r540330869", "bodyText": "Looks good to me after conflict resolution then.", "author": "joheriks", "createdAt": "2020-12-10T16:51:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI1MTY2Ng=="}], "type": "inlineReview"}, {"oid": "1fa2e9f970d7df797c0c5a44b1246f71fe0f38e6", "url": "https://github.com/vaadin/flow/commit/1fa2e9f970d7df797c0c5a44b1246f71fe0f38e6", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-12-13T16:58:00Z", "type": "commit"}, {"oid": "2650b7811b0c1110491065ebe455a11b5b103cb9", "url": "https://github.com/vaadin/flow/commit/2650b7811b0c1110491065ebe455a11b5b103cb9", "message": "move testing endpoint class to fusion-endpoint module", "committedDate": "2020-12-16T10:52:19Z", "type": "commit"}, {"oid": "a3b50c865c2f219f5c662298d70a25d9caeabde6", "url": "https://github.com/vaadin/flow/commit/a3b50c865c2f219f5c662298d70a25d9caeabde6", "message": "Merge branch 'master' of https://github.com/vaadin/flow", "committedDate": "2020-12-16T17:07:18Z", "type": "commit"}]}