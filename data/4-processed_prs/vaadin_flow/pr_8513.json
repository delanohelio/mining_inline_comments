{"pr_number": 8513, "pr_title": "Merge/2.2 to 2.3", "pr_createdAt": "2020-06-08T07:59:05Z", "pr_url": "https://github.com/vaadin/flow/pull/8513", "timeline": [{"oid": "c378ea9176f1b5af4be1a9e786509fa1b3d1e81c", "url": "https://github.com/vaadin/flow/commit/c378ea9176f1b5af4be1a9e786509fa1b3d1e81c", "message": "Wait for intermediate page to load completely in @PreserveOnRefresh IT (#8327)", "committedDate": "2020-05-14T09:49:41Z", "type": "commit"}, {"oid": "8456d73bf58f4ab2a20bf987f6cefbab4520596b", "url": "https://github.com/vaadin/flow/commit/8456d73bf58f4ab2a20bf987f6cefbab4520596b", "message": "Store vaadin hash to node_modules (#8282)\n\nTo notice outside changes to package.json\nbetter we add the hash to node_modules\nso we can cross check the value.\n\nFixes #8182\n\n# Conflicts:\n#\tflow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "committedDate": "2020-05-14T11:24:57Z", "type": "commit"}, {"oid": "8fd9c0846224fabc22b37124952555f6bf920518", "url": "https://github.com/vaadin/flow/commit/8fd9c0846224fabc22b37124952555f6bf920518", "message": "Cherry pick from 2.1 to 2.2 (#8342)\n\n* Push browser history state after navigation is certain\r\nfixes parts of #3619", "committedDate": "2020-05-15T07:52:48Z", "type": "commit"}, {"oid": "d93cd808c263e0a4ad9b97466553d65e38f026cc", "url": "https://github.com/vaadin/flow/commit/d93cd808c263e0a4ad9b97466553d65e38f026cc", "message": "Update chrome version to 83 (#8417)", "committedDate": "2020-05-28T05:52:57Z", "type": "commit"}, {"oid": "35921bc7d6f03534a5bfbfd3c083aef3d27ddeac", "url": "https://github.com/vaadin/flow/commit/35921bc7d6f03534a5bfbfd3c083aef3d27ddeac", "message": "Do not use compatibility mode production frontend prefixes without compat mode (#8465)\n\nFixes #8292", "committedDate": "2020-06-03T09:45:40Z", "type": "commit"}, {"oid": "68b5806fd9c7a3bebb028c099efe88efb2062167", "url": "https://github.com/vaadin/flow/commit/68b5806fd9c7a3bebb028c099efe88efb2062167", "message": "Fix issue with Push unsubscribe URL. (#8330)\n\nRelated to #8177", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "0e427d2d512a90e1513c953bddc1310b9749a6db", "url": "https://github.com/vaadin/flow/commit/0e427d2d512a90e1513c953bddc1310b9749a6db", "message": "Workaround a bug in the external reflection library. (#8431)\n\nFixes #8371", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "e51569c9ab3cc1186820a01ecd50f0ee6df152d9", "url": "https://github.com/vaadin/flow/commit/e51569c9ab3cc1186820a01ecd50f0ee6df152d9", "message": "Force pnpm version >=4.4.0, <4.6.0 (#8452)\n\nFixes #8434", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "e428989342fdc683eb646d83fe88e4e463b30d56", "url": "https://github.com/vaadin/flow/commit/e428989342fdc683eb646d83fe88e4e463b30d56", "message": "Force chokidar version to ^3.4.0 (#8432) (#8451)\n\nFixes #8432", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "6ca260048f1a10c17ab6ac18dab7c0171d904468", "url": "https://github.com/vaadin/flow/commit/6ca260048f1a10c17ab6ac18dab7c0171d904468", "message": "Removing deprecated parameter from DataNode constructor (#8325)\n\nIf you use container (such as the latest Wilfdly) which forces to use significantly newer version of Jsoup than Vaadin depends to, this can cause a problem as deprecated method as been removed.", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "25c248b2c0d907f0660c0de8b2ff495a1a2fe90f", "url": "https://github.com/vaadin/flow/commit/25c248b2c0d907f0660c0de8b2ff495a1a2fe90f", "message": "Fix Javadoc typo in NavigationTargetFilter (#8467)", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "79ff40505f99d22d93c287d8f7559f379c810720", "url": "https://github.com/vaadin/flow/commit/79ff40505f99d22d93c287d8f7559f379c810720", "message": "Close UI after refreshing the page in PreserveOnRefresh case and mark it\n(#8365)\n\nFixes #8286\n\n\n# Conflicts:\n#\tflow-server/src/main/java/com/vaadin/flow/router/internal/AbstractNavigationStateRenderer.java\n\n# Conflicts:\n#\tflow-server/src/main/java/com/vaadin/flow/router/internal/AbstractNavigationStateRenderer.java", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "a2b2b2b376d9bb5f6cc9d84967a119998970a2d8", "url": "https://github.com/vaadin/flow/commit/a2b2b2b376d9bb5f6cc9d84967a119998970a2d8", "message": "Close client app on change location (#8334)\n\nFixes #8177\n# Conflicts:\n#\tflow-server/src/main/java/com/vaadin/flow/component/page/Page.java\n#\tflow-server/src/test/java/com/vaadin/flow/component/page/PageTest.java\n\n# Conflicts:\n#\tflow-client/src/main/java/com/vaadin/client/flow/ExecuteJavaScriptProcessor.java", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "70ff8e8eec6067e84cbc273f7e5949c84cd63936", "url": "https://github.com/vaadin/flow/commit/70ff8e8eec6067e84cbc273f7e5949c84cd63936", "message": "Listen detach events on \"listenOn\" components in shortcut registration (#8391)\n\nFixes #8247", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "876af12f524d462a347ad184eb6d75a3200c053c", "url": "https://github.com/vaadin/flow/commit/876af12f524d462a347ad184eb6d75a3200c053c", "message": "Don't override initial value of hidden HTML Element attribute. (#8419)\n\nFixes #8100", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "2cde527cc740d45806084a33948b3c939655272a", "url": "https://github.com/vaadin/flow/commit/2cde527cc740d45806084a33948b3c939655272a", "message": "Adapt test code to 2.x branch", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "0e0e01b930201ddbc1ccf4b533204c2fd93078d2", "url": "https://github.com/vaadin/flow/commit/0e0e01b930201ddbc1ccf4b533204c2fd93078d2", "message": "Update ExecuteJavaScriptProcessor.java", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "34357a2dc8a1daf4d32d667d5eac08edd49b701f", "url": "https://github.com/vaadin/flow/commit/34357a2dc8a1daf4d32d667d5eac08edd49b701f", "message": "Adapt gwt push connection test for 2.x branch.", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "aea74ad215b72a59c3477c0651fb155dbd4e2acb", "url": "https://github.com/vaadin/flow/commit/aea74ad215b72a59c3477c0651fb155dbd4e2acb", "message": "Quiet down logs for deployment (#8471)\n\nRemoves highlighting blocks, extra whitespace and changes output block\nabout application start up to a oneliner.\n\nFixes #8404, 8395\nRelated to #8104", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "7d4c5ddc1c7e6dba4368adad26459b2c5157133b", "url": "https://github.com/vaadin/flow/commit/7d4c5ddc1c7e6dba4368adad26459b2c5157133b", "message": "Fix issues after cherry-pick", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "ecfc5350dc2d3239bb5dec3b52df47d6925e5565", "url": "https://github.com/vaadin/flow/commit/ecfc5350dc2d3239bb5dec3b52df47d6925e5565", "message": "1000th fix after cherry-pick", "committedDate": "2020-06-03T11:06:10Z", "type": "commit"}, {"oid": "bf1a3aa3c26167e7fcec54115a34fe195a88434d", "url": "https://github.com/vaadin/flow/commit/bf1a3aa3c26167e7fcec54115a34fe195a88434d", "message": "Fix race condition in embedding tests (#8507)\n\n* Wait for a shadow root to appear to work around race condition with HTML import polyfill\r\n\r\n* Update chrome driver to 83.0.4103.39 (#8407)\r\n\r\n* IE compatible version of JS\r\n\r\nCo-authored-by: Zhe Sun <31067185+ZheSun88@users.noreply.github.com>", "committedDate": "2020-06-05T13:29:06Z", "type": "commit"}, {"oid": "10b02b45b8dc8e9900ca318f7bb0650857d8d264", "url": "https://github.com/vaadin/flow/commit/10b02b45b8dc8e9900ca318f7bb0650857d8d264", "message": "Merge branch '2.2' into merge/2.2-to-2.3\n\n# Conflicts:\n#\tflow-client/src/main/java/com/vaadin/client/flow/ExecuteJavaScriptProcessor.java\n#\tflow-client/src/test-gwt/java/com/vaadin/client/communication/GwtAtmoshperePushConnectionTest.java\n#\tflow-server/src/main/java/com/vaadin/flow/function/DeploymentConfiguration.java\n#\tflow-server/src/main/java/com/vaadin/flow/router/internal/AbstractNavigationStateRenderer.java\n#\tflow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "committedDate": "2020-06-08T07:54:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU0MTAwMw==", "url": "https://github.com/vaadin/flow/pull/8513#discussion_r436541003", "bodyText": "Merge this if statement with the enclosing one.", "author": "vaadin-bot", "createdAt": "2020-06-08T08:42:52Z", "path": "flow-server/src/main/java/com/vaadin/flow/server/DefaultDeploymentConfiguration.java", "diffHunk": "@@ -146,18 +143,13 @@ private void logMessages() {\n         Logger logger = LoggerFactory.getLogger(getClass().getName());\n \n         if (!warnings.isEmpty()) {\n-            warnings.add(0, HEADER);\n-            warnings.add(1, DEPLOYMENT_WARNINGS);\n-            warnings.add(\"\\n\");\n+            warnings.add(0, DEPLOYMENT_WARNINGS);\n             // merging info messages to warnings for now\n             warnings.addAll(info);\n-            warnings.add(SEPARATOR);\n             if (logger.isWarnEnabled()) {\n                 logger.warn(String.join(\"\\n\", warnings));\n             }\n         } else if (!info.isEmpty()) {\n-            info.add(0, HEADER);\n-            info.add(SEPARATOR);\n             if (logger.isInfoEnabled()) {", "originalCommit": "10b02b45b8dc8e9900ca318f7bb0650857d8d264", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU0MTAxMA==", "url": "https://github.com/vaadin/flow/pull/8513#discussion_r436541010", "bodyText": "Reduce the number of conditional operators (4) used in the expression (maximum allowed 3).", "author": "vaadin-bot", "createdAt": "2020-06-08T08:42:53Z", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "diffHunk": "@@ -203,9 +248,32 @@ private boolean shouldRunNpmInstall() {\n                     .listFiles(\n                             (dir, name) -> !ignoredNodeFolders.contains(name));\n             assert installedPackages != null;\n-            return installedPackages.length == 0\n-                    || (installedPackages.length == 1 && FLOW_NPM_PACKAGE_NAME\n-                            .startsWith(installedPackages[0].getName()));\n+            return installedPackages.length == 0 || (", "originalCommit": "10b02b45b8dc8e9900ca318f7bb0650857d8d264", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}