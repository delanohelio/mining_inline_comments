{"pr_number": 8585, "pr_title": "Fix adding existing item", "pr_createdAt": "2020-06-18T09:37:46Z", "pr_url": "https://github.com/vaadin/flow/pull/8585", "timeline": [{"oid": "7e24a13bfa56419aeca8b0756e664aa04e8b0073", "url": "https://github.com/vaadin/flow/commit/7e24a13bfa56419aeca8b0756e664aa04e8b0073", "message": "Fix adding existing item\n\nIf item is moved from before\nthe target item the item index\nwas wrong as the old item was removed.", "committedDate": "2020-06-18T09:37:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjExMjE5Ng==", "url": "https://github.com/vaadin/flow/pull/8585#discussion_r442112196", "bodyText": "Oh, such a silly mistake!\nCould we then replace the first call to getItemIndex with contains:\n        if (!contains(targetItemIndex, dataProvider)) {\n            throw new IllegalArgumentException(targetItemNotFoundErrorMessage);\n        }\n\nIt's easier to read.", "author": "mshabarov", "createdAt": "2020-06-18T09:59:55Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/AbstractListDataView.java", "diffHunk": "@@ -371,7 +371,8 @@ private void addItemOnTarget(\n          * the proper position towards to target item.\n          */\n         removeItemIfPresent(item, dataProvider);\n-        itemList.add(insertItemsIndexProvider.apply(targetItemIndex), item);\n+        itemList.add(insertItemsIndexProvider\n+                .apply(getItemIndex(target, dataProvider::getId)), item);", "originalCommit": "7e24a13bfa56419aeca8b0756e664aa04e8b0073", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjExNzY2NA==", "url": "https://github.com/vaadin/flow/pull/8585#discussion_r442117664", "bodyText": "done", "author": "caalador", "createdAt": "2020-06-18T10:09:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjExMjE5Ng=="}], "type": "inlineReview"}, {"oid": "8e63776687c1a5e920797e5da6e1f2cb475a9fc9", "url": "https://github.com/vaadin/flow/commit/8e63776687c1a5e920797e5da6e1f2cb475a9fc9", "message": "Use contains.", "committedDate": "2020-06-18T10:08:59Z", "type": "commit"}]}