{"pr_number": 2048, "pr_title": "[NETBEANS-3787] FlatLaf: fixed active tab painting if project tab colors enabled", "pr_createdAt": "2020-03-26T22:59:27Z", "pr_url": "https://github.com/apache/netbeans/pull/2048", "timeline": [{"oid": "bdae36f85b3f69c494cfcd860b0e402b32d2d32c", "url": "https://github.com/apache/netbeans/commit/bdae36f85b3f69c494cfcd860b0e402b32d2d32c", "message": "[NETBEANS-3787] FlatLaf: fixed active tab painting if project tab colors enabled", "committedDate": "2020-03-26T22:44:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MjY4MQ==", "url": "https://github.com/apache/netbeans/pull/2048#discussion_r399862681", "bodyText": "Looking at FlatLaf.properties ( https://github.com/apache/netbeans/blob/3139141059141caab4a6af1158cce7131e1b40f9/platform/o.n.swing.laf.flatlaf/src/org/netbeans/swing/laf/flatlaf/FlatLaf.properties ), the definition is \"nb.multitabs.underlineHeight={scaledInteger}3\". What does \"scaledInteger\" mean? How does that get parsed here?", "author": "eirikbakke", "createdAt": "2020-03-29T22:24:22Z", "path": "platform/core.multitabs/src/org/netbeans/core/multitabs/impl/ProjectColorTabDecorator.java", "diffHunk": "@@ -161,8 +161,16 @@ public void paintAfter( TabData tab, Graphics g, Rectangle tabRect, boolean isSe\n         }\n         g.setColor( c );\n         Rectangle rect = new Rectangle( tabRect );\n-        rect.y += rect.height - 3;\n-        rect.grow( -1, -1 );\n+        int underlineHeight = UIManager.getInt(\"nb.multitabs.underlineHeight\"); // NOI18N", "originalCommit": "bdae36f85b3f69c494cfcd860b0e402b32d2d32c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM4MjQ0Mg==", "url": "https://github.com/apache/netbeans/pull/2048#discussion_r400382442", "bodyText": "{scaledInteger} means that FlatLaf scales this value (when initializing the Laf) using the FlatLaf user scale factor, which is used for Java 8 but also on Linux. When running in Java 9 the FlatLaf user scale factor is usually 1.\nIn other places I usually invoke method UIScale.scale( intValue ), but in this case it would require that Multi-tabs project depends on FlatLaf library project, which I wanted to avoid.\nThe downside of using {scaledInteger} is that it is not updated when the user changes scaling in Windows Settings.", "author": "DevCharly", "createdAt": "2020-03-30T17:52:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MjY4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQwODc0MQ==", "url": "https://github.com/apache/netbeans/pull/2048#discussion_r406408741", "bodyText": "Ah, so I get it's FlatLAF that reads the property file and puts the scaled value into UIManager. Sounds good.\n\nThe downside of using {scaledInteger} is that it is not updated when the user changes scaling in Windows Settings.\nPresumably it's scaled via the default Graphics2D transform in that case. Sounds correct in any case.", "author": "eirikbakke", "createdAt": "2020-04-09T18:51:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MjY4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MjgzNw==", "url": "https://github.com/apache/netbeans/pull/2048#discussion_r399862837", "bodyText": "Realizing this code was already there... what's going on here? Is tabRect the entire tab to start with?", "author": "eirikbakke", "createdAt": "2020-03-29T22:25:56Z", "path": "platform/core.multitabs/src/org/netbeans/core/multitabs/impl/ProjectColorTabDecorator.java", "diffHunk": "@@ -161,8 +161,16 @@ public void paintAfter( TabData tab, Graphics g, Rectangle tabRect, boolean isSe\n         }\n         g.setColor( c );\n         Rectangle rect = new Rectangle( tabRect );\n-        rect.y += rect.height - 3;", "originalCommit": "bdae36f85b3f69c494cfcd860b0e402b32d2d32c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MzYzMg==", "url": "https://github.com/apache/netbeans/pull/2048#discussion_r399863632", "bodyText": "Sorry, stray comment... I got it.", "author": "eirikbakke", "createdAt": "2020-03-29T22:32:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MjgzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MzUxOA==", "url": "https://github.com/apache/netbeans/pull/2048#discussion_r399863518", "bodyText": "If an underline is used to indicate the active tab, why not just keep the whole tab colored, like the other tabs, with the underline added? E.g.\nrect.height - =underlineHeight?", "author": "eirikbakke", "createdAt": "2020-03-29T22:31:30Z", "path": "platform/core.multitabs/src/org/netbeans/core/multitabs/impl/ProjectColorTabDecorator.java", "diffHunk": "@@ -161,8 +161,16 @@ public void paintAfter( TabData tab, Graphics g, Rectangle tabRect, boolean isSe\n         }\n         g.setColor( c );\n         Rectangle rect = new Rectangle( tabRect );\n-        rect.y += rect.height - 3;\n-        rect.grow( -1, -1 );\n+        int underlineHeight = UIManager.getInt(\"nb.multitabs.underlineHeight\"); // NOI18N\n+        if( underlineHeight > 0 ) {\n+            // if the selected tab is highlighted with an \"underline\" (e.g. in FlatLaf)\n+            // then paint the project color bar at the top of the tab\n+            rect.height = underlineHeight;", "originalCommit": "bdae36f85b3f69c494cfcd860b0e402b32d2d32c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM5MTgzMg==", "url": "https://github.com/apache/netbeans/pull/2048#discussion_r400391832", "bodyText": "@eirikbakke That would look better. Thanks Eirik!", "author": "lkishalmi", "createdAt": "2020-03-30T18:07:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg2MzUxOA=="}], "type": "inlineReview"}]}