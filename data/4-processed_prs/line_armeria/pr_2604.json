{"pr_number": 2604, "pr_title": "Switch from TSLint to ESLint", "pr_createdAt": "2020-03-18T08:28:34Z", "pr_url": "https://github.com/line/armeria/pull/2604", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3NzE5Mg==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394177192", "bodyText": "This is the only customization I did except applying the recommended presets below.", "author": "trustin", "createdAt": "2020-03-18T08:32:20Z", "path": "settings/eslint/eslintrc.js", "diffHunk": "@@ -0,0 +1,66 @@\n+const commonParserOptions = {\n+  ecmaFeatures: {\n+    jsx: true,\n+  },\n+  ecmaVersion: '2020',\n+  sourceType: 'module',\n+};\n+\n+const commonRules = {\n+  'prettier/prettier': [\n+    'error',\n+    {\n+      singleQuote: true,\n+      jsxSingleQuote: true,\n+      trailingComma: 'all',\n+    },\n+  ],", "originalCommit": "13712e6c2a817466a2a6a1c4b0b0bf31a145c3f3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3NjMwNw==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394176307", "bodyText": "We could also just move everything into dependencies. For apps not published to NPM it's one reasonable convention, which is followed by create-react-app", "author": "anuraaga", "createdAt": "2020-03-18T08:30:36Z", "path": "docs-client/.eslintrc.js", "diffHunk": "@@ -0,0 +1,8 @@\n+const defaultConfig = require('../settings/eslint/eslintrc');\n+\n+// Ignore 'webpack.config.ts' so that it doesn't complain that\n+// some dependencies must be moved from devDependencies to dependencies.", "originalCommit": "13712e6c2a817466a2a6a1c4b0b0bf31a145c3f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyOTIwNA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394229204", "bodyText": "That would be convenient, but I'm not sure if it's a good idea to move webpack and its plugins to dependencies because they are used only when building obviously.", "author": "trustin", "createdAt": "2020-03-18T10:02:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3NjMwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc4MTY2Ng==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394781666", "bodyText": "Technically everything is only when building since we build a bundle rather than publishing anything - I think that's why create-react-app follows that convention. But it's ok if it's easy to ignore files too", "author": "anuraaga", "createdAt": "2020-03-19T04:14:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3NjMwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgxMTA4Ng==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394811086", "bodyText": "Merged into dependencies for simplicity", "author": "trustin", "createdAt": "2020-03-19T06:18:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3NjMwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3Njc5MA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394176790", "bodyText": "Let's put these in .prettierrc.js since it will have better support with IDEs", "author": "anuraaga", "createdAt": "2020-03-18T08:31:33Z", "path": "settings/eslint/eslintrc.js", "diffHunk": "@@ -0,0 +1,66 @@\n+const commonParserOptions = {\n+  ecmaFeatures: {\n+    jsx: true,\n+  },\n+  ecmaVersion: '2020',\n+  sourceType: 'module',\n+};\n+\n+const commonRules = {\n+  'prettier/prettier': [", "originalCommit": "13712e6c2a817466a2a6a1c4b0b0bf31a145c3f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDI0MTA0Mg==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394241042", "bodyText": "Done. Thanks for suggestion.", "author": "trustin", "createdAt": "2020-03-18T10:22:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3Njc5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3Nzc2MQ==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394177761", "bodyText": "Are these options needed? I've never seen them defined without losing any linting", "author": "anuraaga", "createdAt": "2020-03-18T08:33:23Z", "path": "settings/eslint/eslintrc.js", "diffHunk": "@@ -0,0 +1,66 @@\n+const commonParserOptions = {\n+  ecmaFeatures: {", "originalCommit": "13712e6c2a817466a2a6a1c4b0b0bf31a145c3f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIzMjUxMw==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394232513", "bodyText": "Seems to work without ecmaFeatures", "author": "trustin", "createdAt": "2020-03-18T10:08:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3Nzc2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3ODg2Mw==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394178863", "bodyText": "Maybe better to leave this as default", "author": "anuraaga", "createdAt": "2020-03-18T08:35:37Z", "path": "settings/eslint/eslintrc.js", "diffHunk": "@@ -0,0 +1,66 @@\n+const commonParserOptions = {\n+  ecmaFeatures: {\n+    jsx: true,\n+  },\n+  ecmaVersion: '2020',\n+  sourceType: 'module',\n+};\n+\n+const commonRules = {\n+  'prettier/prettier': [\n+    'error',\n+    {\n+      singleQuote: true,\n+      jsxSingleQuote: true,\n+      trailingComma: 'all',\n+    },\n+  ],\n+};\n+\n+module.exports = {\n+  globals: {\n+    Atomics: 'readonly',\n+    SharedArrayBuffer: 'readonly',\n+  },\n+  ignorePatterns: ['node_modules/', 'public/', 'build/', '!.*.js', '!.*.json'],\n+  // Settings for .js, .jsx and .json\n+  parser: 'babel-eslint',", "originalCommit": "13712e6c2a817466a2a6a1c4b0b0bf31a145c3f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIzMjM3OQ==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394232379", "bodyText": "Yeah, the default parser works fine. Cargo-culted from eslint-plugin-json \ud83e\udd26\u200d\u2642\ufe0f", "author": "trustin", "createdAt": "2020-03-18T10:07:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3ODg2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3OTMwNA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394179304", "bodyText": "Instead of globals, does this work?\nenv: {\n  browser: true, // Since we run in browser\n  jest: true, // Since we wish we had unit tests\n}", "author": "anuraaga", "createdAt": "2020-03-18T08:36:34Z", "path": "settings/eslint/eslintrc.js", "diffHunk": "@@ -0,0 +1,66 @@\n+const commonParserOptions = {\n+  ecmaFeatures: {\n+    jsx: true,\n+  },\n+  ecmaVersion: '2020',\n+  sourceType: 'module',\n+};\n+\n+const commonRules = {\n+  'prettier/prettier': [\n+    'error',\n+    {\n+      singleQuote: true,\n+      jsxSingleQuote: true,\n+      trailingComma: 'all',\n+    },\n+  ],\n+};\n+\n+module.exports = {\n+  globals: {", "originalCommit": "13712e6c2a817466a2a6a1c4b0b0bf31a145c3f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIzMjAzNA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394232034", "bodyText": "Seems to work. Thanks.", "author": "trustin", "createdAt": "2020-03-18T10:07:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3OTMwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE4MDI1OA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394180258", "bodyText": "I think instead of javascript, it could be better to just use eslint's default functionality with extends", "author": "anuraaga", "createdAt": "2020-03-18T08:38:30Z", "path": "docs-client/.eslintrc.js", "diffHunk": "@@ -0,0 +1,8 @@\n+const defaultConfig = require('../settings/eslint/eslintrc');", "originalCommit": "13712e6c2a817466a2a6a1c4b0b0bf31a145c3f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDIyMjM2MA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394222360", "bodyText": "I tried, but it seems like it fails to load the configs in the extends section, e.g. It fails to find airbnb. I guess it looks for the configs relatively from ../settings/eslint/ rather than from ..", "author": "trustin", "createdAt": "2020-03-18T09:51:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE4MDI1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc4MTk4NA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394781984", "bodyText": "Ah yeah it's true probably need the react version as well when disabling this.", "author": "anuraaga", "createdAt": "2020-03-19T04:16:17Z", "path": "settings/eslint/eslintrc.js", "diffHunk": "@@ -0,0 +1,82 @@\n+const commonParserOptions = {\n+  ecmaVersion: '2020',\n+  sourceType: 'module',\n+};\n+\n+const commonRules = {\n+  'class-methods-use-this': 'off',\n+  'eslint-comments/no-unused-disable': 'error',\n+  'import/export': 'off',\n+  'import/no-cycle': 'off',\n+  'import/no-named-as-default': 'off',\n+  'import/no-useless-path-segments': 'off',\n+  'import/prefer-default-export': 'off',\n+  'prefer-destructuring': 'off',", "originalCommit": "e93516d1d76888a182cbbc3bbcd07124e0546377", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc4MjI0NA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394782244", "bodyText": "Ah just noticed this - I think this is a pretty rare configuration since JSX is basically XML. Up to you but I think most projects use double quote in JSX.", "author": "anuraaga", "createdAt": "2020-03-19T04:17:41Z", "path": "settings/prettier/prettierrc.js", "diffHunk": "@@ -0,0 +1,5 @@\n+module.exports = {\n+  singleQuote: true,\n+  jsxSingleQuote: true,", "originalCommit": "e93516d1d76888a182cbbc3bbcd07124e0546377", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc4OTI1OA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394789258", "bodyText": "Isn't JSX not an XML? It allows things like className={myClassName}. I thought it's good for consistency because otherwise it would mean two different single quote rules in a single .jsx file. What do you think?", "author": "trustin", "createdAt": "2020-03-19T04:49:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc4MjI0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc5NDkyNA==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394794924", "bodyText": "Good point that it's not true XML. But I've never seen a project use this flag, including our two main dependencies material-ui and react. So I'd say it's not conventional to use jsxSingleQuote. Considering the quotes are used in totally different ways (const foo = 'bar' vs <Component foo=\"bar\">, I guess it's rare to cause confusion.", "author": "anuraaga", "createdAt": "2020-03-19T05:14:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc4MjI0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDgxMTIyMQ==", "url": "https://github.com/line/armeria/pull/2604#discussion_r394811221", "bodyText": "Removed jsxSingleQuote: true and reverted auto-fixes", "author": "trustin", "createdAt": "2020-03-19T06:18:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDc4MjI0NA=="}], "type": "inlineReview"}, {"oid": "a9ca3c303fb3d6aab100655f2c045865c6e0126e", "url": "https://github.com/line/armeria/commit/a9ca3c303fb3d6aab100655f2c045865c6e0126e", "message": "Turn off `jsxSingleQuote` and `react/destructuring-assignment`", "committedDate": "2020-03-19T05:27:49Z", "type": "forcePushed"}, {"oid": "8ded5b2bf52057b02fd6219ccd05d01789fe2f13", "url": "https://github.com/line/armeria/commit/8ded5b2bf52057b02fd6219ccd05d01789fe2f13", "message": "Switch from TSLint to ESLint\n\nRelated issues: #2054\n\nMotivation:\n\nTSLint is officially announced to be deprecated in 2019.\n\nModifications:\n\n- Replace TSLint with ESLint\n- Fix some linting errors\n- Place `eslintrc.js` and `prettierrc.js` under `settings/` so that\n  other frontend modules (e.g. Gatsby) can use it as well.\n\nResult:\n\n- New and shiny linting", "committedDate": "2020-03-19T06:35:28Z", "type": "commit"}, {"oid": "8ded5b2bf52057b02fd6219ccd05d01789fe2f13", "url": "https://github.com/line/armeria/commit/8ded5b2bf52057b02fd6219ccd05d01789fe2f13", "message": "Switch from TSLint to ESLint\n\nRelated issues: #2054\n\nMotivation:\n\nTSLint is officially announced to be deprecated in 2019.\n\nModifications:\n\n- Replace TSLint with ESLint\n- Fix some linting errors\n- Place `eslintrc.js` and `prettierrc.js` under `settings/` so that\n  other frontend modules (e.g. Gatsby) can use it as well.\n\nResult:\n\n- New and shiny linting", "committedDate": "2020-03-19T06:35:28Z", "type": "forcePushed"}, {"oid": "79013424b9452c22afb3f9941ecec07223e149a1", "url": "https://github.com/line/armeria/commit/79013424b9452c22afb3f9941ecec07223e149a1", "message": "Move build-time dependencies to `devDependencies`", "committedDate": "2020-03-19T06:43:28Z", "type": "commit"}, {"oid": "cda15485464f5257e2b0828132eadb7b1c66297b", "url": "https://github.com/line/armeria/commit/cda15485464f5257e2b0828132eadb7b1c66297b", "message": "Remove `@ts-ignore`", "committedDate": "2020-03-19T09:01:54Z", "type": "commit"}, {"oid": "86046fc1c98151ddc03bfbd6812eec0d723dd7be", "url": "https://github.com/line/armeria/commit/86046fc1c98151ddc03bfbd6812eec0d723dd7be", "message": "Revert \"Remove `@ts-ignore`\"\n\nThis reverts commit cda15485464f5257e2b0828132eadb7b1c66297b.", "committedDate": "2020-03-19T09:22:06Z", "type": "commit"}]}