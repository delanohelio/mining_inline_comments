{"pr_number": 2415, "pr_title": "Fix a bug where callbacks are invoked with the wrong context", "pr_createdAt": "2020-01-22T11:31:37Z", "pr_url": "https://github.com/line/armeria/pull/2415", "timeline": [{"oid": "5368bcf09526c42ebe5542f5fe9112ec201d7111", "url": "https://github.com/line/armeria/commit/5368bcf09526c42ebe5542f5fe9112ec201d7111", "message": "Fix a bug where an event loop with a ctx trying to push another ctx\nMotivation:\n\nModification:\n\nResult:\nClose #2414", "committedDate": "2020-01-22T11:29:33Z", "type": "commit"}, {"oid": "b38dc958dfe9233fd0fbe7fd5492b316258cacad", "url": "https://github.com/line/armeria/commit/b38dc958dfe9233fd0fbe7fd5492b316258cacad", "message": "Add more", "committedDate": "2020-01-23T03:15:49Z", "type": "commit"}, {"oid": "c499c77abea5ee53c893c6261e49af0a97f43ae2", "url": "https://github.com/line/armeria/commit/c499c77abea5ee53c893c6261e49af0a97f43ae2", "message": "Fix", "committedDate": "2020-01-23T03:24:44Z", "type": "commit"}, {"oid": "31d1ee7896e73d431bf5fc7562e514ac3fcd8858", "url": "https://github.com/line/armeria/commit/31d1ee7896e73d431bf5fc7562e514ac3fcd8858", "message": "Add pop", "committedDate": "2020-01-23T08:22:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4NzI2OA==", "url": "https://github.com/line/armeria/pull/2415#discussion_r369987268", "bodyText": "How about mentioning the specific use case of this method? We could then remove the duplicate comments in this pull request.", "author": "trustin", "createdAt": "2020-01-23T08:39:17Z", "path": "core/src/main/java/com/linecorp/armeria/internal/RequestContextUtil.java", "diffHunk": "@@ -49,5 +49,18 @@ public static IllegalStateException newIllegalContextPushingException(\n                 \"unexpected thread or forgetting to close previous context.\");\n     }\n \n+    /**\n+     * Removes the {@link RequestContext} in the thread-local if exists and returns {@link SafeCloseable} which\n+     * pushes it back to the thread-local.", "originalCommit": "31d1ee7896e73d431bf5fc7562e514ac3fcd8858", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4ODA5Mg==", "url": "https://github.com/line/armeria/pull/2415#discussion_r369988092", "bodyText": "Ah that's a good idea. Let me add it.", "author": "minwoox", "createdAt": "2020-01-23T08:41:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTk4NzI2OA=="}], "type": "inlineReview"}, {"oid": "12db6f3d64bc2bea261eb7380d9e56aff0289bf6", "url": "https://github.com/line/armeria/commit/12db6f3d64bc2bea261eb7380d9e56aff0289bf6", "message": "Add description", "committedDate": "2020-01-23T09:03:58Z", "type": "commit"}]}