{"pr_number": 2367, "pr_title": "Follow Micrometer's naming convention", "pr_createdAt": "2020-01-03T14:11:04Z", "pr_url": "https://github.com/line/armeria/pull/2367", "timeline": [{"oid": "565a8871595f04a0043ee5bfa2058a90f521b16d", "url": "https://github.com/line/armeria/commit/565a8871595f04a0043ee5bfa2058a90f521b16d", "message": "Follow Micrometer's naming convention\n\nCo-authored-by: Per Lundberg <perlun@gmail.com>\n\nMotivation:\n\nThe Micrometer naming conventions (http://micrometer.io/docs/concepts#_naming_meters)\nsuggest that dotted notation (`foo.bar.baz`) should be used when naming\nmeters and tags. This has the advantage of letting different Micrometer\nmonitoring implementations be able to convert it to the naming\nconvention which is native for it (e.g. JMX, Prometheus etc).\n\nModifications:\n\n- Switch to Micrometer's naming convention everywhere.\n- Add a new flag `com.linecorp.armeria.useLegacyMeterNames` which\n  switches back to the old meter names.\n- Deprecate `MoreNamingConventions`\n  - The `NamingConvention`s returned by `MoreNamingConventions` now return\n    Micrometer's default `NamingConvention` for corresponding backend.\n  - `MoreNamingConventions.configure()` is now no-op.\n- Miscellaneous:\n  - `{Dropwizard,Prometheus}MeterRegistries.configureRegistry()` does\n    not override the pause detector anymore because Micrometer now uses\n    `NoPauseDetector` by default.\n\nResult:\n\n- Armeria is now a good citizen of Micrometer ecosystem.\n- Users have time to migrate to the new naming thanks to the new flag.", "committedDate": "2020-01-03T14:01:13Z", "type": "commit"}, {"oid": "e988e45ba45bd79bc8517b68d12e8d83cbe1b364", "url": "https://github.com/line/armeria/commit/e988e45ba45bd79bc8517b68d12e8d83cbe1b364", "message": "Fix Javadoc", "committedDate": "2020-01-03T14:15:37Z", "type": "commit"}, {"oid": "d5fb7cfb82da03d2f29a887ddeae59ce59a7260a", "url": "https://github.com/line/armeria/commit/d5fb7cfb82da03d2f29a887ddeae59ce59a7260a", "message": "Fix test failures", "committedDate": "2020-01-03T14:39:54Z", "type": "commit"}, {"oid": "2fa1fe589279da344f087741301f9ee6b25f2a4f", "url": "https://github.com/line/armeria/commit/2fa1fe589279da344f087741301f9ee6b25f2a4f", "message": "More fixes", "committedDate": "2020-01-03T14:46:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzIzNTM2MA==", "url": "https://github.com/line/armeria/pull/2367#discussion_r363235360", "bodyText": "\ud83d\udc4d/cc @minwoox FYI micrometer-metrics/micrometer-docs@53698ab", "author": "ikhoon", "createdAt": "2020-01-06T10:22:29Z", "path": "core/src/main/java/com/linecorp/armeria/common/metric/DropwizardMeterRegistries.java", "diffHunk": "@@ -159,8 +158,8 @@ public MeterFilterReply accept(Meter.Id id) {\n                 return MeterFilterReply.NEUTRAL;\n             }\n         });\n+\n         meterRegistry.config().namingConvention(MoreNamingConventions.dropwizard());\n-        meterRegistry.config().pauseDetector(new NoPauseDetector());", "originalCommit": "2fa1fe589279da344f087741301f9ee6b25f2a4f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}