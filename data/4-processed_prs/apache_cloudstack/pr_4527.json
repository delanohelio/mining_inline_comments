{"pr_number": 4527, "pr_title": "kvm: set cpu topology only if cpucore per socket is set", "pr_createdAt": "2020-12-09T14:42:36Z", "pr_url": "https://github.com/apache/cloudstack/pull/4527", "timeline": [{"oid": "43dcd65efe03efc294bad7d21c2aaa4573ca893b", "url": "https://github.com/apache/cloudstack/commit/43dcd65efe03efc294bad7d21c2aaa4573ca893b", "message": "kvm: set cpu topology only if cpucore per socket is positive value", "committedDate": "2020-12-09T14:34:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg3NTk4Ng==", "url": "https://github.com/apache/cloudstack/pull/4527#discussion_r539875986", "bodyText": "code LGTM", "author": "sureshanaparti", "createdAt": "2020-12-10T06:11:57Z", "path": "plugins/hypervisors/kvm/src/main/java/com/cloud/hypervisor/kvm/resource/LibvirtComputingResource.java", "diffHunk": "@@ -4239,10 +4239,10 @@ private void setCpuTopology(CpuModeDef cmd, int vcpus, Map<String, String> detai\n                 numCoresPerSocket = 6;\n             } else if (vcpus % 4 == 0) {\n                 numCoresPerSocket = 4;\n-            } else {\n-                numCoresPerSocket = 1;\n             }\n         }\n-        cmd.setTopology(numCoresPerSocket, vcpus / numCoresPerSocket);\n+        if (numCoresPerSocket > 0) {\n+            cmd.setTopology(numCoresPerSocket, vcpus / numCoresPerSocket);\n+        }", "originalCommit": "43dcd65efe03efc294bad7d21c2aaa4573ca893b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}