{"pr_number": 1382, "pr_title": "[DOCS] Add total feature importance to classification example", "pr_createdAt": "2020-09-29T23:20:44Z", "pr_url": "https://github.com/elastic/stack-docs/pull/1382", "timeline": [{"oid": "c47e2f1ca29877dd6585dc757500359a72b09266", "url": "https://github.com/elastic/stack-docs/commit/c47e2f1ca29877dd6585dc757500359a72b09266", "message": "[DOCS] Update classification example", "committedDate": "2020-09-29T17:19:49Z", "type": "commit"}, {"oid": "507b08268616257f52d7536e90d6ecafd176188a", "url": "https://github.com/elastic/stack-docs/commit/507b08268616257f52d7536e90d6ecafd176188a", "message": "[DOCs] Add total feature importance to classification example", "committedDate": "2020-09-29T20:55:01Z", "type": "commit"}, {"oid": "d555723795a4245b10e82642eee59ad4a8f9d7a7", "url": "https://github.com/elastic/stack-docs/commit/d555723795a4245b10e82642eee59ad4a8f9d7a7", "message": "[DOCS] Updates feature importance overview", "committedDate": "2020-09-30T00:57:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ2Mjc5NA==", "url": "https://github.com/elastic/stack-docs/pull/1382#discussion_r497462794", "bodyText": "Good description! \ud83d\udc4d", "author": "valeriy42", "createdAt": "2020-09-30T12:18:22Z", "path": "docs/en/stack/ml/df-analytics/flightdata-classification.asciidoc", "diffHunk": "@@ -332,59 +339,166 @@ probability of all possible classes for the dependent variable. The\n ====\n [source,console]\n --------------------------------------------------\n-GET df-flight-delayed/_search\n+GET model-flight-delay-classification/_search\n --------------------------------------------------\n // TEST[skip:TBD]\n \n The snippet below shows a part of a document with the annotated results:\n \n [source,console-result]\n-----  \n+--------------------------------------------------  \n           ...\n           \"FlightDelay\" : false,\n           ...\n           \"ml\" : {\n+            \"FlightDelay_prediction\" : false,\n             \"top_classes\" : [ <1>\n               {\n-                \"class_probability\" : 0.9198146781161334, \n-               \"class_score\" : 0.36964390728677926, \n-               \"class_name\" : false\n+                \"class_name\" : false,\n+                \"class_probability\" : 0.9427605087816684,\n+                \"class_score\" : 0.3462468700158476\n               },\n               {\n-                \"class_probability\" : 0.08018532188386665,\n-                 \"class_score\" : 0.08018532188386665,\n-                 \"class_name\" : true\n+                \"class_name\" : true,\n+                \"class_probability\" : 0.057239491218331606,\n+                \"class_score\" : 0.057239491218331606\n               }\n             ],\n-            \"prediction_score\" : 0.36964390728677926,\n-            \"FlightDelay_prediction\" : false,\n-            \"prediction_probability\" : 0.9198146781161334,\n+            \"prediction_probability\" : 0.9427605087816684,\n+            \"prediction_score\" : 0.3462468700158476,\n             \"feature_importance\" : [\n               {\n                 \"feature_name\" : \"DistanceMiles\",\n-                \"importance\" : -3.039025449178423\n+                \"classes\" : [\n+                  {\n+                    \"class_name\" : false,\n+                    \"importance\" : -1.4766536146534828\n+                  },\n+                  {\n+                    \"class_name\" : true,\n+                    \"importance\" : 1.4766536146534828\n+                  }\n+                ]\n               },\n               {\n                 \"feature_name\" : \"FlightTimeMin\",\n-                \"importance\" : 2.4980756273399045\n-              }\n-            ],\n-            \"is_training\" : false\n-          }\n-----\n+                \"classes\" : [\n+                  {\n+                    \"class_name\" : false,\n+                    \"importance\" : 1.0919201754729184\n+                  },\n+                  {\n+                    \"class_name\" : true,\n+                    \"importance\" : -1.0919201754729184\n+                  }\n+                ]\n+              },\n+              ...\n+--------------------------------------------------\n <1> An array of values specifying the probability of the prediction and the \n score for each class. \n \n The class with the highest score is the prediction. In this example, `false` has\n-a `class_score` of 0.37 while `true` has only 0.08, so the prediction will be\n+a `class_score` of 0.35 while `true` has only 0.06, so the prediction will be\n `false`. For more details about these values, see\n <<dfa-classification-interpret>>.\n+====\n+\n+If you chose to calculate {feat-imp}, the destination index also contains\n+`ml.feature_importance` objects. Every field that is included in the\n+{classanalysis} (known as a _feature_ of the data point) is assigned a {feat-imp}\n+value. This value has both a magnitude and a direction (positive or negative),\n+which indicates how each field affects a particular prediction. Only the most\n+significant values (in this case, the top 10) are stored in the index. However,\n+the trained model metadata also contains the average magnitude of the {feat-imp}\n+values for each field across all the training data. You can view this", "originalCommit": "d555723795a4245b10e82642eee59ad4a8f9d7a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}