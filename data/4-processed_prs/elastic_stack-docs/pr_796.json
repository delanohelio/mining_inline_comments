{"pr_number": 796, "pr_title": "[Docs][SIEM] Detection engine ui documentation", "pr_createdAt": "2020-01-07T14:36:55Z", "pr_url": "https://github.com/elastic/stack-docs/pull/796", "timeline": [{"oid": "7bc4ed64492f82d8b3f233a3ccef2eff4f3a7c6d", "url": "https://github.com/elastic/stack-docs/commit/7bc4ed64492f82d8b3f233a3ccef2eff4f3a7c6d", "message": "fixes asciidoc formatting", "committedDate": "2020-01-08T14:08:58Z", "type": "forcePushed"}, {"oid": "c1caab63e032b8f2633828dc8660b6715d222aa0", "url": "https://github.com/elastic/stack-docs/commit/c1caab63e032b8f2633828dc8660b6715d222aa0", "message": "starts detection  engine ui documentation", "committedDate": "2020-01-08T14:24:36Z", "type": "forcePushed"}, {"oid": "4089ac3f0040814b80668d430b579c9ae30daa75", "url": "https://github.com/elastic/stack-docs/commit/4089ac3f0040814b80668d430b579c9ae30daa75", "message": "starts detection  engine ui documentation", "committedDate": "2020-01-19T08:12:41Z", "type": "commit"}, {"oid": "bdb19ec9222b46a125efe991a945850ac818164a", "url": "https://github.com/elastic/stack-docs/commit/bdb19ec9222b46a125efe991a945850ac818164a", "message": "updates descriptions and tasks", "committedDate": "2020-01-19T08:12:41Z", "type": "commit"}, {"oid": "ebb513e26367d9118bf1c302fe52b8ef3a4fcb69", "url": "https://github.com/elastic/stack-docs/commit/ebb513e26367d9118bf1c302fe52b8ef3a4fcb69", "message": "adds prebuilt rules draft", "committedDate": "2020-01-19T08:12:41Z", "type": "commit"}, {"oid": "ebb513e26367d9118bf1c302fe52b8ef3a4fcb69", "url": "https://github.com/elastic/stack-docs/commit/ebb513e26367d9118bf1c302fe52b8ef3a4fcb69", "message": "adds prebuilt rules draft", "committedDate": "2020-01-19T08:12:41Z", "type": "forcePushed"}, {"oid": "3289312a25739a95795a5402ed499b8d11433340", "url": "https://github.com/elastic/stack-docs/commit/3289312a25739a95795a5402ed499b8d11433340", "message": "updates names and screenshots", "committedDate": "2020-01-19T10:01:42Z", "type": "commit"}, {"oid": "2ad69cebba06e51818b742e316a4c51ee8521794", "url": "https://github.com/elastic/stack-docs/commit/2ad69cebba06e51818b742e316a4c51ee8521794", "message": "removes beta from siem and adds beta to detections", "committedDate": "2020-01-19T14:01:45Z", "type": "commit"}, {"oid": "8c6a2d547fd26d31e31919b8c69122bf43ba208e", "url": "https://github.com/elastic/stack-docs/commit/8c6a2d547fd26d31e31919b8c69122bf43ba208e", "message": "corrects ui section structure", "committedDate": "2020-01-20T08:53:43Z", "type": "commit"}, {"oid": "e3055007b94c2778ec75d8973dabc99b226f9fe5", "url": "https://github.com/elastic/stack-docs/commit/e3055007b94c2778ec75d8973dabc99b226f9fe5", "message": "formatting", "committedDate": "2020-01-21T06:48:30Z", "type": "commit"}, {"oid": "dfdfd7b7fa4c3cf4215b0838dee7242094e50847", "url": "https://github.com/elastic/stack-docs/commit/dfdfd7b7fa4c3cf4215b0838dee7242094e50847", "message": "updates prebuilt rules draft", "committedDate": "2020-01-21T17:06:24Z", "type": "commit"}, {"oid": "14f25a55365bf940050dd6aa36967b1d07d82a4f", "url": "https://github.com/elastic/stack-docs/commit/14f25a55365bf940050dd6aa36967b1d07d82a4f", "message": "updates prebuilt rules draft", "committedDate": "2020-01-22T11:33:06Z", "type": "commit"}, {"oid": "7df41ba9f1146c251a6166a66005451f4919d9b8", "url": "https://github.com/elastic/stack-docs/commit/7df41ba9f1146c251a6166a66005451f4919d9b8", "message": "adds loading prebuilt rules", "committedDate": "2020-01-22T14:07:54Z", "type": "commit"}, {"oid": "ae000bcec2ba05ef812da7dc899f9a6516faf441", "url": "https://github.com/elastic/stack-docs/commit/ae000bcec2ba05ef812da7dc899f9a6516faf441", "message": "adds required privileges", "committedDate": "2020-01-22T17:37:19Z", "type": "commit"}, {"oid": "0778efbf290789b10aa143db2ec396f1c084c316", "url": "https://github.com/elastic/stack-docs/commit/0778efbf290789b10aa143db2ec396f1c084c316", "message": "proofing, screenshots, and all that jazz", "committedDate": "2020-01-23T08:52:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc0OTMwMQ==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r370749301", "bodyText": "Change \"Signals...\" sentence from passive to active, \"Signals never come from third-party systems\".", "author": "narcher7", "createdAt": "2020-01-24T17:22:04Z", "path": "docs/en/siem/detection-engine-intro.asciidoc", "diffHunk": "@@ -0,0 +1,97 @@\n+[[detection-engine-overview]]\n+[role=\"xpack\"]\n+\n+== Detections (Beta)\n+\n+beta[]\n+\n+The SIEM Detections feature automatically searches for threats and creates \n+signals when they are detected. Signal detection rules define the conditions \n+for creating signals. The {siem-app} comes with\n+<<prebuilt-rules, prebuilt rules>> that search for suspicious \n+activity on your network and hosts. Additionally, you can\n+<<rules-ui-create, create your own rules>>.\n+\n+[IMPORTANT]\n+==============\n+See <<detections-permissions, {kib} and index privileges>> required for viewing \n+signals and creating rules.\n+==============\n+\n+[float]\n+[[det-engine-terminology]]\n+=== Terminology\n+\n+Signals::\n+Always refer to a {siem-soln} produced detections. Signals are never ", "originalCommit": "0778efbf290789b10aa143db2ec396f1c084c316", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc0OTUyNg==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r370749526", "bodyText": "Capitalize \"The\".", "author": "narcher7", "createdAt": "2020-01-24T17:22:39Z", "path": "docs/en/siem/detection-engine-intro.asciidoc", "diffHunk": "@@ -0,0 +1,97 @@\n+[[detection-engine-overview]]\n+[role=\"xpack\"]\n+\n+== Detections (Beta)\n+\n+beta[]\n+\n+The SIEM Detections feature automatically searches for threats and creates \n+signals when they are detected. Signal detection rules define the conditions \n+for creating signals. The {siem-app} comes with\n+<<prebuilt-rules, prebuilt rules>> that search for suspicious \n+activity on your network and hosts. Additionally, you can\n+<<rules-ui-create, create your own rules>>.\n+\n+[IMPORTANT]\n+==============\n+See <<detections-permissions, {kib} and index privileges>> required for viewing \n+signals and creating rules.\n+==============\n+\n+[float]\n+[[det-engine-terminology]]\n+=== Terminology\n+\n+Signals::\n+Always refer to a {siem-soln} produced detections. Signals are never \n+received from third-party systems. When a rule's conditions are met, the\n+{siem-app} writes one or more signals to an Elasticsearch `signals` index.\n+\n+[NOTE]\n+==============\n+Signal indices are created for each {kib} space. The naming convention is:\n+`.siem-signals-<space name>`. For the default space, the signals index is named \n+`.siem-signals-default`.\n+==============\n+\n+Alerts and events::\n+Always refer to data the {siem-app} receives from data shippers and external \n+tools, such as Suricata and Elastic Endpoint Security.\n+\n+[float]\n+=== Signals and external alerts\n+\n+The Detections page displays all signals and alerts. To view signals created \n+by a rule, click *Manage signal detection rules* and then the relevant rule in \n+the All rules table.\n+\n+To view alerts from external data shippers, click *External alerts*.\n+\n+[float]\n+==== Open and close signals\n+\n+You can close signals to indicate they do not need any further investigation. \n+By default, the All signals table displays open signals. To view closed \n+signals, click *Closed signals*.\n+\n+To open and close signals, either:\n+\n+* Click the *Close/Open signal* icon.\n+* Select the signals you want to open or close and then click *Batch actions*\n+-> *Close/Open selected*.\n+\n+[float]\n+==== Send signals to the Timeline\n+\n+To investigate signals in the Timeline, either:\n+\n+* Click the *View in timeline* icon\n+* Select the signals you want to view in the Timeline and then click\n+*Batch actions* -> *View selected in timeline*\n+\n+[float]\n+[[detections-permissions]]\n+=== {kib} and index privileges required for Detections\n+\n+[IMPORTANT]\n+==============\n+You cannot view the Detections page until a user with the `create_index` \n+privilege for the {kib} space visits the page.\n+==============\n+\n+To view signals and detection rules, you must have at least:\n+\n+* `read` permissions for the `.siem-signals-<space name>` index, where\n+`<space name>` is the name of the {kib} space you are using to view Detections\n+(see {ref}/security-privileges.html#privileges-list-indices[Indices privileges]).\n+* {kib} space `Read` privileges for the `SIEM` and `Saved Objects Management` \n+features (see {kibana-ref}/xpack-spaces.html#spaces-control-user-access[Feature access based on user privileges]).\n+\n+To create and modify detection rules, you must have:\n+\n+* the `manage_api_key` cluster privilege (see {ref}/security-privileges.html[Security privileges]).", "originalCommit": "0778efbf290789b10aa143db2ec396f1c084c316", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc1MDMxOQ==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r370750319", "bodyText": "Spelling, \"reun\" to \"rerun\".", "author": "narcher7", "createdAt": "2020-01-24T17:24:29Z", "path": "docs/en/siem/rules-ui-create.asciidoc", "diffHunk": "@@ -0,0 +1,141 @@\n+[[rules-ui-create]]\n+[role=\"xpack\"]\n+=== Managing signal detection rules\n+\n+beta[]\n+\n+Rules run periodically and search the specified indices for \n+documents that meet their criteria.\n+\n+IMPORTANT:: If for any reason a rule fails to run, the {siem-app} tries to reun ", "originalCommit": "0778efbf290789b10aa143db2ec396f1c084c316", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc1NzgwOQ==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r370757809", "bodyText": "Delete \"for any reason\" so sentence starts \"If a rule fails...\"", "author": "narcher7", "createdAt": "2020-01-24T17:41:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc1MDMxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2MTEzMQ==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r370761131", "bodyText": "Add a comma after time. \"...at its next scheduled run time, and an error...\".\nChange \"...is displayed...\" to \"displays\".", "author": "narcher7", "createdAt": "2020-01-24T17:49:42Z", "path": "docs/en/siem/rules-ui-create.asciidoc", "diffHunk": "@@ -0,0 +1,141 @@\n+[[rules-ui-create]]\n+[role=\"xpack\"]\n+=== Managing signal detection rules\n+\n+beta[]\n+\n+Rules run periodically and search the specified indices for \n+documents that meet their criteria.\n+\n+IMPORTANT:: If for any reason a rule fails to run, the {siem-app} tries to reun \n+it at its next scheduled run time and an error is displayed in the ", "originalCommit": "0778efbf290789b10aa143db2ec396f1c084c316", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2NTMyMw==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r370765323", "bodyText": "Should we separate look-back time with bold or monospace formatting since it's a setting?", "author": "narcher7", "createdAt": "2020-01-24T17:59:36Z", "path": "docs/en/siem/rules-ui-create.asciidoc", "diffHunk": "@@ -0,0 +1,141 @@\n+[[rules-ui-create]]\n+[role=\"xpack\"]\n+=== Managing signal detection rules\n+\n+beta[]\n+\n+Rules run periodically and search the specified indices for \n+documents that meet their criteria.\n+\n+IMPORTANT:: If for any reason a rule fails to run, the {siem-app} tries to reun \n+it at its next scheduled run time and an error is displayed in the \n+*Failure History* table on the rule's page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules* -> <rule name>).\n+\n+On the Rules page, you can:\n+\n+* <<load-prebuilt-rules>>\n+* <<create-rule-ui, Create your own rules>>\n+* <<manage-rules-ui, Clone, delete, activate, and deactivate rules>>\n+* <<import-export-rules-ui>>\n+\n+[role=\"screenshot\"]\n+image::all-rules.png[]\n+\n+[[load-prebuilt-rules]]\n+==== Load prebuilt Elastic rules\n+\n+To load the {siem-app}'s prebuilt rules, click *Load Elastic prebuilt rules* \n+on the *Signal detection rules* page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules*).\n+\n+If you delete any of the prebuilt rules, a button appears that enables \n+reloading all the deleted prebuilt rules.\n+\n+[NOTE]\n+==============\n+By default, prebuilt rules are not activated. If you want to modify a prebuilt \n+rule, you must first duplicate it and then make your changes to the duplicated rule.\n+==============\n+\n+[[create-rule-ui]]\n+==== Create a new rule\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Click *Create new rule*.\n++\n+The *Create new rule* page is displayed.\n+[role=\"screenshot\"]\n+image::create-new-rule.png[]\n+. Define which {es} indices the rule analyzes for signals.\n+. Use the filter and query fields to create the criteria used for detecting \n+signals. For example, a rule that detects when a Microsoft Office product \n+starts a process in a user folder uses the following query and filters:\n+\n+* _Custom query_ `process.parent.name: EXCEL.EXE or process.parent.name: MSPUB.EXE or process.parent.name: OUTLOOK.EXE or process.parent.name: POWERPNT.EXE or process.parent.name: VISIO.EXE or process.parent.name: WINWORD.EXE`\n+* _Add filter_:\n+** *Field*: `event.action`\n+** *Operator*: `is`\n+** *Value*: `Process Create (rule: ProcessCreate)`\n+. Click *Continue*.\n++\n+The *About rule* pane is displayed.\n+[role=\"screenshot\"]\n+image::about-rule-pane.png[]\n+. Fill in the following fields:\n+.. _Name_: The rule's name.\n+.. _Description_: A description of what the rule does.\n+.. _Severity_: Select the severity levels of signals created by the rule:\n+* `Low`: Signals that are of interest but generally not considered to be \n+security incidents. Sometimes, a combination of low severity events can \n+indicate suspicious activity.\n+* `Medium`: Signals that require investigation.\n+* `High`: Signals that require an immediate investigation.\n+* `Critical`: Signals that indicate a security incident has occurred.\n+.. _Risk score_: A numerical value between 0 and 100 that correlates with the _Severity_ level. General guidelines are:\n+* `21` represents low severity.\n+* `47` represents medium severity.\n+* `73` represents high severity.\n+* `99` represents critical severity.\n+.. For additional options, click *Advanced settings* and fill in any of \n+these fields: \n+... _Timeline template_ (optional): Select a timeline template used when you \n+send a signal created by the rule to the timeline.\n++\n+TIP: Before you create rules, create and save relevant\n+<<timelines-ui,timelines>> so they can be selected here. \n+\n+... _Reference URLs_ (optional): References to information that is relevant to \n+the rule. For example, links to relevant background information.\n+... _False positives_ (optional): List of common scenarios that may produce \n+false-positive signals.\n+... _MITRE ATT&CK^TM^_ (optional): Relevant MITRE framework tactics and techniques.\n+... _Tags_ (optional): Words and phrases used to categorize, filter, and search \n+the rule.\n+. Click *Continue*.\n++\n+The *Schedule rule* pane is displayed.\n+[role=\"screenshot\"]\n+image::schedule-rule.png[]\n+. Select how often the rule runs.\n+. Optionally, add look-back time to the rule. When defined, the rule searches ", "originalCommit": "0778efbf290789b10aa143db2ec396f1c084c316", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2NTYzMQ==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r370765631", "bodyText": "Add a comma after \"rule,\"", "author": "narcher7", "createdAt": "2020-01-24T18:00:22Z", "path": "docs/en/siem/rules-ui-create.asciidoc", "diffHunk": "@@ -0,0 +1,141 @@\n+[[rules-ui-create]]\n+[role=\"xpack\"]\n+=== Managing signal detection rules\n+\n+beta[]\n+\n+Rules run periodically and search the specified indices for \n+documents that meet their criteria.\n+\n+IMPORTANT:: If for any reason a rule fails to run, the {siem-app} tries to reun \n+it at its next scheduled run time and an error is displayed in the \n+*Failure History* table on the rule's page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules* -> <rule name>).\n+\n+On the Rules page, you can:\n+\n+* <<load-prebuilt-rules>>\n+* <<create-rule-ui, Create your own rules>>\n+* <<manage-rules-ui, Clone, delete, activate, and deactivate rules>>\n+* <<import-export-rules-ui>>\n+\n+[role=\"screenshot\"]\n+image::all-rules.png[]\n+\n+[[load-prebuilt-rules]]\n+==== Load prebuilt Elastic rules\n+\n+To load the {siem-app}'s prebuilt rules, click *Load Elastic prebuilt rules* \n+on the *Signal detection rules* page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules*).\n+\n+If you delete any of the prebuilt rules, a button appears that enables \n+reloading all the deleted prebuilt rules.\n+\n+[NOTE]\n+==============\n+By default, prebuilt rules are not activated. If you want to modify a prebuilt \n+rule, you must first duplicate it and then make your changes to the duplicated rule.\n+==============\n+\n+[[create-rule-ui]]\n+==== Create a new rule\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Click *Create new rule*.\n++\n+The *Create new rule* page is displayed.\n+[role=\"screenshot\"]\n+image::create-new-rule.png[]\n+. Define which {es} indices the rule analyzes for signals.\n+. Use the filter and query fields to create the criteria used for detecting \n+signals. For example, a rule that detects when a Microsoft Office product \n+starts a process in a user folder uses the following query and filters:\n+\n+* _Custom query_ `process.parent.name: EXCEL.EXE or process.parent.name: MSPUB.EXE or process.parent.name: OUTLOOK.EXE or process.parent.name: POWERPNT.EXE or process.parent.name: VISIO.EXE or process.parent.name: WINWORD.EXE`\n+* _Add filter_:\n+** *Field*: `event.action`\n+** *Operator*: `is`\n+** *Value*: `Process Create (rule: ProcessCreate)`\n+. Click *Continue*.\n++\n+The *About rule* pane is displayed.\n+[role=\"screenshot\"]\n+image::about-rule-pane.png[]\n+. Fill in the following fields:\n+.. _Name_: The rule's name.\n+.. _Description_: A description of what the rule does.\n+.. _Severity_: Select the severity levels of signals created by the rule:\n+* `Low`: Signals that are of interest but generally not considered to be \n+security incidents. Sometimes, a combination of low severity events can \n+indicate suspicious activity.\n+* `Medium`: Signals that require investigation.\n+* `High`: Signals that require an immediate investigation.\n+* `Critical`: Signals that indicate a security incident has occurred.\n+.. _Risk score_: A numerical value between 0 and 100 that correlates with the _Severity_ level. General guidelines are:\n+* `21` represents low severity.\n+* `47` represents medium severity.\n+* `73` represents high severity.\n+* `99` represents critical severity.\n+.. For additional options, click *Advanced settings* and fill in any of \n+these fields: \n+... _Timeline template_ (optional): Select a timeline template used when you \n+send a signal created by the rule to the timeline.\n++\n+TIP: Before you create rules, create and save relevant\n+<<timelines-ui,timelines>> so they can be selected here. \n+\n+... _Reference URLs_ (optional): References to information that is relevant to \n+the rule. For example, links to relevant background information.\n+... _False positives_ (optional): List of common scenarios that may produce \n+false-positive signals.\n+... _MITRE ATT&CK^TM^_ (optional): Relevant MITRE framework tactics and techniques.\n+... _Tags_ (optional): Words and phrases used to categorize, filter, and search \n+the rule.\n+. Click *Continue*.\n++\n+The *Schedule rule* pane is displayed.\n+[role=\"screenshot\"]\n+image::schedule-rule.png[]\n+. Select how often the rule runs.\n+. Optionally, add look-back time to the rule. When defined, the rule searches \n+indices with the additional time.\n++\n+For example, if you set a rule to run every 5 minutes with an additional\n+look-back time of 1 minute, the rule runs every 5 minutes but analyses the \n+documents added to indices during the last 6 minutes. This overlap helps ensure \n+signals are issued even when incoming data is delayed.\n+. Save the rule with or without activation.\n++\n+NOTE: When you activate a rule it is queued, and its schedule is determined by ", "originalCommit": "0778efbf290789b10aa143db2ec396f1c084c316", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2Nzg2Mw==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r370767863", "bodyText": "I would rework this sentence to, \"When you activate a rule, the rule places in a queue. The rule's initial run time determines its schedule. For example, if you activate a rule that runs every 5 minutes at 14:02, but it does not run until 14:04, the rule runs again at 14:09.\"", "author": "narcher7", "createdAt": "2020-01-24T18:05:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2NTYzMQ=="}], "type": "inlineReview"}, {"oid": "befe6f659aea35c4f09cb280d1950c9a463476dd", "url": "https://github.com/elastic/stack-docs/commit/befe6f659aea35c4f09cb280d1950c9a463476dd", "message": "corrections after review", "committedDate": "2020-01-26T09:14:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyODg4OQ==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r371028889", "bodyText": "Might be too much information for this block, but just want to note you can also use the KQL filter to narrow which signals are displayed on the main Detections page ala:\nsignal.rule.name: \"SSH (Secure Shell) from the Internet\" \n\nOnly on the main Detections page, Rule Details, and Timelines that have All events or Signal events selected do we add the .siem-signals index. So it's only on those two pages and applicable Timelines that the user will get autosuggestions when typing signal..", "author": "spong", "createdAt": "2020-01-26T20:58:59Z", "path": "docs/en/siem/detection-engine-intro.asciidoc", "diffHunk": "@@ -0,0 +1,97 @@\n+[[detection-engine-overview]]\n+[role=\"xpack\"]\n+\n+== Detections (Beta)\n+\n+beta[]\n+\n+The SIEM Detections feature automatically searches for threats and creates \n+signals when they are detected. Signal detection rules define the conditions \n+for creating signals. The {siem-app} comes with\n+<<prebuilt-rules, prebuilt rules>> that search for suspicious \n+activity on your network and hosts. Additionally, you can\n+<<rules-ui-create, create your own rules>>.\n+\n+[IMPORTANT]\n+==============\n+See <<detections-permissions, {kib} and index privileges>> required for viewing \n+signals and creating rules.\n+==============\n+\n+[float]\n+[[det-engine-terminology]]\n+=== Terminology\n+\n+Signals::\n+Always refer to a {siem-soln} produced detections. Signals are never \n+received from third-party systems. When a rule's conditions are met, the\n+{siem-app} writes one or more signals to an Elasticsearch `signals` index.\n+\n+[NOTE]\n+==============\n+Signal indices are created for each {kib} space. The naming convention is:\n+`.siem-signals-<space name>`. For the default space, the signals index is named \n+`.siem-signals-default`.\n+==============\n+\n+Alerts and events::\n+Always refer to data the {siem-app} receives from data shippers and external \n+tools, such as Suricata and Elastic Endpoint Security.\n+\n+[float]\n+=== Signals and external alerts\n+\n+The Detections page displays all signals and alerts. To view signals created \n+by a rule, click *Manage signal detection rules* and then the relevant rule in \n+the All rules table.", "originalCommit": "befe6f659aea35c4f09cb280d1950c9a463476dd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyOTAzNg==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r371029036", "bodyText": "It appears Batch actions was removed from the Signals Table in favor of just having the open/close action in the main Utility Bar:", "author": "spong", "createdAt": "2020-01-26T21:01:42Z", "path": "docs/en/siem/detection-engine-intro.asciidoc", "diffHunk": "@@ -0,0 +1,97 @@\n+[[detection-engine-overview]]\n+[role=\"xpack\"]\n+\n+== Detections (Beta)\n+\n+beta[]\n+\n+The SIEM Detections feature automatically searches for threats and creates \n+signals when they are detected. Signal detection rules define the conditions \n+for creating signals. The {siem-app} comes with\n+<<prebuilt-rules, prebuilt rules>> that search for suspicious \n+activity on your network and hosts. Additionally, you can\n+<<rules-ui-create, create your own rules>>.\n+\n+[IMPORTANT]\n+==============\n+See <<detections-permissions, {kib} and index privileges>> required for viewing \n+signals and creating rules.\n+==============\n+\n+[float]\n+[[det-engine-terminology]]\n+=== Terminology\n+\n+Signals::\n+Always refer to a {siem-soln} produced detections. Signals are never \n+received from third-party systems. When a rule's conditions are met, the\n+{siem-app} writes one or more signals to an Elasticsearch `signals` index.\n+\n+[NOTE]\n+==============\n+Signal indices are created for each {kib} space. The naming convention is:\n+`.siem-signals-<space name>`. For the default space, the signals index is named \n+`.siem-signals-default`.\n+==============\n+\n+Alerts and events::\n+Always refer to data the {siem-app} receives from data shippers and external \n+tools, such as Suricata and Elastic Endpoint Security.\n+\n+[float]\n+=== Signals and external alerts\n+\n+The Detections page displays all signals and alerts. To view signals created \n+by a rule, click *Manage signal detection rules* and then the relevant rule in \n+the All rules table.\n+\n+To view alerts from external data shippers, click *External alerts*.\n+\n+[float]\n+==== Open and close signals\n+\n+You can close signals to indicate they do not need any further investigation. \n+By default, the All signals table displays open signals. To view closed \n+signals, click *Closed signals*.\n+\n+To open and close signals, either:\n+\n+* Click the *Close/Open signal* icon.\n+* Select the signals you want to open or close and then click *Batch actions*\n+-> *Close/Open selected*.", "originalCommit": "befe6f659aea35c4f09cb280d1950c9a463476dd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyOTA2Mw==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r371029063", "bodyText": "As above, Batch actions was removed from the Signals Table since we're not supporting sending multiple signals to the Timeline at the moment. The View in timeline actions looks to only be available as an action on each row itself.", "author": "spong", "createdAt": "2020-01-26T21:02:15Z", "path": "docs/en/siem/detection-engine-intro.asciidoc", "diffHunk": "@@ -0,0 +1,97 @@\n+[[detection-engine-overview]]\n+[role=\"xpack\"]\n+\n+== Detections (Beta)\n+\n+beta[]\n+\n+The SIEM Detections feature automatically searches for threats and creates \n+signals when they are detected. Signal detection rules define the conditions \n+for creating signals. The {siem-app} comes with\n+<<prebuilt-rules, prebuilt rules>> that search for suspicious \n+activity on your network and hosts. Additionally, you can\n+<<rules-ui-create, create your own rules>>.\n+\n+[IMPORTANT]\n+==============\n+See <<detections-permissions, {kib} and index privileges>> required for viewing \n+signals and creating rules.\n+==============\n+\n+[float]\n+[[det-engine-terminology]]\n+=== Terminology\n+\n+Signals::\n+Always refer to a {siem-soln} produced detections. Signals are never \n+received from third-party systems. When a rule's conditions are met, the\n+{siem-app} writes one or more signals to an Elasticsearch `signals` index.\n+\n+[NOTE]\n+==============\n+Signal indices are created for each {kib} space. The naming convention is:\n+`.siem-signals-<space name>`. For the default space, the signals index is named \n+`.siem-signals-default`.\n+==============\n+\n+Alerts and events::\n+Always refer to data the {siem-app} receives from data shippers and external \n+tools, such as Suricata and Elastic Endpoint Security.\n+\n+[float]\n+=== Signals and external alerts\n+\n+The Detections page displays all signals and alerts. To view signals created \n+by a rule, click *Manage signal detection rules* and then the relevant rule in \n+the All rules table.\n+\n+To view alerts from external data shippers, click *External alerts*.\n+\n+[float]\n+==== Open and close signals\n+\n+You can close signals to indicate they do not need any further investigation. \n+By default, the All signals table displays open signals. To view closed \n+signals, click *Closed signals*.\n+\n+To open and close signals, either:\n+\n+* Click the *Close/Open signal* icon.\n+* Select the signals you want to open or close and then click *Batch actions*\n+-> *Close/Open selected*.\n+\n+[float]\n+==== Send signals to the Timeline\n+\n+To investigate signals in the Timeline, either:\n+\n+* Click the *View in timeline* icon\n+* Select the signals you want to view in the Timeline and then click\n+*Batch actions* -> *View selected in timeline*", "originalCommit": "befe6f659aea35c4f09cb280d1950c9a463476dd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyOTg1MQ==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r371029851", "bodyText": "Just noting that there are two shortcuts to supplying a query + filter, and that's either using the newer Kibana core Saved Query feature (by clicking the \ud83d\udcbe),  or by clicking the Import query from saved timeline link at the top right of the query bar, which will present a dialog to the user for selecting an existing Timeline for which to grab the query+filter from. Note, this is a one-time fetching of the query+filter, and the rule's query is not synced/tied to the selected Timeline.", "author": "spong", "createdAt": "2020-01-26T21:15:27Z", "path": "docs/en/siem/rules-ui-create.asciidoc", "diffHunk": "@@ -0,0 +1,141 @@\n+[[rules-ui-create]]\n+[role=\"xpack\"]\n+=== Managing signal detection rules\n+\n+beta[]\n+\n+Rules run periodically and search the specified indices for \n+documents that meet their criteria.\n+\n+IMPORTANT:: If a rule fails to run, the {siem-app} tries to \n+rerun it at its next scheduled run time and an error is displayed in the \n+*Failure History* table on the rule's page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules* -> <rule name>).\n+\n+On the Rules page, you can:\n+\n+* <<load-prebuilt-rules>>\n+* <<create-rule-ui, Create your own rules>>\n+* <<manage-rules-ui, Clone, delete, activate, and deactivate rules>>\n+* <<import-export-rules-ui>>\n+\n+[role=\"screenshot\"]\n+image::all-rules.png[]\n+\n+[[load-prebuilt-rules]]\n+==== Load prebuilt Elastic rules\n+\n+To load the {siem-app}'s prebuilt rules, click *Load Elastic prebuilt rules* \n+on the *Signal detection rules* page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules*).\n+\n+If you delete any of the prebuilt rules, a button appears that enables \n+reloading all the deleted prebuilt rules.\n+\n+[NOTE]\n+==============\n+By default, prebuilt rules are not activated. If you want to modify a prebuilt \n+rule, you must first duplicate it and then make your changes to the duplicated rule.\n+==============\n+\n+[[create-rule-ui]]\n+==== Create a new rule\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Click *Create new rule*.\n++\n+The *Create new rule* page is displayed.\n+[role=\"screenshot\"]\n+image::create-new-rule.png[]\n+. Define which {es} indices the rule analyzes for signals.\n+. Use the filter and query fields to create the criteria used for detecting \n+signals. For example, a rule that detects when a Microsoft Office product \n+starts a process in a user folder uses the following query and filters:", "originalCommit": "befe6f659aea35c4f09cb280d1950c9a463476dd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAzMDgxMA==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r371030810", "bodyText": "Very nice wording of the look-back feature here @benskelker \ud83d\udc4f \ud83d\ude42 This has been a tough one to describe/grok in all the recent demos it seems.\nOne thing that might be worth noting though is that the server performs de-duplication of signals when it fetches data that has already resulted in the creation of signals.\nAlso, I believe the reason for this feature is not so much for when incoming data is delayed, but rather when there is a delay in the execution of the rule's query. E.g. if the user turns on 100's of rules and only has a single Kibana instance, rules may sit in the queue to be run long enough that there is a gap in coverage since the last time it was ran, and thus this additional look-back ensures that gap of data is queried (and then de-duped if it queries into the previous run's interval).\nFeel free to reach out if you have any questions around the corner cases. I'll do my best to answer, but @FrankHassanabad / @dhurley14 will know for sure though as they implemented this part of the Detection Engine \ud83d\ude05", "author": "spong", "createdAt": "2020-01-26T21:31:37Z", "path": "docs/en/siem/rules-ui-create.asciidoc", "diffHunk": "@@ -0,0 +1,141 @@\n+[[rules-ui-create]]\n+[role=\"xpack\"]\n+=== Managing signal detection rules\n+\n+beta[]\n+\n+Rules run periodically and search the specified indices for \n+documents that meet their criteria.\n+\n+IMPORTANT:: If a rule fails to run, the {siem-app} tries to \n+rerun it at its next scheduled run time and an error is displayed in the \n+*Failure History* table on the rule's page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules* -> <rule name>).\n+\n+On the Rules page, you can:\n+\n+* <<load-prebuilt-rules>>\n+* <<create-rule-ui, Create your own rules>>\n+* <<manage-rules-ui, Clone, delete, activate, and deactivate rules>>\n+* <<import-export-rules-ui>>\n+\n+[role=\"screenshot\"]\n+image::all-rules.png[]\n+\n+[[load-prebuilt-rules]]\n+==== Load prebuilt Elastic rules\n+\n+To load the {siem-app}'s prebuilt rules, click *Load Elastic prebuilt rules* \n+on the *Signal detection rules* page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules*).\n+\n+If you delete any of the prebuilt rules, a button appears that enables \n+reloading all the deleted prebuilt rules.\n+\n+[NOTE]\n+==============\n+By default, prebuilt rules are not activated. If you want to modify a prebuilt \n+rule, you must first duplicate it and then make your changes to the duplicated rule.\n+==============\n+\n+[[create-rule-ui]]\n+==== Create a new rule\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Click *Create new rule*.\n++\n+The *Create new rule* page is displayed.\n+[role=\"screenshot\"]\n+image::create-new-rule.png[]\n+. Define which {es} indices the rule analyzes for signals.\n+. Use the filter and query fields to create the criteria used for detecting \n+signals. For example, a rule that detects when a Microsoft Office product \n+starts a process in a user folder uses the following query and filters:\n+\n+* _Custom query_ `process.parent.name: EXCEL.EXE or process.parent.name: MSPUB.EXE or process.parent.name: OUTLOOK.EXE or process.parent.name: POWERPNT.EXE or process.parent.name: VISIO.EXE or process.parent.name: WINWORD.EXE`\n+* _Add filter_:\n+** *Field*: `event.action`\n+** *Operator*: `is`\n+** *Value*: `Process Create (rule: ProcessCreate)`\n+. Click *Continue*.\n++\n+The *About rule* pane is displayed.\n+[role=\"screenshot\"]\n+image::about-rule-pane.png[]\n+. Fill in the following fields:\n+.. _Name_: The rule's name.\n+.. _Description_: A description of what the rule does.\n+.. _Severity_: Select the severity levels of signals created by the rule:\n+* `Low`: Signals that are of interest but generally not considered to be \n+security incidents. Sometimes, a combination of low severity events can \n+indicate suspicious activity.\n+* `Medium`: Signals that require investigation.\n+* `High`: Signals that require an immediate investigation.\n+* `Critical`: Signals that indicate a security incident has occurred.\n+.. _Risk score_: A numerical value between 0 and 100 that correlates with the _Severity_ level. General guidelines are:\n+* `21` represents low severity.\n+* `47` represents medium severity.\n+* `73` represents high severity.\n+* `99` represents critical severity.\n+.. For additional options, click *Advanced settings* and fill in any of \n+these fields: \n+... _Timeline template_ (optional): Select a timeline template used when you \n+send a signal created by the rule to the timeline.\n++\n+TIP: Before you create rules, create and save relevant\n+<<timelines-ui,timelines>> so they can be selected here. \n+\n+... _Reference URLs_ (optional): References to information that is relevant to \n+the rule. For example, links to relevant background information.\n+... _False positives_ (optional): List of common scenarios that may produce \n+false-positive signals.\n+... _MITRE ATT&CK^TM^_ (optional): Relevant MITRE framework tactics and techniques.\n+... _Tags_ (optional): Words and phrases used to categorize, filter, and search \n+the rule.\n+. Click *Continue*.\n++\n+The *Schedule rule* pane is displayed.\n+[role=\"screenshot\"]\n+image::schedule-rule.png[]\n+. Select how often the rule runs.\n+. Optionally, add `look-back` time to the rule. When defined, the rule searches \n+indices with the additional time.\n++\n+For example, if you set a rule to run every 5 minutes with an additional\n+look-back time of 1 minute, the rule runs every 5 minutes but analyses the \n+documents added to indices during the last 6 minutes. This overlap helps ensure \n+signals are issued even when incoming data is delayed.", "originalCommit": "befe6f659aea35c4f09cb280d1950c9a463476dd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAzMTM2Ng==", "url": "https://github.com/elastic/stack-docs/pull/796#discussion_r371031366", "bodyText": "Not sure if there is going to be separate documentation for the Rule details page, but just wanted to note that the export action is also available under the action overflow icon in the top right of the page:", "author": "spong", "createdAt": "2020-01-26T21:40:28Z", "path": "docs/en/siem/rules-ui-create.asciidoc", "diffHunk": "@@ -0,0 +1,141 @@\n+[[rules-ui-create]]\n+[role=\"xpack\"]\n+=== Managing signal detection rules\n+\n+beta[]\n+\n+Rules run periodically and search the specified indices for \n+documents that meet their criteria.\n+\n+IMPORTANT:: If a rule fails to run, the {siem-app} tries to \n+rerun it at its next scheduled run time and an error is displayed in the \n+*Failure History* table on the rule's page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules* -> <rule name>).\n+\n+On the Rules page, you can:\n+\n+* <<load-prebuilt-rules>>\n+* <<create-rule-ui, Create your own rules>>\n+* <<manage-rules-ui, Clone, delete, activate, and deactivate rules>>\n+* <<import-export-rules-ui>>\n+\n+[role=\"screenshot\"]\n+image::all-rules.png[]\n+\n+[[load-prebuilt-rules]]\n+==== Load prebuilt Elastic rules\n+\n+To load the {siem-app}'s prebuilt rules, click *Load Elastic prebuilt rules* \n+on the *Signal detection rules* page (*SIEM* -> *Detections* ->\n+*Manage signal detection rules*).\n+\n+If you delete any of the prebuilt rules, a button appears that enables \n+reloading all the deleted prebuilt rules.\n+\n+[NOTE]\n+==============\n+By default, prebuilt rules are not activated. If you want to modify a prebuilt \n+rule, you must first duplicate it and then make your changes to the duplicated rule.\n+==============\n+\n+[[create-rule-ui]]\n+==== Create a new rule\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Click *Create new rule*.\n++\n+The *Create new rule* page is displayed.\n+[role=\"screenshot\"]\n+image::create-new-rule.png[]\n+. Define which {es} indices the rule analyzes for signals.\n+. Use the filter and query fields to create the criteria used for detecting \n+signals. For example, a rule that detects when a Microsoft Office product \n+starts a process in a user folder uses the following query and filters:\n+\n+* _Custom query_ `process.parent.name: EXCEL.EXE or process.parent.name: MSPUB.EXE or process.parent.name: OUTLOOK.EXE or process.parent.name: POWERPNT.EXE or process.parent.name: VISIO.EXE or process.parent.name: WINWORD.EXE`\n+* _Add filter_:\n+** *Field*: `event.action`\n+** *Operator*: `is`\n+** *Value*: `Process Create (rule: ProcessCreate)`\n+. Click *Continue*.\n++\n+The *About rule* pane is displayed.\n+[role=\"screenshot\"]\n+image::about-rule-pane.png[]\n+. Fill in the following fields:\n+.. _Name_: The rule's name.\n+.. _Description_: A description of what the rule does.\n+.. _Severity_: Select the severity levels of signals created by the rule:\n+* `Low`: Signals that are of interest but generally not considered to be \n+security incidents. Sometimes, a combination of low severity events can \n+indicate suspicious activity.\n+* `Medium`: Signals that require investigation.\n+* `High`: Signals that require an immediate investigation.\n+* `Critical`: Signals that indicate a security incident has occurred.\n+.. _Risk score_: A numerical value between 0 and 100 that correlates with the _Severity_ level. General guidelines are:\n+* `21` represents low severity.\n+* `47` represents medium severity.\n+* `73` represents high severity.\n+* `99` represents critical severity.\n+.. For additional options, click *Advanced settings* and fill in any of \n+these fields: \n+... _Timeline template_ (optional): Select a timeline template used when you \n+send a signal created by the rule to the timeline.\n++\n+TIP: Before you create rules, create and save relevant\n+<<timelines-ui,timelines>> so they can be selected here. \n+\n+... _Reference URLs_ (optional): References to information that is relevant to \n+the rule. For example, links to relevant background information.\n+... _False positives_ (optional): List of common scenarios that may produce \n+false-positive signals.\n+... _MITRE ATT&CK^TM^_ (optional): Relevant MITRE framework tactics and techniques.\n+... _Tags_ (optional): Words and phrases used to categorize, filter, and search \n+the rule.\n+. Click *Continue*.\n++\n+The *Schedule rule* pane is displayed.\n+[role=\"screenshot\"]\n+image::schedule-rule.png[]\n+. Select how often the rule runs.\n+. Optionally, add `look-back` time to the rule. When defined, the rule searches \n+indices with the additional time.\n++\n+For example, if you set a rule to run every 5 minutes with an additional\n+look-back time of 1 minute, the rule runs every 5 minutes but analyses the \n+documents added to indices during the last 6 minutes. This overlap helps ensure \n+signals are issued even when incoming data is delayed.\n+. Save the rule with or without activation.\n++\n+NOTE: When you activate a rule, it is queued and its schedule is determined by \n+its initial run time. For example, if you activate a rule that runs every 5 \n+minutes at 14:02, but it does not run until 14:04, it will run again at 14:09.\n+\n+[[manage-rules-ui]]\n+==== Modify existing rules\n+\n+You can clone, edit, activate, deactivate, and delete rules:\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. Do one of the following:\n+* Click the actions icon (three dots) and then select the required action.\n+* In the *Rule* column, select all the rules you want to act on, and then the \n+required action from the `Batch actions` menu.\n+. To activate or deactivate a rule, click the Activate toggle button.\n+\n+\n+[[import-export-rules-ui]]\n+==== Import and export rules\n+\n+. Go to *SIEM* -> *Detections* -> *Manage signal detection rules*.\n+. To import rules:\n+.. Click *Import rule*.\n+.. Drag-and-drop files containing the signal detection rules.\n++\n+NOTE: Imported rules must be in a `ndjson` file.\n+\n+. To export rules:\n+.. In the *All rules* table, select the rules you want to export.\n+.. Select *Batch actions* -> *Export selected*.\n++\n+NOTE: You cannot export prebuilt rules.", "originalCommit": "befe6f659aea35c4f09cb280d1950c9a463476dd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "63644f09549e9aae7c8eeb055e70e47ebb806e92", "url": "https://github.com/elastic/stack-docs/commit/63644f09549e9aae7c8eeb055e70e47ebb806e92", "message": "fixes after dev review", "committedDate": "2020-01-27T10:10:45Z", "type": "commit"}]}