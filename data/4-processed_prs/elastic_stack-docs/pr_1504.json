{"pr_number": 1504, "pr_title": "[DOCS] Adds security_linux and security_windows modules", "pr_createdAt": "2020-12-24T01:57:36Z", "pr_url": "https://github.com/elastic/stack-docs/pull/1504", "timeline": [{"oid": "dd8e5d80e02b1ed87b55cff3ea9cb12edd9b165f", "url": "https://github.com/elastic/stack-docs/commit/dd8e5d80e02b1ed87b55cff3ea9cb12edd9b165f", "message": "[DOCS] Adds new linux and windows security modules", "committedDate": "2021-01-28T23:57:17Z", "type": "commit"}, {"oid": "5f9aa12075920882952921c5590b8d69e29e3515", "url": "https://github.com/elastic/stack-docs/commit/5f9aa12075920882952921c5590b8d69e29e3515", "message": "[DOCS] Add version admonition", "committedDate": "2021-01-29T01:43:59Z", "type": "commit"}, {"oid": "5f9aa12075920882952921c5590b8d69e29e3515", "url": "https://github.com/elastic/stack-docs/commit/5f9aa12075920882952921c5590b8d69e29e3515", "message": "[DOCS] Add version admonition", "committedDate": "2021-01-29T01:43:59Z", "type": "forcePushed"}, {"oid": "5ea2fb8d21fccb68447fde7c88fef36a65baf1d2", "url": "https://github.com/elastic/stack-docs/commit/5ea2fb8d21fccb68447fde7c88fef36a65baf1d2", "message": "[DOCS] Adds missing mentions of Elastic Agent", "committedDate": "2021-01-29T18:33:53Z", "type": "commit"}, {"oid": "1fb3594adef936029c72c0b25d284b92bcdf5d68", "url": "https://github.com/elastic/stack-docs/commit/1fb3594adef936029c72c0b25d284b92bcdf5d68", "message": "[DOCS] Add event 4688 details", "committedDate": "2021-01-30T01:31:51Z", "type": "commit"}, {"oid": "25cff6147c1b85ea003c73afcc38e5b15f39ef22", "url": "https://github.com/elastic/stack-docs/commit/25cff6147c1b85ea003c73afcc38e5b15f39ef22", "message": "[DOCS] Add footnotes", "committedDate": "2021-02-03T00:41:40Z", "type": "commit"}, {"oid": "25cff6147c1b85ea003c73afcc38e5b15f39ef22", "url": "https://github.com/elastic/stack-docs/commit/25cff6147c1b85ea003c73afcc38e5b15f39ef22", "message": "[DOCS] Add footnotes", "committedDate": "2021-02-03T00:41:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTM4MjYwNQ==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r569382605", "bodyText": "It's very probable that it's just me, but I'm not sure I understand why the second sentence is important for me as a user. Or what other test options exist other than the two that are listed. Should I be aware that there might be certain cases that are not tested?", "author": "szabosteve", "createdAt": "2021-02-03T12:42:38Z", "path": "docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc", "diffHunk": "@@ -638,9 +649,217 @@ Required ECS fields when not using {beats}:::\n \n // end::security-cloudtrail-jobs[]\n \n+[discrete]\n+[[security-linux-jobs]]\n+== Security: Linux\n+\n+Detect suspicious activity using ECS Linux events. Tested with {auditbeat} and {agent}.", "originalCommit": "25cff6147c1b85ea003c73afcc38e5b15f39ef22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTczMjgwNA==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r569732804", "bodyText": "I agree that since we list those two as required, it goes without saying that we tested them. I'll remove those phrases.", "author": "lcawl", "createdAt": "2021-02-03T20:40:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTM4MjYwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MjQyMjA4NA==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r572422084", "bodyText": "So I can clarify the reason for the text \"Tested with {auditbeat} and {agent}\" is that there are some permutations that are untested. There is at least one new index for Windows events, from the new Elastic agent (not the endpoint), that is not yet in the data feed queries. There are at least three other endpoint modules for Filebeat that have not been tested. The experimental log stash modules have not been tested. Sometimes we see questions about \"why doesn't this or that event stream work\" so I tried to be more explicit in what's tested.", "author": "randomuserid", "createdAt": "2021-02-08T22:27:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTM4MjYwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MjQ0NjEyOA==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r572446128", "bodyText": "I think it makes sense that this statement exists in the module descriptions (security_windows/manifest.json and security_linux/manifest.json). I think until there's a mismatch between what's tested and what's listed in the \"Required Beats or integrations\", however, it's not worth calling out in the docs.", "author": "lcawl", "createdAt": "2021-02-08T23:18:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTM4MjYwNQ=="}], "type": "inlineReview"}, {"oid": "74a85630ff7c05eb0edd35684c352f2a8c8bd8c5", "url": "https://github.com/elastic/stack-docs/commit/74a85630ff7c05eb0edd35684c352f2a8c8bd8c5", "message": "[DOCS] Addresses feedback about testing", "committedDate": "2021-02-03T20:45:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTkwMjA5Ng==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r555902096", "bodyText": "this is the module query that is present in all jobs. I think this can be stated once at the beginning of the section.", "author": "randomuserid", "createdAt": "2021-01-12T16:24:00Z", "path": "docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc", "diffHunk": "@@ -638,9 +637,191 @@ Required ECS fields when not using {beats}:::\n \n // end::security-cloudtrail-jobs[]\n \n+[discrete]\n+[[security-linux-jobs]]\n+== Security: Linux\n+\n+These configurations are only available if data exists that matches the \n+recognizer query specified in the\n+https://github.com/elastic/kibana/blob/{branch}/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/manifest.json#L8[manifest file].\n+\n+Detect suspicious activity using ECS Linux events. Tested with {auditbeat} and {agent}.\n+\n+// tag::security-linux-jobs[]\n+v2_linux_anomalous_network_port_activity_ecs::\n+\n+Identifies unusual destination port activity that can indicate\n+command-and-control, persistence mechanism, or data exfiltration activity.\n++\n+Rarely used destination port activity is generally unusual in Linux fleets, and \n+can indicate unauthorized access or threat actor activity.\n+\n+Job details:::\n+\n+* Analyzes network activity logs where `host.os.type` is `linux` or ", "originalCommit": "b228228e01901e9a2965689ae682190da2120544", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTkwMzQ0Mw==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r555903443", "bodyText": "this query is also used across the entire module and could be stated once in the beginning of the section?", "author": "randomuserid", "createdAt": "2021-01-12T16:25:50Z", "path": "docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc", "diffHunk": "@@ -816,9 +997,259 @@ Required ECS fields when not using {beats}:::\n \n // end::siem-packetbeat-jobs[]\n \n+[discrete]\n+[[security-windows-jobs]]\n+== Security: Windows\n+\n+These configurations are only available if data exists that matches the \n+recognizer query specified in the\n+https://github.com/elastic/kibana/blob/{branch}/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/manifest.json#L8[manifest file].\n+\n+Detects suspicious activity using ECS Windows events. Tested with {winlogbeat} \n+and {agent}.\n+\n+// tag::security-windows-jobs[]\n+v2_rare_process_by_host_windows_ecs::\n+\n+Detects unusually rare processes on Windows hosts, which can indicate execution \n+of unauthorized services, malware, or persistence mechanisms.\n++\n+Processes are considered rare when they only run occasionally as compared with\n+other processes running on the host.\n+\n+Job details:::\n+\n+* Analyzes host activity logs where `host.os.family` or `host.os.type` is ", "originalCommit": "b228228e01901e9a2965689ae682190da2120544", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk5ODM4Ng==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r555998386", "bodyText": "we need to note this job is Sysmon-only at the moment. It will work with Endpoint events when the required field is added. ref: elastic/endpoint-dev#8112", "author": "randomuserid", "createdAt": "2021-01-12T18:49:58Z", "path": "docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc", "diffHunk": "@@ -816,9 +997,259 @@ Required ECS fields when not using {beats}:::\n \n // end::siem-packetbeat-jobs[]\n \n+[discrete]\n+[[security-windows-jobs]]\n+== Security: Windows\n+\n+These configurations are only available if data exists that matches the \n+recognizer query specified in the\n+https://github.com/elastic/kibana/blob/{branch}/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/manifest.json#L8[manifest file].\n+\n+Detects suspicious activity using ECS Windows events. Tested with {winlogbeat} \n+and {agent}.\n+\n+// tag::security-windows-jobs[]\n+v2_rare_process_by_host_windows_ecs::\n+\n+Detects unusually rare processes on Windows hosts, which can indicate execution \n+of unauthorized services, malware, or persistence mechanisms.\n++\n+Processes are considered rare when they only run occasionally as compared with\n+other processes running on the host.\n+\n+Job details:::\n+\n+* Analyzes host activity logs where `host.os.family` or `host.os.type` is \n+`windows`.\n+* Models occurrences of process activities on the host. \n+* Detects unusually rare processes compared to other processes on the host \n+(using the\n+{ml-docs}/ml-rare-functions.html#ml-rare[`rare` function]).\n+* Works on ECS compatible events across multiple indices.\n+\n+Required ECS fields:::\n+\n+* `event.category`\n+* `event.type`\n+* `host.name`\n+* `host.os.family`\n+* `host.os.type`\n+* `process.name`\n+* `user.name`\n+\n+v2_windows_anomalous_network_activity_ecs::\n+\n+Looks for unusual processes using the network which could indicate command-and-\n+control, lateral movement, persistence, or data exfiltration activity.\n++\n+A process with unusual network activity can denote process exploitation or\n+injection, where the process is used to run persistence mechanisms that allow a\n+malicious actor remote access or control of the host, data exfiltration, and\n+execution of unauthorized network applications.\n+\n+Job details:::\n+\n+* Analyzes network activity logs where `host.os.family` is `windows`.\n+* Models the occurrences of processes that cause network activity.\n+* Detects network activity caused by processes that occur rarely compared to \n+other processes (using the\n+{ml-docs}/ml-rare-functions.html#ml-rare[`rare` function]).\n+* Works on ECS compatible events across multiple indices.\n+\n+Required ECS fields:::\n+\n+* `destination.ip`\n+* `event.category`\n+* `event.type`\n+* `host.name`\n+* `host.os.family`\n+* `host.os.type`\n+* `process.name`\n+* `user.name`\n+\n+v2_windows_anomalous_path_activity_ecs::", "originalCommit": "b228228e01901e9a2965689ae682190da2120544", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MjQwNjI3OQ==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r572406279", "bodyText": "I think this is already accomplished by having only winlogbeat and sysmon listed in the \"required beats and integrations\" section. Is that sufficient?", "author": "lcawl", "createdAt": "2021-02-08T22:03:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk5ODM4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MjQyMTg2Mg==", "url": "https://github.com/elastic/stack-docs/pull/1504#discussion_r572421862", "bodyText": "OK", "author": "randomuserid", "createdAt": "2021-02-08T22:27:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTk5ODM4Ng=="}], "type": "inlineReview"}, {"oid": "21f8e02c8599c1f3726be34f63908cb7f6f5feca", "url": "https://github.com/elastic/stack-docs/commit/21f8e02c8599c1f3726be34f63908cb7f6f5feca", "message": "[DOCS] Move duplicated datafeed details", "committedDate": "2021-02-08T22:05:10Z", "type": "commit"}]}