{"pr_number": 1402, "pr_title": "Add the possibility to associate a type to an alias (indicating what it corresponds to)", "pr_createdAt": "2020-07-17T15:09:11Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1402", "timeline": [{"oid": "0c227ddc75a4756d5d77ec28b842756db94e44e0", "url": "https://github.com/powsybl/powsybl-core/commit/0c227ddc75a4756d5d77ec28b842756db94e44e0", "message": "Add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-07-22T12:20:43Z", "type": "forcePushed"}, {"oid": "464872b5323550e9ba392bb691a6cc31ce7342be", "url": "https://github.com/powsybl/powsybl-core/commit/464872b5323550e9ba392bb691a6cc31ce7342be", "message": "Serialization is now in XIIDM 1.4\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-07-23T13:34:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk2Njk4Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r464966982", "bodyText": "We could just have one map for that ?  Set<String> aliases is now useless?", "author": "geofjamg", "createdAt": "2020-08-04T10:55:21Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -24,10 +25,11 @@\n \n     protected boolean fictitious = false;\n \n-    protected Set<String> aliases = new TreeSet<>();\n-\n     protected final Properties properties = new Properties();\n \n+    private final Set<String> aliases = new TreeSet<>();\n+    private final Map<String, String> aliasesTypeByAlias = new HashMap<>();", "originalCommit": "464872b5323550e9ba392bb691a6cc31ce7342be", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk2NzkzOA==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r464967938", "bodyText": "This is a very inefficient implementation. It depends how it is used but we have to be aware of potential performance issue using this method. Is it really needed?", "author": "geofjamg", "createdAt": "2020-08-04T10:57:22Z", "path": "iidm/iidm-impl/src/main/java/com/powsybl/iidm/network/impl/AbstractIdentifiable.java", "diffHunk": "@@ -58,17 +60,43 @@ public String getNameOrId() {\n         return Collections.unmodifiableSet(aliases);\n     }\n \n+    @Override\n+    public Set<String> getAliases(String aliasType) {", "originalCommit": "464872b5323550e9ba392bb691a6cc31ce7342be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzc5MzU5Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r473793592", "bodyText": "I made a draft PR #1447 to show how aliases' types can be used in CGMES update and you're right: we don't really need this method (or at least not in this form). Types are actually unique for one identifiable if they are not null in this use case (in the example, a switch can only have one alias associated with a \"terminal1\" type). I need to rethink how to do this.", "author": "miovd", "createdAt": "2020-08-20T09:07:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDk2NzkzOA=="}], "type": "inlineReview"}, {"oid": "e3d2452c8204ea788b38272bf6751a7386bc98c7", "url": "https://github.com/powsybl/powsybl-core/commit/e3d2452c8204ea788b38272bf6751a7386bc98c7", "message": "Add the possibility to associate a type to an alias (indicating what it corresponds to)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:09Z", "type": "commit"}, {"oid": "9223f01ebf9800b35be2e6fd30ef17cd42ed66c9", "url": "https://github.com/powsybl/powsybl-core/commit/9223f01ebf9800b35be2e6fd30ef17cd42ed66c9", "message": "Throw an exception if trying to retrieve the type of a non existent alias\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:09Z", "type": "commit"}, {"oid": "628175257acb321bae360a18b29d0b860da7ad56", "url": "https://github.com/powsybl/powsybl-core/commit/628175257acb321bae360a18b29d0b860da7ad56", "message": "Add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:09Z", "type": "commit"}, {"oid": "be0cddfe1f533a6a7623b970b9deae1e3e7464fa", "url": "https://github.com/powsybl/powsybl-core/commit/be0cddfe1f533a6a7623b970b9deae1e3e7464fa", "message": "Update XIIDM serialization\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "commit"}, {"oid": "de4a342ec7635a757c2ab0dea818a78159c6c336", "url": "https://github.com/powsybl/powsybl-core/commit/de4a342ec7635a757c2ab0dea818a78159c6c336", "message": "Update tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "commit"}, {"oid": "c642f747cdaac6169d4f076f094fc0658dae3528", "url": "https://github.com/powsybl/powsybl-core/commit/c642f747cdaac6169d4f076f094fc0658dae3528", "message": "Correction getAliases by type\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "commit"}, {"oid": "0e3c0772181332980c3741a9a92e172debbdfdd8", "url": "https://github.com/powsybl/powsybl-core/commit/0e3c0772181332980c3741a9a92e172debbdfdd8", "message": "Add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "commit"}, {"oid": "79ea484f3d9632149475b0ba970f597227b74769", "url": "https://github.com/powsybl/powsybl-core/commit/79ea484f3d9632149475b0ba970f597227b74769", "message": "Serialization is now in XIIDM 1.4\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "commit"}, {"oid": "14c9ba0b39c1a4abe3705e5849596cbf5e34e639", "url": "https://github.com/powsybl/powsybl-core/commit/14c9ba0b39c1a4abe3705e5849596cbf5e34e639", "message": "Only using a map, not a set (reviewer's comment)\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "commit"}, {"oid": "80ec26db9c2842c273bf0ad130a0ec1de26887b9", "url": "https://github.com/powsybl/powsybl-core/commit/80ec26db9c2842c273bf0ad130a0ec1de26887b9", "message": "Change IIDM API for aliases\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "commit"}, {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "url": "https://github.com/powsybl/powsybl-core/commit/5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "message": "Implement for MergingView\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "commit"}, {"oid": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "url": "https://github.com/powsybl/powsybl-core/commit/5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "message": "Implement for MergingView\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-03T12:50:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyMjM2MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483022361", "bodyText": "-> alias", "author": "geofjamg", "createdAt": "2020-09-03T14:29:54Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.", "originalCommit": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDA5NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483024094", "bodyText": "Maybe just specify what should be the impl behaviour if an alias with the same type already exists or another alias with same value already exists? Exception?", "author": "geofjamg", "createdAt": "2020-09-03T14:32:01Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.\n+     */\n+    default Optional<String> getAliasFromType(String aliasType) {\n+        return Optional.empty();\n+    }\n+\n+    /**\n+     * Get the alias type of an alias if it exists, an empty optional otherwise.\n+     */\n+    default Optional<String> getAliasType(String alias) {\n+        return Optional.empty();\n+    }\n+\n     /**\n      * Add an alias to the object. Aliases must be unique in associated Network, and different\n-     * from any identifiable ID.\n+     * from any identifiable ID. No alias type is associated to this alias.\n      */\n     default void addAlias(String alias) {\n     }\n \n+    /**\n+     * Add an alias to the object. Aliases must be unique in associated Network, and different", "originalCommit": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNzI0Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483027242", "bodyText": "Also you can specify that aliasType with a null value is supported and means no alias", "author": "geofjamg", "createdAt": "2020-09-03T14:35:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDA5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAyNDUzNQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483024535", "bodyText": "Maybe just specify what should be the impl behaviour if another alias with same value already exists or an IIDM is? Exception?", "author": "geofjamg", "createdAt": "2020-09-03T14:32:36Z", "path": "iidm/iidm-api/src/main/java/com/powsybl/iidm/network/Identifiable.java", "diffHunk": "@@ -45,13 +45,34 @@ default String getName() {\n         return Collections.emptySet();\n     }\n \n+    /**\n+     * Get the aliases of the object with a given alias type.\n+     */\n+    default Optional<String> getAliasFromType(String aliasType) {\n+        return Optional.empty();\n+    }\n+\n+    /**\n+     * Get the alias type of an alias if it exists, an empty optional otherwise.\n+     */\n+    default Optional<String> getAliasType(String alias) {\n+        return Optional.empty();\n+    }\n+\n     /**\n      * Add an alias to the object. Aliases must be unique in associated Network, and different\n-     * from any identifiable ID.\n+     * from any identifiable ID. No alias type is associated to this alias.", "originalCommit": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAzNTc0Ng==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483035746", "bodyText": "Just a thought but it is very dangerous to have only for shunt kind of duplication of alias management. It is because of model sub element?", "author": "geofjamg", "createdAt": "2020-09-03T14:46:31Z", "path": "iidm/iidm-xml-converter/src/main/java/com/powsybl/iidm/xml/ShuntXml.java", "diffHunk": "@@ -149,8 +147,9 @@ protected void readElement(String id, ShuntCompensatorAdder adder, NetworkXmlRea\n                     break;\n                 case AliasesXml.ALIAS:\n                     IidmXmlUtil.assertMinimumVersion(ROOT_ELEMENT_NAME, AliasesXml.ALIAS, IidmXmlUtil.ErrorMessage.NOT_SUPPORTED, IidmXmlVersion.V_1_3, context);\n+                    String aliasType = context.getReader().getAttributeValue(null, \"type\");\n                     String alias = context.getAnonymizer().deanonymizeString(context.getReader().getElementText());\n-                    aliases.add(alias);\n+                    aliases.put(alias, aliasType);", "originalCommit": "5d1ed3de5a09602cfdbde72d6f7616502bf2386c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzU2OTI5NQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1402#discussion_r483569295", "bodyText": "Yes because shunts are the only equipment who needs its sub element to be created (other equipment can be created without their sub elements).", "author": "miovd", "createdAt": "2020-09-04T11:55:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzAzNTc0Ng=="}], "type": "inlineReview"}, {"oid": "d5fd4eab60603074c6641c89d59525926c23e3b0", "url": "https://github.com/powsybl/powsybl-core/commit/d5fd4eab60603074c6641c89d59525926c23e3b0", "message": "Complete the javadoc\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-09-04T14:58:36Z", "type": "commit"}]}