{"pr_number": 1360, "pr_title": "Current limits with missing permanent limit are not ignored anymore in CGMES import but fixed with permanent limit equal to lowest TATL", "pr_createdAt": "2020-06-19T14:29:18Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1360", "timeline": [{"oid": "3672af0ac5b25057df97f5c87ac753ff2715cbd9", "url": "https://github.com/powsybl/powsybl-core/commit/3672af0ac5b25057df97f5c87ac753ff2715cbd9", "message": "Current limits with mising permanent limit are not ignored anymore in CGMES import but fixed with infinite permanent limit\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-19T14:28:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM2MjkxMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1360#discussion_r443362912", "bodyText": "The PATL seems to be mandatory in CGMES for all transformers and at both ends for a AC line. So I am not sure that it is safe just to replace them by infinite values. What do you think ?", "author": "annetill", "createdAt": "2020-06-22T07:23:36Z", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/CurrentLimitsMapping.java", "diffHunk": "@@ -32,10 +32,12 @@ public CurrentLimitsAdder getCurrentLimitsAdder(String id, Supplier<CurrentLimit\n     void addAll() {\n         for (Map.Entry<String, CurrentLimitsAdder> entry : adders.entrySet()) {\n             if (Double.isNaN(entry.getValue().getPermanentLimit())) {\n-                context.ignored(\"Operational Limit Set of \" + entry.getKey(), \"An operational limit set must at least contain one value for permanent limit.\");\n-            } else {\n-                entry.getValue().add();\n+                context.fixed(\"Operational Limit Set of \" + entry.getKey(),", "originalCommit": "3672af0ac5b25057df97f5c87ac753ff2715cbd9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM3MDc1Ng==", "url": "https://github.com/powsybl/powsybl-core/pull/1360#discussion_r443370756", "bodyText": "In theory, this is true, but it seems that in French networks, current TATL are assigned without PATL...", "author": "miovd", "createdAt": "2020-06-22T07:39:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM2MjkxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM3MTUxOQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1360#discussion_r443371519", "bodyText": "We can take the highest value of TATL as PATL though? It may be more correct that putting an infinite PATL", "author": "miovd", "createdAt": "2020-06-22T07:41:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM2MjkxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM3NTk4Mw==", "url": "https://github.com/powsybl/powsybl-core/pull/1360#discussion_r443375983", "bodyText": "No, I was more thinking about a warning.", "author": "annetill", "createdAt": "2020-06-22T07:50:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM2MjkxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2MzA3OA==", "url": "https://github.com/powsybl/powsybl-core/pull/1360#discussion_r443463078", "bodyText": "Are you sure this is a good workaround, specially if the CurrentLimits has TATL: The PATL has to be lesser or equal to the minimal TATL. Putting MAX_VALUE whould lead to never have violations on that equipment. From my point of view, if there are no TATL, we should not add a CurrentLimit for this object, and if there are TATL, we should pick the lowest one.", "author": "mathbagu", "createdAt": "2020-06-22T10:26:35Z", "path": "cgmes/cgmes-conversion/src/main/java/com/powsybl/cgmes/conversion/CurrentLimitsMapping.java", "diffHunk": "@@ -32,10 +32,12 @@ public CurrentLimitsAdder getCurrentLimitsAdder(String id, Supplier<CurrentLimit\n     void addAll() {\n         for (Map.Entry<String, CurrentLimitsAdder> entry : adders.entrySet()) {\n             if (Double.isNaN(entry.getValue().getPermanentLimit())) {\n-                context.ignored(\"Operational Limit Set of \" + entry.getKey(), \"An operational limit set must at least contain one value for permanent limit.\");\n-            } else {\n-                entry.getValue().add();\n+                context.fixed(\"Operational Limit Set of \" + entry.getKey(),\n+                        \"An operational limit set without permanent limit is considered with infinite limit.\",\n+                        Double.NaN, Double.MAX_VALUE);\n+                entry.getValue().setPermanentLimit(Double.MAX_VALUE);", "originalCommit": "3672af0ac5b25057df97f5c87ac753ff2715cbd9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ4ODc3Mg==", "url": "https://github.com/powsybl/powsybl-core/pull/1360#discussion_r443488772", "bodyText": "The PATL has to be lesser or equal to the minimal TATL\n\nYes, I was wondering that as well... For most current limits in the French networks, the PATL seems to be equals to the minimal TATL. Maybe we should do that? But I'm not sure about putting an arbitrary value, I would prefer to put an undefined/infinite value (even if it has no electrical sense).", "author": "miovd", "createdAt": "2020-06-22T11:19:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2MzA3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzYzNzY4MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1360#discussion_r443637681", "bodyText": "This is the definition of PATL and TATL, but maybe it's not strictly respected. Honestly, instead of setting an infinite value, don't create a currentLimits: the behavior would be the same, and you don't create non sense data :)", "author": "mathbagu", "createdAt": "2020-06-22T15:19:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2MzA3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA5NDgyMQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1360#discussion_r444094821", "bodyText": "I modified to take the lowest available TATL when no PATL is defined (when there is no TATL and no PATL, no current limit is created). Is it okay for you?", "author": "miovd", "createdAt": "2020-06-23T09:37:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ2MzA3OA=="}], "type": "inlineReview"}, {"oid": "f72fb9d2bac8b40f1b64ddb05bfccbe00313a3b9", "url": "https://github.com/powsybl/powsybl-core/commit/f72fb9d2bac8b40f1b64ddb05bfccbe00313a3b9", "message": "Taking review into account: default PATL is not infinite but the lowest TATL available\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-23T09:35:42Z", "type": "commit"}, {"oid": "353605de4044b221c8d3fa1f4d38868101681c1b", "url": "https://github.com/powsybl/powsybl-core/commit/353605de4044b221c8d3fa1f4d38868101681c1b", "message": "Correction\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-23T14:27:05Z", "type": "commit"}, {"oid": "845c6de922cb4a383c2e2d1a21694ae1becdfa8b", "url": "https://github.com/powsybl/powsybl-core/commit/845c6de922cb4a383c2e2d1a21694ae1becdfa8b", "message": "Add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-23T14:43:59Z", "type": "commit"}, {"oid": "845c6de922cb4a383c2e2d1a21694ae1becdfa8b", "url": "https://github.com/powsybl/powsybl-core/commit/845c6de922cb4a383c2e2d1a21694ae1becdfa8b", "message": "Add test\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-06-23T14:43:59Z", "type": "forcePushed"}, {"oid": "0a7fa5248c45bb97372a43514dff90305dcce8d8", "url": "https://github.com/powsybl/powsybl-core/commit/0a7fa5248c45bb97372a43514dff90305dcce8d8", "message": "Merge branch 'master' into cgmes_permanent_current_limits_missing", "committedDate": "2020-06-23T14:48:28Z", "type": "commit"}]}