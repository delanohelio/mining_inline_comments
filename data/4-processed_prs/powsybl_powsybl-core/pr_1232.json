{"pr_number": 1232, "pr_title": "Create convenient methods to run through connectables from network", "pr_createdAt": "2020-03-18T16:54:56Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1232", "timeline": [{"oid": "7e9d513fbcee2d1f7dae0bfbfabbb1895c75a85f", "url": "https://github.com/powsybl/powsybl-core/commit/7e9d513fbcee2d1f7dae0bfbfabbb1895c75a85f", "message": "add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-19T15:27:43Z", "type": "forcePushed"}, {"oid": "a86d3aa5220991b5e4f6ba889467d3317bd06f0b", "url": "https://github.com/powsybl/powsybl-core/commit/a86d3aa5220991b5e4f6ba889467d3317bd06f0b", "message": "Add convenient getConnectables and associated methods in Network\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\ncorrections\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>\n\nwhite spaces\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-20T15:17:34Z", "type": "commit"}, {"oid": "e20842b767298b4a87c58fe0ebb9abdb86731316", "url": "https://github.com/powsybl/powsybl-core/commit/e20842b767298b4a87c58fe0ebb9abdb86731316", "message": "add tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-20T15:17:35Z", "type": "commit"}, {"oid": "61ce12768df37c8dbd63370a09f77b02a20de3d4", "url": "https://github.com/powsybl/powsybl-core/commit/61ce12768df37c8dbd63370a09f77b02a20de3d4", "message": "Modify use of new method when needed\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-20T15:17:35Z", "type": "commit"}, {"oid": "61ce12768df37c8dbd63370a09f77b02a20de3d4", "url": "https://github.com/powsybl/powsybl-core/commit/61ce12768df37c8dbd63370a09f77b02a20de3d4", "message": "Modify use of new method when needed\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-20T15:17:35Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDgyMg==", "url": "https://github.com/powsybl/powsybl-core/pull/1232#discussion_r396344822", "bodyText": "Why calling getLines() or getDanglingLines() is not sufficient there?", "author": "mathbagu", "createdAt": "2020-03-23T10:22:05Z", "path": "iidm/iidm-mergingview/src/main/java/com/powsybl/iidm/mergingview/MergingViewIndex.java", "diffHunk": "@@ -132,6 +132,29 @@ Identifiable getIdentifiable(final Identifiable identifiable) {\n         return getIdentifiableStream().collect(Collectors.toList());\n     }\n \n+    /** @return all Adapters according to all Connectables of a given type */\n+    <C extends Connectable> Collection<C> getConnectables(Class<C> clazz) {\n+        // Search Connectables of a given type into merging & working networks\n+        if (clazz.isAssignableFrom(Line.class)) {\n+            return getLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());\n+        } else if (clazz.isAssignableFrom(DanglingLine.class)) {\n+            return getDanglingLines().stream().filter(clazz::isInstance).map(clazz::cast).collect(Collectors.toList());", "originalCommit": "61ce12768df37c8dbd63370a09f77b02a20de3d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUwMDQ5MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1232#discussion_r396500491", "bodyText": "We can not being sure that the returned stream will be of clazz instance. For example, if class is TieLine.class, TieLine.class is assignable from Line.class but the returned stream must still be filtered and cast to return only TieLines.", "author": "miovd", "createdAt": "2020-03-23T14:39:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDgyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk3NDQyNA==", "url": "https://github.com/powsybl/powsybl-core/pull/1232#discussion_r399974424", "bodyText": "Looking to the NetworkImpl, getLines() returns both Line and TieLine objects. The NetworkImpl::getConnectableStream(Line.class) return lines and tie lines:\n    @Override\n    public <C extends Connectable> Stream<C> getConnectableStream(Class<C> clazz) {\n        return index.getAll().stream().filter(clazz::isInstance).map(clazz::cast);\n    }\n\nIn case of the merging view, the getLine() should return lines, tie tiles and merged lines. I think the getLines() method is OK\nFor the danglingLines() method, it should return all the unmerged dangling lines. Once again, I think the getDanglingLines() method is OK\nLast remark, this TieLine.class.isAssignableFrom(Line.class) test returns false. So I still think you can simply call getLines() and getDanglingLines().", "author": "mathbagu", "createdAt": "2020-03-30T07:19:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDgyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDA2NDY0MA==", "url": "https://github.com/powsybl/powsybl-core/pull/1232#discussion_r400064640", "bodyText": "Last remark, this TieLine.class.isAssignableFrom(Line.class) test returns false. So I still think you can simply call getLines() and getDanglingLines().\n\nOkay, I corrected it in the last commit.\n\nIn case of the merging view, the getLine() should return lines, tie tiles and merged lines. I think the getLines() method is OK\nFor the danglingLines() method, it should return all the unmerged dangling lines. Once again, I think the getDanglingLines() method is OK\n\nI agree. However, when trying to retrieve a subclass of Line (in the example in the tests added in the last commit, MergedLine), it may be necessary to call getLines first and then filter and cast. What do you think?", "author": "miovd", "createdAt": "2020-03-30T09:52:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM0NDgyMg=="}], "type": "inlineReview"}, {"oid": "3780a20fca3919b0ce911ec9d0338519ae0345ce", "url": "https://github.com/powsybl/powsybl-core/commit/3780a20fca3919b0ce911ec9d0338519ae0345ce", "message": "Corrections + tests\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-03-30T09:49:37Z", "type": "commit"}, {"oid": "c718a58ff8252fd74b4e60c9c62d272350c593a2", "url": "https://github.com/powsybl/powsybl-core/commit/c718a58ff8252fd74b4e60c9c62d272350c593a2", "message": "corrections in mergingviewindex\n\nSigned-off-by: RALAMBOTIANA MIORA <miora.ralambotiana@rte-france.com>", "committedDate": "2020-04-03T09:01:28Z", "type": "commit"}, {"oid": "7b278fee1ad83f33e23161822af73c2639e7164d", "url": "https://github.com/powsybl/powsybl-core/commit/7b278fee1ad83f33e23161822af73c2639e7164d", "message": "Merge branch 'master' into add_getconnectables", "committedDate": "2020-04-06T17:36:53Z", "type": "commit"}]}