{"pr_number": 1270, "pr_title": "Issue 890 ucte power plant type management", "pr_createdAt": "2020-04-10T14:43:52Z", "pr_url": "https://github.com/powsybl/powsybl-core/pull/1270", "timeline": [{"oid": "0477ad7edb61c3908d26345fb86a667d1794a02f", "url": "https://github.com/powsybl/powsybl-core/commit/0477ad7edb61c3908d26345fb86a667d1794a02f", "message": "save ucte power plant type in properties\n\nSigned-off-by: J\u00e9r\u00e9my LABOUS <jlabous@silicom.fr>", "committedDate": "2020-03-19T13:13:43Z", "type": "commit"}, {"oid": "8a3b4f1c20002ebc483a51a78dfad0d6aca54d3f", "url": "https://github.com/powsybl/powsybl-core/commit/8a3b4f1c20002ebc483a51a78dfad0d6aca54d3f", "message": "Merge branch 'master' into issue_890_ucte_power_plant_type_management", "committedDate": "2020-04-10T13:36:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM0OTkyMQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1270#discussion_r408349921", "bodyText": "The simplest way to implement that, is to add a property to the generator whatever the type of the power plant. Add the property after the creation of the generator:\ngenerator.setProperty(UCTE_POWER_PLANT_TYPE, ucte.getPowerPlantType());", "author": "mathbagu", "createdAt": "2020-04-14T18:32:47Z", "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -181,8 +187,14 @@ private static void createGenerator(UcteNode ucteNode, VoltageLevel voltageLevel\n         if (ucteNode.getPowerPlantType() != null) {\n             switch (ucteNode.getPowerPlantType()) {\n                 case C:\n+                    voltageLevel.getNetwork().setProperty(UCTE_POWERPLANT_TYPE_KEY + generatorId, ucteNode.getPowerPlantType().toString());\n+                    break;\n                 case G:\n+                    voltageLevel.getNetwork().setProperty(UCTE_POWERPLANT_TYPE_KEY + generatorId, ucteNode.getPowerPlantType().toString());\n+                    break;\n                 case L:\n+                    voltageLevel.getNetwork().setProperty(UCTE_POWERPLANT_TYPE_KEY + generatorId, ucteNode.getPowerPlantType().toString());\n+                    break;", "originalCommit": "8a3b4f1c20002ebc483a51a78dfad0d6aca54d3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM1MDg4MQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1270#discussion_r408350881", "bodyText": "Change the signature of this method to pass the generator instead of these two values.\nLook for the property. If it's defined, use it. If the property is not defined, use the existing code without modifications.", "author": "mathbagu", "createdAt": "2020-04-14T18:34:15Z", "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteExporter.java", "diffHunk": "@@ -702,7 +702,7 @@ private static void setSwitchCurrentLimit(UcteLine ucteLine, Switch sw) {\n         }\n     }\n \n-    private static UctePowerPlantType energySourceToUctePowerPlantType(EnergySource energySource) {\n+    private static UctePowerPlantType energySourceToUctePowerPlantType(EnergySource energySource, String uctePowerPlantType) {", "originalCommit": "8a3b4f1c20002ebc483a51a78dfad0d6aca54d3f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ab51aec375661b61298f401e49d947cae8c734ac", "url": "https://github.com/powsybl/powsybl-core/commit/ab51aec375661b61298f401e49d947cae8c734ac", "message": "take remark in account\n\nSigned-off-by: J\u00e9r\u00e9my LABOUS <jlabous@silicom.fr>", "committedDate": "2020-04-27T09:04:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI1MTgyMw==", "url": "https://github.com/powsybl/powsybl-core/pull/1270#discussion_r419251823", "bodyText": "There is no good reason to make the property name dependent on the ID of the generator.", "author": "mathbagu", "createdAt": "2020-05-04T07:23:46Z", "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteExporter.java", "diffHunk": "@@ -702,8 +702,11 @@ private static void setSwitchCurrentLimit(UcteLine ucteLine, Switch sw) {\n         }\n     }\n \n-    private static UctePowerPlantType energySourceToUctePowerPlantType(EnergySource energySource) {\n-        switch (energySource) {\n+    private static UctePowerPlantType energySourceToUctePowerPlantType(Generator generator) {\n+        if (generator.hasProperty(UcteImporter.UCTE_POWERPLANT_TYPE_KEY + generator.getId())) {\n+            return UctePowerPlantType.valueOf(generator.getProperty(UcteImporter.UCTE_POWERPLANT_TYPE_KEY + generator.getId()));\n+        }", "originalCommit": "ab51aec375661b61298f401e49d947cae8c734ac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI1MjEzOQ==", "url": "https://github.com/powsybl/powsybl-core/pull/1270#discussion_r419252139", "bodyText": "This property should be declared with the others: as it's used in both importer and exporter, the right place is UcteConstants.", "author": "mathbagu", "createdAt": "2020-05-04T07:24:28Z", "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -45,6 +45,12 @@\n \n     private static final String[] EXTENSIONS = {\"uct\", \"UCT\"};\n \n+    /**\n+     * Key to store ucte power plant type in properties\n+     * Concat this key with generator id\n+     */\n+    public static final String UCTE_POWERPLANT_TYPE_KEY = \"UctePowerPlantType_\";", "originalCommit": "ab51aec375661b61298f401e49d947cae8c734ac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI1MjI1NA==", "url": "https://github.com/powsybl/powsybl-core/pull/1270#discussion_r419252254", "bodyText": "Look like a regression", "author": "mathbagu", "createdAt": "2020-05-04T07:24:43Z", "path": "ucte/ucte-converter/src/main/java/com/powsybl/ucte/converter/UcteImporter.java", "diffHunk": "@@ -181,8 +187,11 @@ private static void createGenerator(UcteNode ucteNode, VoltageLevel voltageLevel\n         if (ucteNode.getPowerPlantType() != null) {\n             switch (ucteNode.getPowerPlantType()) {\n                 case C:\n+                    break;\n                 case G:\n+                    break;\n                 case L:\n+                    break;", "originalCommit": "ab51aec375661b61298f401e49d947cae8c734ac", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c3e8838411f113ff8ad3fc1f7d4d6de4861f61db", "url": "https://github.com/powsybl/powsybl-core/commit/c3e8838411f113ff8ad3fc1f7d4d6de4861f61db", "message": "Fix the implementation\n\nSigned-off-by: Mathieu BAGUE <mathieu.bague@rte-france.com>", "committedDate": "2020-05-04T07:28:12Z", "type": "commit"}, {"oid": "93d17943c8d269bc7b61f667e0c7f6fb39c81935", "url": "https://github.com/powsybl/powsybl-core/commit/93d17943c8d269bc7b61f667e0c7f6fb39c81935", "message": "Merge branch 'master' into issue_890_ucte_power_plant_type_management", "committedDate": "2020-05-04T08:24:59Z", "type": "commit"}]}