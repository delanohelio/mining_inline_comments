{"pr_number": 3203, "pr_title": "Improve Redux traces data-flow code", "pr_createdAt": "2020-09-06T13:06:29Z", "pr_url": "https://github.com/openzipkin/zipkin/pull/3203", "timeline": [{"oid": "5c1c20262f70e8dd59a22b30cece42eafa9387f0", "url": "https://github.com/openzipkin/zipkin/commit/5c1c20262f70e8dd59a22b30cece42eafa9387f0", "message": "Add Span and AdjustedTrace model types", "committedDate": "2020-09-06T08:11:10Z", "type": "commit"}, {"oid": "4f89d53b3a0d631317a8d5f8cfdd70a4912044dc", "url": "https://github.com/openzipkin/zipkin/commit/4f89d53b3a0d631317a8d5f8cfdd70a4912044dc", "message": "Improve traces store management", "committedDate": "2020-09-06T12:55:44Z", "type": "commit"}, {"oid": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "url": "https://github.com/openzipkin/zipkin/commit/c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "message": "Remove unused files", "committedDate": "2020-09-06T12:59:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MDY1OQ==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484150659", "bodyText": "is there a way to say what it was loading? maybe if you pass state of the component you are trying to load, so that you can fallback to \"Error loading ${component}\"", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:12:15Z", "path": "zipkin-lens/src/components/common/LoadingOverlay.tsx", "diffHunk": "@@ -0,0 +1,70 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import {\n+  Backdrop,\n+  CircularProgress,\n+  Theme,\n+  createStyles,\n+  makeStyles,\n+} from '@material-ui/core';\n+import { SerializedError } from '@reduxjs/toolkit';\n+import React, { useEffect } from 'react';\n+import { useDispatch } from 'react-redux';\n+\n+import { setAlert } from '../App/slice';\n+\n+interface LoadingOverlayProps {\n+  isLoading: boolean;\n+  error?: SerializedError;\n+}\n+\n+const useStyles = makeStyles((theme: Theme) =>\n+  createStyles({\n+    backdrop: {\n+      zIndex: theme.zIndex.drawer + 1,\n+      color: '#fff',\n+    },\n+  }),\n+);\n+\n+const LoadingOverlay: React.FC<LoadingOverlayProps> = ({\n+  isLoading,\n+  error,\n+}) => {\n+  const classes = useStyles();\n+\n+  const dispatch = useDispatch();\n+\n+  useEffect(() => {\n+    if (error) {\n+      dispatch(\n+        setAlert({\n+          message: error.message || 'Error occurs when loading...',", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MDkxNw==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484150917", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              endpoint: string; // If not exist, this filed will be 'unknown'.\n          \n          \n            \n              endpoint: string; // Ex. 'fooo' or 'unknown' on null span.localEndpoint\n          \n      \n    \n    \n  \n\nwhere 'foo' is a real example", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:13:51Z", "path": "zipkin-lens/src/models/AdjustedTrace.ts", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { ServiceNameAndSpanCount } from './TraceSummary';\n+\n+export type AdjustedAnnotation = {\n+  value: string;\n+  timestamp: number;\n+  endpoint: string; // If not exist, this filed will be 'unknown'.", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MTA0MQ==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484151041", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              spanName: string; // If not exist, this field will be 'unknown'.\n          \n          \n            \n              spanName: string; // span.name or 'unknown' on null", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:14:36Z", "path": "zipkin-lens/src/models/AdjustedTrace.ts", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { ServiceNameAndSpanCount } from './TraceSummary';\n+\n+export type AdjustedAnnotation = {\n+  value: string;\n+  timestamp: number;\n+  endpoint: string; // If not exist, this filed will be 'unknown'.\n+  relativeTime?: string;\n+};\n+\n+export type AdjustedSpan = {\n+  spanId: string;\n+  spanName: string; // If not exist, this field will be 'unknown'.", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MTEwNw==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484151107", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              serviceName: string; // If not exist, this field will be 'unknown'.\n          \n          \n            \n              serviceName: string; // span.localEndpoint.serviceName or 'unknown' on null", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:14:55Z", "path": "zipkin-lens/src/models/AdjustedTrace.ts", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { ServiceNameAndSpanCount } from './TraceSummary';\n+\n+export type AdjustedAnnotation = {\n+  value: string;\n+  timestamp: number;\n+  endpoint: string; // If not exist, this filed will be 'unknown'.\n+  relativeTime?: string;\n+};\n+\n+export type AdjustedSpan = {\n+  spanId: string;\n+  spanName: string; // If not exist, this field will be 'unknown'.\n+  serviceName: string; // If not exist, this field will be 'unknown'.", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MTI3Mg==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484151272", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              rootSpan: {\n          \n          \n            \n              rootSpan: { // the root-most span, when the root is missing", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:15:37Z", "path": "zipkin-lens/src/models/AdjustedTrace.ts", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { ServiceNameAndSpanCount } from './TraceSummary';\n+\n+export type AdjustedAnnotation = {\n+  value: string;\n+  timestamp: number;\n+  endpoint: string; // If not exist, this filed will be 'unknown'.\n+  relativeTime?: string;\n+};\n+\n+export type AdjustedSpan = {\n+  spanId: string;\n+  spanName: string; // If not exist, this field will be 'unknown'.\n+  serviceName: string; // If not exist, this field will be 'unknown'.\n+  parentId?: string;\n+  childIds: string[];\n+  serviceNames: string[];\n+  timestamp: number;\n+  duration: number;\n+  durationStr: string;\n+  tags: {\n+    key: string;\n+    value: string;\n+  }[];\n+  annotations: AdjustedAnnotation[];\n+  errorType: string;\n+  depth: number;\n+  width: number;\n+  left: number;\n+};\n+\n+type AdjustedTrace = {\n+  traceId: string;\n+  serviceNameAndSpanCounts: ServiceNameAndSpanCount[];\n+  duration: number;\n+  durationStr: string;\n+  rootSpan: {", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MTMyNQ==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484151325", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                spanName: string; // If not exist, this field will be 'unknown'.\n          \n          \n            \n                spanName: string; // span.name or 'unknown' on null", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:15:56Z", "path": "zipkin-lens/src/models/AdjustedTrace.ts", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { ServiceNameAndSpanCount } from './TraceSummary';\n+\n+export type AdjustedAnnotation = {\n+  value: string;\n+  timestamp: number;\n+  endpoint: string; // If not exist, this filed will be 'unknown'.\n+  relativeTime?: string;\n+};\n+\n+export type AdjustedSpan = {\n+  spanId: string;\n+  spanName: string; // If not exist, this field will be 'unknown'.\n+  serviceName: string; // If not exist, this field will be 'unknown'.\n+  parentId?: string;\n+  childIds: string[];\n+  serviceNames: string[];\n+  timestamp: number;\n+  duration: number;\n+  durationStr: string;\n+  tags: {\n+    key: string;\n+    value: string;\n+  }[];\n+  annotations: AdjustedAnnotation[];\n+  errorType: string;\n+  depth: number;\n+  width: number;\n+  left: number;\n+};\n+\n+type AdjustedTrace = {\n+  traceId: string;\n+  serviceNameAndSpanCounts: ServiceNameAndSpanCount[];\n+  duration: number;\n+  durationStr: string;\n+  rootSpan: {\n+    serviceName: string; // If not exist, this field will be 'unknown'.\n+    spanName: string; // If not exist, this field will be 'unknown'.", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MTM0Ng==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484151346", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                serviceName: string; // If not exist, this field will be 'unknown'.\n          \n          \n            \n                serviceName: string; // span.localEndpoint.serviceName or 'unknown' on null", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:16:03Z", "path": "zipkin-lens/src/models/AdjustedTrace.ts", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import { ServiceNameAndSpanCount } from './TraceSummary';\n+\n+export type AdjustedAnnotation = {\n+  value: string;\n+  timestamp: number;\n+  endpoint: string; // If not exist, this filed will be 'unknown'.\n+  relativeTime?: string;\n+};\n+\n+export type AdjustedSpan = {\n+  spanId: string;\n+  spanName: string; // If not exist, this field will be 'unknown'.\n+  serviceName: string; // If not exist, this field will be 'unknown'.\n+  parentId?: string;\n+  childIds: string[];\n+  serviceNames: string[];\n+  timestamp: number;\n+  duration: number;\n+  durationStr: string;\n+  tags: {\n+    key: string;\n+    value: string;\n+  }[];\n+  annotations: AdjustedAnnotation[];\n+  errorType: string;\n+  depth: number;\n+  width: number;\n+  left: number;\n+};\n+\n+type AdjustedTrace = {\n+  traceId: string;\n+  serviceNameAndSpanCounts: ServiceNameAndSpanCount[];\n+  duration: number;\n+  durationStr: string;\n+  rootSpan: {\n+    serviceName: string; // If not exist, this field will be 'unknown'.", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MTcyNA==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484151724", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            type Endpoint = {\n          \n          \n            \n            // Same type as Endpoint in the OpenApi/Swagger model https://zipkin.io/zipkin-api/#\n          \n          \n            \n            type Endpoint = {", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:18:10Z", "path": "zipkin-lens/src/models/Endpoint.ts", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+type Endpoint = {", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MTgyNg==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484151826", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            type Span = {\n          \n          \n            \n            // Same type as Span in the OpenApi/Swagger model https://zipkin.io/zipkin-api/#\n          \n          \n            \n            type Span = {", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:18:39Z", "path": "zipkin-lens/src/models/Span.ts", "diffHunk": "@@ -12,15 +12,23 @@\n  * the License.\n  */\n \n-export const TRACE_LOAD_REQUEST = 'TRACE_LOAD_REQUEST';\n-export const TRACE_LOAD_SUCCESS = 'TRACE_LOAD_SUCCESS';\n-export const TRACE_LOAD_FAILURE = 'TRACE_LOAD_FAILURE';\n+import Annotation from './Annotation';\n+import Endpoint from './Endpoint';\n \n-export const TRACES_LOAD_REQUEST = 'TRACES_LOAD_REQUEST';\n-export const TRACES_LOAD_SUCCESS = 'TRACES_LOAD_SUCCESS';\n-export const TRACES_LOAD_FAILURE = 'TRACES_LOAD_FAILURE';\n-export const CLEAR_TRACES = 'TRACES_RESET';\n+type Span = {", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MjExMQ==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484152111", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                [key: string]: {\n          \n          \n            \n                [key: string]: { // key is the traceId", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:20:00Z", "path": "zipkin-lens/src/slices/tracesSlice.ts", "diffHunk": "@@ -0,0 +1,239 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+/* eslint-disable no-param-reassign */\n+\n+import {\n+  SerializedError,\n+  createAsyncThunk,\n+  createSlice,\n+} from '@reduxjs/toolkit';\n+\n+import * as api from '../constants/api';\n+import AdjustedTrace from '../models/AdjustedTrace';\n+import Span from '../models/Span';\n+import TraceSummary from '../models/TraceSummary';\n+import { ensureV2TraceData } from '../util/trace';\n+\n+const {\n+  treeCorrectedForClockSkew,\n+  traceSummary: buildTraceSummary,\n+  traceSummaries: buildTraceSummaries,\n+  detailedTraceSummary: buildDetailedTraceSummary,\n+} = require('../zipkin');\n+\n+export const searchTraces = createAsyncThunk(\n+  'traces/search',\n+  async (params: { [key: string]: string }) => {\n+    const ps = new URLSearchParams(params);\n+    const resp = await fetch(`${api.TRACES}?${ps}`);\n+    if (!resp.ok) {\n+      throw Error(resp.statusText);\n+    }\n+    const rawTraces = (await resp.json()) as Span[][];\n+    const traces = rawTraces.reduce(\n+      (acc, rawTrace) => {\n+        const [{ traceId }] = rawTrace;\n+        const skewCorrectedTrace = treeCorrectedForClockSkew(rawTrace);\n+        acc[traceId] = {\n+          rawTrace,\n+          skewCorrectedTrace,\n+        };\n+        return acc;\n+      },\n+      {} as {\n+        [key: string]: {\n+          rawTrace: Span[];\n+          skewCorrectedTrace: any;\n+        };\n+      },\n+    );\n+\n+    const traceSummaries = buildTraceSummaries(\n+      ps.get('serviceName'),\n+      Object.keys(traces).map((traceId) =>\n+        buildTraceSummary(traces[traceId].skewCorrectedTrace),\n+      ),\n+    );\n+\n+    return {\n+      traces,\n+      traceSummaries,\n+    };\n+  },\n+);\n+\n+export const loadTrace = createAsyncThunk(\n+  'traces/load',\n+  async (traceId: string, thunkApi) => {\n+    const { traces }: TracesState = (thunkApi.getState() as any).traces;\n+\n+    if (traces[traceId]) {\n+      const { rawTrace, skewCorrectedTrace } = traces[traceId];\n+      let { adjustedTrace } = traces[traceId];\n+      if (adjustedTrace) {\n+        return {\n+          traceId,\n+          trace: traces[traceId],\n+        };\n+      }\n+      adjustedTrace = buildDetailedTraceSummary(skewCorrectedTrace);\n+      return {\n+        traceId,\n+        trace: {\n+          rawTrace,\n+          skewCorrectedTrace,\n+          adjustedTrace,\n+        },\n+      };\n+    }\n+\n+    const resp = await fetch(`${api.TRACE}/${traceId}`);\n+    if (!resp.ok) {\n+      throw Error(resp.statusText);\n+    }\n+    const rawTrace: Span[] = await resp.json();\n+    const skewCorrectedTrace = treeCorrectedForClockSkew(rawTrace);\n+    const adjustedTrace: AdjustedTrace = buildDetailedTraceSummary(\n+      skewCorrectedTrace,\n+    );\n+    return {\n+      traceId,\n+      trace: {\n+        rawTrace,\n+        skewCorrectedTrace,\n+        adjustedTrace,\n+      },\n+    };\n+  },\n+);\n+\n+const readFileAsync = (blob: Blob) => {\n+  return new Promise<any>((resolve, reject) => {\n+    const reader = new FileReader();\n+    reader.onload = () => {\n+      resolve(reader.result);\n+    };\n+    reader.onerror = () => {\n+      reject(reader.error);\n+    };\n+    reader.readAsText(blob);\n+  });\n+};\n+\n+export const loadJsonTrace = createAsyncThunk(\n+  'traces/loadJson',\n+  async (blob: Blob) => {\n+    const rawTraceStr = await readFileAsync(blob);\n+    const rawTrace: Span[] = JSON.parse(rawTraceStr);\n+    ensureV2TraceData(rawTrace);\n+    const [{ traceId }] = rawTrace;\n+    const skewCorrectedTrace = treeCorrectedForClockSkew(rawTrace);\n+    const adjustedTrace: AdjustedTrace = buildDetailedTraceSummary(\n+      skewCorrectedTrace,\n+    );\n+    return {\n+      traceId,\n+      trace: {\n+        rawTrace,\n+        skewCorrectedTrace,\n+        adjustedTrace,\n+      },\n+    };\n+  },\n+);\n+\n+export interface TracesState {\n+  isLoading: boolean;\n+  error?: SerializedError;\n+  traces: {\n+    [key: string]: {", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MjI1Mw==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484152253", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            type Annotation = {\n          \n          \n            \n            // Same type as Annotation in the OpenApi/Swagger model https://zipkin.io/zipkin-api/#\n          \n          \n            \n            type Annotation = {", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:20:40Z", "path": "zipkin-lens/src/models/Annotation.ts", "diffHunk": "@@ -11,14 +11,10 @@\n  * or implied. See the License for the specific language governing permissions and limitations under\n  * the License.\n  */\n-import * as types from '../constants/action-types';\n \n-export const loadTrace = (trace) => ({\n-  type: types.TRACE_VIEWER__LOAD_TRACE,\n-  trace,\n-});\n+type Annotation = {", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDE1MjgyMA==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r484152820", "bodyText": "I see this logic twice in this file. do we need that? I don't really know if we should have earlier accepted the remote Endpoint servicename for the root span but I suppose it isn't terrible either.", "author": "codefromthecrypt", "createdAt": "2020-09-07T02:23:25Z", "path": "zipkin-lens/src/zipkin/trace.js", "diffHunk": "@@ -369,17 +367,15 @@ export function detailedTraceSummary(root) {\n     modelview.spans.push(spanRow);\n   }\n \n-  if (modelview.spans.length >= 0) {\n-    modelview.rootSpan = {\n-      serviceName: modelview.spans[0].serviceName || 'unknown',\n-      spanName: modelview.spans[0].spanName || 'unknown',\n-    };\n-  } else {\n-    modelview.rootSpan = {\n-      serviceName: 'unknown',\n-      spanName: 'unknown',\n-    };\n-  }\n+  modelview.rootSpan = {};\n+  // If the first element does not exist, Error will be thrown.\n+  // So we don't have to check rootSpan existence.\n+  const [rootSpan] = root.queueRootMostSpans();\n+  modelview.rootSpan.serviceName =", "originalCommit": "c7c22e5ba1379cd81bb1ef9593586e2f209f40af", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cc56f7cabc4f0118d33264c6dd1b82d0b2e3f6f3", "url": "https://github.com/openzipkin/zipkin/commit/cc56f7cabc4f0118d33264c6dd1b82d0b2e3f6f3", "message": "Update zipkin-lens/src/models/AdjustedTrace.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:33:35Z", "type": "commit"}, {"oid": "afb9ea4a3fd506f8bf5956697a03ff0abaadfac9", "url": "https://github.com/openzipkin/zipkin/commit/afb9ea4a3fd506f8bf5956697a03ff0abaadfac9", "message": "Update zipkin-lens/src/models/AdjustedTrace.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:33:49Z", "type": "commit"}, {"oid": "6d3307c6635a6f6c7335a821fc4c868640c0c841", "url": "https://github.com/openzipkin/zipkin/commit/6d3307c6635a6f6c7335a821fc4c868640c0c841", "message": "Update zipkin-lens/src/models/AdjustedTrace.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:34:02Z", "type": "commit"}, {"oid": "01b92920bd61c58a7bbb63502314a5e2ba5046e9", "url": "https://github.com/openzipkin/zipkin/commit/01b92920bd61c58a7bbb63502314a5e2ba5046e9", "message": "Update zipkin-lens/src/models/AdjustedTrace.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:34:19Z", "type": "commit"}, {"oid": "e0f9a33bfd50a17ff4fb33b38ee1e568e71ab246", "url": "https://github.com/openzipkin/zipkin/commit/e0f9a33bfd50a17ff4fb33b38ee1e568e71ab246", "message": "Update zipkin-lens/src/models/AdjustedTrace.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:34:32Z", "type": "commit"}, {"oid": "9bb8936d815524a6aad2e79e06659770634b489c", "url": "https://github.com/openzipkin/zipkin/commit/9bb8936d815524a6aad2e79e06659770634b489c", "message": "Update zipkin-lens/src/models/AdjustedTrace.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:34:44Z", "type": "commit"}, {"oid": "2f279a06056407389c0b3042b892767a79f10944", "url": "https://github.com/openzipkin/zipkin/commit/2f279a06056407389c0b3042b892767a79f10944", "message": "Update zipkin-lens/src/models/Endpoint.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:34:57Z", "type": "commit"}, {"oid": "8cab2c9a6ccdd8da143ac8c435e63bbeb900fae7", "url": "https://github.com/openzipkin/zipkin/commit/8cab2c9a6ccdd8da143ac8c435e63bbeb900fae7", "message": "Update zipkin-lens/src/models/Span.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:35:08Z", "type": "commit"}, {"oid": "5422d1b6dce3fe13f167ee58b3c1189cd6a744d3", "url": "https://github.com/openzipkin/zipkin/commit/5422d1b6dce3fe13f167ee58b3c1189cd6a744d3", "message": "Update zipkin-lens/src/slices/tracesSlice.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:35:17Z", "type": "commit"}, {"oid": "f77cac3aaa37a8846bb812a6b26ac83dbb0b159a", "url": "https://github.com/openzipkin/zipkin/commit/f77cac3aaa37a8846bb812a6b26ac83dbb0b159a", "message": "Update zipkin-lens/src/models/Annotation.ts\n\nCo-authored-by: Adrian Cole <adriancole@users.noreply.github.com>", "committedDate": "2020-09-07T10:35:29Z", "type": "commit"}, {"oid": "81b7026e9d00a0ff0910a0ebb1cb1129ce5cf012", "url": "https://github.com/openzipkin/zipkin/commit/81b7026e9d00a0ff0910a0ebb1cb1129ce5cf012", "message": "Update traces state management", "committedDate": "2020-09-14T22:57:15Z", "type": "commit"}, {"oid": "34e5d84c2a73de7757a7dccc4145edbb5c36ac96", "url": "https://github.com/openzipkin/zipkin/commit/34e5d84c2a73de7757a7dccc4145edbb5c36ac96", "message": "(package) Add react-spinners", "committedDate": "2020-09-14T22:57:26Z", "type": "commit"}, {"oid": "90f23ba3191803ef5cd403950d7cab9d39ff28b1", "url": "https://github.com/openzipkin/zipkin/commit/90f23ba3191803ef5cd403950d7cab9d39ff28b1", "message": "Fix bug", "committedDate": "2020-09-14T22:57:26Z", "type": "commit"}, {"oid": "9dc2aa0da158f83fcdf75094c62cb8bd53a962cd", "url": "https://github.com/openzipkin/zipkin/commit/9dc2aa0da158f83fcdf75094c62cb8bd53a962cd", "message": "Update loading indicator design", "committedDate": "2020-09-14T22:57:26Z", "type": "commit"}, {"oid": "48e5ba16deef3b994a5cbe2a8723778c09c4e8e9", "url": "https://github.com/openzipkin/zipkin/commit/48e5ba16deef3b994a5cbe2a8723778c09c4e8e9", "message": "Avoid uUnnecessary search", "committedDate": "2020-09-14T22:57:26Z", "type": "commit"}, {"oid": "48e5ba16deef3b994a5cbe2a8723778c09c4e8e9", "url": "https://github.com/openzipkin/zipkin/commit/48e5ba16deef3b994a5cbe2a8723778c09c4e8e9", "message": "Avoid uUnnecessary search", "committedDate": "2020-09-14T22:57:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM3OTA5OQ==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r488379099", "bodyText": "curious. what is being shadowed.. comment worthy? or is this temporary...", "author": "codefromthecrypt", "createdAt": "2020-09-15T04:41:14Z", "path": "zipkin-lens/src/components/TracePage/TracePage.jsx", "diffHunk": "@@ -11,98 +11,50 @@\n  * or implied. See the License for the specific language governing permissions and limitations under\n  * the License.\n  */\n+\n+/* eslint-disable no-shadow */", "originalCommit": "48e5ba16deef3b994a5cbe2a8723778c09c4e8e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU0MDgyMQ==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r488540821", "bodyText": "loadTrace is shadowed..\nBut this shadow can be avoided.. I'll do so.", "author": "tacigar", "createdAt": "2020-09-15T09:56:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM3OTA5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM3OTYyMw==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r488379623", "bodyText": "mental note: we should revisit this naming", "author": "codefromthecrypt", "createdAt": "2020-09-15T04:43:09Z", "path": "zipkin-lens/src/slices/tracesSlice.ts", "diffHunk": "@@ -0,0 +1,292 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+/* eslint-disable no-param-reassign */\n+\n+import {\n+  SerializedError,\n+  createAsyncThunk,\n+  createSlice,\n+} from '@reduxjs/toolkit';\n+\n+import * as api from '../constants/api';\n+import AdjustedTrace from '../models/AdjustedTrace';\n+import Span from '../models/Span';\n+import TraceSummary from '../models/TraceSummary';\n+import { ensureV2TraceData } from '../util/trace';\n+\n+const {\n+  treeCorrectedForClockSkew,\n+  traceSummary: buildTraceSummary,\n+  traceSummaries: buildTraceSummaries,\n+  detailedTraceSummary: buildDetailedTraceSummary,\n+} = require('../zipkin');\n+\n+export const searchTraces = createAsyncThunk(\n+  'traces/search',\n+  async (params: { [key: string]: string }, thunkApi) => {\n+    const ps = new URLSearchParams(params);\n+\n+    // We need to import RootState in order to give the type to getState.\n+    // Importing RootState will result in a cyclic import.\n+    // So use any type to avoid this.\n+    const { search, traces }: TracesState = (thunkApi.getState() as any).traces;\n+    // If the query is the same as the previous query, it will not fetch again.\n+    if (search.prevQuery === ps.toString()) {\n+      return {\n+        traces,\n+        traceSummaries: search.traceSummaries,\n+        query: ps.toString(),\n+      };\n+    }\n+\n+    const resp = await fetch(`${api.TRACES}?${ps.toString()}`);\n+    if (!resp.ok) {\n+      throw Error(resp.statusText);\n+    }\n+    const rawTraces: Span[][] = await resp.json();\n+\n+    const newTraces = rawTraces.reduce(\n+      (acc, rawTrace) => {\n+        const [{ traceId }] = rawTrace;\n+        const skewCorrectedTrace = treeCorrectedForClockSkew(rawTrace);\n+        acc[traceId] = {\n+          rawTrace,\n+          skewCorrectedTrace,\n+        };\n+        return acc;\n+      },\n+      {} as {\n+        [key: string]: {\n+          rawTrace: Span[];\n+          skewCorrectedTrace: any;\n+        };\n+      },\n+    );\n+\n+    const traceSummaries: TraceSummary[] = buildTraceSummaries(\n+      ps.get('serviceName'),\n+      Object.keys(newTraces).map((traceId) =>\n+        buildTraceSummary(newTraces[traceId].skewCorrectedTrace),\n+      ),\n+    );\n+\n+    return {\n+      traces: newTraces,\n+      traceSummaries,\n+      query: ps.toString(),\n+    };\n+  },\n+);\n+\n+export const loadTrace = createAsyncThunk(\n+  'traces/load',\n+  async (traceId: string, thunkApi) => {\n+    // We need to import RootState in order to give the type to getState.\n+    // Importing RootState will result in a cyclic import.\n+    // So use any type to avoid this.\n+    const { traces }: TracesState = (thunkApi.getState() as any).traces;\n+\n+    if (traces[traceId]) {\n+      const { rawTrace, skewCorrectedTrace } = traces[traceId];\n+      let { adjustedTrace } = traces[traceId];\n+      if (adjustedTrace) {\n+        return traces[traceId];\n+      }\n+      if (skewCorrectedTrace) {\n+        adjustedTrace = buildDetailedTraceSummary(skewCorrectedTrace);", "originalCommit": "48e5ba16deef3b994a5cbe2a8723778c09c4e8e9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cebfbdc5aac5d638c849426b483369df267c6c63", "url": "https://github.com/openzipkin/zipkin/commit/cebfbdc5aac5d638c849426b483369df267c6c63", "message": "Avoid disabling no-shadow and use useSelector & useDispatch instead of connect", "committedDate": "2020-09-15T10:11:31Z", "type": "commit"}, {"oid": "3a7053f37279ad4d606c23ba0c6a88341934e519", "url": "https://github.com/openzipkin/zipkin/commit/3a7053f37279ad4d606c23ba0c6a88341934e519", "message": "Remove an unnecessary prop from TracePage", "committedDate": "2020-09-15T21:42:40Z", "type": "commit"}, {"oid": "e140317c8e52b8f39f4ae821f5657e4d93708437", "url": "https://github.com/openzipkin/zipkin/commit/e140317c8e52b8f39f4ae821f5657e4d93708437", "message": "Show error message when failed to load JSON files", "committedDate": "2020-09-15T21:49:15Z", "type": "commit"}, {"oid": "721339980510af31304051a0c2c29ed921a8a11e", "url": "https://github.com/openzipkin/zipkin/commit/721339980510af31304051a0c2c29ed921a8a11e", "message": "Change the way to show that no trace found", "committedDate": "2020-09-15T22:16:36Z", "type": "commit"}, {"oid": "4836fef9e48f9810ff71f1e3b81200e0d962ef9c", "url": "https://github.com/openzipkin/zipkin/commit/4836fef9e48f9810ff71f1e3b81200e0d962ef9c", "message": "Show error message when failed to search traces", "committedDate": "2020-09-15T22:26:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA3OTQ0Ng==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r489079446", "bodyText": "will the return here have the same type as the result of buildDetailedTraceSummary?", "author": "codefromthecrypt", "createdAt": "2020-09-15T23:47:00Z", "path": "zipkin-lens/src/slices/tracesSlice.ts", "diffHunk": "@@ -0,0 +1,292 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+/* eslint-disable no-param-reassign */\n+\n+import {\n+  SerializedError,\n+  createAsyncThunk,\n+  createSlice,\n+} from '@reduxjs/toolkit';\n+\n+import * as api from '../constants/api';\n+import AdjustedTrace from '../models/AdjustedTrace';\n+import Span from '../models/Span';\n+import TraceSummary from '../models/TraceSummary';\n+import { ensureV2TraceData } from '../util/trace';\n+\n+const {\n+  treeCorrectedForClockSkew,\n+  traceSummary: buildTraceSummary,\n+  traceSummaries: buildTraceSummaries,\n+  detailedTraceSummary: buildDetailedTraceSummary,\n+} = require('../zipkin');\n+\n+export const searchTraces = createAsyncThunk(\n+  'traces/search',\n+  async (params: { [key: string]: string }, thunkApi) => {\n+    const ps = new URLSearchParams(params);\n+\n+    // We need to import RootState in order to give the type to getState.\n+    // Importing RootState will result in a cyclic import.\n+    // So use any type to avoid this.\n+    const { search, traces }: TracesState = (thunkApi.getState() as any).traces;\n+    // If the query is the same as the previous query, it will not fetch again.\n+    if (search.prevQuery === ps.toString()) {\n+      return {\n+        traces,\n+        traceSummaries: search.traceSummaries,\n+        query: ps.toString(),\n+      };\n+    }\n+\n+    const resp = await fetch(`${api.TRACES}?${ps.toString()}`);\n+    if (!resp.ok) {\n+      throw Error(resp.statusText);\n+    }\n+    const rawTraces: Span[][] = await resp.json();\n+\n+    const newTraces = rawTraces.reduce(\n+      (acc, rawTrace) => {\n+        const [{ traceId }] = rawTrace;\n+        const skewCorrectedTrace = treeCorrectedForClockSkew(rawTrace);\n+        acc[traceId] = {\n+          rawTrace,\n+          skewCorrectedTrace,\n+        };\n+        return acc;\n+      },\n+      {} as {\n+        [key: string]: {\n+          rawTrace: Span[];\n+          skewCorrectedTrace: any;\n+        };\n+      },\n+    );\n+\n+    const traceSummaries: TraceSummary[] = buildTraceSummaries(\n+      ps.get('serviceName'),\n+      Object.keys(newTraces).map((traceId) =>\n+        buildTraceSummary(newTraces[traceId].skewCorrectedTrace),\n+      ),\n+    );\n+\n+    return {\n+      traces: newTraces,\n+      traceSummaries,\n+      query: ps.toString(),\n+    };\n+  },\n+);\n+\n+export const loadTrace = createAsyncThunk(\n+  'traces/load',\n+  async (traceId: string, thunkApi) => {\n+    // We need to import RootState in order to give the type to getState.\n+    // Importing RootState will result in a cyclic import.\n+    // So use any type to avoid this.\n+    const { traces }: TracesState = (thunkApi.getState() as any).traces;\n+\n+    if (traces[traceId]) {\n+      const { rawTrace, skewCorrectedTrace } = traces[traceId];\n+      let { adjustedTrace } = traces[traceId];\n+      if (adjustedTrace) {\n+        return traces[traceId];", "originalCommit": "4836fef9e48f9810ff71f1e3b81200e0d962ef9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA4MzU5NQ==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r489083595", "bodyText": "Yes.\nIf this adjustedTraces is not undefined, this trace has already been calculated by buildDetailedTraceSummary.\nso I avoid recalculating it and return the data as it is.", "author": "tacigar", "createdAt": "2020-09-16T00:00:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA3OTQ0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA4NDg3MQ==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r489084871", "bodyText": "above this         return traces[traceId]; line, add // this trace has already been calculated by buildDetailedTraceSummary?", "author": "codefromthecrypt", "createdAt": "2020-09-16T00:05:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTA3OTQ0Ng=="}], "type": "inlineReview"}, {"oid": "e5b4962f3867c230e11e01a866d28b78f830b2b9", "url": "https://github.com/openzipkin/zipkin/commit/e5b4962f3867c230e11e01a866d28b78f830b2b9", "message": "Add comments", "committedDate": "2020-09-18T23:02:19Z", "type": "commit"}, {"oid": "f3424bff8d97e1e5c2cf13a3e3a7489124b36656", "url": "https://github.com/openzipkin/zipkin/commit/f3424bff8d97e1e5c2cf13a3e3a7489124b36656", "message": "(package) Add @types/redux-mock-store and update redux-mock-store", "committedDate": "2020-09-19T15:48:41Z", "type": "commit"}, {"oid": "c08e1dc9b727fa0ec6593d299159a3a7ce18f217", "url": "https://github.com/openzipkin/zipkin/commit/c08e1dc9b727fa0ec6593d299159a3a7ce18f217", "message": "Add unit tests of tracesSlice", "committedDate": "2020-09-19T15:48:55Z", "type": "commit"}, {"oid": "b5eded02814d9fa763a7c9e778c7d43f9204b97e", "url": "https://github.com/openzipkin/zipkin/commit/b5eded02814d9fa763a7c9e778c7d43f9204b97e", "message": "Update unit tests", "committedDate": "2020-09-19T15:59:34Z", "type": "commit"}, {"oid": "6e9aace1aef3f8fbead5fa2a61f113d90ac70a12", "url": "https://github.com/openzipkin/zipkin/commit/6e9aace1aef3f8fbead5fa2a61f113d90ac70a12", "message": "Remove unused file", "committedDate": "2020-09-19T16:12:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTYwMjI0Nw==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r491602247", "bodyText": "hah. I bet this was surprising :D", "author": "codefromthecrypt", "createdAt": "2020-09-19T23:26:42Z", "path": "zipkin-lens/src/zipkin/trace.test.js", "diffHunk": "@@ -482,8 +482,8 @@ describe('detailedTraceSummary', () => {\n       { serviceName: 'frontend', spanCount: 1 },\n     ]);\n     expect(rootSpan).toEqual({\n-      serviceName: 'backend',\n-      spanName: 'get /api',\n+      serviceName: 'frontend',", "originalCommit": "6e9aace1aef3f8fbead5fa2a61f113d90ac70a12", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MTQyMg==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r491641422", "bodyText": "I wonder if anyone would appreciate us publishing these types at some point.\nThough it also brought the idea of perhaps using zipkin-js for its model types\nhttps://www.github.com/openzipkin/zipkin-js/tree/master/packages%2Fzipkin%2Findex.d.ts\nJust random idea :)", "author": "anuraaga", "createdAt": "2020-09-20T01:59:39Z", "path": "zipkin-lens/src/models/Span.ts", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Copyright 2015-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+import Annotation from './Annotation';\n+import Endpoint from './Endpoint';\n+\n+// Same type as Span in the OpenApi/Swagger model https://zipkin.io/zipkin-api/#", "originalCommit": "6e9aace1aef3f8fbead5fa2a61f113d90ac70a12", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc0ODM0Mg==", "url": "https://github.com/openzipkin/zipkin/pull/3203#discussion_r491748342", "bodyText": "probably this one is more the point https://github.com/openzipkin/zipkin-js/blob/master/packages/zipkin/src/model.js\nif anything we could match the types and put a link to it for now and make a note? That way the idea lingers more directly, and we can move that comment about the type into zipkin-js?\nfwiw if doing a dep on the openapi type, I'd be more inclined to publish from the api project not zipkin-js.. we have a similar thing published for proto (though not generated..)", "author": "codefromthecrypt", "createdAt": "2020-09-20T23:34:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY0MTQyMg=="}], "type": "inlineReview"}, {"oid": "c819ddeef209a165fd19a0e46c70a26b8338db2d", "url": "https://github.com/openzipkin/zipkin/commit/c819ddeef209a165fd19a0e46c70a26b8338db2d", "message": "Add comments", "committedDate": "2020-09-23T03:33:40Z", "type": "commit"}]}