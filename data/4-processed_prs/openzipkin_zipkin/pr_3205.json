{"pr_number": 3205, "pr_title": "Removes dead code from Lens", "pr_createdAt": "2020-09-11T11:28:57Z", "pr_url": "https://github.com/openzipkin/zipkin/pull/3205", "timeline": [{"oid": "97a711a3de9f72a9067b232c31b91ee9432203af", "url": "https://github.com/openzipkin/zipkin/commit/97a711a3de9f72a9067b232c31b91ee9432203af", "message": "Removes dead code from Lens\n\nFound some of this with IntelliJ", "committedDate": "2020-09-11T11:28:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyNDg0OA==", "url": "https://github.com/openzipkin/zipkin/pull/3205#discussion_r487024848", "bodyText": "I think this code is alive.\nWithout this code the cursor does not change when hovering over the clear button.\n\nWith this code:", "author": "tacigar", "createdAt": "2020-09-11T12:54:12Z", "path": "zipkin-lens/src/components/DependenciesPage/DependenciesGraph.tsx", "diffHunk": "@@ -94,10 +94,6 @@ const reactSelectStyles = {\n     ...base,\n     cursor: 'pointer',\n   }),\n-  clearIndicator: (base: CSSProperties) => ({\n-    ...base,\n-    cursor: 'pointer',\n-  }),", "originalCommit": "97a711a3de9f72a9067b232c31b91ee9432203af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMzMjc5Mw==", "url": "https://github.com/openzipkin/zipkin/pull/3205#discussion_r487332793", "bodyText": "intellij analysis is imperfect :) I will put a comment that this is \"not quite dead\"", "author": "codefromthecrypt", "createdAt": "2020-09-11T23:33:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyNDg0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyNjU3Mw==", "url": "https://github.com/openzipkin/zipkin/pull/3205#discussion_r487026573", "bodyText": "Thanks!\nIt looks like these codes can be removed as well :)\n\n  \n    \n      zipkin/zipkin-lens/src/slices/remoteServicesSlice.ts\n    \n    \n        Lines 55 to 59\n      in\n      5562dd5\n    \n    \n    \n    \n\n        \n          \n           clearRemoteServices: (state) => { \n        \n\n        \n          \n             state.isLoading = false; \n        \n\n        \n          \n             state.remoteServices = []; \n        \n\n        \n          \n             state.error = undefined; \n        \n\n        \n          \n           }, \n        \n    \n  \n\n\n\n  \n    \n      zipkin/zipkin-lens/src/slices/spansSlice.ts\n    \n    \n        Lines 55 to 59\n      in\n      5562dd5\n    \n    \n    \n    \n\n        \n          \n           clearSpans: (state) => { \n        \n\n        \n          \n             state.isLoading = false; \n        \n\n        \n          \n             state.spans = []; \n        \n\n        \n          \n             state.error = undefined; \n        \n\n        \n          \n           }, \n        \n    \n  \n\n\n\n  \n    \n      zipkin/zipkin-lens/src/slices/spansSlice.ts\n    \n    \n         Line 80\n      in\n      5562dd5\n    \n    \n    \n    \n\n        \n          \n           export const { clearSpans } = spansSlice.actions;", "author": "tacigar", "createdAt": "2020-09-11T12:57:12Z", "path": "zipkin-lens/src/slices/remoteServicesSlice.ts", "diffHunk": "@@ -77,6 +77,4 @@ const remoteServicesSlice = createSlice({\n   },\n });\n \n-export const { clearRemoteServices } = remoteServicesSlice.actions;", "originalCommit": "97a711a3de9f72a9067b232c31b91ee9432203af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMzMjg1NQ==", "url": "https://github.com/openzipkin/zipkin/pull/3205#discussion_r487332855", "bodyText": "great", "author": "codefromthecrypt", "createdAt": "2020-09-11T23:33:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyNjU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU5MTkzNA==", "url": "https://github.com/openzipkin/zipkin/pull/3205#discussion_r487591934", "bodyText": "I am curious on these.. why can I remove them? Maybe you can tell me for each below:\nservicesSlice, autocompleteKeys - only loaded ever once, so no need to clear\nautocompleteValues - currently no reducer; data is partitioned by 'autocompleteKey'\nremoteServices, spans - reducer to remove; data partitioned by 'service'\ndependencies - contains a clear reducer, the data is not really cache-able except what's defined in HTTP\nLater I would like to refactor based on this conversation. I would like to delete code, just I don't understand when we need a reducer to clear and not. cc @anuraaga", "author": "codefromthecrypt", "createdAt": "2020-09-13T23:33:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyNjU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODI4OTM3Nw==", "url": "https://github.com/openzipkin/zipkin/pull/3205#discussion_r488289377", "bodyText": "zipkin/zipkin-lens/src/components/DiscoverPage/SearchBar/SearchBar.tsx\n    \n    \n        Lines 138 to 149\n      in\n      5562dd5\n    \n    \n    \n    \n\n        \n          \n           useEffect(() => { \n        \n\n        \n          \n             const criterion = criteria.find( \n        \n\n        \n          \n               // eslint-disable-next-line no-shadow \n        \n\n        \n          \n               (criterion) => criterion.key === 'serviceName', \n        \n\n        \n          \n             ); \n        \n\n        \n          \n             const serviceName = criterion ? criterion.value : ''; \n        \n\n        \n          \n             if (serviceName !== prevServiceName.current) { \n        \n\n        \n          \n               prevServiceName.current = serviceName; \n        \n\n        \n          \n               loadSpans(serviceName); \n        \n\n        \n          \n               loadRemoteServices(serviceName); \n        \n\n        \n          \n             } \n        \n\n        \n          \n           }, [criteria, loadSpans, loadRemoteServices]); \n        \n    \n  \n\n\nAs soon as service criterion is changed, the spans and remoteServices fetching will begin, and the previous spans and remoteServices will be cleared.\nSo I think there is no need to explicitly clear them.", "author": "tacigar", "createdAt": "2020-09-14T23:16:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyNjU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM3NzIwMg==", "url": "https://github.com/openzipkin/zipkin/pull/3205#discussion_r488377202", "bodyText": "thanks!", "author": "codefromthecrypt", "createdAt": "2020-09-15T04:33:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzAyNjU3Mw=="}], "type": "inlineReview"}, {"oid": "d6a3dc42206eedf9d02d32e58ac2bcc39bddd5b8", "url": "https://github.com/openzipkin/zipkin/commit/d6a3dc42206eedf9d02d32e58ac2bcc39bddd5b8", "message": "feedback and comments", "committedDate": "2020-09-13T23:35:28Z", "type": "commit"}, {"oid": "d33eda58066ae528e6b18881065585c5201747e0", "url": "https://github.com/openzipkin/zipkin/commit/d33eda58066ae528e6b18881065585c5201747e0", "message": "moar death", "committedDate": "2020-09-15T04:33:19Z", "type": "commit"}, {"oid": "6104ab4b2f95edb5ff2ff7cefe26951843fb1da7", "url": "https://github.com/openzipkin/zipkin/commit/6104ab4b2f95edb5ff2ff7cefe26951843fb1da7", "message": "license", "committedDate": "2020-09-15T06:13:04Z", "type": "commit"}]}