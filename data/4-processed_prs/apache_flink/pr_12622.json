{"pr_number": 12622, "pr_title": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file", "pr_createdAt": "2020-06-12T02:37:18Z", "pr_url": "https://github.com/apache/flink/pull/12622", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MjE4Nw==", "url": "https://github.com/apache/flink/pull/12622#discussion_r439372187", "bodyText": "The location of this file is wrong. It needs to be in the META-INF folder, not the services folder.", "author": "rmetzger", "createdAt": "2020-06-12T11:49:03Z", "path": "flink-formats/flink-sql-orc/src/main/resources/META-INF/services/NOTICE", "diffHunk": "@@ -1,4 +1,4 @@\n-flink-orc", "originalCommit": "affedb647e7fc0b175f155b202dcc48a9775174a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MjI3NQ==", "url": "https://github.com/apache/flink/pull/12622#discussion_r439372275", "bodyText": "same issue", "author": "rmetzger", "createdAt": "2020-06-12T11:49:18Z", "path": "flink-formats/flink-sql-parquet/src/main/resources/META-INF/services/NOTICE", "diffHunk": "@@ -1,4 +1,4 @@\n-flink-parquet", "originalCommit": "affedb647e7fc0b175f155b202dcc48a9775174a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg==", "url": "https://github.com/apache/flink/pull/12622#discussion_r439373482", "bodyText": "I'm not sure if it is necessary to create new modules just to create the fat jar.\nAfaik, you can use the maven shade plugin to create a new jar. I guess the <finalName> or <outputFile> parameter will be of help for this.", "author": "rmetzger", "createdAt": "2020-06-12T11:52:15Z", "path": "flink-formats/flink-sql-orc/pom.xml", "diffHunk": "@@ -0,0 +1,92 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "originalCommit": "affedb647e7fc0b175f155b202dcc48a9775174a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM4NDc2MQ==", "url": "https://github.com/apache/flink/pull/12622#discussion_r439384761", "bodyText": "If using <finalName> or <outputFile>, I can not find a way to install or deploy into repository. >_<", "author": "JingsongLi", "createdAt": "2020-06-12T12:20:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM4ODU0MA==", "url": "https://github.com/apache/flink/pull/12622#discussion_r439388540", "bodyText": "ah, so if you run \"mvn install\", the jar won't be added to your local .m2 directory?\nHave you tried these? http://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html (and maybe also https://maven.apache.org/plugins/maven-deploy-plugin/deploy-file-mojo.html ?)", "author": "rmetzger", "createdAt": "2020-06-12T12:28:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcxODk3OA==", "url": "https://github.com/apache/flink/pull/12622#discussion_r439718978", "bodyText": "My idea is to automatically upload to Maven repositories, through which users can download by themselves. (The previous jar-with-dependency didn't work too)\nLike jars in https://repo.maven.apache.org/maven2/org/apache/flink/flink-sql-connector-kafka_2.11/1.10.1/", "author": "JingsongLi", "createdAt": "2020-06-13T07:51:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcxOTkwMQ==", "url": "https://github.com/apache/flink/pull/12622#discussion_r439719901", "bodyText": "I found a JIRA related to sql-jars: https://issues.apache.org/jira/browse/FLINK-11026", "author": "JingsongLi", "createdAt": "2020-06-13T08:07:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcyMTIyMw==", "url": "https://github.com/apache/flink/pull/12622#discussion_r439721223", "bodyText": "PR descriptor updated.\nProfile with maven-shade-plugin and shadedClassifierName can create a bundled jar and upload jar to maven repositories.\nBut for accurate notice files it is necessary to be able to supply each artifact with distinct NOTICE files, we need create a separate module.", "author": "JingsongLi", "createdAt": "2020-06-13T08:29:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAxNDgyOA==", "url": "https://github.com/apache/flink/pull/12622#discussion_r440014828", "bodyText": "But for accurate notice files it is necessary to be able to supply each artifact with distinct NOTICE files, we need create a separate module.\n\nBut we would only need one NOTICE file in flink-orc which we will use for the shaded fat jar. For the regular flink-orc.jar we don't need a special NOTICE file, as it contains only Flink binaries.\nSorry that I'm making this so complicated. I'm just trying to make sure that we are not introducing unnecessary complexity here, and that the NOTICE files are valid.", "author": "rmetzger", "createdAt": "2020-06-15T08:34:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyOTE1MQ==", "url": "https://github.com/apache/flink/pull/12622#discussion_r440029151", "bodyText": "Sorry that I'm making this so complicated.\n\nIt's all right, your review makes things clearer~\nI thought the meaning of #7251 is:\nFor the regular flink-orc.jar should has a NOTICE file too.\nIf we create a flink-sql-orc in flink-orc module with classifier sql-jar. Then, there are two jars in artifact flink-orc.\nAnd they should have different NOTICE files (Which is hard to do). One has many dependencies, but another just is an simple file like:\n// ------------------------------------------------------------------\n// NOTICE file corresponding to the section 4d of The Apache License,\n// Version 2.0, in this case for Apache Flink\n// ------------------------------------------------------------------\n\nApache Flink\nCopyright 2006-2020 The Apache Software Foundation\n\nThis product includes software developed at\nThe Apache Software Foundation (http://www.apache.org/).\n\nflink-orc\nCopyright 2014-2020 The Apache Software Foundation\n\nCorrect me if I wrong.\nCC: @zentol", "author": "JingsongLi", "createdAt": "2020-06-15T08:58:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMzcxNA==", "url": "https://github.com/apache/flink/pull/12622#discussion_r440033714", "bodyText": "Thanks a lot for the explanation and reference. It seems that adding a second module is the way to go!", "author": "rmetzger", "createdAt": "2020-06-15T09:06:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTM3MzQ4Mg=="}], "type": "inlineReview"}, {"oid": "409adc2e3f4e30a3070213da099d3649eb38659e", "url": "https://github.com/apache/flink/commit/409adc2e3f4e30a3070213da099d3649eb38659e", "message": "Modify md", "committedDate": "2020-06-12T12:24:10Z", "type": "forcePushed"}, {"oid": "50fdced2c8d3dbdbff6573245dcf5e2cd45fd601", "url": "https://github.com/apache/flink/commit/50fdced2c8d3dbdbff6573245dcf5e2cd45fd601", "message": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file", "committedDate": "2020-06-15T02:38:35Z", "type": "forcePushed"}, {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "url": "https://github.com/apache/flink/commit/6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "message": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file", "committedDate": "2020-06-15T03:18:56Z", "type": "commit"}, {"oid": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "url": "https://github.com/apache/flink/commit/6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "message": "[FLINK-18261][parquet][orc] flink-orc and flink-parquet have invalid NOTICE file", "committedDate": "2020-06-15T03:18:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyNzIzNA==", "url": "https://github.com/apache/flink/pull/12622#discussion_r440027234", "bodyText": "\u2705  File looks good", "author": "rmetzger", "createdAt": "2020-06-15T08:55:31Z", "path": "flink-formats/flink-sql-orc/src/main/resources/META-INF/NOTICE", "diffHunk": "@@ -1,4 +1,4 @@\n-flink-orc", "originalCommit": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyODQ0OQ==", "url": "https://github.com/apache/flink/pull/12622#discussion_r440028449", "bodyText": "\u2705  file looks good", "author": "rmetzger", "createdAt": "2020-06-15T08:57:26Z", "path": "flink-formats/flink-sql-parquet/src/main/resources/META-INF/NOTICE", "diffHunk": "@@ -1,4 +1,4 @@\n-flink-parquet\n+flink-sql-parquet", "originalCommit": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDA2NTk2Mw==", "url": "https://github.com/apache/flink/pull/12622#discussion_r440065963", "bodyText": "I'd prefer this to be defined in flink-formats; to keep things as localized as possible.", "author": "zentol", "createdAt": "2020-06-15T10:01:26Z", "path": "pom.xml", "diffHunk": "@@ -156,6 +156,7 @@ under the License.\n \t\t<hivemetastore.hadoop.version>2.7.5</hivemetastore.hadoop.version>\n \t\t<japicmp.referenceVersion>1.10.0</japicmp.referenceVersion>\n \t\t<japicmp.outputDir>tools/japicmp-output</japicmp.outputDir>\n+\t\t<flink.format.parquet.version>1.10.0</flink.format.parquet.version>", "originalCommit": "6d9675e9da52cd84df8f7b0b78ef7e2de8c23ef3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d78d9ec514a23300e40aab4ca88ebad35ea86453", "url": "https://github.com/apache/flink/commit/d78d9ec514a23300e40aab4ca88ebad35ea86453", "message": "Fix comments", "committedDate": "2020-06-15T10:18:18Z", "type": "commit"}]}