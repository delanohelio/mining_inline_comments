{"pr_number": 13708, "pr_title": "[FLINK-19734][table-planner-blink] Replace 'collection' connector by 'values' connector for temporal join plan tests", "pr_createdAt": "2020-10-20T15:47:19Z", "pr_url": "https://github.com/apache/flink/pull/13708", "timeline": [{"oid": "7790ddd65711253a6e55e9908edd541db30b4b70", "url": "https://github.com/apache/flink/commit/7790ddd65711253a6e55e9908edd541db30b4b70", "message": "[FLINK-19734][table-planner-blink] Replace 'collection' connector by 'values' connector for temporal join plan tests", "committedDate": "2020-10-20T15:42:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk3MTg1OQ==", "url": "https://github.com/apache/flink/pull/13708#discussion_r508971859", "bodyText": "Could we add one Collection test to ensure the temporal join plan works fine with Legacy connector?", "author": "leonardBang", "createdAt": "2020-10-21T03:45:44Z", "path": "flink-table/flink-table-planner-blink/src/test/resources/org/apache/flink/table/planner/plan/stream/sql/join/TemporalJoinTest.xml", "diffHunk": "@@ -43,13 +43,13 @@ Calc(select=[amount, currency, rowtime, PROCTIME_MATERIALIZE(proctime) AS procti\n    :- Exchange(distribution=[hash[currency]])\n    :  +- WatermarkAssigner(rowtime=[rowtime], watermark=[rowtime])\n    :     +- Calc(select=[amount, currency, rowtime, PROCTIME() AS proctime])\n-   :        +- LegacyTableSourceScan(table=[[default_catalog, default_database, Orders, source: [CollectionTableSource(amount, currency, rowtime)]]], fields=[amount, currency, rowtime])\n+   :        +- TableSourceScan(table=[[default_catalog, default_database, Orders]], fields=[amount, currency, rowtime])\n    +- Exchange(distribution=[hash[currency]])\n       +- Calc(select=[currency, rate, rowtime], where=[<(rate, 100)])\n          +- Rank(strategy=[AppendFastStrategy], rankType=[ROW_NUMBER], rankRange=[rankStart=1, rankEnd=1], partitionBy=[currency], orderBy=[rowtime DESC], select=[currency, rate, rowtime])\n             +- Exchange(distribution=[hash[currency]])\n                +- WatermarkAssigner(rowtime=[rowtime], watermark=[rowtime])\n-                  +- LegacyTableSourceScan(table=[[default_catalog, default_database, RatesHistory, source: [CollectionTableSource(currency, rate, rowtime)]]], fields=[currency, rate, rowtime])\n+                  +- TableSourceScan(table=[[default_catalog, default_database, RatesHistory]], fields=[currency, rate, rowtime])", "originalCommit": "7790ddd65711253a6e55e9908edd541db30b4b70", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "78020d78e6cddf182a97d1f44926bb50a3691284", "url": "https://github.com/apache/flink/commit/78020d78e6cddf182a97d1f44926bb50a3691284", "message": "add plan tests for legacy source", "committedDate": "2020-10-21T12:57:09Z", "type": "commit"}]}