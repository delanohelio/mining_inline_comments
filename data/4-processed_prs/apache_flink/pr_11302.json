{"pr_number": 11302, "pr_title": "[FLINK-16414]fix sql validation failed when using udaf/udtf which doesn't implement getResultType", "pr_createdAt": "2020-03-04T07:24:00Z", "pr_url": "https://github.com/apache/flink/pull/11302", "timeline": [{"oid": "d549e324ccf8459f5731f72a9d1ff0fa87188182", "url": "https://github.com/apache/flink/commit/d549e324ccf8459f5731f72a9d1ff0fa87188182", "message": "[FLINK-16414]fix sql validation failed when using udaf/udtf which doesn't implement getResultType", "committedDate": "2020-03-04T07:19:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU4Mjg3MQ==", "url": "https://github.com/apache/flink/pull/11302#discussion_r387582871", "bodyText": "Can we extend the TestTableAggFunction instead so that we can reuse the code ?", "author": "danny0405", "createdAt": "2020-03-04T10:40:03Z", "path": "flink-table/flink-table-api-java/src/test/java/org/apache/flink/table/functions/FunctionDefinitionUtilTest.java", "diffHunk": "@@ -129,4 +174,14 @@ public TypeInformation getAccumulatorType() {\n \t\t\treturn TypeInformation.of(Object.class);\n \t\t}\n \t}\n+\n+\t/**\n+\t * Test function.\n+\t */\n+\tpublic static class TestTableAggFunctionWithoutResultType extends TableAggregateFunction<Long, Long> {\n+\t\t@Override", "originalCommit": "d549e324ccf8459f5731f72a9d1ff0fa87188182", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU4ODIzMg==", "url": "https://github.com/apache/flink/pull/11302#discussion_r387588232", "bodyText": "No, reuse makes code strange. Better to distinguish them clearly.", "author": "JingsongLi", "createdAt": "2020-03-04T10:50:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU4Mjg3MQ=="}], "type": "inlineReview"}]}