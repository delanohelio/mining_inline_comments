{"pr_number": 13294, "pr_title": "[FLINK-19002][canal][json] Support to only read changelogs of specific database and table for canal-json format", "pr_createdAt": "2020-09-01T08:23:54Z", "pr_url": "https://github.com/apache/flink/pull/13294", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDcwMjE5OA==", "url": "https://github.com/apache/flink/pull/13294#discussion_r484702198", "bodyText": "This can be reused by declaring static member.", "author": "leonardBang", "createdAt": "2020-09-08T07:18:56Z", "path": "flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/canal/CanalJsonFormatFactoryTest.java", "diffHunk": "@@ -64,44 +64,50 @@\n \tprivate static final RowType ROW_TYPE = (RowType) SCHEMA.toRowDataType().getLogicalType();\n \n \t@Test\n-\tpublic void testSeDeSchema() {\n+\tpublic void testDefaultOptions() {\n+\t\tMap<String, String> options = getAllOptions();\n \n \t\t// test Deser\n-\t\tfinal CanalJsonDeserializationSchema expectedDeser = new CanalJsonDeserializationSchema(\n-\t\t\tROW_TYPE,\n-\t\t\tInternalTypeInfo.of(ROW_TYPE),\n-\t\t\ttrue,\n-\t\t\tTimestampFormat.ISO_8601);\n-\n-\t\tfinal Map<String, String> options = getAllOptions();\n+\t\tCanalJsonDeserializationSchema expectedDeser = CanalJsonDeserializationSchema\n+\t\t\t.builder(ROW_TYPE, InternalTypeInfo.of(ROW_TYPE))", "originalCommit": "d9ce2f0083bbf6e00e4782c3ab2f7dd686d07e55", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDcwMjcxNw==", "url": "https://github.com/apache/flink/pull/13294#discussion_r484702717", "bodyText": "InternalTypeInfo.of(SCHEMA) can be reused by declaring static member.", "author": "leonardBang", "createdAt": "2020-09-08T07:19:53Z", "path": "flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/canal/CanalJsonSerDeSchemaTest.java", "diffHunk": "@@ -61,15 +61,29 @@\n \t\tFIELD(\"weight\", FLOAT())\n \t).getLogicalType();\n \n+\t@Test\n+\tpublic void testFilteringTables() throws Exception {\n+\t\tList<String> lines = readLines(\"canal-data-filter-table.txt\");\n+\t\tCanalJsonDeserializationSchema deserializationSchema = CanalJsonDeserializationSchema\n+\t\t\t.builder(SCHEMA, InternalTypeInfo.of(SCHEMA))", "originalCommit": "d9ce2f0083bbf6e00e4782c3ab2f7dd686d07e55", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDcwMzk1MA==", "url": "https://github.com/apache/flink/pull/13294#discussion_r484703950", "bodyText": "How about the following translation?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  <td>\u4ec5\u8bfb\u53d6\u5339\u914d\u6240\u6307\u5b9a\u6570\u636e\u5e93\u7684 changelog \u8bb0\u5f55\uff08\u901a\u8fc7\u5bf9\u6bd4 Canal \u8bb0\u5f55\u4e2d\u7684 \"database\" \u5143\u6570\u636e\u5b57\u6bb5\uff09\u3002\n          \n          \n            \n                  <td>\u4ec5\u8bfb\u53d6\u6307\u5b9a\u6570\u636e\u5e93\u7684 changelog \u8bb0\u5f55\uff08\u901a\u8fc7\u5bf9\u6bd4 Canal \u8bb0\u5f55\u4e2d\u7684 \"database\" \u5143\u6570\u636e\u5b57\u6bb5\uff09\u3002", "author": "leonardBang", "createdAt": "2020-09-08T07:22:10Z", "path": "docs/dev/table/connectors/formats/canal.zh.md", "diffHunk": "@@ -183,6 +183,20 @@ Format \u53c2\u6570\n        </ul>\n        </td>\n     </tr>\n+    <tr>\n+      <td><h5>canal-json.database</h5></td>\n+      <td>optional</td>\n+      <td style=\"word-wrap: break-word;\">(none)</td>\n+      <td>String</td>\n+      <td>\u4ec5\u8bfb\u53d6\u5339\u914d\u6240\u6307\u5b9a\u6570\u636e\u5e93\u7684 changelog \u8bb0\u5f55\uff08\u901a\u8fc7\u5bf9\u6bd4 Canal \u8bb0\u5f55\u4e2d\u7684 \"database\" \u5143\u6570\u636e\u5b57\u6bb5\uff09\u3002", "originalCommit": "d9ce2f0083bbf6e00e4782c3ab2f7dd686d07e55", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDcwMzk2Mw==", "url": "https://github.com/apache/flink/pull/13294#discussion_r484703963", "bodyText": "How about the following translation?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  <td>\u4ec5\u8bfb\u53d6\u5339\u914d\u6240\u6307\u5b9a\u8868\u7684 changelog \u8bb0\u5f55\uff08\u901a\u8fc7\u5bf9\u6bd4 Canal \u8bb0\u5f55\u4e2d\u7684 \"table\" \u5143\u6570\u636e\u5b57\u6bb5\uff09\u3002\n          \n          \n            \n                  <td>\u4ec5\u8bfb\u53d6\u6307\u5b9a\u8868\u7684 changelog \u8bb0\u5f55\uff08\u901a\u8fc7\u5bf9\u6bd4 Canal \u8bb0\u5f55\u4e2d\u7684 \"table\" \u5143\u6570\u636e\u5b57\u6bb5\uff09\u3002", "author": "leonardBang", "createdAt": "2020-09-08T07:22:11Z", "path": "docs/dev/table/connectors/formats/canal.zh.md", "diffHunk": "@@ -183,6 +183,20 @@ Format \u53c2\u6570\n        </ul>\n        </td>\n     </tr>\n+    <tr>\n+      <td><h5>canal-json.database</h5></td>\n+      <td>optional</td>\n+      <td style=\"word-wrap: break-word;\">(none)</td>\n+      <td>String</td>\n+      <td>\u4ec5\u8bfb\u53d6\u5339\u914d\u6240\u6307\u5b9a\u6570\u636e\u5e93\u7684 changelog \u8bb0\u5f55\uff08\u901a\u8fc7\u5bf9\u6bd4 Canal \u8bb0\u5f55\u4e2d\u7684 \"database\" \u5143\u6570\u636e\u5b57\u6bb5\uff09\u3002\n+    </tr>\n+    <tr>\n+      <td><h5>canal-json.table</h5></td>\n+      <td>optional</td>\n+      <td style=\"word-wrap: break-word;\">(none)</td>\n+      <td>String</td>\n+      <td>\u4ec5\u8bfb\u53d6\u5339\u914d\u6240\u6307\u5b9a\u8868\u7684 changelog \u8bb0\u5f55\uff08\u901a\u8fc7\u5bf9\u6bd4 Canal \u8bb0\u5f55\u4e2d\u7684 \"table\" \u5143\u6570\u636e\u5b57\u6bb5\uff09\u3002", "originalCommit": "d9ce2f0083bbf6e00e4782c3ab2f7dd686d07e55", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3493864e68acbd58a4c73524dc1639885fcae743", "url": "https://github.com/apache/flink/commit/3493864e68acbd58a4c73524dc1639885fcae743", "message": "[FLINK-19002][canal][json] Support to only read changelogs of specific database and table for canal-json format", "committedDate": "2020-09-17T09:26:43Z", "type": "commit"}, {"oid": "79b09d7dae7d662f6a907ee24f65b023eb63afe5", "url": "https://github.com/apache/flink/commit/79b09d7dae7d662f6a907ee24f65b023eb63afe5", "message": "address review comments.", "committedDate": "2020-09-17T09:26:44Z", "type": "commit"}, {"oid": "051a6077bd7cda3eb9d73ca795285135102fc8de", "url": "https://github.com/apache/flink/commit/051a6077bd7cda3eb9d73ca795285135102fc8de", "message": "rename 'canal-json.database', 'canal-json.table' to 'canal-json.database.include' and 'canal-json.table.include'", "committedDate": "2020-09-17T09:31:48Z", "type": "commit"}, {"oid": "051a6077bd7cda3eb9d73ca795285135102fc8de", "url": "https://github.com/apache/flink/commit/051a6077bd7cda3eb9d73ca795285135102fc8de", "message": "rename 'canal-json.database', 'canal-json.table' to 'canal-json.database.include' and 'canal-json.table.include'", "committedDate": "2020-09-17T09:31:48Z", "type": "forcePushed"}]}