{"pr_number": 11011, "pr_title": "[FLINK-15658][table-planner-blink] Fix duplicate field names exception when join on the same key multiple times", "pr_createdAt": "2020-02-04T06:36:31Z", "pr_url": "https://github.com/apache/flink/pull/11011", "timeline": [{"oid": "e0a75123cffb0bef0a2d155f52d793ee3f6804c6", "url": "https://github.com/apache/flink/commit/e0a75123cffb0bef0a2d155f52d793ee3f6804c6", "message": "[FLINK-15658][table-planner-blink] Fix duplicate field names exception when join on the same key multiple times", "committedDate": "2020-02-04T06:35:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5Nzg1MQ==", "url": "https://github.com/apache/flink/pull/11011#discussion_r374497851", "bodyText": "rowType.toRowType()", "author": "JingsongLi", "createdAt": "2020-02-04T06:45:59Z", "path": "flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/utils/KeySelectorUtil.java", "diffHunk": "@@ -44,20 +44,20 @@\n \tpublic static BaseRowKeySelector getBaseRowSelector(int[] keyFields, BaseRowTypeInfo rowType) {\n \t\tif (keyFields.length > 0) {\n \t\t\tLogicalType[] inputFieldTypes = rowType.getLogicalTypes();\n-\t\t\tString[] inputFieldNames = rowType.getFieldNames();\n \t\t\tLogicalType[] keyFieldTypes = new LogicalType[keyFields.length];\n-\t\t\tString[] keyFieldNames = new String[keyFields.length];\n \t\t\tfor (int i = 0; i < keyFields.length; ++i) {\n \t\t\t\tkeyFieldTypes[i] = inputFieldTypes[keyFields[i]];\n-\t\t\t\tkeyFieldNames[i] = inputFieldNames[keyFields[i]];\n \t\t\t}\n-\t\t\tRowType returnType = RowType.of(keyFieldTypes, keyFieldNames);\n+\t\t\t// do not provide field names for the result key type,\n+\t\t\t// because we may have duplicate key fields and the field names may conflict\n+\t\t\tRowType returnType = RowType.of(keyFieldTypes);\n \t\t\tRowType inputType = RowType.of(inputFieldTypes, rowType.getFieldNames());", "originalCommit": "e0a75123cffb0bef0a2d155f52d793ee3f6804c6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "38e5a57f0b14176f4117662cb5e2bc151e30e241", "url": "https://github.com/apache/flink/commit/38e5a57f0b14176f4117662cb5e2bc151e30e241", "message": "minor fix", "committedDate": "2020-02-04T07:02:09Z", "type": "commit"}]}