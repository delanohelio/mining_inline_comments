{"pr_number": 14488, "pr_title": "[FLINK-20651] Use Spotless/google-java-format for code formatting/enforcement", "pr_createdAt": "2020-12-24T14:15:23Z", "pr_url": "https://github.com/apache/flink/pull/14488", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI0NzU1NQ==", "url": "https://github.com/apache/flink/pull/14488#discussion_r549247555", "bodyText": "Don't we require <p> in comments? at least in java docs?  Or is it the issue, that we shouldn't have them in the license headers, but only in the java docs?", "author": "pnowojski", "createdAt": "2020-12-28T07:44:34Z", "path": "flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/KeyedProcessOperatorTest.java", "diffHunk": "@@ -6,9 +6,9 @@\n  * to you under the Apache License, Version 2.0 (the\n  * \"License\"); you may not use this file except in compliance\n  * with the License.  You may obtain a copy of the License at\n- * <p>\n+ *", "originalCommit": "f5ebdcc418bb91843f9a22a97a0229a6682c8824", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3ODg2NA==", "url": "https://github.com/apache/flink/pull/14488#discussion_r549278864", "bodyText": "<p> tags are only for javadocs, and the license headers are (should be) regular comments.", "author": "aljoscha", "createdAt": "2020-12-28T09:30:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI0NzU1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI1MTEyMQ==", "url": "https://github.com/apache/flink/pull/14488#discussion_r549251121", "bodyText": "Could this be fixed? What's causing this issue?", "author": "pnowojski", "createdAt": "2020-12-28T07:58:41Z", "path": "pom.xml", "diffHunk": "@@ -1815,6 +1827,47 @@ under the License.\n \t\t\t\t\t</configuration>\n \t\t\t\t</plugin>\n \n+\t\t\t\t<!-- Due to the Flink build setup, \"mvn spotless:apply\" and \"mvn spotless:check\"\n+\t\t\t\tdon't work. You have to use the fully qualified name, i.e.\n+\t\t\t\t\"mvn com.diffplug.spotless:spotless-maven-plugin:apply\" -->", "originalCommit": "5ad565c78d1a5bc03502ec929f98d1fde6154b6a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI3OTExNQ==", "url": "https://github.com/apache/flink/pull/14488#discussion_r549279115", "bodyText": "@zentol said that this can happen quite a lot. On a fresh Maven project mvn spotless:apply works, but not for us. We're stretching Maven quite a bit and that shows more and more. \ud83d\ude48", "author": "aljoscha", "createdAt": "2020-12-28T09:31:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI1MTEyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI1MTU3OQ==", "url": "https://github.com/apache/flink/pull/14488#discussion_r549251579", "bodyText": "git config blame.ignoreRevsFile .git-blame-ignore-revs\n\nCan you document this somewhere? In the project's .README?", "author": "pnowojski", "createdAt": "2020-12-28T08:00:32Z", "path": ".git-blame-ignore-revs", "diffHunk": "@@ -0,0 +1 @@\n+c996ed9372fc550d0a8a97b2b986bf96d26e304c", "originalCommit": "3a91ef723429a4fa0c262a148e8129bfcf611ba9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI4MDYyMA==", "url": "https://github.com/apache/flink/pull/14488#discussion_r549280620", "bodyText": "You're right, I forgot about this. I added the other setup instructions to ide_setup.md (c.f. https://ci.apache.org/projects/flink/flink-docs-master/flinkDev/ide_setup.html) and will also add it there.\nIn the long run, I think we should just add all these instructions straight to README.md, though.", "author": "aljoscha", "createdAt": "2020-12-28T09:36:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI1MTU3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI5OTc4MA==", "url": "https://github.com/apache/flink/pull/14488#discussion_r549299780", "bodyText": "indentation", "author": "zentol", "createdAt": "2020-12-28T10:39:09Z", "path": "flink-connectors/flink-connector-files/src/main/java/org/apache/flink/connector/file/src/AbstractFileSource.java", "diffHunk": "@@ -230,12 +230,14 @@ public Boundedness getBoundedness() {\n \t/**\n \t * The generic base builder. This builder carries a <i>SELF</i> type to make it convenient to\n \t * extend this for subclasses, using the following pattern.\n+\t *\n \t * <pre>{@code\n \t * public class SubBuilder<T> extends AbstractFileSourceBuilder<T, SubBuilder<T>> {\n \t *     ...\n \t * }\n \t * }</pre>\n-\t * That way, all return values from builder method defined here are typed to the sub-class\n+\t *\n+     * <p>That way, all return values from builder method defined here are typed to the sub-class", "originalCommit": "5f7065c3f2fdf604f743f7034e2a32a0e7c7c7cd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "896268e61a2b78e19c2493dad3cf2c2c039d5d0f", "url": "https://github.com/apache/flink/commit/896268e61a2b78e19c2493dad3cf2c2c039d5d0f", "message": "[hotfix] Fix incorrect license headers", "committedDate": "2020-12-28T13:24:49Z", "type": "commit"}, {"oid": "bdef67836e157f443acf609630bd529154a817ea", "url": "https://github.com/apache/flink/commit/bdef67836e157f443acf609630bd529154a817ea", "message": "[refactor] Use tabs in checkstyle.xml to conform to our other XML files", "committedDate": "2020-12-28T13:24:49Z", "type": "commit"}, {"oid": "58d0ec16ebbc18bbf236bfded85f4f99799d0b16", "url": "https://github.com/apache/flink/commit/58d0ec16ebbc18bbf236bfded85f4f99799d0b16", "message": "[FLINK-20651] Move checkstyle ignores to suppressions.xml\n\nKeeping them inline does not work with google-java-format.", "committedDate": "2020-12-28T13:24:50Z", "type": "commit"}, {"oid": "c6848163e3db9024662c58566c1d1036484bd0b8", "url": "https://github.com/apache/flink/commit/c6848163e3db9024662c58566c1d1036484bd0b8", "message": "[FLINK-20651] Remove checkstyle checks that don't work/are not needed with google-java-format", "committedDate": "2020-12-28T13:24:50Z", "type": "commit"}, {"oid": "edc65d794f3d746a7e87fec8443af6981051585e", "url": "https://github.com/apache/flink/commit/edc65d794f3d746a7e87fec8443af6981051585e", "message": "[FLINK-20651] Add suppressions for breakage after google-java-format formatting\n\nThe reformatting increases file length for some files.", "committedDate": "2020-12-28T13:24:50Z", "type": "commit"}, {"oid": "37f35d03bfa9c9066d54ede44ae40eed48b5e774", "url": "https://github.com/apache/flink/commit/37f35d03bfa9c9066d54ede44ae40eed48b5e774", "message": "[FLINK-20651] Fix formatting that doesn't work with google-java-format/checkstyle", "committedDate": "2020-12-28T13:24:50Z", "type": "commit"}, {"oid": "7a9483a3856cf94ea04b94e9539034e1543e7739", "url": "https://github.com/apache/flink/commit/7a9483a3856cf94ea04b94e9539034e1543e7739", "message": "[FLINK-20651] Add Spotless plugin with Google AOSP style", "committedDate": "2020-12-28T13:24:51Z", "type": "commit"}, {"oid": "8dd338d65d968b437f88363d84b99ffbd7ad05d4", "url": "https://github.com/apache/flink/commit/8dd338d65d968b437f88363d84b99ffbd7ad05d4", "message": "[FLINK-20651] Format code with Spotless/google-java-format", "committedDate": "2020-12-28T13:30:59Z", "type": "commit"}, {"oid": "54576e4383a54f5914f4e969f89532a543143567", "url": "https://github.com/apache/flink/commit/54576e4383a54f5914f4e969f89532a543143567", "message": "[FLINK-20651] Add .git-blame-ignore-revs for ignoring refactor commit\n\nThis file can be used via:\n\n$ git config blame.ignoreRevsFile .git-blame-ignore-revs", "committedDate": "2020-12-28T13:34:01Z", "type": "commit"}, {"oid": "f47db55d02fdb0f9d4da710e64881986ecc3d185", "url": "https://github.com/apache/flink/commit/f47db55d02fdb0f9d4da710e64881986ecc3d185", "message": "[FLINK-20651] Update .editorconfig to match google-java-format", "committedDate": "2020-12-28T13:34:06Z", "type": "commit"}, {"oid": "1a68434df3dabfead8bc97ac0818563dbce6fb79", "url": "https://github.com/apache/flink/commit/1a68434df3dabfead8bc97ac0818563dbce6fb79", "message": "[FLINK-20651] Add IDE instructions for google-java-format", "committedDate": "2020-12-28T13:34:06Z", "type": "commit"}, {"oid": "1a68434df3dabfead8bc97ac0818563dbce6fb79", "url": "https://github.com/apache/flink/commit/1a68434df3dabfead8bc97ac0818563dbce6fb79", "message": "[FLINK-20651] Add IDE instructions for google-java-format", "committedDate": "2020-12-28T13:34:06Z", "type": "forcePushed"}]}