{"pr_number": 14103, "pr_title": "[FLINK-18545] Introduce `pipeline.name` to allow users to specify job name by configuration", "pr_createdAt": "2020-11-17T15:40:33Z", "pr_url": "https://github.com/apache/flink/pull/14103", "timeline": [{"oid": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31", "url": "https://github.com/apache/flink/commit/938cbb403a01e6d31cbc605a49f9baf7b3b9bf31", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job", "committedDate": "2020-11-17T15:41:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI1MDcxMg==", "url": "https://github.com/apache/flink/pull/14103#discussion_r530250712", "bodyText": "nit: change this to The job name used for printing and logging.", "author": "twalthr", "createdAt": "2020-11-25T10:05:38Z", "path": "docs/_includes/generated/pipeline_configuration.html", "diffHunk": "@@ -86,6 +86,12 @@\n             <td>Integer</td>\n             <td>The program-wide maximum parallelism used for operators which haven't specified a maximum parallelism. The maximum parallelism specifies the upper limit for dynamic scaling and the number of key groups used for partitioned state.</td>\n         </tr>\n+        <tr>\n+            <td><h5>pipeline.name</h5></td>\n+            <td style=\"word-wrap: break-word;\">(none)</td>\n+            <td>String</td>\n+            <td>The name to display for the job.</td>", "originalCommit": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI2MDgwNA==", "url": "https://github.com/apache/flink/pull/14103#discussion_r530260804", "bodyText": "Update StreamExecutionEnvironment#configure as well.", "author": "twalthr", "createdAt": "2020-11-25T10:20:50Z", "path": "flink-streaming-java/src/main/java/org/apache/flink/streaming/api/environment/StreamExecutionEnvironment.java", "diffHunk": "@@ -1778,7 +1778,7 @@ private StateBackend loadStateBackend(ReadableConfig configuration, ClassLoader\n \t * @throws Exception which occurs during job execution.\n \t */\n \tpublic JobExecutionResult execute() throws Exception {", "originalCommit": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDI2NTk2Mw==", "url": "https://github.com/apache/flink/pull/14103#discussion_r530265963", "bodyText": "nit: simplify the test here and below to just use env.fromElements(1, 2, 3).print()", "author": "twalthr", "createdAt": "2020-11-25T10:28:48Z", "path": "flink-streaming-java/src/test/java/org/apache/flink/streaming/api/StreamExecutionEnvironmentTest.java", "diffHunk": "@@ -269,6 +271,27 @@ public void testGetStreamGraph() {\n \t\t}\n \t}\n \n+\t@Test\n+\tpublic void testDefaultJobName() {\n+\t\tStreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\n+\n+\t\tenv.fromCollection(new DummySplittableIterator<>(), BasicTypeInfo.INT_TYPE_INFO).addSink(new DiscardingSink<>());", "originalCommit": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM0NjEzNg==", "url": "https://github.com/apache/flink/pull/14103#discussion_r530346136", "bodyText": "Can't we just put the default name in the pipeline option? That way, it will also be rendered in the documentation.", "author": "aljoscha", "createdAt": "2020-11-25T12:44:03Z", "path": "flink-streaming-java/src/main/java/org/apache/flink/streaming/api/environment/StreamExecutionEnvironment.java", "diffHunk": "@@ -2330,4 +2330,8 @@ public void registerCachedFile(String filePath, String name, boolean executable)\n \t\t}\n \t\treturn (T) resolvedTypeInfo;\n \t}\n+\n+\tprivate String getJobName() {\n+\t\treturn configuration.getString(PipelineOptions.NAME, DEFAULT_JOB_NAME);", "originalCommit": "938cbb403a01e6d31cbc605a49f9baf7b3b9bf31", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM2NTA2Ng==", "url": "https://github.com/apache/flink/pull/14103#discussion_r530365066", "bodyText": "Are pipeline options also used in ExecutionEnvironment? The PR doesn't update this class but maybe it should? In that case Flink Streaming Job would be wrong.", "author": "twalthr", "createdAt": "2020-11-25T13:14:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM0NjEzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDczNDczNg==", "url": "https://github.com/apache/flink/pull/14103#discussion_r530734736", "bodyText": "Thanks all for the suggestions. @twalthr, I have checked that the pipeline options are also used in ExecutionEnvironment. I also don't notice that before, I will update it. The default name of ExecutionEnvironment is \"Flink Java Job at \" + Calendar.getInstance().getTime(), so the NAME option has no default value.", "author": "godfreyhe", "createdAt": "2020-11-26T02:14:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM0NjEzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc0NTI0Ng==", "url": "https://github.com/apache/flink/pull/14103#discussion_r530745246", "bodyText": "TableEnvironment also uses a different default name for the SQL query, e.g. insert-into_<sink-names>. So I think no default value makes more sense, that the default value is defined by different environment.", "author": "wuchong", "createdAt": "2020-11-26T02:55:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDM0NjEzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDg0NjQ0Ng==", "url": "https://github.com/apache/flink/pull/14103#discussion_r530846446", "bodyText": "This method must not be public and thus part of the API. You can call createProgramPlan().getJobName for testing.", "author": "twalthr", "createdAt": "2020-11-26T08:23:38Z", "path": "flink-java/src/main/java/org/apache/flink/api/java/ExecutionEnvironment.java", "diffHunk": "@@ -1122,12 +1125,14 @@ void registerDataSink(DataSink<?> sink) {\n \t}\n \n \t/**\n-\t * Gets a default job name, based on the timestamp when this method is invoked.\n+\t * Gets the job name. If user defined job name is not found in the configuration,\n+\t * the default name based on the timestamp when this method is invoked will return.\n \t *\n-\t * @return A default job name.\n+\t * @return A job name.\n \t */\n-\tprivate static String getDefaultName() {\n-\t\treturn \"Flink Java Job at \" + Calendar.getInstance().getTime();\n+\t@VisibleForTesting", "originalCommit": "cda47b16b8fa216fefb5399249026c2a54e907ed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b5d5336c50afe2aeab2acec4e6ae81be59f5f024", "url": "https://github.com/apache/flink/commit/b5d5336c50afe2aeab2acec4e6ae81be59f5f024", "message": "[FLINK-18545][configuration] Introduce `pipeline.name` to allow users to specify job name by configuration", "committedDate": "2020-11-26T09:30:25Z", "type": "commit"}, {"oid": "84daf24842f84ae2b07fa9fccef5a328bffc6029", "url": "https://github.com/apache/flink/commit/84daf24842f84ae2b07fa9fccef5a328bffc6029", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job", "committedDate": "2020-11-26T09:30:26Z", "type": "forcePushed"}, {"oid": "d4f8a0d979eaece7ead8530a9a02875443343373", "url": "https://github.com/apache/flink/commit/d4f8a0d979eaece7ead8530a9a02875443343373", "message": "[FLINK-18545][configuration] Allow users to specify job name by configuration in ExecutionEnvironment", "committedDate": "2020-11-26T11:38:56Z", "type": "commit"}, {"oid": "b0d0bd3c338dbd6afc109724730f021647582eac", "url": "https://github.com/apache/flink/commit/b0d0bd3c338dbd6afc109724730f021647582eac", "message": "[FLINK-18545][python] Specify job name by `pipeline.name` for flink-python", "committedDate": "2020-11-26T11:39:04Z", "type": "commit"}, {"oid": "1858bb1abcedf787cb83f77443298baf3afe63e0", "url": "https://github.com/apache/flink/commit/1858bb1abcedf787cb83f77443298baf3afe63e0", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job", "committedDate": "2020-11-26T11:39:04Z", "type": "commit"}, {"oid": "1858bb1abcedf787cb83f77443298baf3afe63e0", "url": "https://github.com/apache/flink/commit/1858bb1abcedf787cb83f77443298baf3afe63e0", "message": "[FLINK-18545][table] Specify job name by `pipeline.name` for sql job", "committedDate": "2020-11-26T11:39:04Z", "type": "forcePushed"}]}