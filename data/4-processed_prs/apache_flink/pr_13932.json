{"pr_number": 13932, "pr_title": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration for Print connector", "pr_createdAt": "2020-11-05T06:24:51Z", "pr_url": "https://github.com/apache/flink/pull/13932", "timeline": [{"oid": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "url": "https://github.com/apache/flink/commit/91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "message": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration to Print connector", "committedDate": "2020-12-09T12:10:16Z", "type": "commit"}, {"oid": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "url": "https://github.com/apache/flink/commit/91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "message": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration to Print connector", "committedDate": "2020-12-09T12:10:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1NzIxNQ==", "url": "https://github.com/apache/flink/pull/13932#discussion_r539957215", "bodyText": "Arrays.asList -> Collections.singletonList", "author": "fsk119", "createdAt": "2020-12-10T08:08:57Z", "path": "flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/runtime/stream/table/PrintConnectorITCase.java", "diffHunk": "@@ -77,6 +77,31 @@ public void testStandardError() throws Exception {\n \t\ttest(true);\n \t}\n \n+\t@Test\n+\tpublic void testWithParallelism() throws Exception {\n+\t\ttEnv().executeSql(\"create table print_t (\" +\n+\t\t\t\t\"f0 int,\" +\n+\t\t\t\t\"f1 double\" +\n+\t\t\t\t\") with (\" +\n+\t\t\t\t\"'connector' = 'print',\" +\n+\t\t\t\t\"'print-identifier' = 'test_print',\" +\n+\t\t\t\t\"'sink.parallelism' = '2',\" +\n+\t\t\t\t\"'standard-error'='false')\");\n+\t\tDataType type = tEnv().from(\"print_t\").getSchema().toRowDataType();\n+\t\tRow row = Row.of(1, 1.1);\n+\t\ttEnv().fromValues(type, Arrays.asList(row)).executeInsert(\"print_t\").await();", "originalCommit": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5464e35dc08ff8d326e298987998e26441b92d92", "url": "https://github.com/apache/flink/commit/5464e35dc08ff8d326e298987998e26441b92d92", "message": "fix test", "committedDate": "2020-12-10T08:13:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDc1MDQ5Ng==", "url": "https://github.com/apache/flink/pull/13932#discussion_r540750496", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tprivate final Integer parallelism;\n          \n          \n            \n            \t\tprivate final @Nullable Integer parallelism;\n          \n      \n    \n    \n  \n\nWould be better to add @Nullable annotation.\nSee the Flink Code Style Guideline: https://flink.apache.org/contributing/code-style-and-quality-java.html#java-optional", "author": "wuchong", "createdAt": "2020-12-11T07:45:59Z", "path": "flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/factories/PrintTableSinkFactory.java", "diffHunk": "@@ -95,19 +96,22 @@ public DynamicTableSink createDynamicTableSink(Context context) {\n \t\treturn new PrintSink(\n \t\t\t\tcontext.getCatalogTable().getSchema().toPhysicalRowDataType(),\n \t\t\t\toptions.get(PRINT_IDENTIFIER),\n-\t\t\t\toptions.get(STANDARD_ERROR));\n+\t\t\t\toptions.get(STANDARD_ERROR),\n+\t\t\t\toptions.getOptional(FactoryUtil.SINK_PARALLELISM).orElse(null));\n \t}\n \n \tprivate static class PrintSink implements DynamicTableSink {\n \n \t\tprivate final DataType type;\n \t\tprivate final String printIdentifier;\n \t\tprivate final boolean stdErr;\n+\t\tprivate final Integer parallelism;", "originalCommit": "5464e35dc08ff8d326e298987998e26441b92d92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "46501ddbb8fe78f1ae737862cd2f93d0ddc38793", "url": "https://github.com/apache/flink/commit/46501ddbb8fe78f1ae737862cd2f93d0ddc38793", "message": "Update flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/factories/PrintTableSinkFactory.java\n\nCo-authored-by: Jark Wu <imjark@gmail.com>", "committedDate": "2020-12-11T09:01:34Z", "type": "commit"}, {"oid": "c1701d79d8f06f5c35eea38ca5ec82723fcfd194", "url": "https://github.com/apache/flink/commit/c1701d79d8f06f5c35eea38ca5ec82723fcfd194", "message": "Update PrintTableSinkFactory.java\n\nadd import javax.annotation.Nullable;", "committedDate": "2020-12-16T04:04:27Z", "type": "commit"}]}