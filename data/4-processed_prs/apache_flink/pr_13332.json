{"pr_number": 13332, "pr_title": "[FLINK-19128][sql-client] Remove the runtime execution configuration in sql-client-defaults.yaml", "pr_createdAt": "2020-09-05T13:24:19Z", "pr_url": "https://github.com/apache/flink/pull/13332", "timeline": [{"oid": "f948fd6da8cc777fbfb588a49038b4aa4918160c", "url": "https://github.com/apache/flink/commit/f948fd6da8cc777fbfb588a49038b4aa4918160c", "message": "[FLINK-19128][sql-client] Remove the runtime execution configuration in sql-client-defaults.yaml", "committedDate": "2020-09-06T04:20:39Z", "type": "forcePushed"}, {"oid": "95d5e493cc42f0ddb02c4ab9d99203e765ad104b", "url": "https://github.com/apache/flink/commit/95d5e493cc42f0ddb02c4ab9d99203e765ad104b", "message": "[FLINK-19128][sql-client] Remove the runtime execution configuration in sql-client-defaults.yaml", "committedDate": "2020-09-06T04:22:46Z", "type": "commit"}, {"oid": "95d5e493cc42f0ddb02c4ab9d99203e765ad104b", "url": "https://github.com/apache/flink/commit/95d5e493cc42f0ddb02c4ab9d99203e765ad104b", "message": "[FLINK-19128][sql-client] Remove the runtime execution configuration in sql-client-defaults.yaml", "committedDate": "2020-09-06T04:22:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDEzNjU3Ng==", "url": "https://github.com/apache/flink/pull/13332#discussion_r490136576", "bodyText": "Do not remove entries for the existing test files. The options are still supported, so the tests are valid.\nPlease add a new testing yaml to verify the default behaivor.", "author": "wuchong", "createdAt": "2020-09-17T10:24:49Z", "path": "flink-table/flink-sql-client/src/test/resources/test-sql-client-defaults.yaml", "diffHunk": "@@ -137,19 +137,10 @@ catalogs:\n execution:\n   planner: \"$VAR_PLANNER\"\n   type: \"$VAR_EXECUTION_TYPE\"\n-  time-characteristic: event-time", "originalCommit": "95d5e493cc42f0ddb02c4ab9d99203e765ad104b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDEzNjcwMw==", "url": "https://github.com/apache/flink/pull/13332#discussion_r490136703", "bodyText": "What about only comment out (not remove) the parallelism and restart-strategy?\n\nUser can still easily enable them in the sql-client-defaults.yaml.\nIt seems that other options (time-characteristic, periodic-watermarks-interval, max-parallelism) override the default value of underlying pipeline configuraiton. So removing them may affect the SQL job behavior.\n\nBesides\nWe may also need to update org.apache.flink.table.client.config.entries.ExecutionEntry#getParallelism, it's hard coded to return a default value 1.", "author": "wuchong", "createdAt": "2020-09-17T10:25:01Z", "path": "flink-table/flink-sql-client/conf/sql-client-defaults.yaml", "diffHunk": "@@ -100,18 +100,10 @@ execution:\n   planner: blink\n   # 'batch' or 'streaming' execution\n   type: streaming\n-  # allow 'event-time' or only 'processing-time' in sources\n-  time-characteristic: event-time\n-  # interval in ms for emitting periodic watermarks\n-  periodic-watermarks-interval: 200\n   # 'changelog', 'table' or 'tableau' presentation of results\n   result-mode: table\n   # maximum number of maintained rows in 'table' presentation of results\n   max-table-result-rows: 1000000\n-  # parallelism of the program\n-  parallelism: 1", "originalCommit": "95d5e493cc42f0ddb02c4ab9d99203e765ad104b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "73a7458cb95aef63449e3827897fcccd83dca0e6", "url": "https://github.com/apache/flink/commit/73a7458cb95aef63449e3827897fcccd83dca0e6", "message": "[FLINK-19128][sql-client] Remove the runtime execution configuration in sql-client-defaults.yaml", "committedDate": "2020-09-18T06:03:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDczNjQxMg==", "url": "https://github.com/apache/flink/pull/13332#discussion_r490736412", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             # restart-strategy:\n          \n          \n            \n              # restart-strategy:", "author": "wuchong", "createdAt": "2020-09-18T06:47:14Z", "path": "flink-table/flink-sql-client/conf/sql-client-defaults.yaml", "diffHunk": "@@ -121,10 +121,10 @@ execution:\n   # current database of the current catalog (default database of the catalog by default)\n   current-database: default_database\n   # controls how table programs are restarted in case of a failures\n-  restart-strategy:\n+ # restart-strategy:", "originalCommit": "73a7458cb95aef63449e3827897fcccd83dca0e6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDczNzIxOQ==", "url": "https://github.com/apache/flink/pull/13332#discussion_r490737219", "bodyText": "We can keep only the exectuion entry, because all the others are not used.", "author": "wuchong", "createdAt": "2020-09-18T06:49:03Z", "path": "flink-table/flink-sql-client/src/test/resources/test-sql-client-execution.yaml", "diffHunk": "@@ -0,0 +1,152 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+#==============================================================================\n+# TEST ENVIRONMENT FILE\n+# General purpose default environment file.\n+#==============================================================================\n+\n+# this file has variables that can be filled with content by replacing $VAR_XXX\n+\n+tables:\n+  - name: TableNumber1\n+    type: source-table\n+    $VAR_UPDATE_MODE\n+    schema:\n+      - name: IntegerField1\n+        type: INT\n+      - name: StringField1\n+        type: VARCHAR\n+      - name: TimestampField1\n+        type: TIMESTAMP\n+    connector:\n+      type: filesystem\n+      path: \"$VAR_SOURCE_PATH1\"\n+    format:\n+      type: csv\n+      fields:\n+        - name: IntegerField1\n+          type: INT\n+        - name: StringField1\n+          type: VARCHAR\n+        - name: TimestampField1\n+          type: TIMESTAMP\n+      line-delimiter: \"\\n\"\n+      comment-prefix: \"#\"\n+  - name: TestView1\n+    type: view\n+    query: SELECT scalarUDF(IntegerField1) FROM TableNumber1\n+  - name: TableNumber2\n+    # Test backwards compatibility (\"source\" -> \"source-table\")\n+    type: source\n+    $VAR_UPDATE_MODE\n+    schema:\n+      - name: IntegerField2\n+        type: INT\n+      - name: StringField2\n+        type: VARCHAR\n+      - name: TimestampField2\n+        type: TIMESTAMP\n+    connector:\n+      type: filesystem\n+      path: \"$VAR_SOURCE_PATH2\"\n+    format:\n+      type: csv\n+      fields:\n+        - name: IntegerField2\n+          type: INT\n+        - name: StringField2\n+          type: VARCHAR\n+        - name: TimestampField2\n+          type: TIMESTAMP\n+      line-delimiter: \"\\n\"\n+      comment-prefix: \"#\"\n+  - name: TableSourceSink\n+    type: source-sink-table\n+    $VAR_UPDATE_MODE\n+    schema:\n+      - name: BooleanField\n+        type: BOOLEAN\n+      - name: StringField\n+        type: VARCHAR\n+      - name: TimestampField\n+        type: TIMESTAMP\n+    connector:\n+      type: filesystem\n+      path: \"$VAR_SOURCE_SINK_PATH\"\n+    format:\n+      type: csv\n+      fields:\n+        - name: BooleanField\n+          type: BOOLEAN\n+        - name: StringField\n+          type: VARCHAR\n+        - name: TimestampField\n+          type: TIMESTAMP\n+  - name: TestView2\n+    type: view\n+    query: SELECT * FROM TestView1\n+\n+functions:\n+  - name: scalarUDF\n+    from: class\n+    class: org.apache.flink.table.client.gateway.utils.UserDefinedFunctions$ScalarUDF\n+    constructor:\n+      - 5\n+  - name: aggregateUDF\n+    from: class\n+    class: org.apache.flink.table.client.gateway.utils.UserDefinedFunctions$AggregateUDF\n+    constructor:\n+      - StarryName\n+      - false\n+      - class: java.lang.Integer\n+        constructor:\n+          - class: java.lang.String\n+            constructor:\n+              - type: VARCHAR\n+                value: 3\n+  - name: tableUDF\n+    from: class\n+    class: org.apache.flink.table.client.gateway.utils.UserDefinedFunctions$TableUDF\n+    constructor:\n+      - type: LONG\n+        value: 5\n+\n+catalogs:\n+  - name: catalog1\n+    type: DependencyTest\n+  - name: simple-catalog\n+    type: simple-catalog\n+    test-table: test-table\n+\n+execution:", "originalCommit": "73a7458cb95aef63449e3827897fcccd83dca0e6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8f1ae1192b3809aac8728de1bdb9d5c6bce36f9a", "url": "https://github.com/apache/flink/commit/8f1ae1192b3809aac8728de1bdb9d5c6bce36f9a", "message": "[FLINK-19128][sql-client] Remove the runtime execution configuration in sql-client-defaults.yaml", "committedDate": "2020-09-18T07:12:27Z", "type": "commit"}]}