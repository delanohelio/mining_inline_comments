{"pr_number": 11626, "pr_title": "[FLINK-16961] Bump Netty 4.X to 4.1.44", "pr_createdAt": "2020-04-03T08:54:36Z", "pr_url": "https://github.com/apache/flink/pull/11626", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA1Mjc1NQ==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404052755", "bodyText": "Why don't we upgrade right away to 4.1.48.final?", "author": "tillrohrmann", "createdAt": "2020-04-06T12:30:13Z", "path": "flink-connectors/flink-connector-elasticsearch5/pom.xml", "diffHunk": "@@ -82,6 +82,55 @@ under the License.\n \t\t\t<version>${elasticsearch.version}</version>\n \t\t</dependency>\n \n+\t\t<dependency>\n+\t\t\t<!-- Bump elasticsearch netty dependency -->\n+\t\t\t<groupId>io.netty</groupId>\n+\t\t\t<artifactId>netty-buffer</artifactId>\n+\t\t\t<version>4.1.44.Final</version>", "originalCommit": "3fa65369922f1bcbba5660e0e55a3c022a389408", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE5NzE2Nw==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404197167", "bodyText": "Smallest required jump.", "author": "zentol", "createdAt": "2020-04-06T15:48:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA1Mjc1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYyMDczNw==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404620737", "bodyText": "Hmm ok. I was just thinking if already do the effort to upgrade why not trying the latest version. But on the other hand, it might cause more problems.", "author": "tillrohrmann", "createdAt": "2020-04-07T08:14:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA1Mjc1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA1NjI2NA==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404056264", "bodyText": "Same here, why not 4.1.48.final?", "author": "tillrohrmann", "createdAt": "2020-04-06T12:36:34Z", "path": "flink-connectors/flink-hbase/pom.xml", "diffHunk": "@@ -210,6 +210,13 @@ under the License.\n \t\t\t</exclusions>\n \t\t</dependency>\n \n+\t\t<dependency>\n+\t\t\t<!-- Bump hbase netty dependency -->\n+\t\t\t<groupId>io.netty</groupId>\n+\t\t\t<artifactId>netty-all</artifactId>\n+\t\t\t<version>4.1.44.Final</version>", "originalCommit": "c7763b2da1a287e092939f573a901300d54ab10c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2MzA2Nw==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404063067", "bodyText": "io.netty:netty-resolver:jar:4.1.44.Final is missing", "author": "tillrohrmann", "createdAt": "2020-04-06T12:47:48Z", "path": "flink-connectors/flink-connector-cassandra/src/main/resources/META-INF/NOTICE", "diffHunk": "@@ -9,8 +9,8 @@ This project bundles the following dependencies under the Apache Software Licens\n - com.datastax.cassandra:cassandra-driver-core:3.0.0\n - com.datastax.cassandra:cassandra-driver-mapping:3.0.0\n - com.google.guava:guava:18.0\n-- io.netty:netty-handler:4.0.33.Final\n-- io.netty:netty-buffer:4.0.33.Final\n-- io.netty:netty-common:4.0.33.Final\n-- io.netty:netty-transport:4.0.33.Final\n-- io.netty:netty-codec:4.0.33.Final\n+- io.netty:netty-handler:4.1.44.Final\n+- io.netty:netty-buffer:4.1.44.Final\n+- io.netty:netty-common:4.1.44.Final\n+- io.netty:netty-transport:4.1.44.Final\n+- io.netty:netty-codec:4.1.44.Final", "originalCommit": "3764d88e58021ea3d68b5d9aecb0717f94ad4602", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE5NjkyNw==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404196927", "bodyText": "I don't see netty-resolver in the dependency or shade-plugin output.", "author": "zentol", "createdAt": "2020-04-06T15:47:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2MzA2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYyNTM1OQ==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404625359", "bodyText": "netty-transport  has a compile time dependency. Hence it should be included in the final artifact: https://mvnrepository.com/artifact/io.netty/netty-transport/4.1.44.Final", "author": "tillrohrmann", "createdAt": "2020-04-07T08:21:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2MzA2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY1MjE5Mw==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404652193", "bodyText": "ah, i see it now. I must've checked on the wrong branch.", "author": "zentol", "createdAt": "2020-04-07T09:03:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2MzA2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2NTAxNA==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404065014", "bodyText": "Why is it ok to use these older Netty dependencies?", "author": "tillrohrmann", "createdAt": "2020-04-06T12:51:10Z", "path": "flink-python/src/main/resources/META-INF/NOTICE", "diffHunk": "@@ -20,13 +20,13 @@ This project bundles the following dependencies under the Apache Software Licens\n - io.grpc:grpc-protobuf:1.21.0\n - io.grpc:grpc-stub:1.21.0\n - io.grpc:grpc-testing:1.21.0\n-- io.netty:netty-buffer:4.1.27.Final\n+- io.netty:netty-buffer:4.1.44.Final\n - io.netty:netty-buffer:4.1.34.Final\n - io.netty:netty-codec:4.1.34.Final\n - io.netty:netty-codec-http:4.1.34.Final\n - io.netty:netty-codec-http2:4.1.34.Final\n - io.netty:netty-codec-socks:4.1.34.Final\n-- io.netty:netty-common:4.1.27.Final\n+- io.netty:netty-common:4.1.44.Final\n - io.netty:netty-common:4.1.34.Final\n - io.netty:netty-handler:4.1.34.Final\n - io.netty:netty-handler-proxy:4.1.34.Final", "originalCommit": "10cea4c8ba6756ac31de11a5a6728a5dfc41d9c4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE5MzYzMg==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404193632", "bodyText": "These are bundled in beam-vendor-grpc-1_21_0, and I have no idea how/whether we can update these.", "author": "zentol", "createdAt": "2020-04-06T15:43:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2NTAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE5NDQxNg==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404194416", "bodyText": "I did ignore them tho and had to do some research first, good job pointing them out. \ud83d\udc4d", "author": "zentol", "createdAt": "2020-04-06T15:44:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2NTAxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2NjE1Ng==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404066156", "bodyText": "Help me again. Why do we need these exclusions? Wouldn't they be overridden by the explicit Netty dependencies which are closer to the root?", "author": "tillrohrmann", "createdAt": "2020-04-06T12:53:06Z", "path": "flink-connectors/flink-connector-hive/pom.xml", "diffHunk": "@@ -934,6 +934,42 @@ under the License.\n \t\t\t\t<hive.version>3.1.1</hive.version>\n \t\t\t</properties>\n \n+\t\t\t<dependencies>\n+\t\t\t\t<dependency>\n+\t\t\t\t\t<groupId>org.apache.hive</groupId>\n+\t\t\t\t\t<artifactId>hive-metastore</artifactId>\n+\t\t\t\t\t<version>${hive.version}</version>\n+\t\t\t\t\t<scope>provided</scope>\n+\t\t\t\t\t<exclusions>\n+\t\t\t\t\t\t<exclusion>\n+\t\t\t\t\t\t\t<!-- Override arrow netty dependency -->\n+\t\t\t\t\t\t\t<groupId>io.netty</groupId>\n+\t\t\t\t\t\t\t<artifactId>netty-buffer</artifactId>\n+\t\t\t\t\t\t</exclusion>\n+\t\t\t\t\t\t<exclusion>\n+\t\t\t\t\t\t\t<!-- Override arrow netty dependency -->\n+\t\t\t\t\t\t\t<groupId>io.netty</groupId>\n+\t\t\t\t\t\t\t<artifactId>netty-common</artifactId>\n+\t\t\t\t\t\t</exclusion>\n+\t\t\t\t\t</exclusions>", "originalCommit": "da804e87116667886ab9f47a859152d590a3203f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE3MDcwNg==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404170706", "bodyText": "the dependency convergence complains because we did not explicitly handle the mismatch.", "author": "zentol", "createdAt": "2020-04-06T15:13:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2NjE1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYyNTc2OA==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404625768", "bodyText": "I see. Thanks for the info.", "author": "tillrohrmann", "createdAt": "2020-04-07T08:22:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2NjE1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2OTA0OQ==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404069049", "bodyText": "I couldn't really see that these pom entries have an effect on mvn dependency:tree. It looks as if this module does not have a netty-common and netty-buffer dependency.", "author": "tillrohrmann", "createdAt": "2020-04-06T12:57:45Z", "path": "flink-connectors/flink-connector-hive/pom.xml", "diffHunk": "@@ -934,6 +934,42 @@ under the License.\n \t\t\t\t<hive.version>3.1.1</hive.version>\n \t\t\t</properties>\n \n+\t\t\t<dependencies>\n+\t\t\t\t<dependency>\n+\t\t\t\t\t<groupId>org.apache.hive</groupId>\n+\t\t\t\t\t<artifactId>hive-metastore</artifactId>\n+\t\t\t\t\t<version>${hive.version}</version>\n+\t\t\t\t\t<scope>provided</scope>\n+\t\t\t\t\t<exclusions>\n+\t\t\t\t\t\t<exclusion>\n+\t\t\t\t\t\t\t<!-- Override arrow netty dependency -->\n+\t\t\t\t\t\t\t<groupId>io.netty</groupId>\n+\t\t\t\t\t\t\t<artifactId>netty-buffer</artifactId>\n+\t\t\t\t\t\t</exclusion>\n+\t\t\t\t\t\t<exclusion>\n+\t\t\t\t\t\t\t<!-- Override arrow netty dependency -->\n+\t\t\t\t\t\t\t<groupId>io.netty</groupId>\n+\t\t\t\t\t\t\t<artifactId>netty-common</artifactId>\n+\t\t\t\t\t\t</exclusion>\n+\t\t\t\t\t</exclusions>\n+\t\t\t\t</dependency>\n+\t\t\t\t<dependency>\n+\t\t\t\t\t<!-- Bump arrow netty dependency -->\n+\t\t\t\t\t<groupId>io.netty</groupId>\n+\t\t\t\t\t<artifactId>netty-buffer</artifactId>\n+\t\t\t\t\t<version>4.1.44.Final</version>\n+\t\t\t\t\t<scope>provided</scope>\n+\t\t\t\t</dependency>\n+\n+\t\t\t\t<dependency>\n+\t\t\t\t\t<!-- Bump arrow netty dependency -->\n+\t\t\t\t\t<groupId>io.netty</groupId>\n+\t\t\t\t\t<artifactId>netty-common</artifactId>\n+\t\t\t\t\t<version>4.1.44.Final</version>\n+\t\t\t\t\t<scope>provided</scope>\n+\t\t\t\t</dependency>\n+\t\t\t</dependencies>", "originalCommit": "da804e87116667886ab9f47a859152d590a3203f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDE3MDk5Ng==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404170996", "bodyText": "did you activate the hive-3.1.1 profile?", "author": "zentol", "createdAt": "2020-04-06T15:14:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2OTA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYyMTUxNg==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404621516", "bodyText": "No I did not. If this explains then I guess it is correct.", "author": "tillrohrmann", "createdAt": "2020-04-07T08:15:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2OTA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYzNTY1NQ==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404635655", "bodyText": "This dependencies block is in the hive-3.1.1 profile, so it is kinda important ;)", "author": "zentol", "createdAt": "2020-04-07T08:37:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2OTA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY1NDY5OQ==", "url": "https://github.com/apache/flink/pull/11626#discussion_r404654699", "bodyText": "Seems to be correct given mvn dependency:tree -Phive-3.1.1.", "author": "tillrohrmann", "createdAt": "2020-04-07T09:07:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDA2OTA0OQ=="}], "type": "inlineReview"}, {"oid": "af041c17e2d2856715dd4482df68533db0e4cd19", "url": "https://github.com/apache/flink/commit/af041c17e2d2856715dd4482df68533db0e4cd19", "message": "[FLINK-16961][es] Bump Netty to 4.1.44", "committedDate": "2020-04-14T08:43:02Z", "type": "commit"}, {"oid": "f2842ea1f63a556ed840ca0ad25db1e7451febd6", "url": "https://github.com/apache/flink/commit/f2842ea1f63a556ed840ca0ad25db1e7451febd6", "message": "[FLINK-16961][hbase] Bump Netty to 4.1.44", "committedDate": "2020-04-14T08:43:02Z", "type": "commit"}, {"oid": "cd7ed5e40cbead92b53e8ab6149b973f412e1973", "url": "https://github.com/apache/flink/commit/cd7ed5e40cbead92b53e8ab6149b973f412e1973", "message": "[FLINK-16961][cassandra] Bump Netty to 4.1.44", "committedDate": "2020-04-14T08:43:02Z", "type": "commit"}, {"oid": "476a80a88be7a5aad4b35bf7ad00d904bac79400", "url": "https://github.com/apache/flink/commit/476a80a88be7a5aad4b35bf7ad00d904bac79400", "message": "[FLINK-16961][python] Bump Netty to 4.1.44", "committedDate": "2020-04-14T08:43:03Z", "type": "commit"}, {"oid": "c0773498a357fe14c97770ee45f66b3faa42c4ca", "url": "https://github.com/apache/flink/commit/c0773498a357fe14c97770ee45f66b3faa42c4ca", "message": "[FLINK-16961][hive] Bump Netty to 4.1.44", "committedDate": "2020-04-14T08:43:03Z", "type": "commit"}, {"oid": "c0773498a357fe14c97770ee45f66b3faa42c4ca", "url": "https://github.com/apache/flink/commit/c0773498a357fe14c97770ee45f66b3faa42c4ca", "message": "[FLINK-16961][hive] Bump Netty to 4.1.44", "committedDate": "2020-04-14T08:43:03Z", "type": "forcePushed"}]}