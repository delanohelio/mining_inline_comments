{"pr_number": 11511, "pr_title": "[FLINK-16771][table-planner-blink] NPE when filtering by decimal column", "pr_createdAt": "2020-03-25T13:14:40Z", "pr_url": "https://github.com/apache/flink/pull/11511", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTAwNzgzMw==", "url": "https://github.com/apache/flink/pull/11511#discussion_r399007833", "bodyText": "Can this reproduce by expression test?", "author": "JingsongLi", "createdAt": "2020-03-27T02:55:32Z", "path": "flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/api/TableEnvironmentITCase.scala", "diffHunk": "@@ -273,6 +276,18 @@ class TableEnvironmentITCase(tableEnvName: String, isStreaming: Boolean) {\n     tableEnv.execute(\"insert dest2\")\n   }\n \n+  @Test\n+  def testCompareDecimalColWithNull(): Unit = {", "originalCommit": "e8d83deb718fc09cf49e63ffefddf2ce5de444ed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTAwODM2Mw==", "url": "https://github.com/apache/flink/pull/11511#discussion_r399008363", "bodyText": "Just generateLiteral?", "author": "JingsongLi", "createdAt": "2020-03-27T02:57:32Z", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/GenerateUtils.scala", "diffHunk": "@@ -346,7 +346,11 @@ object GenerateUtils {\n         ctx.addReusableMember(fieldDecimal)\n         val value = Decimal.fromBigDecimal(\n           literalValue.asInstanceOf[JBigDecimal], precision, scale)\n-        generateNonNullLiteral(literalType, fieldTerm, value)\n+        if (value == null) {", "originalCommit": "e8d83deb718fc09cf49e63ffefddf2ce5de444ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTAxMDQ2OA==", "url": "https://github.com/apache/flink/pull/11511#discussion_r399010468", "bodyText": "That won't work because we expect a decimal literal to be a BigDecimal. But now the value has been casted to a Decimal .", "author": "lirui-apache", "createdAt": "2020-03-27T03:05:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTAwODM2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTAxMTI3MQ==", "url": "https://github.com/apache/flink/pull/11511#discussion_r399011271", "bodyText": "So we should improve generateLiteral, and I think maybe this is risk in it too.", "author": "JingsongLi", "createdAt": "2020-03-27T03:09:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTAwODM2Mw=="}], "type": "inlineReview"}, {"oid": "8f0907a91598b9cb7e4e7492ee891fcdae9d8fd8", "url": "https://github.com/apache/flink/commit/8f0907a91598b9cb7e4e7492ee891fcdae9d8fd8", "message": "[FLINK-16771][table-planner-blink] NPE when filtering by decimal column", "committedDate": "2020-04-10T10:18:16Z", "type": "commit"}, {"oid": "f28c034ca66bf8142bcfd220aefdb96487c2d9fe", "url": "https://github.com/apache/flink/commit/f28c034ca66bf8142bcfd220aefdb96487c2d9fe", "message": "address comment", "committedDate": "2020-04-10T10:18:16Z", "type": "commit"}, {"oid": "f28c034ca66bf8142bcfd220aefdb96487c2d9fe", "url": "https://github.com/apache/flink/commit/f28c034ca66bf8142bcfd220aefdb96487c2d9fe", "message": "address comment", "committedDate": "2020-04-10T10:18:16Z", "type": "forcePushed"}]}