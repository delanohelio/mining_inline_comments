{"pr_number": 11424, "pr_title": "[FLINK-16345][table-planner-blink] Fix computed column can not refer row time attribute column", "pr_createdAt": "2020-03-17T03:46:37Z", "pr_url": "https://github.com/apache/flink/pull/11424", "timeline": [{"oid": "a891d89757f7432a095de20c361faeee98f31ff6", "url": "https://github.com/apache/flink/commit/a891d89757f7432a095de20c361faeee98f31ff6", "message": "[FLINK-16345][table-planner-blink] Fix computed column can not refer row time attribute column", "committedDate": "2020-03-17T03:42:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ0NjMyNQ==", "url": "https://github.com/apache/flink/pull/11424#discussion_r393446325", "bodyText": "I think the right place to fix is the SqlToOperationConverter#createTableSchema, before we make the computed column type inference, the time attribute should be patched up based on the watermark definitions.", "author": "danny0405", "createdAt": "2020-03-17T05:02:35Z", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "diffHunk": "@@ -106,7 +111,7 @@ class CatalogSourceTable[T](\n     val toRexFactory = flinkContext.getSqlExprToRexConverterFactory\n \n     // 2. push computed column project\n-    val fieldNames = rowType.getFieldNames.asScala\n+    val fieldNames = erasedRowType.getFieldNames.asScala", "originalCommit": "a891d89757f7432a095de20c361faeee98f31ff6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTU3OTkwOA==", "url": "https://github.com/apache/flink/pull/11424#discussion_r395579908", "bodyText": "After an offline discussion with @danny0405 , we reached an consensus that erasing time indicators in CatalogSourceTable#toRel is the only way to fix this for now. So we will keep the current implementation in PR.", "author": "wuchong", "createdAt": "2020-03-20T11:34:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQ0NjMyNQ=="}], "type": "inlineReview"}]}