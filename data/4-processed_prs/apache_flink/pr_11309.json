{"pr_number": 11309, "pr_title": "[FLINK-16378][AZP] Disable Docker tests when running with JDK11", "pr_createdAt": "2020-03-04T12:39:57Z", "pr_url": "https://github.com/apache/flink/pull/11309", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY4MDE0Ng==", "url": "https://github.com/apache/flink/pull/11309#discussion_r387680146", "bodyText": "I would refrain from excluding this test until we have a confirmation that this is indeed java 11 related and some numbers of how reliably it fails.", "author": "zentol", "createdAt": "2020-03-04T13:55:01Z", "path": "flink-end-to-end-tests/run-nightly-tests.sh", "diffHunk": "@@ -187,8 +186,6 @@ run_test \"TPC-DS end-to-end test (Blink planner)\" \"$END_TO_END_DIR/test-scripts/\n \n run_test \"Heavy deployment end-to-end test\" \"$END_TO_END_DIR/test-scripts/test_heavy_deployment.sh\" \"skip_check_exceptions\"\n \n-run_test \"ConnectedComponents iterations with high parallelism end-to-end test\" \"$END_TO_END_DIR/test-scripts/test_high_parallelism_iterations.sh 25\"", "originalCommit": "51918c217b36034a388528e56a0fa6cc1be69ad2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY5MDg4NA==", "url": "https://github.com/apache/flink/pull/11309#discussion_r387690884", "bodyText": "I can not remember having seen this failure on jdk8 ... In the last 48 hours, I have changed my policy to creating tickets for each test failure I see.\nHow many successful executions on master is proof enough that the test is stable on jdk8? (I propose 10)\nHow long should I keep the JIRA ticket open until we believe it is a jdk11 only issue? (I propose a week)\nIf we are not excluding this test for the JDK11 build, we won't have e2e coverage for jdk11 for everything that comes after.", "author": "rmetzger", "createdAt": "2020-03-04T14:13:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY4MDE0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg0MjE5Mg==", "url": "https://github.com/apache/flink/pull/11309#discussion_r387842192", "bodyText": "This test has always been incredibly flaky, that's why I advise against rash calls.\nTrivial solution for preventing other tests from running in case of failures is to move it to the end of the script.", "author": "zentol", "createdAt": "2020-03-04T18:09:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY4MDE0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg0MjU0OA==", "url": "https://github.com/apache/flink/pull/11309#discussion_r387842548", "bodyText": "naturally if you can show that it is reproducible on java 11 then we can of course disable it.", "author": "zentol", "createdAt": "2020-03-04T18:10:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY4MDE0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODEzOTI5NA==", "url": "https://github.com/apache/flink/pull/11309#discussion_r388139294", "bodyText": "Looks like I am able to fix the test on JDK11: https://issues.apache.org/jira/browse/FLINK-16417", "author": "rmetzger", "createdAt": "2020-03-05T08:26:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY4MDE0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY4MTM5OQ==", "url": "https://github.com/apache/flink/pull/11309#discussion_r387681399", "bodyText": "should be a separate commit, and possibly even JIRA.", "author": "zentol", "createdAt": "2020-03-04T13:57:06Z", "path": "tools/azure-pipelines/jobs-template.yml", "diffHunk": "@@ -161,6 +161,6 @@ jobs:\n     # TODO remove pre-commit tests script by adding the tests to the nightly script\n #    - script: FLINK_DIR=build-target ./flink-end-to-end-tests/run-pre-commit-tests.sh\n #      displayName: Test - precommit \n-    - script: FLINK_DIR=`pwd`/build-target flink-end-to-end-tests/run-nightly-tests.sh\n+    - script: ${{parameters.environment}} FLINK_DIR=`pwd`/build-target flink-end-to-end-tests/run-nightly-tests.sh", "originalCommit": "51918c217b36034a388528e56a0fa6cc1be69ad2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY5MTcwMQ==", "url": "https://github.com/apache/flink/pull/11309#discussion_r387691701", "bodyText": "Why?\nWhat this does is passing the PROFILE variable to the script. This is necessary for deciding whether we are in a jdk11 setting or not. ... I see a clear relationship to the title of the JIRA I'm working on.", "author": "rmetzger", "createdAt": "2020-03-04T14:14:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY4MTM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg0MTAyMQ==", "url": "https://github.com/apache/flink/pull/11309#discussion_r387841021", "bodyText": "because the script was already relying on this being set for the avro schema registry. This fixes a bug, it's not an improvement.", "author": "zentol", "createdAt": "2020-03-04T18:07:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzY4MTM5OQ=="}], "type": "inlineReview"}, {"oid": "c7c0c94488612a9c4e5bce6778405a45ded86f9e", "url": "https://github.com/apache/flink/commit/c7c0c94488612a9c4e5bce6778405a45ded86f9e", "message": "[FLINK-16431][AZP] Pass build profile into end to end test script on Azure", "committedDate": "2020-03-05T08:30:59Z", "type": "commit"}, {"oid": "5b6f97541ccc99a1f9cfbc5c2960277910519609", "url": "https://github.com/apache/flink/commit/5b6f97541ccc99a1f9cfbc5c2960277910519609", "message": "[FLINK-16378][AZP] Disable Docker tests when running with JDK11", "committedDate": "2020-03-05T08:31:04Z", "type": "commit"}, {"oid": "5b6f97541ccc99a1f9cfbc5c2960277910519609", "url": "https://github.com/apache/flink/commit/5b6f97541ccc99a1f9cfbc5c2960277910519609", "message": "[FLINK-16378][AZP] Disable Docker tests when running with JDK11", "committedDate": "2020-03-05T08:31:04Z", "type": "forcePushed"}]}