{"pr_number": 11387, "pr_title": "[FLINK-16343][table-planner-blink] Improve exception message when reading an unbounded source in batch mode", "pr_createdAt": "2020-03-12T03:47:54Z", "pr_url": "https://github.com/apache/flink/pull/11387", "timeline": [{"oid": "4101781e56c504d53168042efa996215b7d9d7bb", "url": "https://github.com/apache/flink/commit/4101781e56c504d53168042efa996215b7d9d7bb", "message": "[FLINK-16343][table-planner-blink] Improve exception message when reading an unbounded source in batch mode", "committedDate": "2020-03-12T03:47:42Z", "type": "commit"}, {"oid": "b92a95ede6d30f98203c696c58d17dca9069a940", "url": "https://github.com/apache/flink/commit/b92a95ede6d30f98203c696c58d17dca9069a940", "message": "Fix PartitionableSinkITCase.testStaticPartitionNotInPartitionFields because sinkTable2 is unbounded", "committedDate": "2020-03-12T06:02:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ0NjQxNg==", "url": "https://github.com/apache/flink/pull/11387#discussion_r391446416", "bodyText": "Using match case?", "author": "JingsongLi", "createdAt": "2020-03-12T07:45:17Z", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "diffHunk": "@@ -164,10 +164,21 @@ class CatalogSourceTable[T](\n     } else {\n       TableFactoryUtil.findAndCreateTableSource(context)\n     }\n+\n     if (!tableSource.isInstanceOf[StreamTableSource[_]]) {", "originalCommit": "b92a95ede6d30f98203c696c58d17dca9069a940", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ0NjUzMw==", "url": "https://github.com/apache/flink/pull/11387#discussion_r391446533", "bodyText": "Why not add this to BatchExecTableSourceScanRule?", "author": "JingsongLi", "createdAt": "2020-03-12T07:45:35Z", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "diffHunk": "@@ -164,10 +164,21 @@ class CatalogSourceTable[T](\n     } else {\n       TableFactoryUtil.findAndCreateTableSource(context)\n     }\n+\n     if (!tableSource.isInstanceOf[StreamTableSource[_]]) {\n       throw new TableException(\"Catalog tables support only \"\n         + \"StreamTableSource and InputFormatTableSource\")\n     }\n+\n+    // validate TableSource when it is in batch mode\n+    if (!schemaTable.isStreamingMode) {", "originalCommit": "b92a95ede6d30f98203c696c58d17dca9069a940", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ5OTMzOQ==", "url": "https://github.com/apache/flink/pull/11387#discussion_r391499339", "bodyText": "My initial thought is \"fail-fast\", throw the exception at ealier stage, just like the above validation which only allows StreamTableSource and InputFormatTableSource.", "author": "wuchong", "createdAt": "2020-03-12T09:38:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ0NjUzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQ0NzIzNg==", "url": "https://github.com/apache/flink/pull/11387#discussion_r391447236", "bodyText": "Can just use && to one if", "author": "JingsongLi", "createdAt": "2020-03-12T07:47:27Z", "path": "flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala", "diffHunk": "@@ -164,10 +164,21 @@ class CatalogSourceTable[T](\n     } else {\n       TableFactoryUtil.findAndCreateTableSource(context)\n     }\n+\n     if (!tableSource.isInstanceOf[StreamTableSource[_]]) {\n       throw new TableException(\"Catalog tables support only \"\n         + \"StreamTableSource and InputFormatTableSource\")\n     }\n+\n+    // validate TableSource when it is in batch mode\n+    if (!schemaTable.isStreamingMode) {", "originalCommit": "b92a95ede6d30f98203c696c58d17dca9069a940", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d0406a0f225c74107a63046068fe9a97010bbf92", "url": "https://github.com/apache/flink/commit/d0406a0f225c74107a63046068fe9a97010bbf92", "message": "address review comments.", "committedDate": "2020-03-12T09:40:23Z", "type": "commit"}]}