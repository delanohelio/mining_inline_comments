{"pr_number": 13374, "pr_title": "[FLINK-19109][streaming] Disallow chaining of ContinuousFileReaderOperator. [1.10]", "pr_createdAt": "2020-09-11T15:36:10Z", "pr_url": "https://github.com/apache/flink/pull/13374", "timeline": [{"oid": "858ce532bd1800cb354ae304296db67764aad433", "url": "https://github.com/apache/flink/commit/858ce532bd1800cb354ae304296db67764aad433", "message": "[FLINK-19109][streaming] Disallow chaining of ContinuousFileReaderOperator.\n\nWhen CFRO is not actively reading from a split, its inside some poll loop where no mail is being processed. Hence, downstream operators cannot rely on processing timers among other things being reliably triggered.", "committedDate": "2020-09-11T17:19:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzUwNDQ4NQ==", "url": "https://github.com/apache/flink/pull/13374#discussion_r487504485", "bodyText": "I think this should be mentioned in the release notes on this branch (that since 1.10.X, we disabled chaining because of yadayadayada).", "author": "pnowojski", "createdAt": "2020-09-13T09:19:32Z", "path": "flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/ContinuousFileReaderOperator.java", "diffHunk": "@@ -80,6 +81,7 @@\n \n \tpublic ContinuousFileReaderOperator(FileInputFormat<OUT> format) {\n \t\tthis.format = checkNotNull(format);\n+\t\tsetChainingStrategy(ChainingStrategy.NEVER);", "originalCommit": "858ce532bd1800cb354ae304296db67764aad433", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6dabc37d6420693963132b6458419ecb15c14ed6", "url": "https://github.com/apache/flink/commit/6dabc37d6420693963132b6458419ecb15c14ed6", "message": "[temp] Executing e2e tests.", "committedDate": "2020-09-14T18:20:10Z", "type": "forcePushed"}, {"oid": "55ac4dabaa1841941b8b33c11511fac8dd729289", "url": "https://github.com/apache/flink/commit/55ac4dabaa1841941b8b33c11511fac8dd729289", "message": "[FLINK-19109][streaming] Disallow chaining of ContinuousFileReaderOperator.\n\nWhen CFRO is not actively reading from a split, its inside some poll loop where no mail is being processed. Hence, downstream operators cannot rely on processing timers among other things being reliably triggered.", "committedDate": "2020-09-15T12:41:58Z", "type": "forcePushed"}, {"oid": "28214151caa049da65115b9fb87ac028254a0bc2", "url": "https://github.com/apache/flink/commit/28214151caa049da65115b9fb87ac028254a0bc2", "message": "[temp] Executing e2e tests.", "committedDate": "2020-09-15T12:42:10Z", "type": "forcePushed"}, {"oid": "7e1f8916c7c4fa73cdf51e04a7b172f4da7d1977", "url": "https://github.com/apache/flink/commit/7e1f8916c7c4fa73cdf51e04a7b172f4da7d1977", "message": "[temp] Executing e2e tests.", "committedDate": "2020-09-15T12:59:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM0Nzg5MA==", "url": "https://github.com/apache/flink/pull/13374#discussion_r489347890", "bodyText": "1.11.2", "author": "pnowojski", "createdAt": "2020-09-16T10:56:03Z", "path": "docs/release-notes/flink-1.10.md", "diffHunk": "@@ -468,3 +468,9 @@ deprecated in favor of `RocksDBOptionsFactory` and\n #### Incompatibility of serialized JobGraphs ([FLINK-14594](https://issues.apache.org/jira/browse/FLINK-14594))\n Serialized `JobGraphs` which set the `ResourceSpec` created by Flink versions < `1.10` are no longer compatible with Flink >= `1.10`. \n If you want to migrate these jobs to Flink >= `1.10` you will have to stop the job with a savepoint and then resume it from this savepoint on the Flink >= `1.10` cluster.\n+\n+#### Disabled chaining of file reading through ContinuousFileReaderOperator (1.10.3).\n+     \n+Any `readFile` or `readTextFile` of `DataStream` creates a `ContinuousFileReaderOperator` that used to be chained to subsequent operators.\n+However, chained operator do not trigger processing time timers correctly, leading to bugs in watermark assigners (FLINK-19109). As a workaround,\n+chaining of `ContinuousFileReaderOperator` is disabled. Flink 1.11.1 and later fixes the underlying problem and re-allows chaining. ", "originalCommit": "d4d102deec879c175dc8cc9b16b342b96dce2650", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c4dc56a032b478c55ef99ed35544e9192b2e10d8", "url": "https://github.com/apache/flink/commit/c4dc56a032b478c55ef99ed35544e9192b2e10d8", "message": "[FLINK-19109][streaming] Disallow chaining of ContinuousFileReaderOperator.\n\nWhen CFRO is not actively reading from a split, its inside some poll loop where no mail is being processed. Hence, downstream operators cannot rely on processing timers among other things being reliably triggered.", "committedDate": "2020-09-16T12:21:26Z", "type": "commit"}, {"oid": "c4dc56a032b478c55ef99ed35544e9192b2e10d8", "url": "https://github.com/apache/flink/commit/c4dc56a032b478c55ef99ed35544e9192b2e10d8", "message": "[FLINK-19109][streaming] Disallow chaining of ContinuousFileReaderOperator.\n\nWhen CFRO is not actively reading from a split, its inside some poll loop where no mail is being processed. Hence, downstream operators cannot rely on processing timers among other things being reliably triggered.", "committedDate": "2020-09-16T12:21:26Z", "type": "forcePushed"}]}