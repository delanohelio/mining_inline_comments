{"pr_number": 447, "pr_title": "XRDDEV-937, XRDDEV-938, XRDDEV-939, XRDDEV-940 - API key management frontend implementation", "pr_createdAt": "2020-04-02T13:37:33Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/447", "timeline": [{"oid": "337526027e5cea7f63f202036f3657262bc3209c", "url": "https://github.com/nordic-institute/X-Road/commit/337526027e5cea7f63f202036f3657262bc3209c", "message": "XRDDEV-937: implementation", "committedDate": "2020-03-02T07:15:37Z", "type": "commit"}, {"oid": "29600cebbf261bc071e1ba67f95b17666349f73b", "url": "https://github.com/nordic-institute/X-Road/commit/29600cebbf261bc071e1ba67f95b17666349f73b", "message": "Merge branch 'develop' into XRDDEV-937\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json", "committedDate": "2020-04-01T08:46:16Z", "type": "commit"}, {"oid": "0f33767e14d4432595d6426f2c3b20a408da02d7", "url": "https://github.com/nordic-institute/X-Road/commit/0f33767e14d4432595d6426f2c3b20a408da02d7", "message": "XRDDEV-937: styling changes and update to the API call", "committedDate": "2020-04-01T09:34:18Z", "type": "commit"}, {"oid": "e2b9e92fb792525720afefb851ec663088d042c3", "url": "https://github.com/nordic-institute/X-Road/commit/e2b9e92fb792525720afefb851ec663088d042c3", "message": "XRDDEV-939: boilerplating", "committedDate": "2020-04-01T11:37:10Z", "type": "commit"}, {"oid": "4e4add65acf1c185d76183239550ef8e89f86aba", "url": "https://github.com/nordic-institute/X-Road/commit/4e4add65acf1c185d76183239550ef8e89f86aba", "message": "XRDDEV-939: api key creation front end implementation", "committedDate": "2020-04-02T11:33:11Z", "type": "commit"}, {"oid": "3a91bb34064f11e739997b3307e0db6de99f12e9", "url": "https://github.com/nordic-institute/X-Road/commit/3a91bb34064f11e739997b3307e0db6de99f12e9", "message": "XRDDEV-938: revoke api key front end implementation", "committedDate": "2020-04-02T12:08:35Z", "type": "commit"}, {"oid": "f4b21d766aa4434652048969addc19476175a632", "url": "https://github.com/nordic-institute/X-Road/commit/f4b21d766aa4434652048969addc19476175a632", "message": "XRDDEV-940: edit api key front end implementation", "committedDate": "2020-04-02T13:33:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAxMjUwOA==", "url": "https://github.com/nordic-institute/X-Road/pull/447#discussion_r403012508", "bodyText": "Empty class", "author": "Riippi", "createdAt": "2020-04-03T13:40:29Z", "path": "src/proxy-ui-api/frontend/src/views/KeysAndCertificates/ApiKey/CreateApiKeyStepper.vue", "diffHunk": "@@ -0,0 +1,210 @@\n+<template>\n+  <v-container class=\"xrd-view-common justify-center wrapper\">\n+    <sub-view-title\n+      :title=\"$t('apiKey.createApiKey.title')\"\n+      :show-close=\"true\"\n+      @close=\"close\"\n+    ></sub-view-title>\n+    <v-stepper :alt-labels=\"true\" v-model=\"step\" class=\"stepper mt-2\">\n+      <v-stepper-header class=\"stepper-header\">\n+        <v-stepper-step :complete=\"step > 1\" step=\"1\">{{\n+          $t('apiKey.createApiKey.step.roles.name')\n+        }}</v-stepper-step>\n+        <v-divider />\n+        <v-stepper-step :complete=\"keyGenerated\" step=\"2\">{{\n+          $t('apiKey.createApiKey.step.keyDetails.name')\n+        }}</v-stepper-step>\n+      </v-stepper-header>\n+      <v-stepper-items class=\"stepper-items-wrapper\">\n+        <v-stepper-content step=\"1\" class=\"pa-0\">\n+          <v-row class=\"mb-5\">\n+            <v-col>\n+              <h3>{{ $t('apiKey.createApiKey.step.roles.description') }}</h3>\n+            </v-col>\n+          </v-row>\n+          <v-row no-gutters v-for=\"role in roles\" :key=\"role\">\n+            <v-col class=\"checkbox-wrapper\">\n+              <v-checkbox\n+                v-model=\"selectedRoles\"\n+                height=\"10px\"\n+                :value=\"role\"\n+                :label=\"$t(`apiKey.role.${role}`)\"\n+              />\n+            </v-col>\n+          </v-row>\n+          <v-row class=\"stepper-item-footer mt-12\" no-gutters>\n+            <v-col>\n+              <large-button outlined @click=\"close\">\n+                {{ $t('action.cancel') }}\n+              </large-button>\n+            </v-col>\n+            <v-col class=\"text-right\">\n+              <large-button :disabled=\"nextButtonDisabled\" @click=\"step++\">\n+                {{ $t('action.next') }}\n+              </large-button>\n+            </v-col>\n+          </v-row>\n+        </v-stepper-content>\n+        <v-stepper-content step=\"2\">\n+          <v-row>\n+            <v-col class=\"text-right\">\n+              <large-button\n+                :disabled=\"keyGenerated\"\n+                :loading=\"generatingKey\"\n+                @click=\"generateKey\"\n+              >\n+                {{ $t('apiKey.createApiKey.step.keyDetails.createKeyButton') }}\n+              </large-button>\n+            </v-col>\n+          </v-row>\n+          <v-row>\n+            <v-col cols=\"6\" sm=\"3\" class=\"api-key-label\">\n+              {{ $t('apiKey.createApiKey.step.keyDetails.apiKey') }}\n+            </v-col>\n+            <v-col cols=\"6\" sm=\"9\">\n+              {{ apiKey.key }}\n+            </v-col>\n+          </v-row>\n+          <v-row>\n+            <v-col cols=\"6\" sm=\"3\" class=\"api-key-label\">\n+              {{ $t('apiKey.createApiKey.step.keyDetails.apiKeyID') }}\n+            </v-col>\n+            <v-col cols=\"6\" sm=\"9\">\n+              {{ apiKey.id }}\n+            </v-col>\n+          </v-row>\n+          <v-row>\n+            <v-col cols=\"6\" sm=\"3\" class=\"api-key-label\">\n+              {{ $t('apiKey.createApiKey.step.keyDetails.assignedRoles') }}\n+            </v-col>\n+            <v-col cols=\"6\" sm=\"9\">\n+              {{ translatedRoles | commaSeparate }}\n+            </v-col>\n+          </v-row>\n+          <v-row class=\"mt-12\">\n+            <v-col>\n+              {{ $t('apiKey.createApiKey.step.keyDetails.note') }}\n+            </v-col>\n+          </v-row>\n+          <v-row class=\"stepper-item-footer mt-12\" no-gutters>\n+            <v-col>\n+              <large-button\n+                outlined\n+                @click=\"close\"\n+                :disabled=\"keyGenerated || generatingKey\"\n+              >\n+                {{ $t('action.cancel') }}\n+              </large-button>\n+            </v-col>\n+            <v-col class=\"text-right\">\n+              <large-button\n+                outlined\n+                @click=\"step--\"\n+                class=\"mr-5\"\n+                :disabled=\"keyGenerated || generatingKey\"\n+              >\n+                {{ $t('action.previous') }}\n+              </large-button>\n+              <large-button :disabled=\"!keyGenerated\" @click=\"close\">\n+                {{ $t('action.finish') }}\n+              </large-button>\n+            </v-col>\n+          </v-row>\n+        </v-stepper-content>\n+      </v-stepper-items>\n+    </v-stepper>\n+  </v-container>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import { Roles } from '@/global';\n+import { ApiKey } from '@/global-types';\n+import * as api from '@/util/api';\n+\n+export default Vue.extend({\n+  name: 'CreateApiKeyStepper',\n+  components: {\n+    LargeButton,\n+    SubViewTitle,\n+  },\n+  data() {\n+    return {\n+      step: 1,\n+      roles: Roles,\n+      generatingKey: false,\n+      selectedRoles: [] as string[],\n+      apiKey: {} as ApiKey,\n+    };\n+  },\n+  computed: {\n+    nextButtonDisabled(): boolean {\n+      return this.selectedRoles.length === 0;\n+    },\n+    translatedRoles(): string[] {\n+      return !this.apiKey.roles\n+        ? []\n+        : this.apiKey.roles.map(\n+            (role) => this.$t(`apiKey.role.${role}`) as string,\n+          );\n+    },\n+    keyGenerated(): boolean {\n+      return this.apiKey.key !== undefined;\n+    },\n+  },\n+  methods: {\n+    close(): void {\n+      this.$router.back();\n+    },\n+    async generateKey() {\n+      this.generatingKey = true;\n+      api\n+        .post('/api-keys', this.selectedRoles)\n+        .then((resp) => {\n+          this.apiKey = resp.data;\n+          this.$store.dispatch('showSuccess', 'apiKey.createApiKey.success');\n+        })\n+        .catch((error) => this.$store.dispatch('showError', error))\n+        .finally(() => (this.generatingKey = false));\n+    },\n+  },\n+});\n+</script>\n+\n+<style scoped lang=\"scss\">\n+@import '../../../assets/detail-views';\n+@import '../../../assets/colors';\n+.wrapper {\n+  max-width: 850px;\n+  height: 100%;\n+  width: 100%;\n+  color: $XRoad-Grey60;\n+}\n+.stepper {\n+  box-shadow: unset;\n+}\n+.stepper-header {\n+  box-shadow: unset;\n+  width: 50%;\n+  margin: auto;\n+}\n+.stepper-item-footer {\n+  margin-top: 20px;\n+  padding-top: 30px;\n+  border-top: 1px solid $XRoad-Grey40;\n+}\n+.stepper-items-wrapper {", "originalCommit": "f4b21d766aa4434652048969addc19476175a632", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAyNDU4OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/447#discussion_r403024589", "bodyText": "Fixed.", "author": "raits", "createdAt": "2020-04-03T13:58:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAxMjUwOA=="}], "type": "inlineReview"}, {"oid": "1fbd6f17051161d895b0e2571e222674fb9e7752", "url": "https://github.com/nordic-institute/X-Road/commit/1fbd6f17051161d895b0e2571e222674fb9e7752", "message": "XRDDEV-937-938-939-940: remove empty style class", "committedDate": "2020-04-03T13:57:52Z", "type": "commit"}]}