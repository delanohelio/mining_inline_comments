{"pr_number": 359, "pr_title": "Icelandic Certificate Profile update", "pr_createdAt": "2020-02-10T23:32:54Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/359", "timeline": [{"oid": "37912198473204cca2a8362c699d20007404aa09", "url": "https://github.com/nordic-institute/X-Road/commit/37912198473204cca2a8362c699d20007404aa09", "message": "Added Icelandic is_IS.UTF-8 locale support to ansible/roles/xroad-base/tasks/ubuntu.yml", "committedDate": "2019-09-11T07:42:10Z", "type": "commit"}, {"oid": "efa1de621db74db054e667b1d5713426b7b9e75a", "url": "https://github.com/nordic-institute/X-Road/commit/efa1de621db74db054e667b1d5713426b7b9e75a", "message": "Reverted \"Added Icelandic is_IS.UTF-8 locale support to ansible/roles/xroad-base/tasks/ubuntu.yml\"\n\nThis reverts commit 37912198473204cca2a8362c699d20007404aa09.", "committedDate": "2019-10-24T06:31:36Z", "type": "commit"}, {"oid": "098ea188dce6e363de7e2835d75dc3f0ede6d890", "url": "https://github.com/nordic-institute/X-Road/commit/098ea188dce6e363de7e2835d75dc3f0ede6d890", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-10-24T06:32:38Z", "type": "commit"}, {"oid": "c2e6dee96d070bc64234b2ba84f1b47c02f8ba5d", "url": "https://github.com/nordic-institute/X-Road/commit/c2e6dee96d070bc64234b2ba84f1b47c02f8ba5d", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2019-11-22T07:13:06Z", "type": "commit"}, {"oid": "8b9b297add8064d3aa6bbd5fa1ed256827f96596", "url": "https://github.com/nordic-institute/X-Road/commit/8b9b297add8064d3aa6bbd5fa1ed256827f96596", "message": "Merge remote-tracking branch 'upstream/develop' into develop", "committedDate": "2020-01-05T21:13:48Z", "type": "commit"}, {"oid": "2b37b8dc30a05a0100639de5a1d3d501af7381dc", "url": "https://github.com/nordic-institute/X-Road/commit/2b37b8dc30a05a0100639de5a1d3d501af7381dc", "message": "Merge branch 'develop' of https://github.com/nordic-institute/X-Road into develop", "committedDate": "2020-02-09T12:23:15Z", "type": "commit"}, {"oid": "78007df0285fbe820a27da0281abf7532afd92d1", "url": "https://github.com/nordic-institute/X-Road/commit/78007df0285fbe820a27da0281abf7532afd92d1", "message": "Updated Icelandic Certificate Auth and Sign profiles", "committedDate": "2020-02-10T17:01:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODIyMTExMg==", "url": "https://github.com/nordic-institute/X-Road/pull/359#discussion_r378221112", "bodyText": "clientId.xRoadInstance is already encoded as countryName and clientId.memberClass as organizationName. If the intention is to make the DN unique in case the member is a client of multiple security servers, maybe this should be something like:\n params.getServerId().toShortString(); // INSTANCE/CLASS/MEMBERCODE/SERVERCODE\n\n(And even that is prone to errors since serialNumber should be a ASN.1 PrintableString (https://en.wikipedia.org/wiki/PrintableString), and serverId can include \"non-PrintableString\" chars)", "author": "jhyoty", "createdAt": "2020-02-12T12:30:29Z", "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsSignCertificateProfileInfo.java", "diffHunk": "@@ -45,23 +45,38 @@\n      */\n     public IsSignCertificateProfileInfo(Parameters params) {\n         super(new DnFieldDescription[] {\n-                // Country Code\n-                new EnumLocalizedFieldDescriptionImpl(\n-                        \"C\", DnFieldLabelLocalizationKey.COUNTRY_CODE, \"IS\").setReadOnly(true),\n \n-                // Organization name\n+                // Instance identifier\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"O\", DnFieldLabelLocalizationKey.ORGANIZATION_NAME, \"\").setReadOnly(false),\n+                        \"C\",\n+                        DnFieldLabelLocalizationKey.INSTANCE_IDENTIFIER,\n+                        params.getClientId().getXRoadInstance()\n+                ).setReadOnly(true),\n \n-                // Serialnumber\n-                new EnumLocalizedFieldDescriptionImpl(\"serialNumber\", DnFieldLabelLocalizationKey.SERIAL_NUMBER,\n-                        params.getClientId().getXRoadInstance() + \"/\" + params.getServerId().getServerCode()\n-                                + \"/\" + params.getClientId().getMemberClass()).setReadOnly(true),\n+                // Member class\n+                new EnumLocalizedFieldDescriptionImpl(\n+                        \"O\",\n+                        DnFieldLabelLocalizationKey.MEMBER_CLASS,\n+                        params.getClientId().getMemberClass()\n+                ).setReadOnly(true),\n \n                 // Member code\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"CN\", DnFieldLabelLocalizationKey.MEMBER_CODE, params.getClientId().getMemberCode())\n-                        .setReadOnly(true) });\n+                        \"CN\",\n+                        DnFieldLabelLocalizationKey.MEMBER_CODE,\n+                        params.getClientId().getMemberCode()\n+                ).setReadOnly(true),\n+\n+                // Serialnumber\n+                new EnumLocalizedFieldDescriptionImpl(\n+                        \"serialNumber\",\n+                        DnFieldLabelLocalizationKey.SERIAL_NUMBER,\n+                        params.getClientId().getXRoadInstance()\n+                        + \"/\" + params.getServerId().getServerCode()\n+                        + \"/\" + params.getClientId().getMemberClass()\n+                ).setReadOnly(true)", "originalCommit": "78007df0285fbe820a27da0281abf7532afd92d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODIyODIzMg==", "url": "https://github.com/nordic-institute/X-Road/pull/359#discussion_r378228232", "bodyText": "Note: Valid values for the countryName attribute are ISO 3166 alpha-2 codes (2-character country codes). It would be safer to map the instance identifier to e.g. \"O\" (and memberClass to OU) in case a CA uses strict validation.", "author": "jhyoty", "createdAt": "2020-02-12T12:46:10Z", "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsSignCertificateProfileInfo.java", "diffHunk": "@@ -45,23 +45,38 @@\n      */\n     public IsSignCertificateProfileInfo(Parameters params) {\n         super(new DnFieldDescription[] {\n-                // Country Code\n-                new EnumLocalizedFieldDescriptionImpl(\n-                        \"C\", DnFieldLabelLocalizationKey.COUNTRY_CODE, \"IS\").setReadOnly(true),\n \n-                // Organization name\n+                // Instance identifier\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"O\", DnFieldLabelLocalizationKey.ORGANIZATION_NAME, \"\").setReadOnly(false),\n+                        \"C\",", "originalCommit": "78007df0285fbe820a27da0281abf7532afd92d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODIzMDkwNA==", "url": "https://github.com/nordic-institute/X-Road/pull/359#discussion_r378230904", "bodyText": "Note: Valid values for the countryName attribute are ISO 3166 alpha-2 codes (2-character country codes). It would be safer to map the instance identifier to e.g. \"organizationName\" in case a CA uses strict validation.", "author": "jhyoty", "createdAt": "2020-02-12T12:51:57Z", "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsAuthCertificateProfileInfo.java", "diffHunk": "@@ -39,21 +39,28 @@\n      */\n     public IsAuthCertificateProfileInfo(Parameters params) {\n         super(new DnFieldDescription[] {\n-                // Country Code\n+                // Instance identifier\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"C\", DnFieldLabelLocalizationKey.COUNTRY_CODE, \"IS\").setReadOnly(true),\n+                        \"C\",\n+                        DnFieldLabelLocalizationKey.INSTANCE_IDENTIFIER,", "originalCommit": "78007df0285fbe820a27da0281abf7532afd92d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI0NDc2Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/359#discussion_r378244763", "bodyText": "Maybe serialNumber value could be something like  params.getServerId().getOwner().toShortString()  if the intention is to make the DN unique (serverCode is already mapped to CN).\nNote that serialNumber should be an ASN.1 PrintableString (https://en.wikipedia.org/wiki/PrintableString), and the identifiers (serverId components) can include \"non-PrintableString\" chars.", "author": "jhyoty", "createdAt": "2020-02-12T13:20:46Z", "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsAuthCertificateProfileInfo.java", "diffHunk": "@@ -39,21 +39,28 @@\n      */\n     public IsAuthCertificateProfileInfo(Parameters params) {\n         super(new DnFieldDescription[] {\n-                // Country Code\n+                // Instance identifier\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"C\", DnFieldLabelLocalizationKey.COUNTRY_CODE, \"IS\").setReadOnly(true),\n+                        \"C\",\n+                        DnFieldLabelLocalizationKey.INSTANCE_IDENTIFIER,\n+                        params.getServerId().getXRoadInstance()\n+                ).setReadOnly(true),\n \n-                // Organization name\n+                // Server code\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"O\", DnFieldLabelLocalizationKey.ORGANIZATION_NAME, \"\").setReadOnly(false),\n+                        \"CN\",\n+                        DnFieldLabelLocalizationKey.SERVER_CODE,\n+                        params.getServerId().getServerCode()\n+                ).setReadOnly(true),\n \n                 // Serialnumber\n-                new EnumLocalizedFieldDescriptionImpl(\"serialNumber\", DnFieldLabelLocalizationKey.SERIAL_NUMBER,\n-                        params.getServerId().getXRoadInstance() + \"/\" + params.getServerId().getServerCode()\n-                                + \"/\" + params.getServerId().getMemberClass()).setReadOnly(true),\n-\n-                // Server code\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"CN\", DnFieldLabelLocalizationKey.SERVER_DNS_NAME, \"\").setReadOnly(false) });\n+                        \"serialNumber\",\n+                        DnFieldLabelLocalizationKey.SERIAL_NUMBER,\n+                        params.getServerId().getXRoadInstance()\n+                        + \"/\" + params.getServerId().getServerCode()\n+                        + \"/\" + params.getServerId().getMemberClass()", "originalCommit": "78007df0285fbe820a27da0281abf7532afd92d1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7ccbcb3f75000c4c95dbf0a9e0e70ce915e2fee0", "url": "https://github.com/nordic-institute/X-Road/commit/7ccbcb3f75000c4c95dbf0a9e0e70ce915e2fee0", "message": "Updated Certificate profiles\n\nThe following code changes impliment the following certifcate profiles for the Icelandic State in project Straumurinn.\n\n----------------------------------------------------\nSigning Cert:\n----------------------------------------------------\nC=IS\nO=IS-DEV\nOU=CLASS\nCN=MEMBERCODE\nserialNumber=IS-DEV/CLASS/OWNERMEMBERCODE/SERVERCODE\n\n----------------------------------------------------\nAuth Cert:\n----------------------------------------------------\nC=IS\nO=IS-DEV\nOU=CLASS\nCN=SECURITYSERVERFQDN\nserialNumber=IS-DEV/CLASS/OWNERMEMBERCODE/SERVERCODE", "committedDate": "2020-02-18T14:16:29Z", "type": "commit"}, {"oid": "53e57090000906502b71aa14a2a53e4a84ca213b", "url": "https://github.com/nordic-institute/X-Road/commit/53e57090000906502b71aa14a2a53e4a84ca213b", "message": "Updated certification profiles according to suggestions from @jhyoty. Compilation was successful", "committedDate": "2020-02-18T17:03:28Z", "type": "commit"}]}