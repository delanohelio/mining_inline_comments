{"pr_number": 470, "pr_title": "XRDDEV-859 Add subsystem, XRDDEV-858 register, XRDDEV-863 unregister client", "pr_createdAt": "2020-04-20T17:29:29Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/470", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzNDEyMA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415534120", "bodyText": "'==' => '==='\n'!=' => '!=='", "author": "TJaakkola", "createdAt": "2020-04-27T06:05:45Z", "path": "src/proxy-ui-api/frontend/src/views/Clients/ClientsDataTable.vue", "diffHunk": "@@ -82,15 +82,15 @@\n \n       <template v-slot:item.button=\"{ item }\">\n         <div class=\"button-wrap\">\n-          <v-btn\n-            v-if=\"(item.type == 'client' ||item.type == 'owner') && showAddClient()\"\n-            small\n-            outlined\n-            rounded\n-            color=\"primary\"\n-            class=\"xrd-small-button xrd-table-button\"\n+          <SmallButton\n+            v-if=\"(item.type == 'client' ||item.type == 'owner') && showAddClient\"\n             @click=\"addSubsystem(item)\"\n-          >{{$t('action.addSubsystem')}}</v-btn>\n+          >{{$t('action.addSubsystem')}}</SmallButton>\n+\n+          <SmallButton\n+            v-if=\"(item.type == 'client'||item.type != 'owner' && item.status === 'SAVED') && showRegister\"", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1Mzk3Ng==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953976", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:17:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzNDEyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzNDY3MQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415534671", "bodyText": "add typings. And while you're on to it add typings to all variables in the data-block :)", "author": "TJaakkola", "createdAt": "2020-04-27T06:07:02Z", "path": "src/proxy-ui-api/frontend/src/views/Clients/ClientsDataTable.vue", "diffHunk": "@@ -113,17 +122,25 @@ import Vue from 'vue';\n import ClientStatus from './ClientStatus.vue';\n import { mapGetters } from 'vuex';\n import { Permissions, RouteName } from '@/global';\n+import { Client } from '@/types';\n+import SmallButton from '@/components/ui/SmallButton.vue';\n+import ConfirmDialog from '@/components/ui/ConfirmDialog.vue';\n \n export default Vue.extend({\n   components: {\n     ClientStatus,\n+    SmallButton,\n+    ConfirmDialog,\n   },\n \n   data: () => ({\n     search: '',\n     pagination: {\n       sortBy: 'sortNameAsc',\n     },\n+    confirmRegisterClient: false,", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1NDA0OA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415954048", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:17:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzNDY3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzNTE4NA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415535184", "bodyText": "typings", "author": "TJaakkola", "createdAt": "2020-04-27T06:08:18Z", "path": "src/proxy-ui-api/frontend/src/views/Clients/Subsystem.vue", "diffHunk": "@@ -27,10 +49,26 @@ export default Vue.extend({\n   data() {\n     return {\n       tab: null,\n+      confirmUnregisterClient: false,", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1NDE0Mg==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415954142", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:17:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzNTE4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzNTQyNA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415535424", "bodyText": "return this.client &&\n        this.$store.getters.hasPermission(Permissions.SEND_CLIENT_DEL_REQ) &&\n        (this.client.status === 'REGISTERED' ||\n          this.client.status === 'REGISTRATION_IN_PROGRESS')", "author": "TJaakkola", "createdAt": "2020-04-27T06:08:56Z", "path": "src/proxy-ui-api/frontend/src/views/Clients/Subsystem.vue", "diffHunk": "@@ -27,10 +49,26 @@ export default Vue.extend({\n   data() {\n     return {\n       tab: null,\n+      confirmUnregisterClient: false,\n+      unregisterLoading: false,\n     };\n   },\n   computed: {\n     ...mapGetters(['client']),\n+\n+    showUnregister(): boolean {\n+      if (\n+        this.client &&\n+        this.$store.getters.hasPermission(Permissions.SEND_CLIENT_DEL_REQ) &&\n+        (this.client.status === 'REGISTERED' ||\n+          this.client.status === 'REGISTRATION_IN_PROGRESS')\n+      ) {\n+        return true;\n+      } else {\n+        return false;\n+      }", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1NDIwOQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415954209", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:17:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzNTQyNA=="}], "type": "inlineReview"}, {"oid": "f019b5149a51f3fd6fb2c7ced23a51a928b912c1", "url": "https://github.com/nordic-institute/X-Road/commit/f019b5149a51f3fd6fb2c7ced23a51a928b912c1", "message": "XRDDEV-859 Fix review issues", "committedDate": "2020-04-27T11:01:27Z", "type": "commit"}, {"oid": "15df662c38b14702755476211951c50c72a86e13", "url": "https://github.com/nordic-institute/X-Road/commit/15df662c38b14702755476211951c50c72a86e13", "message": "XRDDEV-859 Fix register button", "committedDate": "2020-04-27T11:37:36Z", "type": "commit"}, {"oid": "769b530a0b906e232aaef07a7103ba13d54dfc46", "url": "https://github.com/nordic-institute/X-Road/commit/769b530a0b906e232aaef07a7103ba13d54dfc46", "message": "XRDDEV-859 Fix clients api usage", "committedDate": "2020-04-27T16:11:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM0ODgzNA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r416348834", "bodyText": "should be removed", "author": "TJaakkola", "createdAt": "2020-04-28T06:01:03Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,279 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div data-test=\"selected-member-name\">{{memberName}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+          <div data-test=\"selected-member-class\">{{memberClass}}</div>\n+        </div>\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+          <div data-test=\"selected-member-code\">{{memberCode}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel\n+            labelText=\"wizard.subsystemCode\"\n+            helpText=\"wizard.client.subsystemCodeTooltip\"\n+          />\n+\n+          <ValidationProvider name=\"addClient.subsystemCode\" rules=\"required\" v-slot=\"{ errors }\">\n+            <v-text-field\n+              class=\"form-input\"\n+              type=\"text\"\n+              :error-messages=\"errors\"\n+              v-model=\"subsystemCode\"\n+              data-test=\"subsystem-code-input\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+        <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.subsystem.registerSubsystem\" />\n+          <v-checkbox\n+            v-model=\"registerChecked\"\n+            color=\"primary\"\n+            class=\"register-checkbox\"\n+            data-test=\"register-subsystem-checkbox\"\n+          ></v-checkbox>\n+        </div>\n+        <div class=\"button-footer\">\n+          <div class=\"button-group\">\n+            <large-button\n+              outlined\n+              @click=\"exitView\"\n+              data-test=\"cancel-button\"\n+            >{{$t('action.cancel')}}</large-button>\n+          </div>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid || duplicateClient\"\n+            data-test=\"submit-add-subsystem-button\"\n+          >{{$t('action.addSubsystem')}}</large-button>\n+        </div>\n+      </ValidationObserver>\n+\n+      <SelectClientDialog\n+        :dialog=\"showSelectClient\"\n+        :selectableClients=\"selectableSubsystems\"\n+        @cancel=\"showSelectClient = false\"\n+        @save=\"saveSelectedClient\"\n+      />\n+    </div>\n+  </div>\n </template>\n \n <script lang=\"ts\">\n import Vue from 'vue';\n-import { RouteName } from '@/global';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import SubsystemDetailsPage from './SubsystemDetailsPage.vue';\n+import SelectClientDialog from '@/views/AddClient/SelectClientDialog.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { Key, Token } from '@/types';\n+import { RouteName, UsageTypes } from '@/global';\n+import { containsClient } from '@/util/helpers';\n+import { Client } from '@/types';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import * as api from '@/util/api';\n \n export default Vue.extend({\n-  data: () => ({\n-    member: {\n-      name: 'Kuikka',\n-      class: 'Org',\n-      code: '111',\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+    SubViewTitle,\n+  },\n+  props: {\n+    instanceId: {\n+      type: String,\n+      required: true,\n+    },\n+    memberClass: {\n+      type: String,\n+      required: true,\n+    },\n+    memberCode: {\n+      type: String,\n+      required: true,\n+    },\n+    memberName: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      disableDone: false as boolean,\n+      showSelectClient: false as boolean,\n+      registerChecked: true as boolean,\n+      existingSubsystems: [] as Client[],\n+      selectableSubsystems: [] as Client[],\n+      subsystemCode: undefined as undefined | string,\n+    };\n+  },\n+  computed: {\n+    duplicateClient(): boolean {\n+      if (!this.subsystemCode) {\n+        return false;\n+      }\n+\n+      return containsClient(\n+        this.existingSubsystems,\n+        this.memberClass,\n+        this.memberCode,\n+        this.subsystemCode,\n+      );\n     },\n-  }),\n+  },\n   methods: {\n-    addSubsystem() {\n-      console.log('add subsystem');\n+    done(): void {\n+      this.$store\n+        .dispatch('addSubsystem', {\n+          memberName: this.memberName,\n+          memberClass: this.memberClass,\n+          memberCode: this.memberCode,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          () => {\n+            this.disableDone = false;\n+\n+            if (this.registerChecked) {\n+              this.registerSubsystem();\n+            } else {\n+              this.exitView();\n+            }\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        );\n+    },\n+\n+    registerSubsystem(): void {\n+      this.$store\n+        .dispatch('registerClient', {\n+          instanceId: this.instanceId,\n+          memberClass: this.memberClass,\n+          memberCode: this.memberCode,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          () => {\n+            this.disableDone = false;\n+            this.exitView();\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+            this.exitView();\n+          },\n+        );\n     },\n-    cancel() {\n+\n+    exitView(): void {\n       this.$router.replace({ name: RouteName.Clients });\n     },\n+    saveSelectedClient(selectedMember: Client): void {\n+      this.subsystemCode = selectedMember.subsystem_code;\n+      this.showSelectClient = false;\n+    },\n+    fetchData(): void {\n+      // Fetch selectable subsystems\n+      api\n+        .get(\n+          `/clients?instance=${this.instanceId}&member_class=${this.memberClass}&member_code=${this.memberCode}&show_members=false&exclude_local=true`,\n+        )\n+        .then((res) => {\n+          this.selectableSubsystems = res.data;\n+        })\n+        .catch((error) => {\n+          this.$store.dispatch('showError', error);\n+        });\n+\n+      // Fetch existing subsystems\n+      api\n+        .get(\n+          `/clients?instance=${this.instanceId}&member_class=${this.memberClass}&member_code=${this.memberCode}&internal_search=true`,\n+        )\n+        .then((res) => {\n+          console.log(res.data);", "originalCommit": "769b530a0b906e232aaef07a7103ba13d54dfc46", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM3MDI2OA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r416370268", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-28T06:50:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM0ODgzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM0OTQ2NA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r416349464", "bodyText": "should be removed", "author": "TJaakkola", "createdAt": "2020-04-28T06:02:32Z", "path": "src/proxy-ui-api/frontend/src/views/Clients/ClientsDataTable.vue", "diffHunk": "@@ -195,12 +214,56 @@ export default Vue.extend({\n       });\n     },\n \n-    addSubsystem(item: any): void {\n+    addSubsystem(item: Client): void {\n+      if (!item.instance_id || !item.member_name) {\n+        // Should not happen\n+        throw new Error('Invalid client');\n+      }\n+\n+      console.log(item);", "originalCommit": "769b530a0b906e232aaef07a7103ba13d54dfc46", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM3MDI5Ng==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r416370296", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-28T06:50:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjM0OTQ2NA=="}], "type": "inlineReview"}, {"oid": "906419d6e0b7daba8c6dc2ede7c9b79061fbcf5e", "url": "https://github.com/nordic-institute/X-Road/commit/906419d6e0b7daba8c6dc2ede7c9b79061fbcf5e", "message": "XRDDEV-859 Fix review issues", "committedDate": "2020-04-28T06:44:28Z", "type": "commit"}, {"oid": "c1fbca03814013adcc435362f48fdfb80d8215da", "url": "https://github.com/nordic-institute/X-Road/commit/c1fbca03814013adcc435362f48fdfb80d8215da", "message": "XRDDEV-859 Update packages and resolve audit", "committedDate": "2020-04-28T07:20:20Z", "type": "commit"}, {"oid": "cc664c266d4da1cc04b8fabc8c8d98850dfb1d3d", "url": "https://github.com/nordic-institute/X-Road/commit/cc664c266d4da1cc04b8fabc8c8d98850dfb1d3d", "message": "Merge branch 'develop' into XRDDEV-859-add-subsystem", "committedDate": "2020-04-28T07:29:31Z", "type": "commit"}, {"oid": "084c9a76a430b046520650b0281b1f551c4980e9", "url": "https://github.com/nordic-institute/X-Road/commit/084c9a76a430b046520650b0281b1f551c4980e9", "message": "XRDDEV-857 Add localisations", "committedDate": "2020-02-26T14:36:21Z", "type": "commit"}, {"oid": "88a671d6b52036c23e80d4ab7e9e2c54b56853fe", "url": "https://github.com/nordic-institute/X-Road/commit/88a671d6b52036c23e80d4ab7e9e2c54b56853fe", "message": "XRDDEV-857 Add new components", "committedDate": "2020-02-26T14:39:39Z", "type": "commit"}, {"oid": "5cfcee7d114442af6854613bfbae05c471c9a796", "url": "https://github.com/nordic-institute/X-Road/commit/5cfcee7d114442af6854613bfbae05c471c9a796", "message": "XRDDEV-857 Add tokens to store", "committedDate": "2020-02-26T14:58:20Z", "type": "commit"}, {"oid": "8fce2401705cddb8144e0c8ff00bd8cf529bc286", "url": "https://github.com/nordic-institute/X-Road/commit/8fce2401705cddb8144e0c8ff00bd8cf529bc286", "message": "XRDDEV-857 Add localisations", "committedDate": "2020-02-28T13:06:56Z", "type": "commit"}, {"oid": "50439a9d3ad715649b8750c4c50e820a17ecdeba", "url": "https://github.com/nordic-institute/X-Road/commit/50439a9d3ad715649b8750c4c50e820a17ecdeba", "message": "XRDDEV-857 Update vuex store", "committedDate": "2020-02-28T13:07:40Z", "type": "commit"}, {"oid": "1f54656e489204fccf1ec5979cb81f2c16f46364", "url": "https://github.com/nordic-institute/X-Road/commit/1f54656e489204fccf1ec5979cb81f2c16f46364", "message": "XRDDEV-857 Add add client wizard pages", "committedDate": "2020-02-28T13:10:35Z", "type": "commit"}, {"oid": "2968241225a61553de6a38afddfc14000ca9a136", "url": "https://github.com/nordic-institute/X-Road/commit/2968241225a61553de6a38afddfc14000ca9a136", "message": "XRDDEV-857 Remove unused and commented code", "committedDate": "2020-02-28T13:50:59Z", "type": "commit"}, {"oid": "4ff1520861af4cf8109f0866734a0c8a1c7827f0", "url": "https://github.com/nordic-institute/X-Road/commit/4ff1520861af4cf8109f0866734a0c8a1c7827f0", "message": "XRDDEV-857 Add localisations", "committedDate": "2020-02-28T14:32:20Z", "type": "commit"}, {"oid": "28a36856cb5d66c9719813c570d947b17ecca133", "url": "https://github.com/nordic-institute/X-Road/commit/28a36856cb5d66c9719813c570d947b17ecca133", "message": "XRDDEV-857 Update packages", "committedDate": "2020-02-28T14:32:50Z", "type": "commit"}, {"oid": "d9305eb85c0356f13da1d895bc3bb18374cc7c52", "url": "https://github.com/nordic-institute/X-Road/commit/d9305eb85c0356f13da1d895bc3bb18374cc7c52", "message": "Merge commit '0cfc24125cb16a80bf0519ef696c3e391a99334d' into XRDDEV-857-add-client", "committedDate": "2020-02-28T14:33:19Z", "type": "commit"}, {"oid": "7218075dd1d72505b1c220e6259eff5dbc99efa2", "url": "https://github.com/nordic-institute/X-Road/commit/7218075dd1d72505b1c220e6259eff5dbc99efa2", "message": "XRDDEV-857 Update packages", "committedDate": "2020-02-28T14:56:03Z", "type": "commit"}, {"oid": "0f6bb78ead9530780794c4ed0036224b1e2f3cb9", "url": "https://github.com/nordic-institute/X-Road/commit/0f6bb78ead9530780794c4ed0036224b1e2f3cb9", "message": "XRDDEV-857 Fix linter errors", "committedDate": "2020-02-28T14:56:47Z", "type": "commit"}, {"oid": "1627765b6f4a97aff3a73201d4f5e4931b2e1600", "url": "https://github.com/nordic-institute/X-Road/commit/1627765b6f4a97aff3a73201d4f5e4931b2e1600", "message": "XRDDEV-857 Clean up code from store", "committedDate": "2020-03-02T08:31:59Z", "type": "commit"}, {"oid": "83111b18af97de3d5b437b347cca81c06fb2b961", "url": "https://github.com/nordic-institute/X-Road/commit/83111b18af97de3d5b437b347cca81c06fb2b961", "message": "Merge commit 'b9825736f75c0ca5fc49f3843fa24159b6082531' into XRDDEV-857-add-client", "committedDate": "2020-03-02T08:33:17Z", "type": "commit"}, {"oid": "ca86a04578fa36e9801af0da47ea946e2670bd5a", "url": "https://github.com/nordic-institute/X-Road/commit/ca86a04578fa36e9801af0da47ea946e2670bd5a", "message": "XRDDEV-857 Add shared styling for wizard pages", "committedDate": "2020-03-02T11:35:04Z", "type": "commit"}, {"oid": "cd0ebdebe361466bf4492999483efa8049038e00", "url": "https://github.com/nordic-institute/X-Road/commit/cd0ebdebe361466bf4492999483efa8049038e00", "message": "XRDDEV-857 Update wizard buttons", "committedDate": "2020-03-02T11:35:49Z", "type": "commit"}, {"oid": "6bc06a460b39f2816454c5ba177cf8c0616cdbe6", "url": "https://github.com/nordic-institute/X-Road/commit/6bc06a460b39f2816454c5ba177cf8c0616cdbe6", "message": "XRDDEV-857 Remove absolute style from app footer", "committedDate": "2020-03-02T11:36:23Z", "type": "commit"}, {"oid": "0d556b48034584af575883b7283707c579304b0d", "url": "https://github.com/nordic-institute/X-Road/commit/0d556b48034584af575883b7283707c579304b0d", "message": "XRDDEV-857 Add missing scss file", "committedDate": "2020-03-02T13:05:20Z", "type": "commit"}, {"oid": "bf22d4c2fcacc6d6bc81d3c268194ae4e28fd4ee", "url": "https://github.com/nordic-institute/X-Road/commit/bf22d4c2fcacc6d6bc81d3c268194ae4e28fd4ee", "message": "Merge commit 'b190f27e611936ccd730baf9d83b875a770a7c29' into XRDDEV-859-add-subsystem", "committedDate": "2020-03-02T15:12:48Z", "type": "commit"}, {"oid": "3060e9343279f7fdf88c9078bb0e4f98d51b4b59", "url": "https://github.com/nordic-institute/X-Road/commit/3060e9343279f7fdf88c9078bb0e4f98d51b4b59", "message": "Merge commit 'b190f27e611936ccd730baf9d83b875a770a7c29' into XRDDEV-857-add-client", "committedDate": "2020-03-02T15:13:22Z", "type": "commit"}, {"oid": "66a10792629d149ae63266f09e5a4247333c42a1", "url": "https://github.com/nordic-institute/X-Road/commit/66a10792629d149ae63266f09e5a4247333c42a1", "message": "XRDDEV-857 Add missing localisation", "committedDate": "2020-03-02T15:21:58Z", "type": "commit"}, {"oid": "7a93f579e4280179d2d15f362e0534e3b0004320", "url": "https://github.com/nordic-institute/X-Road/commit/7a93f579e4280179d2d15f362e0534e3b0004320", "message": "XRDDEV-857 Add data-test attributes", "committedDate": "2020-03-03T14:02:58Z", "type": "commit"}, {"oid": "e0bd10a4b0a58e1c8b55bfd6926a3380108c1e73", "url": "https://github.com/nordic-institute/X-Road/commit/e0bd10a4b0a58e1c8b55bfd6926a3380108c1e73", "message": "Merge commit 'bedd13afe5f63fb233af3ada80a1561a2b43de87' into XRDDEV-859-add-subsystem", "committedDate": "2020-03-03T15:02:07Z", "type": "commit"}, {"oid": "ba7d5af11493add08820e868f03789c0554cca6d", "url": "https://github.com/nordic-institute/X-Road/commit/ba7d5af11493add08820e868f03789c0554cca6d", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-859-add-subsystem", "committedDate": "2020-03-03T15:02:37Z", "type": "commit"}, {"oid": "8570e42f100655191ec13711272a939e9d00eeaa", "url": "https://github.com/nordic-institute/X-Road/commit/8570e42f100655191ec13711272a939e9d00eeaa", "message": "XRDDEV-859 Add localisations", "committedDate": "2020-03-11T11:40:48Z", "type": "commit"}, {"oid": "706af843931a106aa3794b12aeceaaae5ffba75c", "url": "https://github.com/nordic-institute/X-Road/commit/706af843931a106aa3794b12aeceaaae5ffba75c", "message": "XRDDEV-859 Add parameters to route", "committedDate": "2020-03-11T11:41:35Z", "type": "commit"}, {"oid": "afcff404d3a3517427c50b5a8bb38cde2ab3ccde", "url": "https://github.com/nordic-institute/X-Road/commit/afcff404d3a3517427c50b5a8bb38cde2ab3ccde", "message": "XRDDEV-859 Update styling", "committedDate": "2020-03-11T11:48:57Z", "type": "commit"}, {"oid": "749f115372e862ab08fff5fc6e3bbc121eff8e53", "url": "https://github.com/nordic-institute/X-Road/commit/749f115372e862ab08fff5fc6e3bbc121eff8e53", "message": "XRDDEV-859 Import client interface from types", "committedDate": "2020-03-11T11:49:50Z", "type": "commit"}, {"oid": "e549aeded155cb3fec0b4829151bef41a82fcc2d", "url": "https://github.com/nordic-institute/X-Road/commit/e549aeded155cb3fec0b4829151bef41a82fcc2d", "message": "XRDDEV-859 Update add subsystem flow", "committedDate": "2020-03-11T12:27:05Z", "type": "commit"}, {"oid": "2f8f3989d8f8d5fbf9996282dc3a5c7d0adc69ce", "url": "https://github.com/nordic-institute/X-Road/commit/2f8f3989d8f8d5fbf9996282dc3a5c7d0adc69ce", "message": "XRDDEV-857 Add previous buttons", "committedDate": "2020-03-13T15:08:43Z", "type": "commit"}, {"oid": "663c8476e72df9d9c5f8f5db6ff4278c726eab98", "url": "https://github.com/nordic-institute/X-Road/commit/663c8476e72df9d9c5f8f5db6ff4278c726eab98", "message": "XRDDEV-857 Update wizard flow", "committedDate": "2020-03-13T15:45:04Z", "type": "commit"}, {"oid": "3c581a25de4e1f8ff98e0ab194cecbfb8d47b672", "url": "https://github.com/nordic-institute/X-Road/commit/3c581a25de4e1f8ff98e0ab194cecbfb8d47b672", "message": "XRDDEV-857 Add token login", "committedDate": "2020-03-18T16:11:11Z", "type": "commit"}, {"oid": "e75b6f6132c2786bcb0dabb773ff7bf2993cd517", "url": "https://github.com/nordic-institute/X-Road/commit/e75b6f6132c2786bcb0dabb773ff7bf2993cd517", "message": "Merge branch 'develop' into XRDDEV-859-add-subsystem\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/package-lock.json\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json", "committedDate": "2020-03-18T16:17:41Z", "type": "commit"}, {"oid": "1f6c769daaa0cb1860ae83932d28a592eef5916c", "url": "https://github.com/nordic-institute/X-Road/commit/1f6c769daaa0cb1860ae83932d28a592eef5916c", "message": "Merge commit '5ee5ce2a3529df4eb90600a4be6fd07a80d4a9ab' into XRDDEV-859-add-subsystem", "committedDate": "2020-03-19T11:14:43Z", "type": "commit"}, {"oid": "a61c118815e3ec7f59ce46aa534faa486f0f06ea", "url": "https://github.com/nordic-institute/X-Road/commit/a61c118815e3ec7f59ce46aa534faa486f0f06ea", "message": "Merge commit '5ee5ce2a3529df4eb90600a4be6fd07a80d4a9ab' into XRDDEV-857-add-client\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/package-lock.json\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json", "committedDate": "2020-03-19T11:24:41Z", "type": "commit"}, {"oid": "f660709a66b50bb1cb009ccfd1b22d02d7540a7e", "url": "https://github.com/nordic-institute/X-Road/commit/f660709a66b50bb1cb009ccfd1b22d02d7540a7e", "message": "XRDDEV-859 Add register client request", "committedDate": "2020-03-19T12:38:49Z", "type": "commit"}, {"oid": "7958e01dad64a074e83cdab469ca0857887bcac9", "url": "https://github.com/nordic-institute/X-Road/commit/7958e01dad64a074e83cdab469ca0857887bcac9", "message": "XRDDEV-859 Add localised string", "committedDate": "2020-03-19T12:39:49Z", "type": "commit"}, {"oid": "23c4e598cb8b88eb9b101c2c9bd27346b13713b0", "url": "https://github.com/nordic-institute/X-Road/commit/23c4e598cb8b88eb9b101c2c9bd27346b13713b0", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-859-add-subsystem\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/package-lock.json\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json", "committedDate": "2020-03-19T13:14:52Z", "type": "commit"}, {"oid": "5e197fc9f5f15b47b174a4b4b7cac3ff08937727", "url": "https://github.com/nordic-institute/X-Road/commit/5e197fc9f5f15b47b174a4b4b7cac3ff08937727", "message": "XRDDEV-859 Add register client button", "committedDate": "2020-03-19T15:52:35Z", "type": "commit"}, {"oid": "6f980cb9b6eedd222d7381e614d5a99e313901b9", "url": "https://github.com/nordic-institute/X-Road/commit/6f980cb9b6eedd222d7381e614d5a99e313901b9", "message": "XRDDEV-859 Add unregister client button", "committedDate": "2020-03-19T16:17:04Z", "type": "commit"}, {"oid": "5fa9688eb1bcee04ac42d9b6681bbbe2b08206ff", "url": "https://github.com/nordic-institute/X-Road/commit/5fa9688eb1bcee04ac42d9b6681bbbe2b08206ff", "message": "XRDDEV-859 Add subystem adding", "committedDate": "2020-03-19T16:21:25Z", "type": "commit"}, {"oid": "926c3aaeb333c81389f1e0efd33cc6391d49c924", "url": "https://github.com/nordic-institute/X-Road/commit/926c3aaeb333c81389f1e0efd33cc6391d49c924", "message": "XRDDEV-859 Refactor view", "committedDate": "2020-03-19T18:27:12Z", "type": "commit"}, {"oid": "a7c11cdba62dfdc9c7eb810c2117a53e74315fc6", "url": "https://github.com/nordic-institute/X-Road/commit/a7c11cdba62dfdc9c7eb810c2117a53e74315fc6", "message": "XRDDEV-857 Remove unused scss class", "committedDate": "2020-03-20T09:29:53Z", "type": "commit"}, {"oid": "bbb155f9e37e766d4c32aed4417f75c50b92f767", "url": "https://github.com/nordic-institute/X-Road/commit/bbb155f9e37e766d4c32aed4417f75c50b92f767", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-859-add-subsystem", "committedDate": "2020-03-20T09:31:03Z", "type": "commit"}, {"oid": "b819e5436cf720e90325e0f629807025e9e8fd9d", "url": "https://github.com/nordic-institute/X-Road/commit/b819e5436cf720e90325e0f629807025e9e8fd9d", "message": "XRDDEV-859 Adjust checkbox style", "committedDate": "2020-03-23T17:59:04Z", "type": "commit"}, {"oid": "50271e1c0242327f0a962febafd7d8d4024f9ab2", "url": "https://github.com/nordic-institute/X-Road/commit/50271e1c0242327f0a962febafd7d8d4024f9ab2", "message": "Merge commit '8a4d41f03276d52e18b692f7e4ea9eb69a5914b5' into XRDDEV-857-add-client\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/store/index.ts\n#\tsrc/proxy-ui-api/frontend/src/views/KeysAndCertificates/SignAndAuthKeys/SignAndAuthKeys.vue", "committedDate": "2020-03-24T12:58:52Z", "type": "commit"}, {"oid": "04f776509b82bb1f9eabb659d9f32323234705c4", "url": "https://github.com/nordic-institute/X-Road/commit/04f776509b82bb1f9eabb659d9f32323234705c4", "message": "XRDDEV-857 Fix error snackbars", "committedDate": "2020-03-24T13:02:00Z", "type": "commit"}, {"oid": "865daa743f50cb80ba990c45a923a15bb37ee8fc", "url": "https://github.com/nordic-institute/X-Road/commit/865daa743f50cb80ba990c45a923a15bb37ee8fc", "message": "Merge commit '8a4d41f03276d52e18b692f7e4ea9eb69a5914b5' into XRDDEV-859-add-subsystem\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/store/index.ts\n#\tsrc/proxy-ui-api/frontend/src/views/KeysAndCertificates/SignAndAuthKeys/SignAndAuthKeys.vue", "committedDate": "2020-03-24T20:44:18Z", "type": "commit"}, {"oid": "42a755a19819c48b6cb84c77c29907111dfe78db", "url": "https://github.com/nordic-institute/X-Road/commit/42a755a19819c48b6cb84c77c29907111dfe78db", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-859-add-subsystem\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/views/AddClient/ClientDetailsPage.vue", "committedDate": "2020-03-24T20:46:10Z", "type": "commit"}, {"oid": "a1cf3ab3d92a6e9206f80168064aff5317ab59d2", "url": "https://github.com/nordic-institute/X-Road/commit/a1cf3ab3d92a6e9206f80168064aff5317ab59d2", "message": "XRDDEV-859 Remove $bus calls", "committedDate": "2020-03-24T21:05:36Z", "type": "commit"}, {"oid": "4839ac7e60d75bd7bdd60d3c059280359ac123a9", "url": "https://github.com/nordic-institute/X-Road/commit/4839ac7e60d75bd7bdd60d3c059280359ac123a9", "message": "XRDDEV-859 Remove unused action", "committedDate": "2020-03-25T12:34:02Z", "type": "commit"}, {"oid": "6199da173b9344814c913db11ce46097f8021a28", "url": "https://github.com/nordic-institute/X-Road/commit/6199da173b9344814c913db11ce46097f8021a28", "message": "XRDDEV-859 Update buttons", "committedDate": "2020-03-25T13:27:59Z", "type": "commit"}, {"oid": "07824491a90e40c2fe4200d2750abcc2f15b1f65", "url": "https://github.com/nordic-institute/X-Road/commit/07824491a90e40c2fe4200d2750abcc2f15b1f65", "message": "XRDDEV-859 Remove unused component", "committedDate": "2020-03-25T14:32:29Z", "type": "commit"}, {"oid": "465d4cafb533667af7db0e56a8059f330bffeaee", "url": "https://github.com/nordic-institute/X-Road/commit/465d4cafb533667af7db0e56a8059f330bffeaee", "message": "XRDDEV-857 Clean up vuex store", "committedDate": "2020-03-25T15:46:41Z", "type": "commit"}, {"oid": "3a520ebdc41b56920a7de24c5328d46bc9ff8df8", "url": "https://github.com/nordic-institute/X-Road/commit/3a520ebdc41b56920a7de24c5328d46bc9ff8df8", "message": "XRDDEV-857 Fixed a bug on add key dialog", "committedDate": "2020-03-25T16:03:24Z", "type": "commit"}, {"oid": "16bf7e82d9848eda9c771d8054e6140c17c7b84c", "url": "https://github.com/nordic-institute/X-Road/commit/16bf7e82d9848eda9c771d8054e6140c17c7b84c", "message": "Merge commit 'be66b217cef43d5954ca801bb41d8d4a5e85e8b6' into XRDDEV-857-add-client\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/audit-resolve.json\n#\tsrc/proxy-ui-api/frontend/package-lock.json", "committedDate": "2020-03-30T07:10:01Z", "type": "commit"}, {"oid": "9894b449354d8df1c66640cb388eade303e778f8", "url": "https://github.com/nordic-institute/X-Road/commit/9894b449354d8df1c66640cb388eade303e778f8", "message": "XRDDEV-857 Update select client api calls", "committedDate": "2020-04-01T13:11:08Z", "type": "commit"}, {"oid": "1276be4e04b2d98c6751057f7e3f8112f9463930", "url": "https://github.com/nordic-institute/X-Road/commit/1276be4e04b2d98c6751057f7e3f8112f9463930", "message": "XRDDEV-857 Fix build error", "committedDate": "2020-04-01T13:56:00Z", "type": "commit"}, {"oid": "3a5f49451bea59814b9c162796a852481cff849e", "url": "https://github.com/nordic-institute/X-Road/commit/3a5f49451bea59814b9c162796a852481cff849e", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-859-add-subsystem\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/package-lock.json\n#\tsrc/proxy-ui-api/frontend/src/views/AddClient/ClientDetailsPage.vue", "committedDate": "2020-04-01T14:16:18Z", "type": "commit"}, {"oid": "29ffa253ff673fe1a3a532756ed2a803bf9d9785", "url": "https://github.com/nordic-institute/X-Road/commit/29ffa253ff673fe1a3a532756ed2a803bf9d9785", "message": "XRDDEV-857 Change the way clients are passed to the dialog", "committedDate": "2020-04-01T16:12:31Z", "type": "commit"}, {"oid": "f3ef2c8af5fb664cdb1f7b451e0bf11002cc79aa", "url": "https://github.com/nordic-institute/X-Road/commit/f3ef2c8af5fb664cdb1f7b451e0bf11002cc79aa", "message": "XRDDEV-857 Fix duplicate client check", "committedDate": "2020-04-01T16:18:23Z", "type": "commit"}, {"oid": "134f68e63de1559edd60f69ec79b6ba70ddb5a69", "url": "https://github.com/nordic-institute/X-Road/commit/134f68e63de1559edd60f69ec79b6ba70ddb5a69", "message": "XRDDEV-859 Add unregister client functionality", "committedDate": "2020-04-02T07:50:23Z", "type": "commit"}, {"oid": "707e0621f9c4216b1864ed1f207129e8dcd43dfc", "url": "https://github.com/nordic-institute/X-Road/commit/707e0621f9c4216b1864ed1f207129e8dcd43dfc", "message": "XRDDEV-859 Add permission checks", "committedDate": "2020-04-02T08:40:31Z", "type": "commit"}, {"oid": "3467065b2c1c012cc56d47394197ae7afb45265c", "url": "https://github.com/nordic-institute/X-Road/commit/3467065b2c1c012cc56d47394197ae7afb45265c", "message": "XRDDEV-857 Add missing data-test fields", "committedDate": "2020-04-02T12:47:22Z", "type": "commit"}, {"oid": "85f4015de63a20e979a1fca49b30982ee586946e", "url": "https://github.com/nordic-institute/X-Road/commit/85f4015de63a20e979a1fca49b30982ee586946e", "message": "XRDDEV-859 Fix instance id", "committedDate": "2020-04-02T15:48:36Z", "type": "commit"}, {"oid": "9ca07b39bb44e0f15c5f0756b102ae87b7997d01", "url": "https://github.com/nordic-institute/X-Road/commit/9ca07b39bb44e0f15c5f0756b102ae87b7997d01", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-859-add-subsystem", "committedDate": "2020-04-02T15:48:53Z", "type": "commit"}, {"oid": "a596c6de1058b6e0555e0a68fdaa9d2d3a38fe21", "url": "https://github.com/nordic-institute/X-Road/commit/a596c6de1058b6e0555e0a68fdaa9d2d3a38fe21", "message": "XRDDEV-859 Fix data fetching", "committedDate": "2020-04-03T08:04:30Z", "type": "commit"}, {"oid": "5f30f7bb293d305dc6ba62ccc97043829bcb8f03", "url": "https://github.com/nordic-institute/X-Road/commit/5f30f7bb293d305dc6ba62ccc97043829bcb8f03", "message": "XRDDEV-859 Fix data fetching", "committedDate": "2020-04-03T13:16:54Z", "type": "commit"}, {"oid": "31539bd3d4629a1c7009c72b17e98b2a651aee30", "url": "https://github.com/nordic-institute/X-Road/commit/31539bd3d4629a1c7009c72b17e98b2a651aee30", "message": "Merge branch 'develop' into XRDDEV-857-add-client", "committedDate": "2020-04-06T08:50:31Z", "type": "commit"}, {"oid": "9a95468cd21b15e8a13d32d346a7febf661a7e6e", "url": "https://github.com/nordic-institute/X-Road/commit/9a95468cd21b15e8a13d32d346a7febf661a7e6e", "message": "Merge commit '2a9b88114893f1a22b091e4bc3af77029cf5a988' into XRDDEV-857-add-client\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json", "committedDate": "2020-04-06T11:51:05Z", "type": "commit"}, {"oid": "6cc555df537473d85b3ae7b5ee6786f19939f853", "url": "https://github.com/nordic-institute/X-Road/commit/6cc555df537473d85b3ae7b5ee6786f19939f853", "message": "XRDDEV-857 Fixes for PR issues", "committedDate": "2020-04-08T10:18:10Z", "type": "commit"}, {"oid": "f6009df1d5a2fc8ca9eccb19d959a7453893b1f0", "url": "https://github.com/nordic-institute/X-Road/commit/f6009df1d5a2fc8ca9eccb19d959a7453893b1f0", "message": "XRDDEV-857 Fix missing PR issues", "committedDate": "2020-04-08T16:45:53Z", "type": "commit"}, {"oid": "59a3aef7ef6231a31b00ea0375a6d3cf7d5074d0", "url": "https://github.com/nordic-institute/X-Road/commit/59a3aef7ef6231a31b00ea0375a6d3cf7d5074d0", "message": "Merge branch 'develop' into XRDDEV-859-add-subsystem\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json", "committedDate": "2020-04-08T20:21:56Z", "type": "commit"}, {"oid": "4ba9a5e0794c77577940ac31bcc9550babc6c5cf", "url": "https://github.com/nordic-institute/X-Road/commit/4ba9a5e0794c77577940ac31bcc9550babc6c5cf", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-859-add-subsystem", "committedDate": "2020-04-08T20:32:12Z", "type": "commit"}, {"oid": "6fd2d8674a4a960158dee344f8deb295d0f65e68", "url": "https://github.com/nordic-institute/X-Road/commit/6fd2d8674a4a960158dee344f8deb295d0f65e68", "message": "Merge branch 'develop' into XRDDEV-859-add-subsystem\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/assets/wizards.scss\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json\n#\tsrc/proxy-ui-api/frontend/src/store/modules/addClient.ts\n#\tsrc/proxy-ui-api/frontend/src/views/AddClient/ClientDetailsPage.vue", "committedDate": "2020-04-09T12:14:47Z", "type": "commit"}, {"oid": "f67fd3ceb48ec4f4ad57e383d88ef664ebe44d78", "url": "https://github.com/nordic-institute/X-Road/commit/f67fd3ceb48ec4f4ad57e383d88ef664ebe44d78", "message": "XRDDEV-859 Update comments", "committedDate": "2020-04-09T13:14:44Z", "type": "commit"}, {"oid": "891536989e300d518446b01707e92dfcc372df69", "url": "https://github.com/nordic-institute/X-Road/commit/891536989e300d518446b01707e92dfcc372df69", "message": "Merge branch 'develop' into XRDDEV-859-add-subsystem", "committedDate": "2020-04-09T16:28:23Z", "type": "commit"}, {"oid": "06481e0be69e39fa393c227eed877b40ad7b871f", "url": "https://github.com/nordic-institute/X-Road/commit/06481e0be69e39fa393c227eed877b40ad7b871f", "message": "XRDDEV-859 Use the new owner value in clients list", "committedDate": "2020-04-15T06:15:24Z", "type": "commit"}, {"oid": "81d04d4413bd55a34a99471d5cb5ae55c90e6c58", "url": "https://github.com/nordic-institute/X-Road/commit/81d04d4413bd55a34a99471d5cb5ae55c90e6c58", "message": "Merge branch 'develop' into XRDDEV-859-add-subsystem", "committedDate": "2020-04-15T10:30:43Z", "type": "commit"}, {"oid": "7282cd0f31efecd3384ce95de88285bb05a512c0", "url": "https://github.com/nordic-institute/X-Road/commit/7282cd0f31efecd3384ce95de88285bb05a512c0", "message": "XRDDEV-859 Add confirm dialog to register", "committedDate": "2020-04-15T16:09:39Z", "type": "commit"}, {"oid": "761d3aa457de324e9a8e77deedf4e41acee34fd5", "url": "https://github.com/nordic-institute/X-Road/commit/761d3aa457de324e9a8e77deedf4e41acee34fd5", "message": "XRDDEV-859 Update register client", "committedDate": "2020-04-16T12:38:36Z", "type": "commit"}, {"oid": "1d600a2cbca7c0b4a7555b51b5cf4463da1fb90b", "url": "https://github.com/nordic-institute/X-Road/commit/1d600a2cbca7c0b4a7555b51b5cf4463da1fb90b", "message": "Merge branch 'develop' into XRDDEV-859-add-subsystem", "committedDate": "2020-04-16T12:47:01Z", "type": "commit"}, {"oid": "4bb5a2836d2cc6f6641e2546976ca1e689bec99c", "url": "https://github.com/nordic-institute/X-Road/commit/4bb5a2836d2cc6f6641e2546976ca1e689bec99c", "message": "Merge branch 'develop' into XRDDEV-859-add-subsystem", "committedDate": "2020-04-20T16:29:52Z", "type": "commit"}, {"oid": "45e7fa87eaeda5afb647e6ef779a02bd7296fc69", "url": "https://github.com/nordic-institute/X-Road/commit/45e7fa87eaeda5afb647e6ef779a02bd7296fc69", "message": "XRDDEV-859 Fix loading spinner", "committedDate": "2020-04-20T16:51:13Z", "type": "commit"}, {"oid": "ced71da1bd1e03bb7e4bd237548961f62afe7a9a", "url": "https://github.com/nordic-institute/X-Road/commit/ced71da1bd1e03bb7e4bd237548961f62afe7a9a", "message": "XRDDEV-859 Fix if clauses", "committedDate": "2020-04-20T16:56:46Z", "type": "commit"}, {"oid": "032d477d1c09fa7ad6f0e5eb2504fe8c34cfb680", "url": "https://github.com/nordic-institute/X-Road/commit/032d477d1c09fa7ad6f0e5eb2504fe8c34cfb680", "message": "XRDDEV-859 Fix unit test data", "committedDate": "2020-04-21T11:45:28Z", "type": "commit"}, {"oid": "4525895a567d206a563348c8543c7e8a041c2b30", "url": "https://github.com/nordic-institute/X-Road/commit/4525895a567d206a563348c8543c7e8a041c2b30", "message": "XRDDEV-859 Fix unit test data again", "committedDate": "2020-04-21T12:12:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUwOTM5Nw==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415509397", "bodyText": "There are a couple of changes to queryparameters in develop so I guess this change should be made:\nis_not_local_client -> exclude_local\nAlso internal_search -queryparameter can be removed. Actually only true value would do filtering, false does nothing.", "author": "TJaakkola", "createdAt": "2020-04-27T04:54:51Z", "path": "src/proxy-ui-api/frontend/src/store/modules/addClient.ts", "diffHunk": "@@ -112,12 +112,33 @@ export const actions: ActionTree<AddClientState, RootState> = {\n       });\n   },\n \n+  fetchSelectableForSubsystem({ commit, rootGetters }, client: Client) {\n+    // Fetch clients from backend that match the selected client without subsystem code\n+    return api.get(`/clients?instance=${client.instance_id}&member_class=${client.member_class}&member_code=${client.member_code}&internal_search=false&show_members=false&is_not_local_client=true`)", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MTMxOA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415951318", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:13:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUwOTM5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUxMDQzOQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415510439", "bodyText": "Same as above", "author": "TJaakkola", "createdAt": "2020-04-27T04:58:03Z", "path": "src/proxy-ui-api/frontend/src/store/modules/addClient.ts", "diffHunk": "@@ -112,12 +112,33 @@ export const actions: ActionTree<AddClientState, RootState> = {\n       });\n   },\n \n+  fetchSelectableForSubsystem({ commit, rootGetters }, client: Client) {\n+    // Fetch clients from backend that match the selected client without subsystem code\n+    return api.get(`/clients?instance=${client.instance_id}&member_class=${client.member_class}&member_code=${client.member_code}&internal_search=false&show_members=false&is_not_local_client=true`)\n+      .then((res) => {\n+        commit('storeReservedClients', res.data);\n+      })\n+      .catch((error) => {\n+        throw error;\n+      });\n+  },\n+\n+  fetchReservedSubsystems({ commit, rootGetters }, client: Client) {\n+    // Fetch clients from backend that match the selected client without subsystem code\n+    return api.get(`/clients?instance=${client.instance_id}&member_class=${client.member_class}&member_code=${client.member_code}&internal_search=true`)", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MjYyNg==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415952626", "bodyText": "Here the internal_search is using true which I suppose is the right thing here. Now I moved the whole method out of vuex, but the call is still same.", "author": "Riippi", "createdAt": "2020-04-27T16:15:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUxMDQzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUyMDU1Ng==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415520556", "bodyText": "It feels a bit inconsistent that we have here 3 methods returning a promise and one of them having error handling but the two others do not. I wonder if we could come up a more consistent way?", "author": "TJaakkola", "createdAt": "2020-04-27T05:28:24Z", "path": "src/proxy-ui-api/frontend/src/store/modules/client.ts", "diffHunk": "@@ -210,6 +202,33 @@ export const actions: ActionTree<ClientState, RootState> = {\n \n   },\n \n+  registerClient({ commit, state }, { instanceId, memberClass, memberCode, subsystemCode }) {\n+    const clientId = instanceId + ':' + memberClass + ':' + memberCode + ':' + subsystemCode;\n+    return axios.put(`/clients/${clientId}/register`, {});", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MjczNA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415952734", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:15:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUyMDU1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUyNjQ0NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415526445", "bodyText": "at least 3 data-test -attributes with the 'selected-member-name' -value", "author": "TJaakkola", "createdAt": "2020-04-27T05:45:49Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,317 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_name}}</div>", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MjgxOQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415952819", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:15:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUyNjQ0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUyNzkzNw==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415527937", "bodyText": "add typings to all values in data-block", "author": "TJaakkola", "createdAt": "2020-04-27T05:49:53Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,317 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_name}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_class}}</div>\n+        </div>\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_code}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel\n+            labelText=\"wizard.subsystemCode\"\n+            helpText=\"wizard.client.subsystemCodeTooltip\"\n+          />\n+\n+          <ValidationProvider name=\"addClient.subsystemCode\" rules=\"required\" v-slot=\"{ errors }\">\n+            <v-text-field\n+              class=\"form-input\"\n+              type=\"text\"\n+              :error-messages=\"errors\"\n+              v-model=\"subsystemCode\"\n+              data-test=\"subsystem-code-input\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.subsystem.registerSubsystem\" />\n+          <v-checkbox\n+            v-model=\"registerChecked\"\n+            color=\"primary\"\n+            class=\"register-checkbox\"\n+            data-test=\"register-subsystem-checkbox\"\n+          ></v-checkbox>\n+        </div>\n+        <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+        <div class=\"button-footer\">\n+          <div class=\"button-group\">\n+            <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+          </div>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid\"\n+            data-test=\"submit-add-subsystem-button\"\n+          >{{$t('action.addSubsystem')}}</large-button>\n+        </div>\n+      </ValidationObserver>\n+\n+      <SelectClientDialog\n+        :dialog=\"showSelectClient\"\n+        :selectableClients=\"selectableClients\"\n+        @cancel=\"showSelectClient = false\"\n+        @save=\"saveSelectedClient\"\n+      />\n+    </div>\n+  </div>\n </template>\n \n <script lang=\"ts\">\n import Vue from 'vue';\n-import { RouteName } from '@/global';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import SubsystemDetailsPage from './SubsystemDetailsPage.vue';\n+import SelectClientDialog from '@/views/AddClient/SelectClientDialog.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { Key, Token } from '@/types';\n+import { RouteName, UsageTypes } from '@/global';\n+import { Client } from '@/types';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+import * as api from '@/util/api';\n \n export default Vue.extend({\n-  data: () => ({\n-    member: {\n-      name: 'Kuikka',\n-      class: 'Org',\n-      code: '111',\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+    SubViewTitle,\n+  },\n+  props: {\n+    clientId: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      registerChecked: true,", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1Mjk2NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415952965", "bodyText": "Added typings", "author": "Riippi", "createdAt": "2020-04-27T16:15:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUyNzkzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUyODk4OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415528989", "bodyText": "Wrap if-clause condition in to a separate function for better readability", "author": "TJaakkola", "createdAt": "2020-04-27T05:52:38Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,317 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_name}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_class}}</div>\n+        </div>\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_code}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel\n+            labelText=\"wizard.subsystemCode\"\n+            helpText=\"wizard.client.subsystemCodeTooltip\"\n+          />\n+\n+          <ValidationProvider name=\"addClient.subsystemCode\" rules=\"required\" v-slot=\"{ errors }\">\n+            <v-text-field\n+              class=\"form-input\"\n+              type=\"text\"\n+              :error-messages=\"errors\"\n+              v-model=\"subsystemCode\"\n+              data-test=\"subsystem-code-input\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.subsystem.registerSubsystem\" />\n+          <v-checkbox\n+            v-model=\"registerChecked\"\n+            color=\"primary\"\n+            class=\"register-checkbox\"\n+            data-test=\"register-subsystem-checkbox\"\n+          ></v-checkbox>\n+        </div>\n+        <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+        <div class=\"button-footer\">\n+          <div class=\"button-group\">\n+            <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+          </div>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid\"\n+            data-test=\"submit-add-subsystem-button\"\n+          >{{$t('action.addSubsystem')}}</large-button>\n+        </div>\n+      </ValidationObserver>\n+\n+      <SelectClientDialog\n+        :dialog=\"showSelectClient\"\n+        :selectableClients=\"selectableClients\"\n+        @cancel=\"showSelectClient = false\"\n+        @save=\"saveSelectedClient\"\n+      />\n+    </div>\n+  </div>\n </template>\n \n <script lang=\"ts\">\n import Vue from 'vue';\n-import { RouteName } from '@/global';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import SubsystemDetailsPage from './SubsystemDetailsPage.vue';\n+import SelectClientDialog from '@/views/AddClient/SelectClientDialog.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { Key, Token } from '@/types';\n+import { RouteName, UsageTypes } from '@/global';\n+import { Client } from '@/types';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+import * as api from '@/util/api';\n \n export default Vue.extend({\n-  data: () => ({\n-    member: {\n-      name: 'Kuikka',\n-      class: 'Org',\n-      code: '111',\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+    SubViewTitle,\n+  },\n+  props: {\n+    clientId: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      registerChecked: true,\n+    };\n+  },\n+  computed: {\n+    ...mapGetters(['client', 'selectableClients', 'reservedClients']),\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    subsystemCode: {\n+      get(): string {\n+        return this.$store.getters.subsystemCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setSubsystemCode', value);\n+      },\n+    },\n+\n+    selectedMember: {\n+      get(): Client {\n+        return this.$store.getters.selectedMember;\n+      },\n+      set(value: Client) {\n+        this.$store.commit('setMember', value);\n+      },\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode || !this.subsystemCode) {\n+        return false;\n+      }\n+\n+      if (\n+        this.reservedClients.some((e: Client) => {\n+          if (e.member_class.toLowerCase() !== this.memberClass.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.member_code.toLowerCase() !== this.memberCode.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.subsystem_code !== this.subsystemCode) {\n+            return false;\n+          }\n+          return true;\n+        })", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MzI5OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953299", "bodyText": "Fixed. It's using a shared function now.", "author": "Riippi", "createdAt": "2020-04-27T16:16:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUyODk4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMDE4OA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415530188", "bodyText": "response is not used. I think it could be removed.", "author": "TJaakkola", "createdAt": "2020-04-27T05:55:52Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,317 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_name}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_class}}</div>\n+        </div>\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_code}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel\n+            labelText=\"wizard.subsystemCode\"\n+            helpText=\"wizard.client.subsystemCodeTooltip\"\n+          />\n+\n+          <ValidationProvider name=\"addClient.subsystemCode\" rules=\"required\" v-slot=\"{ errors }\">\n+            <v-text-field\n+              class=\"form-input\"\n+              type=\"text\"\n+              :error-messages=\"errors\"\n+              v-model=\"subsystemCode\"\n+              data-test=\"subsystem-code-input\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.subsystem.registerSubsystem\" />\n+          <v-checkbox\n+            v-model=\"registerChecked\"\n+            color=\"primary\"\n+            class=\"register-checkbox\"\n+            data-test=\"register-subsystem-checkbox\"\n+          ></v-checkbox>\n+        </div>\n+        <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+        <div class=\"button-footer\">\n+          <div class=\"button-group\">\n+            <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+          </div>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid\"\n+            data-test=\"submit-add-subsystem-button\"\n+          >{{$t('action.addSubsystem')}}</large-button>\n+        </div>\n+      </ValidationObserver>\n+\n+      <SelectClientDialog\n+        :dialog=\"showSelectClient\"\n+        :selectableClients=\"selectableClients\"\n+        @cancel=\"showSelectClient = false\"\n+        @save=\"saveSelectedClient\"\n+      />\n+    </div>\n+  </div>\n </template>\n \n <script lang=\"ts\">\n import Vue from 'vue';\n-import { RouteName } from '@/global';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import SubsystemDetailsPage from './SubsystemDetailsPage.vue';\n+import SelectClientDialog from '@/views/AddClient/SelectClientDialog.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { Key, Token } from '@/types';\n+import { RouteName, UsageTypes } from '@/global';\n+import { Client } from '@/types';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+import * as api from '@/util/api';\n \n export default Vue.extend({\n-  data: () => ({\n-    member: {\n-      name: 'Kuikka',\n-      class: 'Org',\n-      code: '111',\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+    SubViewTitle,\n+  },\n+  props: {\n+    clientId: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      registerChecked: true,\n+    };\n+  },\n+  computed: {\n+    ...mapGetters(['client', 'selectableClients', 'reservedClients']),\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    subsystemCode: {\n+      get(): string {\n+        return this.$store.getters.subsystemCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setSubsystemCode', value);\n+      },\n+    },\n+\n+    selectedMember: {\n+      get(): Client {\n+        return this.$store.getters.selectedMember;\n+      },\n+      set(value: Client) {\n+        this.$store.commit('setMember', value);\n+      },\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode || !this.subsystemCode) {\n+        return false;\n+      }\n+\n+      if (\n+        this.reservedClients.some((e: Client) => {\n+          if (e.member_class.toLowerCase() !== this.memberClass.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.member_code.toLowerCase() !== this.memberCode.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.subsystem_code !== this.subsystemCode) {\n+            return false;\n+          }\n+          return true;\n+        })\n+      ) {\n+        return true;\n+      }\n+\n+      return false;\n     },\n-  }),\n+  },\n   methods: {\n-    addSubsystem() {\n-      console.log('add subsystem');\n+    cancel(): void {\n+      this.$store.dispatch('resetState');\n+      this.$store.dispatch('resetAddClientState');\n+      this.$router.replace({ name: RouteName.Clients });\n+    },\n+    done(): void {\n+      this.$store\n+        .dispatch('addSubsystem', {\n+          memberName: this.client.member_name,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MzQ3Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953473", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:16:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMDE4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMDI0Mg==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415530242", "bodyText": "response is not used", "author": "TJaakkola", "createdAt": "2020-04-27T05:56:00Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,317 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_name}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_class}}</div>\n+        </div>\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_code}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel\n+            labelText=\"wizard.subsystemCode\"\n+            helpText=\"wizard.client.subsystemCodeTooltip\"\n+          />\n+\n+          <ValidationProvider name=\"addClient.subsystemCode\" rules=\"required\" v-slot=\"{ errors }\">\n+            <v-text-field\n+              class=\"form-input\"\n+              type=\"text\"\n+              :error-messages=\"errors\"\n+              v-model=\"subsystemCode\"\n+              data-test=\"subsystem-code-input\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.subsystem.registerSubsystem\" />\n+          <v-checkbox\n+            v-model=\"registerChecked\"\n+            color=\"primary\"\n+            class=\"register-checkbox\"\n+            data-test=\"register-subsystem-checkbox\"\n+          ></v-checkbox>\n+        </div>\n+        <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+        <div class=\"button-footer\">\n+          <div class=\"button-group\">\n+            <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+          </div>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid\"\n+            data-test=\"submit-add-subsystem-button\"\n+          >{{$t('action.addSubsystem')}}</large-button>\n+        </div>\n+      </ValidationObserver>\n+\n+      <SelectClientDialog\n+        :dialog=\"showSelectClient\"\n+        :selectableClients=\"selectableClients\"\n+        @cancel=\"showSelectClient = false\"\n+        @save=\"saveSelectedClient\"\n+      />\n+    </div>\n+  </div>\n </template>\n \n <script lang=\"ts\">\n import Vue from 'vue';\n-import { RouteName } from '@/global';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import SubsystemDetailsPage from './SubsystemDetailsPage.vue';\n+import SelectClientDialog from '@/views/AddClient/SelectClientDialog.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { Key, Token } from '@/types';\n+import { RouteName, UsageTypes } from '@/global';\n+import { Client } from '@/types';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+import * as api from '@/util/api';\n \n export default Vue.extend({\n-  data: () => ({\n-    member: {\n-      name: 'Kuikka',\n-      class: 'Org',\n-      code: '111',\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+    SubViewTitle,\n+  },\n+  props: {\n+    clientId: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      registerChecked: true,\n+    };\n+  },\n+  computed: {\n+    ...mapGetters(['client', 'selectableClients', 'reservedClients']),\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    subsystemCode: {\n+      get(): string {\n+        return this.$store.getters.subsystemCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setSubsystemCode', value);\n+      },\n+    },\n+\n+    selectedMember: {\n+      get(): Client {\n+        return this.$store.getters.selectedMember;\n+      },\n+      set(value: Client) {\n+        this.$store.commit('setMember', value);\n+      },\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode || !this.subsystemCode) {\n+        return false;\n+      }\n+\n+      if (\n+        this.reservedClients.some((e: Client) => {\n+          if (e.member_class.toLowerCase() !== this.memberClass.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.member_code.toLowerCase() !== this.memberCode.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.subsystem_code !== this.subsystemCode) {\n+            return false;\n+          }\n+          return true;\n+        })\n+      ) {\n+        return true;\n+      }\n+\n+      return false;\n     },\n-  }),\n+  },\n   methods: {\n-    addSubsystem() {\n-      console.log('add subsystem');\n+    cancel(): void {\n+      this.$store.dispatch('resetState');\n+      this.$store.dispatch('resetAddClientState');\n+      this.$router.replace({ name: RouteName.Clients });\n+    },\n+    done(): void {\n+      this.$store\n+        .dispatch('addSubsystem', {\n+          memberName: this.client.member_name,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {\n+            this.disableDone = false;\n+\n+            if (this.registerChecked) {\n+              this.registerSubsystem();\n+            } else {\n+              this.exitView();\n+            }\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        );\n+    },\n+\n+    registerSubsystem(): void {\n+      this.$store\n+        .dispatch('registerClient', {\n+          instanceId: this.client.instance_id,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MzU0MQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953541", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:16:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMDI0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMDQ2Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415530463", "bodyText": "response is not used", "author": "TJaakkola", "createdAt": "2020-04-27T05:56:24Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,317 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_name}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_class}}</div>\n+        </div>\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_code}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel\n+            labelText=\"wizard.subsystemCode\"\n+            helpText=\"wizard.client.subsystemCodeTooltip\"\n+          />\n+\n+          <ValidationProvider name=\"addClient.subsystemCode\" rules=\"required\" v-slot=\"{ errors }\">\n+            <v-text-field\n+              class=\"form-input\"\n+              type=\"text\"\n+              :error-messages=\"errors\"\n+              v-model=\"subsystemCode\"\n+              data-test=\"subsystem-code-input\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.subsystem.registerSubsystem\" />\n+          <v-checkbox\n+            v-model=\"registerChecked\"\n+            color=\"primary\"\n+            class=\"register-checkbox\"\n+            data-test=\"register-subsystem-checkbox\"\n+          ></v-checkbox>\n+        </div>\n+        <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+        <div class=\"button-footer\">\n+          <div class=\"button-group\">\n+            <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+          </div>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid\"\n+            data-test=\"submit-add-subsystem-button\"\n+          >{{$t('action.addSubsystem')}}</large-button>\n+        </div>\n+      </ValidationObserver>\n+\n+      <SelectClientDialog\n+        :dialog=\"showSelectClient\"\n+        :selectableClients=\"selectableClients\"\n+        @cancel=\"showSelectClient = false\"\n+        @save=\"saveSelectedClient\"\n+      />\n+    </div>\n+  </div>\n </template>\n \n <script lang=\"ts\">\n import Vue from 'vue';\n-import { RouteName } from '@/global';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import SubsystemDetailsPage from './SubsystemDetailsPage.vue';\n+import SelectClientDialog from '@/views/AddClient/SelectClientDialog.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { Key, Token } from '@/types';\n+import { RouteName, UsageTypes } from '@/global';\n+import { Client } from '@/types';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+import * as api from '@/util/api';\n \n export default Vue.extend({\n-  data: () => ({\n-    member: {\n-      name: 'Kuikka',\n-      class: 'Org',\n-      code: '111',\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+    SubViewTitle,\n+  },\n+  props: {\n+    clientId: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      registerChecked: true,\n+    };\n+  },\n+  computed: {\n+    ...mapGetters(['client', 'selectableClients', 'reservedClients']),\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    subsystemCode: {\n+      get(): string {\n+        return this.$store.getters.subsystemCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setSubsystemCode', value);\n+      },\n+    },\n+\n+    selectedMember: {\n+      get(): Client {\n+        return this.$store.getters.selectedMember;\n+      },\n+      set(value: Client) {\n+        this.$store.commit('setMember', value);\n+      },\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode || !this.subsystemCode) {\n+        return false;\n+      }\n+\n+      if (\n+        this.reservedClients.some((e: Client) => {\n+          if (e.member_class.toLowerCase() !== this.memberClass.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.member_code.toLowerCase() !== this.memberCode.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.subsystem_code !== this.subsystemCode) {\n+            return false;\n+          }\n+          return true;\n+        })\n+      ) {\n+        return true;\n+      }\n+\n+      return false;\n     },\n-  }),\n+  },\n   methods: {\n-    addSubsystem() {\n-      console.log('add subsystem');\n+    cancel(): void {\n+      this.$store.dispatch('resetState');\n+      this.$store.dispatch('resetAddClientState');\n+      this.$router.replace({ name: RouteName.Clients });\n+    },\n+    done(): void {\n+      this.$store\n+        .dispatch('addSubsystem', {\n+          memberName: this.client.member_name,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {\n+            this.disableDone = false;\n+\n+            if (this.registerChecked) {\n+              this.registerSubsystem();\n+            } else {\n+              this.exitView();\n+            }\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        );\n+    },\n+\n+    registerSubsystem(): void {\n+      this.$store\n+        .dispatch('registerClient', {\n+          instanceId: this.client.instance_id,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {\n+            this.disableDone = false;\n+            this.exitView();\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        );\n     },\n-    cancel() {\n+\n+    clientDetailsReady(): void {\n+      this.$store.dispatch('showSuccess', 'subsystem_code');\n+    },\n+\n+    exitView(): void {\n+      this.$store.dispatch('resetState');\n+      this.$store.dispatch('resetAddClientState');\n       this.$router.replace({ name: RouteName.Clients });\n     },\n+    saveSelectedClient(selectedMember: Client): void {\n+      this.$store.dispatch('setSelectedMember', selectedMember).then(\n+        (response) => {", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MzYwNg==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953606", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:16:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMDQ2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMDY2MA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415530660", "bodyText": "response is not used", "author": "TJaakkola", "createdAt": "2020-04-27T05:56:53Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,317 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_name}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_class}}</div>\n+        </div>\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_code}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel\n+            labelText=\"wizard.subsystemCode\"\n+            helpText=\"wizard.client.subsystemCodeTooltip\"\n+          />\n+\n+          <ValidationProvider name=\"addClient.subsystemCode\" rules=\"required\" v-slot=\"{ errors }\">\n+            <v-text-field\n+              class=\"form-input\"\n+              type=\"text\"\n+              :error-messages=\"errors\"\n+              v-model=\"subsystemCode\"\n+              data-test=\"subsystem-code-input\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.subsystem.registerSubsystem\" />\n+          <v-checkbox\n+            v-model=\"registerChecked\"\n+            color=\"primary\"\n+            class=\"register-checkbox\"\n+            data-test=\"register-subsystem-checkbox\"\n+          ></v-checkbox>\n+        </div>\n+        <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+        <div class=\"button-footer\">\n+          <div class=\"button-group\">\n+            <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+          </div>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid\"\n+            data-test=\"submit-add-subsystem-button\"\n+          >{{$t('action.addSubsystem')}}</large-button>\n+        </div>\n+      </ValidationObserver>\n+\n+      <SelectClientDialog\n+        :dialog=\"showSelectClient\"\n+        :selectableClients=\"selectableClients\"\n+        @cancel=\"showSelectClient = false\"\n+        @save=\"saveSelectedClient\"\n+      />\n+    </div>\n+  </div>\n </template>\n \n <script lang=\"ts\">\n import Vue from 'vue';\n-import { RouteName } from '@/global';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import SubsystemDetailsPage from './SubsystemDetailsPage.vue';\n+import SelectClientDialog from '@/views/AddClient/SelectClientDialog.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { Key, Token } from '@/types';\n+import { RouteName, UsageTypes } from '@/global';\n+import { Client } from '@/types';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+import * as api from '@/util/api';\n \n export default Vue.extend({\n-  data: () => ({\n-    member: {\n-      name: 'Kuikka',\n-      class: 'Org',\n-      code: '111',\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+    SubViewTitle,\n+  },\n+  props: {\n+    clientId: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      registerChecked: true,\n+    };\n+  },\n+  computed: {\n+    ...mapGetters(['client', 'selectableClients', 'reservedClients']),\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    subsystemCode: {\n+      get(): string {\n+        return this.$store.getters.subsystemCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setSubsystemCode', value);\n+      },\n+    },\n+\n+    selectedMember: {\n+      get(): Client {\n+        return this.$store.getters.selectedMember;\n+      },\n+      set(value: Client) {\n+        this.$store.commit('setMember', value);\n+      },\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode || !this.subsystemCode) {\n+        return false;\n+      }\n+\n+      if (\n+        this.reservedClients.some((e: Client) => {\n+          if (e.member_class.toLowerCase() !== this.memberClass.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.member_code.toLowerCase() !== this.memberCode.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.subsystem_code !== this.subsystemCode) {\n+            return false;\n+          }\n+          return true;\n+        })\n+      ) {\n+        return true;\n+      }\n+\n+      return false;\n     },\n-  }),\n+  },\n   methods: {\n-    addSubsystem() {\n-      console.log('add subsystem');\n+    cancel(): void {\n+      this.$store.dispatch('resetState');\n+      this.$store.dispatch('resetAddClientState');\n+      this.$router.replace({ name: RouteName.Clients });\n+    },\n+    done(): void {\n+      this.$store\n+        .dispatch('addSubsystem', {\n+          memberName: this.client.member_name,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {\n+            this.disableDone = false;\n+\n+            if (this.registerChecked) {\n+              this.registerSubsystem();\n+            } else {\n+              this.exitView();\n+            }\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        );\n+    },\n+\n+    registerSubsystem(): void {\n+      this.$store\n+        .dispatch('registerClient', {\n+          instanceId: this.client.instance_id,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {\n+            this.disableDone = false;\n+            this.exitView();\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        );\n     },\n-    cancel() {\n+\n+    clientDetailsReady(): void {\n+      this.$store.dispatch('showSuccess', 'subsystem_code');\n+    },\n+\n+    exitView(): void {\n+      this.$store.dispatch('resetState');\n+      this.$store.dispatch('resetAddClientState');\n       this.$router.replace({ name: RouteName.Clients });\n     },\n+    saveSelectedClient(selectedMember: Client): void {\n+      this.$store.dispatch('setSelectedMember', selectedMember).then(\n+        (response) => {\n+          this.$store.dispatch('fetchReservedSubsystems', selectedMember);\n+        },\n+        (error) => {\n+          this.$store.dispatch('showError', error);\n+        },\n+      );\n+      this.showSelectClient = false;\n+    },\n+    fetchData(): void {\n+      // Fetch \"parent\" client from backend\n+      this.$store.dispatch('fetchClient', this.clientId).then(\n+        (response) => {", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MzY3Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953673", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:16:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMDY2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMjUxNw==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415532517", "bodyText": "Perhaps refactor styles here so that they're consistent in using hierarchial style definitions. .view-wrap contains all the other class style definitions in this comment rows. Currently only info-block and action-block hierarchy is defined.", "author": "TJaakkola", "createdAt": "2020-04-27T06:01:34Z", "path": "src/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue", "diffHunk": "@@ -1,83 +1,317 @@\n+\n <template>\n-  <v-container class=\"xrd-tab-max-width\">\n-    <v-layout text-xs-center wrap column>\n-      <v-flex mb-4>\n-        <h1 class=\"display-1 font-weight-bold mb-3\">Add a Subsystem</h1>\n-        <p\n-          class=\"subheading font-weight-regular\"\n-        >Specify the name of the Subsystem and add it to the selected Member.</p>\n-      </v-flex>\n-      <v-layout pa-4 column>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Name</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.name}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Class</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.class}}</v-flex>\n-        </v-layout>\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Member Code</v-flex>\n-          <v-flex mb-4 class=\"subs-input\">{{member.code}}</v-flex>\n-        </v-layout>\n-\n-        <v-layout mb-4 row justify-start>\n-          <v-flex mb-4 class=\"input-title\">Subsystem Name</v-flex>\n-          <v-text-field label=\"Regular\" class=\"input-name\"></v-text-field>\n-        </v-layout>\n-      </v-layout>\n-\n-      <v-layout mb-4 justify-space-between>\n-        <v-btn color=\"primary\" @click=\"cancel\" rounded outlined class=\"mb-2 rounded-button\">Cancel</v-btn>\n-\n-        <v-btn\n-          color=\"primary\"\n-          @click=\"addSubsystem\"\n-          rounded\n-          dark\n-          class=\"mb-2 rounded-button\"\n-        >Add subsystem</v-btn>\n-      </v-layout>\n-    </v-layout>\n-  </v-container>\n+  <div class=\"view-wrap\">\n+    <subViewTitle class=\"view-title\" :title=\"$t('wizard.subsystem.title')\" :showClose=\"false\" />\n+\n+    <div class=\"content\">\n+      <div class=\"info-block\">\n+        <div>\n+          {{$t('wizard.subsystem.info1')}}\n+          <br />\n+          <br />\n+          {{$t('wizard.subsystem.info2')}}\n+        </div>\n+        <div class=\"action-block\">\n+          <large-button\n+            @click=\"showSelectClient = true\"\n+            outlined\n+            data-test=\"select-subsystem-button\"\n+          >{{$t('wizard.subsystem.selectSubsystem')}}</large-button>\n+        </div>\n+      </div>\n+\n+      <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_name}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_class}}</div>\n+        </div>\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+          <div v-if=\"client\" data-test=\"selected-member-name\">{{client.member_code}}</div>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel\n+            labelText=\"wizard.subsystemCode\"\n+            helpText=\"wizard.client.subsystemCodeTooltip\"\n+          />\n+\n+          <ValidationProvider name=\"addClient.subsystemCode\" rules=\"required\" v-slot=\"{ errors }\">\n+            <v-text-field\n+              class=\"form-input\"\n+              type=\"text\"\n+              :error-messages=\"errors\"\n+              v-model=\"subsystemCode\"\n+              data-test=\"subsystem-code-input\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+\n+        <div class=\"row-wrap\">\n+          <FormLabel labelText=\"wizard.subsystem.registerSubsystem\" />\n+          <v-checkbox\n+            v-model=\"registerChecked\"\n+            color=\"primary\"\n+            class=\"register-checkbox\"\n+            data-test=\"register-subsystem-checkbox\"\n+          ></v-checkbox>\n+        </div>\n+        <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+        <div class=\"button-footer\">\n+          <div class=\"button-group\">\n+            <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+          </div>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid\"\n+            data-test=\"submit-add-subsystem-button\"\n+          >{{$t('action.addSubsystem')}}</large-button>\n+        </div>\n+      </ValidationObserver>\n+\n+      <SelectClientDialog\n+        :dialog=\"showSelectClient\"\n+        :selectableClients=\"selectableClients\"\n+        @cancel=\"showSelectClient = false\"\n+        @save=\"saveSelectedClient\"\n+      />\n+    </div>\n+  </div>\n </template>\n \n <script lang=\"ts\">\n import Vue from 'vue';\n-import { RouteName } from '@/global';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import SubsystemDetailsPage from './SubsystemDetailsPage.vue';\n+import SelectClientDialog from '@/views/AddClient/SelectClientDialog.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { Key, Token } from '@/types';\n+import { RouteName, UsageTypes } from '@/global';\n+import { Client } from '@/types';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+import * as api from '@/util/api';\n \n export default Vue.extend({\n-  data: () => ({\n-    member: {\n-      name: 'Kuikka',\n-      class: 'Org',\n-      code: '111',\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+    SubViewTitle,\n+  },\n+  props: {\n+    clientId: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      registerChecked: true,\n+    };\n+  },\n+  computed: {\n+    ...mapGetters(['client', 'selectableClients', 'reservedClients']),\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    subsystemCode: {\n+      get(): string {\n+        return this.$store.getters.subsystemCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setSubsystemCode', value);\n+      },\n+    },\n+\n+    selectedMember: {\n+      get(): Client {\n+        return this.$store.getters.selectedMember;\n+      },\n+      set(value: Client) {\n+        this.$store.commit('setMember', value);\n+      },\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode || !this.subsystemCode) {\n+        return false;\n+      }\n+\n+      if (\n+        this.reservedClients.some((e: Client) => {\n+          if (e.member_class.toLowerCase() !== this.memberClass.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.member_code.toLowerCase() !== this.memberCode.toLowerCase()) {\n+            return false;\n+          }\n+\n+          if (e.subsystem_code !== this.subsystemCode) {\n+            return false;\n+          }\n+          return true;\n+        })\n+      ) {\n+        return true;\n+      }\n+\n+      return false;\n     },\n-  }),\n+  },\n   methods: {\n-    addSubsystem() {\n-      console.log('add subsystem');\n+    cancel(): void {\n+      this.$store.dispatch('resetState');\n+      this.$store.dispatch('resetAddClientState');\n+      this.$router.replace({ name: RouteName.Clients });\n+    },\n+    done(): void {\n+      this.$store\n+        .dispatch('addSubsystem', {\n+          memberName: this.client.member_name,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {\n+            this.disableDone = false;\n+\n+            if (this.registerChecked) {\n+              this.registerSubsystem();\n+            } else {\n+              this.exitView();\n+            }\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        );\n+    },\n+\n+    registerSubsystem(): void {\n+      this.$store\n+        .dispatch('registerClient', {\n+          instanceId: this.client.instance_id,\n+          memberClass: this.client.member_class,\n+          memberCode: this.client.member_code,\n+          subsystemCode: this.subsystemCode,\n+        })\n+        .then(\n+          (response) => {\n+            this.disableDone = false;\n+            this.exitView();\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        );\n     },\n-    cancel() {\n+\n+    clientDetailsReady(): void {\n+      this.$store.dispatch('showSuccess', 'subsystem_code');\n+    },\n+\n+    exitView(): void {\n+      this.$store.dispatch('resetState');\n+      this.$store.dispatch('resetAddClientState');\n       this.$router.replace({ name: RouteName.Clients });\n     },\n+    saveSelectedClient(selectedMember: Client): void {\n+      this.$store.dispatch('setSelectedMember', selectedMember).then(\n+        (response) => {\n+          this.$store.dispatch('fetchReservedSubsystems', selectedMember);\n+        },\n+        (error) => {\n+          this.$store.dispatch('showError', error);\n+        },\n+      );\n+      this.showSelectClient = false;\n+    },\n+    fetchData(): void {\n+      // Fetch \"parent\" client from backend\n+      this.$store.dispatch('fetchClient', this.clientId).then(\n+        (response) => {\n+          this.$store.dispatch('fetchSelectableForSubsystem', this.client);\n+        },\n+        (error) => {\n+          this.$store.dispatch('showError', error);\n+        },\n+      );\n+    },\n+  },\n+\n+  created() {\n+    this.fetchData();\n   },\n });\n </script>\n \n <style lang=\"scss\" scoped>\n-.input-title {\n-  max-width: 160px;\n-  text-align: left;\n+@import '../../assets/colors';\n+@import '../../assets/shared';\n+@import '../../assets/wizards';\n+\n+.view-wrap {\n+  width: 100%;\n+  max-width: 1000px;\n+  margin: 10px;\n }\n \n-.subs-input {\n-  text-align: left;\n+.view-title {\n+  width: 100%;\n+  max-width: 100%;\n+  margin-bottom: 30px;\n }\n \n-.input-name {\n-  padding-top: 0;\n-  margin-top: 0;\n+.info-block {\n+  display: flex;\n+  flex-direction: row;\n+  margin-bottom: 40px;\n+\n+  .action-block {\n+    margin-top: 30px;\n+    margin-left: auto;\n+    margin-right: 0px;\n+  }", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MzczOA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953738", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:16:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMjUxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMzQxNA==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415533414", "bodyText": "return this.$store.getters.hasPermission(Permissions.SEND_CLIENT_DEL_REQ;", "author": "TJaakkola", "createdAt": "2020-04-27T06:03:55Z", "path": "src/proxy-ui-api/frontend/src/views/Clients/Client.vue", "diffHunk": "@@ -27,10 +50,19 @@ export default Vue.extend({\n   data() {\n     return {\n       tab: null,\n+      confirmUnregisterClient: false,\n+      unregisterLoading: false,\n     };\n   },\n   computed: {\n     ...mapGetters(['client']),\n+    showUnregister(): boolean {\n+      if (this.$store.getters.hasPermission(Permissions.SEND_CLIENT_DEL_REQ)) {", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1MzgwOQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953809", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:16:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMzQxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMzYwNQ==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415533605", "bodyText": "unused response", "author": "TJaakkola", "createdAt": "2020-04-27T06:04:20Z", "path": "src/proxy-ui-api/frontend/src/views/Clients/Client.vue", "diffHunk": "@@ -70,6 +102,36 @@ export default Vue.extend({\n         this.$store.dispatch('showError', error);\n       });\n     },\n+\n+    unregisterClient(): void {\n+      this.unregisterLoading = true;\n+      this.$store\n+        .dispatch('unregisterClient', this.client)\n+        .then(\n+          (response) => {", "originalCommit": "4525895a567d206a563348c8543c7e8a041c2b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1Mzg5Nw==", "url": "https://github.com/nordic-institute/X-Road/pull/470#discussion_r415953897", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-04-27T16:16:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTUzMzYwNQ=="}], "type": "inlineReview"}]}