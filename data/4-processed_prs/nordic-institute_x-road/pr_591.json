{"pr_number": 591, "pr_title": "XRDDEV-651 API version", "pr_createdAt": "2020-07-13T09:02:38Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/591", "timeline": [{"oid": "8c93c9730c574916c9b20e93323f0fda53cfdcfe", "url": "https://github.com/nordic-institute/X-Road/commit/8c93c9730c574916c9b20e93323f0fda53cfdcfe", "message": "XRDDEV-651 Add API version\n\n* prefix all paths with /api/v1\n* use OpenAPI3 tags to categorize an API path", "committedDate": "2020-07-10T13:38:21Z", "type": "commit"}, {"oid": "38e999952c5ac0b77c54ae262a388a4db6f6b88f", "url": "https://github.com/nordic-institute/X-Road/commit/38e999952c5ac0b77c54ae262a388a4db6f6b88f", "message": "XRDDEV-651 Fix api url in rest tests\n\n* also add descriptions for api tags", "committedDate": "2020-07-13T06:35:25Z", "type": "commit"}, {"oid": "96b951d94833810f64ff4652cf0edfbb2a961ba4", "url": "https://github.com/nordic-institute/X-Road/commit/96b951d94833810f64ff4652cf0edfbb2a961ba4", "message": "XRDDEV-651 Add API version to base path in frontend", "committedDate": "2020-07-13T10:37:21Z", "type": "commit"}, {"oid": "ccfc98edb2a5799d8b06d522c8799de26a14590c", "url": "https://github.com/nordic-institute/X-Road/commit/ccfc98edb2a5799d8b06d522c8799de26a14590c", "message": "XRDDEV-651 Fix Sonar issues\n\n* RequestMapping -> GetMapping\n* renamed some globals", "committedDate": "2020-07-13T11:01:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk4MzI3Mg==", "url": "https://github.com/nordic-institute/X-Road/pull/591#discussion_r454983272", "bodyText": "Could also consider using servers-object to hold the api/v1 prefix? https://swagger.io/docs/specification/api-host-and-base-path/\nIn that case some small test would be good to verify, that we have some means of having both api/v1 and api/v2 endpoints coexist in the same definition.", "author": "jansu76", "createdAt": "2020-07-15T11:31:46Z", "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -12,13 +12,51 @@ info:\n     name: MIT\n     url: https://opensource.org/licenses/MIT\n tags:\n-  - name: security server\n-    description: <br>Security Server admin API design\n+  - name: backups\n+    description: backup endpoints\n+  - name: certificate-authorities\n+    description: CA endpoints\n+  - name: clients\n+    description: clients endpoints\n+  - name: diagnostics\n+    description: diagnostics endpoints\n+  - name: endpoints\n+    description: services' endpoints related endpoints\n+  - name: initialization\n+    description: initialization endpoints\n+  - name: keys\n+    description: keys endpoints\n+  - name: language\n+    description: language endpoints\n+  - name: local-groups\n+    description: local groups endpoints\n+  - name: member-classes\n+    description: member classes endpoints\n+  - name: member-names\n+    description: member names endpoints\n+  - name: security-servers\n+    description: security servers endpoints\n+  - name: services\n+    description: services endpoints\n+  - name: service-descriptions\n+    description: service descriptions endpoints\n+  - name: system\n+    description: system endpoints\n+  - name: timestamping\n+    description: timestamping endpoints\n+  - name: token-certificate\n+    description: token certificates endpoints\n+  - name: tokens\n+    description: tokens endpoints\n+  - name: user\n+    description: user endpoints\n+  - name: xroad-instances\n+    description: xroad-instances endpoints\n paths:\n-  /backups:\n+  /api/v1/backups:", "originalCommit": "ccfc98edb2a5799d8b06d522c8799de26a14590c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTUzNTUxMQ==", "url": "https://github.com/nordic-institute/X-Road/pull/591#discussion_r455535511", "bodyText": "Removed the /api/v1 prefix from the individual endpoints and added it into the servers object. The current OpenAPI Code Generator that we are using only checks that the servers object exists but it does not do anything with it. The API base path is now maintained in the code instead of the API specification, so the prefix was moved into each controller class as a @RequestMapping(\"/api/v1\") annotation.\nMaintaining multiple versions of an endpoint is possible by adding a new controller with @RequestMapping(\"/api/v2\") annotation. In such cases one should also remember to add an overriding servers object into the endpoint in question in order to follow best practices.", "author": "carohauta", "createdAt": "2020-07-16T06:22:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDk4MzI3Mg=="}], "type": "inlineReview"}, {"oid": "a28e73114dda404da1b85b490ec9ad968b1cc71f", "url": "https://github.com/nordic-institute/X-Road/commit/a28e73114dda404da1b85b490ec9ad968b1cc71f", "message": "XRDDEV-651 Move API basepath into servers-object\n\n* also add swaggerhub test server", "committedDate": "2020-07-15T13:29:19Z", "type": "commit"}]}