{"pr_number": 425, "pr_title": "XRDDEV-998: Change updateEndpoint api to not alter service code", "pr_createdAt": "2020-03-20T11:40:36Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/425", "timeline": [{"oid": "8bf8c8dd6848e76225e6c37698c8ffbdfa6e3d28", "url": "https://github.com/nordic-institute/X-Road/commit/8bf8c8dd6848e76225e6c37698c8ffbdfa6e3d28", "message": "XRDDEV-998: Change updateEndpoint api to not alter service code", "committedDate": "2020-03-20T11:39:43Z", "type": "commit"}, {"oid": "513d750ed73cccdf9c602e2477d7eff0ac7693e6", "url": "https://github.com/nordic-institute/X-Road/commit/513d750ed73cccdf9c602e2477d7eff0ac7693e6", "message": "XRDDEV-998: Remove default values so that api users can update only one of path and method", "committedDate": "2020-03-20T22:39:10Z", "type": "commit"}, {"oid": "4fedaffe7409fad68c43f009068470a8bfca8fd8", "url": "https://github.com/nordic-institute/X-Road/commit/4fedaffe7409fad68c43f009068470a8bfca8fd8", "message": "XRDDEV-998: Additional null checks and tests for updating endpoint", "committedDate": "2020-03-20T22:40:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ5Mzc4NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/425#discussion_r396493785", "bodyText": "The allOf keyword, combined with the OpenAPI model generator that we are using, seems to generate a redundant EndpointAllOf object. We have mainly tried to avoid these and created for example a ClientAdd and ServiceDescriptionUpdate models that only have the allowed and required fields in them. So maybe consider separate models (without allOf) for these endpoint schemas.\nThere is a task (XRDDEV-668) about using readOnly keyword in those fields that aren't supposed to be sent in a request. So maybe some unifying methods should be considered and documented when that task is being investigated further. Spoiler alert: The readOnly flag has no effect on anything", "author": "carohauta", "createdAt": "2020-03-23T14:31:04Z", "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -4910,36 +4910,40 @@ components:\n           example: false\n           default: false\n     Endpoint:\n+      allOf:", "originalCommit": "4fedaffe7409fad68c43f009068470a8bfca8fd8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODU2MzE2MQ==", "url": "https://github.com/nordic-institute/X-Road/pull/425#discussion_r398563161", "bodyText": "Removed allOf -operator and renamed EndpointPathAndMethod to EndpointUpdate.", "author": "TJaakkola", "createdAt": "2020-03-26T13:17:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ5Mzc4NQ=="}], "type": "inlineReview"}, {"oid": "0af929718c5c51e625efe42baa1b52aa11a4f210", "url": "https://github.com/nordic-institute/X-Road/commit/0af929718c5c51e625efe42baa1b52aa11a4f210", "message": "XRDDEV-998: Change openapi-definition not to use allOf -operator", "committedDate": "2020-03-26T12:35:07Z", "type": "commit"}, {"oid": "69de872a1d1973aaa1f5fa170cf70cc78689d80b", "url": "https://github.com/nordic-institute/X-Road/commit/69de872a1d1973aaa1f5fa170cf70cc78689d80b", "message": "XRDDEV-998: Rename EndpointPathAndMethod to EndpointUpdate", "committedDate": "2020-03-26T13:16:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTI4MzAyNQ==", "url": "https://github.com/nordic-institute/X-Road/pull/425#discussion_r399283025", "bodyText": "OpenAPI models shouldn't be referenced in the service layer: https://confluence.niis.org/pages/viewpage.action?spaceKey=XRDDEV&title=API+backend+implementation\nMaybe map the values to a separate Method enum?", "author": "carohauta", "createdAt": "2020-03-27T13:57:59Z", "path": "src/proxy-ui-api/src/main/java/org/niis/xroad/restapi/service/EndpointService.java", "diffHunk": "@@ -111,7 +111,7 @@ public void deleteEndpoint(Long id) throws EndpointNotFoundException, ClientNotF\n      * @throws IllegalGeneratedEndpointUpdateException  trying to update that is generated automatically\n      * @throws IllegalArgumentException                 passing illegal combination of parameters\n      */\n-    public EndpointType updateEndpoint(Long id, EndpointPathAndMethod.MethodEnum method, String path)\n+    public EndpointType updateEndpoint(Long id, EndpointUpdate.MethodEnum method, String path)", "originalCommit": "69de872a1d1973aaa1f5fa170cf70cc78689d80b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTMxNTU5OA==", "url": "https://github.com/nordic-institute/X-Road/pull/425#discussion_r399315598", "bodyText": "I decided to just pass string version of the method to service layer extra mapping feels a bit too much here.", "author": "TJaakkola", "createdAt": "2020-03-27T14:43:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTI4MzAyNQ=="}], "type": "inlineReview"}, {"oid": "7eac515d8cce45b49a961b7b5e2c3fcd85b09658", "url": "https://github.com/nordic-institute/X-Road/commit/7eac515d8cce45b49a961b7b5e2c3fcd85b09658", "message": "XRDDEV-803: Pass method to service layer as a String instead of openapi generated enum that are meant to be used only on controller layer", "committedDate": "2020-03-27T14:42:37Z", "type": "commit"}, {"oid": "1d0cefbe0b984f05e7f8c38b66cce324bed4eb99", "url": "https://github.com/nordic-institute/X-Road/commit/1d0cefbe0b984f05e7f8c38b66cce324bed4eb99", "message": "Merge branch 'develop' into XRDDEV-998", "committedDate": "2020-03-27T15:17:48Z", "type": "commit"}, {"oid": "fef093d1dcaaf3019ed0cf634f8b2b0710169137", "url": "https://github.com/nordic-institute/X-Road/commit/fef093d1dcaaf3019ed0cf634f8b2b0710169137", "message": "XRDDEV-803: Replace verifyAuthority method usage with preAuthorize-annotation", "committedDate": "2020-04-03T06:39:43Z", "type": "commit"}, {"oid": "9be8b53956b8ec8c6cd89b4e7299e6c0f84d1a1f", "url": "https://github.com/nordic-institute/X-Road/commit/9be8b53956b8ec8c6cd89b4e7299e6c0f84d1a1f", "message": "XRDDEV-998 Fix tests", "committedDate": "2020-04-03T08:02:46Z", "type": "commit"}, {"oid": "688a94a3afebe0942392ad4b1cd9a4703932d088", "url": "https://github.com/nordic-institute/X-Road/commit/688a94a3afebe0942392ad4b1cd9a4703932d088", "message": "XRDDEV-998: Fix test", "committedDate": "2020-04-06T18:12:30Z", "type": "commit"}, {"oid": "b611987461fc041dbe2c5432f59ad073d987c31d", "url": "https://github.com/nordic-institute/X-Road/commit/b611987461fc041dbe2c5432f59ad073d987c31d", "message": "Merge branch 'develop' into XRDDEV-998", "committedDate": "2020-04-07T10:47:14Z", "type": "commit"}, {"oid": "e2400a8e3c1332afcb667f7a075d8226e88a7ac5", "url": "https://github.com/nordic-institute/X-Road/commit/e2400a8e3c1332afcb667f7a075d8226e88a7ac5", "message": "XRDDEV-998: Fix test checkstyles", "committedDate": "2020-04-07T14:17:45Z", "type": "commit"}, {"oid": "cd23c284a0b2626e358129edda204902b082a5a4", "url": "https://github.com/nordic-institute/X-Road/commit/cd23c284a0b2626e358129edda204902b082a5a4", "message": "Merge branch 'develop' into XRDDEV-998", "committedDate": "2020-04-07T15:35:19Z", "type": "commit"}]}