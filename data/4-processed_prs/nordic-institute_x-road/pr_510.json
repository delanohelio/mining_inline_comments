{"pr_number": 510, "pr_title": "XRDDEV-862 Add member", "pr_createdAt": "2020-05-19T15:23:43Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/510", "timeline": [{"oid": "21ea27627acb2063921759328b85e391b80f21f4", "url": "https://github.com/nordic-institute/X-Road/commit/21ea27627acb2063921759328b85e391b80f21f4", "message": "Merge commit '8a4d41f03276d52e18b692f7e4ea9eb69a5914b5' into XRDDEV-862-add-member\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/package-lock.json\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json\n#\tsrc/proxy-ui-api/frontend/src/store/index.ts\n#\tsrc/proxy-ui-api/frontend/src/views/KeysAndCertificates/SignAndAuthKeys/SignAndAuthKeys.vue", "committedDate": "2020-03-24T20:30:55Z", "type": "commit"}, {"oid": "dfc6d385e1796cc74a7d6ae51488b71388bbdbed", "url": "https://github.com/nordic-institute/X-Road/commit/dfc6d385e1796cc74a7d6ae51488b71388bbdbed", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-862-add-member\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/package-lock.json\n#\tsrc/proxy-ui-api/frontend/src/views/KeysAndCertificates/SignAndAuthKeys/SignAndAuthKeys.vue", "committedDate": "2020-03-24T20:35:46Z", "type": "commit"}, {"oid": "3ad310146bed3d8ce0e859fed14b1df501477dc2", "url": "https://github.com/nordic-institute/X-Road/commit/3ad310146bed3d8ce0e859fed14b1df501477dc2", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-862-add-member", "committedDate": "2020-03-25T15:47:17Z", "type": "commit"}, {"oid": "55ac7b99f0792ff4c070c64dd2ea3a742e27b2ed", "url": "https://github.com/nordic-institute/X-Road/commit/55ac7b99f0792ff4c070c64dd2ea3a742e27b2ed", "message": "XRDDEV-862 Add key skeleton", "committedDate": "2020-03-25T17:20:02Z", "type": "commit"}, {"oid": "8eeced60c5470affa4d5024fc1b44e49013a7c6a", "url": "https://github.com/nordic-institute/X-Road/commit/8eeced60c5470affa4d5024fc1b44e49013a7c6a", "message": "Merge branch 'develop' into XRDDEV-862-add-member", "committedDate": "2020-03-26T16:55:45Z", "type": "commit"}, {"oid": "d3bbe832ca8ba34224cc548178c846a9460b5799", "url": "https://github.com/nordic-institute/X-Road/commit/d3bbe832ca8ba34224cc548178c846a9460b5799", "message": "XRDDEV-862 Update texts", "committedDate": "2020-04-02T11:49:14Z", "type": "commit"}, {"oid": "e1281843252724b249ab8361e963c0786d88b702", "url": "https://github.com/nordic-institute/X-Road/commit/e1281843252724b249ab8361e963c0786d88b702", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-862-add-member", "committedDate": "2020-04-02T11:49:59Z", "type": "commit"}, {"oid": "2471a8cf50e0d417d002e3c20b65d95dba5a6e0b", "url": "https://github.com/nordic-institute/X-Road/commit/2471a8cf50e0d417d002e3c20b65d95dba5a6e0b", "message": "Merge branch 'XRDDEV-857-add-client' into XRDDEV-862-add-member", "committedDate": "2020-04-02T12:53:33Z", "type": "commit"}, {"oid": "64d2923c09dd0f52a366464f31b17f79091c78db", "url": "https://github.com/nordic-institute/X-Road/commit/64d2923c09dd0f52a366464f31b17f79091c78db", "message": "XRDDEV-862 Update member selection", "committedDate": "2020-04-02T14:55:36Z", "type": "commit"}, {"oid": "995bf4655ee5971ea495576765a99a546f0f905c", "url": "https://github.com/nordic-institute/X-Road/commit/995bf4655ee5971ea495576765a99a546f0f905c", "message": "XRDDEV-862 Add skeleton functionality for dynamic wizard", "committedDate": "2020-04-07T12:10:07Z", "type": "commit"}, {"oid": "4b6e1280c1fdff2a7019bdc0dea217fa7d395675", "url": "https://github.com/nordic-institute/X-Road/commit/4b6e1280c1fdff2a7019bdc0dea217fa7d395675", "message": "Merge branch 'XRDDEV-1077' into XRDDEV-862-add-member\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/global.ts\n#\tsrc/proxy-ui-api/frontend/src/locales/en.json\n#\tsrc/proxy-ui-api/frontend/src/views/Clients/ClientsDataTable.vue", "committedDate": "2020-05-06T15:49:54Z", "type": "commit"}, {"oid": "63419ed9c458064d2f77fd398c6c3e34034d7b6b", "url": "https://github.com/nordic-institute/X-Road/commit/63419ed9c458064d2f77fd398c6c3e34034d7b6b", "message": "XRDDEV-862 Remove unused test items", "committedDate": "2020-05-07T15:44:31Z", "type": "commit"}, {"oid": "4a10872a64dc3914c736b4397072ac16d0f9a5a9", "url": "https://github.com/nordic-institute/X-Road/commit/4a10872a64dc3914c736b4397072ac16d0f9a5a9", "message": "XRDDEV-862 Refactor clients vuex store", "committedDate": "2020-05-07T16:18:28Z", "type": "commit"}, {"oid": "29848bada4be04664799bb7661df30bfdada87f4", "url": "https://github.com/nordic-institute/X-Road/commit/29848bada4be04664799bb7661df30bfdada87f4", "message": "Merge commit 'b46c0093fc6c013405cb9f933c6c85b2c8dd860a' into XRDDEV-862-add-member", "committedDate": "2020-05-11T14:15:33Z", "type": "commit"}, {"oid": "5428c10555911dff4235d88c2fceba0d7b0f83a1", "url": "https://github.com/nordic-institute/X-Road/commit/5428c10555911dff4235d88c2fceba0d7b0f83a1", "message": "XRDDEV-862 Fix typo", "committedDate": "2020-05-12T14:07:39Z", "type": "commit"}, {"oid": "2857a963fe5479d5ac16928b42d4fba5e4245ff1", "url": "https://github.com/nordic-institute/X-Road/commit/2857a963fe5479d5ac16928b42d4fba5e4245ff1", "message": "XRDDEV-862 Update routing", "committedDate": "2020-05-12T15:30:40Z", "type": "commit"}, {"oid": "d5b9668f2e071b1d8b5969dbd07bb4f393dfd691", "url": "https://github.com/nordic-institute/X-Road/commit/d5b9668f2e071b1d8b5969dbd07bb4f393dfd691", "message": "XRDDEV-862 Add types", "committedDate": "2020-05-12T16:14:20Z", "type": "commit"}, {"oid": "6e39ac5d5b402ece4dc7e53c0d696493beda8793", "url": "https://github.com/nordic-institute/X-Road/commit/6e39ac5d5b402ece4dc7e53c0d696493beda8793", "message": "XRDDEV-862 Fix small details", "committedDate": "2020-05-12T16:21:02Z", "type": "commit"}, {"oid": "769e4bb0bd9e6f0b31977032259fb44b109dcb48", "url": "https://github.com/nordic-institute/X-Road/commit/769e4bb0bd9e6f0b31977032259fb44b109dcb48", "message": "XRDDEV-862 Add members method", "committedDate": "2020-05-12T16:29:06Z", "type": "commit"}, {"oid": "fe789c8ccb9a24ba4beb434362ce4d74ff2b2870", "url": "https://github.com/nordic-institute/X-Road/commit/fe789c8ccb9a24ba4beb434362ce4d74ff2b2870", "message": "XRDDEV-862 Simplify vuex unit tests", "committedDate": "2020-05-13T13:03:29Z", "type": "commit"}, {"oid": "570c011dbf13506523469b29708b26f8140a0b63", "url": "https://github.com/nordic-institute/X-Road/commit/570c011dbf13506523469b29708b26f8140a0b63", "message": "XRDDEV-862 Fix select client dialog props", "committedDate": "2020-05-13T14:04:41Z", "type": "commit"}, {"oid": "39c826ed47c0698f0a98a0ff6cea5f34c997f037", "url": "https://github.com/nordic-institute/X-Road/commit/39c826ed47c0698f0a98a0ff6cea5f34c997f037", "message": "Merge commit '6a9102dc2f69612b56043aa4862ab726e4ce3f04' into XRDDEV-862-add-member\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/store/modules/addClient.ts", "committedDate": "2020-05-13T14:17:32Z", "type": "commit"}, {"oid": "e52a62435ea53793f28f327b6ae353ba9db62c46", "url": "https://github.com/nordic-institute/X-Road/commit/e52a62435ea53793f28f327b6ae353ba9db62c46", "message": "XRDDEV-862 Add delete client function for members", "committedDate": "2020-05-13T18:42:38Z", "type": "commit"}, {"oid": "6fe82aa693d934ac85c5223c52c1deef0d6afe32", "url": "https://github.com/nordic-institute/X-Road/commit/6fe82aa693d934ac85c5223c52c1deef0d6afe32", "message": "XRDDEV-862 Move delete client actions to shared component", "committedDate": "2020-05-13T19:05:38Z", "type": "commit"}, {"oid": "5580d0b7e0e9a61bfb67948dfb4d27c0fa41ce0b", "url": "https://github.com/nordic-institute/X-Road/commit/5580d0b7e0e9a61bfb67948dfb4d27c0fa41ce0b", "message": "XRDDEV-862 Update typings", "committedDate": "2020-05-13T19:06:06Z", "type": "commit"}, {"oid": "07b4658d0f41fb567f5237de15b48b1e607aaf1a", "url": "https://github.com/nordic-institute/X-Road/commit/07b4658d0f41fb567f5237de15b48b1e607aaf1a", "message": "XRDDEV-862 Move unregister client actions to a shared component", "committedDate": "2020-05-13T19:24:17Z", "type": "commit"}, {"oid": "1c7eb3a372495def884049066efa4b8358942821", "url": "https://github.com/nordic-institute/X-Road/commit/1c7eb3a372495def884049066efa4b8358942821", "message": "XRDDEV-862 Move select client dialog to ui folder", "committedDate": "2020-05-13T19:31:55Z", "type": "commit"}, {"oid": "e54788e27ec60fd58493c383d5a67ecfd1ea1523", "url": "https://github.com/nordic-institute/X-Road/commit/e54788e27ec60fd58493c383d5a67ecfd1ea1523", "message": "XRDDEV-862 Clean up", "committedDate": "2020-05-13T19:34:12Z", "type": "commit"}, {"oid": "c4d648b19b7b66736cd60ebf190f0c3b007d3d83", "url": "https://github.com/nordic-institute/X-Road/commit/c4d648b19b7b66736cd60ebf190f0c3b007d3d83", "message": "XRDDEV-862 Remove unused file", "committedDate": "2020-05-14T08:59:25Z", "type": "commit"}, {"oid": "01e905faf6429975be23a877c836e10e7d5339d2", "url": "https://github.com/nordic-institute/X-Road/commit/01e905faf6429975be23a877c836e10e7d5339d2", "message": "Merge commit '551f1fc1efab4bead473bd14a1283738893d84c7' into XRDDEV-862-add-member\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/ui-types.ts", "committedDate": "2020-05-14T10:42:10Z", "type": "commit"}, {"oid": "edeae06e321b64e4f3ff191f63e878f8b0e85808", "url": "https://github.com/nordic-institute/X-Road/commit/edeae06e321b64e4f3ff191f63e878f8b0e85808", "message": "XRDDEV-862 Modify register client action", "committedDate": "2020-05-14T19:07:11Z", "type": "commit"}, {"oid": "3fce5638baf448f20d02459e29d02bfb21faaedb", "url": "https://github.com/nordic-institute/X-Road/commit/3fce5638baf448f20d02459e29d02bfb21faaedb", "message": "Merge commit '7fbe80ec67e9e599ef90b18586d1f3f45f7057c0' into XRDDEV-862-add-member", "committedDate": "2020-05-15T16:44:04Z", "type": "commit"}, {"oid": "98a932691e06a6dbcb52d293b0eb9f549ea8262a", "url": "https://github.com/nordic-institute/X-Road/commit/98a932691e06a6dbcb52d293b0eb9f549ea8262a", "message": "XRDDEV-862 Update localisations", "committedDate": "2020-05-18T14:57:52Z", "type": "commit"}, {"oid": "ec71b4a6d0cfb5a6b008cdbe7f87e415891e57f2", "url": "https://github.com/nordic-institute/X-Road/commit/ec71b4a6d0cfb5a6b008cdbe7f87e415891e57f2", "message": "XRDDEV-862 Fix snackbar's possible undefined value error", "committedDate": "2020-05-18T15:19:14Z", "type": "commit"}, {"oid": "ccaa774c168939f6a2e17b1a5001b907f1985340", "url": "https://github.com/nordic-institute/X-Road/commit/ccaa774c168939f6a2e17b1a5001b907f1985340", "message": "Merge branch 'develop' into XRDDEV-862-add-member", "committedDate": "2020-05-18T15:20:01Z", "type": "commit"}, {"oid": "3e79bef5f34b76b801aeba490db7896d41bea944", "url": "https://github.com/nordic-institute/X-Road/commit/3e79bef5f34b76b801aeba490db7896d41bea944", "message": "XRDDEV-862 Fix a bug with csr generation", "committedDate": "2020-05-18T15:35:25Z", "type": "commit"}, {"oid": "f6f864298e8ef5d1e3099f62376d159357fbc291", "url": "https://github.com/nordic-institute/X-Road/commit/f6f864298e8ef5d1e3099f62376d159357fbc291", "message": "XRDDEV-862 Add new component", "committedDate": "2020-05-18T16:30:36Z", "type": "commit"}, {"oid": "f9d69f36dbf5cf5ba69e865f4a5325af866cac72", "url": "https://github.com/nordic-institute/X-Road/commit/f9d69f36dbf5cf5ba69e865f4a5325af866cac72", "message": "XRDDEV-862 Add key uses proper prop", "committedDate": "2020-05-18T16:32:38Z", "type": "commit"}, {"oid": "5f68333bb166831cfba2b21a7d99f32c2e840e00", "url": "https://github.com/nordic-institute/X-Road/commit/5f68333bb166831cfba2b21a7d99f32c2e840e00", "message": "XRDDEV-862 Update to add client wizard", "committedDate": "2020-05-18T17:05:25Z", "type": "commit"}, {"oid": "bae3688e37f5c67e627a8eaab5a87ae2e74a2a2e", "url": "https://github.com/nordic-institute/X-Road/commit/bae3688e37f5c67e627a8eaab5a87ae2e74a2a2e", "message": "XRDDEV-862 Remove dangerous and unused line", "committedDate": "2020-05-18T17:15:41Z", "type": "commit"}, {"oid": "cb6905f71c945a865068ba7aecb8ab53c1dc4061", "url": "https://github.com/nordic-institute/X-Road/commit/cb6905f71c945a865068ba7aecb8ab53c1dc4061", "message": "XRDDEV-862 Refactor for add member", "committedDate": "2020-05-19T10:34:12Z", "type": "commit"}, {"oid": "37090653d465500817204c66a484399164f5f4be", "url": "https://github.com/nordic-institute/X-Road/commit/37090653d465500817204c66a484399164f5f4be", "message": "XRDDEV-862 Fix add member flow", "committedDate": "2020-05-19T14:37:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk1MjY1NA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r430952654", "bodyText": "data-test missing", "author": "TJaakkola", "createdAt": "2020-05-27T08:40:47Z", "path": "src/proxy-ui-api/frontend/src/components/client/UnregisterClientButton.vue", "diffHunk": "@@ -0,0 +1,67 @@\n+<template>\n+  <div>\n+    <LargeButton", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2NzAzOQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432467039", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:02:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk1MjY1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk2NjE5OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r430966199", "bodyText": "data-test missing", "author": "TJaakkola", "createdAt": "2020-05-27T09:02:24Z", "path": "src/proxy-ui-api/frontend/src/components/client/DeleteClientButton.vue", "diffHunk": "@@ -0,0 +1,116 @@\n+<template>\n+  <div>\n+    <LargeButton @click=\"confirmDelete = true\">{{$t('action.delete')}}</LargeButton>", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2NzA5MA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432467090", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:02:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk2NjE5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk2OTU3OA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r430969578", "bodyText": "missing typings", "author": "TJaakkola", "createdAt": "2020-05-27T09:07:43Z", "path": "src/proxy-ui-api/frontend/src/components/wizard/CsrDetailsPageLocked.vue", "diffHunk": "@@ -0,0 +1,170 @@\n+<template>\n+  <div>\n+    <ValidationObserver ref=\"form1\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <div class=\"label\">\n+          {{$t('csr.usage')}}\n+          <helpIcon :text=\"$t('csr.helpUsage')\" />\n+        </div>\n+        <div class=\"readonly-info-field\">{{usage}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <div class=\"label\">\n+          {{$t('csr.client')}}\n+          <helpIcon :text=\"$t('csr.helpClient')\" />\n+        </div>\n+        <div\n+          class=\"readonly-info-field\"\n+        >{{selectedMemberId}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <div class=\"label\">\n+          {{$t('csr.certificationService')}}\n+          <helpIcon :text=\"$t('csr.helpCertificationService')\" />\n+        </div>\n+\n+        <ValidationProvider name=\"crs.certService\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"filteredServiceList\"\n+            item-text=\"name\"\n+            item-value=\"name\"\n+            class=\"form-input\"\n+            v-model=\"certificationService\"\n+            data-test=\"csr-certification-service-select\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <div class=\"label\">\n+          {{$t('csr.csrFormat')}}\n+          <helpIcon :text=\"$t('csr.helpCsrFormat')\" />\n+        </div>\n+\n+        <ValidationProvider name=\"crs.crsFormat\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"csrFormatList\"\n+            name=\"crs.crsFormat\"\n+            class=\"form-input\"\n+            v-model=\"csrFormat\"\n+            data-test=\"csr-format-select\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div class=\"button-footer\">\n+        <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+\n+        <div>\n+          <large-button\n+            v-if=\"showPreviousButton\"\n+            @click=\"previous\"\n+            outlined\n+            class=\"previous-button\"\n+            data-test=\"previous-button\"\n+          >{{$t('action.previous')}}</large-button>\n+          <large-button\n+            :disabled=\"invalid\"\n+            @click=\"done\"\n+            data-test=\"save-button\"\n+          >{{$t(saveButtonText)}}</large-button>\n+        </div>\n+      </div>\n+    </ValidationObserver>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import { Key, Token } from '@/types';\n+import { CsrFormatTypes } from '@/global';\n+import * as api from '@/util/api';\n+\n+export default Vue.extend({\n+  components: {\n+    HelpIcon,\n+    LargeButton,\n+    SubViewTitle,\n+    ValidationObserver,\n+    ValidationProvider,\n+  },\n+  props: {\n+    saveButtonText: {\n+      type: String,\n+      default: 'action.continue',\n+    },\n+    showPreviousButton: {\n+      type: Boolean,\n+      default: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      csrFormatList: Object.values(CsrFormatTypes),", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2NzE5MA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432467190", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:02:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk2OTU3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk3MDA5MA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r430970090", "bodyText": "val?.length === 1", "author": "TJaakkola", "createdAt": "2020-05-27T09:08:29Z", "path": "src/proxy-ui-api/frontend/src/components/wizard/CsrDetailsPageLocked.vue", "diffHunk": "@@ -0,0 +1,170 @@\n+<template>\n+  <div>\n+    <ValidationObserver ref=\"form1\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <div class=\"label\">\n+          {{$t('csr.usage')}}\n+          <helpIcon :text=\"$t('csr.helpUsage')\" />\n+        </div>\n+        <div class=\"readonly-info-field\">{{usage}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <div class=\"label\">\n+          {{$t('csr.client')}}\n+          <helpIcon :text=\"$t('csr.helpClient')\" />\n+        </div>\n+        <div\n+          class=\"readonly-info-field\"\n+        >{{selectedMemberId}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <div class=\"label\">\n+          {{$t('csr.certificationService')}}\n+          <helpIcon :text=\"$t('csr.helpCertificationService')\" />\n+        </div>\n+\n+        <ValidationProvider name=\"crs.certService\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"filteredServiceList\"\n+            item-text=\"name\"\n+            item-value=\"name\"\n+            class=\"form-input\"\n+            v-model=\"certificationService\"\n+            data-test=\"csr-certification-service-select\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <div class=\"label\">\n+          {{$t('csr.csrFormat')}}\n+          <helpIcon :text=\"$t('csr.helpCsrFormat')\" />\n+        </div>\n+\n+        <ValidationProvider name=\"crs.crsFormat\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"csrFormatList\"\n+            name=\"crs.crsFormat\"\n+            class=\"form-input\"\n+            v-model=\"csrFormat\"\n+            data-test=\"csr-format-select\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div class=\"button-footer\">\n+        <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+\n+        <div>\n+          <large-button\n+            v-if=\"showPreviousButton\"\n+            @click=\"previous\"\n+            outlined\n+            class=\"previous-button\"\n+            data-test=\"previous-button\"\n+          >{{$t('action.previous')}}</large-button>\n+          <large-button\n+            :disabled=\"invalid\"\n+            @click=\"done\"\n+            data-test=\"save-button\"\n+          >{{$t(saveButtonText)}}</large-button>\n+        </div>\n+      </div>\n+    </ValidationObserver>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import { Key, Token } from '@/types';\n+import { CsrFormatTypes } from '@/global';\n+import * as api from '@/util/api';\n+\n+export default Vue.extend({\n+  components: {\n+    HelpIcon,\n+    LargeButton,\n+    SubViewTitle,\n+    ValidationObserver,\n+    ValidationProvider,\n+  },\n+  props: {\n+    saveButtonText: {\n+      type: String,\n+      default: 'action.continue',\n+    },\n+    showPreviousButton: {\n+      type: Boolean,\n+      default: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      csrFormatList: Object.values(CsrFormatTypes),\n+    };\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'filteredServiceList',\n+      'isUsageReadOnly',\n+      'selectedMemberId',\n+      'usage',\n+    ]),\n+\n+    csrFormat: {\n+      get(): string {\n+        return this.$store.getters.csrFormat;\n+      },\n+      set(value: string) {\n+        this.$store.commit('storeCsrFormat', value);\n+      },\n+    },\n+    certificationService: {\n+      get(): string {\n+        return this.$store.getters.certificationService;\n+      },\n+      set(value: string) {\n+        this.$store.commit('storeCertificationService', value);\n+      },\n+    },\n+  },\n+  methods: {\n+    done(): void {\n+      this.$emit('done');\n+    },\n+    previous(): void {\n+      this.$emit('previous');\n+    },\n+    cancel(): void {\n+      this.$emit('cancel');\n+    },\n+  },\n+\n+  watch: {\n+    filteredServiceList(val) {\n+      // Set first certification service selected as default when the list is updated\n+      if (val && val.length === 1) {", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk3Mzc1Nw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r430973757", "bodyText": "Actually it is possible to remove the if-clause and just:\nThis would set certificationService value each time (undefined if no value)\nthis.certificationService = val?.[0].name\nThis would work identical to what it is now.\nthis.certificationService = val?.[0].name ?? this.sertificationService;\nUp to you what to do, but I'd change at least to that optional chaining in the first comment :)", "author": "TJaakkola", "createdAt": "2020-05-27T09:14:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk3MDA5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2NzMwMQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432467301", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:02:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk3MDA5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk3NTIzOA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r430975238", "bodyText": "You haven't touch this logic, but could refactor it like above", "author": "TJaakkola", "createdAt": "2020-05-27T09:16:40Z", "path": "src/proxy-ui-api/frontend/src/components/wizard/WizardPageCsrDetails.vue", "diffHunk": "@@ -189,7 +189,7 @@ export default Vue.extend({\n       }\n     },\n     localMembersIds(val) {\n-      // Set first client selected as defaulg when the list is updated\n+      // Set first client selected as default when the list is updated\n       if (val && val.length === 1) {", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2NzM2Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432467363", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:03:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk3NTIzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAxODgzOA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431018838", "bodyText": "In general I find a bit inconsistent that async await is used here but everywhere else dealing with promises has been done the 'old way' (attaching then and catch handlers to the promise). Also if we have to use the async await here perhaps we're using the wrong approach in the first place.\nAnyway using the old promise handling way inside async function feels a bit odd too. That could easily be changed to use await instead. The same goes for 'checkForValidSignCert' -function - maybe just use async await there too.", "author": "TJaakkola", "createdAt": "2020-05-27T10:32:18Z", "path": "src/proxy-ui-api/frontend/src/store/modules/addClient.ts", "diffHunk": "@@ -132,6 +201,81 @@ export const actions: ActionTree<AddClientState, RootState> = {\n       });\n   },\n \n+  createMember({ commit, state }) {\n+    const body = {\n+      client: {\n+        member_class: state.memberClass,\n+        member_code: state.memberCode,\n+      },\n+      ignore_warnings: false,\n+    };\n+\n+    return api.post('/clients', body)\n+      .catch((error) => {\n+        throw error;\n+      });\n+  },\n+\n+  async searchTokens({ commit, dispatch }, { instanceId, memberClass, memberCode }) {", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA2MjU4Ng==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432062586", "bodyText": "I refactored it to use only async await. I suppose it's possible to do this with the \"old way\", but I couldn't wrap my brains around how to not make it look like \"spaghetti\".", "author": "Riippi", "createdAt": "2020-05-28T19:15:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAxODgzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAyNDM1NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431024355", "bodyText": "checkForValidSignCert may throw an error which would stop executing this thread.", "author": "TJaakkola", "createdAt": "2020-05-27T10:42:58Z", "path": "src/proxy-ui-api/frontend/src/store/modules/addClient.ts", "diffHunk": "@@ -132,6 +201,81 @@ export const actions: ActionTree<AddClientState, RootState> = {\n       });\n   },\n \n+  createMember({ commit, state }) {\n+    const body = {\n+      client: {\n+        member_class: state.memberClass,\n+        member_code: state.memberCode,\n+      },\n+      ignore_warnings: false,\n+    };\n+\n+    return api.post('/clients', body)\n+      .catch((error) => {\n+        throw error;\n+      });\n+  },\n+\n+  async searchTokens({ commit, dispatch }, { instanceId, memberClass, memberCode }) {\n+\n+    const ownerId = createClientId(instanceId, memberClass, memberCode);\n+    const hasValidCert = await checkForValidSignCert(instanceId, memberClass, memberCode);", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2ODkzNQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432468935", "bodyText": "I removed the whole function", "author": "Riippi", "createdAt": "2020-05-29T13:05:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAyNDM1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAyNTM2NA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431025364", "bodyText": "Actually this return a promise, not true", "author": "TJaakkola", "createdAt": "2020-05-27T10:44:46Z", "path": "src/proxy-ui-api/frontend/src/store/modules/addClient.ts", "diffHunk": "@@ -132,6 +201,81 @@ export const actions: ActionTree<AddClientState, RootState> = {\n       });\n   },\n \n+  createMember({ commit, state }) {\n+    const body = {\n+      client: {\n+        member_class: state.memberClass,\n+        member_code: state.memberCode,\n+      },\n+      ignore_warnings: false,\n+    };\n+\n+    return api.post('/clients', body)\n+      .catch((error) => {\n+        throw error;\n+      });\n+  },\n+\n+  async searchTokens({ commit, dispatch }, { instanceId, memberClass, memberCode }) {\n+\n+    const ownerId = createClientId(instanceId, memberClass, memberCode);\n+    const hasValidCert = await checkForValidSignCert(instanceId, memberClass, memberCode);\n+\n+    if (hasValidCert) {\n+      commit('setAddMemberWizardMode', AddMemberWizardModes.CERTIFICATE_EXISTS);\n+      return;\n+    }\n+\n+    // Fetch tokens from backend\n+    api\n+      .get(`/tokens`)\n+      .then((res) => {\n+\n+        // Find if a token has a sign key with a certificate that has matching client data\n+        res.data.some((token: Token) => {\n+          return token.keys.some((key: Key) => {\n+            if (key.usage === UsageTypes.SIGNING) {\n+\n+              // Go through the keys certificates\n+              const foundCert: boolean = key.certificates.some((certificate: TokenCertificate) => {\n+                if (ownerId === certificate.owner_id) {\n+                  commit('setAddMemberWizardMode', AddMemberWizardModes.CERTIFICATE_EXISTS);\n+                  return true;\n+                }\n+              });\n+\n+              if (foundCert) { return true; }\n+\n+              // Go through the keys CSR:s\n+              key.certificate_signing_requests.some((csr: TokenCertificateSigningRequest) => {\n+                if (ownerId === csr.owner_id) {\n+                  dispatch('setCsrTokenId', token.id);\n+                  commit('setAddMemberWizardMode', AddMemberWizardModes.CSR_EXISTS);\n+                  return true;\n+                }\n+              });\n+            }\n+          });\n+        });\n+      })\n+      .catch((error: Error) => {\n+        throw error;\n+      });\n+\n+  },\n+};\n+\n+const checkForValidSignCert = async (instanceId: string, memberClass: string, memberCode: string): Promise<boolean> => {\n+  // Make a request to backend for a client\n+  // returns true if it has a local valid sign certificate", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2OTI0NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432469245", "bodyText": "I removed the whole function", "author": "Riippi", "createdAt": "2020-05-29T13:06:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAyNTM2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzMTkyOQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431031929", "bodyText": "A shorter way for this:\nconst memberAlreadyExists = members.find((member: ExtendedClient) => member.member_class === element.member_class && member.member_code === element.member_code && member.instance_id === element.instance_id)\nperhaps you could also use destructuring in the lambda parameters to not have to use that 'member.' multiple times.", "author": "TJaakkola", "createdAt": "2020-05-27T10:58:06Z", "path": "src/proxy-ui-api/frontend/src/store/modules/clients.ts", "diffHunk": "@@ -2,103 +2,151 @@ import axios from 'axios';\n import { cloneDeep } from 'lodash';\n import { ActionTree, GetterTree, Module, MutationTree } from 'vuex';\n import { RootState } from '../types';\n+import { Client } from '@/types';\n+import { createClientId } from '@/util/helpers';\n+import { ExtendedClient } from '@/ui-types';\n+import { ClientTypes } from '@/global';\n import i18n from './../../i18n';\n \n-export interface Client {\n-  id: string;\n-  name?: string | null;\n-  sortNameAsc?: string | null;\n-  sortNameDesc?: string | null;\n-  member_name: string | null;\n-  member_class: string;\n-  member_code: string;\n-  subsystem_code: string | null;\n-  created?: string | null;\n-  type?: string;\n-  status?: string;\n-  owner: boolean;\n-}\n-\n export interface ClientsState {\n   clients: Client[];\n-  loading: boolean;\n+  formattedClients: ExtendedClient[];\n+  clientsLoading: boolean;\n   localMembers: Client[];\n+  ownerMember: Client |\u00a0undefined;\n+  members: ExtendedClient[]; // all local members, virtual and real\n+  realMembers: ExtendedClient[]; // local actual real members, owner +1\n+  virtualMembers: ExtendedClient[]; // local \"virtual\" members, generated from subsystem data\n+  subsystems: ExtendedClient[];\n }\n \n export const clientsState: ClientsState = {\n   clients: [],\n-  loading: false,\n+  formattedClients: [],\n+  clientsLoading: false,\n   localMembers: [],\n+  ownerMember: undefined,\n+  members: [],\n+  subsystems: [],\n+  realMembers: [],\n+  virtualMembers: [],\n };\n \n function createSortName(client: Client, sortName: string): any {\n   // Create a sort id for client in form  \"ACMEGOV:1234 MANAGEMENT\"\n   return sortName + client.member_class + client.member_code + ' ' + client.subsystem_code;\n }\n \n-function createMemberAscSortName(client: Client, sortName: string | null): any {\n+function createMemberAscSortName(client: Client, sortName: string | undefined): any {\n   // Create a sort id for member in form  \"ACMEGOV:1234\"\n   return sortName + client.member_class + client.member_code;\n }\n \n-function createMemberDescSortName(client: Client, sortName: any): any {\n+function createMemberDescSortName(client: Client, sortName: string | undefined): any {\n   // Create a sort id for member in form  \"ACMEGOV:1234!\"\n   return sortName + client.member_class + client.member_code + '!';\n }\n \n export const getters: GetterTree<ClientsState, RootState> = {\n-  clients(state): Client[] {\n+  clients(state): ExtendedClient[] {\n+    return state.formattedClients;\n+  },\n+\n+  realMembers(state): ExtendedClient[] {\n+    return state.realMembers;\n+  },\n+\n+  localMembers(state): Client[] {\n+    return state.localMembers;\n+  },\n+\n+  localMembersIds(state): Client[] {\n+    return state.localMembers;\n+  },\n+\n+  clientsLoading(state): boolean {\n+    return state.clientsLoading;\n+  },\n+\n+  ownerMember(state): Client |\u00a0undefined {\n+    return state.ownerMember;\n+  },\n+\n+};\n+\n+export const mutations: MutationTree<ClientsState> = {\n+  storeClients(state, clients: Client[]) {\n+    state.clients = clients;\n+\n     // New arrays to separate members and subsystems\n-    const members: Client[] = [];\n-    const subsystems: Client[] = [];\n+    const realMembers: ExtendedClient[] = [];\n+    const members: ExtendedClient[] = [];\n+    const virtualMembers: ExtendedClient[] = [];\n+    const subsystems: ExtendedClient[] = [];\n     const UNKNOWN_NAME: string = i18n.t('client.unknownMember') as string;\n \n-    // Find the owner member (there is only one)\n-    state.clients.forEach((element, index) => {\n-      if (element.owner === true) {\n-        const clone = cloneDeep(element);\n-        clone.type = 'owner';\n-        clone.subsystem_code = null;\n-        clone.name = clone.member_name;\n+    // Find members. Owner member (there is only one) and possible other member\n+    state.clients.forEach((element: Client) => {\n+\n+      if (!element.subsystem_code) {\n+        const clone = cloneDeep(element) as ExtendedClient;\n+        clone.type = ClientTypes.OWNER_MEMBER;\n+        clone.subsystem_code = undefined;\n+        clone.visibleName = clone.member_name;\n         clone.sortNameAsc = createMemberAscSortName(clone, clone.member_name); // clone.member_name + clone.member_class + clone.member_code;\n         clone.sortNameDesc = createMemberDescSortName(clone, clone.member_name); // clone.member_name + clone.member_class + clone.member_code + '!';\n+\n+        if (element.owner) {\n+          clone.type = ClientTypes.OWNER_MEMBER;\n+          state.ownerMember = element;\n+        } else {\n+          clone.type = ClientTypes.MEMBER;\n+        }\n+\n+        realMembers.push(clone);\n         members.push(clone);\n-        return;\n       }\n     });\n \n     // Pick out the members\n     state.clients.forEach((element) => {\n       // Check if the member is already in the members array\n-      const memberAlreadyExists = members.find((value, index) => {\n-        const cli = value as Client;\n-\n-        // Compare member class and member code\n-        if (cli.member_class === element.member_class && cli.member_code === element.member_code) {\n+      const memberAlreadyExists = members.find((member: ExtendedClient) => {\n+        // Compare member class, member code and instance id\n+        if (member.member_class === element.member_class && member.member_code === element.member_code\n+          && member.instance_id === element.instance_id) {\n           return true;\n         }\n \n         return false;\n       });", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ5Nzk4MQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432497981", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:54:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzMTkyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzMzQ5OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431033499", "bodyText": "I think using lodash cloneDeep should be avoided as there is task for getting rid of lodash", "author": "TJaakkola", "createdAt": "2020-05-27T11:01:15Z", "path": "src/proxy-ui-api/frontend/src/store/modules/clients.ts", "diffHunk": "@@ -2,103 +2,151 @@ import axios from 'axios';\n import { cloneDeep } from 'lodash';\n import { ActionTree, GetterTree, Module, MutationTree } from 'vuex';\n import { RootState } from '../types';\n+import { Client } from '@/types';\n+import { createClientId } from '@/util/helpers';\n+import { ExtendedClient } from '@/ui-types';\n+import { ClientTypes } from '@/global';\n import i18n from './../../i18n';\n \n-export interface Client {\n-  id: string;\n-  name?: string | null;\n-  sortNameAsc?: string | null;\n-  sortNameDesc?: string | null;\n-  member_name: string | null;\n-  member_class: string;\n-  member_code: string;\n-  subsystem_code: string | null;\n-  created?: string | null;\n-  type?: string;\n-  status?: string;\n-  owner: boolean;\n-}\n-\n export interface ClientsState {\n   clients: Client[];\n-  loading: boolean;\n+  formattedClients: ExtendedClient[];\n+  clientsLoading: boolean;\n   localMembers: Client[];\n+  ownerMember: Client |\u00a0undefined;\n+  members: ExtendedClient[]; // all local members, virtual and real\n+  realMembers: ExtendedClient[]; // local actual real members, owner +1\n+  virtualMembers: ExtendedClient[]; // local \"virtual\" members, generated from subsystem data\n+  subsystems: ExtendedClient[];\n }\n \n export const clientsState: ClientsState = {\n   clients: [],\n-  loading: false,\n+  formattedClients: [],\n+  clientsLoading: false,\n   localMembers: [],\n+  ownerMember: undefined,\n+  members: [],\n+  subsystems: [],\n+  realMembers: [],\n+  virtualMembers: [],\n };\n \n function createSortName(client: Client, sortName: string): any {\n   // Create a sort id for client in form  \"ACMEGOV:1234 MANAGEMENT\"\n   return sortName + client.member_class + client.member_code + ' ' + client.subsystem_code;\n }\n \n-function createMemberAscSortName(client: Client, sortName: string | null): any {\n+function createMemberAscSortName(client: Client, sortName: string | undefined): any {\n   // Create a sort id for member in form  \"ACMEGOV:1234\"\n   return sortName + client.member_class + client.member_code;\n }\n \n-function createMemberDescSortName(client: Client, sortName: any): any {\n+function createMemberDescSortName(client: Client, sortName: string | undefined): any {\n   // Create a sort id for member in form  \"ACMEGOV:1234!\"\n   return sortName + client.member_class + client.member_code + '!';\n }\n \n export const getters: GetterTree<ClientsState, RootState> = {\n-  clients(state): Client[] {\n+  clients(state): ExtendedClient[] {\n+    return state.formattedClients;\n+  },\n+\n+  realMembers(state): ExtendedClient[] {\n+    return state.realMembers;\n+  },\n+\n+  localMembers(state): Client[] {\n+    return state.localMembers;\n+  },\n+\n+  localMembersIds(state): Client[] {\n+    return state.localMembers;\n+  },\n+\n+  clientsLoading(state): boolean {\n+    return state.clientsLoading;\n+  },\n+\n+  ownerMember(state): Client |\u00a0undefined {\n+    return state.ownerMember;\n+  },\n+\n+};\n+\n+export const mutations: MutationTree<ClientsState> = {\n+  storeClients(state, clients: Client[]) {\n+    state.clients = clients;\n+\n     // New arrays to separate members and subsystems\n-    const members: Client[] = [];\n-    const subsystems: Client[] = [];\n+    const realMembers: ExtendedClient[] = [];\n+    const members: ExtendedClient[] = [];\n+    const virtualMembers: ExtendedClient[] = [];\n+    const subsystems: ExtendedClient[] = [];\n     const UNKNOWN_NAME: string = i18n.t('client.unknownMember') as string;\n \n-    // Find the owner member (there is only one)\n-    state.clients.forEach((element, index) => {\n-      if (element.owner === true) {\n-        const clone = cloneDeep(element);\n-        clone.type = 'owner';\n-        clone.subsystem_code = null;\n-        clone.name = clone.member_name;\n+    // Find members. Owner member (there is only one) and possible other member\n+    state.clients.forEach((element: Client) => {\n+\n+      if (!element.subsystem_code) {\n+        const clone = cloneDeep(element) as ExtendedClient;\n+        clone.type = ClientTypes.OWNER_MEMBER;\n+        clone.subsystem_code = undefined;\n+        clone.visibleName = clone.member_name;\n         clone.sortNameAsc = createMemberAscSortName(clone, clone.member_name); // clone.member_name + clone.member_class + clone.member_code;\n         clone.sortNameDesc = createMemberDescSortName(clone, clone.member_name); // clone.member_name + clone.member_class + clone.member_code + '!';\n+\n+        if (element.owner) {\n+          clone.type = ClientTypes.OWNER_MEMBER;\n+          state.ownerMember = element;\n+        } else {\n+          clone.type = ClientTypes.MEMBER;\n+        }\n+\n+        realMembers.push(clone);\n         members.push(clone);\n-        return;\n       }\n     });\n \n     // Pick out the members\n     state.clients.forEach((element) => {\n       // Check if the member is already in the members array\n-      const memberAlreadyExists = members.find((value, index) => {\n-        const cli = value as Client;\n-\n-        // Compare member class and member code\n-        if (cli.member_class === element.member_class && cli.member_code === element.member_code) {\n+      const memberAlreadyExists = members.find((member: ExtendedClient) => {\n+        // Compare member class, member code and instance id\n+        if (member.member_class === element.member_class && member.member_code === element.member_code\n+          && member.instance_id === element.instance_id) {\n           return true;\n         }\n \n         return false;\n       });\n \n       if (!memberAlreadyExists) {\n-        // If member is not in members array, create and add it\n-        const clone = cloneDeep(element);\n-        clone.type = 'client';\n+        // If \"virtual member\" is not in members array, create and add it\n+        const clone = cloneDeep(element) as any;", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ5Nzg5Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432497893", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:54:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzMzQ5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzNDI5Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431034293", "bodyText": "Should this be removed?", "author": "TJaakkola", "createdAt": "2020-05-27T11:02:57Z", "path": "src/proxy-ui-api/frontend/src/store/modules/user.ts", "diffHunk": "@@ -108,15 +108,11 @@ export const actions: ActionTree<UserState, RootState> = {\n   },\n \n   async fetchUserData({ commit, dispatch }) {\n-\n-    commit('setLoading', true);\n-\n     return axios.get('/user')\n       .then((res) => {\n         console.log(res);", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUwMTA0MQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432501041", "bodyText": "Yes, that was probably there because of some old copy paste accident.", "author": "Riippi", "createdAt": "2020-05-29T13:59:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzNDI5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzNTEzMA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431035130", "bodyText": "Shouldn't use lodash if possible", "author": "TJaakkola", "createdAt": "2020-05-27T11:04:49Z", "path": "src/proxy-ui-api/frontend/src/util/helpers.ts", "diffHunk": "@@ -1,4 +1,5 @@\n import { Client } from '@/types';\n+import { cloneDeep } from 'lodash';", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUwMzAwMA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432503000", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T14:02:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzNTEzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzNzkzMg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431037932", "bodyText": "optional chaining or not using if block like above", "author": "TJaakkola", "createdAt": "2020-05-27T11:10:14Z", "path": "src/proxy-ui-api/frontend/src/views/AddClient/ClientDetailsPage.vue", "diffHunk": "@@ -175,6 +176,16 @@ export default Vue.extend({\n   },\n   created() {\n     this.$store.dispatch('fetchSelectableClients');\n+    this.$store.dispatch('fetchMemberClasses');\n+  },\n+\n+  watch: {\n+    memberClasses(val) {\n+      // Set first member class selected as default when the list is updated\n+      if (val && val.length === 1) {", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUwNjAxMQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432506011", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T14:07:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzNzkzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzODM3Mg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431038372", "bodyText": "typings missing", "author": "TJaakkola", "createdAt": "2020-05-27T11:11:14Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/AddMember.vue", "diffHunk": "@@ -0,0 +1,297 @@\n+\n+<template>\n+  <div class=\"view-wrap\">\n+    <subViewTitle\n+      class=\"view-title\"\n+      :title=\"$t('wizard.addMemberTitle')\"\n+      :showClose=\"false\"\n+      data-test=\"wizard-title\"\n+    />\n+\n+    <v-stepper :alt-labels=\"true\" v-model=\"currentStep\" class=\"stepper noshadow\">\n+      <template v-if=\"addMemberWizardMode === wizardModes.FULL\">\n+        <v-stepper-header class=\"noshadow\">\n+          <v-stepper-step :complete=\"currentStep > 1\" step=\"1\">{{$t('wizard.member.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 2\" step=\"2\">{{$t('wizard.token.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 3\" step=\"3\">{{$t('wizard.signKey.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 4\" step=\"4\">{{$t('csr.csrDetails')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 5\" step=\"5\">{{$t('csr.generateCsr')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step step=\"6\">{{$t('wizard.finish.title')}}</v-stepper-step>\n+        </v-stepper-header>\n+      </template>\n+\n+      <template v-if=\"addMemberWizardMode === wizardModes.CERTIFICATE_EXISTS\">\n+        <v-stepper-header class=\"noshadow\">\n+          <v-stepper-step :complete=\"currentStep > 1\" step=\"1\">{{$t('wizard.member.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step step=\"2\">{{$t('wizard.finish.title')}}</v-stepper-step>\n+        </v-stepper-header>\n+      </template>\n+\n+      <template v-if=\"addMemberWizardMode === wizardModes.CSR_EXISTS\">\n+        <v-stepper-header class=\"noshadow\">\n+          <v-stepper-step :complete=\"currentStep > 1\" step=\"1\">{{$t('wizard.member.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 2\" step=\"2\">{{$t('csr.csrDetails')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 3\" step=\"3\">{{$t('csr.generateCsr')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step step=\"4\">{{$t('wizard.finish.title')}}</v-stepper-step>\n+        </v-stepper-header>\n+      </template>\n+\n+      <v-stepper-items class=\"stepper-content\">\n+        <!-- Step 1 -->\n+        <v-stepper-content step=\"1\">\n+          <MemberDetailsPage @cancel=\"cancel\" @done=\"currentStep++\" />\n+        </v-stepper-content>\n+        <!-- Step 2 -->\n+        <v-stepper-content :step=\"tokenPageNumber\">\n+          <TokenPage @cancel=\"cancel\" @previous=\"previousPage\" @done=\"tokenReady\" />\n+        </v-stepper-content>\n+        <!-- Step 3 -->\n+        <v-stepper-content :step=\"keyPageNumber\">\n+          <SignKeyPage @cancel=\"cancel\" @previous=\"previousPage\" @done=\"currentStep++\" />\n+        </v-stepper-content>\n+        <!-- Step 4 -->\n+        <v-stepper-content :step=\"csrDetailsPageNumber\">\n+          <CsrDetailsPageLocked\n+            @cancel=\"cancel\"\n+            @previous=\"previousPage\"\n+            @done=\"csrDetailsReady\"\n+            saveButtonText=\"action.next\"\n+          />\n+        </v-stepper-content>\n+        <!-- Step 5 -->\n+        <v-stepper-content :step=\"csrGeneratePageNumber\">\n+          <GenerateCsrPage\n+            @cancel=\"cancel\"\n+            @previous=\"previousPage\"\n+            @done=\"currentStep++\"\n+            saveButtonText=\"action.next\"\n+          />\n+        </v-stepper-content>\n+        <!-- Step 6 -->\n+        <v-stepper-content :step=\"finishPageNumber\">\n+          <FinishPage @cancel=\"cancel\" @previous=\"previousPage\" @done=\"done\" />\n+        </v-stepper-content>\n+      </v-stepper-items>\n+    </v-stepper>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import MemberDetailsPage from './MemberDetailsPage.vue';\n+import TokenPage from './TokenPage.vue';\n+import SignKeyPage from './SignKeyPage.vue';\n+import FinishPage from './FinishPage.vue';\n+import CsrDetailsPageLocked from '@/components/wizard/CsrDetailsPageLocked.vue';\n+import GenerateCsrPage from './GenerateCsrPage.vue';\n+\n+import { Key, Token } from '@/types';\n+import { RouteName, AddMemberWizardModes } from '@/global';\n+import * as api from '@/util/api';\n+\n+export default Vue.extend({\n+  components: {\n+    HelpIcon,\n+    LargeButton,\n+    SubViewTitle,\n+    MemberDetailsPage,\n+    TokenPage,\n+    SignKeyPage,\n+    FinishPage,\n+    CsrDetailsPageLocked,\n+    GenerateCsrPage,\n+  },\n+  props: {\n+    instanceId: {\n+      type: String,\n+      required: true,\n+    },\n+    memberClass: {\n+      type: String,\n+      required: true,\n+    },\n+    memberCode: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+      wizardModes: AddMemberWizardModes,", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUwNzcxMg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432507712", "bodyText": "Added", "author": "Riippi", "createdAt": "2020-05-29T14:10:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzODM3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzOTcyOA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431039728", "bodyText": "Maybe this 999 could be addressed to a variable that tells better what is it for.\nLike const NO_SELECTION = 999;", "author": "TJaakkola", "createdAt": "2020-05-27T11:14:06Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/AddMember.vue", "diffHunk": "@@ -0,0 +1,297 @@\n+\n+<template>\n+  <div class=\"view-wrap\">\n+    <subViewTitle\n+      class=\"view-title\"\n+      :title=\"$t('wizard.addMemberTitle')\"\n+      :showClose=\"false\"\n+      data-test=\"wizard-title\"\n+    />\n+\n+    <v-stepper :alt-labels=\"true\" v-model=\"currentStep\" class=\"stepper noshadow\">\n+      <template v-if=\"addMemberWizardMode === wizardModes.FULL\">\n+        <v-stepper-header class=\"noshadow\">\n+          <v-stepper-step :complete=\"currentStep > 1\" step=\"1\">{{$t('wizard.member.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 2\" step=\"2\">{{$t('wizard.token.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 3\" step=\"3\">{{$t('wizard.signKey.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 4\" step=\"4\">{{$t('csr.csrDetails')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 5\" step=\"5\">{{$t('csr.generateCsr')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step step=\"6\">{{$t('wizard.finish.title')}}</v-stepper-step>\n+        </v-stepper-header>\n+      </template>\n+\n+      <template v-if=\"addMemberWizardMode === wizardModes.CERTIFICATE_EXISTS\">\n+        <v-stepper-header class=\"noshadow\">\n+          <v-stepper-step :complete=\"currentStep > 1\" step=\"1\">{{$t('wizard.member.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step step=\"2\">{{$t('wizard.finish.title')}}</v-stepper-step>\n+        </v-stepper-header>\n+      </template>\n+\n+      <template v-if=\"addMemberWizardMode === wizardModes.CSR_EXISTS\">\n+        <v-stepper-header class=\"noshadow\">\n+          <v-stepper-step :complete=\"currentStep > 1\" step=\"1\">{{$t('wizard.member.title')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 2\" step=\"2\">{{$t('csr.csrDetails')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step :complete=\"currentStep > 3\" step=\"3\">{{$t('csr.generateCsr')}}</v-stepper-step>\n+          <v-divider></v-divider>\n+          <v-stepper-step step=\"4\">{{$t('wizard.finish.title')}}</v-stepper-step>\n+        </v-stepper-header>\n+      </template>\n+\n+      <v-stepper-items class=\"stepper-content\">\n+        <!-- Step 1 -->\n+        <v-stepper-content step=\"1\">\n+          <MemberDetailsPage @cancel=\"cancel\" @done=\"currentStep++\" />\n+        </v-stepper-content>\n+        <!-- Step 2 -->\n+        <v-stepper-content :step=\"tokenPageNumber\">\n+          <TokenPage @cancel=\"cancel\" @previous=\"previousPage\" @done=\"tokenReady\" />\n+        </v-stepper-content>\n+        <!-- Step 3 -->\n+        <v-stepper-content :step=\"keyPageNumber\">\n+          <SignKeyPage @cancel=\"cancel\" @previous=\"previousPage\" @done=\"currentStep++\" />\n+        </v-stepper-content>\n+        <!-- Step 4 -->\n+        <v-stepper-content :step=\"csrDetailsPageNumber\">\n+          <CsrDetailsPageLocked\n+            @cancel=\"cancel\"\n+            @previous=\"previousPage\"\n+            @done=\"csrDetailsReady\"\n+            saveButtonText=\"action.next\"\n+          />\n+        </v-stepper-content>\n+        <!-- Step 5 -->\n+        <v-stepper-content :step=\"csrGeneratePageNumber\">\n+          <GenerateCsrPage\n+            @cancel=\"cancel\"\n+            @previous=\"previousPage\"\n+            @done=\"currentStep++\"\n+            saveButtonText=\"action.next\"\n+          />\n+        </v-stepper-content>\n+        <!-- Step 6 -->\n+        <v-stepper-content :step=\"finishPageNumber\">\n+          <FinishPage @cancel=\"cancel\" @previous=\"previousPage\" @done=\"done\" />\n+        </v-stepper-content>\n+      </v-stepper-items>\n+    </v-stepper>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import HelpIcon from '@/components/ui/HelpIcon.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SubViewTitle from '@/components/ui/SubViewTitle.vue';\n+import MemberDetailsPage from './MemberDetailsPage.vue';\n+import TokenPage from './TokenPage.vue';\n+import SignKeyPage from './SignKeyPage.vue';\n+import FinishPage from './FinishPage.vue';\n+import CsrDetailsPageLocked from '@/components/wizard/CsrDetailsPageLocked.vue';\n+import GenerateCsrPage from './GenerateCsrPage.vue';\n+\n+import { Key, Token } from '@/types';\n+import { RouteName, AddMemberWizardModes } from '@/global';\n+import * as api from '@/util/api';\n+\n+export default Vue.extend({\n+  components: {\n+    HelpIcon,\n+    LargeButton,\n+    SubViewTitle,\n+    MemberDetailsPage,\n+    TokenPage,\n+    SignKeyPage,\n+    FinishPage,\n+    CsrDetailsPageLocked,\n+    GenerateCsrPage,\n+  },\n+  props: {\n+    instanceId: {\n+      type: String,\n+      required: true,\n+    },\n+    memberClass: {\n+      type: String,\n+      required: true,\n+    },\n+    memberCode: {\n+      type: String,\n+      required: true,\n+    },\n+  },\n+  data() {\n+    return {\n+      currentStep: 1,\n+      wizardModes: AddMemberWizardModes,\n+    };\n+  },\n+\n+  computed: {\n+    ...mapGetters(['addMemberWizardMode']),\n+\n+    tokenPageNumber(): number {\n+      if (\n+        this.addMemberWizardMode === AddMemberWizardModes.CERTIFICATE_EXISTS ||\n+        this.addMemberWizardMode === AddMemberWizardModes.CSR_EXISTS\n+      ) {\n+        return 999;", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUwNzM4OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432507389", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T14:09:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTAzOTcyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0MTgzNg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431041836", "bodyText": "return this.addMemberWizardMode === AddMemberWizardModes.CERTIFICATE_EXISTS;\nAt somepoint there were problems using these shorthands. How about here?", "author": "TJaakkola", "createdAt": "2020-05-27T11:18:21Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/FinishPage.vue", "diffHunk": "@@ -0,0 +1,178 @@\n+<template>\n+  <div data-test=\"finish-content\">\n+    <p>\n+      {{$t('wizard.finish.infoLine1')}}\n+      <br />\n+      {{$t('wizard.finish.infoLine2')}}\n+    </p>\n+    <br />\n+    <p>{{$t('wizard.finish.todo1')}}</p>\n+    <p>{{$t('wizard.finish.todo2')}}</p>\n+    <p>{{$t('wizard.finish.todo3')}}</p>\n+    <br />\n+    <br />\n+    <p>{{$t('wizard.finish.note')}}</p>\n+    <p></p>\n+\n+    <div v-if=\"showRegisterOption\" class=\"row-wrap\">\n+      <FormLabel labelText=\"wizard.member.register\" />\n+      <v-checkbox\n+        v-model=\"registerChecked\"\n+        color=\"primary\"\n+        class=\"register-checkbox\"\n+        data-test=\"register-member-checkbox\"\n+      ></v-checkbox>\n+    </div>\n+\n+    <div class=\"button-footer\">\n+      <div class=\"button-group\">\n+        <large-button\n+          outlined\n+          @click=\"cancel\"\n+          :disabled=\"disableCancel\"\n+          data-test=\"cancel-button\"\n+        >{{$t('action.cancel')}}</large-button>\n+      </div>\n+\n+      <div>\n+        <large-button\n+          @click=\"previous\"\n+          outlined\n+          :disabled=\"disableCancel\"\n+          class=\"previous-button\"\n+          data-test=\"previous-button\"\n+        >{{$t('action.previous')}}</large-button>\n+\n+        <large-button\n+          @click=\"done\"\n+          data-test=\"submit-button\"\n+          :loading=\"submitLoading\"\n+        >{{$t('action.submit')}}</large-button>\n+      </div>\n+    </div>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '@/global';\n+import { createClientId } from '@/util/helpers';\n+\n+export default Vue.extend({\n+  components: {\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    FormLabel,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'addMemberWizardMode',\n+      'memberClass',\n+      'memberCode',\n+      'reservedMember',\n+    ]),\n+\n+    showRegisterOption() {\n+      if (\n+        this.addMemberWizardMode === AddMemberWizardModes.CERTIFICATE_EXISTS\n+      ) {\n+        return true;\n+      }\n+      return false;", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUxMzI2NA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432513264", "bodyText": "Yes, it's computed property and it causes problems.", "author": "Riippi", "createdAt": "2020-05-29T14:17:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0MTgzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0Mzg1NA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431043854", "bodyText": "Instead of duplicating setting false values in both success and fail callbacks you could set finally-block and do those just once there.\nI presume dispatch returns promise not sure though.", "author": "TJaakkola", "createdAt": "2020-05-27T11:22:15Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/FinishPage.vue", "diffHunk": "@@ -0,0 +1,178 @@\n+<template>\n+  <div data-test=\"finish-content\">\n+    <p>\n+      {{$t('wizard.finish.infoLine1')}}\n+      <br />\n+      {{$t('wizard.finish.infoLine2')}}\n+    </p>\n+    <br />\n+    <p>{{$t('wizard.finish.todo1')}}</p>\n+    <p>{{$t('wizard.finish.todo2')}}</p>\n+    <p>{{$t('wizard.finish.todo3')}}</p>\n+    <br />\n+    <br />\n+    <p>{{$t('wizard.finish.note')}}</p>\n+    <p></p>\n+\n+    <div v-if=\"showRegisterOption\" class=\"row-wrap\">\n+      <FormLabel labelText=\"wizard.member.register\" />\n+      <v-checkbox\n+        v-model=\"registerChecked\"\n+        color=\"primary\"\n+        class=\"register-checkbox\"\n+        data-test=\"register-member-checkbox\"\n+      ></v-checkbox>\n+    </div>\n+\n+    <div class=\"button-footer\">\n+      <div class=\"button-group\">\n+        <large-button\n+          outlined\n+          @click=\"cancel\"\n+          :disabled=\"disableCancel\"\n+          data-test=\"cancel-button\"\n+        >{{$t('action.cancel')}}</large-button>\n+      </div>\n+\n+      <div>\n+        <large-button\n+          @click=\"previous\"\n+          outlined\n+          :disabled=\"disableCancel\"\n+          class=\"previous-button\"\n+          data-test=\"previous-button\"\n+        >{{$t('action.previous')}}</large-button>\n+\n+        <large-button\n+          @click=\"done\"\n+          data-test=\"submit-button\"\n+          :loading=\"submitLoading\"\n+        >{{$t('action.submit')}}</large-button>\n+      </div>\n+    </div>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '@/global';\n+import { createClientId } from '@/util/helpers';\n+\n+export default Vue.extend({\n+  components: {\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    FormLabel,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'addMemberWizardMode',\n+      'memberClass',\n+      'memberCode',\n+      'reservedMember',\n+    ]),\n+\n+    showRegisterOption() {\n+      if (\n+        this.addMemberWizardMode === AddMemberWizardModes.CERTIFICATE_EXISTS\n+      ) {\n+        return true;\n+      }\n+      return false;\n+    },\n+  },\n+  data() {\n+    return {\n+      disableCancel: false as boolean,\n+      registerChecked: true as boolean,\n+      submitLoading: false as boolean,\n+    };\n+  },\n+  methods: {\n+    cancel(): void {\n+      this.$emit('cancel');\n+    },\n+    previous(): void {\n+      this.$emit('previous');\n+    },\n+    done(): void {\n+      this.disableCancel = true;\n+      this.submitLoading = true;\n+\n+      this.$store.dispatch('createMember').then(\n+        (response) => {\n+          if (\n+            this.addMemberWizardMode ===\n+              AddMemberWizardModes.CERTIFICATE_EXISTS &&\n+            this.registerChecked\n+          ) {\n+            this.registerClient();\n+          } else if (\n+            this.addMemberWizardMode === AddMemberWizardModes.CERTIFICATE_EXISTS\n+          ) {\n+            this.disableCancel = false;\n+            this.submitLoading = false;\n+            this.$emit('done');\n+          } else {\n+            this.generateCsr();\n+          }\n+        },\n+        (error) => {\n+          this.$store.dispatch('showError', error);\n+          this.disableCancel = false;\n+          this.submitLoading = false;\n+        },\n+      );\n+    },\n+\n+    generateCsr(): void {\n+      const tokenId = this.$store.getters.csrTokenId;\n+\n+      this.$store.dispatch('generateKeyAndCsr', tokenId).then(\n+        (response) => {\n+          this.disableCancel = false;\n+          this.submitLoading = false;\n+          this.$emit('done');\n+        },\n+        (error) => {\n+          this.$store.dispatch('showError', error);\n+          this.disableCancel = false;\n+          this.submitLoading = false;\n+        },", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU2MjUwNw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432562507", "bodyText": "It depends what is on the vuex end of the dispatch call. This one does return promise. Changed it to use finally().", "author": "Riippi", "createdAt": "2020-05-29T15:27:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0Mzg1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NDI1OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431044259", "bodyText": "Same  as above", "author": "TJaakkola", "createdAt": "2020-05-27T11:22:59Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/FinishPage.vue", "diffHunk": "@@ -0,0 +1,178 @@\n+<template>\n+  <div data-test=\"finish-content\">\n+    <p>\n+      {{$t('wizard.finish.infoLine1')}}\n+      <br />\n+      {{$t('wizard.finish.infoLine2')}}\n+    </p>\n+    <br />\n+    <p>{{$t('wizard.finish.todo1')}}</p>\n+    <p>{{$t('wizard.finish.todo2')}}</p>\n+    <p>{{$t('wizard.finish.todo3')}}</p>\n+    <br />\n+    <br />\n+    <p>{{$t('wizard.finish.note')}}</p>\n+    <p></p>\n+\n+    <div v-if=\"showRegisterOption\" class=\"row-wrap\">\n+      <FormLabel labelText=\"wizard.member.register\" />\n+      <v-checkbox\n+        v-model=\"registerChecked\"\n+        color=\"primary\"\n+        class=\"register-checkbox\"\n+        data-test=\"register-member-checkbox\"\n+      ></v-checkbox>\n+    </div>\n+\n+    <div class=\"button-footer\">\n+      <div class=\"button-group\">\n+        <large-button\n+          outlined\n+          @click=\"cancel\"\n+          :disabled=\"disableCancel\"\n+          data-test=\"cancel-button\"\n+        >{{$t('action.cancel')}}</large-button>\n+      </div>\n+\n+      <div>\n+        <large-button\n+          @click=\"previous\"\n+          outlined\n+          :disabled=\"disableCancel\"\n+          class=\"previous-button\"\n+          data-test=\"previous-button\"\n+        >{{$t('action.previous')}}</large-button>\n+\n+        <large-button\n+          @click=\"done\"\n+          data-test=\"submit-button\"\n+          :loading=\"submitLoading\"\n+        >{{$t('action.submit')}}</large-button>\n+      </div>\n+    </div>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '@/global';\n+import { createClientId } from '@/util/helpers';\n+\n+export default Vue.extend({\n+  components: {\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    FormLabel,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'addMemberWizardMode',\n+      'memberClass',\n+      'memberCode',\n+      'reservedMember',\n+    ]),\n+\n+    showRegisterOption() {\n+      if (\n+        this.addMemberWizardMode === AddMemberWizardModes.CERTIFICATE_EXISTS\n+      ) {\n+        return true;\n+      }\n+      return false;\n+    },\n+  },\n+  data() {\n+    return {\n+      disableCancel: false as boolean,\n+      registerChecked: true as boolean,\n+      submitLoading: false as boolean,\n+    };\n+  },\n+  methods: {\n+    cancel(): void {\n+      this.$emit('cancel');\n+    },\n+    previous(): void {\n+      this.$emit('previous');\n+    },\n+    done(): void {\n+      this.disableCancel = true;\n+      this.submitLoading = true;\n+\n+      this.$store.dispatch('createMember').then(\n+        (response) => {\n+          if (\n+            this.addMemberWizardMode ===\n+              AddMemberWizardModes.CERTIFICATE_EXISTS &&\n+            this.registerChecked\n+          ) {\n+            this.registerClient();\n+          } else if (\n+            this.addMemberWizardMode === AddMemberWizardModes.CERTIFICATE_EXISTS\n+          ) {\n+            this.disableCancel = false;\n+            this.submitLoading = false;\n+            this.$emit('done');\n+          } else {\n+            this.generateCsr();\n+          }\n+        },\n+        (error) => {\n+          this.$store.dispatch('showError', error);\n+          this.disableCancel = false;\n+          this.submitLoading = false;\n+        },\n+      );\n+    },\n+\n+    generateCsr(): void {\n+      const tokenId = this.$store.getters.csrTokenId;\n+\n+      this.$store.dispatch('generateKeyAndCsr', tokenId).then(\n+        (response) => {\n+          this.disableCancel = false;\n+          this.submitLoading = false;\n+          this.$emit('done');\n+        },\n+        (error) => {\n+          this.$store.dispatch('showError', error);\n+          this.disableCancel = false;\n+          this.submitLoading = false;\n+        },\n+      );\n+    },\n+\n+    registerClient(): void {\n+      const clientId = createClientId(\n+        this.reservedMember.instanceId,\n+        this.memberClass,\n+        this.memberCode,\n+      );\n+\n+      this.$store.dispatch('registerClient', clientId).then(\n+        () => {\n+          this.disableCancel = false;\n+          this.submitLoading = false;\n+          this.$emit('done');\n+        },\n+        (error) => {\n+          this.$store.dispatch('showError', error);\n+          this.disableCancel = false;\n+          this.submitLoading = false;\n+          this.$emit('done');\n+        },\n+      );", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU2MjU5Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432562593", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T15:27:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NDI1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NDUwNA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431044504", "bodyText": "data-test missing", "author": "TJaakkola", "createdAt": "2020-05-27T11:23:32Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/GenerateCsrPage.vue", "diffHunk": "@@ -0,0 +1,99 @@\n+<template>\n+  <div>\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div v-for=\"item in csrForm\" v-bind:key=\"item.id\" class=\"row-wrap\">\n+        <div class=\"label\">{{$t('certificateProfile.' + item.label_key)}}</div>\n+\n+        <div>\n+          <ValidationProvider\n+            :name=\"item.id\"\n+            :rules=\"(item.required) && 'required' \"\n+            v-slot=\"{ errors }\"\n+          >\n+            <v-text-field", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUxOTAyNQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432519025", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T14:23:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NDUwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NDc2Ng==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431044766", "bodyText": "Is this block mandatory?", "author": "TJaakkola", "createdAt": "2020-05-27T11:24:05Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/GenerateCsrPage.vue", "diffHunk": "@@ -0,0 +1,99 @@\n+<template>\n+  <div>\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div v-for=\"item in csrForm\" v-bind:key=\"item.id\" class=\"row-wrap\">\n+        <div class=\"label\">{{$t('certificateProfile.' + item.label_key)}}</div>\n+\n+        <div>\n+          <ValidationProvider\n+            :name=\"item.id\"\n+            :rules=\"(item.required) && 'required' \"\n+            v-slot=\"{ errors }\"\n+          >\n+            <v-text-field\n+              class=\"form-input\"\n+              :name=\"item.id\"\n+              type=\"text\"\n+              v-model=\"item.default_value\"\n+              :disabled=\"item.read_only\"\n+              :error-messages=\"errors\"\n+            ></v-text-field>\n+          </ValidationProvider>\n+        </div>\n+      </div>\n+      <div class=\"button-footer\">\n+        <div class=\"button-group\">\n+          <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+        </div>\n+        <div>\n+          <large-button\n+            @click=\"previous\"\n+            outlined\n+            class=\"previous-button\"\n+            data-test=\"previous-button\"\n+          >{{$t('action.previous')}}</large-button>\n+          <large-button\n+            @click=\"done\"\n+            :disabled=\"invalid\"\n+            data-test=\"save-button\"\n+          >{{$t(saveButtonText)}}</large-button>\n+        </div>\n+      </div>\n+    </ValidationObserver>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+export default Vue.extend({\n+  components: {\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+  },\n+  props: {\n+    saveButtonText: {\n+      type: String,\n+      default: 'action.done',\n+    },\n+    showGenerateButton: {\n+      type: Boolean,\n+      default: true,\n+    },\n+  },\n+  computed: {\n+    ...mapGetters(['csrForm']),\n+  },\n+  data() {", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUxOTcxMQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432519711", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T14:24:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NDc2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NjY0Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431046643", "bodyText": "Remove if clause like above.", "author": "TJaakkola", "createdAt": "2020-05-27T11:27:59Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/MemberDetailsPage.vue", "diffHunk": "@@ -0,0 +1,280 @@\n+<template>\n+  <div>\n+    <div class=\"info-block\">\n+      <div>\n+        {{$t('wizard.member.info1')}}\n+        <br />\n+        <br />\n+        {{$t('wizard.member.info2')}}\n+      </div>\n+      <div class=\"action-block\">\n+        <large-button\n+          @click=\"showSelectClient = true\"\n+          outlined\n+          data-test=\"select-client-button\"\n+        >{{$t('wizard.member.select')}}</large-button>\n+      </div>\n+    </div>\n+\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+        <div data-test=\"selected-member-name\">{{selectedMemberName}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberClass\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"memberClasses\"\n+            class=\"form-input\"\n+            v-model=\"memberClass\"\n+            data-test=\"member-class-input\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberCode\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-text-field\n+            class=\"form-input\"\n+            type=\"text\"\n+            :error-messages=\"errors\"\n+            v-model=\"memberCode\"\n+            data-test=\"member-code-input\"\n+          ></v-text-field>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+      <div class=\"button-footer\">\n+        <div class=\"button-group\">\n+          <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+        </div>\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"invalid || duplicateClient ||\u00a0checkRunning\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </ValidationObserver>\n+\n+    <SelectClientDialog\n+      :dialog=\"showSelectClient\"\n+      :selectableClients=\"selectableMembers\"\n+      @cancel=\"showSelectClient = false\"\n+      @save=\"saveSelectedClient\"\n+    />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SelectClientDialog from '@/components/client/SelectClientDialog.vue';\n+import { Client } from '@/types';\n+import { debounce } from '@/util/helpers';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '../../global';\n+\n+let that: any;\n+\n+export default Vue.extend({\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'reservedMember',\n+      'memberClasses',\n+      'selectedMemberName',\n+    ]),\n+\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    selectableMembers(): Client[] {\n+      // Filter out the owner member\n+      const filtered = this.$store.getters.selectableMembers.filter(\n+        (client: Client) => {\n+          if (", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUyMjcwMA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432522700", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T14:27:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NjY0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0Njk5Mg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431046992", "bodyText": "If clause can be removed and just return the comparison result. Like above.", "author": "TJaakkola", "createdAt": "2020-05-27T11:28:42Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/MemberDetailsPage.vue", "diffHunk": "@@ -0,0 +1,280 @@\n+<template>\n+  <div>\n+    <div class=\"info-block\">\n+      <div>\n+        {{$t('wizard.member.info1')}}\n+        <br />\n+        <br />\n+        {{$t('wizard.member.info2')}}\n+      </div>\n+      <div class=\"action-block\">\n+        <large-button\n+          @click=\"showSelectClient = true\"\n+          outlined\n+          data-test=\"select-client-button\"\n+        >{{$t('wizard.member.select')}}</large-button>\n+      </div>\n+    </div>\n+\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+        <div data-test=\"selected-member-name\">{{selectedMemberName}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberClass\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"memberClasses\"\n+            class=\"form-input\"\n+            v-model=\"memberClass\"\n+            data-test=\"member-class-input\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberCode\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-text-field\n+            class=\"form-input\"\n+            type=\"text\"\n+            :error-messages=\"errors\"\n+            v-model=\"memberCode\"\n+            data-test=\"member-code-input\"\n+          ></v-text-field>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+      <div class=\"button-footer\">\n+        <div class=\"button-group\">\n+          <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+        </div>\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"invalid || duplicateClient ||\u00a0checkRunning\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </ValidationObserver>\n+\n+    <SelectClientDialog\n+      :dialog=\"showSelectClient\"\n+      :selectableClients=\"selectableMembers\"\n+      @cancel=\"showSelectClient = false\"\n+      @save=\"saveSelectedClient\"\n+    />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SelectClientDialog from '@/components/client/SelectClientDialog.vue';\n+import { Client } from '@/types';\n+import { debounce } from '@/util/helpers';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '../../global';\n+\n+let that: any;\n+\n+export default Vue.extend({\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'reservedMember',\n+      'memberClasses',\n+      'selectedMemberName',\n+    ]),\n+\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    selectableMembers(): Client[] {\n+      // Filter out the owner member\n+      const filtered = this.$store.getters.selectableMembers.filter(\n+        (client: Client) => {\n+          if (\n+            client.member_class === this.reservedMember.memberClass &&\n+            client.member_code === this.reservedMember.memberCode\n+          ) {\n+            return false;\n+          }\n+          return true;\n+        },\n+      );\n+      return filtered;\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode) {\n+        return false;\n+      }\n+\n+      // Check that the info doesn't match the reserved member (owner member)\n+      if (", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUyMjc3NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432522775", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T14:27:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0Njk5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NzUyMg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431047522", "bodyText": "Could be refactored like above.", "author": "TJaakkola", "createdAt": "2020-05-27T11:29:47Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/MemberDetailsPage.vue", "diffHunk": "@@ -0,0 +1,280 @@\n+<template>\n+  <div>\n+    <div class=\"info-block\">\n+      <div>\n+        {{$t('wizard.member.info1')}}\n+        <br />\n+        <br />\n+        {{$t('wizard.member.info2')}}\n+      </div>\n+      <div class=\"action-block\">\n+        <large-button\n+          @click=\"showSelectClient = true\"\n+          outlined\n+          data-test=\"select-client-button\"\n+        >{{$t('wizard.member.select')}}</large-button>\n+      </div>\n+    </div>\n+\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+        <div data-test=\"selected-member-name\">{{selectedMemberName}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberClass\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"memberClasses\"\n+            class=\"form-input\"\n+            v-model=\"memberClass\"\n+            data-test=\"member-class-input\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberCode\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-text-field\n+            class=\"form-input\"\n+            type=\"text\"\n+            :error-messages=\"errors\"\n+            v-model=\"memberCode\"\n+            data-test=\"member-code-input\"\n+          ></v-text-field>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+      <div class=\"button-footer\">\n+        <div class=\"button-group\">\n+          <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+        </div>\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"invalid || duplicateClient ||\u00a0checkRunning\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </ValidationObserver>\n+\n+    <SelectClientDialog\n+      :dialog=\"showSelectClient\"\n+      :selectableClients=\"selectableMembers\"\n+      @cancel=\"showSelectClient = false\"\n+      @save=\"saveSelectedClient\"\n+    />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SelectClientDialog from '@/components/client/SelectClientDialog.vue';\n+import { Client } from '@/types';\n+import { debounce } from '@/util/helpers';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '../../global';\n+\n+let that: any;\n+\n+export default Vue.extend({\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'reservedMember',\n+      'memberClasses',\n+      'selectedMemberName',\n+    ]),\n+\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    selectableMembers(): Client[] {\n+      // Filter out the owner member\n+      const filtered = this.$store.getters.selectableMembers.filter(\n+        (client: Client) => {\n+          if (\n+            client.member_class === this.reservedMember.memberClass &&\n+            client.member_code === this.reservedMember.memberCode\n+          ) {\n+            return false;\n+          }\n+          return true;\n+        },\n+      );\n+      return filtered;\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode) {\n+        return false;\n+      }\n+\n+      // Check that the info doesn't match the reserved member (owner member)\n+      if (\n+        this.reservedMember.memberClass.toLowerCase() !==\n+          this.memberClass.toLowerCase() ||\n+        this.reservedMember.memberCode.toLowerCase() !==\n+          this.memberCode.toLowerCase()\n+      ) {\n+        return false;\n+      }\n+\n+      return true;\n+    },\n+  },\n+  data() {\n+    return {\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      checkRunning: false,\n+    };\n+  },\n+  methods: {\n+    cancel(): void {\n+      this.$emit('cancel');\n+    },\n+    done(): void {\n+      this.$emit('done');\n+    },\n+    saveSelectedClient(selectedMember: Client): void {\n+      this.$store.dispatch('setSelectedMember', selectedMember);\n+      this.showSelectClient = false;\n+    },\n+    checkClient(): void {\n+      this.checkRunning = true;\n+\n+      // Find if the selectable clients array has a match\n+      const tempClient = this.selectableMembers.find((client: Client) => {\n+        return (\n+          client.member_code === this.memberCode &&\n+          client.member_class === this.memberClass\n+        );\n+      });\n+\n+      // Fill the name \"field\" if it's available\n+      if (tempClient?.member_name) {\n+        this.$store.commit('setSelectedMemberName', tempClient.member_name);\n+      } else {\n+        // Clear the \"field\" if not\n+        this.$store.commit('setSelectedMemberName', undefined);\n+      }\n+\n+      this.checkClientDebounce();\n+    },\n+    checkClientDebounce: debounce(() => {\n+      // Debounce is used to reduce unnecessary api calls\n+      // Search tokens for suitable CSR:s and certificates\n+      that.$store\n+        .dispatch('searchTokens', {\n+          instanceId: that.reservedMember.instanceId,\n+          memberClass: that.memberClass,\n+          memberCode: that.memberCode,\n+        })\n+        .then(\n+          () => {\n+            that.checkRunning = false;\n+          },\n+          (error: Error) => {\n+            that.$store.dispatch('showError', error);\n+            that.checkRunning = true;\n+          },\n+        );\n+    }, 600),\n+  },\n+  created() {\n+    that = this;\n+    this.$store.commit('setAddMemberWizardMode', AddMemberWizardModes.FULL);\n+    this.$store.dispatch('fetchSelectableMembers');\n+  },\n+\n+  watch: {\n+    memberCode(val) {\n+      // Set first certification service selected as default when the list is updated\n+      this.$store.commit('setAddMemberWizardMode', AddMemberWizardModes.FULL);\n+      if (\n+        !val ||\n+        val.length < 1 ||\n+        !this.memberClass ||\n+        this.memberClass.length < 1\n+      ) {\n+        return;\n+      }\n+      this.checkClient();\n+    },\n+    memberClass(val) {\n+      // Set first certification service selected as default when the list is updated\n+      this.$store.commit('setAddMemberWizardMode', AddMemberWizardModes.FULL);\n+      if (\n+        !val ||\n+        val.length < 1 ||\n+        !this.memberCode ||\n+        this.memberCode.length < 1\n+      ) {\n+        return;\n+      }\n+      this.checkClient();\n+    },\n+\n+    memberClasses(val) {\n+      // Set first member class selected as default when the list is updated\n+      if (val && val.length === 1) {", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUyMzE5OA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432523198", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T14:27:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA0NzUyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE2OTQ4Ng==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431169486", "bodyText": "Typings missing", "author": "TJaakkola", "createdAt": "2020-05-27T14:20:20Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/MemberDetailsPage.vue", "diffHunk": "@@ -0,0 +1,280 @@\n+<template>\n+  <div>\n+    <div class=\"info-block\">\n+      <div>\n+        {{$t('wizard.member.info1')}}\n+        <br />\n+        <br />\n+        {{$t('wizard.member.info2')}}\n+      </div>\n+      <div class=\"action-block\">\n+        <large-button\n+          @click=\"showSelectClient = true\"\n+          outlined\n+          data-test=\"select-client-button\"\n+        >{{$t('wizard.member.select')}}</large-button>\n+      </div>\n+    </div>\n+\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+        <div data-test=\"selected-member-name\">{{selectedMemberName}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberClass\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"memberClasses\"\n+            class=\"form-input\"\n+            v-model=\"memberClass\"\n+            data-test=\"member-class-input\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberCode\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-text-field\n+            class=\"form-input\"\n+            type=\"text\"\n+            :error-messages=\"errors\"\n+            v-model=\"memberCode\"\n+            data-test=\"member-code-input\"\n+          ></v-text-field>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+      <div class=\"button-footer\">\n+        <div class=\"button-group\">\n+          <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+        </div>\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"invalid || duplicateClient ||\u00a0checkRunning\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </ValidationObserver>\n+\n+    <SelectClientDialog\n+      :dialog=\"showSelectClient\"\n+      :selectableClients=\"selectableMembers\"\n+      @cancel=\"showSelectClient = false\"\n+      @save=\"saveSelectedClient\"\n+    />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SelectClientDialog from '@/components/client/SelectClientDialog.vue';\n+import { Client } from '@/types';\n+import { debounce } from '@/util/helpers';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '../../global';\n+\n+let that: any;\n+\n+export default Vue.extend({\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'reservedMember',\n+      'memberClasses',\n+      'selectedMemberName',\n+    ]),\n+\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    selectableMembers(): Client[] {\n+      // Filter out the owner member\n+      const filtered = this.$store.getters.selectableMembers.filter(\n+        (client: Client) => {\n+          if (\n+            client.member_class === this.reservedMember.memberClass &&\n+            client.member_code === this.reservedMember.memberCode\n+          ) {\n+            return false;\n+          }\n+          return true;\n+        },\n+      );\n+      return filtered;\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode) {\n+        return false;\n+      }\n+\n+      // Check that the info doesn't match the reserved member (owner member)\n+      if (\n+        this.reservedMember.memberClass.toLowerCase() !==\n+          this.memberClass.toLowerCase() ||\n+        this.reservedMember.memberCode.toLowerCase() !==\n+          this.memberCode.toLowerCase()\n+      ) {\n+        return false;\n+      }\n+\n+      return true;\n+    },\n+  },\n+  data() {\n+    return {\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      checkRunning: false,", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ4MjUyMg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432482522", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:28:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE2OTQ4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE3MTI2MA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431171260", "bodyText": "Maybe simplify this to:\nthis.$store.commit('setSelectedMemberName', tempClient?.member_name);", "author": "TJaakkola", "createdAt": "2020-05-27T14:22:31Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/MemberDetailsPage.vue", "diffHunk": "@@ -0,0 +1,280 @@\n+<template>\n+  <div>\n+    <div class=\"info-block\">\n+      <div>\n+        {{$t('wizard.member.info1')}}\n+        <br />\n+        <br />\n+        {{$t('wizard.member.info2')}}\n+      </div>\n+      <div class=\"action-block\">\n+        <large-button\n+          @click=\"showSelectClient = true\"\n+          outlined\n+          data-test=\"select-client-button\"\n+        >{{$t('wizard.member.select')}}</large-button>\n+      </div>\n+    </div>\n+\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+        <div data-test=\"selected-member-name\">{{selectedMemberName}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberClass\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"memberClasses\"\n+            class=\"form-input\"\n+            v-model=\"memberClass\"\n+            data-test=\"member-class-input\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberCode\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-text-field\n+            class=\"form-input\"\n+            type=\"text\"\n+            :error-messages=\"errors\"\n+            v-model=\"memberCode\"\n+            data-test=\"member-code-input\"\n+          ></v-text-field>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+      <div class=\"button-footer\">\n+        <div class=\"button-group\">\n+          <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+        </div>\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"invalid || duplicateClient ||\u00a0checkRunning\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </ValidationObserver>\n+\n+    <SelectClientDialog\n+      :dialog=\"showSelectClient\"\n+      :selectableClients=\"selectableMembers\"\n+      @cancel=\"showSelectClient = false\"\n+      @save=\"saveSelectedClient\"\n+    />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SelectClientDialog from '@/components/client/SelectClientDialog.vue';\n+import { Client } from '@/types';\n+import { debounce } from '@/util/helpers';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '../../global';\n+\n+let that: any;\n+\n+export default Vue.extend({\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'reservedMember',\n+      'memberClasses',\n+      'selectedMemberName',\n+    ]),\n+\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    selectableMembers(): Client[] {\n+      // Filter out the owner member\n+      const filtered = this.$store.getters.selectableMembers.filter(\n+        (client: Client) => {\n+          if (\n+            client.member_class === this.reservedMember.memberClass &&\n+            client.member_code === this.reservedMember.memberCode\n+          ) {\n+            return false;\n+          }\n+          return true;\n+        },\n+      );\n+      return filtered;\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode) {\n+        return false;\n+      }\n+\n+      // Check that the info doesn't match the reserved member (owner member)\n+      if (\n+        this.reservedMember.memberClass.toLowerCase() !==\n+          this.memberClass.toLowerCase() ||\n+        this.reservedMember.memberCode.toLowerCase() !==\n+          this.memberCode.toLowerCase()\n+      ) {\n+        return false;\n+      }\n+\n+      return true;\n+    },\n+  },\n+  data() {\n+    return {\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      checkRunning: false,\n+    };\n+  },\n+  methods: {\n+    cancel(): void {\n+      this.$emit('cancel');\n+    },\n+    done(): void {\n+      this.$emit('done');\n+    },\n+    saveSelectedClient(selectedMember: Client): void {\n+      this.$store.dispatch('setSelectedMember', selectedMember);\n+      this.showSelectClient = false;\n+    },\n+    checkClient(): void {\n+      this.checkRunning = true;\n+\n+      // Find if the selectable clients array has a match\n+      const tempClient = this.selectableMembers.find((client: Client) => {\n+        return (\n+          client.member_code === this.memberCode &&\n+          client.member_class === this.memberClass\n+        );\n+      });\n+\n+      // Fill the name \"field\" if it's available\n+      if (tempClient?.member_name) {\n+        this.$store.commit('setSelectedMemberName', tempClient.member_name);\n+      } else {\n+        // Clear the \"field\" if not\n+        this.$store.commit('setSelectedMemberName', undefined);\n+      }", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ4MjE0OA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432482148", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:28:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE3MTI2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE4NTYyMw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431185623", "bodyText": "I think these are empty string checks. We could write a utility function isEmpty and use that -> removed duplication here and below & easier to read code as the utility method name would describe what it does.", "author": "TJaakkola", "createdAt": "2020-05-27T14:35:41Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/MemberDetailsPage.vue", "diffHunk": "@@ -0,0 +1,280 @@\n+<template>\n+  <div>\n+    <div class=\"info-block\">\n+      <div>\n+        {{$t('wizard.member.info1')}}\n+        <br />\n+        <br />\n+        {{$t('wizard.member.info2')}}\n+      </div>\n+      <div class=\"action-block\">\n+        <large-button\n+          @click=\"showSelectClient = true\"\n+          outlined\n+          data-test=\"select-client-button\"\n+        >{{$t('wizard.member.select')}}</large-button>\n+      </div>\n+    </div>\n+\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+        <div data-test=\"selected-member-name\">{{selectedMemberName}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberClass\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"memberClasses\"\n+            class=\"form-input\"\n+            v-model=\"memberClass\"\n+            data-test=\"member-class-input\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberCode\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-text-field\n+            class=\"form-input\"\n+            type=\"text\"\n+            :error-messages=\"errors\"\n+            v-model=\"memberCode\"\n+            data-test=\"member-code-input\"\n+          ></v-text-field>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+      <div class=\"button-footer\">\n+        <div class=\"button-group\">\n+          <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+        </div>\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"invalid || duplicateClient ||\u00a0checkRunning\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </ValidationObserver>\n+\n+    <SelectClientDialog\n+      :dialog=\"showSelectClient\"\n+      :selectableClients=\"selectableMembers\"\n+      @cancel=\"showSelectClient = false\"\n+      @save=\"saveSelectedClient\"\n+    />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SelectClientDialog from '@/components/client/SelectClientDialog.vue';\n+import { Client } from '@/types';\n+import { debounce } from '@/util/helpers';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '../../global';\n+\n+let that: any;\n+\n+export default Vue.extend({\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'reservedMember',\n+      'memberClasses',\n+      'selectedMemberName',\n+    ]),\n+\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    selectableMembers(): Client[] {\n+      // Filter out the owner member\n+      const filtered = this.$store.getters.selectableMembers.filter(\n+        (client: Client) => {\n+          if (\n+            client.member_class === this.reservedMember.memberClass &&\n+            client.member_code === this.reservedMember.memberCode\n+          ) {\n+            return false;\n+          }\n+          return true;\n+        },\n+      );\n+      return filtered;\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode) {\n+        return false;\n+      }\n+\n+      // Check that the info doesn't match the reserved member (owner member)\n+      if (\n+        this.reservedMember.memberClass.toLowerCase() !==\n+          this.memberClass.toLowerCase() ||\n+        this.reservedMember.memberCode.toLowerCase() !==\n+          this.memberCode.toLowerCase()\n+      ) {\n+        return false;\n+      }\n+\n+      return true;\n+    },\n+  },\n+  data() {\n+    return {\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      checkRunning: false,\n+    };\n+  },\n+  methods: {\n+    cancel(): void {\n+      this.$emit('cancel');\n+    },\n+    done(): void {\n+      this.$emit('done');\n+    },\n+    saveSelectedClient(selectedMember: Client): void {\n+      this.$store.dispatch('setSelectedMember', selectedMember);\n+      this.showSelectClient = false;\n+    },\n+    checkClient(): void {\n+      this.checkRunning = true;\n+\n+      // Find if the selectable clients array has a match\n+      const tempClient = this.selectableMembers.find((client: Client) => {\n+        return (\n+          client.member_code === this.memberCode &&\n+          client.member_class === this.memberClass\n+        );\n+      });\n+\n+      // Fill the name \"field\" if it's available\n+      if (tempClient?.member_name) {\n+        this.$store.commit('setSelectedMemberName', tempClient.member_name);\n+      } else {\n+        // Clear the \"field\" if not\n+        this.$store.commit('setSelectedMemberName', undefined);\n+      }\n+\n+      this.checkClientDebounce();\n+    },\n+    checkClientDebounce: debounce(() => {\n+      // Debounce is used to reduce unnecessary api calls\n+      // Search tokens for suitable CSR:s and certificates\n+      that.$store\n+        .dispatch('searchTokens', {\n+          instanceId: that.reservedMember.instanceId,\n+          memberClass: that.memberClass,\n+          memberCode: that.memberCode,\n+        })\n+        .then(\n+          () => {\n+            that.checkRunning = false;\n+          },\n+          (error: Error) => {\n+            that.$store.dispatch('showError', error);\n+            that.checkRunning = true;\n+          },\n+        );\n+    }, 600),\n+  },\n+  created() {\n+    that = this;\n+    this.$store.commit('setAddMemberWizardMode', AddMemberWizardModes.FULL);\n+    this.$store.dispatch('fetchSelectableMembers');\n+  },\n+\n+  watch: {\n+    memberCode(val) {\n+      // Set first certification service selected as default when the list is updated\n+      this.$store.commit('setAddMemberWizardMode', AddMemberWizardModes.FULL);\n+      if (\n+        !val ||\n+        val.length < 1 ||\n+        !this.memberClass ||\n+        this.memberClass.length < 1\n+      ) {\n+        return;\n+      }\n+      this.checkClient();\n+    },\n+    memberClass(val) {\n+      // Set first certification service selected as default when the list is updated\n+      this.$store.commit('setAddMemberWizardMode', AddMemberWizardModes.FULL);\n+      if (\n+        !val ||\n+        val.length < 1 ||", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ3NzgwNQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432477805", "bodyText": "Added isEmpty function", "author": "Riippi", "createdAt": "2020-05-29T13:21:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE4NTYyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE4NjA5NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431186095", "bodyText": "parameter type missing here and other watch-block methods", "author": "TJaakkola", "createdAt": "2020-05-27T14:36:09Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/MemberDetailsPage.vue", "diffHunk": "@@ -0,0 +1,280 @@\n+<template>\n+  <div>\n+    <div class=\"info-block\">\n+      <div>\n+        {{$t('wizard.member.info1')}}\n+        <br />\n+        <br />\n+        {{$t('wizard.member.info2')}}\n+      </div>\n+      <div class=\"action-block\">\n+        <large-button\n+          @click=\"showSelectClient = true\"\n+          outlined\n+          data-test=\"select-client-button\"\n+        >{{$t('wizard.member.select')}}</large-button>\n+      </div>\n+    </div>\n+\n+    <ValidationObserver ref=\"form2\" v-slot=\"{ validate, invalid }\">\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberName\" helpText=\"wizard.client.memberNameTooltip\" />\n+        <div data-test=\"selected-member-name\">{{selectedMemberName}}</div>\n+      </div>\n+\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberClass\" helpText=\"wizard.client.memberClassTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberClass\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-select\n+            :items=\"memberClasses\"\n+            class=\"form-input\"\n+            v-model=\"memberClass\"\n+            data-test=\"member-class-input\"\n+          ></v-select>\n+        </ValidationProvider>\n+      </div>\n+      <div class=\"row-wrap\">\n+        <FormLabel labelText=\"wizard.memberCode\" helpText=\"wizard.client.memberCodeTooltip\" />\n+\n+        <ValidationProvider name=\"addClient.memberCode\" rules=\"required\" v-slot=\"{ errors }\">\n+          <v-text-field\n+            class=\"form-input\"\n+            type=\"text\"\n+            :error-messages=\"errors\"\n+            v-model=\"memberCode\"\n+            data-test=\"member-code-input\"\n+          ></v-text-field>\n+        </ValidationProvider>\n+      </div>\n+\n+      <div v-if=\"duplicateClient\" class=\"duplicate-warning\">{{$t('wizard.client.memberExists')}}</div>\n+      <div class=\"button-footer\">\n+        <div class=\"button-group\">\n+          <large-button outlined @click=\"cancel\" data-test=\"cancel-button\">{{$t('action.cancel')}}</large-button>\n+        </div>\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"invalid || duplicateClient ||\u00a0checkRunning\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </ValidationObserver>\n+\n+    <SelectClientDialog\n+      :dialog=\"showSelectClient\"\n+      :selectableClients=\"selectableMembers\"\n+      @cancel=\"showSelectClient = false\"\n+      @save=\"saveSelectedClient\"\n+    />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import SelectClientDialog from '@/components/client/SelectClientDialog.vue';\n+import { Client } from '@/types';\n+import { debounce } from '@/util/helpers';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { AddMemberWizardModes } from '../../global';\n+\n+let that: any;\n+\n+export default Vue.extend({\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    SelectClientDialog,\n+  },\n+  computed: {\n+    ...mapGetters([\n+      'reservedMember',\n+      'memberClasses',\n+      'selectedMemberName',\n+    ]),\n+\n+    memberClass: {\n+      get(): string {\n+        return this.$store.getters.memberClass;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberClass', value);\n+      },\n+    },\n+\n+    memberCode: {\n+      get(): string {\n+        return this.$store.getters.memberCode;\n+      },\n+      set(value: string) {\n+        this.$store.commit('setMemberCode', value);\n+      },\n+    },\n+\n+    selectableMembers(): Client[] {\n+      // Filter out the owner member\n+      const filtered = this.$store.getters.selectableMembers.filter(\n+        (client: Client) => {\n+          if (\n+            client.member_class === this.reservedMember.memberClass &&\n+            client.member_code === this.reservedMember.memberCode\n+          ) {\n+            return false;\n+          }\n+          return true;\n+        },\n+      );\n+      return filtered;\n+    },\n+\n+    duplicateClient(): boolean {\n+      if (!this.memberClass || !this.memberCode) {\n+        return false;\n+      }\n+\n+      // Check that the info doesn't match the reserved member (owner member)\n+      if (\n+        this.reservedMember.memberClass.toLowerCase() !==\n+          this.memberClass.toLowerCase() ||\n+        this.reservedMember.memberCode.toLowerCase() !==\n+          this.memberCode.toLowerCase()\n+      ) {\n+        return false;\n+      }\n+\n+      return true;\n+    },\n+  },\n+  data() {\n+    return {\n+      disableDone: false,\n+      certificationService: undefined,\n+      filteredServiceList: [],\n+      showSelectClient: false as boolean,\n+      checkRunning: false,\n+    };\n+  },\n+  methods: {\n+    cancel(): void {\n+      this.$emit('cancel');\n+    },\n+    done(): void {\n+      this.$emit('done');\n+    },\n+    saveSelectedClient(selectedMember: Client): void {\n+      this.$store.dispatch('setSelectedMember', selectedMember);\n+      this.showSelectClient = false;\n+    },\n+    checkClient(): void {\n+      this.checkRunning = true;\n+\n+      // Find if the selectable clients array has a match\n+      const tempClient = this.selectableMembers.find((client: Client) => {\n+        return (\n+          client.member_code === this.memberCode &&\n+          client.member_class === this.memberClass\n+        );\n+      });\n+\n+      // Fill the name \"field\" if it's available\n+      if (tempClient?.member_name) {\n+        this.$store.commit('setSelectedMemberName', tempClient.member_name);\n+      } else {\n+        // Clear the \"field\" if not\n+        this.$store.commit('setSelectedMemberName', undefined);\n+      }\n+\n+      this.checkClientDebounce();\n+    },\n+    checkClientDebounce: debounce(() => {\n+      // Debounce is used to reduce unnecessary api calls\n+      // Search tokens for suitable CSR:s and certificates\n+      that.$store\n+        .dispatch('searchTokens', {\n+          instanceId: that.reservedMember.instanceId,\n+          memberClass: that.memberClass,\n+          memberCode: that.memberCode,\n+        })\n+        .then(\n+          () => {\n+            that.checkRunning = false;\n+          },\n+          (error: Error) => {\n+            that.$store.dispatch('showError', error);\n+            that.checkRunning = true;\n+          },\n+        );\n+    }, 600),\n+  },\n+  created() {\n+    that = this;\n+    this.$store.commit('setAddMemberWizardMode', AddMemberWizardModes.FULL);\n+    this.$store.dispatch('fetchSelectableMembers');\n+  },\n+\n+  watch: {\n+    memberCode(val) {", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ3MjIwNg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432472206", "bodyText": "fixed", "author": "Riippi", "createdAt": "2020-05-29T13:11:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE4NjA5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE4Nzg4Nw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431187887", "bodyText": "type missing", "author": "TJaakkola", "createdAt": "2020-05-27T14:37:54Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/SignKeyPage.vue", "diffHunk": "@@ -0,0 +1,86 @@\n+<template>\n+  <div>\n+    {{$t('wizard.signKey.info')}}\n+    <div class=\"row-wrap\">\n+      <FormLabel labelText=\"wizard.signKey.keyLabel\" />\n+      <v-text-field class=\"form-input\" type=\"text\" v-model=\"keyLabel\" data-test=\"key-label-input\"></v-text-field>\n+    </div>\n+    <div class=\"button-footer\">\n+      <div class=\"button-group\">\n+        <large-button\n+          outlined\n+          @click=\"cancel\"\n+          :disabled=\"!disableDone\"\n+          data-test=\"cancel-button\"\n+        >{{$t('action.cancel')}}</large-button>\n+      </div>\n+      <div>\n+        <large-button\n+          @click=\"previous\"\n+          outlined\n+          class=\"previous-button\"\n+          data-test=\"previous-button\"\n+        >{{$t('action.previous')}}</large-button>\n+        <large-button @click=\"done\" data-test=\"next-button\">{{$t('action.next')}}</large-button>\n+      </div>\n+    </div>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import FormLabel from '@/components/ui/FormLabel.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+\n+export default Vue.extend({\n+  components: {\n+    FormLabel,\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+  },\n+  computed: {\n+    keyLabel: {\n+      get(): string {\n+        return this.$store.getters.keyLabel;\n+      },\n+      set(value: string) {\n+        this.$store.commit('storeKeyLabel', value);\n+      },\n+    },\n+  },\n+  data() {\n+    return {\n+      disableDone: true,", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ3MTYzNw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432471637", "bodyText": "fixed", "author": "Riippi", "createdAt": "2020-05-29T13:10:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE4Nzg4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5MDUyMw==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431190523", "bodyText": "data-test missing", "author": "TJaakkola", "createdAt": "2020-05-27T14:41:23Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/TokenPage.vue", "diffHunk": "@@ -0,0 +1,176 @@\n+<template>\n+  <div>\n+    {{$t('wizard.token.info')}}\n+    <v-text-field\n+      v-model=\"search\"\n+      :label=\"$t('wizard.token.tokenName')\"\n+      single-line\n+      hide-details\n+      class=\"search-input\"\n+      data-test=\"token-search-input\"\n+    >\n+      <v-icon slot=\"append\">mdi-magnify</v-icon>\n+    </v-text-field>\n+\n+    <v-radio-group v-model=\"tokenGroup\">\n+      <div class=\"radio-row\" v-for=\"token in filteredTokens\" :key=\"token.id\">\n+        <v-radio :label=\"`Token ${token.name}`\" :value=\"token\" :disabled=\"!token.logged_in\"></v-radio>", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2NzUyMA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432467520", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:03:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5MDUyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5MTg5NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431191895", "bodyText": "return this.tokens.length === 1;", "author": "TJaakkola", "createdAt": "2020-05-27T14:43:12Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/TokenPage.vue", "diffHunk": "@@ -0,0 +1,176 @@\n+<template>\n+  <div>\n+    {{$t('wizard.token.info')}}\n+    <v-text-field\n+      v-model=\"search\"\n+      :label=\"$t('wizard.token.tokenName')\"\n+      single-line\n+      hide-details\n+      class=\"search-input\"\n+      data-test=\"token-search-input\"\n+    >\n+      <v-icon slot=\"append\">mdi-magnify</v-icon>\n+    </v-text-field>\n+\n+    <v-radio-group v-model=\"tokenGroup\">\n+      <div class=\"radio-row\" v-for=\"token in filteredTokens\" :key=\"token.id\">\n+        <v-radio :label=\"`Token ${token.name}`\" :value=\"token\" :disabled=\"!token.logged_in\"></v-radio>\n+        <div>\n+          <large-button\n+            @click=\"confirmLogin(token)\"\n+            v-if=\"!token.logged_in\"\n+            :disabled=\"!token.available\"\n+            data-test=\"token-login-button\"\n+          >{{$t('keys.logIn')}}</large-button>\n+          <large-button\n+            v-if=\"token.logged_in\"\n+            outlined\n+            disabled\n+            data-test=\"token-logout-button\"\n+          >{{$t('wizard.token.loggedIn')}}</large-button>\n+        </div>\n+      </div>\n+    </v-radio-group>\n+\n+    <div class=\"button-footer\">\n+      <div class=\"button-group\">\n+        <large-button\n+          outlined\n+          @click=\"cancel\"\n+          :disabled=\"!disableDone\"\n+          data-test=\"cancel-button\"\n+        >{{$t('action.cancel')}}</large-button>\n+      </div>\n+\n+      <div>\n+        <large-button\n+          @click=\"previous\"\n+          outlined\n+          class=\"previous-button\"\n+          data-test=\"previous-button\"\n+        >{{$t('action.previous')}}</large-button>\n+\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"disableNext\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </div>\n+    <TokenLoginDialog :dialog=\"loginDialog\" @cancel=\"loginDialog = false\" @save=\"tokenLogin\" />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import TokenLoginDialog from '@/components/token/TokenLoginDialog.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { Token } from '@/types';\n+\n+export default Vue.extend({\n+  components: {\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    TokenLoginDialog,\n+  },\n+  computed: {\n+    ...mapGetters(['tokens']),\n+\n+    filteredTokens: {\n+      get(): Token[] {\n+        return this.$store.getters.tokensFilteredByName(this.search);\n+      },\n+    },\n+\n+    disableSelection() {\n+      if (this.tokens.length === 1) {\n+        return true;\n+      }\n+      return false;", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg0MDkzMg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431840932", "bodyText": "This is again the \"computed property issue\" where the linter doesn't allow using a oneliner like that.", "author": "Riippi", "createdAt": "2020-05-28T13:38:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5MTg5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5MzM5Mg==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431193392", "bodyText": "return !this.tokenGroup;", "author": "TJaakkola", "createdAt": "2020-05-27T14:45:13Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/TokenPage.vue", "diffHunk": "@@ -0,0 +1,176 @@\n+<template>\n+  <div>\n+    {{$t('wizard.token.info')}}\n+    <v-text-field\n+      v-model=\"search\"\n+      :label=\"$t('wizard.token.tokenName')\"\n+      single-line\n+      hide-details\n+      class=\"search-input\"\n+      data-test=\"token-search-input\"\n+    >\n+      <v-icon slot=\"append\">mdi-magnify</v-icon>\n+    </v-text-field>\n+\n+    <v-radio-group v-model=\"tokenGroup\">\n+      <div class=\"radio-row\" v-for=\"token in filteredTokens\" :key=\"token.id\">\n+        <v-radio :label=\"`Token ${token.name}`\" :value=\"token\" :disabled=\"!token.logged_in\"></v-radio>\n+        <div>\n+          <large-button\n+            @click=\"confirmLogin(token)\"\n+            v-if=\"!token.logged_in\"\n+            :disabled=\"!token.available\"\n+            data-test=\"token-login-button\"\n+          >{{$t('keys.logIn')}}</large-button>\n+          <large-button\n+            v-if=\"token.logged_in\"\n+            outlined\n+            disabled\n+            data-test=\"token-logout-button\"\n+          >{{$t('wizard.token.loggedIn')}}</large-button>\n+        </div>\n+      </div>\n+    </v-radio-group>\n+\n+    <div class=\"button-footer\">\n+      <div class=\"button-group\">\n+        <large-button\n+          outlined\n+          @click=\"cancel\"\n+          :disabled=\"!disableDone\"\n+          data-test=\"cancel-button\"\n+        >{{$t('action.cancel')}}</large-button>\n+      </div>\n+\n+      <div>\n+        <large-button\n+          @click=\"previous\"\n+          outlined\n+          class=\"previous-button\"\n+          data-test=\"previous-button\"\n+        >{{$t('action.previous')}}</large-button>\n+\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"disableNext\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </div>\n+    <TokenLoginDialog :dialog=\"loginDialog\" @cancel=\"loginDialog = false\" @save=\"tokenLogin\" />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import TokenLoginDialog from '@/components/token/TokenLoginDialog.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { Token } from '@/types';\n+\n+export default Vue.extend({\n+  components: {\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    TokenLoginDialog,\n+  },\n+  computed: {\n+    ...mapGetters(['tokens']),\n+\n+    filteredTokens: {\n+      get(): Token[] {\n+        return this.$store.getters.tokensFilteredByName(this.search);\n+      },\n+    },\n+\n+    disableSelection() {\n+      if (this.tokens.length === 1) {\n+        return true;\n+      }\n+      return false;\n+    },\n+\n+    disableNext() {\n+      if (this.tokenGroup) {\n+        return false;\n+      }\n+      return true;", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg0MjI0NA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431842244", "bodyText": "Same computed property issue.", "author": "Riippi", "createdAt": "2020-05-28T13:40:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5MzM5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5NDYzMQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431194631", "bodyText": "Missing typings", "author": "TJaakkola", "createdAt": "2020-05-27T14:46:52Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/TokenPage.vue", "diffHunk": "@@ -0,0 +1,176 @@\n+<template>\n+  <div>\n+    {{$t('wizard.token.info')}}\n+    <v-text-field\n+      v-model=\"search\"\n+      :label=\"$t('wizard.token.tokenName')\"\n+      single-line\n+      hide-details\n+      class=\"search-input\"\n+      data-test=\"token-search-input\"\n+    >\n+      <v-icon slot=\"append\">mdi-magnify</v-icon>\n+    </v-text-field>\n+\n+    <v-radio-group v-model=\"tokenGroup\">\n+      <div class=\"radio-row\" v-for=\"token in filteredTokens\" :key=\"token.id\">\n+        <v-radio :label=\"`Token ${token.name}`\" :value=\"token\" :disabled=\"!token.logged_in\"></v-radio>\n+        <div>\n+          <large-button\n+            @click=\"confirmLogin(token)\"\n+            v-if=\"!token.logged_in\"\n+            :disabled=\"!token.available\"\n+            data-test=\"token-login-button\"\n+          >{{$t('keys.logIn')}}</large-button>\n+          <large-button\n+            v-if=\"token.logged_in\"\n+            outlined\n+            disabled\n+            data-test=\"token-logout-button\"\n+          >{{$t('wizard.token.loggedIn')}}</large-button>\n+        </div>\n+      </div>\n+    </v-radio-group>\n+\n+    <div class=\"button-footer\">\n+      <div class=\"button-group\">\n+        <large-button\n+          outlined\n+          @click=\"cancel\"\n+          :disabled=\"!disableDone\"\n+          data-test=\"cancel-button\"\n+        >{{$t('action.cancel')}}</large-button>\n+      </div>\n+\n+      <div>\n+        <large-button\n+          @click=\"previous\"\n+          outlined\n+          class=\"previous-button\"\n+          data-test=\"previous-button\"\n+        >{{$t('action.previous')}}</large-button>\n+\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"disableNext\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </div>\n+    <TokenLoginDialog :dialog=\"loginDialog\" @cancel=\"loginDialog = false\" @save=\"tokenLogin\" />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import TokenLoginDialog from '@/components/token/TokenLoginDialog.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { Token } from '@/types';\n+\n+export default Vue.extend({\n+  components: {\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    TokenLoginDialog,\n+  },\n+  computed: {\n+    ...mapGetters(['tokens']),\n+\n+    filteredTokens: {\n+      get(): Token[] {\n+        return this.$store.getters.tokensFilteredByName(this.search);\n+      },\n+    },\n+\n+    disableSelection() {\n+      if (this.tokens.length === 1) {\n+        return true;\n+      }\n+      return false;\n+    },\n+\n+    disableNext() {\n+      if (this.tokenGroup) {\n+        return false;\n+      }\n+      return true;\n+    },\n+  },\n+  data() {\n+    return {\n+      search: undefined,\n+      disableDone: true,\n+      tokenGroup: undefined as Token | undefined,\n+      loginDialog: false,", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2NzYwMA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432467600", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:03:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5NDYzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5NjI2OA==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r431196268", "bodyText": "I think this could be simplified to:\n!this?.tokenGroup.id", "author": "TJaakkola", "createdAt": "2020-05-27T14:48:59Z", "path": "src/proxy-ui-api/frontend/src/views/AddMember/TokenPage.vue", "diffHunk": "@@ -0,0 +1,176 @@\n+<template>\n+  <div>\n+    {{$t('wizard.token.info')}}\n+    <v-text-field\n+      v-model=\"search\"\n+      :label=\"$t('wizard.token.tokenName')\"\n+      single-line\n+      hide-details\n+      class=\"search-input\"\n+      data-test=\"token-search-input\"\n+    >\n+      <v-icon slot=\"append\">mdi-magnify</v-icon>\n+    </v-text-field>\n+\n+    <v-radio-group v-model=\"tokenGroup\">\n+      <div class=\"radio-row\" v-for=\"token in filteredTokens\" :key=\"token.id\">\n+        <v-radio :label=\"`Token ${token.name}`\" :value=\"token\" :disabled=\"!token.logged_in\"></v-radio>\n+        <div>\n+          <large-button\n+            @click=\"confirmLogin(token)\"\n+            v-if=\"!token.logged_in\"\n+            :disabled=\"!token.available\"\n+            data-test=\"token-login-button\"\n+          >{{$t('keys.logIn')}}</large-button>\n+          <large-button\n+            v-if=\"token.logged_in\"\n+            outlined\n+            disabled\n+            data-test=\"token-logout-button\"\n+          >{{$t('wizard.token.loggedIn')}}</large-button>\n+        </div>\n+      </div>\n+    </v-radio-group>\n+\n+    <div class=\"button-footer\">\n+      <div class=\"button-group\">\n+        <large-button\n+          outlined\n+          @click=\"cancel\"\n+          :disabled=\"!disableDone\"\n+          data-test=\"cancel-button\"\n+        >{{$t('action.cancel')}}</large-button>\n+      </div>\n+\n+      <div>\n+        <large-button\n+          @click=\"previous\"\n+          outlined\n+          class=\"previous-button\"\n+          data-test=\"previous-button\"\n+        >{{$t('action.previous')}}</large-button>\n+\n+        <large-button\n+          @click=\"done\"\n+          :disabled=\"disableNext\"\n+          data-test=\"next-button\"\n+        >{{$t('action.next')}}</large-button>\n+      </div>\n+    </div>\n+    <TokenLoginDialog :dialog=\"loginDialog\" @cancel=\"loginDialog = false\" @save=\"tokenLogin\" />\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import Vue from 'vue';\n+import { mapGetters } from 'vuex';\n+import LargeButton from '@/components/ui/LargeButton.vue';\n+import TokenLoginDialog from '@/components/token/TokenLoginDialog.vue';\n+import { ValidationProvider, ValidationObserver } from 'vee-validate';\n+import { Token } from '@/types';\n+\n+export default Vue.extend({\n+  components: {\n+    LargeButton,\n+    ValidationObserver,\n+    ValidationProvider,\n+    TokenLoginDialog,\n+  },\n+  computed: {\n+    ...mapGetters(['tokens']),\n+\n+    filteredTokens: {\n+      get(): Token[] {\n+        return this.$store.getters.tokensFilteredByName(this.search);\n+      },\n+    },\n+\n+    disableSelection() {\n+      if (this.tokens.length === 1) {\n+        return true;\n+      }\n+      return false;\n+    },\n+\n+    disableNext() {\n+      if (this.tokenGroup) {\n+        return false;\n+      }\n+      return true;\n+    },\n+  },\n+  data() {\n+    return {\n+      search: undefined,\n+      disableDone: true,\n+      tokenGroup: undefined as Token | undefined,\n+      loginDialog: false,\n+    };\n+  },\n+  methods: {\n+    cancel(): void {\n+      this.$emit('cancel');\n+    },\n+    previous(): void {\n+      this.$emit('previous');\n+    },\n+    done(): void {\n+      if (!this.tokenGroup || !this.tokenGroup.id) {", "originalCommit": "37090653d465500817204c66a484399164f5f4be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ2NzgxMQ==", "url": "https://github.com/nordic-institute/X-Road/pull/510#discussion_r432467811", "bodyText": "Fixed", "author": "Riippi", "createdAt": "2020-05-29T13:03:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5NjI2OA=="}], "type": "inlineReview"}, {"oid": "bec2c865138661bd847887046ab4cc7fae9ea90f", "url": "https://github.com/nordic-institute/X-Road/commit/bec2c865138661bd847887046ab4cc7fae9ea90f", "message": "Merge commit 'aa8a47b0f880bda26a02896b3b27511d95350857' into XRDDEV-862-add-member\n\n# Conflicts:\n#\tsrc/proxy-ui-api/frontend/src/store/modules/addClient.ts\n#\tsrc/proxy-ui-api/frontend/src/types.ts\n#\tsrc/proxy-ui-api/frontend/src/util/helpers.ts\n#\tsrc/proxy-ui-api/frontend/src/views/AddClient/AddClient.vue\n#\tsrc/proxy-ui-api/frontend/src/views/AddClient/ClientDetailsPage.vue\n#\tsrc/proxy-ui-api/frontend/src/views/AddSubsystem/AddSubsystem.vue\n#\tsrc/proxy-ui-api/frontend/src/views/Clients/ClientsDataTable.vue", "committedDate": "2020-05-28T12:44:02Z", "type": "commit"}, {"oid": "34c523e1e4cd282182d318b8817492352f3de364", "url": "https://github.com/nordic-institute/X-Road/commit/34c523e1e4cd282182d318b8817492352f3de364", "message": "XRDDEV-862 Fix PR issue", "committedDate": "2020-05-28T12:45:30Z", "type": "commit"}, {"oid": "eba670bf5cdc1c6026d7421e180445c436e4e060", "url": "https://github.com/nordic-institute/X-Road/commit/eba670bf5cdc1c6026d7421e180445c436e4e060", "message": "XRDDEV-862 Fix merge issues", "committedDate": "2020-05-28T12:53:47Z", "type": "commit"}, {"oid": "c4e790169ae2afa77da8b86679b52b92e5c12563", "url": "https://github.com/nordic-institute/X-Road/commit/c4e790169ae2afa77da8b86679b52b92e5c12563", "message": "XRDDEV-862 Fix PR issues", "committedDate": "2020-05-28T14:57:07Z", "type": "commit"}, {"oid": "2a977341a1f9907ae7dc52f4d6cd6ad99a91f191", "url": "https://github.com/nordic-institute/X-Road/commit/2a977341a1f9907ae7dc52f4d6cd6ad99a91f191", "message": "XRDDEV-862 Refactor matching certificate function", "committedDate": "2020-05-28T18:50:52Z", "type": "commit"}, {"oid": "a938f388c3cedd2ae07c42f73703ccbb7fc07847", "url": "https://github.com/nordic-institute/X-Road/commit/a938f388c3cedd2ae07c42f73703ccbb7fc07847", "message": "XRDDEV-862 Fix minor bugs", "committedDate": "2020-05-29T08:01:42Z", "type": "commit"}, {"oid": "78fe5021ceb1dae28eeb4fd60512fc60a746c9fb", "url": "https://github.com/nordic-institute/X-Road/commit/78fe5021ceb1dae28eeb4fd60512fc60a746c9fb", "message": "XRDDEV-862 PR fixes", "committedDate": "2020-05-29T15:25:37Z", "type": "commit"}]}