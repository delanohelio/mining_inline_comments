{"pr_number": 365, "pr_title": "XRDDEV-913", "pr_createdAt": "2020-02-12T17:15:54Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/365", "timeline": [{"oid": "5452872ace24f59aeea7272daeb50738d476b439", "url": "https://github.com/nordic-institute/X-Road/commit/5452872ace24f59aeea7272daeb50738d476b439", "message": "XRDDEV-913 add debug logging", "committedDate": "2020-02-11T17:02:43Z", "type": "commit"}, {"oid": "b65acb6c83f280bb50d1729de551800f2052d851", "url": "https://github.com/nordic-institute/X-Road/commit/b65acb6c83f280bb50d1729de551800f2052d851", "message": "XRDDEV-913 fix op-monitor standalone installation on Ubuntu", "committedDate": "2020-02-12T12:23:26Z", "type": "commit"}, {"oid": "c2c245a932fbe534e5b35db0fa66ee350f1bc93c", "url": "https://github.com/nordic-institute/X-Road/commit/c2c245a932fbe534e5b35db0fa66ee350f1bc93c", "message": "Revert \"XRDDEV-913 add debug logging\"\n\nThis reverts commit 5452872ace24f59aeea7272daeb50738d476b439.", "committedDate": "2020-02-12T15:51:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEwNzk0Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/365#discussion_r380107943", "bodyText": "I suppose that this can still fail if opmonitor is standalone and using remote DB? This could be fixed by reverting the changes, and making the db_get not to fail (makes it also possible to use a pre-initialized remote db). Something like:\nRET=\ndb_get xroad-common/database-host || true\ndb_host=\"${RET:-127.0.0.1:5432}\"\ndb_stop", "author": "jhyoty", "createdAt": "2020-02-17T10:44:03Z", "path": "src/packages/src/xroad/ubuntu/generic/xroad-opmonitor.postinst", "diffHunk": "@@ -33,24 +33,25 @@ configure() {\n \n   db_properties=/etc/xroad/db.properties\n   root_properties=/etc/xroad.properties\n-\n-  RET=\n-  db_get xroad-common/database-host\n-  db_host=\"$RET\"\n-  db_url=jdbc:postgresql://${db_host}/${db_name}\n-  db_addr=${db_host%%:*}\n-  db_port=${db_host##*:}\n-  db_initialized=false\n+  db_host=127.0.0.1:5432\n \n   if  [[ -f ${root_properties} && $(get_prop ${root_properties} postgres.connection.password) != \"\" ]]\n   then\n     master_passwd=$(crudini --get ${root_properties} '' postgres.connection.password)\n     export PGPASSWORD=${master_passwd}\n     psql_cmd=remote_psql\n+    RET=\n+    db_get xroad-common/database-host", "originalCommit": "c2c245a932fbe534e5b35db0fa66ee350f1bc93c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "48d8f07128151cb2ab5713a5379f7dd1a27fe418", "url": "https://github.com/nordic-institute/X-Road/commit/48d8f07128151cb2ab5713a5379f7dd1a27fe418", "message": "Revert \"XRDDEV-913 fix op-monitor standalone installation on Ubuntu\"\n\nThis reverts commit b65acb6c83f280bb50d1729de551800f2052d851.", "committedDate": "2020-02-19T07:27:23Z", "type": "commit"}, {"oid": "b946da4ce1f45689333fa55acfe7ccbdadfbfba1", "url": "https://github.com/nordic-institute/X-Road/commit/b946da4ce1f45689333fa55acfe7ccbdadfbfba1", "message": "XRDDEV-913 reading db host does not fail", "committedDate": "2020-02-19T07:30:48Z", "type": "commit"}]}