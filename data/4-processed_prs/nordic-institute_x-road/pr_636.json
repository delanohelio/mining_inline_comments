{"pr_number": 636, "pr_title": "XRDDEV-559 remove old ui", "pr_createdAt": "2020-08-07T10:16:43Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/636", "timeline": [{"oid": "00497ca973eb0e21a159bb330b9b86203292c965", "url": "https://github.com/nordic-institute/X-Road/commit/00497ca973eb0e21a159bb330b9b86203292c965", "message": "XRDDEV-559 remove proxy-ui sources and update packaging accordingly", "committedDate": "2020-07-24T13:43:54Z", "type": "commit"}, {"oid": "0b2f3368a18d6277bd295dd5540ff45ebe84d6ce", "url": "https://github.com/nordic-institute/X-Road/commit/0b2f3368a18d6277bd295dd5540ff45ebe84d6ce", "message": "XRDDEV-559 remove xroad-jetty9 and xroad-nginx when xroad-proxy installs", "committedDate": "2020-07-28T11:58:27Z", "type": "commit"}, {"oid": "17909f84e08d496f1ac219a1a26004cdbfb9b3dd", "url": "https://github.com/nordic-institute/X-Road/commit/17909f84e08d496f1ac219a1a26004cdbfb9b3dd", "message": "XRDDEV-559 update dependencies", "committedDate": "2020-07-29T08:53:03Z", "type": "commit"}, {"oid": "b459196bf81f956c1fd8c4fb3244c7e040b79ebe", "url": "https://github.com/nordic-institute/X-Road/commit/b459196bf81f956c1fd8c4fb3244c7e040b79ebe", "message": "XRDDEV-559 update ubuntu conflicts", "committedDate": "2020-07-29T12:35:01Z", "type": "commit"}, {"oid": "6a056389acf4b160387675e0d9daf3f78b18bb28", "url": "https://github.com/nordic-institute/X-Road/commit/6a056389acf4b160387675e0d9daf3f78b18bb28", "message": "XRDDEV-559 fix rhel problems, including nginx still reserving 4000 after upgrade", "committedDate": "2020-07-30T13:18:45Z", "type": "commit"}, {"oid": "17e365e1115594ff4587818d2cf694d399d96bb6", "url": "https://github.com/nordic-institute/X-Road/commit/17e365e1115594ff4587818d2cf694d399d96bb6", "message": "XRDDEV-559 move proxy-ui system properties under proxy-ui-api, and migrate on RHEL upgrade", "committedDate": "2020-07-30T15:22:56Z", "type": "commit"}, {"oid": "d3503f0d612dc86b792a68cfce1098b22f52f0ea", "url": "https://github.com/nordic-institute/X-Road/commit/d3503f0d612dc86b792a68cfce1098b22f52f0ea", "message": "XRDDEV-559 migrate system parameters on ubuntu", "committedDate": "2020-07-30T16:33:53Z", "type": "commit"}, {"oid": "95f45ccbfdee461b1f7a108eecf8b5620c312e8f", "url": "https://github.com/nordic-institute/X-Road/commit/95f45ccbfdee461b1f7a108eecf8b5620c312e8f", "message": "Merge branch 'develop' into XRDDEV-559-remove-old-ui", "committedDate": "2020-07-31T06:03:12Z", "type": "commit"}, {"oid": "5b8481e452f8a0c5307947ea7b236b3ede38ce95", "url": "https://github.com/nordic-institute/X-Road/commit/5b8481e452f8a0c5307947ea7b236b3ede38ce95", "message": "XRDDEV-559 remove unnecessary SELinux configuration, migrate nginx.crt -> proxy-ui-api.crt (key,p12), remove empty local.ini proxy-ui section, obsolete xroad-jetty+xroad-nginx by proxy-ui-api instead of proxy-ui", "committedDate": "2020-08-04T14:30:34Z", "type": "commit"}, {"oid": "b25ebf38945276de53e58bba6d8751792f82da41", "url": "https://github.com/nordic-institute/X-Road/commit/b25ebf38945276de53e58bba6d8751792f82da41", "message": "XRDDEV-559 fix problems with local.ini wsdl-validator-command handling", "committedDate": "2020-08-06T11:26:32Z", "type": "commit"}, {"oid": "836ee26dbd7b256233df3bca3ce97b59c2e7feed", "url": "https://github.com/nordic-institute/X-Road/commit/836ee26dbd7b256233df3bca3ce97b59c2e7feed", "message": "XRDDEV-559 fix wsdlvalidator removal now restarts xroad-proxy-ui-api", "committedDate": "2020-08-06T12:16:24Z", "type": "commit"}, {"oid": "496fe0edafa30c8d17da96158bd7e2e51a4bb960", "url": "https://github.com/nordic-institute/X-Road/commit/496fe0edafa30c8d17da96158bd7e2e51a4bb960", "message": "XRDDEV-559 only remove local.ini wsdl-validator-command with actual remove", "committedDate": "2020-08-06T12:46:49Z", "type": "commit"}, {"oid": "53d75e803c16a8a1575a969122f8b34334acc83f", "url": "https://github.com/nordic-institute/X-Road/commit/53d75e803c16a8a1575a969122f8b34334acc83f", "message": "XRDDEV-559 fix missing requires from RHEL xroad-proxy", "committedDate": "2020-08-06T15:11:16Z", "type": "commit"}, {"oid": "aa26be5e8c12cfff8bbcf3830c14b7c46dff6513", "url": "https://github.com/nordic-institute/X-Road/commit/aa26be5e8c12cfff8bbcf3830c14b7c46dff6513", "message": "Merge branch 'develop' into XRDDEV-559-remove-old-ui\n\nFix Conflicts:\n\tdoc/Manuals/ug-syspar_x-road_v6_system_parameters.md\n\tsrc/packages/src/xroad/redhat/SPECS/xroad-base.spec\n\tsrc/packages/src/xroad/ubuntu/generic/xroad-base.install", "committedDate": "2020-08-07T06:30:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njk3Mjk1Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/636#discussion_r466972953", "bodyText": "suggestion (a bit simpler and also avoids copying unnecessary libs):\ntask copyDeps(type: Copy) {\n    into \"$buildDir/unpacked-libs\"\n    from configurations.compileClasspath.find {it.name.startsWith(\"postgresql\") }\n}\n\nbuild.dependsOn copyDeps", "author": "jhyoty", "createdAt": "2020-08-07T11:05:41Z", "path": "src/proxy-ui-api/build.gradle", "diffHunk": "@@ -187,6 +187,20 @@ jar {\n     classifier = 'plainDependency'\n }\n \n+// extract dependency jars from spring boot jar, to be able to package postgresql.jar\n+task unpackLibsFromBootJar(type: Copy) {\n+    from(zipTree(\"${buildDir}/libs/proxy-ui-api-1.0.jar\")) {\n+        include \"BOOT-INF/lib/*\"\n+        eachFile { fcd ->\n+            fcd.relativePath = new RelativePath(true, fcd.relativePath.segments.drop(2))\n+        }\n+        includeEmptyDirs = false\n+    }\n+    into \"$buildDir/unpacked-libs\"\n+}\n+\n+jar.finalizedBy(unpackLibsFromBootJar)\n+", "originalCommit": "aa26be5e8c12cfff8bbcf3830c14b7c46dff6513", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyMjE4OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/636#discussion_r468022189", "bodyText": "Good suggestion, fixed, much simplified.\nGradle was a bit picky about the place where copyDeps should be put. That might explain why I ended up with the original clumsy implementation. copyDeps needed to be after dependencyManagement, it seems.", "author": "jansu76", "createdAt": "2020-08-10T16:16:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njk3Mjk1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njk3MzE4Nw==", "url": "https://github.com/nordic-institute/X-Road/pull/636#discussion_r466973187", "bodyText": "should be unnecessary (already a transitive dependency)", "author": "jhyoty", "createdAt": "2020-08-07T11:06:21Z", "path": "src/proxy-ui-api/build.gradle", "diffHunk": "@@ -208,6 +222,7 @@ dependencies {\n     implementation('wsdl4j:wsdl4j:1.6.3')\n     implementation('com.github.vladimir-bukhtoyarov:bucket4j-core:4.10.0')\n     implementation(\"io.swagger.parser.v3:swagger-parser:${swaggerParserVersion}\")\n+    implementation(\"org.postgresql:postgresql:42.2.14\")", "originalCommit": "aa26be5e8c12cfff8bbcf3830c14b7c46dff6513", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyMDU4Ng==", "url": "https://github.com/nordic-institute/X-Road/pull/636#discussion_r468020586", "bodyText": "Fixed", "author": "jansu76", "createdAt": "2020-08-10T16:13:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njk3MzE4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njk3NjczNA==", "url": "https://github.com/nordic-institute/X-Road/pull/636#discussion_r466976734", "bodyText": "Maybe it would be safer to keep the numbering (just leave an empty 3.3 section \"proxy-ui removed in version 6.24\" or something) in case there are some external links to the parameter sections.", "author": "jhyoty", "createdAt": "2020-08-07T11:15:15Z", "path": "doc/Manuals/ug-syspar_x-road_v6_system_parameters.md", "diffHunk": "@@ -276,14 +276,7 @@ limits the configuration parameters usage:\n This in practice limits configurability to different kinds of PostgreSQL database configurations, and it is not possible\n to use for example MySQL as a data store for REST API module.\n \n-### 3.3 Proxy User Interface parameters: `[proxy-ui]`\n-\n-| **Parameter**                                    | **Vanilla value**                          | **Description** |\n-|--------------------------------------------------|--------------------------------------------|-----------------|\n-| wsdl-validator-command                           |                                            | The command to validate the given X-Road service WSDL. The command script must:<br/>a) read the WSDL from the URI given as an argument,<br/>b) return exit code 0 on success,<br/>c) return exit code 0 and write warnings to the standard error (*stderr*), if warnings occurs,<br/>d) return exit code other then 0 and write error messages to the standard error (*stderr*), if errors occurs.<br/>Defaults to no operation. |\n-| auth-cert-reg-signature-digest-algorithm-id      | SHA-512                                    | Signature digest algorithm used for generating authentication certificate registration request.<br/>Possible values are<br/>-   SHA-256,<br/>-   SHA-384,<br/>-   SHA-512. |\n-\n-### 3.4 Signer parameters: `[signer]`\n+### 3.3 Signer parameters: `[signer]`", "originalCommit": "aa26be5e8c12cfff8bbcf3830c14b7c46dff6513", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyMDUyNQ==", "url": "https://github.com/nordic-institute/X-Road/pull/636#discussion_r468020525", "bodyText": "Fixed", "author": "jansu76", "createdAt": "2020-08-10T16:13:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njk3NjczNA=="}], "type": "inlineReview"}, {"oid": "048157231919a705c2e201f141f0f394948535d3", "url": "https://github.com/nordic-institute/X-Road/commit/048157231919a705c2e201f141f0f394948535d3", "message": "XRDDEV-559 improve proxy-ui-api build based on PR comments", "committedDate": "2020-08-10T15:59:24Z", "type": "commit"}, {"oid": "9f643f06e1822def341cca0478753d51ce0359bc", "url": "https://github.com/nordic-institute/X-Road/commit/9f643f06e1822def341cca0478753d51ce0359bc", "message": "XRDDEV-559 keep deprecated 3.3 proxy-ui chapter as suggested in PR comments", "committedDate": "2020-08-10T16:09:07Z", "type": "commit"}, {"oid": "3068141a75b2bed593d96bd65a70e5ebf8cd2561", "url": "https://github.com/nordic-institute/X-Road/commit/3068141a75b2bed593d96bd65a70e5ebf8cd2561", "message": "XRDDEV-559 fix typo", "committedDate": "2020-08-10T16:10:55Z", "type": "commit"}]}