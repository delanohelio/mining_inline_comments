{"pr_number": 523, "pr_title": "XRDDEV-1001 Validation error structure", "pr_createdAt": "2020-05-28T13:16:11Z", "pr_url": "https://github.com/nordic-institute/X-Road/pull/523", "timeline": [{"oid": "93c41e06e9ec8d9daab6fd6bfbbcf4427b83970a", "url": "https://github.com/nordic-institute/X-Road/commit/93c41e06e9ec8d9daab6fd6bfbbcf4427b83970a", "message": "XRDDEV-1101 Initial validation error structure\n\n* updated API definition", "committedDate": "2020-05-28T11:21:22Z", "type": "commit"}, {"oid": "5774b4dfca6d12b5d63e8e7062a1e883b73ed028", "url": "https://github.com/nordic-institute/X-Road/commit/5774b4dfca6d12b5d63e8e7062a1e883b73ed028", "message": "XRDDEV-1101 Field validation error tests", "committedDate": "2020-05-28T13:02:57Z", "type": "commit"}, {"oid": "bbae24dea7925207ddeee7ddf40b64a8931720f4", "url": "https://github.com/nordic-institute/X-Road/commit/bbae24dea7925207ddeee7ddf40b64a8931720f4", "message": "XRDDEV-1101 Simplify test", "committedDate": "2020-05-29T06:30:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTgzNzYxMA==", "url": "https://github.com/nordic-institute/X-Road/pull/523#discussion_r435837610", "bodyText": "maybe add mention about validation errors here, now it mentions only code and metadata?", "author": "jansu76", "createdAt": "2020-06-05T10:37:25Z", "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -4875,7 +4875,7 @@ components:\n         - ERROR_CODE_MISSING_PRIVATE_PARAMS # The downloaded global configuration did not contain private parameters\n         - ERROR_CODE_UNINITIALIZED # The configuration client is initializing.\n         - UNKNOWN\n-    CodeWithMetadata:\n+    CodeWithDetails:\n       type: object\n       description: object that contains a code identifier and possibly collection of", "originalCommit": "bbae24dea7925207ddeee7ddf40b64a8931720f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg2Nzc5NQ==", "url": "https://github.com/nordic-institute/X-Road/pull/523#discussion_r435867795", "bodyText": "Added a mention of validation errors", "author": "carohauta", "createdAt": "2020-06-05T11:47:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTgzNzYxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTgzODI4Mw==", "url": "https://github.com/nordic-institute/X-Road/pull/523#discussion_r435838283", "bodyText": "would mentioning \"dictionary\" help to make this structure more clear? I was a bit befuddled at first, not understanding how this results in Map<String, List<String>> validationErrors (granted, due to my lack of knowledge in openapi)", "author": "jansu76", "createdAt": "2020-06-05T10:38:54Z", "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -4895,6 +4895,19 @@ components:\n           items:\n             type: string\n             format: text\n+        validation_errors:\n+          description: object that contains validation errors bound to their respected fields - the object's key", "originalCommit": "bbae24dea7925207ddeee7ddf40b64a8931720f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg2ODI5Mg==", "url": "https://github.com/nordic-institute/X-Road/pull/523#discussion_r435868292", "bodyText": "Tried to be more verbose about this. Also added a link to OAS3 Dictionary docs right after the additionalProperties keyword", "author": "carohauta", "createdAt": "2020-06-05T11:48:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTgzODI4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0MzIzNg==", "url": "https://github.com/nordic-institute/X-Road/pull/523#discussion_r435843236", "bodyText": "I think that we should document the different validation error codes for the end users. Both our own custom errors (NoPercent, NoBackslashes, etc) and standard bean validation errors (NotNull, Size, etc - this should probably be just a link to documentation elsewhere, possible some section of Bean Validation API specification?).\nNot sure what is a good way to do this, in openapi specification, or maybe somewhere in https://github.com/nordic-institute/X-Road/blob/develop/doc/Manuals/ug-ss_x-road_6_security_server_user_guide.md#19-management-rest-apis ?\nSimilar documentation is missing for error codes and metadata, but we already have a ticket about that https://jira.niis.org/browse/XRDDEV-665", "author": "jansu76", "createdAt": "2020-06-05T10:50:21Z", "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -4895,6 +4895,19 @@ components:\n           items:\n             type: string\n             format: text\n+        validation_errors:\n+          description: object that contains validation errors bound to their respected fields - the object's key\n+            represents the field where the validation error has happened and the key's value is the validation error\n+          type: object\n+          additionalProperties:\n+            type: array\n+            description: array containing the validation errors of a field\n+            items:\n+              type: string\n+              format: text\n+          example:\n+            clientAdd.client.memberCode: [\"NoPercent\"]", "originalCommit": "bbae24dea7925207ddeee7ddf40b64a8931720f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg2NTcyNA==", "url": "https://github.com/nordic-institute/X-Road/pull/523#discussion_r435865724", "bodyText": "I think it could be a good idea to add them into the official documents (e.g. the one you linked or https://github.com/nordic-institute/X-Road/blob/develop/doc/Manuals/ug-ss_x-road_6_security_server_user_guide.md#192-executing-rest-calls). Then we can just add a link to the document in the validation_errors description field.", "author": "carohauta", "createdAt": "2020-06-05T11:42:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0MzIzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTkwMzE4OQ==", "url": "https://github.com/nordic-institute/X-Road/pull/523#discussion_r435903189", "bodyText": "Added a chapter to the X-Road User Guide and a mention about it into the API definition.", "author": "carohauta", "createdAt": "2020-06-05T12:57:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTg0MzIzNg=="}], "type": "inlineReview"}, {"oid": "8c5285cffddc85aacd4da1e8622c2c444bb8ff64", "url": "https://github.com/nordic-institute/X-Road/commit/8c5285cffddc85aacd4da1e8622c2c444bb8ff64", "message": "XRDDEV-1001 Improved API docs // PR comment fix 1", "committedDate": "2020-06-05T11:44:08Z", "type": "commit"}, {"oid": "77ef1cbfde53e27bcb6c3f6ec8a41a5a72a33c8c", "url": "https://github.com/nordic-institute/X-Road/commit/77ef1cbfde53e27bcb6c3f6ec8a41a5a72a33c8c", "message": "XRDDEV-1001 Validation errors docs // PR comment fix 2", "committedDate": "2020-06-05T12:47:33Z", "type": "commit"}, {"oid": "2582b04aea30af219c9cdfb3028b45a967fc24c7", "url": "https://github.com/nordic-institute/X-Road/commit/2582b04aea30af219c9cdfb3028b45a967fc24c7", "message": "Merge branch 'develop' into XRDDEV-1001-validation-error-structure\n\n# Conflicts:\n#\tdoc/Manuals/ug-ss_x-road_6_security_server_user_guide.md", "committedDate": "2020-06-05T12:49:53Z", "type": "commit"}, {"oid": "e4ac0b261dee82eca5f19496e42e7dc3e73a2c71", "url": "https://github.com/nordic-institute/X-Road/commit/e4ac0b261dee82eca5f19496e42e7dc3e73a2c71", "message": "XRDDEV-1001 API definition docs update // PR comment fix 3", "committedDate": "2020-06-05T12:54:55Z", "type": "commit"}]}