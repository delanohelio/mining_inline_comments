{"pr_number": 802, "pr_title": "PLANNER-2021 Don't use JUnit 4's Assert class anymore", "pr_createdAt": "2020-06-16T18:13:41Z", "pr_url": "https://github.com/kiegroup/optaplanner/pull/802", "timeline": [{"oid": "cb5c05d24add032ef10d5e7f35a9eecf32ab44ad", "url": "https://github.com/kiegroup/optaplanner/commit/cb5c05d24add032ef10d5e7f35a9eecf32ab44ad", "message": "Replace JUnit 4 assertions by AssertJ in optaplanner-benchmark", "committedDate": "2020-06-16T10:17:35Z", "type": "commit"}, {"oid": "8a94093f881e81261162cf4e0605cbf69eaefa16", "url": "https://github.com/kiegroup/optaplanner/commit/8a94093f881e81261162cf4e0605cbf69eaefa16", "message": "Replace JUnit 4 assertions by AssertJ in springboot", "committedDate": "2020-06-16T10:25:00Z", "type": "commit"}, {"oid": "39cd41cf3b371c2c5a301a01bdeadf3d19617057", "url": "https://github.com/kiegroup/optaplanner/commit/39cd41cf3b371c2c5a301a01bdeadf3d19617057", "message": "Replace JUnit 4 assertions by AssertJ in persistence", "committedDate": "2020-06-16T10:41:26Z", "type": "commit"}, {"oid": "27de29e9986e7e827c2b7741a8c5739942b786b6", "url": "https://github.com/kiegroup/optaplanner/commit/27de29e9986e7e827c2b7741a8c5739942b786b6", "message": "Replace JUnit 4 assertions by AssertJ in examples", "committedDate": "2020-06-16T11:12:00Z", "type": "commit"}, {"oid": "9f34215ea4410a4da533768ad7f29a0461687403", "url": "https://github.com/kiegroup/optaplanner/commit/9f34215ea4410a4da533768ad7f29a0461687403", "message": "WIP", "committedDate": "2020-06-16T13:37:12Z", "type": "commit"}, {"oid": "88d6a688e9c6f9711ede0db39b41532156561909", "url": "https://github.com/kiegroup/optaplanner/commit/88d6a688e9c6f9711ede0db39b41532156561909", "message": "Conversion done", "committedDate": "2020-06-16T17:54:16Z", "type": "commit"}, {"oid": "e00298d27c62ddac85b4d008a1265f8773e98cf4", "url": "https://github.com/kiegroup/optaplanner/commit/e00298d27c62ddac85b4d008a1265f8773e98cf4", "message": "Inline", "committedDate": "2020-06-16T18:14:53Z", "type": "commit"}, {"oid": "e00298d27c62ddac85b4d008a1265f8773e98cf4", "url": "https://github.com/kiegroup/optaplanner/commit/e00298d27c62ddac85b4d008a1265f8773e98cf4", "message": "Inline", "committedDate": "2020-06-16T18:14:53Z", "type": "forcePushed"}, {"oid": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "url": "https://github.com/kiegroup/optaplanner/commit/99241f9259f345a0ccadd4275275237dc2a4e0d5", "message": "Fix leftovers", "committedDate": "2020-06-17T07:09:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0MTI2Nw==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441341267", "bodyText": "Add static import for offset(). Improves readability. It's the same approach as with Joiners.*.", "author": "yurloc", "createdAt": "2020-06-17T07:34:57Z", "path": "optaplanner-benchmark/src/test/java/org/optaplanner/benchmark/impl/measurement/ScoreDifferencePercentageTest.java", "diffHunk": "@@ -41,60 +42,60 @@ public void calculateScoreDifferencePercentage() {\n         SimpleScore score2 = SimpleScore.of(-100);\n         ScoreDifferencePercentage scoreDifferencePercentage = ScoreDifferencePercentage\n                 .calculateScoreDifferencePercentage(score1, score2);\n-        assertEquals(0.0, scoreDifferencePercentage.getPercentageLevels()[0], tolerance);\n+        assertThat(scoreDifferencePercentage.getPercentageLevels()[0]).isEqualTo(0.0, Offset.offset(tolerance));", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0MjcyMQ==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441342721", "bodyText": "Maybe even?\nprivate static final Offset tolerance = ...;", "author": "yurloc", "createdAt": "2020-06-17T07:37:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM0MTI2Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM1Nzc2NQ==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441357765", "bodyText": "Redundant cast.", "author": "yurloc", "createdAt": "2020-06-17T08:03:20Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/impl/domain/solution/AbstractSolutionTest.java", "diffHunk": "@@ -61,7 +61,7 @@ public void getProblemFacts() {\n         solution.setSingleEntity(singleEntity);\n         SimpleScore score = SimpleScore.of(-10);\n         solution.setScore(score);\n-        assertCollectionContainsExactly(solution.getProblemFactList(), singleValue, v1, v2, v3);\n+        assertThat((Collection<Object>) solution.getProblemFactList()).containsExactly(singleValue, v1, v2, v3);", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM1Nzg1MA==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441357850", "bodyText": "Redundant cast.", "author": "yurloc", "createdAt": "2020-06-17T08:03:29Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/impl/domain/solution/AbstractSolutionTest.java", "diffHunk": "@@ -76,7 +76,7 @@ public void getProblemFactsWithNullField() {\n         solution.setEntityList(null);\n         solution.setSingleEntity(null);\n         solution.setScore(null);\n-        assertCollectionContainsExactly(solution.getProblemFactList(), v1, v2, v3);\n+        assertThat((Collection<Object>) solution.getProblemFactList()).containsExactly(v1, v2, v3);", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQyOTc1Nw==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441429757", "bodyText": "This cast doesn't make sense. Casting the \"actual\" argument to SimpleScore would make sense.", "author": "yurloc", "createdAt": "2020-06-17T09:59:17Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/api/score/constraint/ConstraintMatchTotalTest.java", "diffHunk": "@@ -32,22 +32,22 @@ public void getScoreTotal() {\n         TestdataEntity e2 = new TestdataEntity(\"e2\");\n         TestdataEntity e3 = new TestdataEntity(\"e3\");\n         ConstraintMatchTotal constraintMatchTotal = new ConstraintMatchTotal(\"package1\", \"constraint1\", SimpleScore.ZERO);\n-        assertEquals(SimpleScore.ZERO, constraintMatchTotal.getScore());\n+        assertThat(constraintMatchTotal.getScore()).isEqualTo((org.optaplanner.core.api.score.Score) SimpleScore.ZERO);", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzMDI0MQ==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441430241", "bodyText": "Wrong cast again. See also children of AbstractConstraintStreamTest.", "author": "yurloc", "createdAt": "2020-06-17T10:00:08Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/api/score/constraint/IndictmentTest.java", "diffHunk": "@@ -32,28 +32,28 @@ public void getScoreTotal() {\n         TestdataEntity e2 = new TestdataEntity(\"e2\");\n         TestdataEntity e3 = new TestdataEntity(\"e3\");\n         Indictment indictment = new Indictment(e1, SimpleScore.ZERO);\n-        assertEquals(SimpleScore.ZERO, indictment.getScore());\n+        assertThat(indictment.getScore()).isEqualTo((org.optaplanner.core.api.score.Score) SimpleScore.ZERO);", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzMjMwOA==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441432308", "bodyText": "Redundant cast. It seems this is done automatically by your IDE. Please check if you can avoid that.", "author": "yurloc", "createdAt": "2020-06-17T10:03:40Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/config/heuristic/selector/entity/EntitySelectorConfigTest.java", "diffHunk": "@@ -39,9 +37,11 @@ public void phaseOriginal() {\n         EntitySelector entitySelector = entitySelectorConfig.buildEntitySelector(\n                 buildHeuristicConfigPolicy(),\n                 SelectionCacheType.JUST_IN_TIME, SelectionOrder.RANDOM);\n-        assertInstanceOf(FromSolutionEntitySelector.class, entitySelector);\n-        assertNotInstanceOf(ShufflingEntitySelector.class, entitySelector);\n-        assertEquals(SelectionCacheType.PHASE, entitySelector.getCacheType());\n+        assertThat((Object) entitySelector)", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzMzMyMQ==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441433321", "bodyText": "Why this if?", "author": "yurloc", "createdAt": "2020-06-17T10:05:25Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/config/heuristic/selector/move/MoveSelectorConfigTest.java", "diffHunk": "@@ -53,8 +50,12 @@ public AssertingMoveSelectorConfig(MoveSelector baseMoveSelector,\n         protected MoveSelector buildBaseMoveSelector(\n                 HeuristicConfigPolicy configPolicy,\n                 SelectionCacheType minimumCacheType, boolean randomSelection) {\n-            assertEquals(expectedMinimumCacheType, minimumCacheType);\n-            assertEquals(expectedRandomSelection, randomSelection);\n+            assertThat(minimumCacheType).isEqualTo(expectedMinimumCacheType);\n+            if (expectedRandomSelection) {\n+                assertThat(randomSelection).isTrue();\n+            } else {\n+                assertThat(randomSelection).isFalse();\n+            }", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzNjI0Nw==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441436247", "bodyText": "Redundant cast.", "author": "yurloc", "createdAt": "2020-06-17T10:10:35Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/impl/domain/constraintweight/descriptor/ConstraintWeightDescriptorTest.java", "diffHunk": "@@ -55,10 +53,12 @@ public void extractionFunction() {\n         constraintConfiguration.setSecondWeight(SimpleScore.of(7));\n         solution.setConstraintConfiguration(constraintConfiguration);\n \n-        assertSame(constraintConfiguration,\n-                solutionDescriptor.getConstraintConfigurationMemberAccessor().executeGetter(solution));\n-        assertEquals(SimpleScore.ZERO, firstWeightDescriptor.createExtractor().apply(solution));\n-        assertEquals(SimpleScore.of(7), secondWeightDescriptor.createExtractor().apply(solution));\n+        assertThat(solutionDescriptor.getConstraintConfigurationMemberAccessor().executeGetter(solution))\n+                .isSameAs(constraintConfiguration);\n+        assertThat(firstWeightDescriptor.createExtractor().apply(solution)).isEqualTo(\n+                (org.optaplanner.core.api.score.Score<? extends org.optaplanner.core.api.score.Score>) SimpleScore.ZERO);", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzNzM2NA==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441437364", "bodyText": "Redundant cast.", "author": "yurloc", "createdAt": "2020-06-17T10:12:26Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/config/score/director/ScoreDirectorFactoryConfigTest.java", "diffHunk": "@@ -184,13 +181,13 @@ public SimpleScore calculateScore() {\n     @Test\n     public void testGenerateDroolsTestOption() {\n         ScoreDirectorFactoryConfig config = new ScoreDirectorFactoryConfig();\n-        assertNull(config.isGenerateDroolsTestOnError());\n+        assertThat(config.isGenerateDroolsTestOnError()).isNull();\n         config.setGenerateDroolsTestOnError(true);\n-        assertTrue(config.isGenerateDroolsTestOnError());\n+        assertThat((boolean) config.isGenerateDroolsTestOnError()).isTrue();", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0Nzk5NA==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441447994", "bodyText": "Is this if intentional?", "author": "yurloc", "createdAt": "2020-06-17T10:32:28Z", "path": "optaplanner-core/src/test/java/org/optaplanner/core/impl/solver/thread/OrderByMoveIndexBlockingQueueTest.java", "diffHunk": "@@ -170,19 +169,24 @@ public void addExceptionIsNotEatenIfNextStepStartsBeforeTaken() throws Interrupt\n             queue.startNextStep(1);\n             fail(\"There was no RuntimeException thrown.\");\n         } catch (RuntimeException e) {\n-            assertSame(exception, e.getCause());\n+            assertThat(e.getCause()).isSameAs((Throwable) exception);\n         }\n     }\n \n     private void assertResult(String moveCode, int score, OrderByMoveIndexBlockingQueue.MoveResult<TestdataSolution> result) {\n         assertCode(moveCode, result.getMove());\n-        assertEquals(SimpleScore.of(score), result.getScore());\n+        assertThat(result.getScore()).isEqualTo((org.optaplanner.core.api.score.Score) SimpleScore.of(score));\n     }\n \n     private void assertResult(String moveCode, boolean doable,\n             OrderByMoveIndexBlockingQueue.MoveResult<TestdataSolution> result) {\n         assertCode(moveCode, result.getMove());\n-        assertEquals(doable, result.isMoveDoable());\n+        boolean y = result.isMoveDoable();\n+        if (doable) {\n+            assertThat(y).isTrue();\n+        } else {\n+            assertThat(y).isFalse();\n+        }", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "636003f6c3f8671fd890e949a8cda48a5bc4cc7c", "url": "https://github.com/kiegroup/optaplanner/commit/636003f6c3f8671fd890e949a8cda48a5bc4cc7c", "message": "Remove some unnecessary casts", "committedDate": "2020-06-17T10:33:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0OTE0OA==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441449148", "bodyText": "as() needs to go before assertions, otherwise it's unreachable.", "author": "yurloc", "createdAt": "2020-06-17T10:34:45Z", "path": "optaplanner-examples/src/test/java/org/optaplanner/examples/common/app/SolverPerformanceTest.java", "diffHunk": "@@ -121,27 +119,28 @@ private void runSpeedTest(\n \n     private void assertScoreAndConstraintMatches(SolverFactory<Solution_> solverFactory,\n             Solution_ bestSolution, String bestScoreLimitString) {\n-        assertNotNull(bestSolution);\n+        assertThat(bestSolution).isNotNull();\n         InnerScoreDirectorFactory<Solution_> scoreDirectorFactory = (InnerScoreDirectorFactory<Solution_>) solverFactory\n                 .getScoreDirectorFactory();\n         Score bestScore = scoreDirectorFactory.getSolutionDescriptor().getScore(bestSolution);\n         ScoreDefinition scoreDefinition = scoreDirectorFactory.getScoreDefinition();\n         Score bestScoreLimit = scoreDefinition.parseScore(bestScoreLimitString);\n-        assertTrue(\"The bestScore (\" + bestScore + \") must be at least the bestScoreLimit (\" + bestScoreLimit + \").\",\n-                bestScore.compareTo(bestScoreLimit) >= 0);\n+        assertThat(bestScore)\n+                .isGreaterThanOrEqualTo(bestScoreLimit)\n+                .as(\"The bestScore (\" + bestScore + \") must be at least the bestScoreLimit (\" + bestScoreLimit + \").\");", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0OTk2NQ==", "url": "https://github.com/kiegroup/optaplanner/pull/802#discussion_r441449965", "bodyText": "Committed by mistake?", "author": "yurloc", "createdAt": "2020-06-17T10:36:10Z", "path": "optaplanner-integration/optaplanner-spring-boot-autoconfigure/src/test/java/org/optaplanner/spring/boot/autoconfigure/OptaPlannerAutoConfigurationTest.java", "diffHunk": "@@ -131,46 +130,49 @@ public void solverProperties() {\n                 .run(context -> {\n                     SolverConfig solverConfig = context.getBean(SolverConfig.class);\n                     assertEquals(EnvironmentMode.FULL_ASSERT, solverConfig.getEnvironmentMode());\n-                    assertNotNull(context.getBean(SolverFactory.class));\n+                    assertThat(context.getBean(SolverFactory.class)).isNotNull();\n                 });\n         contextRunner\n                 .withPropertyValues(\"optaplanner.solver.daemon=true\")\n                 .run(context -> {\n                     SolverConfig solverConfig = context.getBean(SolverConfig.class);\n-                    assertTrue(solverConfig.getDaemon());\n-                    assertNotNull(context.getBean(SolverFactory.class));\n+                    assertThat(solverConfig.getDaemon()).isTrue();\n+                    assertThat(context.getBean(SolverFactory.class)).isNotNull();\n                 });\n         contextRunner\n                 .withPropertyValues(\"optaplanner.solver.move-thread-count=2\")\n                 .run(context -> {\n                     SolverConfig solverConfig = context.getBean(SolverConfig.class);\n-                    assertEquals(\"2\", solverConfig.getMoveThreadCount());\n-                    assertNotNull(context.getBean(SolverFactory.class));\n+                    assertThat(solverConfig.getMoveThreadCount()).isEqualTo(\"2\");\n+                    assertThat(context.getBean(SolverFactory.class)).isNotNull();\n                 });\n     }\n \n+    private void assertEquals(EnvironmentMode fullAssert, EnvironmentMode environmentMode) {\n+    }", "originalCommit": "99241f9259f345a0ccadd4275275237dc2a4e0d5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0127a92d1fead3c333086b1bac2ceb70c6d82de6", "url": "https://github.com/kiegroup/optaplanner/commit/0127a92d1fead3c333086b1bac2ceb70c6d82de6", "message": "More static imports", "committedDate": "2020-06-17T10:36:10Z", "type": "commit"}, {"oid": "f3b8d7832de167dc7ac6674e199fac288ba1fb9a", "url": "https://github.com/kiegroup/optaplanner/commit/f3b8d7832de167dc7ac6674e199fac288ba1fb9a", "message": "Remove some more unnecessary code", "committedDate": "2020-06-17T10:50:59Z", "type": "commit"}, {"oid": "6732447d654fba0fae053d64760fb7638d7c39d0", "url": "https://github.com/kiegroup/optaplanner/commit/6732447d654fba0fae053d64760fb7638d7c39d0", "message": "Remove even more unnecessary code", "committedDate": "2020-06-17T10:59:32Z", "type": "commit"}, {"oid": "8980a9d63097cc567997a38b052c2feb2b761e88", "url": "https://github.com/kiegroup/optaplanner/commit/8980a9d63097cc567997a38b052c2feb2b761e88", "message": "Remove JUnit 4 assumptions", "committedDate": "2020-06-17T14:51:47Z", "type": "commit"}]}