{"pr_number": 824, "pr_title": "PLANNER-1996: Enable dependency check", "pr_createdAt": "2020-07-02T22:10:11Z", "pr_url": "https://github.com/kiegroup/optaplanner/pull/824", "timeline": [{"oid": "f22efa72fe11f82da4758855de03c0fc68a6169d", "url": "https://github.com/kiegroup/optaplanner/commit/f22efa72fe11f82da4758855de03c0fc68a6169d", "message": "Part 2", "committedDate": "2020-07-03T08:19:41Z", "type": "forcePushed"}, {"oid": "7396889eaa7ff919cc50a778f44633a79c60e817", "url": "https://github.com/kiegroup/optaplanner/commit/7396889eaa7ff919cc50a778f44633a79c60e817", "message": "PLANNER-1996: Enable dependency check\n\nUse maven-dependency-plugins to fail the build if any used undeclared\nor unused declared dependencies are found.\n\nThe plugin is configured to ignore non-compile dependencies. This avoids\nhaving to ignore runtime and test-runtime dependencies individually.\n\nExplanation:\n- The plugin cannot detect if a declared runtime dependency is unused.\n- The plugin cannot detect if an undeclared runtime dependency is used\n  transitively. It is contributor's responsibility to declare runtime\n  dependencies even though they are provided transitively.\n- Missing runtime dependencies should be detected by tests. It's\n  contributor's responsibility to write tests using runtime dependencies\n  or to document why a runtine dependency is declared in case it\n  cannot be covered by tests.\n- The plugin will detect unused declared compile-scope dependencies.\n- The plugin will detect used undeclared (transitive) compile-scope\n  dependencies.\n\nException: Spring Boot Starters are designed to provided transitive\ndependencies. So the OptaPlanner Spring Boot Starter is allowed to have\nunused declared dependencies and projects depending on Starters are not\nchecked at all. The same applies for Quarkus integration modules.", "committedDate": "2020-07-03T10:33:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA1MDY4Nw==", "url": "https://github.com/kiegroup/optaplanner/pull/824#discussion_r455050687", "bodyText": "There's a skip option:\nhttps://maven.apache.org/plugins/maven-dependency-plugin/analyze-only-mojo.html#skip\nCan we add a property\n<properties>\n<mdep.analyze.skip>true</>\n</>\n\nfor all these kind of cases? It's less lines of code :)", "author": "ge0ffrey", "createdAt": "2020-07-15T13:28:03Z", "path": "optaplanner-quarkus-integration/optaplanner-quarkus/runtime/pom.xml", "diffHunk": "@@ -110,6 +110,17 @@\n           </annotationProcessorPaths>\n         </configuration>\n       </plugin>\n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-dependency-plugin</artifactId>\n+        <executions>\n+          <execution>\n+            <!-- TODO enable dependency check later. -->\n+            <id>analyze-only</id>\n+            <phase>none</phase>\n+          </execution>\n+        </executions>\n+      </plugin>", "originalCommit": "7396889eaa7ff919cc50a778f44633a79c60e817", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTgwMTYzNg==", "url": "https://github.com/kiegroup/optaplanner/pull/824#discussion_r455801636", "bodyText": "No. Using the property has a different effect. It disables the plugin execution for the analyze goal completely. With that, you couldn't run analysis from the command line.", "author": "yurloc", "createdAt": "2020-07-16T13:51:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA1MDY4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTYxMjg2OA==", "url": "https://github.com/kiegroup/optaplanner/pull/824#discussion_r455612868", "bodyText": "I am afraid more conflicts are coming:\n#836\nIf I had known what was coming in this PR, I would have waited with the #836", "author": "rsynek", "createdAt": "2020-07-16T08:25:14Z", "path": "optaplanner-quarkus-integration/optaplanner-quarkus-jackson/deployment/pom.xml", "diffHunk": "@@ -22,34 +22,10 @@\n       <groupId>io.quarkus</groupId>\n       <artifactId>quarkus-arc-deployment</artifactId>\n     </dependency>\n-    <dependency>\n-      <groupId>io.quarkus</groupId>\n-      <artifactId>quarkus-jackson-deployment</artifactId>\n-    </dependency>\n-    <dependency>\n-      <groupId>org.optaplanner</groupId>\n-      <artifactId>optaplanner-quarkus-deployment</artifactId>\n-    </dependency>\n     <dependency>\n       <groupId>org.optaplanner</groupId>\n       <artifactId>optaplanner-quarkus-jackson</artifactId>\n     </dependency>\n-\n-    <dependency>\n-      <groupId>io.quarkus</groupId>\n-      <artifactId>quarkus-junit5-internal</artifactId>\n-      <scope>test</scope>\n-    </dependency>\n-    <dependency>\n-      <groupId>io.quarkus</groupId>\n-      <artifactId>quarkus-resteasy-deployment</artifactId>", "originalCommit": "7396889eaa7ff919cc50a778f44633a79c60e817", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0fee3aa142204767ec6f2dedcac20f747bcccb1b", "url": "https://github.com/kiegroup/optaplanner/commit/0fee3aa142204767ec6f2dedcac20f747bcccb1b", "message": "Fix school timetabling quickstart", "committedDate": "2020-07-16T11:06:09Z", "type": "forcePushed"}, {"oid": "5e7e2d85ccd02cae1897a233721e8b2b0245c7fd", "url": "https://github.com/kiegroup/optaplanner/commit/5e7e2d85ccd02cae1897a233721e8b2b0245c7fd", "message": "PLANNER-1996: Enable dependency check\n\nUse maven-dependency-plugins to fail the build if any used undeclared\nor unused declared dependencies are found.\n\nThe plugin is configured to ignore non-compile dependencies. This avoids\nhaving to ignore runtime and test-runtime dependencies individually.\n\nExplanation:\n- The plugin cannot detect if a declared runtime dependency is unused.\n- The plugin cannot detect if an undeclared runtime dependency is used\n  transitively. It is contributor's responsibility to declare runtime\n  dependencies even though they are provided transitively.\n- Missing runtime dependencies should be detected by tests. It's\n  contributor's responsibility to write tests using runtime dependencies\n  or to document why a runtine dependency is declared in case it\n  cannot be covered by tests.\n- The plugin will detect unused declared compile-scope dependencies.\n- The plugin will detect used undeclared (transitive) compile-scope\n  dependencies.\n\nException: Spring Boot Starters are designed to provided transitive\ndependencies. So the OptaPlanner Spring Boot Starter is allowed to have\nunused declared dependencies and projects depending on Starters are not\nchecked at all. The same applies for Quarkus integration modules.", "committedDate": "2020-07-16T13:55:17Z", "type": "commit"}, {"oid": "5e7e2d85ccd02cae1897a233721e8b2b0245c7fd", "url": "https://github.com/kiegroup/optaplanner/commit/5e7e2d85ccd02cae1897a233721e8b2b0245c7fd", "message": "PLANNER-1996: Enable dependency check\n\nUse maven-dependency-plugins to fail the build if any used undeclared\nor unused declared dependencies are found.\n\nThe plugin is configured to ignore non-compile dependencies. This avoids\nhaving to ignore runtime and test-runtime dependencies individually.\n\nExplanation:\n- The plugin cannot detect if a declared runtime dependency is unused.\n- The plugin cannot detect if an undeclared runtime dependency is used\n  transitively. It is contributor's responsibility to declare runtime\n  dependencies even though they are provided transitively.\n- Missing runtime dependencies should be detected by tests. It's\n  contributor's responsibility to write tests using runtime dependencies\n  or to document why a runtine dependency is declared in case it\n  cannot be covered by tests.\n- The plugin will detect unused declared compile-scope dependencies.\n- The plugin will detect used undeclared (transitive) compile-scope\n  dependencies.\n\nException: Spring Boot Starters are designed to provided transitive\ndependencies. So the OptaPlanner Spring Boot Starter is allowed to have\nunused declared dependencies and projects depending on Starters are not\nchecked at all. The same applies for Quarkus integration modules.", "committedDate": "2020-07-16T13:55:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTkzOTg3Mg==", "url": "https://github.com/kiegroup/optaplanner/pull/824#discussion_r455939872", "bodyText": "Thanks!", "author": "rsynek", "createdAt": "2020-07-16T17:08:12Z", "path": "optaplanner-benchmark/pom.xml", "diffHunk": "@@ -89,6 +89,7 @@\n     <dependency>\n       <groupId>org.glassfish.jaxb</groupId>\n       <artifactId>jaxb-runtime</artifactId>\n+      <scope>runtime</scope>", "originalCommit": "5e7e2d85ccd02cae1897a233721e8b2b0245c7fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}