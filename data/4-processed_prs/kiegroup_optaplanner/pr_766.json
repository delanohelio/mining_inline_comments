{"pr_number": 766, "pr_title": "Apply Quarkus code style", "pr_createdAt": "2020-05-01T06:25:57Z", "pr_url": "https://github.com/kiegroup/optaplanner/pull/766", "timeline": [{"oid": "b1c4ac3b3dafc008798c172c1dad74ca4bf0f50f", "url": "https://github.com/kiegroup/optaplanner/commit/b1c4ac3b3dafc008798c172c1dad74ca4bf0f50f", "message": "Enable the formatter maven plugin", "committedDate": "2020-05-01T05:51:09Z", "type": "commit"}, {"oid": "8e99f48ba83718cc49cabf0a7494ad767fec3250", "url": "https://github.com/kiegroup/optaplanner/commit/8e99f48ba83718cc49cabf0a7494ad767fec3250", "message": "Apply Quarkus code style", "committedDate": "2020-05-01T06:23:46Z", "type": "commit"}, {"oid": "24ca17c70fae70ba6a9d8a188cf33eba68da2f32", "url": "https://github.com/kiegroup/optaplanner/commit/24ca17c70fae70ba6a9d8a188cf33eba68da2f32", "message": "Enforce LF as the newline character", "committedDate": "2020-05-01T09:10:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU4NjI5Ng==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418586296", "bodyText": "I highly recommend to eliminate the trailing space. Trailing spaces are a style-smell, I would say. Git highlights it as an error when displaying a diff. IDEs can be configured to automatically strip off trailing white space on save.\nI know this is a result of applying the maven plugin and I'd argue it's a bug. But note that it won't reintroduce the trailing white space if the Javadoc is already formatted correctly and contains the blank line after description.", "author": "yurloc", "createdAt": "2020-05-01T15:15:43Z", "path": "optaplanner-benchmark/src/main/java/org/optaplanner/benchmark/api/PlannerBenchmarkFactory.java", "diffHunk": "@@ -51,8 +51,9 @@\n      * The XML root element must be {@code <solver>}.\n      * <p>\n      * To read an XML benchmark configuration instead, use {@link #createFromXmlResource(String)}.\n+     * ", "originalCommit": "24ca17c70fae70ba6a9d8a188cf33eba68da2f32", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU4OTk2MQ==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418589961", "bodyText": "Concrete example why neglecting the white space produced by the plugin will be a problem:\nI have my IDE configured to strip trailing spaces on save and I use my IDE to format the code using a shortcut. So each time I'll edit and commit a source file, I'll produce a formatting noise by removing the trailing space (until it's eventually eradicated).\nI'd find that quite annoying especially given that such situation can be easily avoided. Remember that the maven plugin is a safety net for contributors using exotic IDEs or unwilling to import our style.", "author": "yurloc", "createdAt": "2020-05-01T15:23:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU4NjI5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODYwNDQxNw==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418604417", "bodyText": "Thanks for pointing this out, already fixed.", "author": "rsynek", "createdAt": "2020-05-01T15:54:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU4NjI5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODYwNDY2NA==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418604664", "bodyText": "Radovan removed all trailing spaces in all these javadocs", "author": "ge0ffrey", "createdAt": "2020-05-01T15:55:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU4NjI5Ng=="}], "type": "inlineReview"}, {"oid": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "url": "https://github.com/kiegroup/optaplanner/commit/105604b01fb7aef1262eb3e13a2525c0638d78f9", "message": "Get rid of trailing spaces in javadoc", "committedDate": "2020-05-01T16:01:08Z", "type": "commit"}, {"oid": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "url": "https://github.com/kiegroup/optaplanner/commit/105604b01fb7aef1262eb3e13a2525c0638d78f9", "message": "Get rid of trailing spaces in javadoc", "committedDate": "2020-05-01T16:01:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY1NDU3MA==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418654570", "bodyText": "Not nice (especially the space inside brackets).", "author": "yurloc", "createdAt": "2020-05-01T17:46:14Z", "path": "optaplanner-benchmark/src/main/java/org/optaplanner/benchmark/impl/DefaultPlannerBenchmark.java", "diffHunk": "@@ -250,10 +252,11 @@ private void warmUp(Map<Future<SubSingleBenchmarkRunner>, SubSingleBenchmarkRunn\n                 }\n             }\n \n-            SolverBenchmarkResult solverBenchmarkResult = subSingleBenchmarkRunner.getSubSingleBenchmarkResult().getSingleBenchmarkResult().getSolverBenchmarkResult();\n+            SolverBenchmarkResult solverBenchmarkResult = subSingleBenchmarkRunner.getSubSingleBenchmarkResult()\n+                    .getSingleBenchmarkResult().getSolverBenchmarkResult();\n             long timeLeftInCycle = timePhaseEnd - System.currentTimeMillis();\n             if (timeLeftInCycle > 0L) {\n-                SolverBenchmarkResult[] solverBenchmarkResultSingleton = new SolverBenchmarkResult[]{solverBenchmarkResult};\n+                SolverBenchmarkResult[] solverBenchmarkResultSingleton = new SolverBenchmarkResult[] { solverBenchmarkResult };", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY1NjMzMg==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418656332", "bodyText": "Another example of the unexpected space inside brackets.", "author": "yurloc", "createdAt": "2020-05-01T17:49:59Z", "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/domain/solution/PlanningScore.java", "diffHunk": "@@ -35,7 +35,7 @@\n  * This property is modified by the {@link Solver},\n  * every time when the {@link Score} of this {@link PlanningSolution} has been calculated.\n  */\n-@Target({METHOD, FIELD})\n+@Target({ METHOD, FIELD })", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY1OTQ4Nw==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418659487", "bodyText": "The style allows lines longer than 120 chars -> GitHub diff windows with scrollbars.", "author": "yurloc", "createdAt": "2020-05-01T17:56:33Z", "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/holder/AbstractScoreHolder.java", "diffHunk": "@@ -114,15 +115,16 @@ public void configureConstraintWeight(Rule rule, Score_ constraintWeight) {\n      * Requires @{@link OptaPlannerRuleEventListener} to be added as event listener on {@link KieSession}, otherwise the\n      * score changes caused by the constraint matches would not be undone. See\n      * {@link DroolsScoreDirector#resetKieSession()} for an example.\n+     *\n      * @param kcontext The rule for which to register the match.\n      * @param constraintUndoListener The operation to run to undo the match.\n      * @param scoreSupplier The score change to be undone when constraint justification enabled.\n      */\n     protected void registerConstraintMatch(RuleContext kcontext,\n             final Runnable constraintUndoListener, Supplier<Score_> scoreSupplier) {\n         AgendaItem<?> agendaItem = (AgendaItem) kcontext.getMatch();\n-        ConstraintActivationUnMatchListener constraintActivationUnMatchListener\n-                = new ConstraintActivationUnMatchListener(constraintUndoListener);\n+        ConstraintActivationUnMatchListener constraintActivationUnMatchListener = new ConstraintActivationUnMatchListener(", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY2MzQzNA==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418663434", "bodyText": "Not nice. And it violates Checkstyle's GenericWhitespace.", "author": "yurloc", "createdAt": "2020-05-01T18:05:01Z", "path": "optaplanner-core/src/main/java/org/optaplanner/core/config/domain/ReflectionsWorkaroundClasspathHelper.java", "diffHunk": "@@ -203,7 +203,7 @@ public static URL forClass(Class<?> aClass, ClassLoader... classLoaders) {\n                 if (classLoader instanceof URLClassLoader) {\n                     URL[] urls = ((URLClassLoader) classLoader).getURLs();\n                     if (urls != null) {\n-                        result.addAll(Sets.<URL>newHashSet(urls));\n+                        result.addAll(Sets.<URL> newHashSet(urls));", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMzNzU4MA==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r419337580", "bodyText": "I think that the explicit type argument itself is not nice - since Java 8, type inference is able to handle it [1]. I would rather remove it completely.\n[1] https://docs.oracle.com/javase/tutorial/java/generics/genTypeInference.html", "author": "rsynek", "createdAt": "2020-05-04T10:17:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY2MzQzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY2ODY5Nw==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r418668697", "bodyText": "Impossible to break line around assignment operator -> forces to violate line length limit.", "author": "yurloc", "createdAt": "2020-05-01T18:17:11Z", "path": "optaplanner-examples/src/test/java/org/optaplanner/examples/vehiclerouting/optional/score/VehicleRoutingConstraintProviderTest.java", "diffHunk": "@@ -30,8 +30,8 @@\n \n public class VehicleRoutingConstraintProviderTest {\n \n-    private final ConstraintVerifier<VehicleRoutingConstraintProvider, VehicleRoutingSolution> constraintVerifier\n-            = ConstraintVerifier.build(new VehicleRoutingConstraintProvider(),\n+    private final ConstraintVerifier<VehicleRoutingConstraintProvider, VehicleRoutingSolution> constraintVerifier = ConstraintVerifier", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY1MjkzMA==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r423652930", "bodyText": "@rsynek Example of removing \"manual\" line break.", "author": "yurloc", "createdAt": "2020-05-12T11:14:04Z", "path": "optaplanner-benchmark/src/main/java/org/optaplanner/benchmark/impl/report/BenchmarkReport.java", "diffHunk": "@@ -739,8 +755,7 @@ private XYItemRenderer createScalabilityPlotRenderer(NumberFormat numberFormat)\n         XYItemRenderer renderer = new StandardXYItemRenderer(StandardXYItemRenderer.SHAPES_AND_LINES);\n         // Use dashed line\n         renderer.setSeriesStroke(0, new BasicStroke(\n-                1.0f, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND, 1.0f, new float[] {2.0f, 6.0f}, 0.0f\n-        ));\n+                1.0f, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND, 1.0f, new float[] { 2.0f, 6.0f }, 0.0f));", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY1Mzk2MA==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r423653960", "bodyText": "@rsynek Example of removing \"manual\" line break.", "author": "yurloc", "createdAt": "2020-05-12T11:16:01Z", "path": "optaplanner-benchmark/src/main/java/org/optaplanner/benchmark/impl/statistic/movecountperstep/MoveCountPerStepSubSingleStatistic.java", "diffHunk": "@@ -64,8 +64,7 @@ public void stepEnded(AbstractStepScope<Solution_> stepScope) {\n         private void localSearchStepEnded(LocalSearchStepScope<Solution_> stepScope) {\n             long timeMillisSpent = stepScope.getPhaseScope().calculateSolverTimeMillisSpentUpToNow();\n             pointList.add(new MoveCountPerStepStatisticPoint(timeMillisSpent,\n-                    new MoveCountPerStepMeasurement(stepScope.getAcceptedMoveCount(), stepScope.getSelectedMoveCount())\n-            ));\n+                    new MoveCountPerStepMeasurement(stepScope.getAcceptedMoveCount(), stepScope.getSelectedMoveCount())));", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY1NjM1Mg==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r423656352", "bodyText": "@rsynek Another example of removing \"manual\" line break of a different type. It's impossible to insert a line break anywhere on this line other than inside the parentheses around method parameters.", "author": "yurloc", "createdAt": "2020-05-12T11:20:34Z", "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/domain/entity/PlanningEntity.java", "diffHunk": "@@ -68,25 +69,28 @@\n      * Process B (1GB RAM), Process A (2GB RAM), Process C (7GB RAM),\n      * <p>\n      * Do not use together with {@link #difficultyWeightFactoryClass()}.\n+     *\n      * @return {@link NullDifficultyComparator} when it is null (workaround for annotation limitation)\n      * @see #difficultyWeightFactoryClass()\n      */\n     Class<? extends Comparator> difficultyComparatorClass() default NullDifficultyComparator.class;\n \n     /** Workaround for annotation limitation in {@link #difficultyComparatorClass()}. */\n-    interface NullDifficultyComparator extends Comparator {}\n+    interface NullDifficultyComparator extends Comparator {\n+    }\n \n     /**\n      * The {@link SelectionSorterWeightFactory} alternative for {@link #difficultyComparatorClass()}.\n      * <p>\n      * Do not use together with {@link #difficultyComparatorClass()}.\n+     *\n      * @return {@link NullDifficultyWeightFactory} when it is null (workaround for annotation limitation)\n      * @see #difficultyComparatorClass()\n      */\n-    Class<? extends SelectionSorterWeightFactory> difficultyWeightFactoryClass()\n-            default NullDifficultyWeightFactory.class;\n+    Class<? extends SelectionSorterWeightFactory> difficultyWeightFactoryClass() default NullDifficultyWeightFactory.class;", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY2MDI0NA==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r423660244", "bodyText": "@rsynek Example of removing \"manual\" line break of different type. It's not allowed to break line around the arrow token.", "author": "yurloc", "createdAt": "2020-05-12T11:27:55Z", "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/buildin/hardmediumsoftbigdecimal/HardMediumSoftBigDecimalScoreHolder.java", "diffHunk": "@@ -64,29 +64,32 @@ public void configureConstraintWeight(Rule rule, HardMediumSoftBigDecimalScore c\n         super.configureConstraintWeight(rule, constraintWeight);\n         BiConsumer<RuleContext, BigDecimal> matchExecutor;\n         if (constraintWeight.equals(HardMediumSoftBigDecimalScore.ZERO)) {\n-            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight) -> {};\n-        } else if (constraintWeight.getMediumScore().equals(BigDecimal.ZERO) && constraintWeight.getSoftScore().equals(BigDecimal.ZERO)) {\n-            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight)\n-                    -> addHardConstraintMatch(kcontext, constraintWeight.getHardScore().multiply(matchWeight));\n-        } else if (constraintWeight.getHardScore().equals(BigDecimal.ZERO) && constraintWeight.getSoftScore().equals(BigDecimal.ZERO)) {\n-            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight)\n-                    -> addMediumConstraintMatch(kcontext, constraintWeight.getMediumScore().multiply(matchWeight));\n-        } else if (constraintWeight.getHardScore().equals(BigDecimal.ZERO) && constraintWeight.getMediumScore().equals(BigDecimal.ZERO)) {\n-            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight)\n-                    -> addSoftConstraintMatch(kcontext, constraintWeight.getSoftScore().multiply(matchWeight));\n+            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight) -> {\n+            };\n+        } else if (constraintWeight.getMediumScore().equals(BigDecimal.ZERO)\n+                && constraintWeight.getSoftScore().equals(BigDecimal.ZERO)) {\n+            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight) -> addHardConstraintMatch(kcontext,\n+                    constraintWeight.getHardScore().multiply(matchWeight));\n+        } else if (constraintWeight.getHardScore().equals(BigDecimal.ZERO)\n+                && constraintWeight.getSoftScore().equals(BigDecimal.ZERO)) {\n+            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight) -> addMediumConstraintMatch(kcontext,\n+                    constraintWeight.getMediumScore().multiply(matchWeight));\n+        } else if (constraintWeight.getHardScore().equals(BigDecimal.ZERO)\n+                && constraintWeight.getMediumScore().equals(BigDecimal.ZERO)) {\n+            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight) -> addSoftConstraintMatch(kcontext,\n+                    constraintWeight.getSoftScore().multiply(matchWeight));\n         } else {\n-            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight)\n-                    -> addMultiConstraintMatch(kcontext,\n+            matchExecutor = (RuleContext kcontext, BigDecimal matchWeight) -> addMultiConstraintMatch(kcontext,", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY2NDUwOA==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r423664508", "bodyText": "Another nice example. Impossible not to break line length limit here.", "author": "yurloc", "createdAt": "2020-05-12T11:36:34Z", "path": "optaplanner-core/src/main/java/org/optaplanner/core/api/score/stream/ConstraintCollectors.java", "diffHunk": "@@ -1724,8 +1758,7 @@ public void remove(Key key, Value value) {\n      * @param <ValueSet> type of the value set\n      * @return never null\n      */\n-    public static <A, B, C, D, Key extends Comparable<Key>, Value, ValueSet extends Set<Value>>\n-    QuadConstraintCollector<A, B, C, D, ?, SortedMap<Key, ValueSet>> toSortedMap(\n+    public static <A, B, C, D, Key extends Comparable<Key>, Value, ValueSet extends Set<Value>> QuadConstraintCollector<A, B, C, D, ?, SortedMap<Key, ValueSet>> toSortedMap(", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzY2ODQ4MQ==", "url": "https://github.com/kiegroup/optaplanner/pull/766#discussion_r423668481", "bodyText": "@rsynek Another example. This doesn't look harmful but it's a different type of place where breaking a line is not allowed.", "author": "yurloc", "createdAt": "2020-05-12T11:44:31Z", "path": "optaplanner-core/src/main/java/org/optaplanner/core/impl/domain/solution/cloner/FieldAccessingSolutionCloner.java", "diffHunk": "@@ -419,33 +423,32 @@ protected Object cloneArray(Class<?> expectedType, Object originalArray) {\n \n         /**\n          * Fails fast if {@link #isFieldAnEntityPropertyOnSolution} assumptions were wrong.\n+         *\n          * @param originalSolution never null\n          * @param cloneSolution never null\n          */\n         protected void validateCloneSolution(Solution_ originalSolution, Solution_ cloneSolution) {\n-            for (MemberAccessor memberAccessor\n-                    : solutionDescriptor.getEntityMemberAccessorMap().values()) {\n+            for (MemberAccessor memberAccessor : solutionDescriptor.getEntityMemberAccessorMap().values()) {\n                 Object originalProperty = memberAccessor.executeGetter(originalSolution);\n                 if (originalProperty != null) {\n                     Object cloneProperty = memberAccessor.executeGetter(cloneSolution);\n                     if (originalProperty == cloneProperty) {\n                         throw new IllegalStateException(\n                                 \"The solutionProperty (\" + memberAccessor.getName() + \") was not cloned as expected.\"\n-                                + \" The \" + FieldAccessingSolutionCloner.class.getSimpleName() + \" failed to recognize\"\n-                                + \" that property's field, probably because its field name is different.\");\n+                                        + \" The \" + FieldAccessingSolutionCloner.class.getSimpleName() + \" failed to recognize\"\n+                                        + \" that property's field, probably because its field name is different.\");\n                     }\n                 }\n             }\n-            for (MemberAccessor memberAccessor\n-                    : solutionDescriptor.getEntityCollectionMemberAccessorMap().values()) {\n+            for (MemberAccessor memberAccessor : solutionDescriptor.getEntityCollectionMemberAccessorMap().values()) {", "originalCommit": "105604b01fb7aef1262eb3e13a2525c0638d78f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}