{"pr_number": 1052, "pr_title": "PLANNER-2227 A non-full build should not generate javadocs and run the enforcer rules twice", "pr_createdAt": "2020-11-26T14:04:00Z", "pr_url": "https://github.com/kiegroup/optaplanner/pull/1052", "timeline": [{"oid": "4bbabd11b021318843258dcc003c44e36de21501", "url": "https://github.com/kiegroup/optaplanner/commit/4bbabd11b021318843258dcc003c44e36de21501", "message": "Remove unused illegal transitive dependency check\n\nThe check was disabled and is duplicated by the dependency:analyze-only.", "committedDate": "2020-11-25T16:37:52Z", "type": "commit"}, {"oid": "2768c5f1a6e837de0323260d5bc61103a9ead9df", "url": "https://github.com/kiegroup/optaplanner/commit/2768c5f1a6e837de0323260d5bc61103a9ead9df", "message": "Move logback check to separate execution", "committedDate": "2020-11-25T20:54:38Z", "type": "commit"}, {"oid": "f22d701869319b4970720d3f9989196f64fa9f22", "url": "https://github.com/kiegroup/optaplanner/commit/f22d701869319b4970720d3f9989196f64fa9f22", "message": "Run enforcer in its default phase", "committedDate": "2020-11-25T21:04:39Z", "type": "commit"}, {"oid": "2f7fca7a44f97561ede6296c4b9b8ef99e5a37d7", "url": "https://github.com/kiegroup/optaplanner/commit/2f7fca7a44f97561ede6296c4b9b8ef99e5a37d7", "message": "Remove obsolete banned dependencies", "committedDate": "2020-11-25T21:05:19Z", "type": "commit"}, {"oid": "4cc040c6c0ce61475c0038c9eef0c37f6a42d890", "url": "https://github.com/kiegroup/optaplanner/commit/4cc040c6c0ce61475c0038c9eef0c37f6a42d890", "message": "Remove old dependencies from ban-duplicated-classes", "committedDate": "2020-11-25T21:15:11Z", "type": "commit"}, {"oid": "523ef960f3a2fb3988237235edc015fc6c27df65", "url": "https://github.com/kiegroup/optaplanner/commit/523ef960f3a2fb3988237235edc015fc6c27df65", "message": "Remove unused build-helper-maven-plugin", "committedDate": "2020-11-26T09:25:06Z", "type": "commit"}, {"oid": "5e8eccb38327f8cf80f99c573d40bc030e2cf632", "url": "https://github.com/kiegroup/optaplanner/commit/5e8eccb38327f8cf80f99c573d40bc030e2cf632", "message": "Remove obsolete excludes from jacoco reporting", "committedDate": "2020-11-26T09:28:51Z", "type": "commit"}, {"oid": "3d0bc70417287e05eeaacd17d1214c00f76d190b", "url": "https://github.com/kiegroup/optaplanner/commit/3d0bc70417287e05eeaacd17d1214c00f76d190b", "message": "Remove revapi \"report\" execution\n\nThe \"check\" goal is used in the CI. The \"report\" goal creates html\nreport in target/site nobody reads.", "committedDate": "2020-11-26T09:31:26Z", "type": "commit"}, {"oid": "88ab8f5e10567186790d2a984ab7522dee6edd7b", "url": "https://github.com/kiegroup/optaplanner/commit/88ab8f5e10567186790d2a984ab7522dee6edd7b", "message": "Add a Jira for ban-duplicated-classes", "committedDate": "2020-11-26T09:44:39Z", "type": "commit"}, {"oid": "2f68c6593f94370ec91371165ea906c7c2af41d5", "url": "https://github.com/kiegroup/optaplanner/commit/2f68c6593f94370ec91371165ea906c7c2af41d5", "message": "Add a Jira for obsolete dependencies", "committedDate": "2020-11-26T09:52:15Z", "type": "commit"}, {"oid": "2e1bcd2c848e05b3d3de9db4eac9eeb51f4d68c7", "url": "https://github.com/kiegroup/optaplanner/commit/2e1bcd2c848e05b3d3de9db4eac9eeb51f4d68c7", "message": "Remove the enforce-plugin-versions rules\n\nThe enforcer complains about missing versions of various plugins\nthat are, in fact, defined in jboss-parent.", "committedDate": "2020-11-26T10:01:50Z", "type": "commit"}, {"oid": "43580b233b844a274c6282f273d544331e8e34a9", "url": "https://github.com/kiegroup/optaplanner/commit/43580b233b844a274c6282f273d544331e8e34a9", "message": "Remove the revapi report profile", "committedDate": "2020-11-26T10:30:56Z", "type": "commit"}, {"oid": "362f2b3bd0098fe29151277a81722396b473f424", "url": "https://github.com/kiegroup/optaplanner/commit/362f2b3bd0098fe29151277a81722396b473f424", "message": "Remove commented out configuration", "committedDate": "2020-11-26T10:31:56Z", "type": "commit"}, {"oid": "d53d77e6939f655a664a0c7238b770c9f50f6b9a", "url": "https://github.com/kiegroup/optaplanner/commit/d53d77e6939f655a664a0c7238b770c9f50f6b9a", "message": "Move non-essential plugins to full profile", "committedDate": "2020-11-26T14:00:47Z", "type": "commit"}, {"oid": "8f408bd4f6d4aaacf39f39bef2180fe61c0009c7", "url": "https://github.com/kiegroup/optaplanner/commit/8f408bd4f6d4aaacf39f39bef2180fe61c0009c7", "message": "Introduce the quick profile\n\nDoes just the build, no checks at all.", "committedDate": "2020-11-26T14:01:26Z", "type": "commit"}, {"oid": "318a7733d2e57486d730f6f8bf65a32ca54216a1", "url": "https://github.com/kiegroup/optaplanner/commit/318a7733d2e57486d730f6f8bf65a32ca54216a1", "message": "Run the fullProfile in the Github Actions CI", "committedDate": "2020-11-26T14:06:41Z", "type": "commit"}, {"oid": "1035845cc9e7e82fdbce92dc2062f6465bc76059", "url": "https://github.com/kiegroup/optaplanner/commit/1035845cc9e7e82fdbce92dc2062f6465bc76059", "message": "Run revapi only in configured modules", "committedDate": "2020-11-26T14:27:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0Mzc4Ng==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r531643786", "bodyText": "I believe revapi needs to run with a \"mvn clean install\" too, but not a \"mvn clean install -Dquickly\", because it's too often an issue when submitting a PR without a maven build.", "author": "ge0ffrey", "createdAt": "2020-11-27T14:50:50Z", "path": "build/optaplanner-build-parent/pom.xml", "diffHunk": "@@ -74,6 +74,8 @@\n     <!-- Latest release to be used by api-compatibility-check to check backwards compatibility of the API. -->\n     <revapi.oldKieVersion>7.39.0.Final</revapi.oldKieVersion>\n     <revapi.newKieVersion>${project.version}</revapi.newKieVersion>\n+    <!-- Runs only in the fullProfile. -->\n+    <revapi.skip>true</revapi.skip>", "originalCommit": "1035845cc9e7e82fdbce92dc2062f6465bc76059", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0ODc2Nw==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r531648767", "bodyText": "+1.", "author": "triceo", "createdAt": "2020-11-27T15:00:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0Mzc4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NDUzNw==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r531644537", "bodyText": "We can remove cxf too, that's old", "author": "ge0ffrey", "createdAt": "2020-11-27T14:52:18Z", "path": "build/optaplanner-build-parent/pom.xml", "diffHunk": "@@ -513,10 +476,6 @@\n                       <!-- In case of transitive dependency, exclude it and use 'org.javassist:javassist' instead -->\n                       <exclude>javassist:javassist</exclude>\n                       <exclude>org.apache.cxf:cxf-bundle-jaxrs</exclude>", "originalCommit": "1035845cc9e7e82fdbce92dc2062f6465bc76059", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NTEzMQ==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r531645131", "bodyText": "IIRC it only fails on the quarkus, so maybe we can only turn it off for quarkus-integration?\nEither way, good for another PR, not an issues for this one.", "author": "ge0ffrey", "createdAt": "2020-11-27T14:53:36Z", "path": "build/optaplanner-build-parent/pom.xml", "diffHunk": "@@ -526,8 +485,7 @@\n             </execution>\n             <execution>\n               <id>ban-duplicated-classes</id>\n-              <!-- Using phase=none as we don't want this execution as part of the default build. The phase\n-                   is specified in the \"full\" profile and thus the execution will only be activated when using that profile. -->\n+              <!-- Currently disabled as it fails the build. See https://issues.redhat.com/browse/PLANNER-2261. -->", "originalCommit": "1035845cc9e7e82fdbce92dc2062f6465bc76059", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY0NjcxNA==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r532646714", "bodyText": "No, it fails for the optaplanner-core, too.", "author": "rsynek", "createdAt": "2020-11-30T14:42:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NTEzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NTgxMg==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r531645812", "bodyText": "I suspect revapi will best stay (see previous comment)", "author": "ge0ffrey", "createdAt": "2020-11-27T14:54:51Z", "path": "build/optaplanner-build-parent/pom.xml", "diffHunk": "@@ -1131,49 +951,6 @@\n         </plugins>\n       </build>\n     </profile>\n-    <profile>\n-      <id>generate-revapi-report</id>\n-      <!-- There is no need to run tests when generating the report -->\n-      <properties>\n-        <skipTests>true</skipTests>\n-      </properties>", "originalCommit": "1035845cc9e7e82fdbce92dc2062f6465bc76059", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjY0OTQ0MQ==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r532649441", "bodyText": "Yes, this profile is completely unrelated to the regular revapi check we do both locally and in the PR checks.\nWe don't use the reporting capabilities of revapi anymore. In the past we did use it to generate a list of changes between two product releases. In the OptaPlanner, we have something much better - the upgrade-recipe.", "author": "rsynek", "createdAt": "2020-11-30T14:46:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NTgxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NjM2Nw==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r531646367", "bodyText": "in quarkus they call use -Dquickly not -Dquick. I suspect Kogito does the same. Let's just follow them.", "author": "ge0ffrey", "createdAt": "2020-11-27T14:55:50Z", "path": "build/optaplanner-build-parent/pom.xml", "diffHunk": "@@ -1327,6 +1090,66 @@\n         <sonar.pullrequest.base>${env.ghprbTargetBranch}</sonar.pullrequest.base>\n       </properties>\n     </profile>\n+\n+    <profile>\n+      <id>fullProfile</id>\n+      <activation>\n+        <property>\n+          <name>full</name>\n+        </property>\n+      </activation>\n+      <properties>\n+        <revapi.skip>false</revapi.skip>\n+      </properties>\n+      <build>\n+        <plugins>\n+          <plugin> <!-- Make sure the build fails-fast on Javadoc issues. -->\n+            <artifactId>maven-javadoc-plugin</artifactId>\n+            <executions>\n+              <execution>\n+                <id>javadoc-javadoc</id>\n+                <phase>package</phase>\n+                <goals>\n+                  <goal>javadoc-no-fork</goal>\n+                </goals>\n+              </execution>\n+            </executions>\n+          </plugin>\n+          <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-dependency-plugin</artifactId>\n+            <executions>\n+              <execution>\n+                <id>analyze-only</id>\n+                <goals>\n+                  <goal>analyze-only</goal>\n+                </goals>\n+                <configuration>\n+                  <failOnWarning>true</failOnWarning>\n+                  <ignoreNonCompile>true</ignoreNonCompile>\n+                  <verbose>true</verbose>\n+                </configuration>\n+              </execution>\n+            </executions>\n+          </plugin>\n+        </plugins>\n+      </build>\n+    </profile>\n+    <profile>\n+      <id>quickProfile</id>\n+      <activation>\n+        <property>\n+          <name>quick</name>", "originalCommit": "1035845cc9e7e82fdbce92dc2062f6465bc76059", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NjYxNw==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r531646617", "bodyText": "nitpick: quicklyProfile should be before fullProfile I suggest because I'd order from less to more?", "author": "ge0ffrey", "createdAt": "2020-11-27T14:56:18Z", "path": "build/optaplanner-build-parent/pom.xml", "diffHunk": "@@ -1327,6 +1090,66 @@\n         <sonar.pullrequest.base>${env.ghprbTargetBranch}</sonar.pullrequest.base>\n       </properties>\n     </profile>\n+\n+    <profile>\n+      <id>fullProfile</id>\n+      <activation>\n+        <property>\n+          <name>full</name>\n+        </property>\n+      </activation>\n+      <properties>\n+        <revapi.skip>false</revapi.skip>\n+      </properties>\n+      <build>\n+        <plugins>\n+          <plugin> <!-- Make sure the build fails-fast on Javadoc issues. -->\n+            <artifactId>maven-javadoc-plugin</artifactId>\n+            <executions>\n+              <execution>\n+                <id>javadoc-javadoc</id>\n+                <phase>package</phase>\n+                <goals>\n+                  <goal>javadoc-no-fork</goal>\n+                </goals>\n+              </execution>\n+            </executions>\n+          </plugin>\n+          <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-dependency-plugin</artifactId>\n+            <executions>\n+              <execution>\n+                <id>analyze-only</id>\n+                <goals>\n+                  <goal>analyze-only</goal>\n+                </goals>\n+                <configuration>\n+                  <failOnWarning>true</failOnWarning>\n+                  <ignoreNonCompile>true</ignoreNonCompile>\n+                  <verbose>true</verbose>\n+                </configuration>\n+              </execution>\n+            </executions>\n+          </plugin>\n+        </plugins>\n+      </build>\n+    </profile>\n+    <profile>\n+      <id>quickProfile</id>", "originalCommit": "1035845cc9e7e82fdbce92dc2062f6465bc76059", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0OTk4Ng==", "url": "https://github.com/kiegroup/optaplanner/pull/1052#discussion_r531649986", "bodyText": "\"Quickly profile\" is grammatically incorrect. But +1 for -Dquickly activation.\nhttps://github.com/quarkusio/quarkus/blob/1.10.1.Final/independent-projects/arc/pom.xml#L307-L311", "author": "yurloc", "createdAt": "2020-11-27T15:02:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NjYxNw=="}], "type": "inlineReview"}, {"oid": "5d95436127048ea4cc274ff0c3ac68e23d5edf0c", "url": "https://github.com/kiegroup/optaplanner/commit/5d95436127048ea4cc274ff0c3ac68e23d5edf0c", "message": "Address review comments", "committedDate": "2020-11-30T14:47:58Z", "type": "commit"}]}