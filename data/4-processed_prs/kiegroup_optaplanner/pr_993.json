{"pr_number": 993, "pr_title": "[8.0.0.beta1] Add dependencies repository before mvn install", "pr_createdAt": "2020-10-27T08:11:52Z", "pr_url": "https://github.com/kiegroup/optaplanner/pull/993", "timeline": [{"oid": "cf2d5f153a87d85c5f3bbf95d15a18523445554f", "url": "https://github.com/kiegroup/optaplanner/commit/cf2d5f153a87d85c5f3bbf95d15a18523445554f", "message": "Add dependencies repository before mvn install", "committedDate": "2020-10-27T08:02:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ4OTgwNQ==", "url": "https://github.com/kiegroup/optaplanner/pull/993#discussion_r512489805", "bodyText": "We could just store in the env under another name the path to this Settings file (env.GLOBAL_MAVEN_SETTINGS for example), so we don't need to do it again in the Build[...] part and just use the env we just stored.\nThe file is anyway created and stored for the rest of the pipeline run", "author": "radtriste", "createdAt": "2020-10-27T08:17:00Z", "path": "Jenkinsfile.deploy", "diffHunk": "@@ -98,10 +98,7 @@ pipeline {\n                         sh \"echo '\\n-B -s ${MAVEN_SETTINGS_FILE}' | tee -a optaplanner/.mvn/maven.config\"\n                         if (params.MAVEN_DEPENDENCIES_REPOSITORY != '') {\n                             sh \"echo '\\n-Denforcer.skip=true' | tee -a optaplanner/.mvn/maven.config\"\n-                            sh \"sed -i 's|<repositories>|<repositories><repository><id>staging</id><name>Staging Repository</name><url>${params.MAVEN_DEPENDENCIES_REPOSITORY}</url><layout>default</layout><snapshots><enabled>true</enabled></snapshots><releases><enabled>true</enabled></releases></repository>|g' ${MAVEN_SETTINGS_FILE}\"\n-                            sh \"sed -i 's|<pluginRepositories>|<pluginRepositories><pluginRepository><id>staging</id><name>Staging Repository</name><url>${params.MAVEN_DEPENDENCIES_REPOSITORY}</url><layout>default</layout><snapshots><enabled>true</enabled></snapshots><releases><enabled>true</enabled></releases></pluginRepository>|g' ${MAVEN_SETTINGS_FILE}\"\n-                            sh \"sed -i 's|external:\\\\*|external:*,!staging|g' ${MAVEN_SETTINGS_FILE}\"\n-                            // Done to allow Maven to download release artifacts from MAVEN_DEPENDENCIES_REPOSITORY\n+                            addRepositoryToSettings(params.MAVEN_DEPENDENCIES_REPOSITORY, env.MAVEN_SETTINGS_FILE)", "originalCommit": "cf2d5f153a87d85c5f3bbf95d15a18523445554f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ5MDcyMw==", "url": "https://github.com/kiegroup/optaplanner/pull/993#discussion_r512490723", "bodyText": "Truth, better than adding the repository over and over.", "author": "rsynek", "createdAt": "2020-10-27T08:18:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ4OTgwNQ=="}], "type": "inlineReview"}, {"oid": "3ea959f29ad16f3910d9ea0dbb58d7d8ac8654fa", "url": "https://github.com/kiegroup/optaplanner/commit/3ea959f29ad16f3910d9ea0dbb58d7d8ac8654fa", "message": "Store settings in env variable", "committedDate": "2020-10-27T09:03:15Z", "type": "commit"}]}