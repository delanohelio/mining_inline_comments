{"pr_number": 9166, "pr_title": "CDPCP-3121 - Filter internal machine users for user sync", "pr_createdAt": "2020-10-07T21:31:52Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9166", "timeline": [{"oid": "5b13e223a27638ef39e4318353747ff6c49a4ec3", "url": "https://github.com/hortonworks/cloudbreak/commit/5b13e223a27638ef39e4318353747ff6c49a4ec3", "message": "CDPCP-3121. Update usermanagement.proto\n\nA flag has been added to the ListMachineUsersRequest to include workload users\ninstead of including all internal machine users. Usage of this flag will allow\nuser sync to include internal machine users that are workload users and skip\ninternal machine users that are not.", "committedDate": "2020-10-06T17:12:23Z", "type": "commit"}, {"oid": "a1a2abe96a89af93096c56b7b758ea44e981d61a", "url": "https://github.com/hortonworks/cloudbreak/commit/a1a2abe96a89af93096c56b7b758ea44e981d61a", "message": "CDPCP-3121. Update user sync to use includeWorkloadMachineUser flag\n\nUser sync cannot include all internal machine users for consideration\ndue to the large amount of orphaned internal machine users.\n\nInstead, a new field was added to the usermanagement.proto that allows\nthe UMS to filter and return only those internal machine users that\nare also workload users. This commit updates user sync to use this\nnew flag.", "committedDate": "2020-10-06T17:21:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTMyMzA0NA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9166#discussion_r501323044", "bodyText": "this is the needed proto change. the rest of the proto is just to keep it in sync with the UMS.", "author": "handavid", "createdAt": "2020-10-07T21:34:04Z", "path": "auth-connector/src/main/proto/usermanagement.proto", "diffHunk": "@@ -1703,6 +1727,13 @@ message ListMachineUsersRequest {\n   bool includeInternal = 5;\n   // Whether to include deleted machine users.\n   bool includeDeleted = 6;\n+  // Whether to include workload machine users. All regular machine users are\n+  // workload machine users. This is a subset of the internal machine users,\n+  // which have a password set. This field has no effect if internal machine\n+  // users are requested because all workload machine users will already be\n+  // included in the results. Note that this has no impact when listing by name\n+  // or CRN. For those calls, internal machine users are always returned.\n+  bool includeWorkloadMachineUsers = 7;", "originalCommit": "a1a2abe96a89af93096c56b7b758ea44e981d61a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}