{"pr_number": 8359, "pr_title": "CB-7508 Attempt to use KMS for SSE when AES fails.", "pr_createdAt": "2020-06-22T15:17:24Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8359", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDIwNzk4OA==", "url": "https://github.com/hortonworks/cloudbreak/pull/8359#discussion_r444207988", "bodyText": "Pls add log like: echo \"try to upload with AES256 encryption\"", "author": "pdarvasi", "createdAt": "2020-06-23T13:06:32Z", "path": "orchestrator-salt/src/main/resources/salt/salt/postgresql/disaster_recovery/scripts/backup_db.sh", "diffHunk": "@@ -77,19 +77,30 @@ dump_to_s3() {\n   SERVICE=$1\n   S3_LOCATION=\"${BACKUP_LOCATION}/${SERVICE}_backup\"\n   doLog \"INFO Dumping ${SERVICE} to ${S3_LOCATION}\"\n-  pg_dump --host=\"$HOST\" --port=\"$PORT\" --username=\"$USERNAME\" --dbname=\"${SERVICE}\" --format=plain 2>>$LOGFILE | /usr/bin/aws s3 cp --sse AES256 --no-progress - \"${S3_LOCATION}\" 2>>$LOGFILE || errorExit \"Unable to dump ${SERVICE}.\"\n-  doLog \"INFO ${SERVICE} dumped to ${S3_LOCATION}\"\n+\n+  ret_code=$(pg_dump --host=\"$HOST\" --port=\"$PORT\" --username=\"$USERNAME\" --dbname=\"${SERVICE}\" --format=plain 2>>$LOGFILE | /usr/bin/aws s3 cp --sse AES256 --no-progress - \"${S3_LOCATION}\" 2>>$LOGFILE || echo $?)", "originalCommit": "42049ce4912b144dcf1679f40a667f49e0d30df9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDIyMTcxMw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8359#discussion_r444221713", "bodyText": "Done", "author": "brycederriso", "createdAt": "2020-06-23T13:26:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDIwNzk4OA=="}], "type": "inlineReview"}, {"oid": "dac66b2cb420854c7b68c83981d82445c1ec578b", "url": "https://github.com/hortonworks/cloudbreak/commit/dac66b2cb420854c7b68c83981d82445c1ec578b", "message": "CB-7508 Attempt to use KMS for SSE when AES fails.", "committedDate": "2020-06-23T13:25:31Z", "type": "commit"}, {"oid": "dac66b2cb420854c7b68c83981d82445c1ec578b", "url": "https://github.com/hortonworks/cloudbreak/commit/dac66b2cb420854c7b68c83981d82445c1ec578b", "message": "CB-7508 Attempt to use KMS for SSE when AES fails.", "committedDate": "2020-06-23T13:25:31Z", "type": "forcePushed"}]}