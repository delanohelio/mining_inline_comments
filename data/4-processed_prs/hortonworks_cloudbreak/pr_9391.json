{"pr_number": 9391, "pr_title": "Cb 9647", "pr_createdAt": "2020-11-09T13:32:48Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9391", "timeline": [{"oid": "f431465e5a8bcfcc7b2d04c58f03e1788e3dc8ea", "url": "https://github.com/hortonworks/cloudbreak/commit/f431465e5a8bcfcc7b2d04c58f03e1788e3dc8ea", "message": "CB-9647 initial nodecount default now is 0 to avoid rolling upgrade issues", "committedDate": "2020-11-09T13:41:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0MzAxMQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9391#discussion_r519843011", "bodyText": "you have to set default value in a separate step to avoid table lock when adding a column:\nsee: https://github.com/hortonworks/cloudbreak/blob/master/freeipa/src/main/resources/schema/app/20200406095012_CB-6385_add_version_to_stack.sql", "author": "lacikaaa", "createdAt": "2020-11-09T14:13:19Z", "path": "core/src/main/resources/schema/app/20201027161305_CB-9127_optimize_cluster_template_load_time.sql", "diffHunk": "@@ -4,8 +4,9 @@\n DELETE FROM clustertemplate WHERE status='DEFAULT';\n ALTER TABLE clustertemplate ADD COLUMN IF NOT EXISTS clouderaRuntimeVersion VARCHAR(255);\n \n-ALTER TABLE instancegroup ADD COLUMN IF NOT EXISTS initialNodeCount INTEGER;\n+ALTER TABLE instancegroup ADD COLUMN IF NOT EXISTS initialNodeCount INTEGER DEFAULT 0;", "originalCommit": "f431465e5a8bcfcc7b2d04c58f03e1788e3dc8ea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0NDk2Ng==", "url": "https://github.com/hortonworks/cloudbreak/pull/9391#discussion_r519844966", "bodyText": "https://dba.stackexchange.com/questions/211221/add-column-with-default-in-postgresql-without-table-level-lock", "author": "lacikaaa", "createdAt": "2020-11-09T14:15:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0MzAxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg1NDQ4Mg==", "url": "https://github.com/hortonworks/cloudbreak/pull/9391#discussion_r519854482", "bodyText": "done", "author": "doktoric", "createdAt": "2020-11-09T14:29:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTg0MzAxMQ=="}], "type": "inlineReview"}, {"oid": "c92bbdbaab46315971bb95902f5074f11b2d7aba", "url": "https://github.com/hortonworks/cloudbreak/commit/c92bbdbaab46315971bb95902f5074f11b2d7aba", "message": "CB-9647 initial nodecount default now is 0 to avoid rolling upgrade issues", "committedDate": "2020-11-09T14:18:04Z", "type": "forcePushed"}, {"oid": "671c56af2890941d4d5c592f92712798416169e1", "url": "https://github.com/hortonworks/cloudbreak/commit/671c56af2890941d4d5c592f92712798416169e1", "message": "CB-9647 initial nodecount default now is 0 to avoid rolling upgrade issues", "committedDate": "2020-11-09T14:28:09Z", "type": "commit"}, {"oid": "671c56af2890941d4d5c592f92712798416169e1", "url": "https://github.com/hortonworks/cloudbreak/commit/671c56af2890941d4d5c592f92712798416169e1", "message": "CB-9647 initial nodecount default now is 0 to avoid rolling upgrade issues", "committedDate": "2020-11-09T14:28:09Z", "type": "forcePushed"}]}