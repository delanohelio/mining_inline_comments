{"pr_number": 8726, "pr_title": "CB-8210 Store HBase WAL file in a directory different from HBase root\u2026", "pr_createdAt": "2020-08-05T18:43:11Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8726", "timeline": [{"oid": "b73aad44eccbdd335d2a98296741ac2786aa2997", "url": "https://github.com/hortonworks/cloudbreak/commit/b73aad44eccbdd335d2a98296741ac2786aa2997", "message": "CB-8210 Store HBase WAL file in a directory different from HBase root directory", "committedDate": "2020-08-05T18:36:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk3MjI1Nw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8726#discussion_r465972257", "bodyText": "Are there unit-tests for this? We should update them.\nYou have made changes to 7.2.1. Should we make this change in the next version 7.2.2? That way we avoid breaking changes.", "author": "kmanamcheri", "createdAt": "2020-08-05T20:04:28Z", "path": "core/src/main/resources/defaults/blueprints/cdp-sdx-721.bp", "diffHunk": "@@ -222,6 +222,10 @@\n           }\n         ],\n         \"serviceConfigs\": [\n+          {", "originalCommit": "b73aad44eccbdd335d2a98296741ac2786aa2997", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAyNzY4NQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8726#discussion_r466027685", "bodyText": "I am getting familiar with Cloudbreak code. Will find where the test code is and add test code later.", "author": "LinaAtAustin", "createdAt": "2020-08-05T21:57:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk3MjI1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE5MTk0OQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8726#discussion_r466191949", "bodyText": "This will go to the root disk which is not something we want I think. There are dynamic config providers for HBase here.\nConfiguring the attached disk, here is an example where we configure the first disk only for Zookeper. Here is another example to configure multiple disks for Hdfs", "author": "keyki", "createdAt": "2020-08-06T07:11:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk3MjI1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUxMTMyMw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8726#discussion_r466511323", "bodyText": "@keyki Hmm.. this goes into HDFS. Can we configure HDFS for different disks?", "author": "kmanamcheri", "createdAt": "2020-08-06T15:49:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk3MjI1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUyMTc3MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/8726#discussion_r466521770", "bodyText": "Oh, sorry. I didn't know it's on HDFS. In that case, I'm fine. Thanks for the clarification.", "author": "keyki", "createdAt": "2020-08-06T16:05:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk3MjI1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk3MjUzNw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8726#discussion_r465972537", "bodyText": "Does this directory need to exist in HDFS? Is it automatically created? If not, should we add code to make sure that this directory exists?", "author": "kmanamcheri", "createdAt": "2020-08-05T20:05:01Z", "path": "core/src/main/resources/defaults/blueprints/cdp-sdx-721.bp", "diffHunk": "@@ -222,6 +222,10 @@\n           }\n         ],\n         \"serviceConfigs\": [\n+          {\n+            \"name\": \"hbase_wal_dir\",\n+            \"value\": \"/hbase-wals\"", "originalCommit": "b73aad44eccbdd335d2a98296741ac2786aa2997", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAzNTgyMQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8726#discussion_r466035821", "bodyText": "Blueprint just needs to add that configuration. CM will create this directory automatically. I have verified this at the host. With this change only, the folder \"/hbase-wals\" was created, and it contains data.\n[root@lina-0804-aws-s3-1-master1 bin]# hdfs dfs -ls /\nFound 4 items\ndrwxr-xr-x   - hbase hbase               0 2020-08-04 11:41 /hbase-wals\ndrwxrwxr-x   - solr  solr                0 2020-08-04 11:40 /solr-infra\ndrwxrwxrwt   - hdfs  supergroup          0 2020-08-04 11:40 /tmp\n[root@lina-0804-aws-s3-1-master1 bin]# hadoop fs -du -s -h /hbase-wals\n584.6 K  512.6 M  /hbase-wals\ndrwxr-xr-x   - hdfs  supergroup          0 2020-08-04 15:43 /user", "author": "LinaAtAustin", "createdAt": "2020-08-05T22:19:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk3MjUzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUxMDI4Nw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8726#discussion_r466510287", "bodyText": "Ok sounds good.", "author": "kmanamcheri", "createdAt": "2020-08-06T15:48:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk3MjUzNw=="}], "type": "inlineReview"}]}