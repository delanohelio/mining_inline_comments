{"pr_number": 9254, "pr_title": "CB-9154: Add ssl root cert and ssl mode to backup and restore PGSQL settings.", "pr_createdAt": "2020-10-20T16:52:23Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9254", "timeline": [{"oid": "d0aaa8c8fabe736174276c4478114f32642d669a", "url": "https://github.com/hortonworks/cloudbreak/commit/d0aaa8c8fabe736174276c4478114f32642d669a", "message": "CB-9154 Add ssl root cert and ssl mode to PGSQL settings.", "committedDate": "2020-10-28T19:31:19Z", "type": "forcePushed"}, {"oid": "21d3d6cecc5da37de95eb8dd9bc47c0388bba86a", "url": "https://github.com/hortonworks/cloudbreak/commit/21d3d6cecc5da37de95eb8dd9bc47c0388bba86a", "message": "CB-9154 Add ssl root cert and ssl mode to PGSQL settings.\n\n* Check if root cert file exists.\n* Opt in to verify-full and provide the root cert if it does exist.\n* Follow default behavior if it doesn't.", "committedDate": "2020-10-28T19:52:15Z", "type": "commit"}, {"oid": "21d3d6cecc5da37de95eb8dd9bc47c0388bba86a", "url": "https://github.com/hortonworks/cloudbreak/commit/21d3d6cecc5da37de95eb8dd9bc47c0388bba86a", "message": "CB-9154 Add ssl root cert and ssl mode to PGSQL settings.\n\n* Check if root cert file exists.\n* Opt in to verify-full and provide the root cert if it does exist.\n* Follow default behavior if it doesn't.", "committedDate": "2020-10-28T19:52:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3OTE1OA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9254#discussion_r513779158", "bodyText": "how about if we pass the folder /hadoopfs/fs1 down  in a pillar. In that case if somebody change the volume logic then we automatically get the right value.", "author": "doktoric", "createdAt": "2020-10-28T21:42:19Z", "path": "orchestrator-salt/src/main/resources/salt/salt/postgresql/disaster_recovery/scripts/backup_db.sh", "diffHunk": "@@ -29,6 +29,11 @@ RANGERGROUP=\"$5\"\n LOGFILE=${6:-/var/log/}/dl_postgres_backup.log\n echo \"Logs at ${LOGFILE}\"\n \n+if [[ -f /hadoopfs/fs1/database-cacerts/certs.pem ]]; then", "originalCommit": "21d3d6cecc5da37de95eb8dd9bc47c0388bba86a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc4NzYzNA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9254#discussion_r513787634", "bodyText": "Where should we set that pillar value? Is it already available in salt through the other changes @lajosrodek has made, or will I need to set it somewhere in the Java side?", "author": "brycederriso", "createdAt": "2020-10-28T21:59:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3OTE1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc5MDkzOQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9254#discussion_r513790939", "bodyText": "That would certainly need changes in my logic as well once it happens. \ud83d\ude03\n@doktoric I agree this would be a better approach, and we shall indeed do it (not only here but also in other related parts). However, I am wondering if it is the right time to fix this now. Could we possibly postpone it to 2.33 and fix all affected things altogether?", "author": "lajosrodek", "createdAt": "2020-10-28T22:07:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3OTE1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgyMTM4OQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9254#discussion_r513821389", "bodyText": "I've added a new value under the disaster_recovery pillar and tested backup + restore by rsyncing salt scripts and formulas across.\nWorking on testing with CB running locally, but I've not run that many CB components from IntelliJ before. working through it.", "author": "brycederriso", "createdAt": "2020-10-28T23:28:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3OTE1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgyMjA0MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9254#discussion_r513822041", "bodyText": "I'll monitor the build jobs and retry them.", "author": "brycederriso", "createdAt": "2020-10-28T23:30:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3OTE1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjQ5Mjc1MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9254#discussion_r536492751", "bodyText": "Has been solved in #9563.", "author": "lajosrodek", "createdAt": "2020-12-05T03:14:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc3OTE1OA=="}], "type": "inlineReview"}, {"oid": "c0c24d747041abd90a99357005c94d5192dd5a71", "url": "https://github.com/hortonworks/cloudbreak/commit/c0c24d747041abd90a99357005c94d5192dd5a71", "message": "Look up root cert from pillar.", "committedDate": "2020-10-28T23:14:26Z", "type": "commit"}]}