{"pr_number": 9496, "pr_title": "CB-9443 adding freeipa health check polling to freeipa start process", "pr_createdAt": "2020-11-23T16:44:10Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9496", "timeline": [{"oid": "4db89f5062dd338c4bce2544b9891b03abcca483", "url": "https://github.com/hortonworks/cloudbreak/commit/4db89f5062dd338c4bce2544b9891b03abcca483", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailble", "committedDate": "2020-11-24T09:15:43Z", "type": "forcePushed"}, {"oid": "83f2b6343055340df03da8b884715d6727e6d1cb", "url": "https://github.com/hortonworks/cloudbreak/commit/83f2b6343055340df03da8b884715d6727e6d1cb", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-24T10:03:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTM5NTAxOQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9496#discussion_r529395019", "bodyText": "You can check this in the constructor or in the factory.", "author": "topolyai5", "createdAt": "2020-11-24T10:08:57Z", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/flow/stack/start/OneFreeIpaReachableAttempt.java", "diffHunk": "@@ -0,0 +1,62 @@\n+package com.sequenceiq.freeipa.flow.stack.start;\n+\n+import static com.sequenceiq.cloudbreak.util.Benchmark.checkedMeasure;\n+\n+import java.util.Optional;\n+import java.util.Set;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import com.dyngr.core.AttemptMaker;\n+import com.dyngr.core.AttemptResult;\n+import com.dyngr.core.AttemptResults;\n+import com.sequenceiq.cloudbreak.cloud.scheduler.PollGroup;\n+import com.sequenceiq.cloudbreak.cloud.store.InMemoryStateStore;\n+import com.sequenceiq.freeipa.client.model.RPCResponse;\n+import com.sequenceiq.freeipa.entity.InstanceMetaData;\n+import com.sequenceiq.freeipa.entity.Stack;\n+import com.sequenceiq.freeipa.service.stack.FreeIpaHealthDetailsService;\n+\n+public class OneFreeIpaReachableAttempt implements AttemptMaker<Void> {\n+    private static final Logger LOGGER = LoggerFactory.getLogger(OneFreeIpaReachableAttempt.class);\n+\n+    private final FreeIpaHealthDetailsService freeIpaHealthDetailsService;\n+\n+    private final Stack stack;\n+\n+    private final Set<InstanceMetaData> instanceMetaDataSet;\n+\n+    public OneFreeIpaReachableAttempt(FreeIpaHealthDetailsService freeIpaHealthDetailsService, Stack stack, Set<InstanceMetaData> instanceMetaDataSet) {\n+        this.freeIpaHealthDetailsService = freeIpaHealthDetailsService;\n+        this.stack = stack;\n+        this.instanceMetaDataSet = instanceMetaDataSet;\n+    }\n+\n+    @Override\n+    public AttemptResult<Void> process() {\n+        if (stack == null || instanceMetaDataSet == null || instanceMetaDataSet.isEmpty()) {", "originalCommit": "83f2b6343055340df03da8b884715d6727e6d1cb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTQxNDMzMg==", "url": "https://github.com/hortonworks/cloudbreak/pull/9496#discussion_r529414332", "bodyText": "OK, thanks", "author": "afarsang", "createdAt": "2020-11-24T10:24:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTM5NTAxOQ=="}], "type": "inlineReview"}, {"oid": "935c07a3dbf27099510f754283597fb8d7e2b616", "url": "https://github.com/hortonworks/cloudbreak/commit/935c07a3dbf27099510f754283597fb8d7e2b616", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-24T10:33:27Z", "type": "forcePushed"}, {"oid": "1d86a96c027f36faf96de4c20f11ff4f5f4fe022", "url": "https://github.com/hortonworks/cloudbreak/commit/1d86a96c027f36faf96de4c20f11ff4f5f4fe022", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-24T10:55:42Z", "type": "forcePushed"}, {"oid": "f67a28b2acf0d908b3be1d1166c91630cfa432c9", "url": "https://github.com/hortonworks/cloudbreak/commit/f67a28b2acf0d908b3be1d1166c91630cfa432c9", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-24T12:46:57Z", "type": "forcePushed"}, {"oid": "2d15f10be8787aea4af1068383ae78f07da300b3", "url": "https://github.com/hortonworks/cloudbreak/commit/2d15f10be8787aea4af1068383ae78f07da300b3", "message": "CB-9443 adding freeipa health check polling to freeipa start process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-24T14:56:24Z", "type": "forcePushed"}, {"oid": "cecbda2b6aa755787b3b3746622ffb45373f547f", "url": "https://github.com/hortonworks/cloudbreak/commit/cecbda2b6aa755787b3b3746622ffb45373f547f", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-25T13:41:42Z", "type": "forcePushed"}, {"oid": "15c118c5db11545e605d07961977e4273d3df0cb", "url": "https://github.com/hortonworks/cloudbreak/commit/15c118c5db11545e605d07961977e4273d3df0cb", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-25T16:24:03Z", "type": "forcePushed"}, {"oid": "5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf", "url": "https://github.com/hortonworks/cloudbreak/commit/5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-25T18:44:21Z", "type": "commit"}, {"oid": "5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf", "url": "https://github.com/hortonworks/cloudbreak/commit/5b8bb11eda7abbb7fb5f4c940c5742cf9e50bbcf", "message": "CB-9443 adding freeipa health check polling to freeipa start and freeipa reboot process because datalake can fail when start and freeipa is unavailable", "committedDate": "2020-11-25T18:44:21Z", "type": "forcePushed"}]}