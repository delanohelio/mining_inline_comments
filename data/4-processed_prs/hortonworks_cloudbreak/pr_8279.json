{"pr_number": 8279, "pr_title": "CB-7395 Revise, restrict and POC Azure minimal permission list", "pr_createdAt": "2020-06-15T11:25:01Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8279", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDEyNjE3Ng==", "url": "https://github.com/hortonworks/cloudbreak/pull/8279#discussion_r440126176", "bodyText": "We should scope this on RG level, shouldn't we?", "author": "pdarvasi", "createdAt": "2020-06-15T12:02:16Z", "path": "cloud-azure/src/main/resources/definitions/azure-role-def-single-rg.json", "diffHunk": "@@ -0,0 +1,84 @@\n+{\n+  \"Name\": \"Cloudera Management Console Azure Operator\",\n+  \"IsCustom\": true,\n+  \"Description\": \"Can use Cloudera Management Console managed clusters and resources.\",\n+  \"Actions\": [\n+    \"Microsoft.Storage/storageAccounts/read\",\n+    \"Microsoft.Storage/storageAccounts/write\",\n+    \"Microsoft.Storage/storageAccounts/blobServices/write\",\n+    \"Microsoft.Storage/storageAccounts/blobServices/containers/delete\",\n+    \"Microsoft.Storage/storageAccounts/blobServices/containers/read\",\n+    \"Microsoft.Storage/storageAccounts/blobServices/containers/write\",\n+    \"Microsoft.Storage/storageAccounts/listkeys/action\",\n+    \"Microsoft.Storage/storageAccounts/regeneratekey/action\",\n+    \"Microsoft.Storage/storageAccounts/delete\",\n+    \"Microsoft.Storage/locations/deleteVirtualNetworkOrSubnets/action\",\n+    \"Microsoft.Network/virtualNetworks/read\",\n+    \"Microsoft.Network/virtualNetworks/write\",\n+    \"Microsoft.Network/virtualNetworks/delete\",\n+    \"Microsoft.Network/virtualNetworks/subnets/read\",\n+    \"Microsoft.Network/virtualNetworks/subnets/write\",\n+    \"Microsoft.Network/virtualNetworks/subnets/delete\",\n+    \"Microsoft.Network/virtualNetworks/subnets/join/action\",\n+    \"Microsoft.Network/publicIPAddresses/read\",\n+    \"Microsoft.Network/publicIPAddresses/write\",\n+    \"Microsoft.Network/publicIPAddresses/delete\",\n+    \"Microsoft.Network/publicIPAddresses/join/action\",\n+    \"Microsoft.Network/networkInterfaces/read\",\n+    \"Microsoft.Network/networkInterfaces/write\",\n+    \"Microsoft.Network/networkInterfaces/delete\",\n+    \"Microsoft.Network/networkInterfaces/join/action\",\n+    \"Microsoft.Network/networkInterfaces/ipconfigurations/read\",\n+    \"Microsoft.Network/networkSecurityGroups/read\",\n+    \"Microsoft.Network/networkSecurityGroups/write\",\n+    \"Microsoft.Network/networkSecurityGroups/delete\",\n+    \"Microsoft.Network/networkSecurityGroups/join/action\",\n+    \"Microsoft.Network/virtualNetworks/subnets/joinViaServiceEndpoint/action\",\n+    \"Microsoft.Compute/availabilitySets/read\",\n+    \"Microsoft.Compute/availabilitySets/write\",\n+    \"Microsoft.Compute/availabilitySets/delete\",\n+    \"Microsoft.Compute/disks/read\",\n+    \"Microsoft.Compute/disks/write\",\n+    \"Microsoft.Compute/disks/delete\",\n+    \"Microsoft.Compute/images/read\",\n+    \"Microsoft.Compute/images/write\",\n+    \"Microsoft.Compute/images/delete\",\n+    \"Microsoft.Compute/virtualMachines/read\",\n+    \"Microsoft.Compute/virtualMachines/write\",\n+    \"Microsoft.Compute/virtualMachines/delete\",\n+    \"Microsoft.Compute/virtualMachines/start/action\",\n+    \"Microsoft.Compute/virtualMachines/restart/action\",\n+    \"Microsoft.Compute/virtualMachines/deallocate/action\",\n+    \"Microsoft.Compute/virtualMachines/vmSizes/read\",\n+    \"Microsoft.Authorization/roleAssignments/read\",\n+    \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n+    \"Microsoft.Resources/subscriptions/resourceGroups/deployments/read\",\n+    \"Microsoft.Resources/subscriptions/resourceGroups/deployments/write\",\n+    \"Microsoft.Resources/subscriptions/resourcegroups/deployments/operations/read\",\n+    \"Microsoft.Resources/subscriptions/resourcegroups/deployments/operationstatuses/read\",\n+    \"Microsoft.Resources/deployments/read\",\n+    \"Microsoft.Resources/deployments/write\",\n+    \"Microsoft.Resources/deployments/delete\",\n+    \"Microsoft.Resources/deployments/operations/read\",\n+    \"Microsoft.Resources/deployments/operationstatuses/read\",\n+    \"Microsoft.Resources/deployments/exportTemplate/action\",\n+    \"Microsoft.Resources/subscriptions/read\",\n+    \"Microsoft.ManagedIdentity/userAssignedIdentities/write\",\n+    \"Microsoft.ManagedIdentity/userAssignedIdentities/read\",\n+    \"Microsoft.ManagedIdentity/userAssignedIdentities/assign/action\",\n+    \"Microsoft.DBforPostgreSQL/servers/write\",\n+    \"Microsoft.DBforPostgreSQL/servers/delete\",\n+    \"Microsoft.DBforPostgreSQL/servers/virtualNetworkRules/write\"\n+  ],\n+  \"NotActions\": [],\n+  \"DataActions\": [\n+    \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read\",\n+    \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write\",\n+    \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/delete\",\n+    \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/add/action\"\n+  ],\n+  \"NotDataActions\": [],\n+  \"AssignableScopes\": [\n+    \"/subscriptions/{subscriptionId}\"", "originalCommit": "176f0598c26fcb60d09833a010168dc14d97e821", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDEzNDExOA==", "url": "https://github.com/hortonworks/cloudbreak/pull/8279#discussion_r440134118", "bodyText": "Yes, definitely, thank you!", "author": "gergopapi2", "createdAt": "2020-06-15T12:17:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDEyNjE3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDEzODY3Nw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8279#discussion_r440138677", "bodyText": "Hm, but actually I am not sure if we should decrease assignableScope. What if the customer wants to use the same role definition for multiple resource groups? I think the assignableScope can be as wide as possible, whereas the real assignment should be as tight as possible.", "author": "gergopapi2", "createdAt": "2020-06-15T12:26:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDEyNjE3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE4MzI2Ng==", "url": "https://github.com/hortonworks/cloudbreak/pull/8279#discussion_r440183266", "bodyText": "The customers who are asking for single RG feature will most probably scope their credential to have access on RG level, and the AssignableScopes can contain comma-separated list of RG-s", "author": "pdarvasi", "createdAt": "2020-06-15T13:41:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDEyNjE3Ng=="}], "type": "inlineReview"}, {"oid": "7bf684fe1435273d683c3d4fafb963105bbcf777", "url": "https://github.com/hortonworks/cloudbreak/commit/7bf684fe1435273d683c3d4fafb963105bbcf777", "message": "CB-7395 Revise, restrict and POC Azure minimal permission list", "committedDate": "2020-06-24T19:57:20Z", "type": "forcePushed"}, {"oid": "a633f4c68a197c6baa5a716a8aea018e7630a28b", "url": "https://github.com/hortonworks/cloudbreak/commit/a633f4c68a197c6baa5a716a8aea018e7630a28b", "message": "CB-7395 Revise, restrict and POC Azure minimal permission list", "committedDate": "2020-06-24T19:59:30Z", "type": "commit"}, {"oid": "a633f4c68a197c6baa5a716a8aea018e7630a28b", "url": "https://github.com/hortonworks/cloudbreak/commit/a633f4c68a197c6baa5a716a8aea018e7630a28b", "message": "CB-7395 Revise, restrict and POC Azure minimal permission list", "committedDate": "2020-06-24T19:59:30Z", "type": "forcePushed"}]}