{"pr_number": 9308, "pr_title": "CB-9243 AWS PlacementGroup Support", "pr_createdAt": "2020-10-28T07:53:10Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9308", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTUyMg==", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r513391522", "bodyText": "else branch should be great here which maps to none", "author": "doktoric", "createdAt": "2020-10-28T12:08:36Z", "path": "core-api/src/main/java/com/sequenceiq/cloudbreak/api/endpoint/v4/stacks/base/parameter/template/AwsInstanceTemplateV4Parameters.java", "diffHunk": "@@ -99,5 +115,11 @@ public void parse(Map<String, Object> parameters) {\n         if (type != null) {\n             encryption.setType(EncryptionType.valueOf(type));\n         }\n+\n+        String placementGroupStrategy = getParameterOrNull(parameters, AwsInstanceTemplate.PLACEMENT_GROUP_STRATEGY);\n+        if (placementGroupStrategy != null) {", "originalCommit": "dab2ca293760add9f0ba6ea0015f0537482d3497", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDExNjQ1Nw==", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r514116457", "bodyText": "ok", "author": "smaniraju", "createdAt": "2020-10-29T09:27:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTUyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTY5MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r513391690", "bodyText": "if null put none into the map", "author": "doktoric", "createdAt": "2020-10-28T12:08:55Z", "path": "core-api/src/main/java/com/sequenceiq/cloudbreak/api/endpoint/v4/stacks/base/parameter/template/AwsInstanceTemplateV4Parameters.java", "diffHunk": "@@ -60,6 +73,9 @@ public void setEncryption(AwsEncryptionV4Parameters encryption) {\n             putIfValueNotNull(map, InstanceTemplate.VOLUME_ENCRYPTION_KEY_TYPE, encryption.getType());\n             putIfValueNotNull(map, AwsInstanceTemplate.EBS_ENCRYPTION_ENABLED, encryption.getType() != EncryptionType.NONE);\n         }\n+        if (placementGroup != null) {\n+            putIfValueNotNull(map, AwsInstanceTemplate.PLACEMENT_GROUP_STRATEGY, placementGroup.getStrategy().name());\n+        }", "originalCommit": "dab2ca293760add9f0ba6ea0015f0537482d3497", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDExNjIwOQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r514116209", "bodyText": "ok", "author": "smaniraju", "createdAt": "2020-10-29T09:26:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTY5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTkzOQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r513391939", "bodyText": "why we dont put lower in the java code side ?", "author": "doktoric", "createdAt": "2020-10-28T12:09:19Z", "path": "cloud-aws/src/main/resources/templates/aws-cf-stack.ftl", "diffHunk": "@@ -384,6 +387,15 @@\n       }\n     }\n \n+    <#if group.placementGroupStrategy?has_content && group.placementGroupStrategy != \"NONE\">,\n+    \"PlacementGroup${group.groupName?replace('_', '')}\" : {\n+\t  \"Type\" : \"AWS::EC2::PlacementGroup\",\n+      \"Properties\" : {\n+        \"Strategy\" : \"${group.placementGroupStrategy?lower_case}\"", "originalCommit": "dab2ca293760add9f0ba6ea0015f0537482d3497", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDExNTk2Mg==", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r514115962", "bodyText": "ok", "author": "smaniraju", "createdAt": "2020-10-29T09:26:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MTkzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MjIzNw==", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r513392237", "bodyText": "use placementgroupname  here and generate in java code", "author": "doktoric", "createdAt": "2020-10-28T12:09:52Z", "path": "cloud-aws/src/main/resources/templates/aws-cf-stack.ftl", "diffHunk": "@@ -368,6 +368,9 @@\n           </#if>\n           \"InstanceType\"   : \"${group.flavor}\",\n           \"KeyName\"        : { \"Ref\" : \"KeyName\" },\n+          <#if group.placementGroupStrategy?has_content && group.placementGroupStrategy != \"NONE\">\n+          \"Placement\" : { \"GroupName\" : { \"Ref\" : \"PlacementGroup${group.groupName?replace('_', '')}\" } },", "originalCommit": "dab2ca293760add9f0ba6ea0015f0537482d3497", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDEyMTA4OA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9308#discussion_r514121088", "bodyText": "ok", "author": "smaniraju", "createdAt": "2020-10-29T09:34:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM5MjIzNw=="}], "type": "inlineReview"}, {"oid": "1f2600302e5d6e0a6488f73a74922fd75c54e7c3", "url": "https://github.com/hortonworks/cloudbreak/commit/1f2600302e5d6e0a6488f73a74922fd75c54e7c3", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions", "committedDate": "2020-10-29T09:27:58Z", "type": "forcePushed"}, {"oid": "c3156d33997d2a7a4678f5fb3caddcb20cdb5191", "url": "https://github.com/hortonworks/cloudbreak/commit/c3156d33997d2a7a4678f5fb3caddcb20cdb5191", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions", "committedDate": "2020-10-29T10:47:34Z", "type": "forcePushed"}, {"oid": "d4685c1cbdfd5ecc6fd91b86db3a7ae254ce6207", "url": "https://github.com/hortonworks/cloudbreak/commit/d4685c1cbdfd5ecc6fd91b86db3a7ae254ce6207", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions", "committedDate": "2020-10-29T10:58:28Z", "type": "forcePushed"}, {"oid": "feae00a84c34f25460af1e419a83e462b7be96d7", "url": "https://github.com/hortonworks/cloudbreak/commit/feae00a84c34f25460af1e419a83e462b7be96d7", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions", "committedDate": "2020-10-29T11:21:09Z", "type": "commit"}, {"oid": "feae00a84c34f25460af1e419a83e462b7be96d7", "url": "https://github.com/hortonworks/cloudbreak/commit/feae00a84c34f25460af1e419a83e462b7be96d7", "message": "CB-9243 AWS PlacementGroup Support\nPlacement Group Configuration support for AWS Clusters via Cluster Definitions", "committedDate": "2020-10-29T11:21:09Z", "type": "forcePushed"}]}