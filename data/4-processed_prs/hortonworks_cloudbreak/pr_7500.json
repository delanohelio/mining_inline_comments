{"pr_number": 7500, "pr_title": "CB-5556 second attempt at making Sdx Repair internals better, introdu\u2026", "pr_createdAt": "2020-03-06T14:27:22Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/7500", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMTA1OA==", "url": "https://github.com/hortonworks/cloudbreak/pull/7500#discussion_r389301058", "bodyText": "I think this statement shall be in the else clause of the if above, otherwise settings.hostGroupNames might get overwritten (with null or whatever is passed in request.getHostGroupNames()) even if a single host group was to be repaired. Alternatively, the statement can be also moved before the if, whichever approach you prefer. \ud83d\ude04", "author": "lajosrodek", "createdAt": "2020-03-07T18:09:32Z", "path": "datalake/src/main/java/com/sequenceiq/datalake/settings/SdxRepairSettings.java", "diffHunk": "@@ -0,0 +1,36 @@\n+package com.sequenceiq.datalake.settings;\n+\n+import java.util.List;\n+\n+import javax.ws.rs.BadRequestException;\n+\n+import org.apache.commons.collections.CollectionUtils;\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.logging.log4j.util.Strings;\n+\n+import com.sequenceiq.sdx.api.model.SdxRepairRequest;\n+\n+public class SdxRepairSettings {\n+\n+    private List<String> hostGroupNames;\n+\n+    private SdxRepairSettings() {\n+    }\n+\n+    public static SdxRepairSettings from(SdxRepairRequest request) {\n+        if (StringUtils.isNotBlank(request.getHostGroupName()) && CollectionUtils.isNotEmpty(request.getHostGroupNames())) {\n+            throw new BadRequestException(\"Please send only one hostGroupName in the 'hostGroupName' field \" +\n+                    \"or multiple hostGroups in the 'hostGroupNames' fields\");\n+        }\n+        SdxRepairSettings settings = new SdxRepairSettings();\n+        if (Strings.isNotEmpty(request.getHostGroupName())) {\n+            settings.hostGroupNames = List.of(request.getHostGroupName());\n+        }\n+        settings.hostGroupNames = request.getHostGroupNames();", "originalCommit": "504f5a0649bfe5e692c50bd7a4d38c9ae922cabf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTMwMTM3Mg==", "url": "https://github.com/hortonworks/cloudbreak/pull/7500#discussion_r389301372", "bodyText": "Minor: rename repairRequest to repairSettings. Similarly in the other two changes below.", "author": "lajosrodek", "createdAt": "2020-03-07T18:15:09Z", "path": "datalake/src/main/java/com/sequenceiq/datalake/service/sdx/SdxRepairService.java", "diffHunk": "@@ -76,15 +75,15 @@ public FlowIdentifier triggerRepairByName(String userCrn, String clusterName, Sd\n         return sdxReactorFlowManager.triggerSdxRepairFlow(cluster.getId(), clusterRepairRequest);\n     }\n \n-    public void startSdxRepair(Long id, SdxRepairRequest repairRequest) {\n+    public void startSdxRepair(Long id, SdxRepairSettings repairRequest) {", "originalCommit": "504f5a0649bfe5e692c50bd7a4d38c9ae922cabf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "385b8f4a856b7e49071249db02aa6e1f320ee66c", "url": "https://github.com/hortonworks/cloudbreak/commit/385b8f4a856b7e49071249db02aa6e1f320ee66c", "message": "CB-5556 second attempt at making Sdx Repair internals better, introduced RepairSettings, maybe there's a better name for it.", "committedDate": "2020-03-09T11:31:35Z", "type": "commit"}, {"oid": "385b8f4a856b7e49071249db02aa6e1f320ee66c", "url": "https://github.com/hortonworks/cloudbreak/commit/385b8f4a856b7e49071249db02aa6e1f320ee66c", "message": "CB-5556 second attempt at making Sdx Repair internals better, introduced RepairSettings, maybe there's a better name for it.", "committedDate": "2020-03-09T11:31:35Z", "type": "forcePushed"}]}