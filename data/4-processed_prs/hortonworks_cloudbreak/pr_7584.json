{"pr_number": 7584, "pr_title": "CDPCP-1533. Add operations to usersyncstatus", "pr_createdAt": "2020-03-13T17:06:54Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/7584", "timeline": [{"oid": "3c7e0fd96ad187900a790f676354f7c6db785258", "url": "https://github.com/hortonworks/cloudbreak/commit/3c7e0fd96ad187900a790f676354f7c6db785258", "message": "CDPCP-1533. Add operations to usersyncstatus\n\nFirst part to the rolling update of the freeipa database schema\nfor tracking user sync status.\n\nThis commit adds the requested and successful operations to the\nusersync status. The new lastrequestedoperation field is preferred\nbut lastsyncstarttime field is still used as a\nfallback when calculating whether a stack is \"cool\" for the purposes\nof automatic user sync polling.", "committedDate": "2020-03-13T17:33:33Z", "type": "forcePushed"}, {"oid": "b3243b75295f3565b90c25fe0d2ced73f3969719", "url": "https://github.com/hortonworks/cloudbreak/commit/b3243b75295f3565b90c25fe0d2ced73f3969719", "message": "CDPCP-1533. Add operations to usersyncstatus\n\nFirst part to the rolling update of the freeipa database schema\nfor tracking user sync status.\n\nThis commit adds the requested and successful operations to the\nusersync status. The new lastrequestedoperation field is preferred\nbut lastsyncstarttime field is still used as a\nfallback when calculating whether a stack is \"cool\" for the purposes\nof automatic user sync polling.", "committedDate": "2020-03-23T15:55:04Z", "type": "forcePushed"}, {"oid": "b423ab55ebfe2b8f46db81c3785f0f8f55dec50c", "url": "https://github.com/hortonworks/cloudbreak/commit/b423ab55ebfe2b8f46db81c3785f0f8f55dec50c", "message": "CDPCP-1533. Add operations to usersyncstatus\n\nFirst part to the rolling update of the freeipa database schema\nfor tracking user sync status.\n\nThis commit adds the requested and successful operations to the\nusersync status. The new lastrequestedoperation field is preferred\nbut lastsyncstarttime field is still used as a\nfallback when calculating whether a stack is \"cool\" for the purposes\nof automatic user sync polling.", "committedDate": "2020-03-26T17:37:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkwNjU2OA==", "url": "https://github.com/hortonworks/cloudbreak/pull/7584#discussion_r398906568", "bodyText": "so this does not get updated when a request is rejected because there is an ongoing user sync right?", "author": "giladwolff", "createdAt": "2020-03-26T21:34:08Z", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/entity/UserSyncStatus.java", "diffHunk": "@@ -32,6 +32,12 @@\n \n     private Long lastFullSyncEndTime;\n \n+    @OneToOne\n+    private Operation lastRequestedFullSync;", "originalCommit": "b423ab55ebfe2b8f46db81c3785f0f8f55dec50c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkwNzg4MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/7584#discussion_r398907881", "bodyText": "So the idea is that this holds the last successful operation and the lastRequestedFullSync holds the last full sync? Maybe rename it to reflect that (drop the requested?)", "author": "giladwolff", "createdAt": "2020-03-26T21:36:57Z", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/entity/UserSyncStatus.java", "diffHunk": "@@ -32,6 +32,12 @@\n \n     private Long lastFullSyncEndTime;\n \n+    @OneToOne\n+    private Operation lastRequestedFullSync;\n+\n+    @OneToOne\n+    private Operation lastSuccessfulFullSync;", "originalCommit": "b423ab55ebfe2b8f46db81c3785f0f8f55dec50c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkwODA4Ng==", "url": "https://github.com/hortonworks/cloudbreak/pull/7584#discussion_r398908086", "bodyText": "javadoc", "author": "giladwolff", "createdAt": "2020-03-26T21:37:24Z", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/entity/UserSyncStatus.java", "diffHunk": "@@ -63,22 +69,58 @@ public void setUmsEventGenerationIds(Json umsEventGenerationIds) {\n         this.umsEventGenerationIds = umsEventGenerationIds;\n     }\n \n+    /**\n+     * Gets the last full sync start time.\n+     * @deprecated information returned is redundant with {@link #getLastRequestedFullSync()}\n+     */\n+    @Deprecated\n     public Long getLastFullSyncStartTime() {\n         return lastFullSyncStartTime;\n     }\n \n+    /**\n+     * Sets the last full sync start time.\n+     * @deprecated information set is redundant with {@link #setLastRequestedFullSync(Operation)}\n+     */\n+    @Deprecated\n     public void setLastFullSyncStartTime(Long lastFullSyncStartTime) {\n         this.lastFullSyncStartTime = lastFullSyncStartTime;\n     }\n \n+    /**\n+     * Sets the last full sync end time.\n+     * @deprecated information returned is redundant with {@link #getLastSuccessfulFullSync()}\n+     */\n+    @Deprecated\n     public Long getLastFullSyncEndTime() {\n         return lastFullSyncEndTime;\n     }\n \n+    /**\n+     * Sets the last full sync end time.\n+     * @deprecated information set is redundant with {@link #setLastSuccessfulFullSync(Operation)}\n+     */\n+    @Deprecated\n     public void setLastFullSyncEndTime(Long lastFullSyncEndTime) {\n         this.lastFullSyncEndTime = lastFullSyncEndTime;\n     }\n \n+    public Operation getLastRequestedFullSync() {", "originalCommit": "b423ab55ebfe2b8f46db81c3785f0f8f55dec50c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkwODI5Mg==", "url": "https://github.com/hortonworks/cloudbreak/pull/7584#discussion_r398908292", "bodyText": "javadoc", "author": "giladwolff", "createdAt": "2020-03-26T21:37:44Z", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/entity/UserSyncStatus.java", "diffHunk": "@@ -63,22 +69,58 @@ public void setUmsEventGenerationIds(Json umsEventGenerationIds) {\n         this.umsEventGenerationIds = umsEventGenerationIds;\n     }\n \n+    /**\n+     * Gets the last full sync start time.\n+     * @deprecated information returned is redundant with {@link #getLastRequestedFullSync()}\n+     */\n+    @Deprecated\n     public Long getLastFullSyncStartTime() {\n         return lastFullSyncStartTime;\n     }\n \n+    /**\n+     * Sets the last full sync start time.\n+     * @deprecated information set is redundant with {@link #setLastRequestedFullSync(Operation)}\n+     */\n+    @Deprecated\n     public void setLastFullSyncStartTime(Long lastFullSyncStartTime) {\n         this.lastFullSyncStartTime = lastFullSyncStartTime;\n     }\n \n+    /**\n+     * Sets the last full sync end time.\n+     * @deprecated information returned is redundant with {@link #getLastSuccessfulFullSync()}\n+     */\n+    @Deprecated\n     public Long getLastFullSyncEndTime() {\n         return lastFullSyncEndTime;\n     }\n \n+    /**\n+     * Sets the last full sync end time.\n+     * @deprecated information set is redundant with {@link #setLastSuccessfulFullSync(Operation)}\n+     */\n+    @Deprecated\n     public void setLastFullSyncEndTime(Long lastFullSyncEndTime) {\n         this.lastFullSyncEndTime = lastFullSyncEndTime;\n     }\n \n+    public Operation getLastRequestedFullSync() {\n+        return lastRequestedFullSync;\n+    }\n+\n+    public void setLastRequestedFullSync(Operation lastRequestedFullSync) {", "originalCommit": "b423ab55ebfe2b8f46db81c3785f0f8f55dec50c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkwODM1NA==", "url": "https://github.com/hortonworks/cloudbreak/pull/7584#discussion_r398908354", "bodyText": "javadoc", "author": "giladwolff", "createdAt": "2020-03-26T21:37:51Z", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/entity/UserSyncStatus.java", "diffHunk": "@@ -63,22 +69,58 @@ public void setUmsEventGenerationIds(Json umsEventGenerationIds) {\n         this.umsEventGenerationIds = umsEventGenerationIds;\n     }\n \n+    /**\n+     * Gets the last full sync start time.\n+     * @deprecated information returned is redundant with {@link #getLastRequestedFullSync()}\n+     */\n+    @Deprecated\n     public Long getLastFullSyncStartTime() {\n         return lastFullSyncStartTime;\n     }\n \n+    /**\n+     * Sets the last full sync start time.\n+     * @deprecated information set is redundant with {@link #setLastRequestedFullSync(Operation)}\n+     */\n+    @Deprecated\n     public void setLastFullSyncStartTime(Long lastFullSyncStartTime) {\n         this.lastFullSyncStartTime = lastFullSyncStartTime;\n     }\n \n+    /**\n+     * Sets the last full sync end time.\n+     * @deprecated information returned is redundant with {@link #getLastSuccessfulFullSync()}\n+     */\n+    @Deprecated\n     public Long getLastFullSyncEndTime() {\n         return lastFullSyncEndTime;\n     }\n \n+    /**\n+     * Sets the last full sync end time.\n+     * @deprecated information set is redundant with {@link #setLastSuccessfulFullSync(Operation)}\n+     */\n+    @Deprecated\n     public void setLastFullSyncEndTime(Long lastFullSyncEndTime) {\n         this.lastFullSyncEndTime = lastFullSyncEndTime;\n     }\n \n+    public Operation getLastRequestedFullSync() {\n+        return lastRequestedFullSync;\n+    }\n+\n+    public void setLastRequestedFullSync(Operation lastRequestedFullSync) {\n+        this.lastRequestedFullSync = lastRequestedFullSync;\n+    }\n+\n+    public Operation getLastSuccessfulFullSync() {", "originalCommit": "b423ab55ebfe2b8f46db81c3785f0f8f55dec50c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkwODM5Nw==", "url": "https://github.com/hortonworks/cloudbreak/pull/7584#discussion_r398908397", "bodyText": "javadoc", "author": "giladwolff", "createdAt": "2020-03-26T21:37:59Z", "path": "freeipa/src/main/java/com/sequenceiq/freeipa/entity/UserSyncStatus.java", "diffHunk": "@@ -63,22 +69,58 @@ public void setUmsEventGenerationIds(Json umsEventGenerationIds) {\n         this.umsEventGenerationIds = umsEventGenerationIds;\n     }\n \n+    /**\n+     * Gets the last full sync start time.\n+     * @deprecated information returned is redundant with {@link #getLastRequestedFullSync()}\n+     */\n+    @Deprecated\n     public Long getLastFullSyncStartTime() {\n         return lastFullSyncStartTime;\n     }\n \n+    /**\n+     * Sets the last full sync start time.\n+     * @deprecated information set is redundant with {@link #setLastRequestedFullSync(Operation)}\n+     */\n+    @Deprecated\n     public void setLastFullSyncStartTime(Long lastFullSyncStartTime) {\n         this.lastFullSyncStartTime = lastFullSyncStartTime;\n     }\n \n+    /**\n+     * Sets the last full sync end time.\n+     * @deprecated information returned is redundant with {@link #getLastSuccessfulFullSync()}\n+     */\n+    @Deprecated\n     public Long getLastFullSyncEndTime() {\n         return lastFullSyncEndTime;\n     }\n \n+    /**\n+     * Sets the last full sync end time.\n+     * @deprecated information set is redundant with {@link #setLastSuccessfulFullSync(Operation)}\n+     */\n+    @Deprecated\n     public void setLastFullSyncEndTime(Long lastFullSyncEndTime) {\n         this.lastFullSyncEndTime = lastFullSyncEndTime;\n     }\n \n+    public Operation getLastRequestedFullSync() {\n+        return lastRequestedFullSync;\n+    }\n+\n+    public void setLastRequestedFullSync(Operation lastRequestedFullSync) {\n+        this.lastRequestedFullSync = lastRequestedFullSync;\n+    }\n+\n+    public Operation getLastSuccessfulFullSync() {\n+        return lastSuccessfulFullSync;\n+    }\n+\n+    public void setLastSuccessfulFullSync(Operation lastSuccessfulFullSync) {", "originalCommit": "b423ab55ebfe2b8f46db81c3785f0f8f55dec50c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "312829a0df5fcf458f55dad6f52078fb3639a693", "url": "https://github.com/hortonworks/cloudbreak/commit/312829a0df5fcf458f55dad6f52078fb3639a693", "message": "CDPCP-1533. Add operations to usersyncstatus\n\nFirst part to the rolling update of the freeipa database schema\nfor tracking user sync status.\n\nThis commit adds the requested and successful operations to the\nusersync status. The new lastrequestedoperation field is preferred\nbut lastsyncstarttime field is still used as a\nfallback when calculating whether a stack is \"cool\" for the purposes\nof automatic user sync polling.", "committedDate": "2020-03-27T17:30:47Z", "type": "forcePushed"}, {"oid": "0d3e026ef518e168869795e4ea77a7e54228b234", "url": "https://github.com/hortonworks/cloudbreak/commit/0d3e026ef518e168869795e4ea77a7e54228b234", "message": "CDPCP-1533. Add operations to usersyncstatus\n\nFirst part to the rolling update of the freeipa database schema\nfor tracking user sync status.\n\nThis commit adds the requested and successful operations to the\nusersync status. The new lastrequestedoperation field is preferred\nbut lastsyncstarttime field is still used as a\nfallback when calculating whether a stack is \"cool\" for the purposes\nof automatic user sync polling.", "committedDate": "2020-03-27T18:48:08Z", "type": "commit"}, {"oid": "0d3e026ef518e168869795e4ea77a7e54228b234", "url": "https://github.com/hortonworks/cloudbreak/commit/0d3e026ef518e168869795e4ea77a7e54228b234", "message": "CDPCP-1533. Add operations to usersyncstatus\n\nFirst part to the rolling update of the freeipa database schema\nfor tracking user sync status.\n\nThis commit adds the requested and successful operations to the\nusersync status. The new lastrequestedoperation field is preferred\nbut lastsyncstarttime field is still used as a\nfallback when calculating whether a stack is \"cool\" for the purposes\nof automatic user sync polling.", "committedDate": "2020-03-27T18:48:08Z", "type": "forcePushed"}]}