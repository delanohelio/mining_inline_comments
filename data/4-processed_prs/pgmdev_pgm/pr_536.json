{"pr_number": 536, "pr_title": "Fix a few text related issues", "pr_createdAt": "2020-06-14T08:20:30Z", "pr_url": "https://github.com/PGMDev/PGM/pull/536", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg0NTgzOA==", "url": "https://github.com/PGMDev/PGM/pull/536#discussion_r439845838", "bodyText": "We should be caching the Componet name. Instead, listen to the team rename event and change it.", "author": "Electroid", "createdAt": "2020-06-14T16:23:31Z", "path": "core/src/main/java/tc/oc/pgm/teams/Team.java", "diffHunk": "@@ -37,8 +37,6 @@\n   private TeamMatchModule tmm;\n   private JoinMatchModule jmm;\n   protected @Nullable String name = null;\n-  protected @Nullable Component componentName;", "originalCommit": "1ef9d118e2f18b2b064cfc6447da770ea28844eb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1Mzk2Mg==", "url": "https://github.com/PGMDev/PGM/pull/536#discussion_r439853962", "bodyText": "I think we need to clean up this code. Maybe separate methods for each NameStyle?", "author": "Electroid", "createdAt": "2020-06-14T18:03:48Z", "path": "util/src/main/java/tc/oc/pgm/util/text/types/PlayerComponent.java", "diffHunk": "@@ -38,32 +38,49 @@ static Component of(@Nullable Player player, String defName, NameStyle style) {\n       return component.build();\n     }\n \n-    Component usernameComponent;\n+    // For name styles that don't allow vanished, make vanished appear offline\n+    if (!style.showVanish && isVanished(player)) {", "originalCommit": "1ef9d118e2f18b2b064cfc6447da770ea28844eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1NDIzNw==", "url": "https://github.com/PGMDev/PGM/pull/536#discussion_r439854237", "bodyText": "I agree, with the previous refactor I tried to keep it similar to the old PersonalizedPlayer class, but imo would be better to separate into different methods as you suggested \ud83d\udc4d\nI\u2019ll take care of this in a bit.", "author": "applenick", "createdAt": "2020-06-14T18:07:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1Mzk2Mg=="}], "type": "inlineReview"}, {"oid": "c8c46a2513789080b3c174b99651c4c56aa1eed5", "url": "https://github.com/PGMDev/PGM/commit/c8c46a2513789080b3c174b99651c4c56aa1eed5", "message": "Fix a few text related issues\nIncludes:\n* Vanished mapmakers are no longer exposed via various map info locations\n* Fixes issue related to names not rendering decorations (death message bug)\n* Resolve team chat prefix not using proper aliased name\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-15T05:45:55Z", "type": "commit"}, {"oid": "1416dd88611a66872841345e0fe9d26762ee8aa2", "url": "https://github.com/PGMDev/PGM/commit/1416dd88611a66872841345e0fe9d26762ee8aa2", "message": "Add back caching of team name component & prefix\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-15T05:45:56Z", "type": "commit"}, {"oid": "0ca682c2f2cc629d2149daf25515e42f97173c48", "url": "https://github.com/PGMDev/PGM/commit/0ca682c2f2cc629d2149daf25515e42f97173c48", "message": "Clean up NameStyle and PlayerComponent\n* Removed unused style attributes from NameStyle\n* Split up logic for PlayerComponent formatting\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-15T05:45:56Z", "type": "commit"}, {"oid": "0ca682c2f2cc629d2149daf25515e42f97173c48", "url": "https://github.com/PGMDev/PGM/commit/0ca682c2f2cc629d2149daf25515e42f97173c48", "message": "Clean up NameStyle and PlayerComponent\n* Removed unused style attributes from NameStyle\n* Split up logic for PlayerComponent formatting\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-15T05:45:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE1NzA0Ng==", "url": "https://github.com/PGMDev/PGM/pull/536#discussion_r440157046", "bodyText": "Make all of these functions return Component.Builder to avoid copying Components among the methods. In PlayerComponent.of you can build it before returning it.", "author": "Electroid", "createdAt": "2020-06-15T12:59:14Z", "path": "util/src/main/java/tc/oc/pgm/util/text/types/PlayerComponent.java", "diffHunk": "@@ -81,6 +68,109 @@ static Component of(CommandSender sender, NameStyle style) {\n         : TranslatableComponent.of(\"misc.console\", TextColor.DARK_AQUA);\n   }\n \n+  // What an offline or vanished username renders as\n+  static Component formatOffline(String name, boolean plain) {", "originalCommit": "0ca682c2f2cc629d2149daf25515e42f97173c48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM4NzEyMg==", "url": "https://github.com/PGMDev/PGM/pull/536#discussion_r440387122", "bodyText": "Ah better idea! I\u2019ll fix this up \ud83d\udc4d", "author": "applenick", "createdAt": "2020-06-15T19:07:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE1NzA0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ3NjM2NA==", "url": "https://github.com/PGMDev/PGM/pull/536#discussion_r440476364", "bodyText": "I believe you meant TextComponent.Builder, but it\u2019s all cleaned up now \ud83d\udc4d", "author": "applenick", "createdAt": "2020-06-15T22:13:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDE1NzA0Ng=="}], "type": "inlineReview"}, {"oid": "0f27532ce48ae3d6f7a8c6c368eb57b41b4a00af", "url": "https://github.com/PGMDev/PGM/commit/0f27532ce48ae3d6f7a8c6c368eb57b41b4a00af", "message": "Use component builders in PlayerComponent\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-15T22:10:34Z", "type": "commit"}, {"oid": "7b2e5c2e03275859e01dcb1ebe4d2880f11e1d5a", "url": "https://github.com/PGMDev/PGM/commit/7b2e5c2e03275859e01dcb1ebe4d2880f11e1d5a", "message": "Remove lombok\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-15T23:10:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3MjM3Nw==", "url": "https://github.com/PGMDev/PGM/pull/536#discussion_r440272377", "bodyText": "Why remove this?", "author": "KingOfSquares", "createdAt": "2020-06-15T15:46:35Z", "path": "util/src/main/java/tc/oc/pgm/util/named/NameStyle.java", "diffHunk": "@@ -5,43 +5,27 @@\n  * only by context, and is independent of the viewer.\n  */\n public enum NameStyle {\n-  PLAIN(false, false, false, false, false, false, false, false, false), // No formatting\n-  COLOR(true, false, false, false, false, false, false, true, false), // Color only\n-  FANCY(\n-      true, true, true, true, true, false, false, true,\n-      false), // Color, flair, friend status, nick status, vanish status\n-  TAB(\n-      true, true, true, true, true, false, true, true,\n-      true), // Color, flair, friend status, nick status, death status, and vanish status\n-  VERBOSE(true, true, true, true, true, true, false, true, true), // Fancy plus nickname\n-  CONCISE(true, true, true, true, true, true, false, false, true); // Verbose, but removes teleport\n+  PLAIN(false, false, false, false, false), // No formatting\n+  COLOR(true, false, false, true, false), // Color and teleport\n+  FANCY(true, true, false, true, false), // Color, flair, and teleport\n+  TAB(true, true, true, false, true), // Color, flair, death status, and vanish\n+  VERBOSE(true, true, false, true, true), // Color, flair, teleport, and vanish\n+  CONCISE(true, true, false, false, true); // Color, flair, and vanish\n \n   public final boolean isColor;\n   public final boolean showPrefix;\n-  public final boolean showSelf; // Bold if self", "originalCommit": "0ca682c2f2cc629d2149daf25515e42f97173c48", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}