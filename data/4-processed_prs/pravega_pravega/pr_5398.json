{"pr_number": 5398, "pr_title": "Issue 5382: Adding Java cacerts to openjdk:11.0.8-jre-slim Base Image", "pr_createdAt": "2020-12-03T08:28:35Z", "pr_url": "https://github.com/pravega/pravega/pull/5398", "timeline": [{"oid": "638d720eb4cafec7f4305b8638dfad7159b3f2e7", "url": "https://github.com/pravega/pravega/commit/638d720eb4cafec7f4305b8638dfad7159b3f2e7", "message": "adding ca-certificate on top of jre\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>", "committedDate": "2020-12-02T16:51:45Z", "type": "commit"}, {"oid": "7645bb013a833ea6da74e7404d5e9f0813615aeb", "url": "https://github.com/pravega/pravega/commit/7645bb013a833ea6da74e7404d5e9f0813615aeb", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-12-03T06:49:11Z", "type": "commit"}, {"oid": "88e9d3d8348bac64730541504c4eef78e450500a", "url": "https://github.com/pravega/pravega/commit/88e9d3d8348bac64730541504c4eef78e450500a", "message": "added certs on top of the jre image\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>", "committedDate": "2020-12-03T08:19:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDkyMzQxOA==", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r534923418", "bodyText": "Please bring mkdir -p /usr/share/man/man1 to a line before rest of the CA certificates change so that the commands are collocated by functionality.\nAlso, it is not intuitive why this change is needed. Could you please add a comment that explains it?", "author": "ravisharda", "createdAt": "2020-12-03T08:35:58Z", "path": "docker/pravega/Dockerfile", "diffHunk": "@@ -9,14 +9,16 @@\n #\n FROM openjdk:11.0.8-jre-slim\n \n-RUN apt-get update && apt-get install -y -q \\\n+RUN mkdir -p /usr/share/man/man1 && apt-get update && apt-get install -y -q \\", "originalCommit": "88e9d3d8348bac64730541504c4eef78e450500a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTA1NTE0OQ==", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r535055149", "bodyText": "Done.", "author": "Prabhaker24", "createdAt": "2020-12-03T10:16:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDkyMzQxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTA2NjE1OQ==", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r535066159", "bodyText": "Agree with @ravisharda, it is unclear why we need /usr/share/man/man1.", "author": "RaulGracia", "createdAt": "2020-12-03T10:26:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDkyMzQxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEyMzU3OQ==", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r535123579", "bodyText": "I have added comments explaining the inclusion of /usr/share/man/man1.", "author": "Prabhaker24", "createdAt": "2020-12-03T11:19:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDkyMzQxOA=="}], "type": "inlineReview"}, {"oid": "8334f5a88ecdb0d67c005f828b7f1e75c90f58bd", "url": "https://github.com/pravega/pravega/commit/8334f5a88ecdb0d67c005f828b7f1e75c90f58bd", "message": "changed the structure and added comments\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>", "committedDate": "2020-12-03T10:16:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTA2MDg2Mw==", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r535060863", "bodyText": "Nit:\n\nAddidng -> Adding.\nA more useful comment'd be one that explains why you are adding it. Such as \"Adding Java system truststore 'cacerts', as it is missing from the Java distribution installed by the base image, and one of the bindings (ECS) expects it to be there when TLS is enabled. \".\nAlso, explain why mkdir -p /usr/share/man/man1 is needed, as it's need is not intuitive.", "author": "ravisharda", "createdAt": "2020-12-03T10:21:33Z", "path": "docker/pravega/Dockerfile", "diffHunk": "@@ -16,7 +16,11 @@ RUN apt-get update && apt-get install -y -q \\\n     jq \\\n     curl \\\n     net-tools \\\n-    iproute2  \\\n+    iproute2\n+\n+# Addidng ca-certificates to the base image", "originalCommit": "8334f5a88ecdb0d67c005f828b7f1e75c90f58bd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a0208d869d68b10bb9cb8389b9a20bf4ad448f4d", "url": "https://github.com/pravega/pravega/commit/a0208d869d68b10bb9cb8389b9a20bf4ad448f4d", "message": "aded comments\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>", "committedDate": "2020-12-03T11:17:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEyNzgzNg==", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r535127836", "bodyText": "I'm not sure that referring to SO is the best approach here. Could we just summarize the reason in 1 or 2 lines?", "author": "RaulGracia", "createdAt": "2020-12-03T11:23:21Z", "path": "docker/pravega/Dockerfile", "diffHunk": "@@ -16,7 +16,16 @@ RUN apt-get update && apt-get install -y -q \\\n     jq \\\n     curl \\\n     net-tools \\\n-    iproute2  \\\n+    iproute2\n+\n+# Adding Java system truststore 'cacerts', as it is missing from the Java\n+# distribution installed by the base image and one of the storage bindings(ECS)\n+# depends on its presence.\n+#\n+# Without `mkdir -p /usr/share/man/man1` we hit the issue mentioned in:\n+# https://stackoverflow.com/questions/58160597/docker-fails-with-sub-process-usr-bin-dpkg-returned-an-error-code-1", "originalCommit": "a0208d869d68b10bb9cb8389b9a20bf4ad448f4d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTE1NTYwOA==", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r535155608", "bodyText": "Removed the SO link and added comments.", "author": "Prabhaker24", "createdAt": "2020-12-03T11:51:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEyNzgzNg=="}], "type": "inlineReview"}, {"oid": "b7cc09495335102bc6aa061c1217c15eecb358e2", "url": "https://github.com/pravega/pravega/commit/b7cc09495335102bc6aa061c1217c15eecb358e2", "message": "changed comment\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>", "committedDate": "2020-12-03T11:49:52Z", "type": "commit"}, {"oid": "1e6b46e3c04aa4feae1973ae61ef5a1f9fa97009", "url": "https://github.com/pravega/pravega/commit/1e6b46e3c04aa4feae1973ae61ef5a1f9fa97009", "message": "changed location of certs in common.sh file\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>", "committedDate": "2020-12-03T15:05:53Z", "type": "commit"}, {"oid": "d365a1554afb63b9e184edc38b85a9d7098f3c09", "url": "https://github.com/pravega/pravega/commit/d365a1554afb63b9e184edc38b85a9d7098f3c09", "message": "Merge branch 'master' into Issue-5382-Adding-certs-to-jdk11", "committedDate": "2020-12-04T01:02:31Z", "type": "commit"}]}