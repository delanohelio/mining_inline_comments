{"pr_number": 5121, "pr_title": "Issue 5082: Initial Java 11 Migration", "pr_createdAt": "2020-08-29T08:27:02Z", "pr_url": "https://github.com/pravega/pravega/pull/5121", "timeline": [{"oid": "08601afd11463bf700a6d0af3f33dcb53f935e09", "url": "https://github.com/pravega/pravega/commit/08601afd11463bf700a6d0af3f33dcb53f935e09", "message": "Update K8 client APIs to use their 5.0.0 counterparts.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-02-21T00:13:24Z", "type": "commit"}, {"oid": "25a165d0293c34ee8703fff764e55cf8fda413dd", "url": "https://github.com/pravega/pravega/commit/25a165d0293c34ee8703fff764e55cf8fda413dd", "message": "Merge pull request #1 from co-jo/issue-4464-update-kubernetes-client-version\n\nIssue 4464 update kubernetes client version", "committedDate": "2020-02-21T18:42:03Z", "type": "commit"}, {"oid": "8cc2dd2be26feed2953258ff055c1657aeb57019", "url": "https://github.com/pravega/pravega/commit/8cc2dd2be26feed2953258ff055c1657aeb57019", "message": "Run system tests using alternative flag value.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-02-23T04:43:09Z", "type": "commit"}, {"oid": "c3fcbd2e627f9fc0a0f6bad7e42667db4439e092", "url": "https://github.com/pravega/pravega/commit/c3fcbd2e627f9fc0a0f6bad7e42667db4439e092", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-03-10T22:21:32Z", "type": "commit"}, {"oid": "f5f808cc42831892aeb8e7824c22d499a1f9fa03", "url": "https://github.com/pravega/pravega/commit/f5f808cc42831892aeb8e7824c22d499a1f9fa03", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-03-18T18:44:10Z", "type": "commit"}, {"oid": "7901435dc1127bed1c46845bbaf8024477e2078f", "url": "https://github.com/pravega/pravega/commit/7901435dc1127bed1c46845bbaf8024477e2078f", "message": "Merge branch 'master' of https://github.com/pravega/pravega\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-04-02T18:49:59Z", "type": "commit"}, {"oid": "d59b3e33f6d5bd90264753caadcea7ed7bbfe06c", "url": "https://github.com/pravega/pravega/commit/d59b3e33f6d5bd90264753caadcea7ed7bbfe06c", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-04-16T20:22:05Z", "type": "commit"}, {"oid": "aa090cad1d88812f2a88e9debacdb04df585adbf", "url": "https://github.com/pravega/pravega/commit/aa090cad1d88812f2a88e9debacdb04df585adbf", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-04-18T20:15:50Z", "type": "commit"}, {"oid": "e328bcb38239fdc32f866980ee1103c93dff522d", "url": "https://github.com/pravega/pravega/commit/e328bcb38239fdc32f866980ee1103c93dff522d", "message": "Merge branch 'master' of https://github.com/co-jo/pravega", "committedDate": "2020-05-11T22:25:21Z", "type": "commit"}, {"oid": "cd02180986f49a42002c7fd2ef28885d1f701af9", "url": "https://github.com/pravega/pravega/commit/cd02180986f49a42002c7fd2ef28885d1f701af9", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-05-11T22:25:27Z", "type": "commit"}, {"oid": "1408d7527ec73f1645418df04aea4aa1120b39e7", "url": "https://github.com/pravega/pravega/commit/1408d7527ec73f1645418df04aea4aa1120b39e7", "message": "Merge branch 'master' of https://github.com/co-jo/pravega", "committedDate": "2020-05-18T20:48:16Z", "type": "commit"}, {"oid": "e2719517850f39bce3e5f2c92f04c8c24122a520", "url": "https://github.com/pravega/pravega/commit/e2719517850f39bce3e5f2c92f04c8c24122a520", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-05-20T18:59:36Z", "type": "commit"}, {"oid": "b1d3648dd2c28a161dab520a48bf4bf657f9d14d", "url": "https://github.com/pravega/pravega/commit/b1d3648dd2c28a161dab520a48bf4bf657f9d14d", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-06-15T18:43:02Z", "type": "commit"}, {"oid": "b3a8b73b2904f91d0d59e27eaace82bcc1870b5c", "url": "https://github.com/pravega/pravega/commit/b3a8b73b2904f91d0d59e27eaace82bcc1870b5c", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-08-04T21:19:13Z", "type": "commit"}, {"oid": "b02240ab9a8e6d7d645ffdd020f9b43854c89920", "url": "https://github.com/pravega/pravega/commit/b02240ab9a8e6d7d645ffdd020f9b43854c89920", "message": "Merge branch 'master' of https://github.com/pravega/pravega into segmentstore-java-11-migration", "committedDate": "2020-08-17T18:24:07Z", "type": "commit"}, {"oid": "544e4900580d40e7832fff1e6ba2457c736c885d", "url": "https://github.com/pravega/pravega/commit/544e4900580d40e7832fff1e6ba2457c736c885d", "message": "* Initial version configuration.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-17T19:23:27Z", "type": "commit"}, {"oid": "58fa2ad355423360c85be49c39c88a8c6e1548bf", "url": "https://github.com/pravega/pravega/commit/58fa2ad355423360c85be49c39c88a8c6e1548bf", "message": "* Update gradle and add compiler options to dependencies of 'common'.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-18T22:34:38Z", "type": "commit"}, {"oid": "7ca394be056e05b75b9ecc075c717ef0b8afb67f", "url": "https://github.com/pravega/pravega/commit/7ca394be056e05b75b9ecc075c717ef0b8afb67f", "message": "* Update Spotbugs (picked from Tom's repo).\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-19T17:49:58Z", "type": "commit"}, {"oid": "b71b7ac1678c7cff6485a6a8c57b4d11d72e7e11", "url": "https://github.com/pravega/pravega/commit/b71b7ac1678c7cff6485a6a8c57b4d11d72e7e11", "message": "* Update Lombok version.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-26T23:19:48Z", "type": "commit"}, {"oid": "e8aa9bffce20c8ff1f7d3996e8be42dfd1d295f6", "url": "https://github.com/pravega/pravega/commit/e8aa9bffce20c8ff1f7d3996e8be42dfd1d295f6", "message": "* Update TravisCI JDK.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-27T18:56:44Z", "type": "commit"}, {"oid": "fb62760263a14823fba220a91034bc89c74cf091", "url": "https://github.com/pravega/pravega/commit/fb62760263a14823fba220a91034bc89c74cf091", "message": "* Suppress SpotBugs warning.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-27T21:03:01Z", "type": "commit"}, {"oid": "b32ce63f62a3a96f0a09cc5d4d75db0475a89a8e", "url": "https://github.com/pravega/pravega/commit/b32ce63f62a3a96f0a09cc5d4d75db0475a89a8e", "message": "* Add package to suppress SpotBug warning to allowed packages file.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-27T22:52:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyNjAwMQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r479626001", "bodyText": "The client must run well also on jdk8 how can we test it?", "author": "eolivelli", "createdAt": "2020-08-29T08:33:23Z", "path": ".travis.yml", "diffHunk": "@@ -12,7 +12,7 @@ git:\n language: java\n install: true\n jdk:\n- - openjdk8\n+ - openjdk11", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjIwODI0Mw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482208243", "bodyText": "Can you clarify a little bit? Would relying on the unit/integration tests be insufficient?", "author": "co-jo", "createdAt": "2020-09-02T16:35:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyNjAwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjIzOTg1Mw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482239853", "bodyText": "I can't see here where we are testing with jdk8", "author": "eolivelli", "createdAt": "2020-09-02T17:21:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyNjAwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQzNTk3Mw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482435973", "bodyText": "I believe we can set the -source and -target javac flags for the client which should preserve compatibility,", "author": "tkaitchuck", "createdAt": "2020-09-02T20:41:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyNjAwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzEzMTUzNw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483131537", "bodyText": "I have kept all the system test pod defaults as is, so we can still rely on running those for some level of verification. I'm not sure if there is a standard convention (for the variable name) but now if a user has a JAVA_8 env variable defined, it will attempt to run the unit tests using the executable that JAVA_8 points to.", "author": "co-jo", "createdAt": "2020-09-03T17:09:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyNjAwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMzE0MQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483413141", "bodyText": "@tkaitchuck  The best way is to set \"-release 8\" (as it is the current approach), otherwise javac will pick wrong overloaded versions in newer JDKs.", "author": "eolivelli", "createdAt": "2020-09-04T06:27:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTYyNjAwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQyOTI5Ng==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r481429296", "bodyText": "can a build property be defined to control what Java version to use for Client and its dependencies? This is for the case if someone wants to checkout the code and build everything using JDK11. Currently there is a need to make edits in multiple places in biuild.gradle. It would be a much better experience if there will be a single property that controls it.", "author": "medvedevigorek", "createdAt": "2020-09-01T21:02:12Z", "path": "build.gradle", "diffHunk": "@@ -150,6 +142,10 @@ project('common') {\n         //Do NOT add any additional dependencies here.\n     }\n \n+    tasks.withType(JavaCompile) {\n+        options.compilerArgs.addAll(['--release', '8'])", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQzNTYwNA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r481435604", "bodyText": "I looked into that, but couldn't find any sort of function/option that can programmatically apply some config to dependent tasks. The best we can do is have some sort of flag and a check in each of these task.withType(JavaCompile) blocks.", "author": "co-jo", "createdAt": "2020-09-01T21:14:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQyOTI5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ2MTg1Mg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r481461852", "bodyText": "That should work. As long as there is one place to turn Java11 on for Client and its dependencies - it's good enough", "author": "medvedevigorek", "createdAt": "2020-09-01T22:14:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQyOTI5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4OTQ3OQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482189479", "bodyText": "Should this be latest? Shouldn't it be using a specific named version instead?", "author": "ravisharda", "createdAt": "2020-09-02T16:06:42Z", "path": "build.gradle", "diffHunk": "@@ -868,9 +884,9 @@ project('test:system') {\n         systemProperty \"bookkeeperImageName\", System.getProperty(\"bookkeeperImageName\", \"bookkeeper\") // bookkeeper image name\n         systemProperty \"zookeeperImageName\", System.getProperty(\"zookeeperImageName\", \"zookeeper\") // zookkeeper image name\n         systemProperty \"zookeeperImageVersion\", System.getProperty(\"zookeeperImageVersion\", \"latest\") // zookeeper image version\n-        systemProperty \"imageVersion\", System.getProperty(\"imageVersion\") // pravega version.\n+        systemProperty \"imageVersion\", System.getProperty(\"imageVersion\", \"latest\") // pravega version.", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjIwNzY2MQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482207661", "bodyText": "Likely -- I mostly followed suit from the zookeeperImageVersion property above. Any suggestions to a sain default?", "author": "co-jo", "createdAt": "2020-09-02T16:34:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4OTQ3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM1MzQ4NQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482353485", "bodyText": "I don't think we should use latest as Pravega image here. Ideally imageVersion should be pointing to an image that was built from the current source code as this is the intend in most cases - run system tests for the current commit/branch.  If no imageVersion provided then system test run should fail", "author": "medvedevigorek", "createdAt": "2020-09-02T19:39:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4OTQ3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE0ODI2NQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483148265", "bodyText": "Should I just remove the default instead then? Obviously its not possible to determine the exact build tag ahead of time, but if you run the gradle docker task, it produces some sort of version based snapshot <version>-<hash>-SNAPSHOT but that build also gets tagged as latest, so I think it does cover the main use case.", "author": "co-jo", "createdAt": "2020-09-03T17:40:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4OTQ3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI2MjU0Mg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483262542", "bodyText": "I think it comes to where the build is published after the gradle docker task. If it's published to the same repository as the default one to pull image from for the purpose of  the system test run then it may work. But as I understand it's not always true hence it's better to require the user to explicitly mention what image to use. With that in mind the default image version should be removed and if the user doesn't provide it the system test run will fail.", "author": "medvedevigorek", "createdAt": "2020-09-03T21:25:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE4OTQ3OQ=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "b699030bcb62252f95bcc3e46570c34d2d33d780", "url": "https://github.com/pravega/pravega/commit/b699030bcb62252f95bcc3e46570c34d2d33d780", "message": "Replace default Dockerfile with Java11 variant.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-02T18:03:00Z", "type": "commit"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "b699030bcb62252f95bcc3e46570c34d2d33d780", "url": "https://github.com/pravega/pravega/commit/b699030bcb62252f95bcc3e46570c34d2d33d780", "message": "Replace default Dockerfile with Java11 variant.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-02T18:03:00Z", "type": "forcePushed"}, {"oid": "dc46eaf190aeae33f621ddfa4eea3eda4853a00d", "url": "https://github.com/pravega/pravega/commit/dc46eaf190aeae33f621ddfa4eea3eda4853a00d", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-02T18:12:29Z", "type": "commit"}, {"oid": "ac167ff6af108e0ccdb7ee8ad7236916d997da4b", "url": "https://github.com/pravega/pravega/commit/ac167ff6af108e0ccdb7ee8ad7236916d997da4b", "message": "* Add single flag to control whether or not to build the client using JDK11.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-02T18:46:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM1ODMyNg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482358326", "bodyText": "It's bit inconsistent to call this property this way as when default JDK is changed to the next version this property should be updated as well. Suggest to use a better name, something that will reflect the fact that Client will be build for the same release version as Server code.", "author": "medvedevigorek", "createdAt": "2020-09-02T19:43:07Z", "path": "build.gradle", "diffHunk": "@@ -150,6 +142,12 @@ project('common') {\n         //Do NOT add any additional dependencies here.\n     }\n \n+    if (System.getProperty(\"buildJDK11Client\") == null) {", "originalCommit": "ac167ff6af108e0ccdb7ee8ad7236916d997da4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM2MDE0Mg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482360142", "bodyText": "Also please don't forget to update repository README file to reflect the changes in default JDK", "author": "medvedevigorek", "createdAt": "2020-09-02T19:44:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM1ODMyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE0MDYzMA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483140630", "bodyText": "Instead I added a user configurable property to set the client java version accordingly: clientJavaVersion. I opted for this instead of say, a compileUsingSameJDK flag because it essentially requires the same amount of user effort, but is more informative to what versions are being targeted.", "author": "co-jo", "createdAt": "2020-09-03T17:25:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM1ODMyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI2MzgwNA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483263804", "bodyText": "okay, makes sense.", "author": "medvedevigorek", "createdAt": "2020-09-03T21:28:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM1ODMyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQzOTI0Nw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r482439247", "bodyText": "Is there a way to override this for the client?", "author": "tkaitchuck", "createdAt": "2020-09-02T20:43:42Z", "path": "build.gradle", "diffHunk": "@@ -91,18 +90,11 @@ allprojects {\n \n     gradle.projectsEvaluated {\n         tasks.withType(JavaCompile) {\n-            sourceCompatibility = JavaVersion.VERSION_1_8\n-            targetCompatibility = JavaVersion.VERSION_1_8\n+            sourceCompatibility = JavaVersion.VERSION_11\n+            targetCompatibility = JavaVersion.VERSION_11", "originalCommit": "ac167ff6af108e0ccdb7ee8ad7236916d997da4b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzEzNzg0Mg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483137842", "bodyText": "I don't believe it is sufficient (or even possible) to supply overrides for the client (and its dependencies). For example if I supply\n    tasks.withType(JavaCompile) {\n        sourceCompatibility = JavaVersion.VERSION_1_8\n        targetCompatibility = JavaVersion.VERSION_1_8\n    }\n\nin any other project, it still builds Java 11 classes. Even if this was just a matter of ordering this configuration, I don't think it is sufficient. See: https://bugs.openjdk.java.net/browse/JDK-8058150\nThe way we currently override it is through the --release flag, which basically does the above anyway.", "author": "co-jo", "createdAt": "2020-09-03T17:20:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQzOTI0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI2NTM3MQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483265371", "bodyText": "My understanding is that --release is not an equivalent of --source and --target , you should always use --release starting with Java9+. With that in mind, do we really need to specify --source and --target explicitly for the components we want to build with the current JDK (e.g. JDK11)?\nFor Client and its dependencies we should use --release explicitly as we do now.", "author": "medvedevigorek", "createdAt": "2020-09-03T21:31:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQzOTI0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI5NjA0Mw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483296043", "bodyText": "We don't need to explicitly include them no. I do however think it is a good idea to also include release flags for the non-client components. This should protect any users who are running some JDK version >11 from running into issues.", "author": "co-jo", "createdAt": "2020-09-03T22:57:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjQzOTI0Nw=="}], "type": "inlineReview"}, {"oid": "9261b5e2ff83f783bf0b5115123eb6d21a4cb09d", "url": "https://github.com/pravega/pravega/commit/9261b5e2ff83f783bf0b5115123eb6d21a4cb09d", "message": "Use one source of truth for the default Java version.\nAdd a gradle property to set the client's Java version.\nUpdate README.md.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-03T16:44:41Z", "type": "commit"}, {"oid": "720eb800eff962b098530dff247854387c3b0648", "url": "https://github.com/pravega/pravega/commit/720eb800eff962b098530dff247854387c3b0648", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-03T17:51:23Z", "type": "commit"}, {"oid": "6dae234c4c13ce63676ecb0ab255f4da98172b39", "url": "https://github.com/pravega/pravega/commit/6dae234c4c13ce63676ecb0ab255f4da98172b39", "message": "Remove '(source/target)Compatibility' references and replace them with a release flag.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-03T22:50:47Z", "type": "commit"}, {"oid": "fbe7ef9cadd88b3258d247dcf98df140ba73bcc1", "url": "https://github.com/pravega/pravega/commit/fbe7ef9cadd88b3258d247dcf98df140ba73bcc1", "message": "Remove default 'imageVersion'.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-03T22:53:10Z", "type": "commit"}, {"oid": "45975ccb6bb59009c6d214431393e5238761615f", "url": "https://github.com/pravega/pravega/commit/45975ccb6bb59009c6d214431393e5238761615f", "message": "Merge remote-tracking branch 'origin/issue-5082-java-11-migration' into issue-5082-java-11-migration", "committedDate": "2020-09-03T22:53:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMzU2NQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483413565", "bodyText": "\" If you have a local JDK 8 installation, the client's unit tests can be deployed by setting the JAVA_8 environment variable to point the JDK  8 home directory.\"\nI would drop this line, it does not add value.\nIt is important to state that Pravega Client and all its dependendecies is expected to work on Java 8 compatible runtimes", "author": "eolivelli", "createdAt": "2020-09-04T06:28:27Z", "path": "README.md", "diffHunk": "@@ -15,7 +15,9 @@ To learn more about Pravega, visit https://pravega.io\n \n ## Prerequisites\n \n-- Java 8+\n+- Java 11+\n+\n+The `client` project is expected to be built using *Java 8* bytecode. If you have a local *JDK 8* installation, the `client`'s unit tests can be deployed by setting the `JAVA_8` environment variable to point the *JDK  8* home directory.", "originalCommit": "45975ccb6bb59009c6d214431393e5238761615f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMzk4Ng==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483413986", "bodyText": "why this complexity ? istn't \"11\" enough ? you are still hardcoding \"VERSION_11\" here", "author": "eolivelli", "createdAt": "2020-09-04T06:29:41Z", "path": "build.gradle", "diffHunk": "@@ -996,6 +1020,10 @@ def getProjectVersion() {\n     return ver\n }\n \n+def getDefaultJavaVersion() {\n+    return JavaVersion.VERSION_11.getMajorVersion()", "originalCommit": "45975ccb6bb59009c6d214431393e5238761615f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxNjY1MA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483416650", "bodyText": "Yeah, I debated that. Definitely unnecessary.", "author": "co-jo", "createdAt": "2020-09-04T06:36:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxMzk4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxNDk3Nw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483414977", "bodyText": "Are we adding this block in order to run tests of client on jdk8 ?\nI think this is not really needed.\nIf we set --release = 8 in the client and in all dependencies it should be enough.\nIt is better to have some external project / integration tests suite that uses the client.\nHaving here such support looks to me overwhelming", "author": "eolivelli", "createdAt": "2020-09-04T06:32:22Z", "path": "build.gradle", "diffHunk": "@@ -259,6 +261,19 @@ project('client') {\n         testCompile group: 'io.netty', name: 'netty-transport-native-epoll', version: nettyVersion, classifier: 'linux-x86_64'\n     }\n \n+    tasks.withType(JavaCompile) {\n+        options.compilerArgs << \"--release\" << clientJavaVersion\n+    }\n+\n+    // If the user has the client to build with a different version and there exists an appropriate JDK,", "originalCommit": "45975ccb6bb59009c6d214431393e5238761615f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxODI0MQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483418241", "bodyText": "This functionality was introduced in response to your comment here: #5121 (comment). I'm happy with removing it if you think it is overkill.", "author": "co-jo", "createdAt": "2020-09-04T06:40:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxNDk3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxODc4OQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483418789", "bodyText": "@co-jo yes, to me is overkill. Let's remove this complexity.", "author": "eolivelli", "createdAt": "2020-09-04T06:42:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQxNDk3Nw=="}], "type": "inlineReview"}, {"oid": "edf8c7f2a100099263e408d9378f76e02c4416ee", "url": "https://github.com/pravega/pravega/commit/edf8c7f2a100099263e408d9378f76e02c4416ee", "message": "Remove unnecessary/verbose components.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-04T06:47:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQyMjAwNw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483422007", "bodyText": "The version of Java to build the 'client' project and all dependencies in", "author": "eolivelli", "createdAt": "2020-09-04T06:50:14Z", "path": "gradle.properties", "diffHunk": "@@ -66,3 +66,5 @@ bookkeeperBaseTag=pravega/bookkeeper\n signing.keyId=\n # This will be defaulted to ~/.gnupg/secring.gpg if not provided as a command line property\n signing.secretKeyRingFile=\n+# The version of Java to build the 'client' project in.", "originalCommit": "edf8c7f2a100099263e408d9378f76e02c4416ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQyMjk1Mg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483422952", "bodyText": "I would say something like that:\nIn spite of the requirements of using JDK11+ to build this project, Pravega client artifacts are expected to be compatible with Java 8 runtime, only the server side components need JDK11+ to run.", "author": "eolivelli", "createdAt": "2020-09-04T06:52:27Z", "path": "README.md", "diffHunk": "@@ -15,7 +15,9 @@ To learn more about Pravega, visit https://pravega.io\n \n ## Prerequisites\n \n-- Java 8+\n+- Java 11+\n+\n+The `client` project is expected to be built into *Java 8* bytecode.", "originalCommit": "edf8c7f2a100099263e408d9378f76e02c4416ee", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ4Mjg3NA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483482874", "bodyText": "nit: Can we have all the compile options at a single place ? ref: \n  \n    \n      pravega/gradle/java.gradle\n    \n    \n        Lines 20 to 30\n      in\n      4f7be17\n    \n    \n    \n    \n\n        \n          \n               options.compilerArgs.addAll([ \n        \n\n        \n          \n                       \"-Xlint:deprecation\", \n        \n\n        \n          \n                       \"-Xlint:divzero\", \n        \n\n        \n          \n                       \"-Xlint:empty\", \n        \n\n        \n          \n                       \"-Xlint:fallthrough\", \n        \n\n        \n          \n                       \"-Xlint:finally\", \n        \n\n        \n          \n                       \"-Xlint:overrides\", \n        \n\n        \n          \n                       \"-Xlint:path\", \n        \n\n        \n          \n                       \"-Werror\" \n        \n\n        \n          \n               ]) \n        \n\n        \n          \n           } \n        \n    \n  \n\n\njava.gradle seems to be the place were this change can be added.", "author": "shrids", "createdAt": "2020-09-04T08:53:48Z", "path": "build.gradle", "diffHunk": "@@ -150,6 +140,10 @@ project('common') {\n         //Do NOT add any additional dependencies here.\n     }\n \n+    tasks.withType(JavaCompile) {", "originalCommit": "edf8c7f2a100099263e408d9378f76e02c4416ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgyMjcyNw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r483822727", "bodyText": "We could, but we would have to surround the compileJava closure with inside a call to afterEvaluate. That doesn't seem like a good practice to me, but its doable.\nEdit: I'll just leave a comment to explain this interaction.", "author": "co-jo", "createdAt": "2020-09-04T20:03:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ4Mjg3NA=="}], "type": "inlineReview"}, {"oid": "674bd779f68f35b8f63dd665c653c404c2e08be7", "url": "https://github.com/pravega/pravega/commit/674bd779f68f35b8f63dd665c653c404c2e08be7", "message": "Clarify documentation.\nConsolidate Java compilerArgs.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-04T20:27:12Z", "type": "commit"}, {"oid": "7daca88b895a490b90c62db027c5f4a9815487d4", "url": "https://github.com/pravega/pravega/commit/7daca88b895a490b90c62db027c5f4a9815487d4", "message": "Build longevity tests using the targeted client version as well (JDK 8).\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-04T23:31:00Z", "type": "commit"}, {"oid": "38b306ba5816c9b62d33866d00f94d1dccba8148", "url": "https://github.com/pravega/pravega/commit/38b306ba5816c9b62d33866d00f94d1dccba8148", "message": "Revert using afterEvaluate. The last instance of the flag takes precedence.\nAlso add release flag to test classes.\nReplace the --release version, instead of relying on the construction ordering to ensure the proper version is given.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-05T19:52:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA0MjU3MA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r485042570", "bodyText": "nit: \"no more\" -> \"no longer\"", "author": "andreipaduroiu", "createdAt": "2020-09-08T16:17:21Z", "path": "build.gradle", "diffHunk": "@@ -584,10 +595,15 @@ project('shared:controller-api') {\n         compile \"io.grpc:grpc-protobuf:\" + grpcVersion\n         compile \"io.grpc:grpc-stub:\" + grpcVersion\n         compile group: 'io.netty', name: 'netty-tcnative-boringssl-static', version: nettyBoringSSLVersion\n-         // Since Java 10 javax.annotation is no more bundled with the JRE\n+        // Since Java 10 javax.annotation is no more bundled with the JRE", "originalCommit": "38b306ba5816c9b62d33866d00f94d1dccba8148", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA0MzA3Mw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r485043073", "bodyText": "LOL. This is a big jump \ud83d\udc4d", "author": "andreipaduroiu", "createdAt": "2020-09-08T16:18:11Z", "path": "gradle.properties", "diffHunk": "@@ -22,12 +22,12 @@ commonsioVersion=2.6\n commonsLang3Version=3.7\n dockerClientVersion=8.16.0\n ecsObjectClientVersion=3.0.6\n-spotbugsVersion=4.0.3\n-spotbugsAnnotationsVersion=4.0.3\n-spotbugsPluginVersion=1.6.9\n+spotbugsVersion=4.0.6\n+spotbugsAnnotationsVersion=4.0.6\n+spotbugsPluginVersion=4.4.4", "originalCommit": "38b306ba5816c9b62d33866d00f94d1dccba8148", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA1Njg2Mg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r485056862", "bodyText": "Full disclosure, I basically referenced what Tom did in his faster-build branch for these exact versions.  @tkaitchuck Any thoughts?", "author": "co-jo", "createdAt": "2020-09-08T16:41:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA0MzA3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA0MzgyNg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r485043826", "bodyText": "I see you defined this in 2 places. Since this file is imported into main build.gradle file, does it suffice to just declare it here?", "author": "andreipaduroiu", "createdAt": "2020-09-08T16:19:29Z", "path": "gradle/java.gradle", "diffHunk": "@@ -98,3 +104,7 @@ plugins.withId('java') {\n         testCompile \"org.mockito:mockito-core:${mockitoVersion}\"\n     }\n }\n+\n+def getDefaultJavaVersion() {", "originalCommit": "38b306ba5816c9b62d33866d00f94d1dccba8148", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA2NTAzMw==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r485065033", "bodyText": "We can pull it out of java.gradle but not build.gradle. Will remove this declaration.", "author": "co-jo", "createdAt": "2020-09-08T16:55:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA0MzgyNg=="}], "type": "inlineReview"}, {"oid": "c9ce48fb1fe1f67f36ed9da857c17c325c3d6c18", "url": "https://github.com/pravega/pravega/commit/c9ce48fb1fe1f67f36ed9da857c17c325c3d6c18", "message": "Remove duplicate function declaration.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-08T16:56:35Z", "type": "commit"}, {"oid": "75b5be33d44a1fbf53105215620c1c9ff56a90c5", "url": "https://github.com/pravega/pravega/commit/75b5be33d44a1fbf53105215620c1c9ff56a90c5", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-08T17:02:27Z", "type": "commit"}, {"oid": "01beb6f678d56092ed1f057bf39b7b20adbc3f0d", "url": "https://github.com/pravega/pravega/commit/01beb6f678d56092ed1f057bf39b7b20adbc3f0d", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-10T19:06:29Z", "type": "commit"}, {"oid": "6e58a03e8bd12466afd4dd26ce24370b0c80ee81", "url": "https://github.com/pravega/pravega/commit/6e58a03e8bd12466afd4dd26ce24370b0c80ee81", "message": "Add options to ensure Java 11 compatibility.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T04:20:26Z", "type": "commit"}, {"oid": "45edd7f26b6e56bce0a4ef33b52f1b7ee0f3c44d", "url": "https://github.com/pravega/pravega/commit/45edd7f26b6e56bce0a4ef33b52f1b7ee0f3c44d", "message": "Merge remote-tracking branch 'origin/issue-5082-java-11-migration' into issue-5082-java-11-migration", "committedDate": "2020-09-15T04:22:20Z", "type": "commit"}, {"oid": "b3175104e6314cfe5e17b33350ec5a6a736854a7", "url": "https://github.com/pravega/pravega/commit/b3175104e6314cfe5e17b33350ec5a6a736854a7", "message": "Increase pod ready timeout.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T05:46:38Z", "type": "commit"}, {"oid": "44cf28160c9a389be1e93430e2ad72b8bcf85cc4", "url": "https://github.com/pravega/pravega/commit/44cf28160c9a389be1e93430e2ad72b8bcf85cc4", "message": "Remove flag.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T20:42:35Z", "type": "commit"}, {"oid": "ac46515646508c46017ab86bff44083f9303d7b9", "url": "https://github.com/pravega/pravega/commit/ac46515646508c46017ab86bff44083f9303d7b9", "message": "Add new flag to ignore unrecognized flags.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T20:57:15Z", "type": "commit"}, {"oid": "8dbb799ef6802f31506024d1e40bf8b4ad7cb982", "url": "https://github.com/pravega/pravega/commit/8dbb799ef6802f31506024d1e40bf8b4ad7cb982", "message": "Typo in JVM option.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T21:32:53Z", "type": "commit"}, {"oid": "734d51acc2a3415b10ec4771145c2d958f60337e", "url": "https://github.com/pravega/pravega/commit/734d51acc2a3415b10ec4771145c2d958f60337e", "message": "Fix typo in comment.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T21:52:43Z", "type": "commit"}, {"oid": "ba9edb658e418893f0f21636285847b6d62026c9", "url": "https://github.com/pravega/pravega/commit/ba9edb658e418893f0f21636285847b6d62026c9", "message": "Use proper key for `spec.pravega` property.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T22:02:17Z", "type": "commit"}, {"oid": "e717e45f56bcdf7566102059520a0eb60b2a5a21", "url": "https://github.com/pravega/pravega/commit/e717e45f56bcdf7566102059520a0eb60b2a5a21", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-16T20:34:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI4OTYxMg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492289612", "bodyText": "Is this change intentional ?", "author": "sachin-j-joshi", "createdAt": "2020-09-21T19:16:28Z", "path": "test/system/kubernetes/setupTestPod.sh", "diffHunk": "@@ -92,7 +92,7 @@ spec:\n         - mountPath: \"/data\"\n           name: task-pv-storage\n EOF\n-kubectl wait --timeout=1m --for=condition=Ready pod/task-pv-pod\n+kubectl wait --timeout=5m --for=condition=Ready pod/task-pv-pod", "originalCommit": "e717e45f56bcdf7566102059520a0eb60b2a5a21", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjMyMzkxMQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492323911", "bodyText": "It was. Five minutes might seem excessive but I was running into issues with the system tests from this pod timing out. I can lower if if you think its too high, but I think its a better experience to have a longer timeout than having to redeploy the tests.", "author": "co-jo", "createdAt": "2020-09-21T20:22:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI4OTYxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQyODI4OA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492428288", "bodyText": "ok. makes sense.", "author": "sachin-j-joshi", "createdAt": "2020-09-22T01:13:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI4OTYxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQxNzIwMg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492417202", "bodyText": "@co-jo can you please file an issue for Pravega Operator to remove usage of UseCGroupMemoryLimitForHeap for Pravega 0.9+", "author": "medvedevigorek", "createdAt": "2020-09-22T00:25:51Z", "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -288,6 +290,16 @@ private static boolean isOperatorVersionAbove040() {\n         }));\n     }\n \n+    // Removal of the JVM option 'UseCGroupMemoryLimitForHeap' is required with JVM environments >= 10. This option\n+    // is supplied by default by the operators. We cannot 'deactive' it using the XX:- counterpart as it is unrecognized.", "originalCommit": "e717e45f56bcdf7566102059520a0eb60b2a5a21", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQyMjg5NQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492422895", "bodyText": "@co-jo can you please file an issue for Pravega Operator to remove usage of UseCGroupMemoryLimitForHeap for Pravega 0.9+\n\nSure.", "author": "co-jo", "createdAt": "2020-09-22T00:50:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQxNzIwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ2MTQ3OA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492461478", "bodyText": "Why do we need IgnoreUnrecognizedVMOptions?", "author": "tkaitchuck", "createdAt": "2020-09-22T03:56:27Z", "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -288,6 +290,16 @@ private static boolean isOperatorVersionAbove040() {\n         }));\n     }\n \n+    // Removal of the JVM option 'UseCGroupMemoryLimitForHeap' is required with JVM environments >= 10. This option\n+    // is supplied by default by the operators. We cannot 'deactive' it using the XX:- counterpart as it is unrecognized.\n+    private String[] getSegmentStoreJVMOptions() {\n+        return new String[]{\"-XX:+UseContainerSupport\", \"-XX:+IgnoreUnrecognizedVMOptions\"};\n+    }\n+\n+    private String[] getControllerJVMOptions() {\n+        return new String[]{\"-XX:+UseContainerSupport\", \"-XX:+IgnoreUnrecognizedVMOptions\"};", "originalCommit": "e717e45f56bcdf7566102059520a0eb60b2a5a21", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ3NzU3MQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492477571", "bodyText": "The Pravega Operator supplies certain default JVM options (+UseCGroupMemoryLimitForHeap), which are not recognized by later JVMs. Any kubernetes deployment wouldn't work until the Pravega Operator is adjusted accordingly.", "author": "co-jo", "createdAt": "2020-09-22T05:13:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ2MTQ3OA=="}], "type": "inlineReview"}, {"oid": "749e12f986c8bcbf7b31c72fb094cd05b915ce35", "url": "https://github.com/pravega/pravega/commit/749e12f986c8bcbf7b31c72fb094cd05b915ce35", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-22T11:24:13Z", "type": "commit"}, {"oid": "d382a164f2ea0258f61184003ff068c06a9a7348", "url": "https://github.com/pravega/pravega/commit/d382a164f2ea0258f61184003ff068c06a9a7348", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-22T16:28:41Z", "type": "commit"}, {"oid": "69293fb0a48c9f2313a7ece31a4f6f700cd9385d", "url": "https://github.com/pravega/pravega/commit/69293fb0a48c9f2313a7ece31a4f6f700cd9385d", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-24T19:50:00Z", "type": "commit"}, {"oid": "4ae1179d01f05185e24a71f35cf9ebb2c49cfc9d", "url": "https://github.com/pravega/pravega/commit/4ae1179d01f05185e24a71f35cf9ebb2c49cfc9d", "message": "Merge remote-tracking branch 'upstream/master' into issue-5082-java-11-migration\n\n# Conflicts:\n#\tbuild.gradle\n#\ttest/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "committedDate": "2020-09-25T17:27:44Z", "type": "commit"}, {"oid": "a6841cd2815de96168f2be2e67c5d89091287e3b", "url": "https://github.com/pravega/pravega/commit/a6841cd2815de96168f2be2e67c5d89091287e3b", "message": "Remove package.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-28T16:25:34Z", "type": "commit"}]}