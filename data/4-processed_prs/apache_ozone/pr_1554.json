{"pr_number": 1554, "pr_title": "HDDS-4420. Missing a container shouldn't log message at ERROR level", "pr_createdAt": "2020-11-04T06:26:23Z", "pr_url": "https://github.com/apache/ozone/pull/1554", "timeline": [{"oid": "564a6f4ef0c2c9a2468b2d12e403ca71eba9d215", "url": "https://github.com/apache/ozone/commit/564a6f4ef0c2c9a2468b2d12e403ca71eba9d215", "message": "HDDS-4420. Missing a container shouldn't log message at ERROR level", "committedDate": "2020-11-04T06:15:19Z", "type": "commit"}, {"oid": "3f94db4d0c12f3b0f6ac6c16ec2c467ea7a729d7", "url": "https://github.com/apache/ozone/commit/3f94db4d0c12f3b0f6ac6c16ec2c467ea7a729d7", "message": "Trigger notification", "committedDate": "2020-11-04T07:33:55Z", "type": "commit"}, {"oid": "19fdbab657e7b2146df829f34fc1725753337eb1", "url": "https://github.com/apache/ozone/commit/19fdbab657e7b2146df829f34fc1725753337eb1", "message": "Trigger notification", "committedDate": "2020-11-04T07:36:31Z", "type": "commit"}, {"oid": "4ac059f556a8667662ad40be0915efb475a2b457", "url": "https://github.com/apache/ozone/commit/4ac059f556a8667662ad40be0915efb475a2b457", "message": "Trigger notification", "committedDate": "2020-11-04T09:48:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI2MzUwNA==", "url": "https://github.com/apache/ozone/pull/1554#discussion_r517263504", "bodyText": "Avoid the empty line changes here and above", "author": "ayushtkn", "createdAt": "2020-11-04T11:02:13Z", "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/container/IncrementalContainerReportHandler.java", "diffHunk": "@@ -71,8 +71,10 @@ public void onMessage(final IncrementalContainerReportFromDatanode report,\n     for (ContainerReplicaProto replicaProto :\n         report.getReport().getReportList()) {\n       try {\n+\n         final ContainerID id = ContainerID.valueof(\n             replicaProto.getContainerID());\n+", "originalCommit": "4ac059f556a8667662ad40be0915efb475a2b457", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI3NTIxNQ==", "url": "https://github.com/apache/ozone/pull/1554#discussion_r517275215", "bodyText": "Thanks for reminding, I will correct it.", "author": "wycccccc", "createdAt": "2020-11-04T11:23:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI2MzUwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMzE1Nw==", "url": "https://github.com/apache/ozone/pull/1554#discussion_r517413157", "bodyText": "I think rather than changing here, we should catch a separate ContainerReplicaNotFoundException  and there reduce the log level, suppressing for all IOE might not be a good choice.\n@jojochuang does that make sense?", "author": "ayushtkn", "createdAt": "2020-11-04T15:08:52Z", "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/container/IncrementalContainerReportHandler.java", "diffHunk": "@@ -87,7 +89,7 @@ public void onMessage(final IncrementalContainerReportFromDatanode report,\n             report.getDatanodeDetails(), ex);\n       } catch (IOException e) {\n         success = false;\n-        LOG.error(\"Exception while processing ICR for container {}\",\n+        LOG.warn(\"Exception while processing ICR for container {}\",", "originalCommit": "4ac059f556a8667662ad40be0915efb475a2b457", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE5MDA2MA==", "url": "https://github.com/apache/ozone/pull/1554#discussion_r519190060", "bodyText": "@wycccccc can you address this as well", "author": "ayushtkn", "createdAt": "2020-11-07T15:46:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMzE1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTU0NzAzNQ==", "url": "https://github.com/apache/ozone/pull/1554#discussion_r519547035", "bodyText": "@ayushtkn I think what you said makes sense\uff0clet me try it.", "author": "wycccccc", "createdAt": "2020-11-09T04:30:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxMzE1Nw=="}], "type": "inlineReview"}, {"oid": "9cc0accafce5a7c41086934f28fb204165d494f0", "url": "https://github.com/apache/ozone/commit/9cc0accafce5a7c41086934f28fb204165d494f0", "message": "HDDS-4420. Missing a container shouldn't log message at ERROR level", "committedDate": "2020-11-05T02:18:54Z", "type": "commit"}, {"oid": "e960ef36e0bf441d2ac0dfaa40504a65bd13db5f", "url": "https://github.com/apache/ozone/commit/e960ef36e0bf441d2ac0dfaa40504a65bd13db5f", "message": "Trigger notification", "committedDate": "2020-11-05T06:37:30Z", "type": "commit"}, {"oid": "09cf00e51033d444f1b6f8f3cb7bf2b76394c57b", "url": "https://github.com/apache/ozone/commit/09cf00e51033d444f1b6f8f3cb7bf2b76394c57b", "message": "Trigger notification", "committedDate": "2020-11-05T08:11:38Z", "type": "commit"}, {"oid": "b928019afd407634de81298592964830732b8843", "url": "https://github.com/apache/ozone/commit/b928019afd407634de81298592964830732b8843", "message": "Merge branch 'master' of https://github.com/apache/hadoop-ozone into HDDS-4420", "committedDate": "2020-11-09T04:35:38Z", "type": "commit"}, {"oid": "5756e86ac4a51162c483f8c88eeaf9d893caa3d8", "url": "https://github.com/apache/ozone/commit/5756e86ac4a51162c483f8c88eeaf9d893caa3d8", "message": "HDDS-4420. Missing a container shouldn't log message at ERROR level", "committedDate": "2020-11-09T07:16:57Z", "type": "commit"}, {"oid": "2f6fa73588cc08879c82facf8ab12325e1144eb8", "url": "https://github.com/apache/ozone/commit/2f6fa73588cc08879c82facf8ab12325e1144eb8", "message": "Trigger notification", "committedDate": "2020-11-09T07:27:06Z", "type": "commit"}, {"oid": "12f5f4de1927a7dd85d5c00e32e7f6df718b0964", "url": "https://github.com/apache/ozone/commit/12f5f4de1927a7dd85d5c00e32e7f6df718b0964", "message": "HDDS-4420. Missing a container shouldn't log message at ERROR level", "committedDate": "2020-11-09T07:29:12Z", "type": "commit"}, {"oid": "0b36af18ce1ff7936e59eea66021964eadcf12b1", "url": "https://github.com/apache/ozone/commit/0b36af18ce1ff7936e59eea66021964eadcf12b1", "message": "HDDS-4420. Missing a container shouldn't log message at ERROR level", "committedDate": "2020-11-09T07:34:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY2NjI1OQ==", "url": "https://github.com/apache/ozone/pull/1554#discussion_r519666259", "bodyText": "@wycccccc This is just a formatting change. It isn't required here. Please avoid changing it, Apart from this changes Looks Good", "author": "ayushtkn", "createdAt": "2020-11-09T09:31:35Z", "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/container/IncrementalContainerReportHandler.java", "diffHunk": "@@ -80,11 +80,16 @@ public void onMessage(final IncrementalContainerReportFromDatanode report,\n         processContainerReplica(dd, replicaProto, publisher);\n       } catch (ContainerNotFoundException e) {\n         success = false;\n-        LOG.warn(\"Container {} not found!\", replicaProto.getContainerID());\n+        LOG.warn(\"Container {} not found!\",\n+            replicaProto.getContainerID());", "originalCommit": "0b36af18ce1ff7936e59eea66021964eadcf12b1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTkwNjc0Ng==", "url": "https://github.com/apache/ozone/pull/1554#discussion_r519906746", "bodyText": "Based on the CI logs generated by the previous commit (#5756e86), the CheckStyle tool only reported that this line didn't meet the character length limit (<=80). I think it is only necessary to adjust this part.", "author": "cku328", "createdAt": "2020-11-09T15:38:48Z", "path": "hadoop-hdds/server-scm/src/main/java/org/apache/hadoop/hdds/scm/container/IncrementalContainerReportHandler.java", "diffHunk": "@@ -80,11 +80,16 @@ public void onMessage(final IncrementalContainerReportFromDatanode report,\n         processContainerReplica(dd, replicaProto, publisher);\n       } catch (ContainerNotFoundException e) {\n         success = false;\n-        LOG.warn(\"Container {} not found!\", replicaProto.getContainerID());\n+        LOG.warn(\"Container {} not found!\",\n+            replicaProto.getContainerID());\n       } catch (NodeNotFoundException ex) {\n         success = false;\n         LOG.error(\"Received ICR from unknown datanode {}\",\n             report.getDatanodeDetails(), ex);\n+      } catch (ContainerReplicaNotFoundException e){\n+        success = false;\n+        LOG.warn(\"Container {} replica not found!\",\n+            replicaProto.getContainerID());", "originalCommit": "0b36af18ce1ff7936e59eea66021964eadcf12b1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2f9697e0c773327e8ca156dd5f3462a01bc7185a", "url": "https://github.com/apache/ozone/commit/2f9697e0c773327e8ca156dd5f3462a01bc7185a", "message": "HDDS-4420. Missing a container shouldn't log message at ERROR level", "committedDate": "2020-11-10T10:35:59Z", "type": "commit"}]}