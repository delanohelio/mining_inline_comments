{"pr_number": 1166, "pr_title": "HDDS-3914. Remove LevelDB configuration option for DN Metastore", "pr_createdAt": "2020-07-06T20:08:50Z", "pr_url": "https://github.com/apache/ozone/pull/1166", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0Njg4NA==", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451046884", "bodyText": "Thanks @hanishakoneru  for working on this. Not sure if I understand correctly, since we are removing LevelDB support on DN, do we still need to define two types of DB for container here?", "author": "xiaoyuyao", "createdAt": "2020-07-07T18:00:30Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/keyvalue/KeyValueContainerCheck.java", "diffHunk": "@@ -186,8 +186,8 @@ private void checkContainerFile() throws IOException {\n     }\n \n     dbType = onDiskContainerData.getContainerDBType();\n-    if (!dbType.equals(OZONE_METADATA_STORE_IMPL_ROCKSDB) &&\n-        !dbType.equals(OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (!dbType.equals(CONTAINER_DB_TYPE_ROCKSDB) &&", "originalCommit": "86451aeb80c3cd67386e35a3688aeb3a0ff26620", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM5MTk0Ng==", "url": "https://github.com/apache/ozone/pull/1166#discussion_r452391946", "bodyText": "We are deprecating LevelDB support. I kept it there in case there are old containers using LevelDB.\nI am up for removing LevelDB support completely. I think it is safe to assume that there would not be a Container using LevelDB.", "author": "hanishakoneru", "createdAt": "2020-07-09T17:54:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0Njg4NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYwNTkxMA==", "url": "https://github.com/apache/ozone/pull/1166#discussion_r452605910", "bodyText": "That makes sense to me.", "author": "xiaoyuyao", "createdAt": "2020-07-10T03:41:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0Njg4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NzgzNQ==", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451047835", "bodyText": "Do we still need this?", "author": "xiaoyuyao", "createdAt": "2020-07-07T18:02:06Z", "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "diffHunk": "@@ -90,12 +93,12 @@ public void init() throws IOException {\n         + \"-\" + storeImpl.toLowerCase());\n \n     OzoneConfiguration conf = new OzoneConfiguration();\n-    conf.set(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL, storeImpl);\n \n     store = MetadataStoreBuilder.newBuilder()\n         .setConf(conf)\n         .setCreateIfMissing(true)\n         .setDbFile(testDir)\n+        .setDBType(storeImpl)", "originalCommit": "86451aeb80c3cd67386e35a3688aeb3a0ff26620", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM5MjAzOA==", "url": "https://github.com/apache/ozone/pull/1166#discussion_r452392038", "bodyText": "For the same reason as above.", "author": "hanishakoneru", "createdAt": "2020-07-09T17:55:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0NzgzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0ODU2MQ==", "url": "https://github.com/apache/ozone/pull/1166#discussion_r451048561", "bodyText": "The logic needs to be reversed, maybe a typo.", "author": "xiaoyuyao", "createdAt": "2020-07-07T18:03:26Z", "path": "hadoop-hdds/framework/src/test/java/org/apache/hadoop/hdds/utils/TestMetadataStore.java", "diffHunk": "@@ -166,12 +170,12 @@ public void testIterator() throws Exception {\n   public void testMetaStoreConfigDifferentFromType() throws IOException {\n \n     OzoneConfiguration conf = new OzoneConfiguration();\n-    conf.set(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL, storeImpl);\n+\n     String dbType;\n     GenericTestUtils.setLogLevel(MetadataStoreBuilder.LOG, Level.DEBUG);\n     GenericTestUtils.LogCapturer logCapturer =\n         GenericTestUtils.LogCapturer.captureLogs(MetadataStoreBuilder.LOG);\n-    if (storeImpl.equals(OzoneConfigKeys.OZONE_METADATA_STORE_IMPL_LEVELDB)) {\n+    if (storeImpl.equals(CONTAINER_DB_TYPE_LEVELDB)) {", "originalCommit": "86451aeb80c3cd67386e35a3688aeb3a0ff26620", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM5MjE0Nw==", "url": "https://github.com/apache/ozone/pull/1166#discussion_r452392147", "bodyText": "Thanks. Will fix it.", "author": "hanishakoneru", "createdAt": "2020-07-09T17:55:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA0ODU2MQ=="}], "type": "inlineReview"}, {"oid": "7e639d129955fc2769832c3c137ec4bebf20f960", "url": "https://github.com/apache/ozone/commit/7e639d129955fc2769832c3c137ec4bebf20f960", "message": "HDDS-3914. Remove LevelDB configuration option for DN Metastore", "committedDate": "2020-07-09T18:04:35Z", "type": "commit"}, {"oid": "48114a099c440eeda976547e4f255c9574b190e8", "url": "https://github.com/apache/ozone/commit/48114a099c440eeda976547e4f255c9574b190e8", "message": "checkstyle fixes", "committedDate": "2020-07-09T18:04:35Z", "type": "commit"}, {"oid": "35ef925a1bffdd766938b9895cb2813325d83118", "url": "https://github.com/apache/ozone/commit/35ef925a1bffdd766938b9895cb2813325d83118", "message": "integration test fix", "committedDate": "2020-07-09T18:04:35Z", "type": "commit"}, {"oid": "6ff2338319ce04ad276632009c0f55ca8dbce751", "url": "https://github.com/apache/ozone/commit/6ff2338319ce04ad276632009c0f55ca8dbce751", "message": "review and checkstyle fixes", "committedDate": "2020-07-09T18:04:35Z", "type": "commit"}, {"oid": "6ff2338319ce04ad276632009c0f55ca8dbce751", "url": "https://github.com/apache/ozone/commit/6ff2338319ce04ad276632009c0f55ca8dbce751", "message": "review and checkstyle fixes", "committedDate": "2020-07-09T18:04:35Z", "type": "forcePushed"}]}