{"pr_number": 782, "pr_title": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "pr_createdAt": "2020-04-07T16:34:46Z", "pr_url": "https://github.com/apache/ozone/pull/782", "timeline": [{"oid": "c0b88541f45fc1f54d3cd6a299dd2ea7b0ef752c", "url": "https://github.com/apache/ozone/commit/c0b88541f45fc1f54d3cd6a299dd2ea7b0ef752c", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-07T13:26:17Z", "type": "commit"}, {"oid": "13a54450a7531fd52076ff65e33faf89a247635a", "url": "https://github.com/apache/ozone/commit/13a54450a7531fd52076ff65e33faf89a247635a", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-07T13:46:56Z", "type": "commit"}, {"oid": "3fd20edc3b7219b1972946a02601c9adf9b69047", "url": "https://github.com/apache/ozone/commit/3fd20edc3b7219b1972946a02601c9adf9b69047", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-07T16:20:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwMDQ1Mg==", "url": "https://github.com/apache/ozone/pull/782#discussion_r405500452", "bodyText": "Thank you for the contribution, I have one question here.\nThe doc of snprintf as I understand says, it writes the output to the first param which is a char*, it writes at most the number of characters specified in the second argument, and the text is specified from the third argument on just as it should be defined for printf.\nAbout the char* that serves as a buffer in this case the doc says \"The buffer should have a size of at least n characters.\" where n is the number specified in the second parameter.\nIf these are correct, and as string is defined as a char[100], if the length of host, bucket, vol, plus the lenght of \"o3fs://\", plus 3 for the two dot and the null terminator is larger than 100, then as this call tries to write this many characters to the char array, it will index out from the array which will most likely cause an error.\nIf this is true (I am not really familiar with C, but you can try this easily with a longer bucket or volume or host name), then we need to create the char array with a sufficient size to store len+5 characters.\nAnd one more thing... I am not sure why the second character of snprintf here is len+5, I see that there are two extra dots in the host, but that does not explain 5. Can you explain this a bit better in the code, with like naming it and extracting it to a local variable, or by adding a comment, that would help to understand that a bit easier.", "author": "fapifta", "createdAt": "2020-04-08T12:52:58Z", "path": "hadoop-ozone/native-client/libozone/ozfs.c", "diffHunk": "@@ -0,0 +1,42 @@\n+#include \"ozfs.h\"\n+#include \"hdfs/hdfs.h\"\n+#include <fcntl.h>\n+#include <inttypes.h>\n+#include <stdio.h>\n+#include <string.h>\n+\n+\n+ozfsFS ozfsConnect(const char *host, tPort port, const char *bucket, const char *vol)\n+{\n+    struct hdfsBuilder *bld = hdfsNewBuilder();\n+    char string[100] = \"\";\n+    int len = 0;\n+    if (!bld)\n+        return NULL;\n+    len = strlen(host) + strlen(bucket) + strlen(vol) + strlen(\"o3fs://\");\n+    snprintf(string, len + 5, \"o3fs://%s.%s.%s\", bucket, vol, host);", "originalCommit": "3fd20edc3b7219b1972946a02601c9adf9b69047", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU0OTcwMw==", "url": "https://github.com/apache/ozone/pull/782#discussion_r405549703", "bodyText": "Thanks for pointing out @fapifta\nI changed len+5 to len+3 (len+2 for the two dots and +1 for the null character that\u2019s being appended by snprintf).\nAlso I changed string[100] to string[len+2].", "author": "aryangupta1998", "createdAt": "2020-04-08T14:03:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwMDQ1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwNTUyMQ==", "url": "https://github.com/apache/ozone/pull/782#discussion_r405505521", "bodyText": "Why we need fuse for the current code?", "author": "fapifta", "createdAt": "2020-04-08T13:00:57Z", "path": "hadoop-ozone/native-client/README.md", "diffHunk": "@@ -0,0 +1,79 @@\n+#Overview\n+\n+libozfs is a JNI based C API for Ozone File System. It provides with read and write functionality on OzoneFileSystem. It also uses some functions from HDFS(Hadoop Distributed File System) for which it uses libhdfs, which is a JNI based C API for Hadoop\u2019s Distributed File System (HDFS). It provides C APIs to a subset of the HDFS APIs to manipulate HDFS files and the filesystem. libhdfs is part of the Hadoop distribution and comes pre-compiled in $HADOOP_HDFS_HOME/lib/native/libhdfs.so .\n+\n+#The APIs\n+\n+The libozfs APIs are a subset of the Ozone FileSystem APIs. The header file for libozfs describes each API in detail and is available in $HADOOP_HDFS_HOME/include/ozfs.h.\n+\n+#Requirements:\n+\n+1.Hadoop with compiled libhdfs.so\n+2.Linux kernel > 2.6.9 with fuse, which is the default or Fuse 2.7.x, 2.8.x installed. See: http://fuse.sourceforge.net/ or even easier: http://dag.wieers.com/rpm/packages/fuse", "originalCommit": "3fd20edc3b7219b1972946a02601c9adf9b69047", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU1MTMwOQ==", "url": "https://github.com/apache/ozone/pull/782#discussion_r405551309", "bodyText": "Sorry thats a mistake, actually I\u2019m working on FUSE also thats why by mistake I added. I have removed it as we don\u2019t need fuse for this implementation.", "author": "aryangupta1998", "createdAt": "2020-04-08T14:05:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwNTUyMQ=="}], "type": "inlineReview"}, {"oid": "c48621d5a51f2a1e959779944ff9c602753d5707", "url": "https://github.com/apache/ozone/commit/c48621d5a51f2a1e959779944ff9c602753d5707", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-08T13:54:43Z", "type": "commit"}, {"oid": "1ce7302292d23734f5147ff5fe21e0319ff5420a", "url": "https://github.com/apache/ozone/commit/1ce7302292d23734f5147ff5fe21e0319ff5420a", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-09T16:02:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MDQyNg==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407390426", "bodyText": "Can you please add an examle here ? I mean how does the final URI look like ?", "author": "mukul1987", "createdAt": "2020-04-13T09:08:36Z", "path": "hadoop-ozone/native-client/libozone/ozfs.c", "diffHunk": "@@ -0,0 +1,60 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#include \"ozfs.h\"\n+#include \"hdfs/hdfs.h\"\n+#include <fcntl.h>\n+#include <inttypes.h>\n+#include <stdio.h>\n+#include <string.h>\n+\n+\n+ozfsFS ozfsConnect(const char *host, tPort port, const char *bucket, const char *vol)\n+{\n+    struct hdfsBuilder *bld = hdfsNewBuilder();\n+    int len = 0;\n+    if (!bld)\n+        return NULL;\n+    len = strlen(host) + strlen(bucket) + strlen(vol) + strlen(\"o3fs://\");\n+    char string[len + 2];\n+    snprintf(string, len + 3, \"o3fs://%s.%s.%s\", bucket, vol, host);", "originalCommit": "1ce7302292d23734f5147ff5fe21e0319ff5420a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ3MTA4OA==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407471088", "bodyText": "Example added", "author": "aryangupta1998", "createdAt": "2020-04-13T13:13:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MDQyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MDg3Mw==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407390873", "bodyText": "More than 80 characters in a line.", "author": "mukul1987", "createdAt": "2020-04-13T09:09:42Z", "path": "hadoop-ozone/native-client/libozone/ozfs.h", "diffHunk": "@@ -0,0 +1,43 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#ifndef OZFS_DOT_H    \n+#define OZFS_DOT_H\n+\n+#include \"hdfs/hdfs.h\"\n+\n+struct hdfs_internal;\n+typedef struct hdfs_internal* ozfsFS;\n+\n+struct hdfsFile_internal;\n+typedef struct hdfsFile_internal* ozfsFile;\n+\n+ozfsFS ozfsConnect(const char* nn, tPort port, const char* bucket, const char* volume);\n+\n+ozfsFile ozfsOpenFile(ozfsFS fs, const char *path, int flags, int bufferSize, short replication, tSize blockSize);", "originalCommit": "1ce7302292d23734f5147ff5fe21e0319ff5420a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ3MTIyMg==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407471222", "bodyText": "Resolved.", "author": "aryangupta1998", "createdAt": "2020-04-13T13:13:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MDg3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MTMxNA==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407391314", "bodyText": "lets have o3fs as a #define at the start of the file.", "author": "mukul1987", "createdAt": "2020-04-13T09:11:00Z", "path": "hadoop-ozone/native-client/libozone/ozfs.c", "diffHunk": "@@ -0,0 +1,60 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#include \"ozfs.h\"\n+#include \"hdfs/hdfs.h\"\n+#include <fcntl.h>\n+#include <inttypes.h>\n+#include <stdio.h>\n+#include <string.h>\n+\n+\n+ozfsFS ozfsConnect(const char *host, tPort port, const char *bucket, const char *vol)\n+{\n+    struct hdfsBuilder *bld = hdfsNewBuilder();\n+    int len = 0;\n+    if (!bld)\n+        return NULL;\n+    len = strlen(host) + strlen(bucket) + strlen(vol) + strlen(\"o3fs://\");\n+    char string[len + 2];\n+    snprintf(string, len + 3, \"o3fs://%s.%s.%s\", bucket, vol, host);", "originalCommit": "1ce7302292d23734f5147ff5fe21e0319ff5420a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ3MjUzOQ==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407472539", "bodyText": "Added #define O3FS \"o3fs://\"", "author": "aryangupta1998", "createdAt": "2020-04-13T13:16:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MTMxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MTU3Mw==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407391573", "bodyText": "lets have { and } after the if and at the end of if statement", "author": "mukul1987", "createdAt": "2020-04-13T09:11:42Z", "path": "hadoop-ozone/native-client/libozone/ozfs.c", "diffHunk": "@@ -0,0 +1,60 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#include \"ozfs.h\"\n+#include \"hdfs/hdfs.h\"\n+#include <fcntl.h>\n+#include <inttypes.h>\n+#include <stdio.h>\n+#include <string.h>\n+\n+\n+ozfsFS ozfsConnect(const char *host, tPort port, const char *bucket, const char *vol)\n+{\n+    struct hdfsBuilder *bld = hdfsNewBuilder();\n+    int len = 0;\n+    if (!bld)", "originalCommit": "1ce7302292d23734f5147ff5fe21e0319ff5420a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ3MTM0OA==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407471348", "bodyText": "Added", "author": "aryangupta1998", "createdAt": "2020-04-13T13:13:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MTU3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MTgzMw==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407391833", "bodyText": "why len +2 here and len+3 on the next line ?", "author": "mukul1987", "createdAt": "2020-04-13T09:12:16Z", "path": "hadoop-ozone/native-client/libozone/ozfs.c", "diffHunk": "@@ -0,0 +1,60 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#include \"ozfs.h\"\n+#include \"hdfs/hdfs.h\"\n+#include <fcntl.h>\n+#include <inttypes.h>\n+#include <stdio.h>\n+#include <string.h>\n+\n+\n+ozfsFS ozfsConnect(const char *host, tPort port, const char *bucket, const char *vol)\n+{\n+    struct hdfsBuilder *bld = hdfsNewBuilder();\n+    int len = 0;\n+    if (!bld)\n+        return NULL;\n+    len = strlen(host) + strlen(bucket) + strlen(vol) + strlen(\"o3fs://\");\n+    char string[len + 2];", "originalCommit": "1ce7302292d23734f5147ff5fe21e0319ff5420a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ3MjMyMQ==", "url": "https://github.com/apache/ozone/pull/782#discussion_r407472321", "bodyText": "snprintf just appends a null character at the end and we dont need that null character thats why i mentioned string[len+2]. In snprintf we have to pass len+3 because its function requirement.", "author": "aryangupta1998", "createdAt": "2020-04-13T13:15:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM5MTgzMw=="}], "type": "inlineReview"}, {"oid": "bb6b721be541cea6234797bad30df2e95e57dcab", "url": "https://github.com/apache/ozone/commit/bb6b721be541cea6234797bad30df2e95e57dcab", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-13T13:07:45Z", "type": "commit"}, {"oid": "744ccdc29b6bf7b1e31e081939ae8a9b34f56046", "url": "https://github.com/apache/ozone/commit/744ccdc29b6bf7b1e31e081939ae8a9b34f56046", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-13T15:57:58Z", "type": "commit"}, {"oid": "2fa20c8a18adaf671721ee957e77736ec4286a97", "url": "https://github.com/apache/ozone/commit/2fa20c8a18adaf671721ee957e77736ec4286a97", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-13T16:04:07Z", "type": "commit"}, {"oid": "04c63205f76dc810b80908361966271637a6fe41", "url": "https://github.com/apache/ozone/commit/04c63205f76dc810b80908361966271637a6fe41", "message": "Removed ozone-native-client", "committedDate": "2020-04-13T17:18:01Z", "type": "commit"}, {"oid": "a0b1ab6d8df2d8d54a6ac9e30223d281ac5c0fd0", "url": "https://github.com/apache/ozone/commit/a0b1ab6d8df2d8d54a6ac9e30223d281ac5c0fd0", "message": "Removed ozone-native-client", "committedDate": "2020-04-13T19:00:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI3Mjk1OQ==", "url": "https://github.com/apache/ozone/pull/782#discussion_r412272959", "bodyText": "lets change these to o3fs as well", "author": "mukul1987", "createdAt": "2020-04-21T15:12:20Z", "path": "hadoop-ozone/native-client/libo3fs-examples/libo3fs_read.c", "diffHunk": "@@ -0,0 +1,65 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#include \"o3fs.h\"\n+#include <stdio.h>\n+#include <stdlib.h>\n+#include<string.h>\n+\n+int main(int argc, char **argv) {\n+    ozfsFS fs;", "originalCommit": "a0b1ab6d8df2d8d54a6ac9e30223d281ac5c0fd0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMxMDU5OQ==", "url": "https://github.com/apache/ozone/pull/782#discussion_r412310599", "bodyText": "changed", "author": "aryangupta1998", "createdAt": "2020-04-21T16:34:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI3Mjk1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI3MzE5Mg==", "url": "https://github.com/apache/ozone/pull/782#discussion_r412273192", "bodyText": "lets also change these api's oto o3fs as well.", "author": "mukul1987", "createdAt": "2020-04-21T15:12:40Z", "path": "hadoop-ozone/native-client/libo3fs/o3fs.h", "diffHunk": "@@ -0,0 +1,44 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#ifndef OZFS_DOT_H\n+#define OZFS_DOT_H\n+\n+#include \"hdfs/hdfs.h\"\n+\n+struct hdfs_internal;\n+typedef struct hdfs_internal* ozfsFS;\n+\n+struct hdfsFile_internal;\n+typedef struct hdfsFile_internal* ozfsFile;\n+\n+ozfsFS ozfsConnect(const char* nn, tPort port, const char* bucket,", "originalCommit": "a0b1ab6d8df2d8d54a6ac9e30223d281ac5c0fd0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMxMDc5Nw==", "url": "https://github.com/apache/ozone/pull/782#discussion_r412310797", "bodyText": "changed", "author": "aryangupta1998", "createdAt": "2020-04-21T16:34:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI3MzE5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI3NDQ3NA==", "url": "https://github.com/apache/ozone/pull/782#discussion_r412274474", "bodyText": "printf(\"URI : %s\\n\", string);. this line can be removed", "author": "mukul1987", "createdAt": "2020-04-21T15:14:08Z", "path": "hadoop-ozone/native-client/libo3fs/o3fs.c", "diffHunk": "@@ -0,0 +1,67 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#include \"o3fs.h\"\n+#include \"hdfs/hdfs.h\"\n+#include <fcntl.h>\n+#include <inttypes.h>\n+#include <stdio.h>\n+#include <string.h>\n+#define O3FS \"o3fs://\"\n+\n+ozfsFS ozfsConnect(const char *host, tPort port,\n+ const char *bucket, const char *vol)\n+{\n+    struct hdfsBuilder *bld = hdfsNewBuilder();\n+    int len = 0;\n+    if (!bld){\n+        return NULL;\n+    }\n+    len = strlen(host) + strlen(bucket) + strlen(vol) + strlen(O3FS);\n+    char string[len + 2];\n+    snprintf(string, len + 3, \"%s%s.%s.%s\", O3FS, bucket, vol, host);\n+    // After snprintf command,\n+    // string = o3fs://bucket4.vol4.127.0.0.1 (URI without port)\n+    //printf(\"URI : %s\\n\", string);", "originalCommit": "a0b1ab6d8df2d8d54a6ac9e30223d281ac5c0fd0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMxMDkxNQ==", "url": "https://github.com/apache/ozone/pull/782#discussion_r412310915", "bodyText": "removed", "author": "aryangupta1998", "createdAt": "2020-04-21T16:34:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI3NDQ3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI3NTk1Mw==", "url": "https://github.com/apache/ozone/pull/782#discussion_r412275953", "bodyText": "lets also change OZFS to 03FS", "author": "mukul1987", "createdAt": "2020-04-21T15:15:58Z", "path": "hadoop-ozone/native-client/libo3fs/o3fs.h", "diffHunk": "@@ -0,0 +1,44 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+#ifndef OZFS_DOT_H", "originalCommit": "a0b1ab6d8df2d8d54a6ac9e30223d281ac5c0fd0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMxMTAzNQ==", "url": "https://github.com/apache/ozone/pull/782#discussion_r412311035", "bodyText": "changed", "author": "aryangupta1998", "createdAt": "2020-04-21T16:34:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI3NTk1Mw=="}], "type": "inlineReview"}, {"oid": "b7a326ea00a47f3aefdb702b9c68940a43e42c90", "url": "https://github.com/apache/ozone/commit/b7a326ea00a47f3aefdb702b9c68940a43e42c90", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-21T15:47:52Z", "type": "commit"}, {"oid": "47ddb24215cb8ada81f48c568d5df37158737a5e", "url": "https://github.com/apache/ozone/commit/47ddb24215cb8ada81f48c568d5df37158737a5e", "message": "HDDS-3352. Support for native ozone filesystem client using libhdfs.", "committedDate": "2020-04-21T18:12:23Z", "type": "commit"}]}