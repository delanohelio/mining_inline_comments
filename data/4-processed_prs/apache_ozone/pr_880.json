{"pr_number": 880, "pr_title": "HDDS-3327. Fix s3api  create bucket BUCKET_NOT_FOUND and acl initialization problem when enable acl.", "pr_createdAt": "2020-04-28T15:10:00Z", "pr_url": "https://github.com/apache/ozone/pull/880", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5MTQyMw==", "url": "https://github.com/apache/ozone/pull/880#discussion_r416791423", "bodyText": "Move this statement before if and use awsAccessId to check not null in if\nString awsAccessId = v4RequestParser.getAwsAccessId();\nif (awsAccessId != null) {", "author": "vivekratnavel", "createdAt": "2020-04-28T17:24:27Z", "path": "hadoop-ozone/s3gateway/src/main/java/org/apache/hadoop/ozone/s3/OzoneClientProducer.java", "diffHunk": "@@ -103,6 +107,13 @@ private OzoneClient getClient(OzoneConfiguration config) throws IOException {\n           throw S3_AUTHINFO_CREATION_ERROR;\n         }\n \n+      } else if (isAclenable) {\n+        if (v4RequestParser.getAwsAccessId() != null) {\n+          String awsAccessId = v4RequestParser.getAwsAccessId();", "originalCommit": "b2d28b458712de4a2889aa5ddf7b4bc5a8a2756c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjc5MTQ3Mw==", "url": "https://github.com/apache/ozone/pull/880#discussion_r416791473", "bodyText": "Rename variable to isAclEnabled for consistency in casing.", "author": "vivekratnavel", "createdAt": "2020-04-28T17:24:32Z", "path": "hadoop-ozone/s3gateway/src/main/java/org/apache/hadoop/ozone/s3/OzoneClientProducer.java", "diffHunk": "@@ -76,6 +78,8 @@ public void destory() throws IOException {\n \n   private OzoneClient getClient(OzoneConfiguration config) throws IOException {\n     try {\n+      Boolean isAclenable = config.getBoolean(", "originalCommit": "b2d28b458712de4a2889aa5ddf7b4bc5a8a2756c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d7c77c79b38fb9671c2fe48f34366437f93a6730", "url": "https://github.com/apache/ozone/commit/d7c77c79b38fb9671c2fe48f34366437f93a6730", "message": "fix BUCKET_NOT_FOUND", "committedDate": "2020-04-29T02:04:40Z", "type": "commit"}, {"oid": "d7c77c79b38fb9671c2fe48f34366437f93a6730", "url": "https://github.com/apache/ozone/commit/d7c77c79b38fb9671c2fe48f34366437f93a6730", "message": "fix BUCKET_NOT_FOUND", "committedDate": "2020-04-29T02:04:40Z", "type": "forcePushed"}, {"oid": "6917de3a70945a2db7a5341b80038f943d3beb7d", "url": "https://github.com/apache/ozone/commit/6917de3a70945a2db7a5341b80038f943d3beb7d", "message": "Always use awsAccessId to update the acl info.", "committedDate": "2020-04-29T09:38:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM4NDExMA==", "url": "https://github.com/apache/ozone/pull/880#discussion_r420384110", "bodyText": "Should we move the createRemoteUser, setLoginUser outside the if condition and addToken when security is enabled?", "author": "xiaoyuyao", "createdAt": "2020-05-05T20:25:17Z", "path": "hadoop-ozone/s3gateway/src/main/java/org/apache/hadoop/ozone/s3/OzoneClientProducer.java", "diffHunk": "@@ -103,6 +107,13 @@ private OzoneClient getClient(OzoneConfiguration config) throws IOException {\n           throw S3_AUTHINFO_CREATION_ERROR;\n         }\n \n+      } else {", "originalCommit": "6917de3a70945a2db7a5341b80038f943d3beb7d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM4NDIxNg==", "url": "https://github.com/apache/ozone/pull/880#discussion_r420384216", "bodyText": "Do we still need this?", "author": "xiaoyuyao", "createdAt": "2020-05-05T20:25:29Z", "path": "hadoop-ozone/s3gateway/src/main/java/org/apache/hadoop/ozone/s3/OzoneClientProducer.java", "diffHunk": "@@ -76,6 +78,8 @@ public void destory() throws IOException {\n \n   private OzoneClient getClient(OzoneConfiguration config) throws IOException {\n     try {\n+      Boolean isAclEnable = config.getBoolean(", "originalCommit": "6917de3a70945a2db7a5341b80038f943d3beb7d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fa8fa747781ff83aabeac6c9ebdb848afe0325d2", "url": "https://github.com/apache/ozone/commit/fa8fa747781ff83aabeac6c9ebdb848afe0325d2", "message": "fix review issues.", "committedDate": "2020-05-06T01:22:59Z", "type": "commit"}]}