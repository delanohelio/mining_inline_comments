{"pr_number": 1736, "pr_title": "HDDS-4594. Add namespace quota to documentation", "pr_createdAt": "2020-12-24T23:31:24Z", "pr_url": "https://github.com/apache/ozone/pull/1736", "timeline": [{"oid": "0fb1382fa0d69daf63607bf5591ca612bc9d4f19", "url": "https://github.com/apache/ozone/commit/0fb1382fa0d69daf63607bf5591ca612bc9d4f19", "message": "HDDS-4594. Add namespace quota to documentation", "committedDate": "2020-12-24T23:30:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODc4MjQ2OQ==", "url": "https://github.com/apache/ozone/pull/1736#discussion_r548782469", "bodyText": "Do we also need example client usage for namespace quota in the following section?", "author": "amaliujia", "createdAt": "2020-12-25T02:33:47Z", "path": "hadoop-hdds/docs/content/feature/Quota.md", "diffHunk": "@@ -45,6 +45,18 @@ e. If the cluster is upgraded from old version less than 1.1.0, use of quota on\n \n f. If volume's quota is enabled then bucket's quota cannot be cleared. \n \n+2. Namespace quota\n+\n+Administrators should be able to define how many namespace a Volume or Bucket can use. The following settings for namespace quota are supported: \n+\n+a. By default, the namespace quota for volume and bucket is not enabled.\n+\n+b. When volume namespace quota is enabled, the total number of buckets under the volume, cannot exceed the volume namespace quota.\n+\n+c. When bucket namespace quota is enabled, the totoal number of keys under the bucket, cannot exceed the bucket namespace quota.\n+\n+d. Linked buckets do not consume namespace quota.\n+", "originalCommit": "0fb1382fa0d69daf63607bf5591ca612bc9d4f19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODc4MjY4Nw==", "url": "https://github.com/apache/ozone/pull/1736#discussion_r548782687", "bodyText": "Whether 'e' in Storage Space applies equally to Namespace quota. If so, we need to list.", "author": "captainzmc", "createdAt": "2020-12-25T02:35:20Z", "path": "hadoop-hdds/docs/content/feature/Quota.md", "diffHunk": "@@ -45,6 +45,18 @@ e. If the cluster is upgraded from old version less than 1.1.0, use of quota on\n \n f. If volume's quota is enabled then bucket's quota cannot be cleared. \n \n+2. Namespace quota\n+\n+Administrators should be able to define how many namespace a Volume or Bucket can use. The following settings for namespace quota are supported: \n+\n+a. By default, the namespace quota for volume and bucket is not enabled.\n+\n+b. When volume namespace quota is enabled, the total number of buckets under the volume, cannot exceed the volume namespace quota.\n+\n+c. When bucket namespace quota is enabled, the totoal number of keys under the bucket, cannot exceed the bucket namespace quota.\n+\n+d. Linked buckets do not consume namespace quota.", "originalCommit": "0fb1382fa0d69daf63607bf5591ca612bc9d4f19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2054a00de5830f3f054cb9fed07bc0060318884a", "url": "https://github.com/apache/ozone/commit/2054a00de5830f3f054cb9fed07bc0060318884a", "message": "fixup! address comments", "committedDate": "2020-12-25T05:31:33Z", "type": "commit"}, {"oid": "ecea67e1e2cb99a7bde326a50ff810c3f72e4ee2", "url": "https://github.com/apache/ozone/commit/ecea67e1e2cb99a7bde326a50ff810c3f72e4ee2", "message": "trigger new CI check", "committedDate": "2020-12-25T06:36:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIwNTE0MA==", "url": "https://github.com/apache/ozone/pull/1736#discussion_r549205140", "bodyText": "There's something wrong with the directory structure. At present is:\n#space quota\n\u2026\u2026\n#namespace quota\n\u2026\u2026\n## clear quota\n## check quota and usage\nWe can change it to:\n#space quota\n\u2026\u2026\n## clear quota\n## check quota and usage\n#namespace quota\n\u2026\u2026\n## clear quota\n## check quota and usage\nor\n#space quota and namespace quota\n\u2026\u2026\n## clear quota\n## check quota and usage", "author": "captainzmc", "createdAt": "2020-12-28T03:49:02Z", "path": "hadoop-hdds/docs/content/feature/Quota.zh.md", "diffHunk": "@@ -70,10 +84,35 @@ bin/ozone sh bucket setquota  --space-quota 10GB /volume1/bucket1\n \n bucket\u7684\u603b\u914d\u989d \u4e0d\u5e94\u5927\u4e8e\u5176Volume\u7684\u914d\u989d\u3002\u8ba9\u6211\u4eec\u770b\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e00\u4e2a10MB\u7684Volume\uff0c\u8be5volume\u4e0b\u6240\u6709bucket\u7684\u5927\u5c0f\u4e4b\u548c\u4e0d\u80fd\u8d85\u8fc710MB\uff0c\u5426\u5219\u8bbe\u7f6ebucket quota\u5c06\u5931\u8d25\u3002\n \n+### Namespace quota\n+\u547d\u540d\u7a7a\u95f4\u914d\u989d\u662f\u4e00\u4e2a\u6570\u5b57\uff0c\u5176\u4ee3\u8868\u7531\u591a\u5c11\u4e2a\u540d\u5b57\u80fd\u591f\u4f7f\u7528\u3002\u8fd9\u4e2a\u6570\u5b57\u4e0d\u80fd\u8d85\u8fc7Java long\u6570\u636e\u7c7b\u578b\u7684\u6700\u5927\u503c\u3002\n+\n+#### Volume Namespace quota\n+```shell\n+bin/ozone sh volume create --namespace-quota 100 /volume1\n+```\n+\u8fd9\u610f\u5473\u7740\u5c06volume1\u7684\u547d\u540d\u7a7a\u95f4\u914d\u989d\u8bbe\u7f6e\u4e3a100\u3002\n+\n+```shell\n+bin/ozone sh volume setquota --namespace-quota 1000 /volume1\n+```\n+\u6b64\u884c\u4e3a\u5c06volume1\u7684\u547d\u540d\u7a7a\u95f4\u914d\u989d\u66f4\u6539\u4e3a1000\u3002\n+\n+#### Bucket Namespace quota\n+```shell\n+bin/ozone sh bucket create --namespace-quota 100 /volume1/bucket1\n+```\n+\u8fd9\u610f\u5473\u7740bucket1\u5141\u8bb8\u6211\u4eec\u4f7f\u7528100\u7684\u547d\u540d\u7a7a\u95f4\u3002\n+\n+```shell\n+bin/ozone sh bucket setquota --namespace-quota 1000 /volume1/bucket1 \n+```\n+\u8be5\u884c\u4e3a\u5c06bucket1\u7684\u547d\u540d\u7a7a\u95f4\u914d\u989d\u66f4\u6539\u4e3a1000\u3002\n+\n #### \u6e05\u9664volume\u548cbucket\u7684\u914d\u989d\n ```shell\n-bin/ozone sh volume clrquota --space-quota /volume1\n-bin/ozone sh bucket clrquota --space-quota /volume1/bucket1\n+bin/ozone sh volume clrquota --space-quota --namespace-quota /volume1\n+bin/ozone sh bucket clrquota --space-quota --namespace-quota /volume1/bucket1", "originalCommit": "ecea67e1e2cb99a7bde326a50ff810c3f72e4ee2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "86a955d520fa51932f49c474b0941a0db8507629", "url": "https://github.com/apache/ozone/commit/86a955d520fa51932f49c474b0941a0db8507629", "message": "fixup! restructure doc", "committedDate": "2020-12-28T04:53:17Z", "type": "commit"}, {"oid": "faa32ed971e69129e99cd4ae4d3646e028c86b17", "url": "https://github.com/apache/ozone/commit/faa32ed971e69129e99cd4ae4d3646e028c86b17", "message": "trigger new CI check", "committedDate": "2020-12-28T08:14:29Z", "type": "commit"}, {"oid": "db4feec8cdce33ee677018a6534b10912e59a490", "url": "https://github.com/apache/ozone/commit/db4feec8cdce33ee677018a6534b10912e59a490", "message": "trigger new CI check", "committedDate": "2020-12-28T20:11:42Z", "type": "commit"}, {"oid": "61e9b6b9c8745f4bf9cf85204a79768bf026dc4c", "url": "https://github.com/apache/ozone/commit/61e9b6b9c8745f4bf9cf85204a79768bf026dc4c", "message": "trigger new CI check", "committedDate": "2020-12-28T20:12:47Z", "type": "commit"}]}