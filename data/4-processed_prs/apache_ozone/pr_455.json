{"pr_number": 455, "pr_title": "HDDS-2895. Generate only the required keytabs for docker based secure tests", "pr_createdAt": "2020-01-17T11:31:04Z", "pr_url": "https://github.com/apache/ozone/pull/455", "timeline": [{"oid": "5b002aeeab9a5219158bbbc8b8bd132aa267d2cd", "url": "https://github.com/apache/ozone/commit/5b002aeeab9a5219158bbbc8b8bd132aa267d2cd", "message": "HDDS-2895. Generate only the required keytabs for docker based secure tests", "committedDate": "2020-01-17T11:09:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzk0MDM4OQ==", "url": "https://github.com/apache/ozone/pull/455#discussion_r367940389", "bodyText": "Seems like acceptance test failure is caused by missing HTTP keytab on datanode.\ndatanode_1  | 2020-01-17 12:30:34,899 [main] ERROR ozone.HddsDatanodeService: HttpServer failed to start.\n...\ndatanode_1  | Caused by: javax.servlet.ServletException: javax.servlet.ServletException: Keytab does not exist: /etc/security/keytabs/HTTP.keytab\n\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  KERBEROS_KEYTABS: dn\n          \n          \n            \n                  KERBEROS_KEYTABS: dn HTTP", "author": "adoroszlai", "createdAt": "2020-01-17T13:42:45Z", "path": "hadoop-ozone/dist/src/main/compose/ozonesecure/docker-compose.yaml", "diffHunk": "@@ -42,6 +41,8 @@ services:\n     command: [\"/opt/hadoop/bin/ozone\",\"datanode\"]\n     env_file:\n       - docker-config\n+    environment:\n+      KERBEROS_KEYTABS: dn", "originalCommit": "5b002aeeab9a5219158bbbc8b8bd132aa267d2cd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAzODE0Mg==", "url": "https://github.com/apache/ozone/pull/455#discussion_r368038142", "bodyText": "should we have recon in the no_proxy list?", "author": "xiaoyuyao", "createdAt": "2020-01-17T16:57:29Z", "path": "hadoop-ozone/dist/src/main/compose/ozonesecure/docker-config", "diffHunk": "@@ -80,12 +80,11 @@ HDFS-SITE.XML_rpc.metrics.percentiles.intervals=60,300\n OZONE_DATANODE_SECURE_USER=root\n SECURITY_ENABLED=true\n KEYTAB_DIR=/etc/security/keytabs\n-KERBEROS_KEYTABS=dn om scm HTTP testuser testuser2 s3g\n KERBEROS_KEYSTORES=hadoop\n KERBEROS_SERVER=kdc\n JAVA_HOME=/usr/lib/jvm/jre\n JSVC_HOME=/usr/bin\n SLEEP_SECONDS=5\n KERBEROS_ENABLED=true\n \n-no_proxy=om,scm,s3g,kdc,localhost,127.0.0.1\n\\ No newline at end of file\n+no_proxy=om,scm,s3g,kdc,localhost,127.0.0.1", "originalCommit": "5b002aeeab9a5219158bbbc8b8bd132aa267d2cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODIyNDY1NA==", "url": "https://github.com/apache/ozone/pull/455#discussion_r368224654", "bodyText": "AFAIK it was added to support the the curl/wget executed by the smoketests. As we have no recon specific acceptance tests (yet, hopefully), it's not immediately required...", "author": "elek", "createdAt": "2020-01-18T12:34:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAzODE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE0OTgzMQ==", "url": "https://github.com/apache/ozone/pull/455#discussion_r369149831", "bodyText": "There is one recon acceptance tests just added recently to catch a regression in HDDS-2897.\nSee #453 for details.", "author": "xiaoyuyao", "createdAt": "2020-01-21T17:49:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAzODE0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDExNzcyOA==", "url": "https://github.com/apache/ozone/pull/455#discussion_r370117728", "bodyText": "This was added in another task, only newline at EOF is changed.  So I think it should be addressed in a new Jira.", "author": "adoroszlai", "createdAt": "2020-01-23T13:32:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODAzODE0Mg=="}], "type": "inlineReview"}, {"oid": "6a451cf2214e44d3a7ac92a00f56f03d31f035ac", "url": "https://github.com/apache/ozone/commit/6a451cf2214e44d3a7ac92a00f56f03d31f035ac", "message": "Update hadoop-ozone/dist/src/main/compose/ozonesecure/docker-compose.yaml\n\nCo-Authored-By: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>", "committedDate": "2020-01-18T12:32:14Z", "type": "commit"}, {"oid": "c375ce10276b446b3cd08bbbdbbad49365e989f1", "url": "https://github.com/apache/ozone/commit/c375ce10276b446b3cd08bbbdbbad49365e989f1", "message": "generate testuser keytab for s3g tests", "committedDate": "2020-01-20T10:28:11Z", "type": "commit"}, {"oid": "b43cbb385dccfeecb435e94db805251c2b8ecb9b", "url": "https://github.com/apache/ozone/commit/b43cbb385dccfeecb435e94db805251c2b8ecb9b", "message": "add testuser2 for secure fs tests", "committedDate": "2020-01-22T13:58:01Z", "type": "commit"}]}