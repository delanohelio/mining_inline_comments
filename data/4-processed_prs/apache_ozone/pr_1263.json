{"pr_number": 1263, "pr_title": "HDDS-4033. Make the acceptance test reports hierarchical", "pr_createdAt": "2020-07-27T09:49:51Z", "pr_url": "https://github.com/apache/ozone/pull/1263", "timeline": [{"oid": "3237856bebe1125453bfe3380fd35cb9ec7f43fb", "url": "https://github.com/apache/ozone/commit/3237856bebe1125453bfe3380fd35cb9ec7f43fb", "message": "advanced reporting", "committedDate": "2020-07-17T17:47:45Z", "type": "commit"}, {"oid": "ef725dfb1e0a0dbeb0978516917d85bf2287a906", "url": "https://github.com/apache/ozone/commit/ef725dfb1e0a0dbeb0978516917d85bf2287a906", "message": "execute only acceptance", "committedDate": "2020-07-17T17:48:25Z", "type": "commit"}, {"oid": "becba2af8968d877e166a7b95c1417aa1d4dc4fa", "url": "https://github.com/apache/ozone/commit/becba2af8968d877e166a7b95c1417aa1d4dc4fa", "message": "avoid recursion", "committedDate": "2020-07-17T20:23:50Z", "type": "commit"}, {"oid": "0a5cd418aa3b7d7aeb84787d0675827a75253fe8", "url": "https://github.com/apache/ozone/commit/0a5cd418aa3b7d7aeb84787d0675827a75253fe8", "message": "fix naming", "committedDate": "2020-07-18T06:11:25Z", "type": "commit"}, {"oid": "798f9be03a26abec17c409590eab5e77c1645df2", "url": "https://github.com/apache/ozone/commit/798f9be03a26abec17c409590eab5e77c1645df2", "message": "retrigger ci", "committedDate": "2020-07-20T06:59:02Z", "type": "commit"}, {"oid": "4721b0f7e0f83aa97c9caa35a55f2e2846977778", "url": "https://github.com/apache/ozone/commit/4721b0f7e0f83aa97c9caa35a55f2e2846977778", "message": "fix test execution", "committedDate": "2020-07-20T12:51:24Z", "type": "commit"}, {"oid": "1252d3d5660c385622eaa5f4e896dd0b4a29f0d4", "url": "https://github.com/apache/ozone/commit/1252d3d5660c385622eaa5f4e896dd0b4a29f0d4", "message": "report output", "committedDate": "2020-07-21T14:36:45Z", "type": "commit"}, {"oid": "28445cb21f58c0c8615b8c19fadcc0cd22eceb07", "url": "https://github.com/apache/ozone/commit/28445cb21f58c0c8615b8c19fadcc0cd22eceb07", "message": "do not fail if logs output files are missing", "committedDate": "2020-07-22T10:20:53Z", "type": "commit"}, {"oid": "ae5878968e83ffdb8a0fa32f2dc377fd31df336d", "url": "https://github.com/apache/ozone/commit/ae5878968e83ffdb8a0fa32f2dc377fd31df336d", "message": "fix names in loops", "committedDate": "2020-07-26T10:19:54Z", "type": "commit"}, {"oid": "e7ee7c396319b9db2cd1dbc0a92c803473104f5b", "url": "https://github.com/apache/ozone/commit/e7ee7c396319b9db2cd1dbc0a92c803473104f5b", "message": "Merge remote-tracking branch 'origin/master' into acceptance-reporting", "committedDate": "2020-07-26T10:23:55Z", "type": "commit"}, {"oid": "4cdaf4e871ef7c7d0522b49d52ef561c7d274d89", "url": "https://github.com/apache/ozone/commit/4cdaf4e871ef7c7d0522b49d52ef561c7d274d89", "message": "follow latest changes from master (dirname /home/elek/projects/ozone-review)", "committedDate": "2020-07-26T10:31:01Z", "type": "commit"}, {"oid": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e", "url": "https://github.com/apache/ozone/commit/51f78ffe81492efd80bb90f0f0fb1271a1b6de2e", "message": "re-enable all the tests", "committedDate": "2020-07-27T09:44:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyMjM4OA==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r461022388", "bodyText": "I think -mindepth 2 -maxdepth 2 should be added to test-all.sh, too, because currently ozone-mr/hadoop* tests are executed twice:\n2020-07-27T10:02:03.8462205Z Executing test in /mnt/ozone/hadoop-ozone/dist/target/ozone-0.6.0-SNAPSHOT/compose/ozone-mr/hadoop27\n...\n2020-07-27T10:11:13.8415416Z Executing test in /mnt/ozone/hadoop-ozone/dist/target/ozone-0.6.0-SNAPSHOT/compose/ozone-mr/hadoop27", "author": "adoroszlai", "createdAt": "2020-07-27T16:40:03Z", "path": "hadoop-ozone/dist/src/main/compose/ozone-mr/test.sh", "diffHunk": "@@ -0,0 +1,32 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+SCRIPT_DIR=$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" >/dev/null && pwd )\n+ALL_RESULT_DIR=\"$SCRIPT_DIR/result\"\n+set -x\n+RESULT=0\n+IFS=$'\\n'\n+# shellcheck disable=SC2044\n+for test in $(find \"$SCRIPT_DIR\" -mindepth 2 -maxdepth 2 -name test.sh | grep \"${OZONE_TEST_SELECTOR:-\"\"}\" |sort); do", "originalCommit": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjE0MjU0Nw==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462142547", "bodyText": "Hmm. I think I should move out the tricky find segment (contains the #suite support) to the testlib.sh and reuse it from the second level test.sh.", "author": "elek", "createdAt": "2020-07-29T08:51:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyMjM4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNDk2Mg==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r461024962", "bodyText": "Nice.  Can you also add explicit name for the different readdata tests in ozone-topology?\nhttps://github.com/apache/hadoop-ozone/blob/ddd3211757ad67d1574e0e9e983b182681050a7c/hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh#L42\nhttps://github.com/apache/hadoop-ozone/blob/ddd3211757ad67d1574e0e9e983b182681050a7c/hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh#L52", "author": "adoroszlai", "createdAt": "2020-07-27T16:44:03Z", "path": "hadoop-ozone/dist/src/main/compose/ozone/test.sh", "diffHunk": "@@ -35,14 +35,14 @@ execute_robot_test scm gdpr\n \n for scheme in ofs o3fs; do\n   for bucket in link bucket; do\n-    execute_robot_test scm -v SCHEME:${scheme} -v BUCKET_TYPE:${bucket} ozonefs/ozonefs.robot\n+    execute_robot_test scm -v SCHEME:${scheme} -v BUCKET_TYPE:${bucket} -N ozonefs-${scheme}-${bucket} ozonefs/ozonefs.robot", "originalCommit": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjEyMDg4OA==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462120888", "bodyText": "\ud83d\udc4d", "author": "elek", "createdAt": "2020-07-29T08:15:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNDk2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNTU5OA==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r461025598", "bodyText": "Nit: store result of $(basename $(dirname \"$test\")) in variable.", "author": "adoroszlai", "createdAt": "2020-07-27T16:45:06Z", "path": "hadoop-ozone/dist/src/main/compose/test-all.sh", "diffHunk": "@@ -46,9 +46,12 @@ for test in $(find \"$SCRIPT_DIR\" -name test.sh | grep \"${OZONE_TEST_SELECTOR:-\"\"\n       echo \"ERROR: Test execution of $(dirname \"$test\") is FAILED!!!!\"\n   fi\n   RESULT_DIR=\"$(dirname \"$test\")/result\"\n-  cp \"$RESULT_DIR\"/robot-*.xml \"$RESULT_DIR\"/docker-*.log \"$RESULT_DIR\"/*.out* \"$ALL_RESULT_DIR\"/\n+  rebot -N $(basename $(dirname \"$test\")) -o \"$ALL_RESULT_DIR\"/$(basename $(dirname \"$test\")).xml \"$RESULT_DIR\"/*.xml", "originalCommit": "51f78ffe81492efd80bb90f0f0fb1271a1b6de2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjE0MjAzMA==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462142030", "bodyText": "done (got ${d} with the rebase...)", "author": "elek", "createdAt": "2020-07-29T08:50:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyNTU5OA=="}], "type": "inlineReview"}, {"oid": "378b92a7cb2db713c4c11ec58dff68522ddaa9f4", "url": "https://github.com/apache/ozone/commit/378b92a7cb2db713c4c11ec58dff68522ddaa9f4", "message": "Merge remote-tracking branch 'origi/master' into HDDS-4033", "committedDate": "2020-07-29T08:10:47Z", "type": "commit"}, {"oid": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "url": "https://github.com/apache/ozone/commit/7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "message": "address code review comments (+reorganize find_tests)", "committedDate": "2020-07-29T09:17:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMwMDkyNQ==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462300925", "bodyText": "I think this line should be removed:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            rebot -N \"smoketests\" -d \"$SCRIPT_DIR/result\" \"$SCRIPT_DIR/result/robot-*.xml\"\n          \n      \n    \n    \n  \n\nto avoid the following error:\n2020-07-29T10:07:38.2962715Z [ ERROR ] Reading XML source '/mnt/ozone/hadoop-ozone/dist/target/ozone-0.6.0-SNAPSHOT/compose/result/robot-*.xml' failed: No such file or directory", "author": "adoroszlai", "createdAt": "2020-07-29T13:32:58Z", "path": "hadoop-ozone/dist/src/main/compose/test-all.sh", "diffHunk": "@@ -64,10 +49,16 @@ for t in ${tests}; do\n       RESULT=1\n       echo \"ERROR: Test execution of ${d} is FAILED!!!!\"\n   fi\n+  cd \"$SCRIPT_DIR\"\n   RESULT_DIR=\"${d}/result\"\n-  cp \"$RESULT_DIR\"/robot-*.xml \"$RESULT_DIR\"/docker-*.log \"$RESULT_DIR\"/*.out* \"$ALL_RESULT_DIR\"/\n+  TEST_DIR_NAME=$(basename ${d})\n+  rebot -N $TEST_DIR_NAME -o \"$ALL_RESULT_DIR\"/$TEST_DIR_NAME.xml \"$RESULT_DIR\"/\"*.xml\"\n+  cp \"$RESULT_DIR\"/docker-*.log \"$ALL_RESULT_DIR\"/\n+  cp \"$RESULT_DIR\"/*.out* \"$ALL_RESULT_DIR\"/ || true\n done\n \n+rebot -N acceptance -d \"$ALL_RESULT_DIR\" \"$ALL_RESULT_DIR\"/*.xml\n+\n rebot -N \"smoketests\" -d \"$SCRIPT_DIR/result\" \"$SCRIPT_DIR/result/robot-*.xml\"", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMwNzg1NQ==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462307855", "bodyText": "Arguments need to be swapped:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            execute_robot_test scm topology/readdata.robot -N readdata-first-half\n          \n          \n            \n            execute_robot_test scm -N readdata-first-half topology/readdata.robot\n          \n      \n    \n    \n  \n\nto avoid:\n2020-07-29T09:51:30.5630160Z [ ERROR ] Parsing 'topology/readdata.robot' failed: File or directory to execute does not exist.", "author": "adoroszlai", "createdAt": "2020-07-29T13:42:37Z", "path": "hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh", "diffHunk": "@@ -39,7 +39,7 @@ execute_robot_test scm topology/loaddata.robot\n \n stop_containers datanode_1 datanode_2 datanode_3\n \n-execute_robot_test scm topology/readdata.robot\n+execute_robot_test scm topology/readdata.robot -N readdata-first-half", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMwNzk5MQ==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462307991", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            execute_robot_test scm topology/readdata.robot -N readdata-second-half\n          \n          \n            \n            execute_robot_test scm -N readdata-second-half topology/readdata.robot", "author": "adoroszlai", "createdAt": "2020-07-29T13:42:47Z", "path": "hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh", "diffHunk": "@@ -49,7 +49,7 @@ wait_for_port datanode_3 9858 60\n \n stop_containers datanode_4 datanode_5 datanode_6\n \n-execute_robot_test scm topology/readdata.robot\n+execute_robot_test scm topology/readdata.robot -N readdata-second-half", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyMzU1Ng==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462323556", "bodyText": "This needs to be updated to avoid failure in bats check:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh\n          \n          \n            \n            load ../../main/compose/testlib.sh", "author": "adoroszlai", "createdAt": "2020-07-29T14:03:45Z", "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyMzk2OQ==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462323969", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              run find_tests\n          \n          \n            \n              cd $BATS_TEST_DIRNAME\n          \n          \n            \n              run find_tests", "author": "adoroszlai", "createdAt": "2020-07-29T14:04:19Z", "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNDEyNw==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462324127", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              echo \"x${output}x}\"", "author": "adoroszlai", "createdAt": "2020-07-29T14:04:32Z", "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNDMyNw==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462324327", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              run find_tests\n          \n          \n            \n              cd $BATS_TEST_DIRNAME\n          \n          \n            \n              run find_tests", "author": "adoroszlai", "createdAt": "2020-07-29T14:04:48Z", "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"\n+  [[ \"$output\" == \"./test1/test.sh ./test2/test.sh ./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test by suite\" {\n+  OZONE_ACCEPTANCE_SUITE=one\n+  run find_tests", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNzY1MA==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462327650", "bodyText": "Can you please explain what's the purpose of repeatedly loading the library being tested?  In my experience it works fine with a single load, but maybe you want to cover some case I'm not aware of.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh\n          \n          \n            \n            load ../../main/compose/testlib.sh\n          \n      \n    \n    \n  \n\nor\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh", "author": "adoroszlai", "createdAt": "2020-07-29T14:09:17Z", "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"\n+  [[ \"$output\" == \"./test1/test.sh ./test2/test.sh ./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMzMzI4OA==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462333288", "bodyText": "Yes, I learned from you that load can be used, but it doesnt work for me:\nbats compose_testlib.bats\nbats: /home/elek/projects/ozone/hadoop-ozone/dist/src/test/shell/../../main/compose/testlib.sh.bash does not exist\n\nDon't know why....", "author": "elek", "createdAt": "2020-07-29T14:16:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNzY1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMzNTE2NQ==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462335165", "bodyText": "Upgrade bats to 1.2.1.\nbats-core/bats-core#282\nhttps://github.com/bats-core/bats-core/releases/tag/v1.2.1", "author": "adoroszlai", "createdAt": "2020-07-29T14:18:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNzY1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyNzc3Mw==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462327773", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              run find_tests\n          \n          \n            \n              cd $BATS_TEST_DIRNAME\n          \n          \n            \n              run find_tests", "author": "adoroszlai", "createdAt": "2020-07-29T14:09:26Z", "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"\n+  [[ \"$output\" == \"./test1/test.sh ./test2/test.sh ./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test by suite\" {\n+  OZONE_ACCEPTANCE_SUITE=one\n+  run find_tests\n+  [[ \"$output\" == \"./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test default suite\" {\n+  OZONE_ACCEPTANCE_SUITE=misc\n+  run find_tests", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyODU4OA==", "url": "https://github.com/apache/ozone/pull/1263#discussion_r462328588", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh\n          \n          \n            \n            load ../../main/compose/testlib.sh\n          \n      \n    \n    \n  \n\nor\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            source ../../main/compose/testlib.sh", "author": "adoroszlai", "createdAt": "2020-07-29T14:10:23Z", "path": "hadoop-ozone/dist/src/test/shell/compose_testlib.bats", "diffHunk": "@@ -0,0 +1,37 @@\n+#!/usr/bin/env bash\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test recursive, only on one level\" {\n+  run find_tests\n+  echo \"x${output}x}\"\n+  [[ \"$output\" == \"./test1/test.sh ./test2/test.sh ./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh\n+@test \"Find test by suite\" {\n+  OZONE_ACCEPTANCE_SUITE=one\n+  run find_tests\n+  [[ \"$output\" == \"./test4/test.sh\" ]]\n+}\n+\n+source ../../main/compose/testlib.sh", "originalCommit": "7d7d84cf8a9d4639f1811cac4901e42046fffa0c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f7398d4879bd6c7260abf3c0e6aa247185c8a1c3", "url": "https://github.com/apache/ozone/commit/f7398d4879bd6c7260abf3c0e6aa247185c8a1c3", "message": "rat fix", "committedDate": "2020-07-29T14:14:41Z", "type": "commit"}, {"oid": "62c9780724f6bb61826009d370880d3134e7cc1d", "url": "https://github.com/apache/ozone/commit/62c9780724f6bb61826009d370880d3134e7cc1d", "message": "Update hadoop-ozone/dist/src/test/shell/compose_testlib.bats\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>", "committedDate": "2020-07-29T14:30:14Z", "type": "commit"}, {"oid": "c549d468cbfb0ea7e88decbdd1e3098850243adf", "url": "https://github.com/apache/ozone/commit/c549d468cbfb0ea7e88decbdd1e3098850243adf", "message": "Update hadoop-ozone/dist/src/test/shell/compose_testlib.bats\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>", "committedDate": "2020-07-29T14:30:26Z", "type": "commit"}, {"oid": "1d003b88f689d23a1bf8e09e9abc4faec535c9fb", "url": "https://github.com/apache/ozone/commit/1d003b88f689d23a1bf8e09e9abc4faec535c9fb", "message": "Update hadoop-ozone/dist/src/test/shell/compose_testlib.bats\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>", "committedDate": "2020-07-29T14:30:37Z", "type": "commit"}, {"oid": "88f37655493315ae7cd506a74484884d81783811", "url": "https://github.com/apache/ozone/commit/88f37655493315ae7cd506a74484884d81783811", "message": "Update hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>", "committedDate": "2020-07-29T14:30:47Z", "type": "commit"}, {"oid": "2b133a6190df555134a4596d3e4d4f0307e1498c", "url": "https://github.com/apache/ozone/commit/2b133a6190df555134a4596d3e4d4f0307e1498c", "message": "Update hadoop-ozone/dist/src/main/compose/ozone-topology/test.sh\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>", "committedDate": "2020-07-29T14:31:15Z", "type": "commit"}, {"oid": "674205c2e33f52e1cf5f5e695dc18bf404a92664", "url": "https://github.com/apache/ozone/commit/674205c2e33f52e1cf5f5e695dc18bf404a92664", "message": "Merge remote-tracking branch 'elek/HDDS-4033' into HDDS-4033", "committedDate": "2020-07-29T14:32:47Z", "type": "commit"}, {"oid": "5c53c971f7903258ecfd7cd2570055df87cb2898", "url": "https://github.com/apache/ozone/commit/5c53c971f7903258ecfd7cd2570055df87cb2898", "message": "Apply suggestions from code review\n\nCo-authored-by: Doroszlai, Attila <6454655+adoroszlai@users.noreply.github.com>", "committedDate": "2020-07-29T14:35:45Z", "type": "commit"}, {"oid": "05e5f5000d9b15e3b07c09379d50bf03416800fd", "url": "https://github.com/apache/ozone/commit/05e5f5000d9b15e3b07c09379d50bf03416800fd", "message": "Merge remote-tracking branch 'elek/HDDS-4033' into HDDS-4033", "committedDate": "2020-07-29T14:35:54Z", "type": "commit"}, {"oid": "712a06c67addc7e152c0c69a9a68fba4163236fb", "url": "https://github.com/apache/ozone/commit/712a06c67addc7e152c0c69a9a68fba4163236fb", "message": "Merge remote-tracking branch 'origin/master' into HDDS-4033", "committedDate": "2020-07-29T14:36:56Z", "type": "commit"}, {"oid": "6a208ad0858ef1b5c8330247a4ffcbc34962aacb", "url": "https://github.com/apache/ozone/commit/6a208ad0858ef1b5c8330247a4ffcbc34962aacb", "message": "remove duplicated loads", "committedDate": "2020-07-29T14:37:23Z", "type": "commit"}]}