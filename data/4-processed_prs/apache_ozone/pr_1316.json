{"pr_number": 1316, "pr_title": "HDDS-4109. Tests in TestOzoneFileSystem should use the existing MiniOzoneCluster", "pr_createdAt": "2020-08-12T08:22:18Z", "pr_url": "https://github.com/apache/ozone/pull/1316", "timeline": [{"oid": "98c55b70ccf427a595d8ce8a24b6eaa94d3b1718", "url": "https://github.com/apache/ozone/commit/98c55b70ccf427a595d8ce8a24b6eaa94d3b1718", "message": "Tests in TestOzoneFileSystem should use the existing MiniOzoneCluster.\n\nChange-Id: I67ee849cd674b0c3541416bb1f78869541313def", "committedDate": "2020-08-12T08:19:42Z", "type": "commit"}, {"oid": "d0426426f12075cecdb161a7f3ba2d7cf5f1753d", "url": "https://github.com/apache/ozone/commit/d0426426f12075cecdb161a7f3ba2d7cf5f1753d", "message": "Add note.\n\nChange-Id: Iaf8e5feaea00aca5d61c754e8e227f5cf4494cfc", "committedDate": "2020-08-25T16:21:40Z", "type": "commit"}, {"oid": "fac1e371b6fb642811b5dce9b839cf562c34e52a", "url": "https://github.com/apache/ozone/commit/fac1e371b6fb642811b5dce9b839cf562c34e52a", "message": "trigger new CI check", "committedDate": "2020-08-26T08:01:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU3MTcxNQ==", "url": "https://github.com/apache/ozone/pull/1316#discussion_r478571715", "bodyText": "Shouldn't the cleanup be in a finally block? post mkdir if the test fails the directory won't get cleaned up. Wouldn't that affect other tests?", "author": "ayushtkn", "createdAt": "2020-08-27T17:11:56Z", "path": "hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/fs/ozone/TestOzoneFileSystem.java", "diffHunk": "@@ -154,21 +155,21 @@ public void testCreateFileShouldCheckExistenceOfDirWithSameName()\n     } catch (FileAlreadyExistsException fae) {\n       // ignore as its expected\n     }\n+\n+    // Cleanup\n+    fs.delete(new Path(\"/d1/\"), true);", "originalCommit": "fac1e371b6fb642811b5dce9b839cf562c34e52a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODYyMzY4OQ==", "url": "https://github.com/apache/ozone/pull/1316#discussion_r478623689", "bodyText": "Thanks for taking a look at this @ayushtkn .\nIn this case it doesn't matter IMO. Cause if this test (testCreateFileShouldCheckExistenceOfDirWithSameName) fails and throws, testFileSystem as a whole will fail at this point thus the tests following this one won't even be executed.", "author": "smengcl", "createdAt": "2020-08-27T18:45:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU3MTcxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODYzNDM3Ng==", "url": "https://github.com/apache/ozone/pull/1316#discussion_r478634376", "bodyText": "hmm, correct the following tests will fail. Do you think, thats a good behaviour, Ideally only the affected test should fail. If there is a common cluster, that could have been initialised in a BeforeClass and all other tests could have ran independently.\nAnyway not related to what you are doing here. Thanx for confirming.", "author": "ayushtkn", "createdAt": "2020-08-27T19:05:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU3MTcxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcwMDcyOQ==", "url": "https://github.com/apache/ozone/pull/1316#discussion_r478700729", "bodyText": "Yes, I also think @BeforeClass is better. Maybe another jira to refactor the test class this way.", "author": "smengcl", "createdAt": "2020-08-27T21:16:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU3MTcxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODcwMzU3NQ==", "url": "https://github.com/apache/ozone/pull/1316#discussion_r478703575", "bodyText": "Filed https://issues.apache.org/jira/browse/HDDS-4162", "author": "smengcl", "createdAt": "2020-08-27T21:23:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU3MTcxNQ=="}], "type": "inlineReview"}]}