{"pr_number": 1401, "pr_title": "HDDS-3927. Rename Ozone OM,DN,SCM runtime options to conform to naming conventions", "pr_createdAt": "2020-09-05T18:33:15Z", "pr_url": "https://github.com/apache/ozone/pull/1401", "timeline": [{"oid": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd", "url": "https://github.com/apache/ozone/commit/8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd", "message": "HDDS-3927. Rename HDFS_OM_OPTS/HDDS_DN_OPTS to OZONE_MANAGER_OPTS/OZONE_DATANODE_OPTS\n\nChange-Id: I629f87486b62b6a3b7f108addf89ce1ec2bc9e18", "committedDate": "2020-09-05T18:31:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjQzNQ==", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484396435", "bodyText": "I think OZONE_OM_OPTS is aligned with the naming conventions. Especially as it's already working thanks to the\nhadoop_subcommand_opts \"${HADOOP_SHELL_EXECNAME}\" \"${HADOOP_SUBCMD}\"\n\nline.", "author": "elek", "createdAt": "2020-09-07T12:18:05Z", "path": "hadoop-hdds/common/src/main/conf/hadoop-env.sh", "diffHunk": "@@ -400,7 +400,16 @@ export HADOOP_OS_TYPE=${HADOOP_OS_TYPE:-$(uname -s)}\n # These options will be appended to the options specified as HADOOP_OPTS\n # and therefore may override any similar flags set in HADOOP_OPTS\n #\n-# export HDFS_OM_OPTS=\"\"\n+# export OZONE_MANAGER_OPTS=\"\"", "originalCommit": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU4NTg3OQ==", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484585879", "bodyText": "Renamed to OZONE_OM_OPTS", "author": "smengcl", "createdAt": "2020-09-07T23:32:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjQzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjcxNQ==", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484396715", "bodyText": "I think this line is not necessary, because it will be added by\nhadoop_subcommand_opts \"${HADOOP_SHELL_EXECNAME}\" \"${HADOOP_SUBCMD}\"\n\nBut please check it.", "author": "elek", "createdAt": "2020-09-07T12:18:39Z", "path": "hadoop-ozone/dist/src/shell/ozone/ozone", "diffHunk": "@@ -105,8 +105,9 @@ function ozonecmd_case\n       # Corresponding Ratis issue https://issues.apache.org/jira/browse/RATIS-534.\n       # TODO: Fix the problem related to netty resource leak detector throwing\n       # exception as mentioned in HDDS-3812\n-      HDDS_DN_OPTS=\"-Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false -Dorg.apache.ratis.thirdparty.io.netty.leakDetection.level=disabled -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/dn-audit-log4j2.properties ${HDDS_DN_OPTS}\"\n-      HADOOP_OPTS=\"${HADOOP_OPTS} ${HDDS_DN_OPTS}\"\n+      hadoop_deprecate_envvar HDDS_DN_OPTS OZONE_DATANODE_OPTS\n+      OZONE_DATANODE_OPTS=\"-Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false -Dorg.apache.ratis.thirdparty.io.netty.leakDetection.level=disabled -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/dn-audit-log4j2.properties ${OZONE_DATANODE_OPTS}\"\n+      HADOOP_OPTS=\"${HADOOP_OPTS} ${OZONE_DATANODE_OPTS}\"", "originalCommit": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU4NjAzOQ==", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484586039", "bodyText": "Yes looks like HADOOP_OPTS=\"${HADOOP_OPTS} ${OZONE_DATANODE_OPTS}\" is redundant with hadoop_subcommand_opts since we are aligning the OPTS names.\nGood catch!", "author": "smengcl", "createdAt": "2020-09-07T23:33:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjcxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDM5NjkxMQ==", "url": "https://github.com/apache/ozone/pull/1401#discussion_r484396911", "bodyText": "Same as before.", "author": "elek", "createdAt": "2020-09-07T12:19:00Z", "path": "hadoop-ozone/dist/src/shell/ozone/ozone", "diffHunk": "@@ -154,8 +155,9 @@ function ozonecmd_case\n     om)\n       HADOOP_SUBCMD_SUPPORTDAEMONIZATION=\"true\"\n       HADOOP_CLASSNAME=org.apache.hadoop.ozone.om.OzoneManagerStarter\n-      HDFS_OM_OPTS=\"${HDFS_OM_OPTS} -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/om-audit-log4j2.properties\"\n-      HADOOP_OPTS=\"${HADOOP_OPTS} ${HDFS_OM_OPTS}\"\n+      hadoop_deprecate_envvar HDFS_OM_OPTS OZONE_MANAGER_OPTS\n+      OZONE_MANAGER_OPTS=\"${OZONE_MANAGER_OPTS} -Dlog4j.configurationFile=${HADOOP_CONF_DIR}/om-audit-log4j2.properties\"\n+      HADOOP_OPTS=\"${HADOOP_OPTS} ${OZONE_MANAGER_OPTS}\"", "originalCommit": "8e5bfc24e6e3abfc9f7d7b3b18998f014b9b0fdd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "350b98b5f8c4400e19cd481e8681da101b4e7674", "url": "https://github.com/apache/ozone/commit/350b98b5f8c4400e19cd481e8681da101b4e7674", "message": "Conform to hadoop_subcommand_opts's OPTS naming conventions.\n\nChange-Id: I67259db97eabf04a55b9b5bbc582a6e5732cdb58", "committedDate": "2020-09-07T23:35:37Z", "type": "commit"}]}