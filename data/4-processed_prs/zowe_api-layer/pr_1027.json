{"pr_number": 1027, "pr_title": " Checking SAF resource via REST endpoint", "pr_createdAt": "2020-12-18T16:40:10Z", "pr_url": "https://github.com/zowe/api-layer/pull/1027", "timeline": [{"oid": "e8d8450dc915c1523b1ca4d75b59007598f34fcd", "url": "https://github.com/zowe/api-layer/commit/e8d8450dc915c1523b1ca4d75b59007598f34fcd", "message": " EndpointVerifier\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-12-18T16:31:49Z", "type": "commit"}, {"oid": "64b160b8529f4c1d60f969bebf7df33d455b2903", "url": "https://github.com/zowe/api-layer/commit/64b160b8529f4c1d60f969bebf7df33d455b2903", "message": "Merge branch 'master' into protectors/endpointVerifier", "committedDate": "2020-12-22T12:52:52Z", "type": "commit"}, {"oid": "f8c5a5901b409b54d850824d111becdf3dfc793f", "url": "https://github.com/zowe/api-layer/commit/f8c5a5901b409b54d850824d111becdf3dfc793f", "message": "Merge branch 'master' into protectors/endpointVerifier", "committedDate": "2020-12-22T23:36:41Z", "type": "commit"}, {"oid": "882551183f3625129ea2ee2cc1b9f11399814570", "url": "https://github.com/zowe/api-layer/commit/882551183f3625129ea2ee2cc1b9f11399814570", "message": "fix merge\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-12-22T23:51:45Z", "type": "commit"}, {"oid": "5c06a229b802ca56dd5e0b94f277b231b944a74d", "url": "https://github.com/zowe/api-layer/commit/5c06a229b802ca56dd5e0b94f277b231b944a74d", "message": "sonar suppress warning\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-12-23T00:08:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgyOTM3MA==", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r547829370", "bodyText": "Does it make sense to use conditional @configuration instead?", "author": "JirkaAichler", "createdAt": "2020-12-23T09:00:53Z", "path": "apiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessConfig.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.security.common.auth.saf;\n+\n+import lombok.extern.slf4j.Slf4j;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.web.client.RestTemplate;\n+\n+import java.io.IOException;\n+\n+@Configuration\n+@Slf4j\n+public class SafResourceAccessConfig {\n+\n+    @Value(\"${apiml.security.safEndpoint.enabled:false}\")", "originalCommit": "5c06a229b802ca56dd5e0b94f277b231b944a74d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE1MTAwMw==", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r551151003", "bodyText": "There will be multiple implementations, at least one depends on the existing class. I guess the conditions will be too difficult.", "author": "pj892031", "createdAt": "2021-01-04T07:23:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgyOTM3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzMTI0NA==", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r547831244", "bodyText": "You don't need to suppress it when you name your constant with URL instead of `PATH'.", "author": "JirkaAichler", "createdAt": "2020-12-23T09:03:05Z", "path": "apiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessEndpoint.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.security.common.auth.saf;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Data;\n+import lombok.RequiredArgsConstructor;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.web.client.RestTemplate;\n+\n+@RequiredArgsConstructor\n+public class SafResourceAccessEndpoint implements SafResourceAccessVerifying {\n+\n+    @SuppressWarnings(\"squid:S1075\")", "originalCommit": "5c06a229b802ca56dd5e0b94f277b231b944a74d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE2MjY2NA==", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r551162664", "bodyText": "You are right, it is done now", "author": "pj892031", "createdAt": "2021-01-04T07:59:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzMTI0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzNTIzNA==", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r547835234", "bodyText": "Shouldn't you set some default value to make sure that it is not null or empty? Can you obtain it from Zowe installation so it does not have to be configured manually?", "author": "JirkaAichler", "createdAt": "2020-12-23T09:07:38Z", "path": "apiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessEndpoint.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.security.common.auth.saf;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Data;\n+import lombok.RequiredArgsConstructor;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.web.client.RestTemplate;\n+\n+@RequiredArgsConstructor\n+public class SafResourceAccessEndpoint implements SafResourceAccessVerifying {\n+\n+    @SuppressWarnings(\"squid:S1075\")\n+    private static final String PATH_VRIABLE_SUFFIX = \"/{userId}/{class}/{entity}/{level}\";\n+\n+    @Value(\"${apiml.security.safEndpoint.url}\")", "originalCommit": "5c06a229b802ca56dd5e0b94f277b231b944a74d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE2Mjc2MQ==", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r551162761", "bodyText": "fixed with a default value of ZSS.", "author": "pj892031", "createdAt": "2021-01-04T07:59:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzNTIzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzNzE1MQ==", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r547837151", "bodyText": "I am lazy to check the code myself so I am just asking. Is it protected by HTTPS? I somehow thought there are multiple RestTemplate beans.", "author": "JirkaAichler", "createdAt": "2020-12-23T09:09:48Z", "path": "apiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessEndpoint.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+package org.zowe.apiml.security.common.auth.saf;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Data;\n+import lombok.RequiredArgsConstructor;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.security.core.Authentication;\n+import org.springframework.web.client.RestTemplate;\n+\n+@RequiredArgsConstructor\n+public class SafResourceAccessEndpoint implements SafResourceAccessVerifying {\n+\n+    @SuppressWarnings(\"squid:S1075\")\n+    private static final String PATH_VRIABLE_SUFFIX = \"/{userId}/{class}/{entity}/{level}\";\n+\n+    @Value(\"${apiml.security.safEndpoint.url}\")\n+    private String endpointUrl;\n+\n+    private final RestTemplate restTemplate;", "originalCommit": "5c06a229b802ca56dd5e0b94f277b231b944a74d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQ4NTM1Nw==", "url": "https://github.com/zowe/api-layer/pull/1027#discussion_r550485357", "bodyText": "I think at this stage, http or https depends on the type of endpoint that will serve the API. Not on the consumer. I think it can stay like this until further refinement is needed.", "author": "jandadav", "createdAt": "2020-12-31T13:40:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzgzNzE1MQ=="}], "type": "inlineReview"}, {"oid": "219bd0c3e0a5f3338b972811dd0234b33dad3b6b", "url": "https://github.com/zowe/api-layer/commit/219bd0c3e0a5f3338b972811dd0234b33dad3b6b", "message": "Merge branch 'master' into protectors/endpointVerifier\n\n# Conflicts:\n#\tapiml-security-common/src/main/java/org/zowe/apiml/security/common/auth/saf/SafResourceAccessConfig.java", "committedDate": "2020-12-31T12:59:40Z", "type": "commit"}, {"oid": "acb9c646b60342f348b97349c05408952f23b89a", "url": "https://github.com/zowe/api-layer/commit/acb9c646b60342f348b97349c05408952f23b89a", "message": "fix null pointer sonar bug\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-12-31T13:13:14Z", "type": "commit"}, {"oid": "eba44051e504ca445303b62629c673299ab53980", "url": "https://github.com/zowe/api-layer/commit/eba44051e504ca445303b62629c673299ab53980", "message": "Merge branch 'master' into protectors/endpointVerifier", "committedDate": "2020-12-31T14:14:34Z", "type": "commit"}, {"oid": "ce0c419aa63fafd1f0a98f9c7a26c164f6f06525", "url": "https://github.com/zowe/api-layer/commit/ce0c419aa63fafd1f0a98f9c7a26c164f6f06525", "message": "attempt to fix default value and sonar issue\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2021-01-04T07:49:17Z", "type": "commit"}, {"oid": "8837cfcd9a914a7ce6b766548273f0a3edc30648", "url": "https://github.com/zowe/api-layer/commit/8837cfcd9a914a7ce6b766548273f0a3edc30648", "message": "Merge branch 'master' into protectors/endpointVerifier", "committedDate": "2021-01-04T07:59:56Z", "type": "commit"}]}