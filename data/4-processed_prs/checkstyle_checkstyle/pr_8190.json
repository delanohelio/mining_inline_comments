{"pr_number": 8190, "pr_title": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "pr_createdAt": "2020-04-26T00:47:23Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8190", "timeline": [{"oid": "56be00a55499b3ca195a479ed43a4acec367909a", "url": "https://github.com/checkstyle/checkstyle/commit/56be00a55499b3ca195a479ed43a4acec367909a", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-04-29T20:57:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MDQzNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418440436", "bodyText": "assignment -> assignmentS", "author": "strkkk", "createdAt": "2020-05-01T06:59:53Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -32,19 +32,28 @@\n  * {@code String s = Integer.toString(i = 2);}.\n  * </p>\n  * <p>\n- * Rationale: With the exception of {@code for} iterators and assignment in {@code while} idiom,\n+ * Rationale: With the exception of loop idioms,\n  * all assignments should occur in their own top-level statement to increase readability.\n  * With inner assignments like the one given above, it is difficult to see all places\n  * where a variable is set.\n  * </p>\n  * <p>\n- * Note: Check allows usage of the popular assignment in {@code while} idiom:\n+ * Note: Check allows usage of the popular assignment in loops:", "originalCommit": "56be00a55499b3ca195a479ed43a4acec367909a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4MjE1OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418982158", "bodyText": "done", "author": "DXTkastb", "createdAt": "2020-05-02T17:03:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MDQzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MDgzNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418440834", "bodyText": "please keep indentation for code = 2 and add enclosing class for this example", "author": "strkkk", "createdAt": "2020-05-01T07:02:02Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -32,19 +32,28 @@\n  * {@code String s = Integer.toString(i = 2);}.\n  * </p>\n  * <p>\n- * Rationale: With the exception of {@code for} iterators and assignment in {@code while} idiom,\n+ * Rationale: With the exception of loop idioms,\n  * all assignments should occur in their own top-level statement to increase readability.\n  * With inner assignments like the one given above, it is difficult to see all places\n  * where a variable is set.\n  * </p>\n  * <p>\n- * Note: Check allows usage of the popular assignment in {@code while} idiom:\n+ * Note: Check allows usage of the popular assignment in loops:\n  * </p>\n  * <pre>\n  * String line;\n- * while ((line = bufferedReader.readLine()) != null) {\n- *   // process the line\n+ * while ((line = bufferedReader.readLine()) != null) { // OK\n+ *     // process the line", "originalCommit": "56be00a55499b3ca195a479ed43a4acec367909a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4MjE3OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418982178", "bodyText": "done", "author": "DXTkastb", "createdAt": "2020-05-02T17:03:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MDgzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTA5OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418441098", "bodyText": "!((line = file.read()) != null)\nNo need for additional example complications, make simple like in while example", "author": "strkkk", "createdAt": "2020-05-01T07:03:16Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -32,19 +32,28 @@\n  * {@code String s = Integer.toString(i = 2);}.\n  * </p>\n  * <p>\n- * Rationale: With the exception of {@code for} iterators and assignment in {@code while} idiom,\n+ * Rationale: With the exception of loop idioms,\n  * all assignments should occur in their own top-level statement to increase readability.\n  * With inner assignments like the one given above, it is difficult to see all places\n  * where a variable is set.\n  * </p>\n  * <p>\n- * Note: Check allows usage of the popular assignment in {@code while} idiom:\n+ * Note: Check allows usage of the popular assignment in loops:\n  * </p>\n  * <pre>\n  * String line;\n- * while ((line = bufferedReader.readLine()) != null) {\n- *   // process the line\n+ * while ((line = bufferedReader.readLine()) != null) { // OK\n+ *     // process the line\n  * }\n+ *\n+ * for (;!((line = file.read()) != null);) { // OK", "originalCommit": "56be00a55499b3ca195a479ed43a4acec367909a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk3NjIzMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418976230", "bodyText": "Done. I just want to let you know that this example was taken from while examples, and I haven't removed that yet, ok.", "author": "DXTkastb", "createdAt": "2020-05-02T16:08:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTA5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk5MTQwMw==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418991403", "bodyText": "it remains the same", "author": "strkkk", "createdAt": "2020-05-02T18:26:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTA5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAwOTg5MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r419009890", "bodyText": "Done. I am extremely sorry, at first glance I thought it was required to remove this test in test inputs. I have readded the test(in test inputs) and made changes in the Javadoc.", "author": "DXTkastb", "createdAt": "2020-05-02T21:26:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTA5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAxMDQwOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r419010409", "bodyText": "please take a look now. Also, I have posted the new screenshot.", "author": "DXTkastb", "createdAt": "2020-05-02T21:30:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTA5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTEyNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418441127", "bodyText": "same here", "author": "strkkk", "createdAt": "2020-05-01T07:03:24Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -32,19 +32,28 @@\n  * {@code String s = Integer.toString(i = 2);}.\n  * </p>\n  * <p>\n- * Rationale: With the exception of {@code for} iterators and assignment in {@code while} idiom,\n+ * Rationale: With the exception of loop idioms,\n  * all assignments should occur in their own top-level statement to increase readability.\n  * With inner assignments like the one given above, it is difficult to see all places\n  * where a variable is set.\n  * </p>\n  * <p>\n- * Note: Check allows usage of the popular assignment in {@code while} idiom:\n+ * Note: Check allows usage of the popular assignment in loops:\n  * </p>\n  * <pre>\n  * String line;\n- * while ((line = bufferedReader.readLine()) != null) {\n- *   // process the line\n+ * while ((line = bufferedReader.readLine()) != null) { // OK\n+ *     // process the line\n  * }\n+ *\n+ * for (;!((line = file.read()) != null);) { // OK\n+ *     // process the line\n+ * }\n+ *\n+ * do {\n+ *     // process the line\n+ * }\n+ * while (!((line = file.read()) != null)); // OK", "originalCommit": "56be00a55499b3ca195a479ed43a4acec367909a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4MjYwNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418982605", "bodyText": "done", "author": "DXTkastb", "createdAt": "2020-05-02T17:07:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk5MTQxNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418991417", "bodyText": "this one as well", "author": "strkkk", "createdAt": "2020-05-02T18:26:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTEyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAwOTg4NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r419009885", "bodyText": "done", "author": "DXTkastb", "createdAt": "2020-05-02T21:26:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTEyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTQxNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418441414", "bodyText": "please remove whitespaces before right curly for 2 lines above to make it look consistent", "author": "strkkk", "createdAt": "2020-05-01T07:04:49Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -147,7 +156,9 @@\n      * towards the root.\n      */\n     private static final int[][] ALLOWED_ASSIGNMENT_IN_COMPARISON_CONTEXT = {\n-        {TokenTypes.EXPR, TokenTypes.LITERAL_WHILE, },\n+            {TokenTypes.EXPR, TokenTypes.LITERAL_WHILE, },\n+            {TokenTypes.EXPR, TokenTypes.FOR_CONDITION, },", "originalCommit": "56be00a55499b3ca195a479ed43a4acec367909a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4MzE4NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418983185", "bodyText": "done", "author": "DXTkastb", "createdAt": "2020-05-02T17:12:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTQxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTcyMg==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418441722", "bodyText": "please make indentation here 2 as well, like in javadoc for class", "author": "strkkk", "createdAt": "2020-05-01T07:06:34Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -255,11 +266,14 @@ private static boolean isInNoBraceControlStatement(DetailAST ast) {\n     }\n \n     /**\n-     * Tests whether the given AST is used in the \"assignment in while\" idiom.\n+     * Tests whether the given AST is used in the \"assignment in loop\" idiom.\n      * <pre>\n      * String line;\n      * while ((line = bufferedReader.readLine()) != null) {\n-     *    // process the line\n+     *     // process the line\n+     * }\n+     * for (;(value = reader.read()) != 0;) {\n+     *     // process", "originalCommit": "56be00a55499b3ca195a479ed43a4acec367909a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4MzE5OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418983199", "bodyText": "done", "author": "DXTkastb", "createdAt": "2020-05-02T17:12:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTcyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk5MTU4Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418991582", "bodyText": "not changed. Please also see line 273 for same issue", "author": "strkkk", "createdAt": "2020-05-02T18:27:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTcyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAwOTk4MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r419009981", "bodyText": "done. please review the update", "author": "DXTkastb", "createdAt": "2020-05-02T21:26:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MTcyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MjU2MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418442560", "bodyText": "will it report violation for weird case like\nString a = \"\";\nfor (;;(a = \"das\").concat()) {}\n\n?\nIt can be added to test inputs", "author": "strkkk", "createdAt": "2020-05-01T07:10:44Z", "path": "src/test/resources/com/puppycrawl/tools/checkstyle/checks/coding/innerassignment/InputInnerAssignment.java", "diffHunk": "@@ -128,5 +128,47 @@ void method() throws IOException {\n         while (line < 3 || (line = file.read()) != null) {}\n         while (line < 3 & (line = file.read()) != null) {}\n         while (line < 3 | (line = file.read()) != null) {}\n+\n+        do{}\n+        while (!((line = file.read()) != null));\n+        do{}\n+        while ((line = file.read()) != null && line < 3);\n+        do{}\n+        while ((line = file.read()) != null && line < 3 && line > 5);\n+        do{}\n+        while ((line = file.read()) != null || line < 3);\n+        do{}\n+        while ((line = file.read()) != null || line < 3 || line > 5);\n+        do{}\n+        while ((line = file.read()) != null & line < 3);\n+        do{}\n+        while ((line = file.read()) != null & line < 3 & line > 5);\n+        do{}\n+        while ((line = file.read()) != null | line < 3);\n+        do{}\n+        while ((line = file.read()) != null | line < 3 | line > 5);\n+        do{}\n+        while (line < 3 && (line = file.read()) != null);\n+        do{}\n+        while (line < 3 || (line = file.read()) != null);\n+        do{}\n+        while (line < 3 & (line = file.read()) != null);\n+        do{}\n+        while (line < 3 | (line = file.read()) != null);\n+\n+        for (;!((line = file.read()) != null);) {}\n+        for (;(line = file.read()) != null && line < 3;) {}\n+        for (;(line = file.read()) != null && line < 3 && line > 5;) {}\n+        for (;(line = file.read()) != null || line < 3;) {}\n+        for (;(line = file.read()) != null || line < 3 || line > 5;) {}\n+        for (;(line = file.read()) != null & line < 3;) {}\n+        for (;(line = file.read()) != null & line < 3 & line > 5;) {}\n+        for (;(line = file.read()) != null | line < 3;) {}\n+        for (;(line = file.read()) != null | line < 3 | line > 5;) {}\n+        for (;line < 3 && (line = file.read()) != null;) {}\n+        for (;line < 3 || (line = file.read()) != null;) {}\n+        for (;line < 3 & (line = file.read()) != null;) {}\n+        for (;line < 3 | (line = file.read()) != null;) {}\n+", "originalCommit": "56be00a55499b3ca195a479ed43a4acec367909a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY5ODY4OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418698688", "bodyText": "will it report violation for weird case like\nString a = \"\";\nfor (;;(a = \"das\").concat()) {}\n\n\n@strkkk my patch is reporting violation for these kinds of cases, should these be omitted? ( I am not sure if this is a good way of assigning variables)", "author": "DXTkastb", "createdAt": "2020-05-01T19:26:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MjU2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk5MTMwMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r418991301", "bodyText": "This is definitely not the best idea to do like this.\nI think it is ok to report violation in such case. Please add it to test inputs", "author": "strkkk", "createdAt": "2020-05-02T18:24:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MjU2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTAwOTg2Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r419009863", "bodyText": "done", "author": "DXTkastb", "createdAt": "2020-05-02T21:25:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ0MjU2MA=="}], "type": "inlineReview"}, {"oid": "768b0b1a62ee7277e4f2866dd5f374a73430768b", "url": "https://github.com/checkstyle/checkstyle/commit/768b0b1a62ee7277e4f2866dd5f374a73430768b", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-05-02T16:03:50Z", "type": "forcePushed"}, {"oid": "c5b9cbed450e72ecbf9044babc419c1df58fe599", "url": "https://github.com/checkstyle/checkstyle/commit/c5b9cbed450e72ecbf9044babc419c1df58fe599", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-05-02T16:10:27Z", "type": "forcePushed"}, {"oid": "446c13dae057fdd97d2eafda28e6d47685238a78", "url": "https://github.com/checkstyle/checkstyle/commit/446c13dae057fdd97d2eafda28e6d47685238a78", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-05-02T17:06:57Z", "type": "forcePushed"}, {"oid": "af8902cf2a08aea9da3d9e4024a4dcb5cf74e008", "url": "https://github.com/checkstyle/checkstyle/commit/af8902cf2a08aea9da3d9e4024a4dcb5cf74e008", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-05-02T21:23:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTA2NTcyNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r419065726", "bodyText": "please add // violation comment", "author": "strkkk", "createdAt": "2020-05-03T08:04:12Z", "path": "src/test/resources/com/puppycrawl/tools/checkstyle/checks/coding/innerassignment/InputInnerAssignment.java", "diffHunk": "@@ -128,5 +128,50 @@ void method() throws IOException {\n         while (line < 3 || (line = file.read()) != null) {}\n         while (line < 3 & (line = file.read()) != null) {}\n         while (line < 3 | (line = file.read()) != null) {}\n+\n+        do{}\n+        while (!((line = file.read()) != null));\n+        do{}\n+        while ((line = file.read()) != null && line < 3);\n+        do{}\n+        while ((line = file.read()) != null && line < 3 && line > 5);\n+        do{}\n+        while ((line = file.read()) != null || line < 3);\n+        do{}\n+        while ((line = file.read()) != null || line < 3 || line > 5);\n+        do{}\n+        while ((line = file.read()) != null & line < 3);\n+        do{}\n+        while ((line = file.read()) != null & line < 3 & line > 5);\n+        do{}\n+        while ((line = file.read()) != null | line < 3);\n+        do{}\n+        while ((line = file.read()) != null | line < 3 | line > 5);\n+        do{}\n+        while (line < 3 && (line = file.read()) != null);\n+        do{}\n+        while (line < 3 || (line = file.read()) != null);\n+        do{}\n+        while (line < 3 & (line = file.read()) != null);\n+        do{}\n+        while (line < 3 | (line = file.read()) != null);\n+\n+        for (;!((line = file.read()) != null);) {}\n+        for (;(line = file.read()) != null && line < 3;) {}\n+        for (;(line = file.read()) != null && line < 3 && line > 5;) {}\n+        for (;(line = file.read()) != null || line < 3;) {}\n+        for (;(line = file.read()) != null || line < 3 || line > 5;) {}\n+        for (;(line = file.read()) != null & line < 3;) {}\n+        for (;(line = file.read()) != null & line < 3 & line > 5;) {}\n+        for (;(line = file.read()) != null | line < 3;) {}\n+        for (;(line = file.read()) != null | line < 3 | line > 5;) {}\n+        for (;line < 3 && (line = file.read()) != null;) {}\n+        for (;line < 3 || (line = file.read()) != null;) {}\n+        for (;line < 3 & (line = file.read()) != null;) {}\n+        for (;line < 3 | (line = file.read()) != null;) {}\n+\n+        String str1 = \"\";\n+        String str2 = \"cd\";\n+        for (;;(str1 = \"ab\").concat(str2)) {}", "originalCommit": "af8902cf2a08aea9da3d9e4024a4dcb5cf74e008", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTA5NDQ0Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r419094447", "bodyText": "done. please review", "author": "DXTkastb", "createdAt": "2020-05-03T12:09:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTA2NTcyNg=="}], "type": "inlineReview"}, {"oid": "367e1e7d68065333a9dedd17ed9dca4b96bd2c98", "url": "https://github.com/checkstyle/checkstyle/commit/367e1e7d68065333a9dedd17ed9dca4b96bd2c98", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-05-03T12:08:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MTU2NA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r426961564", "bodyText": "I find it odd that the while and do while use bufferedReader for their examples but the for loop does something else which I question if it really is a \"popular\" assignment. You assign flag a constant right before the condition check, while the others receive the result from a method that can be variable.", "author": "rnveach", "createdAt": "2020-05-19T00:23:15Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -32,19 +32,29 @@\n  * {@code String s = Integer.toString(i = 2);}.\n  * </p>\n  * <p>\n- * Rationale: With the exception of {@code for} iterators and assignment in {@code while} idiom,\n+ * Rationale: With the exception of loop idioms,\n  * all assignments should occur in their own top-level statement to increase readability.\n  * With inner assignments like the one given above, it is difficult to see all places\n  * where a variable is set.\n  * </p>\n  * <p>\n- * Note: Check allows usage of the popular assignment in {@code while} idiom:\n+ * Note: Check allows usage of the popular assignments in loops:\n  * </p>\n  * <pre>\n  * String line;\n- * while ((line = bufferedReader.readLine()) != null) {\n+ * while ((line = bufferedReader.readLine()) != null) { // OK\n  *   // process the line\n  * }\n+ *\n+ * int flag;\n+ * for (;(flag = 1) &lt;= 0;) { // OK", "originalCommit": "367e1e7d68065333a9dedd17ed9dca4b96bd2c98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2Mzk0NA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r426963944", "bodyText": "https://dxtkastb.github.io/innerassignment/diff/Hbase/xref/home/kaustubh/ck/contribution-master/checkstyle-tester/repositories/Hbase/hbase-common/src/main/java/org/apache/hadoop/hbase/util/Base64.java.html#L950\nI see this as a good example.", "author": "rnveach", "createdAt": "2020-05-19T00:32:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MTU2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEwNTcxNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r427105717", "bodyText": "I find it odd that the while and do while use bufferedReader for their examples but the for loop does something else which I question if it really is a \"popular\" assignment. You assign flag a constant right before the condition check, while the others receive the result from a method that can be variable.\n\nI thought using bufferedReader in examples is going a bit monotonous, nonetheless I will update the example", "author": "DXTkastb", "createdAt": "2020-05-19T08:02:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MTU2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjE5MDkwNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526190904", "bodyText": "the same code is used", "author": "romani", "createdAt": "2020-11-18T15:45:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MTU2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MTk1OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r426961958", "bodyText": "The opposite of above. Why not make both examples the same?\nAlso why did we add the for loop example but not the do-while?", "author": "rnveach", "createdAt": "2020-05-19T00:24:50Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -255,11 +267,14 @@ private static boolean isInNoBraceControlStatement(DetailAST ast) {\n     }\n \n     /**\n-     * Tests whether the given AST is used in the \"assignment in while\" idiom.\n+     * Tests whether the given AST is used in the \"assignment in loop\" idiom.\n      * <pre>\n      * String line;\n      * while ((line = bufferedReader.readLine()) != null) {\n-     *    // process the line\n+     *   // process the line\n+     * }\n+     * for (;(line = bufferedReader.readLine()) != null;) {", "originalCommit": "367e1e7d68065333a9dedd17ed9dca4b96bd2c98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzEyMDc3OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r427120778", "bodyText": "The opposite of above. Why not make both examples the same?\n\nMy apologies, I couldn't understand this remark. Should I add a different kind of example for each type of loop or I just use any one loop as an example?\n\nAlso why did we add the for loop example but not the do-while?\n\nThere isn't a specific reason, I thought this would be enough for explanatory purposes, I'll add the do-while example.", "author": "DXTkastb", "createdAt": "2020-05-19T08:26:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MTk1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjE5MDgyNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526190827", "bodyText": "the same code is used", "author": "romani", "createdAt": "2020-11-18T15:45:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MTk1OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MjQxOA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r426962418", "bodyText": "Just a question, this should be another issue if it is identified as one.\nWill I atleast get a violation if I change line < 3 to line = 3 (assignment and not equals)?", "author": "rnveach", "createdAt": "2020-05-19T00:26:34Z", "path": "src/test/resources/com/puppycrawl/tools/checkstyle/checks/coding/innerassignment/InputInnerAssignment.java", "diffHunk": "@@ -128,5 +128,50 @@ void method() throws IOException {\n         while (line < 3 || (line = file.read()) != null) {}\n         while (line < 3 & (line = file.read()) != null) {}\n         while (line < 3 | (line = file.read()) != null) {}\n+\n+        do{}\n+        while (!((line = file.read()) != null));\n+        do{}\n+        while ((line = file.read()) != null && line < 3);", "originalCommit": "367e1e7d68065333a9dedd17ed9dca4b96bd2c98", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzExMjAxNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r427112015", "bodyText": "Changing line < 3 to line = 3  will cause compiler error as it expects some boolean expression associated with &&  operator", "author": "DXTkastb", "createdAt": "2020-05-19T08:13:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjk2MjQxOA=="}], "type": "inlineReview"}, {"oid": "8743c65b7b4f3664b21fda94de0a19715c73d3cd", "url": "https://github.com/checkstyle/checkstyle/commit/8743c65b7b4f3664b21fda94de0a19715c73d3cd", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-06-29T20:32:29Z", "type": "forcePushed"}, {"oid": "05e8423cb0c0ab68282f6a24ed109e67d04f8901", "url": "https://github.com/checkstyle/checkstyle/commit/05e8423cb0c0ab68282f6a24ed109e67d04f8901", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-11-17T15:01:55Z", "type": "forcePushed"}, {"oid": "088f9c9c14f30ccdb1ebc6295ac48b497f8f2e26", "url": "https://github.com/checkstyle/checkstyle/commit/088f9c9c14f30ccdb1ebc6295ac48b497f8f2e26", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-11-18T15:43:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU0ODI2Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526548266", "bodyText": "Can we put the indentation back since there was no real change here?", "author": "rnveach", "createdAt": "2020-11-19T02:18:09Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -158,7 +167,9 @@\n      * towards the root.\n      */\n     private static final int[][] ALLOWED_ASSIGNMENT_IN_COMPARISON_CONTEXT = {\n-        {TokenTypes.EXPR, TokenTypes.LITERAL_WHILE, },\n+            {TokenTypes.EXPR, TokenTypes.LITERAL_WHILE},", "originalCommit": "088f9c9c14f30ccdb1ebc6295ac48b497f8f2e26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk0NTkzNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526945934", "bodyText": "fixed", "author": "romani", "createdAt": "2020-11-19T14:50:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU0ODI2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU0ODc3MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526548770", "bodyText": "while checking\n\nThis original wording is the correct usage. It is using the word as a \u00bfconjunction? instead of talking about the Java while keyword.", "author": "rnveach", "createdAt": "2020-11-19T02:19:47Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -174,9 +185,9 @@\n     };\n \n     /**\n-     * The token types that are ignored while checking \"while-idiom\".\n+     * The token types that are ignored loop checking \"loop-idiom\".", "originalCommit": "088f9c9c14f30ccdb1ebc6295ac48b497f8f2e26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk0NjAyNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526946025", "bodyText": "fixed", "author": "romani", "createdAt": "2020-11-19T14:50:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU0ODc3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU0OTE0Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526549142", "bodyText": "Please add space after do.", "author": "rnveach", "createdAt": "2020-11-19T02:20:56Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -266,12 +277,19 @@ private static boolean isInNoBraceControlStatement(DetailAST ast) {\n     }\n \n     /**\n-     * Tests whether the given AST is used in the \"assignment in while\" idiom.\n+     * Tests whether the given AST is used in the \"assignment in loop\" idiom.\n      * <pre>\n      * String line;\n      * while ((line = bufferedReader.readLine()) != null) {\n-     *    // process the line\n+     *   // process the line\n+     * }\n+     * for (;(line = bufferedReader.readLine()) != null;) {\n+     *   // process the line\n+     * }\n+     * do{", "originalCommit": "088f9c9c14f30ccdb1ebc6295ac48b497f8f2e26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk0NjEyMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526946121", "bodyText": "fixed", "author": "romani", "createdAt": "2020-11-19T14:50:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU0OTE0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU0OTIxOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526549219", "bodyText": "Same here after while.", "author": "rnveach", "createdAt": "2020-11-19T02:21:16Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/InnerAssignmentCheck.java", "diffHunk": "@@ -266,12 +277,19 @@ private static boolean isInNoBraceControlStatement(DetailAST ast) {\n     }\n \n     /**\n-     * Tests whether the given AST is used in the \"assignment in while\" idiom.\n+     * Tests whether the given AST is used in the \"assignment in loop\" idiom.\n      * <pre>\n      * String line;\n      * while ((line = bufferedReader.readLine()) != null) {\n-     *    // process the line\n+     *   // process the line\n+     * }\n+     * for (;(line = bufferedReader.readLine()) != null;) {\n+     *   // process the line\n+     * }\n+     * do{\n+     *   // process the line\n      * }\n+     * while((line = bufferedReader.readLine()) != null);", "originalCommit": "088f9c9c14f30ccdb1ebc6295ac48b497f8f2e26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk0NjIyMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8190#discussion_r526946220", "bodyText": "fixed", "author": "romani", "createdAt": "2020-11-19T14:50:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU0OTIxOQ=="}], "type": "inlineReview"}, {"oid": "296c4365ee885e24377ac5ad67e693be5d8feda1", "url": "https://github.com/checkstyle/checkstyle/commit/296c4365ee885e24377ac5ad67e693be5d8feda1", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-11-19T14:49:12Z", "type": "forcePushed"}, {"oid": "98f5361aa45d991724146f1aa85aba7bcff3390f", "url": "https://github.com/checkstyle/checkstyle/commit/98f5361aa45d991724146f1aa85aba7bcff3390f", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-11-21T16:20:20Z", "type": "commit"}, {"oid": "98f5361aa45d991724146f1aa85aba7bcff3390f", "url": "https://github.com/checkstyle/checkstyle/commit/98f5361aa45d991724146f1aa85aba7bcff3390f", "message": "Issue #6915: InnerAssignment: false positives on for and do-while loops", "committedDate": "2020-11-21T16:20:20Z", "type": "forcePushed"}]}