{"pr_number": 8920, "pr_title": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "pr_createdAt": "2020-10-24T17:35:18Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8920", "timeline": [{"oid": "f1c41cdc2e7d8785d3d96f417bc05933e7e82c8e", "url": "https://github.com/checkstyle/checkstyle/commit/f1c41cdc2e7d8785d3d96f417bc05933e7e82c8e", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-24T18:01:40Z", "type": "forcePushed"}, {"oid": "e23550d8a7024f17900ad0e8b89f406c4ade334c", "url": "https://github.com/checkstyle/checkstyle/commit/e23550d8a7024f17900ad0e8b89f406c4ade334c", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-24T18:09:33Z", "type": "forcePushed"}, {"oid": "bead59275f1f0a46ae29a16e3aa97f9f10aa4b07", "url": "https://github.com/checkstyle/checkstyle/commit/bead59275f1f0a46ae29a16e3aa97f9f10aa4b07", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-24T18:52:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTUwMzAyNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r511503027", "bodyText": "Remaining travis failure is due to spellcheck failing on \"nmancus\", which will be removed after checkstyle/contribution#516", "author": "nmancus1", "createdAt": "2020-10-24T18:57:54Z", "path": ".ci/no-exception-test.sh", "diffHunk": "@@ -53,6 +53,35 @@ guava-with-sun-checks)\n   rm sun_checks.*\n   ;;\n \n+openjdk14-with-checks-nonjavadoc-error)\n+  CS_POM_VERSION=$(mvn -e -q -Dexec.executable='echo' -Dexec.args='${project.version}' \\\n+                     --non-recursive org.codehaus.mojo:exec-maven-plugin:1.3.1:exec)\n+  echo CS_version: $CS_POM_VERSION\n+  mkdir -p .ci-temp/\n+  cd .ci-temp/\n+  # activate below line after https://github.com/checkstyle/contribution/pull/516\n+  # git clone https://github.com/checkstyle/contribution\n+  # need to remove below line after https://github.com/checkstyle/contribution/pull/516\n+  git clone https://github.com/nmancus1/contribution.git", "originalCommit": "bead59275f1f0a46ae29a16e3aa97f9f10aa4b07", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "56ffc8d56ef87fb6b131851e51d8a1a4b470b10d", "url": "https://github.com/checkstyle/checkstyle/commit/56ffc8d56ef87fb6b131851e51d8a1a4b470b10d", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-24T19:49:28Z", "type": "forcePushed"}, {"oid": "cf1b208b9004083b1413ac2199b34c64f837f0c7", "url": "https://github.com/checkstyle/checkstyle/commit/cf1b208b9004083b1413ac2199b34c64f837f0c7", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-24T20:12:42Z", "type": "forcePushed"}, {"oid": "bf356400389e18b5289c02cde87358f33aaa353a", "url": "https://github.com/checkstyle/checkstyle/commit/bf356400389e18b5289c02cde87358f33aaa353a", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-25T15:57:12Z", "type": "forcePushed"}, {"oid": "0623f34a840aa17bed22c03f7b843a469d8199f1", "url": "https://github.com/checkstyle/checkstyle/commit/0623f34a840aa17bed22c03f7b843a469d8199f1", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-27T02:25:51Z", "type": "forcePushed"}, {"oid": "f87e856148c7e1744e733a80afe920369199051e", "url": "https://github.com/checkstyle/checkstyle/commit/f87e856148c7e1744e733a80afe920369199051e", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-27T03:02:36Z", "type": "forcePushed"}, {"oid": "c1500c828b3a32d4f0a45f444a9d698f1f8eb4fd", "url": "https://github.com/checkstyle/checkstyle/commit/c1500c828b3a32d4f0a45f444a9d698f1f8eb4fd", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-27T16:30:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUwODQwOA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r513508408", "bodyText": "please change extension of file to \".config\" to skip this file from any tool that try to validate it.\nI do not remember why we named it as \".properties\", probably very first version of file was based on properties.", "author": "romani", "createdAt": "2020-10-28T14:51:41Z", "path": ".ci/openjdk-projects-to-test-on.properties", "diffHunk": "@@ -0,0 +1,11 @@\n+# suppress inspection \"UnusedProperty\" for whole file\n+# suppress inspection \"WrongPropertyKeyValueDelimiter\" for whole file", "originalCommit": "c1500c828b3a32d4f0a45f444a9d698f1f8eb4fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM0NjQ5NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515346495", "bodyText": "Done.", "author": "nmancus1", "createdAt": "2020-10-30T19:57:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUwODQwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUwOTg1OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r513509859", "bodyText": "bunch of crappy words are leaking to our whitelist, lets exclude .ci/openjdk14-excluded.files completely from spell-checker", "author": "romani", "createdAt": "2020-10-28T14:53:26Z", "path": ".ci/jsoref-spellchecker/whitelist.words", "diffHunk": "@@ -1347,6 +1348,7 @@ tt\n ttf\n ttype\n tw\n+Twr", "originalCommit": "c1500c828b3a32d4f0a45f444a9d698f1f8eb4fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM0NjU2MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515346561", "bodyText": "Done.", "author": "nmancus1", "createdAt": "2020-10-30T19:57:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUwOTg1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxMDk3MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r513510971", "bodyText": "please move this to build line to be done before clone of contribution", "author": "romani", "createdAt": "2020-10-28T14:54:36Z", "path": ".ci/no-exception-test.sh", "diffHunk": "@@ -53,6 +53,28 @@ guava-with-sun-checks)\n   rm sun_checks.*\n   ;;\n \n+openjdk14-with-checks-nonjavadoc-error)\n+  CS_POM_VERSION=$(mvn -e -q -Dexec.executable='echo' -Dexec.args='${project.version}' \\\n+                     --non-recursive org.codehaus.mojo:exec-maven-plugin:1.3.1:exec)\n+  echo CS_version: $CS_POM_VERSION\n+  mkdir -p .ci-temp/\n+  cd .ci-temp/\n+  git clone https://github.com/checkstyle/contribution\n+  cd ..\n+  mvn -e clean install -Pno-validations", "originalCommit": "c1500c828b3a32d4f0a45f444a9d698f1f8eb4fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM0NjYzMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515346630", "bodyText": "Done.", "author": "nmancus1", "createdAt": "2020-10-30T19:58:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxMDk3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM1MDA4Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515350083", "bodyText": "Just curious, why? In case of build failure, we don't waste resources/time to clone the contribution repo?", "author": "nmancus1", "createdAt": "2020-10-30T20:05:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxMDk3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUwOTAzNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515509034", "bodyText": "build failure is rare\nin CI we do not make waste, as whole environment is deleted after al executions, only logs are left.\non local, yes it might, but usually this command executed the last verification, so build is passing for sure.", "author": "romani", "createdAt": "2020-10-31T15:39:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxMDk3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxNDMyMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r513514321", "bodyText": "awesome hack ! I like it.\nI would keep it in mind, it might be handy for other complicated cases also.", "author": "romani", "createdAt": "2020-10-28T14:58:32Z", "path": ".ci/no-exception-test.sh", "diffHunk": "@@ -53,6 +53,28 @@ guava-with-sun-checks)\n   rm sun_checks.*\n   ;;\n \n+openjdk14-with-checks-nonjavadoc-error)\n+  CS_POM_VERSION=$(mvn -e -q -Dexec.executable='echo' -Dexec.args='${project.version}' \\\n+                     --non-recursive org.codehaus.mojo:exec-maven-plugin:1.3.1:exec)\n+  echo CS_version: $CS_POM_VERSION\n+  mkdir -p .ci-temp/\n+  cd .ci-temp/\n+  git clone https://github.com/checkstyle/contribution\n+  cd ..\n+  mvn -e clean install -Pno-validations\n+  sed -i.'' 's/value=\\\"error\\\"/value=\\\"ignore\\\"/' \\\n+        .ci-temp/contribution/checkstyle-tester/checks-nonjavadoc-error.xml\n+  cd .ci-temp/contribution/checkstyle-tester\n+  sed -i '/  <!-- Filters -->/r ../../../.ci/openjdk14-excluded.files' checks-nonjavadoc-error.xml", "originalCommit": "c1500c828b3a32d4f0a45f444a9d698f1f8eb4fd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU1NzA0MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r513557040", "bodyText": "I'll leave this here for the future then...\nRan from Checkstyle root:\n#!/bin/bash\nOUTPUT=\"test\"\nwhile  [ -n \"$OUTPUT\" ]\ndo\n    OUTPUT=$(.ci/no-exception-test.sh openjdk14-checkstyle-checks-no-exception | grep \"Caused by: \" | grep -oh '/.*.java' | sed 's|.*/||' | cut -f 1 -d '.' | uniq)\n    echo \"$OUTPUT\"\n    echo -e \"<module name=\\\"BeforeExecutionExclusionFileFilter\\\">\\n  <property name=\\\"fileNamePattern\\\" value=\\\"/$OUTPUT\\.java\\$\\\"/>\\n</module>\" >> config/openjdk14-excluded.files\n    rm -rf .ci-temp/contribution\ndone", "author": "nmancus1", "createdAt": "2020-10-28T15:51:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxNDMyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM0NzAyOA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515347028", "bodyText": "I've linked to the above script from the generated file in this PR, in case we should need to create such a file in the future.", "author": "nmancus1", "createdAt": "2020-10-30T19:58:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxNDMyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUwOTgwNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515509805", "bodyText": "@nmancus1 , see my comment below on how to improve.", "author": "romani", "createdAt": "2020-10-31T15:48:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUxNDMyMQ=="}], "type": "inlineReview"}, {"oid": "46b19ffb2d071205442db093230f22f019c6dd2c", "url": "https://github.com/checkstyle/checkstyle/commit/46b19ffb2d071205442db093230f22f019c6dd2c", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-28T17:13:45Z", "type": "forcePushed"}, {"oid": "08717bf5a949bc89a7bf291d215af1798aca258a", "url": "https://github.com/checkstyle/checkstyle/commit/08717bf5a949bc89a7bf291d215af1798aca258a", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-10-30T19:49:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUwOTMyNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515509326", "bodyText": "please make it as comment in issue, it is more visible area.\nall PR conversations become resolved \"collabsed\".", "author": "romani", "createdAt": "2020-10-31T15:43:05Z", "path": ".ci/openjdk14-excluded.files", "diffHunk": "@@ -0,0 +1,514 @@\n+<!-- This file generated by script at -->\n+<!--     https://github.com/checkstyle/checkstyle/pull/8920#discussion_r513557040 -->", "originalCommit": "08717bf5a949bc89a7bf291d215af1798aca258a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjEyNDQ0Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516124446", "bodyText": "Done.", "author": "nmancus1", "createdAt": "2020-11-02T17:10:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUwOTMyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUwOTYwNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515509604", "bodyText": "@pbludov , this is not very good approach for CI config.\nit should be:\n.ci/no-exception-test.sh openjdk14-with-checks-nonjavadoc-error\nand in comamnds we do eval $COMMAND\none day this execution will fail in CI in PR, contributor might not be very experienced in CI to figureout how to reproduce it on local, so we will share with him link to single line in config for simple copy and paste in terminal, and it works.\nif no objections, lets make issue on this and improve separately.", "author": "romani", "createdAt": "2020-10-31T15:46:06Z", "path": ".semaphore/semaphore.yml", "diffHunk": "@@ -84,6 +84,7 @@ blocks:\n               values:\n                 - guava-with-google-checks\n                 - guava-with-sun-checks\n+                - openjdk14-with-checks-nonjavadoc-error", "originalCommit": "08717bf5a949bc89a7bf291d215af1798aca258a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxMDA2NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515610065", "bodyText": "done in #8950", "author": "pbludov", "createdAt": "2020-11-01T11:31:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTUwOTYwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTMwNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515615306", "bodyText": "Checkstyle is built already: https://github.com/checkstyle/checkstyle/blob/master/.semaphore/semaphore.yml#L88", "author": "pbludov", "createdAt": "2020-11-01T12:21:46Z", "path": ".ci/no-exception-test.sh", "diffHunk": "@@ -53,6 +53,28 @@ guava-with-sun-checks)\n   rm sun_checks.*\n   ;;\n \n+openjdk14-with-checks-nonjavadoc-error)\n+  CS_POM_VERSION=$(mvn -e -q -Dexec.executable='echo' -Dexec.args='${project.version}' \\\n+                     --non-recursive org.codehaus.mojo:exec-maven-plugin:1.3.1:exec)\n+  echo CS_version: $CS_POM_VERSION\n+  mvn -e clean install -Pno-validations", "originalCommit": "08717bf5a949bc89a7bf291d215af1798aca258a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTgxNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515615815", "bodyText": "i'll remove duplicate from semaphore.yml", "author": "pbludov", "createdAt": "2020-11-01T12:26:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTMwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYyMzg3MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515623870", "bodyText": "this is a prat I still do not have strong position, where to keep build of checkstyle in validation commands or in CI config (presumably it is \"given\").\nSome CI reuse the same host for all executions (wercker for example).\nprobably we can have shells like:\nci.yml -> your-ci.sh TASK_NAME -> \"mvn install ....\"  && validation.sh TASKNAME \nplease share ideas, I open for better way to do this.", "author": "romani", "createdAt": "2020-11-01T13:42:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTMwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYyNjIwMg==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515626202", "bodyText": "From #8950 (review):\nmvn -e clean install -Pno-validations && .ci/validation.sh all-sevntu-checks\nThis is a good idea; when I am working on these CI builds, I always comment out the checkstyle build so that I don't have to waste time building Checkstyle over and over again locally.", "author": "nmancus1", "createdAt": "2020-11-01T14:04:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTMwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYyNzkyNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r515627924", "bodyText": "in my case it is simple copy-paste with presumption that sources are built.\nif no built done, failure is obvious\nwhen  no re-build is done, significant execution time reduction.", "author": "romani", "createdAt": "2020-11-01T14:18:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYxNTMwNg=="}], "type": "inlineReview"}, {"oid": "8fe93a27d726f84a3577c2dfd3dada506a7f5074", "url": "https://github.com/checkstyle/checkstyle/commit/8fe93a27d726f84a3577c2dfd3dada506a7f5074", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-11-02T15:13:56Z", "type": "forcePushed"}, {"oid": "b5c631fe1da6edb6d6788b536ab25d763ed443de", "url": "https://github.com/checkstyle/checkstyle/commit/b5c631fe1da6edb6d6788b536ab25d763ed443de", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-11-02T15:59:54Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjEwMzk2MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516103961", "bodyText": "please add indentation for easy reading", "author": "pbludov", "createdAt": "2020-11-02T16:41:35Z", "path": ".semaphore/semaphore.yml", "diffHunk": "@@ -73,6 +73,8 @@ blocks:\n                     && .ci/validation.sh no-error-pmd\n                 - mvn -e clean install -Pno-validations\n                     && .ci/validation.sh no-violation-test-configurate\n+                - mvn -e clean install -Pno-validations\n+                  && .ci/no-exception-test.sh openjdk14-with-checks-nonjavadoc-error", "originalCommit": "b5c631fe1da6edb6d6788b536ab25d763ed443de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjEyMzczMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516123730", "bodyText": "Fixed.", "author": "nmancus1", "createdAt": "2020-11-02T17:09:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjEwMzk2MQ=="}], "type": "inlineReview"}, {"oid": "c0f66cd64481452aaeb1d315deea71ca4e198c8e", "url": "https://github.com/checkstyle/checkstyle/commit/c0f66cd64481452aaeb1d315deea71ca4e198c8e", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-11-02T17:08:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516240425", "bodyText": "Is there a reason these files do not have any reference to an exact or matching folder path?\nBy specifying a file only, it means we will exclude any file matching that name, especially if there are 2 or more in different folders.\nFurthermore why do some have / and others don't? For Windows compatibility folder paths should be [\\\\/]", "author": "rnveach", "createdAt": "2020-11-02T20:38:40Z", "path": ".ci/openjdk14-excluded.files", "diffHunk": "@@ -0,0 +1,514 @@\n+<!-- This file generated by script at -->\n+<!--     https://github.com/checkstyle/checkstyle/issues/8901#issuecomment-712939037 -->\n+\n+<!-- Excluded due to exception; issues opened -->\n+\n+<!-- until https://github.com/checkstyle/checkstyle/issues/8945 -->\n+<module name=\"BeforeExecutionExclusionFileFilter\">\n+  <property name=\"fileNamePattern\" value=\"/NestedTypes\\.java$\"/>", "originalCommit": "c0f66cd64481452aaeb1d315deea71ca4e198c8e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQxODYyNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516418627", "bodyText": "#8901 (comment)\nIt was easier to catch files and generate this file.\nChange to match different files is very low. We can improve this late on ones it become proven way for jdk validation.", "author": "romani", "createdAt": "2020-11-03T04:08:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcxOTIzOA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516719238", "bodyText": "I understand this file is generated, but I am seeing anything that says why folders were removed. If this is to be done later ok, but we could be missing overlapping files.", "author": "rnveach", "createdAt": "2020-11-03T14:43:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcyMDk5NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516720995", "bodyText": "Is there a reason these files do not have any reference to an exact or matching folder path?\n\nA good question. There were quite a few duplicates of identical/ nearly identical files with the same name that kept failing with NPE, so in order to generate this list of\nBeforeExecutionExclusionFileFilter modules in a reasonable amount of time (it still took over three days),  I had the script eliminate the path.\nAlso, since I semi-manually verified non-compilable files, this allowed me to get it done in less time. Additionally, I have had issues line-wrapping XML reliably, so another reason to omit the paths was to keep lines under 100 chars.\n\nBy specifying a file only, it means we will exclude any file matching that name, especially if there are 2 or more in different folders.\n\nI felt that losing some granularity in the BeforeExecutionExclusionFileFilter modules was a fair trade to be able to increase our testing on openjdk14 from around 2,000 files to more than 40,000.  In retrospect, I should have discussed this in issue and got feedback before proceeding.\n\nFurthermore why do some have / and others don't?\n\nThat's a good question; I didn't catch that.  The file names that are not preceded with '/' were the ones that I added manually that we were already aware of issues with.  I can fix that.\n\nFor Windows compatibility folder paths should be [\\\\/]\n\nWe only have a Linux build on Semaphore, so I hadn't considered Windows compatibility, honestly.  I can fix this so that windows users can run locally.", "author": "nmancus1", "createdAt": "2020-11-03T14:45:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc2MzE3Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516763173", "bodyText": "Please fix windows compatibility.\nAnother issue can be postponed.", "author": "romani", "createdAt": "2020-11-03T15:41:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg3NjUyMw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516876523", "bodyText": "Yea, please fix Windows directories so it can be run by those users locally.\nI am ok to skip adding any type of folder paths.", "author": "rnveach", "createdAt": "2020-11-03T18:35:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMwNDMxMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r517304310", "bodyText": "To be clear, I need to change all the preceding / to \\\\/, right?", "author": "nmancus1", "createdAt": "2020-11-04T12:20:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQwNDMwNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r517404307", "bodyText": "you have single , so need to change single.\nexample of how it will looks like:\n\n  \n    \n      checkstyle/config/suppressions.xml\n    \n    \n         Line 67\n      in\n      3fc9dd9\n    \n    \n    \n    \n\n        \n          \n           <suppress checks=\"MethodCount\" files=\"[\\\\/]JavadocMethodCheck.java$\"/>", "author": "romani", "createdAt": "2020-11-04T14:57:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQxNTAwOA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r517415008", "bodyText": "Fixed.  I've also removed to escapes from the \\. in file names to be consistent with your example.", "author": "nmancus1", "createdAt": "2020-11-04T15:11:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MDQyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MTIzOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516241239", "bodyText": "Why is this file needed? Why can't we use contribution's file and tell it to target openjdk14 only?", "author": "rnveach", "createdAt": "2020-11-02T20:40:20Z", "path": ".ci/openjdk-projects-to-test-on.config", "diffHunk": "@@ -0,0 +1,8 @@\n+# List of GIT repositories to clone / pull for checking with Checkstyle\n+# File format: REPO_NAME|[local|git|hg]|URL|[COMMIT_ID]|[EXCLUDE FOLDERS]\n+# Please note that bash comments works in this file\n+#\n+# This file has been created to alleviate confusion in the contribution\n+# repository's projects-to-test-on.properties file; these projects\n+# must be used with special configurations.\n+openjdk14|git|https://github.com/openjdk/jdk14|master||", "originalCommit": "c0f66cd64481452aaeb1d315deea71ca4e198c8e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQxNjQ5Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516416493", "bodyText": "It is very special line, it  is not usable for regular groovy files.\nI even removed openjfk from contribution repo, as it caused too much confusion to contributors.", "author": "romani", "createdAt": "2020-11-03T03:58:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MTIzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcyMDI5Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516720297", "bodyText": "I am resolving this. I thought the line was still in contribution.", "author": "rnveach", "createdAt": "2020-11-03T14:45:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MTIzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516242270", "bodyText": "@romani Note this is using launch and not diff.\nNot expecting a change here.", "author": "rnveach", "createdAt": "2020-11-02T20:42:27Z", "path": ".ci/no-exception-test.sh", "diffHunk": "@@ -53,6 +53,27 @@ guava-with-sun-checks)\n   rm sun_checks.*\n   ;;\n \n+openjdk14-with-checks-nonjavadoc-error)\n+  CS_POM_VERSION=$(mvn -e -q -Dexec.executable='echo' -Dexec.args='${project.version}' \\\n+                     --non-recursive org.codehaus.mojo:exec-maven-plugin:1.3.1:exec)\n+  echo CS_version: $CS_POM_VERSION\n+  mkdir -p .ci-temp/\n+  cd .ci-temp/\n+  git clone https://github.com/checkstyle/contribution\n+  cd ..\n+  sed -i.'' 's/value=\\\"error\\\"/value=\\\"ignore\\\"/' \\\n+        .ci-temp/contribution/checkstyle-tester/checks-nonjavadoc-error.xml\n+  cd .ci-temp/contribution/checkstyle-tester\n+  sed -i '/  <!-- Filters -->/r ../../../.ci/openjdk14-excluded.files' checks-nonjavadoc-error.xml\n+  export MAVEN_OPTS=\"-Xmx2048m\"\n+  groovy ./launch.groovy --listOfProjects ../../../.ci/openjdk-projects-to-test-on.config \\", "originalCommit": "c0f66cd64481452aaeb1d315deea71ca4e198c8e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQxOTIxMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516419210", "bodyText": "@nmancus1 , can we use diff.grovy here ?", "author": "romani", "createdAt": "2020-11-03T04:11:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcwNDcwOA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516704708", "bodyText": "I can add the same extraMvnOptions command line arg to to diff.groovy, but since diff.groovy uses launch.groovy anyway, why not keep it as is and not have another utility to deal with?  Just curious.", "author": "nmancus1", "createdAt": "2020-11-03T14:25:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjcyMjA0Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516722046", "bodyText": "This goes back to discussion in main issue, ending with #8901 (comment) .\nIf we are to remove JXR from tester's POM to avoid telling it not to run anyways, we need to remove uses of launch as I think we are still relying on it generating HTML files since diff-report-tool is what generates the final HTML when diff is launched. It was never confirmed on this aspect so I don't know what effect it will have on jobs running launch and if they will be \"broken\".\nI am fine with delaying it if we want to, but its just going to be an on-going issue. We need to trim back on JXR and maven-checkstyle-plugin which just hold us back.", "author": "rnveach", "createdAt": "2020-11-03T14:47:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjczMTkwNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516731904", "bodyText": "So,  I should submit a PR to contribution to add extraMvnOptions to diff.groovy, then use that in this PR, right?", "author": "nmancus1", "createdAt": "2020-11-03T15:00:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc2Mzg0Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516763843", "bodyText": "I recommend to merge now and improve to use diff.groovy in next iteration/PR.", "author": "romani", "createdAt": "2020-11-03T15:42:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg3NzA3MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r516877070", "bodyText": "Then this is resolved for this PR, I will just leave this open for follow up.", "author": "rnveach", "createdAt": "2020-11-03T18:36:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzAzNTEzOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r517035139", "bodyText": "@nmancus1 , please create issue on this , one day we will address it.", "author": "romani", "createdAt": "2020-11-04T00:38:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMxNjExNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8920#discussion_r517316116", "bodyText": "#8960\ncheckstyle/contribution#523", "author": "nmancus1", "createdAt": "2020-11-04T12:43:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MjI3MA=="}], "type": "inlineReview"}, {"oid": "557a780b955f8febb9fb06515554cae9974579ad", "url": "https://github.com/checkstyle/checkstyle/commit/557a780b955f8febb9fb06515554cae9974579ad", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-11-04T15:09:22Z", "type": "forcePushed"}, {"oid": "279aad9bf641cdf489eff0522c094b1f130d477a", "url": "https://github.com/checkstyle/checkstyle/commit/279aad9bf641cdf489eff0522c094b1f130d477a", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-11-04T15:48:47Z", "type": "commit"}, {"oid": "279aad9bf641cdf489eff0522c094b1f130d477a", "url": "https://github.com/checkstyle/checkstyle/commit/279aad9bf641cdf489eff0522c094b1f130d477a", "message": "Issue #8901: Run regression testing in CI over openjdk14 or newer codebase", "committedDate": "2020-11-04T15:48:47Z", "type": "forcePushed"}]}