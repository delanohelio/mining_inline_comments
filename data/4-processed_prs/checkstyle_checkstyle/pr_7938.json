{"pr_number": 7938, "pr_title": "Issue #4352: Added ability to skip CI executions base on commit files i\u2026", "pr_createdAt": "2020-03-22T10:48:20Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/7938", "timeline": [{"oid": "d2b025f37b5429159f328072a93b13c95a1f0bda", "url": "https://github.com/checkstyle/checkstyle/commit/d2b025f37b5429159f328072a93b13c95a1f0bda", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-03-22T19:49:15Z", "type": "forcePushed"}, {"oid": "0448ecacc369e6b443bafcaaca39e7e73966e208", "url": "https://github.com/checkstyle/checkstyle/commit/0448ecacc369e6b443bafcaaca39e7e73966e208", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-03-23T10:03:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3MDUwMg==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r399670502", "bodyText": "please move this code to https://github.com/checkstyle/checkstyle/blob/master/codeship-steps.yml\nwe need to skip only when we are in CI mode. This shell file can be executed at local and it should not skip anything.", "author": "romani", "createdAt": "2020-03-28T14:49:52Z", "path": ".ci/run-link-check-plugin.sh", "diffHunk": "@@ -3,19 +3,25 @@\n #This script is used at https://app.codeship.com/projects/124310\n #Run \"firefox target/site/linkcheck.html\" after completion to review html report\n \n-set -e\n-pwd\n-uname -a\n-mvn --version\n-curl -I https://sourceforge.net/projects/checkstyle/\n-mvn -e clean site -Dcheckstyle.ant.skip=true -DskipTests -DskipITs \\\n-   -Dpmd.skip=true -Dspotbugs.skip=true -Djacoco.skip=true -Dcheckstyle.skip=true\n-echo \"------------ grep of linkcheck.html--BEGIN\"\n-# \"grep ... | cat\" is required command is running in \"set -e\" mode and\n-# grep could return exit code 1 if nothing is matching\n-grep externalLink target/site/linkcheck.html | cat\n-echo \"------------ grep of linkcheck.html--END\"\n-RESULT=$(grep externalLink target/site/linkcheck.html | grep -v 'Read timed out' | wc -l)\n-echo 'Exit code:'$RESULT\n-if [[ $RESULT != 0 ]]; then false; fi\n+# To skip build if minor files or other CI files area changed\n+SKIP_FILES=\".github|appveyor.yml|circle.yml|distelli-manifest.yml|fast-forward-merge.sh|LICENSE|\\\n+            LICENSE.apache20|README.md|release.sh|RIGHTS.antlr|shippable.yml|wercker.yml\"", "originalCommit": "0448ecacc369e6b443bafcaaca39e7e73966e208", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3NzU5MA==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r399677590", "bodyText": "Alright, got it \ud83d\udc4d", "author": "Gaurav-Punjabi", "createdAt": "2020-03-28T15:57:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3MDUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTcxMzk5MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r399713991", "bodyText": "@romani Done.", "author": "Gaurav-Punjabi", "createdAt": "2020-03-28T21:53:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY3MDUwMg=="}], "type": "inlineReview"}, {"oid": "84381fea985de42119cba3b040880b21922bd323", "url": "https://github.com/checkstyle/checkstyle/commit/84381fea985de42119cba3b040880b21922bd323", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-03-28T17:24:09Z", "type": "forcePushed"}, {"oid": "168c403aba815c2dd9387322bd218a252ebe66d2", "url": "https://github.com/checkstyle/checkstyle/commit/168c403aba815c2dd9387322bd218a252ebe66d2", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-03-28T17:25:30Z", "type": "forcePushed"}, {"oid": "fa28c7d2388dd8817deeea302598e78520a832be", "url": "https://github.com/checkstyle/checkstyle/commit/fa28c7d2388dd8817deeea302598e78520a832be", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-03-28T17:25:59Z", "type": "forcePushed"}, {"oid": "e28cf1d11e05178622730e1412ebc5dd041b6afe", "url": "https://github.com/checkstyle/checkstyle/commit/e28cf1d11e05178622730e1412ebc5dd041b6afe", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-03-28T21:52:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg3MTc0MA==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r399871740", "bodyText": "please wrap long lines to be less then 100 symbols in length.", "author": "romani", "createdAt": "2020-03-29T23:43:30Z", "path": "codeship-steps.yml", "diffHunk": "@@ -7,4 +7,5 @@\n     #-  command: ./.ci/travis/travis.sh site\n     #-  command: ./.ci/travis/travis.sh nondex\n     -  command: ls -la\n-    -  command: .ci/run-link-check-plugin.sh\n+    -  command: SKIP_FILES=\".github|appveyor.yml|circle.yml|distelli-manifest.yml|fast-forward-merge.sh|LICENSE|LICENSE.apache20|README.md|release.sh|RIGHTS.antlr|shippable.yml|wercker.yml\"\n+    -  command: if [[ $(git diff --name-only HEAD HEAD~1 | grep -vE \"$SKIP_FILES\" | cat | wc -c) > 0 ]]; then .ci/run-link-check-plugin.sh; fi", "originalCommit": "e28cf1d11e05178622730e1412ebc5dd041b6afe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk0NTA4Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r399945083", "bodyText": "Sure", "author": "Gaurav-Punjabi", "createdAt": "2020-03-30T06:04:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg3MTc0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTk2ODM2Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r399968367", "bodyText": "Done.", "author": "Gaurav-Punjabi", "createdAt": "2020-03-30T07:06:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg3MTc0MA=="}], "type": "inlineReview"}, {"oid": "387cf69b99222eba74f9fe2f418cc559910805a0", "url": "https://github.com/checkstyle/checkstyle/commit/387cf69b99222eba74f9fe2f418cc559910805a0", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-03-30T06:39:29Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAwNzQ1NA==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403007454", "bodyText": "please use this form  \n  \n    \n      checkstyle/shippable.yml\n    \n    \n         Line 42\n      in\n      72a5294\n    \n    \n    \n    \n\n        \n          \n                 SKIP_FILES1=\"appveyor.yml|codeship-*|buddy.yml|circleci|.travis.yml\" \n        \n    \n  \n\n\nplease make single command node with - | as it is done at \n  \n    \n      checkstyle/shippable.yml\n    \n    \n         Line 32\n      in\n      72a5294\n    \n    \n    \n    \n\n        \n          \n           - |", "author": "romani", "createdAt": "2020-04-03T13:32:28Z", "path": "codeship-steps.yml", "diffHunk": "@@ -6,5 +6,10 @@\n   steps:\n     #-  command: ./.ci/travis/travis.sh site\n     #-  command: ./.ci/travis/travis.sh nondex\n-    -  command: ls -la\n-    -  command: .ci/run-link-check-plugin.sh\n+    - command: ls -la\n+    - command: SKIP_FILES=\n+        \".github|appveyor.yml|circle.yml|distelli-manifest.yml|fast-forward-merge.sh|LICENSE|", "originalCommit": "387cf69b99222eba74f9fe2f418cc559910805a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAzOTU2Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403039566", "bodyText": "Alright \ud83d\udc4d", "author": "Gaurav-Punjabi", "createdAt": "2020-04-03T14:20:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAwNzQ1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzMwNDMzNg==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403304336", "bodyText": "Made the changes. Please reveiw", "author": "Gaurav-Punjabi", "createdAt": "2020-04-03T20:21:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAwNzQ1NA=="}], "type": "inlineReview"}, {"oid": "91f9ff90345e7f1da5a763ed624a95a568c02364", "url": "https://github.com/checkstyle/checkstyle/commit/91f9ff90345e7f1da5a763ed624a95a568c02364", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-04-03T20:19:45Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQyNTc0Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403425747", "bodyText": "Please move then and fi to separate lines, we respect indentation rules even in bash", "author": "romani", "createdAt": "2020-04-04T04:55:33Z", "path": "codeship-steps.yml", "diffHunk": "@@ -6,5 +6,11 @@\n   steps:\n     #-  command: ./.ci/travis/travis.sh site\n     #-  command: ./.ci/travis/travis.sh nondex\n-    -  command: ls -la\n-    -  command: .ci/run-link-check-plugin.sh\n+    - command: |\n+        ls -la\n+        SKIP_FILES1=\".github|distelli-manifest.yml|fast-forward-merge.sh\"\n+        SKIP_FILES2=\"LICENSE|LICENSE.apache20|README.md|release.sh|RIGHTS.antlr\"\n+        SKIP_FILES3=\"shippable.yml|wercker.yml|appveyor.yml|circle.yml\"\n+        SKIP_FILES=\"$SKIP_FILES1$SKIP_FILES2$SKIP_FILES3\"\n+        if [[ $(git diff --name-only HEAD HEAD~1 | grep -vE \"$SKIP_FILES\" | cat | wc -c) > 0 ]];\n+        then .ci/run-link-check-plugin.sh; fi", "originalCommit": "91f9ff90345e7f1da5a763ed624a95a568c02364", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ1Mzk4NA==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403453984", "bodyText": "Done \ud83d\udc4d", "author": "Gaurav-Punjabi", "createdAt": "2020-04-04T10:29:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQyNTc0Nw=="}], "type": "inlineReview"}, {"oid": "3a7c53eb893e67747a798ff1b70e0c0b561360bd", "url": "https://github.com/checkstyle/checkstyle/commit/3a7c53eb893e67747a798ff1b70e0c0b561360bd", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-04-04T10:29:00Z", "type": "forcePushed"}, {"oid": "f2ca79f47dd5b9a2a975f891ad9c4e590ef0e4a0", "url": "https://github.com/checkstyle/checkstyle/commit/f2ca79f47dd5b9a2a975f891ad9c4e590ef0e4a0", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-04-04T10:30:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ2MTM2Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403461367", "bodyText": "The rightmost item should be separated from the leftmost on the next line:\nSKIP_FILES=\"$SKIP_FILES1|$SKIP_FILES2|$SKIP_FILES3\"\nOR\nSKIP_FILES1=\".github|distelli-manifest.yml|fast-forward-merge.sh|\" (and so on)", "author": "pbludov", "createdAt": "2020-04-04T11:51:51Z", "path": "codeship-steps.yml", "diffHunk": "@@ -6,5 +6,13 @@\n   steps:\n     #-  command: ./.ci/travis/travis.sh site\n     #-  command: ./.ci/travis/travis.sh nondex\n-    -  command: ls -la\n-    -  command: .ci/run-link-check-plugin.sh\n+    - command: |\n+        ls -la\n+        SKIP_FILES1=\".github|distelli-manifest.yml|fast-forward-merge.sh\"\n+        SKIP_FILES2=\"LICENSE|LICENSE.apache20|README.md|release.sh|RIGHTS.antlr\"\n+        SKIP_FILES3=\"shippable.yml|wercker.yml|appveyor.yml|circle.yml\"\n+        SKIP_FILES=\"$SKIP_FILES1$SKIP_FILES2$SKIP_FILES3\"", "originalCommit": "f2ca79f47dd5b9a2a975f891ad9c4e590ef0e4a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ3MzUyMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403473521", "bodyText": "Done. Fixed it \ud83d\udc4d", "author": "Gaurav-Punjabi", "createdAt": "2020-04-04T14:02:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ2MTM2Nw=="}], "type": "inlineReview"}, {"oid": "eb67987fd5452e46639e545260a6163b63440171", "url": "https://github.com/checkstyle/checkstyle/commit/eb67987fd5452e46639e545260a6163b63440171", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-04-04T14:01:36Z", "type": "commit"}, {"oid": "eb67987fd5452e46639e545260a6163b63440171", "url": "https://github.com/checkstyle/checkstyle/commit/eb67987fd5452e46639e545260a6163b63440171", "message": "Issue #4352: Add ability to skip CI executions", "committedDate": "2020-04-04T14:01:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5MTU1Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403491557", "bodyText": "@romani Is this safe to do when travis and other CIs dropped this and forced to run all the time?\nhttps://github.com/checkstyle/checkstyle/blob/master/.travis.yml#L326", "author": "rnveach", "createdAt": "2020-04-04T16:58:04Z", "path": "codeship-steps.yml", "diffHunk": "@@ -6,5 +6,13 @@\n   steps:\n     #-  command: ./.ci/travis/travis.sh site\n     #-  command: ./.ci/travis/travis.sh nondex\n-    -  command: ls -la\n-    -  command: .ci/run-link-check-plugin.sh\n+    - command: |\n+        ls -la\n+        SKIP_FILES1=\".github|distelli-manifest.yml|fast-forward-merge.sh\"\n+        SKIP_FILES2=\"LICENSE|LICENSE.apache20|README.md|release.sh|RIGHTS.antlr\"\n+        SKIP_FILES3=\"shippable.yml|wercker.yml|appveyor.yml|circle.yml\"\n+        SKIP_FILES=\"$SKIP_FILES1|$SKIP_FILES2|$SKIP_FILES3\"\n+        if [[ $(git diff --name-only HEAD HEAD~1 | grep -vE \"$SKIP_FILES\" | cat | wc -c) > 0 ]];", "originalCommit": "eb67987fd5452e46639e545260a6163b63440171", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzU2NzczNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7938#discussion_r403567735", "bodyText": "it is not safe, but till it present in other CI, lets keep it here too.\nRemoval of all is another issue, as far as I remember we did not decided on it yet.", "author": "romani", "createdAt": "2020-04-04T23:20:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5MTU1Nw=="}], "type": "inlineReview"}]}