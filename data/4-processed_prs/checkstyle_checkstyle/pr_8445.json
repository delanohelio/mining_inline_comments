{"pr_number": 8445, "pr_title": "Issue #7498: add github actions file to generate diff report", "pr_createdAt": "2020-07-14T10:41:37Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8445", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDUxOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454270519", "bodyText": "need to add new line to file end", "author": "strkkk", "createdAt": "2020-07-14T10:51:34Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p origin/${{needs.parse_body.outputs.branch}} -c config.xml -l proj.properties\n+        \n+     - name: Configure AWS Credentials\n+       uses: aws-actions/configure-aws-credentials@v1\n+       with:\n+        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n+        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n+        aws-region: ${{ env.AWS_REGION }}\n+       \n+     - name: Copy Report to AWS S3 Bucket\n+       run: |\n+        bash\n+        TEST_VAR=`date +%Y%H%M%S`\n+        aws s3 cp ./contribution/checkstyle-tester/reports/diff s3://${{ env.AWS_BUCKET_NAME }}/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/ --recursive\n+        echo https://${{env.AWS_BUCKET_NAME}}.s3.${{env.AWS_REGION}}.amazonaws.com/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/index.html > message\n+        \n+     - name: Set output\n+       id: out\n+       run: echo ::set-output name=message::$(cat message)   \n+      \n+     - name: Comment PR\n+       uses:  kate2513/javascript-test-action@master \n+       with:\n+        message: ${{steps.out.outputs.message}}\n+        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}", "originalCommit": "612d47016529e0e7b60a9febcec0af0a60cf3938", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDc4MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454270780", "bodyText": "line is too long - should be less than 100 chars", "author": "strkkk", "createdAt": "2020-07-14T10:52:06Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p origin/${{needs.parse_body.outputs.branch}} -c config.xml -l proj.properties\n+        \n+     - name: Configure AWS Credentials\n+       uses: aws-actions/configure-aws-credentials@v1\n+       with:\n+        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n+        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n+        aws-region: ${{ env.AWS_REGION }}\n+       \n+     - name: Copy Report to AWS S3 Bucket\n+       run: |\n+        bash\n+        TEST_VAR=`date +%Y%H%M%S`\n+        aws s3 cp ./contribution/checkstyle-tester/reports/diff s3://${{ env.AWS_BUCKET_NAME }}/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/ --recursive", "originalCommit": "612d47016529e0e7b60a9febcec0af0a60cf3938", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDg5Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454270897", "bodyText": "same here", "author": "strkkk", "createdAt": "2020-07-14T10:52:18Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p origin/${{needs.parse_body.outputs.branch}} -c config.xml -l proj.properties\n+        \n+     - name: Configure AWS Credentials\n+       uses: aws-actions/configure-aws-credentials@v1\n+       with:\n+        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n+        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n+        aws-region: ${{ env.AWS_REGION }}\n+       \n+     - name: Copy Report to AWS S3 Bucket\n+       run: |\n+        bash\n+        TEST_VAR=`date +%Y%H%M%S`\n+        aws s3 cp ./contribution/checkstyle-tester/reports/diff s3://${{ env.AWS_BUCKET_NAME }}/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/ --recursive\n+        echo https://${{env.AWS_BUCKET_NAME}}.s3.${{env.AWS_REGION}}.amazonaws.com/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/index.html > message", "originalCommit": "612d47016529e0e7b60a9febcec0af0a60cf3938", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDk3MA==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454270970", "bodyText": "same here", "author": "strkkk", "createdAt": "2020-07-14T10:52:26Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p origin/${{needs.parse_body.outputs.branch}} -c config.xml -l proj.properties", "originalCommit": "612d47016529e0e7b60a9febcec0af0a60cf3938", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MTA4Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454271087", "bodyText": "same here", "author": "strkkk", "createdAt": "2020-07-14T10:52:37Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')", "originalCommit": "612d47016529e0e7b60a9febcec0af0a60cf3938", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MTI0NA==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454271244", "bodyText": "same here", "author": "strkkk", "createdAt": "2020-07-14T10:52:51Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')", "originalCommit": "612d47016529e0e7b60a9febcec0af0a60cf3938", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3NDUzMw==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454274533", "bodyText": "Chekstyle -> Checkstyle \nthere is a typo", "author": "strkkk", "createdAt": "2020-07-14T10:59:23Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.", "originalCommit": "612d47016529e0e7b60a9febcec0af0a60cf3938", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "411968f37718cba8d39786d2e82d6123833b978d", "url": "https://github.com/checkstyle/checkstyle/commit/411968f37718cba8d39786d2e82d6123833b978d", "message": "Issue #7498: add github actions file to generate diff report\n\n Issue #7498: fixed lines\n\nIssue #7498: whitelist.words updated", "committedDate": "2020-07-14T12:31:02Z", "type": "forcePushed"}, {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5", "url": "https://github.com/checkstyle/checkstyle/commit/cd33a599db08b8401aee6d2d40e564acd012dba5", "message": "Issue #7498: add github actions file to generate diff report", "committedDate": "2020-07-14T13:08:15Z", "type": "commit"}, {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5", "url": "https://github.com/checkstyle/checkstyle/commit/cd33a599db08b8401aee6d2d40e564acd012dba5", "message": "Issue #7498: add github actions file to generate diff report", "committedDate": "2020-07-14T13:08:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM1MzM1Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454353352", "bodyText": "Maybe thoughts for the future, to start a discussion:\nWhat about handling PRs where only patch regression (no comparison to master)? This is for things like new checks.\nWhat about handling PRs where base config is different from patch config? This is for things like where we split properties, change property types, add a new property, etc...", "author": "rnveach", "createdAt": "2020-07-14T13:25:00Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         bash\n+         REF=\"origin/${{needs.parse_body.outputs.branch}}\"\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p $REF -c config.xml -l proj.properties", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM2OTU1MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454369551", "bodyText": "all this can be done by special keywords in PR description.\nand extra logic in this file, @strkkk , please try to make it in next PRs.", "author": "romani", "createdAt": "2020-07-14T13:48:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM1MzM1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3MDU3OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454370578", "bodyText": "@rnveach that is a good point. I think it can be done as separate issue(s).\nI guess most of reports are for differences between master and branch for same config.", "author": "strkkk", "createdAt": "2020-07-14T13:50:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM1MzM1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM5NDYzOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454394639", "bodyText": "@rnveach @romani\nI have created #8448 and #8447 for this", "author": "strkkk", "createdAt": "2020-07-14T14:23:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM1MzM1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3MTQzNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454371437", "bodyText": "what is pro ?\nplease use full word", "author": "romani", "createdAt": "2020-07-14T13:51:26Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3MTgzMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454371831", "bodyText": "proj -> project\nno need to be cryptic.", "author": "romani", "createdAt": "2020-07-14T13:52:00Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NDU1MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454374551", "bodyText": "Parsing issue comment", "author": "romani", "createdAt": "2020-07-14T13:55:43Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NDk1OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454374959", "bodyText": "please use \" in around all variable references, fix all other cases", "author": "romani", "createdAt": "2020-07-14T13:56:17Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NTIzMg==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454375232", "bodyText": "Parsing PR description", "author": "romani", "createdAt": "2020-07-14T13:56:34Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NTcyMg==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454375722", "bodyText": "Parsing content of PR comment/description", "author": "romani", "createdAt": "2020-07-14T13:57:16Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3Njg0Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454376846", "bodyText": "grep \"^Diff Regression projects:\" text | cat > temp\nplease use the same for all other cases like this.", "author": "romani", "createdAt": "2020-07-14T13:58:48Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NzE3Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454377176", "bodyText": "proj --> project", "author": "romani", "createdAt": "2020-07-14T13:59:18Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3ODA1Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454378053", "bodyText": "should be project_link", "author": "romani", "createdAt": "2020-07-14T14:00:26Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3ODc0NA==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454378744", "bodyText": "what for this ?", "author": "romani", "createdAt": "2020-07-14T14:01:26Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3OTUxOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454379519", "bodyText": "shoud we use fetch-depth ? ref ?\nas we did for checkstyle clone", "author": "romani", "createdAt": "2020-07-14T14:02:37Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM4MDgwNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454380805", "bodyText": "please remove this, mercurial is used only for old jdk repos, right now all of them are on github.\nso such install is not required.", "author": "romani", "createdAt": "2020-07-14T14:04:28Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         bash\n+         REF=\"origin/${{needs.parse_body.outputs.branch}}\"\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM4MTYwMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454381601", "bodyText": "this is ok for now , but should be changed in next PRs", "author": "romani", "createdAt": "2020-07-14T14:05:35Z", "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         bash\n+         REF=\"origin/${{needs.parse_body.outputs.branch}}\"\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p $REF -c config.xml -l proj.properties\n+        \n+     - name: Configure AWS Credentials\n+       uses: aws-actions/configure-aws-credentials@v1\n+       with:\n+        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n+        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n+        aws-region: ${{ env.AWS_REGION }}\n+       \n+     - name: Copy Report to AWS S3 Bucket\n+       run: |\n+        bash\n+        TIME=`date +%Y%H%M%S`\n+        FOLDER=\"${{needs.parse_body.outputs.branch}}_$TIME\"\n+        DIFF=\"./contribution/checkstyle-tester/reports/diff\"\n+        LINK=\"https://${{env.AWS_BUCKET_NAME}}.s3.${{env.AWS_REGION}}.amazonaws.com\"\n+        aws s3 cp $DIFF s3://${{env.AWS_BUCKET_NAME}}/$FOLDER/reports/diff/ --recursive\n+        echo $LINK/$FOLDER/reports/diff/index.html > message\n+        \n+     - name: Set output\n+       id: out\n+       run: echo ::set-output name=message::$(cat message)   \n+      \n+     - name: Comment PR\n+       uses:  kate2513/javascript-test-action@master ", "originalCommit": "cd33a599db08b8401aee6d2d40e564acd012dba5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM4ODI1Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454388253", "bodyText": "created #8446", "author": "strkkk", "createdAt": "2020-07-14T14:14:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM4MTYwMQ=="}], "type": "inlineReview"}]}