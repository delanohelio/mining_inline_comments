{"pr_number": 8435, "pr_title": "minor: verify correct format for check UT inputs(#8364)", "pr_createdAt": "2020-07-10T19:24:40Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8435", "timeline": [{"oid": "761f0db6e98d4e0e84df8f994583c971c3dde909", "url": "https://github.com/checkstyle/checkstyle/commit/761f0db6e98d4e0e84df8f994583c971c3dde909", "message": "minor: verify correct format for check UT inputs(#8364)", "committedDate": "2020-07-10T19:17:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA5NTUxNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453095514", "bodyText": "remove this module, it is not required.\nIt might force to parser java file.", "author": "romani", "createdAt": "2020-07-10T21:58:57Z", "path": "config/checkstyle_input_checks.xml", "diffHunk": "@@ -0,0 +1,39 @@\n+<?xml version=\"1.0\"?>\n+<!DOCTYPE module PUBLIC\n+        \"-//Checkstyle//DTD Checkstyle Configuration 1.3//EN\"\n+        \"https://checkstyle.org/dtds/configuration_1_3.dtd\">\n+\n+<module name=\"Checker\">\n+    <property name=\"charset\" value=\"UTF-8\"/>\n+    <property name=\"haltOnException\" value=\"false\"/>\n+\n+    <property name=\"cacheFile\" value=\"target/cache_resources\"/>\n+\n+    <!-- Suppressions for resources -->\n+    <module name=\"SuppressionFilter\">\n+        <property name=\"file\"\n+                  value=\"${project.basedir}/config/checkstyle_input_suppressions.xml\"/>\n+    </module>\n+\n+    <!-- Check to make sure check UT input files have config and trailing comments -->\n+    <module name=\"RegexpMultiline\">\n+        <property name=\"format\"\n+                  value=\"(\\/\\/ config:)\"/>\n+        <property name=\"minimum\" value=\"1\"/>\n+        <message key=\"regexp.minimum\"\n+                 value=\"All files in the ''src/(it|test)/resources*'' folder must have a comment at\n+                 the top of the file specifying the check configuration used to produce the\n+                 violations, that begins with '// config:'.\"/>\n+    </module>\n+    <module name=\"RegexpMultiline\">\n+        <property name=\"format\"\n+                  value=\"(\\/\\/ (ok|violation)\\n)\"/>\n+        <property name=\"minimum\" value=\"1\"/>\n+        <message key=\"regexp.minimum\"\n+                 value=\"All files in the ''src/(it|test)/resources*''\n+                  folder must have trailing comments '// ok' and/ or '// violation'.\"/>\n+    </module>\n+\n+    <module name=\"TreeWalker\">\n+    </module>", "originalCommit": "761f0db6e98d4e0e84df8f994583c971c3dde909", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEyMjI2OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453122269", "bodyText": "Fixed.", "author": "nmancus1", "createdAt": "2020-07-10T23:39:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA5NTUxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA5NTg2NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453095865", "bodyText": "and/or", "author": "romani", "createdAt": "2020-07-10T22:00:05Z", "path": "config/checkstyle_input_checks.xml", "diffHunk": "@@ -0,0 +1,39 @@\n+<?xml version=\"1.0\"?>\n+<!DOCTYPE module PUBLIC\n+        \"-//Checkstyle//DTD Checkstyle Configuration 1.3//EN\"\n+        \"https://checkstyle.org/dtds/configuration_1_3.dtd\">\n+\n+<module name=\"Checker\">\n+    <property name=\"charset\" value=\"UTF-8\"/>\n+    <property name=\"haltOnException\" value=\"false\"/>\n+\n+    <property name=\"cacheFile\" value=\"target/cache_resources\"/>\n+\n+    <!-- Suppressions for resources -->\n+    <module name=\"SuppressionFilter\">\n+        <property name=\"file\"\n+                  value=\"${project.basedir}/config/checkstyle_input_suppressions.xml\"/>\n+    </module>\n+\n+    <!-- Check to make sure check UT input files have config and trailing comments -->\n+    <module name=\"RegexpMultiline\">\n+        <property name=\"format\"\n+                  value=\"(\\/\\/ config:)\"/>\n+        <property name=\"minimum\" value=\"1\"/>\n+        <message key=\"regexp.minimum\"\n+                 value=\"All files in the ''src/(it|test)/resources*'' folder must have a comment at\n+                 the top of the file specifying the check configuration used to produce the\n+                 violations, that begins with '// config:'.\"/>\n+    </module>\n+    <module name=\"RegexpMultiline\">\n+        <property name=\"format\"\n+                  value=\"(\\/\\/ (ok|violation)\\n)\"/>\n+        <property name=\"minimum\" value=\"1\"/>\n+        <message key=\"regexp.minimum\"\n+                 value=\"All files in the ''src/(it|test)/resources*''\n+                  folder must have trailing comments '// ok' and/ or '// violation'.\"/>", "originalCommit": "761f0db6e98d4e0e84df8f994583c971c3dde909", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzEyMjMwMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453122300", "bodyText": "Fixed.", "author": "nmancus1", "createdAt": "2020-07-10T23:39:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA5NTg2NQ=="}], "type": "inlineReview"}, {"oid": "8b61f3feb216aa86913751de85d9b4384cdcdcea", "url": "https://github.com/checkstyle/checkstyle/commit/8b61f3feb216aa86913751de85d9b4384cdcdcea", "message": "minor: verify correct format for check UT inputs(#8364)", "committedDate": "2020-07-10T23:34:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE5ODkzNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453198935", "bodyText": "I do not see any Input file that follow this format, but practice this approach for long time,\nPlease do, following search regexp:\n~/java/github/romani/checkstyle/src/test/resources [master|\u2714] \n$ ag \"\\* Config\" | grep java | wc -l\n36\n\nand remove 36 Inputs from suppression file.\nThere might be that some  Inputs missing // ok comment, please add it.\n~/java/github/romani/checkstyle/src/test/resources/com/puppycrawl/tools/checkstyle/checks [master|\u2714] \n$ ag \"\\* Config\" | grep java | cut -d ':' -f 1\nregexp/regexpmultiline/InputRegexpMultilineMultilineSupport2.java\nnaming/abbreviationaswordinname/InputAbbreviationAsWordInNameIgnoreNonStaticFinal.java\nnaming/abbreviationaswordinname/InputAbbreviationAsWordInNameIgnoreFinalKeepStaticFinal.java\nnaming/abbreviationaswordinname/InputAbbreviationAsWordInNameIgnoreFinal.java\nnaming/abbreviationaswordinname/InputAbbreviationAsWordInNameNoIgnore.java\nnaming/abbreviationaswordinname/InputAbbreviationAsWordInNameIgnoreStaticFinal.java\nnaming/abbreviationaswordinname/InputAbbreviationAsWordInNameIgnoreStatic.java\nnaming/abbreviationaswordinname/InputAbbreviationAsWordInNameIgnore.java\nnaming/abbreviationaswordinname/InputAbbreviationAsWordInNameIgnoreStaticKeepStaticFinal.java\nregexp/regexpmultiline/InputRegexpMultilineMultilineSupport.java\ncoding/unnecessarysemicolonafteroutertypedeclaration/InputUnnecessarySemicolonAfterOuterTypeDeclaration.java\ncoding/fallthrough/InputFallThroughDefault.java\ncoding/avoiddoublebraceinitialization/InputAvoidDoubleBraceInitialization.java\ncoding/unnecessarysemicolonaftertypememberdeclaration/InputUnnecessarySemicolonAfterTypeMemberDeclaration.java\ncoding/arraytrailingcomma/InputArrayTrailingCommaAlwaysDemandTrailingComma.java\ncoding/requirethis/InputRequireThisExpressions.java\ncoding/avoidnoargumentsuperconstructorcall/InputAvoidNoArgumentSuperConstructorCall.java\nblocks/rightcurly/InputRightCurlyAloneNewTokens.java\nblocks/rightcurly/InputRightCurlyAloneBlocksWithSemi.java\nblocks/rightcurly/InputRightCurlySameNewTokens.java\nblocks/rightcurly/InputRightCurlySameBlocksWithSemi.java\nblocks/rightcurly/InputRightCurlyAloneOrSingleLineNewTokens.java\nblocks/rightcurly/InputRightCurlyAloneOrSingleLineBlocksWithSemi.java\nblocks/needbraces/InputNeedBracesCaseDefaultNoSingleLine.java\nimports/customimportorder/InputCustomImportOrderEmptyRule.java\nimports/customimportorder/InputCustomImportOrder_OverlappingPatterns.java\nimports/customimportorder/InputCustomImportOrderDefault2.java\nwhitespace/emptylineseparator/InputEmptyLineSeparatorSingleCommentUnderPackage.java\nwhitespace/emptylineseparator/InputEmptyLineSeparatorBlockCommentSeparatedFromPackage.java\nwhitespace/emptylineseparator/InputEmptyLineSeparatorClassDefinitionAndCommentNotSeparatedFromPackage.java\nwhitespace/emptylineseparator/InputEmptyLineSeparatorSingleCommentSeparatedFromPackage.java\nwhitespace/emptylineseparator/InputEmptyLineSeparatorBlockCommentUnderPackage.java\nwhitespace/emptylineseparator/InputEmptyLineSeparatorModifierUnderPackage.java\njavadoc/missingjavadocmethod/InputMissingJavadocMethodPublicMethods.java\njavadoc/javadoctagcontinuationindentation/InputJavadocTagContinuationIndentationDescription.java\njavadoc/javadocmethod/InputJavadocMethodIgnoreThrows.java", "author": "romani", "createdAt": "2020-07-11T14:10:50Z", "path": "config/checkstyle_input_checks.xml", "diffHunk": "@@ -0,0 +1,36 @@\n+<?xml version=\"1.0\"?>\n+<!DOCTYPE module PUBLIC\n+        \"-//Checkstyle//DTD Checkstyle Configuration 1.3//EN\"\n+        \"https://checkstyle.org/dtds/configuration_1_3.dtd\">\n+\n+<module name=\"Checker\">\n+    <property name=\"charset\" value=\"UTF-8\"/>\n+    <property name=\"haltOnException\" value=\"false\"/>\n+\n+    <property name=\"cacheFile\" value=\"target/cache_resources\"/>\n+\n+    <!-- Suppressions for resources -->\n+    <module name=\"SuppressionFilter\">\n+        <property name=\"file\"\n+                  value=\"${project.basedir}/config/checkstyle_input_suppressions.xml\"/>\n+    </module>\n+\n+    <!-- Check to make sure check UT input files have config and trailing comments -->\n+    <module name=\"RegexpMultiline\">\n+        <property name=\"format\"\n+                  value=\"(\\/\\/ config:)\"/>", "originalCommit": "8b61f3feb216aa86913751de85d9b4384cdcdcea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIwMDg1OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453200858", "bodyText": "From this: #8413 (comment)\nI thought we wanted // config:.  But  most comments regarding config are block comments. I will update all config comments in other PRs to be javadoc comments, and change this regex to reflect this.", "author": "nmancus1", "createdAt": "2020-07-11T14:33:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE5ODkzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIwMTgwNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453201805", "bodyText": "yes, it was my fault, as we do this rarely ... we do not even remember what format we use :).", "author": "romani", "createdAt": "2020-07-11T14:45:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE5ODkzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE5OTQxMw==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453199413", "bodyText": "please do paths like blocks[\\\\/]rightcurly[\\\\/]InputRightCurlySameNewTokens.java\nand sort paths to keep all Checks Inputs together.\nIt will help us to improve Inputs continuously in that backlog.", "author": "romani", "createdAt": "2020-07-11T14:16:19Z", "path": "config/checkstyle_input_suppressions.xml", "diffHunk": "@@ -0,0 +1,1063 @@\n+<?xml version=\"1.0\"?>\n+\n+<!DOCTYPE suppressions PUBLIC\n+        \"-//Checkstyle//DTD SuppressionFilter Configuration 1.1//EN\"\n+        \"https://checkstyle.org/dtds/suppressions_1_1.dtd\">\n+\n+<suppressions>\n+\n+    <!-- Suppress miscellaneous files -->\n+    <suppress checks=\"RegexpMultiline\" files=\"package-info.java\"/>\n+\n+    <!-- Suppress older check UT input files -->\n+    <suppress checks=\"RegexpMultiline\" files=\"InputNoCodeInFile6.java\"/>", "originalCommit": "8b61f3feb216aa86913751de85d9b4384cdcdcea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE5OTU5MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453199591", "bodyText": "I thought about Multiline only to test format of comment, but it was my fault.\nWe do not need multiline at all, we do not use benefit of it here.\nPlease use https://checkstyle.org/config_regexp.html#Regexp", "author": "romani", "createdAt": "2020-07-11T14:18:56Z", "path": "config/checkstyle_input_checks.xml", "diffHunk": "@@ -0,0 +1,36 @@\n+<?xml version=\"1.0\"?>\n+<!DOCTYPE module PUBLIC\n+        \"-//Checkstyle//DTD Checkstyle Configuration 1.3//EN\"\n+        \"https://checkstyle.org/dtds/configuration_1_3.dtd\">\n+\n+<module name=\"Checker\">\n+    <property name=\"charset\" value=\"UTF-8\"/>\n+    <property name=\"haltOnException\" value=\"false\"/>\n+\n+    <property name=\"cacheFile\" value=\"target/cache_resources\"/>\n+\n+    <!-- Suppressions for resources -->\n+    <module name=\"SuppressionFilter\">\n+        <property name=\"file\"\n+                  value=\"${project.basedir}/config/checkstyle_input_suppressions.xml\"/>\n+    </module>\n+\n+    <!-- Check to make sure check UT input files have config and trailing comments -->\n+    <module name=\"RegexpMultiline\">", "originalCommit": "8b61f3feb216aa86913751de85d9b4384cdcdcea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE5OTg2NA==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453199864", "bodyText": "cache filename should be unique for checkstyle config. cache_input_resources", "author": "romani", "createdAt": "2020-07-11T14:21:44Z", "path": "config/checkstyle_input_checks.xml", "diffHunk": "@@ -0,0 +1,36 @@\n+<?xml version=\"1.0\"?>\n+<!DOCTYPE module PUBLIC\n+        \"-//Checkstyle//DTD Checkstyle Configuration 1.3//EN\"\n+        \"https://checkstyle.org/dtds/configuration_1_3.dtd\">\n+\n+<module name=\"Checker\">\n+    <property name=\"charset\" value=\"UTF-8\"/>\n+    <property name=\"haltOnException\" value=\"false\"/>\n+\n+    <property name=\"cacheFile\" value=\"target/cache_resources\"/>", "originalCommit": "8b61f3feb216aa86913751de85d9b4384cdcdcea", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d2a7012f02a835466c1b714f395c5c0baa0b1f8c", "url": "https://github.com/checkstyle/checkstyle/commit/d2a7012f02a835466c1b714f395c5c0baa0b1f8c", "message": "minor: verify correct format for check UT inputs(#8364)", "committedDate": "2020-07-13T15:05:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzcxODk4Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453718982", "bodyText": "I've added these excludes, since it doesn't make sense to check for configs in these inputs, and could cause false positives in the future. Are there anymore directories that you can think of that we should exclude?", "author": "nmancus1", "createdAt": "2020-07-13T15:07:11Z", "path": "config/ant-phase-verify.xml", "diffHunk": "@@ -170,5 +172,63 @@\n     <fail if=\"checkstyle.failure.property\"\n           message=\"Checkstyle failed: ${checkstyle.failure.property}\"\n           />\n+\n+    <tstamp>\n+      <format property=\"STARTED\" pattern=\"dd/MM/yyyy hh:mm:ss aa\"/>\n+    </tstamp>\n+    <echo level=\"info\">Checkstyle started (checkstyle_input_checks.xml): ${STARTED}</echo>\n+\n+    <checkstyle config=\"${check.config_input}\"\n+                failOnViolation=\"true\"\n+                failureProperty=\"checkstyle.failure.property\"\n+                executeIgnoredModules=\"true\"\n+    >\n+      <path>\n+        <fileset dir=\"src\"\n+                 includes=\"test/resources/**/*.java,test/resources-noncompilable/**/*.java\">\n+          <!-- bad syntax, permanent exclude -->\n+          <exclude name=\"**/InputAstTreeStringPrinter.java\" />\n+          <exclude name=\"**/InputSuppressionsStringPrinter.java\"/>\n+          <exclude name=\"**/InputMainIncorrectClass.java\"/>\n+          <exclude name=\"**/InputJavadocPropertiesGeneratorParseError.java\"/>\n+          <exclude name=\"**/InputMainFrameModelIncorrectClass.java\"/>\n+          <exclude name=\"**/InputBeforeExecutionExclusionFileFilterIncorrectClass.java\"/>\n+          <exclude name=\"**/InputJavaParser.java\"/>\n+          <!-- This check does not apply to grammar input files -->\n+          <exclude name=\"**/grammar/**/*\"/>\n+          <!-- No need to check xpathmapper files -->\n+          <exclude name=\"**/xpath/xpathmapper/**/*\"/>\n+          <!-- No need to check xpathquerygenerator files -->\n+          <exclude name=\"**/xpath/xpathquerygenerator/**/*\"/>\n+          <!-- No need to check xpathfilegenerator files -->\n+          <exclude name=\"**/xpathfilegenerator*/**/*\"/>\n+          <!-- No need to check main files -->\n+          <exclude name=\"**/main/**/*\"/>\n+          <!-- No need to check javaparser files -->\n+          <exclude name=\"**/javaparser/**/*\"/>\n+          <!-- No need to check treewalker files -->\n+          <exclude name=\"**/treewalker/**/*\"/>\n+          <!-- No need to check gui files -->\n+          <exclude name=\"**/gui/**/*\"/>\n+          <!-- No need to check api files -->\n+          <exclude name=\"**/api/**/*\"/>\n+          <!-- No need to check ant files -->\n+          <exclude name=\"**/ant/**/*\"/>", "originalCommit": "d2a7012f02a835466c1b714f395c5c0baa0b1f8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzcyMjY1Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8435#discussion_r453722656", "bodyText": "We can find them later on", "author": "romani", "createdAt": "2020-07-13T15:12:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzcxODk4Mg=="}], "type": "inlineReview"}, {"oid": "8ecdca175c75976885f6b79d336499071ce18385", "url": "https://github.com/checkstyle/checkstyle/commit/8ecdca175c75976885f6b79d336499071ce18385", "message": "minor: verify correct format for check UT inputs(#8364)", "committedDate": "2020-07-13T15:49:08Z", "type": "commit"}, {"oid": "8ecdca175c75976885f6b79d336499071ce18385", "url": "https://github.com/checkstyle/checkstyle/commit/8ecdca175c75976885f6b79d336499071ce18385", "message": "minor: verify correct format for check UT inputs(#8364)", "committedDate": "2020-07-13T15:49:08Z", "type": "forcePushed"}]}