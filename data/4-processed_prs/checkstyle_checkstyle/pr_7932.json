{"pr_number": 7932, "pr_title": "Issue #6192: New module RequireEmptyLineBeforeBlockTagGroup to ensure there is an empty line before javadoc tag like @param", "pr_createdAt": "2020-03-21T17:20:18Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/7932", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY1Mjc4MA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r399652780", "bodyText": "Double '' required", "author": "bmarwell", "createdAt": "2020-03-28T11:42:43Z", "path": "src/main/resources/com/puppycrawl/tools/checkstyle/checks/javadoc/messages_fr.properties", "diffHunk": "@@ -21,6 +21,7 @@ javadoc.paragraph.redundant.paragraph=Balise <p> redondante.\n javadoc.paragraph.tag.after=Une ligne vide doit \u00eatre suivie par une balise <p> sur la ligne suivante.\n javadoc.parse.rule.error=Le commentaire Javadoc \u00e0 la colonne {0} ne peut \u00eatre analys\u00e9. D\u00e9tails : {1} lors de l''analyse {2}\n javadoc.return.expected=Balise Javadoc @return manquante.\n+javadoc.tag.line.before=Javadoc @-clause {0} doit \u00eatre pr\u00e9c\u00e9d\u00e9 d'une ligne vide.", "originalCommit": "13fcfdc3c395fda0f54c737845442fde7d15532d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg1NTM5OA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r399855398", "bodyText": "Ok. I also added double '' to the other message.properties files.", "author": "josephmate", "createdAt": "2020-03-29T21:18:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY1Mjc4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU4MDEyMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r446580121", "bodyText": "please move this to separate PR to let me merge it immediately and reduce this PR, this will help maintainers to focus on details and nuances of it.", "author": "romani", "createdAt": "2020-06-27T23:50:50Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/JavadocParagraphCheck.java", "diffHunk": "@@ -262,6 +266,7 @@ private static boolean isFirstParagraph(DetailNode paragraphTag) {\n \n     /**\n      * Finds and returns nearest empty line in javadoc.\n+     *", "originalCommit": "a82b781202a860fd07ab44f21447386d7a1f876d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY5Njk2Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r446696967", "bodyText": "Ok. I moved the fixes here: #8347 . I will resolve this conversation once that's committed and I rebase this pull request with master.", "author": "josephmate", "createdAt": "2020-06-28T20:53:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU4MDEyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcxMTY5OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r446711699", "bodyText": "Merged", "author": "romani", "createdAt": "2020-06-28T23:25:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU4MDEyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njk2ODcxMA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r456968710", "bodyText": "Please add example for valid javadoc, to show user what is good", "author": "romani", "createdAt": "2020-07-19T23:24:47Z", "path": "src/xdocs/config_javadoc.xml", "diffHunk": "@@ -2912,6 +2911,110 @@ class DatabaseConfiguration {}\n       </subsection>\n     </section>\n \n+    <section name=\"RequireEmptyLineBeforeAtClauseBlock\">\n+      <p>Since Checkstyle 8.35</p>\n+      <subsection name=\"Description\" id=\"RequireEmptyLineBeforeAtClauseBlock_Description\">\n+        <p>\n+          Checks that one blank line before the at-clauses block if it is present in Javadoc.\n+        </p>\n+      </subsection>\n+      <subsection name=\"Properties\" id=\"RequireEmptyLineBeforeAtClauseBlock_Properties\">\n+        <div class=\"wrapper\">\n+          <table>\n+            <tr>\n+              <th>name</th>\n+              <th>description</th>\n+              <th>type</th>\n+              <th>default value</th>\n+              <th>since</th>\n+            </tr>\n+            <tr>\n+              <td>violateExecutionOnNonTightHtml</td>\n+              <td>\n+                Control when to print violations if the Javadoc being examined by this check\n+                violates the tight html rules defined at\n+                <a href=\"writingjavadocchecks.html#Tight-HTML_rules\">Tight-HTML Rules</a>.</td>\n+              <td><a href=\"property_types.html#boolean\">boolean</a></td>\n+              <td><code>false</code></td>\n+              <td>8.3</td>\n+            </tr>\n+          </table>\n+        </div>\n+      </subsection>\n+\n+      <subsection name=\"Examples\" id=\"RequireEmptyLineBeforeAtClauseBlock_Examples\">\n+        <p>\n+          To configure the check:\n+        </p>\n+        <source>\n+&lt;module name=&quot;RequireEmptyLineBeforeAtClauseBlock&quot;/&gt;\n+        </source>\n+        <p>\n+          By default, the check will report a violation if there is no blank line before the\n+          at-clause.\n+        </p>\n+        <source>\n+&#47;**\n+ * testMethod's javadoc.\n+ * &#64;return something (violation)", "originalCommit": "be8b6e035db8680672b3a38f3c9260fa8e9ef940", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njk2OTEwOA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r456969108", "bodyText": "If something force you to reference all messages ?", "author": "romani", "createdAt": "2020-07-19T23:29:04Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeAtClauseBlockCheck.java", "diffHunk": "@@ -0,0 +1,184 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the at-clauses block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeAtClauseBlock&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the at-clause.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ * }\n+ * </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}", "originalCommit": "be8b6e035db8680672b3a38f3c9260fa8e9ef940", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njk3NDUxNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r456974515", "bodyText": "Other files do same", "author": "romani", "createdAt": "2020-07-20T00:17:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njk2OTEwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njk3NTMxNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r456975315", "bodyText": "RequireEmptyLineBeforeAtClauseBlockCheck extends from AbstractJavadocCheck. As a result, RequireEmptyLineBeforeAtClauseBlockCheck needs to document those inherited properties. Some unit test fails if I don't. I don't remember which test.\nI see three approaches to handling this:\n\nMove those properties out of JavadocCheck into only the classes that needed it\nDon't extend from AbstractJavadocCheck\nDisable that unit test for JavadocCheck", "author": "josephmate", "createdAt": "2020-07-20T00:24:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njk2OTEwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIzOTM1Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r459239353", "bodyText": "Please inline content of this method, we try to keep log methods in visit method.", "author": "romani", "createdAt": "2020-07-23T06:32:23Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeAtClauseBlockCheck.java", "diffHunk": "@@ -0,0 +1,201 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the at-clauses block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeAtClauseBlock&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the at-clause,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other at-clauses like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.35\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeAtClauseBlockCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes an at-clause in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC\n+     * \\\n+     *  -- NEWLINE\n+     *  -- LEADING_ASTERISK\n+     *  -- WS\n+     *  -- JAVADOC_TAG\n+     * </pre>\n+     */\n+    private static final int NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG = 3;\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    @Override\n+    public void visitJavadocToken(DetailNode ast) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        checkAtClause(ast);", "originalCommit": "636e38e964d94089c00f2a1049044baea9741b59", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1Mzc3Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r460353777", "bodyText": "Ok. I deleted checkAtClause and move its contents into visitJavadocToken.", "author": "josephmate", "createdAt": "2020-07-25T02:35:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIzOTM1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI0MDIwMg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r459240202", "bodyText": "Please indent this and following lines further to right, to visually show nested expression.", "author": "romani", "createdAt": "2020-07-23T06:34:51Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeAtClauseBlockCheck.java", "diffHunk": "@@ -0,0 +1,201 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the at-clauses block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeAtClauseBlock&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the at-clause,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other at-clauses like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.35\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeAtClauseBlockCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes an at-clause in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC\n+     * \\\n+     *  -- NEWLINE\n+     *  -- LEADING_ASTERISK\n+     *  -- WS\n+     *  -- JAVADOC_TAG\n+     * </pre>\n+     */\n+    private static final int NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG = 3;\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    @Override\n+    public void visitJavadocToken(DetailNode ast) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        checkAtClause(ast);\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the at clause.\n+     *\n+     * @param atClause the at clause to check for an empty space before it.\n+     */\n+    private void checkAtClause(DetailNode atClause) {\n+        if (!isAnotherAtClauseBefore(atClause)\n+                && !isOnlyAtClauseNothingElse(atClause)\n+                && insufficientConsecutiveNewlines(atClause)) {\n+            log(atClause.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    atClause.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherAtClauseBefore(DetailNode atClause) {\n+        boolean found = false;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(atClause);\n+        while (currentClause != null) {\n+            if (currentClause.getType() == JavadocTokenTypes.JAVADOC_TAG) {\n+                found = true;\n+                break;\n+            }\n+            currentClause = JavadocUtil.getPreviousSibling(currentClause);\n+        }\n+        return found;\n+    }\n+\n+    private static boolean isOnlyAtClauseNothingElse(DetailNode atClause) {\n+        int count = 0;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(atClause);\n+        while (currentClause != null) {\n+            count++;\n+            currentClause = JavadocUtil.getPreviousSibling(currentClause);\n+        }\n+        return count == NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG;\n+    }\n+\n+    /**\n+     * Iterates through the previous siblings of the atClause looking for empty lines until\n+     * there are no more siblings or it hits something other than asterisk, whitespace or newline.\n+     * If it finds at least one empty line, return true. Return false otherwise.\n+     *\n+     * @param atClause the atClause to check if there are sufficient empty lines before it.\n+     * @return true if there are enough empty lines before the atClause.\n+     */\n+    private static boolean insufficientConsecutiveNewlines(DetailNode atClause) {\n+        int count = 0;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(atClause);\n+        while (currentClause != null\n+                && count <= 1\n+                && (currentClause.getType() == JavadocTokenTypes.NEWLINE\n+                || currentClause.getType() == JavadocTokenTypes.WS", "originalCommit": "636e38e964d94089c00f2a1049044baea9741b59", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1Mzg0Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r460353847", "bodyText": "I added an additional indentation to both the || lines.", "author": "josephmate", "createdAt": "2020-07-25T02:35:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI0MDIwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI0MDgwMA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r459240800", "bodyText": "Please make it first expression, to bring null check close to getType block.", "author": "romani", "createdAt": "2020-07-23T06:36:31Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeAtClauseBlockCheck.java", "diffHunk": "@@ -0,0 +1,201 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the at-clauses block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeAtClauseBlock&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the at-clause,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other at-clauses like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.35\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeAtClauseBlockCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes an at-clause in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC\n+     * \\\n+     *  -- NEWLINE\n+     *  -- LEADING_ASTERISK\n+     *  -- WS\n+     *  -- JAVADOC_TAG\n+     * </pre>\n+     */\n+    private static final int NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG = 3;\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    @Override\n+    public void visitJavadocToken(DetailNode ast) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        checkAtClause(ast);\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the at clause.\n+     *\n+     * @param atClause the at clause to check for an empty space before it.\n+     */\n+    private void checkAtClause(DetailNode atClause) {\n+        if (!isAnotherAtClauseBefore(atClause)\n+                && !isOnlyAtClauseNothingElse(atClause)\n+                && insufficientConsecutiveNewlines(atClause)) {\n+            log(atClause.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    atClause.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherAtClauseBefore(DetailNode atClause) {\n+        boolean found = false;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(atClause);\n+        while (currentClause != null) {\n+            if (currentClause.getType() == JavadocTokenTypes.JAVADOC_TAG) {\n+                found = true;\n+                break;\n+            }\n+            currentClause = JavadocUtil.getPreviousSibling(currentClause);\n+        }\n+        return found;\n+    }\n+\n+    private static boolean isOnlyAtClauseNothingElse(DetailNode atClause) {\n+        int count = 0;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(atClause);\n+        while (currentClause != null) {\n+            count++;\n+            currentClause = JavadocUtil.getPreviousSibling(currentClause);\n+        }\n+        return count == NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG;\n+    }\n+\n+    /**\n+     * Iterates through the previous siblings of the atClause looking for empty lines until\n+     * there are no more siblings or it hits something other than asterisk, whitespace or newline.\n+     * If it finds at least one empty line, return true. Return false otherwise.\n+     *\n+     * @param atClause the atClause to check if there are sufficient empty lines before it.\n+     * @return true if there are enough empty lines before the atClause.\n+     */\n+    private static boolean insufficientConsecutiveNewlines(DetailNode atClause) {\n+        int count = 0;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(atClause);\n+        while (currentClause != null\n+                && count <= 1", "originalCommit": "636e38e964d94089c00f2a1049044baea9741b59", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1MzkzMw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r460353933", "bodyText": "I moved null check just before currentClause.getType()", "author": "josephmate", "createdAt": "2020-07-25T02:36:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTI0MDgwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODE5OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r460408199", "bodyText": "After a bit of think on this number ... I still think it is bit non-reliable approach.\nplease\n\nmove whole javadoc of this field to isOnlyAtClauseNothingElse.\nplease format tree to follow our style as at https://checkstyle.sourceforge.io/apidocs/com/puppycrawl/tools/checkstyle/api/JavadocTokenTypes.html#JAVADOC\nplease avoid NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG as constant and let use logic like:\n\nprevSibling = getPrevSibling\nif (prevSibling != null && prevSibling.getType=WS) {\n  prevSibling = getPrevSibling\n  if (prevSibling != null && prevSibling.getType=LEADING_ASTERISK) {\n\n(or something similar)", "author": "romani", "createdAt": "2020-07-25T14:05:35Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeAtClauseBlockCheck.java", "diffHunk": "@@ -0,0 +1,197 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the at-clauses block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeAtClauseBlock&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the at-clause,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other at-clauses like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.35\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeAtClauseBlockCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes an at-clause in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC\n+     * \\\n+     *  -- NEWLINE\n+     *  -- LEADING_ASTERISK\n+     *  -- WS\n+     *  -- JAVADOC_TAG\n+     * </pre>\n+     */\n+    private static final int NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG = 3;", "originalCommit": "9fe81cbc338289b6f8dc5733d0fd960c809cb984", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY0MTU2Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r467641563", "bodyText": "I tried to get rid of the constant but I failed and actual did worse! I added a second constant.\nMy first attempt was the code below:\nboolean result = false;\nDetailNode prevClause = JavadocUtil.getPreviousSibling(tagNode);\nif (prevClause != null && prevClause.getType() == JavadocTokenTypes.WS) {\n    prevClause = JavadocUtil.getPreviousSibling(tagNode);\n    if (prevClause != null && prevClause.getType() == JavadocTokenTypes.LEADING_ASTERISK) {\n        prevClause = JavadocUtil.getPreviousSibling(tagNode);\n        result = prevClause.getType() == JavadocTokenTypes.NEWLINE;\n    }\n}\nreturn result;\nbut that result in many uncovered branches. While searching for test cases to cover the missing branches, I found this test case that I needed to cover\n/**\n *@param nospace There's no space.\n */\nI need to make sure the above example does not recommend a newline. Another indepedent check will recommend adding a space.\nSupporting this case requires even more branches.\nUsing hardcode lists of the expected types came out much cleaner.\nLet me know what you think. I will try again with if statements and search for test cases to cover all the branches is creates if you don't like the List solution.", "author": "josephmate", "createdAt": "2020-08-09T23:24:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODE5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxODMzNA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r469318334", "bodyText": "it is very good that coverage tool try to help us with extra test cases and we become to see more edge case.\nWe should not afraid coverage ... it guides to better code and tests.\nI still scary of this magic number 3.\nlet have one more PR and we will compare code to be more certain about alternative to magic number.\n\nI need to make sure the above example does not recommend a newline. Another indepedent check will recommend adding a space.\n\nyes. yes.", "author": "romani", "createdAt": "2020-08-12T14:51:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODE5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk5NDg1MA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r470994850", "bodyText": "The magic number 3 is gone. It's replaced by the two expected lists of previous siblings:\n    /**\n     * Case when space separates the tag and the asterisk like in the below example.\n     * <pre>\n     *  /**\n     *   * &#64;param noSpace there is no space here\n     * </pre>\n     */\n    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n            JavadocTokenTypes.WS,\n            JavadocTokenTypes.LEADING_ASTERISK,\n            JavadocTokenTypes.NEWLINE);\n\n    /**\n     * Case when no space separates the tag and the asterisk like in the below example.\n     * <pre>\n     *  /**\n     *   *&#64;param noSpace there is no space here\n     * </pre>\n     */\n    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(\n            JavadocTokenTypes.LEADING_ASTERISK,\n            JavadocTokenTypes.NEWLINE);", "author": "josephmate", "createdAt": "2020-08-15T14:17:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODE5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODI5MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r460408291", "bodyText": "isOnlyAtClauseInWholeJavadoc", "author": "romani", "createdAt": "2020-07-25T14:06:43Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeAtClauseBlockCheck.java", "diffHunk": "@@ -0,0 +1,197 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the at-clauses block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeAtClauseBlock&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the at-clause,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other at-clauses like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.35\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeAtClauseBlockCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes an at-clause in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC\n+     * \\\n+     *  -- NEWLINE\n+     *  -- LEADING_ASTERISK\n+     *  -- WS\n+     *  -- JAVADOC_TAG\n+     * </pre>\n+     */\n+    private static final int NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG = 3;\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the at clause.\n+     *\n+     * @param atClause the at at-clause node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode atClause) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        if (!isAnotherAtClauseBefore(atClause)\n+                && !isOnlyAtClauseNothingElse(atClause)\n+                && insufficientConsecutiveNewlines(atClause)) {\n+            log(atClause.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    atClause.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherAtClauseBefore(DetailNode atClause) {\n+        boolean found = false;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(atClause);\n+        while (currentClause != null) {\n+            if (currentClause.getType() == JavadocTokenTypes.JAVADOC_TAG) {\n+                found = true;\n+                break;\n+            }\n+            currentClause = JavadocUtil.getPreviousSibling(currentClause);\n+        }\n+        return found;\n+    }\n+\n+    private static boolean isOnlyAtClauseNothingElse(DetailNode atClause) {", "originalCommit": "9fe81cbc338289b6f8dc5733d0fd960c809cb984", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY0MTYxMw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r467641613", "bodyText": "done. also renamed AtClause to Tag based on below comment", "author": "josephmate", "createdAt": "2020-08-09T23:25:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODI5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODc4OA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r460408788", "bodyText": "please rename all atClause to tag in method names also.\nInternally we call it tag https://checkstyle.sourceforge.io/apidocs/com/puppycrawl/tools/checkstyle/api/JavadocTokenTypes.html#JAVADOC_TAG , so implementation should use same terminology.\nI will review later if we need to change name Check  of Check, it is could be more user friendly, I need to refresh my mind on when at-clause is better to use.", "author": "romani", "createdAt": "2020-07-25T14:13:20Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeAtClauseBlockCheck.java", "diffHunk": "@@ -0,0 +1,197 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the at-clauses block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeAtClauseBlock&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the at-clause,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other at-clauses like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.35\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeAtClauseBlockCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes an at-clause in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC\n+     * \\\n+     *  -- NEWLINE\n+     *  -- LEADING_ASTERISK\n+     *  -- WS\n+     *  -- JAVADOC_TAG\n+     * </pre>\n+     */\n+    private static final int NUM_OF_SIBLINGS_BEFORE_ONLY_JAVADOC_TAG = 3;\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the at clause.\n+     *\n+     * @param atClause the at at-clause node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode atClause) {", "originalCommit": "9fe81cbc338289b6f8dc5733d0fd960c809cb984", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQxMDU4Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r460410582", "bodyText": "unfortunately name of Check need to changed, please read #6192 (comment) for more details.\nnew name RequireEmptyLineBeforeBlockTagsGroupCheck.java", "author": "romani", "createdAt": "2020-07-25T14:34:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODc4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY0MTc0Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r467641742", "bodyText": "Ok. I renamed all the classes to follow RequireEmptyLineBeforeBlockTagsGroup. I also grepped for all occurrences of atclause, at-clause, and at clause and replaced it with tag to keep it consistent.", "author": "josephmate", "createdAt": "2020-08-09T23:26:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQwODc4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjA0Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r469312042", "bodyText": "lets do not use \"clause\" at all.", "author": "romani", "createdAt": "2020-08-12T14:42:37Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeBlockTagsGroupCheck.java", "diffHunk": "@@ -0,0 +1,243 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the tag block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeBlockTagsGroup&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the tag block,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other tags like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.36\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeBlockTagsGroupCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes a tag in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * Case when space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   * &#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n+            JavadocTokenTypes.WS,\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    /**\n+     * Case when no space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   *&#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the tag.\n+     *\n+     * @param tagNode the at tag node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode tagNode) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        if (!isAnotherTagBefore(tagNode)\n+                && !isOnlyTagInWholeJavadoc(tagNode)\n+                && insufficientConsecutiveNewlines(tagNode)) {\n+            log(tagNode.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    tagNode.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherTagBefore(DetailNode tagNode) {\n+        boolean found = false;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(tagNode);\n+        while (currentClause != null) {\n+            if (currentClause.getType() == JavadocTokenTypes.JAVADOC_TAG) {\n+                found = true;\n+                break;\n+            }\n+            currentClause = JavadocUtil.getPreviousSibling(currentClause);\n+        }\n+        return found;\n+    }\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 2 or 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--NEWLINE[3x0] : [\\n]\n+     * |--LEADING_ASTERISK[4x0] : [ *]\n+     * |--WS[4x2] : [ ]\n+     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n+     * </pre>\n+     * Or it can also look like:\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--NEWLINE[3x0] : [\\n]\n+     * |--LEADING_ASTERISK[4x0] : [ *]\n+     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n+     * </pre>\n+     * We do not include the variation\n+     * <pre>\n+     *  /**&#64;param noSpace there is no space here\n+     * </pre>\n+     * which results in the tree\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--JAVADOC_TAG[4x3] : [@param noSpace there is no space here\\n ]\n+     * </pre>\n+     * because this one is invalid. We must recommend placing a blank line to separate &#64;param\n+     * from the first javadoc asterisks.\n+     *\n+     * @param tagNode the at tag node to check if there is nothing before it.\n+     * @return true if there no text before the tagNode.\n+     */\n+    private static boolean isOnlyTagInWholeJavadoc(DetailNode tagNode) {\n+        final List<Integer> previousNodeTypes = new ArrayList<>();\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(tagNode);\n+        while (currentClause != null) {\n+            previousNodeTypes.add(currentClause.getType());\n+            currentClause = JavadocUtil.getPreviousSibling(currentClause);\n+        }\n+        return ONLY_TAG_VARIATION_1.equals(previousNodeTypes)\n+                || ONLY_TAG_VARIATION_2.equals(previousNodeTypes);\n+    }\n+\n+    /**\n+     * Iterates through the previous siblings of the tagNode looking for empty lines until\n+     * there are no more siblings or it hits something other than asterisk, whitespace or newline.\n+     * If it finds at least one empty line, return true. Return false otherwise.\n+     *\n+     * @param tagNode the tagNode to check if there are sufficient empty lines before it.\n+     * @return true if there are enough empty lines before the tagNode.\n+     */\n+    private static boolean insufficientConsecutiveNewlines(DetailNode tagNode) {\n+        int count = 0;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(tagNode);", "originalCommit": "9644dc435a99d57bdf65fb6a907693b2c1629b07", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk5ODU5Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r470998593", "bodyText": "done", "author": "josephmate", "createdAt": "2020-08-15T15:03:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjA0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjE3OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r469312179", "bodyText": "lets do not use \"clause\" at all.", "author": "romani", "createdAt": "2020-08-12T14:42:49Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeBlockTagsGroupCheck.java", "diffHunk": "@@ -0,0 +1,243 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the tag block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeBlockTagsGroup&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the tag block,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other tags like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.36\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeBlockTagsGroupCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes a tag in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * Case when space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   * &#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n+            JavadocTokenTypes.WS,\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    /**\n+     * Case when no space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   *&#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the tag.\n+     *\n+     * @param tagNode the at tag node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode tagNode) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        if (!isAnotherTagBefore(tagNode)\n+                && !isOnlyTagInWholeJavadoc(tagNode)\n+                && insufficientConsecutiveNewlines(tagNode)) {\n+            log(tagNode.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    tagNode.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherTagBefore(DetailNode tagNode) {\n+        boolean found = false;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(tagNode);\n+        while (currentClause != null) {\n+            if (currentClause.getType() == JavadocTokenTypes.JAVADOC_TAG) {\n+                found = true;\n+                break;\n+            }\n+            currentClause = JavadocUtil.getPreviousSibling(currentClause);\n+        }\n+        return found;\n+    }\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 2 or 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--NEWLINE[3x0] : [\\n]\n+     * |--LEADING_ASTERISK[4x0] : [ *]\n+     * |--WS[4x2] : [ ]\n+     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n+     * </pre>\n+     * Or it can also look like:\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--NEWLINE[3x0] : [\\n]\n+     * |--LEADING_ASTERISK[4x0] : [ *]\n+     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n+     * </pre>\n+     * We do not include the variation\n+     * <pre>\n+     *  /**&#64;param noSpace there is no space here\n+     * </pre>\n+     * which results in the tree\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--JAVADOC_TAG[4x3] : [@param noSpace there is no space here\\n ]\n+     * </pre>\n+     * because this one is invalid. We must recommend placing a blank line to separate &#64;param\n+     * from the first javadoc asterisks.\n+     *\n+     * @param tagNode the at tag node to check if there is nothing before it.\n+     * @return true if there no text before the tagNode.\n+     */\n+    private static boolean isOnlyTagInWholeJavadoc(DetailNode tagNode) {\n+        final List<Integer> previousNodeTypes = new ArrayList<>();\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(tagNode);", "originalCommit": "9644dc435a99d57bdf65fb6a907693b2c1629b07", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk5ODYwNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r470998605", "bodyText": "done", "author": "josephmate", "createdAt": "2020-08-15T15:03:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjE3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjI4NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r469312285", "bodyText": "lets do not use \"clause\" at all.", "author": "romani", "createdAt": "2020-08-12T14:43:00Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeBlockTagsGroupCheck.java", "diffHunk": "@@ -0,0 +1,243 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the tag block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeBlockTagsGroup&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the tag block,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other tags like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.36\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeBlockTagsGroupCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes a tag in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * Case when space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   * &#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n+            JavadocTokenTypes.WS,\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    /**\n+     * Case when no space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   *&#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the tag.\n+     *\n+     * @param tagNode the at tag node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode tagNode) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        if (!isAnotherTagBefore(tagNode)\n+                && !isOnlyTagInWholeJavadoc(tagNode)\n+                && insufficientConsecutiveNewlines(tagNode)) {\n+            log(tagNode.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    tagNode.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherTagBefore(DetailNode tagNode) {\n+        boolean found = false;\n+        DetailNode currentClause = JavadocUtil.getPreviousSibling(tagNode);", "originalCommit": "9644dc435a99d57bdf65fb6a907693b2c1629b07", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk5ODYwNw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r470998607", "bodyText": "done", "author": "josephmate", "createdAt": "2020-08-15T15:03:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTMxMjI4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMDUzMA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471830530", "bodyText": "shouldn't tag be singular?", "author": "rnveach", "createdAt": "2020-08-17T23:33:54Z", "path": "config/checkstyle_checks.xml", "diffHunk": "@@ -545,6 +545,7 @@\n     <module name=\"SingleLineJavadoc\"/>\n     <module name=\"WriteTag\"/>\n     <module name=\"SummaryJavadoc\"/>\n+    <module name=\"RequireEmptyLineBeforeBlockTagsGroup\"/>", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDgxNg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160816", "bodyText": "I case insensitive searched for TagsGroup and replaced with TagGroup.", "author": "josephmate", "createdAt": "2020-08-23T02:31:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMDUzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMjgyMg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471832822", "bodyText": "If we remove variation 1, won't 2 always match? If we have to match the entire line or up to the asterisk, isn't it fast to check a size of 2 and the last 2 items are the ones we want?", "author": "rnveach", "createdAt": "2020-08-17T23:41:40Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeBlockTagsGroupCheck.java", "diffHunk": "@@ -0,0 +1,243 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the tag block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeBlockTagsGroup&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the tag block,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other tags like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.36\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeBlockTagsGroupCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes a tag in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * Case when space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   * &#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n+            JavadocTokenTypes.WS,\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    /**\n+     * Case when no space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   *&#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDgzOA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160838", "bodyText": "This one is not done. It requires a response.\nI need to check for\n     * JAVADOC[3x0]\n     * |--NEWLINE[3x0] : [\\n]\n     * |--LEADING_ASTERISK[4x0] : [ *]\n     * |--WS[4x2] : [ ]\n     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n\nand\n     * JAVADOC[3x0]\n     * |--NEWLINE[3x0] : [\\n]\n     * |--LEADING_ASTERISK[4x0] : [ *]\n     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n\nsize of 2 won't match case 1. I could replace variation 1 with first element is WS and last 2 elements are variation 2.", "author": "josephmate", "createdAt": "2020-08-23T02:31:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMjgyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIzOTUzOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475239539", "bodyText": "I am marking this resolved, as I can't think of another way right now.", "author": "rnveach", "createdAt": "2020-08-23T16:39:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMjgyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMzAzNg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471833036", "bodyText": "boolean methods should start with something like is, has, etc...", "author": "rnveach", "createdAt": "2020-08-17T23:42:19Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeBlockTagsGroupCheck.java", "diffHunk": "@@ -0,0 +1,243 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the tag block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeBlockTagsGroup&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the tag block,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other tags like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.36\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeBlockTagsGroupCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes a tag in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * Case when space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   * &#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n+            JavadocTokenTypes.WS,\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    /**\n+     * Case when no space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   *&#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the tag.\n+     *\n+     * @param tagNode the at tag node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode tagNode) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        if (!isAnotherTagBefore(tagNode)\n+                && !isOnlyTagInWholeJavadoc(tagNode)\n+                && insufficientConsecutiveNewlines(tagNode)) {\n+            log(tagNode.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    tagNode.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherTagBefore(DetailNode tagNode) {\n+        boolean found = false;\n+        DetailNode currentNode = JavadocUtil.getPreviousSibling(tagNode);\n+        while (currentNode != null) {\n+            if (currentNode.getType() == JavadocTokenTypes.JAVADOC_TAG) {\n+                found = true;\n+                break;\n+            }\n+            currentNode = JavadocUtil.getPreviousSibling(currentNode);\n+        }\n+        return found;\n+    }\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 2 or 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--NEWLINE[3x0] : [\\n]\n+     * |--LEADING_ASTERISK[4x0] : [ *]\n+     * |--WS[4x2] : [ ]\n+     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n+     * </pre>\n+     * Or it can also look like:\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--NEWLINE[3x0] : [\\n]\n+     * |--LEADING_ASTERISK[4x0] : [ *]\n+     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n+     * </pre>\n+     * We do not include the variation\n+     * <pre>\n+     *  /**&#64;param noSpace there is no space here\n+     * </pre>\n+     * which results in the tree\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--JAVADOC_TAG[4x3] : [@param noSpace there is no space here\\n ]\n+     * </pre>\n+     * because this one is invalid. We must recommend placing a blank line to separate &#64;param\n+     * from the first javadoc asterisks.\n+     *\n+     * @param tagNode the at tag node to check if there is nothing before it.\n+     * @return true if there no text before the tagNode.\n+     */\n+    private static boolean isOnlyTagInWholeJavadoc(DetailNode tagNode) {\n+        final List<Integer> previousNodeTypes = new ArrayList<>();\n+        DetailNode currentNode = JavadocUtil.getPreviousSibling(tagNode);\n+        while (currentNode != null) {\n+            previousNodeTypes.add(currentNode.getType());\n+            currentNode = JavadocUtil.getPreviousSibling(currentNode);\n+        }\n+        return ONLY_TAG_VARIATION_1.equals(previousNodeTypes)\n+                || ONLY_TAG_VARIATION_2.equals(previousNodeTypes);\n+    }\n+\n+    /**\n+     * Iterates through the previous siblings of the tagNode looking for empty lines until\n+     * there are no more siblings or it hits something other than asterisk, whitespace or newline.\n+     * If it finds at least one empty line, return true. Return false otherwise.\n+     *\n+     * @param tagNode the tagNode to check if there are sufficient empty lines before it.\n+     * @return true if there are enough empty lines before the tagNode.\n+     */\n+    private static boolean insufficientConsecutiveNewlines(DetailNode tagNode) {", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDgzOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160839", "bodyText": "done. renamed to hasInsufficientConsecutiveNewlines.", "author": "josephmate", "createdAt": "2020-08-23T02:31:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMzAzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMzc2Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471833766", "bodyText": "First sentence of the javadoc is the most important and says what it is doing for the user calling it. Javadoc printers will only show it for summaries. First sentence is pretty long and 2nd and 3rd still say what its doing. Can we redo the first sentence so it gives a clear informaition and leave further sentences to be implementation specific?", "author": "rnveach", "createdAt": "2020-08-17T23:44:48Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeBlockTagsGroupCheck.java", "diffHunk": "@@ -0,0 +1,243 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the tag block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeBlockTagsGroup&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the tag block,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other tags like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.36\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeBlockTagsGroupCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes a tag in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * Case when space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   * &#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n+            JavadocTokenTypes.WS,\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    /**\n+     * Case when no space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   *&#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the tag.\n+     *\n+     * @param tagNode the at tag node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode tagNode) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        if (!isAnotherTagBefore(tagNode)\n+                && !isOnlyTagInWholeJavadoc(tagNode)\n+                && insufficientConsecutiveNewlines(tagNode)) {\n+            log(tagNode.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    tagNode.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherTagBefore(DetailNode tagNode) {\n+        boolean found = false;\n+        DetailNode currentNode = JavadocUtil.getPreviousSibling(tagNode);\n+        while (currentNode != null) {\n+            if (currentNode.getType() == JavadocTokenTypes.JAVADOC_TAG) {\n+                found = true;\n+                break;\n+            }\n+            currentNode = JavadocUtil.getPreviousSibling(currentNode);\n+        }\n+        return found;\n+    }\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 2 or 3 siblings before it. The parse tree looks like:\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--NEWLINE[3x0] : [\\n]\n+     * |--LEADING_ASTERISK[4x0] : [ *]\n+     * |--WS[4x2] : [ ]\n+     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n+     * </pre>\n+     * Or it can also look like:\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--NEWLINE[3x0] : [\\n]\n+     * |--LEADING_ASTERISK[4x0] : [ *]\n+     * |--JAVADOC_TAG[4x3] : [@param T The bar.\\n ]\n+     * </pre>\n+     * We do not include the variation\n+     * <pre>\n+     *  /**&#64;param noSpace there is no space here\n+     * </pre>\n+     * which results in the tree\n+     * <pre>\n+     * JAVADOC[3x0]\n+     * |--JAVADOC_TAG[4x3] : [@param noSpace there is no space here\\n ]\n+     * </pre>\n+     * because this one is invalid. We must recommend placing a blank line to separate &#64;param\n+     * from the first javadoc asterisks.\n+     *\n+     * @param tagNode the at tag node to check if there is nothing before it.\n+     * @return true if there no text before the tagNode.\n+     */\n+    private static boolean isOnlyTagInWholeJavadoc(DetailNode tagNode) {\n+        final List<Integer> previousNodeTypes = new ArrayList<>();\n+        DetailNode currentNode = JavadocUtil.getPreviousSibling(tagNode);\n+        while (currentNode != null) {\n+            previousNodeTypes.add(currentNode.getType());\n+            currentNode = JavadocUtil.getPreviousSibling(currentNode);\n+        }\n+        return ONLY_TAG_VARIATION_1.equals(previousNodeTypes)\n+                || ONLY_TAG_VARIATION_2.equals(previousNodeTypes);\n+    }\n+\n+    /**\n+     * Iterates through the previous siblings of the tagNode looking for empty lines until\n+     * there are no more siblings or it hits something other than asterisk, whitespace or newline.\n+     * If it finds at least one empty line, return true. Return false otherwise.", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDg0NA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160844", "bodyText": "done. Returns true when there are not enough empty lines before the provided tagNode.", "author": "josephmate", "createdAt": "2020-08-23T02:31:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMzc2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIzODIzNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475238235", "bodyText": "This i fine but I would try to avoid duplicating what the return statement will say, otherwise what is the purpose of having 2 places say the same thing.", "author": "rnveach", "createdAt": "2020-08-23T16:25:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzMzc2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDE3OA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471834178", "bodyText": "same.", "author": "rnveach", "createdAt": "2020-08-17T23:46:11Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeBlockTagsGroupCheck.java", "diffHunk": "@@ -0,0 +1,243 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the tag block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeBlockTagsGroup&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the tag block,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other tags like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.36\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeBlockTagsGroupCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes a tag in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * Case when space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   * &#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n+            JavadocTokenTypes.WS,\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    /**\n+     * Case when no space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   *&#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the tag.\n+     *\n+     * @param tagNode the at tag node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode tagNode) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        if (!isAnotherTagBefore(tagNode)\n+                && !isOnlyTagInWholeJavadoc(tagNode)\n+                && insufficientConsecutiveNewlines(tagNode)) {\n+            log(tagNode.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    tagNode.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherTagBefore(DetailNode tagNode) {\n+        boolean found = false;\n+        DetailNode currentNode = JavadocUtil.getPreviousSibling(tagNode);\n+        while (currentNode != null) {\n+            if (currentNode.getType() == JavadocTokenTypes.JAVADOC_TAG) {\n+                found = true;\n+                break;\n+            }\n+            currentNode = JavadocUtil.getPreviousSibling(currentNode);\n+        }\n+        return found;\n+    }\n+\n+    /**\n+     * When javadoc has only a javadoc tag like {@literal @} in it, the JAVADOC_TAG in a JAVADOC\n+     * detail node will always have 2 or 3 siblings before it. The parse tree looks like:", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDg0Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160846", "bodyText": "done. Returns true when there are is only whitespace and asterisks before the provided tagNode.", "author": "josephmate", "createdAt": "2020-08-23T02:32:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDE3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIzODMwOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475238309", "bodyText": "same.", "author": "rnveach", "createdAt": "2020-08-23T16:26:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDE3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDM0Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471834347", "bodyText": "@romani Shouldn't this method be required to have a javadoc?", "author": "rnveach", "createdAt": "2020-08-17T23:46:45Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/RequireEmptyLineBeforeBlockTagsGroupCheck.java", "diffHunk": "@@ -0,0 +1,243 @@\n+////////////////////////////////////////////////////////////////////////////////\n+// checkstyle: Checks Java source code for adherence to a set of rules.\n+// Copyright (C) 2001-2020 the original author or authors.\n+//\n+// This library is free software; you can redistribute it and/or\n+// modify it under the terms of the GNU Lesser General Public\n+// License as published by the Free Software Foundation; either\n+// version 2.1 of the License, or (at your option) any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+// You should have received a copy of the GNU Lesser General Public\n+// License along with this library; if not, write to the Free Software\n+// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+////////////////////////////////////////////////////////////////////////////////\n+\n+package com.puppycrawl.tools.checkstyle.checks.javadoc;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.puppycrawl.tools.checkstyle.StatelessCheck;\n+import com.puppycrawl.tools.checkstyle.api.DetailNode;\n+import com.puppycrawl.tools.checkstyle.api.JavadocTokenTypes;\n+import com.puppycrawl.tools.checkstyle.utils.JavadocUtil;\n+\n+/**\n+ * <p>\n+ * Checks that one blank line before the tag block if it is present in Javadoc.\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * Property {@code violateExecutionOnNonTightHtml} - Control when to print violations\n+ * if the Javadoc being examined by this check violates the tight html rules defined at\n+ * <a href=\"https://checkstyle.org/writingjavadocchecks.html#Tight-HTML_rules\">\n+ * Tight-HTML Rules</a>.\n+ * Type is {@code boolean}. Default value is {@code false}.\n+ * </li>\n+ * </ul>\n+ * <p>\n+ * To configure the check:\n+ * </p>\n+ * <pre>\n+ * &lt;module name=&quot;RequireEmptyLineBeforeBlockTagsGroup&quot;/&gt;\n+ * </pre>\n+ * <p>\n+ * By default, the check will report a violation if there is no blank line before the tag block,\n+ * like in the example below.\n+ * </p>\n+ * <pre>\n+ * &#47;**\n+ *  * testMethod's javadoc.\n+ *  * &#64;return something (violation)\n+ *  *&#47;\n+ * public boolean testMethod() {\n+ *     return false;\n+ * }\n+ * </pre>\n+ * <p>\n+ *  Valid javadoc should have a blank line separating the parameters, return, throw, or\n+ *  other tags like in the example below.\n+ *  </p>\n+ *  <pre>\n+ *  &#47;**\n+ *  * testMethod's javadoc.\n+ *  *\n+ *  * &#64;param firstParam\n+ *  * &#64;return something\n+ *  *&#47;\n+ *  public boolean testMethod(int firstParam) {\n+ *      return false;\n+ *  }\n+ *  </pre>\n+ * <p>\n+ * Parent is {@code com.puppycrawl.tools.checkstyle.TreeWalker}\n+ * </p>\n+ * <p>\n+ * Violation Message Keys:\n+ * </p>\n+ * <ul>\n+ * <li>\n+ * {@code javadoc.missed.html.close}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.parse.rule.error}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.tag.line.before}\n+ * </li>\n+ * <li>\n+ * {@code javadoc.wrong.singleton.html.tag}\n+ * </li>\n+ * </ul>\n+ *\n+ * @since 8.36\n+ */\n+@StatelessCheck\n+public class RequireEmptyLineBeforeBlockTagsGroupCheck extends AbstractJavadocCheck {\n+\n+    /**\n+     * The key in \"messages.properties\" for the message that describes a tag in javadoc\n+     * requiring an empty line before it.\n+     */\n+    public static final String MSG_JAVADOC_TAG_LINE_BEFORE = \"javadoc.tag.line.before\";\n+\n+    /**\n+     * Case when space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   * &#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_1 = Arrays.asList(\n+            JavadocTokenTypes.WS,\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    /**\n+     * Case when no space separates the tag and the asterisk like in the below example.\n+     * <pre>\n+     *  /**\n+     *   *&#64;param noSpace there is no space here\n+     * </pre>\n+     */\n+    private static final List<Integer> ONLY_TAG_VARIATION_2 = Arrays.asList(\n+            JavadocTokenTypes.LEADING_ASTERISK,\n+            JavadocTokenTypes.NEWLINE);\n+\n+    @Override\n+    public int[] getDefaultJavadocTokens() {\n+        return new int[] {\n+            JavadocTokenTypes.JAVADOC_TAG,\n+        };\n+    }\n+\n+    @Override\n+    public int[] getRequiredJavadocTokens() {\n+        return getAcceptableJavadocTokens();\n+    }\n+\n+    /**\n+     * Logs when there is no empty line before the tag.\n+     *\n+     * @param tagNode the at tag node to check for an empty space before it.\n+     */\n+    @Override\n+    public void visitJavadocToken(DetailNode tagNode) {\n+        // No need to filter token because overridden getDefaultJavadocTokens ensures that we only\n+        // receive JAVADOC_TAG DetailNode.\n+        if (!isAnotherTagBefore(tagNode)\n+                && !isOnlyTagInWholeJavadoc(tagNode)\n+                && insufficientConsecutiveNewlines(tagNode)) {\n+            log(tagNode.getLineNumber(),\n+                    MSG_JAVADOC_TAG_LINE_BEFORE,\n+                    tagNode.getChildren()[0].getText());\n+        }\n+    }\n+\n+    private static boolean isAnotherTagBefore(DetailNode tagNode) {", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkwNTY1OA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471905658", "bodyText": "It is strange that our Checkstyle config is not barking on this.\nI am not a fan of javadoc on non public methods, but our codebase is crazy at on this point.\nI see that we do \n  \n    \n      checkstyle/src/main/java/com/puppycrawl/tools/checkstyle/checks/naming/AbbreviationAsWordInNameCheck.java\n    \n    \n         Line 526\n      in\n      57605ac\n    \n    \n    \n    \n\n        \n          \n           private static boolean isInterfaceDeclaration(DetailAST variableDefAst) { \n        \n    \n  \n\n on private methods.\nLet's do doc here too", "author": "romani", "createdAt": "2020-08-18T04:24:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDM0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjEyMDAyMw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r472120023", "bodyText": "I started an issue as this is why I pointed it out, all methods should have a javadoc.", "author": "rnveach", "createdAt": "2020-08-18T11:53:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDM0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDg1Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160857", "bodyText": "done.", "author": "josephmate", "createdAt": "2020-08-23T02:32:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDM0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDg4Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471834886", "bodyText": "Add example where previous line is empty, but it also has no *.", "author": "rnveach", "createdAt": "2020-08-17T23:48:46Z", "path": "src/test/resources/com/puppycrawl/tools/checkstyle/checks/javadoc/requireemptylinebeforeblocktagsgroup/InputRequireEmptyLineBeforeBlockTagsGroupCorrect.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package com.puppycrawl.tools.checkstyle.checks.javadoc.requireemptylinebeforeblocktagsgroup;\n+\n+/**\n+ * Config: default\n+ * Some Javadoc.\n+ *\n+ * @since 8.35 // ok\n+ */\n+class InputRequireEmptyLineBeforeBlockTagsGroupCorrect {\n+\n+    /**\n+     * This javadoc does not have a tag. There should be no violations.\n+     */\n+    public static final byte NO_TAG = 0;\n+\n+    /**\n+     * This javadoc does has one tag, with an empty line. There should be no violations.\n+     *\n+     * @since 8.0 // ok\n+     */\n+    public static final byte ONE_TAG = 0;\n+\n+    /**\n+     * This javadoc has multiple tags, with an empty line before the. There should be no\n+     * violations.\n+     *\n+     * @param input this is the first tag. // ok", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDg2Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160862", "bodyText": "done.", "author": "josephmate", "createdAt": "2020-08-23T02:32:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNDg4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNTc0Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471835743", "bodyText": "Show some form of example that has 2 blank lines.", "author": "rnveach", "createdAt": "2020-08-17T23:51:39Z", "path": "src/test/resources/com/puppycrawl/tools/checkstyle/checks/javadoc/requireemptylinebeforeblocktagsgroup/InputRequireEmptyLineBeforeBlockTagsGroupCorrect.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package com.puppycrawl.tools.checkstyle.checks.javadoc.requireemptylinebeforeblocktagsgroup;\n+\n+/**\n+ * Config: default\n+ * Some Javadoc.\n+ *\n+ * @since 8.35 // ok\n+ */\n+class InputRequireEmptyLineBeforeBlockTagsGroupCorrect {\n+\n+    /**\n+     * This javadoc does not have a tag. There should be no violations.\n+     */\n+    public static final byte NO_TAG = 0;\n+\n+    /**\n+     * This javadoc does has one tag, with an empty line. There should be no violations.\n+     *\n+     * @since 8.0 // ok", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDkwMg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160902", "bodyText": "done.", "author": "josephmate", "createdAt": "2020-08-23T02:32:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNTc0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNjA4Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471836086", "bodyText": "tag block => block tag.", "author": "rnveach", "createdAt": "2020-08-17T23:52:58Z", "path": "src/xdocs/config_javadoc.xml", "diffHunk": "@@ -2922,6 +2921,128 @@ class DatabaseConfiguration {}\n       </subsection>\n     </section>\n \n+    <section name=\"RequireEmptyLineBeforeBlockTagsGroup\">\n+      <p>Since Checkstyle 8.36</p>\n+      <subsection name=\"Description\" id=\"RequireEmptyLineBeforeBlockTagsGroup_Description\">\n+        <p>\n+          Checks that one blank line before the tag block if it is present in Javadoc.", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDkwNw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160907", "bodyText": "I case insensitive searched for tag block and replaced with block tag.", "author": "josephmate", "createdAt": "2020-08-23T02:32:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNjA4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNjEyMw==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471836123", "bodyText": "Same.", "author": "rnveach", "createdAt": "2020-08-17T23:53:08Z", "path": "src/xdocs/checks.xml", "diffHunk": "@@ -816,6 +816,13 @@\n               Checks that a Javadoc block can fit in a single line and doesn't contain\n               at-clauses.</td>\n           </tr>\n+          <tr>\n+            <td><a href=\"config_javadoc.html#RequireEmptyLineBeforeBlockTagsGroup\">\n+              RequireEmptyLineBeforeBlockTagsGroup</a></td>\n+            <td>\n+              Checks that one blank line before the tag block if it is present in Javadoc.", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDkxMA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160910", "bodyText": "I case insensitive searched for tag block and replaced with block tag.", "author": "josephmate", "createdAt": "2020-08-23T02:33:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNjEyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNjIwNg==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r471836206", "bodyText": "Missing the 6.", "author": "rnveach", "createdAt": "2020-08-17T23:53:28Z", "path": "src/xdocs/config_javadoc.xml", "diffHunk": "@@ -2922,6 +2921,128 @@ class DatabaseConfiguration {}\n       </subsection>\n     </section>\n \n+    <section name=\"RequireEmptyLineBeforeBlockTagsGroup\">\n+      <p>Since Checkstyle 8.36</p>\n+      <subsection name=\"Description\" id=\"RequireEmptyLineBeforeBlockTagsGroup_Description\">\n+        <p>\n+          Checks that one blank line before the tag block if it is present in Javadoc.\n+        </p>\n+      </subsection>\n+      <subsection name=\"Properties\" id=\"RequireEmptyLineBeforeBlockTagsGroup_Properties\">\n+        <div class=\"wrapper\">\n+          <table>\n+            <tr>\n+              <th>name</th>\n+              <th>description</th>\n+              <th>type</th>\n+              <th>default value</th>\n+              <th>since</th>\n+            </tr>\n+            <tr>\n+              <td>violateExecutionOnNonTightHtml</td>\n+              <td>\n+                Control when to print violations if the Javadoc being examined by this check\n+                violates the tight html rules defined at\n+                <a href=\"writingjavadocchecks.html#Tight-HTML_rules\">Tight-HTML Rules</a>.\n+              </td>\n+              <td><a href=\"property_types.html#boolean\">boolean</a></td>\n+              <td><code>false</code></td>\n+              <td>8.3</td>", "originalCommit": "8b1379921be33ba135fa5ac9299174e426854fc8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTE2MDkxNQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475160915", "bodyText": "done.\nHowever, This is an inherited field. All other checks that extend from AbstractJavadocCheck also have 8.3 for this field. I'm not sure which it should be.", "author": "josephmate", "createdAt": "2020-08-23T02:33:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNjIwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIzODY1OA==", "url": "https://github.com/checkstyle/checkstyle/pull/7932#discussion_r475238658", "bodyText": "The version is for when the property is introduced into the check. The check isn't being created until 8.36, so it makes no sense the property has a version before the field.\nThe reason why this is for the other checks is most likely because that is when the property in the AbstractJavadocCheck was added, hence adding it to all checks that inherited that class.", "author": "rnveach", "createdAt": "2020-08-23T16:29:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgzNjIwNg=="}], "type": "inlineReview"}, {"oid": "a7caeada2f5e8011cffcf277d934980370148a2b", "url": "https://github.com/checkstyle/checkstyle/commit/a7caeada2f5e8011cffcf277d934980370148a2b", "message": "Issue #6192: New module RequireEmptyLineBeforeBlockTagGroup to ensure there is an empty line before javadoc tag like @param", "committedDate": "2020-08-23T14:31:35Z", "type": "commit"}]}