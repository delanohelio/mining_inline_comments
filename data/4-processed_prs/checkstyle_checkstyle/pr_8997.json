{"pr_number": 8997, "pr_title": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "pr_createdAt": "2020-11-19T18:18:19Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8997", "timeline": [{"oid": "6a9e35c50dc651cab1a5e0d621b455a6d1ab1264", "url": "https://github.com/checkstyle/checkstyle/commit/6a9e35c50dc651cab1a5e0d621b455a6d1ab1264", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2020-11-23T04:57:19Z", "type": "forcePushed"}, {"oid": "762e792b96b9188b8a5eeed27a5a6ebfdbb8ae64", "url": "https://github.com/checkstyle/checkstyle/commit/762e792b96b9188b8a5eeed27a5a6ebfdbb8ae64", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2020-11-25T04:54:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDQ0MDU2Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8997#discussion_r530440566", "bodyText": "please add file with invalid Array indentation, you can quickly get different types of arrays in your regression report.", "author": "romani", "createdAt": "2020-11-25T15:04:36Z", "path": "src/test/resources/com/puppycrawl/tools/checkstyle/checks/indentation/indentation/InputIndentationValidArrayInitIndentTwo.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/* Config:                                                                  //indent:0 exp:0", "originalCommit": "762e792b96b9188b8a5eeed27a5a6ebfdbb8ae64", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTcyNzM2OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8997#discussion_r531727368", "bodyText": "@romani Done.", "author": "Abhishek-kumar09", "createdAt": "2020-11-27T18:32:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDQ0MDU2Ng=="}], "type": "inlineReview"}, {"oid": "30b8a1c53d80b34efb531137725af45ec695ecac", "url": "https://github.com/checkstyle/checkstyle/commit/30b8a1c53d80b34efb531137725af45ec695ecac", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2020-11-27T18:30:39Z", "type": "forcePushed"}, {"oid": "b4ab0ff6a853e1498e61e26f50fc402736e905a2", "url": "https://github.com/checkstyle/checkstyle/commit/b4ab0ff6a853e1498e61e26f50fc402736e905a2", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2020-11-30T07:07:04Z", "type": "forcePushed"}, {"oid": "a9c96c11cd6d2e28e7d8bd47eee4d824ef3388a1", "url": "https://github.com/checkstyle/checkstyle/commit/a9c96c11cd6d2e28e7d8bd47eee4d824ef3388a1", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2020-12-02T19:18:24Z", "type": "forcePushed"}, {"oid": "39516bb0df6d7c9ea71b0662615d67b43637b05a", "url": "https://github.com/checkstyle/checkstyle/commit/39516bb0df6d7c9ea71b0662615d67b43637b05a", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2020-12-21T18:24:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg4ODQ1Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8997#discussion_r546888453", "bodyText": "curlyIndent is returning the expected indentation for the left and right curlies.\nIf the parent of ARRAY_INIT isn't an ARRAY_INIT (which is almost a non-brace), then how can we use brace adjustment here which is only to be used for braces. Shouldn't basicOffset or lineWrappingIndentation be used here instead?", "author": "rnveach", "createdAt": "2020-12-21T19:27:21Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/indentation/ArrayInitHandler.java", "diffHunk": "@@ -74,7 +75,16 @@ protected DetailAST getLeftCurly() {\n \n     @Override\n     protected IndentLevel curlyIndent() {\n-        final IndentLevel level = new IndentLevel(getIndent(), getBraceAdjustment());\n+        int offset = 0;\n+\n+        final DetailAST lcurly = getLeftCurly();\n+\n+        if (isOnStartOfLine(lcurly)\n+            && !TokenUtil.isOfType(lcurly.getParent(), TokenTypes.ARRAY_INIT)) {\n+            offset = getBraceAdjustment();", "originalCommit": "39516bb0df6d7c9ea71b0662615d67b43637b05a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzUyMzAxNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8997#discussion_r547523017", "bodyText": "@rnveach, sorry for late reply, I got disconnected with my own code.\nIt is for the case when lcurly is on new line, then curlies should be indented on braceAdjustment value ahead of the base.\nIt is for old style java codes.\nclass A \n  { // braceAdj\n      void main() {} // braceAdj + basicOffset\n  }  \n\nclass A {\n    void main() {} //  basicOffset\n}  \n\ndoc:", "author": "Abhishek-kumar09", "createdAt": "2020-12-22T21:48:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg4ODQ1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg4OTA0Nw==", "url": "https://github.com/checkstyle/checkstyle/pull/8997#discussion_r546889047", "bodyText": "If you are just comparing one type, then why don't you just use an equal sign? I am not seeing a need to use the util method here.", "author": "rnveach", "createdAt": "2020-12-21T19:28:48Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/indentation/ArrayInitHandler.java", "diffHunk": "@@ -74,7 +75,16 @@ protected DetailAST getLeftCurly() {\n \n     @Override\n     protected IndentLevel curlyIndent() {\n-        final IndentLevel level = new IndentLevel(getIndent(), getBraceAdjustment());\n+        int offset = 0;\n+\n+        final DetailAST lcurly = getLeftCurly();\n+\n+        if (isOnStartOfLine(lcurly)\n+            && !TokenUtil.isOfType(lcurly.getParent(), TokenTypes.ARRAY_INIT)) {", "originalCommit": "39516bb0df6d7c9ea71b0662615d67b43637b05a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjkwNDUxNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8997#discussion_r546904516", "bodyText": "Corrected", "author": "Abhishek-kumar09", "createdAt": "2020-12-21T20:03:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg4OTA0Nw=="}], "type": "inlineReview"}, {"oid": "1f4dff3bc54e6b6d315c85cd69ede7b4e6c9942e", "url": "https://github.com/checkstyle/checkstyle/commit/1f4dff3bc54e6b6d315c85cd69ede7b4e6c9942e", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2020-12-21T20:02:47Z", "type": "forcePushed"}, {"oid": "6f3605601223413ab6983e249451ffd026944bf2", "url": "https://github.com/checkstyle/checkstyle/commit/6f3605601223413ab6983e249451ffd026944bf2", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2021-01-18T23:52:10Z", "type": "commit"}, {"oid": "6f3605601223413ab6983e249451ffd026944bf2", "url": "https://github.com/checkstyle/checkstyle/commit/6f3605601223413ab6983e249451ffd026944bf2", "message": "Issue #8979: fix for 'array initialization rcurly' has incorrect indentation", "committedDate": "2021-01-18T23:52:10Z", "type": "forcePushed"}]}