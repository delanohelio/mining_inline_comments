{"pr_number": 1011, "pr_title": "Resolves #1010: Bitmap value indexes", "pr_createdAt": "2020-08-11T23:58:27Z", "pr_url": "https://github.com/FoundationDB/fdb-record-layer/pull/1011", "timeline": [{"oid": "70d572ae5629777a358749892624a553d1d9a034", "url": "https://github.com/FoundationDB/fdb-record-layer/commit/70d572ae5629777a358749892624a553d1d9a034", "message": "Move tests for specific indexes into the appropriate child package.", "committedDate": "2020-08-11T21:36:32Z", "type": "commit"}, {"oid": "96351ec18617ded3f954b6505c6cd2fae91a3053", "url": "https://github.com/FoundationDB/fdb-record-layer/commit/96351ec18617ded3f954b6505c6cd2fae91a3053", "message": "Resolves #1010: Bitmap value indexes", "committedDate": "2020-08-11T23:57:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQwMjM2OA==", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/1011#discussion_r469402368", "bodyText": "I suppose there should probably be a test here that checks the behavior on uniqueness violations (making sure there's an error if the unique flag is true and possibly a test for if the unique flag is false that it mishandles duplicates the way we expect)", "author": "alecgrieser", "createdAt": "2020-08-12T16:53:12Z", "path": "fdb-record-layer-core/src/test/java/com/apple/foundationdb/record/provider/foundationdb/indexes/BitmapValueIndexTest.java", "diffHunk": "@@ -0,0 +1,190 @@\n+/*\n+ * BitmapValueIndexTest.java\n+ *\n+ * This source file is part of the FoundationDB open source project\n+ *\n+ * Copyright 2020 Apple Inc. and the FoundationDB project authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.apple.foundationdb.record.provider.foundationdb.indexes;\n+\n+import com.apple.foundationdb.record.FunctionNames;\n+import com.apple.foundationdb.record.IndexEntry;\n+import com.apple.foundationdb.record.IndexScanType;\n+import com.apple.foundationdb.record.IsolationLevel;\n+import com.apple.foundationdb.record.RecordCursor;\n+import com.apple.foundationdb.record.ScanProperties;\n+import com.apple.foundationdb.record.TestRecords1Proto;\n+import com.apple.foundationdb.record.TupleRange;\n+import com.apple.foundationdb.record.metadata.Index;\n+import com.apple.foundationdb.record.metadata.IndexAggregateFunction;\n+import com.apple.foundationdb.record.metadata.IndexOptions;\n+import com.apple.foundationdb.record.metadata.IndexTypes;\n+import com.apple.foundationdb.record.metadata.expressions.KeyExpression;\n+import com.apple.foundationdb.record.provider.foundationdb.FDBRecordContext;\n+import com.apple.foundationdb.record.provider.foundationdb.FDBRecordStoreTestBase;\n+import com.apple.foundationdb.tuple.Tuple;\n+import com.apple.test.Tags;\n+import org.junit.jupiter.api.Tag;\n+import org.junit.jupiter.api.Test;\n+\n+import javax.annotation.Nonnull;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.stream.Collectors;\n+import java.util.stream.IntStream;\n+\n+import static com.apple.foundationdb.record.metadata.Key.Expressions.concatenateFields;\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.equalTo;\n+\n+/**\n+ * Tests for {@code BITMAP_VALUE} type indexes.\n+ */\n+@Tag(Tags.RequiresFDB)\n+public class BitmapValueIndexTest extends FDBRecordStoreTestBase {", "originalCommit": "96351ec18617ded3f954b6505c6cd2fae91a3053", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQxODk5OA==", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/1011#discussion_r469418998", "bodyText": "Added two new uniqueness tests.", "author": "MMcM", "createdAt": "2020-08-12T17:20:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQwMjM2OA=="}], "type": "inlineReview"}, {"oid": "a331b826df417f442e5cc5fdfeeb1c20649eedfa", "url": "https://github.com/FoundationDB/fdb-record-layer/commit/a331b826df417f442e5cc5fdfeeb1c20649eedfa", "message": "Uniqueness tests", "committedDate": "2020-08-12T17:20:11Z", "type": "commit"}]}