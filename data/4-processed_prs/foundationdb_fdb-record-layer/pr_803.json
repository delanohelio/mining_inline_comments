{"pr_number": 803, "pr_title": "Resolves #801: Support for aggregate event metrics", "pr_createdAt": "2020-01-19T13:38:25Z", "pr_url": "https://github.com/FoundationDB/fdb-record-layer/pull/803", "timeline": [{"oid": "fe33ba3faa1d6bc6d6fbd133b6894200b2399019", "url": "https://github.com/FoundationDB/fdb-record-layer/commit/fe33ba3faa1d6bc6d6fbd133b6894200b2399019", "message": "Resolves #801: Support for aggregate event metrics", "committedDate": "2020-01-22T14:55:18Z", "type": "forcePushed"}, {"oid": "e630d0e4af23f8eb5f4faae4d5188885fcda346c", "url": "https://github.com/FoundationDB/fdb-record-layer/commit/e630d0e4af23f8eb5f4faae4d5188885fcda346c", "message": "Resolves #801: Support for aggregate event metrics", "committedDate": "2020-02-12T11:57:40Z", "type": "commit"}, {"oid": "9599fe40d36528bc622e55ea5ba7ecaed5506daf", "url": "https://github.com/FoundationDB/fdb-record-layer/commit/9599fe40d36528bc622e55ea5ba7ecaed5506daf", "message": "Make PMD checks happy", "committedDate": "2020-02-12T11:57:40Z", "type": "commit"}, {"oid": "9599fe40d36528bc622e55ea5ba7ecaed5506daf", "url": "https://github.com/FoundationDB/fdb-record-layer/commit/9599fe40d36528bc622e55ea5ba7ecaed5506daf", "message": "Make PMD checks happy", "committedDate": "2020-02-12T11:57:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkxNzE2MQ==", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/803#discussion_r378917161", "bodyText": "The aggregated time value for some of these will double count things that run in parallel or nested within one another. I'm not sure how easy it is to avoid being thrown off by that.", "author": "MMcM", "createdAt": "2020-02-13T15:04:46Z", "path": "fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBStoreTimer.java", "diffHunk": "@@ -224,6 +238,76 @@ public String logKey() {\n         }\n     }\n \n+    /**\n+     * An aggregate over other count events.\n+     */\n+    public enum EventAggregates implements Aggregate, Event {\n+        COMMITS(\"commits\",\n+                Events.COMMIT,\n+                Events.COMMIT_FAILURE),\n+        READS(\"reads\",\n+                Events.LOAD_META_DATA,\n+                Events.LOAD_RECORD_STORE_STATE,\n+                Events.LOAD_RECORD_STORE_INFO,\n+                Events.LOAD_RECORD_STORE_INDEX_META_DATA,\n+                Events.LOAD_RECORD,\n+                Events.SCAN_RECORDS,\n+                Events.SCAN_INDEX_KEYS,\n+                Events.DIRECTORY_READ,\n+                Events.SCOPED_DIRECTORY_LAYER_READ,\n+                Events.EXTENDED_DIRECTORY_LAYER_READ,\n+                Events.INTERNING_LAYER_READ,\n+                Events.LOAD_BOUNDARY_KEYS,\n+                Events.READ_SAMPLE_KEY),\n+        WRITES(\"writes\",\n+                Events.SAVE_META_DATA,\n+                Events.LOAD_RECORD_STORE_INFO,\n+                Events.SAVE_RECORD,\n+                Events.SAVE_INDEX_ENTRY,", "originalCommit": "9599fe40d36528bc622e55ea5ba7ecaed5506daf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk2NDkzMA==", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/803#discussion_r378964930", "bodyText": "I have removed the READ/WRITE/DELETE aggregates since, I agree, they can be confusing.", "author": "scgray", "createdAt": "2020-02-13T16:16:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkxNzE2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTU2NzkxNg==", "url": "https://github.com/FoundationDB/fdb-record-layer/pull/803#discussion_r379567916", "bodyText": "Yeah, that may be simplest.", "author": "MMcM", "createdAt": "2020-02-14T18:00:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkxNzE2MQ=="}], "type": "inlineReview"}, {"oid": "ee817c302d9ad53c51ad902cd7869882234eb0c2", "url": "https://github.com/FoundationDB/fdb-record-layer/commit/ee817c302d9ad53c51ad902cd7869882234eb0c2", "message": "Remove confusing READ/WRITES/DELETES aggregates", "committedDate": "2020-02-13T16:15:29Z", "type": "commit"}]}