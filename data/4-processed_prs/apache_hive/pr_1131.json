{"pr_number": 1131, "pr_title": "HIVE-23706: Fix nulls first sorting behavior", "pr_createdAt": "2020-06-17T03:55:31Z", "pr_url": "https://github.com/apache/hive/pull/1131", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzOTU5OQ==", "url": "https://github.com/apache/hive/pull/1131#discussion_r441439599", "bodyText": "The result that I would expect is:\n2         B\n1         A\n2         A\nNULL  NULL\n2         NULL\n3         NULL", "author": "zabetak", "createdAt": "2020-06-17T10:16:35Z", "path": "ql/src/test/results/clientpositive/llap/order_null.q.out", "diffHunk": "@@ -116,12 +116,12 @@ POSTHOOK: query: SELECT x.* FROM src_null_n1 x ORDER BY b desc, a asc\n POSTHOOK: type: QUERY\n POSTHOOK: Input: default@src_null_n1\n #### A masked pattern was here ####\n-2\tB\n-1\tA\n-2\tA\n 2\tNULL\n 3\tNULL\n NULL\tNULL\n+2\tB\n+1\tA\n+2\tA", "originalCommit": "c3ad226faa6dc42d5542ec35fd48543356743a9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUwMzY5OA==", "url": "https://github.com/apache/hive/pull/1131#discussion_r441503698", "bodyText": "Not sure about how up-to-date that document is but as far as I know we want nulls last as the default for asc and nulls first for desc.\nIt can be controlled by the setting hive.default.nulls.last. Default value is true.\nI also run these queries with Postgres and got the same results as with this patch.", "author": "kasakrisz", "createdAt": "2020-06-17T12:23:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzOTU5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUwOTAyMQ==", "url": "https://github.com/apache/hive/pull/1131#discussion_r441509021", "bodyText": "OK, now I understand better, thanks for the clarification.\nThe hive.default.nulls.last is a bit confusing. From the name and description I get the impression that NULLS LAST is the default behavior for both ASC and DESC and apparently it is not the case either.\nYes the new results are in sync with Postgres since the latter uses the semantics that you mentioned. Note that this is not a rule from every DBMS.", "author": "zabetak", "createdAt": "2020-06-17T12:33:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzOTU5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUyMDU4Mg==", "url": "https://github.com/apache/hive/pull/1131#discussion_r441520582", "bodyText": "I agree that description is confusing I changed accordingly.", "author": "kasakrisz", "createdAt": "2020-06-17T12:52:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzOTU5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0MTQ4NQ==", "url": "https://github.com/apache/hive/pull/1131#discussion_r441441485", "bodyText": "I think that the old result was correct.", "author": "zabetak", "createdAt": "2020-06-17T10:20:01Z", "path": "ql/src/test/results/clientpositive/llap/order_null.q.out", "diffHunk": "@@ -187,9 +187,9 @@ POSTHOOK: type: QUERY\n POSTHOOK: Input: default@src_null_n1\n #### A masked pattern was here ####\n 1\tA\n+2\tNULL\n 2\tB\n 2\tA\n-2\tNULL\n 3\tNULL\n NULL\tNULL", "originalCommit": "c3ad226faa6dc42d5542ec35fd48543356743a9a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0NTU2Mw==", "url": "https://github.com/apache/hive/pull/1131#discussion_r441445563", "bodyText": "I think that the old result was correct.", "author": "zabetak", "createdAt": "2020-06-17T10:27:41Z", "path": "ql/src/test/results/clientpositive/llap/order_null.q.out", "diffHunk": "@@ -88,12 +88,12 @@ POSTHOOK: query: SELECT x.* FROM src_null_n1 x ORDER BY a desc\n POSTHOOK: type: QUERY\n POSTHOOK: Input: default@src_null_n1\n #### A masked pattern was here ####\n+NULL\tNULL\n 3\tNULL\n 2\tNULL\n 2\tA\n 2\tB\n 1\tA\n-NULL\tNULL", "originalCommit": "c3ad226faa6dc42d5542ec35fd48543356743a9a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e5d287a4c84862c0babc2a37ab4d3c115bab68f5", "url": "https://github.com/apache/hive/commit/e5d287a4c84862c0babc2a37ab4d3c115bab68f5", "message": "HIVE-23706: Fix nulls first sorting behavior - update q tests", "committedDate": "2020-06-17T12:47:59Z", "type": "forcePushed"}, {"oid": "17799f576f5babac0f517d4dddc511b53def99a5", "url": "https://github.com/apache/hive/commit/17799f576f5babac0f517d4dddc511b53def99a5", "message": "HIVE-23706: Fix nulls first sorting behavior", "committedDate": "2020-06-22T04:45:05Z", "type": "commit"}, {"oid": "437159cc84929682c4e6ab53069120e3fdf0f838", "url": "https://github.com/apache/hive/commit/437159cc84929682c4e6ab53069120e3fdf0f838", "message": "HIVE-23706: Fix nulls first sorting behavior - update q tests", "committedDate": "2020-06-22T04:45:05Z", "type": "commit"}, {"oid": "5ce1fc381ae91fcbbfe084677a2efb898dfd2a3e", "url": "https://github.com/apache/hive/commit/5ce1fc381ae91fcbbfe084677a2efb898dfd2a3e", "message": "HIVE-23706: Fix nulls first sorting behavior - change description of hive.default.nulls.last", "committedDate": "2020-06-22T04:45:05Z", "type": "commit"}, {"oid": "4e599376b22440a76500ac2e8c6a72e1456ff559", "url": "https://github.com/apache/hive/commit/4e599376b22440a76500ac2e8c6a72e1456ff559", "message": "HIVE-23706: Fix nulls first sorting behavior - update q tests", "committedDate": "2020-06-22T06:08:23Z", "type": "commit"}, {"oid": "4e599376b22440a76500ac2e8c6a72e1456ff559", "url": "https://github.com/apache/hive/commit/4e599376b22440a76500ac2e8c6a72e1456ff559", "message": "HIVE-23706: Fix nulls first sorting behavior - update q tests", "committedDate": "2020-06-22T06:08:23Z", "type": "forcePushed"}]}