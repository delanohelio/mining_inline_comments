{"pr_number": 1258, "pr_title": "HIVE-23857: Fix HiveParser 'code too large' problem (Miklos Gergely, reviewed by David Mollitor)", "pr_createdAt": "2020-07-15T16:58:28Z", "pr_url": "https://github.com/apache/hive/pull/1258", "timeline": [{"oid": "4a63015cef2ade3318b08ae2675702b74cd58ab5", "url": "https://github.com/apache/hive/commit/4a63015cef2ade3318b08ae2675702b74cd58ab5", "message": "HIVE-23857: Fix HiveParser 'code too large' problem (Miklos Gergely, reviewed by David Mollitor)", "committedDate": "2020-07-15T19:22:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMwMjM1Mg==", "url": "https://github.com/apache/hive/pull/1258#discussion_r455302352", "bodyText": "Looks like AWK reinvented in bash", "author": "t3rmin4t0r", "createdAt": "2020-07-15T19:50:34Z", "path": "parser/bin/fixHiveParser.sh", "diffHunk": "@@ -0,0 +1,44 @@\n+#!/bin/bash\n+\n+# This is a temporary solution for the issue of the \"code too large\" problem related to HiveParser.java\n+# We got to a point where adding anything to the antlr files lead to an issue about having a HiveParser.java that can not be compiled due to the compiled code size limitation in java (maximum 65536 bytes), so to avoid it we temorarly add this script to remove the huge tokenNames array into a separate file.\n+# The real solution would be to switch to antlr 4\n+\n+tokenFile=\"target/generated-sources/antlr3/org/apache/hadoop/hive/ql/parse/HiveParserTokens.java\"\n+input=\"target/generated-sources/antlr3/org/apache/hadoop/hive/ql/parse/HiveParser.java\"\n+output=\"target/generated-sources/antlr3/org/apache/hadoop/hive/ql/parse/HiveParser.java-fixed\"\n+\n+rm $tokenFile > /dev/null 2>&1\n+rm $output > /dev/null 2>&1\n+\n+echo \"package org.apache.hadoop.hive.ql.parse;\" >> $tokenFile\n+echo \"\" >> $tokenFile\n+echo \"public class HiveParserTokens {\" >> $tokenFile\n+\n+state=\"STAY\"\n+while IFS= read -r line", "originalCommit": "4a63015cef2ade3318b08ae2675702b74cd58ab5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTM1MjczOQ==", "url": "https://github.com/apache/hive/pull/1258#discussion_r455352739", "bodyText": "Thank you @t3rmin4t0r, I've modified the patch using awk.", "author": "miklosgergely", "createdAt": "2020-07-15T21:14:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTMwMjM1Mg=="}], "type": "inlineReview"}, {"oid": "5598f2de566c5217c53c20ba2b4309b3c14d1fd1", "url": "https://github.com/apache/hive/commit/5598f2de566c5217c53c20ba2b4309b3c14d1fd1", "message": "HIVE-23857: Fix HiveParser 'code too large' problem (Miklos Gergely, reviewed by David Mollitor)", "committedDate": "2020-07-15T21:13:09Z", "type": "commit"}, {"oid": "5598f2de566c5217c53c20ba2b4309b3c14d1fd1", "url": "https://github.com/apache/hive/commit/5598f2de566c5217c53c20ba2b4309b3c14d1fd1", "message": "HIVE-23857: Fix HiveParser 'code too large' problem (Miklos Gergely, reviewed by David Mollitor)", "committedDate": "2020-07-15T21:13:09Z", "type": "forcePushed"}]}