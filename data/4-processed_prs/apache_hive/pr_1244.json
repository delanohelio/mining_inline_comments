{"pr_number": 1244, "pr_title": "HIVE-23837: Configure StorageHandlers if FileSinkOperator is child of MergeJoinWork", "pr_createdAt": "2020-07-13T11:38:56Z", "pr_url": "https://github.com/apache/hive/pull/1244", "timeline": [{"oid": "5956a686b00f046c2d26665f22620b18ce22398b", "url": "https://github.com/apache/hive/commit/5956a686b00f046c2d26665f22620b18ce22398b", "message": "HIVE-23837: Configure StorageHandlers if FileSinkOperator is child of MergeJoinWork", "committedDate": "2020-07-13T11:37:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcwNTQxMw==", "url": "https://github.com/apache/hive/pull/1244#discussion_r455705413", "bodyText": "could we use forEach here?", "author": "deniskuzZ", "createdAt": "2020-07-16T11:04:33Z", "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {", "originalCommit": "5956a686b00f046c2d26665f22620b18ce22398b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcwNTY2Ng==", "url": "https://github.com/apache/hive/pull/1244#discussion_r455705666", "bodyText": "same", "author": "deniskuzZ", "createdAt": "2020-07-16T11:05:05Z", "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {\n+      for (FileSinkOperator fs : OperatorUtils.findOperators(rootOp, FileSinkOperator.class)) {", "originalCommit": "5956a686b00f046c2d26665f22620b18ce22398b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcxMTYyNQ==", "url": "https://github.com/apache/hive/pull/1244#discussion_r455711625", "bodyText": "I think, it can be extracted to base. In MapWork and ReduceWork , for example, you can do same, at least for FileSinkOperator - iterate over getAllRootOperators() and call configureJobConf", "author": "deniskuzZ", "createdAt": "2020-07-16T11:17:33Z", "path": "ql/src/java/org/apache/hadoop/hive/ql/plan/MergeJoinWork.java", "diffHunk": "@@ -66,6 +67,13 @@ public void replaceRoots(Map<Operator<?>, Operator<?>> replacementMap) {\n \n   @Override\n   public void configureJobConf(JobConf job) {\n+    for(Operator rootOp : getAllRootOperators()) {", "originalCommit": "5956a686b00f046c2d26665f22620b18ce22398b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTczMDg1NA==", "url": "https://github.com/apache/hive/pull/1244#discussion_r455730854", "bodyText": "Done", "author": "pvargacl", "createdAt": "2020-07-16T11:55:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcxMTYyNQ=="}], "type": "inlineReview"}, {"oid": "f65401e1e45fa18b5a51e77a24b0441bdd769e97", "url": "https://github.com/apache/hive/commit/f65401e1e45fa18b5a51e77a24b0441bdd769e97", "message": "Extract confJobConf to BaseWork", "committedDate": "2020-07-16T11:48:20Z", "type": "commit"}]}