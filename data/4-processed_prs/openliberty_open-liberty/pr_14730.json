{"pr_number": 14730, "pr_title": "Add mpCompatible-x.x private features", "pr_createdAt": "2020-10-28T14:47:59Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/14730", "timeline": [{"oid": "6c628f510659a76193ba476660bfa0335b88cdec", "url": "https://github.com/OpenLiberty/open-liberty/commit/6c628f510659a76193ba476660bfa0335b88cdec", "message": "MP Compatible 4.0\n\nMP Compatible 1.0 (anything earlier than 4.0)", "committedDate": "2020-10-29T12:27:04Z", "type": "forcePushed"}, {"oid": "5075910c35a2265684d2a702c43aa2097096c527", "url": "https://github.com/OpenLiberty/open-liberty/commit/5075910c35a2265684d2a702c43aa2097096c527", "message": "MP Compatible 4.0\n\nMP Compatible 1.0 (anything earlier than 4.0)", "committedDate": "2020-10-29T12:28:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NDQ2Mw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514244463", "bodyText": "suggest to use mpComptible-pre4", "author": "Emily-Jiang", "createdAt": "2020-10-29T13:09:00Z", "path": "dev/com.ibm.websphere.appserver.features/visibility/private/io.openliberty.mpCompatible-1.0.feature", "diffHunk": "@@ -0,0 +1,8 @@\n+-include= ~${workspace}/cnf/resources/bnd/feature.props\n+symbolicName=io.openliberty.mpCompatible-1.0", "originalCommit": "5075910c35a2265684d2a702c43aa2097096c527", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI3NDg5Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514274892", "bodyText": "I think it has to be a number at the end if we want anything to be able to tolerate both 4.0 and pre-4.0", "author": "Azquelt", "createdAt": "2020-10-29T13:52:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NDQ2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI3OTgxNw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514279817", "bodyText": "exactly, can't do the tolerates if it doesn't follow the normal format", "author": "tevans78", "createdAt": "2020-10-29T13:59:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NDQ2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM0OTk3NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514349975", "bodyText": "Might still be worth a comment in this file to say what depending on mpCompatible-1.0 means as it may confuse people.", "author": "Azquelt", "createdAt": "2020-10-29T15:28:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NDQ2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQyNDI1OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514424259", "bodyText": "Hopefully this is more obvious now that I have added 2.0 and 3.0", "author": "tevans78", "createdAt": "2020-10-29T17:06:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NDQ2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQxNTYzOA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r521415638", "bodyText": "I think it's more confusing to have mpCompatible-2.0 and 3.0. It's not like we have an mpCompatible feature for every MP version, and the mpCompatible-2.0 and 3.0 features don't actually do anything (everything that uses any of them tolerates the others too).\nI'd suggest putting a big comment on mpCompatible-1.0 saying that all MP features pre-3.3 should tolerate it. MP features for 4.0 or later should tolerate the relevant mpCompatible feature.", "author": "Azquelt", "createdAt": "2020-11-11T14:57:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NDQ2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA0MzMyNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r525043325", "bodyText": "we have decided to use mpCompatible-0.0", "author": "tevans78", "createdAt": "2020-11-17T10:24:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NDQ2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NTQzOA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514245438", "bodyText": "It is important to ensure LRA working with other MP features because this is the only one LRA feature. This is a good tolerance.", "author": "Emily-Jiang", "createdAt": "2020-10-29T13:10:26Z", "path": "dev/com.ibm.websphere.appserver.features/visibility/public/mpLRA-1.0/io.openliberty.mpLRA-1.0.feature", "diffHunk": "@@ -11,7 +11,8 @@ IBM-API-Package: \\\n   org.eclipse.microprofile.lra.annotation; type=\"stable\", \\\n   org.eclipse.microprofile.lra.annotation.ws.rs; type=\"stable\";\n -features=io.openliberty.org.eclipse.microprofile.lra-1.0, \\\n-          com.ibm.websphere.appserver.jaxrs-2.1\n+          com.ibm.websphere.appserver.jaxrs-2.1, \\\n+          io.openliberty.mpCompatible-1.0; ibm.tolerates:=4.0", "originalCommit": "5075910c35a2265684d2a702c43aa2097096c527", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0Nzk4NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514247984", "bodyText": "I thought this dependency was only added to RestClient 2.0", "author": "Emily-Jiang", "createdAt": "2020-10-29T13:14:29Z", "path": "dev/com.ibm.websphere.appserver.features/visibility/public/mpRestClient-1.1/com.ibm.websphere.appserver.mpRestClient-1.1.feature", "diffHunk": "@@ -18,7 +18,8 @@ Subsystem-Name: MicroProfile Rest Client 1.1\n  com.ibm.websphere.appserver.javax.annotation-1.2; ibm.tolerates:=1.3, \\\n  com.ibm.websphere.appserver.jaxrsClient-2.0; ibm.tolerates:=2.1, \\\n  com.ibm.websphere.appserver.jsonp-1.0; ibm.tolerates:=1.1, \\\n- com.ibm.websphere.appserver.org.reactivestreams.reactive-streams-1.0\n+ com.ibm.websphere.appserver.org.reactivestreams.reactive-streams-1.0, \\", "originalCommit": "5075910c35a2265684d2a702c43aa2097096c527", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI4MjcyMQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514282721", "bodyText": "Can't change it now, it's already GA.", "author": "tevans78", "createdAt": "2020-10-29T14:03:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0Nzk4NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0ODU0OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514248549", "bodyText": "we need to make this tolerate mpCompatible-4.0. Otherwise, MP Rest client 2.0 will not be able to work.", "author": "Emily-Jiang", "createdAt": "2020-10-29T13:15:21Z", "path": "dev/com.ibm.websphere.appserver.features/visibility/public/mpReactiveStreams-1.0/com.ibm.websphere.appserver.mpReactiveStreams-1.0.feature", "diffHunk": "@@ -14,7 +14,8 @@ IBM-API-Package: \\\n   org.reactivestreams; type=\"stable\";\n -features=\\\n   com.ibm.websphere.appserver.org.eclipse.microprofile.reactive.streams.operators-1.0, \\\n-  com.ibm.websphere.appserver.concurrent-1.0\n+  com.ibm.websphere.appserver.concurrent-1.0, \\\n+  io.openliberty.mpCompatible-1.0", "originalCommit": "5075910c35a2265684d2a702c43aa2097096c527", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQyNDU4MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r514424581", "bodyText": "done", "author": "tevans78", "createdAt": "2020-10-29T17:07:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0ODU0OQ=="}], "type": "inlineReview"}, {"oid": "008f7452a3c7c912c28d2a0fa79ec42b66ef822e", "url": "https://github.com/OpenLiberty/open-liberty/commit/008f7452a3c7c912c28d2a0fa79ec42b66ef822e", "message": "Add mpCompatible-2.0 and mpCompatible-3.0", "committedDate": "2020-10-29T16:56:14Z", "type": "forcePushed"}, {"oid": "220c79e829a4ce1e2c13212e0a60a12dfe47df26", "url": "https://github.com/OpenLiberty/open-liberty/commit/220c79e829a4ce1e2c13212e0a60a12dfe47df26", "message": "Add mpCompatible-2.0 and mpCompatible-3.0", "committedDate": "2020-10-29T17:04:32Z", "type": "forcePushed"}, {"oid": "9c173b5f4d88ed2b1c5a410049add8e302a13e1a", "url": "https://github.com/OpenLiberty/open-liberty/commit/9c173b5f4d88ed2b1c5a410049add8e302a13e1a", "message": "Add mpCompatible-2.0 and mpCompatible-3.0", "committedDate": "2020-11-02T14:57:17Z", "type": "forcePushed"}, {"oid": "87260cb7f3a2f9c223fee6c2dd245ccb9e98f6bb", "url": "https://github.com/OpenLiberty/open-liberty/commit/87260cb7f3a2f9c223fee6c2dd245ccb9e98f6bb", "message": "Add mpCompatible-2.0 and mpCompatible-3.0", "committedDate": "2020-11-03T12:35:17Z", "type": "forcePushed"}, {"oid": "87e2a4bb1fe8821390dad2d61a7c990c2620d419", "url": "https://github.com/OpenLiberty/open-liberty/commit/87e2a4bb1fe8821390dad2d61a7c990c2620d419", "message": "Add mpCompatible-2.0 and mpCompatible-3.0", "committedDate": "2020-11-04T17:24:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzk4NzQ5OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r517987498", "bodyText": "Since MP 1.x pulls in CDI 1.2. I think tolerating EE6 is not going to work and it is confusing.", "author": "Emily-Jiang", "createdAt": "2020-11-05T11:41:01Z", "path": "dev/com.ibm.websphere.appserver.features/visibility/private/io.openliberty.mpCompatible-1.0.feature", "diffHunk": "@@ -0,0 +1,10 @@\n+-include= ~${workspace}/cnf/resources/bnd/feature.props\n+symbolicName=io.openliberty.mpCompatible-1.0\n+visibility=private\n+singleton=true\n+Subsystem-Version: 1.0\n+-features=com.ibm.websphere.appserver.eeCompatible-7.0; ibm.tolerates:=\"6.0, 8.0\"", "originalCommit": "87e2a4bb1fe8821390dad2d61a7c990c2620d419", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODAwNDA1Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r518004052", "bodyText": "You are right that it is confusing but we did not enforce it before and we can't change that now. There are some combinations which do \"work\" together (start at the same time). e.g. If you only pull in mpConfig-1.1 and mpFaultTolerance-1.0 (but NOT cdi-1.2) then those should still work at the same time as (some) EE6 features because there is no actual clash.... even if it doesn't make sense!", "author": "tevans78", "createdAt": "2020-11-05T12:10:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzk4NzQ5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA3MzM5NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r518073395", "bodyText": "ok", "author": "Emily-Jiang", "createdAt": "2020-11-05T14:03:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzk4NzQ5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTA0NDEyOA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r525044128", "bodyText": "I had to remove the eeCompatible dependencies for now. Will try to add them back in a second PR.", "author": "tevans78", "createdAt": "2020-11-17T10:25:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzk4NzQ5OA=="}], "type": "inlineReview"}, {"oid": "935a05516aab7dcc40e3c87179a29b1faa615ac7", "url": "https://github.com/OpenLiberty/open-liberty/commit/935a05516aab7dcc40e3c87179a29b1faa615ac7", "message": "Pull in eeCompatible-6.0 by default, tolerate 7 and 8", "committedDate": "2020-11-09T19:02:13Z", "type": "forcePushed"}, {"oid": "bc12bdb7498cfb782543f6d9ed3e32188f95a679", "url": "https://github.com/OpenLiberty/open-liberty/commit/bc12bdb7498cfb782543f6d9ed3e32188f95a679", "message": "Pull in eeCompatible-6.0 by default, tolerate 7 and 8", "committedDate": "2020-11-09T19:06:14Z", "type": "forcePushed"}, {"oid": "a33e0ed46095a96393908c15af1ebf340b749924", "url": "https://github.com/OpenLiberty/open-liberty/commit/a33e0ed46095a96393908c15af1ebf340b749924", "message": "MP Compatible 1.0, 2.0, 3.0 and 4.0", "committedDate": "2020-11-10T18:31:51Z", "type": "forcePushed"}, {"oid": "dd25b18d488a20e962ee6bd36727745cf2ccf5b5", "url": "https://github.com/OpenLiberty/open-liberty/commit/dd25b18d488a20e962ee6bd36727745cf2ccf5b5", "message": "MP Compatible 1.0, 2.0, 3.0 and 4.0", "committedDate": "2020-11-10T18:37:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQyMjYyMQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r521422621", "bodyText": "How to track this so that we can enable this with future MP 5.0 changes? Should an issue be opened for this?", "author": "Emily-Jiang", "createdAt": "2020-11-11T15:07:11Z", "path": "dev/com.ibm.ws.concurrent.mp_fat/fat/src/com/ibm/ws/concurrent/mp/fat/FATSuite.java", "diffHunk": "@@ -19,8 +19,8 @@\n                 MPConcurrentTest.class,\n                 MPConcurrentConfigTest.class,\n                 MPConcurrentJAXRSTest.class,\n-                MPConcurrentTxTest.class,\n-                MPContextProp1_1_Test.class,\n+                //MPConcurrentTxTest.class, //Relies on Jakarta EE 9 but MicroProfile does not yet support EE9", "originalCommit": "dd25b18d488a20e962ee6bd36727745cf2ccf5b5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjEzMTczNA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14730#discussion_r522131734", "bodyText": "#14941", "author": "tevans78", "createdAt": "2020-11-12T14:08:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQyMjYyMQ=="}], "type": "inlineReview"}, {"oid": "fb7fb6bfebae103a54e8d15f946de82c39091a90", "url": "https://github.com/OpenLiberty/open-liberty/commit/fb7fb6bfebae103a54e8d15f946de82c39091a90", "message": "MP Compatible 0.0 and 4.0", "committedDate": "2020-11-12T11:43:09Z", "type": "commit"}, {"oid": "fb7fb6bfebae103a54e8d15f946de82c39091a90", "url": "https://github.com/OpenLiberty/open-liberty/commit/fb7fb6bfebae103a54e8d15f946de82c39091a90", "message": "MP Compatible 0.0 and 4.0", "committedDate": "2020-11-12T11:43:09Z", "type": "forcePushed"}]}