{"pr_number": 13484, "pr_title": "Update deployment descriptor for Servlet5", "pr_createdAt": "2020-08-13T15:09:12Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/13484", "timeline": [{"oid": "d4e4b2f3adeebb4c3f334bab45bfae9a3becf9a4", "url": "https://github.com/OpenLiberty/open-liberty/commit/d4e4b2f3adeebb4c3f334bab45bfae9a3becf9a4", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-13T15:20:40Z", "type": "forcePushed"}, {"oid": "e9c605d165fa9ccd0cd02273923478d50cfa7347", "url": "https://github.com/OpenLiberty/open-liberty/commit/e9c605d165fa9ccd0cd02273923478d50cfa7347", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-17T17:38:03Z", "type": "forcePushed"}, {"oid": "e04c30ad475d089d9408e2f6a6db3cf1dd894829", "url": "https://github.com/OpenLiberty/open-liberty/commit/e04c30ad475d089d9408e2f6a6db3cf1dd894829", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-17T17:42:31Z", "type": "forcePushed"}, {"oid": "82e9cf707050f7127a2043f33a0b41cbbe29d4ce", "url": "https://github.com/OpenLiberty/open-liberty/commit/82e9cf707050f7127a2043f33a0b41cbbe29d4ce", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-17T17:49:22Z", "type": "forcePushed"}, {"oid": "8013c9ca636ceb01e018385f55e96548a1c3a1d3", "url": "https://github.com/OpenLiberty/open-liberty/commit/8013c9ca636ceb01e018385f55e96548a1c3a1d3", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-17T17:55:57Z", "type": "forcePushed"}, {"oid": "07e75fce2c5883278108e5fcf1074ae4d476eefd", "url": "https://github.com/OpenLiberty/open-liberty/commit/07e75fce2c5883278108e5fcf1074ae4d476eefd", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-18T02:20:13Z", "type": "forcePushed"}, {"oid": "0989cd5d6a60ed42e35af0182717926bb4195c3e", "url": "https://github.com/OpenLiberty/open-liberty/commit/0989cd5d6a60ed42e35af0182717926bb4195c3e", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-18T14:36:52Z", "type": "forcePushed"}, {"oid": "e7d2d330a6ee7a2237fc0031d44512a0af9ad473", "url": "https://github.com/OpenLiberty/open-liberty/commit/e7d2d330a6ee7a2237fc0031d44512a0af9ad473", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-18T14:38:00Z", "type": "forcePushed"}, {"oid": "6c8af0631704b7c1524e31119aebae270708bc09", "url": "https://github.com/OpenLiberty/open-liberty/commit/6c8af0631704b7c1524e31119aebae270708bc09", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-18T16:06:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxNjk0OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13484#discussion_r472416949", "bodyText": "Do we really need all the trace specified here , same comment for the bootstrap?", "author": "pnicolucci", "createdAt": "2020-08-18T19:04:26Z", "path": "dev/com.ibm.ws.webcontainer.servlet.4.0_fat/publish/servers/servlet50_wcServer/server.xml", "diffHunk": "@@ -0,0 +1,15 @@\n+<server description=\"Server for testing Servlet 50 jakarta.servlet\">\n+\n+  <include location=\"../fatTestPorts.xml\"/>\n+\n+  <featureManager>\n+    <feature>servlet-5.0</feature>\n+  </featureManager>\n+\n+  <logging\n+    traceSpecification=\"*=info=enabled:com.ibm.ws.webcontainer*=all:com.ibm.wsspi.webcontainer*=all:HttpTransport=all:HTTPChannel=all:TCPChannel=all:GenericBNF=all:com.ibm.ws.jsp*=all:com.ibm.ws.session.*=all:com.ibm.ws.runtime.update.internal*=all:ChannelFramework=all\"\n+    maxFileSize=\"20\"\n+    maxFiles=\"10\"\n+    traceFormat=\"BASIC\"/>\n+", "originalCommit": "6c8af0631704b7c1524e31119aebae270708bc09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxODA4MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13484#discussion_r472418081", "bodyText": "Looks like we're missing a copyright statement.", "author": "pnicolucci", "createdAt": "2020-08-18T19:06:32Z", "path": "dev/com.ibm.ws.webcontainer.servlet.4.0_fat/test-applications/Servlet5TestApp.war/src/servlet5snoop/war/servlets/Snoop5Servlet.java", "diffHunk": "@@ -0,0 +1,298 @@\n+package servlet5snoop.war.servlets;", "originalCommit": "6c8af0631704b7c1524e31119aebae270708bc09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxOTcxNg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13484#discussion_r472419716", "bodyText": "Can you fix the space formatting here?", "author": "pnicolucci", "createdAt": "2020-08-18T19:09:44Z", "path": "dev/com.ibm.ws.webcontainer.servlet.4.0_fat/test-applications/Servlet5TestApp.war/resources/WEB-INF/web.xml", "diffHunk": "@@ -0,0 +1,18 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<web-app version=\"5.0\" xmlns=\"https://jakarta.ee/xml/ns/jakartaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd\">\n+  <display-name>Snoop Servlet 50</display-name>\n+  <description>This is the IBM WebSphere Application Sever Default Web Application Snoop using Servlet 50, since 2020</description>\n+  \n+  <servlet>\n+\t\t<display-name>Snoop Servlet</display-name>\n+\t\t<servlet-name>Snoop Servlet</servlet-name>\n+        <servlet-class>servlet5snoop.war.servlets.Snoop5Servlet</servlet-class>", "originalCommit": "6c8af0631704b7c1524e31119aebae270708bc09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyMDA0MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13484#discussion_r472420040", "bodyText": "What error is this and why are we expecting it? Can we add some comments so we know in the future?", "author": "pnicolucci", "createdAt": "2020-08-18T19:10:21Z", "path": "dev/com.ibm.ws.webcontainer.servlet.4.0_fat/fat/src/com/ibm/ws/fat/wc/tests/WC5JakartaServletTest.java", "diffHunk": "@@ -0,0 +1,87 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package com.ibm.ws.fat.wc.tests;\n+\n+import java.util.ArrayList;\n+import java.util.logging.Logger;\n+\n+import org.junit.AfterClass;\n+import org.junit.BeforeClass;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+import com.ibm.ws.fat.util.LoggingTest;\n+import com.ibm.ws.fat.util.SharedServer;\n+import com.ibm.ws.fat.wc.WCApplicationHelper;\n+\n+import componenttest.annotation.SkipForRepeat;\n+import componenttest.custom.junit.runner.FATRunner;\n+import componenttest.custom.junit.runner.Mode;\n+import componenttest.custom.junit.runner.Mode.TestMode;\n+\n+/**\n+ * Test Servlet 5 native jakarta.servlet (i.e not transformer)\n+ * Should only run in EE9.\n+ * The target app is servlet 5.0 version with new namespace.\n+ * Request to the simple snoop servlet 50 version which test several jakarta.servlet API (along with the new web-app web.xml namespace)\n+ */\n+@RunWith(FATRunner.class)\n+@Mode(TestMode.FULL)\n+@SkipForRepeat(SkipForRepeat.NO_MODIFICATION)\n+public class WC5JakartaServletTest extends LoggingTest {\n+\n+    private static final Logger LOG = Logger.getLogger(WC5JakartaServletTest.class.getName());\n+    private static final String APP_NAME = \"Servlet5TestApp\";\n+\n+    @ClassRule\n+    public static SharedServer SHARED_SERVER = new SharedServer(\"servlet50_wcServer\");\n+\n+    /*\n+     * (non-Javadoc)\n+     *\n+     * @see com.ibm.ws.fat.util.LoggingTest#getSharedServer()\n+     */\n+    @Override\n+    protected SharedServer getSharedServer() {\n+        return SHARED_SERVER;\n+    }\n+\n+    @BeforeClass\n+    public static void before() throws Exception {\n+        LOG.info(\"Setup : add \" + APP_NAME + \" war to the server if not already present.\");\n+\n+        WCApplicationHelper.addWarToServerDropins(SHARED_SERVER.getLibertyServer(), APP_NAME + \".war\", true, \"servlet5snoop.war.servlets\");\n+\n+        ArrayList<String> expectedErrors = new ArrayList<String>();\n+        expectedErrors.add(\"CWWWC0401E:.*\");\n+        SHARED_SERVER.getLibertyServer().addIgnoredErrors(expectedErrors);", "originalCommit": "6c8af0631704b7c1524e31119aebae270708bc09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQyMDU5NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13484#discussion_r472420595", "bodyText": "We should add this above the @server annotation comment since this uses the SHARED_SERVER", "author": "pnicolucci", "createdAt": "2020-08-18T19:11:21Z", "path": "dev/com.ibm.ws.webcontainer.servlet.4.0_fat/fat/src/com/ibm/ws/fat/wc/FATSuite.java", "diffHunk": "@@ -77,14 +78,14 @@\n                 WCApplicationMBeanStatusTest.class,\n                 // @Server Annotations\n                 WCServletContainerInitializerExceptionTest.class,\n-                WCSameSiteCookieAttributeTests.class\n+                WCSameSiteCookieAttributeTests.class,\n+                WC5JakartaServletTest.class", "originalCommit": "6c8af0631704b7c1524e31119aebae270708bc09", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0d4fec4d0ada03542b610de7da5fa57929cf9ada", "url": "https://github.com/OpenLiberty/open-liberty/commit/0d4fec4d0ada03542b610de7da5fa57929cf9ada", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-24T14:26:01Z", "type": "forcePushed"}, {"oid": "90e90758e0aa61c3910257afd8f10091e420e241", "url": "https://github.com/OpenLiberty/open-liberty/commit/90e90758e0aa61c3910257afd8f10091e420e241", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-24T14:49:39Z", "type": "forcePushed"}, {"oid": "e4d2a39dcb51064927e78c5c8846dd81d65da602", "url": "https://github.com/OpenLiberty/open-liberty/commit/e4d2a39dcb51064927e78c5c8846dd81d65da602", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-24T16:36:45Z", "type": "forcePushed"}, {"oid": "da9b2fe4351ff0713ec69b2383b68933807d7e27", "url": "https://github.com/OpenLiberty/open-liberty/commit/da9b2fe4351ff0713ec69b2383b68933807d7e27", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-25T13:53:59Z", "type": "commit"}, {"oid": "da9b2fe4351ff0713ec69b2383b68933807d7e27", "url": "https://github.com/OpenLiberty/open-liberty/commit/da9b2fe4351ff0713ec69b2383b68933807d7e27", "message": "Update deployment descriptor for Servlet5", "committedDate": "2020-08-25T13:53:59Z", "type": "forcePushed"}]}