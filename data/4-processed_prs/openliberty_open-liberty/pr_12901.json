{"pr_number": 12901, "pr_title": "Add new <kerberos> config element", "pr_createdAt": "2020-07-06T23:02:38Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/12901", "timeline": [{"oid": "92a93cbed86a8a3281578e23e832e3930a201224", "url": "https://github.com/OpenLiberty/open-liberty/commit/92a93cbed86a8a3281578e23e832e3930a201224", "message": "Introduce new <kerberos> configuration element for system-wide krb5 config", "committedDate": "2020-07-06T22:16:15Z", "type": "commit"}, {"oid": "0133066fd0b6c038d98648385c2b774a9e55447b", "url": "https://github.com/OpenLiberty/open-liberty/commit/0133066fd0b6c038d98648385c2b774a9e55447b", "message": "Update AuthData to use new <kerberos> config element", "committedDate": "2020-07-06T22:16:50Z", "type": "commit"}, {"oid": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "url": "https://github.com/OpenLiberty/open-liberty/commit/2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "message": "Update SPNEGO to use new <kerberos> config element", "committedDate": "2020-07-06T23:11:08Z", "type": "commit"}, {"oid": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "url": "https://github.com/OpenLiberty/open-liberty/commit/2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "message": "Update SPNEGO to use new <kerberos> config element", "committedDate": "2020-07-06T23:11:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU3NjY3NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450576674", "bodyText": "krb5Principal=Kerberos principal name", "author": "utle", "createdAt": "2020-07-07T02:25:45Z", "path": "dev/com.ibm.ws.security.auth.data.common/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -37,9 +37,3 @@ maxSize.desc=Maximum number of entries supported by the authentication data subj\n # Do not translate: Kerberos, principal\n krb5Principal=Kerberos service principal name", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU3NzIzMA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450577230", "bodyText": "krb5Principal.desc=The name of the Kerberos principal name or Kerberos service name to be used.", "author": "utle", "createdAt": "2020-07-07T02:28:15Z", "path": "dev/com.ibm.ws.security.auth.data.common/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -37,9 +37,3 @@ maxSize.desc=Maximum number of entries supported by the authentication data subj\n # Do not translate: Kerberos, principal\n krb5Principal=Kerberos service principal name\n krb5Principal.desc=The name of the principal to be used. The principal can be a simple username or a service name.", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4MDA0Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450580046", "bodyText": "Can we change from kerbKeytab to keytabPath?", "author": "utle", "createdAt": "2020-07-07T02:39:55Z", "path": "dev/com.ibm.ws.security.spnego/src/com/ibm/ws/security/spnego/internal/SpnegoConfigImpl.java", "diffHunk": "@@ -162,6 +168,12 @@ protected void processConfig(Map<String, Object> props) {\n      */\n     protected String processKrb5Keytab(Map<String, Object> props) {\n         String keytab = (String) props.get(KEY_KRB5_KEYTAB);\n+        Path kerbKeytab = kerbSvc.getKeytab(); // from the <kerberos> element", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4MTM0NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450581344", "bodyText": "We have variable name prefix with krb and kerb ; Can we use one?. I am ok with either one but like to see one prefix for Kerberos.", "author": "utle", "createdAt": "2020-07-07T02:45:17Z", "path": "dev/com.ibm.ws.security.spnego/src/com/ibm/ws/security/spnego/internal/SpnegoConfigImpl.java", "diffHunk": "@@ -180,6 +192,20 @@ protected String processKrb5Keytab(Map<String, Object> props) {\n      */\n     protected String processKrb5Config(Map<String, Object> props) {\n         String krbCf = (String) props.get(KEY_KRB5_CONFIG);\n+        Path kerbConfigFile = kerbSvc.getConfigFile(); // from the <kerberos> element", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4MTcxNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450581715", "bodyText": "how's about krbCf and krbCfPath?  or\nkerbCf and KerbCfPath?", "author": "utle", "createdAt": "2020-07-07T02:46:53Z", "path": "dev/com.ibm.ws.security.spnego/src/com/ibm/ws/security/spnego/internal/SpnegoConfigImpl.java", "diffHunk": "@@ -180,6 +192,20 @@ protected String processKrb5Keytab(Map<String, Object> props) {\n      */\n     protected String processKrb5Config(Map<String, Object> props) {\n         String krbCf = (String) props.get(KEY_KRB5_CONFIG);\n+        Path kerbConfigFile = kerbSvc.getConfigFile(); // from the <kerberos> element", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4MzgzNw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450583837", "bodyText": "Can we remove Kerberos from name and description?", "author": "utle", "createdAt": "2020-07-07T02:55:34Z", "path": "dev/com.ibm.ws.security.kerberos.auth/resources/OSGI-INF/metatype/metatype.xml", "diffHunk": "@@ -0,0 +1,29 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+    Copyright (c) 2020 IBM Corporation and others.\n+    All rights reserved. This program and the accompanying materials\n+    are made available under the terms of the Eclipse Public License v1.0\n+    which accompanies this distribution, and is available at\n+    http://www.eclipse.org/legal/epl-v10.html\n+\n+    Contributors:\n+        IBM Corporation - initial API and implementation\n+-->\n+<metatype:MetaData xmlns:metatype=\"http://www.osgi.org/xmlns/metatype/v1.1.0\" \n+                   xmlns:ibm=\"http://www.ibm.com/xmlns/appservers/osgi/metatype/v1.0.0\" \n+                   localization=\"OSGI-INF/l10n/metatype\">\n+    \n+    <OCD id=\"com.ibm.ws.security.kerberos.auth.KerberosService\" name=\"%kerberos\" description=\"%kerberos.desc\" \n+    \t  ibm:alias=\"kerberos\" ibm:beta=\"true\">\n+    \t  \n+    \t<AD id=\"keytab\"     name=\"%kerberos.keytab\"     description=\"%kerberos.keytab.desc\"     type=\"String\" ibm:type=\"location(file)\" required=\"false\"/>", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU5ODkwOQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450598909", "bodyText": "those are just variable names, so a user would not seem them. I can shorten the variable names though if that's what you're asking", "author": "aguibert", "createdAt": "2020-07-07T04:02:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4MzgzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDkxNTU3Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450915576", "bodyText": "Yes, just shorting the variable names.. %keytab and %keytab.des", "author": "utle", "createdAt": "2020-07-07T14:38:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4MzgzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4ODI0MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450588240", "bodyText": "When we modify the kerberos element or unsetKrb5Service, don't we need to clean up the subject cache?", "author": "utle", "createdAt": "2020-07-07T03:13:51Z", "path": "dev/com.ibm.ws.security.jca/src/com/ibm/ws/security/jca/internal/AuthDataServiceImpl.java", "diffHunk": "@@ -86,6 +88,14 @@ protected void unsetSecurityService(ServiceReference<SecurityService> reference)\n         securityServiceRef.unsetReference(reference);\n     }\n \n+    protected void setKrb5Service(ServiceReference<KerberosService> ref) {\n+        krb5ServiceRef.setReference(ref);\n+    }\n+\n+    protected void unsetKrb5Service(ServiceReference<KerberosService> ref) {", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU5ODcxNA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450598714", "bodyText": "What subject cache are you referring to?", "author": "aguibert", "createdAt": "2020-07-07T04:01:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4ODI0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDkyMTU2Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450921566", "bodyText": "Looks like we do not cache the subject and do the Kerberos login every time, right?\nNOTE: Caching of subjects was removed under defect 63520, due to the following two reasons\n\nwhich we could not address in the GA timeframe:", "author": "utle", "createdAt": "2020-07-07T14:46:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4ODI0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4ODUwOQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450588509", "bodyText": "2020", "author": "utle", "createdAt": "2020-07-07T03:15:02Z", "path": "dev/com.ibm.ws.security.kerberos.auth/resources/OSGI-INF/wlp/defaultInstances.xml", "diffHunk": "@@ -0,0 +1,13 @@\n+<!--\n+    Copyright (c) 2019 IBM Corporation and others.", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4OTk2MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450589961", "bodyText": "I would think the Kerberos service will do more than just get the config and keytab from the kerberos element. So we will know which keytab and config file that we use.\nif (kerberos config)\nget keytab and config files\nelse (get the default file name and location for keytab and config files)\nWe should print out the the kerberos config and keytab as an event.\nThe most common problem we see is which Kerberos config/keytab files that we use.", "author": "utle", "createdAt": "2020-07-07T03:21:58Z", "path": "dev/com.ibm.ws.security.kerberos.auth/src/com/ibm/ws/security/kerberos/auth/KerberosService.java", "diffHunk": "@@ -0,0 +1,79 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package com.ibm.ws.security.kerberos.auth;\n+\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.security.AccessController;\n+\n+import org.osgi.service.component.ComponentContext;\n+import org.osgi.service.component.annotations.Activate;\n+import org.osgi.service.component.annotations.Component;\n+import org.osgi.service.component.annotations.ConfigurationPolicy;\n+\n+import com.ibm.websphere.ras.Tr;\n+import com.ibm.websphere.ras.TraceComponent;\n+import com.ibm.ws.kernel.service.util.SecureAction;\n+\n+@Component(configurationPolicy = ConfigurationPolicy.REQUIRE,", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU5OTYxOQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450599619", "bodyText": "2 questions here:\n\n\nwhen you say \"print out the kerberos config and keytab as an event\" do you mean to log the locations being used as an INFO level message? That sounds reasonable to me.\n\n\nCan you elaborate on what you mean by the pseudocode above? I don't think the Liberty code should be doing any parsing of the config/keytab files, or even specifying default values if unspecified. We should just delegate all of the config parsing and default values to whatever the JDK has", "author": "aguibert", "createdAt": "2020-07-07T04:06:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4OTk2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDkxNzI5OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450917299", "bodyText": "Yes, log the locations being used as an INFO level msg.\nI am ok with what you have as long as we log the INFO level msg in 1) for the default keytab and config file.", "author": "utle", "createdAt": "2020-07-07T14:40:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU4OTk2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU5MDg3Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450590872", "bodyText": "I hope you also test with IBM JDK 8 and the ibm krb5 debug is -Dcom.ibm.security.krb5.krb5Debug", "author": "utle", "createdAt": "2020-07-07T03:26:08Z", "path": "dev/com.ibm.ws.jdbc_fat_krb5/fat/src/com/ibm/ws/jdbc/fat/db2/JDBCKerberosTest.java", "diffHunk": "@@ -76,8 +76,8 @@ public static void setUp() throws Exception {\n         server.addEnvVar(\"DB2_USER\", db2.getUsername());\n         server.addEnvVar(\"DB2_PASS\", db2.getPassword());\n         server.addEnvVar(\"KRB5_USER\", KRB5_USER);\n+        server.addEnvVar(\"KRB5_CONF\", krbConfPath.toAbsolutePath().toString());\n         List<String> jvmOpts = new ArrayList<>();\n-        jvmOpts.add(\"-Djava.security.krb5.conf=\" + krbConfPath.toAbsolutePath());\n         jvmOpts.add(\"-Dsun.security.krb5.debug=true\");", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU5ODYzNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450598635", "bodyText": "I have not tested with IBM JDK 8 yet, but we will test with IBM JDK 8 before we GA the feature", "author": "aguibert", "createdAt": "2020-07-07T04:00:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU5MDg3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk1MjQzMA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r450952430", "bodyText": "discussion with Ut: Change to error if both are specified to different value (same as config)", "author": "aguibert", "createdAt": "2020-07-07T15:27:52Z", "path": "dev/com.ibm.ws.security.spnego/src/com/ibm/ws/security/spnego/internal/SpnegoConfigImpl.java", "diffHunk": "@@ -162,6 +168,12 @@ protected void processConfig(Map<String, Object> props) {\n      */\n     protected String processKrb5Keytab(Map<String, Object> props) {\n         String keytab = (String) props.get(KEY_KRB5_KEYTAB);\n+        Path kerbKeytab = kerbSvc.getKeytab(); // from the <kerberos> element\n+\n+        if (keytab == null && kerbKeytab != null) {", "originalCommit": "2d5e9904ff6a3e80d137658f3ff057b2bd05ba2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU1NDE1NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451554154", "bodyText": "Change,\n\"The attribute {0} from the {1} element conflicts with the attribute {2} from the {3} element. Only specify a value on either the {1} or the {3} element. It is suggested to only specify the value on the {1} element.\"\nto,\n\"The attribute {0} from the {1} element conflicts with the attribute {2} from the {3} element. Specify only a value on either the {1} or the {3} element. It is suggested to specify only the value on the {1} element.\"", "author": "ManasiGandhi", "createdAt": "2020-07-08T13:43:13Z", "path": "dev/com.ibm.ws.security.spnego/resources/com/ibm/ws/security/spnego/internal/resources/SpnegoMessages.nlsprops", "diffHunk": "@@ -113,3 +113,7 @@ SPNEGO_CAN_NOT_GET_DELEGATE_SERVICE_SPN.useraction=Verify the service principal\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE=CWWKS4322E: Delegate SPN {0} can not authenticate to the Key Distribution Center (KDC) using the Kerberos configuration file {1} and keytab file {2}. Login exception was received: {3}\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE.explanation=Can not authenticate to the Key Distribution Center (KDC).\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE.useraction=Verify the service principal name format, and make sure it exists on the Windows domain and that the Kerberos keytab file contains the service principal name.\n+\n+SPNEGO_CONFLICTING_SETTINGS_CWWKS4323E=CWWKS4323E: The attribute {0} from the {1} element conflicts with the attribute {2} from the {3} element. Only specify a value on either the {1} or the {3} element. It is suggested to only specify the value on the {1} element.", "originalCommit": "1b4fa412b103a69c0bed0e16e39d80b4c81b8758", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY1MjgzNw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451652837", "bodyText": "I would suggest instead\n\"\"The {0} attribute of the {1} element conflicts with the {2} attribute from the {3} element. Specify a value on either the {1} or the {3} element, but not on both. It is suggested to specify the value on the {1} element.\"\nThe message guidelines say the proper nouns (replacement parms) should proceed nouns.", "author": "frowe", "createdAt": "2020-07-08T15:56:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU1NDE1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY1NjU2MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451656560", "bodyText": "SPN needs to be exploded similar to KDC.  Useraction also refers to Windows domain which would not apply to *nix envs.", "author": "frowe", "createdAt": "2020-07-08T16:02:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU1NDE1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTU1NTkzOA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451555938", "bodyText": "Change,\n\"In order to honor each attribute, a system property needs to be set, which is a system-wide setting. Different values for a system-wide setting cannot be honored.\"\nto,\n\"To recognize each attribute, a system property needs to be set, which is a system-wide setting. Different values for a system-wide setting cannot be recognized.\"", "author": "ManasiGandhi", "createdAt": "2020-07-08T13:45:48Z", "path": "dev/com.ibm.ws.security.spnego/resources/com/ibm/ws/security/spnego/internal/resources/SpnegoMessages.nlsprops", "diffHunk": "@@ -113,3 +113,7 @@ SPNEGO_CAN_NOT_GET_DELEGATE_SERVICE_SPN.useraction=Verify the service principal\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE=CWWKS4322E: Delegate SPN {0} can not authenticate to the Key Distribution Center (KDC) using the Kerberos configuration file {1} and keytab file {2}. Login exception was received: {3}\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE.explanation=Can not authenticate to the Key Distribution Center (KDC).\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE.useraction=Verify the service principal name format, and make sure it exists on the Windows domain and that the Kerberos keytab file contains the service principal name.\n+\n+SPNEGO_CONFLICTING_SETTINGS_CWWKS4323E=CWWKS4323E: The attribute {0} from the {1} element conflicts with the attribute {2} from the {3} element. Only specify a value on either the {1} or the {3} element. It is suggested to only specify the value on the {1} element.\n+SPNEGO_CONFLICTING_SETTINGS_CWWKS4323E.explanation=In order to honor each attribute, a system property needs to be set, which is a system-wide setting. Different values for a system-wide setting cannot be honored.", "originalCommit": "1b4fa412b103a69c0bed0e16e39d80b4c81b8758", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "91f1be20f079bebc6e54a20a4e14bce6676f24b4", "url": "https://github.com/OpenLiberty/open-liberty/commit/91f1be20f079bebc6e54a20a4e14bce6676f24b4", "message": "Review comment changes from Ut", "committedDate": "2020-07-08T18:39:31Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc1Nzc0OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451757748", "bodyText": "Is it possible to say what the name will be used for, or by what?", "author": "dmuelle", "createdAt": "2020-07-08T18:52:22Z", "path": "dev/com.ibm.ws.security.auth.data.common/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -35,11 +35,5 @@ maxSize.desc=Maximum number of entries supported by the authentication data subj\n \n #======= KERBEROS SETTINGS =========\n # Do not translate: Kerberos, principal\n-krb5Principal=Kerberos service principal name\n-krb5Principal.desc=The name of the principal to be used. The principal can be a simple username or a service name.\n-\n-# Do not translate: Kerberos, keytab, principal, {user.home}/krb5.keytab\n-krb5Keytab=Kerberos keytab file\n-krb5Keytab.desc=The path of the keytab file that is used to obtain the principal's secret key. If unspecified, the keytab from \\\n-the Kerberos configuration file is used. If it is not specified in the Kerberos configuration file, then it looks for the file \\\n-at {user.home}/krb5.keytab.\n+krb5Principal=Kerberos principal name\n+krb5Principal.desc=The name of the Kerberos principal name or Kerberos service name to be used.", "originalCommit": "91f1be20f079bebc6e54a20a4e14bce6676f24b4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc1OTczNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451759735", "bodyText": "If it is not specified in the Kerberos configuration file, then it looks for the file \\ at {user.home}/krb5.keytab.\nWhat do the two \"it\" s in this sentence refer to respectively? I think the first one refers to the keytab but not sure about the second", "author": "dmuelle", "createdAt": "2020-07-08T18:56:10Z", "path": "dev/com.ibm.ws.security.kerberos.auth/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -0,0 +1,29 @@\n+###############################################################################\n+# Copyright (c) 2020 IBM Corporation and others.\n+# All rights reserved. This program and the accompanying materials\n+# are made available under the terms of the Eclipse Public License v1.0\n+# which accompanies this distribution, and is available at\n+# http://www.eclipse.org/legal/epl-v10.html\n+#\n+# Contributors:\n+#     IBM Corporation - initial API and implementation\n+###############################################################################\n+#\n+#CMVCPATHNAME com.ibm.ws.security.kerberos.auth/resources/OSGI-INF/l10n/metatype.properties\n+#ISMESSAGEFILE FALSE\n+#NLS_ENCODING=UNICODE\n+#NLS_MESSAGEFORMAT_NONE\n+#\n+\n+kerberos=Kerberos\n+kerberos.desc=System-wide settings for Kerberos authentication\n+\n+keytab=Kerberos keytab file\n+keytab.desc=The path of the keytab file that is used to obtain the principal's secret key. If unspecified, the keytab from \\\n+the Kerberos configuration file is used. If it is not specified in the Kerberos configuration file, then it looks for the file \\", "originalCommit": "91f1be20f079bebc6e54a20a4e14bce6676f24b4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc2MTU1Nw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451761557", "bodyText": "change\nThe attribute [{0}]...\nto\nThe [{0}] attribute ...\nIs there a reason  [{0}] is double bracketed, while the other variables are not?\nWhat sort of element is {2} ? Is it a directory location?", "author": "dmuelle", "createdAt": "2020-07-08T18:59:33Z", "path": "dev/com.ibm.ws.security.kerberos.auth/resources/com/ibm/ws/security/kerberos/auth/internal/resources/KerberosMessages.nlsprops", "diffHunk": "@@ -0,0 +1,27 @@\n+###############################################################################\n+# Copyright (c) 2020 IBM Corporation and others.\n+# All rights reserved. This program and the accompanying materials\n+# are made available under the terms of the Eclipse Public License v1.0\n+# which accompanies this distribution, and is available at\n+# http://www.eclipse.org/legal/epl-v10.html\n+#\n+# Contributors:\n+#     IBM Corporation - initial API and implementation\n+###############################################################################\n+#CMVCPATHNAME com.ibm.ws.security.kerberos.auth/resources/com/ibm/ws/security/kerberos/auth/internal/resources/KerberosMessages.nlsprops\n+#COMPONENTPREFIX CWWKS\n+#COMPONENTNAMEFOR WebSphere Application Server Security Kerberos Service\n+#ISMESSAGEFILE TRUE\n+#NLS_MESSAGEFORMAT_VAR\n+#NLS_ENCODING=UNICODE\n+# -------------------------------------------------------------------------------------------------\n+\n+# For any new messages reserve a code from the nlsprops file in the com.ibm.ws.security.kerberos.java8 bundle\n+\n+KRB5_FILE_NOT_FOUND_CWWKS4345E=CWWKS4345E: The attribute [{0}] from the {1} element is configured to a file that does not exist at: {2}", "originalCommit": "91f1be20f079bebc6e54a20a4e14bce6676f24b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzcxNjgwNg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r453716806", "bodyText": "The reason [{0}] is double bracketed is because we use this convention in other places when referring to an attribute. So the message will resolve as: The attribute [keytab] from the .....\nVariable {2} is a specific file location", "author": "aguibert", "createdAt": "2020-07-13T15:04:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc2MTU1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc2MjE3MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451762170", "bodyText": "I don't think you need to include the second sentence in both the explanation and the useraction, unless there is a specific reason for doing so", "author": "dmuelle", "createdAt": "2020-07-08T19:00:39Z", "path": "dev/com.ibm.ws.security.kerberos.auth/resources/com/ibm/ws/security/kerberos/auth/internal/resources/KerberosMessages.nlsprops", "diffHunk": "@@ -0,0 +1,27 @@\n+###############################################################################\n+# Copyright (c) 2020 IBM Corporation and others.\n+# All rights reserved. This program and the accompanying materials\n+# are made available under the terms of the Eclipse Public License v1.0\n+# which accompanies this distribution, and is available at\n+# http://www.eclipse.org/legal/epl-v10.html\n+#\n+# Contributors:\n+#     IBM Corporation - initial API and implementation\n+###############################################################################\n+#CMVCPATHNAME com.ibm.ws.security.kerberos.auth/resources/com/ibm/ws/security/kerberos/auth/internal/resources/KerberosMessages.nlsprops\n+#COMPONENTPREFIX CWWKS\n+#COMPONENTNAMEFOR WebSphere Application Server Security Kerberos Service\n+#ISMESSAGEFILE TRUE\n+#NLS_MESSAGEFORMAT_VAR\n+#NLS_ENCODING=UNICODE\n+# -------------------------------------------------------------------------------------------------\n+\n+# For any new messages reserve a code from the nlsprops file in the com.ibm.ws.security.kerberos.java8 bundle\n+\n+KRB5_FILE_NOT_FOUND_CWWKS4345E=CWWKS4345E: The attribute [{0}] from the {1} element is configured to a file that does not exist at: {2}\n+KRB5_FILE_NOT_FOUND_CWWKS4345E.explanation=The configuration refers to a file that does not exist, or could not be read. Ensure that the configuration points to a file that exists and is readable by the appliction process.", "originalCommit": "91f1be20f079bebc6e54a20a4e14bce6676f24b4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc2MjYwOA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451762608", "bodyText": "What kind of elements are {0} and {1} ?", "author": "dmuelle", "createdAt": "2020-07-08T19:01:26Z", "path": "dev/com.ibm.ws.security.kerberos.auth/resources/com/ibm/ws/security/kerberos/auth/internal/resources/KerberosMessages.nlsprops", "diffHunk": "@@ -0,0 +1,27 @@\n+###############################################################################\n+# Copyright (c) 2020 IBM Corporation and others.\n+# All rights reserved. This program and the accompanying materials\n+# are made available under the terms of the Eclipse Public License v1.0\n+# which accompanies this distribution, and is available at\n+# http://www.eclipse.org/legal/epl-v10.html\n+#\n+# Contributors:\n+#     IBM Corporation - initial API and implementation\n+###############################################################################\n+#CMVCPATHNAME com.ibm.ws.security.kerberos.auth/resources/com/ibm/ws/security/kerberos/auth/internal/resources/KerberosMessages.nlsprops\n+#COMPONENTPREFIX CWWKS\n+#COMPONENTNAMEFOR WebSphere Application Server Security Kerberos Service\n+#ISMESSAGEFILE TRUE\n+#NLS_MESSAGEFORMAT_VAR\n+#NLS_ENCODING=UNICODE\n+# -------------------------------------------------------------------------------------------------\n+\n+# For any new messages reserve a code from the nlsprops file in the com.ibm.ws.security.kerberos.java8 bundle\n+\n+KRB5_FILE_NOT_FOUND_CWWKS4345E=CWWKS4345E: The attribute [{0}] from the {1} element is configured to a file that does not exist at: {2}\n+KRB5_FILE_NOT_FOUND_CWWKS4345E.explanation=The configuration refers to a file that does not exist, or could not be read. Ensure that the configuration points to a file that exists and is readable by the appliction process.\n+KRB5_FILE_NOT_FOUND_CWWKS4345E.useraction=Ensure that the configuration points to a file that exists and is readable by the application process.\n+\n+KRB5_FILE_FOUND_CWWKS4346I=CWWKS4346I: The Kerberos component is configured to use a {0} located at {1}", "originalCommit": "91f1be20f079bebc6e54a20a4e14bce6676f24b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgxODM2OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r451818369", "bodyText": "{0} will be either a .keytab or .conf file.\n{1} will be the path to the configured keytab or conf file.\nSince these bits won't be translated, I decided to use {0} for 1 less message that will need to be translated", "author": "aguibert", "createdAt": "2020-07-08T20:52:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc2MjYwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMxNDM1MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r452314350", "bodyText": "Generally, guidance is to have an identifier for the variable, like:\nThe Kerberos component is configured to use a {0} file located at {1}.\nIf the variable pulls in the actual filename\nThe Kerberos component is configured to use a the {0} file located at {1}.\nThe sentence already identifies {1} as a location so I don't think you'd need another identifier", "author": "dmuelle", "createdAt": "2020-07-09T15:44:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc2MjYwOA=="}], "type": "inlineReview"}, {"oid": "ed56f87eeb5a3b4ff3e20bfc0cdda463eb55f687", "url": "https://github.com/OpenLiberty/open-liberty/commit/ed56f87eeb5a3b4ff3e20bfc0cdda463eb55f687", "message": "Review comment changes from Ut and ID team", "committedDate": "2020-07-13T15:06:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAxNzU2OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r454017568", "bodyText": "change\nThe location is passed to the JDK implementation of \nthe Kerberos APIs using the java.security.krb5.conf system property.\ndepending on which of the following is correct:\nto\nThe location is passed to the JDK implementation of \nthe Kerberos APIs by using the java.security.krb5.conf system property.\nor\nThe location is passed to the JDK implementation of \nthe Kerberos APIs that are using the java.security.krb5.conf system property.", "author": "dmuelle", "createdAt": "2020-07-14T00:02:37Z", "path": "dev/com.ibm.ws.security.kerberos.auth/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -0,0 +1,29 @@\n+###############################################################################\n+# Copyright (c) 2020 IBM Corporation and others.\n+# All rights reserved. This program and the accompanying materials\n+# are made available under the terms of the Eclipse Public License v1.0\n+# which accompanies this distribution, and is available at\n+# http://www.eclipse.org/legal/epl-v10.html\n+#\n+# Contributors:\n+#     IBM Corporation - initial API and implementation\n+###############################################################################\n+#\n+#CMVCPATHNAME com.ibm.ws.security.kerberos.auth/resources/OSGI-INF/l10n/metatype.properties\n+#ISMESSAGEFILE FALSE\n+#NLS_ENCODING=UNICODE\n+#NLS_MESSAGEFORMAT_NONE\n+#\n+\n+kerberos=Kerberos\n+kerberos.desc=System-wide settings for Kerberos authentication\n+\n+keytab=Kerberos keytab file\n+keytab.desc=The path of the keytab file that is used to obtain the principal's secret key. If unspecified, the keytab from \\\n+the Kerberos configuration file is used. If a keytab file is not specified in the Kerberos configuration file, then the location \\\n+{user.home}/krb5.keytab is checked.\n+\n+configFile=Kerberos conf file\n+configFile.desc=The location of an MIT style krb5.conf configuration file. The location is passed to the JDK implementation of \\\n+the Kerberos APIs using the java.security.krb5.conf system property. If unspecified, the krb5.conf file is searched for according to the \\", "originalCommit": "ed56f87eeb5a3b4ff3e20bfc0cdda463eb55f687", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAxOTU5OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r454019599", "bodyText": "suggested edits:\nchange\nThe attribute {0} from the {1} element conflicts with the attribute {2} from the {3} element. Specify only a value on either the {1} or the {3} element. It is suggested to specify only the value on the {1} element.\nto\nThe {0} attribute from the {1} element conflicts with the {2} attribute  from the {3} element. Specify a value only on either the {1} or the {3} element, not on both elements. It is suggested to specify  the value only on the {1} element.\nDo the attributes in this message need double bracketing?\nchange\nSpecify the attribute in only one of the config elements.\nto\nSpecify the attribute in only one of the configuration elements.", "author": "dmuelle", "createdAt": "2020-07-14T00:09:42Z", "path": "dev/com.ibm.ws.security.spnego/resources/com/ibm/ws/security/spnego/internal/resources/SpnegoMessages.nlsprops", "diffHunk": "@@ -113,3 +113,7 @@ SPNEGO_CAN_NOT_GET_DELEGATE_SERVICE_SPN.useraction=Verify the service principal\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE=CWWKS4322E: Delegate SPN {0} can not authenticate to the Key Distribution Center (KDC) using the Kerberos configuration file {1} and keytab file {2}. Login exception was received: {3}\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE.explanation=Can not authenticate to the Key Distribution Center (KDC).\n SPNEGO_DELEGATE_SPN_LOGIN_TO_KDC_FAILURE.useraction=Verify the service principal name format, and make sure it exists on the Windows domain and that the Kerberos keytab file contains the service principal name.\n+\n+SPNEGO_CONFLICTING_SETTINGS_CWWKS4323E=The attribute {0} from the {1} element conflicts with the attribute {2} from the {3} element. Specify only a value on either the {1} or the {3} element. It is suggested to specify only the value on the {1} element.", "originalCommit": "ed56f87eeb5a3b4ff3e20bfc0cdda463eb55f687", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAyMDE1NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r454020155", "bodyText": "change\nStandard variable substitutions, such as ${server.config.dir}, can be used when specifying the directory path.\nto\nStandard variable substitutions, such as ${server.config.dir}, can be used when you specify the directory path.", "author": "dmuelle", "createdAt": "2020-07-14T00:11:43Z", "path": "dev/com.ibm.ws.security.spnego/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -29,10 +29,10 @@ canonicalHostName=Use canonical host name\n canonicalHostName.desc= Controls whether you want to use the canonical host name.\n \n krb5Config=The Kerberos configuration file with full path\n-krb5Config.desc=Specifies the fully qualified Kerberos configuration path and name. Standard variable substitutions, such as ${server.config.dir}, can be used when specifying the directory path.\n+krb5Config.desc=Deprecated: use configFile attribute on the <kerberos> element instead. Specifies the fully qualified Kerberos configuration path and name. Standard variable substitutions, such as ${server.config.dir}, can be used when specifying the directory path.", "originalCommit": "ed56f87eeb5a3b4ff3e20bfc0cdda463eb55f687", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAyMjQ2NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12901#discussion_r454022465", "bodyText": "Specifies the fully qualified Kerberos keytab  path and name.\nremove extra space between \"keytab\" and \"path\"\nchange\nStandard variable substitutions, such as ${server.config.dir}, can be used when specifying the directory path.\nto\nStandard variable substitutions, such as ${server.config.dir}, can be used when you specify the directory path.", "author": "dmuelle", "createdAt": "2020-07-14T00:19:50Z", "path": "dev/com.ibm.ws.security.spnego/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -29,10 +29,10 @@ canonicalHostName=Use canonical host name\n canonicalHostName.desc= Controls whether you want to use the canonical host name.\n \n krb5Config=The Kerberos configuration file with full path\n-krb5Config.desc=Specifies the fully qualified Kerberos configuration path and name. Standard variable substitutions, such as ${server.config.dir}, can be used when specifying the directory path.\n+krb5Config.desc=Deprecated: use configFile attribute on the <kerberos> element instead. Specifies the fully qualified Kerberos configuration path and name. Standard variable substitutions, such as ${server.config.dir}, can be used when specifying the directory path.\n \n krb5Keytab=The Kerberos keytab file name and include path\n-krb5Keytab.desc=Specifies the fully qualified Kerberos keytab  path and name. Standard variable substitutions, such as ${server.config.dir}, can be used when specifying the directory path. The Kerberos keytab file contains a list of keys that are analogous to user passwords. It is important for hosts to protect their Kerberos keytab files by storing them on the local disk.\n+krb5Keytab.desc=Deprecated: use keytab attribute on the <kerberos> element instead. Specifies the fully qualified Kerberos keytab  path and name. Standard variable substitutions, such as ${server.config.dir}, can be used when specifying the directory path. The Kerberos keytab file contains a list of keys that are analogous to user passwords. It is important for hosts to protect their Kerberos keytab files by storing them on the local disk.", "originalCommit": "ed56f87eeb5a3b4ff3e20bfc0cdda463eb55f687", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7ac903ec633bc9fbd08d32df9055a0c216cb4934", "url": "https://github.com/OpenLiberty/open-liberty/commit/7ac903ec633bc9fbd08d32df9055a0c216cb4934", "message": "Review comment changes from Ut and ID team", "committedDate": "2020-07-14T04:19:27Z", "type": "commit"}, {"oid": "7ac903ec633bc9fbd08d32df9055a0c216cb4934", "url": "https://github.com/OpenLiberty/open-liberty/commit/7ac903ec633bc9fbd08d32df9055a0c216cb4934", "message": "Review comment changes from Ut and ID team", "committedDate": "2020-07-14T04:19:27Z", "type": "forcePushed"}]}