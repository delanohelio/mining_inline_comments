{"pr_number": 13241, "pr_title": "Implement subject cache for KerberosService", "pr_createdAt": "2020-07-29T19:47:51Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/13241", "timeline": [{"oid": "948e139f0c520938a7759bb3d56765566b7b6c69", "url": "https://github.com/OpenLiberty/open-liberty/commit/948e139f0c520938a7759bb3d56765566b7b6c69", "message": "Implement subject cache for KerberosService", "committedDate": "2020-07-30T05:19:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk5MTAxNw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13241#discussion_r462991017", "bodyText": "We need to make sure the KerberosPrinicpal is a fully qualify Kerberos principal name userName@KerberosRealmName", "author": "utle", "createdAt": "2020-07-30T13:21:30Z", "path": "dev/com.ibm.ws.security.kerberos.auth/src/com/ibm/ws/security/kerberos/auth/internal/LRUCache.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package com.ibm.ws.security.kerberos.auth.internal;\n+\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import javax.security.auth.Subject;\n+import javax.security.auth.kerberos.KerberosPrincipal;\n+import javax.security.auth.kerberos.KerberosTicket;\n+\n+import org.ietf.jgss.GSSCredential;\n+import org.ietf.jgss.GSSException;\n+\n+import com.ibm.websphere.ras.Tr;\n+import com.ibm.websphere.ras.TraceComponent;\n+import com.ibm.websphere.ras.annotation.Trivial;\n+\n+@Trivial\n+public class LRUCache {\n+\n+    private static final TraceComponent tc = Tr.register(LRUCache.class);\n+\n+    private final Map<KerberosPrincipal, Subject> cache = new LinkedHashMap<KerberosPrincipal, Subject>() {", "originalCommit": "948e139f0c520938a7759bb3d56765566b7b6c69", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzA0NDYxNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13241#discussion_r463044615", "bodyText": "@utle it will automatically add the default realm name if it is not specified in the principal string, this is the main reason I'm using KerberosPrinicpal here instead of just String. I ran this test to show that the default realm name is automatically added:\nKerberosPrincipal p1 = new KerberosPrincipal(\"dbuser\");\nKerberosPrincipal p2 = new KerberosPrincipal(\"dbuser@EXAMPLE.COM\");\n\nSystem.out.println(\"equal? \" + p1.equals(p2)); // shows both principals are equal", "author": "aguibert", "createdAt": "2020-07-30T14:37:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk5MTAxNw=="}], "type": "inlineReview"}, {"oid": "fa00ba1f83106e4a1d1755782e6aa8900c24fb66", "url": "https://github.com/OpenLiberty/open-liberty/commit/fa00ba1f83106e4a1d1755782e6aa8900c24fb66", "message": "Implement subject cache for KerberosService", "committedDate": "2020-07-30T20:46:13Z", "type": "commit"}, {"oid": "fa00ba1f83106e4a1d1755782e6aa8900c24fb66", "url": "https://github.com/OpenLiberty/open-liberty/commit/fa00ba1f83106e4a1d1755782e6aa8900c24fb66", "message": "Implement subject cache for KerberosService", "committedDate": "2020-07-30T20:46:13Z", "type": "forcePushed"}]}