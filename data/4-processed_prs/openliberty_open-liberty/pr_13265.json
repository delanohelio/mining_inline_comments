{"pr_number": 13265, "pr_title": "Restructure MP API projects", "pr_createdAt": "2020-07-30T18:01:57Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/13265", "timeline": [{"oid": "4e3ad48687b79eb8b81805aba7c249970c2492a2", "url": "https://github.com/OpenLiberty/open-liberty/commit/4e3ad48687b79eb8b81805aba7c249970c2492a2", "message": "Cleanup MP API components\n\n- Delete the components' whose bnd files were moved to the new project.\n- Remove properties and META-INF directories in these projects that were\nunused as well.", "committedDate": "2020-07-31T20:20:00Z", "type": "forcePushed"}, {"oid": "a831cc45593415e3c21c7444e8bd8887798b7704", "url": "https://github.com/OpenLiberty/open-liberty/commit/a831cc45593415e3c21c7444e8bd8887798b7704", "message": "Temporarily add back contextpropagation project\n\n- commercial liberty repo still depends on the project so temporarily\nadd it back and then will switch over to use\ncom.ibm.websphere.org.eclipse.micrprofile once it makes it to master.", "committedDate": "2020-08-03T12:57:37Z", "type": "forcePushed"}, {"oid": "6d3341a5f000a9c435858f98c386eee4ea78aa59", "url": "https://github.com/OpenLiberty/open-liberty/commit/6d3341a5f000a9c435858f98c386eee4ea78aa59", "message": "Temporarily add back contextpropagation project\n\n- commercial liberty repo still depends on the project so temporarily\nadd it back and then will switch over to use\ncom.ibm.websphere.org.eclipse.micrprofile once it makes it to master.", "committedDate": "2020-08-03T16:32:45Z", "type": "forcePushed"}, {"oid": "2a19c0aeb11498366b4b33cfd977f34d5d6d2174", "url": "https://github.com/OpenLiberty/open-liberty/commit/2a19c0aeb11498366b4b33cfd977f34d5d6d2174", "message": "Temporarily add back contextpropagation project\n\n- commercial liberty repo still depends on the project so temporarily\nadd it back and then will switch over to use\ncom.ibm.websphere.org.eclipse.micrprofile once it makes it to master.", "committedDate": "2020-08-03T16:34:58Z", "type": "forcePushed"}, {"oid": "741c63dfafb8b5916ee37a4a2e2c5b8e4f821864", "url": "https://github.com/OpenLiberty/open-liberty/commit/741c63dfafb8b5916ee37a4a2e2c5b8e4f821864", "message": "Temporarily add back contextpropagation project\n\n- commercial liberty repo still depends on the project so temporarily\nadd it back and then will switch over to use\ncom.ibm.websphere.org.eclipse.micrprofile once it makes it to master.", "committedDate": "2020-08-03T16:57:53Z", "type": "forcePushed"}, {"oid": "32998691797a96eb3128e4f64323a02ebeba1372", "url": "https://github.com/OpenLiberty/open-liberty/commit/32998691797a96eb3128e4f64323a02ebeba1372", "message": "Temporarily add back contextpropagation project\n\n- commercial liberty repo still depends on the project so temporarily\nadd it back and then will switch over to use\ncom.ibm.websphere.org.eclipse.micrprofile once it makes it to master.", "committedDate": "2020-08-03T16:59:24Z", "type": "forcePushed"}, {"oid": "9974ab08e50f82dfa3d7a3c5e6f86e1f8ab648c5", "url": "https://github.com/OpenLiberty/open-liberty/commit/9974ab08e50f82dfa3d7a3c5e6f86e1f8ab648c5", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-04T00:15:17Z", "type": "forcePushed"}, {"oid": "7a98b95d838686ca77d79248f8930ddafe075938", "url": "https://github.com/OpenLiberty/open-liberty/commit/7a98b95d838686ca77d79248f8930ddafe075938", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-05T20:02:43Z", "type": "forcePushed"}, {"oid": "e44196b5c89d8f66101d79561c8f462947fa05da", "url": "https://github.com/OpenLiberty/open-liberty/commit/e44196b5c89d8f66101d79561c8f462947fa05da", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-05T20:06:32Z", "type": "forcePushed"}, {"oid": "782e5f6dbe4bbe106bb44729b9e98d4a80e76444", "url": "https://github.com/OpenLiberty/open-liberty/commit/782e5f6dbe4bbe106bb44729b9e98d4a80e76444", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-05T20:53:15Z", "type": "forcePushed"}, {"oid": "e8b417c9a57def01f8b579d27382ebc4d8c0509c", "url": "https://github.com/OpenLiberty/open-liberty/commit/e8b417c9a57def01f8b579d27382ebc4d8c0509c", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-05T21:13:53Z", "type": "forcePushed"}, {"oid": "3d1945852072ea92940bc1750c4b120c4a7e68bf", "url": "https://github.com/OpenLiberty/open-liberty/commit/3d1945852072ea92940bc1750c4b120c4a7e68bf", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-06T16:09:40Z", "type": "forcePushed"}, {"oid": "54c309615ac747db429084275f4383fb7c531661", "url": "https://github.com/OpenLiberty/open-liberty/commit/54c309615ac747db429084275f4383fb7c531661", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-06T17:20:18Z", "type": "forcePushed"}, {"oid": "f13513cb7ad7eeec03c22dec63690fc45b2b1184", "url": "https://github.com/OpenLiberty/open-liberty/commit/f13513cb7ad7eeec03c22dec63690fc45b2b1184", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-06T17:27:24Z", "type": "forcePushed"}, {"oid": "2e1c92a44ca02fdf071849bd3a17934874f77419", "url": "https://github.com/OpenLiberty/open-liberty/commit/2e1c92a44ca02fdf071849bd3a17934874f77419", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-10T14:08:42Z", "type": "forcePushed"}, {"oid": "d9201e32edf91da9f4e318c909f127f12ab48c8a", "url": "https://github.com/OpenLiberty/open-liberty/commit/d9201e32edf91da9f4e318c909f127f12ab48c8a", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-11T23:04:33Z", "type": "forcePushed"}, {"oid": "1a4abad1e7340f8b6f98b805fa2902e232005b66", "url": "https://github.com/OpenLiberty/open-liberty/commit/1a4abad1e7340f8b6f98b805fa2902e232005b66", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-11T23:05:18Z", "type": "forcePushed"}, {"oid": "209743b6c4d93fb2235673d63bd7827c28ef7b86", "url": "https://github.com/OpenLiberty/open-liberty/commit/209743b6c4d93fb2235673d63bd7827c28ef7b86", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-11T23:25:14Z", "type": "forcePushed"}, {"oid": "0fc0483ccbd58b6b329313e6212698b1404bc4ac", "url": "https://github.com/OpenLiberty/open-liberty/commit/0fc0483ccbd58b6b329313e6212698b1404bc4ac", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-12T11:46:07Z", "type": "forcePushed"}, {"oid": "773da4d7e867f57d9e560ec09cf04e012f06bf9d", "url": "https://github.com/OpenLiberty/open-liberty/commit/773da4d7e867f57d9e560ec09cf04e012f06bf9d", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-12T11:52:48Z", "type": "forcePushed"}, {"oid": "00c315e4f7b88598524cb77795b0c471e03c1be1", "url": "https://github.com/OpenLiberty/open-liberty/commit/00c315e4f7b88598524cb77795b0c471e03c1be1", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-12T16:31:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzNzM0Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472937342", "bodyText": "What does this root bnd.bnd file in the com.ibm.websphere.org.eclipse.microprofile project do?\nInitially I expected it to be doing nothing, but there's quite a lot in here if that's the case.", "author": "Azquelt", "createdAt": "2020-08-19T10:48:00Z", "path": "dev/com.ibm.websphere.org.eclipse.microprofile/bnd.bnd", "diffHunk": "@@ -0,0 +1,24 @@\n+#*******************************************************************************\n+# Copyright (c) 2020 IBM Corporation and others.\n+# All rights reserved. This program and the accompanying materials\n+# are made available under the terms of the Eclipse Public License v1.0\n+# which accompanies this distribution, and is available at\n+# http://www.eclipse.org/legal/epl-v10.html\n+#\n+# Contributors:\n+#     IBM Corporation - initial API and implementation\n+#*******************************************************************************\n+-include= ~../cnf/resources/bnd/bundle.props\n+bVersion: 1.0\n+\n+-sub: *.bnd\n+\n+publish.wlp.jar.suffix: dev/api/stable\n+\n+instrument.disabled: true\n+\n+-buildpath: \\\n+  com.ibm.websphere.javaee.cdi.1.2;version=latest, \\\n+  com.ibm.websphere.javaee.interceptor.1.2;version=latest, \\\n+  com.ibm.websphere.javaee.jsonp.1.0, \\\n+  org.eclipse.microprofile.reactive.messaging:microprofile-reactive-messaging-api;version=1.0.0", "originalCommit": "10b80ed348257850206ce0c17585ce7380aeea23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk3NTc4Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472975782", "bodyText": "The outer project references the sub bundles.  The subprojects inherit settings from the outer bnd file.  The settings in the file (instrument.disabled, publish.wlp.jar.suffix and buildpath) are set for all of the sub projects.  Unless assemble.gradle is updated to handle some of these liberty build properties like instrument.disabled and publish.wlp.jar.suffix in the sub projects, they need to be in the outer bnd file.  The buildpath is defined by bnd and is required to be in the outer bnd file.  buildpath will not be used if it is specified in the sub bnd files.  In the end, the buildpath here is used to set the import versions in the sub project bundles.", "author": "jhanders34", "createdAt": "2020-08-19T12:01:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzNzM0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk3NjAzMg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472976032", "bodyText": "I will add some comments in the bnd file to help explain this.", "author": "jhanders34", "createdAt": "2020-08-19T12:02:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzNzM0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE1NjQzMw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r474156433", "bodyText": "I updated the bnd.bnd files for the outer projects with comments.", "author": "jhanders34", "createdAt": "2020-08-20T17:31:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzNzM0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzODM4MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472938381", "bodyText": "Copyright dates on all these modified bnd files should be updated.", "author": "Azquelt", "createdAt": "2020-08-19T10:49:55Z", "path": "dev/com.ibm.websphere.org.eclipse.microprofile/config.1.1.bnd", "diffHunk": "@@ -26,14 +25,4 @@ Export-Package: \\\n Include-Resource: \\\n   @${repo;org.eclipse.microprofile.config:microprofile-config-api;1.1;EXACT}\n \n-\n WS-TraceGroup: APPCONFIG\n-\n--buildpath: \\\n-\tcom.ibm.websphere.javaee.cdi.1.2;version=latest, \\\n-\tcom.ibm.ws.org.osgi.annotation.versioning;version=latest\n-\n-instrument.disabled: true\n-\n-publish.wlp.jar.suffix: dev/api/stable", "originalCommit": "10b80ed348257850206ce0c17585ce7380aeea23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk3MzY3NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472973674", "bodyText": "I will update them accordingly.", "author": "jhanders34", "createdAt": "2020-08-19T11:57:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzODM4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE1NjYyNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r474156625", "bodyText": "Copyright dates are updated.", "author": "jhanders34", "createdAt": "2020-08-20T17:31:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzODM4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzOTUwNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472939505", "bodyText": "This looks iffy. Previously we were including the 1.4 API jar, now we're including... the whole com.ibm.websphere.org.eclipse.microprofile project? What does that contain?\nAlso, it's worth noting that different versions of the MP specs often contain different conflicting versions of the same classes, so if we were putting all of them on the same classpath, that would not be ideal.", "author": "Azquelt", "createdAt": "2020-08-19T10:52:04Z", "path": "dev/com.ibm.ws.microprofile.config.1.4_fat/build.gradle", "diffHunk": "@@ -10,5 +10,5 @@\n  *******************************************************************************/\n \n dependencies {\n-  requiredLibs 'commons-logging:commons-logging:1.1.3', project(':com.ibm.ws.microprofile.config_repeat_tests'), project(':com.ibm.websphere.org.eclipse.microprofile.config.1.4')\n+  requiredLibs 'commons-logging:commons-logging:1.1.3', project(':com.ibm.ws.microprofile.config_repeat_tests'), project(':com.ibm.websphere.org.eclipse.microprofile')", "originalCommit": "10b80ed348257850206ce0c17585ce7380aeea23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk3MzU2Nw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472973567", "bodyText": "This is depending on the project I thought.  I did not think that was adding to the classpath, but if it is then I agree that it should be changed and will look to see what the behavior is.  I thought it was just adding a dependency on the project so that it is built before this project.", "author": "jhanders34", "createdAt": "2020-08-19T11:57:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzOTUwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAyNDE2OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r473024168", "bodyText": "Adding things to the requiredLibs dependency configuration means they get packaged in the autoFVT zip lib directory so that they're on the classpath when your test runs.\nhttps://github.com/OpenLiberty/open-liberty/wiki/FAT-tests#adding-libraries-to-the-fat-classpath", "author": "Azquelt", "createdAt": "2020-08-19T13:21:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzOTUwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE1NzA5Nw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r474157097", "bodyText": "Will work on this early next week", "author": "jhanders34", "createdAt": "2020-08-20T17:32:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzOTUwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTkwMjEyMQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r475902121", "bodyText": "I put in a change to resolve this issue.  It is part of commit 1 and commit 3", "author": "jhanders34", "createdAt": "2020-08-24T21:22:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzOTUwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM2Njg4MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r477366880", "bodyText": "I think this problem has been solved, but also see my new comment below: #13265 (comment)", "author": "Azquelt", "createdAt": "2020-08-26T14:56:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzOTUwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk0MDIyNA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472940224", "bodyText": "Comments to explain what this is doing and why it's needed would be helpful.\nPossibly some of it could be refactored into separate methods to make it more readable.", "author": "Azquelt", "createdAt": "2020-08-19T10:53:35Z", "path": "dev/wlp-gradle/subprojects/assemble.gradle", "diffHunk": "@@ -24,39 +24,68 @@ task publishWLPJars(type: Copy) {\n     from project.buildDir\n     into buildImage.file('wlp/' + bnd('publish.wlp.jar.suffix', 'lib'))\n     include bnd('publish.wlp.jar.include', '*.jar')\n+    def hasIFIXHeaders = [:]\n+    def fullVersions = [:]\n     if (parseBoolean(bnd('publish.wlp.jar.rename', 'true'))) {\n+        def outerSymbolicName = bnd('Bundle-SymbolicName', project.name)\n+        if (outerSymbolicName != null) {\n+            int index = outerSymbolicName.indexOf(\";\")\n+            if (index != -1) {\n+                outerSymbolicName = outerSymbolicName.substring(0, index).trim()\n+            }\n+        }\n+        def outerVersion = bnd('bVersion')\n+        def outerFullVersion = bnd('bFullVersion')\n+        fullVersions.put(outerSymbolicName, outerFullVersion)\n+\n         // iFixed jars should get renamed with a qualifier so they can exist in the filesystem\n         // next to the base version of the jar, *except* for jars that are directly\n         // referenced in a tool script's classpath...\n-        if (((bnd('IBM-Interim-Fixes', '').empty) && (bnd('IBM-Test-Fixes', '').empty))\n-                || (project.name.equals(\"com.ibm.ws.kernel.boot\"))\n-                || (project.name.equals(\"com.ibm.ws.kernel.boot.archive\"))\n-                || (project.name.equals(\"com.ibm.ws.appclient.boot\"))\n-                || (project.name.equals(\"com.ibm.ws.kernel.boot.cmdline\"))) {\n-            rename '(.*).jar', '$1' + \"_${bnd.bFullVersion}.jar\"\n+        if (((!bnd('IBM-Interim-Fixes', '').empty) || (!bnd('IBM-Test-Fixes', '').empty))\n+                && (!project.name.equals(\"com.ibm.ws.kernel.boot\"))\n+                && (!project.name.equals(\"com.ibm.ws.kernel.boot.archive\"))\n+                && (!project.name.equals(\"com.ibm.ws.appclient.boot\"))\n+                && (!project.name.equals(\"com.ibm.ws.kernel.boot.cmdline\"))) {\n+            hasIFIXHeaders.put(outerSymbolicName, true)\n         }\n-        else {\n-            rename '(.*).jar', '$1' + \"_${bnd.bFullVersion}.${qualifier}.jar\"\n-        }\n-    }\n-    if (!bnd('-sub', '').empty) {\n-        def hasIFIXHeaders = [:]\n-        fileTree(dir: projectDir, include: bnd('-sub', '')).each { subBndFile ->\n-            Properties subBndProperties = new Properties()\n-            subBndFile.withInputStream { subBndProperties.load(it) }\n-            if (subBndProperties.getProperty(\"IBM-Interim-Fixes\") != null\n-                    || subBndProperties.getProperty(\"IBM-Test-Fixes\") != null) {\n-                hasIFIXHeaders.put(subBndProperties.getProperty(\"Bundle-SymbolicName\"), true)\n+\n+        if (!bnd('-sub', '').empty) {\n+            fileTree(dir: projectDir, include: bnd('-sub', '')).each { subBndFile ->\n+                Properties subBndProperties = new Properties()\n+                subBndFile.withInputStream { subBndProperties.load(it) }\n+                def symbolicName = subBndProperties.getProperty(\"Bundle-SymbolicName\")\n+                if (symbolicName != null) {\n+                    int index = symbolicName.indexOf(\";\")\n+                    if (index != -1) {\n+                        symbolicName = symbolicName.substring(0, index).trim()\n+                    }\n+\n+                    if (subBndProperties.getProperty(\"IBM-Interim-Fixes\") != null\n+                        || subBndProperties.getProperty(\"IBM-Test-Fixes\") != null) {\n+                        hasIFIXHeaders.put(symbolicName, true)\n+                    }\n+\n+                    def subBVersion = subBndProperties.getProperty('bVersion')\n+                    if (outerVersion.equals(subBVersion)) {\n+                        fullVersions.put(symbolicName, outerFullVersion)\n+                    } else {\n+                        fullVersions.put(symbolicName, subBVersion + outerFullVersion.substring(outerVersion.length()))\n+                    }\n+                }", "originalCommit": "10b80ed348257850206ce0c17585ce7380aeea23", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk3NzAyMA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r472977020", "bodyText": "I will add comments.  Refactoring into separate methods may not be as feasible.  It is mainly a swizzle of existing logic though.", "author": "jhanders34", "createdAt": "2020-08-19T12:04:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk0MDIyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE1NjgyOA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r474156828", "bodyText": "Comments have been added", "author": "jhanders34", "createdAt": "2020-08-20T17:31:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk0MDIyNA=="}], "type": "inlineReview"}, {"oid": "ea297882ea63c33c40f050236aaf433cc3f844b4", "url": "https://github.com/OpenLiberty/open-liberty/commit/ea297882ea63c33c40f050236aaf433cc3f844b4", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-20T17:26:21Z", "type": "forcePushed"}, {"oid": "0e5dd7e8265d0b87c6c0d45bbc3bebac62654cb6", "url": "https://github.com/OpenLiberty/open-liberty/commit/0e5dd7e8265d0b87c6c0d45bbc3bebac62654cb6", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-20T21:57:44Z", "type": "forcePushed"}, {"oid": "3b75798e40ceb61a452cc444f6f9d04f1e2b5873", "url": "https://github.com/OpenLiberty/open-liberty/commit/3b75798e40ceb61a452cc444f6f9d04f1e2b5873", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-24T20:32:21Z", "type": "forcePushed"}, {"oid": "02920e996f44d0494287560f2922a1e52e0b8403", "url": "https://github.com/OpenLiberty/open-liberty/commit/02920e996f44d0494287560f2922a1e52e0b8403", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-25T15:44:23Z", "type": "forcePushed"}, {"oid": "28ebfaec37a2dc3a04cc7a8b5a5bdc37d4bedaac", "url": "https://github.com/OpenLiberty/open-liberty/commit/28ebfaec37a2dc3a04cc7a8b5a5bdc37d4bedaac", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-25T15:50:39Z", "type": "forcePushed"}, {"oid": "cf1134b6528ed86fb4d8fddbf5621d6e5a3b865b", "url": "https://github.com/OpenLiberty/open-liberty/commit/cf1134b6528ed86fb4d8fddbf5621d6e5a3b865b", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-25T18:33:49Z", "type": "forcePushed"}, {"oid": "a1246eb7f74086fad01ddfa740067746d9e1c95c", "url": "https://github.com/OpenLiberty/open-liberty/commit/a1246eb7f74086fad01ddfa740067746d9e1c95c", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-26T14:15:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM2NjA3MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r477366070", "bodyText": "I can see that this is solving the problem of exposing the sub-bundles to fat tests which want to depend on them.\nHowever, it looks a little at odds with what's in the Gradle user guide here: https://docs.gradle.org/current/userguide/declaring_dependencies.html#sec:resolvable-consumable-configs\nThe user guide suggests:\n\ncanBeResolved and canBeConsumed both default to true.\nfor a configuration exposed to other projects as a dependency, you want canBeResolved = false and canBeConsumed = true\n\nI'm not necessarily saying this is wrong, since I'm not familiar enough with gradle (and I wouldn't be surprised if we were doing something a bit weird), but thought it worth mentioning that it looks different to what the user guide suggests.", "author": "Azquelt", "createdAt": "2020-08-26T14:55:35Z", "path": "dev/com.ibm.websphere.org.eclipse.microprofile/build.gradle", "diffHunk": "@@ -0,0 +1,39 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+configurations {\n+  config11 {\n+    canBeResolved = true\n+  }\n+  config121 {\n+    canBeResolved = true\n+  }\n+  config13 {\n+    canBeResolved = true\n+  }\n+  config14 {\n+    canBeResolved = true\n+  }\n+  ft10 {\n+    canBeResolved = true\n+  }\n+  ft11 {\n+    canBeResolved = true\n+  }\n+}\n+\n+artifacts {\n+  config11(file('build/libs/com.ibm.websphere.org.eclipse.microprofile.config.1.1.jar'))\n+  config121(file('build/libs/com.ibm.websphere.org.eclipse.microprofile.config.1.2.1.jar'))\n+  config13(file('build/libs/com.ibm.websphere.org.eclipse.microprofile.config.1.3.jar'))\n+  config14(file('build/libs/com.ibm.websphere.org.eclipse.microprofile.config.1.4.jar'))\n+  ft10(file('build/libs/com.ibm.websphere.org.eclipse.microprofile.faulttolerance.1.0.jar'))\n+  ft11(file('build/libs/com.ibm.websphere.org.eclipse.microprofile.faulttolerance.1.1.jar'))\n+}", "originalCommit": "a1246eb7f74086fad01ddfa740067746d9e1c95c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM3MDY3NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r477370675", "bodyText": "Yes I struggled some with what to set them to.  I will say it is working the way that I have it configured.  Tests are getting just the bundle they are after.  I have asked @fritze2 to take another look at the PR in light of these new gradle file changes to get his feedback since he has a lot more experience with using gradle.", "author": "jhanders34", "createdAt": "2020-08-26T15:01:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM2NjA3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM3MTgzNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r477371835", "bodyText": "Yes, I'd expect it to work since canBeConsumed will default to true.", "author": "Azquelt", "createdAt": "2020-08-26T15:03:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM2NjA3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQzOTA2MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r477439061", "bodyText": "I read through what you pointed to in the guide and updated it to consume = true and resolve = false based off of my reading.  I ran one of the FATs with the change and it worked just fine.  With consume = false it failed miserably, but resolve = false looks to be what we want from reading through things.  The PR commit 1 is updated with the change.", "author": "jhanders34", "createdAt": "2020-08-26T16:40:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM2NjA3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0MjMzMw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/13265#discussion_r477442333", "bodyText": "Looks good, thanks.", "author": "Azquelt", "createdAt": "2020-08-26T16:45:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM2NjA3MA=="}], "type": "inlineReview"}, {"oid": "79531dea4e46849f015b1434978847c16176033f", "url": "https://github.com/OpenLiberty/open-liberty/commit/79531dea4e46849f015b1434978847c16176033f", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-26T16:08:05Z", "type": "forcePushed"}, {"oid": "ef1d276ca8903c47bf1f6f76c797f9f71eed2ed9", "url": "https://github.com/OpenLiberty/open-liberty/commit/ef1d276ca8903c47bf1f6f76c797f9f71eed2ed9", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-26T16:25:39Z", "type": "forcePushed"}, {"oid": "234be0bd858c25d3d72aef65efcf8ae233713082", "url": "https://github.com/OpenLiberty/open-liberty/commit/234be0bd858c25d3d72aef65efcf8ae233713082", "message": "Move MP API projects to a single component\n\n- Move MP API project bnd files that don't have source code in OL GH to\nnew com.ibm.websphere.org.eclipse.microprofile project", "committedDate": "2020-08-26T16:38:24Z", "type": "commit"}, {"oid": "19629e8ee1f72ae1445f6aea0a7c051fd5973982", "url": "https://github.com/OpenLiberty/open-liberty/commit/19629e8ee1f72ae1445f6aea0a7c051fd5973982", "message": "Cleanup MP API components\n\n- Delete the components' whose bnd files were moved to the new project.\n- Remove properties and META-INF directories in these projects that were\nunused as well.", "committedDate": "2020-08-26T16:38:26Z", "type": "commit"}, {"oid": "081de06c3282088a95a7c8ab0f631572e3627d95", "url": "https://github.com/OpenLiberty/open-liberty/commit/081de06c3282088a95a7c8ab0f631572e3627d95", "message": "Move io.openliberty MP API projects to a single project\n\n- Move bnd files from individual spec levels for io.openliberty projects\nto the parent project like did with\ncom.ibm.websphere.org.eclipse.microprofile MP API projects.", "committedDate": "2020-08-26T16:38:27Z", "type": "commit"}, {"oid": "94fe20a9c48c89afbca0fb5cd9c44f467a6f555b", "url": "https://github.com/OpenLiberty/open-liberty/commit/94fe20a9c48c89afbca0fb5cd9c44f467a6f555b", "message": "Clean up eclipse files from io.openliberty MP API projects", "committedDate": "2020-08-26T16:38:29Z", "type": "commit"}, {"oid": "cee3b676e67d4b9b33fbe2ac7f3428cc45814b30", "url": "https://github.com/OpenLiberty/open-liberty/commit/cee3b676e67d4b9b33fbe2ac7f3428cc45814b30", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-26T16:38:30Z", "type": "commit"}, {"oid": "cee3b676e67d4b9b33fbe2ac7f3428cc45814b30", "url": "https://github.com/OpenLiberty/open-liberty/commit/cee3b676e67d4b9b33fbe2ac7f3428cc45814b30", "message": "Move contextpropagation 1.1 bundle to io.openliberty", "committedDate": "2020-08-26T16:38:30Z", "type": "forcePushed"}]}