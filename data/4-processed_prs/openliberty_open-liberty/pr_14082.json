{"pr_number": 14082, "pr_title": "EJBBindings Server.xml bindings test", "pr_createdAt": "2020-09-22T15:17:04Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/14082", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAzNTU0OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14082#discussion_r493035548", "bodyText": "I hate to be that guy, but could this file be reformatted with a uniform indentation scheme?  I normally wouldn't necessarily protest about it, but since this test is actually about the server.xml file we should make sure it's easy to read.", "author": "brideck", "createdAt": "2020-09-22T21:10:10Z", "path": "dev/com.ibm.ws.ejbcontainer.bindings_fat/publish/servers/com.ibm.ws.ejbcontainer.bindings.fat.serverxml.testserver/server.xml", "diffHunk": "@@ -0,0 +1,53 @@\n+<server>\n+    <featureManager>\n+        <feature>servlet-3.1</feature>\n+        <feature>ejbRemote-3.2</feature>\n+        <feature>ejbHome-3.2</feature>\n+\t\t<feature>componenttest-1.0</feature>\n+    </featureManager>\n+    \n+    <include location=\"../fatTestPorts.xml\"/>\n+\n+    <iiopEndpoint id=\"defaultIiopEndpoint\" iiopPort=\"${bvt.prop.IIOP}\" iiopsPort=\"${bvt.prop.IIOP.secure}\"/>\n+    \n+    <ejbContainer bindToServerRoot=\"true\"/>\n+    \n+    <application location=\"ServerXMLTestApp.ear\">\n+    \n+    \t<ejb-jar-bnd moduleName=\"BindingNameEJB\">\n+    \t\t<session name=\"BindingName5\">\n+    \t\t\t<interface class=\"com.ibm.ejb3x.BindingName.ejb.BindingNameIntf\" binding-name=\"ejblocal:ejb/ServerXMLBindingNameIntf5\"/>\n+  \t\t\t\t<interface class=\"com.ibm.ejb3x.BindingName.ejb.RemoteBindingNameIntf\" binding-name=\"ejb/ServerXMLBindingNameIntf5\"/>", "originalCommit": "4012b615d2654f4d648433e74bf1363c0f46a350", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA2MjY2OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14082#discussion_r493062669", "bodyText": "Being that guy is ok, fixed it.", "author": "olendvcook", "createdAt": "2020-09-22T22:11:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAzNTU0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAzNzQ3Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14082#discussion_r493037476", "bodyText": "There's some errant copy/paste issues with the assertion text here and with remote-home-binding below.  Also, is there any particular reason that you're not just using assertNotNull for all of these test points?", "author": "brideck", "createdAt": "2020-09-22T21:14:10Z", "path": "dev/com.ibm.ws.ejbcontainer.bindings_fat/test-applications/ServerXMLBindingsWeb.war/src/com/ibm/ws/ejbcontainer/bindings/serverxml/bnd/web/ServerXMLBindingsTestServlet.java", "diffHunk": "@@ -0,0 +1,144 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n+package com.ibm.ws.ejbcontainer.bindings.serverxml.bnd.web;\n+\n+import static org.junit.Assert.fail;\n+\n+import javax.naming.InitialContext;\n+import javax.rmi.PortableRemoteObject;\n+import javax.servlet.annotation.WebServlet;\n+\n+import com.ibm.ejb3x.BindingName.ejb.BindingNameIntf;\n+import com.ibm.ejb3x.BindingName.ejb.RemoteBindingNameIntf;\n+import com.ibm.ejb3x.ComponentIDBnd.ejb.ComponentIDBnd;\n+import com.ibm.ejb3x.ComponentIDBnd.ejb.ComponentIDBndHome;\n+import com.ibm.ejb3x.HomeBindingName.ejb.LocalHomeBindingName;\n+import com.ibm.ejb3x.HomeBindingName.ejb.LocalHomeBindingNameHome;\n+import com.ibm.ejb3x.HomeBindingName.ejb.RemoteHomeBindingName;\n+import com.ibm.ejb3x.HomeBindingName.ejb.RemoteHomeBindingNameHome;\n+import com.ibm.ejb3x.SimpleBindingName.ejb.SimpleBindingName;\n+import com.ibm.ejb3x.SimpleBindingName.ejb.SimpleBindingNameHome;\n+\n+import componenttest.app.FATServlet;\n+\n+/**\n+ */\n+@SuppressWarnings(\"serial\")\n+@WebServlet(\"/ServerXMLBindingsTestServlet\")\n+public class ServerXMLBindingsTestServlet extends FATServlet {\n+\n+    public void lookupServerXMLBindings() throws Exception {\n+        InitialContext ctx = new InitialContext();\n+\n+        // Component-id\n+        ComponentIDBndHome compIDbeanHome = (ComponentIDBndHome) ctx.lookup(\"ejblocal:ejb/ServerXMLMyEJB1#com.ibm.ejb3x.ComponentIDBnd.ejb.ComponentIDBndHome\");\n+        if (compIDbeanHome == null) {\n+            fail(\"lookup component-id was null\");\n+        }\n+        ComponentIDBnd compIDbean = compIDbeanHome.create();\n+        if (compIDbean == null) {\n+            fail(\"home.create() component-id was null\");\n+        }\n+        System.out.println(\"Got bean, calling method\");\n+        if (compIDbean.foo() == null) {\n+            fail(\"bean.method() for component-id was null\");\n+        }\n+\n+        // local-home-binding\n+        LocalHomeBindingNameHome LHBbeanHome = (LocalHomeBindingNameHome) ctx.lookup(\"ejblocal:com/ibm/ejb3x/HomeBindingName/ejb/ServerXMLHomeBindingNameHome1\");\n+        if (LHBbeanHome == null) {\n+            fail(\"lookup local-home-binding was null\");\n+        }\n+        LocalHomeBindingName LHBbean = LHBbeanHome.create();\n+        if (LHBbean == null) {\n+            fail(\"home.create() for local-home-binding was null\");\n+        }\n+        if (LHBbean.foo() == null) {\n+            fail(\"bean.method() for local-home-binding was null\");\n+        }\n+\n+        // remote-home-binding\n+        Object RHBlookup = ctx.lookup(\"com/ibm/ejb3x/HomeBindingName/ejb/ServerXMLHomeBindingNameHome3\");\n+        RemoteHomeBindingNameHome RHBbeanHome = (RemoteHomeBindingNameHome) PortableRemoteObject.narrow(RHBlookup, RemoteHomeBindingNameHome.class);\n+        if (RHBbeanHome == null) {\n+            fail(\"lookup for remote-home-binding was null\");\n+        }\n+        RemoteHomeBindingName RHBbean = RHBbeanHome.create();\n+        if (RHBbean == null) {\n+            fail(\"lookup for remote-home-binding was null\");\n+        }\n+        if (RHBbean.foo() == null) {\n+            fail(\"lookup for remote-home-binding was null\");\n+        }\n+\n+        // simple-binding-name\n+        SimpleBindingNameHome SBNbeanHome = (SimpleBindingNameHome) ctx.lookup(\"ejblocal:com/ibm/ejb3x/SimpleBindingName/ejb/ServerXMLSimpleBindingNameHome1\");\n+        if (SBNbeanHome == null) {\n+            fail(\"lookup for simple-binding-name was null\");\n+        }\n+        SimpleBindingName SBNbean = SBNbeanHome.create();\n+        if (SBNbean == null) {\n+            fail(\"lookup for simple-binding-name was null\");", "originalCommit": "4012b615d2654f4d648433e74bf1363c0f46a350", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA2MzQxNA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14082#discussion_r493063414", "bodyText": "I copy pasted those from another test where the message was very long so it was more readable with the if statements, but since I cut the message down assertNotNull does make more sense, changed it.", "author": "olendvcook", "createdAt": "2020-09-22T22:13:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzAzNzQ3Ng=="}], "type": "inlineReview"}, {"oid": "6d49001b630c3c8422fdee5099ecd6df65877376", "url": "https://github.com/OpenLiberty/open-liberty/commit/6d49001b630c3c8422fdee5099ecd6df65877376", "message": "EJBBindings Server.xml bindings test", "committedDate": "2020-09-22T22:08:23Z", "type": "forcePushed"}, {"oid": "24df40ce4197c153005c547eefe6b2705a7f2956", "url": "https://github.com/OpenLiberty/open-liberty/commit/24df40ce4197c153005c547eefe6b2705a7f2956", "message": "EJBBindings Server.xml bindings test", "committedDate": "2020-09-22T22:10:26Z", "type": "forcePushed"}, {"oid": "1ef46bcd9b4b30b566918fe12655b62de9b235bb", "url": "https://github.com/OpenLiberty/open-liberty/commit/1ef46bcd9b4b30b566918fe12655b62de9b235bb", "message": "EJBBindings Server.xml bindings test", "committedDate": "2020-09-24T14:24:35Z", "type": "forcePushed"}, {"oid": "d35d4baabaed16a51dc816412851f1293b320c74", "url": "https://github.com/OpenLiberty/open-liberty/commit/d35d4baabaed16a51dc816412851f1293b320c74", "message": "EJBBindings Server.xml bindings test", "committedDate": "2020-09-25T20:41:58Z", "type": "commit"}, {"oid": "d35d4baabaed16a51dc816412851f1293b320c74", "url": "https://github.com/OpenLiberty/open-liberty/commit/d35d4baabaed16a51dc816412851f1293b320c74", "message": "EJBBindings Server.xml bindings test", "committedDate": "2020-09-25T20:41:58Z", "type": "forcePushed"}]}