{"pr_number": 10497, "pr_title": "Initial commit:adding decompression ratio support", "pr_createdAt": "2020-01-20T21:20:48Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/10497", "timeline": [{"oid": "8243dd1998028b405ef459c5a0db901eeee44bf1", "url": "https://github.com/OpenLiberty/open-liberty/commit/8243dd1998028b405ef459c5a0db901eeee44bf1", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-22T18:33:16Z", "type": "forcePushed"}, {"oid": "01549bc04ebc2dd0195006c9d2932a9ff81a0d7f", "url": "https://github.com/OpenLiberty/open-liberty/commit/01549bc04ebc2dd0195006c9d2932a9ff81a0d7f", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-22T18:43:44Z", "type": "forcePushed"}, {"oid": "43d557aec0cee7614a6ea5146ad146e874b57b32", "url": "https://github.com/OpenLiberty/open-liberty/commit/43d557aec0cee7614a6ea5146ad146e874b57b32", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-22T23:47:07Z", "type": "forcePushed"}, {"oid": "26ac756130621f554787a2cf8a991aff7854eb0f", "url": "https://github.com/OpenLiberty/open-liberty/commit/26ac756130621f554787a2cf8a991aff7854eb0f", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-22T23:48:34Z", "type": "forcePushed"}, {"oid": "81510bee6c30de204f3e4f79c1e3896dbf7c2193", "url": "https://github.com/OpenLiberty/open-liberty/commit/81510bee6c30de204f3e4f79c1e3896dbf7c2193", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-22T23:57:37Z", "type": "forcePushed"}, {"oid": "2b1313e1e9b148c07dd321a278a6e07659339cd7", "url": "https://github.com/OpenLiberty/open-liberty/commit/2b1313e1e9b148c07dd321a278a6e07659339cd7", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-23T19:46:16Z", "type": "forcePushed"}, {"oid": "2a29d418d6e0e9cdafc0be6189e272e33896a0a9", "url": "https://github.com/OpenLiberty/open-liberty/commit/2a29d418d6e0e9cdafc0be6189e272e33896a0a9", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-23T20:08:02Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzNDI0Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370334246", "bodyText": "Change,\n\"Specifies the maximum ratio of decompressed to compressed request body payload. This ratio is verified as the body is read by the HTTP channel, and if the decompressionTolerance is reached, the request is ended.\"\nto,\n\"Specifies the maximum ratio of decompressed to compressed request body payload. The HTTP channel reads the request body and verifies the ratio as the body decompresses. The channel stops decompression of the request body if the decompression ratio remains above the configured value and the decompressionTolerance attribute is reached.\"", "author": "ManasiGandhi", "createdAt": "2020-01-23T20:19:39Z", "path": "dev/com.ibm.ws.transport.http/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -206,6 +206,12 @@ http.proxyredirect.httpsPort.desc=The (secure) port to redirect to. Incoming HTT\n http.autoDecompression=Auto decompression\n http.autoDecompression.desc=Specifies whether the HTTP Channel automatically decompresses incoming request body data.\n \n+http.decompressionRatioLimit=Decompression ratio limit\n+http.decompressionRatioLimit.desc=Specifies the maximum ratio of decompressed to compressed request body payload. This ratio is verified as the body is read by the HTTP channel, and if the decompressionTolerance is reached, the request is ended.", "originalCommit": "2a29d418d6e0e9cdafc0be6189e272e33896a0a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM1NzE5Nw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370357197", "bodyText": "I think we should define the decompressionTolerance,\nThe request ends if the maximum number of times the HTTP channel reach this ratio sepcified by decompressionTolerance", "author": "anupag", "createdAt": "2020-01-23T21:13:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzNDI0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2NTk4OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370365988", "bodyText": "Made the changes above.", "author": "ManasiGandhi", "createdAt": "2020-01-23T21:33:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzNDI0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzNTA3OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370335079", "bodyText": "Change,\n\"Specifies the maximum number of times the HTTP channel can hit the decompressionRatioLimit as the request body is decompressed before the request is ended.\"\nto\n\"Specifies the maximum number of times the HTTP channel tolerates a decompression ratio above the configured ratio, depicted by the decompressionRatioLimit httpOption attribute.  If this number reaches, and the next decompression cycle still contains a decompression ratio above the ratio limit, then the HTTP channel stops decompressing the request body.\"", "author": "ManasiGandhi", "createdAt": "2020-01-23T20:21:35Z", "path": "dev/com.ibm.ws.transport.http/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -206,6 +206,12 @@ http.proxyredirect.httpsPort.desc=The (secure) port to redirect to. Incoming HTT\n http.autoDecompression=Auto decompression\n http.autoDecompression.desc=Specifies whether the HTTP Channel automatically decompresses incoming request body data.\n \n+http.decompressionRatioLimit=Decompression ratio limit\n+http.decompressionRatioLimit.desc=Specifies the maximum ratio of decompressed to compressed request body payload. This ratio is verified as the body is read by the HTTP channel, and if the decompressionTolerance is reached, the request is ended.\n+\n+http.decompressionTolerance=Decompression tolerance\n+http.decompressionTolerance.desc=Specifies the maximum number of times the HTTP channel can hit the decompressionRatioLimit as the request body is decompressed before the request is ended.", "originalCommit": "2a29d418d6e0e9cdafc0be6189e272e33896a0a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM1NzM3MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370357370", "bodyText": "same here explain decompressionRatioLimit", "author": "anupag", "createdAt": "2020-01-23T21:13:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzNTA3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2Nzg4NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370367884", "bodyText": "Updated the comment above.", "author": "ManasiGandhi", "createdAt": "2020-01-23T21:36:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDMzNTA3OQ=="}], "type": "inlineReview"}, {"oid": "6cab964e88b51e44fd8f3e6061e25a0ec39f1a1a", "url": "https://github.com/OpenLiberty/open-liberty/commit/6cab964e88b51e44fd8f3e6061e25a0ec39f1a1a", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-23T21:04:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0NDk2NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370344965", "bodyText": "Change,\n\" When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.\"\nto,\n\"When you define the value, ensure to set it to gzip, x-gzip, deflate, zlib, identity, or none.\"", "author": "ManasiGandhi", "createdAt": "2020-01-23T20:45:12Z", "path": "dev/com.ibm.ws.transport.http/resources/com/ibm/ws/http/channel/internal/resources/httpchannelmessages.nlsprops", "diffHunk": "@@ -160,4 +160,8 @@ compression.duplicateOverwriteAndAdd.useraction=If the default configuration mus\n \n compression.unsupportedAlgorithm=CWWKT0033W: An attempt was made to configure {0} as the server-preferred algorithm. The supported values are gzip, x-gzip, zlib, deflate, identity, and none. The default configuration {1} is used instead.\n compression.unsupportedAlgorithm.explanation=The configuration is attempting to set an unsupported algorithm as the server-preferred algorithm to use for compression. \n-compression.unsupportedAlgorithm.useraction= When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.\n\\ No newline at end of file\n+compression.unsupportedAlgorithm.useraction= When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.", "originalCommit": "2a29d418d6e0e9cdafc0be6189e272e33896a0a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDczMjUzOA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370732538", "bodyText": "This is not part of change being added, message is already out for this one.", "author": "mrsaldana", "createdAt": "2020-01-24T16:46:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM0NDk2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2MjkzMw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370362933", "bodyText": "Change,\n\"Attempted to decompress a body with a ratio larger than tolerated.\"\nto,\n\"The HTTP channel attempted to decompress a body with a larger than tolerated ratio.\"", "author": "ManasiGandhi", "createdAt": "2020-01-23T21:26:22Z", "path": "dev/com.ibm.ws.transport.http/resources/com/ibm/ws/http/channel/internal/resources/httpchannelmessages.nlsprops", "diffHunk": "@@ -160,4 +160,8 @@ compression.duplicateOverwriteAndAdd.useraction=If the default configuration mus\n \n compression.unsupportedAlgorithm=CWWKT0033W: An attempt was made to configure {0} as the server-preferred algorithm. The supported values are gzip, x-gzip, zlib, deflate, identity, and none. The default configuration {1} is used instead.\n compression.unsupportedAlgorithm.explanation=The configuration is attempting to set an unsupported algorithm as the server-preferred algorithm to use for compression. \n-compression.unsupportedAlgorithm.useraction= When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.\n\\ No newline at end of file\n+compression.unsupportedAlgorithm.useraction= When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.\n+\n+decompression.tolerance.reached=CWWKT0034E: Attempted to decompress a body with a ratio larger than tolerated.", "originalCommit": "6cab964e88b51e44fd8f3e6061e25a0ec39f1a1a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2MzU1MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370363551", "bodyText": "Change,\n\"The amount of tolerated decompression cycles, defined by the 'decompressionTolerance' httpOption attribute, which resulted in a decompression ratio larger than the configured limit, has been reached. The decompression limit is defined by the 'decompressionRatioLimit' httpOption attribute.\"\nto,\n\"\"The maximum number of decompression cycles resulting in a decompression ratio larger than the configured limit has been reached. The decompression limit is defined by the 'decompressionRatioLimit' httpOption attribute.\"", "author": "ManasiGandhi", "createdAt": "2020-01-23T21:27:39Z", "path": "dev/com.ibm.ws.transport.http/resources/com/ibm/ws/http/channel/internal/resources/httpchannelmessages.nlsprops", "diffHunk": "@@ -160,4 +160,8 @@ compression.duplicateOverwriteAndAdd.useraction=If the default configuration mus\n \n compression.unsupportedAlgorithm=CWWKT0033W: An attempt was made to configure {0} as the server-preferred algorithm. The supported values are gzip, x-gzip, zlib, deflate, identity, and none. The default configuration {1} is used instead.\n compression.unsupportedAlgorithm.explanation=The configuration is attempting to set an unsupported algorithm as the server-preferred algorithm to use for compression. \n-compression.unsupportedAlgorithm.useraction= When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.\n\\ No newline at end of file\n+compression.unsupportedAlgorithm.useraction= When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.\n+\n+decompression.tolerance.reached=CWWKT0034E: Attempted to decompress a body with a ratio larger than tolerated.\n+decompression.tolerance.reached.explanation=The amount of tolerated decompression cycles, defined by the 'decompressionTolerance' httpOption attribute, which resulted in a decompression ratio larger than the configured limit, has been reached. The decompression limit is defined by the 'decompressionRatioLimit' httpOption attribute.", "originalCommit": "6cab964e88b51e44fd8f3e6061e25a0ec39f1a1a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDczNzIxMQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370737211", "bodyText": "Can we word this as, \"The maximum number of decompression cycles resulting in a decompression ratio larger than the configured limit has been reached. The decompression limit is defined by the 'decompressionRatioLimit' httpOption attribute. The tolerated amount of cycles above the decompression ratio is defined by the 'decompressionTolerance' httpOption attribute\" ?", "author": "mrsaldana", "createdAt": "2020-01-24T16:55:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2MzU1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2Mzg0Ng==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10497#discussion_r370363846", "bodyText": "Change,\n\"When this exception happens on a request body that is considered valid, consider reconfiguring the 'decompressionTolerance' and 'decompressionRatioLimit' httpOption attributes to achieve the desired decompression results.\"\nto,\n\"When this exception happens on a valid request body, reconfigure the 'decompressionTolerance' and 'decompressionRatioLimit' httpOption attributes to achieve the appropriate decompression results.\"", "author": "ManasiGandhi", "createdAt": "2020-01-23T21:28:22Z", "path": "dev/com.ibm.ws.transport.http/resources/com/ibm/ws/http/channel/internal/resources/httpchannelmessages.nlsprops", "diffHunk": "@@ -160,4 +160,8 @@ compression.duplicateOverwriteAndAdd.useraction=If the default configuration mus\n \n compression.unsupportedAlgorithm=CWWKT0033W: An attempt was made to configure {0} as the server-preferred algorithm. The supported values are gzip, x-gzip, zlib, deflate, identity, and none. The default configuration {1} is used instead.\n compression.unsupportedAlgorithm.explanation=The configuration is attempting to set an unsupported algorithm as the server-preferred algorithm to use for compression. \n-compression.unsupportedAlgorithm.useraction= When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.\n\\ No newline at end of file\n+compression.unsupportedAlgorithm.useraction= When defining the value, ensure that it is set to gzip, x-gzip, deflate, zlib, identity, or none.\n+\n+decompression.tolerance.reached=CWWKT0034E: Attempted to decompress a body with a ratio larger than tolerated.\n+decompression.tolerance.reached.explanation=The amount of tolerated decompression cycles, defined by the 'decompressionTolerance' httpOption attribute, which resulted in a decompression ratio larger than the configured limit, has been reached. The decompression limit is defined by the 'decompressionRatioLimit' httpOption attribute.\n+decompression.tolerance.reached.useraction=When this exception happens on a request body that is considered valid, consider reconfiguring the 'decompressionTolerance' and 'decompressionRatioLimit' httpOption attributes to achieve the desired decompression results.", "originalCommit": "6cab964e88b51e44fd8f3e6061e25a0ec39f1a1a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e30598eebf4f0ffa243684b3a8cf799ff735bd6a", "url": "https://github.com/OpenLiberty/open-liberty/commit/e30598eebf4f0ffa243684b3a8cf799ff735bd6a", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-23T21:28:37Z", "type": "commit"}, {"oid": "e30598eebf4f0ffa243684b3a8cf799ff735bd6a", "url": "https://github.com/OpenLiberty/open-liberty/commit/e30598eebf4f0ffa243684b3a8cf799ff735bd6a", "message": "Initial commit:adding decompression ratio support", "committedDate": "2020-01-23T21:28:37Z", "type": "forcePushed"}, {"oid": "6cda9e635ae23d3e6182d8e60ef0528f5b2b7fb4", "url": "https://github.com/OpenLiberty/open-liberty/commit/6cda9e635ae23d3e6182d8e60ef0528f5b2b7fb4", "message": "Adding ID review changes", "committedDate": "2020-02-03T01:41:40Z", "type": "commit"}, {"oid": "6cda9e635ae23d3e6182d8e60ef0528f5b2b7fb4", "url": "https://github.com/OpenLiberty/open-liberty/commit/6cda9e635ae23d3e6182d8e60ef0528f5b2b7fb4", "message": "Adding ID review changes", "committedDate": "2020-02-03T01:41:40Z", "type": "forcePushed"}]}