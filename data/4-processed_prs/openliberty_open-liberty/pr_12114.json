{"pr_number": 12114, "pr_title": "Issues #11673, #11247, #11245: Add retry until logic in AcmeClient or\u2026", "pr_createdAt": "2020-05-08T18:28:25Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/12114", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExNDQ0Mw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12114#discussion_r423114443", "bodyText": "Suggested update:\n\"The amount of time to spend polling the status of an ACME challenge before the challenge cancels.\"", "author": "Charlotte-Holt", "createdAt": "2020-05-11T15:14:55Z", "path": "dev/com.ibm.ws.security.acme/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -28,17 +28,11 @@ validFor.desc=The duration of time that the certificate signing request specifie\n subjectDN=Subject distinguished name\n subjectDN.desc=Subject distinguished name (DN) to use for the certificate. The DN can include the following relative distinguished name (RDN) types: cn, c, st, l, o and ou. If the cn RDN type is defined, it must be one of the domains defined by the domain configuration element and it must be the first RDN in the DN. If the cn RDN type is not defined, the first domain defined by the domain configuration element is used as the cn RDN value.\n \n-challengeRetries=Challenge retries\n-challengeRetries.desc=The number of times to retry updating the challenge status before aborting the challenge.\n+challengePollTimeout=Challenge poll timeout\n+challengePollTimeout.desc=The amount of time to spend polling the status of an ACME challenge before aborting.", "originalCommit": "f0052bba33464966980fd137334106f0b140c0e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIzMTE0NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12114#discussion_r423231145", "bodyText": "Talked to Charlotte on slack, we decided on the following:\nThe amount of time to spend polling the status of an ACME challenge before polling discontinues and treats the challenge as failed.", "author": "jvanhill", "createdAt": "2020-05-11T18:20:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExNDQ0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExNzE5MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12114#discussion_r423117191", "bodyText": "Suggested update:\n\"The amount of time to spend polling the status of an ACME order before the poll times out.\"", "author": "Charlotte-Holt", "createdAt": "2020-05-11T15:18:45Z", "path": "dev/com.ibm.ws.security.acme/resources/OSGI-INF/l10n/metatype.properties", "diffHunk": "@@ -28,17 +28,11 @@ validFor.desc=The duration of time that the certificate signing request specifie\n subjectDN=Subject distinguished name\n subjectDN.desc=Subject distinguished name (DN) to use for the certificate. The DN can include the following relative distinguished name (RDN) types: cn, c, st, l, o and ou. If the cn RDN type is defined, it must be one of the domains defined by the domain configuration element and it must be the first RDN in the DN. If the cn RDN type is not defined, the first domain defined by the domain configuration element is used as the cn RDN value.\n \n-challengeRetries=Challenge retries\n-challengeRetries.desc=The number of times to retry updating the challenge status before aborting the challenge.\n+challengePollTimeout=Challenge poll timeout\n+challengePollTimeout.desc=The amount of time to spend polling the status of an ACME challenge before aborting.\n \n-challengeRetryWait=Challenge retry wait\n-challengeRetryWait.desc=The amount of time to wait before retrying to refresh the status of a challenge.\n-\n-orderRetries=Order retries\n-orderRetries.desc=The number of times to retry updating the order status before aborting the order.\n-\n-orderRetryWait=Order retry wait\n-orderRetryWait.desc=The amount of time to wait before retrying to refresh the status of an order.\n+orderPollTimeout=Order poll timeout\n+orderPollTimeout.desc=The amount of time to spend polling the status of an ACME order before aborting.", "originalCommit": "f0052bba33464966980fd137334106f0b140c0e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIzMDkzNg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12114#discussion_r423230936", "bodyText": "Talked to Charlotte on slack, we decided on the following:\nThe amount of time to spend polling the status of an ACME order before polling discontinues and treats the order as failed.", "author": "jvanhill", "createdAt": "2020-05-11T18:20:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExNzE5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExODY1Mw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12114#discussion_r423118653", "bodyText": "Suggested update:\n\"The ACME certificate authority at the {0} URI updated its terms of service and now requires the user to agree to the new terms of service at the following URI before it processes any further requests: {1}\"", "author": "Charlotte-Holt", "createdAt": "2020-05-11T15:20:48Z", "path": "dev/com.ibm.ws.security.acme/resources/com/ibm/ws/security/acme/resources/AcmeMessages.nlsprops", "diffHunk": "@@ -285,3 +285,11 @@ CWPKI2061E.useraction=Ensure that the certificate is a valid X.509 certificate.\n CWPKI2062E=CWPKI2062E: The {0} OCSP responder URL defined in the server configuration is not a valid URI. If defined, it must be a valid URI to override the OSCP responder URL contained in the certificate.\n CWPKI2062E.explanation=Certificate revocation checking requires a valid OCSP responder URL.\n CWPKI2062E.useraction=Provide a valid OCSP responder URL in the server configuration.\n+\n+CWPKI2063E=CWPKI2063E: The ACME certificate authority at the {0} URI has updated its terms of service and now requires the user to agree to the new terms of service at the following URI before it will process any further requests: {1}", "originalCommit": "f0052bba33464966980fd137334106f0b140c0e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIyNDYxMw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12114#discussion_r423224613", "bodyText": "Agreed.", "author": "jvanhill", "createdAt": "2020-05-11T18:08:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExODY1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExOTI4MQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12114#discussion_r423119281", "bodyText": "Suggested update:\n\"The certificate authority updated its terms of service and requires user interaction.\"", "author": "Charlotte-Holt", "createdAt": "2020-05-11T15:21:39Z", "path": "dev/com.ibm.ws.security.acme/resources/com/ibm/ws/security/acme/resources/AcmeMessages.nlsprops", "diffHunk": "@@ -285,3 +285,11 @@ CWPKI2061E.useraction=Ensure that the certificate is a valid X.509 certificate.\n CWPKI2062E=CWPKI2062E: The {0} OCSP responder URL defined in the server configuration is not a valid URI. If defined, it must be a valid URI to override the OSCP responder URL contained in the certificate.\n CWPKI2062E.explanation=Certificate revocation checking requires a valid OCSP responder URL.\n CWPKI2062E.useraction=Provide a valid OCSP responder URL in the server configuration.\n+\n+CWPKI2063E=CWPKI2063E: The ACME certificate authority at the {0} URI has updated its terms of service and now requires the user to agree to the new terms of service at the following URI before it will process any further requests: {1}\n+CWPKI2063E.explanation=The certificate authority updated its terms of service and requires user interaction to agree.", "originalCommit": "f0052bba33464966980fd137334106f0b140c0e9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzIyNDkyMg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12114#discussion_r423224922", "bodyText": "Agreed.", "author": "jvanhill", "createdAt": "2020-05-11T18:09:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExOTI4MQ=="}], "type": "inlineReview"}, {"oid": "655fe503144463a977c14cbf2877a547d540898f", "url": "https://github.com/OpenLiberty/open-liberty/commit/655fe503144463a977c14cbf2877a547d540898f", "message": "Issues #11673, #11247, #11245: Add retry until logic in AcmeClient order and challenge processing. Add message to denote how long it took to retrieve the certificate from the ACME server. Add message when terms of service requires manual intervention.", "committedDate": "2020-05-11T18:19:29Z", "type": "forcePushed"}, {"oid": "c3a276b0141608be556f0c7867e8da060332217b", "url": "https://github.com/OpenLiberty/open-liberty/commit/c3a276b0141608be556f0c7867e8da060332217b", "message": "Issues #11673, #11247, #11245: Add retry until logic in AcmeClient order and challenge processing. Add message to denote how long it took to retrieve the certificate from the ACME server. Add message when terms of service requires manual intervention.", "committedDate": "2020-05-11T22:04:14Z", "type": "commit"}, {"oid": "c3a276b0141608be556f0c7867e8da060332217b", "url": "https://github.com/OpenLiberty/open-liberty/commit/c3a276b0141608be556f0c7867e8da060332217b", "message": "Issues #11673, #11247, #11245: Add retry until logic in AcmeClient order and challenge processing. Add message to denote how long it took to retrieve the certificate from the ACME server. Add message when terms of service requires manual intervention.", "committedDate": "2020-05-11T22:04:14Z", "type": "forcePushed"}]}