{"pr_number": 11580, "pr_title": "Preserve HTTP response code in mpOpenTracing", "pr_createdAt": "2020-04-01T13:38:58Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/11580", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEyODM3OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11580#discussion_r405128378", "bodyText": "Expected exception", "author": "donbourne", "createdAt": "2020-04-07T21:37:19Z", "path": "dev/com.ibm.ws.opentracing.1.x_fat/fat/src/com/ibm/ws/testing/opentracing/test/FATMPOpenTracing.java", "diffHunk": "@@ -99,22 +105,57 @@ public void testHelloWorld() throws Exception {\n             tracerState += actualResponseLine;\n         }\n \n+        int expectedSpans = 3;\n+        int spanCount = getSpanCount(tracerState);\n+        if (spanCount != expectedSpans) {\n+            Assert.assertEquals(\"Expected \" + expectedSpans + \" spans but found \" + spanCount + \":\", tracerState);\n+        }\n+    }\n+    \n+    @Test\n+    public void testNotFoundException() throws Exception {\n+    \tString methodName = \"testNotFoundException\";\n+\n+        try {\n+            \n+            executeWebService(\"notFound\");\n+        } catch (TestAppException tae) {\n+            FATLogging.info(CLASS, methodName, \"Expection exception\", tae);", "originalCommit": "1b88d2df50253cc22d3ad974890331cc95a91c07", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU2MTM5Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11580#discussion_r405561392", "bodyText": "Fixed", "author": "fmhwong", "createdAt": "2020-04-08T14:19:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEyODM3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEyOTY5Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11580#discussion_r405129692", "bodyText": "why does number of expected spans change to 3 (from 2)?", "author": "donbourne", "createdAt": "2020-04-07T21:39:54Z", "path": "dev/com.ibm.ws.opentracing.1.x_fat/fat/src/com/ibm/ws/testing/opentracing/test/FATMPOpenTracing.java", "diffHunk": "@@ -99,22 +105,57 @@ public void testHelloWorld() throws Exception {\n             tracerState += actualResponseLine;\n         }\n \n+        int expectedSpans = 3;", "originalCommit": "1b88d2df50253cc22d3ad974890331cc95a91c07", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU2NDg1Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11580#discussion_r405564852", "bodyText": "The clearTracer() method that was added to clear the Tracer object between tests.  It makes a HTTP DELETE call to clear the tracer before each test.  Therefore, each test will have an additional span from the HTTP DELETE call.", "author": "fmhwong", "createdAt": "2020-04-08T14:24:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTEyOTY5Mg=="}], "type": "inlineReview"}, {"oid": "7164317b24a717e6846ef91ac68ee5e1b5928dc2", "url": "https://github.com/OpenLiberty/open-liberty/commit/7164317b24a717e6846ef91ac68ee5e1b5928dc2", "message": "Preserve response code", "committedDate": "2020-04-08T14:18:06Z", "type": "commit"}, {"oid": "7164317b24a717e6846ef91ac68ee5e1b5928dc2", "url": "https://github.com/OpenLiberty/open-liberty/commit/7164317b24a717e6846ef91ac68ee5e1b5928dc2", "message": "Preserve response code", "committedDate": "2020-04-08T14:18:06Z", "type": "forcePushed"}]}