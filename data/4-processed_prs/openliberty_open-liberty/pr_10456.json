{"pr_number": 10456, "pr_title": "Nls introspect addition", "pr_createdAt": "2020-01-15T22:57:27Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/10456", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQ1MzcwOA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10456#discussion_r367453708", "bodyText": "It doesn't look like you committed the updates to this message that we talked about.", "author": "ayoho", "createdAt": "2020-01-16T14:40:06Z", "path": "dev/com.ibm.ws.security.social/resources/com/ibm/ws/security/social/resources/SocialMessages.nlsprops", "diffHunk": "@@ -119,6 +119,16 @@ JSON_ENTRY_WRONG_JSON_TYPE=CWWKS5386E: The value for the key [{0}] in the JSON d\n JSON_ENTRY_WRONG_JSON_TYPE.explanation=The value for the specified key did not have the correct type. The JSON data might be malformed or might have an unexpected structure.\n JSON_ENTRY_WRONG_JSON_TYPE.useraction=Check the structure of the JSON data. Check the JSON data to see whether an error occurred.\n \n+# 0=Exception message\n+INTROSPECT_ERROR_GETTING_USER_INFO=CWWKS5387E: The response from the token introspection API cannot be processed: {0}\n+INTROSPECT_ERROR_GETTING_USER_INFO.explanation=Information about the authenticated user cannot be obtained because another error occurred.\n+INTROSPECT_ERROR_GETTING_USER_INFO.useraction=If the message contains another error message, see the user action for that message. Otherwise, check the server logs for more error messages that might indicate where the other error occurred.\n+\n+# 0=User API response string\n+INTROSPECT_USER_API_ACTIVE_NOT_TRUE=CWWKS5388E: The active value from the introspect user API is false or is not a boolean. The full response is {0}.", "originalCommit": "bdf62d3758182b3d30f2ac6629da293f296691cc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQ2NDg5Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10456#discussion_r367464892", "bodyText": "This isn't a Kubernetes user API call, and the \"response\" isn't the thing that's expected to be true. When phrasing these messages, we try to be as clear as we possibly can when describing this particular situation: what were we doing when this error occurred, what might have gone wrong, what possible remedies might there be, etc. Having another look at https://tools.ietf.org/html/rfc7662#section-2.2 would be useful here. In this scenario, the token introspect response included \"active\":false, so the token that was sent to the token introspect endpoint is not considered active/valid. Why might that be? Some of the examples from the spec are: the token introspection server might not have been the entity that issued that token, the token might be revoked or expired, or the protected resource might not be allowed to introspect the token.", "author": "ayoho", "createdAt": "2020-01-16T14:58:39Z", "path": "dev/com.ibm.ws.security.social/resources/com/ibm/ws/security/social/resources/SocialMessages.nlsprops", "diffHunk": "@@ -119,6 +119,16 @@ JSON_ENTRY_WRONG_JSON_TYPE=CWWKS5386E: The value for the key [{0}] in the JSON d\n JSON_ENTRY_WRONG_JSON_TYPE.explanation=The value for the specified key did not have the correct type. The JSON data might be malformed or might have an unexpected structure.\n JSON_ENTRY_WRONG_JSON_TYPE.useraction=Check the structure of the JSON data. Check the JSON data to see whether an error occurred.\n \n+# 0=Exception message\n+INTROSPECT_ERROR_GETTING_USER_INFO=CWWKS5387E: The response from the token introspection API cannot be processed: {0}\n+INTROSPECT_ERROR_GETTING_USER_INFO.explanation=Information about the authenticated user cannot be obtained because another error occurred.\n+INTROSPECT_ERROR_GETTING_USER_INFO.useraction=If the message contains another error message, see the user action for that message. Otherwise, check the server logs for more error messages that might indicate where the other error occurred.\n+\n+# 0=User API response string\n+INTROSPECT_USER_API_ACTIVE_NOT_TRUE=CWWKS5388E: The active value from the introspect user API is false or is not a boolean. The full response is {0}.\n+INTROSPECT_USER_API_ACTIVE_NOT_TRUE.explanation=The response from the Kubernetes user API is expected to be true.", "originalCommit": "bdf62d3758182b3d30f2ac6629da293f296691cc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQ3MDM5NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10456#discussion_r367470395", "bodyText": "In this case, verifying the active value in the response isn't much of a remedy. That would be a bit like asking someone to verify that their check bounced after their check was rejected (when they should check their account balance, for instance). So for the NLS useraction, ask yourself what would someone who sees this message (here, that'd be a server administrator who controls the server configuration and environment) actually be able to do to fix the situation, or at least have a chance at getting more information? The most likely things that happened: the token is revoked or expired, the protected resource does not have permission to introspect the token, or an incorrect token introspection endpoint is used. So what would the server admin be able to do about those situations? Make sure the token is valid, verify that the token can be introspected, and verify that the correct token introspection endpoint is used.", "author": "ayoho", "createdAt": "2020-01-16T15:08:00Z", "path": "dev/com.ibm.ws.security.social/resources/com/ibm/ws/security/social/resources/SocialMessages.nlsprops", "diffHunk": "@@ -119,6 +119,16 @@ JSON_ENTRY_WRONG_JSON_TYPE=CWWKS5386E: The value for the key [{0}] in the JSON d\n JSON_ENTRY_WRONG_JSON_TYPE.explanation=The value for the specified key did not have the correct type. The JSON data might be malformed or might have an unexpected structure.\n JSON_ENTRY_WRONG_JSON_TYPE.useraction=Check the structure of the JSON data. Check the JSON data to see whether an error occurred.\n \n+# 0=Exception message\n+INTROSPECT_ERROR_GETTING_USER_INFO=CWWKS5387E: The response from the token introspection API cannot be processed: {0}\n+INTROSPECT_ERROR_GETTING_USER_INFO.explanation=Information about the authenticated user cannot be obtained because another error occurred.\n+INTROSPECT_ERROR_GETTING_USER_INFO.useraction=If the message contains another error message, see the user action for that message. Otherwise, check the server logs for more error messages that might indicate where the other error occurred.\n+\n+# 0=User API response string\n+INTROSPECT_USER_API_ACTIVE_NOT_TRUE=CWWKS5388E: The active value from the introspect user API is false or is not a boolean. The full response is {0}.\n+INTROSPECT_USER_API_ACTIVE_NOT_TRUE.explanation=The response from the Kubernetes user API is expected to be true.\n+INTROSPECT_USER_API_ACTIVE_NOT_TRUE.useraction=Verify that the active value in the introspect user api is true.", "originalCommit": "bdf62d3758182b3d30f2ac6629da293f296691cc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7823d4f22cc533d93c6b4b2ef2259074d1f3123c", "url": "https://github.com/OpenLiberty/open-liberty/commit/7823d4f22cc533d93c6b4b2ef2259074d1f3123c", "message": "added nls messages and edited error calls", "committedDate": "2020-01-17T19:57:49Z", "type": "forcePushed"}, {"oid": "d10b7186e2a9f6ccb4fe7b4e3cf9bad0750fbadc", "url": "https://github.com/OpenLiberty/open-liberty/commit/d10b7186e2a9f6ccb4fe7b4e3cf9bad0750fbadc", "message": "added nls messages and edited error calls", "committedDate": "2020-01-17T20:04:37Z", "type": "commit"}, {"oid": "d10b7186e2a9f6ccb4fe7b4e3cf9bad0750fbadc", "url": "https://github.com/OpenLiberty/open-liberty/commit/d10b7186e2a9f6ccb4fe7b4e3cf9bad0750fbadc", "message": "added nls messages and edited error calls", "committedDate": "2020-01-17T20:04:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODU1MDY0OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/10456#discussion_r368550648", "bodyText": "Suggestion: remove the \"Either.\" Change \"Either the\" to \"The\" because either typically is used when there are only 2 options.", "author": "helyarp", "createdAt": "2020-01-20T13:36:45Z", "path": "dev/com.ibm.ws.security.social/resources/com/ibm/ws/security/social/resources/SocialMessages.nlsprops", "diffHunk": "@@ -119,6 +119,16 @@ JSON_ENTRY_WRONG_JSON_TYPE=CWWKS5386E: The value for the [{0}] key in the JSON d\n JSON_ENTRY_WRONG_JSON_TYPE.explanation=The value for the specified key did not have the correct type. The JSON data might be malformed or might have an unexpected structure.\n JSON_ENTRY_WRONG_JSON_TYPE.useraction=Check the structure of the JSON data. Check the JSON data to see whether an error occurred.\n \n+# 0=Exception message\n+INTROSPECT_ERROR_GETTING_USER_INFO=CWWKS5387E: The response from the token introspection API cannot be processed: {0}\n+INTROSPECT_ERROR_GETTING_USER_INFO.explanation=Information about the authenticated user cannot be obtained because another error occurred.\n+INTROSPECT_ERROR_GETTING_USER_INFO.useraction=If the message contains another error message, see the user action for that message. Otherwise, check the server logs for more error messages that might indicate where the other error occurred.\n+\n+# 0=User API response string\n+INTROSPECT_USER_API_INACTIVE=CWWKS5388E: The token introspection request failed because the token that is included in the request is not valid. The full response is {0}.\n+INTROSPECT_USER_API_INACTIVE.explanation=Either the authorization server did not issue the token, the resource owner revoked the token, the token is expired, or another error occurred.", "originalCommit": "d10b7186e2a9f6ccb4fe7b4e3cf9bad0750fbadc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}