{"pr_number": 1290, "pr_title": "[HUDI-584] Relocate spark-avro dependency by maven-shade-plugin", "pr_createdAt": "2020-01-29T16:00:39Z", "pr_url": "https://github.com/apache/hudi/pull/1290", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU3NzkyNQ==", "url": "https://github.com/apache/hudi/pull/1290#discussion_r372577925", "bodyText": "just leave it as instantTime ? (also this change is different from what the PR says so lets not have it in this PR)", "author": "n3nash", "createdAt": "2020-01-29T19:13:37Z", "path": "hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java", "diffHunk": "@@ -104,7 +104,7 @@ public String showLogFileCommits(\n           try {\n             instantTime = n.getLogBlockHeader().get(HeaderMetadataType.INSTANT_TIME);\n             if (instantTime == null) {\n-              throw new Exception(\"Invalid instant time \" + instantTime);", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjYwNTc2Ng==", "url": "https://github.com/apache/hudi/pull/1290#discussion_r372605766", "bodyText": "@n3nash thanks for your comment, IMO, it's a minor change (which has no function impact) may be no need separate PR.\nFor the minor change: The instantTime variable is known to be null.\n\"Invalid instant time \" + null", "author": "lamberken", "createdAt": "2020-01-29T20:11:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU3NzkyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcwNzQzMA==", "url": "https://github.com/apache/hudi/pull/1290#discussion_r372707430", "bodyText": "Right, I agree it's a minor change and doesn't need a new PR. But I don't think we need this change", "author": "n3nash", "createdAt": "2020-01-30T00:38:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU3NzkyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjgyMDYyOA==", "url": "https://github.com/apache/hudi/pull/1290#discussion_r372820628", "bodyText": "@n3nash follow you, reverted.", "author": "lamberken", "createdAt": "2020-01-30T08:47:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU3NzkyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjE5MDA0MQ==", "url": "https://github.com/apache/hudi/pull/1290#discussion_r386190041", "bodyText": "can we also add the --package  instruction here to explicitly say how to add spark-avro if building without it.", "author": "bhasudha", "createdAt": "2020-03-02T04:10:19Z", "path": "README.md", "diffHunk": "@@ -71,6 +71,14 @@ The default Scala version supported is 2.11. To build for Scala 2.12 version, bu\n mvn clean package -DskipTests -DskipITs -Dscala-2.12\n ```\n \n+### Build without spark-avro module\n+\n+The default hudi-jar bundles spark-avro module. To build without spark-avro module, build using `spark-shade-unbundle-avro` profile", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjE5MDQ5Ng==", "url": "https://github.com/apache/hudi/pull/1290#discussion_r386190496", "bodyText": "@lamber-ken I see a '/' here for the property \"spark.bundle.spark.shade.prefix\" if the profile is activated. Is this intended? Does this mean shade with empty prefix (same as not shading)? I dont know much about profiling either so wanted to clarify with you.", "author": "bhasudha", "createdAt": "2020-03-02T04:13:12Z", "path": "packaging/hudi-spark-bundle/pom.xml", "diffHunk": "@@ -248,6 +260,13 @@\n         <spark.bundle.hive.shade.prefix>org.apache.hudi.</spark.bundle.hive.shade.prefix>\n       </properties>\n     </profile>\n+    <profile>\n+      <id>spark-shade-unbundle-avro</id>\n+      <properties>\n+        <spark.bundle.avro.scope>provided</spark.bundle.avro.scope>\n+        <spark.bundle.spark.shade.prefix>/</spark.bundle.spark.shade.prefix>", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIxMTQxOQ==", "url": "https://github.com/apache/hudi/pull/1290#discussion_r386211419", "bodyText": "Good catch", "author": "lamberken", "createdAt": "2020-03-02T06:10:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjE5MDQ5Ng=="}], "type": "inlineReview"}, {"oid": "7be999a65c05df994bead40bdb2e769be404be19", "url": "https://github.com/apache/hudi/commit/7be999a65c05df994bead40bdb2e769be404be19", "message": "[HUDI-584] Relocate spark-avro dependency by maven-shade-plugin", "committedDate": "2020-03-02T06:52:51Z", "type": "commit"}]}