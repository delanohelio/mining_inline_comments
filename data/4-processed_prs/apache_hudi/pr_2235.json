{"pr_number": 2235, "pr_title": "[HUDI-1377] remove duplicate code in HoodieSparkSqlWriter", "pr_createdAt": "2020-11-06T09:04:45Z", "pr_url": "https://github.com/apache/hudi/pull/2235", "timeline": [{"oid": "dc1363a7d7667a39f99fed3026d0ee602ea11bf7", "url": "https://github.com/apache/hudi/commit/dc1363a7d7667a39f99fed3026d0ee602ea11bf7", "message": "remove duplicate code", "committedDate": "2020-11-06T08:55:21Z", "type": "commit"}, {"oid": "71f365bf649423b1399a460ad7fe17bdca982d4d", "url": "https://github.com/apache/hudi/commit/71f365bf649423b1399a460ad7fe17bdca982d4d", "message": "Merge branch 'master' into HUDI-1377", "committedDate": "2020-11-06T09:06:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc1NTU2NQ==", "url": "https://github.com/apache/hudi/pull/2235#discussion_r518755565", "bodyText": "Good Catch", "author": "wangxianghu", "createdAt": "2020-11-06T13:38:00Z", "path": "hudi-spark/src/main/scala/org/apache/hudi/HoodieSparkSqlWriter.scala", "diffHunk": "@@ -140,7 +140,7 @@ private[hudi] object HoodieSparkSqlWriter {\n \n           // Convert to RDD[HoodieRecord]\n           val keyGenerator = DataSourceUtils.createKeyGenerator(toProperties(parameters))\n-          val genericRecords: RDD[GenericRecord] = AvroConversionUtils.createRdd(df, structName, nameSpace)\n+          val genericRecords: RDD[GenericRecord] = AvroConversionUtils.createRdd(df, schema, structName, nameSpace)", "originalCommit": "71f365bf649423b1399a460ad7fe17bdca982d4d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}