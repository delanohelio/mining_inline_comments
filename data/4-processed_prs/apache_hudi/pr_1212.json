{"pr_number": 1212, "pr_title": "[HUDI-509] Renaming code in sync with cWiki restructuring", "pr_createdAt": "2020-01-12T09:52:44Z", "pr_url": "https://github.com/apache/hudi/pull/1212", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTU3MDgzNQ==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r365570835", "bodyText": "IMO, this means ORC support is coming \ud83d\udc4d", "author": "lamberken", "createdAt": "2020-01-12T09:57:35Z", "path": "hudi-common/src/main/java/org/apache/hudi/common/model/HoodieBaseFile.java", "diffHunk": "@@ -27,21 +27,21 @@\n import java.util.Objects;\n \n /**\n- * Hoodie data file.\n+ * Hoodie base file.\n  */\n-public class HoodieDataFile implements Serializable {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjIwNzkzNg==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r366207936", "bodyText": "I tried retaining --storage-type as well. but have to choose betwen this and the new --table-typeto mark as required.. Whichever we pick, it wont be ideal. So choose to simply rename, requiring the users to make a small change in the command, when upgrading.", "author": "vinothchandar", "createdAt": "2020-01-14T08:38:34Z", "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -160,9 +160,9 @@ public Operation convert(String value) throws ParameterException {\n     @Parameter(names = {\"--target-table\"}, description = \"name of the target table in Hive\", required = true)\n     public String targetTableName;\n \n-    @Parameter(names = {\"--storage-type\"}, description = \"Type of Storage. COPY_ON_WRITE (or) MERGE_ON_READ\",\n+    @Parameter(names = {\"--table-type\"}, description = \"Type of table. COPY_ON_WRITE (or) MERGE_ON_READ\",", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjIxNDIzNA==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r366214234", "bodyText": "this is a behavior change... previously MOR realtime view errored out here.. now we just return the same RO query results with a warning..", "author": "vinothchandar", "createdAt": "2020-01-14T08:54:01Z", "path": "hudi-spark/src/main/scala/org/apache/hudi/DefaultSource.scala", "diffHunk": "@@ -50,20 +50,14 @@ class DefaultSource extends RelationProvider\n                               optParams: Map[String, String],\n                               schema: StructType): BaseRelation = {\n     // Add default options for unspecified read options keys.\n-    val parameters = Map(VIEW_TYPE_OPT_KEY -> DEFAULT_VIEW_TYPE_OPT_VAL) ++ optParams\n+    val parameters = Map(QUERY_TYPE_OPT_KEY -> DEFAULT_QUERY_TYPE_OPT_VAL) ++ optParams\n \n     val path = parameters.get(\"path\")\n     if (path.isEmpty) {\n       throw new HoodieException(\"'path' must be specified.\")\n     }\n \n-    if (parameters(VIEW_TYPE_OPT_KEY).equals(VIEW_TYPE_REALTIME_OPT_VAL)) {\n-      throw new HoodieException(\"Realtime view not supported yet via data source. Please use HiveContext route.\")\n-    }\n-\n-    if (parameters(VIEW_TYPE_OPT_KEY).equals(VIEW_TYPE_INCREMENTAL_OPT_VAL)) {\n-      new IncrementalRelation(sqlContext, path.get, optParams, schema)\n-    } else {\n+    if (parameters(QUERY_TYPE_OPT_KEY).equals(QUERY_TYPE_SNAPSHOT_OPT_VAL)) {", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3OTM2Ng==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367179366", "bodyText": "s/full/complete?", "author": "n3nash", "createdAt": "2020-01-16T00:39:14Z", "path": "hudi-common/src/main/java/org/apache/hudi/common/table/SyncableFileSystemView.java", "diffHunk": "@@ -18,12 +18,15 @@\n \n package org.apache.hudi.common.table;\n \n+import org.apache.hudi.common.table.TableFileSystemView.BaseFileOnlyView;\n+import org.apache.hudi.common.table.TableFileSystemView.SliceView;\n+\n /**\n- * A consolidated file-system view interface exposing both realtime and read-optimized views along with\n+ * A consolidated file-system view interface exposing both full and basefile only views along with", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQ3MjU3OA==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367472578", "bodyText": "okay .. complete sounds better", "author": "vinothchandar", "createdAt": "2020-01-16T15:11:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3OTM2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3OTYwNw==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367179607", "bodyText": "Not sure if it's the best user-experience to augment the table name with a postfix for all tables..", "author": "n3nash", "createdAt": "2020-01-16T00:40:05Z", "path": "hudi-hive/src/main/java/org/apache/hudi/hive/HiveSyncTool.java", "diffHunk": "@@ -53,30 +53,44 @@\n public class HiveSyncTool {\n \n   private static final Logger LOG = LogManager.getLogger(HiveSyncTool.class);\n-  private final HoodieHiveClient hoodieHiveClient;\n-  public static final String SUFFIX_REALTIME_TABLE = \"_rt\";\n+  public static final String SUFFIX_SNAPSHOT_TABLE = \"_rt\";\n+  public static final String SUFFIX_READ_OPTIMIZED_TABLE = \"_ro\";", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE5MDI2Mg==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367190262", "bodyText": "@n3nash the reason was.. without this, it gets kind of confusing that the snapshot query on COW hits the table with no prefix and on MOR, its not the snapshot table.. So wanted to clearly call out _ro ...", "author": "vinothchandar", "createdAt": "2020-01-16T01:24:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3OTYwNw=="}], "type": "inlineReview"}, {"oid": null, "url": null, "message": null, "committedDate": null, "type": "forcePushed"}, {"oid": "426aeced1b819a610219e744a1b801bcf13c7402", "url": "https://github.com/apache/hudi/commit/426aeced1b819a610219e744a1b801bcf13c7402", "message": "[HUDI-509] Renaming code in sync with cWiki restructuring\n\n - Storage Type replaced with Table Type (remaining instances)\n - View types replaced with query types;\n - ReadOptimized view referred as Snapshot Query\n - TableFileSystemView sub interfaces renamed to BaseFileOnly and Slice Views\n - HoodieDataFile renamed to HoodieBaseFile\n - Hive Sync tool will register RO tables for MOR with a `_ro` suffix\n - Datasource/Deltastreamer options renamed accordingly\n\nTDB\n [ ] Support fallback to old config values as well, so migration is painless\n [ ] Config for controlling _ro suffix addition", "committedDate": "2020-01-16T18:13:39Z", "type": "commit"}, {"oid": "c4007e23f184f9fa9e9d19700eb5b30f6c1c51ba", "url": "https://github.com/apache/hudi/commit/c4007e23f184f9fa9e9d19700eb5b30f6c1c51ba", "message": "Fix issue with hive sync, by refactoring how table name is passed around", "committedDate": "2020-01-16T18:13:39Z", "type": "commit"}, {"oid": "2633bcb7e2715aa7debeef1c160c1e8496faf6ff", "url": "https://github.com/apache/hudi/commit/2633bcb7e2715aa7debeef1c160c1e8496faf6ff", "message": "Adding translation to new configs, in cases where user specifies the old configs still", "committedDate": "2020-01-16T18:14:20Z", "type": "commit"}, {"oid": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "url": "https://github.com/apache/hudi/commit/97d21b1bf3e301357ad35ced94f16bf075f25c22", "message": "Also fix HoodieJavaApp, update doap", "committedDate": "2020-01-16T18:14:21Z", "type": "commit"}, {"oid": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "url": "https://github.com/apache/hudi/commit/97d21b1bf3e301357ad35ced94f16bf075f25c22", "message": "Also fix HoodieJavaApp, update doap", "committedDate": "2020-01-16T18:14:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3ODA2OA==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367678068", "bodyText": "@vinothchandar Do we want to rename the method as well to 'toHoodieBaseFile' ?", "author": "bhasudha", "createdAt": "2020-01-16T22:14:20Z", "path": "hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java", "diffHunk": "@@ -36,22 +36,22 @@\n   @JsonProperty(\"fileLen\")\n   private long fileLen;\n \n-  public static HoodieDataFile toHoodieDataFile(DataFileDTO dto) {\n+  public static HoodieBaseFile toHoodieDataFile(DataFileDTO dto) {", "originalCommit": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY4NzA2MA==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367687060", "bodyText": "+1", "author": "n3nash", "createdAt": "2020-01-16T22:39:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3ODA2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3ODI0NQ==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367678245", "bodyText": "'fromHoodieBaseFile' instead ?", "author": "bhasudha", "createdAt": "2020-01-16T22:14:49Z", "path": "hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/DataFileDTO.java", "diffHunk": "@@ -36,22 +36,22 @@\n   @JsonProperty(\"fileLen\")\n   private long fileLen;\n \n-  public static HoodieDataFile toHoodieDataFile(DataFileDTO dto) {\n+  public static HoodieBaseFile toHoodieDataFile(DataFileDTO dto) {\n     if (null == dto) {\n       return null;\n     }\n \n-    HoodieDataFile dataFile = null;\n+    HoodieBaseFile dataFile = null;\n     if (null != dto.fileStatus) {\n-      dataFile = new HoodieDataFile(FileStatusDTO.toFileStatus(dto.fileStatus));\n+      dataFile = new HoodieBaseFile(FileStatusDTO.toFileStatus(dto.fileStatus));\n     } else {\n-      dataFile = new HoodieDataFile(dto.fullPath);\n+      dataFile = new HoodieBaseFile(dto.fullPath);\n       dataFile.setFileLen(dto.fileLen);\n     }\n     return dataFile;\n   }\n \n-  public static DataFileDTO fromHoodieDataFile(HoodieDataFile dataFile) {\n+  public static DataFileDTO fromHoodieDataFile(HoodieBaseFile dataFile) {", "originalCommit": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY4NzA5NA==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367687094", "bodyText": "+1", "author": "n3nash", "createdAt": "2020-01-16T22:39:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3ODI0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3OTg3Nw==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367679877", "bodyText": "convertFileStatusesToBaseFiles instead ? No strong opinion on these. I think it should be okay to leave it as is since the return type is indicative already.", "author": "bhasudha", "createdAt": "2020-01-16T22:19:18Z", "path": "hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java", "diffHunk": "@@ -249,10 +249,10 @@ private void ensurePartitionLoadedCorrectly(String partition) {\n    *\n    * @param statuses List of File-Status\n    */\n-  private Stream<HoodieDataFile> convertFileStatusesToDataFiles(FileStatus[] statuses) {\n+  private Stream<HoodieBaseFile> convertFileStatusesToDataFiles(FileStatus[] statuses) {", "originalCommit": "97d21b1bf3e301357ad35ced94f16bf075f25c22", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY4NzE3Mg==", "url": "https://github.com/apache/hudi/pull/1212#discussion_r367687172", "bodyText": "+1", "author": "n3nash", "createdAt": "2020-01-16T22:39:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY3OTg3Nw=="}], "type": "inlineReview"}, {"oid": "b12cd461484a70133445af8713378ede52f13de6", "url": "https://github.com/apache/hudi/commit/b12cd461484a70133445af8713378ede52f13de6", "message": "Renaming DataFile to BaseFile across DTOs, HoodieFileSlice and AbstractTableFileSystemView", "committedDate": "2020-01-17T07:27:11Z", "type": "commit"}]}