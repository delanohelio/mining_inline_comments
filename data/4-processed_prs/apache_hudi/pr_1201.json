{"pr_number": 1201, "pr_title": "[HUDI-248] CLI doesn't allow rolling back a Delta commit", "pr_createdAt": "2020-01-09T09:46:37Z", "pr_url": "https://github.com/apache/hudi/pull/1201", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA0NTMxNg==", "url": "https://github.com/apache/hudi/pull/1201#discussion_r365045316", "bodyText": "A MergeOnRead table has both DELTA_COMMIT and COMMIT. The best way to do this would be :\ninstant = activeTimeline.getCommitsTimeline().filterCompletedInstants().filter(instant.getTimestamp.equals(commitTime)\nUse that instant (which should have the action populated) and you can remove the if else..", "author": "n3nash", "createdAt": "2020-01-10T02:09:29Z", "path": "hudi-cli/src/main/java/org/apache/hudi/cli/commands/CommitsCommand.java", "diffHunk": "@@ -96,7 +98,15 @@ public String rollbackCommit(@CliOption(key = {\"commit\"}, help = \"Commit to roll\n       throws Exception {\n     HoodieActiveTimeline activeTimeline = HoodieCLI.getTableMetaClient().getActiveTimeline();\n     HoodieTimeline timeline = activeTimeline.getCommitsTimeline().filterCompletedInstants();\n-    HoodieInstant commitInstant = new HoodieInstant(false, HoodieTimeline.COMMIT_ACTION, commitTime);\n+    HoodieTableType tableType = HoodieCLI.getTableMetaClient().getTableType();\n+    HoodieInstant commitInstant;", "originalCommit": null, "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8d3a6353c6d9ae57a560a26d3be3f4f50062ed34", "url": "https://github.com/apache/hudi/commit/8d3a6353c6d9ae57a560a26d3be3f4f50062ed34", "message": "[HUDI-248] CLI doesn't allow rolling back a Delta commit", "committedDate": "2020-01-10T04:26:54Z", "type": "commit"}, {"oid": "8d3a6353c6d9ae57a560a26d3be3f4f50062ed34", "url": "https://github.com/apache/hudi/commit/8d3a6353c6d9ae57a560a26d3be3f4f50062ed34", "message": "[HUDI-248] CLI doesn't allow rolling back a Delta commit", "committedDate": "2020-01-10T04:26:54Z", "type": "forcePushed"}]}