{"pr_number": 1710, "pr_title": "[HUDI-1023] Add validation error messages in delta sync", "pr_createdAt": "2020-06-07T01:33:55Z", "pr_url": "https://github.com/apache/hudi/pull/1710", "timeline": [{"oid": "22533afb177b94dc54273d7f70eae198fd60de16", "url": "https://github.com/apache/hudi/commit/22533afb177b94dc54273d7f70eae198fd60de16", "message": "[MINOR] Fix delta streamer write config\n\n- avoid overwrite index type\n- add more validation error message\n- make write config constants public", "committedDate": "2020-06-07T01:35:52Z", "type": "commit"}, {"oid": "22533afb177b94dc54273d7f70eae198fd60de16", "url": "https://github.com/apache/hudi/commit/22533afb177b94dc54273d7f70eae198fd60de16", "message": "[MINOR] Fix delta streamer write config\n\n- avoid overwrite index type\n- add more validation error message\n- make write config constants public", "committedDate": "2020-06-07T01:35:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMxNjIzOQ==", "url": "https://github.com/apache/hudi/pull/1710#discussion_r436316239", "bodyText": "@vinothchandar I think this fixed index type to BLOOM. Not sure any historical reason behind it.", "author": "xushiyan", "createdAt": "2020-06-07T01:47:58Z", "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java", "diffHunk": "@@ -497,25 +499,30 @@ private void setupWriteClient() {\n    * @param schemaProvider Schema Provider\n    */\n   private HoodieWriteConfig getHoodieClientConfig(SchemaProvider schemaProvider) {\n+    final boolean combineBeforeUpsert = true;\n+    final boolean autoCommit = false;\n     HoodieWriteConfig.Builder builder =\n-        HoodieWriteConfig.newBuilder().withPath(cfg.targetBasePath).combineInput(cfg.filterDupes, true)\n+        HoodieWriteConfig.newBuilder().withPath(cfg.targetBasePath).combineInput(cfg.filterDupes, combineBeforeUpsert)\n             .withCompactionConfig(HoodieCompactionConfig.newBuilder().withPayloadClass(cfg.payloadClassName)\n                 // Inline compaction is disabled for continuous mode. otherwise enabled for MOR\n                 .withInlineCompaction(cfg.isInlineCompactionEnabled()).build())\n             .forTable(cfg.targetTableName)\n-            .withIndexConfig(HoodieIndexConfig.newBuilder().withIndexType(HoodieIndex.IndexType.BLOOM).build())", "originalCommit": "22533afb177b94dc54273d7f70eae198fd60de16", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cb52d965bbee7d94f0bb12d22e80cd2ea5345e87", "url": "https://github.com/apache/hudi/commit/cb52d965bbee7d94f0bb12d22e80cd2ea5345e87", "message": "Trigger", "committedDate": "2020-06-07T02:13:06Z", "type": "commit"}, {"oid": "6f985401f9a7c8e074b2a49ddb431686f999d00a", "url": "https://github.com/apache/hudi/commit/6f985401f9a7c8e074b2a49ddb431686f999d00a", "message": "Trigger", "committedDate": "2020-06-07T18:08:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYxMTU5Mg==", "url": "https://github.com/apache/hudi/pull/1710#discussion_r436611592", "bodyText": "but this will override this.. the withProps(). no?", "author": "vinothchandar", "createdAt": "2020-06-08T10:53:36Z", "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java", "diffHunk": "@@ -497,25 +499,30 @@ private void setupWriteClient() {\n    * @param schemaProvider Schema Provider\n    */\n   private HoodieWriteConfig getHoodieClientConfig(SchemaProvider schemaProvider) {\n+    final boolean combineBeforeUpsert = true;\n+    final boolean autoCommit = false;\n     HoodieWriteConfig.Builder builder =\n-        HoodieWriteConfig.newBuilder().withPath(cfg.targetBasePath).combineInput(cfg.filterDupes, true)\n+        HoodieWriteConfig.newBuilder().withPath(cfg.targetBasePath).combineInput(cfg.filterDupes, combineBeforeUpsert)\n             .withCompactionConfig(HoodieCompactionConfig.newBuilder().withPayloadClass(cfg.payloadClassName)\n                 // Inline compaction is disabled for continuous mode. otherwise enabled for MOR\n                 .withInlineCompaction(cfg.isInlineCompactionEnabled()).build())\n             .forTable(cfg.targetTableName)\n-            .withIndexConfig(HoodieIndexConfig.newBuilder().withIndexType(HoodieIndex.IndexType.BLOOM).build())\n-            .withAutoCommit(false).withProps(props);\n+            .withAutoCommit(autoCommit).withProps(props);", "originalCommit": "6f985401f9a7c8e074b2a49ddb431686f999d00a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUyNjcwMA==", "url": "https://github.com/apache/hudi/pull/1710#discussion_r438526700", "bodyText": "@vinothchandar you're right. it was my overlook. But i guess this line is redundant anyway as index is default to BLOOM, setting the index config may cause some confusion.", "author": "xushiyan", "createdAt": "2020-06-11T03:47:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYxMTU5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODk1NTg3MQ==", "url": "https://github.com/apache/hudi/pull/1710#discussion_r438955871", "bodyText": "ok makes sense", "author": "vinothchandar", "createdAt": "2020-06-11T17:37:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYxMTU5Mg=="}], "type": "inlineReview"}]}