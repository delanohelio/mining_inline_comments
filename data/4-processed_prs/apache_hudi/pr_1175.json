{"pr_number": 1175, "pr_title": "[HUDI-495] Update deprecated HBase API", "pr_createdAt": "2020-01-03T20:47:30Z", "pr_url": "https://github.com/apache/hudi/pull/1175", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjk5NjQzNg==", "url": "https://github.com/apache/hudi/pull/1175#discussion_r362996436", "bodyText": "Could you comment with a small snippet of the doc mentioning this is the new API ?", "author": "n3nash", "createdAt": "2020-01-03T23:48:29Z", "path": "hudi-client/src/main/java/org/apache/hudi/index/hbase/HBaseIndex.java", "diffHunk": "@@ -287,13 +289,10 @@ private boolean checkIfValidCommit(HoodieTableMetaClient metaClient, String comm\n           hbaseConnection = getHBaseConnection();\n         }\n       }\n-      HTable hTable = null;\n-      try {\n-        hTable = (HTable) hbaseConnection.getTable(TableName.valueOf(tableName));\n+      try (BufferedMutator mutator = hbaseConnection.getBufferedMutator(TableName.valueOf(tableName))) {", "originalCommit": null, "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjk5OTQ5MA==", "url": "https://github.com/apache/hudi/pull/1175#discussion_r362999490", "bodyText": "Sure. Here is the doc: https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html.\nThe try-with-resources statement is a try statement that declares one or more resources.\nA resource is an object that must be closed after the program is finished with it.\nThe try-with-resources statement ensures that each resource is closed at the end of the statement.", "author": "zhedoubushishi", "createdAt": "2020-01-04T00:11:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjk5NjQzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU0ODEyNw==", "url": "https://github.com/apache/hudi/pull/1175#discussion_r363548127", "bodyText": "Thanks for providing the link, so is the BufferedMutator from Hbase also the preferred new methodology ? (The above link tells me that from the JDBC driver changes are fair)", "author": "n3nash", "createdAt": "2020-01-07T00:42:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjk5NjQzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzkxOTI0Nw==", "url": "https://github.com/apache/hudi/pull/1175#discussion_r363919247", "bodyText": "Yes I think so.\nThe HTable API doc shows:\nflushCommits()\nDeprecated. \nas of 1.0.0. Replaced by BufferedMutator.flush()\n\nAlso HTable is not threadsafe. (https://issues.apache.org/jira/browse/HBASE-17361)", "author": "zhedoubushishi", "createdAt": "2020-01-07T19:46:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjk5NjQzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM3NjM1MQ==", "url": "https://github.com/apache/hudi/pull/1175#discussion_r364376351", "bodyText": "Ok great, thanks!", "author": "n3nash", "createdAt": "2020-01-08T18:26:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjk5NjQzNg=="}], "type": "inlineReview"}, {"oid": "e3029ade578f717ba337db4316f1686ca0a2c02d", "url": "https://github.com/apache/hudi/commit/e3029ade578f717ba337db4316f1686ca0a2c02d", "message": "Update deprecated HBase API", "committedDate": "2020-01-06T23:40:43Z", "type": "commit"}, {"oid": "e3029ade578f717ba337db4316f1686ca0a2c02d", "url": "https://github.com/apache/hudi/commit/e3029ade578f717ba337db4316f1686ca0a2c02d", "message": "Update deprecated HBase API", "committedDate": "2020-01-06T23:40:43Z", "type": "forcePushed"}]}