{"pr_number": 313, "pr_title": "Support ES 7.10.0 ", "pr_createdAt": "2020-11-17T23:43:16Z", "pr_url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313", "timeline": [{"oid": "bf58ee6e1a46b94aa04f5946c18ba4fd3b7a593d", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/bf58ee6e1a46b94aa04f5946c18ba4fd3b7a593d", "message": "Support ES 7.10.0", "committedDate": "2020-11-17T23:26:57Z", "type": "commit"}, {"oid": "42c34a9c356dd128235aa274d0226fe609ce5224", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/42c34a9c356dd128235aa274d0226fe609ce5224", "message": "Format the codes", "committedDate": "2020-11-17T23:52:44Z", "type": "commit"}, {"oid": "77cbcc97df8cf87cab252612664b0f9f32f7e692", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/77cbcc97df8cf87cab252612664b0f9f32f7e692", "message": "remove mavenlocal", "committedDate": "2020-11-18T16:36:45Z", "type": "commit"}, {"oid": "f11f3633797b8266c640551df675e800674010a4", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/f11f3633797b8266c640551df675e800674010a4", "message": "Fix some format issues, and update the github workflows for the env related issues", "committedDate": "2020-11-18T16:57:52Z", "type": "commit"}, {"oid": "c8ee57a4b222735371a34116cf07727bd6ec2096", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/c8ee57a4b222735371a34116cf07727bd6ec2096", "message": "update the integtest command", "committedDate": "2020-11-18T17:06:19Z", "type": "commit"}, {"oid": "5aada21fac29451c1727bf0f0c20ff658226f02e", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/5aada21fac29451c1727bf0f0c20ff658226f02e", "message": "simplify the configuration of integtest", "committedDate": "2020-11-18T18:01:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3MTEyOA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526371128", "bodyText": "Could you remove this method since nobody calls it?", "author": "kaituo", "createdAt": "2020-11-18T19:42:21Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/cluster/MasterEventListener.java", "diffHunk": "@@ -114,8 +114,7 @@ protected Cancellable getHourlyCron() {\n         return hourlyCron;\n     }\n \n-    @Override\n-    public String executorName() {\n+    private String executorName() {", "originalCommit": "5aada21fac29451c1727bf0f0c20ff658226f02e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5MDQ5NA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526390494", "bodyText": "Actually it's used by our scheduled jobs.", "author": "weicongs-amazon", "createdAt": "2020-11-18T20:15:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3MTEyOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQyMDA4MA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526420080", "bodyText": "got it.", "author": "kaituo", "createdAt": "2020-11-18T21:05:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3MTEyOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3MTM3OA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526371378", "bodyText": "please remove.", "author": "kaituo", "createdAt": "2020-11-18T19:42:53Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/indices/AnomalyDetectionIndices.java", "diffHunk": "@@ -439,8 +439,7 @@ public void offMaster() {\n         }\n     }\n \n-    @Override\n-    public String executorName() {\n+    private String executorName() {", "originalCommit": "5aada21fac29451c1727bf0f0c20ff658226f02e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5MDYxNQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526390615", "bodyText": "The same as above", "author": "weicongs-amazon", "createdAt": "2020-11-18T20:15:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3MTM3OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQyMDEzOQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526420139", "bodyText": "yes.", "author": "kaituo", "createdAt": "2020-11-18T21:06:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3MTM3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3Mzg2Ng==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526373866", "bodyText": "Why do we want to have a different readable name than before?", "author": "kaituo", "createdAt": "2020-11-18T19:47:00Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/model/AnomalyDetector.java", "diffHunk": "@@ -266,7 +267,7 @@ public XContentBuilder toXContent(XContentBuilder builder, Params params) throws\n             xContentBuilder.field(UI_METADATA_FIELD, uiMetadata);\n         }\n         if (lastUpdateTime != null) {\n-            xContentBuilder.timeField(LAST_UPDATE_TIME_FIELD, LAST_UPDATE_TIME_FIELD, lastUpdateTime.toEpochMilli());\n+            xContentBuilder.timeField(LAST_UPDATE_TIME_FIELD, LAST_UPDATE_TIME_FIELD_READABLE_NAME, lastUpdateTime.toEpochMilli());", "originalCommit": "5aada21fac29451c1727bf0f0c20ff658226f02e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5MTM4MA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526391380", "bodyText": "xContentBuilder.timeField this method changes the logic that exception will be thrown when raw and readable names are the same. This is one thing I wanna confirm with team: What readable  name should be used here?", "author": "weicongs-amazon", "createdAt": "2020-11-18T20:17:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3Mzg2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQyMzkzMw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526423933", "bodyText": "The original code may have a mistake since we don't intend to provide two fields for the same information.  Can we just use timeField(String name, Object timeValue)?", "author": "kaituo", "createdAt": "2020-11-18T21:13:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3Mzg2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ1ODc5Nw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526458797", "bodyText": "Yes, we can change it to timeField(String name, Object timeValue).  Do you see any negative impact for this change?", "author": "weicongs-amazon", "createdAt": "2020-11-18T22:15:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3Mzg2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ4Njk5NQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526486995", "bodyText": "You can manually tested it by updating an detector and see if last_update_time is correct or not. If yes, we should be ok.", "author": "kaituo", "createdAt": "2020-11-18T23:17:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3Mzg2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ5MTc2Nw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526491767", "bodyText": "Don't think there is negative impact to remove readable name.", "author": "ylwu-amzn", "createdAt": "2020-11-18T23:31:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3Mzg2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU5MzMzOA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526593338", "bodyText": "Readable one is removed. The  timeField(String name, Object timeValue) method isn't compatible with other codes. To be consistent with previous version, use field method instead.", "author": "weicongs-amazon", "createdAt": "2020-11-19T04:53:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3Mzg2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526377502", "bodyText": "To ensure we have a clean state before each integ test, can you install certificate for the super user as https://github.com/opendistro-for-elasticsearch/alerting/blob/master/alerting/src/test/kotlin/com/amazon/opendistroforelasticsearch/alerting/ODFERestTestCase.kt#L103-L124 ?", "author": "kaituo", "createdAt": "2020-11-18T19:53:08Z", "path": "src/test/java/com/amazon/opendistroforelasticsearch/ad/ODFERestTestCase.java", "diffHunk": "@@ -105,7 +106,15 @@ protected void wipeAllODFEIndices() throws IOException {\n             for (Map<String, Object> index : parserList) {\n                 String indexName = (String) index.get(\"index\");\n                 if (indexName != null && !\".opendistro_security\".equals(indexName)) {\n-                    client().performRequest(new Request(\"DELETE\", \"/\" + indexName));\n+                    try {\n+                        client().performRequest(new Request(\"DELETE\", \"/\" + indexName));\n+                    } catch (WarningFailureException e) {\n+                        // This will also delete system indices, and will get warning exception.\n+                        if (!e.getMessage().contains(\"this request accesses system indices\")) {\n+                            throw e;\n+                        }", "originalCommit": "5aada21fac29451c1727bf0f0c20ff658226f02e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5NzI4Nw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526397287", "bodyText": "It's not about super user. The deletion has been successful. Just a warning exception will be thrown as one system index is trying to be deleted. In future, this will be blocked.  I did try to use the strict mode to avoid this exception but it will block all of warning exceptions which might be not what we want. Instead here it will be only passed for this specific warning message. For long term plan, we probably need a new interface to delete the system indices", "author": "weicongs-amazon", "createdAt": "2020-11-18T20:24:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQyNDc4Mg==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526424782", "bodyText": "Can you tell me how do you test on security enabled on?  I didn't know we can delete system index.  If yes, there seems to be a bug on the system index side.", "author": "kaituo", "createdAt": "2020-11-18T21:14:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ1MjI0MA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526452240", "bodyText": "This warning is just introduced by the latest ES PR: elastic/elasticsearch#60945. It's not related to security feature. Currently security plugin isn't ready for 1.12.0. We need wait for it to run the testing against security enabled cluster.", "author": "weicongs-amazon", "createdAt": "2020-11-18T22:02:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ4NjM1Mg==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526486352", "bodyText": "I see. I am afraid this call will likely fail and throw other exceptions when security is enabled.", "author": "kaituo", "createdAt": "2020-11-18T23:16:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ5NTYwMg==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526495602", "bodyText": "Have you tested some REST API by run ./gradlew run ? Will we get the same exception?", "author": "ylwu-amzn", "createdAt": "2020-11-18T23:41:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUyOTU5Nw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526529597", "bodyText": "Also see the warning message. My understanding is that in theory, direct access system indices isn't reasonable.\n curl -v  http://127.0.0.1:9200/.opendistro-anomaly-detectors\n*   Trying 127.0.0.1...\n* TCP_NODELAY set\n* Connected to 127.0.0.1 (127.0.0.1) port 9200 (#0)\n> GET /.opendistro-anomaly-detectors HTTP/1.1\n> Host: 127.0.0.1:9200\n> User-Agent: curl/7.54.0\n> Accept: */*\n>\n< HTTP/1.1 200 OK\n< Warning: 299 Elasticsearch-7.10.0-51e9d6f22758d0374a0f3f5c6e8f3a7997850f96 \"this request accesses system indices: [.opendistro-anomaly-detectors], but in a future major version, direct access to system indices will be prevented by default\"\n< content-type: application/json; charset=UTF-8\n< content-length: 1819\n<\n* Connection #0 to host 127.0.0.1 left intact\n{\".opendistro-anomaly-detectors\":{\"aliases\":{},\"mappings\":{\"dynamic\":\"false\",\"_meta\":{\"schema_version\":2},\"properties\":{\"category_field\":{\"type\":\"keyword\"},\"description\":{\"type\":\"text\"},\"detection_interval\":{\"properties\":{\"period\":```", "author": "weicongs-amazon", "createdAt": "2020-11-19T01:20:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUzMDEyMg==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526530122", "bodyText": "Based on discussion with Yaliang, there is no direct access from customer use cases. For these IT cases, we need change those before next major version. One issue is created to track this: #315", "author": "weicongs-amazon", "createdAt": "2020-11-19T01:22:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjU5NDM2Nw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526594367", "bodyText": "@kaituo is there any related change in security?  since the test cases have run successfully with security enabled cluster for 1.11.0 release, it should be ok unless there is some related change in security recently.", "author": "weicongs-amazon", "createdAt": "2020-11-19T04:57:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE0NjYyMA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527146620", "bodyText": "security also has a concept called \"system index\", different from ES's \"system index\".  Only admin with certificates can access security's system index.  Sarat added it recently and should be included in 1.12.  Previous CI runs with a security plugin without Sarat's changes.", "author": "kaituo", "createdAt": "2020-11-19T19:34:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE1MzY4NQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527153685", "bodyText": "I see, thanks. This is very helpful.  could it be tested with odfe 1.11.0 by rebuilding AD plugin?", "author": "weicongs-amazon", "createdAt": "2020-11-19T19:46:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzg1NDMwMQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527854301", "bodyText": "Tested on security cluster with both 1.11.0 and 1.12.0.", "author": "weicongs-amazon", "createdAt": "2020-11-20T17:34:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk0NjYzNA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527946634", "bodyText": "Thanks for the change.", "author": "kaituo", "createdAt": "2020-11-20T20:13:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM3NzUwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM4MTU1Nw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526381557", "bodyText": "Does the delete succeed?", "author": "kaituo", "createdAt": "2020-11-18T19:59:47Z", "path": "src/test/java/com/amazon/opendistroforelasticsearch/ad/rest/AnomalyDetectorRestApiIT.java", "diffHunk": "@@ -327,7 +328,14 @@ public void testUpdateAnomalyDetectorWithNotExistingIndex() throws Exception {\n             detector.getUser()\n         );\n \n-        deleteIndex(AnomalyDetector.ANOMALY_DETECTORS_INDEX);\n+        try {\n+            deleteIndex(AnomalyDetector.ANOMALY_DETECTORS_INDEX);\n+        } catch (WarningFailureException e) {\n+            // This will delete system indices, and will get warning exception.\n+            if (!e.getMessage().contains(\"this request accesses system indices\")) {", "originalCommit": "5aada21fac29451c1727bf0f0c20ff658226f02e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM5NDk4NA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526394984", "bodyText": "yes. just one warning message", "author": "weicongs-amazon", "createdAt": "2020-11-18T20:20:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM4MTU1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ4NzM2Mw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526487363", "bodyText": "Remove this one, as 298 listed as \"Enhancements\" above", "author": "ylwu-amzn", "createdAt": "2020-11-18T23:18:52Z", "path": "release-notes/opendistro-for-elasticsearch-anomaly-detection.release-notes-1.12.0.0.md", "diffHunk": "@@ -0,0 +1,22 @@\n+## Version 1.12.0.0 Release Notes\n+\n+Compatible with Elasticsearch 7.10.0\n+\n+### Enhancements\n+\n+* Improve profile API ([#298](https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/298))\n+* Add checkpoint index retention for multi entity detector ([#283](https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/283))\n+* Stashing context for Stats API to allow users to query from RestAPI ([#300](https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/300))\n+* add HC detector request/failure stats ([#307](https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/307))\n+\n+### Bug Fixes\n+\n+* Fix edge case where entities found for preview is empty ([#296](https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/296))\n+* Improve profile API ([#298](https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/298))", "originalCommit": "5aada21fac29451c1727bf0f0c20ff658226f02e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUzNDU1Ng==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526534556", "bodyText": "good catch. Thanks :)", "author": "weicongs-amazon", "createdAt": "2020-11-19T01:36:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ4NzM2Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ5MDYxMQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526490611", "bodyText": "Not related to this PR, but is it reasonable to use GENERIC executor to run AD cron job? Same question for AnomalyDetectionIndices.java line 443 return ThreadPool.Names.MANAGEMENT;", "author": "ylwu-amzn", "createdAt": "2020-11-18T23:28:06Z", "path": "src/main/java/com/amazon/opendistroforelasticsearch/ad/cluster/MasterEventListener.java", "diffHunk": "@@ -114,8 +114,7 @@ protected Cancellable getHourlyCron() {\n         return hourlyCron;\n     }\n \n-    @Override\n-    public String executorName() {\n+    private String executorName() {\n         return ThreadPool.Names.GENERIC;", "originalCommit": "5aada21fac29451c1727bf0f0c20ff658226f02e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjUzMzE0Nw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r526533147", "bodyText": "Good call. new issue is created: #316. Let's discuss it there.", "author": "weicongs-amazon", "createdAt": "2020-11-19T01:31:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjQ5MDYxMQ=="}], "type": "inlineReview"}, {"oid": "dd5aa7ffa0b48f7cd892895a1722b3bfa5ded1eb", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/dd5aa7ffa0b48f7cd892895a1722b3bfa5ded1eb", "message": "Add test cluster for run command; remove duplicated item from release note; remove the readable name for AD", "committedDate": "2020-11-19T01:33:57Z", "type": "commit"}, {"oid": "d49d63cd15f80d9b69655e4969e31901a5c349d5", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/d49d63cd15f80d9b69655e4969e31901a5c349d5", "message": "Use long value for last_update_time field", "committedDate": "2020-11-19T02:03:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE0ODExMQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527148111", "bodyText": "Why do we need to add this?", "author": "kaituo", "createdAt": "2020-11-19T19:36:32Z", "path": "build.gradle", "diffHunk": "@@ -231,6 +231,8 @@ run {\n             cluster.waitForAllConditions()\n         }\n     }\n+\n+    useCluster testClusters.integTest", "originalCommit": "dd5aa7ffa0b48f7cd892895a1722b3bfa5ded1eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE0ODk2Nw==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527148967", "bodyText": "It's related to latest change of es building too. without this, the cluster can't be started.", "author": "weicongs-amazon", "createdAt": "2020-11-19T19:38:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzE0ODExMQ=="}], "type": "inlineReview"}, {"oid": "2d44f2115313292d06f1f9ff827dc61baa2d5c6c", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/2d44f2115313292d06f1f9ff827dc61baa2d5c6c", "message": "Update the IT for security changes", "committedDate": "2020-11-19T22:28:34Z", "type": "commit"}, {"oid": "af1b60a01132d43797e14783145bfc22093afd67", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/af1b60a01132d43797e14783145bfc22093afd67", "message": "Merge remote-tracking branch 'upstream/master' into odfe-1.12.0", "committedDate": "2020-11-20T17:10:50Z", "type": "commit"}, {"oid": "d3ca9e97254c788ef5ab5bf2279426d98a6da327", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/d3ca9e97254c788ef5ab5bf2279426d98a6da327", "message": "Fix IT cases for security enabled cluster", "committedDate": "2020-11-20T17:14:18Z", "type": "commit"}, {"oid": "8512278a63dabd4a7ea66697f5113814fb55987f", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/8512278a63dabd4a7ea66697f5113814fb55987f", "message": "refactor warning exception logic", "committedDate": "2020-11-20T17:21:01Z", "type": "commit"}, {"oid": "320431dc5e022ecc053315d447eb61cb17649d57", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/320431dc5e022ecc053315d447eb61cb17649d57", "message": "add new PR into the release note", "committedDate": "2020-11-20T17:38:29Z", "type": "commit"}, {"oid": "db9d9cd77aa16b691c26bd472128d3098209b49d", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/commit/db9d9cd77aa16b691c26bd472128d3098209b49d", "message": "remove numNode param which is useless for docker based integration test", "committedDate": "2020-11-20T17:58:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2OTU2MQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527969561", "bodyText": "ES7.10 doesn't support PnumNodes ? How to test cluster with multiple nodes?", "author": "ylwu-amzn", "createdAt": "2020-11-20T21:05:51Z", "path": ".github/workflows/CI.yml", "diffHunk": "@@ -70,10 +70,10 @@ jobs:\n           if [ $security -gt 0 ]\n           then\n             echo \"Security plugin is available\"\n-            ./gradlew :integTestRunner --tests \"com.amazon.opendistroforelasticsearch.ad.rest.*IT\" --tests \"com.amazon.opendistroforelasticsearch.ad.e2e.*IT\" -Dtests.rest.cluster=localhost:9200 -Dtests.cluster=localhost:9200 -Dtests.clustername=\"docker-cluster\" -Dhttps=true -Duser=admin -Dpassword=admin -PnumNodes=2\n+            ./gradlew integTest -Dtests.rest.cluster=localhost:9200 -Dtests.cluster=localhost:9200 -Dtests.clustername=\"docker-cluster\" -Dhttps=true -Duser=admin -Dpassword=admin\n           else\n             echo \"Security plugin is NOT available\"\n-            ./gradlew :integTestRunner --tests \"com.amazon.opendistroforelasticsearch.ad.rest.*IT\" --tests \"com.amazon.opendistroforelasticsearch.ad.e2e.*IT\" -Dtests.rest.cluster=localhost:9200 -Dtests.cluster=localhost:9200 -Dtests.clustername=\"docker-cluster\" -PnumNodes=2\n+            ./gradlew integTest -Dtests.rest.cluster=localhost:9200 -Dtests.cluster=localhost:9200 -Dtests.clustername=\"docker-cluster\"", "originalCommit": "db9d9cd77aa16b691c26bd472128d3098209b49d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk3MDIzNA==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527970234", "bodyText": "PnumNodes is used for local test, not for remote cluster.", "author": "weicongs-amazon", "createdAt": "2020-11-20T21:07:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2OTU2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk3MDU1MQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527970551", "bodyText": "We need add new task for local testing with multi nodes", "author": "weicongs-amazon", "createdAt": "2020-11-20T21:08:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2OTU2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk3NDgyNg==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527974826", "bodyText": "Actually it never worked. I commented in the issue: #194. Let's use that to track the multi node testing changes", "author": "weicongs-amazon", "createdAt": "2020-11-20T21:18:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2OTU2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk5NzM1NQ==", "url": "https://github.com/opendistro-for-elasticsearch/anomaly-detection/pull/313#discussion_r527997355", "bodyText": "Got it, let's fix in a separate PR", "author": "ylwu-amzn", "createdAt": "2020-11-20T22:09:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2OTU2MQ=="}], "type": "inlineReview"}]}