{"pr_number": 4193, "pr_title": "NIFI-7319 Add walkthrough document", "pr_createdAt": "2020-04-08T04:57:27Z", "pr_url": "https://github.com/apache/nifi/pull/4193", "timeline": [{"oid": "defbcf6c34bf4233f7db7fd34a2335bd300c6aa6", "url": "https://github.com/apache/nifi/commit/defbcf6c34bf4233f7db7fd34a2335bd300c6aa6", "message": "NIFI-7319 Added first draft of walkthroughs doc.", "committedDate": "2020-04-08T04:56:48Z", "type": "commit"}, {"oid": "a652be5c8c7aa0d7ddf00fd57941e90f69ae880a", "url": "https://github.com/apache/nifi/commit/a652be5c8c7aa0d7ddf00fd57941e90f69ae880a", "message": "NIFI-7319 Added instructions and screenshots for securing standalone NiFi instance.", "committedDate": "2020-04-08T04:56:48Z", "type": "commit"}, {"oid": "d7af6189ad8d114d4434bcb8670e2003053fd22a", "url": "https://github.com/apache/nifi/commit/d7af6189ad8d114d4434bcb8670e2003053fd22a", "message": "NIFI-7319 Added instructions and screenshots for instructing OS & browser to trust self-signed certificate.", "committedDate": "2020-04-08T04:56:48Z", "type": "commit"}, {"oid": "3f75fe872e21dd7c51f68c1b7996e6655ce3686f", "url": "https://github.com/apache/nifi/commit/3f75fe872e21dd7c51f68c1b7996e6655ce3686f", "message": "NIFI-7319 Added instructions and screenshots for securing NiFi with externally-provided certificates.", "committedDate": "2020-04-08T04:56:49Z", "type": "commit"}, {"oid": "4863bedcf72bdaf18e2258c9c4c3fc40db6b1a33", "url": "https://github.com/apache/nifi/commit/4863bedcf72bdaf18e2258c9c4c3fc40db6b1a33", "message": "NIFI-7319 Added instructions and screenshots for building NiFi from source.", "committedDate": "2020-04-08T04:56:49Z", "type": "commit"}, {"oid": "4bd7fb3a4882f0c26489bb84148abb72133c03ae", "url": "https://github.com/apache/nifi/commit/4bd7fb3a4882f0c26489bb84148abb72133c03ae", "message": "NIFI-7319 [WIP] Converting secure cluster instructions to match format.\nFixed instructions regarding embedded ZooKeeper configuration.", "committedDate": "2020-04-08T04:56:49Z", "type": "commit"}, {"oid": "8ef64f5e0550de11f34df4e8446564c06cae151c", "url": "https://github.com/apache/nifi/commit/8ef64f5e0550de11f34df4e8446564c06cae151c", "message": "NIFI-7319 Completed secure cluster walkthrough.", "committedDate": "2020-04-08T04:56:49Z", "type": "commit"}, {"oid": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "url": "https://github.com/apache/nifi/commit/0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "message": "NIFI-7319 Added walkthroughs to documentation navigation list.", "committedDate": "2020-04-08T04:56:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ1NzM2OA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406457368", "bodyText": "These links are broken.", "author": "andrewmlim", "createdAt": "2020-04-09T20:26:25Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ3MjUzNA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406472534", "bodyText": "Other docs use the following as an example:  link:overview.html[NiFi Overview]", "author": "andrewmlim", "createdAt": "2020-04-09T20:56:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ1NzM2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ3MzMxNA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406473314", "bodyText": "Perhaps change the first sentence to read:\nThe intent of this document is to provide a canonical source...", "author": "andrewmlim", "createdAt": "2020-04-09T20:58:11Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ3NzgyOA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406477828", "bodyText": "These links should open in a new browser tab as they will not render properly inside the NiFi Help docs (similar issue as https://issues.apache.org/jira/browse/NIFI-4791). With :linkattrs: already existing, just need to add a \"^\" to the links:\nlink:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^]", "author": "andrewmlim", "createdAt": "2020-04-09T21:07:14Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ3ODcxMQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406478711", "bodyText": "Perhaps make this a NOTE to call attention. I thought a WARNING might be too strong, but that is a possibility too.", "author": "andrewmlim", "createdAt": "2020-04-09T21:09:04Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ3OTc4Mg==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406479782", "bodyText": "Have link open in new browser tab.", "author": "andrewmlim", "createdAt": "2020-04-09T21:11:18Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ4MDY5Mw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406480693", "bodyText": "Have link open in new browser tab.", "author": "andrewmlim", "createdAt": "2020-04-09T21:13:04Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ4MjMwOQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406482309", "bodyText": "We should add information about why the NiFi toolkit is being downloaded/installed as well.", "author": "andrewmlim", "createdAt": "2020-04-09T21:16:29Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUwNjg2Nw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406506867", "bodyText": "Open link in new tab.", "author": "andrewmlim", "createdAt": "2020-04-09T22:13:34Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUwODEyNQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406508125", "bodyText": "Should refer to nifi-1.11.4-source-release.zip not those gz files.", "author": "andrewmlim", "createdAt": "2020-04-09T22:16:59Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUwODQwNQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406508405", "bodyText": "Open link in new tab.", "author": "andrewmlim", "createdAt": "2020-04-09T22:17:49Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUwOTMzNw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406509337", "bodyText": "Not a big deal, but to make more generic, perhaps change references to \"alopresto\" to \"user\" or something similar.", "author": "andrewmlim", "createdAt": "2020-04-09T22:20:21Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxNDI1Mg==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406514252", "bodyText": "Just noticed that there are images that display \"alopresto\". So I'm good if this is left as is. Don't want to delay this being merged and we can clean this up at a later point if necessary.", "author": "andrewmlim", "createdAt": "2020-04-09T22:34:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUwOTMzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUzNTc5OQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406535799", "bodyText": "Yeah, I wanted to make it generic but it was substantial effort to change. I'm ok with this staying in for right now but can be fixed in another revision.", "author": "alopresto", "createdAt": "2020-04-09T23:48:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUwOTMzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxMDM2NQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406510365", "bodyText": "The 5 minute low end estimate doesn't seem to be consistent with other steps that follow (we estimate that building from source takes about 6 minutes). Perhaps change to 10 minutes?", "author": "andrewmlim", "createdAt": "2020-04-09T22:23:23Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxMDQ1OA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406510458", "bodyText": "Open links in new tabs.", "author": "andrewmlim", "createdAt": "2020-04-09T22:23:40Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxNjEyMw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406516123", "bodyText": "Open link in new tab.", "author": "andrewmlim", "createdAt": "2020-04-09T22:40:20Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at `http://localhost:8080/nifi`).", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxNjcxMg==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406516712", "bodyText": "Need to fix link and open in new tab.", "author": "andrewmlim", "createdAt": "2020-04-09T22:42:11Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at `http://localhost:8080/nifi`).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080 or any listed in the `nifi-app.log` output).", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxNzExMQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406517111", "bodyText": "Open link in new tab.", "author": "andrewmlim", "createdAt": "2020-04-09T22:43:26Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at `http://localhost:8080/nifi`).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080 or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value. This is line 145 as of 1.11.4\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (`http://localhost:7777/nifi`)", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxNzY3Mg==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406517672", "bodyText": "I would suggest removing \"This is line 145 as of 1.11.4\". Don't feel it adds enough value especially since this may change frequently for future versions.", "author": "andrewmlim", "createdAt": "2020-04-09T22:45:16Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at `http://localhost:8080/nifi`).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080 or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value. This is line 145 as of 1.11.4", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUxODQ3Mw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406518473", "bodyText": "Link opens in new tab, but link syntax is incorrect so results in error.", "author": "andrewmlim", "createdAt": "2020-04-09T22:47:50Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at `http://localhost:8080/nifi`).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080 or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value. This is line 145 as of 1.11.4\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (`http://localhost:7777/nifi`)\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link://https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUyNzQzNQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406527435", "bodyText": "Broken link.", "author": "andrewmlim", "createdAt": "2020-04-09T23:17:39Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1097 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+This document is intended to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the <<overview.adoc,NiFi Overview>>, <<administrator-guide.adoc,NiFi System Administrator's Guide>>, and <<user-guide.adoc,NiFi User's Guide>>. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)].\n+\n+This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 5 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at `http://localhost:8080/nifi`).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080 or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value. This is line 145 as of 1.11.4\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (`http://localhost:7777/nifi`)\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link://https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see <<administration-guide.adoc#security_configuration,Administrator's Guide: Security Configuration>>.\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link://https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit", "originalCommit": "0d7dcf88aaee0dfe2142e97ff911de57db1ad23d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjU0MDY0OQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r406540649", "bodyText": "Typo: \"NiFI\" should be \"NiFi\".\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            . By default, NiFI waits for nodes to join for 5 minutes before the cluster is available. Because the number of nodes is known, this delay can be modified on each node to start up much faster. (Optional)\n          \n          \n            \n            . By default, NiFi waits for nodes to join for 5 minutes before the cluster is available. Because the number of nodes is known, this delay can be modified on each node to start up much faster. (Optional)", "author": "mtien-apache", "createdAt": "2020-04-10T00:07:30Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -1024,59 +1018,80 @@ NOTE: The `nifi.cluster.load.balance.host=` entry must be manually populated her\n ** `server.1=` -> `server.1=node1.nifi:2881:3881;2181`\n ** Add the line `server.2=node2.nifi:2882:3882;2182`\n ** Add the line `server.3=node3.nifi:2883:3883;2183`\n-* `cp node1.nifi/conf/zookeeper.properties node2.nifi/conf/zookeeper.properties node3.nifi/conf/zookeeper.properties` -- Copies the modified `zookeeper.properties` file from `node1` to `node2` and `node3`\n+* `cp node1.nifi/conf/zookeeper.properties node2.nifi/conf/zookeeper.properties` -- Copies the modified `zookeeper.properties` file from `node1` to `node2`\n+* `cp node1.nifi/conf/zookeeper.properties node3.nifi/conf/zookeeper.properties` -- Copies the modified `zookeeper.properties` file from `node1` to `node3`\n . Create the `myid` file on each node to identify the embedded ZooKeeper server.\n-* `mkdir -p node1.nifi/conf/state/zookeeper` -- Creates the ZooKeeper directory on `node1`\n-* `echo 1 >> node1.nifi/conf/state/zookeeper/myid` -- Creates the `myid` file with the `node1` identifier\n-* `mkdir -p node2.nifi/conf/state/zookeeper` -- Creates the ZooKeeper directory on `node2`\n-* `echo 2 >> node2.nifi/conf/state/zookeeper/myid` -- Creates the `myid` file with the `node2` identifier\n-* `mkdir -p node3.nifi/conf/state/zookeeper` -- Creates the ZooKeeper directory on `node3`\n-* `echo 3 >> node3.nifi/conf/state/zookeeper/myid` -- Creates the `myid` file with the `node3` identifier\n+* `mkdir -p node1.nifi/state/zookeeper` -- Creates the ZooKeeper directory on `node1`\n+* `echo 1 >> node1.nifi/state/zookeeper/myid` -- Creates the `myid` file with the `node1` identifier\n+* `mkdir -p node2.nifi/state/zookeeper` -- Creates the ZooKeeper directory on `node2`\n+* `echo 2 >> node2.nifi/state/zookeeper/myid` -- Creates the `myid` file with the `node2` identifier\n+* `mkdir -p node3.nifi/state/zookeeper` -- Creates the ZooKeeper directory on `node3`\n+* `echo 3 >> node3.nifi/state/zookeeper/myid` -- Creates the `myid` file with the `node3` identifier\n . Update the `state-management.xml` file on each node to allow ZooKeeper connections. The `state-management.xml` file can be identical on each node (assuming no other changes were made), so the modified file will be copied to the other nodes.\n * `$EDITOR node1.nifi/conf/state-management.xml` -- Opens the `state-management.xml` file in a text editor\n * Update the following line:\n ** `<property name=\"Connect String\"></property>` -> `<property name=\"Connect String\">node1.nifi:2181,node2.nifi:2182,node3.nifi:2183</property>`\n-* `cp node1.nifi/conf/state-management.xml node2.nifi/conf/state-management.xml node3.nifi/conf/state-management.xml` -- Copies the modified `state-management.xml` file from `node1` to `node2` and `node3`\n-\n-=== Step 6. Update the authorizers.xml File\n-Update the `authorizers.xml` for *each* node.\n-\n-. From a text editor, open the `authorizers.xml` file for the first node from `nifi/cluster/nifi1.xyz.com/conf`\n-. Locate the ``<userGroupProvider>`` section.\n-. Locate the line ``<property name=\"Initial User Identity 1\">CN=nifi-admin-client-cert, O=Example LLC</property>``\n-. Add the following new lines to specify the Initial User Identity for *each* node:\n-----\n-<property name=\"Initial User Identity 2\">CN=nifi1.xyz.com, OU=NIFI</property>\n-<property name=\"Initial User Identity 3\">CN=nifi2.xyz.com, OU=NIFI</property>\n-<property name=\"Initial User Identity 4\">CN=nifi3.xyz.com, OU=NIFI</property>\n-----\n+* `cp node1.nifi/conf/state-management.xml node2.nifi/conf/state-management.xml` -- Copies the modified `state-management.xml` file from `node1` to `node2`\n+* `cp node1.nifi/conf/state-management.xml node3.nifi/conf/state-management.xml` -- Copies the modified `state-management.xml` file from `node1` to `node3`\n+. Update the `authorizers.xml` file. This file contains the *Initial Node Identities* and *Initial User Identities*. The *users* consist of all human users _and_ all nodes in the cluster. The `authorizers.xml` file can be identical on each node (assuming no other changes were made), so the modified file will be copied to the other nodes.\n+* `$EDITOR node1.nifi/conf/authorizers.xml` -- Opens the `authorizers.xml` file in a text editor\n+* Update the following lines:\n+** In the `<userGroupProvider>` section, `<property name=\"Initial User Identity 1\"></property>` -> `<property name=\"Initial User Identity 1\">CN=my_username</property>` -- Adds an initial user with the DN generated in the client certificate. This is line 52 as of 1.11.4\n+** In the `<userGroupProvider>` section, add the line `<property name=\"Initial User Identity 2\">CN=node1.nifi, OU=NIFI</property>` -- Adds an initial user for `node1`\n+** In the `<userGroupProvider>` section, add the line `<property name=\"Initial User Identity 3\">CN=node2.nifi, OU=NIFI</property>` -- Adds an initial user for `node2`\n+** In the `<userGroupProvider>` section, add the line `<property name=\"Initial User Identity 4\">CN=node3.nifi, OU=NIFI</property>` -- Adds an initial user for `node3`\n +\n-image::tls-authorizers-file-userGroupProvider.png[userGroupProvider section in the authorizers file]\n-[start=5]\n-. Locate the ``<accessPolicyProvider>`` section.\n-. Locate the line ``<property name=\"Node Identity 1\"></property>``\n-. Add the CN and OU to the property: ``<property name=\"Node Identity 1\">CN=nifi1.xyz.com, OU=NIFI</property>``\n-. Add the following lines to specify the node identity for the remaining nodes:\n-----\n-<property name=\"Node Identity 2\">CN=nifi2.xyz.com, OU=NIFI</property>\n-<property name=\"Node Identity 3\">CN=nifi3.xyz.com, OU=NIFI</property>\n-----\n+image::authorizers-xml-initial-user-identities.png[\"authorizers.xml with Initial User Identities\"]\n+** In the `<accessPolicyProvider>` section, `<property name=\"Initial Admin Identity\"></property>` -> `<property name=\"Initial Admin Identity\">CN=my_username</property>` -- Adds an initial admin with the DN generated in the client certificate. This is line 280 as of 1.11.4\n+** In the `<accessPolicyProvider>` section, `<property name=\"Node Identity 1\"></property>` -> `<property name=\"Node Identity 1\">CN=node1.nifi, OU=NIFI</property>` -- Adds an initial node with the DN generated in the `node1` certificate. This is line 282 as of 1.11.4\n+** In the `<accessPolicyProvider>` section, add the line `<property name=\"Node Identity 2\">CN=node2.nifi, OU=NIFI</property>`\n+** In the `<accessPolicyProvider>` section, add the line `<property name=\"Node Identity 3\">CN=node3.nifi, OU=NIFI</property>`\n +\n-image::tls-authorizers-file-accessPolicyProvider.png[accessPolicyProvider section in the authorizers file]\n+image::authorizers-xml-initial-node-identities.png[\"authorizers.xml with Initial Node Identities\"]\n+* `cp node1.nifi/conf/authorizers.xml node2.nifi/conf/authorizers.xml` -- Copies the modified `authorizers.xml` file from `node1` to `node2`\n+* `cp node1.nifi/conf/authorizers.xml node3.nifi/conf/authorizers.xml` -- Copies the modified `authorizers.xml` file from `node1` to `node3`\n+. By default, NiFI waits for nodes to join for 5 minutes before the cluster is available. Because the number of nodes is known, this delay can be modified on each node to start up much faster. (Optional)", "originalCommit": "8ef64f5e0550de11f34df4e8446564c06cae151c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "34e6b60bb0225574dda956485da481234de1b36e", "url": "https://github.com/apache/nifi/commit/34e6b60bb0225574dda956485da481234de1b36e", "message": "NIFI-7319 Incorporated PR feedback on broken links.", "committedDate": "2020-04-10T00:31:02Z", "type": "commit"}, {"oid": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "url": "https://github.com/apache/nifi/commit/fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "message": "NIFI-7319 Removed line number helpers from update sections.", "committedDate": "2020-04-10T00:34:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwMzg1NQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407003855", "bodyText": "Can leave as is, but these links do not need to open in a new tab since they are included in the built-in help.", "author": "andrewmlim", "createdAt": "2020-04-11T02:07:02Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxODYzOQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407018639", "bodyText": "I did change these intentionally so if a user clicks them they don't lose their place here (since they are for \"more information\", the user will likely want both open).", "author": "alopresto", "createdAt": "2020-04-11T05:01:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwMzg1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwNDcxMA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407004710", "bodyText": "Can leave as is, but this link does not need to open in a new tab since it opens a doc that is in the built-in help.", "author": "andrewmlim", "createdAt": "2020-04-11T02:15:38Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwNDgxNw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407004817", "bodyText": "Can leave as is, but the Toolkit link does not need to open in a new tab since it opens a doc that is in the built-in help.", "author": "andrewmlim", "createdAt": "2020-04-11T02:16:45Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwODAxMg==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407008012", "bodyText": "Can leave as is, but these links do not have to open in new tab.", "author": "andrewmlim", "createdAt": "2020-04-11T02:50:11Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwODQ0NA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407008444", "bodyText": "Perhaps blur out the unrelated certs.", "author": "andrewmlim", "createdAt": "2020-04-11T02:55:36Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwODU1Nw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407008557", "bodyText": "Can keep link in current browser tab.", "author": "andrewmlim", "createdAt": "2020-04-11T02:57:07Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwOTAwOA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407009008", "bodyText": "Can keep link in current browser tab.", "author": "andrewmlim", "createdAt": "2020-04-11T03:02:24Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwOTQzNw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407009437", "bodyText": "Seems like \"necessary\" at the end of the first sentence can be removed. Or is the intent more like \"Converting the PKCS12...into the Java KeyStore file is necessary?", "author": "andrewmlim", "createdAt": "2020-04-11T03:07:10Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwOTUzMw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407009533", "bodyText": "Add a comma after \"Optionally\".", "author": "andrewmlim", "createdAt": "2020-04-11T03:08:18Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwOTY5Mg==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407009692", "bodyText": "For consistency with previous examples, the open.ssl command should be a separate bullet point.", "author": "andrewmlim", "createdAt": "2020-04-11T03:10:07Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAwOTg2NQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407009865", "bodyText": "Link doesn't work. I don't think that anchor exists.", "author": "andrewmlim", "createdAt": "2020-04-11T03:12:08Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice\n+\n+From this point, the instructions are identical to those using the TLS Toolkit, starting at <<load-client-certificate-to-browser,Loading the client certificate in the browser>>.", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMDAwNg==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407010006", "bodyText": "Can keep link in current browser tab.", "author": "andrewmlim", "createdAt": "2020-04-11T03:13:40Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice\n+\n+From this point, the instructions are identical to those using the TLS Toolkit, starting at <<load-client-certificate-to-browser,Loading the client certificate in the browser>>.\n+\n+==== Securing NiFi with TLS Toolkit and Provided Intermediate CA\n+\n+Occasionally, an IT department will provide an intermediate CA certificate which is signed by a trusted certificate and can be used to generate server and client certificates on-demand by the NiFi admin without further intervention by the IT department. The TLS toolkit provides a mechanism to use the intermediate certificate to sign generated certificates.\n+\n+The end result will consist of a self-signed external CA (the root), an intermediate CA used to sign NiFi certificates, a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+// TODO: Write\n+CAUTION: Develop section\n+\n+== Deploying a NiFi Cluster\n+\n+Apache NiFi can run in either _standalone_ or _clustered_ mode. A standalone node is often sufficient for dataflow operations, but in a production or high-volume environment, a cluster is more performant and resilient. For more information, see link:administration-guide.html#clustering[NiFi Administrator's Guide: Clustering^].", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMDMzOA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407010338", "bodyText": "I realize this section is still under development, but perhaps add a similar table to what exists for the secured cluster version. It will give some context even to the brief 3 steps currently provided.", "author": "andrewmlim", "createdAt": "2020-04-11T03:17:59Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice\n+\n+From this point, the instructions are identical to those using the TLS Toolkit, starting at <<load-client-certificate-to-browser,Loading the client certificate in the browser>>.\n+\n+==== Securing NiFi with TLS Toolkit and Provided Intermediate CA\n+\n+Occasionally, an IT department will provide an intermediate CA certificate which is signed by a trusted certificate and can be used to generate server and client certificates on-demand by the NiFi admin without further intervention by the IT department. The TLS toolkit provides a mechanism to use the intermediate certificate to sign generated certificates.\n+\n+The end result will consist of a self-signed external CA (the root), an intermediate CA used to sign NiFi certificates, a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+// TODO: Write\n+CAUTION: Develop section\n+\n+== Deploying a NiFi Cluster\n+\n+Apache NiFi can run in either _standalone_ or _clustered_ mode. A standalone node is often sufficient for dataflow operations, but in a production or high-volume environment, a cluster is more performant and resilient. For more information, see link:administration-guide.html#clustering[NiFi Administrator's Guide: Clustering^].\n+\n+=== Creating a NiFi Cluster\n+\n+// TODO: Write\n+CAUTION: Needs a diagram\n+\n+CAUTION: Develop section\n+\n+. Copy the NiFi run directory 3x\n+. Configure the settings\n+. Start each node\n+\n+// TODO: Write\n+=== Creating and Securing a NiFi Cluster with the TLS Toolkit\n+", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMDczMw==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407010733", "bodyText": "This might just be personal preference, so feel free to disregard. But since there aren't that many numbers to display within the ranges given, I thought it might be more readable/ understandable to just state them all. As an example:\n2181, 2182, 2183 - ZooKeeper ports", "author": "andrewmlim", "createdAt": "2020-04-11T03:22:51Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice\n+\n+From this point, the instructions are identical to those using the TLS Toolkit, starting at <<load-client-certificate-to-browser,Loading the client certificate in the browser>>.\n+\n+==== Securing NiFi with TLS Toolkit and Provided Intermediate CA\n+\n+Occasionally, an IT department will provide an intermediate CA certificate which is signed by a trusted certificate and can be used to generate server and client certificates on-demand by the NiFi admin without further intervention by the IT department. The TLS toolkit provides a mechanism to use the intermediate certificate to sign generated certificates.\n+\n+The end result will consist of a self-signed external CA (the root), an intermediate CA used to sign NiFi certificates, a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+// TODO: Write\n+CAUTION: Develop section\n+\n+== Deploying a NiFi Cluster\n+\n+Apache NiFi can run in either _standalone_ or _clustered_ mode. A standalone node is often sufficient for dataflow operations, but in a production or high-volume environment, a cluster is more performant and resilient. For more information, see link:administration-guide.html#clustering[NiFi Administrator's Guide: Clustering^].\n+\n+=== Creating a NiFi Cluster\n+\n+// TODO: Write\n+CAUTION: Needs a diagram\n+\n+CAUTION: Develop section\n+\n+. Copy the NiFi run directory 3x\n+. Configure the settings\n+. Start each node\n+\n+// TODO: Write\n+=== Creating and Securing a NiFi Cluster with the TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on configuring and securing a 3 node cluster\n+|Purpose            | A NiFi cluster can perform flow operations in parallel and provide resiliency if nodes are unavailable.\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | 3 nodes of latest version of Apache NiFi in secured cluster running on local machine\n+|Helpful Reading    | <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>, <<creating-a-nifi-cluster,Creating a NiFi Cluster>>\n+|Estimated Duration | 15 minutes\n+|=======================================================================================================================\n+\n+Similar to a standalone instance, a NiFi cluster must have TLS configured to enable authentication and authorization mechanisms. However, the cluster communication protocol used by NiFi and the framework authentication and authorization must also be configured to allow nodes to communicate.\n+\n+For this guide, the three nodes will be referred to as `node1`, `node2`, and `node3`. Each will have a `$NIFI_HOME` environment variable which points to the respective \"NiFi home directory\".\n+\n+Prerequisites:\n+\n+* DNS configuration for three hosts using the addresses `node1.nifi`, `node2.nifi`, `node3.nifi`\n+** This can be all side-by-side on the same physical host, using virtual machines, or using independent physical machines\n+* Ports open to allow the nodes to communicate\n+** If these machines are subject to a firewall, ensure that the following ports are open:\n+*** `2181`, `2888`, `3888` -- ZooKeeper ports\n+*** `6342` -- Load-balancing port\n+*** `9443` -- HTTPS port for NiFi UI/API\n+*** `10443` -- Site to site port\n+*** `11443` -- Cluster communications port\n+** If all the nodes will run on the same machine, the port scheme will end in the respective node identifier to avoid conflicts (e.g. HTTPS port `9441` for `node1`, `9442` for `node2`, `9443` for `node3`). Ensure that the following ports are open:\n+*** `2181` - `2183` -- ZooKeeper ports", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMDg4MQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407010881", "bodyText": "Don't have to fix for this version, but some of the text is difficult to read in this image.", "author": "andrewmlim", "createdAt": "2020-04-11T03:24:22Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice\n+\n+From this point, the instructions are identical to those using the TLS Toolkit, starting at <<load-client-certificate-to-browser,Loading the client certificate in the browser>>.\n+\n+==== Securing NiFi with TLS Toolkit and Provided Intermediate CA\n+\n+Occasionally, an IT department will provide an intermediate CA certificate which is signed by a trusted certificate and can be used to generate server and client certificates on-demand by the NiFi admin without further intervention by the IT department. The TLS toolkit provides a mechanism to use the intermediate certificate to sign generated certificates.\n+\n+The end result will consist of a self-signed external CA (the root), an intermediate CA used to sign NiFi certificates, a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+// TODO: Write\n+CAUTION: Develop section\n+\n+== Deploying a NiFi Cluster\n+\n+Apache NiFi can run in either _standalone_ or _clustered_ mode. A standalone node is often sufficient for dataflow operations, but in a production or high-volume environment, a cluster is more performant and resilient. For more information, see link:administration-guide.html#clustering[NiFi Administrator's Guide: Clustering^].\n+\n+=== Creating a NiFi Cluster\n+\n+// TODO: Write\n+CAUTION: Needs a diagram\n+\n+CAUTION: Develop section\n+\n+. Copy the NiFi run directory 3x\n+. Configure the settings\n+. Start each node\n+\n+// TODO: Write\n+=== Creating and Securing a NiFi Cluster with the TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on configuring and securing a 3 node cluster\n+|Purpose            | A NiFi cluster can perform flow operations in parallel and provide resiliency if nodes are unavailable.\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | 3 nodes of latest version of Apache NiFi in secured cluster running on local machine\n+|Helpful Reading    | <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>, <<creating-a-nifi-cluster,Creating a NiFi Cluster>>\n+|Estimated Duration | 15 minutes\n+|=======================================================================================================================\n+\n+Similar to a standalone instance, a NiFi cluster must have TLS configured to enable authentication and authorization mechanisms. However, the cluster communication protocol used by NiFi and the framework authentication and authorization must also be configured to allow nodes to communicate.\n+\n+For this guide, the three nodes will be referred to as `node1`, `node2`, and `node3`. Each will have a `$NIFI_HOME` environment variable which points to the respective \"NiFi home directory\".\n+\n+Prerequisites:\n+\n+* DNS configuration for three hosts using the addresses `node1.nifi`, `node2.nifi`, `node3.nifi`\n+** This can be all side-by-side on the same physical host, using virtual machines, or using independent physical machines\n+* Ports open to allow the nodes to communicate\n+** If these machines are subject to a firewall, ensure that the following ports are open:\n+*** `2181`, `2888`, `3888` -- ZooKeeper ports\n+*** `6342` -- Load-balancing port\n+*** `9443` -- HTTPS port for NiFi UI/API\n+*** `10443` -- Site to site port\n+*** `11443` -- Cluster communications port\n+** If all the nodes will run on the same machine, the port scheme will end in the respective node identifier to avoid conflicts (e.g. HTTPS port `9441` for `node1`, `9442` for `node2`, `9443` for `node3`). Ensure that the following ports are open:\n+*** `2181` - `2183` -- ZooKeeper ports\n+*** `2881` - `2883` -- ZooKeeper ports\n+*** `3881` - `3883` -- ZooKeeper ports\n+*** `6341` - `6343` -- Load-balancing port\n+*** `9441` - `9443` -- HTTPS port for NiFi UI/API\n+*** `10441` - `10443` -- Site to site port\n+*** `11441` - `11443` -- Cluster communications port\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for each NiFi node to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-cluster-tls-toolkit-certificate-diagram.png[\"NiFi Cluster with TLS Toolkit Certificates Diagram\"]", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMDk0MQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407010941", "bodyText": "Toolkit link can open in current tab.", "author": "andrewmlim", "createdAt": "2020-04-11T03:25:14Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice\n+\n+From this point, the instructions are identical to those using the TLS Toolkit, starting at <<load-client-certificate-to-browser,Loading the client certificate in the browser>>.\n+\n+==== Securing NiFi with TLS Toolkit and Provided Intermediate CA\n+\n+Occasionally, an IT department will provide an intermediate CA certificate which is signed by a trusted certificate and can be used to generate server and client certificates on-demand by the NiFi admin without further intervention by the IT department. The TLS toolkit provides a mechanism to use the intermediate certificate to sign generated certificates.\n+\n+The end result will consist of a self-signed external CA (the root), an intermediate CA used to sign NiFi certificates, a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+// TODO: Write\n+CAUTION: Develop section\n+\n+== Deploying a NiFi Cluster\n+\n+Apache NiFi can run in either _standalone_ or _clustered_ mode. A standalone node is often sufficient for dataflow operations, but in a production or high-volume environment, a cluster is more performant and resilient. For more information, see link:administration-guide.html#clustering[NiFi Administrator's Guide: Clustering^].\n+\n+=== Creating a NiFi Cluster\n+\n+// TODO: Write\n+CAUTION: Needs a diagram\n+\n+CAUTION: Develop section\n+\n+. Copy the NiFi run directory 3x\n+. Configure the settings\n+. Start each node\n+\n+// TODO: Write\n+=== Creating and Securing a NiFi Cluster with the TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on configuring and securing a 3 node cluster\n+|Purpose            | A NiFi cluster can perform flow operations in parallel and provide resiliency if nodes are unavailable.\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | 3 nodes of latest version of Apache NiFi in secured cluster running on local machine\n+|Helpful Reading    | <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>, <<creating-a-nifi-cluster,Creating a NiFi Cluster>>\n+|Estimated Duration | 15 minutes\n+|=======================================================================================================================\n+\n+Similar to a standalone instance, a NiFi cluster must have TLS configured to enable authentication and authorization mechanisms. However, the cluster communication protocol used by NiFi and the framework authentication and authorization must also be configured to allow nodes to communicate.\n+\n+For this guide, the three nodes will be referred to as `node1`, `node2`, and `node3`. Each will have a `$NIFI_HOME` environment variable which points to the respective \"NiFi home directory\".\n+\n+Prerequisites:\n+\n+* DNS configuration for three hosts using the addresses `node1.nifi`, `node2.nifi`, `node3.nifi`\n+** This can be all side-by-side on the same physical host, using virtual machines, or using independent physical machines\n+* Ports open to allow the nodes to communicate\n+** If these machines are subject to a firewall, ensure that the following ports are open:\n+*** `2181`, `2888`, `3888` -- ZooKeeper ports\n+*** `6342` -- Load-balancing port\n+*** `9443` -- HTTPS port for NiFi UI/API\n+*** `10443` -- Site to site port\n+*** `11443` -- Cluster communications port\n+** If all the nodes will run on the same machine, the port scheme will end in the respective node identifier to avoid conflicts (e.g. HTTPS port `9441` for `node1`, `9442` for `node2`, `9443` for `node3`). Ensure that the following ports are open:\n+*** `2181` - `2183` -- ZooKeeper ports\n+*** `2881` - `2883` -- ZooKeeper ports\n+*** `3881` - `3883` -- ZooKeeper ports\n+*** `6341` - `6343` -- Load-balancing port\n+*** `9441` - `9443` -- HTTPS port for NiFi UI/API\n+*** `10441` - `10443` -- Site to site port\n+*** `11441` - `11443` -- Cluster communications port\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for each NiFi node to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-cluster-tls-toolkit-certificate-diagram.png[\"NiFi Cluster with TLS Toolkit Certificates Diagram\"]\n+\n+. Create the NiFi Client Certificates. When using the `standalone` mode of the TLS Toolkit, it is important that *all certificates are generated from the same instance, using the same generated NiFi CA certificate to sign each*. The certificates can be generated by a single command, or individually. By default, the Distinguished Name (DN) will be `CN=<provided_hostname>, OU=NIFI`. For more information on toolkit flag options, see link:toolkit-guide.html#usage-8[NiFi Toolkit Guide: TLS Toolkit Usage^].", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMTIwNA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407011204", "bodyText": "Second Zookeeper link can open in current browser tab.", "author": "andrewmlim", "createdAt": "2020-04-11T03:28:47Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice\n+\n+From this point, the instructions are identical to those using the TLS Toolkit, starting at <<load-client-certificate-to-browser,Loading the client certificate in the browser>>.\n+\n+==== Securing NiFi with TLS Toolkit and Provided Intermediate CA\n+\n+Occasionally, an IT department will provide an intermediate CA certificate which is signed by a trusted certificate and can be used to generate server and client certificates on-demand by the NiFi admin without further intervention by the IT department. The TLS toolkit provides a mechanism to use the intermediate certificate to sign generated certificates.\n+\n+The end result will consist of a self-signed external CA (the root), an intermediate CA used to sign NiFi certificates, a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+// TODO: Write\n+CAUTION: Develop section\n+\n+== Deploying a NiFi Cluster\n+\n+Apache NiFi can run in either _standalone_ or _clustered_ mode. A standalone node is often sufficient for dataflow operations, but in a production or high-volume environment, a cluster is more performant and resilient. For more information, see link:administration-guide.html#clustering[NiFi Administrator's Guide: Clustering^].\n+\n+=== Creating a NiFi Cluster\n+\n+// TODO: Write\n+CAUTION: Needs a diagram\n+\n+CAUTION: Develop section\n+\n+. Copy the NiFi run directory 3x\n+. Configure the settings\n+. Start each node\n+\n+// TODO: Write\n+=== Creating and Securing a NiFi Cluster with the TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on configuring and securing a 3 node cluster\n+|Purpose            | A NiFi cluster can perform flow operations in parallel and provide resiliency if nodes are unavailable.\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | 3 nodes of latest version of Apache NiFi in secured cluster running on local machine\n+|Helpful Reading    | <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>, <<creating-a-nifi-cluster,Creating a NiFi Cluster>>\n+|Estimated Duration | 15 minutes\n+|=======================================================================================================================\n+\n+Similar to a standalone instance, a NiFi cluster must have TLS configured to enable authentication and authorization mechanisms. However, the cluster communication protocol used by NiFi and the framework authentication and authorization must also be configured to allow nodes to communicate.\n+\n+For this guide, the three nodes will be referred to as `node1`, `node2`, and `node3`. Each will have a `$NIFI_HOME` environment variable which points to the respective \"NiFi home directory\".\n+\n+Prerequisites:\n+\n+* DNS configuration for three hosts using the addresses `node1.nifi`, `node2.nifi`, `node3.nifi`\n+** This can be all side-by-side on the same physical host, using virtual machines, or using independent physical machines\n+* Ports open to allow the nodes to communicate\n+** If these machines are subject to a firewall, ensure that the following ports are open:\n+*** `2181`, `2888`, `3888` -- ZooKeeper ports\n+*** `6342` -- Load-balancing port\n+*** `9443` -- HTTPS port for NiFi UI/API\n+*** `10443` -- Site to site port\n+*** `11443` -- Cluster communications port\n+** If all the nodes will run on the same machine, the port scheme will end in the respective node identifier to avoid conflicts (e.g. HTTPS port `9441` for `node1`, `9442` for `node2`, `9443` for `node3`). Ensure that the following ports are open:\n+*** `2181` - `2183` -- ZooKeeper ports\n+*** `2881` - `2883` -- ZooKeeper ports\n+*** `3881` - `3883` -- ZooKeeper ports\n+*** `6341` - `6343` -- Load-balancing port\n+*** `9441` - `9443` -- HTTPS port for NiFi UI/API\n+*** `10441` - `10443` -- Site to site port\n+*** `11441` - `11443` -- Cluster communications port\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for each NiFi node to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-cluster-tls-toolkit-certificate-diagram.png[\"NiFi Cluster with TLS Toolkit Certificates Diagram\"]\n+\n+. Create the NiFi Client Certificates. When using the `standalone` mode of the TLS Toolkit, it is important that *all certificates are generated from the same instance, using the same generated NiFi CA certificate to sign each*. The certificates can be generated by a single command, or individually. By default, the Distinguished Name (DN) will be `CN=<provided_hostname>, OU=NIFI`. For more information on toolkit flag options, see link:toolkit-guide.html#usage-8[NiFi Toolkit Guide: TLS Toolkit Usage^].\n+.. Navigate to the `nifi-toolkit-1.11.4/` directory.\n+* `cd /etc/nifi-toolkit-1.11.4/` -- Changes to the toolkit directory\n+.. Generate the certificates. Running these commands first generates the NiFi CA public certificate and private key if not present, then generates the server certificates, followed by the client certificate necessary for the *Initial Admin Identity*. An alternative command performing all the steps sequentially is also provided.\n+* `./bin/tls-toolkit.sh standalone -n 'node1.nifi' -c 'ca.nifi'` -- Generates the NiFi CA (`ca.nifi`) certificate and key if not present and generates and signs `node1` certificate, placing the `keystore.jks`, `truststore.jks`, and populated `nifi.properties` in a subdirectory called `node1.nifi`\n++\n+--\n+_Note the creation of the CA certificate and key_\n+[source]\n+----\n+% ./bin/tls-toolkit.sh standalone -n 'node1.nifi' -c 'ca.nifi'\n+2020/04/06 18:12:07 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/06 18:12:07 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/node1.nifi\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for node1.nifi 1 in ../nifi-toolkit-1.11.4/node1.nifi\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+% ls -alGh node1.nifi\n+total 48\n+drwx------   5 alopresto  staff   160B Apr  6 18:12 .\n+drwxr-xr-x  11 alopresto  staff   352B Apr  6 18:12 ..\n+-rw-------   1 alopresto  staff   3.0K Apr  6 18:12 keystore.jks\n+-rw-------   1 alopresto  staff    12K Apr  6 18:12 nifi.properties\n+-rw-------   1 alopresto  staff   895B Apr  6 18:12 truststore.jks\n+----\n+--\n+* `./bin/tls-toolkit.sh standalone -n 'node2.nifi'` -- Generates and signs `node2` certificate with the same CA\n++\n+--\n+_Note the existing CA certificate being used_\n+[source]\n+----\n+% ./bin/tls-toolkit.sh standalone -n 'node2.nifi'\n+2020/04/06 18:13:13 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=ca.nifi,OU=NIFI\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=ca.nifi,OU=NIFI signature with CN=ca.nifi,OU=NIFI\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=ca.nifi,OU=NIFI\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/node2.nifi\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for node2.nifi 1 in ../nifi-toolkit-1.11.4/node2.nifi\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+--\n+* `./bin/tls-toolkit.sh standalone -n 'node3.nifi'` -- Generates and signs `node3` certificate with the same CA\n++\n+[source]\n+----\n+% ./bin/tls-toolkit.sh standalone -n 'node3.nifi'\n+2020/04/06 18:53:07 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=ca.nifi,OU=NIFI signature with CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/node3.nifi\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for node3.nifi 1 in ../nifi-toolkit-1.11.4/node3.nifi\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+* `./bin/tls-toolkit.sh standalone -C 'CN=my_username'` -- Generates and signs `my_username` client certificate with the same CA\n++\n+[source]\n+----\n+% ./bin/tls-toolkit.sh standalone -C 'CN=my_username'\n+2020/04/06 18:53:19 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=ca.nifi,OU=NIFI signature with CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username.p12\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username.p12\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n++\n+--\n+The resulting directory will contain 7 new entries:\n+\n+** `CN=my_username.p12` -- The client certificate in a PKCS12 keystore\n+** `CN=my_username.password` -- The corresponding file containing the randomly-generated password. Use `-b` or `--clientCertPassword` when generating to specify a password\n+** `nifi-cert.pem` -- The CA certificate in PEM format\n+** `nifi-key.key` -- The corresponding CA private key in PEM format\n+** `node1.nifi/` -- The directory containing `node1` keystore and related files\n+** `node2.nifi/` -- The directory containing `node2` keystore and related files\n+** `node3.nifi/` -- The directory containing `node3` keystore and related files\n+--\n+Optional command to execute all steps together using the toolkit pattern syntax:\n+* `./bin/tls-toolkit.sh -n 'node[1-3].nifi' -C 'CN=my_username' -c 'ca.nifi'` -- Performs all steps listed above simultaneously\n+. Create a new `nifi_cluster` folder in an appropriate location. In this example, where all three nodes will run on the same machine, the `/etc/nifi_cluster` directory is used. All further instructions occur from this directory.\n+* `mkdir /etc/nifi_cluster` -- Creates the working directory\n+* `cd /etc/nifi_cluster` -- Change to the created directory\n+. Copy the NiFi installation folder (i.e. `nifi-1.11.4`) to a new folder for *each* node in the `nifi_cluster` folder created in the previous step.\n+* `mkdir node1.nifi && cp -R /etc/nifi-1.11.4 node1.nifi` -- Creates the `node1` directory and copies the NiFi application into it\n+* `mkdir node2.nifi && cp -R /etc/nifi-1.11.4 node2.nifi` -- Creates the `node2` directory and copies the NiFi application into it\n+* `mkdir node3.nifi && cp -R /etc/nifi-1.11.4 node3.nifi` -- Creates the `node3` directory and copies the NiFi application into it\n+. Copy the generated `keystore.jks`, `truststore.jks`, and `nifi.properties` to the `conf/` directory of *each* node.\n+* `cp -R /etc/nifi-toolkit-1.11.4/node1.nifi/* node1.nifi/conf/.` -- Copies the `node1` files\n+* `cp -R /etc/nifi-toolkit-1.11.4/node2.nifi/* node2.nifi/conf/.` -- Copies the `node2` files\n+* `cp -R /etc/nifi-toolkit-1.11.4/node3.nifi/* node3.nifi/conf/.` -- Copies the `node3` files\n+. Modify the `nifi.properties` file for each node to set the appropriate ports and enable the embedded link:https://zookeeper.apache.org/[ZooKeeper^] server. *If the nodes are being deployed to separate physical or virtual machines (such that each is treated as an independent host for networking), modifying the ports is not required, but enabling the embedded ZooKeeper servers is*. If the nodes are being deployed on the same machine such that the ports cannot conflict, all parts of this step are required. This port selection convention follows the pattern defined at the top of this section, where the last digit corresponds to the node identifier. For more information on ZooKeeper configuration for NiFi, see link:administration-guide.html#embedded_zookeeper[NiFi Administrator's Guide: Embedded ZooKeeper^].", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMTYyMA==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407011620", "bodyText": "Should open this link in a new tab.", "author": "andrewmlim", "createdAt": "2020-04-11T03:33:54Z", "path": "nifi-docs/src/main/asciidoc/walkthroughs.adoc", "diffHunk": "@@ -0,0 +1,1099 @@\n+//\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//     http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+//\n+= Apache NiFi Walkthroughs\n+Apache NiFi Team <dev@nifi.apache.org>\n+:homepage: http://nifi.apache.org\n+:linkattrs:\n+\n+== Purpose\n+The intent of this document is to provide a canonical source of prescriptive instruction sets for common administrator and user tasks using Apache NiFi. It is intended to complement the link:overview.html[NiFi Overview^], link:administration-guide.html[NiFi System Administrator's Guide^], and link:user-guide.html[NiFi User's Guide^]. Those documents provide extensive reference information about various features and configuration values, but they do not provide information on _how_ to accomplish tasks.\n+\n+This document is _not_ intended to be a comprehensive repository of all possible admin or user activities, but rather a collection of well-documented reference activities which can be followed directly or adapted to custom scenarios. This document requires continued updates as application or ecosystem behavior changes, and corrections and improvements where the content is unclear to the community. To contribute to this document, please link:https://issues.apache.org/jira/secure/CreateIssue!default.jspa[open a Jira^] (see link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide#ContributorGuide-WheretoStart?[further instructions in the Contributor Guide^]) and link:https://github.com/apache/nifi/pulls[submit a pull request (PR)^].\n+\n+NOTE: This document is provided with no warranty. All steps have been evaluated for correctness to the extent possible by the Apache NiFi community, but no responsibility is assumed for negative impacts on any computer system where these commands are executed.\n+\n+== Installing Apache NiFi\n+\n+Apache NiFi is an easy to use, powerful, and reliable system to process and distribute data. It supports powerful and scalable directed graphs of data routing, transformation, and system mediation logic. In addition to NiFi, there is the NiFi Toolkit, a collection of command-line tools which help perform administrative tasks such as interacting with remote services, generating TLS certificates, managing nodes in a cluster, and encrypting sensitive configuration values.  \n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi application and Toolkit\n+|Purpose            | To make the application available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 1 minute + download time\n+|=======================================================================================================================\n+\n+NOTE: The following instructions are for installing a single node of NiFi. This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi via the compressed binary files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-bin.tar.gz` [1.2 GB]\n+* `nifi-toolkit-1.11.4-bin.tar.gz` [42 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n++\n+image::install-download-link.png[\"Download site\"]\n+. Note that the `nifi-1.11.4-bin.tar.gz` and the `nifi-toolkit-1.11.4-bin.tar.gz` compressed files are downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for those files. They are found on the initial download page next to each binary file.\n+* `gpg --verify -v nifi-1.11.4-bin.tar.gz.asc` -- Verifies the GPG signature provided on the binary by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-bin.tar.gz` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-bin.tar.gz.sha512` for equality\n++\n+image::verify-release-gpg-and-checksums.png[\"Verifying the GPG signature and checksums]\n+. Extract the files from each `tar.gz` file. This can be done by double-clicking on the files in the Finder or running the following commands in the terminal.\n+  * `tar -xvzf nifi-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-1.11.4/`\n+  * `tar -xvzf nifi-toolkit-1.11.4-bin.tar.gz` -- Uncompresses the `gzip` file and extracts the `tar` archive contents to `nifi-toolkit-1.11.4/`\n+. Optionally, move the folders to a more appropriate location.\n+\n+== Building NiFi From Source\n+\n+|=======================================================================================================================\n+|Description        | Instructions on downloading the Apache NiFi source code and building the application locally\n+|Purpose            | To make the application (with potential code modifications) available to run on the specified machine (e.g. a local development environment)\n+|Starting Point     | Machine running modern OS\n+|Expected Outcome   | Latest version of Apache NiFi available to run on host with no configuration\n+|Estimated Duration | 10 - 35 minutes + download time\n+|=======================================================================================================================\n+\n+NOTE: This guide assumes Mac OS X / macOS 10.11.0+ but should work for any modern operating system. *nix commands are used by default, but Windows equivalents are provided where available.\n+\n+. Go to the link:http://nifi.apache.org/download.html[Apache NiFi Downloads^] page.\n+. Download the latest version of NiFi source code via the compressed files. For example, if the latest version is 1.11.4:\n+* `nifi-1.11.4-source-release.zip` [53 MB]\n+. If you are directed to a mirror page, click the first link on the page to download the respective archive file.\n+. Note that the `nifi-1.11.4-source-release.zip` compressed file is downloaded to your `Downloads` folder.\n+. Download the GPG signature and checksums for the file. They are found on the initial download page next to the archive file.\n+* `gpg --verify -v nifi-1.11.4-source-release.zip.asc` -- Verifies the GPG signature provided on the archive by the Release Manager (RM). See link:https://nifi.apache.org/gpg.html#verifying-a-release-signature[NiFi GPG Guide: Verifying a Release Signature^] for further details\n+* `shasum -a 256 nifi-1.11.4-source-release.zip` -- Calculates a SHA-256 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha256` for equality\n+* `shasum -a 512 nifi-1.11.4-source-release.zip` -- Calculates a SHA-512 checksum over the downloaded artifact. This should be compared with the contents of `nifi-1.11.4-source-release.zip.sha512` for equality\n+. Extract the files from the `zip` file. This can be done by double-clicking on the file in the Finder or running the following command in the terminal.\n+* `unzip nifi-1.11.4-source-release.zip` -- Uncompresses the `zip` file and extracts the archive contents to `nifi-1.11.4/`\n+. Optionally, move the folder to a more appropriate location.\n++\n+[source]\n+----\n+nifi-1.11.4/ % ls -alGh\n+total 328\n+drwxr-xr-x  25 alopresto  staff   800B Apr  6 15:48 ./\n+drwxr-xr-x   8 alopresto  staff   256B Apr  4 18:01 ../\n+drwxr-xr-x   4 alopresto  staff   128B Jan 22 15:10 .github/\n+-rw-r--r--   1 alopresto  staff   254B Jan 22 15:10 DEPENDENCIES\n+-rw-r--r--   1 alopresto  staff    66K Jan 22 15:10 KEYS\n+-rw-r--r--   1 alopresto  staff    21K Jan 22 15:10 LICENSE\n+-rw-r--r--   1 alopresto  staff   7.1K Jan 22 15:10 NOTICE\n+-rw-r--r--   1 alopresto  staff   9.1K Jan 22 15:10 README.md\n+-rw-r--r--   1 alopresto  staff   3.3K Jan 22 15:10 SECURITY.md\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-api/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:50 nifi-assembly/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-bootstrap/\n+drwxr-xr-x  23 alopresto  staff   736B Apr  6 15:44 nifi-commons/\n+drwxr-xr-x   9 alopresto  staff   288B Apr  6 15:44 nifi-docker/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-docs/\n+drwxr-xr-x   8 alopresto  staff   256B Apr  6 15:44 nifi-external/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:44 nifi-framework-api/\n+drwxr-xr-x   6 alopresto  staff   192B Apr  6 15:44 nifi-maven-archetypes/\n+drwxr-xr-x   5 alopresto  staff   160B Apr  6 15:45 nifi-mock/\n+drwxr-xr-x  82 alopresto  staff   2.6K Apr  6 15:44 nifi-nar-bundles/\n+drwxr-xr-x   7 alopresto  staff   224B Apr  6 15:44 nifi-system-tests/\n+drwxr-xr-x  14 alopresto  staff   448B Apr  6 15:44 nifi-toolkit/\n+-rw-r--r--   1 alopresto  staff    44K Jan 22 15:10 pom.xml\n+----\n+. Build the NiFi source using link:https://maven.apache.org/[Apache Maven^] from the source root directory (`nifi-1.11.4/`) using one of the following commands. For more information, see the link:https://cwiki.apache.org/confluence/display/NIFI/Contributor+Guide[NiFi Contributor Guide^]. Estimated build times for each command on a modern professional laptop are listed below; allow additional time for dependency library downloads on first build.\n+* `mvn clean install -Pinclude-grpc` -- Builds the application (expected time ~30 minutes)\n+* `mvn clean install -T2.0C` -- Builds the application with multiple parallel threads (expected time ~15 minutes)\n+* `mvn clean install -T2.0C -DskipTests` -- Builds the application with multiple parallel threads and unit tests disabled (expected time ~6 minutes)\n++\n+[source]\n+----\n+nifi-1.11.4/ % mvn clean install -T2.0C -DskipTests\n+...\n+------------------------------------------------------------------------\n+Reactor Summary for nifi 1.11.4:\n+\n+nifi ............................................... SUCCESS [  0.834 s]\n+nifi-api ........................................... SUCCESS [  8.799 s]\n+nifi-framework-api ................................. SUCCESS [ 12.020 s]\n+nifi-commons ....................................... SUCCESS [  0.253 s]\n+nifi-utils ......................................... SUCCESS [ 16.029 s]\n+nifi-properties .................................... SUCCESS [  6.863 s]\n+nifi-security-utils ................................ SUCCESS [ 14.682 s]\n+nifi-nar-bundles ................................... SUCCESS [  0.279 s]\n+nifi-framework-bundle .............................. SUCCESS [  0.358 s]\n+nifi-framework ..................................... SUCCESS [  1.538 s]\n+nifi-properties-loader ............................. SUCCESS [ 14.153 s]\n+...\n+nifi-system-test-suite ............................. SUCCESS [  3.999 s]\n+------------------------------------------------------------------------\n+BUILD SUCCESS\n+------------------------------------------------------------------------\n+Total time:  06:17 min (Wall Clock)\n+Finished at: 2020-04-06T15:50:35-07:00\n+------------------------------------------------------------------------\n+----\n+. The resulting application is available in the build directory (for 1.11.14: `nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4`).\n+* `cd nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4` -- Changes directory to the application root directory\n++\n+[source]\n+----\n+nifi-1.11.4/nifi-assembly/target/nifi-1.11.4-bin/nifi-1.11.4/ % ls -alGh\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 ./\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 ../\n+-rw-r--r--    1 alopresto  staff   157K Jan 22 07:10 LICENSE\n+-rw-r--r--    1 alopresto  staff    85K Jan 22 07:10 NOTICE\n+-rw-r--r--    1 alopresto  staff   4.7K Jan 22 07:10 README\n+drwxr-xr-x    8 alopresto  staff   256B Apr  6 15:50 bin/\n+drwxr-xr-x   10 alopresto  staff   320B Apr  6 15:50 conf/\n+drwxr-xr-x    3 alopresto  staff    96B Apr  6 15:50 docs/\n+drwxr-xr-x    2 alopresto  staff    64B Jan 22 07:10 extensions/\n+drwxr-xr-x  116 alopresto  staff   3.6K Apr  6 15:50 lib/\n+----\n+\n+== Starting NiFi\n+\n+|=======================================================================================================================\n+|Description        | Instructions on running the Apache NiFi application\n+|Purpose            | To configure and run the application on the local machine\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host with minimal configuration\n+|Estimated Duration | 1 minute\n+|=======================================================================================================================\n+\n+. Start in the directory where NiFi was downloaded and unarchived or built. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. At this point, NiFi can be started with default configuration values (available at link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^]).\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log which will indicate when the application has started\n++\n+image::nifi-app-log-ui-available.png[\"NiFi application log listing available URLS\"]\n+. Navigate to the URL in a web browser (link:http://localhost:8080/nifi[`http://localhost:8080/nifi`^] or any listed in the `nifi-app.log` output).\n++\n+image::nifi-application-running-browser.png[\"NiFi application running in browser\"]\n+\n+=== Modification of Configuration Values\n+Many web applications run on `:8080` by default, so this port may already be occupied on the machine. This section will demonstrate changing the port used by NiFi. All of the following commands are run from `$NIFI_HOME`.\n+\n+. Ensure the application is not running.\n+* `ps -ef | grep nifi` -- Checks the running system for any processes referencing `nifi` (optional)\n+* `./bin/nifi.sh status` -- Determines if the specified instance is running (optional)\n+* `./bin/nifi.sh stop` -- Stops the specified instance\n+. Open the main configuration file for NiFi (`nifi.properties`). Any text editor is sufficient for this (Sublime Text, Atom, vi, nano, etc.)\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file for editing\n+. Change `nifi.web.http.port=8080` -> `nifi.web.http.port=7777` -- Sets the HTTP port to a new value\n++\n+NOTE: Setting a port between 1 - 1024 requires `root` access on *nix systems\n+. Save and close the file.\n+. Start NiFi again\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n+. Open a web browser to the new address (link:http://localhost:7777/nifi[`http://localhost:7777/nifi`^])\n+\n+== Securing NiFi with TLS\n+\n+Apache NiFi requires link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] configuration for multiple reasons.\n+\n+. To encrypt communication between clients and server (this provides confidentialty and integrity over transmitted data)\n+. To prevent malicious users from intercepting data or impersonating the server\n+. To enable any authentication & authorization mechanisms\n+\n+NiFi intentionally does not allow any authentication or authorization features over plaintext HTTP. Without the confidentiality and integrity provided by TLS and the user & group access controls, any malicious entity can intercept and modify NiFi API requests, corrupt and steal data, and otherwise interfere with the NiFi instance. Because of NiFi's robust feature set, this can even lead to complete control over the host running NiFi. For more information, see link:administration-guide.html#security_configuration[Administrator's Guide: Security Configuration^].\n+\n+=== Securing NiFi with TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using the TLS Toolkit\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+Apache NiFi provides a toolkit (a collection of command-line tools for system administration). One of these is the TLS Toolkit, which provides a self-signed link:https://en.wikipedia.org/wiki/Certificate_authority[Certificate Authority (CA)^] and can easily issue and sign certificates in the format expected by NiFi. The toolkit can be run by a user or scripted to perform automated certificate generation. For more information, see link:toolkit-guide.html#tls_toolkit[NiFi Toolkit Guide: TLS Toolkit^].\n+\n+The end result will consist of a self-signed NiFi CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-toolkit-standalone-cert-diagram.png[\"NiFi TLS Toolkit Standalone Certificate Diagram\"]\n+\n+. Start in the directory where the NiFi toolkit was downloaded and unarchived. For this section, the directory `/etc/nifi-toolkit-1.11.4` will be used. This directory will be referred to as the \"NiFi Toolkit home directory\" and can be set explicitly (this is not done automatically by NiFi Toolkit nor is it required).\n+* `export NIFI_TOOLKIT_HOME=\"/etc/nifi-toolkit-1.11.4/\"` -- Sets an environment variable (`$NIFI_TOOLKIT_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-toolkit-1.11.4` -- Changes the terminal to the NiFi Toolkit home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-toolkit-home-dir-listing.png[\"NiFi Toolkit Home directory contents\"]\n+. Generate the certificate and key for the NiFi instance. Running this command will first generate the NiFi CA root certificate and private key, then generate and sign the certificate for the application instance, and finally generate a pre-configured `nifi.properties` file.\n+* `./bin/tls-toolkit.sh standalone -n \"localhost\"` -- Generates the signed certificate for `localhost`\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -n \"localhost\"\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:13:29 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for localhost 1 in ../nifi-toolkit-1.11.4/localhost\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/04 19:13:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+. The toolkit has created three files in the `localhost` directory: `keystore.jks`, `truststore.jks`, and `nifi.properties`. To see what was automatically populated in `nifi.properties`, compare it to the default file in the NiFi instance.\n+* `diff /etc/nifi-1.11.4/conf/nifi.properties localhost/nifi.properties` -- Compares the original configuration with the newly-generated one\n++\n+--\n+[source]\n+----\n+nifi-toolkit-1.11.4 % diff ../nifi-1.11.4/conf/nifi.properties localhost/nifi.properties\n+135,137c135,137\n+< nifi.remote.input.host=\n+< nifi.remote.input.secure=false\n+< nifi.remote.input.socket.port=\n+---\n+> nifi.remote.input.host=localhost\n+> nifi.remote.input.secure=true\n+> nifi.remote.input.socket.port=10443\n+145c145\n+< nifi.web.http.port=8080\n+---\n+> nifi.web.http.port=\n+147,148c147,148\n+< nifi.web.https.host=\n+< nifi.web.https.port=\n+---\n+> nifi.web.https.host=localhost\n+> nifi.web.https.port=9443\n+163,169c163,169\n+< nifi.security.keystore=\n+< nifi.security.keystoreType=\n+< nifi.security.keystorePasswd=\n+< nifi.security.keyPasswd=\n+< nifi.security.truststore=\n+< nifi.security.truststoreType=\n+< nifi.security.truststorePasswd=\n+---\n+> nifi.security.keystore=./conf/keystore.jks\n+> nifi.security.keystoreType=jks\n+> nifi.security.keystorePasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.keyPasswd=aCeVndQ8JxIi9kLoz9YS65RClHPxB516tmIA/n26b54\n+> nifi.security.truststore=./conf/truststore.jks\n+> nifi.security.truststoreType=jks\n+> nifi.security.truststorePasswd=hbuVighksEPIxl6iGl1WFCIrFqdb65KZuamj72J7Yp8\n+213c213\n+< nifi.cluster.protocol.is.secure=false\n+---\n+> nifi.cluster.protocol.is.secure=true\n+217,218c217,218\n+< nifi.cluster.node.address=\n+< nifi.cluster.node.protocol.port=\n+---\n+> nifi.cluster.node.address=localhost\n+> nifi.cluster.node.protocol.port=11443\n+----\n+\n+The `nifi.remote` section configures link:user-guide.html#site-to-site[Site to Site^] connections. The `nifi.web` section disables the plaintext HTTP connector and enables an HTTPS connector at `localhost:9443` (the default HTTPS port for NiFi). The `nifi.security` section populates the paths to the keystore and truststore and randomly-generated passwords for each. The `nifi.cluster` section configures the link:administration-guide.html#clustering[cluster communication protocol^] (not used in a standalone instance).\n+--\n+. Copy the contents of the `localhost` directory to the `conf/` directory in the location of the NiFi installation. **This command will overwrite any existing `nifi.properties` file or keystore/truststore present in the destination.**\n+* `cp -rv ./localhost/* /etc/nifi-1.11.4/conf/.` -- Copies the generated files into the NiFi instance\n+. Generate the user's client certificate to authenticate to NiFi. The toolkit will create the certificate and sign it with the same NiFi CA certificate used for the NiFi server certificate. Because the NiFi truststore includes this public certificate, it will trust the client certificate and allow it to authenticate.\n+* `./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"` -- Generates and signs the client certificate\n++\n+[source]\n+----\n+nifi-toolkit-1.11.4 % ./bin/tls-toolkit.sh standalone -C \"CN=my_username, OU=NiFi\"\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=localhost,OU=NIFI signature with CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=localhost,OU=NIFI\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/04 19:38:30 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username_OU=NiFi.p12\n+2020/04/04 19:38:31 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+\n+[[load_client_certificate_to_browser]]\n+[start=6]\n+. Load the client certificate into the web browser. Some browsers (e.g. Mozilla Firefox) maintain their own internal keychain separate from the operating system's (OS). Others (e.g. Apple Safari, Google Chrome) rely on the OS keychain. On most modern OS, double-clicking the PKCS12 keystore (`CN=my_username_OU=NiFi.p12`) will open it with the default handler and load it into the OS keychain. The randomly-generated password is available in `CN=my_username_OU=NiFi.password`.\n+. Populate the *Initial Admin Identity* in NiFi. This is the identity that will be allowed to access the NiFi instance and configure user and group access via the UI or API.\n+* `$EDITOR /etc/nifi-1.11.4/conf/authorizers.xml` -- Opens the `authorizers.xml` file in the text editor.\n+* Replace `<property name=\"Initial User Identity 1\"></property>` in the `userGroupProvider` section with `<property name=\"Initial User Identity 1\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n+* Replace `<property name=\"Initial Admin Identity\"></property>` in the `accessPolicyProvider` section with `<property name=\"Initial Admin Identity\">CN=my_username, OU=NiFi</property>` containing the full Distinguished Name (DN) as provided to the TLS Toolkit in the previous step\n++\n+WARNING: This is a frequent problem area when configuring security for NiFi. The DN must match *exactly* to be authenticated. Check capitalization and whitespace especially.\n+. Start NiFi with the new configuration.\n+* `cd /etc/nifi-1.11.4/` -- Changes to the NiFi home directory\n+* `./bin/nifi.sh start` -- Starts NiFi\n+* `tail -f logs/nifi-app.log` -- Tails the application log\n++\n+--\n+Note that there are now log entries about the keystore and truststore being loaded and the available URLs are HTTPS.\n+[source]\n+----\n+2020-04-04 19:52:01,122 INFO [main] o.e.jetty.server.handler.ContextHandler Started o.e.j.w.WebAppContext@623ebac7{nifi-error,/,file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/work/jetty/nifi-web-error-1.11.4.war/webapp/,AVAILABLE}{./work/nar/framework/nifi-framework-nar-1.11.4.nar-unpacked/NAR-INF/bundled-dependencies/nifi-web-error-1.11.4.war}\n+2020-04-04 19:52:01,155 INFO [main] o.e.jetty.util.ssl.SslContextFactory x509=X509@b96fb73(nifi-key,h=[localhost],w=[]) for SslContextFactory@5edd911f[provider=null,keyStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/keystore.jks,trustStore=file:///Users/alopresto/Workspace/scratch/release_verification/nifi-1.11.4-bin/nifi-1.11.4/conf/truststore.jks]\n+2020-04-04 19:52:01,191 INFO [main] o.eclipse.jetty.server.AbstractConnector Started ServerConnector@767191b1{SSL,[ssl, http/1.1]}{localhost:9443}\n+2020-04-04 19:52:01,192 INFO [main] org.eclipse.jetty.server.Server Started @24336ms\n+2020-04-04 19:52:01,215 INFO [main] org.apache.nifi.nar.NarAutoLoader Starting NAR Auto-Loader for directory ./extensions ...\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.nar.NarAutoLoader NAR Auto-Loader started\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer NiFi has started. The UI is available at the following URLs:\n+2020-04-04 19:52:01,216 INFO [main] org.apache.nifi.web.server.JettyServer https://localhost:9443/nifi\n+2020-04-04 19:52:01,218 INFO [main] org.apache.nifi.BootstrapListener Successfully initiated communication with Bootstrap\n+2020-04-04 19:52:01,219 INFO [main] org.apache.nifi.NiFi Controller initialization took 16457023826 nanoseconds (16 seconds).\n+----\n+--\n+. Open the web browser to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]. The browser will present a warning that the site you are attempting to visit is insecure because the NiFi certificate is not signed by a trusted CA. Make an exception and acknowledge the risk (all communications are still encrypted even if the browser does not recognize the certificate). The browser may prompt to select the client certificate you wish to present to NiFi. Choose the entry for `CN=my_username` generated by the toolkit.\n++\n+--\n+The browser warning of an insecure server certificate\n+\n+image::browser-warning-insecure-site.png[\"Browser warning on untrusted server TLS certificate\"]\n+\n+The browser prompting for a client certificate to present\n+\n+image::browser-present-client-cert.png[\"Browser prompting for client certificate to present\"]\n+\n+The application running. Note the user's DN in the top-right corner\n+\n+image::nifi-running-tls-client-certificate.png[\"NiFi running with user logged in by client certificate]\n+--\n+\n+==== Additional Notes\n+\n+* While it is recommended to configure NiFi with security immediately, some admins have already run NiFi with other configuration modifications before securing it. The TLS Toolkit provides an option to consume an existing `nifi.properties` file and make the security changes to it rather than using a default template. Use `-f /etc/nifi-1.11.4/conf/nifi.properties` or `--nifiPropertiesFile /etc/nifi-1.11.4/conf/nifi.properties` if this file already exists. For more toolkit options, see link:toolkit-guide.html#tls_operation_modes[NiFi Toolkit Guide: TLS Toolkit Operation Modes^].\n+* To generate a certificate for a hostname other than `localhost`, use the `-n somehost.com` argument. To run on the local machine, DNS settings must allow for this. Either modify the `/etc/hosts` file or use a tool like link:https://en.wikipedia.org/wiki/Dnsmasq[dnsmasq^] to set up custom DNS routing. This is beyond the scope of this document.\n+* The browser will warn about an insecure connection because it does not trust the self-signed CA certificate. To explicitly mark this certificate as trusted, follow the instructions for the relevant OS and browser combination. For example, using macOS Catalina and Google Chrome:\n++\n+--\n+. Open the NiFi CA cert in the Keychain Access app. Double-click on `nifi-cert.pem` or run the following command:\n+* `open /etc/nifi-toolkit-1.11.4/nifi-cert.pem` -- Opens the certificate in Keychain Access\n+* Right-click the `localhost` certificate and select *Get Info*\n+\n+image::keychain-access-certificate-listing.png[\"Keychain Access listing certificates\"]\n+\n+* Expand the *Trust* section in the dialog\n+* Change *Secure Sockets Layer (SSL)* to *Always Trust*\n+\n+image::keychain-access-trust-certificate.png[\"Trusting the CA certificate for TLS/SSL\"]\n+\n+* Close the dialog\n+* Restart the browser\n+* Navigate to link:https://localhost:9443/nifi[`https://localhost:9443/nifi`^]\n+\n+image::nifi-trusted-server-certificate.png[\"Browser showing trusted NiFi server certificate\"]\n+--\n+\n+=== Securing NiFi with Provided Certificates\n+\n+NOTE: This section assumes an enterprise IT department or other mechanism to provide signed certificates. For a scenario with self-signed certificates, see <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on enabling link:https://en.wikipedia.org/wiki/Transport_Layer_Security[Transport Layer Security (TLS)^] for the Apache NiFi application using provided certificates\n+|Purpose            | Securing NiFi with TLS protects data in motion and is required to enable authentication & authorization\n+|Starting Point     | <<starting-nifi>>\n+|Expected Outcome   | Latest version of Apache NiFi running on host over TLS with client certificate authentication and authorization enabled and a single configured user\n+|Estimated Duration | 10 minutes\n+|=======================================================================================================================\n+\n+In this scenario, a commercial CA is used, but it could also be an enterprise CA with an internal CA certificate which is configured to be trusted by corporate machines. There are many commercial vendors providing signed certificates. For this example, link:https://tinycert.org[TinyCert^] is used as it is free. link:https://letsencrypt.org[Let's Encrypt^] is another free provider, but requires verification of hostname ownership which involves additional steps not shown here.\n+\n+For this scenario, all certificates and keys will be in link:https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail[Privacy-Enhanced Mail (PEM)^] format. This is a common format for certificates and keys. It uses Base64 encoding for the contents of the files, and can be transmitted across various mediums and storage mechanisms easily. Plain text editors can be used to view the contents, and the `openssl` and `keytool` tools can parse the contents.\n+\n+Example PEM file:\n+\n+[source]\n+----\n+% cat nifi.pem\n+-----BEGIN CERTIFICATE-----\n+MIIFDzCCA/egAwIBAgICURswDQYJKoZIhvcNAQELBQAwgZMxCzAJBgNVBAYTAlVT\n+MQswCQYDVQQIDAJDQTEVMBMGA1UEBwwMU2FudGEgTW9uaWNhMRcwFQYDVQQKDA5B\n+cGFjaGUgTmlGaSBDQTErMCkGA1UECwwiU2VjdXJlIERpZ2l0YWwgQ2VydGlmaWNh\n+dGUgU2lnbmluZzEaMBgGA1UEAwwRQXBhY2hlIE5pRmkgQ0EgQ0EwHhcNMjAwNDA1\n+MjI0MTQ5WhcNMjEwNDA1MjI0MTQ5WjCBgjELMAkGA1UEBhMCVVMxCzAJBgNVBAgM\n+AkNBMRUwEwYDVQQHDAxTYW50YSBNb25pY2ExFzAVBgNVBAoMDkFwYWNoZSBOaUZp\n+IENBMSAwHgYDVQQLDBdBcGFjaGUgTmlGaSBXYWxrdGhyb3VnaDEUMBIGA1UEAwwL\n+c2VjdXJlLm5pZmkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDJySMX\n+H+Fco7WbXIKQ1u1RrMd/FE7zl/69X/7Da6x4c6jlI8fy3MbxZjqFnDsJpNuIkPVv\n+yHcGCm8Lkw70DbCTUkW60MlVM5r4CkWhVgOd1RD34QzhgkcKjg29uOuCYa+FM78q\n+E5Qp64wbLpDXHpxmm4/Qv97RHdTqynqRzYs6g+VyCn14nXuqJp0533F1T2khtK4z\n+BrIMZj6VpWyyCFmJjmrW37GbcRuxMbtbgj+4mzD0Eew6/96R9A7Wxlq0QMuRTz12\n+ie9xSi/GyzQV2r9gRzxuIo8qshMIq2d/1pipIgWNj2LzEXXoEbfHy7Jwm78e1G/+\n+PV/ULIx+QL4h9Ni/AgMBAAGjggF6MIIBdjAJBgNVHRMEAjAAMB0GA1UdDgQWBBTy\n+gw/GBUrqMI80gYpdlh3NNfwrBzAfBgNVHSMEGDAWgBRkovbp8RqbD0BeDyPcrBYg\n+a1rzdDARBglghkgBhvhCAQEEBAMCBPAwCwYDVR0PBAQDAgP4MDsGA1UdJQQ0MDIG\n+CCsGAQUFBwMBBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcD\n+CDBtBggrBgEFBQcBAQRhMF8wLAYIKwYBBQUHMAGGIGh0dHA6Ly9vY3NwLnRpbnlj\n+ZXJ0Lm9yZy9jYS0yNDA1MC8GCCsGAQUFBzAChiNodHRwOi8vYWlhLnRpbnljZXJ0\n+Lm9yZy9jYS0yNDA1LmNydDA0BgNVHR8ELTArMCmgJ6AlhiNodHRwOi8vY3JsLnRp\n+bnljZXJ0Lm9yZy9jYS0yNDA1LmNybDAnBgNVHREEIDAeggtzZWN1cmUubmlmaYcE\n+fwAAAYIJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4IBAQDAICxyfgm2eBa8J3+s\n+D2QpIQgOc8fgMYeqWwgk5rHbDk8IdkH9XloAuSzxi/weZt3PQQOdNHeeOCOXEWAf\n+n0X1SMGFUvLForHgArGolt9uFofvh2sE2q3/wSBI6J2940dYwZOPAlf5m7fNpcbz\n+WCJZGt7Pn/VWm3+uPZrMAj+GzsvR9NVMZwK/eAFM4OKNCeiLRPv1qLARYVqvLJFK\n+t9dlCrHKyDLIaUbG2Lcw6Yt7SBU7nAnobuYqImRRXm/bE0xwb9X9fD8UzJfmryOT\n+Fvz4hlntwk1fgvG1n4SrZgFNZpg1awN5tXbwiOdisTwslQ49C4QCH5iEWCM1HExL\n+A5GR\n+-----END CERTIFICATE-----\n+----\n+\n+Example parsed contents:\n+\n+[source]\n+----\n+% openssl x509 -in nifi.pem -text -noout\n+Certificate:\n+    Data:\n+        Version: 3 (0x2)\n+        Serial Number: 20763 (0x511b)\n+    Signature Algorithm: sha256WithRSAEncryption\n+        Issuer: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Secure Digital Certificate Signing, CN=Apache NiFi CA CA\n+        Validity\n+            Not Before: Apr  5 22:41:49 2020 GMT\n+            Not After : Apr  5 22:41:49 2021 GMT\n+        Subject: C=US, ST=CA, L=Santa Monica, O=Apache NiFi CA, OU=Apache NiFi Walkthrough, CN=secure.nifi\n+        Subject Public Key Info:\n+            Public Key Algorithm: rsaEncryption\n+                Public-Key: (2048 bit)\n+                Modulus:\n+                    00:c9:c9:23:17:1f:e1:5c:a3:b5:9b:5c:82:90:d6:\n+                    ed:51:ac:c7:7f:14:4e:f3:97:fe:bd:5f:fe:c3:6b:\n+                    ac:78:73:a8:e5:23:c7:f2:dc:c6:f1:66:3a:85:9c:\n+                    3b:09:a4:db:88:90:f5:6f:c8:77:06:0a:6f:0b:93:\n+                    0e:f4:0d:b0:93:52:45:ba:d0:c9:55:33:9a:f8:0a:\n+                    45:a1:56:03:9d:d5:10:f7:e1:0c:e1:82:47:0a:8e:\n+                    0d:bd:b8:eb:82:61:af:85:33:bf:2a:13:94:29:eb:\n+                    8c:1b:2e:90:d7:1e:9c:66:9b:8f:d0:bf:de:d1:1d:\n+                    d4:ea:ca:7a:91:cd:8b:3a:83:e5:72:0a:7d:78:9d:\n+                    7b:aa:26:9d:39:df:71:75:4f:69:21:b4:ae:33:06:\n+                    b2:0c:66:3e:95:a5:6c:b2:08:59:89:8e:6a:d6:df:\n+                    b1:9b:71:1b:b1:31:bb:5b:82:3f:b8:9b:30:f4:11:\n+                    ec:3a:ff:de:91:f4:0e:d6:c6:5a:b4:40:cb:91:4f:\n+                    3d:76:89:ef:71:4a:2f:c6:cb:34:15:da:bf:60:47:\n+                    3c:6e:22:8f:2a:b2:13:08:ab:67:7f:d6:98:a9:22:\n+                    05:8d:8f:62:f3:11:75:e8:11:b7:c7:cb:b2:70:9b:\n+                    bf:1e:d4:6f:fe:3d:5f:d4:2c:8c:7e:40:be:21:f4:\n+                    d8:bf\n+                Exponent: 65537 (0x10001)\n+        X509v3 extensions:\n+            X509v3 Basic Constraints:\n+                CA:FALSE\n+            X509v3 Subject Key Identifier:\n+                F2:83:0F:C6:05:4A:EA:30:8F:34:81:8A:5D:96:1D:CD:35:FC:2B:07\n+            X509v3 Authority Key Identifier:\n+                keyid:64:A2:F6:E9:F1:1A:9B:0F:40:5E:0F:23:DC:AC:16:20:6B:5A:F3:74\n+\n+            Netscape Cert Type:\n+                SSL Client, SSL Server, S/MIME, Object Signing\n+            X509v3 Key Usage:\n+                Digital Signature, Non Repudiation, Key Encipherment, Data Encipherment, Key Agreement\n+            X509v3 Extended Key Usage:\n+                TLS Web Server Authentication, TLS Web Client Authentication, Code Signing, E-mail Protection, Time Stamping\n+            Authority Information Access:\n+                OCSP - URI:http://ocsp.tinycert.org/ca-2405\n+                CA Issuers - URI:http://aia.tinycert.org/ca-2405.crt\n+\n+            X509v3 CRL Distribution Points:\n+\n+                Full Name:\n+                  URI:http://crl.tinycert.org/ca-2405.crl\n+\n+            X509v3 Subject Alternative Name:\n+                DNS:secure.nifi, IP Address:127.0.0.1, DNS:localhost\n+    Signature Algorithm: sha256WithRSAEncryption\n+         c0:20:2c:72:7e:09:b6:78:16:bc:27:7f:ac:0f:64:29:21:08:\n+         0e:73:c7:e0:31:87:aa:5b:08:24:e6:b1:db:0e:4f:08:76:41:\n+         fd:5e:5a:00:b9:2c:f1:8b:fc:1e:66:dd:cf:41:03:9d:34:77:\n+         9e:38:23:97:11:60:1f:9f:45:f5:48:c1:85:52:f2:c5:a2:b1:\n+         e0:02:b1:a8:96:df:6e:16:87:ef:87:6b:04:da:ad:ff:c1:20:\n+         48:e8:9d:bd:e3:47:58:c1:93:8f:02:57:f9:9b:b7:cd:a5:c6:\n+         f3:58:22:59:1a:de:cf:9f:f5:56:9b:7f:ae:3d:9a:cc:02:3f:\n+         86:ce:cb:d1:f4:d5:4c:67:02:bf:78:01:4c:e0:e2:8d:09:e8:\n+         8b:44:fb:f5:a8:b0:11:61:5a:af:2c:91:4a:b7:d7:65:0a:b1:\n+         ca:c8:32:c8:69:46:c6:d8:b7:30:e9:8b:7b:48:15:3b:9c:09:\n+         e8:6e:e6:2a:22:64:51:5e:6f:db:13:4c:70:6f:d5:fd:7c:3f:\n+         14:cc:97:e6:af:23:93:16:fc:f8:86:59:ed:c2:4d:5f:82:f1:\n+         b5:9f:84:ab:66:01:4d:66:98:35:6b:03:79:b5:76:f0:88:e7:\n+         62:b1:3c:2c:95:0e:3d:0b:84:02:1f:98:84:58:23:35:1c:4c:\n+         4b:03:91:91\n+----\n+\n+The prerequisites for the scenario (issued by the IT department):\n+\n+* A signed NiFi server certificate for the specified host (`secure.nifi` for this example) in PEM format (`nifi.pem`)\n+* The matching private key in PEM format (`nifi.key`)\n+* A signed client certificate for the specified user (`CN=my_username, ...` for this example) in PEM format (`client.pem`)\n+* The matching private key in PEM format (`client.key`)\n+* The CA certificate in PEM format (`cacert.pem`)\n+\n+NOTE: For more information on converting certificates between various forms, see link:toolkit-guide.html#additional_certificate_commands[Toolkit Guide: Additional Certificate Commands^].\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-tls-standalone-external-certificate-diagram.png[\"NiFi TLS Standalone Provided Certificate Diagram\"]\n+\n+WARNING: Depending on the version of Java used, some commands below may display a warning `Warning:\n+The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format using \"keytool -importkeystore -srckeystore keystore.jks -destkeystore keystore.jks -deststoretype pkcs12\".` As of version 1.11.4, NiFi still handles JKS keystores better than PKCS12 keystores, but either is acceptable. This may change in future versions. PKCS12 keystores are used for client certificates and keys as browsers prefer loading this format.\n+\n+. Start in the directory where NiFi was downloaded and unarchived. For this section, the directory `/etc/nifi-1.11.4` will be used. This directory will be referred to as the \"NiFi home directory\" and can be set explicitly (this is not done automatically by NiFi nor is it required).\n+* `export NIFI_HOME=\"/etc/nifi-1.11.4/\"` -- Sets an environment variable (`$NIFI_HOME`) which references the installation directory (optional)\n+* `cd /etc/nifi-1.11.4` -- Changes the terminal to the NiFi home directory\n+* `ls -alGh` -- Lists the contents of the directory (optional)\n++\n+image::nifi-home-dir-listing.png[\"NiFi Home directory contents\"]\n+. Determine if the server certificate (`nifi.pem`) contains the complete certificate chain or just the server certificate. If the sequence `-----BEGIN CERTIFICATE-----` occurs only once, this is just the server certificate. If it occurs multiple times, the certificate chain is present. If the certificate chain is present, continue with Step 4. If it is not present, continue to Step 3.\n+* `cat nifi.pem` -- Prints the Base64-encoded contents\n+. Concatenate the server certificate and CA certificate to form the certificate chain.\n+* `cat cacert.pem >> nifi.pem` -- Concatenates the CA certificate to the NiFi server certificate in the proper order\n+. Form the PKCS12 keystore from the certificate chain and private key.\n+* `openssl pkcs12 -export -out nifi.p12 -inkey nifi.key -in nifi.pem -name nifi-key` -- Generates the PKCS12 keystore containing the private key and certificate chain under the alias `nifi-key`. The command will prompt for an *export password*. Choose a secure password and enter it twice for confirmation (for this scenario, the *bad* example `passwordpassword` is used)\n+* `keytool -list -v -keystore nifi.p12` -- Verifies the contents of the PKCS12 keystore (optional). This command will prompt for the same password entered on the previous step\n++\n+--\n+NOTE: The certificate chain length is 2, starting with the server certificate and including the CA certificate.\n+[source]\n+----\n+keytool -list -v -keystore nifi.p12\n+Enter keystore password:\n+Keystore type: PKCS12\n+Keystore provider: SUN\n+\n+Your keystore contains 1 entry\n+\n+Alias name: 1\n+Creation date: Apr 5, 2020\n+Entry type: PrivateKeyEntry\n+Certificate chain length: 2\n+Certificate[1]:\n+Owner: CN=secure.nifi, OU=Apache NiFi Walkthrough, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 511b\n+Valid from: Sun Apr 05 15:41:49 PDT 2020 until: Mon Apr 05 15:41:49 PDT 2021\n+Certificate fingerprints:\n+\t SHA1: C7:DD:26:7F:8E:25:45:2E:02:FE:34:FA:89:42:D8:BE:5B:88:AB:2D\n+\t SHA256: 6E:A6:6C:BB:88:E3:24:99:5C:EB:C7:B8:02:D1:30:C4:AC:6D:0C:F2:40:46:DA:CB:6A:15:13:B7:49:40:FA:99\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false\n+AuthorityInfoAccess [\n+  [\n+   accessMethod: ocsp\n+   accessLocation: URIName: http://ocsp.tinycert.org/ca-2405\n+,\n+   accessMethod: caIssuers\n+   accessLocation: URIName: http://aia.tinycert.org/ca-2405.crt\n+]\n+]\n+\n+#2: ObjectId: 2.5.29.35 Criticality=false\n+AuthorityKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+#3: ObjectId: 2.5.29.19 Criticality=false\n+BasicConstraints:[\n+  CA:false\n+  PathLen: undefined\n+]\n+\n+#4: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#5: ObjectId: 2.5.29.37 Criticality=false\n+ExtendedKeyUsages [\n+  serverAuth\n+  clientAuth\n+  codeSigning\n+  emailProtection\n+  timeStamping\n+]\n+\n+#6: ObjectId: 2.5.29.15 Criticality=false\n+KeyUsage [\n+  DigitalSignature\n+  Non_repudiation\n+  Key_Encipherment\n+  Data_Encipherment\n+  Key_Agreement\n+]\n+\n+#7: ObjectId: 2.16.840.1.113730.1.1 Criticality=false\n+NetscapeCertType [\n+   SSL client\n+   SSL server\n+   S/MIME\n+   Object Signing\n+]\n+\n+#8: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  DNSName: secure.nifi\n+  IPAddress: 127.0.0.1\n+  DNSName: localhost\n+]\n+\n+#9: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: F2 83 0F C6 05 4A EA 30   8F 34 81 8A 5D 96 1D CD  .....J.0.4..]...\n+0010: 35 FC 2B 07                                        5.+.\n+]\n+]\n+\n+Certificate[2]:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+\n+\n+*******************************************\n+*******************************************\n+----\n+--\n+. Convert the PKCS12 keystore for the NiFi instance into the Java KeyStore file (`keystore.jks`) necessary. PKCS12 keystores are usable by NiFi, but JKS format is handled more robustly and causes fewer edge cases. JKS keystores cannot be formed directly from PEM files, so the PKCS12 keystore serves as an intermediate form.\n+* `keytool -importkeystore -srckeystore nifi.p12 -srcstoretype pkcs12 -srcalias nifi-key -destkeystore keystore.jks\n+       -deststoretype jks -destalias nifi-key` -- Converts the PKCS12 keystore to a JKS keystore. This command will prompt for a new keystore password twice, then prompt for the password set on the PKCS12 keystore from the previous step\n+. Convert the CA certificate into the NiFi truststore (`truststore.jks`) to allow trusted incoming connections.\n+* `keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks` -- Imports the CA certificate into the truststore. This command will prompt for a new truststore password twice\n++\n+--\n+[source]\n+----\n+% keytool -importcert -alias nifi-cert -file cacert.pem -keystore truststore.jks\n+Enter keystore password:\n+Re-enter new password:\n+Owner: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Issuer: CN=Apache NiFi CA CA, OU=Secure Digital Certificate Signing, O=Apache NiFi CA, L=Santa Monica, ST=CA, C=US\n+Serial number: 0\n+Valid from: Mon Feb 08 20:24:06 PST 2016 until: Thu Feb 05 20:24:06 PST 2026\n+Certificate fingerprints:\n+\t SHA1: E9:CA:EF:26:C7:2A:AF:7A:FD:BC:97:12:ED:F5:6B:3B:79:40:D2:A3\n+\t SHA256: 4C:0A:2F:C4:D3:CC:B5:A8:0E:0B:95:EE:0C:E6:60:7C:85:78:7A:58:77:BB:87:58:12:9B:D1:E4:BA:E0:9B:67\n+Signature algorithm name: SHA256withRSA\n+Subject Public Key Algorithm: 2048-bit RSA key\n+Version: 3\n+\n+Extensions:\n+\n+#1: ObjectId: 2.5.29.19 Criticality=true\n+BasicConstraints:[\n+  CA:true\n+  PathLen:2147483647\n+]\n+\n+#2: ObjectId: 2.5.29.31 Criticality=false\n+CRLDistributionPoints [\n+  [DistributionPoint:\n+     [URIName: http://crl.tinycert.org/ca-2405.crl]\n+]]\n+\n+#3: ObjectId: 2.5.29.18 Criticality=false\n+IssuerAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#4: ObjectId: 2.5.29.15 Criticality=true\n+KeyUsage [\n+  DigitalSignature\n+  Key_Encipherment\n+  Key_Agreement\n+  Key_CertSign\n+]\n+\n+#5: ObjectId: 2.5.29.17 Criticality=false\n+SubjectAlternativeName [\n+  RFC822Name: andy@andylopresto.com\n+]\n+\n+#6: ObjectId: 2.5.29.14 Criticality=false\n+SubjectKeyIdentifier [\n+KeyIdentifier [\n+0000: 64 A2 F6 E9 F1 1A 9B 0F   40 5E 0F 23 DC AC 16 20  d.......@^.#...\n+0010: 6B 5A F3 74                                        kZ.t\n+]\n+]\n+\n+Trust this certificate? [no]:  yes\n+Certificate was added to keystore\n+----\n+--\n+. Optionally move the `keystore.jks` and `truststore.jks` files into the `conf/` directory. This step is not required, but helps with organization.\n+. Configure the `nifi.properties` file with the necessary values. This includes setting the hostname, ports, and keystore and truststore paths and passwords.\n+* `$EDITOR conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.remote.input.host=` -> `nifi.remote.input.host=secure.nifi`\n+** `nifi.remote.input.secure=false` -> `nifi.remote.input.secure=true`\n+** `nifi.remote.input.socket.port=` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.http.port=8080` -> `nifi.web.http.port=`\n+** `nifi.web.https.host=` -> `nifi.web.https.host=secure.nifi`\n+** `nifi.web.https.port=` -> `nifi.web.https.port=9443`\n+** `nifi.security.keystore=` -> `nifi.security.keystore=./conf/keystore.jks`\n+** `nifi.security.keystoreType=` -> `nifi.security.keystoreType=jks`\n+** `nifi.security.keystorePasswd=` -> `nifi.security.keystorePasswd=passwordpassword`\n+** `nifi.security.truststore=` -> `nifi.security.truststore=./conf/truststore.jks`\n+** `nifi.security.truststoreType=` -> `nifi.security.truststoreType=jks`\n+** `nifi.security.truststorePasswd=` -> `nifi.security.truststorePasswd=passwordpassword`\n+. Generate the client certificate keystore from the client certificate and key.\n+`openssl pkcs12 -export -out CN=my_username.p12 -inkey client.key -in client.pem` -- Creates the PKCS12 keystore containing the client certificate and private key. This command prompts for an *export password* twice\n+\n+From this point, the instructions are identical to those using the TLS Toolkit, starting at <<load-client-certificate-to-browser,Loading the client certificate in the browser>>.\n+\n+==== Securing NiFi with TLS Toolkit and Provided Intermediate CA\n+\n+Occasionally, an IT department will provide an intermediate CA certificate which is signed by a trusted certificate and can be used to generate server and client certificates on-demand by the NiFi admin without further intervention by the IT department. The TLS toolkit provides a mechanism to use the intermediate certificate to sign generated certificates.\n+\n+The end result will consist of a self-signed external CA (the root), an intermediate CA used to sign NiFi certificates, a keystore and truststore containing the necessary certificates for the NiFi instance to operate, and a client certificate for a human user to access NiFi.\n+\n+// TODO: Write\n+CAUTION: Develop section\n+\n+== Deploying a NiFi Cluster\n+\n+Apache NiFi can run in either _standalone_ or _clustered_ mode. A standalone node is often sufficient for dataflow operations, but in a production or high-volume environment, a cluster is more performant and resilient. For more information, see link:administration-guide.html#clustering[NiFi Administrator's Guide: Clustering^].\n+\n+=== Creating a NiFi Cluster\n+\n+// TODO: Write\n+CAUTION: Needs a diagram\n+\n+CAUTION: Develop section\n+\n+. Copy the NiFi run directory 3x\n+. Configure the settings\n+. Start each node\n+\n+// TODO: Write\n+=== Creating and Securing a NiFi Cluster with the TLS Toolkit\n+\n+NOTE: This section assumes no enterprise IT department to provide signed certificates. For a scenario with provided certificates, see <<securing-nifi-with-provided-certificates,Securing NiFi with Provided Certificates>>.\n+\n+|=======================================================================================================================\n+|Description        | Instructions on configuring and securing a 3 node cluster\n+|Purpose            | A NiFi cluster can perform flow operations in parallel and provide resiliency if nodes are unavailable.\n+|Starting Point     | <<installing-apache-nifi,Installing Apache NiFi>> or <<building-nifi-from-source,Building NiFi from Source>>\n+|Expected Outcome   | 3 nodes of latest version of Apache NiFi in secured cluster running on local machine\n+|Helpful Reading    | <<securing-nifi-with-tls-toolkit,Securing NiFi with TLS Toolkit>>, <<creating-a-nifi-cluster,Creating a NiFi Cluster>>\n+|Estimated Duration | 15 minutes\n+|=======================================================================================================================\n+\n+Similar to a standalone instance, a NiFi cluster must have TLS configured to enable authentication and authorization mechanisms. However, the cluster communication protocol used by NiFi and the framework authentication and authorization must also be configured to allow nodes to communicate.\n+\n+For this guide, the three nodes will be referred to as `node1`, `node2`, and `node3`. Each will have a `$NIFI_HOME` environment variable which points to the respective \"NiFi home directory\".\n+\n+Prerequisites:\n+\n+* DNS configuration for three hosts using the addresses `node1.nifi`, `node2.nifi`, `node3.nifi`\n+** This can be all side-by-side on the same physical host, using virtual machines, or using independent physical machines\n+* Ports open to allow the nodes to communicate\n+** If these machines are subject to a firewall, ensure that the following ports are open:\n+*** `2181`, `2888`, `3888` -- ZooKeeper ports\n+*** `6342` -- Load-balancing port\n+*** `9443` -- HTTPS port for NiFi UI/API\n+*** `10443` -- Site to site port\n+*** `11443` -- Cluster communications port\n+** If all the nodes will run on the same machine, the port scheme will end in the respective node identifier to avoid conflicts (e.g. HTTPS port `9441` for `node1`, `9442` for `node2`, `9443` for `node3`). Ensure that the following ports are open:\n+*** `2181` - `2183` -- ZooKeeper ports\n+*** `2881` - `2883` -- ZooKeeper ports\n+*** `3881` - `3883` -- ZooKeeper ports\n+*** `6341` - `6343` -- Load-balancing port\n+*** `9441` - `9443` -- HTTPS port for NiFi UI/API\n+*** `10441` - `10443` -- Site to site port\n+*** `11441` - `11443` -- Cluster communications port\n+\n+The end result will consist of a self-signed external CA (the root), a keystore and truststore containing the necessary certificates for each NiFi node to operate, and a client certificate for a human user to access NiFi.\n+\n+image::nifi-cluster-tls-toolkit-certificate-diagram.png[\"NiFi Cluster with TLS Toolkit Certificates Diagram\"]\n+\n+. Create the NiFi Client Certificates. When using the `standalone` mode of the TLS Toolkit, it is important that *all certificates are generated from the same instance, using the same generated NiFi CA certificate to sign each*. The certificates can be generated by a single command, or individually. By default, the Distinguished Name (DN) will be `CN=<provided_hostname>, OU=NIFI`. For more information on toolkit flag options, see link:toolkit-guide.html#usage-8[NiFi Toolkit Guide: TLS Toolkit Usage^].\n+.. Navigate to the `nifi-toolkit-1.11.4/` directory.\n+* `cd /etc/nifi-toolkit-1.11.4/` -- Changes to the toolkit directory\n+.. Generate the certificates. Running these commands first generates the NiFi CA public certificate and private key if not present, then generates the server certificates, followed by the client certificate necessary for the *Initial Admin Identity*. An alternative command performing all the steps sequentially is also provided.\n+* `./bin/tls-toolkit.sh standalone -n 'node1.nifi' -c 'ca.nifi'` -- Generates the NiFi CA (`ca.nifi`) certificate and key if not present and generates and signs `node1` certificate, placing the `keystore.jks`, `truststore.jks`, and populated `nifi.properties` in a subdirectory called `node1.nifi`\n++\n+--\n+_Note the creation of the CA certificate and key_\n+[source]\n+----\n+% ./bin/tls-toolkit.sh standalone -n 'node1.nifi' -c 'ca.nifi'\n+2020/04/06 18:12:07 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/06 18:12:07 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generated new CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/node1.nifi\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for node1.nifi 1 in ../nifi-toolkit-1.11.4/node1.nifi\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/06 18:12:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+% ls -alGh node1.nifi\n+total 48\n+drwx------   5 alopresto  staff   160B Apr  6 18:12 .\n+drwxr-xr-x  11 alopresto  staff   352B Apr  6 18:12 ..\n+-rw-------   1 alopresto  staff   3.0K Apr  6 18:12 keystore.jks\n+-rw-------   1 alopresto  staff    12K Apr  6 18:12 nifi.properties\n+-rw-------   1 alopresto  staff   895B Apr  6 18:12 truststore.jks\n+----\n+--\n+* `./bin/tls-toolkit.sh standalone -n 'node2.nifi'` -- Generates and signs `node2` certificate with the same CA\n++\n+--\n+_Note the existing CA certificate being used_\n+[source]\n+----\n+% ./bin/tls-toolkit.sh standalone -n 'node2.nifi'\n+2020/04/06 18:13:13 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=ca.nifi,OU=NIFI\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=ca.nifi,OU=NIFI signature with CN=ca.nifi,OU=NIFI\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=ca.nifi,OU=NIFI\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/node2.nifi\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for node2.nifi 1 in ../nifi-toolkit-1.11.4/node2.nifi\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/06 18:13:14 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+--\n+* `./bin/tls-toolkit.sh standalone -n 'node3.nifi'` -- Generates and signs `node3` certificate with the same CA\n++\n+[source]\n+----\n+% ./bin/tls-toolkit.sh standalone -n 'node3.nifi'\n+2020/04/06 18:53:07 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=ca.nifi,OU=NIFI signature with CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Writing new ssl configuration to ../nifi-toolkit-1.11.4/node3.nifi\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated TLS configuration for node3.nifi 1 in ../nifi-toolkit-1.11.4/node3.nifi\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No clientCertDn specified, not generating any client certificates.\n+2020/04/06 18:53:08 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n+* `./bin/tls-toolkit.sh standalone -C 'CN=my_username'` -- Generates and signs `my_username` client certificate with the same CA\n++\n+[source]\n+----\n+% ./bin/tls-toolkit.sh standalone -C 'CN=my_username'\n+2020/04/06 18:53:19 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandaloneCommandLine: No nifiPropertiesFile specified, using embedded one.\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Running standalone certificate generation with output directory ../nifi-toolkit-1.11.4\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Verifying the certificate signature for CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Attempting to verify certificate CN=ca.nifi,OU=NIFI signature with CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.util.TlsHelper: Certificate was signed by CN=ca.nifi,OU=NIFI\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Using existing CA certificate ../nifi-toolkit-1.11.4/nifi-cert.pem and key ../nifi-toolkit-1.11.4/nifi-key.key\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: No hostnames specified, not generating any host certificates or configuration.\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Generating new client certificate ../nifi-toolkit-1.11.4/CN=my_username.p12\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: Successfully generated client certificate ../nifi-toolkit-1.11.4/CN=my_username.p12\n+2020/04/06 18:53:20 INFO [main] org.apache.nifi.toolkit.tls.standalone.TlsToolkitStandalone: tls-toolkit standalone completed successfully\n+----\n++\n+--\n+The resulting directory will contain 7 new entries:\n+\n+** `CN=my_username.p12` -- The client certificate in a PKCS12 keystore\n+** `CN=my_username.password` -- The corresponding file containing the randomly-generated password. Use `-b` or `--clientCertPassword` when generating to specify a password\n+** `nifi-cert.pem` -- The CA certificate in PEM format\n+** `nifi-key.key` -- The corresponding CA private key in PEM format\n+** `node1.nifi/` -- The directory containing `node1` keystore and related files\n+** `node2.nifi/` -- The directory containing `node2` keystore and related files\n+** `node3.nifi/` -- The directory containing `node3` keystore and related files\n+--\n+Optional command to execute all steps together using the toolkit pattern syntax:\n+* `./bin/tls-toolkit.sh -n 'node[1-3].nifi' -C 'CN=my_username' -c 'ca.nifi'` -- Performs all steps listed above simultaneously\n+. Create a new `nifi_cluster` folder in an appropriate location. In this example, where all three nodes will run on the same machine, the `/etc/nifi_cluster` directory is used. All further instructions occur from this directory.\n+* `mkdir /etc/nifi_cluster` -- Creates the working directory\n+* `cd /etc/nifi_cluster` -- Change to the created directory\n+. Copy the NiFi installation folder (i.e. `nifi-1.11.4`) to a new folder for *each* node in the `nifi_cluster` folder created in the previous step.\n+* `mkdir node1.nifi && cp -R /etc/nifi-1.11.4 node1.nifi` -- Creates the `node1` directory and copies the NiFi application into it\n+* `mkdir node2.nifi && cp -R /etc/nifi-1.11.4 node2.nifi` -- Creates the `node2` directory and copies the NiFi application into it\n+* `mkdir node3.nifi && cp -R /etc/nifi-1.11.4 node3.nifi` -- Creates the `node3` directory and copies the NiFi application into it\n+. Copy the generated `keystore.jks`, `truststore.jks`, and `nifi.properties` to the `conf/` directory of *each* node.\n+* `cp -R /etc/nifi-toolkit-1.11.4/node1.nifi/* node1.nifi/conf/.` -- Copies the `node1` files\n+* `cp -R /etc/nifi-toolkit-1.11.4/node2.nifi/* node2.nifi/conf/.` -- Copies the `node2` files\n+* `cp -R /etc/nifi-toolkit-1.11.4/node3.nifi/* node3.nifi/conf/.` -- Copies the `node3` files\n+. Modify the `nifi.properties` file for each node to set the appropriate ports and enable the embedded link:https://zookeeper.apache.org/[ZooKeeper^] server. *If the nodes are being deployed to separate physical or virtual machines (such that each is treated as an independent host for networking), modifying the ports is not required, but enabling the embedded ZooKeeper servers is*. If the nodes are being deployed on the same machine such that the ports cannot conflict, all parts of this step are required. This port selection convention follows the pattern defined at the top of this section, where the last digit corresponds to the node identifier. For more information on ZooKeeper configuration for NiFi, see link:administration-guide.html#embedded_zookeeper[NiFi Administrator's Guide: Embedded ZooKeeper^].\n++\n+NOTE: The `nifi.cluster.load.balance.host=` entry must be manually populated here because it was added after the TLS Toolkit was last updated. The toolkit correctly populates the hostname in all other necessary properties.\n+\n+* `$EDITOR node1.nifi/conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.state.management.embedded.zookeeper.start=false` -> `nifi.state.management.embedded.zookeeper.start=true`\n+** `nifi.remote.input.socket.port=10443` -> `nifi.remote.input.socket.port=10441`\n+** `nifi.web.https.port=9443` -> `nifi.web.https.port=9441`\n+** `nifi.cluster.is.node=false` -> `nifi.cluster.is.node=true`\n+** `nifi.cluster.node.protocol.port=11443` -> `nifi.cluster.node.protocol.port=11441`\n+** `nifi.cluster.load.balance.host=` -> `nifi.cluster.load.balance.host=node1.nifi`\n+** `nifi.cluster.load.balance.port=6342` -> `nifi.cluster.load.balance.port=6341`\n+** `nifi.zookeeper.connect.string=` -> `nifi.zookeeper.connect.string=node1.nifi:2181,node2.nifi:2182,node3.nifi:2183`\n+* `$EDITOR node2.nifi/conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor. _Note that the `nifi.cluster.load.balance.port=6342` does not need to change for `node2` and is included for completeness_\n+* Update the following lines:\n+** `nifi.state.management.embedded.zookeeper.start=false` -> `nifi.state.management.embedded.zookeeper.start=true`\n+** `nifi.remote.input.socket.port=10443` -> `nifi.remote.input.socket.port=10442`\n+** `nifi.web.https.port=9443` -> `nifi.web.https.port=9442`\n+** `nifi.cluster.is.node=false` -> `nifi.cluster.is.node=true`\n+** `nifi.cluster.node.protocol.port=11443` -> `nifi.cluster.node.protocol.port=11442`\n+** `nifi.cluster.load.balance.host=` -> `nifi.cluster.load.balance.host=node2.nifi`\n+** `nifi.cluster.load.balance.port=6342` -> `nifi.cluster.load.balance.port=6342`\n+** `nifi.zookeeper.connect.string=` -> `nifi.zookeeper.connect.string=node1.nifi:2181,node2.nifi:2182,node3.nifi:2183`\n+* `$EDITOR node3.nifi/conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor. _Note that some of the ports do not need to change for `node3` and are included for completeness_\n+* Update the following lines:\n+** `nifi.state.management.embedded.zookeeper.start=false` -> `nifi.state.management.embedded.zookeeper.start=true`\n+** `nifi.remote.input.socket.port=10443` -> `nifi.remote.input.socket.port=10443`\n+** `nifi.web.https.port=9443` -> `nifi.web.https.port=9443`\n+** `nifi.cluster.is.node=false` -> `nifi.cluster.is.node=true`\n+** `nifi.cluster.node.protocol.port=11443` -> `nifi.cluster.node.protocol.port=11443`\n+** `nifi.cluster.load.balance.host=` -> `nifi.cluster.load.balance.host=node3.nifi`\n+** `nifi.cluster.load.balance.port=6342` -> `nifi.cluster.load.balance.port=6343`\n+** `nifi.zookeeper.connect.string=` -> `nifi.zookeeper.connect.string=node1.nifi:2181,node2.nifi:2182,node3.nifi:2183`\n+. Update the `zookeeper.properties` file on each node. This file contains the addresses of each embedded ZooKeeper server in the cluster. The `zookeeper.properties` file can be identical on each embedded ZooKeeper server (assuming no other changes were made), so the modified file will be copied to the other nodes.\n+* `$EDITOR node1.nifi/conf/zookeeper.properties` -- Opens the `zookeeper.properties` file in a text editor\n+* Update the following lines:\n+** `server.1=` -> `server.1=node1.nifi:2881:3881;2181`\n+** Add the line `server.2=node2.nifi:2882:3882;2182`\n+** Add the line `server.3=node3.nifi:2883:3883;2183`\n+* `cp node1.nifi/conf/zookeeper.properties node2.nifi/conf/zookeeper.properties` -- Copies the modified `zookeeper.properties` file from `node1` to `node2`\n+* `cp node1.nifi/conf/zookeeper.properties node3.nifi/conf/zookeeper.properties` -- Copies the modified `zookeeper.properties` file from `node1` to `node3`\n+. Create the `myid` file on each node to identify the embedded ZooKeeper server.\n+* `mkdir -p node1.nifi/state/zookeeper` -- Creates the ZooKeeper directory on `node1`\n+* `echo 1 >> node1.nifi/state/zookeeper/myid` -- Creates the `myid` file with the `node1` identifier\n+* `mkdir -p node2.nifi/state/zookeeper` -- Creates the ZooKeeper directory on `node2`\n+* `echo 2 >> node2.nifi/state/zookeeper/myid` -- Creates the `myid` file with the `node2` identifier\n+* `mkdir -p node3.nifi/state/zookeeper` -- Creates the ZooKeeper directory on `node3`\n+* `echo 3 >> node3.nifi/state/zookeeper/myid` -- Creates the `myid` file with the `node3` identifier\n+. Update the `state-management.xml` file on each node to allow ZooKeeper connections. The `state-management.xml` file can be identical on each node (assuming no other changes were made), so the modified file will be copied to the other nodes.\n+* `$EDITOR node1.nifi/conf/state-management.xml` -- Opens the `state-management.xml` file in a text editor\n+* Update the following line:\n+** `<property name=\"Connect String\"></property>` -> `<property name=\"Connect String\">node1.nifi:2181,node2.nifi:2182,node3.nifi:2183</property>`\n+* `cp node1.nifi/conf/state-management.xml node2.nifi/conf/state-management.xml` -- Copies the modified `state-management.xml` file from `node1` to `node2`\n+* `cp node1.nifi/conf/state-management.xml node3.nifi/conf/state-management.xml` -- Copies the modified `state-management.xml` file from `node1` to `node3`\n+. Update the `authorizers.xml` file. This file contains the *Initial Node Identities* and *Initial User Identities*. The *users* consist of all human users _and_ all nodes in the cluster. The `authorizers.xml` file can be identical on each node (assuming no other changes were made), so the modified file will be copied to the other nodes.\n+* `$EDITOR node1.nifi/conf/authorizers.xml` -- Opens the `authorizers.xml` file in a text editor\n+* Update the following lines:\n+** In the `<userGroupProvider>` section, `<property name=\"Initial User Identity 1\"></property>` -> `<property name=\"Initial User Identity 1\">CN=my_username</property>` -- Adds an initial user with the DN generated in the client certificate\n+** In the `<userGroupProvider>` section, add the line `<property name=\"Initial User Identity 2\">CN=node1.nifi, OU=NIFI</property>` -- Adds an initial user for `node1`\n+** In the `<userGroupProvider>` section, add the line `<property name=\"Initial User Identity 3\">CN=node2.nifi, OU=NIFI</property>` -- Adds an initial user for `node2`\n+** In the `<userGroupProvider>` section, add the line `<property name=\"Initial User Identity 4\">CN=node3.nifi, OU=NIFI</property>` -- Adds an initial user for `node3`\n++\n+image::authorizers-xml-initial-user-identities.png[\"authorizers.xml with Initial User Identities\"]\n+** In the `<accessPolicyProvider>` section, `<property name=\"Initial Admin Identity\"></property>` -> `<property name=\"Initial Admin Identity\">CN=my_username</property>` -- Adds an initial admin with the DN generated in the client certificate\n+** In the `<accessPolicyProvider>` section, `<property name=\"Node Identity 1\"></property>` -> `<property name=\"Node Identity 1\">CN=node1.nifi, OU=NIFI</property>` -- Adds an initial node with the DN generated in the `node1` certificate\n+** In the `<accessPolicyProvider>` section, add the line `<property name=\"Node Identity 2\">CN=node2.nifi, OU=NIFI</property>`\n+** In the `<accessPolicyProvider>` section, add the line `<property name=\"Node Identity 3\">CN=node3.nifi, OU=NIFI</property>`\n++\n+image::authorizers-xml-initial-node-identities.png[\"authorizers.xml with Initial Node Identities\"]\n+* `cp node1.nifi/conf/authorizers.xml node2.nifi/conf/authorizers.xml` -- Copies the modified `authorizers.xml` file from `node1` to `node2`\n+* `cp node1.nifi/conf/authorizers.xml node3.nifi/conf/authorizers.xml` -- Copies the modified `authorizers.xml` file from `node1` to `node3`\n+. By default, NiFi waits for nodes to join for 5 minutes before the cluster is available. Because the number of nodes is known, this delay can be modified on each node to start up much faster. (Optional)\n+* `$EDITOR node1.nifi/conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.cluster.flow.election.max.wait.time=5 mins` -> `nifi.cluster.flow.election.max.wait.time=1 min` -- Changes the flow election wait time to 1 min, speeding up cluster availability\n+** `nifi.cluster.flow.election.max.candidates=` -> `nifi.cluster.flow.election.max.candidates=3` -- Changes the flow election to occur when 3 nodes are present, speeding up cluster availability\n+* `$EDITOR node2.nifi/conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.cluster.flow.election.max.wait.time=5 mins` -> `nifi.cluster.flow.election.max.wait.time=1 min` -- Changes the flow election wait time to 1 min, speeding up cluster availability\n+** `nifi.cluster.flow.election.max.candidates=` -> `nifi.cluster.flow.election.max.candidates=3` -- Changes the flow election to occur when 3 nodes are present, speeding up cluster availability\n+* `$EDITOR node3.nifi/conf/nifi.properties` -- Opens the `nifi.properties` file in a text editor\n+* Update the following lines:\n+** `nifi.cluster.flow.election.max.wait.time=5 mins` -> `nifi.cluster.flow.election.max.wait.time=1 min` -- Changes the flow election wait time to 1 min, speeding up cluster availability\n+** `nifi.cluster.flow.election.max.candidates=` -> `nifi.cluster.flow.election.max.candidates=3` -- Changes the flow election to occur when 3 nodes are present, speeding up cluster availability\n+. Start the NiFi cluster. Once all three nodes have started and joined the cluster, the flow is agreed upon and a cluster coordinator is elected, the UI is available on any of the three nodes. \n+* `./node1.nifi/bin/nifi.sh start` -- Starts `node1`\n+* `./node2.nifi/bin/nifi.sh start` -- Starts `node2`\n+* `./node3.nifi/bin/nifi.sh start` -- Starts `node3`\n+. Wait approximately 30 seconds and open the web browser to `https://node3.nifi:9443/nifi`. The cluster should be available. Note that the Initial Admin Identity has no permissions on the root process group. This is an artifact of legacy design decisions where the root process group ID is not known at initial start time. ", "originalCommit": "fed8e2e0e53de4f15b92553c2b970ee7d20e6f0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMTg1OQ==", "url": "https://github.com/apache/nifi/pull/4193#discussion_r407011859", "bodyText": "The \"Note that the Initial Admin Identity... This is an artifact...at initial start time.\" sentence should be in italics for consistency.", "author": "andrewmlim", "createdAt": "2020-04-11T03:37:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzAxMTYyMA=="}], "type": "inlineReview"}, {"oid": "cd4f4b3e6d259fbb7d7c8f3c66c819b3c1cbea6f", "url": "https://github.com/apache/nifi/commit/cd4f4b3e6d259fbb7d7c8f3c66c819b3c1cbea6f", "message": "NIFI-7319 Incorporated final PR review items.", "committedDate": "2020-04-11T05:24:11Z", "type": "commit"}]}