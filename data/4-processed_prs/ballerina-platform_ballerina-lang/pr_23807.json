{"pr_number": 23807, "pr_title": "Update grpc module error", "pr_createdAt": "2020-06-08T12:03:05Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807", "timeline": [{"oid": "a04e1732b009e384633ef485275cb70ef8fdc4f6", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a04e1732b009e384633ef485275cb70ef8fdc4f6", "message": "Fix error\n\nFix testcases\n\nUncomment testcases\n\nUse error insteadof Error", "committedDate": "2020-06-08T12:09:17Z", "type": "commit"}, {"oid": "043fee2f4473d27f59b3c2b78160c6f4d2bd31de", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/043fee2f4473d27f59b3c2b78160c6f4d2bd31de", "message": "Remove additinal change", "committedDate": "2020-06-08T12:13:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY1MDQ4Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r436650483", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        return io:sprintf(\"File read error: %s - %s\", err.message());\n          \n          \n            \n                        return io:sprintf(\"File read error: %s\", err.message());", "author": "daneshk", "createdAt": "2020-06-08T12:18:32Z", "path": "tests/jballerina-integration-test/src/test/resources/grpc/src/clients/11_grpc_byte_client.bal", "diffHunk": "@@ -60,7 +60,7 @@ function testLargeByteArray(string filePath) returns (string) {\n             }\n         } else {\n             error err = resultBytes;\n-            return io:sprintf(\"File read error: %s - %s\", err.reason(), <string> err.detail()[\"message\"]);\n+            return io:sprintf(\"File read error: %s - %s\", err.message());", "originalCommit": "a04e1732b009e384633ef485275cb70ef8fdc4f6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY1MTE5NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r436651195", "bodyText": "Do we still need to maintain constants values for the error? or shall we remove those", "author": "daneshk", "createdAt": "2020-06-08T12:19:59Z", "path": "stdlib/grpc/src/main/ballerina/src/grpc/grpc_errors.bal", "diffHunk": "@@ -14,101 +14,92 @@\n // specific language governing permissions and limitations\n // under the License.\n \n-# The details of a gRPC error.\n-#\n-# + message - Specific error message for the error\n-# + cause - Cause of the error if this error occurred due to another error (probably from another module)\n-public type Detail record {\n-    string message;\n-    error cause?;\n-};\n-\n-# Represents the reason of the cancelled error.\n-public const CANCELLED_ERROR = \"{ballerina/grpc}CancelledError\";\n+# Represents the type of the cancelled error.\n+public const CANCELLED_ERROR = \"CancelledError\";", "originalCommit": "043fee2f4473d27f59b3c2b78160c6f4d2bd31de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2MDUyNg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r436660526", "bodyText": "No need these constants for the error but these used to create the ErrorType(https://github.com/ballerina-platform/ballerina-lang/blob/master/stdlib/grpc/src/main/ballerina/src/grpc/grpc_errors.bal#L116). ErrorType used in the retryConfig. Therefore, I keep this.", "author": "kalaiyarasiganeshalingam", "createdAt": "2020-06-08T12:38:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY1MTE5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjcyOTE1OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r436729159", "bodyText": "In retryConfig, instead of ErrorType const, is it possible to pass the actual error typedesc value", "author": "daneshk", "createdAt": "2020-06-08T14:00:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY1MTE5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc0MjE3MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r436742170", "bodyText": "yes, we can use it but it will affect the API. So, I skipped this.\nCan we do the changes in the API?", "author": "kalaiyarasiganeshalingam", "createdAt": "2020-06-08T14:14:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY1MTE5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQxODY1Nw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r437418657", "bodyText": "Fixed in 26e0f03", "author": "kalaiyarasiganeshalingam", "createdAt": "2020-06-09T13:31:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY1MTE5NQ=="}], "type": "inlineReview"}, {"oid": "74c5be826ae611d91bf17bcd1417da9d7098711f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/74c5be826ae611d91bf17bcd1417da9d7098711f", "message": "Update tests/jballerina-integration-test/src/test/resources/grpc/src/clients/11_grpc_byte_client.bal\n\nCo-authored-by: Danesh Kuruppu <daneshk@users.noreply.github.com>", "committedDate": "2020-06-08T13:03:53Z", "type": "commit"}, {"oid": "59d6224b2f6d78041400270270c97d5b6edbea6c", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/59d6224b2f6d78041400270270c97d5b6edbea6c", "message": "Made the changes in the errorType\n\nAdd the new line", "committedDate": "2020-06-09T04:24:45Z", "type": "commit"}, {"oid": "78f3cda01e5a6dbfa846012532f9fd42a161e4c4", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/78f3cda01e5a6dbfa846012532f9fd42a161e4c4", "message": "Improve the errorType coding", "committedDate": "2020-06-09T10:48:08Z", "type": "commit"}, {"oid": "768e19b81a931084d1b619871501f5351409ab4a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/768e19b81a931084d1b619871501f5351409ab4a", "message": "Make the changes in the retry.bal file", "committedDate": "2020-06-09T11:54:10Z", "type": "commit"}, {"oid": "26e0f03aae208b8548b387b65f5208a5f7cd536e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/26e0f03aae208b8548b387b65f5208a5f7cd536e", "message": "Improve the checkErrorForRetry()", "committedDate": "2020-06-09T13:04:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzg2NTAxNA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r437865014", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            return io:sprintf(\"Error from Connector: %s - %s\", addResponse.message());\n          \n          \n            \n                            return io:sprintf(\"Error from Connector: %s\", addResponse.message());", "author": "daneshk", "createdAt": "2020-06-10T05:16:18Z", "path": "tests/jballerina-integration-test/src/test/resources/grpc/src/clients/11_grpc_byte_client.bal", "diffHunk": "@@ -48,7 +48,7 @@ function testLargeByteArray(string filePath) returns (string) {\n         if (resultBytes is byte[]) {\n             var addResponse = blockingEp->checkBytes(resultBytes);\n             if (addResponse is grpc:Error) {\n-                return io:sprintf(\"Error from Connector: %s - %s\", addResponse.reason(), <string> addResponse.detail()[\"message\"]);\n+                return io:sprintf(\"Error from Connector: %s - %s\", addResponse.message());", "originalCommit": "26e0f03aae208b8548b387b65f5208a5f7cd536e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzg2NTA1MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r437865051", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return io:sprintf(\"Error from Connector: %s - %s\", addResponse.message());\n          \n          \n            \n                    return io:sprintf(\"Error from Connector: %s\", addResponse.message());", "author": "daneshk", "createdAt": "2020-06-10T05:16:28Z", "path": "tests/jballerina-integration-test/src/test/resources/grpc/src/clients/11_grpc_byte_client.bal", "diffHunk": "@@ -29,7 +29,7 @@ function testByteArray() returns (string) {\n     byte[] bytes = statement.toBytes();\n     var addResponse = blockingEp->checkBytes(bytes);\n     if (addResponse is grpc:Error) {\n-        return io:sprintf(\"Error from Connector: %s - %s\", addResponse.reason(), <string> addResponse.detail()[\"message\"]);\n+        return io:sprintf(\"Error from Connector: %s - %s\", addResponse.message());", "originalCommit": "26e0f03aae208b8548b387b65f5208a5f7cd536e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzg2NTA5OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r437865099", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return io:sprintf(\"Error from Connector: %s - %s\", unionResp.message());\n          \n          \n            \n                    return io:sprintf(\"Error from Connector: %s\", unionResp.message());", "author": "daneshk", "createdAt": "2020-06-10T05:16:40Z", "path": "tests/jballerina-integration-test/src/test/resources/grpc/src/clients/10_grpc_ssl_client.bal", "diffHunk": "@@ -35,7 +35,7 @@ function testUnarySecuredBlockingWithCerts() returns (string) {\n \n     [string, grpc:Headers]|grpc:Error unionResp = helloWorldBlockingEp->hello(\"WSO2\");\n     if (unionResp is grpc:Error) {\n-        return io:sprintf(\"Error from Connector: %s - %s\", unionResp.reason(), <string> unionResp.detail()[\"message\"]);\n+        return io:sprintf(\"Error from Connector: %s - %s\", unionResp.message());", "originalCommit": "26e0f03aae208b8548b387b65f5208a5f7cd536e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzg2NTE0Mg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23807#discussion_r437865142", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return io:sprintf(\"Error from Connector: %s - %s\", unionResp.message());\n          \n          \n            \n                    return io:sprintf(\"Error from Connector: %s\", unionResp.message());", "author": "daneshk", "createdAt": "2020-06-10T05:16:52Z", "path": "tests/jballerina-integration-test/src/test/resources/grpc/src/clients/09_grpc_secured_unary_client.bal", "diffHunk": "@@ -47,7 +47,7 @@ function testUnarySecuredBlocking(string keystorePath, string truststorePath) re\n \n     [string, grpc:Headers]|grpc:Error unionResp = helloWorldBlockingEp->hello(\"WSO2\");\n     if (unionResp is grpc:Error) {\n-        return io:sprintf(\"Error from Connector: %s - %s\", unionResp.reason(), <string> unionResp.detail()[\"message\"]);\n+        return io:sprintf(\"Error from Connector: %s - %s\", unionResp.message());", "originalCommit": "26e0f03aae208b8548b387b65f5208a5f7cd536e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "518061e4b8143398b9faab177c0d72a99c276ff9", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/518061e4b8143398b9faab177c0d72a99c276ff9", "message": "Fix comments", "committedDate": "2020-06-10T05:57:43Z", "type": "commit"}]}