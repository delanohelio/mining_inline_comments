{"pr_number": 22949, "pr_title": "Support custom SMTP properties for Email Connector", "pr_createdAt": "2020-04-28T19:43:27Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949", "timeline": [{"oid": "0c3fa57600d2ed8ac231bed7d0e69f760dd6e8a7", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0c3fa57600d2ed8ac231bed7d0e69f760dd6e8a7", "message": "Fix https://github.com/ballerina-platform/ballerina-lang/issues/22948", "committedDate": "2020-04-28T19:21:51Z", "type": "commit"}, {"oid": "5c79e1b593d66b7dae8d2933f3fa2ca828399127", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5c79e1b593d66b7dae8d2933f3fa2ca828399127", "message": "Resolve branch related conflicts", "committedDate": "2020-04-28T19:36:24Z", "type": "commit"}, {"oid": "fdc1c8fd43a06f1074fb7073a95e57745fe00cf6", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fdc1c8fd43a06f1074fb7073a95e57745fe00cf6", "message": "Add a new line at the end of the file", "committedDate": "2020-04-28T19:45:30Z", "type": "commit"}, {"oid": "fd32527abda6ce6f714ac9f9c4671c382370c116", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fd32527abda6ce6f714ac9f9c4671c382370c116", "message": "Add API docs to a method", "committedDate": "2020-04-28T19:53:43Z", "type": "commit"}, {"oid": "a23cf6a43539d7278fd3087909f5135e100bc9e6", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a23cf6a43539d7278fd3087909f5135e100bc9e6", "message": "Remove an unwanted line", "committedDate": "2020-04-28T19:55:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA0NDI4OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#discussion_r417044289", "bodyText": "Is it possible to make it as properties map like\nmap<string>? properties = ();\nAs we are converting the value to a string, I think we can restrict to string only\nWDYT?", "author": "daneshk", "createdAt": "2020-04-29T03:14:26Z", "path": "stdlib/email/src/main/ballerina/src/email/smtp_client_endpoint.bal", "diffHunk": "@@ -59,8 +59,10 @@ function send(SmtpClient clientEndpoint, Email email) returns Error? = @java:Met\n #\n # + port - Port number of the SMTP server\n # + enableSsl - If set to true, use SSL to connect and use the SSL port by default.\n-#               The default value is true for the \"smtps\" protocol and false for the \"smtp\" protocol.\n+#               The default value is true for the \"smtps\" protocol and false for the \"smtp\" protocol\n+# + properties - SMTP properties to override the existing configuration\n public type SmtpConfig record {|\n     int port = 465;\n     boolean enableSsl = true;\n+    Property[]? properties = ();", "originalCommit": "a23cf6a43539d7278fd3087909f5135e100bc9e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA5ODI1Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#discussion_r417098253", "bodyText": "Changed.", "author": "Maninda", "createdAt": "2020-04-29T06:45:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA0NDI4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA0NTMyMg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#discussion_r417045322", "bodyText": "I think we need to give priority to the predefined fields? shall we first add custom properties and then add field values.", "author": "daneshk", "createdAt": "2020-04-29T03:18:53Z", "path": "stdlib/email/src/main/java/org/ballerinalang/stdlib/email/util/SmtpUtil.java", "diffHunk": "@@ -74,6 +75,15 @@ public static Properties getProperties(MapValue smtpConfig, String host) {\n         properties.put(EmailConstants.PROPS_SMTP_AUTH, \"true\");\n         properties.put(EmailConstants.PROPS_SMTP_STARTTLS, \"true\");\n         properties.put(EmailConstants.PROPS_ENABLE_SSL, smtpConfig.getBooleanValue(EmailConstants.PROPS_SSL));\n+        CommonUtil.addCustomProperties(smtpConfig.getArrayValue(EmailConstants.PROPS_PROPERTIES), properties);\n+        if (log.isDebugEnabled()) {\n+            Set<String> propertySet = properties.stringPropertyNames();\n+            log.debug(\"SMTP Properties set are as follows.\");\n+            for (Object propertyObj : propertySet) {\n+                log.debug(\"Property Name: \" + propertyObj + \", Value: \" + properties.get(propertyObj).toString()\n+                        + \" ValueType: \" + properties.get(propertyObj).getClass().getName());\n+            }\n+        }", "originalCommit": "a23cf6a43539d7278fd3087909f5135e100bc9e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA5MDE2OA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22949#discussion_r417090168", "bodyText": "Custom properties are given higher priority to override the default functionality of the connector for advanced users.", "author": "Maninda", "createdAt": "2020-04-29T06:23:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA0NTMyMg=="}], "type": "inlineReview"}, {"oid": "bba9caa4ebd234be91c40a3f7602b46a95ed75f4", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bba9caa4ebd234be91c40a3f7602b46a95ed75f4", "message": "Implement the suggestions given in the PR review", "committedDate": "2020-04-29T06:31:13Z", "type": "commit"}]}