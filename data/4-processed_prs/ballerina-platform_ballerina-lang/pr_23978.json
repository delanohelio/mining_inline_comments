{"pr_number": 23978, "pr_title": "Add API to check resource is secured or not [1.2.x]", "pr_createdAt": "2020-06-12T03:43:24Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/23978", "timeline": [{"oid": "5e5a375c692be7b8dbcb216944372c16eb4d40b4", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5e5a375c692be7b8dbcb216944372c16eb4d40b4", "message": "Add API to check resource is secured or not", "committedDate": "2020-06-12T03:41:54Z", "type": "commit"}, {"oid": "f2055c7e3dbc9cce50af7f008a6883646d835c7d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f2055c7e3dbc9cce50af7f008a6883646d835c7d", "message": "Fix langserver test cases", "committedDate": "2020-06-12T03:42:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ3NDIwNw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23978#discussion_r439474207", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if (resourceSecured is boolean) {\n          \n          \n            \n                    if (!resourceSecured) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }\n          \n          \n            \n                } else {\n          \n          \n            \n                    if (!serviceSecured) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }\n          \n          \n            \n                }\n          \n          \n            \n                return true;\n          \n          \n            \n                if (resourceSecured is boolean) {\n          \n          \n            \n                    return resourceSecured;\n          \n          \n            \n                } else {\n          \n          \n            \n                    return serviceSecured;\n          \n          \n            \n                }", "author": "ldclakmal", "createdAt": "2020-06-12T15:02:50Z", "path": "stdlib/http/src/main/ballerina/src/http/auth/utils.bal", "diffHunk": "@@ -57,6 +57,29 @@ public function extractAuthorizationHeaderValue(Request req) returns @tainted st\n     return req.getHeader(AUTH_HEADER);\n }\n \n+# Checks whether the calling resource is secured by evaluating the authentication hierarchy.\n+#\n+# + context - The `FilterContext` instance\n+# + return - The status of calling resource is secured or not\n+public function isResourceSecured(FilterContext context) returns boolean {\n+    ResourceAuth? resourceLevelAuthAnn = getResourceAuthConfig(context);\n+    ServiceAuth? serviceLevelAuthAnn = getServiceAuthConfig(context);\n+\n+    boolean? resourceSecured = isResourceAuthEnabled(resourceLevelAuthAnn);\n+    boolean serviceSecured = isServiceAuthEnabled(serviceLevelAuthAnn);\n+\n+    if (resourceSecured is boolean) {\n+        if (!resourceSecured) {\n+            return false;\n+        }\n+    } else {\n+        if (!serviceSecured) {\n+            return false;\n+        }\n+    }\n+    return true;", "originalCommit": "f2055c7e3dbc9cce50af7f008a6883646d835c7d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9bb5025949584e57ef23ef5a357a9e443cb18cf9", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9bb5025949584e57ef23ef5a357a9e443cb18cf9", "message": "Update stdlib/http/src/main/ballerina/src/http/auth/utils.bal", "committedDate": "2020-06-12T15:03:00Z", "type": "commit"}, {"oid": "6b1198da5369b18c1c17ebbcd363f2f35b1420fc", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6b1198da5369b18c1c17ebbcd363f2f35b1420fc", "message": "Merge branch 'ballerina-1.2.x' of https://github.com/ballerina-platform/ballerina-lang into fix-auth-1.2.x", "committedDate": "2020-06-13T03:25:13Z", "type": "commit"}]}