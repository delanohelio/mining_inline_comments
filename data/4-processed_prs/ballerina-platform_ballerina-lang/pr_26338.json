{"pr_number": 26338, "pr_title": "Make positions 0-based in the compiler", "pr_createdAt": "2020-10-13T16:14:16Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/26338", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ5NzQ1MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26338#discussion_r504497450", "bodyText": "With this change, now we don't need to convert a SyntaxDiagnostic to BLangDiagnostic. Shall we remove that conversion too?", "author": "SupunS", "createdAt": "2020-10-14T08:31:25Z", "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/parser/Parser.java", "diffHunk": "@@ -150,9 +150,9 @@ private void reportSyntaxDiagnostics(BDiagnosticSource diagnosticSource, SyntaxT\n             Location syntaxLocation = syntaxDiagnostic.location();\n             LineRange lineRange = syntaxLocation.lineRange();\n             LinePosition startLine = lineRange.startLine();\n-            LinePosition endLine = lineRange.startLine();\n-            Location location = new BLangDiagnosticLocation(diagnosticSource.cUnitName, startLine.line() + 1,\n-                    endLine.line() + 1, startLine.offset() + 1, endLine.offset() + 1);\n+            LinePosition endLine = lineRange.endLine();\n+            Location location = new BLangDiagnosticLocation(diagnosticSource.cUnitName, startLine.line(),\n+                                                            endLine.line(), startLine.offset(), endLine.offset());\n             BLangDiagnostic diag =\n                     new BLangDiagnostic(location, syntaxDiagnostic.message(), syntaxDiagnostic.diagnosticInfo());", "originalCommit": "0a59bd55e7c24d1db3f213c4676093ea4cdc6f8f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDUwNDIxOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26338#discussion_r504504219", "bodyText": "Ah ideally yes. Wanted to bring that up actually. That was what I tried at first. But for some reason that broke the sorting of the diagnostics. The syntax diagnostics and semantic diagnostics got interspersed. In our current implementation, we show the syntax errors first and then the semantic errors.", "author": "pubudu91", "createdAt": "2020-10-14T08:41:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ5NzQ1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDgwMzk0MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26338#discussion_r504803941", "bodyText": "Fixed with 506d8b8", "author": "pubudu91", "createdAt": "2020-10-14T16:13:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDQ5NzQ1MA=="}], "type": "inlineReview"}, {"oid": "761d39d6cd3e054341bb001d64d88d9111a150eb", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/761d39d6cd3e054341bb001d64d88d9111a150eb", "message": "Rename srcFile -> fileName", "committedDate": "2020-10-14T11:15:58Z", "type": "commit"}, {"oid": "72309c37fe8e7f9d22230254b911661fe60decfa", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/72309c37fe8e7f9d22230254b911661fe60decfa", "message": "Make positions 0-based in the compiler", "committedDate": "2020-10-14T11:17:15Z", "type": "commit"}, {"oid": "47914ead507915a860ac669aead8bfc9bc31a68c", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/47914ead507915a860ac669aead8bfc9bc31a68c", "message": "Fix position info in oberservability gen", "committedDate": "2020-10-14T11:17:16Z", "type": "commit"}, {"oid": "506d8b8e12cb4bf951d42090892bcc41bb24a617", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/506d8b8e12cb4bf951d42090892bcc41bb24a617", "message": "Remove unnecessary conversion of syntax diagnostic -> blang diagnostic", "committedDate": "2020-10-14T11:17:16Z", "type": "commit"}, {"oid": "506d8b8e12cb4bf951d42090892bcc41bb24a617", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/506d8b8e12cb4bf951d42090892bcc41bb24a617", "message": "Remove unnecessary conversion of syntax diagnostic -> blang diagnostic", "committedDate": "2020-10-14T11:17:16Z", "type": "forcePushed"}, {"oid": "063a2e7d5099b181e2f0971990ce94ed7a88622d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/063a2e7d5099b181e2f0971990ce94ed7a88622d", "message": "Fix missing node filtering test", "committedDate": "2020-10-14T14:45:02Z", "type": "commit"}]}