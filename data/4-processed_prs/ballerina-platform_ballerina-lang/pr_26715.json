{"pr_number": 26715, "pr_title": "[Testerina] Add diff to the error message when equality assertion fails for anydata map", "pr_createdAt": "2020-11-03T10:13:39Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/26715", "timeline": [{"oid": "69e3ac630e377d7f377c894d932f7c404360c99f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/69e3ac630e377d7f377c894d932f7c404360c99f", "message": "Add map assertion diff implementation", "committedDate": "2020-11-02T19:13:20Z", "type": "commit"}, {"oid": "bdcbe4fe06e5284819cfd2a358c6cd0d2efe17fb", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/bdcbe4fe06e5284819cfd2a358c6cd0d2efe17fb", "message": "Improve test cases for assertion errors", "committedDate": "2020-11-03T10:00:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjU1ODkxMg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/26715#discussion_r516558912", "bodyText": "Is this a description comment or something that needs to be asserted? Can we remove it?", "author": "Ibaqu", "createdAt": "2020-11-03T10:20:10Z", "path": "tests/testerina-integration-test/src/test/resources/project-based-tests/basic-tests/src/assertions-error-messages/tests/assertions-diff-error-messages.bal", "diffHunk": "@@ -56,18 +70,45 @@ function testAssertJsonValues() {\n     json bioData2 = {name:\"John Doe New\", age:25, address:{city:\"Colombo\", country:\"Sri Lanka\"}};\n     error? err = trap test:assertEquals(bioData, bioData2);\n     error result = <error>err;\n-    test:assertEquals(result.message().toString(),\n-    \"Assertion Failed!\\n \\nexpected: '{\\\"name\\\":\\\"John Doe New\\\",\\\"age\\\":25,\\\"address\\\":{\\\"city\\\":\\\"Colombo\\\",\" + \"\\\"country\\\":\\\"Sri Lanka...'\\nactual\\t: '{\\\"name\\\":\\\"John Doe\\\",\\\"age\\\":25,\\\"address\\\":{\\\"city\\\":\\\"Colombo\\\",\" + \"\\\"country\\\":\\\"Sri Lanka\\\"}}'\");\n+    test:assertEquals(result.message().toString(), \"Assertion Failed!\\n \\nexpected: '{\\\"name\\\":\\\"John Doe New\\\",\\\"age\\\":25,\\\"address\\\":{\\\"city\\\":\\\"Colombo\\\",\" + \"\\\"country\\\":\\\"Sri Lanka...'\\nactual\\t: '{\\\"name\\\":\\\"John Doe\\\",\\\"age\\\":25,\\\"address\\\":{\\\"city\\\":\\\"Colombo\\\",\" + \"\\\"country\\\":\\\"Sri Lanka\\\"}}'\\n \\nDiff\\t:\\n \\n\\n \\nkey: name\\nexpected value\\t: John Doe New\\nactual value\\t: John Doe \\n \\n\");\n+}\n+\n+@test:Config {}\n+function testAssertJsonInJson() {\n+    json j1 = {name: \"Anne\", age: \"21\", marks: {maths: 100, physics: 90, status: {pass:true}}};\n+    json j2 = {name: \"Anne\", age: 21, marks: {maths: 100, physics: 90, status: {pass:false}}};\n+    error? err = trap test:assertEquals(j1, j2);\n+    error result = <error>err;\n+    test:assertEquals(result.message().toString(), \"Assertion Failed!\\n \\nexpected: '{\\\"name\\\":\\\"Anne\\\",\\\"age\\\":21,\\\"marks\\\":{\\\"maths\\\":100,\\\"physics\\\":90,\\\"status\\\":{\\\"pass\\\":false...'\\nactual\\t: '{\\\"name\\\":\\\"Anne\\\",\\\"age\\\":\\\"21\\\",\\\"marks\\\":{\\\"maths\\\":100,\\\"physics\\\":90,\\\"status\\\":{\\\"pass\\\":tru...'\\n \\nDiff\\t:\\n \\n\\n \\nkey: age\\nexpected value\\t: <int> 21\\nactual value\\t: <string> 21 \\n\\n \\nkey: marks.status.pass\\nexpected value\\t: false\\nactual value\\t: true \\n \\n\");\n }\n \n @test:Config {}\n function testAssertLongJsonValues() {\n     json bioData = {name:\"John Doe Old\", age:25, designation: \"SSE\", address:{city:\"Colombo\", country:\"Sri Lankaa\"}};\n     json bioData2 = {name:\"John Doe New\", age:25, designation: \"SSE\", address:{city:\"Colombo\", country:\"Sri Lanka\"}};\n+    //test:assertEquals(bioData, bioData2);", "originalCommit": "bdcbe4fe06e5284819cfd2a358c6cd0d2efe17fb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "edde6278718b60ebe8538e7460f696eb7e7c357e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/edde6278718b60ebe8538e7460f696eb7e7c357e", "message": "Remove unnecessary comments", "committedDate": "2020-11-03T11:04:07Z", "type": "commit"}, {"oid": "035d8a2348642d0932a18010ea185794e8889946", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/035d8a2348642d0932a18010ea185794e8889946", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into fix-formatting-diff", "committedDate": "2020-11-03T13:26:24Z", "type": "commit"}]}