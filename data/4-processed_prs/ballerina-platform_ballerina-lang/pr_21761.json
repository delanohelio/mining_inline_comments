{"pr_number": 21761, "pr_title": "[Observability] Remove connector name from the metric id", "pr_createdAt": "2020-03-13T13:02:54Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/21761", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIxOTMzNQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21761#discussion_r392219335", "bodyText": "Can we do an integer division here instead of String.valueOf(statusCode).charAt(0) ? I think it might be better.", "author": "nadundesilva", "createdAt": "2020-03-13T13:15:05Z", "path": "stdlib/grpc/src/main/java/org/ballerinalang/net/grpc/ObservableClientConnectorListener.java", "diffHunk": "@@ -64,7 +65,7 @@ public void onError(Throwable throwable) {\n \n     private void addHttpStatusCode(int statusCode) {\n         Optional<ObserverContext> observerContext = ObserveUtils.getObserverContextOfCurrentFrame(context.getStrand());\n-        observerContext.ifPresent(ctx -> ctx.addTag(ObservabilityConstants.TAG_KEY_HTTP_STATUS_CODE,\n-                String.valueOf(statusCode)));\n+        observerContext.ifPresent(ctx -> ctx.addTag(ObservabilityConstants.TAG_KEY_HTTP_STATUS_CODE_GROUP,\n+                String.valueOf(statusCode).charAt(0) + STATUS_CODE_GROUP_SUFFIX));", "originalCommit": "24288c264a8a6985b01d798c487623ba32e982ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM4OTUyMg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21761#discussion_r392389522", "bodyText": "Fixed with f22240b", "author": "madushajg", "createdAt": "2020-03-13T18:05:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIxOTMzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIyMDQxOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21761#discussion_r392220419", "bodyText": "Same as in the other place we can use integer division. It might be even better to just hardcode \"5xx\"\nPlease do so in all similar places", "author": "nadundesilva", "createdAt": "2020-03-13T13:17:04Z", "path": "stdlib/grpc/src/main/java/org/ballerinalang/net/grpc/callback/StreamingCallableUnitCallBack.java", "diffHunk": "@@ -40,20 +41,21 @@ public StreamingCallableUnitCallBack(StreamObserver responseSender, ObserverCont\n         this.responseSender = responseSender;\n         this.observerContext = context;\n     }\n-    \n+\n     @Override\n     public void notifySuccess() {\n         super.notifySuccess();\n     }\n-    \n+\n     @Override\n     public void notifyFailure(ErrorValue error) {\n         if (responseSender != null) {\n             handleFailure(responseSender, error);\n         }\n         if (observerContext != null) {\n-            observerContext.addTag(TAG_KEY_HTTP_STATUS_CODE,\n-                    String.valueOf(getMappingHttpStatusCode(Status.Code.INTERNAL.value())));\n+            observerContext.addTag(TAG_KEY_HTTP_STATUS_CODE_GROUP,\n+                    String.valueOf(getMappingHttpStatusCode(Status.Code.INTERNAL.value())).charAt(0) +\n+                            STATUS_CODE_GROUP_SUFFIX);", "originalCommit": "24288c264a8a6985b01d798c487623ba32e982ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM4OTYyNQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21761#discussion_r392389625", "bodyText": "Fixed with f22240b", "author": "madushajg", "createdAt": "2020-03-13T18:05:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjIyMDQxOQ=="}], "type": "inlineReview"}, {"oid": "c8322b197207ef440188b1df14e1d334904bb202", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c8322b197207ef440188b1df14e1d334904bb202", "message": "Fix chestyle issues", "committedDate": "2020-03-14T06:26:19Z", "type": "forcePushed"}, {"oid": "87f8be9447a73fcda0bbb48ffd2f05e318707340", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/87f8be9447a73fcda0bbb48ffd2f05e318707340", "message": "Remove connector name from the metric id", "committedDate": "2020-03-14T08:26:32Z", "type": "commit"}, {"oid": "4caeb6b7734a7490c554644982bae25fd2f75a9d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4caeb6b7734a7490c554644982bae25fd2f75a9d", "message": "Check for empty action names before adding connector name tag", "committedDate": "2020-03-14T08:26:32Z", "type": "commit"}, {"oid": "e3e22bc50db373548833734dd969c94e076520ee", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e3e22bc50db373548833734dd969c94e076520ee", "message": "Add review suggestions", "committedDate": "2020-03-14T08:26:32Z", "type": "commit"}, {"oid": "e9539a2eb2f351f282199ed88bba4908ea80e997", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e9539a2eb2f351f282199ed88bba4908ea80e997", "message": "Fix chestyle issues", "committedDate": "2020-03-14T08:26:32Z", "type": "commit"}, {"oid": "c3a0eb7bf34526d0c5d08f3a7f085023fe402c2e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c3a0eb7bf34526d0c5d08f3a7f085023fe402c2e", "message": "Update the metrics test cases", "committedDate": "2020-03-14T08:59:17Z", "type": "forcePushed"}, {"oid": "81998aeb982f22e0cdd8b3796613e61ba6713b14", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/81998aeb982f22e0cdd8b3796613e61ba6713b14", "message": "Update the metrics test cases", "committedDate": "2020-03-14T09:23:52Z", "type": "forcePushed"}, {"oid": "efd56439774062c3f28dcf338952b52877be20c5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/efd56439774062c3f28dcf338952b52877be20c5", "message": "Update the metrics test cases", "committedDate": "2020-03-14T12:45:42Z", "type": "commit"}, {"oid": "efd56439774062c3f28dcf338952b52877be20c5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/efd56439774062c3f28dcf338952b52877be20c5", "message": "Update the metrics test cases", "committedDate": "2020-03-14T12:45:42Z", "type": "forcePushed"}]}