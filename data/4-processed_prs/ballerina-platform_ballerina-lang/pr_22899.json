{"pr_number": 22899, "pr_title": "Add support for complex types as sql params", "pr_createdAt": "2020-04-25T19:37:55Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899", "timeline": [{"oid": "94e04df4b329c4ba2876cd3f5f934b07a7c638bb", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/94e04df4b329c4ba2876cd3f5f934b07a7c638bb", "message": "Add missing complex types", "committedDate": "2020-04-17T09:20:16Z", "type": "commit"}, {"oid": "82645078fa58d5b316769b05b23455d8f9fade11", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/82645078fa58d5b316769b05b23455d8f9fade11", "message": "Merge branch 'upstream-master' into sql-connector-params-support", "committedDate": "2020-04-21T05:24:20Z", "type": "commit"}, {"oid": "b06fb4cd44a8171b9dfe00424ccde884e160c335", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b06fb4cd44a8171b9dfe00424ccde884e160c335", "message": "Add ref, row and xml type support", "committedDate": "2020-04-22T18:09:23Z", "type": "commit"}, {"oid": "f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e", "message": "Add test cases for jdbc2 and mysql connectors", "committedDate": "2020-04-25T19:34:20Z", "type": "commit"}, {"oid": "11b1fc96010268e9ce933a0ea7419663642a7706", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/11b1fc96010268e9ce933a0ea7419663642a7706", "message": "Merge branch 'upstream-master' into sql-connector-params-support", "committedDate": "2020-04-25T19:40:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY5ODY0NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899#discussion_r415698645", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            function queryJdbcClient(string url, string user, string password,@untainted string|sql:ParameterizedString sqlQuery,\n          \n          \n            \n            function queryJdbcClient(string url, string user, string password, @untainted string|sql:ParameterizedString sqlQuery,", "author": "daneshk", "createdAt": "2020-04-27T10:32:47Z", "path": "stdlib/database/jdbc2/src/test/resources/test-src/query/simple-params-query-test.bal", "diffHunk": "@@ -839,10 +900,11 @@ function getClobColumnChannel() returns @untainted io:ReadableCharacterChannel|e\n     return sourceChannel;\n }\n \n-function queryJdbcClient(string url, string user, string password,@untainted string|sql:ParameterizedString sqlQuery)\n+function queryJdbcClient(string url, string user, string password,@untainted string|sql:ParameterizedString sqlQuery,", "originalCommit": "f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTcyNjUxNA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899#discussion_r415726514", "bodyText": "Is it possible to avoid setting an empty array for insertions, If insertions not required?\nMay be setting a default value", "author": "daneshk", "createdAt": "2020-04-27T11:18:38Z", "path": "stdlib/database/mysql/src/test/resources/test-src/query/simple-params-query-test.bal", "diffHunk": "@@ -656,6 +710,80 @@ function queryTimestampStringInvalidParam() returns @tainted record {}|error? {\n     return queryMysqlClient(sqlQuery);\n }\n \n+function queryEnumStringParam() returns @tainted record {}|error? {\n+    sql:ParameterizedString sqlQuery = {\n+            parts: [\"SELECT * from ENUMTable where enum_type=\", \"\"],\n+            insertions: [\"doctor\"]\n+     };\n+    return queryMysqlClient(sqlQuery);\n+}\n+\n+type EnumResult record {|\n+    int id;\n+    string enum_type;\n+|};\n+\n+function queryEnumStringParam2() returns @tainted record {}|error? {\n+    sql:ParameterizedString sqlQuery = {\n+            parts: [\"SELECT * from ENUMTable where enum_type=\", \"\"],\n+            insertions: [\"doctor\"]\n+     };\n+    return queryMysqlClient(sqlQuery, resultType=EnumResult);\n+}\n+\n+function querySetStringParam() returns @tainted record {}|error? {\n+    sql:ParameterizedString sqlQuery = {\n+            parts: [\"SELECT * from SetTable where set_type=\", \"\"],\n+            insertions: [\"a,d\"]\n+     };\n+    return queryMysqlClient(sqlQuery);\n+}\n+\n+function queryGeoParam() returns @tainted record {}|error? {\n+    sql:ParameterizedString sqlQuery = {\n+            parts: [\"SELECT id, ST_AsText(geom) as geomText from GEOTable\"],\n+            insertions: []", "originalCommit": "f79a77a6d38a5a7a2cb47fcc5ba22d3b9ef6f72e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTczNjcyOA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/22899#discussion_r415736728", "bodyText": "This is a temporary syntax based on this - https://docs.google.com/document/d/1F1Hlxc8rWmKmJKiWnqmeDOQ1XFckrmbeL5V8UxQAD3c/edit#heading=h.f4zz0m9kmsmf, corresponding spec issue - ballerina-platform/ballerina-spec#442. Once these issues are addressed in the language, will make necessary changes to support that syntax in the module to change the current syntax.", "author": "sinthuja", "createdAt": "2020-04-27T11:35:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTcyNjUxNA=="}], "type": "inlineReview"}, {"oid": "15cd9cda73d99373af9a50e774f2ec41d5c63e34", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/15cd9cda73d99373af9a50e774f2ec41d5c63e34", "message": "Update stdlib/database/jdbc2/src/test/resources/test-src/query/simple-params-query-test.bal\n\nCo-Authored-By: Danesh Kuruppu <daneshk@users.noreply.github.com>", "committedDate": "2020-04-27T11:27:52Z", "type": "commit"}, {"oid": "4356e33f1b6dc1d0659896ce74a37da882b6cc99", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4356e33f1b6dc1d0659896ce74a37da882b6cc99", "message": "Add some test cases for execute operation", "committedDate": "2020-04-28T14:10:19Z", "type": "commit"}, {"oid": "806a6b9d68e4e19f68022f181aeae8847fabd998", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/806a6b9d68e4e19f68022f181aeae8847fabd998", "message": "Merge branch 'upstream-master' into sql-connector-params-support", "committedDate": "2020-04-28T14:11:17Z", "type": "commit"}, {"oid": "960ed7507d76a526803f0ebcda60954b9f49d719", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/960ed7507d76a526803f0ebcda60954b9f49d719", "message": "Add formatting fixes.", "committedDate": "2020-04-28T14:33:54Z", "type": "commit"}, {"oid": "1743af08193b48ec27fd567011d6846c664dd31b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1743af08193b48ec27fd567011d6846c664dd31b", "message": "Merge remote-tracking branch 'origin/sql-connector-params-support' into sql-connector-params-support\n\n# Conflicts:\n#\tstdlib/database/jdbc2/src/test/resources/test-src/query/simple-params-query-test.bal", "committedDate": "2020-04-28T14:36:16Z", "type": "commit"}, {"oid": "6be498e9155d7c786566b88081084edca7a1fbf7", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6be498e9155d7c786566b88081084edca7a1fbf7", "message": "Merge branch 'upstream-master' into sql-connector-params-support", "committedDate": "2020-04-28T16:55:18Z", "type": "commit"}, {"oid": "148ac1255da89dd6c50d35c7cdde5d8ee78963d2", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/148ac1255da89dd6c50d35c7cdde5d8ee78963d2", "message": "Add formatting fixes.", "committedDate": "2020-04-28T17:26:06Z", "type": "commit"}, {"oid": "7d870660a3ffeb78bedb87e6886095179b9aaaf5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/7d870660a3ffeb78bedb87e6886095179b9aaaf5", "message": "Merge branch 'sql-connector-params-support' into sql-params-execute\n\n# Conflicts:\n#\tstdlib/database/sql/src/test/resources/test-module/mock-sql/src/query/simple-params-query-test.bal", "committedDate": "2020-04-29T06:30:08Z", "type": "commit"}, {"oid": "654c3e1c45043219ff9a392c6d0c81551dbfa10c", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/654c3e1c45043219ff9a392c6d0c81551dbfa10c", "message": "Add test cases for sql connector regarding the execute operation with params", "committedDate": "2020-04-29T13:10:11Z", "type": "commit"}, {"oid": "4560d4f90c09b6eca52ad3b92e92beacf1135399", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4560d4f90c09b6eca52ad3b92e92beacf1135399", "message": "Add jdbc test cases for jdbc connector regarding the execute operation with params", "committedDate": "2020-04-29T13:40:25Z", "type": "commit"}, {"oid": "98ce0c010295b0811b5a275398b1dd0ffa250592", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/98ce0c010295b0811b5a275398b1dd0ffa250592", "message": "Add mysql test cases", "committedDate": "2020-04-29T14:20:05Z", "type": "commit"}]}