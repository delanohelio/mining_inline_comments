{"pr_number": 27282, "pr_title": "Add parameters passed when logging to diagnostics", "pr_createdAt": "2020-12-02T04:06:38Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/27282", "timeline": [{"oid": "02922e9316333de33960119daca420cfccb9fa31", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/02922e9316333de33960119daca420cfccb9fa31", "message": "Add new constructor to diagnostic-info", "committedDate": "2020-12-02T04:33:05Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzg5MTA3Mg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27282#discussion_r533891072", "bodyText": "Shouldn't this args part of the DiagnosticRelatedInformation?", "author": "rasika", "createdAt": "2020-12-02T04:36:23Z", "path": "compiler/ballerina-tools-api/src/main/java/io/ballerina/tools/diagnostics/DiagnosticInfo.java", "diffHunk": "@@ -32,21 +32,31 @@\n     private final String messageTemplate;\n     private final DiagnosticSeverity severity;\n     private final Collection<DiagnosticRelatedInformation> relatedInformation;\n+    private Object[] args;\n \n     public DiagnosticInfo(String code,\n                           String messageTemplate,\n                           DiagnosticSeverity severity) {\n-        this(code, messageTemplate, severity, Collections.emptyList());\n+        this(code, messageTemplate, severity, Collections.emptyList(), null);\n     }\n \n     public DiagnosticInfo(String code,\n                           String messageTemplate,\n                           DiagnosticSeverity severity,\n-                          Collection<DiagnosticRelatedInformation> relatedInformation) {\n+                          Object[] args) {\n+        this(code, messageTemplate, severity, Collections.emptyList(), args);\n+    }\n+\n+    public DiagnosticInfo(String code,\n+                          String messageTemplate,\n+                          DiagnosticSeverity severity,\n+                          Collection<DiagnosticRelatedInformation> relatedInformation,\n+                          Object[] args) {\n         this.code = code;\n         this.messageTemplate = messageTemplate;\n         this.severity = severity;\n         this.relatedInformation = relatedInformation;\n+        this.args = args;", "originalCommit": "02922e9316333de33960119daca420cfccb9fa31", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzg5MjU3Nw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27282#discussion_r533892577", "bodyText": "Args being Object api-consumer need to call instanceOf. Can't we have a specific thing for symbol-info where the type is Symbol", "author": "rasika", "createdAt": "2020-12-02T04:41:46Z", "path": "compiler/ballerina-tools-api/src/main/java/io/ballerina/tools/diagnostics/DiagnosticInfo.java", "diffHunk": "@@ -64,4 +74,8 @@ public DiagnosticSeverity severity() {\n     public Collection<DiagnosticRelatedInformation> relatedInformation() {\n         return relatedInformation;\n     }\n+\n+    public Object[] getArgs() {", "originalCommit": "02922e9316333de33960119daca420cfccb9fa31", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzkxNzk3MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27282#discussion_r533917970", "bodyText": "In BlangDiagnosticLog usages (such as error() method), sometimes it takes BTypes and sometimes Strings. That's why I have allowed for Object. Any alternative way to do this ?", "author": "dulajdilshan", "createdAt": "2020-12-02T06:06:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzg5MjU3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTg2ODczNA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27282#discussion_r535868734", "bodyText": "Yes, IMO at this phase, we cannot migrate all diagnostics into args based templates. Even we do, there's no point in retrieving string args since it does not contain any symbol meta-data. What diagnostics messages missing are the symbol-info. Thus, it should be symbol-info which are optional and may provided by some diagnostics such as incompatible types.", "author": "rasika", "createdAt": "2020-12-04T06:35:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzg5MjU3Nw=="}], "type": "inlineReview"}, {"oid": "866b87f924f133dcde15f9c2af47f3b8e7a0df0b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/866b87f924f133dcde15f9c2af47f3b8e7a0df0b", "message": "Add diagnostic-args to diagnostics", "committedDate": "2020-12-09T11:57:21Z", "type": "forcePushed"}, {"oid": "4f7e884ca812fa8e8e4f4bc8a44db4d90d754e06", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/4f7e884ca812fa8e8e4f4bc8a44db4d90d754e06", "message": "Replace some parameters with their symbolic value in dlog.error API usages in CodeAnalyzer", "committedDate": "2020-12-10T22:05:04Z", "type": "forcePushed"}, {"oid": "35fba7e77f883e0919763ed5e26f411c2a7e1517", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/35fba7e77f883e0919763ed5e26f411c2a7e1517", "message": "Replace some parameters with their symbolic value in dlog.error API usages in CodeAnalyzer", "committedDate": "2020-12-10T22:40:10Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDY4NjMxMw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27282#discussion_r540686313", "bodyText": "Shall we pass Collections.emptyList() to avoid possible NPEs and minimize null checks from the api-consumer side", "author": "rasika", "createdAt": "2020-12-11T04:41:53Z", "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/diagnostic/BLangDiagnostic.java", "diffHunk": "@@ -34,20 +37,20 @@\n     private String msg;\n     private DiagnosticInfo diagnosticInfo;\n     private DiagnosticCode diagnosticCode;\n+    private List<DiagnosticProperty> properties;\n \n-    public BLangDiagnostic(Location location, String msg, DiagnosticInfo diagnosticInfo) {\n-        this.location = location;\n-        this.msg = msg;\n-        this.diagnosticInfo = diagnosticInfo;\n-        this.diagnosticCode = null;\n+    public BLangDiagnostic(Location location, String msg, DiagnosticInfo diagnosticInfo,\n+                           DiagnosticCode diagnosticCode) {\n+        this(location, msg, diagnosticInfo, diagnosticCode, null);", "originalCommit": "35fba7e77f883e0919763ed5e26f411c2a7e1517", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDc5NjgwMQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27282#discussion_r540796801", "bodyText": "sure", "author": "dulajdilshan", "createdAt": "2020-12-11T09:10:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDY4NjMxMw=="}], "type": "inlineReview"}, {"oid": "2a324ad09d5b767c929d2ea9a91c568394cedc4f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/2a324ad09d5b767c929d2ea9a91c568394cedc4f", "message": "Remove Property interfaces", "committedDate": "2021-01-08T13:22:07Z", "type": "forcePushed"}, {"oid": "23bf2db2ff45ffaf7ed4bcae7141b8fd7421fa9a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/23bf2db2ff45ffaf7ed4bcae7141b8fd7421fa9a", "message": "Add properties to diagnostics", "committedDate": "2021-01-08T14:21:15Z", "type": "commit"}, {"oid": "82449cfbfe4edea4303193d4a76c036fcc6f998a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/82449cfbfe4edea4303193d4a76c036fcc6f998a", "message": "Change arguments to symbol in dlog.error in DataflowAnalyzer", "committedDate": "2021-01-08T14:21:15Z", "type": "commit"}, {"oid": "8ef71d4a08d65a32efe1bfba6d5275daeb6ba4aa", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8ef71d4a08d65a32efe1bfba6d5275daeb6ba4aa", "message": "Replace some parameters with their symbolic value in dlog.error API usages in CodeAnalyzer", "committedDate": "2021-01-08T14:21:15Z", "type": "commit"}, {"oid": "270e82767957e983ad17e197c48b060cb1480a89", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/270e82767957e983ad17e197c48b060cb1480a89", "message": "Pass Collections.emptyList() to avoid possible NPEs", "committedDate": "2021-01-08T14:21:15Z", "type": "commit"}, {"oid": "dabaac52b743087e91071fb9c9a3f79504e15041", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/dabaac52b743087e91071fb9c9a3f79504e15041", "message": "Rename package with 'properties'", "committedDate": "2021-01-08T14:21:16Z", "type": "commit"}, {"oid": "0d46599dad64e6347ff9088d941b1730160c81a0", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0d46599dad64e6347ff9088d941b1730160c81a0", "message": "Expose 'value()' API", "committedDate": "2021-01-08T14:21:16Z", "type": "commit"}, {"oid": "9a07ad985c587256f4aa5a77e2ad661dc42b597e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9a07ad985c587256f4aa5a77e2ad661dc42b597e", "message": "Remove diagnostic-related-info from diagnostic-info", "committedDate": "2021-01-08T14:21:16Z", "type": "commit"}, {"oid": "5ccf0f5829d8f4596dd274e1e3174dc41dad7a64", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5ccf0f5829d8f4596dd274e1e3174dc41dad7a64", "message": "Make attributes final", "committedDate": "2021-01-08T14:21:16Z", "type": "commit"}, {"oid": "09b4a3874c9c2e0826f6246791e6d5c7a115eda3", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/09b4a3874c9c2e0826f6246791e6d5c7a115eda3", "message": "Remove Property interfaces", "committedDate": "2021-01-08T14:21:16Z", "type": "commit"}, {"oid": "0be81b136981c70034a6a2ffe297a3b809a227e6", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0be81b136981c70034a6a2ffe297a3b809a227e6", "message": "Fix checkstyle issues", "committedDate": "2021-01-08T14:21:16Z", "type": "forcePushed"}, {"oid": "ffa37bc95888e04877af428c7d11fc72cc46f066", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ffa37bc95888e04877af428c7d11fc72cc46f066", "message": "Fix checkstyle issues", "committedDate": "2021-01-08T15:55:15Z", "type": "commit"}, {"oid": "ffa37bc95888e04877af428c7d11fc72cc46f066", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ffa37bc95888e04877af428c7d11fc72cc46f066", "message": "Fix checkstyle issues", "committedDate": "2021-01-08T15:55:15Z", "type": "forcePushed"}, {"oid": "8508ac645aded072a2ee0d39285f034968897875", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8508ac645aded072a2ee0d39285f034968897875", "message": "fix missing javadoc @param <T>", "committedDate": "2021-01-08T16:05:47Z", "type": "commit"}]}