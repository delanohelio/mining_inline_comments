{"pr_number": 24718, "pr_title": "Support executing a single test function", "pr_createdAt": "2020-07-14T05:11:29Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718", "timeline": [{"oid": "9971499b65f8608beb4dd5beac0c194cb452ea3a", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/9971499b65f8608beb4dd5beac0c194cb452ea3a", "message": "Support executing a single test function", "committedDate": "2020-07-14T21:33:13Z", "type": "forcePushed"}, {"oid": "1409b7d8cb22f52e6914328ffc90f60b91a7bdfe", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/1409b7d8cb22f52e6914328ffc90f60b91a7bdfe", "message": "Support executing a single test function", "committedDate": "2020-07-14T22:15:41Z", "type": "forcePushed"}, {"oid": "a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "message": "Support executing a single test function", "committedDate": "2020-07-14T22:23:31Z", "type": "commit"}, {"oid": "a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "message": "Support executing a single test function", "committedDate": "2020-07-14T22:23:31Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc3NzYwMg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718#discussion_r454777602", "bodyText": "Can we name the options as --tests", "author": "hevayo", "createdAt": "2020-07-15T04:04:32Z", "path": "cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/TestCommand.java", "diffHunk": "@@ -149,6 +149,9 @@ public TestCommand(Path userDir, PrintStream outStream, PrintStream errStream, b\n     @CommandLine.Option(names = \"--home-cache\", description = \"Custom home cache\")\n     private String homeCache;\n \n+    @CommandLine.Option(names = \"--functions\", split = \",\", description = \"Test functions to be executed\")", "originalCommit": "a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc3ODQzOQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718#discussion_r454778439", "bodyText": "Can we give a more specific response", "author": "hevayo", "createdAt": "2020-07-15T04:07:26Z", "path": "tests/testerina-integration-test/src/test/java/org/ballerinalang/testerina/test/SelectedFunctionTest.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package org.ballerinalang.testerina.test;\n+\n+import org.ballerinalang.test.context.BMainInstance;\n+import org.ballerinalang.test.context.BallerinaTestException;\n+import org.ballerinalang.test.context.LogLeecher;\n+import org.testng.annotations.BeforeClass;\n+import org.testng.annotations.Test;\n+\n+/**\n+ * Test class containing tests related to selective function tests.\n+ */\n+public class SelectedFunctionTest extends BaseTestCase {\n+\n+    private BMainInstance balClient;\n+    private String projectPath;\n+\n+    @BeforeClass\n+    public void setup() throws BallerinaTestException {\n+        balClient = new BMainInstance(balServer);\n+        projectPath = basicTestsProjectPath.toString();\n+    }\n+\n+    @Test\n+    public void testSingleFunctionExecution() throws BallerinaTestException {\n+        String msg = \"1 passing\";\n+        LogLeecher clientLeecher = new LogLeecher(msg);\n+        balClient.runMain(\"test\", new String[]{\"--functions\", \"testFunc\", \"beforeEachAfterEach\"},\n+                null, new String[]{}, new LogLeecher[]{clientLeecher}, projectPath);\n+        clientLeecher.waitForText(20000);\n+    }\n+\n+    @Test\n+    public void testDependentFunctionExecution() throws BallerinaTestException {\n+        String msg = \"2 passing\";\n+        LogLeecher clientLeecher = new LogLeecher(msg);\n+        balClient.runMain(\"test\", new String[]{\"--functions\", \"testFunc2\", \"beforeEachAfterEach\"},\n+                null, new String[]{}, new LogLeecher[]{clientLeecher}, projectPath);\n+        clientLeecher.waitForText(20000);\n+    }\n+\n+    @Test\n+    public void testMultipleFunctionExecution() throws BallerinaTestException {\n+        String msg = \"2 passing\";\n+        LogLeecher clientLeecher = new LogLeecher(msg);\n+        balClient.runMain(\"test\", new String[]{\"--functions\", \"testFunc,testFunc2\",\n+                \"beforeEachAfterEach\"}, null, new String[]{}, new LogLeecher[]{clientLeecher}, projectPath);\n+        clientLeecher.waitForText(20000);\n+    }\n+\n+    @Test\n+    public void testNonExistingFunctionExecution() throws BallerinaTestException {\n+        String msg = \"No tests found\";", "originalCommit": "a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc3ODQ5OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718#discussion_r454778499", "bodyText": "What is the error code of this.", "author": "hevayo", "createdAt": "2020-07-15T04:07:45Z", "path": "tests/testerina-integration-test/src/test/java/org/ballerinalang/testerina/test/SelectedFunctionTest.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package org.ballerinalang.testerina.test;\n+\n+import org.ballerinalang.test.context.BMainInstance;\n+import org.ballerinalang.test.context.BallerinaTestException;\n+import org.ballerinalang.test.context.LogLeecher;\n+import org.testng.annotations.BeforeClass;\n+import org.testng.annotations.Test;\n+\n+/**\n+ * Test class containing tests related to selective function tests.\n+ */\n+public class SelectedFunctionTest extends BaseTestCase {\n+\n+    private BMainInstance balClient;\n+    private String projectPath;\n+\n+    @BeforeClass\n+    public void setup() throws BallerinaTestException {\n+        balClient = new BMainInstance(balServer);\n+        projectPath = basicTestsProjectPath.toString();\n+    }\n+\n+    @Test\n+    public void testSingleFunctionExecution() throws BallerinaTestException {\n+        String msg = \"1 passing\";\n+        LogLeecher clientLeecher = new LogLeecher(msg);\n+        balClient.runMain(\"test\", new String[]{\"--functions\", \"testFunc\", \"beforeEachAfterEach\"},\n+                null, new String[]{}, new LogLeecher[]{clientLeecher}, projectPath);\n+        clientLeecher.waitForText(20000);\n+    }\n+\n+    @Test\n+    public void testDependentFunctionExecution() throws BallerinaTestException {\n+        String msg = \"2 passing\";\n+        LogLeecher clientLeecher = new LogLeecher(msg);\n+        balClient.runMain(\"test\", new String[]{\"--functions\", \"testFunc2\", \"beforeEachAfterEach\"},\n+                null, new String[]{}, new LogLeecher[]{clientLeecher}, projectPath);\n+        clientLeecher.waitForText(20000);\n+    }\n+\n+    @Test\n+    public void testMultipleFunctionExecution() throws BallerinaTestException {\n+        String msg = \"2 passing\";\n+        LogLeecher clientLeecher = new LogLeecher(msg);\n+        balClient.runMain(\"test\", new String[]{\"--functions\", \"testFunc,testFunc2\",\n+                \"beforeEachAfterEach\"}, null, new String[]{}, new LogLeecher[]{clientLeecher}, projectPath);\n+        clientLeecher.waitForText(20000);\n+    }\n+\n+    @Test\n+    public void testNonExistingFunctionExecution() throws BallerinaTestException {\n+        String msg = \"No tests found\";\n+        LogLeecher clientLeecher = new LogLeecher(msg);\n+        balClient.runMain(\"test\", new String[]{\"--functions\", \"nonExistingFunc\", \"--all\"},\n+                null, new String[]{}, new LogLeecher[]{clientLeecher}, projectPath);\n+        clientLeecher.waitForText(20000);", "originalCommit": "a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkwNTcyMQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718#discussion_r454905721", "bodyText": "There's no error code as such. If the provided text is not found within the timeout period, an error message as \"Timeout expired waiting for matching log\" will be given. Does that answer your question?", "author": "Dilhasha", "createdAt": "2020-07-15T09:07:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc3ODQ5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkxMDM0NA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718#discussion_r454910344", "bodyText": "AFAIU, @hevayo is asking about the exit code of the command. According to the current implementation, the exit code is 0, when no tests found to execute. Ideally this should be 1.", "author": "azinneera", "createdAt": "2020-07-15T09:15:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc3ODQ5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDkyMTE5NA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718#discussion_r454921194", "bodyText": "Yeh sorry I was referring to exit code", "author": "hevayo", "createdAt": "2020-07-15T09:34:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc3ODQ5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc3ODc1NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718#discussion_r454778755", "bodyText": "Wouldnt it be better to name the option as --tests", "author": "azinneera", "createdAt": "2020-07-15T04:08:58Z", "path": "cli/ballerina-packerina/src/main/java/org/ballerinalang/packerina/cmd/TestCommand.java", "diffHunk": "@@ -149,6 +149,9 @@ public TestCommand(Path userDir, PrintStream outStream, PrintStream errStream, b\n     @CommandLine.Option(names = \"--home-cache\", description = \"Custom home cache\")\n     private String homeCache;\n \n+    @CommandLine.Option(names = \"--functions\", split = \",\", description = \"Test functions to be executed\")", "originalCommit": "a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4MjExMg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24718#discussion_r454782112", "bodyText": "Shall we add test cases to check the behavior to test the following:\n\nwhen trying to run a disabled test case\nwhen trying to run a test case which depends on a disabled tests case", "author": "azinneera", "createdAt": "2020-07-15T04:22:16Z", "path": "tests/testerina-integration-test/src/test/java/org/ballerinalang/testerina/test/SelectedFunctionTest.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package org.ballerinalang.testerina.test;\n+\n+import org.ballerinalang.test.context.BMainInstance;\n+import org.ballerinalang.test.context.BallerinaTestException;\n+import org.ballerinalang.test.context.LogLeecher;\n+import org.testng.annotations.BeforeClass;\n+import org.testng.annotations.Test;\n+\n+/**\n+ * Test class containing tests related to selective function tests.\n+ */\n+public class SelectedFunctionTest extends BaseTestCase {", "originalCommit": "a58a19c3c7708cc23868d33bb79e5e90ca0bed29", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0100686922816b37b3f8fc746289aeabc04bfd71", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0100686922816b37b3f8fc746289aeabc04bfd71", "message": "Fix PR suggestions", "committedDate": "2020-07-15T09:01:28Z", "type": "commit"}, {"oid": "697af76a935b85814aa1a79fbb96bf5d77defb3f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/697af76a935b85814aa1a79fbb96bf5d77defb3f", "message": "Fix issue in single test execution", "committedDate": "2020-07-16T08:12:27Z", "type": "commit"}]}