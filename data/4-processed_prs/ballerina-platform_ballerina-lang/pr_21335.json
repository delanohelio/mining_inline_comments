{"pr_number": 21335, "pr_title": "Send vscode client configuration during initialization", "pr_createdAt": "2020-02-27T11:40:15Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/21335", "timeline": [{"oid": "396d3313e219e543e3964e0a34ba0dd0a2dcdf9d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/396d3313e219e543e3964e0a34ba0dd0a2dcdf9d", "message": "Send vscode client configuration during initialization\n\nSigned-off-by: Rasika <info.rasika@gmail.com>", "committedDate": "2020-02-27T11:39:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE1ODkyNw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21335#discussion_r385158927", "bodyText": "I think this is to capture the initial configuration at the server-side? It seems that we are violating the LSP by sending the didChangeConfiguration notification through the extension bypassing the protocol. I think what we should do to fetch the initial configuration is to use the configuration request at the server-side [1].\n[1] https://microsoft.github.io/language-server-protocol/specifications/specification-3-14/#workspace_configuration", "author": "nadeeshaan", "createdAt": "2020-02-27T14:25:44Z", "path": "tool-plugins/vscode/src/extension.ts", "diffHunk": "@@ -91,6 +91,21 @@ export function activate(context: ExtensionContext): Promise<any> {\n         activateTreeView(ballerinaExtInstance);\n         // Enable Ballerina Syntax Highlighter\n         activateSyntaxHighlighter(ballerinaExtInstance);\n+\n+        ballerinaExtInstance.onReady().then(() => {\n+            const langClient = <ExtendedLangClient>ballerinaExtInstance.langClient;\n+            // Send initial configuration \n+            const args: DidChangeConfigurationParams = {\n+                settings: workspace.getConfiguration('ballerina'),\n+            };\n+            langClient.sendNotification(\"workspace/didChangeConfiguration\", args);", "originalCommit": "396d3313e219e543e3964e0a34ba0dd0a2dcdf9d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU2MzkwNQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21335#discussion_r385563905", "bodyText": "+1, initially I was reluctant to add this workspace/configuration request since some clients might not have implemented it. If we stressing down on the protocol let's strict with it, I'll add a fix.", "author": "rasika", "createdAt": "2020-02-28T08:28:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE1ODkyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTU2OTQ2NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21335#discussion_r385569465", "bodyText": "+1, initially I was reluctant to add this workspace/configuration request since some clients might not have implemented it. If we stressing down on the protocol let's strict with it, I'll add a fix.\n\nAwesome :D", "author": "nadeeshaan", "createdAt": "2020-02-28T08:43:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE1ODkyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjIxMjUzNQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21335#discussion_r386212535", "bodyText": "As discussed since we are having troubles in getting the result of the CompletableFuture, will do this as an improvement. Created #21390 to track this.", "author": "rasika", "createdAt": "2020-03-02T06:15:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE1ODkyNw=="}], "type": "inlineReview"}]}