{"pr_number": 23424, "pr_title": "Allow type inclusion of non-abstract objects", "pr_createdAt": "2020-05-22T06:37:46Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424", "timeline": [{"oid": "44ddc32949f082754a4e55021e176b7b21c96b85", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/44ddc32949f082754a4e55021e176b7b21c96b85", "message": "Fix object type inclusion bstring unit test cases", "committedDate": "2020-05-22T07:20:26Z", "type": "forcePushed"}, {"oid": "8d65d05d521e5e254b260f3f7b107fa92e3b2d0e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8d65d05d521e5e254b260f3f7b107fa92e3b2d0e", "message": "Code improvement", "committedDate": "2020-05-25T08:12:09Z", "type": "forcePushed"}, {"oid": "f27dd8313b27806842b1608032b120482012fd4f", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f27dd8313b27806842b1608032b120482012fd4f", "message": "Fix existing test for non abstract obj inclusion", "committedDate": "2020-05-26T02:10:25Z", "type": "forcePushed"}, {"oid": "25e97d2cb587ad136f09523d18d5a12e34890555", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/25e97d2cb587ad136f09523d18d5a12e34890555", "message": "Fix existing test for non abstract obj inclusion", "committedDate": "2020-05-26T04:51:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkyMDYyMw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424#discussion_r432920623", "bodyText": "When you replace, ArrayList with a HashSet, you lose the insertion order. That may cause intermittent test failures. Better option is to replace it with a LinkedHashSet.", "author": "hasithaa", "createdAt": "2020-05-31T07:53:42Z", "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/SymbolEnter.java", "diffHunk": "@@ -1431,7 +1432,7 @@ private void defineMembers(List<BLangTypeDefinition> typeDefNodes, SymbolEnv pkg\n                     defineNode(f, objMethodsEnv);\n                 });\n \n-                List<String> referencedFunctions = new ArrayList<>();\n+                Set<String> referencedFunctions = new HashSet<>();", "originalCommit": "25e97d2cb587ad136f09523d18d5a12e34890555", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk5MzA5OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424#discussion_r432993099", "bodyText": "This is only used to check duplicates and issue DiagnosticCode.REDECLARED_SYMBOL error message. [EDIT] I will rename this DS\n\n  \n    \n      ballerina-lang/compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/SymbolEnter.java\n    \n    \n         Line 1879\n      in\n      ac9058f\n    \n    \n    \n    \n\n        \n          \n           if (referencedFunctions.contains(referencedFuncName)) {", "author": "KRVPerera", "createdAt": "2020-05-31T22:58:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkyMDYyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY2MTIxNQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424#discussion_r433661215", "bodyText": "I renamed the DS to make sure it is not mistaken with referencedFunctions member field in BObjectTypeSymbol.\nCommit : 6e55b93", "author": "KRVPerera", "createdAt": "2020-06-02T07:01:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkyMDYyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkyMjE2Mg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424#discussion_r432922162", "bodyText": "We need to add a balo test case for this feature.", "author": "hasithaa", "createdAt": "2020-05-31T08:16:07Z", "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/balo/object/ObjectInBaloTest.java", "diffHunk": "@@ -571,7 +571,9 @@ public void testObjectReferingTypeFromBaloNegative() {\n         int i = 0;\n         BAssertUtil.validateError(result, i++, \"undefined field 'name' in object 'Manager1'\", 25, 13);\n         BAssertUtil.validateError(result, i++, \"undefined field 'age' in object 'Manager1'\", 26, 13);\n-        BAssertUtil.validateError(result, i, \"incompatible types: 'foo:Manager1' is not an abstract object\", 38, 6);\n+        BAssertUtil.validateError(result, i,\n+                                  \"incompatible type reference 'foo:Manager1': a referenced object cannot have \" +\n+                                          \"non-public fields or methods\", 38, 6);\n     }\n ", "originalCommit": "25e97d2cb587ad136f09523d18d5a12e34890555", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY2MDE3MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424#discussion_r433660171", "bodyText": "Added :\n\n8e86018\n95c235c", "author": "KRVPerera", "createdAt": "2020-06-02T06:59:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkyMjE2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjI3MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424#discussion_r432952270", "bodyText": "Why are we using testerina?\nWe don't usually import non-langlib modules for language tests, including testerina.", "author": "MaryamZi", "createdAt": "2020-05-31T14:23:42Z", "path": "tests/jballerina-unit-test/src/test/resources/test-src/object/object-type-reference.bal", "diffHunk": "@@ -13,6 +13,7 @@\n // KIND, either express or implied.  See the License for the\n // specific language governing permissions and limitations\n // under the License.\n+import ballerina/test;", "originalCommit": "25e97d2cb587ad136f09523d18d5a12e34890555", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzA2NTA5OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424#discussion_r433065099", "bodyText": "Will remove this.", "author": "KRVPerera", "createdAt": "2020-06-01T06:36:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY1OTk5Nw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23424#discussion_r433659997", "bodyText": "Done : f5f5a22", "author": "KRVPerera", "createdAt": "2020-06-02T06:58:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjI3MA=="}], "type": "inlineReview"}, {"oid": "07ac3e86245b8588cfffa4010a6f71b9c4539786", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/07ac3e86245b8588cfffa4010a6f71b9c4539786", "message": "Allow type inclusion of non-abstract objects", "committedDate": "2020-06-02T06:57:51Z", "type": "commit"}, {"oid": "6f18534c09999b7c1ab9b2815681ddcc9e83e3de", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6f18534c09999b7c1ab9b2815681ddcc9e83e3de", "message": "Fix object type inclusion unit test cases", "committedDate": "2020-06-02T06:57:52Z", "type": "commit"}, {"oid": "841dd156ade9daf18281733bb57e721be34ee278", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/841dd156ade9daf18281733bb57e721be34ee278", "message": "Set interface flag for referenced function symbols", "committedDate": "2020-06-02T06:57:52Z", "type": "commit"}, {"oid": "57f4f70540c9594491b61240bec57fbd5f8a19d9", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/57f4f70540c9594491b61240bec57fbd5f8a19d9", "message": "Fix existing test for non abstract obj inclusion", "committedDate": "2020-06-02T06:57:52Z", "type": "commit"}, {"oid": "6e55b9358886a9cc9ec6bef3fbd9a41a834bb1d2", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6e55b9358886a9cc9ec6bef3fbd9a41a834bb1d2", "message": "Rename DS name to improve readability", "committedDate": "2020-06-02T06:57:52Z", "type": "commit"}, {"oid": "f5f5a222febd5fa5e52b1786058666918333aaf9", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f5f5a222febd5fa5e52b1786058666918333aaf9", "message": "Remove testerina dependency", "committedDate": "2020-06-02T06:57:52Z", "type": "commit"}, {"oid": "fa61026cb10ac2da61984697167376a2d8d8b27d", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fa61026cb10ac2da61984697167376a2d8d8b27d", "message": "Fix Code : variable name", "committedDate": "2020-06-02T06:57:52Z", "type": "commit"}, {"oid": "8e8601896a6850ade29a643e2e92a1153f220a2e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8e8601896a6850ade29a643e2e92a1153f220a2e", "message": "Balos test cases : non-abstract object inclusion", "committedDate": "2020-06-02T06:57:52Z", "type": "commit"}, {"oid": "8e8601896a6850ade29a643e2e92a1153f220a2e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8e8601896a6850ade29a643e2e92a1153f220a2e", "message": "Balos test cases : non-abstract object inclusion", "committedDate": "2020-06-02T06:57:52Z", "type": "forcePushed"}, {"oid": "95c235c517b7ef90f0bf84eb193f2bcb2a369983", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/95c235c517b7ef90f0bf84eb193f2bcb2a369983", "message": "Add test non-abstract object inclusion from balos", "committedDate": "2020-06-02T16:42:19Z", "type": "commit"}]}