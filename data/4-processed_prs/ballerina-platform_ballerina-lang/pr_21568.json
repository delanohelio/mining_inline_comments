{"pr_number": 21568, "pr_title": "Disallow method invocation directly after xml navigation access expression.", "pr_createdAt": "2020-03-10T08:17:23Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568", "timeline": [{"oid": "ae0efe4157d4f76ea98a9a869214addc9702fd25", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ae0efe4157d4f76ea98a9a869214addc9702fd25", "message": "Disallow method invocations on xml navigation exp", "committedDate": "2020-03-10T06:30:07Z", "type": "commit"}, {"oid": "296f39f714c1a334ecc8af161dd193b150c3a818", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/296f39f714c1a334ecc8af161dd193b150c3a818", "message": "Fix unit-test failures", "committedDate": "2020-03-10T07:54:51Z", "type": "commit"}, {"oid": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/ecf5f4a36f2ab6933e508a5d8db0d21a888b6717", "message": "Improve error message", "committedDate": "2020-03-10T08:08:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDE3Nzg2MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390177860", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              method invocations are not supported within XML navigation expressions yet, use grouping expression (parenthesis) \\\n          \n          \n            \n              method invocations are not yet supported within XML navigation expressions, use a grouping expression (parenthesis) \\", "author": "MaryamZi", "createdAt": "2020-03-10T09:14:27Z", "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -488,6 +488,10 @@ error.invalid.xml.ns.interpolation=\\\n error.cannot.find.xml.namespace.prefix=\\\n   cannot find xml namespace prefix ''{0}''\n \n+error.method.invocation.in.xml.navigation.expressions.not.supported=\\\n+  method invocations are not supported within XML navigation expressions yet, use grouping expression (parenthesis) \\", "originalCommit": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDE3ODA1Ng==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390178056", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              if you intent to invoke the method in the result of navigation expression.\n          \n          \n            \n              if you intend to invoke the method on the result of the navigation expression.", "author": "MaryamZi", "createdAt": "2020-03-10T09:14:47Z", "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -488,6 +488,10 @@ error.invalid.xml.ns.interpolation=\\\n error.cannot.find.xml.namespace.prefix=\\\n   cannot find xml namespace prefix ''{0}''\n \n+error.method.invocation.in.xml.navigation.expressions.not.supported=\\\n+  method invocations are not supported within XML navigation expressions yet, use grouping expression (parenthesis) \\\n+  if you intent to invoke the method in the result of navigation expression.", "originalCommit": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDE5NzYxOA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390197618", "bodyText": "Can't we use\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        dlog.error(((BLangInvocation) expression.parent).name.pos,\n          \n          \n            \n                        dlog.error(((BLangInvocation) expression.parent).pos,\n          \n      \n    \n    \n  \n\ninstead?", "author": "MaryamZi", "createdAt": "2020-03-10T09:48:57Z", "path": "compiler/ballerina-lang/src/main/java/org/wso2/ballerinalang/compiler/semantics/analyzer/CodeAnalyzer.java", "diffHunk": "@@ -2102,6 +2102,15 @@ public void visit(BLangXMLNavigationAccess xmlNavigation) {\n         if (xmlNavigation.childIndex != null) {\n             analyzeExpr(xmlNavigation.childIndex);\n         }\n+        validateMethodInvocationsInXMLNavigationExpression(xmlNavigation);\n+    }\n+\n+    private void validateMethodInvocationsInXMLNavigationExpression(BLangXMLNavigationAccess expression) {\n+        if (!expression.methodInvocationAnalyzed && expression.parent.getKind() == NodeKind.INVOCATION) {\n+            dlog.error(((BLangInvocation) expression.parent).name.pos,", "originalCommit": "ecf5f4a36f2ab6933e508a5d8db0d21a888b6717", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDM2NDMzNA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390364334", "bodyText": "Wanted to get the error highlighting just for method name + paranthesis, but just realized that paranthesis will not be included in the position. Will changed to suggested.", "author": "rdhananjaya", "createdAt": "2020-03-10T14:41:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDE5NzYxOA=="}], "type": "inlineReview"}, {"oid": "f3794f583ef3f9c2491f8034035765b46b91cc44", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/f3794f583ef3f9c2491f8034035765b46b91cc44", "message": "Apply review suggestions", "committedDate": "2020-03-10T14:56:03Z", "type": "commit"}, {"oid": "c6c609b53ed79ddc2b35b211a76acd898b639d57", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c6c609b53ed79ddc2b35b211a76acd898b639d57", "message": "Allow navigation expression as func argument", "committedDate": "2020-03-10T15:21:51Z", "type": "commit"}, {"oid": "83f67bde878fac9c6e6e1dc055a6f38782be86fd", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/83f67bde878fac9c6e6e1dc055a6f38782be86fd", "message": "Fix failing langlib test cases", "committedDate": "2020-03-11T00:39:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDc1MzQ5MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/21568#discussion_r390753490", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              method invocations are not yet supported within XML navigation expressions yet, use a grouping expression \\\n          \n          \n            \n              method invocations are not yet supported within XML navigation expressions, use a grouping expression \\", "author": "MaryamZi", "createdAt": "2020-03-11T05:31:51Z", "path": "compiler/ballerina-lang/src/main/resources/compiler.properties", "diffHunk": "@@ -488,6 +488,10 @@ error.invalid.xml.ns.interpolation=\\\n error.cannot.find.xml.namespace.prefix=\\\n   cannot find xml namespace prefix ''{0}''\n \n+error.method.invocation.in.xml.navigation.expressions.not.supported=\\\n+  method invocations are not yet supported within XML navigation expressions yet, use a grouping expression \\", "originalCommit": "83f67bde878fac9c6e6e1dc055a6f38782be86fd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3c84f89aec60630e0e35a260b363d761bb501271", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/3c84f89aec60630e0e35a260b363d761bb501271", "message": "Fix error message grammar", "committedDate": "2020-03-11T07:18:51Z", "type": "commit"}]}