{"pr_number": 24799, "pr_title": "Add import function mocking implementation details to Module md file", "pr_createdAt": "2020-07-17T05:32:26Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/24799", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzMzQwNw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24799#discussion_r456233407", "bodyText": "Since the feature is generalized to handle both imported functions and functions in the same module using the test:MockFunction, we don't need this separation now. We can put a general description under the title ### Function Mocking", "author": "azinneera", "createdAt": "2020-07-17T05:55:05Z", "path": "misc/testerina/modules/testerina-core/src/main/ballerina/src/test/Module.md", "diffHunk": "@@ -114,6 +114,25 @@ function testMockImportedFunction() {\n }\n ```\n \n+Scoping and stubbing of mock functions declared for import functions is also supported\n+\n+```ballerina\n+import ballerina/math;\n+import ballerina/test;\n+\n+@test:Mock {\n+    moduleName : \"ballerina/math\",\n+    functionName : \"absInt\"\n+}\n+test:MockFunction mock_absInt = new();\n+\n+@test:Config {}\n+public function testFunction() {\n+    test:when(mock_absInt).thenReturn(100);\n+    test:assertEquals(math:absInt(-5), 100);\n+}\n+```\n+\n #### Mocking a function in the same module", "originalCommit": "49edbf9f1a3e2870b111917b060f9e48b6e5f46c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0MTkzMQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24799#discussion_r456241931", "bodyText": "Changed it so that it we use a general description for both", "author": "Ibaqu", "createdAt": "2020-07-17T06:22:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzMzQwNw=="}], "type": "inlineReview"}, {"oid": "60041d459c35492f0bb178bdf8d85e8aaa914a52", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/60041d459c35492f0bb178bdf8d85e8aaa914a52", "message": "Add import function mocking implementation details to Module md file", "committedDate": "2020-07-17T06:20:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0NDkwMg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24799#discussion_r456244902", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The annotation `@test:Mock` is used to declare a MockFunction object, with details of the name of the function to be mocked, as well as the module name if an import function is being mocked. The module name value of the annotation is optional if the function being mocked is not an import function.\n          \n          \n            \n            The annotation `@test:Mock {}` is used to declare a `MockFunction` object, with details of the name of the function to be mocked, as well as the module name if an import function is being mocked. The module name value of the annotation is optional if the function being mocked is not an import function.", "author": "azinneera", "createdAt": "2020-07-17T06:30:43Z", "path": "misc/testerina/modules/testerina-core/src/main/ballerina/src/test/Module.md", "diffHunk": "@@ -87,38 +87,28 @@ function intAdd(int a, int b) returns (int) {\n The test module provides capabilities to mock a function or an object for unit testing. The mocking features can be used to control the behavior of functions and objects by defining return values or replacing the entire object or function with a user-defined equivalent. This feature will help you to test the Ballerina code independently from other modules and external endpoints.\n \n ### Function Mocking\n-Function mocking allows to control the behavior of a function in the module under test or a function of an imported module. \n+Function mocking allows to control the behavior of a function in the module being tested or a function of an imported module. \n \n-An annotation is used to declare a mock function within which the original function to be mocked should be defined using the annotation parameters. The function specified with this annotation allows to mock an imported function whereas the same annotation specified with the test:MockFunction object allows to mock a function in the module under test.\n-\n-#### Mocking an imported function\n-\n-Mocking an imported function will invoke the mock function every time that the original function is called. Mocking a function will apply the mocked function to every instance of the original function call. It is not limited to the test file where it is being mocked. A compile time error will be thrown in case of a signature mismatch between the mock function and the original.\n+The annotation `@test:Mock` is used to declare a MockFunction object, with details of the name of the function to be mocked, as well as the module name if an import function is being mocked. The module name value of the annotation is optional if the function being mocked is not an import function.", "originalCommit": "60041d459c35492f0bb178bdf8d85e8aaa914a52", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0NTg0Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/24799#discussion_r456245843", "bodyText": "Commited suggestion", "author": "Ibaqu", "createdAt": "2020-07-17T06:33:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0NDkwMg=="}], "type": "inlineReview"}, {"oid": "62f164e4de49527d7501eb94c730c655e7870f45", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/62f164e4de49527d7501eb94c730c655e7870f45", "message": "Add import function mocking implementation details to Module md file", "committedDate": "2020-07-17T06:32:53Z", "type": "commit"}, {"oid": "62f164e4de49527d7501eb94c730c655e7870f45", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/62f164e4de49527d7501eb94c730c655e7870f45", "message": "Add import function mocking implementation details to Module md file", "committedDate": "2020-07-17T06:32:53Z", "type": "forcePushed"}]}