{"pr_number": 27175, "pr_title": "Fix bad sad error due to connection error & Improve central client exceptions and errors", "pr_createdAt": "2020-11-26T07:12:10Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/27175", "timeline": [{"oid": "d4ce02dcae2e88d33dabab670137bcf1c8040b13", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/d4ce02dcae2e88d33dabab670137bcf1c8040b13", "message": "Fix offline build issue", "committedDate": "2020-11-26T07:09:44Z", "type": "commit"}, {"oid": "0ecc379d288824396134caea5b129dc0fe8a1d48", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/0ecc379d288824396134caea5b129dc0fe8a1d48", "message": "Improve central client errors & exceptions", "committedDate": "2020-11-26T09:41:48Z", "type": "commit"}, {"oid": "e1e668cb666e233ee9a8bee3764e8efe318e71f5", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/e1e668cb666e233ee9a8bee3764e8efe318e71f5", "message": "Merge branch 'master' of https://github.com/ballerina-platform/ballerina-lang into central-cmd-fix", "committedDate": "2020-11-26T09:44:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkxMTgyNw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27175#discussion_r530911827", "bodyText": "Specific exceptions can extend on the CentralClientException", "author": "hevayo", "createdAt": "2020-11-26T10:04:53Z", "path": "cli/central-client/src/main/java/org/ballerinalang/central/client/exceptions/PackageAlreadyExistsException.java", "diffHunk": "@@ -23,7 +23,7 @@\n  *\n  * @since 2.0.0\n  */\n-public class PackageAlreadyExistsException extends RuntimeException {\n+public class PackageAlreadyExistsException extends Exception {", "originalCommit": "e1e668cb666e233ee9a8bee3764e8efe318e71f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkxNzEzMw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27175#discussion_r530917133", "bodyText": "are we continuing offline here? If so shall we log a message to say that?", "author": "azinneera", "createdAt": "2020-11-26T10:13:14Z", "path": "compiler/ballerina-lang/src/main/java/io/ballerina/projects/internal/repositories/RemotePackageRepository.java", "diffHunk": "@@ -99,8 +101,14 @@ public static RemotePackageRepository from(Environment environment, Path cacheDi\n         }\n \n         List<PackageVersion> packageVersions = new ArrayList<>();\n-        for (String version : this.client.getPackageVersions(orgName, packageName)) {\n-            packageVersions.add(PackageVersion.from(version));\n+        try {\n+            for (String version : this.client.getPackageVersions(orgName, packageName)) {\n+                packageVersions.add(PackageVersion.from(version));\n+            }\n+        } catch (CentralClientException e) {\n+            throw new ProjectException(e.getMessage());\n+        } catch (ConnectionErrorException e) {\n+            // ignore connect to remote repo failure", "originalCommit": "e1e668cb666e233ee9a8bee3764e8efe318e71f5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkxOTU4NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27175#discussion_r530919585", "bodyText": "@hevayo @sameerajayasoma We decided not to log a warning message here right? Pls confirm.", "author": "pramodya1994", "createdAt": "2020-11-26T10:16:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkxNzEzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDk1MDIwNg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27175#discussion_r530950206", "bodyText": "Let's see if how this works. we can add the log as an improvement later.", "author": "azinneera", "createdAt": "2020-11-26T11:06:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkxNzEzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDk1MTEyMw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27175#discussion_r530951123", "bodyText": "Yes lets add as an improvement", "author": "hevayo", "createdAt": "2020-11-26T11:07:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkxNzEzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkxNzgwMw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27175#discussion_r530917803", "bodyText": "refer to the comment https://github.com/ballerina-platform/ballerina-lang/pull/27175/files#r530917133", "author": "azinneera", "createdAt": "2020-11-26T10:14:14Z", "path": "compiler/ballerina-lang/src/main/java/io/ballerina/projects/internal/repositories/RemotePackageRepository.java", "diffHunk": "@@ -78,8 +80,8 @@ public static RemotePackageRepository from(Environment environment, Path cacheDi\n             for (String supportedPlatform : SUPPORTED_PLATFORMS) {\n                 try {\n                     this.client.pullPackage(orgName, packageName, version, packagePathInBaloCache, supportedPlatform,\n-                            RepoUtils.getBallerinaVersion(), true);\n-                } catch (CentralClientException e) {\n+                                            RepoUtils.getBallerinaVersion(), true);\n+                } catch (CentralClientException | PackageAlreadyExistsException | ConnectionErrorException e) {", "originalCommit": "e1e668cb666e233ee9a8bee3764e8efe318e71f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkxOTA4MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/27175#discussion_r530919081", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * @since 1.2.0\n          \n          \n            \n             * @since 2.0.0", "author": "azinneera", "createdAt": "2020-11-26T10:16:07Z", "path": "cli/central-client/src/main/java/org/ballerinalang/central/client/exceptions/ConnectionErrorException.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+\n+package org.ballerinalang.central.client.exceptions;\n+\n+/**\n+ * Thrown to indicate connections errors to remote repository.\n+ *\n+ * @since 1.2.0", "originalCommit": "e1e668cb666e233ee9a8bee3764e8efe318e71f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5b13964b52f65715d825de27c6dff23dfa1e08e8", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/5b13964b52f65715d825de27c6dff23dfa1e08e8", "message": "Resolve PR comments", "committedDate": "2020-11-26T10:53:12Z", "type": "commit"}]}