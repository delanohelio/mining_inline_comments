{"pr_number": 20506, "pr_title": "Fix NPE on duplicate field in record declaration", "pr_createdAt": "2020-01-02T09:51:22Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/20506", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY5MTEzNg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20506#discussion_r362691136", "bodyText": "Do we need a separate class for this? Can't we just add these cases to https://github.com/ballerina-platform/ballerina-lang/blob/v1.1.0/tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/record/OpenRecordNegativeTest.java#L81", "author": "MaryamZi", "createdAt": "2020-01-03T02:15:07Z", "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/record/RecordDefNegativeTest.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package org.ballerinalang.test.record;\n+\n+import org.ballerinalang.test.util.BAssertUtil;\n+import org.ballerinalang.test.util.BCompileUtil;\n+import org.ballerinalang.test.util.CompileResult;\n+import org.testng.annotations.Test;\n+\n+/**\n+ * Test cases for user record definition negative test.\n+ */\n+public class RecordDefNegativeTest {", "originalCommit": "82737f26aa4c2027959e16ddc912acc4fd01c915", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjcwMjU0Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20506#discussion_r362702543", "bodyText": "This test case doesn't just belong to OpenRecord (or CloseRecords). Hence I thought it'd make sense this way.", "author": "irshadnilam", "createdAt": "2020-01-03T04:14:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY5MTEzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjcwMzA5Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20506#discussion_r362703093", "bodyText": "But we seem to be having tests for the same thing in two different places, which is not right IMO. Can we at least move those tests here?", "author": "MaryamZi", "createdAt": "2020-01-03T04:20:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY5MTEzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjcwODg5OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20506#discussion_r362708899", "bodyText": "+1 will move those here", "author": "irshadnilam", "createdAt": "2020-01-03T05:28:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY5MTEzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjcwOTU0Ng==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20506#discussion_r362709546", "bodyText": "I have removed the mentioned duplicate-key tests, as it is tested from the tests I have added.", "author": "irshadnilam", "createdAt": "2020-01-03T05:35:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY5MTEzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY5MTE5MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20506#discussion_r362691191", "bodyText": "The description does not reflect what's being tested IMO.", "author": "MaryamZi", "createdAt": "2020-01-03T02:15:42Z", "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/record/RecordDefNegativeTest.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied.  See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+package org.ballerinalang.test.record;\n+\n+import org.ballerinalang.test.util.BAssertUtil;\n+import org.ballerinalang.test.util.BCompileUtil;\n+import org.ballerinalang.test.util.CompileResult;\n+import org.testng.annotations.Test;\n+\n+/**\n+ * Test cases for user record definition negative test.\n+ */\n+public class RecordDefNegativeTest {\n+\n+    @Test(description = \"Negative test cases for record definition\")", "originalCommit": "82737f26aa4c2027959e16ddc912acc4fd01c915", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY5MTI4Nw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/20506#discussion_r362691287", "bodyText": "Shall we fix formatting?", "author": "MaryamZi", "createdAt": "2020-01-03T02:16:33Z", "path": "tests/jballerina-unit-test/src/test/resources/test-src/record/negative/duplicate-key-negative.bal", "diffHunk": "@@ -0,0 +1,37 @@\n+// Copyright (c) 2020 WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+//\n+// WSO2 Inc. licenses this file to you under the Apache License,\n+// Version 2.0 (the \"License\"); you may not use this file except\n+// in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+// http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+type Song record {|\n+    string name;\n+    int length;\n+|};\n+\n+function duplicateKeyTest1() {\n+     Song hello = {\n+         name: \"hello\",\n+         length: 1,\n+         name: \"hello\"\n+     };\n+}\n+\n+function duplicateKeyTest2() {\n+    Song hi;\n+    hi = {\n+            name: \"hi\",\n+            length: 2,\n+            name: \"hi\"\n+        };", "originalCommit": "82737f26aa4c2027959e16ddc912acc4fd01c915", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fd510d153b8a9f1e0413b7f08e8aff1a187e9cea", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/fd510d153b8a9f1e0413b7f08e8aff1a187e9cea", "message": "Fix NPE on duplicate field in record declaration", "committedDate": "2020-01-03T08:13:44Z", "type": "commit"}, {"oid": "c85f5daf00a378140e633b4e0e753f9a673becb0", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c85f5daf00a378140e633b4e0e753f9a673becb0", "message": "Add test case for duplicate key as string in record type", "committedDate": "2020-01-03T08:14:16Z", "type": "commit"}]}