{"pr_number": 23934, "pr_title": "Add API to check resource is secured or not [master]", "pr_createdAt": "2020-06-11T07:52:30Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/23934", "timeline": [{"oid": "6aaa9ba5a3f750b567f42e34c5c80e8c1cc909d9", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/6aaa9ba5a3f750b567f42e34c5c80e8c1cc909d9", "message": "Add API to check resource is secured or not", "committedDate": "2020-06-11T05:36:10Z", "type": "commit"}, {"oid": "b9bac88e1410eec60f90ec2a66693cf660b4ab62", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/b9bac88e1410eec60f90ec2a66693cf660b4ab62", "message": "Fix langserver test cases", "committedDate": "2020-06-12T02:27:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIxNzg0MQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23934#discussion_r439217841", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if (resourceSecured is boolean) {\n          \n          \n            \n                    if (!resourceSecured) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }\n          \n          \n            \n                } else {\n          \n          \n            \n                    if (!serviceSecured) {\n          \n          \n            \n                        return false;\n          \n          \n            \n                    }\n          \n          \n            \n                }\n          \n          \n            \n                return true;\n          \n          \n            \n                if (resourceSecured is boolean) {\n          \n          \n            \n                    return resourceSecured;\n          \n          \n            \n                } else {\n          \n          \n            \n                    return serviceSecured;\n          \n          \n            \n                }", "author": "daneshk", "createdAt": "2020-06-12T05:43:44Z", "path": "stdlib/http/src/main/ballerina/src/http/auth/utils.bal", "diffHunk": "@@ -57,6 +57,29 @@ public function extractAuthorizationHeaderValue(Request req) returns @tainted st\n     return req.getHeader(AUTH_HEADER);\n }\n \n+# Checks whether the calling resource is secured by evaluating the authentication hierarchy.\n+#\n+# + context - The `FilterContext` instance\n+# + return - The status of calling resource is secured or not\n+public function isResourceSecured(FilterContext context) returns boolean {\n+    ResourceAuth? resourceLevelAuthAnn = getResourceAuthConfig(context);\n+    ServiceAuth? serviceLevelAuthAnn = getServiceAuthConfig(context);\n+\n+    boolean? resourceSecured = isResourceAuthEnabled(resourceLevelAuthAnn);\n+    boolean serviceSecured = isServiceAuthEnabled(serviceLevelAuthAnn);\n+\n+    if (resourceSecured is boolean) {\n+        if (!resourceSecured) {\n+            return false;\n+        }\n+    } else {\n+        if (!serviceSecured) {\n+            return false;\n+        }\n+    }\n+    return true;", "originalCommit": "b9bac88e1410eec60f90ec2a66693cf660b4ab62", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ3MzU5NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/23934#discussion_r439473595", "bodyText": "Oh, I missed this simple logic due to copying and cleaning from exact complex logic. Thanks for pointing out!\nhttps://github.com/ballerina-platform/ballerina-lang/blob/master/stdlib/http/src/main/ballerina/src/http/auth/utils.bal#L73", "author": "ldclakmal", "createdAt": "2020-06-12T15:01:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTIxNzg0MQ=="}], "type": "inlineReview"}, {"oid": "a73d24e2440e71d0b0e6cf0b300ed4bb95338ca4", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/a73d24e2440e71d0b0e6cf0b300ed4bb95338ca4", "message": "Update stdlib/http/src/main/ballerina/src/http/auth/utils.bal\n\nCo-authored-by: Danesh Kuruppu <daneshk@users.noreply.github.com>", "committedDate": "2020-06-12T15:01:52Z", "type": "commit"}]}