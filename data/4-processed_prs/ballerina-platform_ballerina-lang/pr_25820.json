{"pr_number": 25820, "pr_title": "Add doc support for classes and abstract objects", "pr_createdAt": "2020-09-15T11:56:16Z", "pr_url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820", "timeline": [{"oid": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/8ddf93a264607cc9f2134c565aa623965bc33e5e", "message": "Change objects to class, add abstract objects", "committedDate": "2020-09-15T11:47:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc0MzY1Mg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488743652", "bodyText": "@shehan360 do we need check? Below for each won't execute if there are 0 entries?", "author": "keizer619", "createdAt": "2020-09-15T15:06:56Z", "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/Generator.java", "diffHunk": "@@ -417,28 +391,48 @@ private static void addDocForObjectType(BLangObjectTypeNode objectType,\n                 }\n             }\n         }\n+        module.abstractObjects.add(new BAbstractObject(name, description, isDeprecated, fields, functions));\n+    }\n+\n+    private static void addDocForClassType(BLangClassDefinition classDefinition, Module module) {\n+        List<Function> functions = new ArrayList<>();\n+        String name = classDefinition.getName().getValue();\n+        String description = description(classDefinition);\n+        boolean isDeprecated = isDeprecated(classDefinition.getAnnotationAttachments());\n+\n+        List<DefaultableVariable> fields = getFields(classDefinition, classDefinition.fields,\n+                classDefinition.getMarkdownDocumentationAttachment(), module);\n+\n+        // Iterate through the functions\n+        if (classDefinition.getFunctions().size() > 0) {", "originalCommit": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5MzkxOA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r489193918", "bodyText": "Yes the check can be removed", "author": "shehan360", "createdAt": "2020-09-16T06:30:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc0MzY1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2NjU5Mw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488766593", "bodyText": "isAnonymous is never used", "author": "pramodya1994", "createdAt": "2020-09-15T15:37:37Z", "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/Generator.java", "diffHunk": "@@ -391,9 +365,9 @@ private static String findDescFromList(String name, BLangMarkdownDocumentation d\n         }\n     }\n \n-    private static void addDocForObjectType(BLangObjectTypeNode objectType,\n-                                            BLangTypeDefinition parent,\n-                                            Module module) {\n+    private static void addDocForAbstractObjectType(BLangObjectTypeNode objectType,\n+                                                    BLangTypeDefinition parent,\n+                                                    Module module) {\n         List<Function> functions = new ArrayList<>();\n         String name = parent.getName().getValue();\n         boolean isAnonymous = false;", "originalCommit": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5NDA4OQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r489194089", "bodyText": "Fixed", "author": "shehan360", "createdAt": "2020-09-16T06:31:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2NjU5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2OTUwNQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488769505", "bodyText": "handlebars.registerHelper(\"addColon\",\n                    (Helper<PageContext>) (page, options) -> page.getClass() == ClassPageContext.class\n                            || page.getClass() == RecordPageContext.class || page.getClass() == ClientPageContext.class\n                            || page.getClass() == ListenerPageContext.class);\nCan't we simplify L152 - 160 like this?", "author": "pramodya1994", "createdAt": "2020-09-15T15:41:38Z", "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/Writer.java", "diffHunk": "@@ -168,7 +150,7 @@ public static void writeHtmlDocument(Object object, String packageTemplateName,\n             });\n \n             handlebars.registerHelper(\"addColon\", (Helper<PageContext>) (page, options) -> {\n-                if (page.getClass() == ObjectPageContext.class || page.getClass() == RecordPageContext.class ||\n+                if (page.getClass() == ClassPageContext.class || page.getClass() == RecordPageContext.class ||", "originalCommit": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5NDIxNA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r489194214", "bodyText": "Added the changes", "author": "shehan360", "createdAt": "2020-09-16T06:31:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc2OTUwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3MTA5NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488771095", "bodyText": "Access can be package-private for both consts", "author": "pramodya1994", "createdAt": "2020-09-15T15:43:43Z", "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/docs/BallerinaDocConstants.java", "diffHunk": "@@ -34,7 +34,8 @@\n     public static final String ORG_NAME = \"org-name\";\n     public static final String VERSION = \"version\";\n     public static final String RECORD_TEMPLATE_NAME_KEY = \"record.template.name\";\n-    public static final String OBJECT_TEMPLATE_NAME_KEY = \"object.template.name\";\n+    public static final String CLASS_TEMPLATE_NAME_KEY = \"class.template.name\";", "originalCommit": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5NDg5NA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r489194894", "bodyText": "Added the changes", "author": "shehan360", "createdAt": "2020-09-16T06:33:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3MTA5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3NDIxOA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488774218", "bodyText": "make this a static final constant or private & provide getters if need to access", "author": "pramodya1994", "createdAt": "2020-09-15T15:48:06Z", "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/generator/model/AbstractObjectPageContext.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://wso2.com) All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.ballerinalang.docgen.generator.model;\n+\n+/**\n+ * Page context for the Abstract Object page.\n+ *\n+ * @since 2.0\n+ */\n+public class AbstractObjectPageContext extends ModulePageContext {\n+    public BAbstractObject abstractObject;", "originalCommit": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5NDQ1MA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r489194450", "bodyText": "I think this has to be kept public because its accessed by handlebars template", "author": "shehan360", "createdAt": "2020-09-16T06:31:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3NDIxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3NzE0NQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488777145", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public BClass bClass;\n          \n          \n            \n                private BClass bClass;\n          \n      \n    \n    \n  \n\nAccess ca be private", "author": "pramodya1994", "createdAt": "2020-09-15T15:52:08Z", "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/generator/model/ClassPageContext.java", "diffHunk": "@@ -16,13 +16,15 @@\n package org.ballerinalang.docgen.generator.model;\n \n /**\n- * Page context for the object page.\n+ * Page context for the bClass page.\n+ *\n+ * @since 2.0\n  */\n-public class ObjectPageContext extends ModulePageContext {\n-    public Object object;\n-    public ObjectPageContext(Object object, Module module, Project project, String rootPath, String title,\n-                             boolean excludeIndex) {\n+public class ClassPageContext extends ModulePageContext {\n+    public BClass bClass;", "originalCommit": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5NDUxNA==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r489194514", "bodyText": "I think this has to be kept public because its accessed by handlebars template", "author": "shehan360", "createdAt": "2020-09-16T06:32:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3NzE0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3OTEwNw==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488779107", "bodyText": "// if anonymous empty record can remove one, since the same comment duplicated.", "author": "pramodya1994", "createdAt": "2020-09-15T15:54:55Z", "path": "misc/docerina/src/main/java/org/ballerinalang/docgen/generator/model/Type.java", "diffHunk": "@@ -216,12 +217,14 @@ public static Type fromTypeNode(BLangType type, String currentModule) {\n         // If anonymous type substitute the name\n         if (typeModel.name != null && typeModel.name.contains(\"$anonType$\")) {\n             // if anonymous empty record\n-            if (type.type instanceof BRecordType && ((BRecordType) type.type).fields.isEmpty()) {\n-                    typeModel.name = type.type.toString();\n-                    typeModel.generateUserDefinedTypeLink = false;\n+            // if anonymous empty record", "originalCommit": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5NDU5Mg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r489194592", "bodyText": "Added the changes", "author": "shehan360", "createdAt": "2020-09-16T06:32:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3OTEwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc4MTMzMQ==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r488781331", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                List<BClass> bClasses;\n          \n          \n            \n                priavte List<BClass> bClasses;", "author": "pramodya1994", "createdAt": "2020-09-15T15:58:06Z", "path": "tests/jballerina-unit-test/src/test/java/org/ballerinalang/test/documentation/ObjectFieldDefaultValueTest.java", "diffHunk": "@@ -41,12 +41,12 @@\n import java.util.Map;\n \n /**\n- * Test cases to check default value initialization for objects in docs.\n+ * Test cases to check default value initialization for bClasses in docs.\n  */\n @Test(groups = \"brokenOnClassChange\")\n public class ObjectFieldDefaultValueTest {\n     private Module testModule;\n-    List<Object> objects;\n+    List<BClass> bClasses;", "originalCommit": "8ddf93a264607cc9f2134c565aa623965bc33e5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5NDY2Mg==", "url": "https://github.com/ballerina-platform/ballerina-lang/pull/25820#discussion_r489194662", "bodyText": "Added the changes", "author": "shehan360", "createdAt": "2020-09-16T06:32:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc4MTMzMQ=="}], "type": "inlineReview"}, {"oid": "afa27d7930815775437f813447b62264d2210e2b", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/afa27d7930815775437f813447b62264d2210e2b", "message": "Change objects to class, add abstract objects", "committedDate": "2020-09-16T06:26:55Z", "type": "commit"}, {"oid": "55b7839c23c20cdd0037e0d87d9cad6b451456b9", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/55b7839c23c20cdd0037e0d87d9cad6b451456b9", "message": "Change objects to class, add abstract objects", "committedDate": "2020-09-16T08:31:48Z", "type": "commit"}, {"oid": "c9c3ef73f8ad82ad7d41b319cf014cdc532e8493", "url": "https://github.com/ballerina-platform/ballerina-lang/commit/c9c3ef73f8ad82ad7d41b319cf014cdc532e8493", "message": "Change objects to class, add abstract objects", "committedDate": "2020-09-16T08:45:05Z", "type": "commit"}]}