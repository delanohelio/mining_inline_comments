{"pr_number": 2422, "pr_title": "Target Android 11", "pr_createdAt": "2020-12-21T13:32:39Z", "pr_url": "https://github.com/dimagi/commcare-android/pull/2422", "timeline": [{"oid": "24e53fc99c494b944d9e99e3a7570864781a5ff9", "url": "https://github.com/dimagi/commcare-android/commit/24e53fc99c494b944d9e99e3a7570864781a5ff9", "message": "Update sdk version to 30", "committedDate": "2020-12-22T06:16:12Z", "type": "commit"}, {"oid": "8385d0219174d1cedb77fa3de8bb6d533071d45f", "url": "https://github.com/dimagi/commcare-android/commit/8385d0219174d1cedb77fa3de8bb6d533071d45f", "message": "Add queries element to manifest for TTS\n\nhttps://developer.android.com/about/versions/11/behavior-changes-11\\#tts-engines", "committedDate": "2020-12-22T06:16:12Z", "type": "commit"}, {"oid": "7f3fb76e188772cb1de9658dfa4e6013127b08eb", "url": "https://github.com/dimagi/commcare-android/commit/7f3fb76e188772cb1de9658dfa4e6013127b08eb", "message": "Fix build errors in LocationListener implementation\n\ne: /Users/dsi-admin/Documents/projects/Commcare/commcare-android/app/src/org/commcare/gis/DrawingBoundaryActivity.kt: (32, 1): Class 'DrawingBoundaryActivity' is not abstract and does not implement abstract member public abstract fun onLocationChanged(p0: Location): Unit defined in android.location.LocationListener", "committedDate": "2020-12-22T06:16:12Z", "type": "commit"}, {"oid": "0c8b636af6b0efa984c38e73674e55e6b16d511a", "url": "https://github.com/dimagi/commcare-android/commit/0c8b636af6b0efa984c38e73674e55e6b16d511a", "message": "Remove storage access to non-app-specific directory", "committedDate": "2020-12-22T06:16:12Z", "type": "commit"}, {"oid": "0c8b636af6b0efa984c38e73674e55e6b16d511a", "url": "https://github.com/dimagi/commcare-android/commit/0c8b636af6b0efa984c38e73674e55e6b16d511a", "message": "Remove storage access to non-app-specific directory", "committedDate": "2020-12-22T06:16:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODg0MDU0OA==", "url": "https://github.com/dimagi/commcare-android/pull/2422#discussion_r548840548", "bodyText": "the wordings of this doesn't make sense with the code to access outside scope storage deleted. Can we just say more on the lines of \"Invalid Intent definition, no extra with name 'KEY_FORM_RECORD_DESTINATION` present in the intent\"", "author": "shubham1g5", "createdAt": "2020-12-25T09:15:01Z", "path": "app/src/org/commcare/activities/components/FormEntryInstanceState.java", "diffHunk": "@@ -106,8 +103,7 @@ public void loadFromIntent(Intent intent) {\n         if (intent.hasExtra(KEY_FORM_RECORD_DESTINATION)) {\n             this.mFormRecordDestination = intent.getStringExtra(KEY_FORM_RECORD_DESTINATION);\n         } else {\n-            Logger.log(LogTypes.SOFT_ASSERT, \"Access outside scoped storage in loading current form.\");\n-            mFormRecordDestination = ODKStorage.FORM_RECORD_PATH;\n+            throw new RuntimeException(\"Access outside scoped storage in loading current form.\");", "originalCommit": "0c8b636af6b0efa984c38e73674e55e6b16d511a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODg0MDYyNQ==", "url": "https://github.com/dimagi/commcare-android/pull/2422#discussion_r548840625", "bodyText": "Same comment as above on wordings of exception.", "author": "shubham1g5", "createdAt": "2020-12-25T09:15:24Z", "path": "app/src/org/commcare/tasks/FormLoaderTask.java", "diffHunk": "@@ -235,24 +235,7 @@ private void setupFormMedia(String formMediaPath, File formXmlFile) {\n             ReferenceManager.instance().addSessionRootTranslator(\n                     new RootTranslator(\"jr://video/\", formMediaPath));\n         } else {\n-            // This should get moved to the Application Class\n-            if (ReferenceManager.instance().getFactories().length == 0) {\n-                // this is /sdcard/odk\n-                Logger.log(LogTypes.SOFT_ASSERT, \"Access outside scoped storage in form media setup.\");\n-                ReferenceManager.instance().addReferenceFactory(\n-                        new FileReferenceFactory(Environment.getExternalStorageDirectory() + \"/odk\"));\n-            }\n-\n-            // set paths to /sdcard/odk/forms/formfilename-media/\n-            String formFileName = formXmlFile.getName().substring(0, formXmlFile.getName().lastIndexOf(\".\"));\n-\n-            // Set jr://... to point to /sdcard/odk/forms/filename-media/\n-            ReferenceManager.instance().addSessionRootTranslator(\n-                    new RootTranslator(\"jr://images/\", \"jr://file/forms/\" + formFileName + \"-media/\"));\n-            ReferenceManager.instance().addSessionRootTranslator(\n-                    new RootTranslator(\"jr://audio/\", \"jr://file/forms/\" + formFileName + \"-media/\"));\n-            ReferenceManager.instance().addSessionRootTranslator(\n-                    new RootTranslator(\"jr://video/\", \"jr://file/forms/\" + formFileName + \"-media/\"));\n+            throw new RuntimeException(\"Access outside scoped storage in form media setup.\");", "originalCommit": "0c8b636af6b0efa984c38e73674e55e6b16d511a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5ffb6db2d2f29ed526d7807ac49fee1d2e87cf34", "url": "https://github.com/dimagi/commcare-android/commit/5ffb6db2d2f29ed526d7807ac49fee1d2e87cf34", "message": "Improve error messag", "committedDate": "2020-12-29T08:30:09Z", "type": "commit"}]}