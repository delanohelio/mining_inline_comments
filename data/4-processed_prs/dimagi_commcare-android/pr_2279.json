{"pr_number": 2279, "pr_title": "Hides manual quarantine behind developer option", "pr_createdAt": "2020-06-17T20:47:26Z", "pr_url": "https://github.com/dimagi/commcare-android/pull/2279", "timeline": [{"oid": "0d389a8defe833f92b31800c6605cdccd25caf27", "url": "https://github.com/dimagi/commcare-android/commit/0d389a8defe833f92b31800c6605cdccd25caf27", "message": "Hides manual quarantine behind dev option", "committedDate": "2020-06-17T18:52:05Z", "type": "commit"}, {"oid": "d5e64ef3406710dbff8306d3d63883547e074c19", "url": "https://github.com/dimagi/commcare-android/commit/d5e64ef3406710dbff8306d3d63883547e074c19", "message": "logs quarantine event to analytics", "committedDate": "2020-06-17T20:43:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTg0OTQ1MQ==", "url": "https://github.com/dimagi/commcare-android/pull/2279#discussion_r441849451", "bodyText": "Is there a reason this is \"spring loaded\" so to speak and only lets you quarantine a single form? That will get quite painful if there is some strange event that causes issues for a lot of forms in a row.", "author": "ctsims", "createdAt": "2020-06-17T21:39:21Z", "path": "app/src/org/commcare/activities/FormRecordListActivity.java", "diffHunk": "@@ -464,10 +464,13 @@ private void createFormRecordScanResultDialog(Pair<Boolean, String> result, Form\n                 result.second, resId, null);\n \n         if (FormRecordFilter.Pending.containsStatus(record.getStatus())) {\n-            dialog.setNegativeButton(Localization.get(\"app.workflow.forms.quarantine\"), (dialog1, which) -> {\n-                manuallyQuarantineRecord(record);\n-                dismissAlertDialog();\n-            });\n+            if (DeveloperPreferences.isManualFormQuarantineAllowed()) {\n+                dialog.setNegativeButton(Localization.get(\"app.workflow.forms.quarantine\"), (dialog1, which) -> {\n+                    manuallyQuarantineRecord(record);\n+                    dismissAlertDialog();\n+                    DeveloperPreferences.disableManualFormQuarantine();", "originalCommit": "d5e64ef3406710dbff8306d3d63883547e074c19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTg1MDAxOQ==", "url": "https://github.com/dimagi/commcare-android/pull/2279#discussion_r441850019", "bodyText": "I think this needs to be behind the user visible / controllable developer preferences, not the \"Special Dimagi\" level preferences.\nManual quarantining is a support tool that we need non-Dimagi personnel to be able to trigger to recover a clean state on their devices.", "author": "ctsims", "createdAt": "2020-06-17T21:40:37Z", "path": "app/src/org/commcare/preferences/DeveloperPreferences.java", "diffHunk": "@@ -56,6 +56,7 @@\n     private final static String ENFORCE_SECURE_ENDPOINT = \"cc-enforce-secure-endpoint\";\n     private final static String ALLOW_SPACE_IN_SELECT_CHOICES = \"cc-allow-space-in-select-choices\";\n     private final static String USE_EXPRESSION_CACHING_IN_FORMS = \"use-expression-caching-in-forms\";\n+    private final static String ALLOW_MANUAL_FORM_QUARANTINE = \"cc-allow-manual-form-quarantine\";", "originalCommit": "d5e64ef3406710dbff8306d3d63883547e074c19", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5a3d98fd3a901d4c414fd0ba419e3a66a8576ecc", "url": "https://github.com/dimagi/commcare-android/commit/5a3d98fd3a901d4c414fd0ba419e3a66a8576ecc", "message": "moved the pref to contol manual form quarantine to advanced settings", "committedDate": "2020-07-08T19:43:27Z", "type": "commit"}, {"oid": "9301a6b4f15dfbbfa1498c65d65a66a326e6fdc1", "url": "https://github.com/dimagi/commcare-android/commit/9301a6b4f15dfbbfa1498c65d65a66a326e6fdc1", "message": "Merge branch 'master' into hideQuarantineBehindDevOptions", "committedDate": "2020-07-08T19:57:41Z", "type": "commit"}]}