{"pr_number": 8856, "pr_title": "Show confirmation dialog on role delete with info about assigned users", "pr_createdAt": "2020-08-24T13:07:53Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/8856", "timeline": [{"oid": "59acea1d858768bd8d8aa4231be98cb7f2a4c818", "url": "https://github.com/Graylog2/graylog2-server/commit/59acea1d858768bd8d8aa4231be98cb7f2a4c818", "message": "Check if role is assigned to users on role delete", "committedDate": "2020-08-24T12:57:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY3NzM5Nw==", "url": "https://github.com/Graylog2/graylog2-server/pull/8856#discussion_r475677397", "bodyText": "Instead of asking for all users just to check if there is more then one, perhaps we should ask for one user? Because we will get a 'total' attribute in the pagination which tells us how many there are.", "author": "kmerz", "createdAt": "2020-08-24T14:58:42Z", "path": "graylog2-web-interface/src/components/roles/RolesOverview/ActionsCell.jsx", "diffHunk": "@@ -21,29 +21,29 @@ const ActtionsWrapper = styled.div`\n   justify-content: flex-end;\n `;\n \n-const ActionsCell = ({ roleId, roleName, readOnly }: Props) => {\n-  const _deleteRole = () => {\n+const _deleteRole = (roleId: $PropertyType<Role, 'id'>, roleName: $PropertyType<Role, 'name'>, setDeleting: boolean => void) => {\n+  let confirmMessage = `Do you really want to delete role \"${roleName}?\"`;\n+  const getUnlimited = [1, 0, ''];\n+  setDeleting(true);\n+\n+  AuthzRolesActions.loadUsersForRole(roleId, ...getUnlimited).then((paginatedUsers) => {", "originalCommit": "59acea1d858768bd8d8aa4231be98cb7f2a4c818", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTcyMjgyOQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/8856#discussion_r475722829", "bodyText": "That totally makes sense, thanks!", "author": "linuspahl", "createdAt": "2020-08-24T16:02:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY3NzM5Nw=="}], "type": "inlineReview"}, {"oid": "61f985d71a85e0b665860ca97888d90432416259", "url": "https://github.com/Graylog2/graylog2-server/commit/61f985d71a85e0b665860ca97888d90432416259", "message": "Improve role delete confirmation message and improve data fetching", "committedDate": "2020-08-24T16:03:07Z", "type": "commit"}, {"oid": "792f68bd86a455e6db3f513cf1083eb9413ce81f", "url": "https://github.com/Graylog2/graylog2-server/commit/792f68bd86a455e6db3f513cf1083eb9413ce81f", "message": "Rename attribute", "committedDate": "2020-08-25T11:49:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMyMjMwOA==", "url": "https://github.com/Graylog2/graylog2-server/pull/8856#discussion_r476322308", "bodyText": "paginationForFirstRole", "author": "kmerz", "createdAt": "2020-08-25T09:47:10Z", "path": "graylog2-web-interface/src/components/roles/RolesOverview/ActionsCell.jsx", "diffHunk": "@@ -21,29 +21,29 @@ const ActtionsWrapper = styled.div`\n   justify-content: flex-end;\n `;\n \n-const ActionsCell = ({ roleId, roleName, readOnly }: Props) => {\n-  const _deleteRole = () => {\n+const _deleteRole = (roleId: $PropertyType<Role, 'id'>, roleName: $PropertyType<Role, 'name'>, setDeleting: boolean => void) => {\n+  let confirmMessage = `Do you really want to delete role \"${roleName}?\"`;\n+  const pagination = [1, 1, ''];", "originalCommit": "61f985d71a85e0b665860ca97888d90432416259", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}