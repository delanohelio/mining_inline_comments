{"pr_number": 9721, "pr_title": "Improving `connect` type inference regarding component `propTypes` and `defaultProps`.", "pr_createdAt": "2020-12-08T11:15:39Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/9721", "timeline": [{"oid": "067a63d329d14548a770d279f7c1c821e511c60c", "url": "https://github.com/Graylog2/graylog2-server/commit/067a63d329d14548a770d279f7c1c821e511c60c", "message": "Considering defaultProps and propTypes in connect type inference.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "47b600fc88efa1c6f7d1bfeacfbe86c1bc06778c", "url": "https://github.com/Graylog2/graylog2-server/commit/47b600fc88efa1c6f7d1bfeacfbe86c1bc06778c", "message": "Remove `Widget` propTypes which are not compatible with prop type definition.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "9c57607f9578e625324773236725f7c81bfac4f5", "url": "https://github.com/Graylog2/graylog2-server/commit/9c57607f9578e625324773236725f7c81bfac4f5", "message": "Remove `URLWhiteListFormModal` propTypes which are not compatible with prop type definition.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "c89a37990f2df49b84b852b9a8179aeeafcc3568", "url": "https://github.com/Graylog2/graylog2-server/commit/c89a37990f2df49b84b852b9a8179aeeafcc3568", "message": "Remove `StreamsRuleForm` propTypes which are not compatible with prop type definition.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "5941eedad8ba07e8fbce1d039403eef705342db3", "url": "https://github.com/Graylog2/graylog2-server/commit/5941eedad8ba07e8fbce1d039403eef705342db3", "message": "Remove not needed type definition in `connect`.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "d209c21215059022e046792bc14f9707305251e7", "url": "https://github.com/Graylog2/graylog2-server/commit/d209c21215059022e046792bc14f9707305251e7", "message": "Add tests for `connect` typing.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "13951a8d7e783ca2f14309a53bfb95feaf572196", "url": "https://github.com/Graylog2/graylog2-server/commit/13951a8d7e783ca2f14309a53bfb95feaf572196", "message": "Fix `StreamRuleForm` type definitions.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "dbf8900677fe10cb8b6001a8b91a6aaba113111d", "url": "https://github.com/Graylog2/graylog2-server/commit/dbf8900677fe10cb8b6001a8b91a6aaba113111d", "message": "Define type for `DashboardSearchBar` config prop.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "c93bb29e2cd80f3e345cfa0e8385c58379638f54", "url": "https://github.com/Graylog2/graylog2-server/commit/c93bb29e2cd80f3e345cfa0e8385c58379638f54", "message": "Remove not needed code in `SavedSearchControls`.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "26fc1d51d1b105598a792714df451961f72958f4", "url": "https://github.com/Graylog2/graylog2-server/commit/26fc1d51d1b105598a792714df451961f72958f4", "message": "Update `SavedSearchList` prop types.", "committedDate": "2020-12-08T09:21:07Z", "type": "commit"}, {"oid": "e2d004e87458f3035466c999c4d622193b133786", "url": "https://github.com/Graylog2/graylog2-server/commit/e2d004e87458f3035466c999c4d622193b133786", "message": "Removing empty line", "committedDate": "2020-12-08T10:26:43Z", "type": "commit"}, {"oid": "32d98aa580a836ab2ec737aa8a056fcdb96037c5", "url": "https://github.com/Graylog2/graylog2-server/commit/32d98aa580a836ab2ec737aa8a056fcdb96037c5", "message": "Implementing `instanceOf` for widget propType in `Widget`.", "committedDate": "2020-12-08T10:34:32Z", "type": "commit"}, {"oid": "11aa69f9eb3c6aa7119a480743d2ce42320cd495", "url": "https://github.com/Graylog2/graylog2-server/commit/11aa69f9eb3c6aa7119a480743d2ce42320cd495", "message": "Removing not needed example component in `connect` test.", "committedDate": "2020-12-08T10:37:56Z", "type": "commit"}, {"oid": "2888bb6242fbe253233e603daa34ca769769b333", "url": "https://github.com/Graylog2/graylog2-server/commit/2888bb6242fbe253233e603daa34ca769769b333", "message": "Adding test for defaultProps typing for `connect`.", "committedDate": "2020-12-08T11:02:38Z", "type": "commit"}, {"oid": "38c6d37c398aee8ca24c5279167df9829e19b325", "url": "https://github.com/Graylog2/graylog2-server/commit/38c6d37c398aee8ca24c5279167df9829e19b325", "message": "Removing `instanceOf` in PropTypes of `Widget` because it is not working as expected and resulted in failing tests.", "committedDate": "2020-12-08T11:14:02Z", "type": "commit"}, {"oid": "2dafbba436ccf4f4e959a794fa78c29c9b8d7178", "url": "https://github.com/Graylog2/graylog2-server/commit/2dafbba436ccf4f4e959a794fa78c29c9b8d7178", "message": "Fixing `connect` tests.", "committedDate": "2020-12-08T11:15:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI2NTU5Mw==", "url": "https://github.com/Graylog2/graylog2-server/pull/9721#discussion_r539265593", "bodyText": "We can do this instead:\n    urlType: PropTypes.oneOf(['regex', 'literal', ''] as const),", "author": "dennisoelkers", "createdAt": "2020-12-09T12:28:29Z", "path": "graylog2-web-interface/src/components/common/URLWhiteListFormModal.tsx", "diffHunk": "@@ -55,15 +55,14 @@ class URLWhiteListFormModal extends React.Component<Props, State> {\n     newUrlEntry: PropTypes.string,\n     onUpdate: PropTypes.func,\n     configuration: PropTypes.object,\n-    currentUser: PropTypes.object.isRequired,\n-    urlType: PropTypes.string,", "originalCommit": "2dafbba436ccf4f4e959a794fa78c29c9b8d7178", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI2NTcxOA==", "url": "https://github.com/Graylog2/graylog2-server/pull/9721#discussion_r539265718", "bodyText": "We can do this instead:\n    currentUser: PropTypes.exact({\n      permissions: PropTypes.arrayOf(PropTypes.string),\n    }).isRequired,", "author": "dennisoelkers", "createdAt": "2020-12-09T12:28:42Z", "path": "graylog2-web-interface/src/components/common/URLWhiteListFormModal.tsx", "diffHunk": "@@ -55,15 +55,14 @@ class URLWhiteListFormModal extends React.Component<Props, State> {\n     newUrlEntry: PropTypes.string,\n     onUpdate: PropTypes.func,\n     configuration: PropTypes.object,\n-    currentUser: PropTypes.object.isRequired,", "originalCommit": "2dafbba436ccf4f4e959a794fa78c29c9b8d7178", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI2NTk0Mg==", "url": "https://github.com/Graylog2/graylog2-server/pull/9721#discussion_r539265942", "bodyText": "If we use the suggestion above, we can remove this.", "author": "dennisoelkers", "createdAt": "2020-12-09T12:29:03Z", "path": "graylog2-web-interface/src/components/common/URLWhiteListFormModal.tsx", "diffHunk": "@@ -55,15 +55,14 @@ class URLWhiteListFormModal extends React.Component<Props, State> {\n     newUrlEntry: PropTypes.string,\n     onUpdate: PropTypes.func,\n     configuration: PropTypes.object,\n-    currentUser: PropTypes.object.isRequired,\n-    urlType: PropTypes.string,\n   };\n \n   static defaultProps = {\n     newUrlEntry: '',\n     onUpdate: () => { return undefined; },\n     configuration: {},\n-    urlType: '',\n+    // eslint-disable-next-line react/default-props-match-prop-types", "originalCommit": "2dafbba436ccf4f4e959a794fa78c29c9b8d7178", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI3MDM2OA==", "url": "https://github.com/Graylog2/graylog2-server/pull/9721#discussion_r539270368", "bodyText": "I think we might be able to use CustomPropTypes.CurrentView` here.", "author": "dennisoelkers", "createdAt": "2020-12-09T12:35:53Z", "path": "graylog2-web-interface/src/views/components/widgets/Widget.tsx", "diffHunk": "@@ -129,14 +129,6 @@ const _editComponentForType = (type) => {\n class Widget extends React.Component<Props, State> {\n   static propTypes = {\n     id: PropTypes.string.isRequired,\n-    view: PropTypes.object.isRequired,", "originalCommit": "2dafbba436ccf4f4e959a794fa78c29c9b8d7178", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI3MDY3Ng==", "url": "https://github.com/Graylog2/graylog2-server/pull/9721#discussion_r539270676", "bodyText": "Can we use PropTypes.instanceOf(WidgetModel) here?", "author": "dennisoelkers", "createdAt": "2020-12-09T12:36:24Z", "path": "graylog2-web-interface/src/views/components/widgets/Widget.tsx", "diffHunk": "@@ -129,14 +129,6 @@ const _editComponentForType = (type) => {\n class Widget extends React.Component<Props, State> {\n   static propTypes = {\n     id: PropTypes.string.isRequired,\n-    view: PropTypes.object.isRequired,\n-    widget: PropTypes.shape({", "originalCommit": "2dafbba436ccf4f4e959a794fa78c29c9b8d7178", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTI3MDkxOQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/9721#discussion_r539270919", "bodyText": "Can we use PropTypes.instanceOf(WidgetPosition) here?", "author": "dennisoelkers", "createdAt": "2020-12-09T12:36:44Z", "path": "graylog2-web-interface/src/views/components/widgets/Widget.tsx", "diffHunk": "@@ -146,7 +138,6 @@ class Widget extends React.Component<Props, State> {\n     onSizeChange: PropTypes.func.isRequired,\n     onPositionsChange: PropTypes.func.isRequired,\n     title: PropTypes.string.isRequired,\n-    position: PropTypes.object.isRequired,", "originalCommit": "2dafbba436ccf4f4e959a794fa78c29c9b8d7178", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4edcf73525201958397f8f232427b38567f81b82", "url": "https://github.com/Graylog2/graylog2-server/commit/4edcf73525201958397f8f232427b38567f81b82", "message": "Improving `URLWhiteListFormModal` prop-types.", "committedDate": "2020-12-09T15:26:12Z", "type": "commit"}, {"oid": "5123f547162103f278fd1e5568933f5025f3ec52", "url": "https://github.com/Graylog2/graylog2-server/commit/5123f547162103f278fd1e5568933f5025f3ec52", "message": "Improving `Widget` prop-types and updating `Widget.test`.", "committedDate": "2020-12-09T16:01:23Z", "type": "commit"}]}