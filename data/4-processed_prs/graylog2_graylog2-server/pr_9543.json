{"pr_number": 9543, "pr_title": "DateRange Absolute Limits & Errors", "pr_createdAt": "2020-11-18T15:28:37Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/9543", "timeline": [{"oid": "6ef47225b481ec801a6e9178f3596a4e09e2affc", "url": "https://github.com/Graylog2/graylog2-server/commit/6ef47225b481ec801a6e9178f3596a4e09e2affc", "message": "DateTimePicker Show Timezone (#9381)\n\n* Some Cleanup\r\n\r\n* Migrating original range options to Popover\r\n\r\n* Converting existing DateTimePicker to Popover\r\n\r\n* Migrating original range options to Popover\r\n\r\n* Updating some tests to get more passing\r\n\r\n* reverting & commenting\r\n\r\n* Updating some tests to get more passing\r\n\r\n* reverting & commenting\r\n\r\n* Show current Timerange in TimeRangeDropdown\r\n\r\n* Bold\r\n\r\n* reverting changes\r\n\r\n* lint", "committedDate": "2020-11-19T13:06:21Z", "type": "commit"}, {"oid": "8daa28c098816ece9045c7265dc07dd3453b154e", "url": "https://github.com/Graylog2/graylog2-server/commit/8daa28c098816ece9045c7265dc07dd3453b154e", "message": "flow cleanup", "committedDate": "2020-11-19T16:56:00Z", "type": "forcePushed"}, {"oid": "5b0fe3cb66b37e8e870d67df649da9d1b6a4c234", "url": "https://github.com/Graylog2/graylog2-server/commit/5b0fe3cb66b37e8e870d67df649da9d1b6a4c234", "message": "Some Cleanup", "committedDate": "2020-11-19T17:52:19Z", "type": "commit"}, {"oid": "881662c01ac44a663fcf8ff7d2bd39683cdd71d0", "url": "https://github.com/Graylog2/graylog2-server/commit/881662c01ac44a663fcf8ff7d2bd39683cdd71d0", "message": "Migrating original range options to Popover", "committedDate": "2020-11-19T17:52:19Z", "type": "commit"}, {"oid": "58acb074f6c03b2d42201094b4d1ae4ca9ae0cee", "url": "https://github.com/Graylog2/graylog2-server/commit/58acb074f6c03b2d42201094b4d1ae4ca9ae0cee", "message": "Converting existing DateTimePicker to Popover", "committedDate": "2020-11-19T17:52:19Z", "type": "commit"}, {"oid": "5963ee265c29ad6f27d08579a912ea4d0dac6791", "url": "https://github.com/Graylog2/graylog2-server/commit/5963ee265c29ad6f27d08579a912ea4d0dac6791", "message": "Migrating original range options to Popover", "committedDate": "2020-11-19T17:52:19Z", "type": "commit"}, {"oid": "78db61131e7610cf417108f373c696f7d94424cb", "url": "https://github.com/Graylog2/graylog2-server/commit/78db61131e7610cf417108f373c696f7d94424cb", "message": "Updating some tests to get more passing", "committedDate": "2020-11-19T17:52:19Z", "type": "commit"}, {"oid": "a8bb6458a2099ff0ac3387c2cd22e0b68ba7c3ec", "url": "https://github.com/Graylog2/graylog2-server/commit/a8bb6458a2099ff0ac3387c2cd22e0b68ba7c3ec", "message": "reverting & commenting", "committedDate": "2020-11-19T17:52:19Z", "type": "commit"}, {"oid": "47862e6f565fc3e62e4e0207681c0650f0dfdc6d", "url": "https://github.com/Graylog2/graylog2-server/commit/47862e6f565fc3e62e4e0207681c0650f0dfdc6d", "message": "Updating some tests to get more passing", "committedDate": "2020-11-19T17:52:19Z", "type": "commit"}, {"oid": "47160d524de33caeecead9f8d0cb4b76074fd288", "url": "https://github.com/Graylog2/graylog2-server/commit/47160d524de33caeecead9f8d0cb4b76074fd288", "message": "reverting & commenting", "committedDate": "2020-11-19T17:52:19Z", "type": "commit"}, {"oid": "cf6098d130b77d3b575cd428980f66ed4e5f4b5d", "url": "https://github.com/Graylog2/graylog2-server/commit/cf6098d130b77d3b575cd428980f66ed4e5f4b5d", "message": "reverting changes", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "2e5d587457d235043df445ed8af762ab432bb813", "url": "https://github.com/Graylog2/graylog2-server/commit/2e5d587457d235043df445ed8af762ab432bb813", "message": "lint", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "5cb57e269301970551a73794b930246c12c249ca", "url": "https://github.com/Graylog2/graylog2-server/commit/5cb57e269301970551a73794b930246c12c249ca", "message": "Some Cleanup", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "0098ce57b1cbf3997afe4f3a93b3b30680b4c9f4", "url": "https://github.com/Graylog2/graylog2-server/commit/0098ce57b1cbf3997afe4f3a93b3b30680b4c9f4", "message": "flowtype formik reset", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "d3e3423b5a5ed5d4cdfaa54066dcb111c9005b37", "url": "https://github.com/Graylog2/graylog2-server/commit/d3e3423b5a5ed5d4cdfaa54066dcb111c9005b37", "message": "Relative Timerange styles", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "b6d91b74d3e2a9e018bcdc4d2a7788594e3b9a8c", "url": "https://github.com/Graylog2/graylog2-server/commit/b6d91b74d3e2a9e018bcdc4d2a7788594e3b9a8c", "message": "snaps", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "12cee9475184cdbf938bff97e081ac273b723575", "url": "https://github.com/Graylog2/graylog2-server/commit/12cee9475184cdbf938bff97e081ac273b723575", "message": "started rewrite of Relative form fields", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "155c568e67f3749c957ce720ad7b92bb9939c721", "url": "https://github.com/Graylog2/graylog2-server/commit/155c568e67f3749c957ce720ad7b92bb9939c721", "message": "Error checking, message, and disable Apply", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "050b3e57e7fc87f52bac5be9cceb6e7c8d018861", "url": "https://github.com/Graylog2/graylog2-server/commit/050b3e57e7fc87f52bac5be9cceb6e7c8d018861", "message": "wrong select value", "committedDate": "2020-11-19T17:52:53Z", "type": "commit"}, {"oid": "2f73aee2da5bf4066b51fee898aa68d7ee039670", "url": "https://github.com/Graylog2/graylog2-server/commit/2f73aee2da5bf4066b51fee898aa68d7ee039670", "message": "tests and snaps", "committedDate": "2020-11-19T17:52:54Z", "type": "commit"}, {"oid": "30aa634994960aa68f0b76f754e377c755980980", "url": "https://github.com/Graylog2/graylog2-server/commit/30aa634994960aa68f0b76f754e377c755980980", "message": "most of the flow errors except AbsoluteRange", "committedDate": "2020-11-19T17:52:54Z", "type": "commit"}, {"oid": "c37d6d15dab3677fd2209368b55a1b494caf63b1", "url": "https://github.com/Graylog2/graylog2-server/commit/c37d6d15dab3677fd2209368b55a1b494caf63b1", "message": "lint", "committedDate": "2020-11-19T17:52:54Z", "type": "commit"}, {"oid": "9962f1cce1da69bd2199c51a13c7d07410c2a38c", "url": "https://github.com/Graylog2/graylog2-server/commit/9962f1cce1da69bd2199c51a13c7d07410c2a38c", "message": "tests", "committedDate": "2020-11-19T18:02:19Z", "type": "forcePushed"}, {"oid": "2a095af4568d1a93ef3bf6ba191181e53c00679d", "url": "https://github.com/Graylog2/graylog2-server/commit/2a095af4568d1a93ef3bf6ba191181e53c00679d", "message": "oh, snap!", "committedDate": "2020-11-19T20:21:35Z", "type": "commit"}, {"oid": "13ca4f8a6d13d95e3cac81a1000d5b9879095422", "url": "https://github.com/Graylog2/graylog2-server/commit/13ca4f8a6d13d95e3cac81a1000d5b9879095422", "message": "Absolute limits in calendar", "committedDate": "2020-11-19T20:21:58Z", "type": "commit"}, {"oid": "6f1c773ef6817ee9c8b204fafd9f7bdc98c53c63", "url": "https://github.com/Graylog2/graylog2-server/commit/6f1c773ef6817ee9c8b204fafd9f7bdc98c53c63", "message": "Absolute limits in calendar", "committedDate": "2020-11-19T20:21:58Z", "type": "commit"}, {"oid": "536b6059e8f497db0a6ade21386e2f159b64dd42", "url": "https://github.com/Graylog2/graylog2-server/commit/536b6059e8f497db0a6ade21386e2f159b64dd42", "message": "Cleanup and disable Absolute Apply when dates arent correct", "committedDate": "2020-11-19T20:21:58Z", "type": "commit"}, {"oid": "2d461410322a8037ee1bb3178c14b38ececc1851", "url": "https://github.com/Graylog2/graylog2-server/commit/2d461410322a8037ee1bb3178c14b38ececc1851", "message": "update error style and time check", "committedDate": "2020-11-19T20:21:58Z", "type": "commit"}, {"oid": "4c7a4a5d972896b855ab87c1593a2f069379e777", "url": "https://github.com/Graylog2/graylog2-server/commit/4c7a4a5d972896b855ab87c1593a2f069379e777", "message": "flow cleanup", "committedDate": "2020-11-19T20:21:58Z", "type": "commit"}, {"oid": "b7ea565302d74d29c092d210b41222363f37d400", "url": "https://github.com/Graylog2/graylog2-server/commit/b7ea565302d74d29c092d210b41222363f37d400", "message": "tests", "committedDate": "2020-11-19T20:21:58Z", "type": "commit"}, {"oid": "e10b3fc70ff7f84cff96e0b0517ddea7c3d8103e", "url": "https://github.com/Graylog2/graylog2-server/commit/e10b3fc70ff7f84cff96e0b0517ddea7c3d8103e", "message": "oh, snap!", "committedDate": "2020-11-19T20:23:40Z", "type": "commit"}, {"oid": "e10b3fc70ff7f84cff96e0b0517ddea7c3d8103e", "url": "https://github.com/Graylog2/graylog2-server/commit/e10b3fc70ff7f84cff96e0b0517ddea7c3d8103e", "message": "oh, snap!", "committedDate": "2020-11-19T20:23:40Z", "type": "forcePushed"}, {"oid": "ea574cc9f1582e9c7db3d377de0453bd0a8aff06", "url": "https://github.com/Graylog2/graylog2-server/commit/ea574cc9f1582e9c7db3d377de0453bd0a8aff06", "message": "fix setstate error", "committedDate": "2020-11-19T20:46:51Z", "type": "commit"}, {"oid": "1f4669a6ff1d08de39066df0fba6ec2c0742f7a7", "url": "https://github.com/Graylog2/graylog2-server/commit/1f4669a6ff1d08de39066df0fba6ec2c0742f7a7", "message": "Merge branch 'feature/DateTimeRange' into dtp_absolute_limit_error\n\n# Conflicts:\n#\tgraylog2-web-interface/src/views/components/searchbar/DateInputWithPicker.jsx\n#\tgraylog2-web-interface/src/views/components/searchbar/DateInputWithPicker.test.jsx\n#\tgraylog2-web-interface/src/views/components/searchbar/__snapshots__/SearchBarForm.test.jsx.snap\n#\tgraylog2-web-interface/src/views/components/searchbar/date-time-picker/AbsoluteRangeField.jsx\n#\tgraylog2-web-interface/src/views/components/searchbar/date-time-picker/TimeRangeDropdown.jsx", "committedDate": "2020-11-24T23:39:53Z", "type": "commit"}, {"oid": "4eef66d5593a8f7b233219d25b738fef03aa83fb", "url": "https://github.com/Graylog2/graylog2-server/commit/4eef66d5593a8f7b233219d25b738fef03aa83fb", "message": "snapshot update", "committedDate": "2020-12-03T15:16:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU0ODE4Nw==", "url": "https://github.com/Graylog2/graylog2-server/pull/9543#discussion_r537548187", "bodyText": "Why did you choose this kind of validation over the Formik validation?", "author": "linuspahl", "createdAt": "2020-12-07T14:27:18Z", "path": "graylog2-web-interface/src/views/components/searchbar/date-time-picker/AbsoluteRangeField.jsx", "diffHunk": "@@ -153,22 +162,36 @@ const fieldUpdate = (value) => {\n   };\n };\n \n-const AbsoluteRangeField = ({ disabled, originalTimeRange, from }: Props) => {\n+const _isDayAfter = ({ from, to }) => {\n+  if (new Date(from) > new Date(to)) {\n+    return 'From date can not be before the Until date.';\n+  }\n+\n+  return '';\n+};\n+\n+const AbsoluteRangeField = ({ disabled, limitDuration, from, currentTimerange, setDisableApply }: Props) => {\n   const range = from ? 'from' : 'to';\n   const hourIcon = useRef(TIME_ICON_MID);\n+  const [timeRangeError, setTimeRangeError] = useState('');\n+\n+  useEffect(() => {\n+    setTimeRangeError(_isDayAfter(currentTimerange));\n+  }, [currentTimerange]);", "originalCommit": "4eef66d5593a8f7b233219d25b738fef03aa83fb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a3d5b38a9dedb5c93e5cd39c41e8145af119bf34", "url": "https://github.com/Graylog2/graylog2-server/commit/a3d5b38a9dedb5c93e5cd39c41e8145af119bf34", "message": "Update disabledApply, fix Relative All Time, update error messages for Absolute timerange", "committedDate": "2020-12-07T20:20:46Z", "type": "commit"}, {"oid": "3267e3d3a99c6ab3a3016e90c23d8a0a65676af2", "url": "https://github.com/Graylog2/graylog2-server/commit/3267e3d3a99c6ab3a3016e90c23d8a0a65676af2", "message": "flow", "committedDate": "2020-12-07T20:40:47Z", "type": "commit"}, {"oid": "451cec78bec26d35194be4a5a0986d8aa883b07b", "url": "https://github.com/Graylog2/graylog2-server/commit/451cec78bec26d35194be4a5a0986d8aa883b07b", "message": "jest", "committedDate": "2020-12-07T20:46:10Z", "type": "commit"}, {"oid": "285688c698c41bc075e8c077699ae1facaaa9d23", "url": "https://github.com/Graylog2/graylog2-server/commit/285688c698c41bc075e8c077699ae1facaaa9d23", "message": "lint", "committedDate": "2020-12-07T21:07:56Z", "type": "commit"}]}