{"pr_number": 9705, "pr_title": "Typing `styled-components`", "pr_createdAt": "2020-12-04T13:06:28Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/9705", "timeline": [{"oid": "55cba83c44632f6cc3a2c9a77b3fa77619324780", "url": "https://github.com/Graylog2/graylog2-server/commit/55cba83c44632f6cc3a2c9a77b3fa77619324780", "message": "Reverting `yarn.lock` changes.", "committedDate": "2020-12-04T13:21:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzUzNjkyMw==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r537536923", "bodyText": "Maybe we can use Props or Pick<Props, 'height'> in here?", "author": "dennisoelkers", "createdAt": "2020-12-07T14:12:46Z", "path": "graylog2-web-interface/src/views/components/horizontalspacer/HorizontalSpacer.tsx", "diffHunk": "@@ -32,7 +31,7 @@ type Props = {\n   className?: string,\n };\n \n-const Spacer: StyledComponent<Props, {}, HTMLDivElement> = styled.div`\n+const Spacer = styled.div<{ height: number }>`", "originalCommit": "0446caebdef1ebcd869edfda0dc4a64c3cfa3339", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU4MzI1Ng==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r537583256", "bodyText": "This is breaking the current behavior of the series select, which allows the user to select function and field without having to reopen the select.", "author": "dennisoelkers", "createdAt": "2020-12-07T15:11:49Z", "path": "graylog2-web-interface/src/views/components/aggregationbuilder/SeriesSelect.tsx", "diffHunk": "@@ -168,10 +164,8 @@ class SeriesSelect extends React.Component<Props, State> {\n               options={options}\n               value={series.map(_wrapOption)}\n               components={_components}\n-              onClose={this._onClose}\n-              closeMenuOnSelect={false}\n+              closeMenuOnSelect", "originalCommit": "0446caebdef1ebcd869edfda0dc4a64c3cfa3339", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODEzNTcxMg==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r538135712", "bodyText": "Good catch, that change slipped in.", "author": "linuspahl", "createdAt": "2020-12-08T08:31:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU4MzI1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU4Mzc4OA==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r537583788", "bodyText": "Removing this is breaking the behavior which resets the state to selecting a function when closing the select.", "author": "dennisoelkers", "createdAt": "2020-12-07T15:12:27Z", "path": "graylog2-web-interface/src/views/components/aggregationbuilder/SeriesSelect.tsx", "diffHunk": "@@ -130,10 +130,6 @@ class SeriesSelect extends React.Component<Props, State> {\n     this.setState({ options: suggester.defaults });\n   };\n \n-  _onClose = () => {", "originalCommit": "0446caebdef1ebcd869edfda0dc4a64c3cfa3339", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODE0MDU1NA==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r538140554", "bodyText": "I removed this part because the react-select component does not have a prop onClose. But I understand the benefit and will reimplement this function and use the prop onMenuClose instead.", "author": "linuspahl", "createdAt": "2020-12-08T08:38:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU4Mzc4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU4NDAzNA==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r537584034", "bodyText": "Is there a different way to solve this?", "author": "dennisoelkers", "createdAt": "2020-12-07T15:12:47Z", "path": "graylog2-web-interface/src/components/permissions/GranteesSelector.tsx", "diffHunk": "@@ -129,6 +128,7 @@ const GranteesSelector = ({ availableGrantees, availableCapabilities, className,\n                                     onChange={(granteeId) => onChange({ target: { value: granteeId, name } })}\n                                     optionRenderer={_renderGranteesSelectOption}\n                                     options={granteesOptions}\n+                                    // @ts-ignore", "originalCommit": "0446caebdef1ebcd869edfda0dc4a64c3cfa3339", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODE0NzMwOQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r538147309", "bodyText": "With #9713 I changed this part and the @ts-ignore should no longer be necessary. I will remove it one of these pull requests.", "author": "linuspahl", "createdAt": "2020-12-08T08:49:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzU4NDAzNA=="}], "type": "inlineReview"}, {"oid": "040cb5e21cd9cc48a325feb79ce7428d0655cacc", "url": "https://github.com/Graylog2/graylog2-server/commit/040cb5e21cd9cc48a325feb79ce7428d0655cacc", "message": "Fixing merge conflict in `EntityShareModal`.", "committedDate": "2020-12-08T13:29:29Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODQxNjQzMQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r538416431", "bodyText": "Is this removed on purpose?", "author": "dennisoelkers", "createdAt": "2020-12-08T14:12:58Z", "path": "graylog2-web-interface/src/views/components/aggregationbuilder/SeriesSelect.tsx", "diffHunk": "@@ -168,10 +168,9 @@ class SeriesSelect extends React.Component<Props, State> {\n               options={options}\n               value={series.map(_wrapOption)}\n               components={_components}\n-              onClose={this._onClose}\n               closeMenuOnSelect={false}\n+              onMenuClose={this._onClose}\n               menuShouldScrollIntoView\n-              tabSelectsValue", "originalCommit": "040cb5e21cd9cc48a325feb79ce7428d0655cacc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODQzNjA4Ng==", "url": "https://github.com/Graylog2/graylog2-server/pull/9705#discussion_r538436086", "bodyText": "I removed this prop, because we always set it to false in the views Select. I tested this case with tabSelectsValue and prefer to keep it disabled.", "author": "linuspahl", "createdAt": "2020-12-08T14:31:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODQxNjQzMQ=="}], "type": "inlineReview"}, {"oid": "4d7c2f2bfff11f985d9b7d28111bafd3e3b5967d", "url": "https://github.com/Graylog2/graylog2-server/commit/4d7c2f2bfff11f985d9b7d28111bafd3e3b5967d", "message": "Fixing linter warnings.", "committedDate": "2020-12-09T09:38:12Z", "type": "forcePushed"}, {"oid": "7430f0f8654e22b946ebfb10cc19287949a5ca7f", "url": "https://github.com/Graylog2/graylog2-server/commit/7430f0f8654e22b946ebfb10cc19287949a5ca7f", "message": "Adding `@types/styled-components` as dependecy of `graylog-web-plugin`.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "09a47cd5add497680b2c86f0addb26cc61d0d1a8", "url": "https://github.com/Graylog2/graylog2-server/commit/09a47cd5add497680b2c86f0addb26cc61d0d1a8", "message": "Create declarations for styled-components theme", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "4f03be9cef060ad8f9a3ce30905244074691d8d8", "url": "https://github.com/Graylog2/graylog2-server/commit/4f03be9cef060ad8f9a3ce30905244074691d8d8", "message": "Remove no longer needed usage of StyledComponent type", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "1debaa7f6ec5ea7e1b7fb3deef31c594120eafb0", "url": "https://github.com/Graylog2/graylog2-server/commit/1debaa7f6ec5ea7e1b7fb3deef31c594120eafb0", "message": "Remove no longer needed ThemeInterface type", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "50d95b64d9a6f4049ce97c7b3c9e4353976c99ad", "url": "https://github.com/Graylog2/graylog2-server/commit/50d95b64d9a6f4049ce97c7b3c9e4353976c99ad", "message": "Type theme as DefaultTheme where necessary", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "4ed0daa3e4db0c9d177a397cc2e81841e6b4e479", "url": "https://github.com/Graylog2/graylog2-server/commit/4ed0daa3e4db0c9d177a397cc2e81841e6b4e479", "message": "Add missing import", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "d5cff374ceae954010d808566d00683055cc53f6", "url": "https://github.com/Graylog2/graylog2-server/commit/d5cff374ceae954010d808566d00683055cc53f6", "message": "Implementing `useTheme` hook instead of `withTheme` in common `Select`.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "a5a2cea931991215366285295ce49449c8e13a28", "url": "https://github.com/Graylog2/graylog2-server/commit/a5a2cea931991215366285295ce49449c8e13a28", "message": "Implementing `useTheme` hook instead of `withTheme` in views `Select`.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "130626048a45997485d367995a686da370163331", "url": "https://github.com/Graylog2/graylog2-server/commit/130626048a45997485d367995a686da370163331", "message": "Implementing `useTheme` hook instead of `withTheme` in `GenericPlot`.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "3bd3e0756e239caeb6c458879669ef3afc7e5ea6", "url": "https://github.com/Graylog2/graylog2-server/commit/3bd3e0756e239caeb6c458879669ef3afc7e5ea6", "message": "Rename styled-components declaration file", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "d811fc3c3419785667f4b7a88abddc03ef74bcbd", "url": "https://github.com/Graylog2/graylog2-server/commit/d811fc3c3419785667f4b7a88abddc03ef74bcbd", "message": "Add missing type definition for `InputDescription`", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "f35167992f1aa0ce1e2b10552ad192b401f1e3a7", "url": "https://github.com/Graylog2/graylog2-server/commit/f35167992f1aa0ce1e2b10552ad192b401f1e3a7", "message": "Defining correct `onChange` type for `PageSizeSelect`.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "6e97f919fdf7d71894f6ced6648352a76def6a88", "url": "https://github.com/Graylog2/graylog2-server/commit/6e97f919fdf7d71894f6ced6648352a76def6a88", "message": "Adding missing prop type definitions for common `Select`.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "ce651be22602791655143212a3c454ab43c7544f", "url": "https://github.com/Graylog2/graylog2-server/commit/ce651be22602791655143212a3c454ab43c7544f", "message": "Adding missing type definitioon in `ErrorPage`.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "f4a82f00c76bf8fafb299559ff134f95f0620f89", "url": "https://github.com/Graylog2/graylog2-server/commit/f4a82f00c76bf8fafb299559ff134f95f0620f89", "message": "Removing type definition from jsx file.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "f68c399340c810d47c4b011d7e6714fb43953070", "url": "https://github.com/Graylog2/graylog2-server/commit/f68c399340c810d47c4b011d7e6714fb43953070", "message": "Fxining type defeinitions in `ProgressBar`.", "committedDate": "2020-12-10T12:25:00Z", "type": "commit"}, {"oid": "7dfc0dd4c5a0bc39a26e5f4535ccd493c56413eb", "url": "https://github.com/Graylog2/graylog2-server/commit/7dfc0dd4c5a0bc39a26e5f4535ccd493c56413eb", "message": "Adding missing prop type definitions for views `Select`.", "committedDate": "2020-12-10T12:25:01Z", "type": "commit"}, {"oid": "62d92ec203874c0f2a76257097728805dae3dd35", "url": "https://github.com/Graylog2/graylog2-server/commit/62d92ec203874c0f2a76257097728805dae3dd35", "message": "Fixing `SeriesSelect` `Select` usage", "committedDate": "2020-12-10T12:25:01Z", "type": "commit"}, {"oid": "552e50dd7bf5fd6f452cf7c1091f5c24a022baf4", "url": "https://github.com/Graylog2/graylog2-server/commit/552e50dd7bf5fd6f452cf7c1091f5c24a022baf4", "message": "Adding missing type definitions in `QueryTitle`.", "committedDate": "2020-12-10T12:25:01Z", "type": "commit"}, {"oid": "a9fbbb696ff3a2e8990e4510b3f90d938023aa60", "url": "https://github.com/Graylog2/graylog2-server/commit/a9fbbb696ff3a2e8990e4510b3f90d938023aa60", "message": "Removing not needed props form button in `SavedSearchList`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "9666571d8e014d9c4faba57fcc437d6f9b6e2cfd", "url": "https://github.com/Graylog2/graylog2-server/commit/9666571d8e014d9c4faba57fcc437d6f9b6e2cfd", "message": "Replace `Styles` type with `React.CSSProperties`", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "428539ffc93648bcb4ebdb3e951da8a2f4208900", "url": "https://github.com/Graylog2/graylog2-server/commit/428539ffc93648bcb4ebdb3e951da8a2f4208900", "message": "Fixing format of `FieldSortSelect` options.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "89c9cffbd660357e431df620abafd9e4f22e17b7", "url": "https://github.com/Graylog2/graylog2-server/commit/89c9cffbd660357e431df620abafd9e4f22e17b7", "message": "Fixing forwardRef type definition in `Trend`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "d496a54c9519b997bd845b8b3aab82d863a37395", "url": "https://github.com/Graylog2/graylog2-server/commit/d496a54c9519b997bd845b8b3aab82d863a37395", "message": "Reverting `GenericPlot` and `Select` `withTheme` changes.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "e032fbed403233c8b510a271a9348fd72b98db29", "url": "https://github.com/Graylog2/graylog2-server/commit/e032fbed403233c8b510a271a9348fd72b98db29", "message": "Fixing type error in `Trend.test.tsx`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "8fb06e68e84ae038e6e59e8472c9c720d2295ee9", "url": "https://github.com/Graylog2/graylog2-server/commit/8fb06e68e84ae038e6e59e8472c9c720d2295ee9", "message": "Ignoring ref type error in `EntitySHareModal`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "2ae0f67af9725d677ee1777fcfd390662c98633a", "url": "https://github.com/Graylog2/graylog2-server/commit/2ae0f67af9725d677ee1777fcfd390662c98633a", "message": "Fixing type definition in `Trend.test`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "ec80028f219526ba916f1a362a59fb8bea6d0fdf", "url": "https://github.com/Graylog2/graylog2-server/commit/ec80028f219526ba916f1a362a59fb8bea6d0fdf", "message": "Updating `yarn.lock`", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "dac25726586cdf3516c1e89a662f422f2fe783d1", "url": "https://github.com/Graylog2/graylog2-server/commit/dac25726586cdf3516c1e89a662f422f2fe783d1", "message": "Moving `styled-components` decleration file to `src/@types/styled-components`", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "61ef1db85d6fdc2a76d841e68e97eec4b558383b", "url": "https://github.com/Graylog2/graylog2-server/commit/61ef1db85d6fdc2a76d841e68e97eec4b558383b", "message": "Removing `@types/styled-components` and copying its content to own decleration file.\n\nThis is neccessary to adjust the resturn type of `BaseWithThemeFnInterface`.\nWe can undo this once the change is part of `@types/styled-components`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "d618a4616134da0c03936689c383ac66e9a54a58", "url": "https://github.com/Graylog2/graylog2-server/commit/d618a4616134da0c03936689c383ac66e9a54a58", "message": "Creating separate file for `ThemeInterface`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "fb122911bfaa9d2a055616bac534c857bfcfd859", "url": "https://github.com/Graylog2/graylog2-server/commit/fb122911bfaa9d2a055616bac534c857bfcfd859", "message": "Moving `ThemeInterface` to `styled-components` decleration file.\n\nThis is necessary because otherwise the theme utility import paths do not get resolved properly\nwhen importing core components which are using the theme, in plugins.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "34625d439be765460dcc26e34158b9e4a4b08806", "url": "https://github.com/Graylog2/graylog2-server/commit/34625d439be765460dcc26e34158b9e4a4b08806", "message": "Reverting `Select` theme props change.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "ad7cb3b4761eaa19e957493d246924e75425bd7a", "url": "https://github.com/Graylog2/graylog2-server/commit/ad7cb3b4761eaa19e957493d246924e75425bd7a", "message": "Removing no lionger needed `ThemeInterface` file.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "b33fb8d35e4e094a52d3e068529ccef14191c989", "url": "https://github.com/Graylog2/graylog2-server/commit/b33fb8d35e4e094a52d3e068529ccef14191c989", "message": "Reverting `yarn.lock` changes.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "636cdc145778f157c593578a79a588412d54d3b7", "url": "https://github.com/Graylog2/graylog2-server/commit/636cdc145778f157c593578a79a588412d54d3b7", "message": "Unifying and improving common and view `Select` prop types.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "7008e770d2b9499a5bf090f41d9b974126f93b9a", "url": "https://github.com/Graylog2/graylog2-server/commit/7008e770d2b9499a5bf090f41d9b974126f93b9a", "message": "fixing `Select` usage in tests.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "e9781e1a93a9f82d605316c57469025b172a68aa", "url": "https://github.com/Graylog2/graylog2-server/commit/e9781e1a93a9f82d605316c57469025b172a68aa", "message": "Simplifying redundant type definition in `HorizontalSpacer`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "7f04ac248f30f03d5503eeb737ebbc6cc463d660", "url": "https://github.com/Graylog2/graylog2-server/commit/7f04ac248f30f03d5503eeb737ebbc6cc463d660", "message": "Defining correct value for select prop `closeMenuOnSelect` in `SeriesSelect`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "0090a629f63b6c2e0cb44cfc7ea41b697bc6a58c", "url": "https://github.com/Graylog2/graylog2-server/commit/0090a629f63b6c2e0cb44cfc7ea41b697bc6a58c", "message": "Adding `onMenuClose` for views `Select` and reimplementing on close logic in `SeriesSelect`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "bee9a38c4de756a86c7ddccdd1d76307b9b6506d", "url": "https://github.com/Graylog2/graylog2-server/commit/bee9a38c4de756a86c7ddccdd1d76307b9b6506d", "message": "Fixing merge conflict in `EntityShareModal`.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "2912fe02f8dce9acc17573f0fd9f53fd8d46c4ac", "url": "https://github.com/Graylog2/graylog2-server/commit/2912fe02f8dce9acc17573f0fd9f53fd8d46c4ac", "message": "Fixing linter warnings.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "dde474055e0a49fc0e8d05bb2f1fef8efb9e52f1", "url": "https://github.com/Graylog2/graylog2-server/commit/dde474055e0a49fc0e8d05bb2f1fef8efb9e52f1", "message": "Removing type inference logic in `QueryInput` which is now part of the `styled-component` type declaration.", "committedDate": "2020-12-10T12:25:57Z", "type": "commit"}, {"oid": "dde474055e0a49fc0e8d05bb2f1fef8efb9e52f1", "url": "https://github.com/Graylog2/graylog2-server/commit/dde474055e0a49fc0e8d05bb2f1fef8efb9e52f1", "message": "Removing type inference logic in `QueryInput` which is now part of the `styled-component` type declaration.", "committedDate": "2020-12-10T12:25:57Z", "type": "forcePushed"}, {"oid": "75a9e363a209d57cfd03ab802782453a187d0c6d", "url": "https://github.com/Graylog2/graylog2-server/commit/75a9e363a209d57cfd03ab802782453a187d0c6d", "message": "Fix linter warning regarding extra semicolon in `ProgressBar` styling.", "committedDate": "2020-12-10T13:51:02Z", "type": "commit"}, {"oid": "a27e182eda651bc2e8dea206a090f65c31cb3384", "url": "https://github.com/Graylog2/graylog2-server/commit/a27e182eda651bc2e8dea206a090f65c31cb3384", "message": "Ignoring stylelint warning in `FieldActions`.", "committedDate": "2020-12-10T13:53:31Z", "type": "commit"}]}