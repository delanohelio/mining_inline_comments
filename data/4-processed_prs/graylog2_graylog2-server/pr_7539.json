{"pr_number": 7539, "pr_title": "Add 200ms delay for displaying loading spinner", "pr_createdAt": "2020-02-24T15:03:53Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/7539", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA1NDAyNg==", "url": "https://github.com/Graylog2/graylog2-server/pull/7539#discussion_r384054026", "bodyText": "Should we have a test for the delay?", "author": "kyleknighted", "createdAt": "2020-02-25T18:46:02Z", "path": "graylog2-web-interface/src/components/common/Spinner.test.jsx", "diffHunk": "@@ -1,17 +1,21 @@\n import React from 'react';\n-import { mount } from 'wrappedEnzyme';\n+import { render, cleanup } from 'wrappedTestingLibrary';", "originalCommit": "29ccfb5a26b8a2e3392ddf02934c545a80ea1579", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNjIxOA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7539#discussion_r385616218", "bodyText": "I added a test, it only tests styling, but I agree it makes sense.", "author": "linuspahl", "createdAt": "2020-02-28T10:23:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA1NDAyNg=="}], "type": "inlineReview"}, {"oid": "5652cddec0ecae7417dc3cbf717ebc1c58057341", "url": "https://github.com/Graylog2/graylog2-server/commit/5652cddec0ecae7417dc3cbf717ebc1c58057341", "message": "Remove inexact spinner prop handling", "committedDate": "2020-02-28T09:58:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNzUxMA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7539#discussion_r385617510", "bodyText": "I had a problem with the usage of {...props} or in my case {...rest} and replaced it with some specific props and prop definitions. i hope I found every use case, so far I only found pulse and fixedWidth", "author": "linuspahl", "createdAt": "2020-02-28T10:26:16Z", "path": "graylog2-web-interface/src/components/common/Spinner.jsx", "diffHunk": "@@ -1,22 +1,62 @@\n-import React from 'react';\n+// @flow strict\n+import React, { useState, useEffect } from 'react';\n import PropTypes from 'prop-types';\n+import styled, { type StyledComponent } from 'styled-components';\n \n import Icon from './Icon';\n \n+const Wrapper: StyledComponent<{ visible: boolean }, {}, HTMLSpanElement> = styled.span`\n+  visibility: ${({ visible }) => (visible ? 'visible' : 'hidden')};\n+`;\n+\n+type Props = {\n+  delay?: number,\n+  fixedWidth?: boolean,\n+  name?: string,\n+  pulse: boolean,\n+  text?: string,\n+}\n+\n /**\n  * Simple spinner to use while waiting for something to load.\n  */\n-const Spinner = ({ name, text, ...props }) => <span><Icon name={name} spin {...props} /> {text}</span>;", "originalCommit": "3ca8430867d6785ef3032bbe2d4623ff13fe8580", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxODU1Mw==", "url": "https://github.com/Graylog2/graylog2-server/pull/7539#discussion_r385618553", "bodyText": "I saw the usage of {...rest} in other components (e.g. views/components/Select.jsx) where we are using flow as well. I don't really understand why we do not see the same error there.", "author": "linuspahl", "createdAt": "2020-02-28T10:28:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNzUxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYzNjU1OQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/7539#discussion_r385636559", "bodyText": "I was testing locally, and I can see the error when the spread happens at the end of the list of props.\nThis throws the error:\n<Icon name={name} spin {...props} /> {text}\n\nThis seems to be fine:\n<Icon {...props} name={name} spin /> {text}\n\nI guess that makes sense, since the rest props could contain a spin property that overrides the value, when the spread happens after the prop is set.", "author": "edmundoa", "createdAt": "2020-02-28T11:06:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNzUxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY0MDQ5Mg==", "url": "https://github.com/Graylog2/graylog2-server/pull/7539#discussion_r385640492", "bodyText": "Thanks for the clarification, this totally makes sense! I will reimplement the {...props} because I like the flexibility.", "author": "linuspahl", "createdAt": "2020-02-28T11:15:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNzUxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY0OTM2NQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/7539#discussion_r385649365", "bodyText": "I just realized the update of eslint-sonfig-airbnb #7586 forbids the props spreading. We need to discuss If we really want this, but the explanation contains some good points. I will not reimplement the props spreading for now.", "author": "linuspahl", "createdAt": "2020-02-28T11:37:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNzUxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTY1OTg5Mg==", "url": "https://github.com/Graylog2/graylog2-server/pull/7539#discussion_r385659892", "bodyText": "Sounds good, I think for this component is also fine having them explicitly set.", "author": "edmundoa", "createdAt": "2020-02-28T12:04:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYxNzUxMA=="}], "type": "inlineReview"}, {"oid": "1646ea513f15b9c7bcdc11dfff2b124b1f6534f9", "url": "https://github.com/Graylog2/graylog2-server/commit/1646ea513f15b9c7bcdc11dfff2b124b1f6534f9", "message": "Disable Spinner delay for LoadingPage", "committedDate": "2020-03-02T15:27:40Z", "type": "forcePushed"}, {"oid": "ae745d79bd98f2fe1b494f84e2f2f45814136678", "url": "https://github.com/Graylog2/graylog2-server/commit/ae745d79bd98f2fe1b494f84e2f2f45814136678", "message": "Disable Spinner delay for LoadingPage", "committedDate": "2020-03-03T14:40:00Z", "type": "forcePushed"}, {"oid": "9913a0b3e05d926ed017dcf6e0cd08054588c36e", "url": "https://github.com/Graylog2/graylog2-server/commit/9913a0b3e05d926ed017dcf6e0cd08054588c36e", "message": "Add 200ms delay for displaying loading spinner", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "bcaebb9f2375ac73c175fbc69999843d69f7c6a8", "url": "https://github.com/Graylog2/graylog2-server/commit/bcaebb9f2375ac73c175fbc69999843d69f7c6a8", "message": "Transform Spinner test to @testing-library/react test", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "976ada1191aa76a8237ffb8cde355d33f98b53e2", "url": "https://github.com/Graylog2/graylog2-server/commit/976ada1191aa76a8237ffb8cde355d33f98b53e2", "message": "Use flow strict for Spinner component", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "9ed58283178da651b87f19b2c236d26d2a8c9e45", "url": "https://github.com/Graylog2/graylog2-server/commit/9ed58283178da651b87f19b2c236d26d2a8c9e45", "message": "Remove not needed snpshot", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "d7b20f5149eadf4b49bbd9347dad06402d5c9025", "url": "https://github.com/Graylog2/graylog2-server/commit/d7b20f5149eadf4b49bbd9347dad06402d5c9025", "message": "Remove inexact spinner prop handling", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "6b3744ee05586d39b0ad0ebeddd6efa705ff14a2", "url": "https://github.com/Graylog2/graylog2-server/commit/6b3744ee05586d39b0ad0ebeddd6efa705ff14a2", "message": "Add tests for Spinner delay", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "c07ddf8849f1331fcd7bbefd24be8263167c2b85", "url": "https://github.com/Graylog2/graylog2-server/commit/c07ddf8849f1331fcd7bbefd24be8263167c2b85", "message": "Refactor styled component type definition", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "883462b7e8cd441ed1b5992440cfd8c1f894002b", "url": "https://github.com/Graylog2/graylog2-server/commit/883462b7e8cd441ed1b5992440cfd8c1f894002b", "message": "Fix linting", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "d4ff5a6937adcfe64386c25aecc271b12e7c17b9", "url": "https://github.com/Graylog2/graylog2-server/commit/d4ff5a6937adcfe64386c25aecc271b12e7c17b9", "message": "Update snapshots", "committedDate": "2020-03-03T14:41:03Z", "type": "commit"}, {"oid": "da45ffeff578e9dac75cf5e8f8f38a96c4ad1a65", "url": "https://github.com/Graylog2/graylog2-server/commit/da45ffeff578e9dac75cf5e8f8f38a96c4ad1a65", "message": "Disable Spinner delay for LoadingPage", "committedDate": "2020-03-03T14:42:48Z", "type": "commit"}, {"oid": "da45ffeff578e9dac75cf5e8f8f38a96c4ad1a65", "url": "https://github.com/Graylog2/graylog2-server/commit/da45ffeff578e9dac75cf5e8f8f38a96c4ad1a65", "message": "Disable Spinner delay for LoadingPage", "committedDate": "2020-03-03T14:42:48Z", "type": "forcePushed"}]}