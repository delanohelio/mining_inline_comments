{"pr_number": 8084, "pr_title": "Support editing title, description and summary of a saved search", "pr_createdAt": "2020-05-11T14:16:38Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/8084", "timeline": [{"oid": "be7225a50c37ef44d824d8dd5641f56834fde2d9", "url": "https://github.com/Graylog2/graylog2-server/commit/be7225a50c37ef44d824d8dd5641f56834fde2d9", "message": "Support editing title, description and summary of a saved search\n\n* Add \"Edit metadata\" action for saved search controls\n* Rename \"Edit\" action to \"Edit metadata\" for dashboards\n* Implement view type specific description for ViewPropertiesModal\n* Adjust sidebar ViewDescription", "committedDate": "2020-05-26T14:28:54Z", "type": "forcePushed"}, {"oid": "41541b815e9b4ecdf4794e676f562d05be049fb9", "url": "https://github.com/Graylog2/graylog2-server/commit/41541b815e9b4ecdf4794e676f562d05be049fb9", "message": "Support editing title, description and summary of a saved search\n\n* Add \"Edit metadata\" action for saved search controls\n* Rename \"Edit\" action to \"Edit metadata\" for dashboards\n* Implement view type specific description for ViewPropertiesModal\n* Adjust sidebar ViewDescription", "committedDate": "2020-05-26T15:33:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDUxMTYxMA==", "url": "https://github.com/Graylog2/graylog2-server/pull/8084#discussion_r430511610", "bodyText": "I does not have to be in this PR, but wouldn't it be wiser to make a functional component of this component, instead of adding a UNSAFE_", "author": "kmerz", "createdAt": "2020-05-26T15:39:48Z", "path": "graylog2-web-interface/src/views/components/views/ViewPropertiesModal.jsx", "diffHunk": "@@ -23,7 +24,8 @@ export default class ViewPropertiesModal extends React.Component {\n     };\n   }\n \n-  componentWillReceiveProps(nextProps) {\n+  // eslint-disable-next-line camelcase", "originalCommit": "41541b815e9b4ecdf4794e676f562d05be049fb9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDUxNDA5Mw==", "url": "https://github.com/Graylog2/graylog2-server/pull/8084#discussion_r430514093", "bodyText": "When we turn this into a functional component, we should do something better then comparing the whole view.\n\nit is not very efficient\nwe do not really care about the whole view if I am not wrong", "author": "kmerz", "createdAt": "2020-05-26T15:42:23Z", "path": "graylog2-web-interface/src/views/components/views/ViewPropertiesModal.jsx", "diffHunk": "@@ -23,7 +24,8 @@ export default class ViewPropertiesModal extends React.Component {\n     };\n   }\n \n-  componentWillReceiveProps(nextProps) {\n+  // eslint-disable-next-line camelcase\n+  UNSAFE_componentWillReceiveProps(nextProps) {\n     const { title } = this.props;\n     const { view } = this.state;\n     if (title !== nextProps.title || !isEqual(view, nextProps.view)) {", "originalCommit": "41541b815e9b4ecdf4794e676f562d05be049fb9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDUxNjYxOQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/8084#discussion_r430516619", "bodyText": "The order of Sections does not make much sense to me:\n\nI would rather have the description and summary together and the result in the beginning or the end.", "author": "kmerz", "createdAt": "2020-05-26T15:45:58Z", "path": "graylog2-web-interface/src/views/components/sidebar/ViewDescription.jsx", "diffHunk": "@@ -1,46 +1,55 @@\n // @flow strict\n-import React from 'react';\n+import * as React from 'react';\n+import { useContext } from 'react';\n import styled from 'styled-components';\n import PropTypes from 'prop-types';\n \n import type { ViewMetaData } from 'views/stores/ViewMetadataStore';\n+import QueryResult from 'views/logic/QueryResult';\n \n-import IfDashboard from 'views/components/dashboard/IfDashboard';\n+import ViewTypeLabel from 'views/components/ViewTypeLabel';\n+import ViewTypeContext from 'views/components/contexts/ViewTypeContext';\n import { SearchResultOverview } from 'views/components/sidebar';\n \n const Section = styled.div`\n   margin-bottom: 8px;\n `;\n \n-const defaultNewDashboardSummary = 'No dashboard summary.';\n-\n type Props = {\n-  results: Object,\n+  results: QueryResult,\n   viewMetadata: ViewMetaData,\n };\n \n const ViewDescription = ({ results, viewMetadata }: Props) => {\n-  const formatDashboardDescription = (view: ViewMetaData) => {\n-    const { description } = view;\n-    if (description) {\n-      return <span>{description}</span>;\n-    }\n-    return <i>No dashboard description.</i>;\n-  };\n+  const isAdHocSearch = !viewMetadata.id;\n+  const viewType = useContext(ViewTypeContext);\n+  const viewTypeLabel = viewType ? <ViewTypeLabel type={viewType} /> : '';\n+  const resultsSection = (\n+    <Section>\n+      <SearchResultOverview results={results} />\n+    </Section>\n+  );\n \n-  return (\n-    <>\n-      <IfDashboard>\n+  if (isAdHocSearch) {\n+    return (\n+      <>\n+        {resultsSection}\n         <Section>\n-          {viewMetadata.summary || defaultNewDashboardSummary}\n+          <i>Save the search or export it to a dashboard to add a custom description.</i>\n         </Section>\n-      </IfDashboard>\n+      </>\n+    );\n+  }\n+\n+  return (\n+    <>\n+      <Section>\n+        {viewMetadata.summary || <i>No {viewTypeLabel} summary.</i>}\n+      </Section>\n+      {resultsSection}\n       <Section>\n-        <SearchResultOverview results={results} />\n+        {viewMetadata.description || <i>No {viewTypeLabel} description.</i>}\n       </Section>", "originalCommit": "41541b815e9b4ecdf4794e676f562d05be049fb9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7d9d4bd102aa5f43aa8e64acfcc56399e2122ba2", "url": "https://github.com/Graylog2/graylog2-server/commit/7d9d4bd102aa5f43aa8e64acfcc56399e2122ba2", "message": "Support editing title, description and summary of a saved search\n\n* Add \"Edit metadata\" action for saved search controls\n* Rename \"Edit\" action to \"Edit metadata\" for dashboards\n* Implement view type specific description for ViewPropertiesModal\n* Adjust sidebar ViewDescription", "committedDate": "2020-06-02T15:11:37Z", "type": "forcePushed"}, {"oid": "fe3c2517718ddc94fb9852cc0ab36f756a675db3", "url": "https://github.com/Graylog2/graylog2-server/commit/fe3c2517718ddc94fb9852cc0ab36f756a675db3", "message": "Support editing title, description and summary of a saved search\n\n* Add \"Edit metadata\" action for saved search controls\n* Rename \"Edit\" action to \"Edit metadata\" for dashboards\n* Implement view type specific description for ViewPropertiesModal\n* Adjust sidebar ViewDescription", "committedDate": "2020-06-11T08:45:14Z", "type": "commit"}, {"oid": "f23645bae78aaf99dcf968561fb964f73710e7ae", "url": "https://github.com/Graylog2/graylog2-server/commit/f23645bae78aaf99dcf968561fb964f73710e7ae", "message": "Movesearch execution info in sidebar above search summary and description", "committedDate": "2020-06-11T08:45:14Z", "type": "commit"}, {"oid": "f23645bae78aaf99dcf968561fb964f73710e7ae", "url": "https://github.com/Graylog2/graylog2-server/commit/f23645bae78aaf99dcf968561fb964f73710e7ae", "message": "Movesearch execution info in sidebar above search summary and description", "committedDate": "2020-06-11T08:45:14Z", "type": "forcePushed"}]}