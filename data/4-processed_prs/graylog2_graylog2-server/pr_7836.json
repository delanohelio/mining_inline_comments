{"pr_number": 7836, "pr_title": "Create separate context for current user", "pr_createdAt": "2020-04-07T09:15:36Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/7836", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY2MTM0MA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r404661340", "bodyText": "I had to use the ActionContext because AdditionalContext is not working with useContext, but I could also wrap the component in AdditionalContext.Provider, instead.", "author": "linuspahl", "createdAt": "2020-04-07T09:18:10Z", "path": "graylog2-web-interface/src/views/components/messagelist/CustomHighlighting.jsx", "diffHunk": "@@ -1,24 +1,22 @@\n // @flow strict\n import * as React from 'react';\n+import { useContext } from 'react';\n import PropTypes from 'prop-types';\n \n-import connect from 'stores/connect';\n-\n-import { HighlightingRulesStore } from 'views/stores/HighlightingRulesStore';\n+import { ActionContext } from 'views/logic/ActionContext';\n import DecoratorContext from 'views/components/messagelist/decoration/DecoratorContext';\n-import HighlightingRule from 'views/logic/views/formatting/highlighting/HighlightingRule';\n \n import PossiblyHighlight from './PossiblyHighlight';\n import Highlight from './Highlight';\n \n type Props = {\n   children: ?React.Node,\n   field: string,\n-  highlightingRules: { [string]: Array<HighlightingRule> },\n   value?: any,\n };\n \n-const CustomHighlighting = ({ children, field: fieldName, value: fieldValue, highlightingRules }: Props) => {\n+const CustomHighlighting = ({ children, field: fieldName, value: fieldValue }: Props) => {\n+  const { highlightingRules = {} } = useContext(ActionContext);", "originalCommit": "e66605adc6c64d56460571631765c394fcd5c2b8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "381d70c64d354597d1d1707c078b3e7b957469a3", "url": "https://github.com/Graylog2/graylog2-server/commit/381d70c64d354597d1d1707c078b3e7b957469a3", "message": "Fix SavedSearchControls test", "committedDate": "2020-04-09T10:22:57Z", "type": "forcePushed"}, {"oid": "61c1865d8c08080ce1b36e5dd6f46a5b0178fc2f", "url": "https://github.com/Graylog2/graylog2-server/commit/61c1865d8c08080ce1b36e5dd6f46a5b0178fc2f", "message": "Fix linting error", "committedDate": "2020-04-15T09:42:53Z", "type": "forcePushed"}, {"oid": "630a71f0cd218978df5b7818cf58da44a16c797f", "url": "https://github.com/Graylog2/graylog2-server/commit/630a71f0cd218978df5b7818cf58da44a16c797f", "message": "Add tests for HighlightingRulesProvider", "committedDate": "2020-04-15T10:27:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAxOTg3Mg==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r409019872", "bodyText": "Since we're revising this component already, could we use createRef?", "author": "kyleknighted", "createdAt": "2020-04-15T17:41:27Z", "path": "graylog2-web-interface/src/views/components/searchbar/saved-search/SavedSearchControls.jsx", "diffHunk": "@@ -228,50 +205,48 @@ class SavedSearchControls extends React.Component<Props, State> {\n     );\n \n     return (\n-      <NewViewLoaderContext.Consumer>\n-        {(loadNewView) => (\n-          <div className=\"pull-right\">\n-            <ButtonGroup>\n-              <>\n-                <Button title={title} ref={(elem) => { this.formTarget = elem; }} onClick={this.toggleFormModal}>\n-                  <Icon style={{ color: savedSearchColor }} name={savedSearchStyle} /> Save\n-                </Button>\n-                {savedSearchForm}\n-              </>\n-              <Button title=\"Load a previously saved search\"\n-                      onClick={this.toggleListModal}>\n-                <Icon name=\"folder-o\" /> Load\n-              </Button>\n-              {savedSearchList}\n-              <DropdownButton title={<Icon name=\"ellipsis-h\" />} id=\"search-actions-dropdown\" pullRight noCaret>\n-                <MenuItem onSelect={this.loadAsDashboard}><Icon name=\"dashboard\" /> Export to dashboard</MenuItem>\n-                <MenuItem onSelect={this.toggleCSVExport}><Icon name=\"cloud-download\" /> Export to CSV</MenuItem>\n-                <MenuItem disabled={disableReset} onSelect={() => loadNewView()} data-testid=\"reset-search\">\n-                  <Icon name=\"eraser\" /> Reset search\n-                </MenuItem>\n-                <MenuItem divider />\n-                <MenuItem onSelect={this.toggleShareSearch} title=\"Share search\" disabled={!(view && view.id) || !_isAllowedToEdit(view, currentUser)}>\n-                  <Icon name=\"share-alt\" /> Share\n-                </MenuItem>\n-              </DropdownButton>\n-              {csvExport}\n-              {shareSearch}\n-            </ButtonGroup>\n-          </div>\n+      <CurrentUserContext.Consumer>\n+        {(currentUser) => (\n+          <NewViewLoaderContext.Consumer>\n+            {(loadNewView) => (\n+              <div className=\"pull-right\">\n+                <ButtonGroup>\n+                  <>\n+                    <Button title={title} ref={(elem) => { this.formTarget = elem; }} onClick={this.toggleFormModal}>", "originalCommit": "7429ed2a66e202f48a31fede002e69845aa52a28", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyNTI4MQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r409025281", "bodyText": "graylog2-web-interface/config.js shows that the default timezone is 'Europe/Berlin'. Not sure if that's relevant. Also, should we hoist this default up into the context's default?", "author": "kyleknighted", "createdAt": "2020-04-15T17:50:22Z", "path": "graylog2-web-interface/src/views/components/visualizations/XYPlot.jsx", "diffHunk": "@@ -50,14 +47,14 @@ const XYPlot = ({\n   config,\n   chartData,\n   currentQuery,\n-  timezone,\n   effectiveTimerange,\n   getChartColor,\n   setChartColor,\n   height,\n   plotLayout = {},\n   onZoom = OnZoom,\n }: Props) => {\n+  const { timezone } = useContext(CurrentUserContext) || { timezone: 'UTC' };", "originalCommit": "7429ed2a66e202f48a31fede002e69845aa52a28", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ0MTEzMA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r409441130", "bodyText": "I've implemented the AppConfig rootTimeZone  as a default fallback. I prefer to define the fall back inside the component, because we check e.g. in the App.jsx if the currentUser object is empty.", "author": "linuspahl", "createdAt": "2020-04-16T10:11:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyNTI4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA2OTI5Mg==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410069292", "bodyText": "Instead of || we can now use ??, which returns the right side only if the left side is null or undefined, not just falsy. We should favor this now that we can use it over ||.", "author": "dennisoelkers", "createdAt": "2020-04-17T08:23:58Z", "path": "graylog2-web-interface/src/views/components/common/UserTimezoneTimestamp.jsx", "diffHunk": "@@ -1,25 +1,14 @@\n-import React from 'react';\n-import PropTypes from 'prop-types';\n+import React, { useContext } from 'react';\n \n-import connect from 'stores/connect';\n-import CombinedProvider from 'injection/CombinedProvider';\n+import AppConfig from 'util/AppConfig';\n+import CurrentUserContext from 'contexts/CurrentUserContext';\n import Timestamp from 'components/common/Timestamp';\n import DateTime from 'logic/datetimes/DateTime';\n \n-const { CurrentUserStore } = CombinedProvider.get('CurrentUser');\n-\n-const UserTimezoneTimestamp = ({ timezone, ...rest }) => <Timestamp tz={timezone} format={DateTime.Formats.DATETIME_TZ} {...rest} />;\n-\n-UserTimezoneTimestamp.propTypes = {\n-  timezone: PropTypes.string,\n-};\n-\n-UserTimezoneTimestamp.defaultProps = {\n-  timezone: null,\n+const UserTimezoneTimestamp = ({ ...rest }) => {\n+  const currentUser = useContext(CurrentUserContext);\n+  const timezone = currentUser?.timezone || AppConfig.rootTimeZone();", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3MzIzNA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410073234", "bodyText": "|| -> ??", "author": "dennisoelkers", "createdAt": "2020-04-17T08:31:05Z", "path": "graylog2-web-interface/src/views/components/messagelist/CustomHighlighting.jsx", "diffHunk": "@@ -1,26 +1,25 @@\n // @flow strict\n import * as React from 'react';\n+import { useContext } from 'react';\n import PropTypes from 'prop-types';\n \n-import connect from 'stores/connect';\n-\n-import { HighlightingRulesStore } from 'views/stores/HighlightingRulesStore';\n+import HighlightingRulesContext from 'views/components/contexts/HighlightingRulesContext';\n import DecoratorContext from 'views/components/messagelist/decoration/DecoratorContext';\n-import HighlightingRule from 'views/logic/views/formatting/highlighting/HighlightingRule';\n \n import PossiblyHighlight from './PossiblyHighlight';\n import Highlight from './Highlight';\n \n type Props = {\n   children: ?React.Node,\n   field: string,\n-  highlightingRules: { [string]: Array<HighlightingRule> },\n   value?: any,\n };\n \n-const CustomHighlighting = ({ children, field: fieldName, value: fieldValue, highlightingRules }: Props) => {\n+const CustomHighlighting = ({ children, field: fieldName, value: fieldValue }: Props) => {\n+  const highlightingRules = useContext(HighlightingRulesContext) || [];", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3MzUxMQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410073511", "bodyText": "|| -> ??", "author": "dennisoelkers", "createdAt": "2020-04-17T08:31:37Z", "path": "graylog2-web-interface/src/views/components/messagelist/CustomHighlighting.jsx", "diffHunk": "@@ -1,26 +1,25 @@\n // @flow strict\n import * as React from 'react';\n+import { useContext } from 'react';\n import PropTypes from 'prop-types';\n \n-import connect from 'stores/connect';\n-\n-import { HighlightingRulesStore } from 'views/stores/HighlightingRulesStore';\n+import HighlightingRulesContext from 'views/components/contexts/HighlightingRulesContext';\n import DecoratorContext from 'views/components/messagelist/decoration/DecoratorContext';\n-import HighlightingRule from 'views/logic/views/formatting/highlighting/HighlightingRule';\n \n import PossiblyHighlight from './PossiblyHighlight';\n import Highlight from './Highlight';\n \n type Props = {\n   children: ?React.Node,\n   field: string,\n-  highlightingRules: { [string]: Array<HighlightingRule> },\n   value?: any,\n };\n \n-const CustomHighlighting = ({ children, field: fieldName, value: fieldValue, highlightingRules }: Props) => {\n+const CustomHighlighting = ({ children, field: fieldName, value: fieldValue }: Props) => {\n+  const highlightingRules = useContext(HighlightingRulesContext) || [];\n+  const highlightingRulesMap = highlightingRules.reduce((prev, cur) => ({ ...prev, [cur.field]: prev[cur.field] ? [...prev[cur.field], cur] : [cur] }), {});\n   const decorators = [];\n-  const rules = highlightingRules[fieldName] || [];\n+  const rules = highlightingRulesMap[fieldName] || [];", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3NDAxMg==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410074012", "bodyText": "I think we can simplify this to\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              const highlightingRulesMap = highlightingRules.reduce((prev, cur) => ({ ...prev, [cur.field]: prev[cur.field] ? [...prev[cur.field], cur] : [cur] }), {});\n          \n          \n            \n              const highlightingRulesMap = highlightingRules.reduce((prev, cur) => ({ ...prev, [cur.field]: [...prev[cur.field], cur] }), {});", "author": "dennisoelkers", "createdAt": "2020-04-17T08:32:37Z", "path": "graylog2-web-interface/src/views/components/messagelist/CustomHighlighting.jsx", "diffHunk": "@@ -1,26 +1,25 @@\n // @flow strict\n import * as React from 'react';\n+import { useContext } from 'react';\n import PropTypes from 'prop-types';\n \n-import connect from 'stores/connect';\n-\n-import { HighlightingRulesStore } from 'views/stores/HighlightingRulesStore';\n+import HighlightingRulesContext from 'views/components/contexts/HighlightingRulesContext';\n import DecoratorContext from 'views/components/messagelist/decoration/DecoratorContext';\n-import HighlightingRule from 'views/logic/views/formatting/highlighting/HighlightingRule';\n \n import PossiblyHighlight from './PossiblyHighlight';\n import Highlight from './Highlight';\n \n type Props = {\n   children: ?React.Node,\n   field: string,\n-  highlightingRules: { [string]: Array<HighlightingRule> },\n   value?: any,\n };\n \n-const CustomHighlighting = ({ children, field: fieldName, value: fieldValue, highlightingRules }: Props) => {\n+const CustomHighlighting = ({ children, field: fieldName, value: fieldValue }: Props) => {\n+  const highlightingRules = useContext(HighlightingRulesContext) || [];\n+  const highlightingRulesMap = highlightingRules.reduce((prev, cur) => ({ ...prev, [cur.field]: prev[cur.field] ? [...prev[cur.field], cur] : [cur] }), {});", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyNDI4Nw==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r414424287", "bodyText": "We need to check in some way if prev[cur.field] is defined, because undefined is not iterable.", "author": "linuspahl", "createdAt": "2020-04-24T09:16:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3NDAxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3NTM4Mw==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410075383", "bodyText": "|| -> ??", "author": "dennisoelkers", "createdAt": "2020-04-17T08:35:03Z", "path": "graylog2-web-interface/src/views/components/sidebar/SearchResultOverview.jsx", "diffHunk": "@@ -1,20 +1,20 @@\n-import React from 'react';\n+import React, { useContext } from 'react';\n import PropTypes from 'prop-types';\n import numeral from 'numeral';\n-import { get } from 'lodash';\n \n+import AppConfig from 'util/AppConfig';\n import { Timestamp } from 'components/common';\n-import DateTime from 'logic/datetimes/DateTime';\n-import CurrentUserStore from 'stores/users/CurrentUserStore';\n-import connect from 'stores/connect';\n+import CurrentUserContext from 'contexts/CurrentUserContext';\n \n-const UserTimestamp = connect(Timestamp, { currentUser: CurrentUserStore }, ({ currentUser }) => ({ tz: get(currentUser, 'currentUser.timezone', 'UTC') }));\n+import DateTime from 'logic/datetimes/DateTime';\n \n const SearchResultOverview = ({ results }) => {\n   const { timestamp } = results;\n+  const currentUser = useContext(CurrentUserContext);\n+  const timezone = currentUser?.timezone || AppConfig.rootTimeZone();", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3ODE2OA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410078168", "bodyText": "It looks like in none of the tests the currentUser is actually supplied. Do we need the context provider here?", "author": "dennisoelkers", "createdAt": "2020-04-17T08:40:01Z", "path": "graylog2-web-interface/src/views/components/ViewActionsMenu.test.jsx", "diffHunk": "@@ -66,23 +55,34 @@ jest.mock('views/stores/ViewSharingStore', () => ({\n describe('ViewActionsMenu', () => {\n   afterEach(cleanup);\n \n+  const SimpleViewActionMenu = ({ currentUser, ...props }: {currentUser?: User}) => (\n+    <CurrentUserContext.Provider value={currentUser}>", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQyNzk2OA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r414427968", "bodyText": "We need to mock the currentUser here to be able to test the meta information and share modal. Otherwise the menu buttons would be disabled.", "author": "linuspahl", "createdAt": "2020-04-24T09:21:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3ODE2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3ODY2NQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410078665", "bodyText": "We are favoring the Array<HighlightingRule> syntax in most other places. Generally I am fine with both (there is no semantic difference), but if we want to settle on one for consistency, it would be Array<T> right now.", "author": "dennisoelkers", "createdAt": "2020-04-17T08:41:02Z", "path": "graylog2-web-interface/src/views/components/contexts/HighlightingRulesContext.jsx", "diffHunk": "@@ -0,0 +1,8 @@\n+// @flow strict\n+import * as React from 'react';\n+import { singleton } from 'views/logic/singleton';\n+import HighlightingRule from 'views/logic/views/formatting/highlighting/HighlightingRule';\n+\n+const HighlightingRules = React.createContext<?HighlightingRule[]>();", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA4NDM1NQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410084355", "bodyText": "|| -> ??", "author": "dennisoelkers", "createdAt": "2020-04-17T08:51:20Z", "path": "graylog2-web-interface/src/views/components/visualizations/XYPlot.jsx", "diffHunk": "@@ -50,14 +48,15 @@ const XYPlot = ({\n   config,\n   chartData,\n   currentQuery,\n-  timezone,\n   effectiveTimerange,\n   getChartColor,\n   setChartColor,\n   height,\n   plotLayout = {},\n   onZoom = OnZoom,\n }: Props) => {\n+  const currentUser = useContext(CurrentUserContext);\n+  const timezone = currentUser?.timezone || AppConfig.rootTimeZone();", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA4NjU4MA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410086580", "bodyText": "I think we should use a separate file to feed AppConfig for our tests. This one is used by the dev server, using a separate one with different settings (especially a timezone that is not Europe/Berlin) could potentially uncover issues which we do not see when testing on dev machines (where we would use the same settings otherwise).", "author": "dennisoelkers", "createdAt": "2020-04-17T08:55:22Z", "path": "graylog2-web-interface/test/setup-jest.js", "diffHunk": "@@ -1,6 +1,8 @@\n import jQuery from 'jquery';\n import registerBuiltinStores from 'injection/registerBuiltinStores';\n \n+import '../config';", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDQ3ODQzMQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r414478431", "bodyText": "Good point, I've created another config file and included it as a setupFile. At first I tried to reuse the config.js in a way we only need to define window.appConfig in one place, but in the end it was a cleaner solution to create another separate file and keep the config.js as simple as possible.", "author": "linuspahl", "createdAt": "2020-04-24T10:44:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA4NjU4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA5MDg2NA==", "url": "https://github.com/Graylog2/graylog2-server/pull/7836#discussion_r410090864", "bodyText": "CurrentUserPreferencesProvider -> CurrentUserProvider", "author": "dennisoelkers", "createdAt": "2020-04-17T09:03:11Z", "path": "graylog2-web-interface/src/contexts/CurrentUserProvider.jsx", "diffHunk": "@@ -0,0 +1,26 @@\n+// @flow strict\n+import * as React from 'react';\n+import PropTypes from 'prop-types';\n+import { get } from 'lodash';\n+\n+import { useStore } from 'stores/connect';\n+import CombinedProvider from 'injection/CombinedProvider';\n+import CurrentUserContext from './CurrentUserContext';\n+\n+const { CurrentUserStore } = CombinedProvider.get('CurrentUser');\n+const CurrentUserPreferencesProvider = ({ children }: { children: React.Node }) => {", "originalCommit": "be63f3f51517e2ba8cba2aa6117286d2f5a76b1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "768c03f4e298e1fda480eb922c0b5e5c7fce249b", "url": "https://github.com/Graylog2/graylog2-server/commit/768c03f4e298e1fda480eb922c0b5e5c7fce249b", "message": "Implement React.createRef for saved searches save button", "committedDate": "2020-04-24T10:14:15Z", "type": "forcePushed"}, {"oid": "e34298c49b6696d515535d1daf3e9c5f308de34f", "url": "https://github.com/Graylog2/graylog2-server/commit/e34298c49b6696d515535d1daf3e9c5f308de34f", "message": "Mock SearchExecutionStateStore in ViewActionsMenu test", "committedDate": "2020-04-24T10:39:51Z", "type": "forcePushed"}, {"oid": "fbee2cf66488e61f225a813f1dad6c7ed985c612", "url": "https://github.com/Graylog2/graylog2-server/commit/fbee2cf66488e61f225a813f1dad6c7ed985c612", "message": "Use ?? instead of || for remaining user timezone checks", "committedDate": "2020-04-24T10:59:32Z", "type": "forcePushed"}, {"oid": "b7da17e42b225ecf726954fb3579951863871b29", "url": "https://github.com/Graylog2/graylog2-server/commit/b7da17e42b225ecf726954fb3579951863871b29", "message": "Use ?? instead of || for remaining user timezone checks", "committedDate": "2020-04-24T12:21:13Z", "type": "forcePushed"}, {"oid": "17bc8403c6b244aae4b2b0b0c948a29584363551", "url": "https://github.com/Graylog2/graylog2-server/commit/17bc8403c6b244aae4b2b0b0c948a29584363551", "message": "Fixing rebase", "committedDate": "2020-05-15T15:19:00Z", "type": "forcePushed"}, {"oid": "4805ba1d07cf7207eb5a7e509e677aa6646a08d1", "url": "https://github.com/Graylog2/graylog2-server/commit/4805ba1d07cf7207eb5a7e509e677aa6646a08d1", "message": "Fix import of CurrentUserContext in App.jsx", "committedDate": "2020-06-04T09:45:27Z", "type": "forcePushed"}, {"oid": "0c9eb90a08bc1bb82dad7a06d81b77d2b29ed77a", "url": "https://github.com/Graylog2/graylog2-server/commit/0c9eb90a08bc1bb82dad7a06d81b77d2b29ed77a", "message": "    Add highlighting rules to AdditionalContext", "committedDate": "2020-06-15T09:59:20Z", "type": "commit"}, {"oid": "f706b5fcfb5068c1aa2609b6cef382a08e177955", "url": "https://github.com/Graylog2/graylog2-server/commit/f706b5fcfb5068c1aa2609b6cef382a08e177955", "message": "Add currentUser to AdditionalContext", "committedDate": "2020-06-15T09:59:20Z", "type": "commit"}, {"oid": "94a565f73d580a0af99aebd35d213fc6fdfb1a61", "url": "https://github.com/Graylog2/graylog2-server/commit/94a565f73d580a0af99aebd35d213fc6fdfb1a61", "message": "Extract currentUser from current user store on ViewAdditionalContextProvider creation", "committedDate": "2020-06-15T09:59:21Z", "type": "commit"}, {"oid": "335291cb6c7984ece16bf134ab2e776d9c44cde8", "url": "https://github.com/Graylog2/graylog2-server/commit/335291cb6c7984ece16bf134ab2e776d9c44cde8", "message": "Create CurrentUserContext and implement Provider in App.jsx", "committedDate": "2020-06-15T09:59:21Z", "type": "commit"}, {"oid": "6ab6e3608200dc0bf67da789162008f5bdba4972", "url": "https://github.com/Graylog2/graylog2-server/commit/6ab6e3608200dc0bf67da789162008f5bdba4972", "message": "Implement CurrentUserContext for UserTimezoneTimestamp", "committedDate": "2020-06-15T09:59:21Z", "type": "commit"}, {"oid": "61eb12dc2374c0ce5b39d56b2fc3d1ef1bbc7639", "url": "https://github.com/Graylog2/graylog2-server/commit/61eb12dc2374c0ce5b39d56b2fc3d1ef1bbc7639", "message": "Implement CurrentUserContext for ViewActionsMenu", "committedDate": "2020-06-15T09:59:21Z", "type": "commit"}, {"oid": "6f263e8d82393f50dc8644d44f0c37aede624f51", "url": "https://github.com/Graylog2/graylog2-server/commit/6f263e8d82393f50dc8644d44f0c37aede624f51", "message": "Define default value for CurrentUserContext fot less problems with flow type checking", "committedDate": "2020-06-15T09:59:21Z", "type": "commit"}, {"oid": "97562104fbf12a9235defa706e704335a6ef1696", "url": "https://github.com/Graylog2/graylog2-server/commit/97562104fbf12a9235defa706e704335a6ef1696", "message": "Implement CurrentUserContext for SavedSearchControls", "committedDate": "2020-06-15T10:09:52Z", "type": "commit"}, {"oid": "69c347aa9c50b1ecbb8f3601caed7ad0ead62aa0", "url": "https://github.com/Graylog2/graylog2-server/commit/69c347aa9c50b1ecbb8f3601caed7ad0ead62aa0", "message": "Implement CurrentUserContext for View component", "committedDate": "2020-06-15T10:09:52Z", "type": "commit"}, {"oid": "600f1519fd3f0b60aecf62a3406083160f6ec785", "url": "https://github.com/Graylog2/graylog2-server/commit/600f1519fd3f0b60aecf62a3406083160f6ec785", "message": "Remove current user from ViewAdditionalContextProvider", "committedDate": "2020-06-15T10:09:53Z", "type": "commit"}, {"oid": "7afc7203f9647b60713f972f396ad19836bae26b", "url": "https://github.com/Graylog2/graylog2-server/commit/7afc7203f9647b60713f972f396ad19836bae26b", "message": "Implement CurrentUserContext for XYPlot", "committedDate": "2020-06-15T10:09:53Z", "type": "commit"}, {"oid": "7b66a13d05b5701ffad28953716f6858213fe8cc", "url": "https://github.com/Graylog2/graylog2-server/commit/7b66a13d05b5701ffad28953716f6858213fe8cc", "message": "Implement CurrentUserContext for SearchResultOverview", "committedDate": "2020-06-15T10:09:53Z", "type": "commit"}, {"oid": "9d29842773089fdc20a5c60f8d2ce8c9b3e452b3", "url": "https://github.com/Graylog2/graylog2-server/commit/9d29842773089fdc20a5c60f8d2ce8c9b3e452b3", "message": "FIx SavedSearchControls test", "committedDate": "2020-06-15T10:09:53Z", "type": "commit"}, {"oid": "d8330fffb6af904695816daf9e5052a149ef449c", "url": "https://github.com/Graylog2/graylog2-server/commit/d8330fffb6af904695816daf9e5052a149ef449c", "message": "Remove empty object as default value for UserContext and define a default value in related components", "committedDate": "2020-06-15T10:09:53Z", "type": "commit"}, {"oid": "80259c6e460a3b0d8daff55d03db3a6028020f87", "url": "https://github.com/Graylog2/graylog2-server/commit/80259c6e460a3b0d8daff55d03db3a6028020f87", "message": "Create separate file for UserContextProvider which uses useStore", "committedDate": "2020-06-15T10:09:53Z", "type": "commit"}, {"oid": "11524f89ebf9dbeb0e2a999c512800bbdeae4d3b", "url": "https://github.com/Graylog2/graylog2-server/commit/11524f89ebf9dbeb0e2a999c512800bbdeae4d3b", "message": "Use JSX syntax for helper components in tests which are wrapped in a context", "committedDate": "2020-06-15T10:09:53Z", "type": "commit"}, {"oid": "22fefa5419c0b8a28bd5e070590670529747992c", "url": "https://github.com/Graylog2/graylog2-server/commit/22fefa5419c0b8a28bd5e070590670529747992c", "message": "Create own context provider for HighlightingRulest", "committedDate": "2020-06-15T10:11:31Z", "type": "commit"}, {"oid": "e41bf03e4aa7369c21b40bba666c153abca098f9", "url": "https://github.com/Graylog2/graylog2-server/commit/e41bf03e4aa7369c21b40bba666c153abca098f9", "message": "Fix linting error", "committedDate": "2020-06-15T10:11:31Z", "type": "commit"}, {"oid": "0789d7da113181c0ee2bb28ad40989025e9f150d", "url": "https://github.com/Graylog2/graylog2-server/commit/0789d7da113181c0ee2bb28ad40989025e9f150d", "message": "Revert not needed changes", "committedDate": "2020-06-15T10:11:50Z", "type": "commit"}, {"oid": "50ff4cc127e4637b2cb543ec1870e6c34369172b", "url": "https://github.com/Graylog2/graylog2-server/commit/50ff4cc127e4637b2cb543ec1870e6c34369172b", "message": "Add tests for CurrentUserProvider", "committedDate": "2020-06-15T10:11:50Z", "type": "commit"}, {"oid": "1910787f370cbe83b37acea4ae025174fe54700f", "url": "https://github.com/Graylog2/graylog2-server/commit/1910787f370cbe83b37acea4ae025174fe54700f", "message": "Remove not needed CurrentUserStoreMock", "committedDate": "2020-06-15T10:11:50Z", "type": "commit"}, {"oid": "d077d432fd5dce803c21478902ff88f46518133f", "url": "https://github.com/Graylog2/graylog2-server/commit/d077d432fd5dce803c21478902ff88f46518133f", "message": "Fix flow error", "committedDate": "2020-06-15T10:11:50Z", "type": "commit"}, {"oid": "7290de6c120b3f34a1cde40dbbf72802ec1eaddf", "url": "https://github.com/Graylog2/graylog2-server/commit/7290de6c120b3f34a1cde40dbbf72802ec1eaddf", "message": "Revert TransformKeys changes", "committedDate": "2020-06-15T10:11:50Z", "type": "commit"}, {"oid": "ec72936a163ad134a7084c60428e96ba89ec730a", "url": "https://github.com/Graylog2/graylog2-server/commit/ec72936a163ad134a7084c60428e96ba89ec730a", "message": "Fix flow errors", "committedDate": "2020-06-15T10:11:50Z", "type": "commit"}, {"oid": "9ecdce8181b1868a6cc228b3a60964847c53da28", "url": "https://github.com/Graylog2/graylog2-server/commit/9ecdce8181b1868a6cc228b3a60964847c53da28", "message": "Remove PropTypes from SavedSearchControls test", "committedDate": "2020-06-15T10:11:50Z", "type": "commit"}, {"oid": "5246b41c27823357200c21bd02497c7cc35d24aa", "url": "https://github.com/Graylog2/graylog2-server/commit/5246b41c27823357200c21bd02497c7cc35d24aa", "message": "Remove console.log", "committedDate": "2020-06-15T10:11:50Z", "type": "commit"}, {"oid": "10c6ec2bdddba1a7983621c649008fedbb8c7d4b", "url": "https://github.com/Graylog2/graylog2-server/commit/10c6ec2bdddba1a7983621c649008fedbb8c7d4b", "message": "Remove not needed import", "committedDate": "2020-06-15T10:11:51Z", "type": "commit"}, {"oid": "b9575bfe0f19e727c3d7072741e647a10b0a0269", "url": "https://github.com/Graylog2/graylog2-server/commit/b9575bfe0f19e727c3d7072741e647a10b0a0269", "message": "Use AppConfig rootTimeZone as default timezone fallback\n- import app config for tests\n- Add missing CurrentUserContext in XYPlot test\n- Adjust currentUser default value handling by using optional chaining", "committedDate": "2020-06-15T10:11:51Z", "type": "commit"}, {"oid": "e8e382913f9852d2fb187f3fcafde9966569c3e6", "url": "https://github.com/Graylog2/graylog2-server/commit/e8e382913f9852d2fb187f3fcafde9966569c3e6", "message": "Remove empty line", "committedDate": "2020-06-15T10:11:51Z", "type": "commit"}, {"oid": "5a14bc49b7d6fe268e29ff3273b872ff4879570a", "url": "https://github.com/Graylog2/graylog2-server/commit/5a14bc49b7d6fe268e29ff3273b872ff4879570a", "message": "Fix for test filename", "committedDate": "2020-06-15T10:11:51Z", "type": "commit"}, {"oid": "65f8382c17095290eb6afdbc6ca8aac0138cd099", "url": "https://github.com/Graylog2/graylog2-server/commit/65f8382c17095290eb6afdbc6ca8aac0138cd099", "message": "Defining correct name for CurrentUserProvider component", "committedDate": "2020-06-15T10:11:51Z", "type": "commit"}, {"oid": "5d931293d9a9946dcc743d6a539af6facf957ad5", "url": "https://github.com/Graylog2/graylog2-server/commit/5d931293d9a9946dcc743d6a539af6facf957ad5", "message": "Use Array<HighlightingRules> instead of HighlightingRules[] for type definitions", "committedDate": "2020-06-15T10:12:40Z", "type": "commit"}, {"oid": "3bb1090d8ab14759615fdccdcfe84336115dafbe", "url": "https://github.com/Graylog2/graylog2-server/commit/3bb1090d8ab14759615fdccdcfe84336115dafbe", "message": "Implement CurrectUserContext for UserPreferencesProvider\n* Move CurrentUserProvider usage from App to LoggedInPage component", "committedDate": "2020-06-15T10:12:40Z", "type": "commit"}, {"oid": "88688f8fa71eed093e9d1f8c483eb2cc835d6a7a", "url": "https://github.com/Graylog2/graylog2-server/commit/88688f8fa71eed093e9d1f8c483eb2cc835d6a7a", "message": "Fixing linter errors", "committedDate": "2020-06-15T10:12:40Z", "type": "commit"}, {"oid": "cc14d9f68b2baf4b62c80ad6e11407f3cdf8c2ff", "url": "https://github.com/Graylog2/graylog2-server/commit/cc14d9f68b2baf4b62c80ad6e11407f3cdf8c2ff", "message": "Create separate app config file for tests with different default timezone", "committedDate": "2020-06-15T10:12:40Z", "type": "commit"}, {"oid": "29c043abf888c4db7962f2f92af690b5b145382a", "url": "https://github.com/Graylog2/graylog2-server/commit/29c043abf888c4db7962f2f92af690b5b145382a", "message": "Implement React.createRef for saved searches save button", "committedDate": "2020-06-15T10:13:11Z", "type": "commit"}, {"oid": "9028275a6b1bda330137a2f7693472f0f2614c98", "url": "https://github.com/Graylog2/graylog2-server/commit/9028275a6b1bda330137a2f7693472f0f2614c98", "message": "Mock SearchExecutionStateStore in ViewActionsMenu test", "committedDate": "2020-06-15T10:13:11Z", "type": "commit"}, {"oid": "9a57f4a268543cb7304e9fcc0c66a34a3d6f2a6b", "url": "https://github.com/Graylog2/graylog2-server/commit/9a57f4a268543cb7304e9fcc0c66a34a3d6f2a6b", "message": "Include ScrollToHint and ScretchPad in ReportedErrorBoundary", "committedDate": "2020-06-15T10:13:11Z", "type": "commit"}, {"oid": "b265cc1ea017e6ae92394f7cade6f8b38f9be0e0", "url": "https://github.com/Graylog2/graylog2-server/commit/b265cc1ea017e6ae92394f7cade6f8b38f9be0e0", "message": "Use ?? instead of || for highlighting rules check", "committedDate": "2020-06-15T10:13:47Z", "type": "commit"}, {"oid": "ad64d621b9c969c837d32236f820c7417e3dfbc9", "url": "https://github.com/Graylog2/graylog2-server/commit/ad64d621b9c969c837d32236f820c7417e3dfbc9", "message": "Use ?? instead of || for user timezone checks", "committedDate": "2020-06-15T10:13:48Z", "type": "commit"}, {"oid": "13765acf22c0b1d484f1e5236cfeb1d322da93bb", "url": "https://github.com/Graylog2/graylog2-server/commit/13765acf22c0b1d484f1e5236cfeb1d322da93bb", "message": "Use proper default prop for currentUser in ShareViewModal", "committedDate": "2020-06-15T10:13:48Z", "type": "commit"}, {"oid": "a71fcb2ec8490909479a9e5bd6aec527a6b0076b", "url": "https://github.com/Graylog2/graylog2-server/commit/a71fcb2ec8490909479a9e5bd6aec527a6b0076b", "message": "Use ?? instead of || for remaining user timezone checks", "committedDate": "2020-06-15T10:13:48Z", "type": "commit"}, {"oid": "230abe2313bb525d2afa7f3b429ec1f1bf353d27", "url": "https://github.com/Graylog2/graylog2-server/commit/230abe2313bb525d2afa7f3b429ec1f1bf353d27", "message": "Fixing rebase", "committedDate": "2020-06-15T10:14:39Z", "type": "commit"}, {"oid": "1fe3f70f68f44a20cec95e8cdf22cf4cb96645d3", "url": "https://github.com/Graylog2/graylog2-server/commit/1fe3f70f68f44a20cec95e8cdf22cf4cb96645d3", "message": "Fix import of CurrentUserContext in App.jsx", "committedDate": "2020-06-15T10:14:39Z", "type": "commit"}, {"oid": "4c3a77b22a78fc22222b6906121962e771467680", "url": "https://github.com/Graylog2/graylog2-server/commit/4c3a77b22a78fc22222b6906121962e771467680", "message": "Remove implementation of HighlightingRulesContext because it is part of another PR", "committedDate": "2020-06-15T10:17:35Z", "type": "commit"}, {"oid": "90370f86af420981f892ed172d845df93ad22c12", "url": "https://github.com/Graylog2/graylog2-server/commit/90370f86af420981f892ed172d845df93ad22c12", "message": "Test CurrentUserPreferencesProvider without provided CurrentUserContext", "committedDate": "2020-06-15T10:17:35Z", "type": "commit"}, {"oid": "4fd15911719bc2e096d01a0f96c760bdb4082658", "url": "https://github.com/Graylog2/graylog2-server/commit/4fd15911719bc2e096d01a0f96c760bdb4082658", "message": "Add missing HighlightingRulesProvider", "committedDate": "2020-06-15T10:24:13Z", "type": "commit"}, {"oid": "fd5a11a480488192e3bdcac1e92b56c886d0cf1d", "url": "https://github.com/Graylog2/graylog2-server/commit/fd5a11a480488192e3bdcac1e92b56c886d0cf1d", "message": "Updating snapshots and fixing SavedSearchControls access check", "committedDate": "2020-06-15T10:35:03Z", "type": "commit"}, {"oid": "fd5a11a480488192e3bdcac1e92b56c886d0cf1d", "url": "https://github.com/Graylog2/graylog2-server/commit/fd5a11a480488192e3bdcac1e92b56c886d0cf1d", "message": "Updating snapshots and fixing SavedSearchControls access check", "committedDate": "2020-06-15T10:35:03Z", "type": "forcePushed"}, {"oid": "4e30fd3ec29823fc2da372578314fa0462b27deb", "url": "https://github.com/Graylog2/graylog2-server/commit/4e30fd3ec29823fc2da372578314fa0462b27deb", "message": "Revert change for CustomHighlighting test", "committedDate": "2020-06-15T10:41:30Z", "type": "commit"}, {"oid": "52fc6ccc41c823a98727a5bae90516b4fc2426dc", "url": "https://github.com/Graylog2/graylog2-server/commit/52fc6ccc41c823a98727a5bae90516b4fc2426dc", "message": "Fix indentation for SavedSearchControls", "committedDate": "2020-06-15T10:42:07Z", "type": "commit"}, {"oid": "1aae927a6b5ee1442e3b89d0a08a505a1c61f796", "url": "https://github.com/Graylog2/graylog2-server/commit/1aae927a6b5ee1442e3b89d0a08a505a1c61f796", "message": "Fix linter warning for SavedSearchControls ref", "committedDate": "2020-06-15T10:48:50Z", "type": "commit"}, {"oid": "d74e46f0593b7db1d6ed6c0f0a4740fe4adbd78d", "url": "https://github.com/Graylog2/graylog2-server/commit/d74e46f0593b7db1d6ed6c0f0a4740fe4adbd78d", "message": "Reimplement HighlightingRulesProvider for ExtendedSearchPage", "committedDate": "2020-06-15T10:49:21Z", "type": "commit"}, {"oid": "d0048b2dc21358a8974515b94182cf352db2f46b", "url": "https://github.com/Graylog2/graylog2-server/commit/d0048b2dc21358a8974515b94182cf352db2f46b", "message": "Merge branch 'master' into message-table-connect-refactoring", "committedDate": "2020-06-22T10:32:42Z", "type": "commit"}, {"oid": "6f02cd9c997ecac5940336d5e9cab9afb977a3bd", "url": "https://github.com/Graylog2/graylog2-server/commit/6f02cd9c997ecac5940336d5e9cab9afb977a3bd", "message": "Replace global app config mocking with component specific mocking", "committedDate": "2020-06-22T15:59:42Z", "type": "commit"}]}