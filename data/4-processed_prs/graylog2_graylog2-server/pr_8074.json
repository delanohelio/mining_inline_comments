{"pr_number": 8074, "pr_title": "Query ace styles", "pr_createdAt": "2020-05-08T16:28:45Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/8074", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg0NTY3MQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/8074#discussion_r422845671", "bodyText": "The query input has a fixed width, without !important:", "author": "linuspahl", "createdAt": "2020-05-11T07:44:31Z", "path": "graylog2-web-interface/src/views/components/searchbar/queryinput/StyledAceEditor.jsx", "diffHunk": "@@ -8,9 +8,9 @@ const StyledAceEditor = styled(AceEditor).attrs(({ aceTheme, theme }) => ({\n   theme: aceTheme,\n   scTheme: theme,\n }))(({ scTheme }) => css`\n-  margin-top: 9px;\n-  height: 34px !important;\n-  width: 100% !important;\n+  height: 34px;\n+  line-height: 32px;\n+  width: 100%;", "originalCommit": "546552535340b182d1ee241fa9eb0a4ecab9425e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjg0ODQzNw==", "url": "https://github.com/Graylog2/graylog2-server/pull/8074#discussion_r422848437", "bodyText": "You could create lighten for the top and a darken function for the bottom block.", "author": "linuspahl", "createdAt": "2020-05-11T07:49:37Z", "path": "graylog2-web-interface/src/theme/variants/teinte.js", "diffHunk": "@@ -30,14 +30,24 @@ const variant = {\n   primary: '#702785',\n   success: '#00ae42',\n   warning: '#ffd200',\n+  lightest: {},\n+  lighter: {},\n+  light: {},\n+  dark: {},\n+  darker: {},\n+  darkest: {},\n };\n \n-const variantLight = {};\n-const variantDark = {};\n-\n Object.keys(variant).forEach((name) => {\n-  variantLight[name] = chroma(variant[name]).brighten(1).hex();\n-  variantDark[name] = chroma(variant[name]).darken(1.5).hex();\n+  if (typeof variant[name] === 'string') {\n+    variant.light[name] = chroma.mix(variant[name], '#fff', 0.15).hex();\n+    variant.lighter[name] = chroma.mix(variant[name], '#fff', 0.5).hex();\n+    variant.lightest[name] = chroma.mix(variant[name], '#fff', 0.85).hex();\n+\n+    variant.dark[name] = chroma.mix(variant[name], '#000', 0.15).hex();\n+    variant.darker[name] = chroma.mix(variant[name], '#000', 0.5).hex();\n+    variant.darkest[name] = chroma.mix(variant[name], '#000', 0.85).hex();", "originalCommit": "546552535340b182d1ee241fa9eb0a4ecab9425e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU0OTMwMg==", "url": "https://github.com/Graylog2/graylog2-server/pull/8074#discussion_r423549302", "bodyText": "@kyleknighted I like your changes regarding the highlight! While testing these changes, I noticed two problems with the autocomplete:\nDue to the new changes the autocomplete lost its top \"margin\":\n\nCompared with before (3.3 beta1):\n\nAnd as you can see in the screenshot the autocomplete has a larger width. While having a look at the described problem, I saw the   .ace_editor.ace_autocomplete { styling is no longer being included. This is not directly related to this PR, but could you have a look at it as well?", "author": "linuspahl", "createdAt": "2020-05-12T08:19:46Z", "path": "graylog2-web-interface/src/views/components/searchbar/queryinput/StyledAceEditor.jsx", "diffHunk": "@@ -8,140 +8,140 @@ const StyledAceEditor = styled(AceEditor).attrs(({ aceTheme, theme }) => ({\n   theme: aceTheme,\n   scTheme: theme,\n }))(({ scTheme }) => css`\n-  margin-top: 9px;\n-  height: 34px !important;\n-  width: 100% !important;\n-\n-  &.ace-queryinput .ace_gutter {\n-    background: ${scTheme.color.global.inputBackground};\n-    color: ${util.contrastingColor(scTheme.color.global.inputBackground, 'AAA')};\n-  }\n-\n-  &.ace-queryinput .ace_print-margin {\n-    width: 1px;\n-    background: ${scTheme.color.global.inputBackground};\n-  }\n-\n   &.ace-queryinput {\n+    height: 34px !important;\n+    width: 100% !important;\n     background-color: ${scTheme.color.global.inputBackground};\n     color: ${util.contrastingColor(scTheme.color.global.inputBackground, 'AAA')};\n-  }\n-\n-  &.ace-queryinput .ace_cursor {\n-    color: ${scTheme.color.gray[50]};\n-  }\n-\n-  &.ace-queryinput .ace_marker-layer .ace_selection {\n-    background: ${scTheme.color.variant.light.default};\n-  }\n-\n-  &.ace-queryinput.ace_multiselect .ace_selection.ace_start {\n-    box-shadow: 0 0 3px 0 ${scTheme.color.global.inputBackground};\n-  }\n-\n-  &.ace-queryinput .ace_marker-layer .ace_step {\n-    background: ${scTheme.color.variant.warning};\n-  }\n-\n-  &.ace-queryinput .ace_marker-layer .ace_bracket {\n-    margin: -1px 0 0 -1px;\n-    border: none;\n-  }\n-\n-  &.ace-queryinput .ace_marker-layer .ace_active-line {\n-    background: ${scTheme.color.global.inputBackground};\n-  }\n-\n-  &.ace-queryinput .ace_gutter-active-line {\n-    background-color: ${scTheme.color.global.inputBackground};\n-  }\n-\n-  &.ace-queryinput .ace_marker-layer .ace_selected-word {\n-    border: 1px solid ${scTheme.color.gray[80]};\n-  }\n-\n-  &.ace-queryinput .ace_invisible {\n-    color: ${scTheme.color.global.inputBackground};\n-  }\n-\n-  &.ace-queryinput .ace_keyword,\n-  &.ace-queryinput .ace_meta,\n-  &.ace-queryinput .ace_storage,\n-  &.ace-queryinput .ace_storage.ace_type,\n-  &.ace-queryinput .ace_support.ace_type {\n-    color: ${scTheme.color.variant.primary};\n-  }\n-\n-  &.ace-queryinput .ace_keyword.ace_operator {\n-    color: ${scTheme.color.variant.dark.info};\n-  }\n-\n-  &.ace-queryinput .ace_constant.ace_character,\n-  &.ace-queryinput .ace_constant.ace_language,\n-  &.ace-queryinput .ace_constant.ace_numeric,\n-  &.ace-queryinput .ace_keyword.ace_other.ace_unit,\n-  &.ace-queryinput .ace_support.ace_constant,\n-  &.ace-queryinput .ace_variable.ace_parameter {\n-    color: ${scTheme.color.variant.dark.danger};\n-  }\n-\n-  &.ace-queryinput .ace_constant.ace_other {\n-    color: ${scTheme.color.variant.default};\n-  }\n-\n-  &.ace-queryinput .ace_invalid {\n-    color: ${util.readableColor(scTheme.color.brand.primary)};\n-    background-color: ${scTheme.color.brand.primary};\n-  }\n-\n-  &.ace-queryinput .ace_invalid.ace_deprecated {\n-    color: ${util.readableColor(scTheme.color.brand.primary)};\n-    background-color: ${scTheme.color.variant.dark.primary};\n-  }\n-\n-  &.ace-queryinput .ace_fold {\n-    background-color: ${scTheme.color.variant.info};\n-    border-color: ${util.contrastingColor(scTheme.color.global.inputBackground, 'AAA')};\n-  }\n-\n-  &.ace-queryinput .ace_entity.ace_name.ace_function,\n-  &.ace-queryinput .ace_support.ace_function,\n-  &.ace-queryinput .ace_variable,\n-  &.ace-queryinput .ace_term {\n-    color: ${scTheme.color.variant.info};\n-  }\n-\n-  &.ace-queryinput .ace_support.ace_class,\n-  &.ace-queryinput .ace_support.ace_type {\n-    color: ${scTheme.color.variant.dark.warning};\n-  }\n-\n-  &.ace-queryinput .ace_heading,\n-  &.ace-queryinput .ace_markup.ace_heading,\n-  &.ace-queryinput .ace_string {\n-    color: ${scTheme.color.variant.dark.success};\n-  }\n-\n-  &.ace-queryinput .ace_entity.ace_name.ace_tag,\n-  &.ace-queryinput .ace_entity.ace_other.ace_attribute-name,\n-  &.ace-queryinput .ace_meta.ace_tag,\n-  &.ace-queryinput .ace_string.ace_regexp,\n-  &.ace-queryinput .ace_variable {\n-    color: ${scTheme.color.brand.primary};\n-  }\n-\n-  &.ace-queryinput .ace_comment {\n-    color: ${scTheme.color.gray[60]};\n-  }\n-\n-  .ace_placeholder {\n-    font-size: 16px;\n-    padding: 0 !important;\n-    font-family: inherit !important;\n-  }\n \n-  &.ace-queryinput .ace_indent-guide {\n-    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bdu3f/BwAlfgctduB85QAAAABJRU5ErkJggg==) right repeat-y;\n+    .ace_gutter {\n+      background: ${scTheme.color.global.inputBackground};\n+      color: ${util.contrastingColor(scTheme.color.global.inputBackground, 'AAA')};\n+    }\n+\n+    .ace_print-margin {\n+      width: 1px;\n+      background: ${scTheme.color.global.inputBackground};\n+    }\n+\n+    .ace_cursor {\n+      color: ${scTheme.color.gray[50]};\n+    }\n+\n+    .ace_marker-layer .ace_selection {\n+      background: ${scTheme.color.variant.lightest.default};\n+    }\n+\n+    &.ace_multiselect .ace_selection.ace_start {\n+      box-shadow: 0 0 3px 0 ${scTheme.color.global.inputBackground};\n+    }\n+\n+    .ace_marker-layer .ace_step {\n+      background: ${scTheme.color.variant.warning};\n+    }\n+\n+    .ace_marker-layer .ace_bracket {\n+      margin: -1px 0 0 -1px;\n+      border: none;\n+    }\n+\n+    .ace_marker-layer .ace_active-line {\n+      background: ${scTheme.color.global.inputBackground};\n+    }\n+\n+    .ace_gutter-active-line {\n+      background-color: ${scTheme.color.global.inputBackground};\n+    }\n+\n+    .ace_marker-layer .ace_selected-word {\n+      border: 1px solid ${scTheme.color.gray[80]};\n+    }\n+\n+    .ace_invisible {\n+      color: ${scTheme.color.global.inputBackground};\n+    }\n+\n+    .ace_keyword,\n+    .ace_meta,\n+    .ace_storage,\n+    .ace_storage.ace_type,\n+    .ace_support.ace_type {\n+      color: ${scTheme.color.variant.primary};\n+    }\n+\n+    .ace_keyword.ace_operator {\n+      color: ${scTheme.color.variant.darker.info};\n+    }\n+\n+    .ace_constant.ace_character,\n+    .ace_constant.ace_language,\n+    .ace_constant.ace_numeric,\n+    .ace_keyword.ace_other.ace_unit,\n+    .ace_support.ace_constant,\n+    .ace_variable.ace_parameter {\n+      color: ${scTheme.color.variant.dark.danger};\n+    }\n+\n+    .ace_constant.ace_other {\n+      color: ${scTheme.color.variant.default};\n+    }\n+\n+    .ace_invalid {\n+      color: ${util.readableColor(scTheme.color.brand.primary)};\n+      background-color: ${scTheme.color.brand.primary};\n+    }\n+\n+    .ace_invalid.ace_deprecated {\n+      color: ${util.readableColor(scTheme.color.brand.primary)};\n+      background-color: ${scTheme.color.variant.dark.primary};\n+    }\n+\n+    .ace_fold {\n+      background-color: ${scTheme.color.variant.info};\n+      border-color: ${util.contrastingColor(scTheme.color.global.inputBackground, 'AAA')};\n+    }\n+\n+    .ace_entity.ace_name.ace_function,\n+    .ace_support.ace_function,\n+    .ace_variable,\n+    .ace_term {\n+      color: ${scTheme.color.variant.info};\n+    }\n+\n+    .ace_support.ace_class,\n+    .ace_support.ace_type {\n+      color: ${scTheme.color.variant.dark.warning};\n+    }\n+\n+    .ace_heading,\n+    .ace_markup.ace_heading,\n+    .ace_string {\n+      color: ${scTheme.color.variant.dark.success};\n+    }\n+\n+    .ace_entity.ace_name.ace_tag,\n+    .ace_entity.ace_other.ace_attribute-name,\n+    .ace_meta.ace_tag,\n+    .ace_string.ace_regexp,\n+    .ace_variable {\n+      color: ${scTheme.color.brand.primary};\n+    }\n+\n+    .ace_comment {\n+      color: ${scTheme.color.gray[60]};\n+    }\n+\n+    .ace_indent-guide {\n+      background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bdu3f/BwAlfgctduB85QAAAABJRU5ErkJggg==) right repeat-y;\n+    }\n+\n+    .ace_content,\n+    .ace_placeholder {\n+      top: 6px;\n+      font-size: 16px;\n+      padding: 0 !important;\n+      font-family: inherit !important;\n+    }\n   }\n \n   .ace_editor.ace_autocomplete {", "originalCommit": "ed8b5972a5abdc60893023cc356e34ffb9f10706", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzkxMzc2NQ==", "url": "https://github.com/Graylog2/graylog2-server/pull/8074#discussion_r423913765", "bodyText": "got it fixed up", "author": "kyleknighted", "createdAt": "2020-05-12T17:36:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzU0OTMwMg=="}], "type": "inlineReview"}, {"oid": "44e69e86933ac56b865d8c5b8910409f7c0c50ba", "url": "https://github.com/Graylog2/graylog2-server/commit/44e69e86933ac56b865d8c5b8910409f7c0c50ba", "message": "Adding color variants", "committedDate": "2020-05-12T17:41:09Z", "type": "commit"}, {"oid": "19f7f02c761d8c1d44e6d476a39a1c144f2bc93e", "url": "https://github.com/Graylog2/graylog2-server/commit/19f7f02c761d8c1d44e6d476a39a1c144f2bc93e", "message": "Update Query input styles", "committedDate": "2020-05-12T17:41:09Z", "type": "commit"}, {"oid": "83e1c43d2269003f9c2540dbfe0a652c4319c096", "url": "https://github.com/Graylog2/graylog2-server/commit/83e1c43d2269003f9c2540dbfe0a652c4319c096", "message": "snapshots", "committedDate": "2020-05-12T17:41:10Z", "type": "commit"}, {"oid": "47a58532324c786698e73077c70aaab358fbcac7", "url": "https://github.com/Graylog2/graylog2-server/commit/47a58532324c786698e73077c70aaab358fbcac7", "message": "important styles", "committedDate": "2020-05-12T17:41:10Z", "type": "commit"}, {"oid": "a078d93ac28373b11183de0159b22bbaadf3c6a5", "url": "https://github.com/Graylog2/graylog2-server/commit/a078d93ac28373b11183de0159b22bbaadf3c6a5", "message": "Color funcs", "committedDate": "2020-05-12T17:41:10Z", "type": "commit"}, {"oid": "b82767db91cbd755e919b8aad2c8a50a890e396a", "url": "https://github.com/Graylog2/graylog2-server/commit/b82767db91cbd755e919b8aad2c8a50a890e396a", "message": "return colors", "committedDate": "2020-05-12T17:41:10Z", "type": "commit"}, {"oid": "16ff6a88d51b3bffcddf380505bcead991d46dff", "url": "https://github.com/Graylog2/graylog2-server/commit/16ff6a88d51b3bffcddf380505bcead991d46dff", "message": "cleanup styles", "committedDate": "2020-05-12T17:41:10Z", "type": "commit"}, {"oid": "4ca85d9e8ea8431d5d5cb74a39c08f59fc920a81", "url": "https://github.com/Graylog2/graylog2-server/commit/4ca85d9e8ea8431d5d5cb74a39c08f59fc920a81", "message": "autocomplete positioning", "committedDate": "2020-05-12T17:41:10Z", "type": "commit"}, {"oid": "4ca85d9e8ea8431d5d5cb74a39c08f59fc920a81", "url": "https://github.com/Graylog2/graylog2-server/commit/4ca85d9e8ea8431d5d5cb74a39c08f59fc920a81", "message": "autocomplete positioning", "committedDate": "2020-05-12T17:41:10Z", "type": "forcePushed"}]}