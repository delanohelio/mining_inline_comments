{"pr_number": 2632, "pr_title": "[DS-4409] Remove GeoIP download Ant target, reconfigure for external provision", "pr_createdAt": "2020-01-03T21:41:25Z", "pr_url": "https://github.com/DSpace/DSpace/pull/2632", "timeline": [{"oid": "e01838617524b91eb1c2620d1774cb44cce98a54", "url": "https://github.com/DSpace/DSpace/commit/e01838617524b91eb1c2620d1774cb44cce98a54", "message": "[DS-4409] Remove GeoIP download Ant target, reconfigure for external provision.", "committedDate": "2020-01-03T21:31:27Z", "type": "commit"}, {"oid": "692bbd9449e9f3da5adfa4fceb8925b670ceb7f2", "url": "https://github.com/DSpace/DSpace/commit/692bbd9449e9f3da5adfa4fceb8925b670ceb7f2", "message": "[DS-4409] Don't use live GeoLite database for testing -- there might not be one.", "committedDate": "2020-01-07T21:23:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI3MjI4Ng==", "url": "https://github.com/DSpace/DSpace/pull/2632#discussion_r364272286", "bodyText": "Just a quick note...is this a \"standard\" path where GeoLite2 tends to install itself?  If so, this is OK to preconfigure (though we may want to enhance the comments here to link back to GeoLite2 install docs, if plausible).  If there is no \"standard\" location for GeoLite2, I wonder if we should consider commenting this out by default (if that doesn't break things), to essentially force people to set this to an appropriate setting after they install GeoLite2.\nI guess I'm just trying to think about the most appropriate error message for folks to see here if things end up misconfigured.  Is it better to see a \"File not found\" (pointing at this path) error, or is there somewhere we can simply check if usage-statistics.dbfile is set...and if not, throw an error saying that it is \"required for Solr Statistics\" and that GeoLite2 must be installed.", "author": "tdonohue", "createdAt": "2020-01-08T14:56:21Z", "path": "dspace/config/modules/usage-statistics.cfg", "diffHunk": "@@ -1,13 +1,14 @@\n #---------------------------------------------------------------#\n #--------------USAGE STATISTICS CONFIGURATIONS------------------#\n #---------------------------------------------------------------#\n-# These configs are only used by the DSpace interfaces which    #\n-# track usage statistics (Solr)                                 #\n+# These properties are only used by the DSpace interfaces which #\n+# track usage statistics (Solr).                                #\n # See also: solr-statistics.cfg                                 #\n #---------------------------------------------------------------#\n \n-# The location for the Geo Database retrieved on update/installation\n-usage-statistics.dbfile = ${dspace.dir}/config/GeoLite2-City.mmdb\n+# The location for the database used to map client addresses to approximate\n+# physical locations.\n+usage-statistics.dbfile = /usr/share/GeoIP/GeoLite2-City.mmdb", "originalCommit": "692bbd9449e9f3da5adfa4fceb8925b670ceb7f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg5NTYzMA==", "url": "https://github.com/DSpace/DSpace/pull/2632#discussion_r364895630", "bodyText": "That is where MaxMind's updater places the databases on my development system, and it looks like a standard sort of place which I would expect to be used on any distro.  Of course it won't work on Windows.  So it might be best to comment out as you suggest, and make certain that DSpace gracefully recovers or gives a useful message if it is not configured.\nThe documentation does need updating, and I'll do that if/when this patch is merged.", "author": "mwoodiupui", "createdAt": "2020-01-09T18:32:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI3MjI4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTMyODM5MQ==", "url": "https://github.com/DSpace/DSpace/pull/2632#discussion_r365328391", "bodyText": "SolrLoggerServiceImpl logs a complaint and skips the calls to GeoIP if the database location is unconfigured.", "author": "mwoodiupui", "createdAt": "2020-01-10T16:47:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI3MjI4Ng=="}], "type": "inlineReview"}, {"oid": "ad03a9766033f6766bdaf30ce20e31777edd3606", "url": "https://github.com/DSpace/DSpace/commit/ad03a9766033f6766bdaf30ce20e31777edd3606", "message": "[DS04409] There is another set of mock/fake classes for dspace-server-webapp.  Activate them.", "committedDate": "2020-01-09T21:13:38Z", "type": "commit"}, {"oid": "aa4f2898c61d268329f13b3552c12dff1ec3e36b", "url": "https://github.com/DSpace/DSpace/commit/aa4f2898c61d268329f13b3552c12dff1ec3e36b", "message": "[DS-4409] Leave GeoLite database location unconfigured by default.", "committedDate": "2020-01-10T16:46:08Z", "type": "commit"}]}