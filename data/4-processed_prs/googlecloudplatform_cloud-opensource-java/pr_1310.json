{"pr_number": 1310, "pr_title": "BlockHound's VirtualMachine exclusion rule for JNA", "pr_createdAt": "2020-03-25T17:37:05Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310", "timeline": [{"oid": "4fcddde7fd21964bcc75f9ae23f747ce4b9a6997", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/4fcddde7fd21964bcc75f9ae23f747ce4b9a6997", "message": "BlockHound exclusion rule", "committedDate": "2020-03-25T17:40:20Z", "type": "commit"}, {"oid": "c7d34ef0b29a74b4962b7b7017bdef2a69d1d123", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c7d34ef0b29a74b4962b7b7017bdef2a69d1d123", "message": "Adding URL", "committedDate": "2020-03-25T17:40:20Z", "type": "commit"}, {"oid": "3d7f5c2d619f67b226c23312a216a76ee76e22e6", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/3d7f5c2d619f67b226c23312a216a76ee76e22e6", "message": "Reason", "committedDate": "2020-03-25T17:40:20Z", "type": "commit"}, {"oid": "3d7f5c2d619f67b226c23312a216a76ee76e22e6", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/3d7f5c2d619f67b226c23312a216a76ee76e22e6", "message": "Reason", "committedDate": "2020-03-25T17:40:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDA0Ng==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398054046", "bodyText": "Blockhound's --> Blockhound", "author": "elharo", "createdAt": "2020-03-25T17:51:45Z", "path": "dependencies/src/main/resources/linkage-checker-exclusion-default.xml", "diffHunk": "@@ -57,4 +57,18 @@\n       https://github.com/GoogleCloudPlatform/cloud-opensource-java/issues/407\n     </Reason>\n   </LinkageError>\n+  <LinkageError>\n+    <Target>\n+      <Package name=\"com.sun.jna\" />\n+    </Target>\n+    <Source>\n+      <Package name=\"reactor.blockhound.shaded.net.bytebuddy.agent.VirtualMachine\" />\n+    </Source>\n+    <Reason>\n+      BlockHound's shades ByteBuddy's VirtualMachine class. The class uses Java Native Access (JNA)", "originalCommit": "3d7f5c2d619f67b226c23312a216a76ee76e22e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA2MjMxNw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398062317", "bodyText": "Fixed", "author": "suztomo", "createdAt": "2020-03-25T18:03:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDA0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDQzOA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398054438", "bodyText": "If it's guarding the class, the rule above should reference the class (or classes) rather than a package.", "author": "elharo", "createdAt": "2020-03-25T17:52:24Z", "path": "dependencies/src/main/resources/linkage-checker-exclusion-default.xml", "diffHunk": "@@ -57,4 +57,18 @@\n       https://github.com/GoogleCloudPlatform/cloud-opensource-java/issues/407\n     </Reason>\n   </LinkageError>\n+  <LinkageError>\n+    <Target>\n+      <Package name=\"com.sun.jna\" />\n+    </Target>\n+    <Source>\n+      <Package name=\"reactor.blockhound.shaded.net.bytebuddy.agent.VirtualMachine\" />\n+    </Source>\n+    <Reason>\n+      BlockHound's shades ByteBuddy's VirtualMachine class. The class uses Java Native Access (JNA)\n+      only when the class is available by catching ClassNotFoundException. Therefore the invalid", "originalCommit": "3d7f5c2d619f67b226c23312a216a76ee76e22e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA2MjY5OA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398062698", "bodyText": "Updated this explanation to mention JNA package.", "author": "suztomo", "createdAt": "2020-03-25T18:04:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDQzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDUzNQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398054535", "bodyText": "should --> do", "author": "elharo", "createdAt": "2020-03-25T17:52:32Z", "path": "dependencies/src/main/resources/linkage-checker-exclusion-default.xml", "diffHunk": "@@ -57,4 +57,18 @@\n       https://github.com/GoogleCloudPlatform/cloud-opensource-java/issues/407\n     </Reason>\n   </LinkageError>\n+  <LinkageError>\n+    <Target>\n+      <Package name=\"com.sun.jna\" />\n+    </Target>\n+    <Source>\n+      <Package name=\"reactor.blockhound.shaded.net.bytebuddy.agent.VirtualMachine\" />\n+    </Source>\n+    <Reason>\n+      BlockHound's shades ByteBuddy's VirtualMachine class. The class uses Java Native Access (JNA)\n+      only when the class is available by catching ClassNotFoundException. Therefore the invalid\n+      references should not cause linkage errors at runtime.", "originalCommit": "3d7f5c2d619f67b226c23312a216a76ee76e22e6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA2MjQwNw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398062407", "bodyText": "Fixed", "author": "suztomo", "createdAt": "2020-03-25T18:03:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDUzNQ=="}], "type": "inlineReview"}, {"oid": "0b663993b55980a61a24f5bef3138aacfb56c28c", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/0b663993b55980a61a24f5bef3138aacfb56c28c", "message": "Applied review", "committedDate": "2020-03-25T18:02:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA2OTMzMw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398069333", "bodyText": "This sentence doesn't quite work. Perhaps break out \" by catching ClassNotFoundException\" into a sentence of its own that explains how the access is guarded, or just delete it.", "author": "elharo", "createdAt": "2020-03-25T18:14:28Z", "path": "dependencies/src/main/resources/linkage-checker-exclusion-default.xml", "diffHunk": "@@ -57,4 +57,19 @@\n       https://github.com/GoogleCloudPlatform/cloud-opensource-java/issues/407\n     </Reason>\n   </LinkageError>\n+  <LinkageError>\n+    <Target>\n+      <Package name=\"com.sun.jna\" />\n+    </Target>\n+    <Source>\n+      <Package name=\"reactor.blockhound.shaded.net.bytebuddy.agent.VirtualMachine\" />\n+    </Source>\n+    <Reason>\n+      BlockHound shades ByteBuddy's VirtualMachine class. The class uses Java Native Access (JNA)\n+      only when the com.sun.jna package is available by catching ClassNotFoundException. Therefore", "originalCommit": "0b663993b55980a61a24f5bef3138aacfb56c28c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA3MTI4Nw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398071287", "bodyText": "Right. Deleted \"by catching ...\".", "author": "suztomo", "createdAt": "2020-03-25T18:17:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA2OTMzMw=="}], "type": "inlineReview"}, {"oid": "a5834a4d4b7ed97d6b0effaad05ccbbb1c0fb823", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/a5834a4d4b7ed97d6b0effaad05ccbbb1c0fb823", "message": "removed 'by catching...'", "committedDate": "2020-03-25T18:16:11Z", "type": "commit"}, {"oid": "4028e65422fbfb83b72ec77b2d8176f0698e7adb", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/4028e65422fbfb83b72ec77b2d8176f0698e7adb", "message": "Merge remote-tracking branch 'origin/master' into blockhound_exclusion", "committedDate": "2020-03-25T19:04:39Z", "type": "commit"}]}