{"pr_number": 1653, "pr_title": "The Gradle plugin to use dependencies module through Maven local", "pr_createdAt": "2020-09-15T17:55:45Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653", "timeline": [{"oid": "9f8f5549ae1da2c5cd15601756613fe67436a46d", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/9f8f5549ae1da2c5cd15601756613fe67436a46d", "message": "Fixes #1651", "committedDate": "2020-09-15T17:51:52Z", "type": "commit"}, {"oid": "5cf147d31916e527c35dc2d655e85e580800c72f", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/5cf147d31916e527c35dc2d655e85e580800c72f", "message": "Removing old Gradle plugin's RELEASING.mdd", "committedDate": "2020-09-15T17:53:42Z", "type": "commit"}, {"oid": "473c8a8835b8c9dc9be3d5ba434c63ad4c6aa774", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/473c8a8835b8c9dc9be3d5ba434c63ad4c6aa774", "message": "Merge remote-tracking branch 'origin/master' into gradle_version", "committedDate": "2020-09-15T17:55:14Z", "type": "commit"}, {"oid": "5408442bfca7ca8c1e59d09f9f309dccb58af3c8", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/5408442bfca7ca8c1e59d09f9f309dccb58af3c8", "message": "doc", "committedDate": "2020-09-15T18:00:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2MDA2Mg==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653#discussion_r488860062", "bodyText": "Sed's -i takes an empty string to perform in-place change without creating a backup file.", "author": "suztomo", "createdAt": "2020-09-15T17:57:33Z", "path": "scripts/prepare_release.sh", "diffHunk": "@@ -76,23 +76,25 @@ if [[ \"${SUFFIX}\" = \"bom\" ]]; then\n   cd boms/cloud-oss-bom\n fi\n \n-if [[ \"${SUFFIX}\" = \"gradle\" ]]; then\n-  cd gradle-plugin\n-  # Changes the version for release and creates the commits/tags.\n-  echo | ./gradlew release -Prelease.releaseVersion=${VERSION} \\\n-      -Prelease.newVersion=${NEXT_SNAPSHOT}\n-else\n-  # Updates the pom.xml with the version to release.\n-  mvn versions:set versions:commit -DnewVersion=${VERSION} -DgenerateBackupPoms=false\n-  # Tags a new commit for this release.\n-  git commit -am \"preparing release ${VERSION}-${SUFFIX}\"\n-  git tag v${VERSION}-${SUFFIX}\n-  mvn versions:set versions:commit -DnewVersion=${NEXT_SNAPSHOT} -DgenerateBackupPoms=false\n-\n-  # Commits this next snapshot version.\n-  git commit -am \"${NEXT_SNAPSHOT}\"\n+# Updates the pom.xml with the version to release.\n+mvn versions:set versions:commit -DnewVersion=${VERSION} -DgenerateBackupPoms=false\n+\n+if [[ \"${SUFFIX}\" = \"dependencies\" ]]; then\n+  sed -i \"\" \"s/version = .*/version = ${VERSION}/\" gradle-plugin/gradle.properties", "originalCommit": "473c8a8835b8c9dc9be3d5ba434c63ad4c6aa774", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2MDQ0OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653#discussion_r488860449", "bodyText": "The gradle plugin's version and its dependencies module will have the same version.", "author": "suztomo", "createdAt": "2020-09-15T17:58:15Z", "path": "gradle-plugin/gradle.properties", "diffHunk": "@@ -1 +1,2 @@\n-version = 1.0.2-SNAPSHOT\n+# scripts/prepare_release.sh maintains this value.\n+version = 1.5.3-SNAPSHOT", "originalCommit": "473c8a8835b8c9dc9be3d5ba434c63ad4c6aa774", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0efc6febcc05cfca43c577c5bb14ea6aff1849b3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/0efc6febcc05cfca43c577c5bb14ea6aff1849b3", "message": "install in Circle CI", "committedDate": "2020-09-15T18:54:18Z", "type": "commit"}, {"oid": "604b1aa37e0fa96ca06537ca1055ee79e5d22ee2", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/604b1aa37e0fa96ca06537ca1055ee79e5d22ee2", "message": "Instruction to build Maven projects first", "committedDate": "2020-09-15T19:37:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk0MzY0Nw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653#discussion_r488943647", "bodyText": "the local Maven repository", "author": "elharo", "createdAt": "2020-09-15T20:09:40Z", "path": "gradle-plugin/README.md", "diffHunk": "@@ -4,7 +4,14 @@ For usage of this plugin, see the documentation.\n \n # Build Instruction\n \n+This Gradle project depends on the `dependencies` module through the Maven local repository.\n+\n ```\n+# At the root of the cloud-opensource-java project, first install the Maven projects to Maven local", "originalCommit": "604b1aa37e0fa96ca06537ca1055ee79e5d22ee2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk2MDY0MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653#discussion_r488960641", "bodyText": "Updated", "author": "suztomo", "createdAt": "2020-09-15T20:42:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk0MzY0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk0NDMzNg==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653#discussion_r488944336", "bodyText": "indent four spaces for code", "author": "elharo", "createdAt": "2020-09-15T20:10:57Z", "path": "gradle-plugin/README.md", "diffHunk": "@@ -4,7 +4,14 @@ For usage of this plugin, see the documentation.\n \n # Build Instruction\n \n+This Gradle project depends on the `dependencies` module through the Maven local repository.\n+\n ```\n+# At the root of the cloud-opensource-java project, first install the Maven projects to Maven local\n+# repository.\n+$ mvn install", "originalCommit": "604b1aa37e0fa96ca06537ca1055ee79e5d22ee2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk2MDYwMw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653#discussion_r488960603", "bodyText": "Done with 3-space indentation (as in boms/cloud-oss-bom/RELEASING.md; 4-space didn't work in GitHub's markdown viewer.)", "author": "suztomo", "createdAt": "2020-09-15T20:41:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODk0NDMzNg=="}], "type": "inlineReview"}, {"oid": "e3c3f6a0ef9ef95386540c2f12ea8c34b5728fa0", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/e3c3f6a0ef9ef95386540c2f12ea8c34b5728fa0", "message": "the Maven local repository", "committedDate": "2020-09-15T20:38:51Z", "type": "commit"}, {"oid": "1d5509339aec0f3228f29270eaa9ef15cb80bfac", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/1d5509339aec0f3228f29270eaa9ef15cb80bfac", "message": "Indent code block", "committedDate": "2020-09-15T20:41:46Z", "type": "commit"}, {"oid": "c76cc2782580c1173350e5d749d0552aa468f26b", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c76cc2782580c1173350e5d749d0552aa468f26b", "message": "3-space", "committedDate": "2020-09-15T20:44:15Z", "type": "commit"}, {"oid": "93c689482c70b2414573574b8809b70eb8f672d4", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/93c689482c70b2414573574b8809b70eb8f672d4", "message": "Gradle plugin release script needs to install Maven projects", "committedDate": "2020-09-15T20:59:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5MDk3Mg==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653#discussion_r489390972", "bodyText": "the local Maven", "author": "elharo", "createdAt": "2020-09-16T12:17:54Z", "path": "gradle-plugin/README.md", "diffHunk": "@@ -4,24 +4,35 @@ For usage of this plugin, see the documentation.\n \n # Build Instruction\n \n-```\n-$ cd gradle-plugin\n-$ ./gradlew build publishToMavenLocal\n-```\n+This Gradle project depends on the `dependencies` module through the Maven local repository.\n \n-This command installs the Linkage Checker Gradle plugin in Maven local repository.\n+At the root of the cloud-opensource-java project, first install the Maven projects to the local\n+Maven repository:\n+\n+   ```\n+   $ mvn install\n+   ```\n+\n+Then build this Gradle project:\n \n-```\n-suztomo-macbookpro44% ls ~/.m2/repository/com/google/cloud/tools/linkage-checker-gradle-plugin/0.1.0-SNAPSHOT/\n-linkage-checker-gradle-plugin-0.1.0-SNAPSHOT.jar\n-linkage-checker-gradle-plugin-0.1.0-SNAPSHOT.pom\n-```\n+   ```\n+   $ cd gradle-plugin\n+   $ ./gradlew build publishToMavenLocal\n+   ```\n+\n+This command installs the Linkage Checker Gradle plugin in Maven local repository.", "originalCommit": "93c689482c70b2414573574b8809b70eb8f672d4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQyOTEzOA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1653#discussion_r489429138", "bodyText": "Updated.", "author": "suztomo", "createdAt": "2020-09-16T13:17:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM5MDk3Mg=="}], "type": "inlineReview"}, {"oid": "f61431b8c619bcd6786b83a3478b1476253da192", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/f61431b8c619bcd6786b83a3478b1476253da192", "message": "the local Maven repository", "committedDate": "2020-09-16T13:17:42Z", "type": "commit"}]}