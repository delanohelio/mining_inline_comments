{"pr_number": 1493, "pr_title": "Don't follow transitive optional dependencies", "pr_createdAt": "2020-06-22T22:39:54Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1493", "timeline": [{"oid": "d918e5111895397d2b4183080141b860bee4b71f", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/d918e5111895397d2b4183080141b860bee4b71f", "message": "build verbose rather than full classpath", "committedDate": "2020-06-22T21:25:15Z", "type": "commit"}, {"oid": "c42da8192349a24d692c31daa51fd34ec0a5e2c3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c42da8192349a24d692c31daa51fd34ec0a5e2c3", "message": "build verbose rather than full classpath", "committedDate": "2020-06-22T22:39:07Z", "type": "commit"}, {"oid": "481c3582f70716a55747a74e7e4c227c8a15f4b0", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/481c3582f70716a55747a74e7e4c227c8a15f4b0", "message": "mark method non-public", "committedDate": "2020-06-22T22:40:38Z", "type": "commit"}, {"oid": "7fd4986b909897f2e30980ab20c691dd0e7b7630", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/7fd4986b909897f2e30980ab20c691dd0e7b7630", "message": "revert last change", "committedDate": "2020-06-22T22:42:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMTY3NA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1493#discussion_r443921674", "bodyText": "This change does not affect Linkage Check column in the dashboard. If you want to change the Linkage Checker's class path, you need to update code around line 184:\n  private static Path generate(Bom bom) throws IOException, TemplateException, URISyntaxException {\n\n    ImmutableList<Artifact> managedDependencies = bom.getManagedDependencies();\n\n    ClassPathResult classPathResult = classPathBuilder.resolve(managedDependencies);\n    ImmutableList<ClassPathEntry> classpath = classPathResult.getClassPath();\n\n    LinkageChecker linkageChecker = LinkageChecker.create(classpath);\n...", "author": "suztomo", "createdAt": "2020-06-23T02:11:02Z", "path": "dashboard/src/main/java/com/google/cloud/tools/opensource/dashboard/DashboardMain.java", "diffHunk": "@@ -312,7 +312,7 @@ private static ArtifactCache loadArtifactInfo(List<Artifact> artifacts) {\n \n     for (Artifact artifact : artifacts) {\n       DependencyGraph completeDependencies =\n-          dependencyGraphBuilder.buildFullDependencyGraph(ImmutableList.of(artifact));\n+          dependencyGraphBuilder.buildVerboseDependencyGraph(artifact);", "originalCommit": "7fd4986b909897f2e30980ab20c691dd0e7b7630", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDQzMzc0NA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1493#discussion_r444433744", "bodyText": "I just checked buildVerboseDependencyGraph for com.google.http-client:google-http-client:jar:1.35.0 only. It generates additional linkage errors for the missing classes in the optional dependencies.", "author": "suztomo", "createdAt": "2020-06-23T18:45:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMTY3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgyMzYwOQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1493#discussion_r444823609", "bodyText": "This is interesting. Two of those might be true positives but I need to investigate. I wonder how this class is guarding those usages?", "author": "elharo", "createdAt": "2020-06-24T11:20:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMTY3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg1ODg5NQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1493#discussion_r444858895", "bodyText": "After looking into commons-logging I think:\n\nThose are unlikely to come up in practice but are true positives.\nNo one should depend on Commons-logging for multiple reasons, including that it does not properly guard usage of its optional dependencies.\n\nThis does add weight to your idea about distinguishing linkage errors caused by dependency conflicts from linkage errors caused by missing optional dependencies.", "author": "elharo", "createdAt": "2020-06-24T12:31:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzkyMTY3NA=="}], "type": "inlineReview"}, {"oid": "f3f6edfcfd9dd9e1268f5ed9ddbd75adc395a6db", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/f3f6edfcfd9dd9e1268f5ed9ddbd75adc395a6db", "message": "Merge branch 'master' into opt", "committedDate": "2020-06-24T11:07:00Z", "type": "commit"}, {"oid": "985d1a41d20d30de589253804ff85c3878166397", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/985d1a41d20d30de589253804ff85c3878166397", "message": "Merge branch 'master' into opt", "committedDate": "2020-06-30T13:54:22Z", "type": "commit"}, {"oid": "64d40b8ebe897b2e9e26a1afcaeafe62206a2f16", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/64d40b8ebe897b2e9e26a1afcaeafe62206a2f16", "message": "Merge branch 'master' into opt", "committedDate": "2020-06-30T15:02:27Z", "type": "commit"}, {"oid": "c3a7ad315909163ad3f9c4205115be01384e3ac2", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c3a7ad315909163ad3f9c4205115be01384e3ac2", "message": "Merge branch 'master' into opt", "committedDate": "2020-06-30T15:19:40Z", "type": "commit"}, {"oid": "19c3c7ee0bcc5cbcd0bc30ba25a4f4b77e071a10", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/19c3c7ee0bcc5cbcd0bc30ba25a4f4b77e071a10", "message": "update characterizaton test", "committedDate": "2020-06-30T16:31:29Z", "type": "commit"}]}