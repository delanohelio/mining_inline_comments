{"pr_number": 1762, "pr_title": "Shading often corrupts non-code metadata in META-INF/MANIFEST.mf", "pr_createdAt": "2020-10-29T14:39:40Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762", "timeline": [{"oid": "bee1a4ab8875e9f3b8c42a08ed3a926d0486c68f", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/bee1a4ab8875e9f3b8c42a08ed3a926d0486c68f", "message": "Shading often corrupts non-code metadata in META-INF/MANIFEST.mf\n\n@suztomo Inspired by https://github.com/googleapis/gax-java/issues/1207", "committedDate": "2020-10-29T14:39:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMjY0Ng==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r514322646", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              for every jar.\n          \n          \n            \n              for every JAR file.\n          \n      \n    \n    \n  \n\nhttps://docs.oracle.com/javase/tutorial/deployment/jar/basicsindex.html\n\"JAR\" for the files. \"jar\" for the command.", "author": "suztomo", "createdAt": "2020-10-29T14:54:21Z", "path": "docs/JLBP-0018.md", "diffHunk": "@@ -22,7 +22,8 @@ There are a number of problems with shading:\n   to also roll in the security fix).\n - Shading cannot be performed on types used in a library's own public API as return\n   types or method arguments.\n-- Service entries under `META-INF/services` can easily be messed up. They need\n+- Shading often corrupts non-code metadata in META-INF/MANIFEST.mf and other locations.\n+  For instance, service entries under `META-INF/services` can easily need\n   special effort to be merged because the entries are located in the same place\n   for every jar.", "originalCommit": "bee1a4ab8875e9f3b8c42a08ed3a926d0486c68f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM3MzI1MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r514373251", "bodyText": "done", "author": "elharo", "createdAt": "2020-10-29T15:57:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMjY0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMjg5MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r514322891", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - Shading often corrupts non-code metadata in META-INF/MANIFEST.mf and other locations.\n          \n          \n            \n            - Shading often corrupts non-code metadata in META-INF/MANIFEST.mf and other files.\n          \n      \n    \n    \n  \n\nI think you meant \"files in other locations.\" This is the same as \"other files\".", "author": "suztomo", "createdAt": "2020-10-29T14:54:38Z", "path": "docs/JLBP-0018.md", "diffHunk": "@@ -22,7 +22,8 @@ There are a number of problems with shading:\n   to also roll in the security fix).\n - Shading cannot be performed on types used in a library's own public API as return\n   types or method arguments.\n-- Service entries under `META-INF/services` can easily be messed up. They need\n+- Shading often corrupts non-code metadata in META-INF/MANIFEST.mf and other locations.", "originalCommit": "bee1a4ab8875e9f3b8c42a08ed3a926d0486c68f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyODcxNA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r514328714", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - Shading often corrupts non-code metadata in META-INF/MANIFEST.mf and other locations.\n          \n          \n            \n            - Shading often corrupts non-code metadata in the files under `META-INF`, such as `META-INF/MANIFEST.mf` and `META-INF/services`.", "author": "suztomo", "createdAt": "2020-10-29T15:01:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMjg5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM3MTYyOA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r514371628", "bodyText": "locations is correct, not files. There can be locations inside a JAR file.", "author": "elharo", "createdAt": "2020-10-29T15:55:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMjg5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3Mjg5NQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r515272895", "bodyText": "That's right. It's \"non-code metadata in ... other locations\".", "author": "suztomo", "createdAt": "2020-10-30T17:42:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMjg5MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyNTc2OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r514325769", "bodyText": "\"can easily need special effort to be merged\" is difficult to read. Can you make it active voice?", "author": "suztomo", "createdAt": "2020-10-29T14:58:00Z", "path": "docs/JLBP-0018.md", "diffHunk": "@@ -22,7 +22,8 @@ There are a number of problems with shading:\n   to also roll in the security fix).\n - Shading cannot be performed on types used in a library's own public API as return\n   types or method arguments.\n-- Service entries under `META-INF/services` can easily be messed up. They need\n+- Shading often corrupts non-code metadata in META-INF/MANIFEST.mf and other locations.\n+  For instance, service entries under `META-INF/services` can easily need\n   special effort to be merged because the entries are located in the same place", "originalCommit": "bee1a4ab8875e9f3b8c42a08ed3a926d0486c68f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM3Mjk0NA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r514372944", "bodyText": "improved", "author": "elharo", "createdAt": "2020-10-29T15:56:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyNTc2OQ=="}], "type": "inlineReview"}, {"oid": "2890c56a302f3fec63b7f8c33c62372d2836081c", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/2890c56a302f3fec63b7f8c33c62372d2836081c", "message": "review", "committedDate": "2020-10-29T15:57:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3Mzc1Nw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r515273757", "bodyText": "(minor) Not every JAR file has META-INF/services.", "author": "suztomo", "createdAt": "2020-10-30T17:43:34Z", "path": "docs/JLBP-0018.md", "diffHunk": "@@ -22,9 +22,10 @@ There are a number of problems with shading:\n   to also roll in the security fix).\n - Shading cannot be performed on types used in a library's own public API as return\n   types or method arguments.\n-- Service entries under `META-INF/services` can easily be messed up. They need\n-  special effort to be merged because the entries are located in the same place\n-  for every jar.\n+- Shading often corrupts non-code metadata in META-INF/MANIFEST.mf and other locations.\n+  For instance, service entries under `META-INF/services` are hard \n+  to merge because the entries are located in the same place\n+  for every JAR file.", "originalCommit": "2890c56a302f3fec63b7f8c33c62372d2836081c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTMwNzU5Mw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1762#discussion_r515307593", "bodyText": "Yes, that's one example of the sorts of problems that can happen. Not every shading will have this problem, or indeed any problem with metadata, but it can crop up.", "author": "elharo", "createdAt": "2020-10-30T18:43:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3Mzc1Nw=="}], "type": "inlineReview"}, {"oid": "577225563e3c5ad36a1eb198bcd46b39c930ffd3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/577225563e3c5ad36a1eb198bcd46b39c930ffd3", "message": "Merge branch 'master' into elharo-patch-6", "committedDate": "2020-10-30T18:42:31Z", "type": "commit"}, {"oid": "ddc97db64484dff94196f7cae7b3dfec46221b78", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/ddc97db64484dff94196f7cae7b3dfec46221b78", "message": "Merge branch 'master' into elharo-patch-6", "committedDate": "2020-11-03T17:24:13Z", "type": "commit"}]}