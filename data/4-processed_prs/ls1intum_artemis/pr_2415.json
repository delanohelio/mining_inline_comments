{"pr_number": 2415, "pr_title": "[Enhancement] Align buttons in some Views and add lock mechanism for Programming Assessment and some refactoring", "pr_createdAt": "2020-11-17T08:06:50Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2415", "timeline": [{"oid": "e039e4bb6061327b4516b2984b839e8419e24e79", "url": "https://github.com/ls1intum/Artemis/commit/e039e4bb6061327b4516b2984b839e8419e24e79", "message": "rename file", "committedDate": "2020-11-14T06:48:31Z", "type": "commit"}, {"oid": "5df3408ed914393c324c908b6cf7b8b39fa4d59f", "url": "https://github.com/ls1intum/Artemis/commit/5df3408ed914393c324c908b6cf7b8b39fa4d59f", "message": "use same buttons as other exercise types and use resolver for locking (locking is not enabled yet)", "committedDate": "2020-11-14T11:58:00Z", "type": "commit"}, {"oid": "325274ef7c01183ecb312a28ad46abc61eaa063e", "url": "https://github.com/ls1intum/Artemis/commit/325274ef7c01183ecb312a28ad46abc61eaa063e", "message": "add locking functionality to server calls", "committedDate": "2020-11-14T11:58:44Z", "type": "commit"}, {"oid": "ef8afa616bb71fc21ac58a98f2ab3a335935527b", "url": "https://github.com/ls1intum/Artemis/commit/ef8afa616bb71fc21ac58a98f2ab3a335935527b", "message": "make it work also for new assessments", "committedDate": "2020-11-14T12:35:22Z", "type": "commit"}, {"oid": "76a82b2dfe63d7ba258aeef759379324faf1191a", "url": "https://github.com/ls1intum/Artemis/commit/76a82b2dfe63d7ba258aeef759379324faf1191a", "message": "try to make locking work for programming exercises", "committedDate": "2020-11-14T18:48:51Z", "type": "commit"}, {"oid": "df118e3a58deab2d4a8d6e2531f3c417afbc822b", "url": "https://github.com/ls1intum/Artemis/commit/df118e3a58deab2d4a8d6e2531f3c417afbc822b", "message": "add check and enable lock also for next submission and set result always rated", "committedDate": "2020-11-15T10:31:02Z", "type": "commit"}, {"oid": "032b7f42fa5c343f948953a14e324cf446a56a1f", "url": "https://github.com/ls1intum/Artemis/commit/032b7f42fa5c343f948953a14e324cf446a56a1f", "message": "use same buttons for team assessment and also for scores page", "committedDate": "2020-11-15T10:31:56Z", "type": "commit"}, {"oid": "d0f96da2acf79734a6b81f2982a419b888eb8a24", "url": "https://github.com/ls1intum/Artemis/commit/d0f96da2acf79734a6b81f2982a419b888eb8a24", "message": "fix issue with router link and naming of button + run spotless", "committedDate": "2020-11-15T21:03:41Z", "type": "commit"}, {"oid": "937078ce9e3b84fb6553bba2ffbfce38ef450827", "url": "https://github.com/ls1intum/Artemis/commit/937078ce9e3b84fb6553bba2ffbfce38ef450827", "message": "delete not used component", "committedDate": "2020-11-15T21:59:42Z", "type": "commit"}, {"oid": "d153d0e46bb0272b2c70a7cc120248b42cf0987a", "url": "https://github.com/ls1intum/Artemis/commit/d153d0e46bb0272b2c70a7cc120248b42cf0987a", "message": "copy the feedbacks during the lock into the new result.\nremove import", "committedDate": "2020-11-15T23:55:48Z", "type": "commit"}, {"oid": "37e7c97ded58d849a56b088987c9486cc27c4d00", "url": "https://github.com/ls1intum/Artemis/commit/37e7c97ded58d849a56b088987c9486cc27c4d00", "message": "fix issue with copying the automatic feedback and change save/submit call as it is always ensured to have a manual result in the database", "committedDate": "2020-11-16T05:36:30Z", "type": "commit"}, {"oid": "3398eba135215314d8d10adf8a360b1f2f8bb826", "url": "https://github.com/ls1intum/Artemis/commit/3398eba135215314d8d10adf8a360b1f2f8bb826", "message": "refactor to avoid not needed calls as automatic feedback is already included in manual feedback when locking the assessment", "committedDate": "2020-11-16T08:36:32Z", "type": "commit"}, {"oid": "6ba7d468d56dc176f8bbb4279eec2c804560e39d", "url": "https://github.com/ls1intum/Artemis/commit/6ba7d468d56dc176f8bbb4279eec2c804560e39d", "message": "fix cancel assessment and issue with no result string when creating manual result during the lock", "committedDate": "2020-11-16T11:40:51Z", "type": "commit"}, {"oid": "358baa55cbd51ff6b0564d476e764d863a62e03e", "url": "https://github.com/ls1intum/Artemis/commit/358baa55cbd51ff6b0564d476e764d863a62e03e", "message": "removed commented out code and display view submission button in exercise score only when a manual result is available", "committedDate": "2020-11-16T12:11:00Z", "type": "commit"}, {"oid": "6d045e6ec1e7b320deab153f6598be4331796c4a", "url": "https://github.com/ls1intum/Artemis/commit/6d045e6ec1e7b320deab153f6598be4331796c4a", "message": "make sure that route for new assessment is triggered", "committedDate": "2020-11-16T20:07:52Z", "type": "commit"}, {"oid": "2b257cee86333234d363246c32c9d4af1bf74a42", "url": "https://github.com/ls1intum/Artemis/commit/2b257cee86333234d363246c32c9d4af1bf74a42", "message": "add info about locklimit when reached", "committedDate": "2020-11-16T20:09:55Z", "type": "commit"}, {"oid": "ef5ca7ac391190fafbe83d9a3ff7ba56c4a4abf3", "url": "https://github.com/ls1intum/Artemis/commit/ef5ca7ac391190fafbe83d9a3ff7ba56c4a4abf3", "message": "improve error handling for team assessment", "committedDate": "2020-11-16T21:03:45Z", "type": "commit"}, {"oid": "a4c3b53aee2d437bbc22391301a92e9b3863e1d9", "url": "https://github.com/ls1intum/Artemis/commit/a4c3b53aee2d437bbc22391301a92e9b3863e1d9", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard", "committedDate": "2020-11-16T21:05:26Z", "type": "commit"}, {"oid": "fcff484772dbb205f716e1695fec59ffb650e6ba", "url": "https://github.com/ls1intum/Artemis/commit/fcff484772dbb205f716e1695fec59ffb650e6ba", "message": "rename to view assessment + add lock limit to 2 for testing", "committedDate": "2020-11-17T07:53:55Z", "type": "commit"}, {"oid": "4810cc1cd80689daf9106f8de5e6a2cc79be5f1a", "url": "https://github.com/ls1intum/Artemis/commit/4810cc1cd80689daf9106f8de5e6a2cc79be5f1a", "message": "fix server tests", "committedDate": "2020-11-17T12:29:07Z", "type": "commit"}, {"oid": "f6b9a84a9e96b70806b9d033d4cefe77f283841c", "url": "https://github.com/ls1intum/Artemis/commit/f6b9a84a9e96b70806b9d033d4cefe77f283841c", "message": "add tests", "committedDate": "2020-11-17T19:45:49Z", "type": "commit"}, {"oid": "08c15eb1fb18dbd6dbbb9cbbb5096d52257b711d", "url": "https://github.com/ls1intum/Artemis/commit/08c15eb1fb18dbd6dbbb9cbbb5096d52257b711d", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard", "committedDate": "2020-11-17T19:46:04Z", "type": "commit"}, {"oid": "e77a55ce63e8e98b16474f1009c6ab0bd4657f34", "url": "https://github.com/ls1intum/Artemis/commit/e77a55ce63e8e98b16474f1009c6ab0bd4657f34", "message": "fix client tests", "committedDate": "2020-11-17T21:32:15Z", "type": "commit"}, {"oid": "75c4457e82feb0829f19dfe84e2c47d8f84916ff", "url": "https://github.com/ls1intum/Artemis/commit/75c4457e82feb0829f19dfe84e2c47d8f84916ff", "message": "Merge branch 'develop' into enhancement/programming-assessment/align-button-assessment-dashboard", "committedDate": "2020-11-17T21:51:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU1MzA0Nw==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525553047", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Get a file upload submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.\n          \n          \n            \n                 * Get a programming exercise submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.", "author": "kloessst", "createdAt": "2020-11-17T22:00:08Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingSubmissionService.java", "diffHunk": "@@ -634,4 +633,42 @@ public ProgrammingSubmission findByIdWithEagerResultAndFeedback(long submissionI\n         return programmingSubmissionRepository.findWithEagerResultAssessorFeedbackById(submissionId)\n                 .orElseThrow(() -> new EntityNotFoundException(\"Programming submission with id \\\"\" + submissionId + \"\\\" does not exist\"));\n     }\n+\n+    /**\n+     * Get a file upload submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.", "originalCommit": "75c4457e82feb0829f19dfe84e2c47d8f84916ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU1NTAwMQ==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525555001", "bodyText": "Good eyes!", "author": "fde312", "createdAt": "2020-11-17T22:04:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU1MzA0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU1NTY0Mw==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525555643", "bodyText": "I'd rename the variable to manualResult if because the statement just looks for the first manual result. I guess this is fine because only one manual result can exist now.", "author": "kloessst", "createdAt": "2020-11-17T22:05:11Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingAssessmentResource.java", "diffHunk": "@@ -120,13 +118,11 @@ public ProgrammingAssessmentResource(AuthorizationCheckService authCheckService,\n \n         User user = userService.getUserWithGroupsAndAuthorities();\n \n-        Optional<Result> latestExistingResult = participation.getResults().stream().filter(result -> result.isManualResult()).findFirst();\n-        if (latestExistingResult.isPresent()) {\n-            // prevent that tutors create multiple manual results\n-            newResult.setId(latestExistingResult.get().getId());\n-            // load assessor\n-            latestExistingResult = resultRepository.findWithEagerSubmissionAndFeedbackAndAssessorById(latestExistingResult.get().getId());\n-        }\n+        Result latestExistingResult = participation.getResults().stream().filter(result -> result.isManualResult()).findFirst().get();", "originalCommit": "75c4457e82feb0829f19dfe84e2c47d8f84916ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYxNTk1NQ==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525615955", "bodyText": "Done", "author": "fde312", "createdAt": "2020-11-18T00:30:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU1NTY0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU2NzE3OA==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525567178", "bodyText": "Is this call necessary? latestExistingResult should already have an safe submission fetched from the DB.", "author": "kloessst", "createdAt": "2020-11-17T22:28:27Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingAssessmentResource.java", "diffHunk": "@@ -168,18 +164,9 @@ else if (!newResult.getFeedbacks().isEmpty() && newResult.getFeedbacks().stream(\n             throw new BadRequestAlertException(\"In case feedback is present, a feedback must contain points.\", ENTITY_NAME, \"feedbackCreditsNull\");\n         }\n \n-        ProgrammingSubmission submission;\n-        if (latestExistingResult.isEmpty()) {\n-            // Create manual submission with last commit hash and current time stamp.\n-            submission = programmingSubmissionService.createSubmissionWithLastCommitHashForParticipation((ProgrammingExerciseStudentParticipation) participation,\n-                    SubmissionType.MANUAL);\n-            newResult.setSubmission(submission);\n-        }\n-        else {\n-            submission = programmingSubmissionService.findByIdWithEagerResultAndFeedback(latestExistingResult.get().getSubmission().getId());\n-            newResult.setSubmission(submission);\n-        }\n-\n+        // make sure that the submission cannot be manipulated on the client side\n+        ProgrammingSubmission submission = programmingSubmissionService.findByIdWithEagerResultAndFeedback(latestExistingResult.getSubmission().getId());", "originalCommit": "75c4457e82feb0829f19dfe84e2c47d8f84916ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU2NzYzNA==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525567634", "bodyText": "Add param lockSubmission to JavaDoc", "author": "kloessst", "createdAt": "2020-11-17T22:29:29Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingSubmissionResource.java", "diffHunk": "@@ -355,7 +355,8 @@ public ProgrammingSubmissionResource(ProgrammingSubmissionService programmingSub\n      */\n     @GetMapping(value = \"/exercises/{exerciseId}/programming-submission-without-assessment\")\n     @PreAuthorize(\"hasAnyRole('TA', 'INSTRUCTOR', 'ADMIN')\")\n-    public ResponseEntity<ProgrammingSubmission> getProgrammingSubmissionWithoutAssessment(@PathVariable Long exerciseId) {\n+    public ResponseEntity<ProgrammingSubmission> getProgrammingSubmissionWithoutAssessment(@PathVariable Long exerciseId,\n+            @RequestParam(value = \"lock\", defaultValue = \"false\") boolean lockSubmission) {", "originalCommit": "75c4457e82feb0829f19dfe84e2c47d8f84916ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU5OTQ4OA==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525599488", "bodyText": "Done", "author": "fde312", "createdAt": "2020-11-17T23:44:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU2NzYzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU2ODA2OQ==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525568069", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n                    // final ProgrammingSubmission programmingSubmission = optionalProgrammingSubmission.get();", "author": "kloessst", "createdAt": "2020-11-17T22:30:19Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingSubmissionResource.java", "diffHunk": "@@ -369,14 +370,24 @@ public ProgrammingSubmissionResource(ProgrammingSubmissionService programmingSub\n             return forbidden();\n         }\n \n-        // TODO: Handle lock limit.\n+        // Check if the limit of simultaneously locked submissions has been reached\n+        programmingSubmissionService.checkSubmissionLockLimit(programmingExercise.getCourseViaExerciseGroupOrCourseMember().getId());\n+\n+        final ProgrammingSubmission programmingSubmission;\n+        if (lockSubmission) {\n+            programmingSubmission = programmingSubmissionService.getLockedProgrammingSubmissionWithoutResult(programmingExercise);\n+        }\n+        else {\n+            Optional<ProgrammingSubmission> optionalProgrammingSubmission = programmingSubmissionService.getRandomProgrammingSubmissionEligibleForNewAssessment(programmingExercise,\n+                    programmingExercise.hasExerciseGroup());\n+            if (optionalProgrammingSubmission.isEmpty()) {\n+                return notFound();\n+            }\n+            programmingSubmission = optionalProgrammingSubmission.get();\n \n-        Optional<ProgrammingSubmission> optionalProgrammingSubmission = programmingSubmissionService.getRandomProgrammingSubmissionEligibleForNewAssessment(programmingExercise,\n-                programmingExercise.hasExerciseGroup());\n-        if (optionalProgrammingSubmission.isEmpty()) {\n-            return notFound();\n         }\n-        final ProgrammingSubmission programmingSubmission = optionalProgrammingSubmission.get();\n+\n+        // final ProgrammingSubmission programmingSubmission = optionalProgrammingSubmission.get();", "originalCommit": "75c4457e82feb0829f19dfe84e2c47d8f84916ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU5OTQzMA==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525599430", "bodyText": "Done", "author": "fde312", "createdAt": "2020-11-17T23:44:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU2ODA2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU3NDY2Nw==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525574667", "bodyText": "I would rather check here, that no manual feedback exist.", "author": "kloessst", "createdAt": "2020-11-17T22:44:05Z", "path": "src/main/webapp/app/exercises/programming/assess/code-editor-tutor-assessment-container.component.ts", "diffHunk": "@@ -386,19 +380,14 @@ export class CodeEditorTutorAssessmentContainerComponent implements OnInit, OnDe\n     }\n \n     private handleFeedback(): void {\n-        // Setup automatic feedback\n-        this.automaticFeedback = this.automaticResult?.feedbacks ?? [];\n-        this.automaticFeedback.forEach((feedback) => {\n-            feedback.id = undefined;\n-            if (!feedback.credits) {\n-                feedback.credits = 0;\n-            }\n-        });\n-\n-        // Setup not automatically generated feedbacks\n         const feedbacks = this.manualResult?.feedbacks || [];\n-        this.unreferencedFeedback = feedbacks.filter((feedbackElement) => feedbackElement.reference == undefined && feedbackElement.type === FeedbackType.MANUAL_UNREFERENCED);\n+        this.automaticFeedback = feedbacks.filter((feedback) => feedback.type === FeedbackType.AUTOMATIC);\n+        // When manual result only contains automatic feedback elements (when assessing for the first time), no manual assessment was yet saved or submitted.\n+        if (this.manualResult?.feedbacks && this.manualResult.feedbacks.length === this.automaticFeedback.length) {", "originalCommit": "75c4457e82feb0829f19dfe84e2c47d8f84916ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYyMzQ4OA==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r525623488", "bodyText": "@kloessst I modified the check to also set it as first assessment when there is no feedback at all to include the No tests found result string of automatic result with build failed :)", "author": "fde312", "createdAt": "2020-11-18T00:52:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTU3NDY2Nw=="}], "type": "inlineReview"}, {"oid": "fcea2d2179f41eb89628b0c80da9ffea9df18288", "url": "https://github.com/ls1intum/Artemis/commit/fcea2d2179f41eb89628b0c80da9ffea9df18288", "message": "small fixes", "committedDate": "2020-11-18T01:22:14Z", "type": "commit"}, {"oid": "8012d71bc5449d3be974749c61a10014a58a20c9", "url": "https://github.com/ls1intum/Artemis/commit/8012d71bc5449d3be974749c61a10014a58a20c9", "message": "try to fix issue with hibernate exception, incorporate feedback and improve the check for isFirstAssessment", "committedDate": "2020-11-18T10:45:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA0MDA3Mw==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526040073", "bodyText": "A bit confusing method name, maybe LockAndGetProgrammingSubmissionWithoutResult makes more sense", "author": "TobiasPr", "createdAt": "2020-11-18T12:13:42Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingSubmissionService.java", "diffHunk": "@@ -634,4 +633,42 @@ public ProgrammingSubmission findByIdWithEagerResultAndFeedback(long submissionI\n         return programmingSubmissionRepository.findWithEagerResultAssessorFeedbackById(submissionId)\n                 .orElseThrow(() -> new EntityNotFoundException(\"Programming submission with id \\\"\" + submissionId + \"\\\" does not exist\"));\n     }\n+\n+    /**\n+     * Get a programming submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.\n+     *\n+     * @param exercise the exercise the submission should belong to\n+     * @return a locked programming submission that needs an assessment\n+     */\n+    @Transactional\n+    public ProgrammingSubmission getLockedProgrammingSubmissionWithoutResult(ProgrammingExercise exercise) {", "originalCommit": "8012d71bc5449d3be974749c61a10014a58a20c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjE4OTQ4NQ==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526189485", "bodyText": "Changed to lockAndGetProgramingSubmissionWithoutResultand also accordingly for modeling and file upload exercises.", "author": "fde312", "createdAt": "2020-11-18T15:43:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA0MDA3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEyNzY2Ng==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526127666", "bodyText": "can we please remove this @Transactional here", "author": "krusche", "createdAt": "2020-11-18T14:26:24Z", "path": "src/main/java/de/tum/in/www1/artemis/service/SubmissionService.java", "diffHunk": "@@ -163,19 +163,20 @@ public long countSubmissionLocks(long courseId) {\n      * No manual result means that no user has started an assessment for the corresponding submission yet.\n      * For exam exercises we should also remove the test run participations as these should not be graded by the tutors.\n      *\n-     * @param fileUploadExercise the exercise for which we want to retrieve a submission without manual result\n+     * @param exercise the exercise for which we want to retrieve a submission without manual result\n      * @param examMode flag to determine if test runs should be removed. This should be set to true for exam exercises\n      * @return a submission without any manual result or an empty Optional if no submission without manual result could be found\n      */\n     @Transactional(readOnly = true)", "originalCommit": "8012d71bc5449d3be974749c61a10014a58a20c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM4MzcxOA==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526383718", "bodyText": "Done", "author": "fde312", "createdAt": "2020-11-18T20:03:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEyNzY2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEyNzc2NQ==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526127765", "bodyText": "please remove this @Transactional here", "author": "krusche", "createdAt": "2020-11-18T14:26:31Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingSubmissionService.java", "diffHunk": "@@ -634,4 +633,42 @@ public ProgrammingSubmission findByIdWithEagerResultAndFeedback(long submissionI\n         return programmingSubmissionRepository.findWithEagerResultAssessorFeedbackById(submissionId)\n                 .orElseThrow(() -> new EntityNotFoundException(\"Programming submission with id \\\"\" + submissionId + \"\\\" does not exist\"));\n     }\n+\n+    /**\n+     * Get a programming submission of the given exercise that still needs to be assessed and lock the submission to prevent other tutors from receiving and assessing it.\n+     *\n+     * @param exercise the exercise the submission should belong to\n+     * @return a locked programming submission that needs an assessment\n+     */\n+    @Transactional", "originalCommit": "8012d71bc5449d3be974749c61a10014a58a20c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjE1MjU2MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526152561", "bodyText": "Isn't it possible then, that two tutors aquire the same lock on a submission?", "author": "kloessst", "createdAt": "2020-11-18T14:57:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEyNzc2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjM4Mzc4Nw==", "url": "https://github.com/ls1intum/Artemis/pull/2415#discussion_r526383787", "bodyText": "Done", "author": "fde312", "createdAt": "2020-11-18T20:03:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjEyNzc2NQ=="}], "type": "inlineReview"}, {"oid": "2d891c73f14c2776d74eb6a9d0fe95e8f4079f07", "url": "https://github.com/ls1intum/Artemis/commit/2d891c73f14c2776d74eb6a9d0fe95e8f4079f07", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard", "committedDate": "2020-11-18T14:29:44Z", "type": "commit"}, {"oid": "dc2f9d613a20195d6c2339d1eca0ea95950b888a", "url": "https://github.com/ls1intum/Artemis/commit/dc2f9d613a20195d6c2339d1eca0ea95950b888a", "message": "removed transactional for lock call for exercise types and renamed method", "committedDate": "2020-11-18T20:04:50Z", "type": "commit"}, {"oid": "e07926310e2ba21e8689c98fcc74a50d412f1fc8", "url": "https://github.com/ls1intum/Artemis/commit/e07926310e2ba21e8689c98fcc74a50d412f1fc8", "message": "make codacy happier", "committedDate": "2020-11-18T20:07:20Z", "type": "commit"}, {"oid": "70e24904a3279f8bfbdf2419cb221ba00071e486", "url": "https://github.com/ls1intum/Artemis/commit/70e24904a3279f8bfbdf2419cb221ba00071e486", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard", "committedDate": "2020-11-18T20:08:29Z", "type": "commit"}, {"oid": "7129488099e7c064fe01443a986d8d5aa7a4c11b", "url": "https://github.com/ls1intum/Artemis/commit/7129488099e7c064fe01443a986d8d5aa7a4c11b", "message": "add check for 404 error no unassessed submissions left", "committedDate": "2020-11-18T20:50:47Z", "type": "commit"}, {"oid": "69daa9f71f5f6810537a14b7c61b0362a10b0f27", "url": "https://github.com/ls1intum/Artemis/commit/69daa9f71f5f6810537a14b7c61b0362a10b0f27", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/align-button-assessment-dashboard", "committedDate": "2020-11-18T20:51:06Z", "type": "commit"}]}