{"pr_number": 1743, "pr_title": "Catch EntityNotFoundException for websocket  subscribe.", "pr_createdAt": "2020-06-29T11:14:32Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1743", "timeline": [{"oid": "0560459da5dbef23e694628f58b80e4c486bc696", "url": "https://github.com/ls1intum/Artemis/commit/0560459da5dbef23e694628f58b80e4c486bc696", "message": "Catch EntityNotFoundException for websocket  subscribe.", "committedDate": "2020-06-29T09:36:15Z", "type": "commit"}, {"oid": "b57b33639fabb382c962083005ae687a37f41420", "url": "https://github.com/ls1intum/Artemis/commit/b57b33639fabb382c962083005ae687a37f41420", "message": "Merge branch 'develop' into bugfix/websocket-subscribe-anonymous", "committedDate": "2020-06-29T10:41:22Z", "type": "commit"}, {"oid": "aad2895de029805394e2bc4a77975536a0e60186", "url": "https://github.com/ls1intum/Artemis/commit/aad2895de029805394e2bc4a77975536a0e60186", "message": "Merge branch 'develop' into bugfix/websocket-subscribe-anonymous", "committedDate": "2020-06-29T11:45:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk1Nzg0Nw==", "url": "https://github.com/ls1intum/Artemis/pull/1743#discussion_r446957847", "bodyText": "log.warn(\"Catcher an exception during SUBSCRIBE...\")", "author": "krusche", "createdAt": "2020-06-29T13:09:37Z", "path": "src/main/java/de/tum/in/www1/artemis/config/websocket/WebsocketConfiguration.java", "diffHunk": "@@ -262,9 +263,15 @@ protected Principal determineUser(ServerHttpRequest request, WebSocketHandler ws\n             String destination = headerAccessor.getDestination();\n \n             if (StompCommand.SUBSCRIBE.equals(headerAccessor.getCommand())) {\n-                if (!allowSubscription(principal, destination)) {\n-                    logUnauthorizedDestinationAccess(principal, destination);\n-                    return null; // erase the forbidden SUBSCRIBE command the user was trying to send\n+                try {\n+                    if (!allowSubscription(principal, destination)) {\n+                        logUnauthorizedDestinationAccess(principal, destination);\n+                        return null; // erase the forbidden SUBSCRIBE command the user was trying to send\n+                    }\n+                }\n+                catch (EntityNotFoundException e) {\n+                    // If the user is not found (e.g. because he is not logged in), he should not be able to subscribe to these topics", "originalCommit": "aad2895de029805394e2bc4a77975536a0e60186", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk3MjEyNg==", "url": "https://github.com/ls1intum/Artemis/pull/1743#discussion_r446972126", "bodyText": "I've added a log message.", "author": "sleiss", "createdAt": "2020-06-29T13:29:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk1Nzg0Nw=="}], "type": "inlineReview"}, {"oid": "f96e7858d7b5cb5c90a2a35d3fa9d47dc830f5a1", "url": "https://github.com/ls1intum/Artemis/commit/f96e7858d7b5cb5c90a2a35d3fa9d47dc830f5a1", "message": "Add log.warn message if permission check failed.", "committedDate": "2020-06-29T13:16:23Z", "type": "commit"}, {"oid": "7936949c7dd5dc2c720cfa320fe380c564ae1e31", "url": "https://github.com/ls1intum/Artemis/commit/7936949c7dd5dc2c720cfa320fe380c564ae1e31", "message": "Merge remote-tracking branch 'origin/bugfix/websocket-subscribe-anonymous' into bugfix/websocket-subscribe-anonymous", "committedDate": "2020-06-29T13:16:43Z", "type": "commit"}, {"oid": "107a781e0efdc58f7b87be78dd8d895c91c774e1", "url": "https://github.com/ls1intum/Artemis/commit/107a781e0efdc58f7b87be78dd8d895c91c774e1", "message": "Merge branch 'develop' into bugfix/websocket-subscribe-anonymous", "committedDate": "2020-06-29T18:56:35Z", "type": "commit"}]}