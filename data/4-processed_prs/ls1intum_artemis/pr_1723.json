{"pr_number": 1723, "pr_title": "[Exam] Check that submissions are made in time and the user is allowed to submit", "pr_createdAt": "2020-06-27T06:19:17Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1723", "timeline": [{"oid": "175df9f76d5034ebf01045e01654bb779192965d", "url": "https://github.com/ls1intum/Artemis/commit/175df9f76d5034ebf01045e01654bb779192965d", "message": "Basic ExamSubmissionService implementation", "committedDate": "2020-06-27T04:25:03Z", "type": "commit"}, {"oid": "4a51aad2180b8563aa8f6df77ae88ea2004ced38", "url": "https://github.com/ls1intum/Artemis/commit/4a51aad2180b8563aa8f6df77ae88ea2004ced38", "message": "Use ExamSubmissionService in TextSubmissionResource", "committedDate": "2020-06-27T04:27:47Z", "type": "commit"}, {"oid": "eb719232c9c64f511e3a59d5d7fed40336f41e93", "url": "https://github.com/ls1intum/Artemis/commit/eb719232c9c64f511e3a59d5d7fed40336f41e93", "message": "Add submission allowance check to SubmissionService so the checks can be reused and tested", "committedDate": "2020-06-27T05:37:33Z", "type": "commit"}, {"oid": "024deda42a93c664c0f3359063dbf49a16f9b5e9", "url": "https://github.com/ls1intum/Artemis/commit/024deda42a93c664c0f3359063dbf49a16f9b5e9", "message": "Adjust all submission services to extended constructor of parent class", "committedDate": "2020-06-27T05:43:33Z", "type": "commit"}, {"oid": "04fea5086d3ac004ca1a2a8833f3949da01e95e5", "url": "https://github.com/ls1intum/Artemis/commit/04fea5086d3ac004ca1a2a8833f3949da01e95e5", "message": "Make ExamSubmissionService a valid bean", "committedDate": "2020-06-27T05:44:03Z", "type": "commit"}, {"oid": "c2450eb95c2dd860e1f04f194f68db6ab9b4ece4", "url": "https://github.com/ls1intum/Artemis/commit/c2450eb95c2dd860e1f04f194f68db6ab9b4ece4", "message": "Use checkSubmissionAllowance() in TextSubmissionResource", "committedDate": "2020-06-27T05:44:26Z", "type": "commit"}, {"oid": "a35ff0d4b02b007a9c483d2a253a4eb0104ab54a", "url": "https://github.com/ls1intum/Artemis/commit/a35ff0d4b02b007a9c483d2a253a4eb0104ab54a", "message": "Use working time for isSubmissionInTime check", "committedDate": "2020-06-27T05:58:59Z", "type": "commit"}, {"oid": "1ae56298021251d7e95195cd6dfa10fa48ab5e0f", "url": "https://github.com/ls1intum/Artemis/commit/1ae56298021251d7e95195cd6dfa10fa48ab5e0f", "message": "Check that the current user is allowed to submit to this (exam) exercise", "committedDate": "2020-06-27T06:02:11Z", "type": "commit"}, {"oid": "d94d6733836a35b697425df2e34e9671f02fdc12", "url": "https://github.com/ls1intum/Artemis/commit/d94d6733836a35b697425df2e34e9671f02fdc12", "message": "Fix JavaDoc", "committedDate": "2020-06-27T06:40:41Z", "type": "commit"}, {"oid": "080930c149ee25818a1134f79334b693a7d8a728", "url": "https://github.com/ls1intum/Artemis/commit/080930c149ee25818a1134f79334b693a7d8a728", "message": "Check that participation exists", "committedDate": "2020-06-27T12:58:20Z", "type": "commit"}, {"oid": "1895448dbfdbc2789db7e8c7093d567c96417a97", "url": "https://github.com/ls1intum/Artemis/commit/1895448dbfdbc2789db7e8c7093d567c96417a97", "message": "Smaller adjustments", "committedDate": "2020-06-27T13:30:13Z", "type": "commit"}, {"oid": "0f599a18307062713497717a8ddf1ff0f2b0a959", "url": "https://github.com/ls1intum/Artemis/commit/0f599a18307062713497717a8ddf1ff0f2b0a959", "message": "Add testing for ExamSubmissionService", "committedDate": "2020-06-27T14:12:01Z", "type": "commit"}, {"oid": "60035e55b6cc0c7bc3681b1f391e30c69534ca57", "url": "https://github.com/ls1intum/Artemis/commit/60035e55b6cc0c7bc3681b1f391e30c69534ca57", "message": "First implementation of SubmissionServiceTest", "committedDate": "2020-06-28T10:46:26Z", "type": "commit"}, {"oid": "5740d0d700c400c57ce41faf9d32791d322ddf45", "url": "https://github.com/ls1intum/Artemis/commit/5740d0d700c400c57ce41faf9d32791d322ddf45", "message": "Add service method to get exercise with student participations and submissions", "committedDate": "2020-06-28T13:57:57Z", "type": "commit"}, {"oid": "f6b078ca5007b6fcd41fd92e066321457223bda7", "url": "https://github.com/ls1intum/Artemis/commit/f6b078ca5007b6fcd41fd92e066321457223bda7", "message": "Use findOneWithStudentParticipationsAndSubmissions() in TextSubmissionResource", "committedDate": "2020-06-28T13:58:27Z", "type": "commit"}, {"oid": "f97cd5defee8be6cc9e7a326e7f229ff79ddc53f", "url": "https://github.com/ls1intum/Artemis/commit/f97cd5defee8be6cc9e7a326e7f229ff79ddc53f", "message": "Prevent multiple submissions", "committedDate": "2020-06-28T14:39:10Z", "type": "commit"}, {"oid": "ed5d17d250e4cb2c5febb64b4d1504d7c18344a4", "url": "https://github.com/ls1intum/Artemis/commit/ed5d17d250e4cb2c5febb64b4d1504d7c18344a4", "message": "Adjust method name", "committedDate": "2020-06-28T15:52:34Z", "type": "commit"}, {"oid": "0406672e2257c70bcebc0eed747569f182f11b3a", "url": "https://github.com/ls1intum/Artemis/commit/0406672e2257c70bcebc0eed747569f182f11b3a", "message": "Ensure that check methods are called on post and put of text submission", "committedDate": "2020-06-28T16:37:46Z", "type": "commit"}, {"oid": "5d6905650da7eeaa5e46952b0067ff74a81db3cc", "url": "https://github.com/ls1intum/Artemis/commit/5d6905650da7eeaa5e46952b0067ff74a81db3cc", "message": "Remove findOneWithStudentParticipationsAndSubmissions()", "committedDate": "2020-06-28T17:09:47Z", "type": "commit"}, {"oid": "ea1c1a9bb6ba0a431b1fa528875ced58d2d7aa2c", "url": "https://github.com/ls1intum/Artemis/commit/ea1c1a9bb6ba0a431b1fa528875ced58d2d7aa2c", "message": "Temporarily deactivate new test case", "committedDate": "2020-06-28T17:13:07Z", "type": "commit"}, {"oid": "19ac37ea729aeba5ef9d9bf2ad6e574019a366c1", "url": "https://github.com/ls1intum/Artemis/commit/19ac37ea729aeba5ef9d9bf2ad6e574019a366c1", "message": "Use findByExerciseAndStudentIdWithEagerResultsAndSubmissions()", "committedDate": "2020-06-28T17:19:15Z", "type": "commit"}, {"oid": "ab1f1babfa1192d45a32123ee2b96610bdec9d46", "url": "https://github.com/ls1intum/Artemis/commit/ab1f1babfa1192d45a32123ee2b96610bdec9d46", "message": "Own implementation of findByExerciseAndStudentIdWithEagerResultsAndSubmissions() without results", "committedDate": "2020-06-28T17:25:33Z", "type": "commit"}, {"oid": "d6f5c33e333d94215b7378a05416085a3d5b2644", "url": "https://github.com/ls1intum/Artemis/commit/d6f5c33e333d94215b7378a05416085a3d5b2644", "message": "Test preventMultipleSubmissions()", "committedDate": "2020-06-28T17:39:26Z", "type": "commit"}, {"oid": "a8c8fcd13db2d59e1fdec3e40e951a51bf5a853e", "url": "https://github.com/ls1intum/Artemis/commit/a8c8fcd13db2d59e1fdec3e40e951a51bf5a853e", "message": "Remove check call test case for now", "committedDate": "2020-06-28T18:02:42Z", "type": "commit"}, {"oid": "27f3678afb668c75bf28c2e5283b926f1e1be66c", "url": "https://github.com/ls1intum/Artemis/commit/27f3678afb668c75bf28c2e5283b926f1e1be66c", "message": "Remove unneeded TODO", "committedDate": "2020-06-28T18:04:53Z", "type": "commit"}, {"oid": "4060293d50796ab3f556c222e61f01eae7c9e75c", "url": "https://github.com/ls1intum/Artemis/commit/4060293d50796ab3f556c222e61f01eae7c9e75c", "message": "Use textExerciseService.findOne()", "committedDate": "2020-06-28T18:13:06Z", "type": "commit"}, {"oid": "729711139431325077daee4a21a3307393eccaae", "url": "https://github.com/ls1intum/Artemis/commit/729711139431325077daee4a21a3307393eccaae", "message": "Add comment", "committedDate": "2020-06-28T18:14:35Z", "type": "commit"}, {"oid": "b6b2770dd50d9ecb76e839cae6d5f92dc6bf732d", "url": "https://github.com/ls1intum/Artemis/commit/b6b2770dd50d9ecb76e839cae6d5f92dc6bf732d", "message": "Apply checks to file upload submissions", "committedDate": "2020-06-28T18:26:19Z", "type": "commit"}, {"oid": "c21d07d9f35b7a5e46c171ceb0645e5a4fe995e2", "url": "https://github.com/ls1intum/Artemis/commit/c21d07d9f35b7a5e46c171ceb0645e5a4fe995e2", "message": "Apply checks to modeling submissions", "committedDate": "2020-06-28T18:41:55Z", "type": "commit"}, {"oid": "8fb988a45714808438d9364353879c14bef45b72", "url": "https://github.com/ls1intum/Artemis/commit/8fb988a45714808438d9364353879c14bef45b72", "message": "Apply checks to quiz submissions", "committedDate": "2020-06-28T19:10:34Z", "type": "commit"}, {"oid": "ddb4e283d4431cdfc8e26db67d81cf2a71644779", "url": "https://github.com/ls1intum/Artemis/commit/ddb4e283d4431cdfc8e26db67d81cf2a71644779", "message": "Apply exam checks to programming submissions", "committedDate": "2020-06-28T20:24:31Z", "type": "commit"}, {"oid": "d378103735d3674d64e9f8e10ba28261b6a60bb5", "url": "https://github.com/ls1intum/Artemis/commit/d378103735d3674d64e9f8e10ba28261b6a60bb5", "message": "Merge branch 'develop' into exam/participation/submissions-between-start-and-end", "committedDate": "2020-06-28T20:26:09Z", "type": "commit"}, {"oid": "b9bf7bf320afce834fbf4e01f07cb01d8a6f5d43", "url": "https://github.com/ls1intum/Artemis/commit/b9bf7bf320afce834fbf4e01f07cb01d8a6f5d43", "message": "Merge branch 'develop' into exam/participation/submissions-between-start-and-end", "committedDate": "2020-06-28T22:49:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4Mjc4MQ==", "url": "https://github.com/ls1intum/Artemis/pull/1723#discussion_r446882781", "bodyText": "for future PR I would use Optional as return type", "author": "krusche", "createdAt": "2020-06-29T10:09:27Z", "path": "src/main/java/de/tum/in/www1/artemis/repository/StudentParticipationRepository.java", "diffHunk": "@@ -65,9 +65,15 @@\n     @Query(\"select distinct participation from StudentParticipation participation left join fetch participation.results result where participation.exercise.id = :#{#exerciseId} and (result.id = (select max(id) from participation.results) or result is null)\")\n     List<StudentParticipation> findByExerciseIdWithLatestResult(@Param(\"exerciseId\") Long exerciseId);\n \n+    @Query(\"select distinct participation from StudentParticipation participation left join fetch participation.submissions where participation.exercise.id = :#{#exerciseId} and participation.student.id = :#{#studentId}\")\n+    List<StudentParticipation> findByExerciseIdAndStudentIdWithEagerSubmissions(@Param(\"exerciseId\") Long exerciseId, @Param(\"studentId\") Long studentId);", "originalCommit": "b9bf7bf320afce834fbf4e01f07cb01d8a6f5d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4MzI1Mg==", "url": "https://github.com/ls1intum/Artemis/pull/1723#discussion_r446883252", "bodyText": "maybe reuse the following one\n@EntityGraph(type = LOAD, attributePaths = \"submissions\")\nOptional findWithEagerSubmissionsByExerciseIdAndStudentLogin(Long exerciseId, String username);\n@EntityGraph(type = LOAD, attributePaths = \"submissions\")\nOptional<StudentParticipation> findWithEagerSubmissionsByExerciseIdAndTeamId(Long exerciseId, Long teamId);", "author": "krusche", "createdAt": "2020-06-29T10:10:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4Mjc4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4MjgyOQ==", "url": "https://github.com/ls1intum/Artemis/pull/1723#discussion_r446882829", "bodyText": "for future PR I would use Optional as return type", "author": "krusche", "createdAt": "2020-06-29T10:09:34Z", "path": "src/main/java/de/tum/in/www1/artemis/repository/StudentParticipationRepository.java", "diffHunk": "@@ -65,9 +65,15 @@\n     @Query(\"select distinct participation from StudentParticipation participation left join fetch participation.results result where participation.exercise.id = :#{#exerciseId} and (result.id = (select max(id) from participation.results) or result is null)\")\n     List<StudentParticipation> findByExerciseIdWithLatestResult(@Param(\"exerciseId\") Long exerciseId);\n \n+    @Query(\"select distinct participation from StudentParticipation participation left join fetch participation.submissions where participation.exercise.id = :#{#exerciseId} and participation.student.id = :#{#studentId}\")\n+    List<StudentParticipation> findByExerciseIdAndStudentIdWithEagerSubmissions(@Param(\"exerciseId\") Long exerciseId, @Param(\"studentId\") Long studentId);\n+\n     @Query(\"select distinct participation from StudentParticipation participation left join fetch participation.results left join fetch participation.submissions where participation.exercise.id = :#{#exerciseId} and participation.student.id = :#{#studentId}\")\n     List<StudentParticipation> findByExerciseIdAndStudentIdWithEagerResultsAndSubmissions(@Param(\"exerciseId\") Long exerciseId, @Param(\"studentId\") Long studentId);\n \n+    @Query(\"select distinct participation from StudentParticipation participation left join fetch participation.submissions where participation.exercise.id = :#{#exerciseId} and participation.team.id = :#{#teamId}\")\n+    List<StudentParticipation> findByExerciseIdAndTeamIdWithEagerSubmissions(@Param(\"exerciseId\") Long exerciseId, @Param(\"teamId\") Long teamId);", "originalCommit": "b9bf7bf320afce834fbf4e01f07cb01d8a6f5d43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4MzI3Mg==", "url": "https://github.com/ls1intum/Artemis/pull/1723#discussion_r446883272", "bodyText": "@EntityGraph(type = LOAD, attributePaths = \"submissions\")\nOptional<StudentParticipation> findWithEagerSubmissionsByExerciseIdAndStudentLogin(Long exerciseId, String username);\n\n@EntityGraph(type = LOAD, attributePaths = \"submissions\")\nOptional<StudentParticipation> findWithEagerSubmissionsByExerciseIdAndTeamId(Long exerciseId, Long teamId);", "author": "krusche", "createdAt": "2020-06-29T10:10:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg4MjgyOQ=="}], "type": "inlineReview"}, {"oid": "6a5674a5f6468e659f6640e0ce5b011c01a00663", "url": "https://github.com/ls1intum/Artemis/commit/6a5674a5f6468e659f6640e0ce5b011c01a00663", "message": "Add comment", "committedDate": "2020-06-29T10:59:45Z", "type": "commit"}, {"oid": "92a00d0824164fb15514765f7f912ec20da92233", "url": "https://github.com/ls1intum/Artemis/commit/92a00d0824164fb15514765f7f912ec20da92233", "message": "Remove exam submission allowance check from ProgrammingSubmissionResource", "committedDate": "2020-06-29T11:01:00Z", "type": "commit"}, {"oid": "5838836ff86a3d2bedba0578999c93dcd9c80a30", "url": "https://github.com/ls1intum/Artemis/commit/5838836ff86a3d2bedba0578999c93dcd9c80a30", "message": "Remove unnecessary SpyBeans", "committedDate": "2020-06-29T11:04:00Z", "type": "commit"}, {"oid": "c8dc00193a77b2ec83a06c962b5c91774452cc31", "url": "https://github.com/ls1intum/Artemis/commit/c8dc00193a77b2ec83a06c962b5c91774452cc31", "message": "Remove unnecessary isAllowedToSeeExercise() check from quiz submission exam route", "committedDate": "2020-06-29T11:05:40Z", "type": "commit"}, {"oid": "d3616b57ba7df44b57eb610bde6dbdd2bfc586b7", "url": "https://github.com/ls1intum/Artemis/commit/d3616b57ba7df44b57eb610bde6dbdd2bfc586b7", "message": "Merge branch 'develop' into exam/participation/submissions-between-start-and-end", "committedDate": "2020-06-29T11:06:04Z", "type": "commit"}]}