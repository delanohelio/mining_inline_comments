{"pr_number": 2290, "pr_title": "[Enhancement] Improve user interface for Manual Assessment of Programming Exercises", "pr_createdAt": "2020-10-28T17:58:39Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2290", "timeline": [{"oid": "e3b7f280439b9c2f7703e7c4f985842b51638e0d", "url": "https://github.com/ls1intum/Artemis/commit/e3b7f280439b9c2f7703e7c4f985842b51638e0d", "message": "change layout and remove not used components", "committedDate": "2020-10-26T20:06:27Z", "type": "commit"}, {"oid": "02bd2f64cb15355fda4b711f38ecf3aa68a96de0", "url": "https://github.com/ls1intum/Artemis/commit/02bd2f64cb15355fda4b711f38ecf3aa68a96de0", "message": "adapt the result string to display the points of the assessment", "committedDate": "2020-10-27T11:51:07Z", "type": "commit"}, {"oid": "e67f87577fc3a6275200ce8440224ae06f838fc8", "url": "https://github.com/ls1intum/Artemis/commit/e67f87577fc3a6275200ce8440224ae06f838fc8", "message": "add more checks to REST CALL", "committedDate": "2020-10-27T13:31:11Z", "type": "commit"}, {"oid": "a01732c4869f0dbb5e98571fb1a305a01831f61d", "url": "https://github.com/ls1intum/Artemis/commit/a01732c4869f0dbb5e98571fb1a305a01831f61d", "message": "adapt submit call from ProgrammingAssessmentService and setResultString from ProgrammingExerciseGradingService", "committedDate": "2020-10-27T13:35:08Z", "type": "commit"}, {"oid": "d595d0b1b17277bc0beeb8b6dbe7b74c4fd1671e", "url": "https://github.com/ls1intum/Artemis/commit/d595d0b1b17277bc0beeb8b6dbe7b74c4fd1671e", "message": "fix tests of ProgrammingExerciseGradingService", "committedDate": "2020-10-27T19:13:21Z", "type": "commit"}, {"oid": "f5a270288dcf2d2f7ddbba2377db9d9fb0157bd3", "url": "https://github.com/ls1intum/Artemis/commit/f5a270288dcf2d2f7ddbba2377db9d9fb0157bd3", "message": "fix issue with boolean check and set score and result string for result creation", "committedDate": "2020-10-27T21:59:07Z", "type": "commit"}, {"oid": "3eb329df8209b6da562d1859638a1ba7658389ef", "url": "https://github.com/ls1intum/Artemis/commit/3eb329df8209b6da562d1859638a1ba7658389ef", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/improve-user-interface\n\n# Conflicts:\n#\tsrc/main/webapp/app/exercises/programming/assess/code-editor-tutor-assessment-container.component.html", "committedDate": "2020-10-28T09:40:14Z", "type": "commit"}, {"oid": "bbd30ba3ec30d413a924439a42ff36a56d909bf3", "url": "https://github.com/ls1intum/Artemis/commit/bbd30ba3ec30d413a924439a42ff36a56d909bf3", "message": "adapt more tests", "committedDate": "2020-10-28T14:22:13Z", "type": "commit"}, {"oid": "4c159cd1dbc0afdb6184ff550e5487078d9dd007", "url": "https://github.com/ls1intum/Artemis/commit/4c159cd1dbc0afdb6184ff550e5487078d9dd007", "message": "improve code and add functionality for updateAfterComplaint", "committedDate": "2020-10-28T15:54:22Z", "type": "commit"}, {"oid": "3729f60a8d37ca95ab097eefd46ae5a1b86e200e", "url": "https://github.com/ls1intum/Artemis/commit/3729f60a8d37ca95ab097eefd46ae5a1b86e200e", "message": "rename download repos button and run prettier", "committedDate": "2020-10-28T17:57:24Z", "type": "commit"}, {"oid": "3868fd5c7c90764385e092d06429c0803600de8b", "url": "https://github.com/ls1intum/Artemis/commit/3868fd5c7c90764385e092d06429c0803600de8b", "message": "fix broken tests", "committedDate": "2020-10-28T21:25:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3MzUxMQ==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r513873511", "bodyText": "I don't think you need JsonIgnore for a method named \"create...\". Jackson should ignore this by default.", "author": "kloessst", "createdAt": "2020-10-29T01:57:07Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Result.java", "diffHunk": "@@ -137,6 +137,24 @@ public void setResultString(Double totalScore, @Nullable Double maxScore) {\n         }\n     }\n \n+    /**\n+     * Builds a part of the result string of manual results for programming exercises\n+     *\n+     * @param totalScore total amount of scored points\n+     * @param maxScore   maximum score reachable at corresponding exercise\n+     * @return String with result string for manual result of a progrmaming exercise\n+     */\n+    @JsonIgnore", "originalCommit": "3868fd5c7c90764385e092d06429c0803600de8b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIyODMxOA==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r514228318", "bodyText": "Fixed in 5a4957277", "author": "fde312", "createdAt": "2020-10-29T12:43:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3MzUxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3NDIxNA==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r513874214", "bodyText": "This seems like a duplication of lines 130-138. You could call the create method within the set method.", "author": "kloessst", "createdAt": "2020-10-29T01:58:42Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Result.java", "diffHunk": "@@ -137,6 +137,24 @@ public void setResultString(Double totalScore, @Nullable Double maxScore) {\n         }\n     }\n \n+    /**\n+     * Builds a part of the result string of manual results for programming exercises\n+     *\n+     * @param totalScore total amount of scored points\n+     * @param maxScore   maximum score reachable at corresponding exercise\n+     * @return String with result string for manual result of a progrmaming exercise\n+     */\n+    @JsonIgnore\n+    public String createResultStringForManualResult(Double totalScore, @Nullable Double maxScore) {\n+        DecimalFormat formatter = new DecimalFormat(\"#.##\");\n+        if (maxScore == null) {\n+            return formatter.format(totalScore) + \" points\";\n+        }\n+        else {\n+            return formatter.format(totalScore) + \" of \" + formatter.format(maxScore) + \" points\";\n+        }", "originalCommit": "3868fd5c7c90764385e092d06429c0803600de8b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIyODM4Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r514228382", "bodyText": "Good catch! Thanks! Fixed in 5a4957277", "author": "fde312", "createdAt": "2020-10-29T12:43:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3NDIxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3OTM2OQ==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r513879369", "bodyText": "Do we need the exercise type case distinction here? If ProgrammingAssessmentService inherits from AssessmentService, you should override updateAssessmentAfterComplaint and call it on the child class.", "author": "kloessst", "createdAt": "2020-10-29T02:10:23Z", "path": "src/main/java/de/tum/in/www1/artemis/service/AssessmentService.java", "diffHunk": "@@ -109,8 +109,22 @@ public Result updateAssessmentAfterComplaint(Result originalResult, Exercise exe\n \n         // Update the result that was complained about with the new feedback\n         originalResult.updateAllFeedbackItems(assessmentUpdate.getFeedbacks());\n-        Double calculatedScore = calculateTotalScore(originalResult.getFeedbacks());\n-        return submitResult(originalResult, exercise, calculatedScore);\n+        if (exercise instanceof ProgrammingExercise) {\n+            double points = ((ProgrammingAssessmentService) this).calculateTotalScore(originalResult);", "originalCommit": "3868fd5c7c90764385e092d06429c0803600de8b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIzMDg3MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r514230871", "bodyText": "I cannot override the method as there is no calculateTotalScore(Result result) in AssessmentService and we need it that way only for programming exercises we have a special way on calculating the points the student has :)", "author": "fde312", "createdAt": "2020-10-29T12:47:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3OTM2OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIzMzU5Nw==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r514233597", "bodyText": "I understand your point, but it is basically then code duplication except of the last part isn't it? Therefore, I thought to avoid it :)", "author": "fde312", "createdAt": "2020-10-29T12:51:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg3OTM2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg4MzMyOA==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r513883328", "bodyText": "I'd suggest moving the validation of newResult as far up as possible in the method. Validation should be done before services are used.", "author": "kloessst", "createdAt": "2020-10-29T02:19:00Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingAssessmentResource.java", "diffHunk": "@@ -144,7 +144,19 @@ public ProgrammingAssessmentResource(AuthorizationCheckService authCheckService,\n             return forbidden();\n         }\n \n-        if (newResult.getScore() != null && newResult.getScore() < 100 && newResult.isSuccessful()) {\n+        if (Boolean.FALSE.equals(newResult.isRated())) {\n+            throw new BadRequestAlertException(\"Result is not rated\", ENTITY_NAME, \"resultNotRated\");\n+        }\n+        if (newResult.getResultString() == null) {\n+            throw new BadRequestAlertException(\"Result string is required.\", ENTITY_NAME, \"resultStringNull\");\n+        }\n+        else if (newResult.getResultString().length() > 255) {\n+            throw new BadRequestAlertException(\"Result string is too long.\", ENTITY_NAME, \"resultStringNull\");\n+        }\n+        else if (newResult.getScore() == null) {\n+            throw new BadRequestAlertException(\"Score is required.\", ENTITY_NAME, \"scoreNull\");\n+        }\n+        else if (newResult.getScore() < 100 && newResult.isSuccessful()) {", "originalCommit": "3868fd5c7c90764385e092d06429c0803600de8b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDIyMTczMA==", "url": "https://github.com/ls1intum/Artemis/pull/2290#discussion_r514221730", "bodyText": "The calls which are done before are also checks, e.g. if the user has enough roles etc. I would leave it like it is, as I think it is equally important to check if he has the rights to submit/save a result or that the result has the correct format. :)", "author": "fde312", "createdAt": "2020-10-29T12:32:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg4MzMyOA=="}], "type": "inlineReview"}, {"oid": "5a49572771ae1435c8863f1c1ed23a874b999a89", "url": "https://github.com/ls1intum/Artemis/commit/5a49572771ae1435c8863f1c1ed23a874b999a89", "message": "apply suggestions from code review", "committedDate": "2020-10-29T12:42:18Z", "type": "commit"}, {"oid": "f866f20eeb7f7687943942b3d423192350667099", "url": "https://github.com/ls1intum/Artemis/commit/f866f20eeb7f7687943942b3d423192350667099", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/improve-user-interface", "committedDate": "2020-10-29T12:42:27Z", "type": "commit"}, {"oid": "a8408f590a85940a79aef410e992947bcc56139b", "url": "https://github.com/ls1intum/Artemis/commit/a8408f590a85940a79aef410e992947bcc56139b", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into enhancement/programming-assessment/improve-user-interface\n\n# Conflicts:\n#\tsrc/main/java/de/tum/in/www1/artemis/service/AssessmentService.java", "committedDate": "2020-10-29T19:24:16Z", "type": "commit"}, {"oid": "a6e4dfb94582bd405e6f397c49f7eacf1ba0e249", "url": "https://github.com/ls1intum/Artemis/commit/a6e4dfb94582bd405e6f397c49f7eacf1ba0e249", "message": "Merge branch 'develop' into enhancement/programming-assessment/improve-user-interface", "committedDate": "2020-10-29T21:17:51Z", "type": "commit"}, {"oid": "20bbf13cacea2640d03ac7fbd8f265a286586c8f", "url": "https://github.com/ls1intum/Artemis/commit/20bbf13cacea2640d03ac7fbd8f265a286586c8f", "message": "Merge branch 'develop' into enhancement/programming-assessment/improve-user-interface", "committedDate": "2020-10-29T21:28:53Z", "type": "commit"}]}