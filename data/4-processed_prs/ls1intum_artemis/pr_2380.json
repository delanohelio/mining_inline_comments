{"pr_number": 2380, "pr_title": "Actions: Split Workflows into Build, Test and Docs", "pr_createdAt": "2020-11-10T21:57:10Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2380", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ1MzAzNg==", "url": "https://github.com/ls1intum/Artemis/pull/2380#discussion_r521453036", "bodyText": "Can we move Spotless and Checkstyle in front of the testing step? I think we should fail fast here in case something is wrong because the tests take a lot more time to run through.", "author": "kloessst", "createdAt": "2020-11-11T15:49:52Z", "path": ".github/workflows/test.yml", "diffHunk": "@@ -0,0 +1,105 @@\n+name: Test\n+\n+on:\n+  pull_request:\n+  push:\n+    branches:\n+    - develop\n+    - main\n+    tags: '[0-9]+.[0-9]+.[0-9]+'\n+    paths-ignore:\n+    - 'README.md'\n+    - 'CODE_OF_CONDUCT.md'\n+    - 'CONTRIBUTING.md'\n+    - 'LICENSE'\n+    - 'SECURITY.md'\n+    - 'docs/**'\n+    - '.github/**'\n+    - '!.github/workflows/test.yml'\n+  release:\n+    types:\n+    - created\n+\n+# Keep in sync with codeql-analysis.yml and build.yml\n+env:\n+  CI: true\n+  node: 14.x\n+  java: 15\n+\n+jobs:\n+\n+  server-tests:\n+    if: github.event_name != 'release'\n+    runs-on: ubuntu-latest\n+    steps:\n+    - name: Setup Java\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: '${{ env.java }}'\n+    - uses: actions/checkout@v2\n+    - name: Cache Gradle dependencies\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.gradle/caches\n+        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle') }}\n+        restore-keys: |\n+          ${{ runner.os }}-gradle-\n+    - name: Java Tests\n+      run: ./gradlew --console=plain executeTests jacocoTestReport -x yarn -x webpack jacocoTestCoverageVerification\n+    - name: \"Codacy: Report coverage\"\n+      uses: codacy/codacy-coverage-reporter-action@master\n+      with:\n+        project-token: ${{ secrets.CODACY_PROJECT_TOKEN }}\n+        coverage-reports: build/reports/jacoco/test/jacocoTestReport.xml\n+      if: (github.event.pull_request.head.repo.full_name == github.event.pull_request.base.repo.full_name) && (success() || failure())\n+    - name: Java Code Style\n+      run: ./gradlew spotlessCheck\n+      if: success() || failure()\n+    - name: Java Documentation\n+      run: ./gradlew checkstyleMain -x yarn -x webpack\n+      if: success() || failure()", "originalCommit": "2a27ad2b9f4baf1d701231eeb7d2abc2232c7b1c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU5MzIxNw==", "url": "https://github.com/ls1intum/Artemis/pull/2380#discussion_r521593217", "bodyText": "Nice Idea. I separated the linting and tests in different jobs. \ud83d\udc4d", "author": "jpbernius", "createdAt": "2020-11-11T19:37:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ1MzAzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ1MzUxMA==", "url": "https://github.com/ls1intum/Artemis/pull/2380#discussion_r521453510", "bodyText": "Same suggestion as with the server test.", "author": "kloessst", "createdAt": "2020-11-11T15:50:30Z", "path": ".github/workflows/test.yml", "diffHunk": "@@ -0,0 +1,105 @@\n+name: Test\n+\n+on:\n+  pull_request:\n+  push:\n+    branches:\n+    - develop\n+    - main\n+    tags: '[0-9]+.[0-9]+.[0-9]+'\n+    paths-ignore:\n+    - 'README.md'\n+    - 'CODE_OF_CONDUCT.md'\n+    - 'CONTRIBUTING.md'\n+    - 'LICENSE'\n+    - 'SECURITY.md'\n+    - 'docs/**'\n+    - '.github/**'\n+    - '!.github/workflows/test.yml'\n+  release:\n+    types:\n+    - created\n+\n+# Keep in sync with codeql-analysis.yml and build.yml\n+env:\n+  CI: true\n+  node: 14.x\n+  java: 15\n+\n+jobs:\n+\n+  server-tests:\n+    if: github.event_name != 'release'\n+    runs-on: ubuntu-latest\n+    steps:\n+    - name: Setup Java\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: '${{ env.java }}'\n+    - uses: actions/checkout@v2\n+    - name: Cache Gradle dependencies\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.gradle/caches\n+        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle') }}\n+        restore-keys: |\n+          ${{ runner.os }}-gradle-\n+    - name: Java Tests\n+      run: ./gradlew --console=plain executeTests jacocoTestReport -x yarn -x webpack jacocoTestCoverageVerification\n+    - name: \"Codacy: Report coverage\"\n+      uses: codacy/codacy-coverage-reporter-action@master\n+      with:\n+        project-token: ${{ secrets.CODACY_PROJECT_TOKEN }}\n+        coverage-reports: build/reports/jacoco/test/jacocoTestReport.xml\n+      if: (github.event.pull_request.head.repo.full_name == github.event.pull_request.base.repo.full_name) && (success() || failure())\n+    - name: Java Code Style\n+      run: ./gradlew spotlessCheck\n+      if: success() || failure()\n+    - name: Java Documentation\n+      run: ./gradlew checkstyleMain -x yarn -x webpack\n+      if: success() || failure()\n+    - uses: ashley-taylor/junit-report-annotations-action@9ac2f823854c677f30e062dfe779445e33e5d380\n+      if: always()\n+      with:\n+        access-token: ${{ secrets.GITHUB_TOKEN }}\n+        path: build/test-results/test/*.xml\n+        numFailures: 99\n+\n+  client-tests:\n+    if: github.event_name != 'release'\n+    runs-on: ubuntu-latest\n+    steps:\n+    - name: Setup Node.js\n+      uses: actions/setup-node@v1\n+      with:\n+        node-version: '${{ env.node }}'\n+    - uses: actions/checkout@v2\n+    - name: Cache node modules\n+      uses: actions/cache@v2\n+      with:\n+        path: node_modules\n+        key: ${{ runner.os }}-node_modules-${{ hashFiles('**/yarn.lock') }}\n+        restore-keys: |\n+          ${{ runner.os }}-node_modules-\n+    - name: Install Dependencies\n+      run: yarn install\n+    - name: TypeScript Tests\n+      run: yarn test:coverage --ci\n+    - name: \"Codacy: Report coverage\"\n+      uses: codacy/codacy-coverage-reporter-action@master\n+      with:\n+          project-token: ${{ secrets.CODACY_PROJECT_TOKEN }}\n+          coverage-reports: coverage/lcov.info\n+      if: (github.event.pull_request.head.repo.full_name == github.event.pull_request.base.repo.full_name) && (success() || failure())\n+    - name: TypeScript Formatting\n+      run: yarn prettier:check\n+      if: success() || failure()\n+    - name: TypeScript Code Style\n+      run: yarn lint\n+      if: success() || failure()", "originalCommit": "2a27ad2b9f4baf1d701231eeb7d2abc2232c7b1c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7249cc555bfcb21fa2841677f928ceb5575b7270", "url": "https://github.com/ls1intum/Artemis/commit/7249cc555bfcb21fa2841677f928ceb5575b7270", "message": "Split build/test/docs\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>", "committedDate": "2020-11-11T19:35:20Z", "type": "commit"}, {"oid": "2ff891d3a20acebdd9b08a042ee39a140aa11e4a", "url": "https://github.com/ls1intum/Artemis/commit/2ff891d3a20acebdd9b08a042ee39a140aa11e4a", "message": "Bump Junit annotionss action\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>", "committedDate": "2020-11-11T19:35:20Z", "type": "commit"}, {"oid": "fa0c31cb8ac6f363df98d5a30891856ef81fa44a", "url": "https://github.com/ls1intum/Artemis/commit/fa0c31cb8ac6f363df98d5a30891856ef81fa44a", "message": "Rename new Workflows\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>", "committedDate": "2020-11-11T19:35:21Z", "type": "commit"}, {"oid": "59abbb635d49c23f46e46d8234e3d725a772dc32", "url": "https://github.com/ls1intum/Artemis/commit/59abbb635d49c23f46e46d8234e3d725a772dc32", "message": "Fix Cut/Paste mistake\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>", "committedDate": "2020-11-11T19:35:21Z", "type": "commit"}, {"oid": "2cea31ea0f5e306dd230e80c4a53ce9ac0620cdd", "url": "https://github.com/ls1intum/Artemis/commit/2cea31ea0f5e306dd230e80c4a53ce9ac0620cdd", "message": "Separate Tests & Documentation\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>", "committedDate": "2020-11-11T19:35:21Z", "type": "commit"}, {"oid": "2cea31ea0f5e306dd230e80c4a53ce9ac0620cdd", "url": "https://github.com/ls1intum/Artemis/commit/2cea31ea0f5e306dd230e80c4a53ce9ac0620cdd", "message": "Separate Tests & Documentation\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>", "committedDate": "2020-11-11T19:35:21Z", "type": "forcePushed"}, {"oid": "a3a029892c6814f68cb81c2bb854d9c414834e61", "url": "https://github.com/ls1intum/Artemis/commit/a3a029892c6814f68cb81c2bb854d9c414834e61", "message": "Remove unneeded success || failure\n\nSigned-off-by: Jan Philip Bernius <janphilip.bernius@tum.de>", "committedDate": "2020-11-11T19:36:51Z", "type": "commit"}]}