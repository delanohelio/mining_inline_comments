{"pr_number": 2174, "pr_title": "Improve registration: add more customization options", "pr_createdAt": "2020-10-07T12:11:55Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2174", "timeline": [{"oid": "a89b8df3410c66252fa46e0dda1aa7784fb7ed96", "url": "https://github.com/ls1intum/Artemis/commit/a89b8df3410c66252fa46e0dda1aa7784fb7ed96", "message": "bump version", "committedDate": "2020-10-07T07:30:01Z", "type": "commit"}, {"oid": "d6e5264439e40b8f21ad12e65414d164f8b2d206", "url": "https://github.com/ls1intum/Artemis/commit/d6e5264439e40b8f21ad12e65414d164f8b2d206", "message": "improve course registration\n\nimprove user login\nadd course registration message option\nimprove translations and add new explantions in course creation dialog", "committedDate": "2020-10-07T09:26:46Z", "type": "commit"}, {"oid": "54d6ad54916a863c53ff0fc660a7558404e69dc8", "url": "https://github.com/ls1intum/Artemis/commit/54d6ad54916a863c53ff0fc660a7558404e69dc8", "message": "fix some issues", "committedDate": "2020-10-07T10:04:27Z", "type": "commit"}, {"oid": "545d34efe31e539f093c751e00c0a039c9c51b15", "url": "https://github.com/ls1intum/Artemis/commit/545d34efe31e539f093c751e00c0a039c9c51b15", "message": "also allow users to register for courses without startDate or endDate", "committedDate": "2020-10-07T12:02:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk3NDgwMA==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r500974800", "bodyText": "Should we add that only users with a matching username (according to the regex) can register to the course to avoid confusion?", "author": "sleiss", "createdAt": "2020-10-07T12:34:35Z", "path": "src/main/webapp/i18n/en/course.json", "diffHunk": "@@ -54,8 +54,15 @@\n             \"startDate\": \"Start\",\n             \"endDate\": \"End\",\n             \"accessGroups\": \"Access Groups\",\n-            \"onlineCourse\": \"Online Course\",\n-            \"registrationEnabled\": \"Student Registration Enabled\",\n+            \"onlineCourse\": {\n+                \"title\": \"Online Course\",\n+                \"description\": \"Activate this checkbox for external online courses (e.g. on edX) so that students can use this Artemis course (via the LTI interface). This also allows automatic account creation if enabled by the Artemis system administrator.\"\n+            },\n+            \"registrationEnabled\": {\n+                \"title\": \"Student Course Registration Enabled\",\n+                \"description\": \"Activate this checkbox to allow students to register independently in the course if it is active (between start and end of the course). You can optionally enter a message that students have to confirm during registration.\"", "originalCommit": "545d34efe31e539f093c751e00c0a039c9c51b15", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTIzNTY1NA==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r501235654", "bodyText": "We could do that. However, the problem is that the instructors do not really know about those mechanisms.\nAlso this regex is really TUM specific. I don't even know if other universities would use this. At the TUM instance, we also have internal users (e.g. from online courses on edx) that should not be able to register and participate in normal university courses. In the TUM scenario, I would specify it like \"Activate this checkbox to allow TUM users to register independently...\"\nSo I am not sure how to formulate this in a more generic but still helpful way, that is not confusing, but that would still apply to other universities?", "author": "krusche", "createdAt": "2020-10-07T18:47:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk3NDgwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTIzNzk0MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r501237941", "bodyText": "Okay, so we would basically omit this declaration as by default, every user can register (as no username pattern is present).\nIf an administrator adds a pattern, he is responsible to inform other persons that might need this information.", "author": "sleiss", "createdAt": "2020-10-07T18:51:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk3NDgwMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk4MDg1OQ==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r500980859", "bodyText": "As this is also TUM specific (at least I guess so): Should we also make this configurable?", "author": "sleiss", "createdAt": "2020-10-07T12:43:55Z", "path": "src/main/java/de/tum/in/www1/artemis/config/Constants.java", "diffHunk": "@@ -51,10 +51,6 @@\n \n     public static final Pattern FILE_ENDING_PATTERN = Pattern.compile(FILE_ENDING_REGEX);\n \n-    public static final String TUM_USERNAME_REGEX = \"^([a-z]{2}\\\\d{2}[a-z]{3})\";\n-\n-    public static final Pattern TUM_USERNAME_PATTERN = Pattern.compile(TUM_USERNAME_REGEX);\n-\n     public static final Pattern TITLE_NAME_PATTERN = Pattern.compile(\"^[a-zA-Z0-9_\\\\-\\\\s]*\");\n \n     public static final String TUM_LDAP_MATRIKEL_NUMBER = \"imMatrikelNr\";", "originalCommit": "545d34efe31e539f093c751e00c0a039c9c51b15", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTIzNjQ5OA==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r501236498", "bodyText": "I would suggest we do this when someone requests it. The configuration becomes more and more complex, and I would like to avoid too many changes for now.", "author": "krusche", "createdAt": "2020-10-07T18:49:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk4MDg1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTIzNjgyNQ==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r501236825", "bodyText": "Sounds reasonable to me.", "author": "sleiss", "createdAt": "2020-10-07T18:49:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDk4MDg1OQ=="}], "type": "inlineReview"}, {"oid": "17ec63471d0d6026fedaaf21e7588965dcdfa71f", "url": "https://github.com/ls1intum/Artemis/commit/17ec63471d0d6026fedaaf21e7588965dcdfa71f", "message": "use rest template interceptors for Bamboo and Bitbucket and prefer token based authentication if avilable\n\nrename secret to token for Gitlab config to be more consistent", "committedDate": "2020-10-07T12:57:26Z", "type": "commit"}, {"oid": "b46c8097902d464230d04a4e865900f40e3aedea", "url": "https://github.com/ls1intum/Artemis/commit/b46c8097902d464230d04a4e865900f40e3aedea", "message": "improve comment", "committedDate": "2020-10-07T13:04:02Z", "type": "commit"}, {"oid": "a77af091379b0b2cc9c5f78a9f514fa6360a5229", "url": "https://github.com/ls1intum/Artemis/commit/a77af091379b0b2cc9c5f78a9f514fa6360a5229", "message": "fix wrong config", "committedDate": "2020-10-07T13:45:01Z", "type": "commit"}, {"oid": "42d848984cc65d096f11a3e0f6c95aa8ebd1a2af", "url": "https://github.com/ls1intum/Artemis/commit/42d848984cc65d096f11a3e0f6c95aa8ebd1a2af", "message": "fix config issues with new authorization", "committedDate": "2020-10-07T13:50:30Z", "type": "commit"}, {"oid": "3b10cbd899110c17786c72337bd9553666528e7d", "url": "https://github.com/ls1intum/Artemis/commit/3b10cbd899110c17786c72337bd9553666528e7d", "message": "fix javadoc issue", "committedDate": "2020-10-07T19:02:26Z", "type": "commit"}, {"oid": "4ffb13bb5b8a58072f7c6e256b3996ac6b79c1b8", "url": "https://github.com/ls1intum/Artemis/commit/4ffb13bb5b8a58072f7c6e256b3996ac6b79c1b8", "message": "update dependencies", "committedDate": "2020-10-07T19:12:53Z", "type": "commit"}, {"oid": "d1e6219ffa8ffc8ff8204e0be860cf4d87eff565", "url": "https://github.com/ls1intum/Artemis/commit/d1e6219ffa8ffc8ff8204e0be860cf4d87eff565", "message": "consistent use of \u201c in build.gradle", "committedDate": "2020-10-07T20:27:02Z", "type": "commit"}, {"oid": "2465cd32bb49a4deed0342d4f4d21925a941525e", "url": "https://github.com/ls1intum/Artemis/commit/2465cd32bb49a4deed0342d4f4d21925a941525e", "message": "update client dependencies", "committedDate": "2020-10-08T09:26:29Z", "type": "commit"}, {"oid": "eb436b940cea788a49d986223fa041ae9538dd5a", "url": "https://github.com/ls1intum/Artemis/commit/eb436b940cea788a49d986223fa041ae9538dd5a", "message": "use basic auth to create projects", "committedDate": "2020-10-08T09:26:41Z", "type": "commit"}, {"oid": "fd0f8c47f73c403fefa877ff521928365eb96b18", "url": "https://github.com/ls1intum/Artemis/commit/fd0f8c47f73c403fefa877ff521928365eb96b18", "message": "Merge branch 'develop' into feature/improve-registration", "committedDate": "2020-10-11T13:05:49Z", "type": "commit"}, {"oid": "db43b59d211dd6a0c66e537f95655f2272ba471c", "url": "https://github.com/ls1intum/Artemis/commit/db43b59d211dd6a0c66e537f95655f2272ba471c", "message": "Revert changes to continuous integration features that are not related to this PR", "committedDate": "2020-10-11T13:11:23Z", "type": "commit"}, {"oid": "f610da66073b5438f4a713a495866701b5eb2f24", "url": "https://github.com/ls1intum/Artemis/commit/f610da66073b5438f4a713a495866701b5eb2f24", "message": "revert more changes related to continuous integration", "committedDate": "2020-10-11T13:16:38Z", "type": "commit"}, {"oid": "7dd9a162e7f1f023850945b90bb730c2384518b4", "url": "https://github.com/ls1intum/Artemis/commit/7dd9a162e7f1f023850945b90bb730c2384518b4", "message": "revert unrelated changes", "committedDate": "2020-10-11T13:18:44Z", "type": "commit"}, {"oid": "031a09db400c0743bb637bd9382adfebcd9dfdaa", "url": "https://github.com/ls1intum/Artemis/commit/031a09db400c0743bb637bd9382adfebcd9dfdaa", "message": "update dependencies", "committedDate": "2020-10-11T13:36:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzMDEwMA==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r503230100", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    <div *ngIf=\"!accountName\" class=\"lead\" [jhiTranslate]=\"signInMessage\">Please sign in with your account.</div>\n          \n          \n            \n                    <div *ngIf=\"accountName\" class=\"lead\" [jhiTranslate]=\"signInMessage\" [translateValues]=\"{ account: accountName }\">Please sign in with your account.</div>\n          \n          \n            \n                    <div *ngIf=\"!accountName\" class=\"lead\" [jhiTranslate]=\"home.pleaseSignIn\">Please sign in with your account.</div>\n          \n          \n            \n                    <div *ngIf=\"accountName\" class=\"lead\" [jhiTranslate]=\"home. pleaseSignInAccount\" [translateValues]=\"{ account: accountName }\">Please sign in with your account.</div>", "author": "jpbernius", "createdAt": "2020-10-12T11:27:54Z", "path": "src/main/webapp/app/home/home.component.html", "diffHunk": "@@ -2,7 +2,8 @@\n     <div class=\"col-md-8 offset-md-2 text-center\">\n         <h1 jhiTranslate=\"home.title\">Welcome to Artemis!</h1>\n         <p class=\"lead\" jhiTranslate=\"home.subtitle\">Interactive Learning with Individual Feedback</p>\n-        <div class=\"lead\" [jhiTranslate]=\"signInMessage\">Please sign in with your account.</div>\n+        <div *ngIf=\"!accountName\" class=\"lead\" [jhiTranslate]=\"signInMessage\">Please sign in with your account.</div>\n+        <div *ngIf=\"accountName\" class=\"lead\" [jhiTranslate]=\"signInMessage\" [translateValues]=\"{ account: accountName }\">Please sign in with your account.</div>", "originalCommit": "031a09db400c0743bb637bd9382adfebcd9dfdaa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzMDMxOQ==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r503230319", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                signInMessage = 'home.pleaseSignIn'; // default, might be overridden based on profile info", "author": "jpbernius", "createdAt": "2020-10-12T11:28:21Z", "path": "src/main/webapp/app/home/home.component.ts", "diffHunk": "@@ -35,9 +32,11 @@ export class HomeComponent implements OnInit, AfterViewInit {\n     credentials: Credentials;\n     isRegistrationEnabled = false;\n \n-    usernameRegexPattern = TUM_USERNAME_REGEX; // default, might be overridden in ngOnInit\n-    signInMessage = 'home.pleaseSignInTUM'; // default, might be overridden in ngOnInit\n-    errorMesssageUsername = 'home.errors.tumWarning'; // default, might be overridden in ngOnInit\n+    // if the server is not connected to an external user management such as JIRA, we accept all valid username patterns\n+    usernameRegexPattern = /^[a-z0-9_-]{3,50}$/; // default, might be overridden in ngOnInit\n+    signInMessage = 'home.pleaseSignIn'; // default, might be overridden based on profile info", "originalCommit": "031a09db400c0743bb637bd9382adfebcd9dfdaa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzIzMDY4OQ==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r503230689", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (profileInfo.accountName) {\n          \n          \n            \n                                this.signInMessage = 'home.pleaseSignInAccount';\n          \n          \n            \n                            }", "author": "jpbernius", "createdAt": "2020-10-12T11:29:08Z", "path": "src/main/webapp/app/home/home.component.ts", "diffHunk": "@@ -60,26 +59,28 @@ export class HomeComponent implements OnInit, AfterViewInit {\n     ) {}\n \n     ngOnInit() {\n-        this.profileService\n-            .getProfileInfo()\n-            .pipe(\n-                filter(Boolean),\n-                tap((info: ProfileInfo) => {\n-                    if (!info.activeProfiles.includes('jira')) {\n-                        // if the server is not connected to an external user management such as JIRA, we accept all valid username patterns\n-                        this.usernameRegexPattern = /^[a-z0-9_-]{3,100}$/;\n-                        this.signInMessage = 'home.pleaseSignIn';\n-                        this.errorMesssageUsername = 'home.errors.usernameIncorrect';\n-                        this.externalUserManagementActive = false;\n-                    } else {\n-                        this.externalUserManagementUrl = info.externalUserManagementURL;\n-                        this.externalUserManagementName = info.externalUserManagementName;\n+        this.profileService.getProfileInfo().subscribe((profileInfo) => {\n+            if (profileInfo) {\n+                if (profileInfo.activeProfiles.includes('jira')) {\n+                    this.externalUserManagementUrl = profileInfo.externalUserManagementURL;\n+                    this.externalUserManagementName = profileInfo.externalUserManagementName;\n+                    if (profileInfo.allowedLdapUsernamePattern) {\n+                        this.usernameRegexPattern = new RegExp(profileInfo.allowedLdapUsernamePattern);\n                     }\n-\n-                    this.isRegistrationEnabled = info.registrationEnabled || false;\n-                }),\n-            )\n-            .subscribe();\n+                } else {\n+                    // TODO: in the future we might also allow external user management for non jira profiles\n+                    this.externalUserManagementActive = false;\n+                }\n+                if (profileInfo.accountName) {\n+                    this.signInMessage = 'home.pleaseSignInAccount';\n+                }", "originalCommit": "031a09db400c0743bb637bd9382adfebcd9dfdaa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8dca717b1701dbdf9c6ba9122e8923fad90eeae1", "url": "https://github.com/ls1intum/Artemis/commit/8dca717b1701dbdf9c6ba9122e8923fad90eeae1", "message": "Merge branch 'develop' into feature/improve-registration", "committedDate": "2020-10-13T17:05:00Z", "type": "commit"}, {"oid": "84778d9a84b741a904dec19bedcaeabb176c4d7d", "url": "https://github.com/ls1intum/Artemis/commit/84778d9a84b741a904dec19bedcaeabb176c4d7d", "message": "update dependencies", "committedDate": "2020-10-13T17:13:30Z", "type": "commit"}, {"oid": "4310e7888b52f62b9dfb16d200dd5b982a60b133", "url": "https://github.com/ls1intum/Artemis/commit/4310e7888b52f62b9dfb16d200dd5b982a60b133", "message": "simplify based on feedback", "committedDate": "2020-10-13T18:32:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI4ODA4OQ==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504288089", "bodyText": "I haven't seen code which truncates those messages to 255 characters on server side. Otherwise course creation could crash. Validation on client-side should also be done.", "author": "kloessst", "createdAt": "2020-10-13T22:11:37Z", "path": "src/main/resources/config/liquibase/changelog/20201007105032_changelog.xml", "diffHunk": "@@ -0,0 +1,8 @@\n+<?xml version=\"1.1\" encoding=\"UTF-8\" standalone=\"no\"?>\n+<databaseChangeLog xmlns=\"http://www.liquibase.org/xml/ns/dbchangelog\" xmlns:ext=\"http://www.liquibase.org/xml/ns/dbchangelog-ext\" xmlns:pro=\"http://www.liquibase.org/xml/ns/pro\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-3.9.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.9.xsd\">\n+<changeSet author=\"krusche\" id=\"20201007105032\">\n+    <addColumn tableName=\"course\">\n+        <column name=\"registration_confirmation_message\" type=\"VARCHAR(255)\"/>", "originalCommit": "4310e7888b52f62b9dfb16d200dd5b982a60b133", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI5MTY2MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504291661", "bodyText": "If this is the case, it might also be better to allow more than 255 characters.", "author": "MaisiKoleni", "createdAt": "2020-10-13T22:20:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI4ODA4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI5MjY0MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504292641", "bodyText": "Anyways, we still need to add some validation or truncation, otherwise we have a build logs 2.0 case \ud83d\ude04", "author": "kloessst", "createdAt": "2020-10-13T22:23:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI4ODA4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDMwMjgwMw==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504302803", "bodyText": "Good point, I added a basic validation", "author": "krusche", "createdAt": "2020-10-13T22:50:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI4ODA4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDI4OTUwMA==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504289500", "bodyText": "Could add something like Validators.maxLength(255) here", "author": "kloessst", "createdAt": "2020-10-13T22:14:59Z", "path": "src/main/webapp/app/course/manage/course-update.component.ts", "diffHunk": "@@ -113,6 +107,7 @@ export class CourseUpdateComponent implements OnInit {\n             }),\n             studentQuestionsEnabled: new FormControl(this.course.studentQuestionsEnabled),\n             registrationEnabled: new FormControl(this.course.registrationEnabled),\n+            registrationConfirmationMessage: new FormControl(this.course.registrationConfirmationMessage),", "originalCommit": "4310e7888b52f62b9dfb16d200dd5b982a60b133", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "db047885f13cdc82bac7eface009aaa2ca4769de", "url": "https://github.com/ls1intum/Artemis/commit/db047885f13cdc82bac7eface009aaa2ca4769de", "message": "Merge branch 'develop' into feature/improve-registration", "committedDate": "2020-10-13T22:44:52Z", "type": "commit"}, {"oid": "6d71c584812c5949bb5101e3dd75fbd79d880187", "url": "https://github.com/ls1intum/Artemis/commit/6d71c584812c5949bb5101e3dd75fbd79d880187", "message": "add basic validation", "committedDate": "2020-10-13T22:49:56Z", "type": "commit"}, {"oid": "5c961b53905b3fb1a016312bc42a993277bb57ff", "url": "https://github.com/ls1intum/Artemis/commit/5c961b53905b3fb1a016312bc42a993277bb57ff", "message": "fix small issues in client validation", "committedDate": "2020-10-14T13:22:00Z", "type": "commit"}, {"oid": "db0293f54c49eacbd3308583c6934666cebb97a1", "url": "https://github.com/ls1intum/Artemis/commit/db0293f54c49eacbd3308583c6934666cebb97a1", "message": "update client dependencies", "committedDate": "2020-10-14T13:39:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcwOTkyMg==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504709922", "bodyText": "An idea for a future PR might be to allow to customize this, so that other can also set specific warnings/error messages.(?)", "author": "FrankeLukas", "createdAt": "2020-10-14T14:10:57Z", "path": "src/main/webapp/app/home/home.component.ts", "diffHunk": "@@ -60,26 +58,25 @@ export class HomeComponent implements OnInit, AfterViewInit {\n     ) {}\n \n     ngOnInit() {\n-        this.profileService\n-            .getProfileInfo()\n-            .pipe(\n-                filter(Boolean),\n-                tap((info: ProfileInfo) => {\n-                    if (!info.activeProfiles.includes('jira')) {\n-                        // if the server is not connected to an external user management such as JIRA, we accept all valid username patterns\n-                        this.usernameRegexPattern = /^[a-z0-9_-]{3,100}$/;\n-                        this.signInMessage = 'home.pleaseSignIn';\n-                        this.errorMesssageUsername = 'home.errors.usernameIncorrect';\n-                        this.externalUserManagementActive = false;\n-                    } else {\n-                        this.externalUserManagementUrl = info.externalUserManagementURL;\n-                        this.externalUserManagementName = info.externalUserManagementName;\n+        this.profileService.getProfileInfo().subscribe((profileInfo) => {\n+            if (profileInfo) {\n+                if (profileInfo.activeProfiles.includes('jira')) {\n+                    this.externalUserManagementUrl = profileInfo.externalUserManagementURL;\n+                    this.externalUserManagementName = profileInfo.externalUserManagementName;\n+                    if (profileInfo.allowedLdapUsernamePattern) {\n+                        this.usernameRegexPattern = new RegExp(profileInfo.allowedLdapUsernamePattern);\n                     }\n-\n-                    this.isRegistrationEnabled = info.registrationEnabled || false;\n-                }),\n-            )\n-            .subscribe();\n+                } else {\n+                    // TODO: in the future we might also allow external user management for non jira profiles\n+                    this.externalUserManagementActive = false;\n+                }\n+                this.accountName = profileInfo.accountName;\n+                if (this.accountName === 'TUM') {", "originalCommit": "db0293f54c49eacbd3308583c6934666cebb97a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcxOTc5Ng==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504719796", "bodyText": "yes, we can do this in a follow-up. I was a bit lazy in the end ;-) and wanted to avoid too many config options.", "author": "krusche", "createdAt": "2020-10-14T14:23:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDcwOTkyMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MDUzOA==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504780538", "bodyText": "this can lead to a problem if a regex is specified with only a start or only a regex end e.g. ^[a-zA-Z0-9_\\-\\.\\+]+@(gmail.com) or [a-zA-Z0-9_\\-\\.\\+]+@(gmail.com)$\nwe would than wrap that again resulting in ^(^[a-zA-Z0-9_\\-\\.\\+]+@(gmail.com))$ or ^([a-zA-Z0-9_\\-\\.\\+]+@(gmail.com)$)$", "author": "TobiasPr", "createdAt": "2020-10-14T15:40:30Z", "path": "src/main/webapp/app/overview/course-registration-selector/course-registration-selector.component.ts", "diffHunk": "@@ -31,8 +31,14 @@ export class CourseRegistrationSelectorComponent implements OnInit {\n             this.profileService.getProfileInfo().subscribe((profileInfo) => {\n                 if (profileInfo) {\n                     if (profileInfo.allowedCourseRegistrationUsernamePattern) {\n-                        const regex = new RegExp(profileInfo.allowedCourseRegistrationUsernamePattern);\n-                        this.userIsAllowedToRegister = !!user!.login!.match(regex);\n+                        // we want to test for a full match, so wrap the regex in ^ and $\n+                        let regex = profileInfo.allowedCourseRegistrationUsernamePattern;\n+                        if (!regex.startsWith('^') && !regex.endsWith('$')) {", "originalCommit": "1bce51c36d706c9d5db3cfd6c2b98b4feea39b09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MzIyNA==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504783224", "bodyText": "That should be a || instead of &&. Will fix, thanks.", "author": "FrankeLukas", "createdAt": "2020-10-14T15:44:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MDUzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4Njg3OA==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r504786878", "bodyText": "never mind I think it is correct just got it wrong, but one question: what happens to the case when we do start only with ^ or end with $ should it then also be wrapped?", "author": "TobiasPr", "createdAt": "2020-10-14T15:49:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MDUzOA=="}], "type": "inlineReview"}, {"oid": "3035a009cae399d232eaeec16b0498ec52d9aa2a", "url": "https://github.com/ls1intum/Artemis/commit/3035a009cae399d232eaeec16b0498ec52d9aa2a", "message": "Make clientside course registration regex matching more robust", "committedDate": "2020-10-14T15:52:36Z", "type": "commit"}, {"oid": "3035a009cae399d232eaeec16b0498ec52d9aa2a", "url": "https://github.com/ls1intum/Artemis/commit/3035a009cae399d232eaeec16b0498ec52d9aa2a", "message": "Make clientside course registration regex matching more robust", "committedDate": "2020-10-14T15:52:36Z", "type": "forcePushed"}, {"oid": "38dffc44867ffed2d970e1a41a176623a3e6f1e6", "url": "https://github.com/ls1intum/Artemis/commit/38dffc44867ffed2d970e1a41a176623a3e6f1e6", "message": "Create a helper util for matching a regex fully", "committedDate": "2020-10-14T16:23:11Z", "type": "commit"}, {"oid": "6f02c800a4ee2cef0db184cfd40a93610e2b44f2", "url": "https://github.com/ls1intum/Artemis/commit/6f02c800a4ee2cef0db184cfd40a93610e2b44f2", "message": "fix undefined / null issue found in review", "committedDate": "2020-10-14T16:29:58Z", "type": "commit"}, {"oid": "a5188f6896619f244ce77b3746865abf144ee044", "url": "https://github.com/ls1intum/Artemis/commit/a5188f6896619f244ce77b3746865abf144ee044", "message": "Don't add only one parenthesis", "committedDate": "2020-10-14T16:32:17Z", "type": "commit"}, {"oid": "54f845c08e22ef9a8860a7941e02fb7b9373d33c", "url": "https://github.com/ls1intum/Artemis/commit/54f845c08e22ef9a8860a7941e02fb7b9373d33c", "message": "Merge branch 'develop' into feature/improve-registration", "committedDate": "2020-10-14T21:17:14Z", "type": "commit"}, {"oid": "42f4c19a39934efd517e7d5589c966dddd5dde4a", "url": "https://github.com/ls1intum/Artemis/commit/42f4c19a39934efd517e7d5589c966dddd5dde4a", "message": "add additional course validation so that online course and registration enabled cannot be active at the same time", "committedDate": "2020-10-14T21:44:12Z", "type": "commit"}, {"oid": "bf0d10af2ed6ee4396a1013cccf9d21cbdb0c2f3", "url": "https://github.com/ls1intum/Artemis/commit/bf0d10af2ed6ee4396a1013cccf9d21cbdb0c2f3", "message": "fix checkstyle issue", "committedDate": "2020-10-14T22:20:48Z", "type": "commit"}, {"oid": "3640b7b7b4f2c682df200542ca909dc91bffbae0", "url": "https://github.com/ls1intum/Artemis/commit/3640b7b7b4f2c682df200542ca909dc91bffbae0", "message": "update client dependencies", "committedDate": "2020-10-14T22:22:47Z", "type": "commit"}, {"oid": "de7fd1cea6a1099995c640d16b25d338e2d15d08", "url": "https://github.com/ls1intum/Artemis/commit/de7fd1cea6a1099995c640d16b25d338e2d15d08", "message": "Merge branch 'develop' into feature/improve-registration", "committedDate": "2020-10-14T22:23:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU1MDYwMw==", "url": "https://github.com/ls1intum/Artemis/pull/2174#discussion_r505550603", "bodyText": "\ud83d\udc4d", "author": "1-alex98", "createdAt": "2020-10-15T13:40:27Z", "path": "src/main/webapp/app/overview/course-registration-selector/course-registration-selector.component.html", "diffHunk": "@@ -1,44 +1,49 @@\n <div *ngIf=\"courses\">\n-    <div class=\"col-12 col-sm-auto\" *ngIf=\"!showCourseSelection && !addedSuccessful && isTumStudent\">", "originalCommit": "de7fd1cea6a1099995c640d16b25d338e2d15d08", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}