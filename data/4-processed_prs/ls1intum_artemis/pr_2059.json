{"pr_number": 2059, "pr_title": "Adapted quiz statistics bar labels to the behaviour of exam scores", "pr_createdAt": "2020-08-25T21:20:43Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2059", "timeline": [{"oid": "8e819b03dd3bc684ff10dac41851be2d2ed85995", "url": "https://github.com/ls1intum/Artemis/commit/8e819b03dd3bc684ff10dac41851be2d2ed85995", "message": "Adapted quiz statistics bar labels to the behaviour of exam scores", "committedDate": "2020-08-25T21:18:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU4OTE5NQ==", "url": "https://github.com/ls1intum/Artemis/pull/2059#discussion_r478589195", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        dataSetProvider.getDataSets().forEach(function (dataset: DataSet, i: number) {\n          \n          \n            \n                        dataSetProvider.getDataSets().forEach((dataset: DataSet, i: number) =>  {", "author": "TobiasPr", "createdAt": "2020-08-27T17:42:30Z", "path": "src/main/webapp/app/exercises/quiz/manage/statistics/quiz-statistic/quiz-statistic.component.ts", "diffHunk": "@@ -79,52 +80,21 @@ export function createAnimation(dataSetProvider: DataSetProvider): ChartAnimatio\n     return {\n         duration: 500,\n         onComplete: (chartElement: ChartElement) => {\n-            const chart = chartElement.chart;\n-            const ctx = chart.ctx!;\n-            const fontSize = 12;\n-            const fontStyle = 'normal';\n-            const fontFamily = 'Arial';\n-            ctx.font = Chart.helpers.fontString(fontSize, fontStyle, fontFamily);\n-            ctx.textAlign = 'center';\n-            ctx.textBaseline = 'middle';\n+            const chartInstance = chartElement.chart,\n+                ctx = chartInstance.ctx!;\n \n+            ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);\n+            ctx.textAlign = 'center';\n+            ctx.textBaseline = 'bottom';\n             const participants = dataSetProvider.getParticipants();\n-            dataSetProvider.getDataSets().forEach((dataset, i) => {\n-                const meta = chart.getDatasetMeta(i);\n-                meta.data.forEach((bar: any, index) => {\n+\n+            dataSetProvider.getDataSets().forEach(function (dataset: DataSet, i: number) {", "originalCommit": "8e819b03dd3bc684ff10dac41851be2d2ed85995", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU4OTcyMg==", "url": "https://github.com/ls1intum/Artemis/pull/2059#discussion_r478589722", "bodyText": "maybe also rename i to index", "author": "TobiasPr", "createdAt": "2020-08-27T17:43:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU4OTE5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU5MDEzMQ==", "url": "https://github.com/ls1intum/Artemis/pull/2059#discussion_r478590131", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            meta.data.forEach(function (bar: any, index: number) {\n          \n          \n            \n                            meta.data.forEach((bar: any, index: number) => {", "author": "TobiasPr", "createdAt": "2020-08-27T17:44:02Z", "path": "src/main/webapp/app/exercises/quiz/manage/statistics/quiz-statistic/quiz-statistic.component.ts", "diffHunk": "@@ -79,52 +80,21 @@ export function createAnimation(dataSetProvider: DataSetProvider): ChartAnimatio\n     return {\n         duration: 500,\n         onComplete: (chartElement: ChartElement) => {\n-            const chart = chartElement.chart;\n-            const ctx = chart.ctx!;\n-            const fontSize = 12;\n-            const fontStyle = 'normal';\n-            const fontFamily = 'Arial';\n-            ctx.font = Chart.helpers.fontString(fontSize, fontStyle, fontFamily);\n-            ctx.textAlign = 'center';\n-            ctx.textBaseline = 'middle';\n+            const chartInstance = chartElement.chart,\n+                ctx = chartInstance.ctx!;\n \n+            ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, Chart.defaults.global.defaultFontStyle, Chart.defaults.global.defaultFontFamily);\n+            ctx.textAlign = 'center';\n+            ctx.textBaseline = 'bottom';\n             const participants = dataSetProvider.getParticipants();\n-            dataSetProvider.getDataSets().forEach((dataset, i) => {\n-                const meta = chart.getDatasetMeta(i);\n-                meta.data.forEach((bar: any, index) => {\n+\n+            dataSetProvider.getDataSets().forEach(function (dataset: DataSet, i: number) {\n+                const meta = chartInstance.getDatasetMeta(i);\n+                meta.data.forEach(function (bar: any, index: number) {", "originalCommit": "8e819b03dd3bc684ff10dac41851be2d2ed85995", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU5MjI1Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2059#discussion_r478592252", "bodyText": "what are you doing here, can't we jsut do Math.max(...data) (do we need the const merged = [].concat.apply([],data))", "author": "TobiasPr", "createdAt": "2020-08-27T17:47:57Z", "path": "src/main/webapp/app/exercises/quiz/manage/statistics/quiz-statistic/quiz-statistic.component.ts", "diffHunk": "@@ -136,6 +106,15 @@ export interface DataSetProvider {\n     getParticipants(): number;\n }\n \n+export function calculateTickMax(datasetProvider: DataSetProvider) {\n+    const data = datasetProvider.getDataSets().map((dataset) => {\n+        return dataset.data;\n+    });\n+    const merged = [].concat.apply([], data);\n+    const max = Math.max(...merged);", "originalCommit": "8e819b03dd3bc684ff10dac41851be2d2ed85995", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODY3MTMxNQ==", "url": "https://github.com/ls1intum/Artemis/pull/2059#discussion_r478671315", "bodyText": "should then be Math.max([...data]) I think.", "author": "fde312", "createdAt": "2020-08-27T20:17:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU5MjI1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODkxMjY3NQ==", "url": "https://github.com/ls1intum/Artemis/pull/2059#discussion_r478912675", "bodyText": "Hi the type of data is number[][] so we need to flatten it first one level", "author": "stefanwaldhauser", "createdAt": "2020-08-28T08:01:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU5MjI1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODkyMjU3OA==", "url": "https://github.com/ls1intum/Artemis/pull/2059#discussion_r478922578", "bodyText": "I modified the code a little to make it more clearer", "author": "stefanwaldhauser", "createdAt": "2020-08-28T08:11:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU5MjI1Mg=="}], "type": "inlineReview"}, {"oid": "1438606f39cce1a37cd8c2466ec31f6d52206964", "url": "https://github.com/ls1intum/Artemis/commit/1438606f39cce1a37cd8c2466ec31f6d52206964", "message": "Merge branch 'develop' into change-quiz-bar-chart-label", "committedDate": "2020-08-27T20:31:18Z", "type": "commit"}, {"oid": "d154f39d04c587ec30d977a2b6121f2a6f52acb0", "url": "https://github.com/ls1intum/Artemis/commit/d154f39d04c587ec30d977a2b6121f2a6f52acb0", "message": "Update src/main/webapp/app/exercises/quiz/manage/statistics/quiz-statistic/quiz-statistic.component.ts\n\nCo-authored-by: Tobias Priesching <tobias.priesching@gmail.com>", "committedDate": "2020-08-28T08:03:19Z", "type": "commit"}, {"oid": "4784936e208795f827adbcc19a108b2834114997", "url": "https://github.com/ls1intum/Artemis/commit/4784936e208795f827adbcc19a108b2834114997", "message": "Update src/main/webapp/app/exercises/quiz/manage/statistics/quiz-statistic/quiz-statistic.component.ts\n\nCo-authored-by: Tobias Priesching <tobias.priesching@gmail.com>", "committedDate": "2020-08-28T08:04:35Z", "type": "commit"}, {"oid": "37c620214a7d8c1e54f4de9e1a9a5881b3472445", "url": "https://github.com/ls1intum/Artemis/commit/37c620214a7d8c1e54f4de9e1a9a5881b3472445", "message": "Renamed Indexes to a more sensible name", "committedDate": "2020-08-28T08:10:54Z", "type": "commit"}, {"oid": "e41de71d13e6074c513e52ddd520d86bec7480c5", "url": "https://github.com/ls1intum/Artemis/commit/e41de71d13e6074c513e52ddd520d86bec7480c5", "message": "Made flatten code more clear", "committedDate": "2020-08-28T08:11:11Z", "type": "commit"}, {"oid": "2cfdc837a4e91d04b6ffedcf58b8305ecf867450", "url": "https://github.com/ls1intum/Artemis/commit/2cfdc837a4e91d04b6ffedcf58b8305ecf867450", "message": "Merge branch 'develop' into change-quiz-bar-chart-label", "committedDate": "2020-08-28T08:20:05Z", "type": "commit"}, {"oid": "fa02d45dc38bdb70c5810a14cdf45f7acfc7ee44", "url": "https://github.com/ls1intum/Artemis/commit/fa02d45dc38bdb70c5810a14cdf45f7acfc7ee44", "message": "Merge branch 'develop' into change-quiz-bar-chart-label", "committedDate": "2020-08-28T11:38:06Z", "type": "commit"}, {"oid": "dda07b80e12e984112f55a18efa6f36a570f6f2c", "url": "https://github.com/ls1intum/Artemis/commit/dda07b80e12e984112f55a18efa6f36a570f6f2c", "message": "Merge branch 'develop' into change-quiz-bar-chart-label", "committedDate": "2020-09-01T12:02:29Z", "type": "commit"}, {"oid": "87315d3c29e4086ab0e6a0328c2da6b0b5a713fc", "url": "https://github.com/ls1intum/Artemis/commit/87315d3c29e4086ab0e6a0328c2da6b0b5a713fc", "message": "Fixed type error", "committedDate": "2020-09-01T13:03:05Z", "type": "commit"}, {"oid": "ce794bbcc3a4e81c663c77fdbc78889f244eadc7", "url": "https://github.com/ls1intum/Artemis/commit/ce794bbcc3a4e81c663c77fdbc78889f244eadc7", "message": "Merge branch 'develop' into change-quiz-bar-chart-label", "committedDate": "2020-09-05T17:26:24Z", "type": "commit"}, {"oid": "4310743ed2686ff89aad047902f12ccaeaa9882a", "url": "https://github.com/ls1intum/Artemis/commit/4310743ed2686ff89aad047902f12ccaeaa9882a", "message": "Merge branch 'develop' into change-quiz-bar-chart-label", "committedDate": "2020-09-21T16:43:50Z", "type": "commit"}]}