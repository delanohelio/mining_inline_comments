{"pr_number": 3332, "pr_title": "DB-8949 Decouple OlapServer from HMaster", "pr_createdAt": "2020-03-20T17:04:52Z", "pr_url": "https://github.com/splicemachine/spliceengine/pull/3332", "timeline": [{"oid": "d1d175a156b9bbebfbfe03e9a430de6a48fe8fb4", "url": "https://github.com/splicemachine/spliceengine/commit/d1d175a156b9bbebfbfe03e9a430de6a48fe8fb4", "message": "DB-8949 Decouple OlapServer from HMaster\n\nAllow for Kubernetes-based deployment", "committedDate": "2020-03-19T11:51:53Z", "type": "commit"}, {"oid": "9339e6e435cab2c5803c54e02f2441c61e218a67", "url": "https://github.com/splicemachine/spliceengine/commit/9339e6e435cab2c5803c54e02f2441c61e218a67", "message": "DB-8949 Retry Olap Server submission if failure is ConnectionEx", "committedDate": "2020-03-19T14:13:00Z", "type": "commit"}, {"oid": "5f2400f816e211e9d375d8797b824f89b9f2b956", "url": "https://github.com/splicemachine/spliceengine/commit/5f2400f816e211e9d375d8797b824f89b9f2b956", "message": "DB-8949 Add diagnostics to OlapServer connection exceptions", "committedDate": "2020-03-20T15:31:50Z", "type": "commit"}, {"oid": "c2e90dc9850634f8981d711afaafc14cbc69b728", "url": "https://github.com/splicemachine/spliceengine/commit/c2e90dc9850634f8981d711afaafc14cbc69b728", "message": "DB-8949 Create ZK paths on OlapServerMaster too", "committedDate": "2020-04-01T09:13:10Z", "type": "commit"}, {"oid": "6f3d1dc72bce799169c362c5554d1397a5b9330d", "url": "https://github.com/splicemachine/spliceengine/commit/6f3d1dc72bce799169c362c5554d1397a5b9330d", "message": "DB-8949 Create Persistent ZK nodes", "committedDate": "2020-04-03T12:09:32Z", "type": "commit"}, {"oid": "5250a4c31ad808cb04b72e03fe66418bd6070209", "url": "https://github.com/splicemachine/spliceengine/commit/5250a4c31ad808cb04b72e03fe66418bd6070209", "message": "Merge remote-tracking branch 'origin/master' into DB-8949", "committedDate": "2020-04-22T10:00:02Z", "type": "commit"}, {"oid": "bff77dc2f1cde23a365d6e834d51f053e1ad00f2", "url": "https://github.com/splicemachine/spliceengine/commit/bff77dc2f1cde23a365d6e834d51f053e1ad00f2", "message": "DB-8949 Address SpotBugs issues", "committedDate": "2020-04-22T17:54:00Z", "type": "commit"}, {"oid": "bff77dc2f1cde23a365d6e834d51f053e1ad00f2", "url": "https://github.com/splicemachine/spliceengine/commit/bff77dc2f1cde23a365d6e834d51f053e1ad00f2", "message": "DB-8949 Address SpotBugs issues", "committedDate": "2020-04-22T17:54:00Z", "type": "forcePushed"}, {"oid": "801b3ab69e30333b4fd9a1b356d400063b376f04", "url": "https://github.com/splicemachine/spliceengine/commit/801b3ab69e30333b4fd9a1b356d400063b376f04", "message": "DB-8949 SpotBugs", "committedDate": "2020-04-27T08:21:08Z", "type": "commit"}, {"oid": "ebc92c680f7573b77d9d10a4b095046bde83db8e", "url": "https://github.com/splicemachine/spliceengine/commit/ebc92c680f7573b77d9d10a4b095046bde83db8e", "message": "Merge branch 'master' into DB-8949", "committedDate": "2020-05-06T17:34:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTA4Njk5Mw==", "url": "https://github.com/splicemachine/spliceengine/pull/3332#discussion_r421086993", "bodyText": "looks good, although i don't understand everything. are server names always of the form xxxxNUM, where NUM is 10 digits?", "author": "martinrupp", "createdAt": "2020-05-06T20:56:58Z", "path": "hbase_sql/src/main/java/com/splicemachine/olap/OlapServerZNode.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package com.splicemachine.olap;\n+\n+import java.util.Objects;\n+\n+public class OlapServerZNode implements Comparable<OlapServerZNode> {\n+    private String queueName;\n+    private int sequence;\n+\n+    public OlapServerZNode(String queueName, int sequence) {\n+        this.queueName = queueName;\n+        this.sequence = sequence;\n+    }\n+\n+    public String getQueueName() {\n+        return queueName;\n+    }\n+\n+    public long getSequence() {\n+        return sequence;\n+    }\n+\n+    public String toZNode() {", "originalCommit": "ebc92c680f7573b77d9d10a4b095046bde83db8e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI4MDE2Mw==", "url": "https://github.com/splicemachine/spliceengine/pull/3332#discussion_r421280163", "bodyText": "To avoid duplicates each OlapServer registers itself in ZooKeeper using a sequence node, which appends a unique identifier at the end to guarantee uniqueness.", "author": "dgomezferro", "createdAt": "2020-05-07T06:58:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTA4Njk5Mw=="}], "type": "inlineReview"}]}