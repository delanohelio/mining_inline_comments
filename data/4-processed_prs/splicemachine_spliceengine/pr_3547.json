{"pr_number": 3547, "pr_title": "DB-9402: fix bulk delete using index lookup", "pr_createdAt": "2020-05-06T22:09:15Z", "pr_url": "https://github.com/splicemachine/spliceengine/pull/3547", "timeline": [{"oid": "f3d31a90493a997a5bbc4a41f9905a078d63d42e", "url": "https://github.com/splicemachine/spliceengine/commit/f3d31a90493a997a5bbc4a41f9905a078d63d42e", "message": "DB-9402: fix bulk delete using index lookup", "committedDate": "2020-05-06T22:00:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTE2MDY0Ng==", "url": "https://github.com/splicemachine/spliceengine/pull/3547#discussion_r421160646", "bodyText": "@jyuanca How the setting of BulkFetch affects the index deletion for BulkDelete? Thanks!", "author": "yxia92", "createdAt": "2020-05-07T00:01:40Z", "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/compile/FromBaseTable.java", "diffHunk": "@@ -1715,7 +1722,7 @@ else if(isOneRowResultSet()){\n                 !(trulyTheBestJoinStrategy.ignoreBulkFetch()) &&\n                 !bulkFetchTurnedOff &&\n                 (bulkFetch==UNSET) &&\n-                !forUpdate() &&\n+                (!forUpdate() || isBulkDelete)&&", "originalCommit": "f3d31a90493a997a5bbc4a41f9905a078d63d42e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzMyNDY0NA==", "url": "https://github.com/splicemachine/spliceengine/pull/3547#discussion_r423324644", "bodyText": "This is to enable bulk delete to bulk fetch index rows and look up all columns of all indexes from base table, similar to select all columns of all indexes from base table using index lookup. The returned based row contains all columns of all indexes, and is used to generated delete marker for all indexes.\nFor regular delete, index columns are returned from base table by index lookup. Index columns are returned by index write handler.", "author": "jyuanca", "createdAt": "2020-05-11T21:16:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTE2MDY0Ng=="}], "type": "inlineReview"}]}