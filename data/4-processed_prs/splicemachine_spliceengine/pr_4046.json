{"pr_number": 4046, "pr_title": "DB-9749 sync user roles before running remote queries.", "pr_createdAt": "2020-08-25T11:10:00Z", "pr_url": "https://github.com/splicemachine/spliceengine/pull/4046", "timeline": [{"oid": "55365c9966969bffaf7a0da9079d2ee35c407ac0", "url": "https://github.com/splicemachine/spliceengine/commit/55365c9966969bffaf7a0da9079d2ee35c407ac0", "message": "DB-9749 sync user roles before running remote queries.", "committedDate": "2020-08-25T10:53:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjU2MjEzNQ==", "url": "https://github.com/splicemachine/spliceengine/pull/4046#discussion_r476562135", "bodyText": "We can skip the check of roles if user is database owner or he/belong to the admin group, and use the requestedQueue directly.", "author": "yxia92", "createdAt": "2020-08-25T16:02:23Z", "path": "hbase_sql/src/main/java/com/splicemachine/stream/RemoteQueryClientImpl.java", "diffHunk": "@@ -122,6 +122,8 @@ public void submit() throws StandardException {\n                     streamingBatches, streamingBatchSize, parallelPartitions, shufflePartitionsProperty);\n \n             String requestedQueue = (String) activation.getLanguageConnectionContext().getSessionProperties().getProperty(SessionProperties.PROPERTYNAME.OLAPQUEUE);\n+            // remove any stale revoked roles (DB-9749)", "originalCommit": "55365c9966969bffaf7a0da9079d2ee35c407ac0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4cbb514e24bc0e51855a23ee61a54ea3c5452770", "url": "https://github.com/splicemachine/spliceengine/commit/4cbb514e24bc0e51855a23ee61a54ea3c5452770", "message": "DB-9749 avoid checking role for admin users.\n\n- refreshing roles could be an expensive operation. Since database\n  owner has all permissions, no need to check role checking, either\n  directly use the rqeuested queue, or fallback to default one if\n  the requested queue is null.", "committedDate": "2020-08-25T18:02:23Z", "type": "commit"}, {"oid": "b8c3493254738963f164370f4d8bb70b04fb9be1", "url": "https://github.com/splicemachine/spliceengine/commit/b8c3493254738963f164370f4d8bb70b04fb9be1", "message": "DB-9749 Strengthen DBO check.\n\n- check not only whether the user is DBO, but also whether the user\n  is part of a DBO user group.", "committedDate": "2020-08-25T18:15:53Z", "type": "commit"}]}