{"pr_number": 5112, "pr_title": "java 8 only", "pr_createdAt": "2020-10-23T03:19:36Z", "pr_url": "https://github.com/geonetwork/core-geonetwork/pull/5112", "timeline": [{"oid": "318e394e0ee7bf69a23fa9090ffa3dab7639b7a3", "url": "https://github.com/geonetwork/core-geonetwork/commit/318e394e0ee7bf69a23fa9090ffa3dab7639b7a3", "message": "java 8 only", "committedDate": "2020-10-23T04:00:12Z", "type": "forcePushed"}, {"oid": "953e963cbf5315674950f171b6d7c973c9dbbe4f", "url": "https://github.com/geonetwork/core-geonetwork/commit/953e963cbf5315674950f171b6d7c973c9dbbe4f", "message": "java 8 only", "committedDate": "2020-10-23T04:15:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY0MzAyMQ==", "url": "https://github.com/geonetwork/core-geonetwork/pull/5112#discussion_r510643021", "bodyText": "From the pom.xml it should be ~/.m2/toolchains.xml instead of ~/.m2/toolchain.xml\nI tested the configuration and seem pick up, but the startup error about the version occurs if the default version is 11:\n[INFO] --- maven-toolchains-plugin:3.0.0:toolchain (default) @ web-app ---\n[INFO] Required toolchain: jdk [ version='8' ]\n[INFO] Found matching toolchain for type jdk: JDK[/PATH/candidates/java/8.0.201-oracle]\n\n...\n\n[INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ web-app ---\n[INFO] Toolchain in maven-compiler-plugin: JDK[/PATH/candidates/java/8.0.201-oracle]\n[INFO] Changes detected - recompiling the module!\n[INFO] Compiling 11 source files to /core-geonetwork/web/target/test-classes\n...\n2020-10-23 07:58:42,184 FATAL [jeeves.engine] -    Exception : java.lang.RuntimeException: Java 8 required, cannot start with \"11.0.8\"\n2020-10-23 07:58:42,189 FATAL [jeeves.engine] -    Message   : Java 8 required, cannot start with \"11.0.8\"\n2020-10-23 07:58:42,192 FATAL [jeeves.engine] -    Stack     : java.lang.RuntimeException: Java 8 required, cannot start with \"11.0.8\"\n\tat jeeves.config.springutil.JeevesContextLoaderListener.contextInitialized(JeevesContextLoaderListener.java:63)\n\n\nApart of the toolchain stuff, the change works fine, starts up fine with Java 8 and throws the exception if other version is used.", "author": "josegar74", "createdAt": "2020-10-23T06:02:01Z", "path": "software_development/BUILDING.md", "diffHunk": "@@ -97,3 +97,26 @@ For changes related to the user interface in the `web-ui` module or the metadata\n ```\n mvn process-resources\n ```\n+\n+Tool chain\n+----------\n+\n+GeoNetwork requires Java 8 at this time. If you have multiple JDK environments installed\n+our build can make use of an optional `~/.m2/toolchain.xml` file.", "originalCommit": "953e963cbf5315674950f171b6d7c973c9dbbe4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY2MTIzNA==", "url": "https://github.com/geonetwork/core-geonetwork/pull/5112#discussion_r510661234", "bodyText": "That is odd, the surefire plugin must be picking up the wrong JDK. Let me check version numbers on the surefire plugin (to ensure it is new enough to be aware of tool chain).", "author": "jodygarnett", "createdAt": "2020-10-23T06:26:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY0MzAyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY3NTUzMw==", "url": "https://github.com/geonetwork/core-geonetwork/pull/5112#discussion_r510675533", "bodyText": "This is working for me locally, tried updating the surefire plugin to 3.0.0-M5 and that still works.\nStill, since this is not important, I have pushed it up as two commits to the PR. You can accept (since toolchains.xml is optional) or just cherry-pick the one change.", "author": "jodygarnett", "createdAt": "2020-10-23T07:02:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDY0MzAyMQ=="}], "type": "inlineReview"}, {"oid": "611220a19af3160ef1071a8aecaae25335398c58", "url": "https://github.com/geonetwork/core-geonetwork/commit/611220a19af3160ef1071a8aecaae25335398c58", "message": "Check java 8 on Jeeves startup\n\nFailing here will prevent geonetwork from loading in an unsupported environment (and provide a clear error message).", "committedDate": "2020-10-23T07:00:24Z", "type": "commit"}, {"oid": "77e8618942869f2496ed4b8c4ed98fbf1b2d652f", "url": "https://github.com/geonetwork/core-geonetwork/commit/77e8618942869f2496ed4b8c4ed98fbf1b2d652f", "message": "Optional use of toolchains.xml to always build on JDK 8", "committedDate": "2020-10-23T07:01:03Z", "type": "commit"}, {"oid": "77e8618942869f2496ed4b8c4ed98fbf1b2d652f", "url": "https://github.com/geonetwork/core-geonetwork/commit/77e8618942869f2496ed4b8c4ed98fbf1b2d652f", "message": "Optional use of toolchains.xml to always build on JDK 8", "committedDate": "2020-10-23T07:01:03Z", "type": "forcePushed"}]}