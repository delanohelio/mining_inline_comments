{"pr_number": 2903, "pr_title": "Add yaml as text based media type", "pr_createdAt": "2020-03-09T21:14:49Z", "pr_url": "https://github.com/micronaut-projects/micronaut-core/pull/2903", "timeline": [{"oid": "6727988912036bf169198a3d3bf89d7d897aa5f1", "url": "https://github.com/micronaut-projects/micronaut-core/commit/6727988912036bf169198a3d3bf89d7d897aa5f1", "message": "Add yaml as text based media type\n\nso that it can be compressed when served.", "committedDate": "2020-03-09T21:13:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3MjY1Nw==", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2903#discussion_r390972657", "bodyText": "Is there a reason why only x-yaml is checked?", "author": "graemerocher", "createdAt": "2020-03-11T13:34:26Z", "path": "http/src/main/java/io/micronaut/http/MediaType.java", "diffHunk": "@@ -532,9 +532,9 @@ public CharSequence subSequence(int start, int end) {\n      * @return Whether the media type is text based\n      */\n     public boolean isTextBased() {\n-        boolean matches = textTypePatterns.stream().anyMatch((p) -> p.matcher(name).matches());\n+        boolean matches = textTypePatterns.stream().anyMatch(p -> p.matcher(name).matches());\n         if (!matches) {\n-            matches = subtype.equalsIgnoreCase(\"json\") || subtype.equalsIgnoreCase(\"xml\");\n+            matches = subtype.equalsIgnoreCase(\"json\") || subtype.equalsIgnoreCase(\"xml\") || subtype.equalsIgnoreCase(\"x-yaml\");", "originalCommit": "6727988912036bf169198a3d3bf89d7d897aa5f1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NTQ2NQ==", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2903#discussion_r390975465", "bodyText": "Well the media type is application/x-yaml and text/yaml will be matched by the textTypePatterns.", "author": "croudet", "createdAt": "2020-03-11T13:38:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3MjY1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3NzI5NA==", "url": "https://github.com/micronaut-projects/micronaut-core/pull/2903#discussion_r390977294", "bodyText": "I can add a pattern if you want:\ntextTypePatterns.add(Pattern.compile(\"^.*\\\\+yaml$\"));", "author": "croudet", "createdAt": "2020-03-11T13:41:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk3MjY1Nw=="}], "type": "inlineReview"}]}