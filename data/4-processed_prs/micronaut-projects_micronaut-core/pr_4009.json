{"pr_number": 4009, "pr_title": "Fix for method argument annotation visitors.", "pr_createdAt": "2020-09-02T18:39:46Z", "pr_url": "https://github.com/micronaut-projects/micronaut-core/pull/4009", "timeline": [{"oid": "31af87f9de8b0f53403d70a53d30ccaaeba14a4d", "url": "https://github.com/micronaut-projects/micronaut-core/commit/31af87f9de8b0f53403d70a53d30ccaaeba14a4d", "message": "Test to make sure method arguments can be annotated using element visitor.", "committedDate": "2020-09-02T17:38:42Z", "type": "commit"}, {"oid": "c22d081be4929d46529f0e28e2ccd18fab218b30", "url": "https://github.com/micronaut-projects/micronaut-core/commit/c22d081be4929d46529f0e28e2ccd18fab218b30", "message": "Fixed test", "committedDate": "2020-09-02T18:14:46Z", "type": "commit"}, {"oid": "4371fc5df1d5ad67a1bcf417db3b58f6bb9e8a8c", "url": "https://github.com/micronaut-projects/micronaut-core/commit/4371fc5df1d5ad67a1bcf417db3b58f6bb9e8a8c", "message": "Fix for method argument annotation visitors.", "committedDate": "2020-09-02T18:18:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUxMTQwNA==", "url": "https://github.com/micronaut-projects/micronaut-core/pull/4009#discussion_r482511404", "bodyText": "The only part I am not sure about is if this cast is safe, or if there is another way to obtain the declaring type...", "author": "tomas-langer", "createdAt": "2020-09-02T21:53:47Z", "path": "inject-java/src/main/java/io/micronaut/annotation/processing/visitor/AbstractJavaElement.java", "diffHunk": "@@ -76,7 +77,20 @@\n                 .newAnnotationBuilder()\n                 .annotate(annotationMetadata, av);\n \n-        String declaringTypeName = this instanceof MemberElement ? ((MemberElement) this).getOwningType().getName() : getName();\n+        String declaringTypeName;\n+        if (this instanceof MemberElement) {\n+            declaringTypeName = ((MemberElement) this).getOwningType().getName();\n+        } else if (this instanceof ParameterElement) {\n+            TypeElement typeElement = visitorContext.getModelUtils().classElementFor((Element) this.getNativeType());", "originalCommit": "4371fc5df1d5ad67a1bcf417db3b58f6bb9e8a8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc1NDE2MA==", "url": "https://github.com/micronaut-projects/micronaut-core/pull/4009#discussion_r482754160", "bodyText": "Yes it is safe", "author": "graemerocher", "createdAt": "2020-09-03T07:08:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUxMTQwNA=="}], "type": "inlineReview"}]}