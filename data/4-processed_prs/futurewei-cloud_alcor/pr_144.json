{"pr_number": 144, "pr_title": "[Microservices] Route manager", "pr_createdAt": "2020-03-31T06:59:06Z", "pr_url": "https://github.com/futurewei-cloud/alcor/pull/144", "timeline": [{"oid": "a81d90c0c4b33c3a4ee7165b4f787aff53d440ff", "url": "https://github.com/futurewei-cloud/alcor/commit/a81d90c0c4b33c3a4ee7165b4f787aff53d440ff", "message": "vpcmanager", "committedDate": "2020-03-24T23:00:44Z", "type": "commit"}, {"oid": "93da5e40ad87f49cfc891b56a8618c25567b9c40", "url": "https://github.com/futurewei-cloud/alcor/commit/93da5e40ad87f49cfc891b56a8618c25567b9c40", "message": "vpc manager service update", "committedDate": "2020-03-24T23:35:04Z", "type": "commit"}, {"oid": "bb7c1ffd71e6ab1c1019b874322b18e239f0be61", "url": "https://github.com/futurewei-cloud/alcor/commit/bb7c1ffd71e6ab1c1019b874322b18e239f0be61", "message": "Merge pull request #1 from futurewei-cloud/master\n\nReplace Redis with Apache Ignite for in memory cache and db (#129)", "committedDate": "2020-03-25T16:12:19Z", "type": "commit"}, {"oid": "2b6a43fb0ae185b880969b49ce852434d1799a24", "url": "https://github.com/futurewei-cloud/alcor/commit/2b6a43fb0ae185b880969b49ce852434d1799a24", "message": "vpc manager directory structure update", "committedDate": "2020-03-25T18:26:03Z", "type": "commit"}, {"oid": "49ad0b0272ef71832af87ff93ab68c80a8300121", "url": "https://github.com/futurewei-cloud/alcor/commit/49ad0b0272ef71832af87ff93ab68c80a8300121", "message": "common service and updated vpcmanager", "committedDate": "2020-03-27T07:02:52Z", "type": "commit"}, {"oid": "c9935f10df13ca8e7cfff10ad9f07fdbfc61eb4f", "url": "https://github.com/futurewei-cloud/alcor/commit/c9935f10df13ca8e7cfff10ad9f07fdbfc61eb4f", "message": "Rename directory name from Common-service to lib", "committedDate": "2020-03-27T07:28:26Z", "type": "commit"}, {"oid": "3f04333e9042ae0c9577c875f9c430a3d78b5aa2", "url": "https://github.com/futurewei-cloud/alcor/commit/3f04333e9042ae0c9577c875f9c430a3d78b5aa2", "message": "Move lib files under com.futurewei.alcor.common", "committedDate": "2020-03-27T07:34:01Z", "type": "commit"}, {"oid": "715675ee72a3518e87c9280a57ffe52fa242b3e8", "url": "https://github.com/futurewei-cloud/alcor/commit/715675ee72a3518e87c9280a57ffe52fa242b3e8", "message": "fix package paths in lib", "committedDate": "2020-03-27T07:53:44Z", "type": "commit"}, {"oid": "4de3c83ba533eb941ab9a2392f863eda36baa0a9", "url": "https://github.com/futurewei-cloud/alcor/commit/4de3c83ba533eb941ab9a2392f863eda36baa0a9", "message": "Rename package path to com.futurewei.alcor.vpcmanager", "committedDate": "2020-03-27T08:04:01Z", "type": "commit"}, {"oid": "8d2a24da02a5540318f52d288030fbab99b776b6", "url": "https://github.com/futurewei-cloud/alcor/commit/8d2a24da02a5540318f52d288030fbab99b776b6", "message": "Update common jar and use latest package path in vpcmanager", "committedDate": "2020-03-27T08:12:46Z", "type": "commit"}, {"oid": "84b4cd58ce61c78df855a5feca4bed2b6c4cc760", "url": "https://github.com/futurewei-cloud/alcor/commit/84b4cd58ce61c78df855a5feca4bed2b6c4cc760", "message": "update vpc manager jar package name", "committedDate": "2020-03-27T08:14:40Z", "type": "commit"}, {"oid": "00328559311fede7087bf48ed328008e748f2b0b", "url": "https://github.com/futurewei-cloud/alcor/commit/00328559311fede7087bf48ed328008e748f2b0b", "message": "change Dockerfilr", "committedDate": "2020-03-27T17:19:05Z", "type": "commit"}, {"oid": "510fe4aced4f39764ac8f5a30df4783a67bef57a", "url": "https://github.com/futurewei-cloud/alcor/commit/510fe4aced4f39764ac8f5a30df4783a67bef57a", "message": "delete useless file", "committedDate": "2020-03-27T17:22:43Z", "type": "commit"}, {"oid": "2d1cca813255fedeb2cbd2662cbfb6b50e10f7b5", "url": "https://github.com/futurewei-cloud/alcor/commit/2d1cca813255fedeb2cbd2662cbfb6b50e10f7b5", "message": "Reformat some files in vpc manager", "committedDate": "2020-03-27T17:48:42Z", "type": "commit"}, {"oid": "b0a81d3ec168f2f1b55af276bcbe58d1255d1266", "url": "https://github.com/futurewei-cloud/alcor/commit/b0a81d3ec168f2f1b55af276bcbe58d1255d1266", "message": "Reformat files in common lib", "committedDate": "2020-03-27T17:55:22Z", "type": "commit"}, {"oid": "0c06645add0d6720d8c1475cdc45e049ec370987", "url": "https://github.com/futurewei-cloud/alcor/commit/0c06645add0d6720d8c1475cdc45e049ec370987", "message": "route manager codes and update vpc manager", "committedDate": "2020-03-30T03:48:56Z", "type": "commit"}, {"oid": "bfd46bc69200c5aebf2ca5913bb26d7c6fc8035b", "url": "https://github.com/futurewei-cloud/alcor/commit/bfd46bc69200c5aebf2ca5913bb26d7c6fc8035b", "message": "update vpc_manager.yaml, route_manager_yaml", "committedDate": "2020-03-30T04:05:12Z", "type": "commit"}, {"oid": "3a2c035eda11418a0473781cd195d9492aa8a72a", "url": "https://github.com/futurewei-cloud/alcor/commit/3a2c035eda11418a0473781cd195d9492aa8a72a", "message": "update", "committedDate": "2020-03-30T04:07:49Z", "type": "commit"}, {"oid": "a739a9c0af774dcf9727474391ab796fa6ea43ef", "url": "https://github.com/futurewei-cloud/alcor/commit/a739a9c0af774dcf9727474391ab796fa6ea43ef", "message": "Delete unused files", "committedDate": "2020-03-30T04:15:29Z", "type": "commit"}, {"oid": "8e5549a78b09381b116fcb895b13b9dc75ddd8aa", "url": "https://github.com/futurewei-cloud/alcor/commit/8e5549a78b09381b116fcb895b13b9dc75ddd8aa", "message": "Add get/create apis on route manager and post call from vpc to route", "committedDate": "2020-03-30T06:55:51Z", "type": "commit"}, {"oid": "771dad76d57ef25344c77e266bca90b313055225", "url": "https://github.com/futurewei-cloud/alcor/commit/771dad76d57ef25344c77e266bca90b313055225", "message": "update vpc controller and vpcState", "committedDate": "2020-03-30T21:23:25Z", "type": "commit"}, {"oid": "d07ff34f909437485a64e40e0f8d71562c8fc8bd", "url": "https://github.com/futurewei-cloud/alcor/commit/d07ff34f909437485a64e40e0f8d71562c8fc8bd", "message": "Update gitignore to exclude logs file", "committedDate": "2020-03-31T02:38:49Z", "type": "commit"}, {"oid": "a84ab728c191cf9cf2166b01f54b9d8748fb1dff", "url": "https://github.com/futurewei-cloud/alcor/commit/a84ab728c191cf9cf2166b01f54b9d8748fb1dff", "message": "Merge from alcor/master", "committedDate": "2020-03-31T04:24:32Z", "type": "commit"}, {"oid": "e27b2facfe4e77d57f42f08fd8c9633152e071e1", "url": "https://github.com/futurewei-cloud/alcor/commit/e27b2facfe4e77d57f42f08fd8c9633152e071e1", "message": "Merge from vpcmanager to alcor.vpcmanager", "committedDate": "2020-03-31T05:13:59Z", "type": "commit"}, {"oid": "9070cd0137d7dfa0b8c200de531771ec5b839f45", "url": "https://github.com/futurewei-cloud/alcor/commit/9070cd0137d7dfa0b8c200de531771ec5b839f45", "message": "Remove lib jar and add dependency on pom", "committedDate": "2020-03-31T05:16:14Z", "type": "commit"}, {"oid": "8874c7307bcb7f7f96bb0ac1b3003361db53ff4a", "url": "https://github.com/futurewei-cloud/alcor/commit/8874c7307bcb7f7f96bb0ac1b3003361db53ff4a", "message": "Remove lib jar and add dependency on pom for route manager", "committedDate": "2020-03-31T05:17:36Z", "type": "commit"}, {"oid": "0b58f598d1df2422900c3c9b6768342e2ec15478", "url": "https://github.com/futurewei-cloud/alcor/commit/0b58f598d1df2422900c3c9b6768342e2ec15478", "message": "update alcor route manager service and package name", "committedDate": "2020-03-31T05:22:53Z", "type": "commit"}, {"oid": "b6c328f29bc96c5b46b074f313eb68859c54fc62", "url": "https://github.com/futurewei-cloud/alcor/commit/b6c328f29bc96c5b46b074f313eb68859c54fc62", "message": "Fix vpc manager duplicated UTs", "committedDate": "2020-03-31T05:26:53Z", "type": "commit"}, {"oid": "d11745b658f1092eaaf2dec138e1578dde36474d", "url": "https://github.com/futurewei-cloud/alcor/commit/d11745b658f1092eaaf2dec138e1578dde36474d", "message": "redis-route.yaml", "committedDate": "2020-03-31T05:35:20Z", "type": "commit"}, {"oid": "0ed002dfc5d6805dc54a49ea9f94679c6717cd9a", "url": "https://github.com/futurewei-cloud/alcor/commit/0ed002dfc5d6805dc54a49ea9f94679c6717cd9a", "message": "Update setRouteWebObjectList", "committedDate": "2020-03-31T05:56:16Z", "type": "commit"}, {"oid": "f73cac5a73fc18c0ffaabfd381d2c1f30d7f8398", "url": "https://github.com/futurewei-cloud/alcor/commit/f73cac5a73fc18c0ffaabfd381d2c1f30d7f8398", "message": "Merge branch 'feature/route_manager' of https://github.com/kevin-zhonghao/alcor into feature/route_manager", "committedDate": "2020-03-31T06:00:31Z", "type": "commit"}, {"oid": "6575ac236283bb433b4cd980015a267b8cef9ef4", "url": "https://github.com/futurewei-cloud/alcor/commit/6575ac236283bb433b4cd980015a267b8cef9ef4", "message": "Fix setter/getter issue in VpcState", "committedDate": "2020-03-31T06:09:21Z", "type": "commit"}, {"oid": "6a6ac89f90fc43620e382adcfe43fdbeeade9a89", "url": "https://github.com/futurewei-cloud/alcor/commit/6a6ac89f90fc43620e382adcfe43fdbeeade9a89", "message": "Move VpcManager under Services", "committedDate": "2020-03-31T06:19:16Z", "type": "commit"}, {"oid": "a25c9f024acc9c14c2b04fb36101b215c5727708", "url": "https://github.com/futurewei-cloud/alcor/commit/a25c9f024acc9c14c2b04fb36101b215c5727708", "message": "Rename vpcmanager to vpc_manager", "committedDate": "2020-03-31T06:22:22Z", "type": "commit"}, {"oid": "27e62ac7be121800ffecfdf9f89f17d54e7452e1", "url": "https://github.com/futurewei-cloud/alcor/commit/27e62ac7be121800ffecfdf9f89f17d54e7452e1", "message": "Move routemanager under services and rename it to route_manager", "committedDate": "2020-03-31T06:23:47Z", "type": "commit"}, {"oid": "0cfc6869dc46cd40a5ee3118cef389bc2c408b32", "url": "https://github.com/futurewei-cloud/alcor/commit/0cfc6869dc46cd40a5ee3118cef389bc2c408b32", "message": "Fix package issues for route_manager", "committedDate": "2020-03-31T06:33:46Z", "type": "commit"}, {"oid": "3d76c29f36db8aa4aaf2e932735ae241e0e2eeab", "url": "https://github.com/futurewei-cloud/alcor/commit/3d76c29f36db8aa4aaf2e932735ae241e0e2eeab", "message": "Add web route schema and update vpc schema", "committedDate": "2020-03-31T06:47:51Z", "type": "commit"}, {"oid": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "url": "https://github.com/futurewei-cloud/alcor/commit/3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "message": "Delete unused yaml files for vpcmanager", "committedDate": "2020-03-31T07:03:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyNDQ0NQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401924445", "bodyText": "As discussed in teams, we want to use the docker image tag to track the image version, maybe that would come later?", "author": "er1cthe0ne", "createdAt": "2020-04-01T21:36:07Z", "path": "kubernetes/services/api-gateway.yaml", "diffHunk": "@@ -15,7 +15,8 @@ spec:\n         app: apimanager\n     spec:\n       containers:\n-        - image: zhonghaolyu/repo:apiKube4\n+        #- image: zhonghaolyu/repo:apiKube4\n+        - image: fwnetworking/controller:apiKube1", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0MTQ3Mg==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401941472", "bodyText": "@kevin-zhonghao I believe you made the change. Could you push your change please?", "author": "xieus", "createdAt": "2020-04-01T22:14:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyNDQ0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjYzMTIzOA==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r402631238", "bodyText": "NP, I will do it right now ~", "author": "kevin-zhonghao", "createdAt": "2020-04-02T22:24:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyNDQ0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyNDgyMQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401924821", "bodyText": "remove the comment?", "author": "er1cthe0ne", "createdAt": "2020-04-01T21:36:56Z", "path": "kubernetes/services/route_manager.yaml", "diffHunk": "@@ -0,0 +1,37 @@\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  labels:\n+    app: routemanager\n+  name: routemanager\n+spec:\n+  selector:\n+    matchLabels:\n+      app: routemanager\n+  replicas: 1\n+  template:\n+    metadata:\n+      labels:\n+        app: routemanager\n+    spec:\n+      containers:\n+        #- image: zhonghaolyu/repo:routeKube", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyNTgzNg==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401925836", "bodyText": "ditto", "author": "er1cthe0ne", "createdAt": "2020-04-01T21:39:08Z", "path": "kubernetes/services/vpc_manager.yaml", "diffHunk": "@@ -15,7 +15,8 @@ spec:\n         app: vpcmanager\n     spec:\n       containers:\n-        - image: zhonghaolyu/repo:test1\n+        #- image: zhonghaolyu/repo:vpcKube2\n+        - image: fwnetworking/controller:vpcKube1", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyNzMzMw==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401927333", "bodyText": "Looks like there is an extra empty line :)?", "author": "er1cthe0ne", "createdAt": "2020-04-01T21:42:26Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/config/RedisConfiguration.java", "diffHunk": "@@ -0,0 +1,95 @@\n+/*\n+Copyright 2019 The Alcor Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+        you may not use this file except in compliance with the License.\n+        You may obtain a copy of the License at\n+\n+        http://www.apache.org/licenses/LICENSE-2.0\n+\n+        Unless required by applicable law or agreed to in writing, software\n+        distributed under the License is distributed on an \"AS IS\" BASIS,\n+        WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+        See the License for the specific language governing permissions and\n+        limitations under the License.\n+*/\n+\n+package com.futurewei.alcor.route.config;\n+\n+import com.futurewei.alcor.common.repo.ICachePublisher;\n+import com.futurewei.alcor.common.service.RedisListener;\n+import com.futurewei.alcor.route.entity.RouteState;\n+import com.futurewei.alcor.route.service.RedisPublisher;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.boot.autoconfigure.domain.EntityScan;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.ComponentScan;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.data.redis.connection.RedisStandaloneConfiguration;\n+import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;\n+import org.springframework.data.redis.core.RedisTemplate;\n+import org.springframework.data.redis.listener.ChannelTopic;\n+import org.springframework.data.redis.listener.RedisMessageListenerContainer;\n+import org.springframework.data.redis.listener.adapter.MessageListenerAdapter;\n+import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;\n+import org.springframework.data.redis.serializer.StringRedisSerializer;\n+\n+@Configuration\n+@ComponentScan({\"com.futurewei.alcor.route.service\", \"com.futurewei.alcor.common.service\"})\n+@EntityScan({\"com.futurewei.alcor.route.entity}\", \"com.futurewei.alcor.common.entity\"})\n+public class RedisConfiguration {\n+\n+    @Value(\"${spring.redis.host}\")\n+    private String redisHostName;\n+\n+    @Value(\"${spring.redis.port}\")\n+    private int redisHostPort;\n+\n+    @Bean\n+    LettuceConnectionFactory lettuceConnectionFactory() {\n+        RedisStandaloneConfiguration configuration = new RedisStandaloneConfiguration();\n+        configuration.setHostName(redisHostName);\n+        configuration.setPort(redisHostPort);\n+        return new LettuceConnectionFactory(configuration);\n+    }\n+\n+    @Bean\n+    public RedisTemplate<String, RouteState> redisRouteTemplate() {\n+        final RedisTemplate<String, RouteState> template = new RedisTemplate<String, RouteState>();\n+        template.setConnectionFactory(lettuceConnectionFactory());\n+        template.setKeySerializer(new StringRedisSerializer());\n+        template.setHashValueSerializer(new Jackson2JsonRedisSerializer<RouteState>(RouteState.class));\n+        template.setValueSerializer(new Jackson2JsonRedisSerializer<RouteState>(RouteState.class));\n+        return template;\n+    }\n+", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyNzc5Mw==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401927793", "bodyText": "we will need the copy right header for each source file.", "author": "er1cthe0ne", "createdAt": "2020-04-01T21:43:29Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/controller/RouteController.java", "diffHunk": "@@ -0,0 +1,78 @@\n+package com.futurewei.alcor.route.controller;", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQwMDQ0OQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r402400449", "bodyText": "Updated.", "author": "xieus", "createdAt": "2020-04-02T15:23:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyNzc5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyOTE0Ng==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401929146", "bodyText": "I am curious, what is the benefit of catching the ParameterNullOrEmptyException and just rethrow it after?", "author": "er1cthe0ne", "createdAt": "2020-04-01T21:46:16Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/controller/RouteController.java", "diffHunk": "@@ -0,0 +1,78 @@\n+package com.futurewei.alcor.route.controller;\n+\n+import com.futurewei.alcor.common.exception.ParameterNullOrEmptyException;\n+import com.futurewei.alcor.route.dao.RouteRedisRepository;\n+import com.futurewei.alcor.route.entity.RouteState;\n+import com.futurewei.alcor.route.entity.RouteStateJson;\n+import com.futurewei.alcor.route.entity.*;\n+import com.futurewei.alcor.route.utils.RestPreconditionsUtil;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.web.bind.annotation.*;\n+\n+import java.util.UUID;\n+\n+import static org.springframework.web.bind.annotation.RequestMethod.GET;\n+import static org.springframework.web.bind.annotation.RequestMethod.POST;\n+\n+@RestController\n+public class RouteController {\n+\n+    @Autowired\n+    private RouteRedisRepository routeRedisRepository;\n+\n+    @RequestMapping(\n+            method = GET,\n+            value = {\"/vpcs/{vpcId}/routes/{routeId}\"})\n+    public RouteStateJson getRule (@PathVariable String vpcId, @PathVariable String routeId) throws Exception {\n+\n+        RouteState routeState = null;\n+\n+        try {\n+            RestPreconditionsUtil.verifyParameterNotNullorEmpty(vpcId);\n+            RestPreconditionsUtil.verifyParameterNotNullorEmpty(routeId);\n+\n+            routeState = this.routeRedisRepository.findItem(routeId);\n+        } catch (ParameterNullOrEmptyException e) {\n+            //TODO: REST error code\n+            throw new Exception(e);\n+        }\n+\n+        if (routeState == null) {\n+            //TODO: REST error code\n+            return new RouteStateJson();\n+        }\n+\n+        return new RouteStateJson(routeState);\n+    }\n+\n+    @RequestMapping(\n+            method = POST,\n+            value = {\"/vpcs/{vpcId}/routes\"})\n+    @ResponseStatus(HttpStatus.CREATED)\n+    public RouteStateJson createVpcDefaultRoute(@PathVariable String vpcId, @RequestBody VpcStateJson resource) throws Exception {\n+        RouteState routeState= null;\n+\n+        try {\n+            RestPreconditionsUtil.verifyParameterNotNullorEmpty(vpcId);\n+\n+            VpcState inVpcState = resource.getVpc();\n+            RestPreconditionsUtil.verifyResourceNotNull(inVpcState);\n+\n+            String id = UUID.randomUUID().toString();\n+            String projectId = inVpcState.getProjectId();\n+            String destination = inVpcState.getCidr();\n+            String routeTableId = UUID.randomUUID().toString();\n+\n+            routeState = new RouteState(projectId, id, \"default_route_rule\", \"\",\n+                    destination, RouteConstant.DEFAULT_TARGET, RouteConstant.DEFAULT_PRIORITY, RouteConstant.DEFAULT_ROUTE_TABLE_TYPE, routeTableId);\n+\n+            this.routeRedisRepository.addItem(routeState);\n+        } catch (ParameterNullOrEmptyException e) {", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQwMzU0NQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r402403545", "bodyText": "See the comments there. We would need to catch that and throw different Neutron-compatible error codes for clients. See #130", "author": "xieus", "createdAt": "2020-04-02T15:27:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTkyOTE0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk3MTgzMw==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401971833", "bodyText": "this /* ... */ comment style is different from other places. Maybe we want to keep it consistent by using '//' only?", "author": "er1cthe0ne", "createdAt": "2020-04-01T23:39:47Z", "path": "services/vpc_manager/.mvn/wrapper/MavenWrapperDownloader.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright 2007-present the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+import java.net.*;\n+import java.io.*;\n+import java.nio.channels.*;\n+import java.util.Properties;\n+\n+public class MavenWrapperDownloader {\n+\n+    private static final String WRAPPER_VERSION = \"0.5.6\";\n+    /**\n+     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.\n+     */", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk3MTk5MQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401971991", "bodyText": "maybe at least log an error here?", "author": "er1cthe0ne", "createdAt": "2020-04-01T23:40:22Z", "path": "services/vpc_manager/.mvn/wrapper/MavenWrapperDownloader.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright 2007-present the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+import java.net.*;\n+import java.io.*;\n+import java.nio.channels.*;\n+import java.util.Properties;\n+\n+public class MavenWrapperDownloader {\n+\n+    private static final String WRAPPER_VERSION = \"0.5.6\";\n+    /**\n+     * Default URL to download the maven-wrapper.jar from, if no 'downloadUrl' is provided.\n+     */\n+    private static final String DEFAULT_DOWNLOAD_URL = \"https://repo.maven.apache.org/maven2/io/takari/maven-wrapper/\"\n+            + WRAPPER_VERSION + \"/maven-wrapper-\" + WRAPPER_VERSION + \".jar\";\n+\n+    /**\n+     * Path to the maven-wrapper.properties file, which might contain a downloadUrl property to\n+     * use instead of the default one.\n+     */\n+    private static final String MAVEN_WRAPPER_PROPERTIES_PATH =\n+            \".mvn/wrapper/maven-wrapper.properties\";\n+\n+    /**\n+     * Path where the maven-wrapper.jar will be saved to.\n+     */\n+    private static final String MAVEN_WRAPPER_JAR_PATH =\n+            \".mvn/wrapper/maven-wrapper.jar\";\n+\n+    /**\n+     * Name of the property which should be used to override the default download url for the wrapper.\n+     */\n+    private static final String PROPERTY_NAME_WRAPPER_URL = \"wrapperUrl\";\n+\n+    public static void main(String args[]) {\n+        System.out.println(\"- Downloader started\");\n+        File baseDirectory = new File(args[0]);\n+        System.out.println(\"- Using base directory: \" + baseDirectory.getAbsolutePath());\n+\n+        // If the maven-wrapper.properties exists, read it and check if it contains a custom\n+        // wrapperUrl parameter.\n+        File mavenWrapperPropertyFile = new File(baseDirectory, MAVEN_WRAPPER_PROPERTIES_PATH);\n+        String url = DEFAULT_DOWNLOAD_URL;\n+        if (mavenWrapperPropertyFile.exists()) {\n+            FileInputStream mavenWrapperPropertyFileInputStream = null;\n+            try {\n+                mavenWrapperPropertyFileInputStream = new FileInputStream(mavenWrapperPropertyFile);\n+                Properties mavenWrapperProperties = new Properties();\n+                mavenWrapperProperties.load(mavenWrapperPropertyFileInputStream);\n+                url = mavenWrapperProperties.getProperty(PROPERTY_NAME_WRAPPER_URL, url);\n+            } catch (IOException e) {\n+                System.out.println(\"- ERROR loading '\" + MAVEN_WRAPPER_PROPERTIES_PATH + \"'\");\n+            } finally {\n+                try {\n+                    if (mavenWrapperPropertyFileInputStream != null) {\n+                        mavenWrapperPropertyFileInputStream.close();\n+                    }\n+                } catch (IOException e) {\n+                    // Ignore ...", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk3MjYxOA==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401972618", "bodyText": "would the code look better if we just do:\nimport com.futurewei.alcor.vpcmanager.entity.*;", "author": "er1cthe0ne", "createdAt": "2020-04-01T23:42:27Z", "path": "services/vpc_manager/src/main/java/com/futurewei/alcor/vpcmanager/controller/VpcController.java", "diffHunk": "@@ -25,10 +25,16 @@\n import com.futurewei.alcor.vpcmanager.entity.VpcState;\n import com.futurewei.alcor.vpcmanager.entity.VpcStateJson;\n import com.futurewei.alcor.vpcmanager.utils.RestPreconditionsUtil;\n+import com.futurewei.alcor.vpcmanager.entity.RouteWebJson;\n+import com.futurewei.alcor.vpcmanager.entity.RouteWebObject;", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjMyNjM5Mw==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r402326393", "bodyText": "See more than 2 references in the package, it will be switched to * as the current code optimization pattern is.", "author": "xieus", "createdAt": "2020-04-02T13:47:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk3MjYxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk3Mjk1OQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r401972959", "bodyText": "need to remove the commented out code or explain why we want to leave it here.", "author": "er1cthe0ne", "createdAt": "2020-04-01T23:43:32Z", "path": "services/vpc_manager/src/main/java/com/futurewei/alcor/vpcmanager/controller/VpcController.java", "diffHunk": "@@ -40,6 +46,37 @@\n     @Autowired\n     private VpcRedisRepository vpcRedisRepository;\n \n+    private RestTemplate restTemplate = new RestTemplate();\n+\n+    @RequestMapping(\n+            method = GET,\n+            value = {\"/rule/{projectid}/vpcs/{vpcid}\"})\n+    public String getRuleByVpcId(@PathVariable String projectid, @PathVariable String vpcid) throws Exception {\n+\n+//        VpcState vpcState = null;", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e99d276309abcbbf89aa410fdf4fbd26343d0dfc", "url": "https://github.com/futurewei-cloud/alcor/commit/e99d276309abcbbf89aa410fdf4fbd26343d0dfc", "message": "Remove unused codes in VpcController", "committedDate": "2020-04-02T13:46:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM3MTE1OQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r402371159", "bodyText": "@kevin-zhonghao Do we definitely need this one or it is okay to remove it?", "author": "xieus", "createdAt": "2020-04-02T14:46:09Z", "path": "services/vpc_manager/.mvn/wrapper/MavenWrapperDownloader.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright 2007-present the original author or authors.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+import java.net.*;\n+import java.io.*;\n+import java.nio.channels.*;\n+import java.util.Properties;\n+\n+public class MavenWrapperDownloader {", "originalCommit": "3bc699be2963ea2a70ef531742e3dcd6020c9e3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjYzNTc3Nw==", "url": "https://github.com/futurewei-cloud/alcor/pull/144#discussion_r402635777", "bodyText": "Actually we don't have to keep it, but I think we can have it ~ what's your suggestion?", "author": "kevin-zhonghao", "createdAt": "2020-04-02T22:36:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjM3MTE1OQ=="}], "type": "inlineReview"}, {"oid": "3ea48e2e47aa9f33e2e8993a57f4e1806af82a6a", "url": "https://github.com/futurewei-cloud/alcor/commit/3ea48e2e47aa9f33e2e8993a57f4e1806af82a6a", "message": "Address format comments", "committedDate": "2020-04-02T15:24:50Z", "type": "commit"}, {"oid": "057fbc3e177ed053bc9ca6e0eab19b9f21086a19", "url": "https://github.com/futurewei-cloud/alcor/commit/057fbc3e177ed053bc9ca6e0eab19b9f21086a19", "message": "update dynamically load configuration file in kubernetes", "committedDate": "2020-04-02T22:40:11Z", "type": "commit"}, {"oid": "90f06509f2230d653d644685de2e0bdf91baa6f3", "url": "https://github.com/futurewei-cloud/alcor/commit/90f06509f2230d653d644685de2e0bdf91baa6f3", "message": "Merge branch 'feature/route_manager' of https://github.com/kevin-zhonghao/alcor into feature/route_manager", "committedDate": "2020-04-02T22:40:43Z", "type": "commit"}]}