{"pr_number": 215, "pr_title": "[Documentation] Outline Elastic IP Manager Design", "pr_createdAt": "2020-05-25T04:22:45Z", "pr_url": "https://github.com/futurewei-cloud/alcor/pull/215", "timeline": [{"oid": "33f3ffe3865e15fd2ea4e60cc6dab0a3d8e5e59a", "url": "https://github.com/futurewei-cloud/alcor/commit/33f3ffe3865e15fd2ea4e60cc6dab0a3d8e5e59a", "message": "Outline EIP manager design", "committedDate": "2020-05-25T04:19:11Z", "type": "commit"}, {"oid": "ff0c9e2142263fa087dbf9b9ef2abd4c8427b9a9", "url": "https://github.com/futurewei-cloud/alcor/commit/ff0c9e2142263fa087dbf9b9ef2abd4c8427b9a9", "message": "Add reference section", "committedDate": "2020-05-25T06:04:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE2MzQxNw==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430163417", "bodyText": "should the uniqueness be in the world level?", "author": "er1cthe0ne", "createdAt": "2020-05-26T05:28:52Z", "path": "docs/modules/ROOT/pages/mgmt_services/elastic_ip_manager.adoc", "diffHunk": "@@ -0,0 +1,207 @@\n+= Elastic IP Manager Design Specification\n+Eric Yuan <dakuaiera@sina.com>, Liguang Xie <lxie@futurewei.com>\n+v0.1, 2020-05-24\n+:toc: right\n+:imagesdir: ../../images\n+\n+NOTE: This document is under development\n+\n+== Overview\n+\n+The Elastic IP (EIP) manager is responsible of allocating and releasing EIP as well as associating the allocated EIP to a running instance or network interface (port).\n+This is the acting microservice that provides elastic/floating IP APIs to external customers (through API gateway) and driving the elastic IP CURD workflow.\n+A network interface with an enabled EIP could establish inbound connections from and outbound connections to external networks like Internet.\n+\n+=== User Cases\n+A customer of Alcor could leverage Elastic IP manager in the following cases:\n+\n+* Allocate or release a _standalone_ EIP within the user account.\n+* Associate or disassociate an EIP to a running instance, which by default attach to its primary interface.\n+* Associate or disassociate an EIP to a network interface.\n+\n+=== Service Basic Requirements\n+\n+[arabic]\n+1. Provide CURD REST APIs for customers or provider admins to management EIPs. The APIs are compatible to OpenStack Neutron v2.0 APIs <<neutron_api>>.\n+1. Provide CURD REST APIs for cloud provider admins to register or unregister a list of public IPv4 or IPv6 ranges in EIP manager.\n+Note that those IP ranges should be owned by cloud provider.\n+1. Allocate _standalone_ and _unique_ EIP address. Guarantee uniqueness of EIP address in a regional scope.", "originalCommit": "ff0c9e2142263fa087dbf9b9ef2abd4c8427b9a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE2NDc0NA==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430164744", "bodyText": "An EIP is a resource unique globally but the EIP service in one region has no visibility on other EIP services. Therefore from EIP service perspective, it only guarantee region-wide uniqueness while the global uniqueness is ensured by additional mechanisms.", "author": "xieus", "createdAt": "2020-05-26T05:33:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE2MzQxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI2NjE5NQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430266195", "bodyText": "Maybe we don't need to support this case (associate or disassociate an EIP to a running instance)? That case could be supported by an upper layer API orchestration component.", "author": "Eric-Yuan", "createdAt": "2020-05-26T09:08:00Z", "path": "docs/modules/ROOT/pages/mgmt_services/elastic_ip_manager.adoc", "diffHunk": "@@ -0,0 +1,207 @@\n+= Elastic IP Manager Design Specification\n+Eric Yuan <dakuaiera@sina.com>, Liguang Xie <lxie@futurewei.com>\n+v0.1, 2020-05-24\n+:toc: right\n+:imagesdir: ../../images\n+\n+NOTE: This document is under development\n+\n+== Overview\n+\n+The Elastic IP (EIP) manager is responsible of allocating and releasing EIP as well as associating the allocated EIP to a running instance or network interface (port).\n+This is the acting microservice that provides elastic/floating IP APIs to external customers (through API gateway) and driving the elastic IP CURD workflow.\n+A network interface with an enabled EIP could establish inbound connections from and outbound connections to external networks like Internet.\n+\n+=== User Cases\n+A customer of Alcor could leverage Elastic IP manager in the following cases:\n+\n+* Allocate or release a _standalone_ EIP within the user account.\n+* Associate or disassociate an EIP to a running instance, which by default attach to its primary interface.", "originalCommit": "ff0c9e2142263fa087dbf9b9ef2abd4c8427b9a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcwOTkwOA==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430709908", "bodyText": "This is more like customer scenario. From EIP manager perspective, the EIP is associated to the primary interface attached to the running instance. EIP manager as of now is unaware of primary or secondary interface therefore the API exposed by EIP manager is generic to either primary interface or secondary interface.", "author": "xieus", "createdAt": "2020-05-26T21:10:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI2NjE5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgxMTgwMw==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430811803", "bodyText": "Get it", "author": "Eric-Yuan", "createdAt": "2020-05-27T01:43:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI2NjE5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI5MjEzNQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430292135", "bodyText": "I think the internal or external DNS might be an indenpentant microservice,  because they own indenpentant resource models and APIs. The dns_name attribute in a floatingip/port could be added after the DNS microservice is ready.", "author": "Eric-Yuan", "createdAt": "2020-05-26T09:51:20Z", "path": "docs/modules/ROOT/pages/mgmt_services/elastic_ip_manager.adoc", "diffHunk": "@@ -0,0 +1,207 @@\n+= Elastic IP Manager Design Specification\n+Eric Yuan <dakuaiera@sina.com>, Liguang Xie <lxie@futurewei.com>\n+v0.1, 2020-05-24\n+:toc: right\n+:imagesdir: ../../images\n+\n+NOTE: This document is under development\n+\n+== Overview\n+\n+The Elastic IP (EIP) manager is responsible of allocating and releasing EIP as well as associating the allocated EIP to a running instance or network interface (port).\n+This is the acting microservice that provides elastic/floating IP APIs to external customers (through API gateway) and driving the elastic IP CURD workflow.\n+A network interface with an enabled EIP could establish inbound connections from and outbound connections to external networks like Internet.\n+\n+=== User Cases\n+A customer of Alcor could leverage Elastic IP manager in the following cases:\n+\n+* Allocate or release a _standalone_ EIP within the user account.\n+* Associate or disassociate an EIP to a running instance, which by default attach to its primary interface.\n+* Associate or disassociate an EIP to a network interface.\n+\n+=== Service Basic Requirements\n+\n+[arabic]\n+1. Provide CURD REST APIs for customers or provider admins to management EIPs. The APIs are compatible to OpenStack Neutron v2.0 APIs <<neutron_api>>.\n+1. Provide CURD REST APIs for cloud provider admins to register or unregister a list of public IPv4 or IPv6 ranges in EIP manager.\n+Note that those IP ranges should be owned by cloud provider.\n+1. Allocate _standalone_ and _unique_ EIP address. Guarantee uniqueness of EIP address in a regional scope.\n+1. Release public IP address per customer request or other microservices, and make it ready for reuse for other customers.\n+1. Release (port, EIP) association when a port is to be deleted.\n+1. Maintain EIP states and a mapping from an EIP to its owning interface/port.\n+1. Association of an EIP to a running instance or network interface (port) at POST call (when fixed_ip_address is not NULL), or at PUT call.\n+1. Disassociation of EIP with a network interface (primary or secondary).\n+1. Working together with other services including port manager and DNS manager for allocation of port and external DNS, respectively.", "originalCommit": "ff0c9e2142263fa087dbf9b9ef2abd4c8427b9a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM5Mjc3NQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430392775", "bodyText": "I saw port manger has already support dns_name and dns_assignment attribute, so mayb elastic IP manager should support that too.", "author": "Eric-Yuan", "createdAt": "2020-05-26T13:00:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI5MjEzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcxMjYxMQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430712611", "bodyText": "Correct. Eventually EIP manager could talk to external and/or internal DNS manager to allocate DNS name etc. for an EIP. We could split the DNS management into two microservices, one for external DNS and the other for internal DNS, or consolidate them into one bigger microservice. Either approach has its pros and cons.\nFor now, we can leave some design space in EIP manager regarding its interaction with DNS management component, and revisit it shortly after DNS design is finalized.", "author": "xieus", "createdAt": "2020-05-26T21:16:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI5MjEzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDgxMTk2MA==", "url": "https://github.com/futurewei-cloud/alcor/pull/215#discussion_r430811960", "bodyText": "OK", "author": "Eric-Yuan", "createdAt": "2020-05-27T01:43:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI5MjEzNQ=="}], "type": "inlineReview"}]}