{"pr_number": 220, "pr_title": "Rename Port/Route Web Classes, and Update Kubernetes yaml", "pr_createdAt": "2020-05-28T22:34:29Z", "pr_url": "https://github.com/futurewei-cloud/alcor/pull/220", "timeline": [{"oid": "43af222551b38dacdee52211a4b9322d9c1e91be", "url": "https://github.com/futurewei-cloud/alcor/commit/43af222551b38dacdee52211a4b9322d9c1e91be", "message": "create branch", "committedDate": "2020-05-22T22:33:08Z", "type": "commit"}, {"oid": "7bca3c9b8bccddb0f70f2a074c2b9610767b385d", "url": "https://github.com/futurewei-cloud/alcor/commit/7bca3c9b8bccddb0f70f2a074c2b9610767b385d", "message": "sync up", "committedDate": "2020-05-26T18:10:59Z", "type": "commit"}, {"oid": "9c736c16c0b298618d836ef7e9c99e064e116e74", "url": "https://github.com/futurewei-cloud/alcor/commit/9c736c16c0b298618d836ef7e9c99e064e116e74", "message": "Merge branch 'new_master' into feature/pending_items", "committedDate": "2020-05-26T18:16:38Z", "type": "commit"}, {"oid": "505c496b93145d89365f31a4d7019226c8a614fa", "url": "https://github.com/futurewei-cloud/alcor/commit/505c496b93145d89365f31a4d7019226c8a614fa", "message": "Rename RouteEntity and PortEntity, update port manager and node manager yaml files", "committedDate": "2020-05-28T22:31:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2ODUyNQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432168525", "bodyText": "Is it possible to use a local image link? if so, this could speed up the testing.", "author": "xieus", "createdAt": "2020-05-28T22:57:01Z", "path": "kubernetes/services/mac_manager.yaml", "diffHunk": "@@ -38,7 +41,7 @@ spec:\n               - key: application.properties\n                 path: application.properties\n       containers:\n-        - image: zhonghaolyu/repo:macKube2\n+        - image: zhonghaolyu/repo:macKube1", "originalCommit": "505c496b93145d89365f31a4d7019226c8a614fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2OTEzNw==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432169137", "bodyText": "is this a single-node cluster setup?", "author": "xieus", "createdAt": "2020-05-28T22:58:54Z", "path": "kubernetes/services/subnet_manager.yaml", "diffHunk": "@@ -4,17 +4,17 @@ metadata:\n   name: subnet-configmap\n data:\n   application.properties: |\n-    spring.redis.host=10.109.3.172\n-    spring.redis.port=6382\n+    ignite.host=10.99.135.32\n+    ignite.port=10800\n     logging.level.root=info\n     logging.level.org.springframework.web=info\n     logging.file.path=.\n     logging.type=file\n     apache.kafka.address=172.17.0.1:9092\n-    microservices.vpc.service.url=http://192.168.1.25:30001/project/\n-    microservices.mac.service.url=http://192.168.1.25:30005/macs\n-    microservices.route.service.url=http://192.168.1.25:30003/\n-    microservices.ip.service.url=http://192.168.1.25:30007/ips/\n+    microservices.vpc.service.url=http://10.213.43.166:30001/project/", "originalCommit": "505c496b93145d89365f31a4d7019226c8a614fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE5NzU1MQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432197551", "bodyText": "Yes ~ when I set up another cluster, I will change it to multiple-node", "author": "kevin-zhonghao", "createdAt": "2020-05-29T00:40:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2OTEzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIzMTUxMA==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432231510", "bodyText": "Okay thanks.", "author": "xieus", "createdAt": "2020-05-29T03:05:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2OTEzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2OTY4OQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432169689", "bodyText": "Thanks for updating the comment as well \ud83d\udc4d", "author": "xieus", "createdAt": "2020-05-28T23:00:21Z", "path": "services/port_manager/src/main/java/com/futurewei/alcor/portmanager/controller/PortController.java", "diffHunk": "@@ -36,16 +36,16 @@\n      * If any exception occurs in the added process, we need to roll back\n      * the resource allocated from each micro-service.\n      * @param projectId Project the port belongs to\n-     * @param portStateJson Port configuration\n+     * @param portWebJson Port configuration", "originalCommit": "505c496b93145d89365f31a4d7019226c8a614fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE3ODM2NQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432178365", "bodyText": "rename the variable name to \"route\"", "author": "xieus", "createdAt": "2020-05-28T23:28:42Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/controller/RouteController.java", "diffHunk": "@@ -50,7 +50,7 @@\n             value = {\"/vpcs/{vpcId}/routes/{routeId}\"})\n     public RouteWebJson getRuleByVpcId(@PathVariable String vpcId, @PathVariable String routeId) throws Exception {\n \n-        RouteWebObject routeState = null;\n+        RouteEntity routeState = null;", "originalCommit": "505c496b93145d89365f31a4d7019226c8a614fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE5NzY5Mw==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432197693", "bodyText": "Sure", "author": "kevin-zhonghao", "createdAt": "2020-05-29T00:40:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE3ODM2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE3ODY3MQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432178671", "bodyText": "maybe rename the variable name to \"route\"", "author": "xieus", "createdAt": "2020-05-28T23:29:45Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/service/Impl/RouteDatabaseServiceImpl.java", "diffHunk": "@@ -35,7 +35,7 @@ public Map getAllRoutes() throws CacheException {\n     }\n \n     @Override\n-    public void addRoute(RouteWebObject routeState) throws DatabasePersistenceException {\n+    public void addRoute(RouteEntity routeState) throws DatabasePersistenceException {", "originalCommit": "505c496b93145d89365f31a4d7019226c8a614fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE3ODk1OQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432178959", "bodyText": "routeState => route", "author": "xieus", "createdAt": "2020-05-28T23:30:40Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/service/RouteDatabaseService.java", "diffHunk": "@@ -4,15 +4,15 @@\n import com.futurewei.alcor.common.exception.DatabasePersistenceException;\n import com.futurewei.alcor.common.exception.ResourceNotFoundException;\n import com.futurewei.alcor.common.exception.ResourcePersistenceException;\n-import com.futurewei.alcor.web.entity.route.RouteWebObject;\n+import com.futurewei.alcor.web.entity.route.RouteEntity;\n \n import java.util.Map;\n \n public interface RouteDatabaseService {\n \n-    public RouteWebObject getByRouteId (String routeId) throws ResourceNotFoundException, ResourcePersistenceException;\n+    public RouteEntity getByRouteId (String routeId) throws ResourceNotFoundException, ResourcePersistenceException;\n     public Map getAllRoutes () throws CacheException;\n-    public void addRoute (RouteWebObject routeState) throws DatabasePersistenceException;\n+    public void addRoute (RouteEntity routeState) throws DatabasePersistenceException;", "originalCommit": "505c496b93145d89365f31a4d7019226c8a614fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE4MTQyNA==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432181424", "bodyText": "I think this change caused UT failure.", "author": "xieus", "createdAt": "2020-05-28T23:39:32Z", "path": "services/private_ip_manager/src/main/resources/application.properties", "diffHunk": "@@ -1,13 +1,13 @@\n-server.port=9004\n+#server.port=9004\n #Redis configuration\n #spring.redis.host=localhost\n #spring.redis.port=6380\n #apache.kafka.address=172.17.0.1:9092\n #server.port=9000\n #Ignite configuration\n #ignite.host=192.168.137.1\n-ignite.host=localhost\n-ignite.port=10801\n+ignite.host=192.168.137.1\n+ignite.port=10800", "originalCommit": "505c496b93145d89365f31a4d7019226c8a614fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE5ODU0MQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432198541", "bodyText": "Yeah you are right", "author": "kevin-zhonghao", "createdAt": "2020-05-29T00:43:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE4MTQyNA=="}], "type": "inlineReview"}, {"oid": "f121481b5cac3a1d7411cd838f63b0a7581805ad", "url": "https://github.com/futurewei-cloud/alcor/commit/f121481b5cac3a1d7411cd838f63b0a7581805ad", "message": "Fix UTs issues, rename route", "committedDate": "2020-05-29T00:45:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIzMjE3NA==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432232174", "bodyText": "@kevin-zhonghao The change I was referring to was \"RouteEntity route = null\" :-)", "author": "xieus", "createdAt": "2020-05-29T03:08:29Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/controller/RouteController.java", "diffHunk": "@@ -50,7 +50,7 @@\n             value = {\"/vpcs/{vpcId}/routes/{routeId}\"})\n     public RouteWebJson getRuleByVpcId(@PathVariable String vpcId, @PathVariable String routeId) throws Exception {\n \n-        RouteWebObject routeState = null;\n+        Route routeState = null;", "originalCommit": "f121481b5cac3a1d7411cd838f63b0a7581805ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1MjY0Mg==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432252642", "bodyText": "Sorry ~ I will change it right now", "author": "kevin-zhonghao", "createdAt": "2020-05-29T04:44:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIzMjE3NA=="}], "type": "inlineReview"}, {"oid": "141655217ae5c3a6065c08fbecd470f68540b7f4", "url": "https://github.com/futurewei-cloud/alcor/commit/141655217ae5c3a6065c08fbecd470f68540b7f4", "message": "update route", "committedDate": "2020-05-29T04:45:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NDc1Ng==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432254756", "bodyText": "This is good.", "author": "xieus", "createdAt": "2020-05-29T04:53:43Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/controller/RouteController.java", "diffHunk": "@@ -50,49 +50,49 @@\n             value = {\"/vpcs/{vpcId}/routes/{routeId}\"})\n     public RouteWebJson getRuleByVpcId(@PathVariable String vpcId, @PathVariable String routeId) throws Exception {\n \n-        Route routeState = null;\n+        RouteEntity routeEntity = null;", "originalCommit": "141655217ae5c3a6065c08fbecd470f68540b7f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NDg4OA==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432254888", "bodyText": "=> \"RouteEntity routeEntity\"", "author": "xieus", "createdAt": "2020-05-29T04:54:27Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/service/Impl/RouteDatabaseServiceImpl.java", "diffHunk": "@@ -35,9 +35,9 @@ public Map getAllRoutes() throws CacheException {\n     }\n \n     @Override\n-    public void addRoute(Route routeState) throws DatabasePersistenceException {\n+    public void addRoute(RouteEntity routeEntityState) throws DatabasePersistenceException {", "originalCommit": "141655217ae5c3a6065c08fbecd470f68540b7f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NDk5OQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432254999", "bodyText": "=> \"RouteEntity routeEntity\"", "author": "xieus", "createdAt": "2020-05-29T04:54:57Z", "path": "services/route_manager/src/main/java/com/futurewei/alcor/route/service/RouteDatabaseService.java", "diffHunk": "@@ -4,15 +4,15 @@\n import com.futurewei.alcor.common.exception.DatabasePersistenceException;\n import com.futurewei.alcor.common.exception.ResourceNotFoundException;\n import com.futurewei.alcor.common.exception.ResourcePersistenceException;\n-import com.futurewei.alcor.web.entity.route.Route;\n+import com.futurewei.alcor.web.entity.route.RouteEntity;\n \n import java.util.Map;\n \n public interface RouteDatabaseService {\n \n-    public Route getByRouteId (String routeId) throws ResourceNotFoundException, ResourcePersistenceException;\n+    public RouteEntity getByRouteId (String routeId) throws ResourceNotFoundException, ResourcePersistenceException;\n     public Map getAllRoutes () throws CacheException;\n-    public void addRoute (Route routeState) throws DatabasePersistenceException;\n+    public void addRoute (RouteEntity routeEntityState) throws DatabasePersistenceException;", "originalCommit": "141655217ae5c3a6065c08fbecd470f68540b7f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI2NDAyNg==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432264026", "bodyText": "Sure", "author": "kevin-zhonghao", "createdAt": "2020-05-29T05:32:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NDk5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NTA3NA==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432255074", "bodyText": "Revert back to \"RouteControllerTests\"", "author": "xieus", "createdAt": "2020-05-29T04:55:19Z", "path": "services/route_manager/src/test/java/com/futurewei/alcor/route/RouteEntityControllerTests.java", "diffHunk": "@@ -29,7 +29,7 @@\n @SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,\n         properties = {\"httpbin=http://localhost:${wiremock.server.port}\"})\n @AutoConfigureMockMvc\n-public class RouteControllerTests {\n+public class RouteEntityControllerTests {", "originalCommit": "141655217ae5c3a6065c08fbecd470f68540b7f4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NTY0Mw==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432255643", "bodyText": "I think we need to revert the changes in *.adoc, *.puml, *.proto and application.properties.\nGlobal replacement is dangerous :-)", "author": "xieus", "createdAt": "2020-05-29T04:57:43Z", "path": "docs/modules/ROOT/pages/db_services/data_store.adoc", "diffHunk": "@@ -53,14 +53,14 @@ Similar analysis could be done for other controllers.\n ** The target is 1 million read/write operations per second.\n ** Estimated size of a middle-sized region is 500,000 node with 100 ports per node with consideration of multi-port container and VMs.\n Thus, the estimated total number of ports is ~50 millions.\n-** The estimated number of port-related resources (e.g. security groups, ACL, routes, DNS records and subnets) is of the same magnitude.\n+** The estimated number of port-related resources (e.g. security groups, ACL, routeEntities, DNS records and subnets) is of the same magnitude.", "originalCommit": "141655217ae5c3a6065c08fbecd470f68540b7f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI2NDUxNw==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432264517", "bodyText": "It's my bad ~ I will fix them", "author": "kevin-zhonghao", "createdAt": "2020-05-29T05:34:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NTY0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI2NTg2Mg==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432265862", "bodyText": "Yeah you are right ! it's my fault", "author": "kevin-zhonghao", "createdAt": "2020-05-29T05:40:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NTY0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI5MjgzMw==", "url": "https://github.com/futurewei-cloud/alcor/pull/220#discussion_r432292833", "bodyText": "It is okay. It happened. Don't worry about it.\nWaiting for the latest CI results to merge the PR.", "author": "xieus", "createdAt": "2020-05-29T07:03:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI1NTY0Mw=="}], "type": "inlineReview"}, {"oid": "0597a70567298785a9efc1737dcc645c97d39755", "url": "https://github.com/futurewei-cloud/alcor/commit/0597a70567298785a9efc1737dcc645c97d39755", "message": "Fix issues", "committedDate": "2020-05-29T06:23:56Z", "type": "commit"}, {"oid": "7052f361447c39a085c98cd20f408cd9bf5177d6", "url": "https://github.com/futurewei-cloud/alcor/commit/7052f361447c39a085c98cd20f408cd9bf5177d6", "message": "Fix issues", "committedDate": "2020-05-29T06:47:30Z", "type": "commit"}]}