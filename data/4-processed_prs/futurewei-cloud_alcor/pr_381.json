{"pr_number": 381, "pr_title": "[DPM/ACA Schema] Update Routing_rules and Add RoutingRuleExtraInfo Message", "pr_createdAt": "2020-09-09T22:30:32Z", "pr_url": "https://github.com/futurewei-cloud/alcor/pull/381", "timeline": [{"oid": "1e2695f32783e8f912610becbc39b06c77d17bc2", "url": "https://github.com/futurewei-cloud/alcor/commit/1e2695f32783e8f912610becbc39b06c77d17bc2", "message": "added new NextHopInfo message", "committedDate": "2020-09-09T22:23:10Z", "type": "commit"}, {"oid": "4266c86083fe2f028c7c80a2ad832f15a7c7305b", "url": "https://github.com/futurewei-cloud/alcor/commit/4266c86083fe2f028c7c80a2ad832f15a7c7305b", "message": "remove neighbor_host_dvr_mac", "committedDate": "2020-09-10T02:33:46Z", "type": "commit"}, {"oid": "0b961f0edee1adc81d28ab0c79fa85533f20ea9b", "url": "https://github.com/futurewei-cloud/alcor/commit/0b961f0edee1adc81d28ab0c79fa85533f20ea9b", "message": "update per discussion", "committedDate": "2020-09-10T18:56:00Z", "type": "commit"}, {"oid": "a64d8cf203c4cfe224a26696b5a6484f1e36b329", "url": "https://github.com/futurewei-cloud/alcor/commit/a64d8cf203c4cfe224a26696b5a6484f1e36b329", "message": "update router e2e workflow", "committedDate": "2020-09-10T20:06:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NjcwOQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/381#discussion_r486656709", "bodyText": "Do we expect this has to be IP, or could be others like a label?", "author": "xieus", "createdAt": "2020-09-10T21:58:06Z", "path": "schema/proto3/router.proto", "diffHunk": "@@ -32,13 +37,19 @@ message RouterConfiguration {\n     MessageType message_type = 5; // DELTA (default) or FULL\n     string host_dvr_mac_address = 6;\n \n+    message RoutingRuleExtraInfo{\n+        DestinationType destination_type = 1;\n+        string next_hop_mac = 2;\n+        }\n+\n     message RoutingRule {\n         OperationType operation_type = 1;\n         string id = 2;\n         string name = 3;\n-        string destination = 4;\n-        string nextHop = 5;\n+        string destination = 4;  // destination IP, could be 154.12.42.24/32 (host address) or 0.0.0.0/0 (network address)\n+        string next_hop_ip = 5;", "originalCommit": "a64d8cf203c4cfe224a26696b5a6484f1e36b329", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1Nzg0MQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/381#discussion_r486657841", "bodyText": "this is expected to be IP only, confirmed with James this morning.", "author": "er1cthe0ne", "createdAt": "2020-09-10T22:01:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NjcwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2Mzc4Nw==", "url": "https://github.com/futurewei-cloud/alcor/pull/381#discussion_r486663787", "bodyText": "Yes. \"nexthop\" should be an IP address of a gateway, but we can use \"nexthop_type\" to indicate what type of the nexthop or gateway, such as \"local\", \"vpc\", \"internet\", \"ngw\", etc...", "author": "cj-chung", "createdAt": "2020-09-10T22:16:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NjcwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MTI2NA==", "url": "https://github.com/futurewei-cloud/alcor/pull/381#discussion_r486671264", "bodyText": "should it be nexthop_type or destination_type existed in RoutingRuleExtraInfo?\nI think destination_type is more appropriate since it is more important about the destination.", "author": "er1cthe0ne", "createdAt": "2020-09-10T22:36:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NjcwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjcxMjc4OA==", "url": "https://github.com/futurewei-cloud/alcor/pull/381#discussion_r486712788", "bodyText": "Okay thanks for the confirmation.\nKeep in mind that this change will ask an upstream microservices (either RM or others) to read the user-input rules (which uses next_hop) and convert the customer object into an infra object (with next_hop_ip).", "author": "xieus", "createdAt": "2020-09-11T00:58:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY1NjcwOQ=="}], "type": "inlineReview"}]}