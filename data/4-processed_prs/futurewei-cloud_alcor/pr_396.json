{"pr_number": 396, "pr_title": "[Contract] Add routers_internal to NetworkConfiguration Entity", "pr_createdAt": "2020-10-05T16:57:36Z", "pr_url": "https://github.com/futurewei-cloud/alcor/pull/396", "timeline": [{"oid": "6de2c0d3baaa71d7d54f24e207493eb4ffbe56d2", "url": "https://github.com/futurewei-cloud/alcor/commit/6de2c0d3baaa71d7d54f24e207493eb4ffbe56d2", "message": "add dhcp/router/gateway/l2/l3 neighbor to port\n\nadd dhcp/router/gateway/l2/l3 neighbor to port creation", "committedDate": "2020-08-05T05:02:21Z", "type": "commit"}, {"oid": "9f32721615f2e7bf52773d3da5eb9f1205e8bbe1", "url": "https://github.com/futurewei-cloud/alcor/commit/9f32721615f2e7bf52773d3da5eb9f1205e8bbe1", "message": "change according to discussion this morning 08/05\n\nchange subnet info according to discussion this morning 08/05", "committedDate": "2020-08-05T22:23:34Z", "type": "commit"}, {"oid": "5eca251942033a6076b78fdc25b83dfcac234aea", "url": "https://github.com/futurewei-cloud/alcor/commit/5eca251942033a6076b78fdc25b83dfcac234aea", "message": "Merge branch 'master' of https://github.com/futurewei-cloud/alcor into master", "committedDate": "2020-10-05T16:51:51Z", "type": "commit"}, {"oid": "2915e6cae4ce35e9dcf5c51159378e289a68910a", "url": "https://github.com/futurewei-cloud/alcor/commit/2915e6cae4ce35e9dcf5c51159378e289a68910a", "message": "add routesinfo to network conf", "committedDate": "2020-10-05T16:56:48Z", "type": "commit"}, {"oid": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093", "url": "https://github.com/futurewei-cloud/alcor/commit/f3f79dcb1bd68f727d6cba258426f8cf9c5c8093", "message": "change to internal router info from router table", "committedDate": "2020-10-05T17:16:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgxODE0OA==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499818148", "bodyText": "We only have one GW MAC address.", "author": "xieus", "createdAt": "2020-10-05T19:20:16Z", "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "diffHunk": "@@ -178,157 +178,195 @@ anchor:Create_Port_NetworkConfiguration[]\n \n * Example\n * Use Case Desc: \n-` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports `\n+` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports, also the subnet info passing down to DPM should contain portId/dhcpId/routerId/gatewayId(if any) per subnet to support L2/L3 NeighborInfo`\n \n http://localhost:8080/v4/port/\n \n Body:\n \n ------------------------------------------------------------\n {\n-\t\"vpcs_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"name\": \"test_vpc\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.0.0/16\"\n-\t}\n-],\n-\t\"subnets_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"network_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n-\t\t\"name\": \"test_subnet2\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.2.0/24\",\n-\t\t\"gateway_ip\": \"192.168.2.1\",\n-\t\t\"availability_zone\": \"uswest-1\",\n-\t\t\"dhcp_enable\": false,\n-\t\t\"primary_dns\": null,\n-\t\t\"secondary_dns\": null,\n-\t\t\"dns_list\": null,\n-\t\t\t\"tunnel_id\": \"88889\"\n-\t}],\n-\t\"ports_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d3\",\n-\t\t\"name\": \"test_cni_port2\",\n-\t\t\"description\": \"\",\n-    \t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:55\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.2\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d0\",\n-\t\t\"name\": \"test_cni_port3\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:56\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.3\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d6\",\n-\t\t\"name\": \"test_cni_port4\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:57\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.4\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d7\",\n-\t\t\"name\": \"test_cni_port5\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:58\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.5\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\t\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}],\n-\t\"security_groups_internal\": [{}, {}]\n+   \"vpcs_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"name\":\"test_vpc\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.0.0/16\"\n+      }\n+   ],\n+   \"subnets_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"network_id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"id\":\"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n+         \"name\":\"test_subnet2\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.2.0/24\",\n+         \"gateway_ip\":\"192.168.2.1\",\n+         \"availability_zone\":\"uswest-1\",\n+         \"dhcp_enable\":false,\n+         \"primary_dns\":null,\n+         \"secondary_dns\":null,\n+         \"dns_list\":null,\n+         \"tunnel_id\":\"88889\",\n+         \"portIdsPerHost\":[\n+            {\n+               \"hostIp\":\"10.213.43.187\",\n+               \"portIds\":\"f37810eb-7f83-45fa-a4d4-1b31e75399d3,f37810eb-7f83-45fa-a4d4-1b31e75399d0\"\n+            },\n+            {\n+               \"hostIp\":\"10.213.43.188\",\n+               \"portIds\":\"f37810eb-7f83-45fa-a4d4-1b31e75399d6,f37810eb-7f83-45fa-a4d4-1b31e75399d7\"\n+            }\n+         ],\n+         \"dhcpIds\":\"aaa,bbb\",\n+         \"gatewayMacs\":\"g1,g2\"", "originalCommit": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNTU3Nw==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499825577", "bodyText": "This subnet_internal is aligned with our InternalSubnetEntity, at least the following fields:\n\nportIdsPerHost\ngatewayMacs\ndhcpIds\n\n\n  \n    \n      alcor/web/src/main/java/com/futurewei/alcor/web/entity/dataplane/InternalSubnetEntity.java\n    \n    \n         Line 20\n      in\n      83f950b\n    \n    \n    \n    \n\n        \n          \n           public class InternalSubnetEntity extends SubnetEntity {", "author": "xieus", "createdAt": "2020-10-05T19:34:39Z", "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "diffHunk": "@@ -178,157 +178,195 @@ anchor:Create_Port_NetworkConfiguration[]\n \n * Example\n * Use Case Desc: \n-` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports `\n+` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports, also the subnet info passing down to DPM should contain portId/dhcpId/routerId/gatewayId(if any) per subnet to support L2/L3 NeighborInfo`\n \n http://localhost:8080/v4/port/\n \n Body:\n \n ------------------------------------------------------------\n {\n-\t\"vpcs_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"name\": \"test_vpc\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.0.0/16\"\n-\t}\n-],\n-\t\"subnets_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"network_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n-\t\t\"name\": \"test_subnet2\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.2.0/24\",\n-\t\t\"gateway_ip\": \"192.168.2.1\",\n-\t\t\"availability_zone\": \"uswest-1\",\n-\t\t\"dhcp_enable\": false,\n-\t\t\"primary_dns\": null,\n-\t\t\"secondary_dns\": null,\n-\t\t\"dns_list\": null,\n-\t\t\t\"tunnel_id\": \"88889\"\n-\t}],\n-\t\"ports_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d3\",\n-\t\t\"name\": \"test_cni_port2\",\n-\t\t\"description\": \"\",\n-    \t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:55\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.2\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d0\",\n-\t\t\"name\": \"test_cni_port3\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:56\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.3\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d6\",\n-\t\t\"name\": \"test_cni_port4\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:57\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.4\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d7\",\n-\t\t\"name\": \"test_cni_port5\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:58\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.5\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\t\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}],\n-\t\"security_groups_internal\": [{}, {}]\n+   \"vpcs_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"name\":\"test_vpc\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.0.0/16\"\n+      }\n+   ],\n+   \"subnets_internal\":[", "originalCommit": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNjA3MQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499826071", "bodyText": "Please update routers_internal with the latest contract in NetworkConfiguration.java.", "author": "xieus", "createdAt": "2020-10-05T19:35:29Z", "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "diffHunk": "@@ -178,157 +178,195 @@ anchor:Create_Port_NetworkConfiguration[]\n \n * Example\n * Use Case Desc: \n-` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports `\n+` client should send out NetworkConfiguration to create (bulk) port(s)  unless port to be created inside the NetworkConfiguration itself in which case client should remember the neighbor infos among newly created ports, also the subnet info passing down to DPM should contain portId/dhcpId/routerId/gatewayId(if any) per subnet to support L2/L3 NeighborInfo`\n \n http://localhost:8080/v4/port/\n \n Body:\n \n ------------------------------------------------------------\n {\n-\t\"vpcs_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"name\": \"test_vpc\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.0.0/16\"\n-\t}\n-],\n-\t\"subnets_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"network_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n-\t\t\"name\": \"test_subnet2\",\n-\t\t\"description\": \"\",\n-\t\t\"cidr\": \"192.168.2.0/24\",\n-\t\t\"gateway_ip\": \"192.168.2.1\",\n-\t\t\"availability_zone\": \"uswest-1\",\n-\t\t\"dhcp_enable\": false,\n-\t\t\"primary_dns\": null,\n-\t\t\"secondary_dns\": null,\n-\t\t\"dns_list\": null,\n-\t\t\t\"tunnel_id\": \"88889\"\n-\t}],\n-\t\"ports_internal\": [{\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d3\",\n-\t\t\"name\": \"test_cni_port2\",\n-\t\t\"description\": \"\",\n-    \t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:55\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.2\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d0\",\n-\t\t\"name\": \"test_cni_port3\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.187\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:56\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.3\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d6\",\n-\t\t\"name\": \"test_cni_port4\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:57\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.4\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}, {\n-\t\t\"project_id\": \"3dda2801-d675-4688-a63f-dcda8d327f50\",\n-\t\t\"id\": \"f37810eb-7f83-45fa-a4d4-1b31e75399d7\",\n-\t\t\"name\": \"test_cni_port5\",\n-\t\t\"description\": \"\",\n-\t\t\"binding_host_ip\": \"10.213.43.188\",\n-\t\t\"vpc_id\": \"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n-\t\t\"tenant_id\": null,\n-\t\t\"admin_state_up\": true,\n-\t\t\"mac_address\": \"86:ea:77:ad:52:58\",\n-\t\t\"veth_name\": \"veth0\",\n-\t\t\"device_id\": null,\n-\t\t\"device_owner\": null,\n-\t\t\"status\": null,\n-\t\t\"neighbor_host_ip\": null,\n-\t\t\"fixed_ips\": [{\n-\t\t\t\"ip_address\": \"192.168.2.5\",\n-\t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\t\n-\t\t],\n-\t\t\"allowed_address_pairs\": null,\n-\t\t\"extra_dhcp_opts\": null,\n-\t\t\"security_groups\": null,\n-\t\t\"binding:host_id\": \"ephost_0\",\n-\t\t\"binding:profile\": null,\n-\t\t\"binding:vnic_type\": null,\n-\t\t\"network_ns\": \"/var/run/netns/test_netw_ns\",\n-\t\t\"dnsName\": null,\n-\t\t\"dnsAssignment\": null,\n-\t\t\"fast_path\": true\n-\t}],\n-\t\"security_groups_internal\": [{}, {}]\n+   \"vpcs_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"name\":\"test_vpc\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.0.0/16\"\n+      }\n+   ],\n+   \"subnets_internal\":[\n+      {\n+         \"project_id\":\"3dda2801-d675-4688-a63f-dcda8d327f50\",\n+         \"network_id\":\"9192a4d4-ffff-4ece-b3f0-8d36e3d88038\",\n+         \"id\":\"a87e0f87-a2d9-44ef-9194-9a62f178594f\",\n+         \"name\":\"test_subnet2\",\n+         \"description\":\"\",\n+         \"cidr\":\"192.168.2.0/24\",\n+         \"gateway_ip\":\"192.168.2.1\",\n+         \"availability_zone\":\"uswest-1\",\n+         \"dhcp_enable\":false,\n+         \"primary_dns\":null,\n+         \"secondary_dns\":null,\n+         \"dns_list\":null,\n+         \"tunnel_id\":\"88889\",\n+         \"portIdsPerHost\":[\n+            {\n+               \"hostIp\":\"10.213.43.187\",\n+               \"portIds\":\"f37810eb-7f83-45fa-a4d4-1b31e75399d3,f37810eb-7f83-45fa-a4d4-1b31e75399d0\"\n+            },\n+            {\n+               \"hostIp\":\"10.213.43.188\",\n+               \"portIds\":\"f37810eb-7f83-45fa-a4d4-1b31e75399d6,f37810eb-7f83-45fa-a4d4-1b31e75399d7\"\n+            }\n+         ],\n+         \"dhcpIds\":\"aaa,bbb\",\n+         \"gatewayMacs\":\"g1,g2\"\n+      }\n+   ],\n+   \"routers_internal\":[", "originalCommit": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNjY4OA==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499826688", "bodyText": "Suggest to rename the variable name to routerInfo.", "author": "xieus", "createdAt": "2020-10-05T19:36:46Z", "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "diffHunk": "@@ -46,6 +47,9 @@\n   @JsonProperty(\"neighbor_table\")\n   private List<NeighborEntry> neighborTable;\n \n+  @JsonProperty(\"routerinfo\")\n+  private List<InternalRouterInfo> routerTable;", "originalCommit": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk0MzU1MA==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499943550", "bodyText": "fixed in a90538a", "author": "haboy52581", "createdAt": "2020-10-06T00:32:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNjY4OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk4OTEzMg==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499989132", "bodyText": "@haboy52581 the variable name itself remains unchanged.", "author": "xieus", "createdAt": "2020-10-06T03:43:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNjY4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNzEzNA==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499827134", "bodyText": "Need to add setter and getter for the new field, and update ToString method.", "author": "xieus", "createdAt": "2020-10-05T19:37:39Z", "path": "web/src/main/java/com/futurewei/alcor/web/entity/dataplane/NetworkConfiguration.java", "diffHunk": "@@ -46,6 +47,9 @@\n   @JsonProperty(\"neighbor_table\")\n   private List<NeighborEntry> neighborTable;\n \n+  @JsonProperty(\"routerinfo\")\n+  private List<InternalRouterInfo> routerTable;\n+\n   public void addPortEntity(InternalPortEntity portEntity) {\n     if (this.portEntities == null) {\n       this.portEntities = new ArrayList<>();", "originalCommit": "f3f79dcb1bd68f727d6cba258426f8cf9c5c8093", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk0MzUzMw==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499943533", "bodyText": "fixed in a90538a", "author": "haboy52581", "createdAt": "2020-10-06T00:32:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgyNzEzNA=="}], "type": "inlineReview"}, {"oid": "a90538ab17d99e93785d7b5f8025a6863d3774a8", "url": "https://github.com/futurewei-cloud/alcor/commit/a90538ab17d99e93785d7b5f8025a6863d3774a8", "message": "change tostring and add set/getter", "committedDate": "2020-10-06T00:32:27Z", "type": "commit"}, {"oid": "5b30b6a6cadbce7f86cc0130125f7b1d53f91852", "url": "https://github.com/futurewei-cloud/alcor/commit/5b30b6a6cadbce7f86cc0130125f7b1d53f91852", "message": "fix adoc", "committedDate": "2020-10-06T00:41:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk4ODEwMQ==", "url": "https://github.com/futurewei-cloud/alcor/pull/396#discussion_r499988101", "bodyText": "Replace \"tab\" with space throughout the document.", "author": "xieus", "createdAt": "2020-10-06T03:38:48Z", "path": "docs/modules/ROOT/pages/infra_services/data_plane_manager.adoc", "diffHunk": "@@ -552,7 +576,7 @@ Body:\n \t\t\"fixed_ips\": [{\n \t\t\t\"ip_address\": \"192.168.2.5\",\n \t\t\t\"subnet_id\": \"a87e0f87-a2d9-44ef-9194-9a62f178594f\"\n-\t\t}\t\n+\t\t}", "originalCommit": "5b30b6a6cadbce7f86cc0130125f7b1d53f91852", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "93b8e780313168ec145cd953c24efa4d8790abc6", "url": "https://github.com/futurewei-cloud/alcor/commit/93b8e780313168ec145cd953c24efa4d8790abc6", "message": "change var name of router", "committedDate": "2020-10-06T19:09:11Z", "type": "commit"}, {"oid": "1171987b882c105d4056a409bfc7526c352bf30d", "url": "https://github.com/futurewei-cloud/alcor/commit/1171987b882c105d4056a409bfc7526c352bf30d", "message": "address the tab replacement", "committedDate": "2020-10-06T23:02:46Z", "type": "commit"}]}