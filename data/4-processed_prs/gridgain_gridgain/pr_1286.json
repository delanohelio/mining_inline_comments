{"pr_number": 1286, "pr_title": "GG-30055: Ab Initio related fixes to ODBC", "pr_createdAt": "2020-07-06T22:50:57Z", "pr_url": "https://github.com/gridgain/gridgain/pull/1286", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM3NDgzOA==", "url": "https://github.com/gridgain/gridgain/pull/1286#discussion_r451374838", "bodyText": "Should we also test values with fractional parts?", "author": "ptupitsyn", "createdAt": "2020-07-08T08:32:26Z", "path": "modules/platforms/cpp/odbc-test/src/utility_test.cpp", "diffHunk": "@@ -89,4 +89,58 @@ BOOST_AUTO_TEST_CASE(TestUtilityWriteReadString)\n     BOOST_REQUIRE(outStr4.empty());\n }\n \n+void CheckDecimalWriteRead(const std::string& val)\n+{\n+    using namespace ignite::impl::binary;\n+    using namespace ignite::impl::interop;\n+    using namespace ignite::common;\n+    using namespace ignite::utility;\n+\n+    InteropUnpooledMemory mem(1024);\n+    InteropOutputStream outStream(&mem);\n+    BinaryWriterImpl writer(&outStream, 0);\n+\n+    Decimal decimal(val);\n+\n+    WriteDecimal(writer, decimal);\n+\n+    outStream.Synchronize();\n+\n+    InteropInputStream inStream(&mem);\n+    BinaryReaderImpl reader(&inStream);\n+\n+    Decimal out;\n+    ReadDecimal(reader, out);\n+\n+    std::stringstream converter;\n+    converter << out;\n+\n+    std::string res = converter.str();\n+\n+    BOOST_CHECK_EQUAL(res, val);\n+}\n+\n+/**\n+ * Check that Decimal writing and reading works as expected.\n+ *\n+ * 1. Create Decimal value.\n+ * 2. Write using standard serialization algorithm.\n+ * 3. Read using standard de-serialization algorithm.\n+ * 4. Check that initial and read value are equal.\n+ *\n+ * Repeat with the following values: 0, 1, -1, 42, -42, 160, -160, 34729864879625196, -34729864879625196\n+ */\n+BOOST_AUTO_TEST_CASE(TestUtilityWriteReadDecimal)\n+{\n+    CheckDecimalWriteRead(\"0\");\n+    CheckDecimalWriteRead(\"1\");\n+    CheckDecimalWriteRead(\"-1\");\n+    CheckDecimalWriteRead(\"42\");\n+    CheckDecimalWriteRead(\"-42\");\n+    CheckDecimalWriteRead(\"160\");\n+    CheckDecimalWriteRead(\"-160\");\n+    CheckDecimalWriteRead(\"34729864879625196\");\n+    CheckDecimalWriteRead(\"-34729864879625196\");", "originalCommit": "8599cb97afce575d28677cecb52d2b178b13538f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM4NzY5OA==", "url": "https://github.com/gridgain/gridgain/pull/1286#discussion_r451387698", "bodyText": "Good point. Added.", "author": "isapego", "createdAt": "2020-07-08T08:53:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM3NDgzOA=="}], "type": "inlineReview"}, {"oid": "37bf235262e77010356127ea4cfd2b38f99f231f", "url": "https://github.com/gridgain/gridgain/commit/37bf235262e77010356127ea4cfd2b38f99f231f", "message": "GG-30055: Added support for UID and PWD", "committedDate": "2020-07-08T08:54:11Z", "type": "commit"}, {"oid": "673eb581e73715b1b7588e248b9027b558ded9c4", "url": "https://github.com/gridgain/gridgain/commit/673eb581e73715b1b7588e248b9027b558ded9c4", "message": "GG-30055: Decimal serialization fixed", "committedDate": "2020-07-08T08:54:11Z", "type": "commit"}, {"oid": "eb582d4f7e35490ad7b022ef710f033387dc98a7", "url": "https://github.com/gridgain/gridgain/commit/eb582d4f7e35490ad7b022ef710f033387dc98a7", "message": "GG-30055: Fixed getting of env parameters", "committedDate": "2020-07-08T08:54:11Z", "type": "commit"}, {"oid": "32c31d75739b9fc7e861cf7b9aabc7319624bbcd", "url": "https://github.com/gridgain/gridgain/commit/32c31d75739b9fc7e861cf7b9aabc7319624bbcd", "message": "GG-30055: Added tests for UID and PWD", "committedDate": "2020-07-08T08:54:11Z", "type": "commit"}, {"oid": "d0bc06f236cdb532df8bf3470fa389288c2e70f7", "url": "https://github.com/gridgain/gridgain/commit/d0bc06f236cdb532df8bf3470fa389288c2e70f7", "message": "GG-30055: Added test for Decimal writing-reading", "committedDate": "2020-07-08T08:54:11Z", "type": "commit"}, {"oid": "64233972490dd4d4134155e80a738fc59287e26a", "url": "https://github.com/gridgain/gridgain/commit/64233972490dd4d4134155e80a738fc59287e26a", "message": "GG-30055: Added test for env ODBC version", "committedDate": "2020-07-08T08:54:11Z", "type": "commit"}, {"oid": "727b2a163f959034b0b5d4763f6cff951b3064ed", "url": "https://github.com/gridgain/gridgain/commit/727b2a163f959034b0b5d4763f6cff951b3064ed", "message": "GG-30055: Added Decimal tests", "committedDate": "2020-07-08T08:54:12Z", "type": "commit"}, {"oid": "727b2a163f959034b0b5d4763f6cff951b3064ed", "url": "https://github.com/gridgain/gridgain/commit/727b2a163f959034b0b5d4763f6cff951b3064ed", "message": "GG-30055: Added Decimal tests", "committedDate": "2020-07-08T08:54:12Z", "type": "forcePushed"}]}