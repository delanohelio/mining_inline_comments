{"pr_number": 1461, "pr_title": "GG-28222 CPP Thin: Use random address order", "pr_createdAt": "2020-09-29T22:10:54Z", "pr_url": "https://github.com/gridgain/gridgain/pull/1461", "timeline": [{"oid": "f851d541c57834ca7eeb99cf609d09776514b31b", "url": "https://github.com/gridgain/gridgain/commit/f851d541c57834ca7eeb99cf609d09776514b31b", "message": "GG-28222: Addresses now randomly shuffled once resolved.", "committedDate": "2020-09-29T23:15:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM5NTkxOQ==", "url": "https://github.com/gridgain/gridgain/pull/1461#discussion_r497395919", "bodyText": "This looks exactly like the code above for Linux, can we deduplicate?", "author": "ptupitsyn", "createdAt": "2020-09-30T10:10:39Z", "path": "modules/platforms/cpp/network/os/win/src/network/tcp_socket_client.cpp", "diffHunk": "@@ -28,6 +30,23 @@ namespace ignite\n {\n     namespace network\n     {\n+        /**\n+         * Shuffle addresses randomly.\n+         * @param addrsIn Addresses.\n+         * @return Randomly shuffled addresses.\n+         */\n+        std::vector<addrinfo*> ShuffleAddresses(addrinfo* addrsIn)\n+        {\n+            std::vector<addrinfo*> res;\n+\n+            for (addrinfo *it = addrsIn; it != NULL; it = it->ai_next)\n+                res.push_back(it);\n+\n+            std::random_shuffle(res.begin(), res.end());\n+\n+            return res;\n+        }", "originalCommit": "f851d541c57834ca7eeb99cf609d09776514b31b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzgxODg3MQ==", "url": "https://github.com/gridgain/gridgain/pull/1461#discussion_r497818871", "bodyText": "Well in theory, we can, using templates. The hard part here is that despite of the same name addrinfos in Windows and Linux are two different classes, so we can not just make a simple function. I'll think if I can improve this part without over-complicating the code though.", "author": "isapego", "createdAt": "2020-09-30T21:45:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM5NTkxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzg0NDY3NA==", "url": "https://github.com/gridgain/gridgain/pull/1461#discussion_r497844674", "bodyText": "Fixed. Check out new version.", "author": "isapego", "createdAt": "2020-09-30T22:52:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM5NTkxOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODAxMzIyNg==", "url": "https://github.com/gridgain/gridgain/pull/1461#discussion_r498013226", "bodyText": "Looks good, thanks!", "author": "ptupitsyn", "createdAt": "2020-10-01T06:37:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM5NTkxOQ=="}], "type": "inlineReview"}, {"oid": "32a72ab2d87048f771653bbd41208ba25f3f21bc", "url": "https://github.com/gridgain/gridgain/commit/32a72ab2d87048f771653bbd41208ba25f3f21bc", "message": "GG-28222: Addresses now randomly shuffled once resolved.", "committedDate": "2020-09-30T23:48:29Z", "type": "commit"}, {"oid": "42e3602b715a85fa4324278a5ae9a2840d5f6c8b", "url": "https://github.com/gridgain/gridgain/commit/42e3602b715a85fa4324278a5ae9a2840d5f6c8b", "message": "GG-28222: Removed code duplication", "committedDate": "2020-09-30T23:48:29Z", "type": "commit"}, {"oid": "f55c190dc071656ab27a2fdc4ee167d8c9abbfdc", "url": "https://github.com/gridgain/gridgain/commit/f55c190dc071656ab27a2fdc4ee167d8c9abbfdc", "message": "GG-28222: Added test", "committedDate": "2020-09-30T23:48:29Z", "type": "commit"}, {"oid": "f55c190dc071656ab27a2fdc4ee167d8c9abbfdc", "url": "https://github.com/gridgain/gridgain/commit/f55c190dc071656ab27a2fdc4ee167d8c9abbfdc", "message": "GG-28222: Added test", "committedDate": "2020-09-30T23:48:29Z", "type": "forcePushed"}, {"oid": "7b362540b120901838bbd499d7f29ffa281d00d7", "url": "https://github.com/gridgain/gridgain/commit/7b362540b120901838bbd499d7f29ffa281d00d7", "message": "GG-28222: Fix for MSVC", "committedDate": "2020-10-01T09:48:09Z", "type": "commit"}]}