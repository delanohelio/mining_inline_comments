{"pr_number": 2638, "pr_title": "Include button elements in DOM XSS Scan Rule", "pr_createdAt": "2020-12-01T14:27:04Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2638", "timeline": [{"oid": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779", "url": "https://github.com/zaproxy/zap-extensions/commit/41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779", "message": "mcr-DomXSSPlugin-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-01T14:35:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ3ODk0MA==", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r533478940", "bodyText": "You can combine this into just one line:\ninputElements.addAll(findHelper(driver, By.tagName(\"button\")))", "author": "psiinon", "createdAt": "2020-12-01T15:00:19Z", "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -453,9 +453,12 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n         }\n \n         List<WebElement> inputElements;\n+        List<WebElement> buttonElements;\n \n         try {\n             inputElements = findHelper(driver, By.tagName(\"input\"));\n+            buttonElements = findHelper(driver, By.tagName(\"button\"));\n+            inputElements.addAll(buttonElements);", "originalCommit": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzUwODk5Nw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r533508997", "bodyText": "Will do. I'll combine", "author": "mrod23", "createdAt": "2020-12-01T15:37:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ3ODk0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDUwNTgwOQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r534505809", "bodyText": "combined", "author": "mrod23", "createdAt": "2020-12-02T21:52:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ3ODk0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzQ5Mzc4MQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r533493781", "bodyText": "This should be added to the above \"Changed\" section.", "author": "thc202", "createdAt": "2020-12-01T15:18:42Z", "path": "addOns/domxss/CHANGELOG.md", "diffHunk": "@@ -15,6 +15,10 @@ The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/).\n - Maintenance changes.\n - Promote to beta\n \n+## [10] - 2020-12-01\n+### Changed\n+- Now clicking on different buttons throughout the page to see if it triggers XSS.", "originalCommit": "41d43cb9eb93bff3a4fe2dd58c304f49dbb2b779", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e2d83653ff8019598c8b0ea79a96a0e1b7dd2d9b", "url": "https://github.com/zaproxy/zap-extensions/commit/e2d83653ff8019598c8b0ea79a96a0e1b7dd2d9b", "message": "mcr-cleanup-and-adding-unit-test\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-02T13:11:51Z", "type": "forcePushed"}, {"oid": "0ed9b060c81843c30ef3aab66fbd6aa42d20520c", "url": "https://github.com/zaproxy/zap-extensions/commit/0ed9b060c81843c30ef3aab66fbd6aa42d20520c", "message": "mcr-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-02T13:20:32Z", "type": "forcePushed"}, {"oid": "3d359ded799011204eeaac241b7010c54c9ac6fc", "url": "https://github.com/zaproxy/zap-extensions/commit/3d359ded799011204eeaac241b7010c54c9ac6fc", "message": "mrod-more-unit-test-changes\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-03T18:45:38Z", "type": "forcePushed"}, {"oid": "aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed", "url": "https://github.com/zaproxy/zap-extensions/commit/aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed", "message": "mrod-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-04T16:47:29Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxOTE0Nw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r538619147", "bodyText": "I agree these names are more descriptive, but what if people are already using the existing ones?\nNo idea if thats the case, but if so then it would break things for them...", "author": "psiinon", "createdAt": "2020-12-08T17:14:13Z", "path": "addOns/domxss/src/main/java/org/zaproxy/zap/extension/domxss/DomXssScanRule.java", "diffHunk": "@@ -476,10 +477,14 @@ private void scanHelper(String attackVector, String url) throws DomAlertExceptio\n                 attributeId = element.getAttribute(\"id\");\n                 attributeName = element.getAttribute(\"name\");\n \n-                element.sendKeys(attackVector);\n+                if (tagName.equals(\"input\")) {\n+                    element.sendKeys(attackVector);\n+                }\n+\n                 element.click();\n+\n             } catch (UnhandledAlertException uae) {\n-                Stats.incCounter(\"domxss.vulns.input2\");\n+                Stats.incCounter(\"domxss.vulns.possibleXSSTriggers2\");", "originalCommit": "aa6dae0adbdf8e92d73f64d8cc822907f5acb6ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM2Njk4NA==", "url": "https://github.com/zaproxy/zap-extensions/pull/2638#discussion_r539366984", "bodyText": "Updated to possibleDomXSSTriggers2", "author": "mrod23", "createdAt": "2020-12-09T14:47:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODYxOTE0Nw=="}], "type": "inlineReview"}, {"oid": "cf702b877eb07618f384f25290589a91da066c6e", "url": "https://github.com/zaproxy/zap-extensions/commit/cf702b877eb07618f384f25290589a91da066c6e", "message": "mrod-cleaning-up-cancel-page-and-vars\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-09T14:27:27Z", "type": "forcePushed"}, {"oid": "3abb0dfe2577cce23b121917d56d2b7fa0ca6da0", "url": "https://github.com/zaproxy/zap-extensions/commit/3abb0dfe2577cce23b121917d56d2b7fa0ca6da0", "message": "squashing commits", "committedDate": "2020-12-09T14:29:36Z", "type": "forcePushed"}, {"oid": "0b7f271662a98df57b37862ffb8a49499e52b766", "url": "https://github.com/zaproxy/zap-extensions/commit/0b7f271662a98df57b37862ffb8a49499e52b766", "message": "mrod-squashing-commits", "committedDate": "2020-12-09T14:41:16Z", "type": "forcePushed"}, {"oid": "afdd7af7aa7ede3fe04a8d75ad1a53f867bbc2e3", "url": "https://github.com/zaproxy/zap-extensions/commit/afdd7af7aa7ede3fe04a8d75ad1a53f867bbc2e3", "message": "mrod-squashing-commits\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-09T14:41:51Z", "type": "forcePushed"}, {"oid": "3b71fde30acd410f3b6045a4d3a3fcfe851575f0", "url": "https://github.com/zaproxy/zap-extensions/commit/3b71fde30acd410f3b6045a4d3a3fcfe851575f0", "message": "mrod-cleanup\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-09T18:41:48Z", "type": "forcePushed"}, {"oid": "3f5ecc41778eebaf3c6a42c4b181e3d6473c9a16", "url": "https://github.com/zaproxy/zap-extensions/commit/3f5ecc41778eebaf3c6a42c4b181e3d6473c9a16", "message": "squashing commitsh", "committedDate": "2020-12-09T18:43:23Z", "type": "forcePushed"}, {"oid": "040b3d56b2e3f17dc7d6a13aa12453d047312af8", "url": "https://github.com/zaproxy/zap-extensions/commit/040b3d56b2e3f17dc7d6a13aa12453d047312af8", "message": "squashing commitsh\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-09T18:43:54Z", "type": "commit"}, {"oid": "040b3d56b2e3f17dc7d6a13aa12453d047312af8", "url": "https://github.com/zaproxy/zap-extensions/commit/040b3d56b2e3f17dc7d6a13aa12453d047312af8", "message": "squashing commitsh\n\nSigned-off-by: michael.rodriguez <michael.rodriguez@thetradedesk.com>", "committedDate": "2020-12-09T18:43:54Z", "type": "forcePushed"}]}