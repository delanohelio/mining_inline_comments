{"pr_number": 4385, "pr_title": "[WFCORE-4135] Support for read only server configuration directory", "pr_createdAt": "2020-11-05T10:30:38Z", "pr_url": "https://github.com/wildfly/wildfly-core/pull/4385", "timeline": [{"oid": "60eaf2028f5a486e699e671e960842c07cdf567b", "url": "https://github.com/wildfly/wildfly-core/commit/60eaf2028f5a486e699e671e960842c07cdf567b", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory", "committedDate": "2020-11-11T15:32:02Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNDI1MA==", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528434250", "bodyText": "Please add javadoc for the useGit param.", "author": "bstansberry", "createdAt": "2020-11-23T01:04:50Z", "path": "controller/src/main/java/org/jboss/as/controller/persistence/ConfigurationFile.java", "diffHunk": "@@ -151,6 +152,20 @@ public ConfigurationFile(final File configurationDir, final String rawName, fina\n         this(configurationDir, rawName, name, persistOriginal ? InteractionPolicy.STANDARD : InteractionPolicy.READ_ONLY, false);\n     }\n \n+    /**\n+     * Creates a new ConfigurationFile.\n+     *\n+     * @param configurationDir  directory in which configuration files are stored. Cannot be {@code null} and must exist\n+     *                          and be a directory\n+     * @param rawName           default name for configuration files of the type handled by this object.\n+     *                          Cannot be {@code null} or an empty string\n+     * @param name              user provided name of the configuration file to use\n+     * @param interactionPolicy policy governing interaction with the configuration file.\n+     */\n+    public ConfigurationFile(final File configurationDir, final String rawName, final String name, final InteractionPolicy interactionPolicy, final boolean useGit) {", "originalCommit": "60eaf2028f5a486e699e671e960842c07cdf567b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODYzOTk3Nw==", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528639977", "bodyText": "javadoc added", "author": "yersan", "createdAt": "2020-11-23T11:36:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNDI1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNDI4Mg==", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528434282", "bodyText": "Please add javadoc for the tmpDir param.", "author": "bstansberry", "createdAt": "2020-11-23T01:05:07Z", "path": "controller/src/main/java/org/jboss/as/controller/persistence/ConfigurationFile.java", "diffHunk": "@@ -163,19 +178,22 @@ public ConfigurationFile(final File configurationDir, final String rawName, fina\n      * @param useGit {@code true} if configuration is using Git to manage its history.", "originalCommit": "60eaf2028f5a486e699e671e960842c07cdf567b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY0MDA0NQ==", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528640045", "bodyText": "javadoc added", "author": "yersan", "createdAt": "2020-11-23T11:36:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNDI4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNTY1Mw==", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528435653", "bodyText": "I believe this can be package protected. If so, please make it package protected.", "author": "bstansberry", "createdAt": "2020-11-23T01:15:44Z", "path": "controller/src/main/java/org/jboss/as/controller/persistence/ConfigurationFile.java", "diffHunk": "@@ -478,6 +496,9 @@ public File getConfigurationDir(){\n         return configurationDir;\n     }\n \n+    public File getConfigurationTmpDir() {", "originalCommit": "60eaf2028f5a486e699e671e960842c07cdf567b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODY0MDM5OQ==", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r528640399", "bodyText": "Right, made package protected. Thanks for the review.", "author": "yersan", "createdAt": "2020-11-23T11:37:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODQzNTY1Mw=="}], "type": "inlineReview"}, {"oid": "dc693956d6e9d9ce2827740441bc4c697fe31959", "url": "https://github.com/wildfly/wildfly-core/commit/dc693956d6e9d9ce2827740441bc4c697fe31959", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory", "committedDate": "2020-11-23T11:34:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyODY1OQ==", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r535928659", "bodyText": "Do you rather mean temporary directory?", "author": "jmesnil", "createdAt": "2020-12-04T08:43:36Z", "path": "controller/src/main/java/org/jboss/as/controller/persistence/ConfigurationFile.java", "diffHunk": "@@ -154,28 +155,48 @@ public ConfigurationFile(final File configurationDir, final String rawName, fina\n     /**\n      * Creates a new ConfigurationFile.\n      *\n-     * @param configurationDir directory in which configuration files are stored. Cannot be {@code null} and must exist\n-     *                         and be a directory\n-     * @param rawName default name for configuration files of the type handled by this object.\n-     *                Cannot be {@code null} or an empty string\n-     * @param name user provided name of the configuration file to use\n-     * @param interactionPolicy policy governing interaction with the configuration file\n-     * @param useGit {@code true} if configuration is using Git to manage its history.\n+     * @param configurationDir  directory in which configuration files are stored. Cannot be {@code null} and must exist\n+     *                          and be a directory\n+     * @param rawName           default name for configuration files of the type handled by this object.\n+     *                          Cannot be {@code null} or an empty string\n+     * @param name              user provided name of the configuration file to use\n+     * @param interactionPolicy policy governing interaction with the configuration file.\n+     * @param useGit            {@code true} if configuration is using Git to manage its history.\n+     */\n+    public ConfigurationFile(final File configurationDir, final String rawName, final String name, final InteractionPolicy interactionPolicy, final boolean useGit) {\n+        this(configurationDir, rawName, name, interactionPolicy, useGit, null);\n+    }\n+\n+    /**\n+     * Creates a new ConfigurationFile.\n+     *\n+     * @param configurationDir  directory in which configuration files are stored. Cannot be {@code null} and must exist\n+     *                          and be a directory.\n+     * @param rawName           default name for configuration files of the type handled by this object.\n+     *                          Cannot be {@code null} or an empty string.\n+     * @param name              user provided name of the configuration file to use.\n+     * @param interactionPolicy policy governing interaction with the configuration file.\n+     * @param useGit            {@code true} if configuration is using Git to manage its history.\n+     * @param tmpDir            The server temporal directory to use as a fallback if the configuration directory cannot", "originalCommit": "dc693956d6e9d9ce2827740441bc4c697fe31959", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkzNTcxOQ==", "url": "https://github.com/wildfly/wildfly-core/pull/4385#discussion_r535935719", "bodyText": "Yes @jmesnil , fixed the typo, thank you for your review", "author": "yersan", "createdAt": "2020-12-04T08:54:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyODY1OQ=="}], "type": "inlineReview"}, {"oid": "c81d065e4fc67bf0bd5588cd65868446223a6e57", "url": "https://github.com/wildfly/wildfly-core/commit/c81d065e4fc67bf0bd5588cd65868446223a6e57", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory", "committedDate": "2020-12-04T08:53:08Z", "type": "commit"}, {"oid": "c81d065e4fc67bf0bd5588cd65868446223a6e57", "url": "https://github.com/wildfly/wildfly-core/commit/c81d065e4fc67bf0bd5588cd65868446223a6e57", "message": "[WFCORE-4135] Allow ConfigurationFile to work with a read only directory\n\n[WFCORE-4135] Test server is able to start with a read only config directory", "committedDate": "2020-12-04T08:53:08Z", "type": "forcePushed"}]}