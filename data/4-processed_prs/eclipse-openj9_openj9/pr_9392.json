{"pr_number": 9392, "pr_title": "Enable JIT testing for value types tests", "pr_createdAt": "2020-04-28T20:55:29Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/9392", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODM0NDY3Ng==", "url": "https://github.com/eclipse-openj9/openj9/pull/9392#discussion_r418344676", "bodyText": "We should also add invocationCount = 2 and add an -Xjit:count=1,disableAsyncCompilation test as that is more realistic once we can inline methods.", "author": "fjeremic", "createdAt": "2020-04-30T23:27:34Z", "path": "test/functional/Valhalla/playlist.xml", "diffHunk": "@@ -25,13 +25,13 @@\n \t<test>\n \t\t<testCaseName>ValueTypeTests</testCaseName>\n \t\t<variations>\n-\t\t\t<variation>NoOptions</variation>\n-\t\t\t<variation>-Xgcpolicy:nogc -XX:ValueTypeFlatteningThreshold=99999</variation>\n-\t\t\t<variation>-Xgcpolicy:optthruput -Xnocompactgc -XX:ValueTypeFlatteningThreshold=99999</variation>\n+\t\t\t<variation>-Xint</variation>\n+\t\t\t<variation>-Xint -Xgcpolicy:nogc -XX:ValueTypeFlatteningThreshold=99999</variation>\n+\t\t\t<variation>-Xint -Xgcpolicy:optthruput -Xnocompactgc -XX:ValueTypeFlatteningThreshold=99999</variation>\n+\t\t\t<variation>-Xjit:count=0</variation>", "originalCommit": "07912b470350b3e0d3c886a57fffe7b232b31b91", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6e2960ceaa613d45472bdd35535848c32d7fade1", "url": "https://github.com/eclipse-openj9/openj9/commit/6e2960ceaa613d45472bdd35535848c32d7fade1", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a variation to test with JIT compilation forced on with count=0,\nand a second variation with count=1,disableAsyncCompilation to make the\ncompilation scenarios a little more realistic.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-05-05T20:15:31Z", "type": "forcePushed"}, {"oid": "bb08a840e301023ec55aa7b8c713d3bf6da494d1", "url": "https://github.com/eclipse-openj9/openj9/commit/bb08a840e301023ec55aa7b8c713d3bf6da494d1", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a variation to test with JIT compilation forced on with count=0,\nand a second variation with count=1,disableAsyncCompilation to make the\ncompilation scenarios a little more realistic.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-06-26T17:56:46Z", "type": "forcePushed"}, {"oid": "b2233cad2c902dfea599f4ed1aac9dfd0ff32d78", "url": "https://github.com/eclipse-openj9/openj9/commit/b2233cad2c902dfea599f4ed1aac9dfd0ff32d78", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a new test case name to invoke those same tests with two different\nvariations:  one with JIT compilation forced on with count=0, and a\nsecond variation with count=1,disableAsyncCompilation to make the\ncompilation scenarios a little more realistic.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-07-14T18:16:16Z", "type": "forcePushed"}, {"oid": "2a43d1a1e2bf644a770b6126fe0f38880fedb18d", "url": "https://github.com/eclipse-openj9/openj9/commit/2a43d1a1e2bf644a770b6126fe0f38880fedb18d", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a new test case name to invoke those same tests with two different\nvariations:  one with JIT compilation forced on with count=0, and a\nsecond variation with count=1,disableAsyncCompilation to make the\ncompilation scenarios a little more realistic.\n\nThe tests method testCheckCastValueTypeOnInvalidQtype is excluded from\nJIT testing for now, as it fails consistently.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-07-14T18:21:18Z", "type": "forcePushed"}, {"oid": "7b52c734e787e6ea405fd75f2f892bb9cb76ed0c", "url": "https://github.com/eclipse-openj9/openj9/commit/7b52c734e787e6ea405fd75f2f892bb9cb76ed0c", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a new test case name to invoke those same tests with two different\nvariations:  one with JIT compilation forced on with count=0, and a\nsecond variation with count=1,disableAsyncCompilation to make the\ncompilation scenarios a little more realistic.\n\nThe tests method testCheckCastValueTypeOnInvalidQtype is excluded from\nJIT testing for now, as it fails consistently.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-07-15T14:59:35Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTE2MDg3Mw==", "url": "https://github.com/eclipse-openj9/openj9/pull/9392#discussion_r455160873", "bodyText": "I'm not a committer. I wonder if testCheckCastValueTypeOnInvalidQtype still needs to be excluded here. The test failure #10056  in TestCheckCastOnInvalidQtype.testCheckCastOnInvalidQtype  is being fixed in #10068.", "author": "a7ehuo", "createdAt": "2020-07-15T15:59:51Z", "path": "test/functional/Valhalla/testng.xml", "diffHunk": "@@ -31,4 +31,13 @@\n \t\t\t<class name=\"org.openj9.test.lworld.ValueTypeTests\" />\n \t\t</classes>\n \t</test>\n+\t<test name=\"ValueTypeTestsJIT\">\n+\t\t<classes>\n+\t\t\t<class name=\"org.openj9.test.lworld.ValueTypeTests\">\n+\t\t\t\t<methods>\n+\t\t\t\t\t<exclude name=\"testCheckCastValueTypeOnInvalidQtype\"/>", "originalCommit": "7b52c734e787e6ea405fd75f2f892bb9cb76ed0c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU5MzIxOQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9392#discussion_r457593219", "bodyText": "Thanks, Annabelle @a7ehuo!  Removed the excluded test from commit 2d150f3, now that pull request #10068 has been merged.", "author": "hzongaro", "createdAt": "2020-07-20T18:00:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTE2MDg3Mw=="}], "type": "inlineReview"}, {"oid": "32c0d92d6d72f80cd29b9216ec9d6a41f7047379", "url": "https://github.com/eclipse-openj9/openj9/commit/32c0d92d6d72f80cd29b9216ec9d6a41f7047379", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a new test case name to invoke those same tests with two different\nvariations:  one with JIT compilation forced on with count=0, and a\nsecond variation with count=1,disableAsyncCompilation to make the\ncompilation scenarios a little more realistic.\n\nThe tests method testCheckCastValueTypeOnInvalidQtype is excluded from\nJIT testing for now, as it fails consistently.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-07-15T15:38:51Z", "type": "forcePushed"}, {"oid": "2d150f3c989bed00681dd1082412e1e04bb421e3", "url": "https://github.com/eclipse-openj9/openj9/commit/2d150f3c989bed00681dd1082412e1e04bb421e3", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a new test case name to invoke those same tests with a new test\nvariation that has JIT compilation enabled with\n-Xjit:count=1,disableAsyncCompilation.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-07-20T15:06:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU1OTQ3NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9392#discussion_r461559474", "bodyText": "minor indentation issue here", "author": "tajila", "createdAt": "2020-07-28T12:59:51Z", "path": "test/functional/Valhalla/playlist.xml", "diffHunk": "@@ -53,4 +53,37 @@\n \t\t\t<impl>ibm</impl>\n \t\t </impls>\n \t</test>\n+\t<test>\n+\t\t<testCaseName>ValueTypeTestsJIT</testCaseName>\n+\t\t<variations>\n+\t\t\t<!--\n+\t\t\t  - -Xjit:count=0 temporarily disabled due to intermittent failures\n+\t\t\t  -\n+\t\t\t  -\t<variation>-Xjit:count=0</variation>\n+\t\t\t  -->\n+\t\t\t<variation>-Xjit:count=1,disableAsyncCompilation</variation>\n+\t\t</variations>\n+\t\t<command>$(JAVA_COMMAND) $(JVM_OPTIONS) \\\n+\t\t-Xverify:none \\\n+\t\t--add-opens java.base/jdk.internal.misc=ALL-UNNAMED \\\n+\t\t-XX:+EnableValhalla \\\n+\t\t-cp $(Q)$(LIB_DIR)$(D)asm-all.jar$(P)$(RESOURCES_DIR)$(P)$(TESTNG)$(P)$(TEST_RESROOT)$(D)ValhallaTests.jar$(Q) \\\n+\t\torg.testng.TestNG -d $(REPORTDIR) $(Q)$(TEST_RESROOT)$(D)testng.xml$(Q) -testnames ValueTypeTestsJIT \\\n+\t\t-groups $(TEST_GROUP) \\\n+\t\t-excludegroups $(DEFAULT_EXCLUDE); \\\n+\t\t$(TEST_STATUS)</command>\n+\t\t<levels>\n+\t\t\t<level>sanity</level>\n+\t\t</levels>\n+\t\t<groups>\n+\t\t\t<group>functional</group>\n+\t\t</groups>\n+\t\t<subsets>\n+\t\t\t<subset>Valhalla</subset>\n+\t\t</subsets>\n+\t\t<impls>\n+\t\t\t<impl>openj9</impl>\n+\t\t\t<impl>ibm</impl>\n+\t\t </impls>", "originalCommit": "2d150f3c989bed00681dd1082412e1e04bb421e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc2MjI0NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9392#discussion_r461762244", "bodyText": "Fixed indentation issue in commit 5e799b4", "author": "hzongaro", "createdAt": "2020-07-28T17:47:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTU1OTQ3NA=="}], "type": "inlineReview"}, {"oid": "5e799b4cef13b70ed659ec0c153d12afbf1b5c6b", "url": "https://github.com/eclipse-openj9/openj9/commit/5e799b4cef13b70ed659ec0c153d12afbf1b5c6b", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a new test case name to invoke those same tests with a new test\nvariation that has JIT compilation enabled with\n-Xjit:count=1,disableAsyncCompilation.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-07-28T17:46:30Z", "type": "commit"}, {"oid": "5e799b4cef13b70ed659ec0c153d12afbf1b5c6b", "url": "https://github.com/eclipse-openj9/openj9/commit/5e799b4cef13b70ed659ec0c153d12afbf1b5c6b", "message": "Enable JIT testing for value types tests\n\nThis change adds an invocationCount of 2 to the value type tests, along\nwith a new test case name to invoke those same tests with a new test\nvariation that has JIT compilation enabled with\n-Xjit:count=1,disableAsyncCompilation.\n\nSigned-off-by:  Henry Zongaro <zongaro@ca.ibm.com>", "committedDate": "2020-07-28T17:46:30Z", "type": "forcePushed"}]}