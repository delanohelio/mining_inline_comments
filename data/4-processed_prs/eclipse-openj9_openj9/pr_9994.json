{"pr_number": 9994, "pr_title": "Use _NSGetEnviron() on OSX to retrieve environ", "pr_createdAt": "2020-06-23T22:28:01Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/9994", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU3MjE0OQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9994#discussion_r444572149", "bodyText": "Bit of a nitpick - usually we label the else as well\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            #else\n          \n          \n            \n            #else /* defined(OSX) */", "author": "DanHeidinga", "createdAt": "2020-06-24T00:02:03Z", "path": "runtime/vm/rasdump.c", "diffHunk": "@@ -289,7 +293,12 @@ configureRasDump(J9JavaVM *vm)\n void\n J9RASInitialize(J9JavaVM* javaVM)\n {\n+#if defined(OSX)\n+\tchar **environ = *_NSGetEnviron();\n+#else", "originalCommit": "5520232b6302671cfffaa55c0cfc6eae452daedc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d07d9e01520a87a4877db427a921a5ad58e5c369", "url": "https://github.com/eclipse-openj9/openj9/commit/d07d9e01520a87a4877db427a921a5ad58e5c369", "message": "Use _NSGetEnviron() on OSX to retrieve environ\n\nDirect access to `environ` on OSX should use _NSGetEnviron(), as\n`environ` is only directly accessible via that environment\nsubroutine from shared libraries and bundles.\n\n---\n\n`environ` is a list of strings that is made available when a\nprocess begins. Each string has the convention \"name=value\" which\nis set in the user environment.\n\n`environ` can be directly accessed, except from shared libraries\nand bundles, since it is only available to the loader `ld` when a\ncomplete program is being linked. The environment routines\n`getenv`, `setenv` and `putenv` can be used to access `environ`\nwhether referenced by the loader or in shared libraries and\nbundles. If direct access to `environ` is needed in shared\nlibraries or bundles for OSX, `_NSGetEnviron` (defined in\n`crt_externs.h`) can be used to retrieve `environ` at runtime.\n\nSource: https://opensource.apple.com/source/Libc/Libc-1353.41.1/man/FreeBSD/environ.7.auto.html\n\nSigned-off-by: Sharon Wang <sharon-wang-cpsc@outlook.com>", "committedDate": "2020-06-24T01:44:16Z", "type": "commit"}, {"oid": "d07d9e01520a87a4877db427a921a5ad58e5c369", "url": "https://github.com/eclipse-openj9/openj9/commit/d07d9e01520a87a4877db427a921a5ad58e5c369", "message": "Use _NSGetEnviron() on OSX to retrieve environ\n\nDirect access to `environ` on OSX should use _NSGetEnviron(), as\n`environ` is only directly accessible via that environment\nsubroutine from shared libraries and bundles.\n\n---\n\n`environ` is a list of strings that is made available when a\nprocess begins. Each string has the convention \"name=value\" which\nis set in the user environment.\n\n`environ` can be directly accessed, except from shared libraries\nand bundles, since it is only available to the loader `ld` when a\ncomplete program is being linked. The environment routines\n`getenv`, `setenv` and `putenv` can be used to access `environ`\nwhether referenced by the loader or in shared libraries and\nbundles. If direct access to `environ` is needed in shared\nlibraries or bundles for OSX, `_NSGetEnviron` (defined in\n`crt_externs.h`) can be used to retrieve `environ` at runtime.\n\nSource: https://opensource.apple.com/source/Libc/Libc-1353.41.1/man/FreeBSD/environ.7.auto.html\n\nSigned-off-by: Sharon Wang <sharon-wang-cpsc@outlook.com>", "committedDate": "2020-06-24T01:44:16Z", "type": "forcePushed"}]}