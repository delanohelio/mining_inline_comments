{"pr_number": 8295, "pr_title": "Fix the issue with the dangling pointer at shutdown", "pr_createdAt": "2020-01-14T04:37:57Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/8295", "timeline": [{"oid": "99d34332bcdb61f1e5bc8a1a32124084119f91bf", "url": "https://github.com/eclipse-openj9/openj9/commit/99d34332bcdb61f1e5bc8a1a32124084119f91bf", "message": "Fix the issue with the dangling pointer at shutdown\n\nThe change is to ensure the allocated memory in each \nelement of the linked list plus the element itself\nis safely released at the shutdown of SCC.\n\nFixes: #8140\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>", "committedDate": "2020-01-14T04:45:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE3MjA5OA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8295#discussion_r366172098", "bodyText": "Can this line be moved before the call to cleanup()?   Fetching the next before doing the cleanup ensures that future changes to cleanup don't mess this up", "author": "DanHeidinga", "createdAt": "2020-01-14T06:40:37Z", "path": "runtime/shared_common/CacheMap.cpp", "diffHunk": "@@ -375,11 +375,12 @@ SH_CacheMap::cleanup(J9VMThread* currentThread)\n \t}\n \twhile (theCC) {\n \t\ttheCC->cleanup(currentThread);\n-\t\ttheCC = theCC->getNext();\n+\t\tSH_CompositeCacheImpl* nextCC = theCC->getNext();", "originalCommit": "99d34332bcdb61f1e5bc8a1a32124084119f91bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjM1NzM1OQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8295#discussion_r366357359", "bodyText": "Agreed and updated the fix as suggested above.", "author": "ChengJin01", "createdAt": "2020-01-14T14:09:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE3MjA5OA=="}], "type": "inlineReview"}, {"oid": "57c54a1222974395d0311c4106fc2bdd3b5d29b3", "url": "https://github.com/eclipse-openj9/openj9/commit/57c54a1222974395d0311c4106fc2bdd3b5d29b3", "message": "Fix the issue with the dangling pointer at shutdown\n\nThe change is to ensure the allocated memory in each \nelement of the linked list plus the element itself\nis safely released at the shutdown of SCC.\n\nFixes: #8140\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>", "committedDate": "2020-01-14T14:06:32Z", "type": "commit"}, {"oid": "57c54a1222974395d0311c4106fc2bdd3b5d29b3", "url": "https://github.com/eclipse-openj9/openj9/commit/57c54a1222974395d0311c4106fc2bdd3b5d29b3", "message": "Fix the issue with the dangling pointer at shutdown\n\nThe change is to ensure the allocated memory in each \nelement of the linked list plus the element itself\nis safely released at the shutdown of SCC.\n\nFixes: #8140\n\nSigned-off-by: Cheng Jin <jincheng@ca.ibm.com>", "committedDate": "2020-01-14T14:06:32Z", "type": "forcePushed"}]}