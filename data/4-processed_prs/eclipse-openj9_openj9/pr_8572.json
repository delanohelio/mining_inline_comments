{"pr_number": 8572, "pr_title": "Support new escape sequences introduced in JDK 14 (JEP 368)", "pr_createdAt": "2020-02-13T16:39:17Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/8572", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk4NTU5NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8572#discussion_r378985594", "bodyText": "I am not sure if this \\r case is required as all newline character (\\r, \\n, \\r\\n) should be normalized to \\n during stripIndent() call before this method is called. (line 8441 in this file)", "author": "fengxue-IS", "createdAt": "2020-02-13T16:48:59Z", "path": "jcl/src/java.base/share/classes/java/lang/String.java", "diffHunk": "@@ -8521,6 +8524,14 @@ public String translateEscapes() {\n \t\t\t\t\t}\n \t\t\t\t\tbuilder.append((char)octal);\n \t\t\t\t\tbreak;\n+\t\t\t\tcase '\\r':", "originalCommit": "be5eca83feffb544854143c406428e859bb1acef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk5MTg4OQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8572#discussion_r378991889", "bodyText": "The verifyLineTerminator() test from TranslateEscapes.java failed on \\r and \\r\\n when I didn't have the case for \\r. I think this is because the test directly calls translateEscapes(), so the string isn't normalized by stripIndent()", "author": "sharon-wang", "createdAt": "2020-02-13T16:59:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk4NTU5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk4ODIxMg==", "url": "https://github.com/eclipse-openj9/openj9/pull/8572#discussion_r378988212", "bodyText": "maybe add a comment for why ignoring \\n here?", "author": "fengxue-IS", "createdAt": "2020-02-13T16:53:10Z", "path": "jcl/src/java.base/share/classes/java/lang/String.java", "diffHunk": "@@ -8521,6 +8524,14 @@ public String translateEscapes() {\n \t\t\t\t\t}\n \t\t\t\t\tbuilder.append((char)octal);\n \t\t\t\t\tbreak;\n+\t\t\t\tcase '\\r':\n+\t\t\t\t\t/* Check if the next character is the newline character, i.e. case \"\\r\\n\" */\n+\t\t\t\t\tif (((index + 1) < strLength) && ('\\n' == charArray[index + 1])) {\n+\t\t\t\t\t\tindex++;\n+\t\t\t\t\t}\n+\t\t\t\t\tbreak;\n+\t\t\t\tcase '\\n':", "originalCommit": "be5eca83feffb544854143c406428e859bb1acef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE1MjU0NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8572#discussion_r379152544", "bodyText": "added comment to explain line terminator cases", "author": "sharon-wang", "createdAt": "2020-02-13T22:22:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk4ODIxMg=="}], "type": "inlineReview"}, {"oid": "bbbdfab11a3cab5780bfba235bd8ede3b772d0d7", "url": "https://github.com/eclipse-openj9/openj9/commit/bbbdfab11a3cab5780bfba235bd8ede3b772d0d7", "message": "Support new escape sequences introduced in JDK 14 (JEP 368)\n\njava.lang.String.translateEscapes() now supports:\n`\\s`: space\n`\\<line-terminator>`: continuation\n\n<line-terminator> can be '\\n', '\\r', '\\r\\n'\n\nFor reference:\nhttps://openjdk.java.net/jeps/368#New-escape-sequences\nhttp://cr.openjdk.java.net/~iris/se/14/build/latest/api/java.base/java/lang/String.html#translateEscapes()\n\nSigned-off-by: Sharon Wang <sharon-wang-cpsc@outlook.com>", "committedDate": "2020-02-13T22:19:51Z", "type": "commit"}, {"oid": "bbbdfab11a3cab5780bfba235bd8ede3b772d0d7", "url": "https://github.com/eclipse-openj9/openj9/commit/bbbdfab11a3cab5780bfba235bd8ede3b772d0d7", "message": "Support new escape sequences introduced in JDK 14 (JEP 368)\n\njava.lang.String.translateEscapes() now supports:\n`\\s`: space\n`\\<line-terminator>`: continuation\n\n<line-terminator> can be '\\n', '\\r', '\\r\\n'\n\nFor reference:\nhttps://openjdk.java.net/jeps/368#New-escape-sequences\nhttp://cr.openjdk.java.net/~iris/se/14/build/latest/api/java.base/java/lang/String.html#translateEscapes()\n\nSigned-off-by: Sharon Wang <sharon-wang-cpsc@outlook.com>", "committedDate": "2020-02-13T22:19:51Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE1MjMwNw==", "url": "https://github.com/eclipse-openj9/openj9/pull/8572#discussion_r379152307", "bodyText": "@fengxue-IS this is the added comment to explain why we're ignoring the line terminators", "author": "sharon-wang", "createdAt": "2020-02-13T22:21:28Z", "path": "jcl/src/java.base/share/classes/java/lang/String.java", "diffHunk": "@@ -8521,6 +8524,19 @@ public String translateEscapes() {\n \t\t\t\t\t}\n \t\t\t\t\tbuilder.append((char)octal);\n \t\t\t\t\tbreak;\n+\t\t\t\t/**\n+\t\t\t\t * JEP 368: Text Blocks (Second Preview)\n+\t\t\t\t * '\\r', \"\\r\\n\" and '\\n' are ignored as per new continuation \\<line-terminator> escape sequence \n+\t\t\t\t * i.e. ignore line terminator and continue line\n+\t\t\t\t * */", "originalCommit": "bbbdfab11a3cab5780bfba235bd8ede3b772d0d7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ2NzYzMg==", "url": "https://github.com/eclipse-openj9/openj9/pull/8572#discussion_r379467632", "bodyText": "Shouldn't this be guarded by /*[IF Java14]*/?", "author": "keithc-ca", "createdAt": "2020-02-14T14:45:22Z", "path": "jcl/src/java.base/share/classes/java/lang/String.java", "diffHunk": "@@ -8487,6 +8487,9 @@ public String translateEscapes() {\n \t\t\t\tcase 'r':\n \t\t\t\t\tbuilder.append('\\r');\n \t\t\t\t\tbreak;\n+\t\t\t\tcase 's':", "originalCommit": "bbbdfab11a3cab5780bfba235bd8ede3b772d0d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ5MDMyNA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8572#discussion_r379490324", "bodyText": "Java 13 is no longer supported, and this code is only for Java 14 now.", "author": "pshipton", "createdAt": "2020-02-14T15:25:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ2NzYzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTUwNzM1OQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8572#discussion_r379507359", "bodyText": "Right: I missed that the region was only for Java13+. Sorry for the distraction.", "author": "keithc-ca", "createdAt": "2020-02-14T15:55:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTQ2NzYzMg=="}], "type": "inlineReview"}]}