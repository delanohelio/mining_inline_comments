{"pr_number": 8752, "pr_title": "Fix stackmap always marking ConstantDynamic as objects", "pr_createdAt": "2020-03-04T22:35:39Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/8752", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NDczNw==", "url": "https://github.com/eclipse-openj9/openj9/pull/8752#discussion_r387984737", "bodyText": "Do not use implicit zero comparisons. Also, strictly speaking the constant should be on the left of the comparison.", "author": "gacholio", "createdAt": "2020-03-04T22:57:23Z", "path": "runtime/stackmap/stackmap.c", "diffHunk": "@@ -350,7 +350,14 @@ mapStack(UDATA *scratch, UDATA totalStack, U_8 * map, J9ROMClass * romClass, J9R\n \t\t\t\t}\n \n \t\t\t\tif (pool[index].slot2) {\n-\t\t\t\t\tPUSH(OBJ);\n+\t\t\t\t\t/* Check for primitive values resolved from ConstantDynamic */\n+\t\t\t\t\tif (((pool[index].slot2 & J9DescriptionCpTypeMask) == J9DescriptionCpTypeConstantDynamic)\n+\t\t\t\t\t&& (pool[index].slot2 >> J9DescriptionReturnTypeShift)", "originalCommit": "5cdffa99129e5a20a53953ac0f6fac38e0210919", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NjI3OQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8752#discussion_r387986279", "bodyText": "fixed", "author": "fengxue-IS", "createdAt": "2020-03-04T23:01:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk4NDczNw=="}], "type": "inlineReview"}, {"oid": "f635f8d501ea3fb36b95f6c0c5f81dda18e41a7d", "url": "https://github.com/eclipse-openj9/openj9/commit/f635f8d501ea3fb36b95f6c0c5f81dda18e41a7d", "message": "Fix stackmap always marking ConstantDynamic as objects\n\n- Check Condy return type before marking stack slot\n\nSigned-off-by: Jack Lu <Jack.S.Lu@ibm.com>", "committedDate": "2020-03-04T23:00:58Z", "type": "commit"}, {"oid": "f635f8d501ea3fb36b95f6c0c5f81dda18e41a7d", "url": "https://github.com/eclipse-openj9/openj9/commit/f635f8d501ea3fb36b95f6c0c5f81dda18e41a7d", "message": "Fix stackmap always marking ConstantDynamic as objects\n\n- Check Condy return type before marking stack slot\n\nSigned-off-by: Jack Lu <Jack.S.Lu@ibm.com>", "committedDate": "2020-03-04T23:00:58Z", "type": "forcePushed"}]}