{"pr_number": 8592, "pr_title": "Update double map call to use new API", "pr_createdAt": "2020-02-16T16:43:31Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/8592", "timeline": [{"oid": "d9f7c93dc4938f2c5d79a547fcec8566e15d305a", "url": "https://github.com/eclipse-openj9/openj9/commit/d9f7c93dc4938f2c5d79a547fcec8566e15d305a", "message": "Add functionality to allow double map with huge pages\n\nIntroduce new flags to control if heap should be created\nusing memfd_create or shm_get in case of double mapping.\nNote that memfd_create is only available starting at\nglibc version 2.27\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-02-16T16:46:23Z", "type": "forcePushed"}, {"oid": "ff143414f436a9a36e52e6f526116ee23f85c169", "url": "https://github.com/eclipse-openj9/openj9/commit/ff143414f436a9a36e52e6f526116ee23f85c169", "message": "Update double map API to only be available in newer versions\n\nDouble map will only be available in systems that support\nglibc versions 2.27 or newwer due to new API that's being\nused\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-03-13T00:59:50Z", "type": "forcePushed"}, {"oid": "fd802dd9000b1c82120edb60592ddd754986b902", "url": "https://github.com/eclipse-openj9/openj9/commit/fd802dd9000b1c82120edb60592ddd754986b902", "message": "Update double map API to only be available in newer versions\n\nDouble map will only be available in systems that support\nglibc versions 2.27 or newwer due to new API that's being\nused\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-03-13T01:08:48Z", "type": "forcePushed"}, {"oid": "e103e223ca94f5f62c41ed37ca41ac7900374f73", "url": "https://github.com/eclipse-openj9/openj9/commit/e103e223ca94f5f62c41ed37ca41ac7900374f73", "message": "Update double map API to only be available in newer versions\n\nDouble map will only be available in systems that support\nglibc versions 2.27 or newwer due to new API that's being\nused\n\nAdd double map trace points\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-03-20T23:15:10Z", "type": "forcePushed"}, {"oid": "94a542e17e65e14e1129ded46b989f8f20303f8c", "url": "https://github.com/eclipse-openj9/openj9/commit/94a542e17e65e14e1129ded46b989f8f20303f8c", "message": "Update double map API to only be available in newer versions\n\nDouble map will only be available in systems that support\nglibc versions 2.27 or newwer due to new API that's being\nused\n\nAdd double map trace points\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-03-22T20:03:46Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAxMjAwNg==", "url": "https://github.com/eclipse-openj9/openj9/pull/8592#discussion_r398012006", "bodyText": "Naming of options in this file isn't completely consistent. Sometimes there is 'use', sometimes there is 'enable', sometimes there is nothing (for example for TransparentHugePage). I personally prefer 'nothing' since '+' and '-' serve the purpose of words 'enable' and 'disable'.", "author": "amicic", "createdAt": "2020-03-25T16:52:59Z", "path": "runtime/oti/jvminit.h", "diffHunk": "@@ -452,6 +452,9 @@ enum INIT_STAGE {\n #define VMOPT_XXUSECONTAINERSUPPORT \"-XX:+UseContainerSupport\"\n #define VMOPT_XXNOUSECONTAINERSUPPORT \"-XX:-UseContainerSupport\"\n \n+#define VMOPT_PORT_VMEM_HUGE_PAGES_MMAP_ENABLED \"-XX:+enableHugePagesWithMmap\"\n+#define VMOPT_PORT_VMEM_HUGE_PAGES_MMAP_DISABLED \"-XX:-enableHugePagesWithMmap\"", "originalCommit": "aa8c62397aa33259877fdba6585b436372a251ea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAxNTE0Nw==", "url": "https://github.com/eclipse-openj9/openj9/pull/8592#discussion_r398015147", "bodyText": "Cool, so in the case of VMOPT_PORT_VMEM_HUGE_PAGES_MMAP_DISABLED it would become VMOPT_PORT_VMEM_NO_HUGE_PAGES_MMAP", "author": "bragaigor", "createdAt": "2020-03-25T16:57:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAxMjAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyMjk5MA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8592#discussion_r398022990", "bodyText": "I think having enable/disable in various internal constants and variables are ok. I just did not like it in the name of the command line options.", "author": "amicic", "createdAt": "2020-03-25T17:07:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAxMjAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyMzk4MA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8592#discussion_r398023980", "bodyText": "Oh I see what you mean, got it", "author": "bragaigor", "createdAt": "2020-03-25T17:09:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAxMjAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA0ODc2Mg==", "url": "https://github.com/eclipse-openj9/openj9/pull/8592#discussion_r398048762", "bodyText": "And minor nitpick - command line options should start with capital letters.  ie: -XX:+Enable...", "author": "DanHeidinga", "createdAt": "2020-03-25T17:44:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAxMjAwNg=="}], "type": "inlineReview"}, {"oid": "b0f9b0a02401cf7a8e5a0977b078ab201b6b4379", "url": "https://github.com/eclipse-openj9/openj9/commit/b0f9b0a02401cf7a8e5a0977b078ab201b6b4379", "message": "Update command line name for huge pages with mmap\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-03-26T02:55:51Z", "type": "forcePushed"}, {"oid": "bec9976814c27eea614434363602feb6cec421b9", "url": "https://github.com/eclipse-openj9/openj9/commit/bec9976814c27eea614434363602feb6cec421b9", "message": "Update command line name for huge pages with mmap\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-03-31T01:47:52Z", "type": "forcePushed"}, {"oid": "4fefa12cad2d0beed17925ba151f23e891c1e741", "url": "https://github.com/eclipse-openj9/openj9/commit/4fefa12cad2d0beed17925ba151f23e891c1e741", "message": "Update double map API to only be available in newer versions\n\nDouble map will only be available in systems that support\nglibc versions 2.27 or newwer due to new API that's being\nused\n\nAdd double map trace points\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-04-14T18:36:09Z", "type": "forcePushed"}, {"oid": "0ce0eaa4c789d07c55469dacd8f25b301056c36a", "url": "https://github.com/eclipse-openj9/openj9/commit/0ce0eaa4c789d07c55469dacd8f25b301056c36a", "message": "Update double map API to only be available in newer versions\n\nDouble map will only be available in systems that support\nglibc versions 2.27 or newwer due to new API that's being\nused\n\nAdd double map trace points\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-04-16T13:31:00Z", "type": "commit"}, {"oid": "0ce0eaa4c789d07c55469dacd8f25b301056c36a", "url": "https://github.com/eclipse-openj9/openj9/commit/0ce0eaa4c789d07c55469dacd8f25b301056c36a", "message": "Update double map API to only be available in newer versions\n\nDouble map will only be available in systems that support\nglibc versions 2.27 or newwer due to new API that's being\nused\n\nAdd double map trace points\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-04-16T13:31:00Z", "type": "forcePushed"}]}