{"pr_number": 10781, "pr_title": "Add security check at System.loadLibrary(libName)", "pr_createdAt": "2020-10-05T14:13:13Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/10781", "timeline": [{"oid": "58d1fe703fc3f43b65ba9e35f8ddf8f6a0146f77", "url": "https://github.com/eclipse-openj9/openj9/commit/58d1fe703fc3f43b65ba9e35f8ddf8f6a0146f77", "message": "Add security check at System.loadLibrary(libName)\n\nAdded SecurityManager.checkLink(libName) within\nSystem.loadLibrary(libName);\nRemoved the security check within loadLibraryWithClassLoader;\nAssume the caller of ClassLoader.loadLibrary(caller, name, fullPath)\nperform the security check.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>", "committedDate": "2020-10-04T03:00:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzNzQ3Nw==", "url": "https://github.com/eclipse-openj9/openj9/pull/10781#discussion_r499637477", "bodyText": "This can't be removed, there are other callers than loadLibrary(String)", "author": "pshipton", "createdAt": "2020-10-05T14:24:05Z", "path": "jcl/src/java.base/share/classes/java/lang/ClassLoader.java", "diffHunk": "@@ -1913,9 +1913,6 @@ static ClassLoader callerClassLoader() {\n  *\t\t\t\t\t\t\tif the library was not allowed to be loaded\n  */\n static void loadLibraryWithClassLoader(String libName, ClassLoader loader) {\n-\tSecurityManager smngr = System.getSecurityManager();", "originalCommit": "58d1fe703fc3f43b65ba9e35f8ddf8f6a0146f77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY0MzI0Ng==", "url": "https://github.com/eclipse-openj9/openj9/pull/10781#discussion_r499643246", "bodyText": "The other caller is static void loadLibrary(Class<?> caller, String name, boolean fullPath) which is not in OpenJD JDK15+, for earlier JDK level, it is invoked by Runtime.load0() & loadLibrary0() in which security.checkLink(libname) are performed first.", "author": "JasonFengJ9", "createdAt": "2020-10-05T14:31:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzNzQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY0NTI4Nw==", "url": "https://github.com/eclipse-openj9/openj9/pull/10781#discussion_r499645287", "bodyText": "See System.loadLibrary() as well.", "author": "pshipton", "createdAt": "2020-10-05T14:34:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzNzQ3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTY0ODg5MQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/10781#discussion_r499648891", "bodyText": "Right, this PR moved the security check from loadLibraryWithClassLoader() into System.loadLibrary(), note that a similar check already is within System.load().", "author": "JasonFengJ9", "createdAt": "2020-10-05T14:39:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYzNzQ3Nw=="}], "type": "inlineReview"}]}