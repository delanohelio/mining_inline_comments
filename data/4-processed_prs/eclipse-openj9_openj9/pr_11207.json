{"pr_number": 11207, "pr_title": "Fix failures on Z due to PIC Dispatch changes", "pr_createdAt": "2020-11-17T14:12:14Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/11207", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTE4NzQ4MQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/11207#discussion_r525187481", "bodyText": "@fjeremic  Can I get a review please? I found out this when rebased my changes for Static and Special Direct calls for Read only cache and tested them out.\nThis previous implementation of how we extract the Post dependencies from the dependencies and add room for new one was actually not working as it was just setting the cursor which is not what we want. To avoid the un-necessary object allocation for postDeps, so this way we just create the postDeps from the dependencies with room for new ones and set preDeps to 0.", "author": "r30shah", "createdAt": "2020-11-17T14:16:46Z", "path": "runtime/compiler/z/codegen/S390PrivateLinkage.cpp", "diffHunk": "@@ -1742,10 +1742,11 @@ J9::Z::PrivateLinkage::buildNoPatchingIPIC(TR::Node *callNode, TR::RegisterDepen\n \n    TR::RegisterDependencyConditions *preDeps = new (trHeapMemory()) TR::RegisterDependencyConditions(dependencies->getPreConditions(), NULL,\n                                                                                                          dependencies->getAddCursorForPre(), 0, cg());\n-   \n-   TR::RegisterDependencyConditions *postDeps = new (trHeapMemory()) TR::RegisterDependencyConditions(NULL, dependencies->getPostConditions(),\n-                                                                                                         0, dependencies->getAddCursorForPost() + numberOfAdditionalPostDeps, cg());\n \n+\tTR::RegisterDependencyConditions *postDeps = new (trHeapMemory()) TR::RegisterDependencyConditions(dependencies, 0, numberOfAdditionalPostDeps, cg());", "originalCommit": "64707f65aa39feea541bc3034147274744b7c11d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f1615663565d613e8206eed4570532853946dad0", "url": "https://github.com/eclipse-openj9/openj9/commit/f1615663565d613e8206eed4570532853946dad0", "message": "Fix failures on Z due to PIC Dispatch changes\n\nWhile addressing the suggestions on the PR, there were couple of issues\nintroduced that was hitting the Assert. This commit fixes them.\n\nSigned-off-by: Rahil Shah <rahil@ca.ibm.com>", "committedDate": "2020-11-17T14:31:32Z", "type": "commit"}, {"oid": "f1615663565d613e8206eed4570532853946dad0", "url": "https://github.com/eclipse-openj9/openj9/commit/f1615663565d613e8206eed4570532853946dad0", "message": "Fix failures on Z due to PIC Dispatch changes\n\nWhile addressing the suggestions on the PR, there were couple of issues\nintroduced that was hitting the Assert. This commit fixes them.\n\nSigned-off-by: Rahil Shah <rahil@ca.ibm.com>", "committedDate": "2020-11-17T14:31:32Z", "type": "forcePushed"}]}