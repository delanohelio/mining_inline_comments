{"pr_number": 9701, "pr_title": "Mac: set compatibility and current version of dylib's to 1.0.0", "pr_createdAt": "2020-05-26T21:13:59Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/9701", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcyNjY3MA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9701#discussion_r430726670", "bodyText": "if you change this to\nset(CMAKE_SHARED_LINKER_FLAGS \"${CMAKE_SHARED_LINKER_FLAGS} -Wl,-compatibility_version,1.0.0,-current_version,1.0.0\" )  I think you would get something which works. I'll do some digging to see if there is a more natural way to do this in cmake, but this should work for now.", "author": "dnakamura", "createdAt": "2020-05-26T21:47:44Z", "path": "runtime/cmake/platform/os/osx.cmake", "diffHunk": "@@ -0,0 +1,24 @@\n+################################################################################\n+# Copyright (c) 2020, 2020 IBM Corp. and others\n+#\n+# This program and the accompanying materials are made available under\n+# the terms of the Eclipse Public License 2.0 which accompanies this\n+# distribution and is available at https://www.eclipse.org/legal/epl-2.0/\n+# or the Apache License, Version 2.0 which accompanies this distribution and\n+# is available at https://www.apache.org/licenses/LICENSE-2.0.\n+#\n+# This Source Code may also be made available under the following\n+# Secondary Licenses when the conditions for such availability set\n+# forth in the Eclipse Public License, v. 2.0 are satisfied: GNU\n+# General Public License, version 2 with the GNU Classpath\n+# Exception [1] and GNU General Public License, version 2 with the\n+# OpenJDK Assembly Exception [2].\n+#\n+# [1] https://www.gnu.org/software/classpath/license.html\n+# [2] http://openjdk.java.net/legal/assembly-exception.html\n+#\n+# SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n+################################################################################\n+\n+# set OpenJ9 library versions\n+set(LDFLAGS \"${LDFLAGS} -compatibility_version 1.0.0 -current_version 1.0.0\")", "originalCommit": "7f6a8da6f02510e6429fedff8c8ea9a36aebca26", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "02d58ddc1ff3e778b1968e8ca31c500495bb55ba", "url": "https://github.com/eclipse-openj9/openj9/commit/02d58ddc1ff3e778b1968e8ca31c500495bb55ba", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-26T21:59:59Z", "type": "forcePushed"}, {"oid": "c86fe9c5f0f76f89800f573d268c6c9e24e9a17e", "url": "https://github.com/eclipse-openj9/openj9/commit/c86fe9c5f0f76f89800f573d268c6c9e24e9a17e", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-27T18:52:12Z", "type": "forcePushed"}, {"oid": "db3616bf32bbfb5f018851fd0f5c990b89f59af5", "url": "https://github.com/eclipse-openj9/openj9/commit/db3616bf32bbfb5f018851fd0f5c990b89f59af5", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-27T19:03:44Z", "type": "forcePushed"}, {"oid": "f8a04923de62c86b8d79e3352a85c41cb493aeee", "url": "https://github.com/eclipse-openj9/openj9/commit/f8a04923de62c86b8d79e3352a85c41cb493aeee", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-27T19:20:45Z", "type": "forcePushed"}, {"oid": "e3e0885c53372bb4f0fa183731156e402dabfde5", "url": "https://github.com/eclipse-openj9/openj9/commit/e3e0885c53372bb4f0fa183731156e402dabfde5", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-27T19:58:19Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQzNDIxMA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9701#discussion_r431434210", "bodyText": "All of this should be removed: the -install_name option is superseded by OMR (e.g. here) and the version options are handled by eclipse/omr#5251.", "author": "keithc-ca", "createdAt": "2020-05-27T20:51:09Z", "path": "runtime/thread/threadshared.mk.ftl", "diffHunk": "@@ -95,6 +95,7 @@ endif # Linux\n \n ifeq (osx,$(OMR_HOST_OS))\n GLOBAL_LDFLAGS += -install_name lib$(MODULE_NAME).dylib\n+GLOBAL_LDFLAGS += -compatibility_version 1.0.0 -current_version 1.0.0\n endif # OSX", "originalCommit": "e3e0885c53372bb4f0fa183731156e402dabfde5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQzNzI4NQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9701#discussion_r431437285", "bodyText": "Removed it.", "author": "pshipton", "createdAt": "2020-05-27T20:56:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQzNDIxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQzNDc2OQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9701#discussion_r431434769", "bodyText": "This change will not be necessary once eclipse/omr#5251 lands.", "author": "keithc-ca", "createdAt": "2020-05-27T20:52:18Z", "path": "runtime/hookable/hookableshared.mk.ftl", "diffHunk": "@@ -61,6 +61,10 @@ EXPORT_FUNCTIONS_FILE := $(HOOKABLE_SRCDIR)hookable.exportlist\n MODULE_STATIC_LIBS += j9utilcore j9pool\n MODULE_SHARED_LIBS += j9thr${uma.buildinfo.version.major}${uma.buildinfo.version.minor}\n \n+ifeq (osx,$(OMR_HOST_OS))\n+GLOBAL_LDFLAGS += -compatibility_version 1.0.0 -current_version 1.0.0\n+endif # OSX\n+", "originalCommit": "e3e0885c53372bb4f0fa183731156e402dabfde5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQzNzM2Ng==", "url": "https://github.com/eclipse-openj9/openj9/pull/9701#discussion_r431437366", "bodyText": "Removed it.", "author": "pshipton", "createdAt": "2020-05-27T20:57:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQzNDc2OQ=="}], "type": "inlineReview"}, {"oid": "9c62c83420eda663853e1500e583fe9efa497baf", "url": "https://github.com/eclipse-openj9/openj9/commit/9c62c83420eda663853e1500e583fe9efa497baf", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-27T20:55:46Z", "type": "forcePushed"}, {"oid": "64c2dde9393345fff49ff4006b46051adce5f5cb", "url": "https://github.com/eclipse-openj9/openj9/commit/64c2dde9393345fff49ff4006b46051adce5f5cb", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK.\nRemoved obsolete -install_name setting for j9thr29.dylib since this is\nset by OMR.\nhttps://github.com/eclipse/omr/blob/master/omrmakefiles/rules.osx.mk#L125\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-27T21:00:05Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ0MDAyMQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9701#discussion_r431440021", "bodyText": "This file isn't changing, so the copyright date need not change.", "author": "keithc-ca", "createdAt": "2020-05-27T21:02:09Z", "path": "runtime/hookable/hookableshared.mk.ftl", "diffHunk": "@@ -1,5 +1,5 @@\n ###############################################################################\n-# Copyright (c) 2016, 2017 IBM Corp. and others\n+# Copyright (c) 2016, 2020 IBM Corp. and others", "originalCommit": "64c2dde9393345fff49ff4006b46051adce5f5cb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ0MTQwNA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9701#discussion_r431441404", "bodyText": "Removed.", "author": "pshipton", "createdAt": "2020-05-27T21:04:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ0MDAyMQ=="}], "type": "inlineReview"}, {"oid": "a0f22c8e90ccaf9c3231eec92634ddff96c11574", "url": "https://github.com/eclipse-openj9/openj9/commit/a0f22c8e90ccaf9c3231eec92634ddff96c11574", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK.\nRemoved obsolete -install_name setting for j9thr29.dylib since this is\nset by OMR.\nhttps://github.com/eclipse/omr/blob/master/omrmakefiles/rules.osx.mk#L125\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-27T21:04:18Z", "type": "commit"}, {"oid": "a0f22c8e90ccaf9c3231eec92634ddff96c11574", "url": "https://github.com/eclipse-openj9/openj9/commit/a0f22c8e90ccaf9c3231eec92634ddff96c11574", "message": "Mac: set compatibility and current version of dylib's to 1.0.0\n\nFor compatibility with OpenJDK.\nRemoved obsolete -install_name setting for j9thr29.dylib since this is\nset by OMR.\nhttps://github.com/eclipse/omr/blob/master/omrmakefiles/rules.osx.mk#L125\n\n[ci skip]\n\nSigned-off-by: Peter Shipton <Peter_Shipton@ca.ibm.com>", "committedDate": "2020-05-27T21:04:18Z", "type": "forcePushed"}]}