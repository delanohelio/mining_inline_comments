{"pr_number": 9464, "pr_title": "Add GNU workaround for unused functions", "pr_createdAt": "2020-05-06T04:31:37Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/9464", "timeline": [{"oid": "4b2475ac2de668457a23a4d087e01c41ed186ebc", "url": "https://github.com/eclipse-openj9/openj9/commit/4b2475ac2de668457a23a4d087e01c41ed186ebc", "message": "Add GNU workaround for unused functions\n\nThis matches the workaround in j9accessbarrierhelpers.h and\navoids compile errors when compiling at `-O0`\n\nrelated: #9462\n\nSigned-off-by: Dan Heidinga <daniel_heidinga@ca.ibm.com>", "committedDate": "2020-05-06T04:49:32Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDc5MzcyMw==", "url": "https://github.com/eclipse-openj9/openj9/pull/9464#discussion_r420793723", "bodyText": "This one should also be in !defined(J9VM_SHRTEST) && !defined(J9SHR_CACHELET_SUPPORT), it's in the same block as j9shr_Query_IsAddressInCache() below.", "author": "pshipton", "createdAt": "2020-05-06T13:34:08Z", "path": "runtime/shared_common/include/SCQueryFunctions.h", "diffHunk": "@@ -33,6 +33,23 @@ extern \"C\"\n {\n #endif\n \n+ #if defined(__GNUC__)\n+ /*\n+  * Source files which include (directly or indirectly) this file\n+  * but do not use the functions defined below may fail to compile unless the \"unused\" attribute\n+  * is applied.\n+  * Note that Microsoft compilers do not allow this attribute.\n+  */\n+#if !defined(J9VM_SHRTEST)\n+#if !defined(J9SHR_CACHELET_SUPPORT)\n+static VMINLINE BOOLEAN j9shr_Query_IsCacheFull(J9JavaVM *vm)  __attribute__ ((__unused__));\n+static VMINLINE BOOLEAN j9shr_Query_IsAddressInCache(J9JavaVM *vm, void *address, UDATA length)  __attribute__ ((__unused__));\n+#endif /* !J9SHR_CACHELET_SUPPORT */\n+static VMINLINE void j9shr_Query_PopulatePreinitConfigDefaults(J9JavaVM *vm, J9SharedClassPreinitConfig *updatedWithDefaults)  __attribute__ ((__unused__));\n+#endif /* !J9VM_SHRTEST */\n+static VMINLINE BOOLEAN j9shr_Query_IsAddressInReadWriteCache(J9JavaVM *vm, void *address, UDATA length) __attribute__ ((__unused__));", "originalCommit": "4b2475ac2de668457a23a4d087e01c41ed186ebc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDc5OTE5Nw==", "url": "https://github.com/eclipse-openj9/openj9/pull/9464#discussion_r420799197", "bodyText": "Thanks for catching that. I've updated the PR", "author": "DanHeidinga", "createdAt": "2020-05-06T13:41:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDc5MzcyMw=="}], "type": "inlineReview"}, {"oid": "becde19b4b19d3c11154fc68889a4b95ba3a8415", "url": "https://github.com/eclipse-openj9/openj9/commit/becde19b4b19d3c11154fc68889a4b95ba3a8415", "message": "Add GNU workaround for unused functions\n\nThis matches the workaround in j9accessbarrierhelpers.h and\navoids compile errors when compiling at `-O0`\n\nfixes: #9462\n\nSigned-off-by: Dan Heidinga <daniel_heidinga@ca.ibm.com>", "committedDate": "2020-05-06T13:40:43Z", "type": "commit"}, {"oid": "becde19b4b19d3c11154fc68889a4b95ba3a8415", "url": "https://github.com/eclipse-openj9/openj9/commit/becde19b4b19d3c11154fc68889a4b95ba3a8415", "message": "Add GNU workaround for unused functions\n\nThis matches the workaround in j9accessbarrierhelpers.h and\navoids compile errors when compiling at `-O0`\n\nfixes: #9462\n\nSigned-off-by: Dan Heidinga <daniel_heidinga@ca.ibm.com>", "committedDate": "2020-05-06T13:40:43Z", "type": "forcePushed"}]}