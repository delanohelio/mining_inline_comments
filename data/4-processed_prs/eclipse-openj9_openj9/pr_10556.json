{"pr_number": 10556, "pr_title": "Unsafe copySwapMemory: no memory addresses overlap for different objects", "pr_createdAt": "2020-09-10T01:26:43Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/10556", "timeline": [{"oid": "409f4308dc8d88055a4ec20a04005e105595eda0", "url": "https://github.com/eclipse-openj9/openj9/commit/409f4308dc8d88055a4ec20a04005e105595eda0", "message": "Unsafe copySwapMemory: no memory addresses overlap for different objects\n\nFixed memOverlapIsNone to return JNI_TRUE for different objects assuming\nno memory addresses overlap.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>", "committedDate": "2020-09-09T20:13:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMyNzI1Mg==", "url": "https://github.com/eclipse-openj9/openj9/pull/10556#discussion_r486327252", "bodyText": "This is a conservative approach in that it leaves out the case where the objects are the same but the copied regions don't overlap.\nI'm ok with this approach for JDK15 but we might want to dig further into whether it should be made less conservative.", "author": "DanHeidinga", "createdAt": "2020-09-10T13:16:42Z", "path": "runtime/jcl/common/sun_misc_Unsafe.cpp", "diffHunk": "@@ -1129,7 +1129,9 @@ Java_jdk_internal_misc_Unsafe_registerNatives(JNIEnv *env, jclass clazz)\n jboolean\n  memOverlapIsNone(j9object_t sourceObject, UDATA sourceOffset, j9object_t destObject, UDATA destOffset, UDATA actualCopySize) {\n \tjboolean result = JNI_FALSE;\n-\tif ((sourceObject == NULL) && (destObject == NULL)) {\n+\tif (sourceObject != destObject) {\n+\t\tresult = JNI_TRUE;\n+\t} else if ((sourceObject == NULL) && (destObject == NULL)) {", "originalCommit": "409f4308dc8d88055a4ec20a04005e105595eda0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM0MTkwNw==", "url": "https://github.com/eclipse-openj9/openj9/pull/10556#discussion_r486341907", "bodyText": "Created #10560.", "author": "JasonFengJ9", "createdAt": "2020-09-10T13:36:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMyNzI1Mg=="}], "type": "inlineReview"}]}