{"pr_number": 10946, "pr_title": "Fix array size offset for inlined zero sized arrays in x86", "pr_createdAt": "2020-10-20T22:08:42Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/10946", "timeline": [{"oid": "0bfbf984fed9e14f8a1c57a9be9cc22b6ad783b2", "url": "https://github.com/eclipse-openj9/openj9/commit/0bfbf984fed9e14f8a1c57a9be9cc22b6ad783b2", "message": "Fix array size offset for inlined zero sized arrays in x86\n\nFix array size offset for inline allocated zero sized\narrays in x86 systems. The fix adds 2 extra instructions\nto the path of array allocations and 3 instructions in\ncase of zero sized arrays.\n\nTests were conducted and the proposed fix does not\nimpact throughput and performance\n\nFixes: https://github.com/eclipse/openj9/issues/9683\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-10-21T00:44:48Z", "type": "commit"}, {"oid": "0bfbf984fed9e14f8a1c57a9be9cc22b6ad783b2", "url": "https://github.com/eclipse-openj9/openj9/commit/0bfbf984fed9e14f8a1c57a9be9cc22b6ad783b2", "message": "Fix array size offset for inlined zero sized arrays in x86\n\nFix array size offset for inline allocated zero sized\narrays in x86 systems. The fix adds 2 extra instructions\nto the path of array allocations and 3 instructions in\ncase of zero sized arrays.\n\nTests were conducted and the proposed fix does not\nimpact throughput and performance\n\nFixes: https://github.com/eclipse/openj9/issues/9683\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-10-21T00:44:48Z", "type": "forcePushed"}, {"oid": "37753b8fc75ba883c6ce28d1f09e65e499c723c5", "url": "https://github.com/eclipse-openj9/openj9/commit/37753b8fc75ba883c6ce28d1f09e65e499c723c5", "message": "Add confition to initialize zero sized array\n\nZero sized arrays are only initialized if genZeroInitObject2 is\nnot called. In which case an extra store instruction is added to\ngenInitArrayHeader() to initialize the zero sized array header\n\nSigned-off-by: Igor Braga <higorb1@gmail.com>", "committedDate": "2020-10-26T15:04:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjA0MDQ0NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/10946#discussion_r512040444", "bodyText": "Fix tab/spaces", "author": "bragaigor", "createdAt": "2020-10-26T15:15:48Z", "path": "runtime/compiler/x/codegen/J9TreeEvaluator.cpp", "diffHunk": "@@ -7840,6 +7873,7 @@ J9::X86::TreeEvaluator::VMnewEvaluator(\n          if (canUseFastInlineAllocation)\n             {\n             useRepInstruction = genZeroInitObject2(node, objectSize, elementSize, sizeReg, targetReg, tempReg, segmentReg, scratchReg, cg);\n+\t    shouldInitZeroSizedArrayHeader = false;", "originalCommit": "37753b8fc75ba883c6ce28d1f09e65e499c723c5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}