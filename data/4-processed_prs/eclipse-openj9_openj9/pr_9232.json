{"pr_number": 9232, "pr_title": "Set java.base module for anonymous classes loaded at bootup stage", "pr_createdAt": "2020-04-13T22:21:07Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/9232", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNjgxNw==", "url": "https://github.com/eclipse-openj9/openj9/pull/9232#discussion_r408336817", "bodyText": "I'd like to only do this second walk only if anon classes have been created.  We can check:\nif (vm->anonClassCount > 0) {\n   ......\n}\n\nand the locals related to this can be moved into this scope.", "author": "DanHeidinga", "createdAt": "2020-04-14T18:10:26Z", "path": "runtime/j9vm/java11vmi.c", "diffHunk": "@@ -810,6 +812,16 @@ JVM_DefineModule(JNIEnv * env, jobject module, jboolean isOpen, jstring version,\n \t\t\t\t\t\t\t\tclazz = vmFuncs->allClassesNextDo(&classWalkState);\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t\tvmFuncs->allClassesEndDo(&classWalkState);\n+\n+\t\t\t\t\t\t\tAssert_SC_notNull(vm->anonClassLoader);", "originalCommit": "f58a6594350e6f6e01e15947a0598988a21c7e66", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM3MzAwMQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9232#discussion_r408373001", "bodyText": "Added the check.\n@DanHeidinga please have another look.", "author": "JasonFengJ9", "createdAt": "2020-04-14T19:12:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODMzNjgxNw=="}], "type": "inlineReview"}, {"oid": "092753224bdfdd31a8aac70b10d869465248fa46", "url": "https://github.com/eclipse-openj9/openj9/commit/092753224bdfdd31a8aac70b10d869465248fa46", "message": "Set java.base module for anonymous classes loaded at bootup stage\n\nFor those anonymous classes loaded before the module java.base is\ncreated, set java.base module for such classes when java.base is being\ncreated.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>", "committedDate": "2020-04-14T19:07:56Z", "type": "commit"}, {"oid": "092753224bdfdd31a8aac70b10d869465248fa46", "url": "https://github.com/eclipse-openj9/openj9/commit/092753224bdfdd31a8aac70b10d869465248fa46", "message": "Set java.base module for anonymous classes loaded at bootup stage\n\nFor those anonymous classes loaded before the module java.base is\ncreated, set java.base module for such classes when java.base is being\ncreated.\n\nSigned-off-by: Jason Feng <fengj@ca.ibm.com>", "committedDate": "2020-04-14T19:07:56Z", "type": "forcePushed"}]}