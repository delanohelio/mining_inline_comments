{"pr_number": 8498, "pr_title": "Use 25% RAM as default maximum heap size for Java 8", "pr_createdAt": "2020-02-04T19:39:29Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/8498", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg4NTA3OA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r374885078", "bodyText": "I believe would be better to have <= J2SE_V8", "author": "dmitripivkine", "createdAt": "2020-02-04T19:46:31Z", "path": "runtime/gc_base/GCExtensions.cpp", "diffHunk": "@@ -235,6 +236,24 @@ MM_GCExtensions::updateIdentityHashDataForSaltIndex(UDATA index)\n \tgetJavaVM()->identityHashData->hashSaltTable[index] = (U_32)convertValueToHash(getJavaVM(), getJavaVM()->identityHashData->hashSaltTable[index]);\n }\n \n+BOOLEAN\n+MM_GCExtensions::isOriginalJDK8HeapSizeCompatibilityOptionsEanbled(MM_EnvironmentBase* env)\n+{\n+\tJ9JavaVM* vm = (J9JavaVM *)getOmrVM()->_language_vm;\n+\tBOOLEAN enabled = FALSE;\n+\t/* Java 11 or above would ignore VMOPT_XXENABLEORIGINALJDK8HEAPSIZECOMPATIBILITY option */\n+\tif (J2SE_VERSION((J9JavaVM *)getOmrVM()->_language_vm) < J2SE_V11) {", "originalCommit": "4f124948956d1fd99bc3acd2df970f3dbf08f9de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg4NjU4MQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r374886581", "bodyText": "ok, I am taking this back.. Your version is good considering existing code", "author": "dmitripivkine", "createdAt": "2020-02-04T19:49:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg4NTA3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg5MTQ2Mw==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r374891463", "bodyText": "This code can be organized better. There is an example from jvminit.c (you don't need else if case):\n\t{\n\t\tIDATA enablePositiveHashCode = FIND_AND_CONSUME_ARG(EXACT_MATCH, VMOPT_XXENABLEPOSITIVEHASHCODE, NULL);\n\t\tIDATA disablePositiveHashCode = FIND_AND_CONSUME_ARG(EXACT_MATCH, VMOPT_XXDISABLEPOSITIVEHASHCODE, NULL);\n\t\tif (enablePositiveHashCode > disablePositiveHashCode) {\n\t\t\tvm->extendedRuntimeFlags |= J9_EXTENDED_RUNTIME_POSITIVE_HASHCODE;\n\t\t} else if (enablePositiveHashCode < disablePositiveHashCode) {\n\t\t\tvm->extendedRuntimeFlags &= ~(UDATA)J9_EXTENDED_RUNTIME_POSITIVE_HASHCODE;\n\t\t}\n\t}", "author": "dmitripivkine", "createdAt": "2020-02-04T19:59:19Z", "path": "runtime/gc_base/GCExtensions.cpp", "diffHunk": "@@ -235,6 +236,24 @@ MM_GCExtensions::updateIdentityHashDataForSaltIndex(UDATA index)\n \tgetJavaVM()->identityHashData->hashSaltTable[index] = (U_32)convertValueToHash(getJavaVM(), getJavaVM()->identityHashData->hashSaltTable[index]);\n }\n \n+BOOLEAN\n+MM_GCExtensions::isOriginalJDK8HeapSizeCompatibilityOptionsEanbled(MM_EnvironmentBase* env)\n+{\n+\tJ9JavaVM* vm = (J9JavaVM *)getOmrVM()->_language_vm;\n+\tBOOLEAN enabled = FALSE;\n+\t/* Java 11 or above would ignore VMOPT_XXENABLEORIGINALJDK8HEAPSIZECOMPATIBILITY option */\n+\tif (J2SE_VERSION((J9JavaVM *)getOmrVM()->_language_vm) < J2SE_V11) {\n+\t\tIDATA argIndex = FIND_AND_CONSUME_ARG(EXACT_MATCH, VMOPT_XXENABLEORIGINALJDK8HEAPSIZECOMPATIBILITY, NULL);\n+\t\tif (-1 != argIndex) {\n+\t\t\tIDATA argIndex2 = FIND_AND_CONSUME_ARG(EXACT_MATCH, VMOPT_XXDISABLEORIGINALJDK8HEAPSIZECOMPATIBILITY, NULL);\n+\t\t\tif (argIndex > argIndex2) {\n+\t\t\t\tenabled = TRUE;\n+\t\t\t}\n+\t\t}\n+\t}\n+\treturn enabled;", "originalCommit": "4f124948956d1fd99bc3acd2df970f3dbf08f9de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "982f4d37ae0c355dc61e6c4348578d85918d5fd5", "url": "https://github.com/eclipse-openj9/openj9/commit/982f4d37ae0c355dc61e6c4348578d85918d5fd5", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-05T16:48:34Z", "type": "forcePushed"}, {"oid": "a35a8d9bd659e5bc789404bea3aaae6618ac15e4", "url": "https://github.com/eclipse-openj9/openj9/commit/a35a8d9bd659e5bc789404bea3aaae6618ac15e4", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-06T16:12:20Z", "type": "forcePushed"}, {"oid": "8ddf7ccccb6cfcd6f807fda68eae0054161c6a06", "url": "https://github.com/eclipse-openj9/openj9/commit/8ddf7ccccb6cfcd6f807fda68eae0054161c6a06", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-06T16:19:54Z", "type": "forcePushed"}, {"oid": "cff345594d5506026b31e8bc030e1493ca081a67", "url": "https://github.com/eclipse-openj9/openj9/commit/cff345594d5506026b31e8bc030e1493ca081a67", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-06T21:47:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQzMTA5MA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r376431090", "bodyText": "This is pure C function, so all declarations must be done at the beginning of the function. This line does not create problem just because it happen still to be in declaration section. But in general the functionality (described in name) is very local to be defined in declaration section. The solution might be wrap this code to extra {``} to define local section.", "author": "dmitripivkine", "createdAt": "2020-02-07T14:52:32Z", "path": "runtime/gc_modron_startup/mmparse.cpp", "diffHunk": "@@ -1472,6 +1472,19 @@ gcParseCommandLineAndInitializeWithValues(J9JavaVM *vm, IDATA *memoryParameters)\n \t/* Parse the command line \n \t * Order is important for parameters that match as substrings (-Xmrx/-Xmr)\n \t */\n+\tbool eanbleOriginalJDK8HeapSizeCompatibilityOption = false;", "originalCommit": "cff345594d5506026b31e8bc030e1493ca081a67", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ0MjQ5OQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r376442499", "bodyText": "Declaration must be at the beginning of the function but my explanation why might be not entirely correct. This function uses goto and compiler does not allow jump over variable declaration", "author": "dmitripivkine", "createdAt": "2020-02-07T15:13:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQzMTA5MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk1NTIxMA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r378955210", "bodyText": "The C rule that requires declarations at the beginning of the block (not necessarily the function) don't apply to a C++ source file even if the function is not associated with a class.", "author": "keithc-ca", "createdAt": "2020-02-13T16:01:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQzMTA5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQzMTk2Mw==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r376431963", "bodyText": "Should it be >= ?!", "author": "dmitripivkine", "createdAt": "2020-02-07T14:54:04Z", "path": "runtime/gc_modron_startup/mmparse.cpp", "diffHunk": "@@ -1472,6 +1472,19 @@ gcParseCommandLineAndInitializeWithValues(J9JavaVM *vm, IDATA *memoryParameters)\n \t/* Parse the command line \n \t * Order is important for parameters that match as substrings (-Xmrx/-Xmr)\n \t */\n+\tbool eanbleOriginalJDK8HeapSizeCompatibilityOption = false;\n+\t/* only parse VMOPT_XXENABLEORIGINALJDK8HEAPSIZECOMPATIBILITY option for Java 8 and below */\n+\tif (J2SE_V8 <= J2SE_VERSION((J9JavaVM *)getOmrVM()->_language_vm)) {", "originalCommit": "cff345594d5506026b31e8bc030e1493ca081a67", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIwODI1Mw==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r377208253", "bodyText": "updated", "author": "LinHu2016", "createdAt": "2020-02-10T17:29:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQzMTk2Mw=="}], "type": "inlineReview"}, {"oid": "6d29e2e3058923c411fca399c9165e503d7a921a", "url": "https://github.com/eclipse-openj9/openj9/commit/6d29e2e3058923c411fca399c9165e503d7a921a", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-10T16:40:21Z", "type": "forcePushed"}, {"oid": "5276293e3ce6e5ee162d417b0abb28e457b7989a", "url": "https://github.com/eclipse-openj9/openj9/commit/5276293e3ce6e5ee162d417b0abb28e457b7989a", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-11T15:14:15Z", "type": "forcePushed"}, {"oid": "73be9312df829309e6896eb1858e168c563d90fc", "url": "https://github.com/eclipse-openj9/openj9/commit/73be9312df829309e6896eb1858e168c563d90fc", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-12T15:31:36Z", "type": "forcePushed"}, {"oid": "a6de33560b02500f070dc42f1432aa9d6c8c0cc3", "url": "https://github.com/eclipse-openj9/openj9/commit/a6de33560b02500f070dc42f1432aa9d6c8c0cc3", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-12T15:32:46Z", "type": "forcePushed"}, {"oid": "d0e29df896398e0abe82cc14787156c6a741496b", "url": "https://github.com/eclipse-openj9/openj9/commit/d0e29df896398e0abe82cc14787156c6a741496b", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-12T16:21:40Z", "type": "forcePushed"}, {"oid": "a82e24d10c9464afc3a2009832218e415aa245ce", "url": "https://github.com/eclipse-openj9/openj9/commit/a82e24d10c9464afc3a2009832218e415aa245ce", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-13T15:09:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk1Njg3MQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r378956871", "bodyText": "The comment should be indented the same as the code in the block (as it was before).", "author": "keithc-ca", "createdAt": "2020-02-13T16:04:04Z", "path": "runtime/gc_base/GCExtensions.cpp", "diffHunk": "@@ -256,8 +254,8 @@ MM_GCExtensions::computeDefaultMaxHeap(MM_EnvironmentBase *env)\n \t}\n \n #if defined(OMR_ENV_DATA64)\n-\tif (J2SE_VERSION((J9JavaVM *)getOmrVM()->_language_vm) >= J2SE_V11) {\n-\t\t/* extend java default max memory to 25% of usable RAM */\n+\tif (!eanbleOriginalJDK8HeapSizeCompatibilityOption) {\n+\t/* extend java default max memory to 25% of usable RAM */", "originalCommit": "a82e24d10c9464afc3a2009832218e415aa245ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3MjIzMQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r378972231", "bodyText": "@LinHu2016 I launched Linux x86 extended test build. Would you please wait with this comment fix until it complete and results are reviewed?", "author": "dmitripivkine", "createdAt": "2020-02-13T16:27:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk1Njg3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk3NzUyMQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r378977521", "bodyText": "@dmitripivkine Sure", "author": "LinHu2016", "createdAt": "2020-02-13T16:36:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk1Njg3MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTAzNzM5NQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r379037395", "bodyText": "Ok, test build failed because of Jenkins issues... Please submit the fix and we will start testing over", "author": "dmitripivkine", "createdAt": "2020-02-13T18:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODk1Njg3MQ=="}], "type": "inlineReview"}, {"oid": "48e8b1ee22abeae971017a9668287bc2cd190f7b", "url": "https://github.com/eclipse-openj9/openj9/commit/48e8b1ee22abeae971017a9668287bc2cd190f7b", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-13T16:45:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQxMjg0MA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r381412840", "bodyText": "spelling: eanble -> enable", "author": "amicic", "createdAt": "2020-02-19T17:02:42Z", "path": "runtime/gc_base/GCExtensions.cpp", "diffHunk": "@@ -256,7 +254,7 @@ MM_GCExtensions::computeDefaultMaxHeap(MM_EnvironmentBase *env)\n \t}\n \n #if defined(OMR_ENV_DATA64)\n-\tif (J2SE_VERSION((J9JavaVM *)getOmrVM()->_language_vm) >= J2SE_V11) {\n+\tif (!eanbleOriginalJDK8HeapSizeCompatibilityOption) {", "originalCommit": "48e8b1ee22abeae971017a9668287bc2cd190f7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ4ODY0NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r381488644", "bodyText": "done", "author": "LinHu2016", "createdAt": "2020-02-19T19:16:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQxMjg0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQxMzc3MA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r381413770", "bodyText": "wrong spelling of 'enable' at a few spots in this method", "author": "amicic", "createdAt": "2020-02-19T17:04:09Z", "path": "runtime/gc_modron_startup/mmparse.cpp", "diffHunk": "@@ -1472,6 +1472,20 @@ gcParseCommandLineAndInitializeWithValues(J9JavaVM *vm, IDATA *memoryParameters)\n \t/* Parse the command line \n \t * Order is important for parameters that match as substrings (-Xmrx/-Xmr)\n \t */\n+\t{\n+\t\tbool eanbleOriginalJDK8HeapSizeCompatibilityOption = false;\n+\t\t/* only parse VMOPT_XXENABLEORIGINALJDK8HEAPSIZECOMPATIBILITY option for Java 8 and below */\n+\t\tif (J2SE_18 >= J2SE_VERSION(vm)) {\n+\n+\t\t\tIDATA eanbled = FIND_AND_CONSUME_ARG(EXACT_MATCH, VMOPT_XXENABLEORIGINALJDK8HEAPSIZECOMPATIBILITY, NULL);\n+\t\t\tIDATA disabled = FIND_AND_CONSUME_ARG(EXACT_MATCH, VMOPT_XXDISABLEORIGINALJDK8HEAPSIZECOMPATIBILITY, NULL);\n+\t\t\tif (eanbled > disabled) {", "originalCommit": "48e8b1ee22abeae971017a9668287bc2cd190f7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ4ODc1NQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r381488755", "bodyText": "done", "author": "LinHu2016", "createdAt": "2020-02-19T19:16:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQxMzc3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQyOTk2Mw==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r381429963", "bodyText": "I'm fine with removing the call to EnvBase::computeDefaultMaxHeap here. Just commenting for clarification purposes - it will still be called during EnvBase::initialize.", "author": "amicic", "createdAt": "2020-02-19T17:31:05Z", "path": "runtime/gc_base/GCExtensions.cpp", "diffHunk": "@@ -235,11 +235,9 @@ MM_GCExtensions::updateIdentityHashDataForSaltIndex(UDATA index)\n }\n \n void\n-MM_GCExtensions::computeDefaultMaxHeap(MM_EnvironmentBase *env)\n+MM_GCExtensions::computeDefaultMaxHeapForJava(bool eanbleOriginalJDK8HeapSizeCompatibilityOption)\n {\n-\tOMRPORT_ACCESS_FROM_OMRPORT(env->getPortLibrary());\n-\n-\tMM_GCExtensionsBase::computeDefaultMaxHeap(env);\n+\tOMRPORT_ACCESS_FROM_OMRVM(_omrVM);", "originalCommit": "48e8b1ee22abeae971017a9668287bc2cd190f7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQ4ODgyMQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/8498#discussion_r381488821", "bodyText": "done", "author": "LinHu2016", "createdAt": "2020-02-19T19:16:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTQyOTk2Mw=="}], "type": "inlineReview"}, {"oid": "a2eda64cbbdb38b7e7dbe1b868f4312b5e0feffa", "url": "https://github.com/eclipse-openj9/openj9/commit/a2eda64cbbdb38b7e7dbe1b868f4312b5e0feffa", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-19T19:00:17Z", "type": "forcePushed"}, {"oid": "c560cd75ea7ca9c9f2442d2eab7b1afa8a15af1e", "url": "https://github.com/eclipse-openj9/openj9/commit/c560cd75ea7ca9c9f2442d2eab7b1afa8a15af1e", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-19T19:14:01Z", "type": "commit"}, {"oid": "c560cd75ea7ca9c9f2442d2eab7b1afa8a15af1e", "url": "https://github.com/eclipse-openj9/openj9/commit/c560cd75ea7ca9c9f2442d2eab7b1afa8a15af1e", "message": "Use 25% RAM as default maximum heap size for Java 8\n\n\t- new -XX:[+-]OriginalJDK8HeapSizeCompatibilityMode option\n\t- recognize this option in Java 8 only, ignore in Java 11 and higher\n\t- use 512m as default for heap size if\n\t -XX:+OriginalJDK8HeapSizeCompatibilityMode option is\n\t provided explicitly.\n\nSigned-off-by: Lin Hu <linhu@ca.ibm.com>", "committedDate": "2020-02-19T19:14:01Z", "type": "forcePushed"}]}