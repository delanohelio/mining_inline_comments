{"pr_number": 9050, "pr_title": "Change monitor enter return type", "pr_createdAt": "2020-03-31T15:56:47Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/9050", "timeline": [{"oid": "d6d391caffa005b58182e6d304e9ffd22aec05f9", "url": "https://github.com/eclipse-openj9/openj9/commit/d6d391caffa005b58182e6d304e9ffd22aec05f9", "message": "Change monitor enter return type\n\nWhen the previous code returns an IDATA for monitor status. A check is\nperformed to determine if the monitor status is less than the blocking\nenter return code (currently 4). This is broken because a valid object\ncan be a negative value (highly likely on 32bit platforms).\n\nThis PR changes the return type from a IDATA to a UDATA. Also, it fixes\nthe bytecode action order.\n\nSigned-off-by: Tobi Ajila <atobia@ca.ibm.com>", "committedDate": "2020-03-31T15:43:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTAzMDY3NQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9050#discussion_r401030675", "bodyText": "This still doesn't match the interpreter - the VT one is after the debug ones in the interpreter.", "author": "gacholio", "createdAt": "2020-03-31T16:00:29Z", "path": "runtime/vm/BytecodeAction.hpp", "diffHunk": "@@ -47,16 +47,16 @@ typedef enum {\n \tTHROW_AIOB,\n \tTHROW_ARRAY_STORE,\n \tTHROW_DIVIDE_BY_ZERO,\n-#if defined(J9VM_OPT_VALHALLA_VALUE_TYPES)\n-\tTHROW_VALUE_TYPE_ILLEGAL_MONITOR_STATE,\n-#endif /* defined(J9VM_OPT_VALHALLA_VALUE_TYPES) */\n \tTHROW_ILLEGAL_MONITOR_STATE,\n \tTHROW_INCOMPATIBLE_CLASS_CHANGE,\n \tTHROW_WRONG_METHOD_TYPE,\n \tPERFORM_DLT,\n \tRUN_METHOD_INTERPRETED,\n \tRUN_JNI_NATIVE,\n \tRUN_METHOD_COMPILED,\n+#if defined(J9VM_OPT_VALHALLA_VALUE_TYPES)", "originalCommit": "d6d391caffa005b58182e6d304e9ffd22aec05f9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTAzMzk2Mg==", "url": "https://github.com/eclipse-openj9/openj9/pull/9050#discussion_r401033962", "bodyText": "@gacholio Are you referring to this? or something else?", "author": "tajila", "createdAt": "2020-03-31T16:05:21Z", "path": "runtime/vm/BytecodeInterpreter.hpp", "diffHunk": "@@ -9106,8 +9106,8 @@ done:;\n \t\t\tgoto jni; \\\n \t\tcase RUN_METHOD_COMPILED: \\\n \t\t\tgoto i2j; \\\n-\t\tDEBUG_ACTIONS \\\n \t\tPERFORM_ACTION_VALUE_TYPE_IMSE \\", "originalCommit": "d6d391caffa005b58182e6d304e9ffd22aec05f9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTAzNTI5MQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9050#discussion_r401035291", "bodyText": "Sorry, missed the fact that you also changed this.", "author": "gacholio", "createdAt": "2020-03-31T16:07:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTAzMzk2Mg=="}], "type": "inlineReview"}]}