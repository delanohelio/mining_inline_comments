{"pr_number": 9461, "pr_title": "Update JITServer documentation", "pr_createdAt": "2020-05-05T20:04:54Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/9461", "timeline": [{"oid": "bf0be38564d16ed90e0cd2affc6563106b625305", "url": "https://github.com/eclipse-openj9/openj9/commit/bf0be38564d16ed90e0cd2affc6563106b625305", "message": "pushing another commit to refresh the check\n\n[skip ci] meant to refresh the check in #9461\n\nSigned-off-by: Eman Elsabban <eman.elsaban1@gmail.com>", "committedDate": "2020-05-05T21:05:47Z", "type": "forcePushed"}, {"oid": "5e91a4147385eaf339c7a42af5be6c4af6033e22", "url": "https://github.com/eclipse-openj9/openj9/commit/5e91a4147385eaf339c7a42af5be6c4af6033e22", "message": "pushing another commit to refresh the check\n\nMeant to refresh the check in #9461\n[skip ci]\n\nSigned-off-by: Eman Elsabban <eman.elsaban1@gmail.com>", "committedDate": "2020-05-05T21:18:10Z", "type": "forcePushed"}, {"oid": "5c5b0bc35f34fa488a58299269858f03b99928ff", "url": "https://github.com/eclipse-openj9/openj9/commit/5c5b0bc35f34fa488a58299269858f03b99928ff", "message": "Updated the JIT Documentation and deleted Protobuf\n\nI deleted the protobuf steps from Build.md and elaborated more on some\nsteps in Usage.md and Testing.md\n\nIn Testing.md I added a step that is required for the tests to make\ncompile, which is export TEST_JDK_HOME and explained more in step 2 that\nthe JAVA_HOME and JAVA_BIN has to be set before make compile and I gave\nan example of my JAVA_HOME AND JAVA_BIN.In Usage.md, I elaborated more\non where to run the jitserver.\nIssue: #9406\n[skip ci]\n\nSigned-off-by: Eman Elsabban <eman.elsaban1@gmail.com>", "committedDate": "2020-05-12T19:38:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5ODgyNA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r423998824", "bodyText": "Let's remove \"The only difference is you need to check out the JITServer code instead of upstream OpenJ9.\"\nThis probably is a leftover since we had a different branch.", "author": "mpirvu", "createdAt": "2020-05-12T20:01:37Z", "path": "doc/compiler/jitserver/Build.md", "diffHunk": "@@ -128,6 +118,26 @@ bash get_source.sh -openj9-repo=https://github.com/<Your GitHub UserID>/openj9.g\n ```\n See https://www.eclipse.org/openj9/oj9_build.html for more detail. The only difference is you need to check out the JITServer code instead of upstream OpenJ9.", "originalCommit": "5c5b0bc35f34fa488a58299269858f03b99928ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMDI2MA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r424000260", "bodyText": "This is a bit confusing because above you are building a Java8 SDK (git clone https://github.com/ibmruntimes/openj9-openjdk-jdk8.git) but the version in here shows a Java11 build", "author": "mpirvu", "createdAt": "2020-05-12T20:04:19Z", "path": "doc/compiler/jitserver/Build.md", "diffHunk": "@@ -128,6 +118,26 @@ bash get_source.sh -openj9-repo=https://github.com/<Your GitHub UserID>/openj9.g\n ```\n See https://www.eclipse.org/openj9/oj9_build.html for more detail. The only difference is you need to check out the JITServer code instead of upstream OpenJ9.\n \n+You can test it by running the `java -version` command.\n+\n+```\n+cd build/linux-x86_64-normal-server-release/images/jdk\n+```\n+Run:\n+\n+```\n+./bin/java -version\n+```\n+Here is some sample output:\n+\n+```\n+openjdk version \"11.0.8-internal\" 2020-07-14", "originalCommit": "5c5b0bc35f34fa488a58299269858f03b99928ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMTYxNQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r424001615", "bodyText": "Let's change the phrasing slightly so that we don't give the impression that the entire testing is done with java -version. Maybe say\nYou can test the success of the build process with \"java -version\" command like so:...", "author": "mpirvu", "createdAt": "2020-05-12T20:06:48Z", "path": "doc/compiler/jitserver/Build.md", "diffHunk": "@@ -128,6 +118,26 @@ bash get_source.sh -openj9-repo=https://github.com/<Your GitHub UserID>/openj9.g\n ```\n See https://www.eclipse.org/openj9/oj9_build.html for more detail. The only difference is you need to check out the JITServer code instead of upstream OpenJ9.\n \n+You can test it by running the `java -version` command.", "originalCommit": "5c5b0bc35f34fa488a58299269858f03b99928ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMjYxNw==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r424002617", "bodyText": "Actually since this is about JITServer I would use \"./bin/jitserver\" and \"./bin/java -XX:+UseJITServer -version\"", "author": "mpirvu", "createdAt": "2020-05-12T20:08:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMTYxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwMzg3OA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r424003878", "bodyText": "Rephrase: \"An example of how to install the prerequisites can be found ....\"", "author": "mpirvu", "createdAt": "2020-05-12T20:10:38Z", "path": "doc/compiler/jitserver/Testing.md", "diffHunk": "@@ -33,12 +33,13 @@ These are the steps to run the tests on your machine.\n \n 2. Install [prerequisites](https://github.com/eclipse/openj9/blob/master/test/docs/Prerequisites.md)\n \n-   Example installation can be found [here](https://github.com/eclipse/openj9/blob/master/buildenv/docker/test/Dockerfile#L57-L68).\n+   Example installation can be found [here](https://github.com/eclipse/openj9/blob/master/buildenv/docker/test/Dockerfile#L57-L68). Make sure that JAVA_HOME and JAVA_BIN are set(EX. `export JAVA_HOME=/root/openj9-openjdk-jdk11/build/linux-x86_64-normal-server-release/images/jdk` and `export JAVA_BIN=/root/openj9-openjdk-jdk11/build/linux-x86_64-normal-server-release/images/jdk/bin`). Basically you want to test on the jdk you build, so point the environment variable to your personal build of jdk.", "originalCommit": "5c5b0bc35f34fa488a58299269858f03b99928ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwNTA3NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r424005074", "bodyText": "I believe that JAVA_VERSION is inferred and therefore does not need to be specified.\nOtherwise, you may want to change this to Java11 because your example above shows a Java11 path.", "author": "mpirvu", "createdAt": "2020-05-12T20:13:02Z", "path": "doc/compiler/jitserver/Testing.md", "diffHunk": "@@ -33,12 +33,13 @@ These are the steps to run the tests on your machine.\n \n 2. Install [prerequisites](https://github.com/eclipse/openj9/blob/master/test/docs/Prerequisites.md)\n \n-   Example installation can be found [here](https://github.com/eclipse/openj9/blob/master/buildenv/docker/test/Dockerfile#L57-L68).\n+   Example installation can be found [here](https://github.com/eclipse/openj9/blob/master/buildenv/docker/test/Dockerfile#L57-L68). Make sure that JAVA_HOME and JAVA_BIN are set(EX. `export JAVA_HOME=/root/openj9-openjdk-jdk11/build/linux-x86_64-normal-server-release/images/jdk` and `export JAVA_BIN=/root/openj9-openjdk-jdk11/build/linux-x86_64-normal-server-release/images/jdk/bin`). Basically you want to test on the jdk you build, so point the environment variable to your personal build of jdk.\n 3. Compile  the tests (only need to compile once):\n    ```\n    cd $OPENJ9_DIR/openj9/test\n    git clone https://github.com/AdoptOpenJDK/TKG.git\n    cd TKG\n+   export TEST_JDK_HOME=<path to JDK directory that you wish to test, it's the same as $JAVA_HOME>\n    export JAVA_VERSION=SE80", "originalCommit": "5c5b0bc35f34fa488a58299269858f03b99928ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwNjcwOQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r424006709", "bodyText": "Are these instructions still current? I am using a slightly different approach.", "author": "mpirvu", "createdAt": "2020-05-12T20:16:00Z", "path": "doc/compiler/jitserver/Testing.md", "diffHunk": "@@ -33,12 +33,13 @@ These are the steps to run the tests on your machine.\n \n 2. Install [prerequisites](https://github.com/eclipse/openj9/blob/master/test/docs/Prerequisites.md)\n \n-   Example installation can be found [here](https://github.com/eclipse/openj9/blob/master/buildenv/docker/test/Dockerfile#L57-L68).\n+   Example installation can be found [here](https://github.com/eclipse/openj9/blob/master/buildenv/docker/test/Dockerfile#L57-L68). Make sure that JAVA_HOME and JAVA_BIN are set(EX. `export JAVA_HOME=/root/openj9-openjdk-jdk11/build/linux-x86_64-normal-server-release/images/jdk` and `export JAVA_BIN=/root/openj9-openjdk-jdk11/build/linux-x86_64-normal-server-release/images/jdk/bin`). Basically you want to test on the jdk you build, so point the environment variable to your personal build of jdk.\n 3. Compile  the tests (only need to compile once):\n    ```\n    cd $OPENJ9_DIR/openj9/test\n    git clone https://github.com/AdoptOpenJDK/TKG.git", "originalCommit": "5c5b0bc35f34fa488a58299269858f03b99928ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY2MDU3OA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r424660578", "bodyText": "Yes, I followed these instructions for testing", "author": "EmanElsaban", "createdAt": "2020-05-13T18:53:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwNjcwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAwODc5NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/9461#discussion_r424008794", "bodyText": "I would prefer to eliminate: (The bindirectory exists inbuild/linux-x86_64-normal-server-release/images/jdk/binrun./jitserverthere to launch the JVM).\nbecause it refers to a directory structure created for build. We should be more generic on how to launch the jitserver", "author": "mpirvu", "createdAt": "2020-05-12T20:19:44Z", "path": "doc/compiler/jitserver/Usage.md", "diffHunk": "@@ -20,7 +20,7 @@ OpenJDK Assembly Exception [2].\n SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n -->\n \n-JITServer adds two additional *personas* to the JVM: client mode and server mode. To start the JVM in server mode, run the `jitserver` launcher present under `bin` directory (along side `java` launcher). To start the JVM in client mode, there is a new command line option: `-XX:+UseJITServer`\n+JITServer adds two additional *personas* to the JVM: client mode and server mode. To start the JVM in server mode, run the `jitserver` launcher present under `bin` directory (along side `java` launcher)(The `bin` directory exists in `build/linux-x86_64-normal-server-release/images/jdk/bin` run `./jitserver` there to launch the JVM). To start the JVM in client mode, there is a new command line option: `-XX:+UseJITServer` (under bin run `./java -XX:+UseJITServer <application name>`)", "originalCommit": "5c5b0bc35f34fa488a58299269858f03b99928ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dfc5dc0c00452cbb294fd66b71246b5f8467851d", "url": "https://github.com/eclipse-openj9/openj9/commit/dfc5dc0c00452cbb294fd66b71246b5f8467851d", "message": "Addressed the comments on the JIT Doc Update\n\nUpdated the Build.md, Usage.md and Testing.md to reflect Marius\ncomments in the JIT Documentation. Protobuf was deleted.\n\nIssue: #9406\n[skip ci]\n\nSigned-off-by: Eman Elsabban <eman.elsaban1@gmail.com>", "committedDate": "2020-05-13T20:52:39Z", "type": "commit"}, {"oid": "dfc5dc0c00452cbb294fd66b71246b5f8467851d", "url": "https://github.com/eclipse-openj9/openj9/commit/dfc5dc0c00452cbb294fd66b71246b5f8467851d", "message": "Addressed the comments on the JIT Doc Update\n\nUpdated the Build.md, Usage.md and Testing.md to reflect Marius\ncomments in the JIT Documentation. Protobuf was deleted.\n\nIssue: #9406\n[skip ci]\n\nSigned-off-by: Eman Elsabban <eman.elsaban1@gmail.com>", "committedDate": "2020-05-13T20:52:39Z", "type": "forcePushed"}]}