{"pr_number": 11169, "pr_title": "Centralize opcode enum", "pr_createdAt": "2020-11-12T20:04:35Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/11169", "timeline": [{"oid": "3ef877cc5377f0454fc1f9e3af1c90c0ec9029c1", "url": "https://github.com/eclipse-openj9/openj9/commit/3ef877cc5377f0454fc1f9e3af1c90c0ec9029c1", "message": "Centralize the opcode enum into Opcodes.enum\n\nTransmutes the ILOpCodeProperties.hpp file into Opcodes.enum which holds\nthe exact same information presented in a macro format. The new\n`OPCODE_MACRO` has just one additional field which is a commented out\ndescription which was pulled from J9ILOpCodesEnum.hpp.\n\nThis new Opcodes.enum file is the concrete enum file which gets included\ninto various places that generate tables based on opcodes. It will\nautomatically get pulled into OMR when building up the various tables\nsuch that no extra boilerplate needs to be done within OpenJ9.\n\nThis will avoid future build breaks whenever we need to modify the\nopcode tables between the two projects (OpenJ9 and OMR).\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T17:13:49Z", "type": "commit"}, {"oid": "fba26362ab318def894963b90a2eadca120993f9", "url": "https://github.com/eclipse-openj9/openj9/commit/fba26362ab318def894963b90a2eadca120993f9", "message": "Extend the simplifier tables in OpenJ9 using the centralized opcode enum\n\nFollow the same pattern as within OMR and extend the simplifier table\nusing the now centralized auto-generated tables.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T17:18:08Z", "type": "commit"}, {"oid": "da874c30ca3de391bbcd1a6cea6db86bf84e0bd8", "url": "https://github.com/eclipse-openj9/openj9/commit/da874c30ca3de391bbcd1a6cea6db86bf84e0bd8", "message": "Centralize the AMD64 TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T17:19:34Z", "type": "commit"}, {"oid": "d54a50e0417e51d807f2e68d48b4c67db7ceb024", "url": "https://github.com/eclipse-openj9/openj9/commit/d54a50e0417e51d807f2e68d48b4c67db7ceb024", "message": "Centralize the AArch64 TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T19:43:04Z", "type": "commit"}, {"oid": "025b36121335216d05b29933c90f58cc7901dae0", "url": "https://github.com/eclipse-openj9/openj9/commit/025b36121335216d05b29933c90f58cc7901dae0", "message": "Centralize the ARM TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T19:43:30Z", "type": "commit"}, {"oid": "7979f20efeaa6cc64cd4f482b7fa7c5d570e3e61", "url": "https://github.com/eclipse-openj9/openj9/commit/7979f20efeaa6cc64cd4f482b7fa7c5d570e3e61", "message": "Centralize the Power TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T19:43:51Z", "type": "commit"}, {"oid": "ef64719db5dafafd2dc447906f70c77120a685cf", "url": "https://github.com/eclipse-openj9/openj9/commit/ef64719db5dafafd2dc447906f70c77120a685cf", "message": "Centralize the Z TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T19:44:05Z", "type": "commit"}, {"oid": "9b5819b29cbe47761b55c6d20243e02450240c19", "url": "https://github.com/eclipse-openj9/openj9/commit/9b5819b29cbe47761b55c6d20243e02450240c19", "message": "Centralize the Intel TreeEvaluator table\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T19:44:26Z", "type": "commit"}, {"oid": "d53776b39faa0a176adcd424149d3ab0cfe18fb7", "url": "https://github.com/eclipse-openj9/openj9/commit/d53776b39faa0a176adcd424149d3ab0cfe18fb7", "message": "Deprecate nvvmOpCodeNames in favor of a switch\n\nThe `nvvmOpCodeNames` in CodeGenGPU.cpp is not generated via the new\nOpcodes.enum `OPCODE_MACRO`. There does not exist a nice mapping\nbetween the OMR opcodes and the LLVM equivalents. As such this table\nwill always need to be manually maintained whenever we modify the opcode\ntables either in OMR or OpenJ9.\n\nThis table can however be easily translated into a switch statement\nsince it is so sparse. We carry out this translation within this commit\nto eliminate the need to maintain this table in the future.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T20:06:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM5MjA4Mw==", "url": "https://github.com/eclipse-openj9/openj9/pull/11169#discussion_r522392083", "bodyText": "Whoooooops. This is a mistake. Going to take this out now.", "author": "fjeremic", "createdAt": "2020-11-12T20:12:48Z", "path": "runtime/cmake/platform/toolcfg/gnu.cmake", "diffHunk": "@@ -20,7 +20,7 @@\n # SPDX-License-Identifier: EPL-2.0 OR Apache-2.0 OR GPL-2.0 WITH Classpath-exception-2.0 OR LicenseRef-GPL-2.0 WITH Assembly-exception\n ################################################################################\n \n-list(APPEND OMR_PLATFORM_COMPILE_OPTIONS -O3 -g -fstack-protector)\n+list(APPEND OMR_PLATFORM_COMPILE_OPTIONS -O0 -g -fstack-protector)", "originalCommit": "d53776b39faa0a176adcd424149d3ab0cfe18fb7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "85a509ca734a731a62ea2896c9149444ed554497", "url": "https://github.com/eclipse-openj9/openj9/commit/85a509ca734a731a62ea2896c9149444ed554497", "message": "Deprecate nvvmOpCodeNames in favor of a switch\n\nThe `nvvmOpCodeNames` in CodeGenGPU.cpp is not generated via the new\nOpcodes.enum `OPCODE_MACRO`. There does not exist a nice mapping\nbetween the OMR opcodes and the LLVM equivalents. As such this table\nwill always need to be manually maintained whenever we modify the opcode\ntables either in OMR or OpenJ9.\n\nThis table can however be easily translated into a switch statement\nsince it is so sparse. We carry out this translation within this commit\nto eliminate the need to maintain this table in the future.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T20:14:20Z", "type": "commit"}, {"oid": "85a509ca734a731a62ea2896c9149444ed554497", "url": "https://github.com/eclipse-openj9/openj9/commit/85a509ca734a731a62ea2896c9149444ed554497", "message": "Deprecate nvvmOpCodeNames in favor of a switch\n\nThe `nvvmOpCodeNames` in CodeGenGPU.cpp is not generated via the new\nOpcodes.enum `OPCODE_MACRO`. There does not exist a nice mapping\nbetween the OMR opcodes and the LLVM equivalents. As such this table\nwill always need to be manually maintained whenever we modify the opcode\ntables either in OMR or OpenJ9.\n\nThis table can however be easily translated into a switch statement\nsince it is so sparse. We carry out this translation within this commit\nto eliminate the need to maintain this table in the future.\n\nSigned-off-by: Filip Jeremic <fjeremic@ca.ibm.com>", "committedDate": "2020-11-12T20:14:20Z", "type": "forcePushed"}]}