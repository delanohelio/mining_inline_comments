{"pr_number": 11200, "pr_title": "CMake: Specify exclude directories for DDR", "pr_createdAt": "2020-11-16T19:09:57Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/11200", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTI3MQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r524651271", "bodyText": "nit: Please end sentences with a period.", "author": "keithc-ca", "createdAt": "2020-11-16T22:03:13Z", "path": "runtime/CMakeLists.txt", "diffHunk": "@@ -352,6 +352,19 @@ if(OMR_DDR)\n \t\t${CMAKE_CURRENT_BINARY_DIR}/omr/gc\n \t\t${CMAKE_CURRENT_BINARY_DIR}/omr\n \t)\n+\n+\t# Specify the directories which shouldn't be searched for debug info.\n+\t# Currently this is only used on zos, and has no effect elsewhere", "originalCommit": "ac8c4597549d8f69f2a57e95d07099d72aae00aa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTc2NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r524651764", "bodyText": "Why the trailing slashes?", "author": "keithc-ca", "createdAt": "2020-11-16T22:03:33Z", "path": "runtime/CMakeLists.txt", "diffHunk": "@@ -352,6 +352,19 @@ if(OMR_DDR)\n \t\t${CMAKE_CURRENT_BINARY_DIR}/omr/gc\n \t\t${CMAKE_CURRENT_BINARY_DIR}/omr\n \t)\n+\n+\t# Specify the directories which shouldn't be searched for debug info.\n+\t# Currently this is only used on zos, and has no effect elsewhere\n+\tset_property(TARGET j9ddr PROPERTY DDR_OBJECT_EXCLUDES\n+\t\tbcutil/test/\n+\t\tcompiler/\n+\t\tgc_tests/\n+\t\tjilgen/\n+\t\tomr/\n+\t\truntimetools/\n+\t\ttests/", "originalCommit": "ac8c4597549d8f69f2a57e95d07099d72aae00aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1OTc1Ng==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r524659756", "bodyText": "Also this list is not the same as in run_omrddrgen.mk.ftl. This appears to exclude more: compiler and all of omr.", "author": "keithc-ca", "createdAt": "2020-11-16T22:09:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTc2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDg1MjIxMA==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r524852210", "bodyText": "Isn't that already explained in the description?", "author": "pshipton", "createdAt": "2020-11-17T02:54:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTc2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTE1OTMyOQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r525159329", "bodyText": "You're right, I missed the explanation of the differences.", "author": "keithc-ca", "createdAt": "2020-11-17T13:39:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTc2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTM3MjAxNQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r525372015", "bodyText": "Actually, I don't think the omr portion is handled properly: eclipse/omr#5479 sets DDR_OBJECT_EXCLUDES for omrddr, not for j9ddr.", "author": "keithc-ca", "createdAt": "2020-11-17T17:59:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTc2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTUwNDkxOA==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r525504918", "bodyText": "Trailing slashes are there because DDR_OBJECT_EXCLUDES is treated as a list of string prefixes rather than a list of directories", "author": "dnakamura", "createdAt": "2020-11-17T20:32:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTc2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODkyNTk2Nw==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r598925967", "bodyText": "Actually, I don't think the omr portion is handled properly: eclipse/omr#5479 sets DDR_OBJECT_EXCLUDES for omrddr, not for j9ddr.\n\nThat is intentional. Since j9ddr includes omrddr, it will inherit any objects included in it.", "author": "dnakamura", "createdAt": "2021-03-22T17:23:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTc2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODkzNzMzOA==", "url": "https://github.com/eclipse-openj9/openj9/pull/11200#discussion_r598937338", "bodyText": "This deserves some comments so future readers will understand that those exclusions are retroactive (omr has already been included) or derived later.", "author": "keithc-ca", "createdAt": "2021-03-22T17:37:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDY1MTc2NA=="}], "type": "inlineReview"}, {"oid": "6d1796cbdaefe838229b88f2dfa122b8ce7c091f", "url": "https://github.com/eclipse-openj9/openj9/commit/6d1796cbdaefe838229b88f2dfa122b8ce7c091f", "message": "CMake: Specify exclude directories for DDR\n\nSpecify direcotries which are excluded when searching for debug info.\nThis is the same as DDR_EXCLUDED_FOLDERS from ddr/run_omrddrgen.mk.ftl\n\nThere are some minor differences due to differences between the uma and\ncmake builds.\n\n- all of omr/ is excluded as in CMake, omr is responsible for searching\n  for its own object files\n- compiler/ is excluded as CMake builds generate debug info when building\n  the compiler, where as uma builds do not.\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>", "committedDate": "2021-03-22T17:19:56Z", "type": "forcePushed"}, {"oid": "f15f5b2dfc1bf60778bd540ed465662bc748aadf", "url": "https://github.com/eclipse-openj9/openj9/commit/f15f5b2dfc1bf60778bd540ed465662bc748aadf", "message": "CMake: Specify exclude directories for DDR\n\nSpecify direcotries which are excluded when searching for debug info.\nThis is the same as DDR_EXCLUDED_FOLDERS from ddr/run_omrddrgen.mk.ftl\n\nThere are some minor differences due to differences between the uma and\ncmake builds.\n\n- all of omr/ is excluded as in CMake, omr is responsible for searching\n  for its own object files\n- compiler/ is excluded as CMake builds generate debug info when building\n  the compiler, where as uma builds do not.\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>", "committedDate": "2021-04-26T16:53:15Z", "type": "commit"}, {"oid": "f15f5b2dfc1bf60778bd540ed465662bc748aadf", "url": "https://github.com/eclipse-openj9/openj9/commit/f15f5b2dfc1bf60778bd540ed465662bc748aadf", "message": "CMake: Specify exclude directories for DDR\n\nSpecify direcotries which are excluded when searching for debug info.\nThis is the same as DDR_EXCLUDED_FOLDERS from ddr/run_omrddrgen.mk.ftl\n\nThere are some minor differences due to differences between the uma and\ncmake builds.\n\n- all of omr/ is excluded as in CMake, omr is responsible for searching\n  for its own object files\n- compiler/ is excluded as CMake builds generate debug info when building\n  the compiler, where as uma builds do not.\n\nSigned-off-by: Devin Nakamura <devinn@ca.ibm.com>", "committedDate": "2021-04-26T16:53:15Z", "type": "forcePushed"}]}