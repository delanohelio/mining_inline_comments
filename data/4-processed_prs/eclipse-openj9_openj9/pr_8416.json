{"pr_number": 8416, "pr_title": "AArch64: Add code for compressed refs - evaluateNULLCHKWithPossibleResolve", "pr_createdAt": "2020-01-27T09:21:08Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/8416", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjE5MzAxNA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8416#discussion_r372193014", "bodyText": "This variable n is used only in the following if (comp->useCompressedPointers() && ... ) { ... } block.\nCan you move the variable into the block?", "author": "knn-k", "createdAt": "2020-01-29T05:21:58Z", "path": "runtime/compiler/aarch64/codegen/J9TreeEvaluator.cpp", "diffHunk": "@@ -971,11 +970,28 @@ J9::ARM64::TreeEvaluator::evaluateNULLCHKWithPossibleResolve(TR::Node *node, boo\n    TR::Snippet *snippet = new (cg->trHeapMemory()) TR::ARM64HelperCallSnippet(cg, node, snippetLabel, node->getSymbolReference(), NULL);\n    cg->addSnippet(snippet);\n    TR::Register *referenceReg = cg->evaluate(reference);\n-   TR::InstOpCode::Mnemonic compareOp = useCompressedPointers ? TR::InstOpCode::cbzw : TR::InstOpCode::cbzx;\n-   TR::Instruction *cbzInstruction = generateCompareBranchInstruction(cg, compareOp, node, referenceReg, snippetLabel, NULL);\n+   TR::Instruction *cbzInstruction = generateCompareBranchInstruction(cg, TR::InstOpCode::cbzx, node, referenceReg, snippetLabel, NULL);\n    cbzInstruction->setNeedsGCMap(0xffffffff);\n    snippet->gcMap().setGCRegisterMask(0xffffffff);\n \n+   TR::Node *n = NULL;", "originalCommit": "69a14258c3559f8af2eb75881311324a5c4731ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjE5NjU1OA==", "url": "https://github.com/eclipse-openj9/openj9/pull/8416#discussion_r372196558", "bodyText": "Moved the declaration of n inside the block.", "author": "Akira1Saitoh", "createdAt": "2020-01-29T05:33:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjE5MzAxNA=="}], "type": "inlineReview"}, {"oid": "c1e3533f6d12fc3e2d760ac29109b554b11f34d4", "url": "https://github.com/eclipse-openj9/openj9/commit/c1e3533f6d12fc3e2d760ac29109b554b11f34d4", "message": "AArch64: Add code for compressed refs - evaluateNULLCHKWithPossibleResolve\n\nThis commit adds code to `evaluateNULLCHKWithPossibleResolve` to support\ncompressed references for aarch64.\n\nSigned-off-by: Akira Saitoh <saiaki@jp.ibm.com>", "committedDate": "2020-01-29T05:32:57Z", "type": "commit"}, {"oid": "c1e3533f6d12fc3e2d760ac29109b554b11f34d4", "url": "https://github.com/eclipse-openj9/openj9/commit/c1e3533f6d12fc3e2d760ac29109b554b11f34d4", "message": "AArch64: Add code for compressed refs - evaluateNULLCHKWithPossibleResolve\n\nThis commit adds code to `evaluateNULLCHKWithPossibleResolve` to support\ncompressed references for aarch64.\n\nSigned-off-by: Akira Saitoh <saiaki@jp.ibm.com>", "committedDate": "2020-01-29T05:32:57Z", "type": "forcePushed"}]}