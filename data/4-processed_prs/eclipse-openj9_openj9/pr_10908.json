{"pr_number": 10908, "pr_title": "Array JIT Helper NULL check fix", "pr_createdAt": "2020-10-16T16:16:48Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/10908", "timeline": [{"oid": "df55ea63b64ac59b1a8ca37832cc2ea1168beb34", "url": "https://github.com/eclipse-openj9/openj9/commit/df55ea63b64ac59b1a8ca37832cc2ea1168beb34", "message": "Array JIT Helper NULL check fix\n\nReplaced existing NULL check with one that first checks if the\nvalue is a Valuetype then perform a NULL check. This is because\nyou can not write NULL to value types.\n\nSigned-off-by: Oussama Saoudi <oussama.saoudi@ibm.com>", "committedDate": "2020-10-16T20:52:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg0ODQ4NQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/10908#discussion_r507848485", "bodyText": "my mistake, this was fine he way it was before. Slow path is only a failure path since storing the element cannot fail", "author": "tajila", "createdAt": "2020-10-19T15:32:23Z", "path": "runtime/codert_vm/cnathelp.cpp", "diffHunk": "@@ -970,7 +970,7 @@ old_slow_jitStoreFlattenableArrayElement(J9VMThread *currentThread)\n \t\t} else {\n \t\t\tif (false == VM_VMHelpers::objectArrayStoreAllowed(currentThread, arrayref, value)) {\n \t\t\t\taddr = setCurrentExceptionFromJIT(currentThread, J9VMCONSTANTPOOL_JAVALANGARRAYSTOREEXCEPTION, NULL);\n-\t\t\t} else {\n+\t\t\t} else if ((J9_IS_J9CLASS_VALUETYPE(value)) && (NULL == value)) {", "originalCommit": "df55ea63b64ac59b1a8ca37832cc2ea1168beb34", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c0359f3708d35c8712d7a9d9032ffe31a833dc3d", "url": "https://github.com/eclipse-openj9/openj9/commit/c0359f3708d35c8712d7a9d9032ffe31a833dc3d", "message": "Array JIT Helper NULL check fix\n\nReplaced existing NULL check with one that first checks if the\nvalue is a Valuetype then perform a NULL check. This is because\nyou can not write NULL to value types.\n\nSigned-off-by: Oussama Saoudi <oussama.saoudi@ibm.com>", "committedDate": "2020-10-19T18:49:12Z", "type": "forcePushed"}, {"oid": "ef95b7ae15ed93030731cc1b98d0e76af2ef499e", "url": "https://github.com/eclipse-openj9/openj9/commit/ef95b7ae15ed93030731cc1b98d0e76af2ef499e", "message": "Array JIT Helper NULL check fix\n\nReplaced existing NULL check with one that first checks if the\nvalue is a Valuetype then perform a NULL check. This is because\nyou can not write NULL to value types.\n\nSigned-off-by: Oussama Saoudi <oussama.saoudi@ibm.com>", "committedDate": "2020-10-20T14:33:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODU4MTUzOQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/10908#discussion_r508581539", "bodyText": "you can use J9_IS_J9CLASS_VALUETYPE(arrayrefClass->componentType)", "author": "tajila", "createdAt": "2020-10-20T14:56:21Z", "path": "runtime/codert_vm/cnathelp.cpp", "diffHunk": "@@ -989,6 +989,7 @@ old_fast_jitStoreFlattenableArrayElement(J9VMThread *currentThread)\n \tDECLARE_JIT_PARM(U_32, index, 3);\n \tbool slowPathUsed = false;\n \tvoid *slowPath = NULL;\n+\tJ9Class *clazz = J9OBJECT_CLAZZ(currentThread, (J9Object *) value);", "originalCommit": "ef95b7ae15ed93030731cc1b98d0e76af2ef499e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6c31d5314f59c057da5e7c6163cea325912f1f7a", "url": "https://github.com/eclipse-openj9/openj9/commit/6c31d5314f59c057da5e7c6163cea325912f1f7a", "message": "Array JIT Helper NULL check fix\n\nReplaced existing NULL check with one that first checks if the\nvalue is a Valuetype then perform a NULL check. This is because\nyou can not write NULL to value types.\n\nSigned-off-by: Oussama Saoudi <oussama.saoudi@ibm.com>", "committedDate": "2020-10-20T17:58:11Z", "type": "commit"}, {"oid": "6c31d5314f59c057da5e7c6163cea325912f1f7a", "url": "https://github.com/eclipse-openj9/openj9/commit/6c31d5314f59c057da5e7c6163cea325912f1f7a", "message": "Array JIT Helper NULL check fix\n\nReplaced existing NULL check with one that first checks if the\nvalue is a Valuetype then perform a NULL check. This is because\nyou can not write NULL to value types.\n\nSigned-off-by: Oussama Saoudi <oussama.saoudi@ibm.com>", "committedDate": "2020-10-20T17:58:11Z", "type": "forcePushed"}]}