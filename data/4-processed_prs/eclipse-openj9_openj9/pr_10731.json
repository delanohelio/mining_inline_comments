{"pr_number": 10731, "pr_title": "Unify LinkageInfo word initialization", "pr_createdAt": "2020-09-28T21:21:29Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/10731", "timeline": [{"oid": "e95248e9de603eaea7f49a6fc46a68dd1502330b", "url": "https://github.com/eclipse-openj9/openj9/commit/e95248e9de603eaea7f49a6fc46a68dd1502330b", "message": "Add Getters/Setters to LinkageInfo\n\nSigned-off-by: Irwin D'Souza <dsouzai.gh@gmail.com>", "committedDate": "2020-09-28T20:28:22Z", "type": "commit"}, {"oid": "fadf8ce5107c66fa89ee55d9ae80ec650cd0dd15", "url": "https://github.com/eclipse-openj9/openj9/commit/fadf8ce5107c66fa89ee55d9ae80ec650cd0dd15", "message": "Unify LinkageInfo word initialization\n\nSigned-off-by: Irwin D'Souza <dsouzai.gh@gmail.com>", "committedDate": "2020-09-28T21:25:02Z", "type": "forcePushed"}, {"oid": "bc1780ad3aabeb1289a9c0a2ce5dcc438c5e956d", "url": "https://github.com/eclipse-openj9/openj9/commit/bc1780ad3aabeb1289a9c0a2ce5dcc438c5e956d", "message": "Unify LinkageInfo word initialization\n\nSigned-off-by: Irwin D'Souza <dsouzai.gh@gmail.com>", "committedDate": "2020-09-29T13:54:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MTQzMg==", "url": "https://github.com/eclipse-openj9/openj9/pull/10731#discussion_r499741432", "bodyText": "I don't think this is correct.  initializeLinkageInfo is in the CodeGenerator class, not Linkage.", "author": "0xdaryl", "createdAt": "2020-10-05T16:57:04Z", "path": "runtime/compiler/aarch64/codegen/ARM64PrivateLinkage.cpp", "diffHunk": "@@ -1540,27 +1540,8 @@ void J9::ARM64::PrivateLinkage::performPostBinaryEncoding()\n                    \"Expecting the return type info instruction to be created\");\n \n    TR::ARM64ImmInstruction *linkageInfoWordInstruction = cg()->getReturnTypeInfoInstruction();\n-   uint32_t linkageInfoWord = linkageInfoWordInstruction->getSourceImmediate();\n-\n-   intptr_t jittedMethodEntryAddress = reinterpret_cast<intptr_t>(getJittedMethodEntryPoint()->getBinaryEncoding());\n-   intptr_t interpretedMethodEntryAddress = reinterpret_cast<intptr_t>(getInterpretedMethodEntryPoint()->getBinaryEncoding());\n-\n-   linkageInfoWord = (static_cast<uint32_t>(jittedMethodEntryAddress - interpretedMethodEntryAddress) << 16) | linkageInfoWord;\n+   uint32_t linkageInfoWord = self()->initializeLinkageInfo(linkageInfoWordInstruction->getBinaryEncoding());", "originalCommit": "bc1780ad3aabeb1289a9c0a2ce5dcc438c5e956d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0NDU4Mg==", "url": "https://github.com/eclipse-openj9/openj9/pull/10731#discussion_r499744582", "bodyText": "Ah you're right; I didn't realize this was the private linkage class. Good catch.", "author": "dsouzai", "createdAt": "2020-10-05T17:02:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MTQzMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc0MjE5MQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/10731#discussion_r499742191", "bodyText": "sp:  Initializes", "author": "0xdaryl", "createdAt": "2020-10-05T16:58:24Z", "path": "runtime/compiler/codegen/J9CodeGenerator.hpp", "diffHunk": "@@ -577,6 +577,15 @@ void addMonClass(TR::Node* monNode, TR_OpaqueClassBlock* clazz);\n     */\n    bool supportsStackAllocations() { return false; }\n \n+   /**\n+    * \\brief Intializes the Linkage Info word found before the interpreter entry point.", "originalCommit": "bc1780ad3aabeb1289a9c0a2ce5dcc438c5e956d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4687e119b6825b7ff520ed92325f9fedcd60a204", "url": "https://github.com/eclipse-openj9/openj9/commit/4687e119b6825b7ff520ed92325f9fedcd60a204", "message": "Unify LinkageInfo word initialization\n\nSigned-off-by: Irwin D'Souza <dsouzai.gh@gmail.com>", "committedDate": "2020-10-05T17:05:22Z", "type": "forcePushed"}, {"oid": "390f354413d0ceb6d51d58116a7ec5075abf4011", "url": "https://github.com/eclipse-openj9/openj9/commit/390f354413d0ceb6d51d58116a7ec5075abf4011", "message": "Unify LinkageInfo word initialization\n\nSigned-off-by: Irwin D'Souza <dsouzai.gh@gmail.com>", "committedDate": "2020-10-05T17:07:36Z", "type": "commit"}, {"oid": "390f354413d0ceb6d51d58116a7ec5075abf4011", "url": "https://github.com/eclipse-openj9/openj9/commit/390f354413d0ceb6d51d58116a7ec5075abf4011", "message": "Unify LinkageInfo word initialization\n\nSigned-off-by: Irwin D'Souza <dsouzai.gh@gmail.com>", "committedDate": "2020-10-05T17:07:36Z", "type": "forcePushed"}]}