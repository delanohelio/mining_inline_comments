{"pr_number": 11482, "pr_title": "Add add-exports to JEP358NPEMessageTests", "pr_createdAt": "2020-12-15T15:06:12Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/11482", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUyMDY1MQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/11482#discussion_r543520651", "bodyText": "Can we keep the references to jdk internal ASM to avoid updating external asm.jar file later?\nA workaround for IllegalAccessError could be something like --add-exports java.base/jdk.internal.org.objectweb.asm=ALL-UNNAMED.", "author": "JasonFengJ9", "createdAt": "2020-12-15T17:00:32Z", "path": "test/functional/Java14andUp/src/org/openj9/test/jep358/NPEMessageTests.java", "diffHunk": "@@ -26,26 +26,26 @@\n \n import org.testng.Assert;\n \n-import jdk.internal.org.objectweb.asm.ClassWriter;\n-import jdk.internal.org.objectweb.asm.Label;\n-import jdk.internal.org.objectweb.asm.MethodVisitor;\n-import jdk.internal.org.objectweb.asm.Opcodes;\n-import jdk.internal.org.objectweb.asm.Type;\n+import org.objectweb.asm.ClassWriter;\n+import org.objectweb.asm.Label;\n+import org.objectweb.asm.MethodVisitor;\n+import org.objectweb.asm.Opcodes;\n+import org.objectweb.asm.Type;\n \n import static java.lang.invoke.MethodHandles.lookup;\n \n-import static jdk.internal.org.objectweb.asm.Opcodes.ACC_PUBLIC;\n-import static jdk.internal.org.objectweb.asm.Opcodes.ACC_SUPER;\n-import static jdk.internal.org.objectweb.asm.Opcodes.ACONST_NULL;\n-import static jdk.internal.org.objectweb.asm.Opcodes.ALOAD;\n-import static jdk.internal.org.objectweb.asm.Opcodes.ASTORE;\n-import static jdk.internal.org.objectweb.asm.Opcodes.GETFIELD;\n-import static jdk.internal.org.objectweb.asm.Opcodes.GETSTATIC;\n-import static jdk.internal.org.objectweb.asm.Opcodes.ICONST_1;\n-import static jdk.internal.org.objectweb.asm.Opcodes.INVOKESPECIAL;\n-import static jdk.internal.org.objectweb.asm.Opcodes.INVOKEVIRTUAL;\n-import static jdk.internal.org.objectweb.asm.Opcodes.IRETURN;\n-import static jdk.internal.org.objectweb.asm.Opcodes.RETURN;\n+import static org.objectweb.asm.Opcodes.ACC_PUBLIC;", "originalCommit": "c943834e1d84d52258e3360ff518e11283f2035a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU2OTYxNw==", "url": "https://github.com/eclipse-openj9/openj9/pull/11482#discussion_r543569617", "bodyText": "Hi @JasonFengJ9 , currently  the --add-exports has already exist in the build.xml, but it still has IllegalAccessError, could you specify where we also need to add this? Thanks.", "author": "LongyuZhang", "createdAt": "2020-12-15T18:06:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUyMDY1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU4NTM2Ng==", "url": "https://github.com/eclipse-openj9/openj9/pull/11482#discussion_r543585366", "bodyText": "--add-exports has already exist in the build.xml\n\nThat's for compilation, it need to be set for runtime after JDK tights its access control.\nThe option can be set at https://github.com/eclipse/openj9/blob/67bb44416a1caafdbcebdff6a2463b44d82f13cd/test/functional/Java14andUp/playlist.xml#L83\nJEP358NPEMessageTests-noDebugInfo needs similar change as well.", "author": "JasonFengJ9", "createdAt": "2020-12-15T18:30:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUyMDY1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzYxOTc0NQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/11482#discussion_r543619745", "bodyText": "The commit has been updated, and it passed on all platforms. Thanks a lot!", "author": "LongyuZhang", "createdAt": "2020-12-15T19:18:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzUyMDY1MQ=="}], "type": "inlineReview"}, {"oid": "aaf0165e0650f11042ff8b1dba5e8b6cabc4f536", "url": "https://github.com/eclipse-openj9/openj9/commit/aaf0165e0650f11042ff8b1dba5e8b6cabc4f536", "message": "Add add-exports to JEP358NPEMessageTests\n- Add --add-exports to JEPJEP358NPEMessageTests to fix illegal-access error\n\nSigned-off-by: Longyu Zhang <longyu.zhang@ibm.com>", "committedDate": "2020-12-15T19:11:29Z", "type": "forcePushed"}, {"oid": "8729182e0e79680c9a6ce64d223b9afa92e8db94", "url": "https://github.com/eclipse-openj9/openj9/commit/8729182e0e79680c9a6ce64d223b9afa92e8db94", "message": "Add add-exports to JEP358NPEMessageTests\n- Add --add-exports to JEPJEP358NPEMessageTests to fix illegal-access error\n\n[skip ci]\nSigned-off-by: Longyu Zhang <longyu.zhang@ibm.com>", "committedDate": "2020-12-15T19:16:22Z", "type": "forcePushed"}, {"oid": "7902ece283a329bc79d62c6170602e8c03eee891", "url": "https://github.com/eclipse-openj9/openj9/commit/7902ece283a329bc79d62c6170602e8c03eee891", "message": "Add add-exports to JEP358NPEMessageTests\n- Add --add-exports to JEP358NPEMessageTests to fix illegal-access error\n\n[skip ci]\nSigned-off-by: Longyu Zhang <longyu.zhang@ibm.com>", "committedDate": "2020-12-15T19:21:23Z", "type": "commit"}, {"oid": "7902ece283a329bc79d62c6170602e8c03eee891", "url": "https://github.com/eclipse-openj9/openj9/commit/7902ece283a329bc79d62c6170602e8c03eee891", "message": "Add add-exports to JEP358NPEMessageTests\n- Add --add-exports to JEP358NPEMessageTests to fix illegal-access error\n\n[skip ci]\nSigned-off-by: Longyu Zhang <longyu.zhang@ibm.com>", "committedDate": "2020-12-15T19:21:23Z", "type": "forcePushed"}]}