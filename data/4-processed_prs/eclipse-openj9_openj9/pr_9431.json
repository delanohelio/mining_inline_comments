{"pr_number": 9431, "pr_title": "Replace CPU APIs on Z", "pr_createdAt": "2020-05-01T18:28:41Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/9431", "timeline": [{"oid": "ff743ab68d2b552bd5c8f17dfb5ac7a92fecc041", "url": "https://github.com/eclipse-openj9/openj9/commit/ff743ab68d2b552bd5c8f17dfb5ac7a92fecc041", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-19T19:26:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NzE4Ng==", "url": "https://github.com/eclipse-openj9/openj9/pull/9431#discussion_r427557186", "bodyText": "@fjeremic Issue here: options get initialized after CompilerEnv gets initialized. as a result, by the time our cpu::detect() function is called , we won't have the command line options ready. So these feature/processor intiailizations have to be done afterwards. The workaround I have here is an applyUserOptions() api that will be called somewhere after the options are ready. (I picked the place that the old processor detection system uses to be safe). I thought about moving the detect function somewhere else, still think the current location is most idea. I also don't want our cpu::detect() function to have dependency on options initialization.", "author": "harryyu1994", "createdAt": "2020-05-19T19:46:27Z", "path": "runtime/compiler/z/env/J9CPU.cpp", "diffHunk": "@@ -43,14 +43,85 @@\n \n extern J9JITConfig * jitConfig;\n \n-namespace J9\n-{\n+void\n+J9::Z::CPU::applyUserOptions()", "originalCommit": "ff743ab68d2b552bd5c8f17dfb5ac7a92fecc041", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d7ee5bd87b2b0b810d9c237acd16077e71caade7", "url": "https://github.com/eclipse-openj9/openj9/commit/d7ee5bd87b2b0b810d9c237acd16077e71caade7", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-21T02:52:58Z", "type": "forcePushed"}, {"oid": "9df38930e88bf6eb00b06b4688f9f117dafc710a", "url": "https://github.com/eclipse-openj9/openj9/commit/9df38930e88bf6eb00b06b4688f9f117dafc710a", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-22T17:03:12Z", "type": "forcePushed"}, {"oid": "3ca46cffeee220874d15fb054c58e10a097d7600", "url": "https://github.com/eclipse-openj9/openj9/commit/3ca46cffeee220874d15fb054c58e10a097d7600", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-23T03:12:51Z", "type": "forcePushed"}, {"oid": "ae9efef0841ccd06b525a40779a6c4ae891e1c34", "url": "https://github.com/eclipse-openj9/openj9/commit/ae9efef0841ccd06b525a40779a6c4ae891e1c34", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-23T03:15:24Z", "type": "forcePushed"}, {"oid": "099de8ddac0e7242013c8731ada0b547627c49e0", "url": "https://github.com/eclipse-openj9/openj9/commit/099de8ddac0e7242013c8731ada0b547627c49e0", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-28T20:53:01Z", "type": "forcePushed"}, {"oid": "7ae31004f21d15a823039163eeec9ece28097de9", "url": "https://github.com/eclipse-openj9/openj9/commit/7ae31004f21d15a823039163eeec9ece28097de9", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-29T04:23:32Z", "type": "forcePushed"}, {"oid": "6150411cf30162e32a9a5d3dabc2be5523f10ce3", "url": "https://github.com/eclipse-openj9/openj9/commit/6150411cf30162e32a9a5d3dabc2be5523f10ce3", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-29T22:45:01Z", "type": "commit"}, {"oid": "6150411cf30162e32a9a5d3dabc2be5523f10ce3", "url": "https://github.com/eclipse-openj9/openj9/commit/6150411cf30162e32a9a5d3dabc2be5523f10ce3", "message": "Replace CPU APIs on Z\n\nSigned-off-by: Harry Yu <harryyu1994@gmail.com>", "committedDate": "2020-05-29T22:45:01Z", "type": "forcePushed"}]}