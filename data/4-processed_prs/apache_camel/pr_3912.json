{"pr_number": 3912, "pr_title": "Re-style the javascript for gulpfile", "pr_createdAt": "2020-06-14T07:09:28Z", "pr_url": "https://github.com/apache/camel/pull/3912", "timeline": [{"oid": "1b942474f7640ab52011815bae4c2a10151b298f", "url": "https://github.com/apache/camel/commit/1b942474f7640ab52011815bae4c2a10151b298f", "message": "add linting setup for gulpfile within docs", "committedDate": "2020-06-14T16:21:26Z", "type": "forcePushed"}, {"oid": "e2e136e224404f355a56874c5e8cc1145b39e1b6", "url": "https://github.com/apache/camel/commit/e2e136e224404f355a56874c5e8cc1145b39e1b6", "message": "modify gulpfile using lint", "committedDate": "2020-06-15T19:06:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM4ODQ2OQ==", "url": "https://github.com/apache/camel/pull/3912#discussion_r440388469", "bodyText": "Nitpick: this should go to devDependencies", "author": "zregvart", "createdAt": "2020-06-15T19:10:28Z", "path": "docs/package.json", "diffHunk": "@@ -14,5 +18,14 @@\n     \"gulp-sort\": \"^2.0.0\",\n     \"map-stream\": \"^0.0.7\",\n     \"through2\": \"^3.0.1\"\n+  },\n+  \"dependencies\": {\n+    \"eslint\": \"^7.2.0\",\n+    \"eslint-config-standard\": \"^14.1.1\",\n+    \"eslint-plugin-import\": \"^2.21.2\",\n+    \"eslint-plugin-node\": \"^11.1.0\",\n+    \"eslint-plugin-promise\": \"^4.2.1\",\n+    \"eslint-plugin-standard\": \"^4.0.1\",\n+    \"prettier-eslint-cli\": \"^5.0.0\"", "originalCommit": "e2e136e224404f355a56874c5e8cc1145b39e1b6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM4OTIwOA==", "url": "https://github.com/apache/camel/pull/3912#discussion_r440389208", "bodyText": "Seems that '../core/camel-main/src/main/docs/*.adoc' is missing here.", "author": "zregvart", "createdAt": "2020-06-15T19:11:59Z", "path": "docs/gulpfile.js", "diffHunk": "@@ -14,343 +14,427 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-const { dest, series, parallel, src, symlink } = require('gulp');\n-const del = require('del');\n-const filter = require('gulp-filter');\n-const inject = require('gulp-inject');\n+/* eslint-disable-next-line no-unused-vars */\n+const { dest, series, parallel, src, symlink } = require('gulp')\n+const del = require('del')\n+const filter = require('gulp-filter')\n+const inject = require('gulp-inject')\n const map = require('map-stream')\n-const path = require('path');\n-const rename = require('gulp-rename');\n-const replace = require('gulp-replace');\n-const sort = require('gulp-sort');\n-const through2 = require('through2');\n+const path = require('path')\n+const rename = require('gulp-rename')\n+const replace = require('gulp-replace')\n+const sort = require('gulp-sort')\n+const through2 = require('through2')\n const File = require('vinyl')\n-const fs = require('fs');\n+const fs = require('fs')\n \n-function deleteComponentSymlinks() {\n-    return del(['components/modules/ROOT/pages/*', '!components/modules/ROOT/pages/index.adoc']);\n+function deleteComponentSymlinks () {\n+  return del(['components/modules/ROOT/pages/*', '!components/modules/ROOT/pages/index.adoc'])\n }\n \n-function deleteComponentImageSymlinks() {\n-    return del(['components/modules/ROOT/assets/images/*']);\n+function deleteComponentImageSymlinks () {\n+  return del(['components/modules/ROOT/assets/images/*'])\n }\n \n-function createComponentSymlinks() {\n-    return src(['../core/camel-base/src/main/docs/*-component.adoc', '../components/{*,*/*}/src/main/docs/*-component.adoc', '../components/{*,*/*}/src/main/docs/*-summary.adoc'])\n-        .pipe(map((file, done) => {\n-            // this flattens the output to just .../pages/....adoc\n-            // instead of .../pages/camel-.../src/main/docs/....adoc\n-            file.base = path.dirname(file.path);\n-            done(null, file);\n-        }))\n-        // Antora disabled symlinks, there is an issue open\n-        // https://gitlab.com/antora/antora/issues/188\n-        // to reinstate symlink support, until that's resolved\n-        // we'll simply copy over instead of creating symlinks\n-        // .pipe(symlink('components/modules/ROOT/pages/', {\n-        //     relativeSymlinks: true\n-        // }));\n-        // uncomment above .pipe() and remove the .pipe() below\n-        // when antora#188 is resolved\n-        .pipe(insertSourceAttribute())\n-        .pipe(dest('components/modules/ROOT/pages/'));\n+function createComponentSymlinks () {\n+  return (\n+    src([\n+      '../core/camel-base/src/main/docs/*-component.adoc',\n+      '../components/{*,*/*}/src/main/docs/*-component.adoc',\n+      '../components/{*,*/*}/src/main/docs/*-summary.adoc',\n+    ])\n+      .pipe(\n+        map((file, done) => {\n+          // this flattens the output to just .../pages/....adoc\n+          // instead of .../pages/camel-.../src/main/docs/....adoc\n+          file.base = path.dirname(file.path)\n+          done(null, file)\n+        })\n+      )\n+      // Antora disabled symlinks, there is an issue open\n+      // https://gitlab.com/antora/antora/issues/188\n+      // to reinstate symlink support, until that's resolved\n+      // we'll simply copy over instead of creating symlinks\n+      // .pipe(symlink('components/modules/ROOT/pages/', {\n+      //     relativeSymlinks: true\n+      // }));\n+      // uncomment above .pipe() and remove the .pipe() below\n+      // when antora#188 is resolved\n+      .pipe(insertSourceAttribute())\n+      .pipe(dest('components/modules/ROOT/pages/'))\n+  )\n }\n \n-function createComponentOthersSymlinks() {\n-    const f = filter(['**','!**/*-language.adoc', '!**/*-dataformat.adoc', '!**/*-component.adoc', '!**/*-summary.adoc'])\n-    return src(['../core/camel-base/src/main/docs/*.adoc','../core/camel-main/src/main/docs/*.adoc','../components/{*,*/*}/src/main/docs/*.adoc'])\n-        .pipe(f)\n-        .pipe(map((file, done) => {\n-            // this flattens the output to just .../pages/....adoc\n-            // instead of .../pages/camel-.../src/main/docs/....adoc\n-            file.base = path.dirname(file.path);\n-            done(null, file);\n-        }))\n-        // Antora disabled symlinks, there is an issue open\n-        // https://gitlab.com/antora/antora/issues/188\n-        // to reinstate symlink support, until that's resolved\n-        // we'll simply copy over instead of creating symlinks\n-        // .pipe(symlink('components/modules/ROOT/pages/', {\n-        //     relativeSymlinks: true\n-        // }));\n-        // uncomment above .pipe() and remove the .pipe() below\n-        // when antora#188 is resolved\n-        .pipe(insertSourceAttribute())\n-        .pipe(dest('components/modules/others/pages/'));\n+function createComponentOthersSymlinks () {\n+  const f = filter([\n+    '**',\n+    '!**/*-language.adoc',\n+    '!**/*-dataformat.adoc',\n+    '!**/*-component.adoc',\n+    '!**/*-summary.adoc',\n+  ])\n+  return (\n+    src(['../core/camel-base/src/main/docs/*.adoc', '../components/{*,*/*}/src/main/docs/*.adoc'])", "originalCommit": "e2e136e224404f355a56874c5e8cc1145b39e1b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQwMjE2NA==", "url": "https://github.com/apache/camel/pull/3912#discussion_r440402164", "bodyText": "Yes, that's the merge conflict.", "author": "djencks", "createdAt": "2020-06-15T19:37:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM4OTIwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxNjk3MA==", "url": "https://github.com/apache/camel/pull/3912#discussion_r440416970", "bodyText": "I have rebased my branch with the master and it's up to date with the master branch. I am not sure about how this difference has come.", "author": "AemieJ", "createdAt": "2020-06-15T20:06:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM4OTIwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQ1MTg0MA==", "url": "https://github.com/apache/camel/pull/3912#discussion_r440451840", "bodyText": "Claus added a commit to gulpfile.js after your initial run of lint[-fix].  His change isn't in your latest commit.  I think you should discard your second commit, make your your branch is up to date with master (in case someone else changed something :-), run lint-fix, and make any manual changes needed, commit the result, and force-push.  I hope we'll be able to commit then :-)", "author": "djencks", "createdAt": "2020-06-15T21:16:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM4OTIwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDU5OTI4MA==", "url": "https://github.com/apache/camel/pull/3912#discussion_r440599280", "bodyText": "Latest commit includes the camel-main clause.", "author": "djencks", "createdAt": "2020-06-16T05:45:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM4OTIwOA=="}], "type": "inlineReview"}, {"oid": "8234ae6c5e6386bc27d4199e19ec2a506099af37", "url": "https://github.com/apache/camel/commit/8234ae6c5e6386bc27d4199e19ec2a506099af37", "message": "modify gulpfile using lint\n\nadd the packages as devDependencies", "committedDate": "2020-06-15T20:12:09Z", "type": "forcePushed"}, {"oid": "f4b63f06ae2b7712897344586859d6dc595c7719", "url": "https://github.com/apache/camel/commit/f4b63f06ae2b7712897344586859d6dc595c7719", "message": "add linting setup for gulpfile", "committedDate": "2020-06-16T04:32:31Z", "type": "commit"}, {"oid": "d6ce8f2442d1f7f48de88bf38fe00c9ec79093c8", "url": "https://github.com/apache/camel/commit/d6ce8f2442d1f7f48de88bf38fe00c9ec79093c8", "message": "modify gulpfile using lint", "committedDate": "2020-06-16T04:45:00Z", "type": "commit"}, {"oid": "d6ce8f2442d1f7f48de88bf38fe00c9ec79093c8", "url": "https://github.com/apache/camel/commit/d6ce8f2442d1f7f48de88bf38fe00c9ec79093c8", "message": "modify gulpfile using lint", "committedDate": "2020-06-16T04:45:00Z", "type": "forcePushed"}]}