{"pr_number": 4088, "pr_title": "CAMEL-14826: Add unit tests to the platform-http component", "pr_createdAt": "2020-08-13T09:23:21Z", "pr_url": "https://github.com/apache/camel/pull/4088", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg3OTg1OQ==", "url": "https://github.com/apache/camel/pull/4088#discussion_r469879859", "bodyText": "I would change the name of the method, e.g. tearDown()", "author": "aldettinger", "createdAt": "2020-08-13T11:21:08Z", "path": "components/camel-platform-http/src/test/java/org/apache/camel/component/platform/http/PlatformHttpTest.java", "diffHunk": "@@ -0,0 +1,93 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.camel.component.platform.http;\n+\n+import io.restassured.RestAssured;\n+import io.restassured.response.Response;\n+import io.restassured.specification.RequestSpecification;\n+import org.apache.camel.CamelContext;\n+import org.apache.camel.builder.RouteBuilder;\n+import org.apache.camel.impl.DefaultCamelContext;\n+import org.apache.camel.test.AvailablePortFinder;\n+import org.apache.camel.test.junit5.CamelTestSupport;\n+import org.junit.jupiter.api.AfterAll;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.Test;\n+\n+import static io.restassured.RestAssured.given;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+\n+public class PlatformHttpTest extends CamelTestSupport {\n+    private static JettyServerTest server;\n+    private static CamelContext ctx;\n+    private static int port;\n+\n+    @BeforeAll\n+    public static void init() throws Exception {\n+\n+        ctx = new DefaultCamelContext();\n+        ctx.getRegistry().bind(PlatformHttpConstants.PLATFORM_HTTP_ENGINE_FACTORY, new JettyCustomPlatformHttpEngine());\n+\n+        port = AvailablePortFinder.getNextAvailable();\n+        server = new JettyServerTest(port);\n+\n+        ctx.getRegistry().bind(JettyServerTest.JETTY_SERVER_NAME, server);\n+        server.start();\n+\n+        ctx.addRoutes(new RouteBuilder() {\n+            @Override\n+            public void configure() throws Exception {\n+                from(\"platform-http:/get\")\n+                        .setBody().constant(\"get\");\n+                from(\"platform-http:/post\")\n+                        .transform().body(String.class, b -> b.toUpperCase());\n+            }\n+        });\n+        ctx.start();\n+    }\n+\n+    @AfterAll\n+    public static void initPort() throws Exception {\n+        ctx.stop();", "originalCommit": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDAzOTQyMA==", "url": "https://github.com/apache/camel/pull/4088#discussion_r470039420", "bodyText": "yes!!", "author": "zbendhiba", "createdAt": "2020-08-13T15:30:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg3OTg1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA0NDM5MQ==", "url": "https://github.com/apache/camel/pull/4088#discussion_r470044391", "bodyText": "done !!", "author": "zbendhiba", "createdAt": "2020-08-13T15:38:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg3OTg1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg4MTE5Ng==", "url": "https://github.com/apache/camel/pull/4088#discussion_r469881196", "bodyText": "We may remove this line if not needed ?", "author": "aldettinger", "createdAt": "2020-08-13T11:23:59Z", "path": "components/camel-platform-http/src/test/resources/log4j2.properties", "diffHunk": "@@ -0,0 +1,29 @@\n+## ---------------------------------------------------------------------------\n+## Licensed to the Apache Software Foundation (ASF) under one or more\n+## contributor license agreements.  See the NOTICE file distributed with\n+## this work for additional information regarding copyright ownership.\n+## The ASF licenses this file to You under the Apache License, Version 2.0\n+## (the \"License\"); you may not use this file except in compliance with\n+## the License.  You may obtain a copy of the License at\n+##\n+##      http://www.apache.org/licenses/LICENSE-2.0\n+##\n+## Unless required by applicable law or agreed to in writing, software\n+## distributed under the License is distributed on an \"AS IS\" BASIS,\n+## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+## See the License for the specific language governing permissions and\n+## limitations under the License.\n+## ---------------------------------------------------------------------------\n+appender.file.type = File\n+appender.file.name = file\n+appender.file.fileName = target/camel-platform-http-test.log\n+appender.file.layout.type = PatternLayout\n+appender.file.layout.pattern = %d [%-15.15t] %-5p %-30.30c{1} - %m%n\n+appender.out.type = Console\n+appender.out.name = out\n+appender.out.layout.type = PatternLayout\n+appender.out.layout.pattern = [%30.30t] %-30.30c{1} %-5p %m%n\n+\n+rootLogger.level = INFO\n+rootLogger.appenderRef.file.ref = file\n+#rootLogger.appenderRef.out.ref = out", "originalCommit": "ed7a005dcdbb08ca7136205ea3ef5876f57dae48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA0NDAzNw==", "url": "https://github.com/apache/camel/pull/4088#discussion_r470044037", "bodyText": "done!!", "author": "zbendhiba", "createdAt": "2020-08-13T15:37:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg4MTE5Ng=="}], "type": "inlineReview"}, {"oid": "f70aa6477e1a350af097b59a772315e584abd03e", "url": "https://github.com/apache/camel/commit/f70aa6477e1a350af097b59a772315e584abd03e", "message": "CAMEL-14826: Add unit tests to the platform-http component", "committedDate": "2020-08-13T15:36:18Z", "type": "commit"}, {"oid": "f70aa6477e1a350af097b59a772315e584abd03e", "url": "https://github.com/apache/camel/commit/f70aa6477e1a350af097b59a772315e584abd03e", "message": "CAMEL-14826: Add unit tests to the platform-http component", "committedDate": "2020-08-13T15:36:18Z", "type": "forcePushed"}]}