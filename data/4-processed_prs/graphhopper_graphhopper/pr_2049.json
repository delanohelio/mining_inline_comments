{"pr_number": 2049, "pr_title": "Setup deployment on GitHub packages", "pr_createdAt": "2020-05-28T15:44:00Z", "pr_url": "https://github.com/graphhopper/graphhopper/pull/2049", "timeline": [{"oid": "0315fdec364a31c1bf53d3a3bd7939f976cd7cff", "url": "https://github.com/graphhopper/graphhopper/commit/0315fdec364a31c1bf53d3a3bd7939f976cd7cff", "message": "Try to setup GH workflow", "committedDate": "2020-05-28T14:22:36Z", "type": "commit"}, {"oid": "6c853bff634f85a66533a34d4372b2eef0e316b0", "url": "https://github.com/graphhopper/graphhopper/commit/6c853bff634f85a66533a34d4372b2eef0e316b0", "message": "Trigger", "committedDate": "2020-05-28T14:25:51Z", "type": "commit"}, {"oid": "6e73cd47503686c9ca792bbc1c183a757c9e7ed6", "url": "https://github.com/graphhopper/graphhopper/commit/6e73cd47503686c9ca792bbc1c183a757c9e7ed6", "message": "rename", "committedDate": "2020-05-28T14:28:24Z", "type": "commit"}, {"oid": "328cc2eb91af2d491788452cccedc7e336a982ab", "url": "https://github.com/graphhopper/graphhopper/commit/328cc2eb91af2d491788452cccedc7e336a982ab", "message": "Again", "committedDate": "2020-05-28T14:35:21Z", "type": "commit"}, {"oid": "8754cc6037062dc48dc8e805706548a9ae2727e2", "url": "https://github.com/graphhopper/graphhopper/commit/8754cc6037062dc48dc8e805706548a9ae2727e2", "message": "Use batch mode, skip tests", "committedDate": "2020-05-28T14:37:30Z", "type": "commit"}, {"oid": "b9142333d4ed237ef7415201365a89e758353634", "url": "https://github.com/graphhopper/graphhopper/commit/b9142333d4ed237ef7415201365a89e758353634", "message": "Merge branch 'master' into github_packages", "committedDate": "2020-05-28T15:14:45Z", "type": "commit"}, {"oid": "ff55b1c770fffb6cc27e63996fbb5da500f8b07b", "url": "https://github.com/graphhopper/graphhopper/commit/ff55b1c770fffb6cc27e63996fbb5da500f8b07b", "message": "Exclude fat jars and npm", "committedDate": "2020-05-28T15:17:27Z", "type": "commit"}, {"oid": "a797d16b2f9fe2052230c43fe23da07df0c77e96", "url": "https://github.com/graphhopper/graphhopper/commit/a797d16b2f9fe2052230c43fe23da07df0c77e96", "message": "Rename and add cache", "committedDate": "2020-05-28T15:26:09Z", "type": "commit"}, {"oid": "e0d17423ec33ce2a2b3f8a43885ce61e4d080ccb", "url": "https://github.com/graphhopper/graphhopper/commit/e0d17423ec33ce2a2b3f8a43885ce61e4d080ccb", "message": "Test cache", "committedDate": "2020-05-28T15:26:35Z", "type": "commit"}, {"oid": "b7d27f878d9535c2f28c7026cb9617471a83baa4", "url": "https://github.com/graphhopper/graphhopper/commit/b7d27f878d9535c2f28c7026cb9617471a83baa4", "message": "Restore", "committedDate": "2020-05-28T15:26:43Z", "type": "commit"}, {"oid": "342aba7e73c60c79d18311ccad6d55789a628dc5", "url": "https://github.com/graphhopper/graphhopper/commit/342aba7e73c60c79d18311ccad6d55789a628dc5", "message": "Skip node&npm installation", "committedDate": "2020-05-28T15:35:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTkzODQ3Mg==", "url": "https://github.com/graphhopper/graphhopper/pull/2049#discussion_r431938472", "bodyText": "This creates a hash code from the pom.xml files and uses this has caching key to cache the .m2 folder. The cached files still have to be downloaded on every build so its probably not much faster, but at least this way the logs are not as messy :)", "author": "easbar", "createdAt": "2020-05-28T15:45:24Z", "path": ".github/workflows/push-packages.yml", "diffHunk": "@@ -0,0 +1,24 @@\n+name: Publish to GitHub Packages\n+on: push\n+jobs:\n+  publish:\n+    runs-on: ubuntu-18.04\n+    steps:\n+      - uses: actions/checkout@v2\n+      - uses: actions/setup-java@v1\n+        with:\n+          java-version: 1.8\n+      - name: Cache Maven artifacts\n+        uses: actions/cache@v2\n+        with:\n+          path: ~/.m2/repository\n+          key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}\n+          restore-keys: |\n+            ${{ runner.os }}-maven-", "originalCommit": "342aba7e73c60c79d18311ccad6d55789a628dc5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTkzODc4NQ==", "url": "https://github.com/graphhopper/graphhopper/pull/2049#discussion_r431938785", "bodyText": "I do not think we need this as we are not releasing any 'snapshot' artifacts?", "author": "easbar", "createdAt": "2020-05-28T15:45:50Z", "path": "pom.xml", "diffHunk": "@@ -264,10 +264,11 @@\n     </build>\n \n     <distributionManagement>\n-        <snapshotRepository>\n-            <id>ossrh</id>\n-            <url>https://oss.sonatype.org/content/repositories/snapshots</url>\n-        </snapshotRepository>", "originalCommit": "342aba7e73c60c79d18311ccad6d55789a628dc5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk0MTUyMg==", "url": "https://github.com/graphhopper/graphhopper/pull/2049#discussion_r431941522", "bodyText": "Ah, here we can use it this.", "author": "karussell", "createdAt": "2020-05-28T15:49:49Z", "path": ".github/workflows/push-packages.yml", "diffHunk": "@@ -18,7 +18,7 @@ jobs:\n       - name: Build and publish package\n         run: |\n           mvn -B versions:set -DnewVersion=$GITHUB_SHA -DgenerateBackupPoms=false\n-          mvn -B -DskipTests -Dskip.npm -Pskip-shaded-web-jar -Pskip-tools-jar deploy\n+          mvn -B -DskipTests -Dskip.installnodenpm -Dskip.npm -Pskip-shaded-web-jar -Pskip-tools-jar deploy", "originalCommit": "342aba7e73c60c79d18311ccad6d55789a628dc5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}