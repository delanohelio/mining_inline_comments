{"pr_number": 13020, "pr_title": "Fix for WFLY-13129, Example CLI script", "pr_createdAt": "2020-02-19T17:31:56Z", "pr_url": "https://github.com/wildfly/wildfly/pull/13020", "timeline": [{"oid": "dc5b40b38fb1344b9450977a447a9227a86bdff3", "url": "https://github.com/wildfly/wildfly/commit/dc5b40b38fb1344b9450977a447a9227a86bdff3", "message": "Fix for WFLY-13129, Example CLI script to evolve standalone configurations with microprofile", "committedDate": "2020-03-12T16:06:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5NjcyNQ==", "url": "https://github.com/wildfly/wildfly/pull/13020#discussion_r402096725", "bodyText": "What about slimming the ApplicationRealm so it is just about default SSL, as Darran suggested in the analysis.", "author": "OndrejKotek", "createdAt": "2020-04-02T07:11:03Z", "path": "galleon-pack/src/main/resources/packages/docs.examples/content/docs/examples/enable-microprofile.cli", "diffHunk": "@@ -0,0 +1,59 @@\n+# This CLI script allows to enable Microprofile for the standalone configurations.\n+# By default, standalone.xml is updated.\n+# Run it from JBOSS_HOME as:\n+# bin/jboss-cli.sh --file=docs/examples/enable-microprofile.cli [-Dconfig=<standalone-full.xml|standalone-ha.xml|standalone-full-ha.xml>]\n+\n+embed-server --server-config=${config:standalone.xml}\n+\n+echo INFO: Updating configuration to use elytron\n+\n+/subsystem=undertow/application-security-domain=other:add(security-domain=ApplicationDomain)\n+/subsystem=ejb3/application-security-domain=other:add(security-domain=ApplicationDomain)\n+/subsystem=batch-jberet:write-attribute(name=security-domain, value=ApplicationDomain)\n+\n+# This applies to full configurations only.\n+if (outcome == success) of /subsystem=messaging-activemq/server=default:read-resource\n+  /subsystem=messaging-activemq/server=default:undefine-attribute(name=security-domain)\n+  /subsystem=messaging-activemq/server=default:write-attribute(name=elytron-domain, value=ApplicationDomain)\n+end-if\n+\n+/subsystem=remoting/http-connector=http-remoting-connector:write-attribute(name=sasl-authentication-factory, value=application-sasl-authentication)\n+/subsystem=remoting/http-connector=http-remoting-connector:undefine-attribute(name=security-realm)\n+\n+/core-service=management/access=identity:add(security-domain=ManagementDomain)\n+/core-service=management/management-interface=http-interface:write-attribute(name=http-upgrade,value={enabled=true, sasl-authentication-factory=management-sasl-authentication})\n+/core-service=management/management-interface=http-interface:write-attribute(name=http-authentication-factory,value=management-http-authentication)\n+/core-service=management/management-interface=http-interface:undefine-attribute(name=security-realm)\n+", "originalCommit": "dc5b40b38fb1344b9450977a447a9227a86bdff3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjEzNTIyMQ==", "url": "https://github.com/wildfly/wildfly/pull/13020#discussion_r402135221", "bodyText": "@OndrejKotek , the http-invoker references the ApplicationRealm, to be able to remove the authentication part we would need to introduce an http-authentication factory as defined in the analysis: https://github.com/wildfly/wildfly-proposals/pull/294/files#diff-f4f1c6de1cff1faeef00be5fbe9ef028R82", "author": "jfdenise", "createdAt": "2020-04-02T08:23:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA5NjcyNQ=="}], "type": "inlineReview"}, {"oid": "7fbcb21c00e513cc24658a9191b0a4afe92604d3", "url": "https://github.com/wildfly/wildfly/commit/7fbcb21c00e513cc24658a9191b0a4afe92604d3", "message": "Fix for WFLY-13129, Example CLI script to evolve standalone configurations with microprofile", "committedDate": "2020-04-16T07:34:14Z", "type": "commit"}, {"oid": "7fbcb21c00e513cc24658a9191b0a4afe92604d3", "url": "https://github.com/wildfly/wildfly/commit/7fbcb21c00e513cc24658a9191b0a4afe92604d3", "message": "Fix for WFLY-13129, Example CLI script to evolve standalone configurations with microprofile", "committedDate": "2020-04-16T07:34:14Z", "type": "forcePushed"}]}