{"pr_number": 13479, "pr_title": "[WFLY-13754] Allow injection for JSF artifacts", "pr_createdAt": "2020-08-12T09:51:40Z", "pr_url": "https://github.com/wildfly/wildfly/pull/13479", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk2Njk0Mg==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r469966942", "bodyText": "Does this new message describe the same situation as the old message, just with slightly different wording?  If not a new message should probably be used as the message ids are meant to be dictionary keys with the entry they point to (say a kbase, our own or a users) not radically changing.\nI recognize there can be some gray area here; if there is whatever @fjuma thinks best is fine with me.", "author": "bstansberry", "createdAt": "2020-08-13T13:51:48Z", "path": "jsf/subsystem/src/main/java/org/jboss/as/jsf/logging/JSFLogger.java", "diffHunk": "@@ -104,8 +104,8 @@\n     DeploymentUnitProcessingException invalidDefaultJSFImpl(String defaultJsfVersion);\n \n     @LogMessage(level = ERROR)\n-    @Message(id = 15, value = \"Failed to parse %s, phase listeners defined in this file will not be available\")\n-    void phaseListenersConfigParseFailed(VirtualFile facesConfig);\n+    @Message(id = 15, value = \"Failed to parse %s, JSF artifacts defined in this file will not be available\")\n+    void jsfArtifactsConfigParseFailed(VirtualFile facesConfig);", "originalCommit": "195f9a74c944363d181fccf60fc40c9edc5686e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk4NDYyMg==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r469984622", "bodyText": "Previously there was one message for managed-beans parsing error and another one for phase-listeners (two different parsing executions). Now there is one parsing method for all the artifacts, so it's very similar but not exactly the same.\nI just re-used one of the previous messages and commented out the other one. I really didn't think too much about this, I just re-used it. If you prefer a new ID/message and commenting out the previous two just let me know.\nThanks!", "author": "rmartinc", "createdAt": "2020-08-13T14:15:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk2Njk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI0OTgyNQ==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r470249825", "bodyText": "Thanks. The parsing error message change is fine with me.\nThis next question is somewhat OT to this PR as it's about the existing code, but this message doesn't really tell the user anything about the problem. Should the actual error that leads to it be logged at DEBUG or something?", "author": "bstansberry", "createdAt": "2020-08-13T21:09:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk2Njk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ1NTE2Nw==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r471455167", "bodyText": "IMHO the message is OK at error level, or at least at warning. More or less that message means the faces-config file is incorrect and it is not going to be fully parsed for managed-beans or other artifacts. Why do you say it doesn't say anything about the error? Would it be better to log the stack-trace too?", "author": "rmartinc", "createdAt": "2020-08-17T12:49:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk2Njk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMxMjE2MA==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r476312160", "bodyText": "For the moment and after reading your comments I have used the first message instead of the second (the first one is the important one, so better re-use the first one and comment out the second). It's just a slightly different wording but same ID and error level. I have rebased to current master too.", "author": "rmartinc", "createdAt": "2020-08-25T09:30:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk2Njk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDQzNTcxNg==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r510435716", "bodyText": "@rmartinc Just to close out this discussion, which I failed to come back to. Yes, I was referring to logging a stack trace at DEBUG.\nThat's not urgent; if this passes CI agains it's ready for merge.", "author": "bstansberry", "createdAt": "2020-10-22T20:25:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTk2Njk0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI1MDczNQ==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r470250735", "bodyText": "Can all the whitespace issues in this PR be cleaned up please? Thanks.", "author": "bstansberry", "createdAt": "2020-08-13T21:11:15Z", "path": "jsf/subsystem/src/main/java/org/jboss/as/jsf/deployment/JSFComponentProcessor.java", "diffHunk": "@@ -67,13 +73,149 @@\n \n     private static final String WEB_INF_FACES_CONFIG = \"WEB-INF/faces-config.xml\";\n \n-    private static final String MANAGED_BEAN = \"managed-bean\";\n-    private static final String MANAGED_BEAN_CLASS = \"managed-bean-class\";\n-    private static final String LIFECYCLE = \"lifecycle\";\n-    private static final String PHASE_LISTENER = \"phase-listener\";\n-\n     private static final String CONFIG_FILES = \"javax.faces.CONFIG_FILES\";\n \n+    /**\n+     * JSF tags that should be checked in the configuration file. All the\n+     * tags that are needed for injection are taken into account.\n+     * If more artifacts should be included just add it to the enum and to\n+     * the <em>facesConfigElement</em> tree in order to be parsed.\n+     */\n+    private enum JsfTag {\n+      FACES_CONFIG,\n+        FACTORY,\n+          APPLICATION_FACTORY,", "originalCommit": "195f9a74c944363d181fccf60fc40c9edc5686e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQ1NTEyOQ==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r471455129", "bodyText": "OK, I'll re-format the enum when I know what to do with the message to do both things ate the same time. This was done on purpose, to see the XML structure. :-)", "author": "rmartinc", "createdAt": "2020-08-17T12:49:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI1MDczNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjMxMDM4MQ==", "url": "https://github.com/wildfly/wildfly/pull/13479#discussion_r476310381", "bodyText": "Fixed!", "author": "rmartinc", "createdAt": "2020-08-25T09:27:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI1MDczNQ=="}], "type": "inlineReview"}, {"oid": "4f578cc422b004e4b158d73925d62cdc0744f1c9", "url": "https://github.com/wildfly/wildfly/commit/4f578cc422b004e4b158d73925d62cdc0744f1c9", "message": "[WFLY-13754] Allow injection for JSF artifacts", "committedDate": "2020-08-25T06:51:05Z", "type": "commit"}, {"oid": "4f578cc422b004e4b158d73925d62cdc0744f1c9", "url": "https://github.com/wildfly/wildfly/commit/4f578cc422b004e4b158d73925d62cdc0744f1c9", "message": "[WFLY-13754] Allow injection for JSF artifacts", "committedDate": "2020-08-25T06:51:05Z", "type": "forcePushed"}]}