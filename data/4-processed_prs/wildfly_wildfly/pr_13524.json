{"pr_number": 13524, "pr_title": "WFLY-13354  Add Galleon layers for the EJB subsystem", "pr_createdAt": "2020-09-02T04:32:38Z", "pr_url": "https://github.com/wildfly/wildfly/pull/13524", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzEyNzg0Nw==", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483127847", "bodyText": "This feature-group uses 'security=\"identity\"' which AFAICT introduces a requirement for the legacy security subsytem. Which isn't ok; we don't want layers to require the legacy security subsystem", "author": "bstansberry", "createdAt": "2020-09-03T17:02:52Z", "path": "ee-feature-pack/galleon-common/src/main/resources/layers/standalone/iiop-openjdk/layer-spec.xml", "diffHunk": "@@ -0,0 +1,21 @@\n+<?xml version=\"1.0\" ?>\n+<layer-spec xmlns=\"urn:jboss:galleon:layer-spec:1.0\" name=\"iiop-openjdk\">\n+    <dependencies>\n+        <layer name=\"naming\"/>\n+    </dependencies>\n+    <feature-group name=\"iiop-openjdk\"/>", "originalCommit": "33fb6f42af3ff3c2b7bf8eff4c633e6d89948567", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzEzODQ1MA==", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483138450", "bodyText": "If the layer instead specified 'security='elytron'\" then a dependency on the 'elytron' layer would be required.\nSuch a dependency should be declared as optional, to allow the user to exclude the dependency if they intend to change the 'security' value.", "author": "bstansberry", "createdAt": "2020-09-03T17:22:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzEyNzg0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI0ODY4OQ==", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483248689", "bodyText": "@chengfang This needs to be\n<groupId>${testsuite.ee.galleon.pack.groupId}</groupId>\n\nThis allows different test jobs to configure what feature pack is used to provision the server, i.e. the one that directly exposes the layer or a higher level one that exposes it transitively.", "author": "bstansberry", "createdAt": "2020-09-03T20:54:43Z", "path": "testsuite/integration/basic/pom.xml", "diffHunk": "@@ -1197,8 +1235,127 @@\n                                 </configuration>\n                             </execution>\n \n+                            <!-- Provision a cloud-profile server with ejb3-lite -->\n+                            <execution>\n+                                <id>ejb3-lite-provisioning</id>\n+                                <goals>\n+                                    <goal>provision</goal>\n+                                </goals>\n+                                <phase>compile</phase>\n+                                <configuration>\n+                                    <install-dir>${project.build.directory}/wildfly-ejb3-lite</install-dir>\n+                                    <record-state>false</record-state>\n+                                    <log-time>${galleon.log.time}</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>\n+                                        <optional-packages>passive+</optional-packages>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>${project.groupId}</groupId>", "originalCommit": "33fb6f42af3ff3c2b7bf8eff4c633e6d89948567", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI2MzM4Mw==", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483263383", "bodyText": "will fix it.", "author": "chengfang", "createdAt": "2020-09-03T21:27:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI0ODY4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI0OTEwOQ==", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483249109", "bodyText": "@chengfang This needs to be\n<groupId>${testsuite.ee.galleon.pack.groupId}</groupId>", "author": "bstansberry", "createdAt": "2020-09-03T20:55:30Z", "path": "testsuite/integration/basic/pom.xml", "diffHunk": "@@ -1197,8 +1235,127 @@\n                                 </configuration>\n                             </execution>\n \n+                            <!-- Provision a cloud-profile server with ejb3-lite -->\n+                            <execution>\n+                                <id>ejb3-lite-provisioning</id>\n+                                <goals>\n+                                    <goal>provision</goal>\n+                                </goals>\n+                                <phase>compile</phase>\n+                                <configuration>\n+                                    <install-dir>${project.build.directory}/wildfly-ejb3-lite</install-dir>\n+                                    <record-state>false</record-state>\n+                                    <log-time>${galleon.log.time}</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>\n+                                        <optional-packages>passive+</optional-packages>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>${project.groupId}</groupId>\n+                                            <artifactId>${testsuite.ee.galleon.pack.artifactId}</artifactId>\n+                                            <version>${testsuite.ee.galleon.pack.version}</version>\n+                                            <inherit-configs>false</inherit-configs>\n+                                            <inherit-packages>false</inherit-packages>\n+                                        </feature-pack>\n+                                    </feature-packs>\n+                                    <configurations>\n+                                        <config>\n+                                            <model>standalone</model>\n+                                            <name>standalone.xml</name>\n+                                            <layers>\n+                                                <layer>cloud-server</layer>\n+                                                <layer>h2-default-datasource</layer>\n+                                                <layer>ejb3-lite</layer>\n+                                            </layers>\n+                                        </config>\n+                                    </configurations>\n+                                </configuration>\n+                            </execution>\n+                            <!-- Provision a cloud-profile server with ejb3 -->\n+                            <execution>\n+                                <id>ejb3-provisioning</id>\n+                                <goals>\n+                                    <goal>provision</goal>\n+                                </goals>\n+                                <phase>compile</phase>\n+                                <configuration>\n+                                    <install-dir>${project.build.directory}/wildfly-ejb3</install-dir>\n+                                    <record-state>false</record-state>\n+                                    <log-time>${galleon.log.time}</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>\n+                                        <optional-packages>passive+</optional-packages>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>${project.groupId}</groupId>\n+                                            <artifactId>wildfly-test-galleon-pack</artifactId>\n+                                            <version>${ee.maven.version}</version>\n+                                            <inherit-configs>false</inherit-configs>\n+                                            <inherit-packages>false</inherit-packages>\n+                                        </feature-pack>\n+                                    </feature-packs>\n+                                    <configurations>\n+                                        <config>\n+                                            <model>standalone</model>\n+                                            <name>standalone.xml</name>\n+                                            <layers>\n+                                                <layer>cloud-server</layer>\n+                                                <layer>h2-default-datasource</layer>\n+                                                <layer>ejb3</layer>\n+                                                <layer>ejb-elytron-testsuite</layer>\n+                                            </layers>\n+                                        </config>\n+                                    </configurations>\n+                                </configuration>\n+                            </execution>\n+                            <!-- Provision a cloud-profile server with ejb3-iiop -->\n+                            <execution>\n+                                <id>ejb3-iiop-provisioning</id>\n+                                <goals>\n+                                    <goal>provision</goal>\n+                                </goals>\n+                                <phase>compile</phase>\n+                                <configuration>\n+                                    <install-dir>${project.build.directory}/wildfly-ejb3-iiop</install-dir>\n+                                    <record-state>false</record-state>\n+                                    <log-time>${galleon.log.time}</log-time>\n+                                    <offline>true</offline>\n+                                    <plugin-options>\n+                                        <jboss-maven-dist/>\n+                                        <jboss-fork-embedded>${galleon.fork.embedded}</jboss-fork-embedded>\n+                                        <optional-packages>passive+</optional-packages>\n+                                    </plugin-options>\n+                                    <feature-packs>\n+                                        <feature-pack>\n+                                            <groupId>${project.groupId}</groupId>", "originalCommit": "33fb6f42af3ff3c2b7bf8eff4c633e6d89948567", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI2MzQ3MA==", "url": "https://github.com/wildfly/wildfly/pull/13524#discussion_r483263470", "bodyText": "will fix it.", "author": "chengfang", "createdAt": "2020-09-03T21:27:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI0OTEwOQ=="}], "type": "inlineReview"}, {"oid": "773be0569d80667471dd784936045270f1365003", "url": "https://github.com/wildfly/wildfly/commit/773be0569d80667471dd784936045270f1365003", "message": "WFLY-13354 Add Galleon layers for the EJB subsystem", "committedDate": "2020-09-04T18:03:25Z", "type": "commit"}, {"oid": "773be0569d80667471dd784936045270f1365003", "url": "https://github.com/wildfly/wildfly/commit/773be0569d80667471dd784936045270f1365003", "message": "WFLY-13354 Add Galleon layers for the EJB subsystem", "committedDate": "2020-09-04T18:03:25Z", "type": "forcePushed"}]}