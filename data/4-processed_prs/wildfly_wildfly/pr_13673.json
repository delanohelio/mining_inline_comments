{"pr_number": 13673, "pr_title": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "pr_createdAt": "2020-10-23T18:41:48Z", "pr_url": "https://github.com/wildfly/wildfly/pull/13673", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1NjU2OA==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r511156568", "bodyText": "Instead of mentioning this here and below, I think it would be better to add something like a \"Configuring SSLv2Hello\" section just after the  \"Configuring a server SSLContext\"/\"Configuring a client SSLContext\" sections. This section should contain a warning that indicates that the use of this protocol is discouraged.", "author": "fjuma", "createdAt": "2020-10-23T21:09:36Z", "path": "docs/src/main/asciidoc/_elytron/Using_the_Elytron_Subsystem.adoc", "diffHunk": "@@ -1378,7 +1378,8 @@ into the server truststore:\n \n *IMPORTANT* +\n You need to determine what SSL/TLS protocols you want to support. The\n-example commands above uses _TLSv1.2_.\n+example commands above uses _TLSv1.2_. Supported protocols include SSLv2, SSLv2Hello, SSLv3,", "originalCommit": "1656f90db2a71fa5bc564e52d7085cfde7c93716", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1OTE4Ng==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r511159186", "bodyText": "Similar content should also be added in authentication-client.adoc.", "author": "fjuma", "createdAt": "2020-10-23T21:16:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1NjU2OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjczNTUzMg==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r512735532", "bodyText": "I've added the sections to the documentation.", "author": "SoniaZaldana", "createdAt": "2020-10-27T14:23:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTE1NjU2OA=="}], "type": "inlineReview"}, {"oid": "eb5e9f9f3a73fc7e466405febb1834c4bd3bccfc", "url": "https://github.com/wildfly/wildfly/commit/eb5e9f9f3a73fc7e466405febb1834c4bd3bccfc", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-27T14:22:50Z", "type": "forcePushed"}, {"oid": "42f425cff7e4f37c090bc4cbfc224518655611ae", "url": "https://github.com/wildfly/wildfly/commit/42f425cff7e4f37c090bc4cbfc224518655611ae", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-27T14:24:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU0MzkxMQ==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r513543911", "bodyText": "I think we could use \"WARNING\" here instead of \"=== Important to Note:\". I think we should add a sentence at the beginning of this warning that says: \"The use of SSLv2Hello is discouraged.\" just to emphasize it again.", "author": "fjuma", "createdAt": "2020-10-28T15:35:06Z", "path": "docs/src/main/asciidoc/_client-guide/authentication-client.adoc", "diffHunk": "@@ -471,6 +471,31 @@ The following example configuration specifies that the default filtering should\n \n  <certificate-revocation-list />:: The presence of this element enabled checking the peer's certificate against a certificate revocation list, this element defines both a path to the certificate revocation list and also specifies the maximum number of non-self-issued intermediate certificates that may exist in a certification path\n \n+=== Configuring SSLv2Hello\n+\n+Older JDK versions use ``SSLv2Hello`` during the initial SSL handshake message\n+where the SSL/TLS version that will be used for the rest of the communication is\n+negotiated.\n+\n+Using ``SSLv2Hello`` is discouraged, therefore newer JDK versions disable this protocol\n+on the client by default. However, they do provide the ability to re-enable it if necessary.\n+\n+``SSLv2Hello`` can be configured as a supported protocol for the SSL context as follows:\n+\n+[source,options=\"nowrap\"]\n+----\n+<protocol names=\"SSLv2Hello TLSv1\">\n+----\n+\n+=== Important to Note:", "originalCommit": "42f425cff7e4f37c090bc4cbfc224518655611ae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMxODkzMg==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r514318932", "bodyText": "I've updated the documentation and also added the missing test scenarios.", "author": "SoniaZaldana", "createdAt": "2020-10-29T14:49:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU0MzkxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzU0NDAzOA==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r513544038", "bodyText": "Same here.", "author": "fjuma", "createdAt": "2020-10-28T15:35:14Z", "path": "docs/src/main/asciidoc/_elytron/Using_the_Elytron_Subsystem.adoc", "diffHunk": "@@ -2309,6 +2309,39 @@ the first handshake in order to receive the `NewSessionTicket` that can be used\n change once https://bugs.openjdk.java.net/browse/JDK-8209953[JDK-8209953] is resolved.\n \n \n+=== Configuring SSLv2Hello\n+\n+Older JDK versions use ``SSLv2Hello`` during the initial SSL handshake message\n+where the SSL/TLS version that will be used for the rest of the communication is\n+negotiated.\n+\n+Using ``SSLv2Hello`` is discouraged, therefore newer JDK versions disable this protocol\n+on the client by default. However, they do provide the ability to re-enable it if necessary.\n+\n+``SSLv2Hello`` can be configured as a supported protocol for the server SSL context as follows:\n+\n+[source,options=\"nowrap\"]\n+----\n+/subsystem=elytron/server-ssl-context=server-context:add(protocols=[SSLv2Hello,TLSv1], ...)\n+----\n+\n+Similarly, it can be configured as a supported protocol for the client SSL context as follows:\n+\n+[source,options=\"nowrap\"]\n+----\n+/subsystem=elytron/client-ssl-context=client-context:add(protocols=[SSLv2Hello,TLSv1], ...)\n+----\n+\n+==== Important to Note:", "originalCommit": "42f425cff7e4f37c090bc4cbfc224518655611ae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "84d02347f8c1ab26a97697ebcb72c7bec97082f2", "url": "https://github.com/wildfly/wildfly/commit/84d02347f8c1ab26a97697ebcb72c7bec97082f2", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-29T14:33:58Z", "type": "forcePushed"}, {"oid": "d6239fca9f72eba4d268701f18380f5bb32d14b2", "url": "https://github.com/wildfly/wildfly/commit/d6239fca9f72eba4d268701f18380f5bb32d14b2", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-29T14:42:54Z", "type": "forcePushed"}, {"oid": "b9c4114ac3f18abb6af91884e635622424df2efa", "url": "https://github.com/wildfly/wildfly/commit/b9c4114ac3f18abb6af91884e635622424df2efa", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-29T14:48:58Z", "type": "forcePushed"}, {"oid": "299288f9fa42d99b853e802243b7bf20b7fc34c1", "url": "https://github.com/wildfly/wildfly/commit/299288f9fa42d99b853e802243b7bf20b7fc34c1", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-29T19:49:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTExMzgzOA==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r515113838", "bodyText": "Looks like the above lines can be removed.", "author": "fjuma", "createdAt": "2020-10-30T13:53:49Z", "path": "testsuite/integration/elytron/src/test/resources/org/wildfly/test/integration/elytron/ssl/wildfly-config-one-way-sslv2hello.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<configuration>\n+    <authentication-client xmlns=\"urn:elytron:client:1.6\">\n+        <key-stores>\n+            <key-store name=\"truststore\" type=\"JKS\">\n+                <file name=\"target/UndertowTwoWaySslNeedClientAuthTestCase/client.truststore\"/>\n+            </key-store>\n+<!--            <key-store name=\"keystore\" type=\"JKS\">-->\n+<!--                <file name=\"target/UndertowTwoWaySslNeedClientAuthTestCase/client.keystore\"/>-->\n+<!--                <key-store-clear-password password=\"123456\" />-->\n+<!--            </key-store>-->", "originalCommit": "299288f9fa42d99b853e802243b7bf20b7fc34c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTExMzkxNg==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r515113916", "bodyText": "Same here.", "author": "fjuma", "createdAt": "2020-10-30T13:53:55Z", "path": "testsuite/integration/elytron/src/test/resources/org/wildfly/test/integration/elytron/ssl/wildfly-config-one-way-sslv2hello.xml", "diffHunk": "@@ -0,0 +1,27 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<configuration>\n+    <authentication-client xmlns=\"urn:elytron:client:1.6\">\n+        <key-stores>\n+            <key-store name=\"truststore\" type=\"JKS\">\n+                <file name=\"target/UndertowTwoWaySslNeedClientAuthTestCase/client.truststore\"/>\n+            </key-store>\n+<!--            <key-store name=\"keystore\" type=\"JKS\">-->\n+<!--                <file name=\"target/UndertowTwoWaySslNeedClientAuthTestCase/client.keystore\"/>-->\n+<!--                <key-store-clear-password password=\"123456\" />-->\n+<!--            </key-store>-->\n+        </key-stores>\n+        <ssl-contexts>\n+            <ssl-context name=\"client-context\">\n+                <trust-store key-store-name=\"truststore\"/>\n+<!--                <key-store-ssl-certificate key-store-name=\"keystore\">-->\n+<!--                    <key-store-clear-password password=\"123456\" />-->\n+<!--                </key-store-ssl-certificate>-->", "originalCommit": "299288f9fa42d99b853e802243b7bf20b7fc34c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ece54777760cbd2ae80ef94c3713179546a50b40", "url": "https://github.com/wildfly/wildfly/commit/ece54777760cbd2ae80ef94c3713179546a50b40", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-30T14:43:06Z", "type": "forcePushed"}, {"oid": "10101f9b2b81ea1c7ef39956ffaa18493baafc5b", "url": "https://github.com/wildfly/wildfly/commit/10101f9b2b81ea1c7ef39956ffaa18493baafc5b", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-10-30T15:24:07Z", "type": "forcePushed"}, {"oid": "ed4877e4cf5e6a58d3b0f3249f73bf80548354e8", "url": "https://github.com/wildfly/wildfly/commit/ed4877e4cf5e6a58d3b0f3249f73bf80548354e8", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2020-11-26T20:12:16Z", "type": "forcePushed"}, {"oid": "832f5af88b82bc7c9b6c3aacb241a2cc48cec284", "url": "https://github.com/wildfly/wildfly/commit/832f5af88b82bc7c9b6c3aacb241a2cc48cec284", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-01-11T15:26:12Z", "type": "forcePushed"}, {"oid": "8f0cfbfc6102d66500d3e3caad61dc463da63f66", "url": "https://github.com/wildfly/wildfly/commit/8f0cfbfc6102d66500d3e3caad61dc463da63f66", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-02-01T15:20:50Z", "type": "forcePushed"}, {"oid": "cb35eabbb3571186854b404504edd941c8804571", "url": "https://github.com/wildfly/wildfly/commit/cb35eabbb3571186854b404504edd941c8804571", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-02-02T21:00:01Z", "type": "forcePushed"}, {"oid": "d5be418673590b46e936848fe51dbf8d9b1b2449", "url": "https://github.com/wildfly/wildfly/commit/d5be418673590b46e936848fe51dbf8d9b1b2449", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-02-04T18:58:27Z", "type": "forcePushed"}, {"oid": "a661f06bc60d00c6ded567f579e89c5fb52f9904", "url": "https://github.com/wildfly/wildfly/commit/a661f06bc60d00c6ded567f579e89c5fb52f9904", "message": "[WFLY-14835] Add @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-03T17:19:27Z", "type": "forcePushed"}, {"oid": "b101ce56b7b6a518c250d24caf85b9e5a01a1c95", "url": "https://github.com/wildfly/wildfly/commit/b101ce56b7b6a518c250d24caf85b9e5a01a1c95", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-07T19:04:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NjkwNzcwMA==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r646907700", "bodyText": "Since the properties file is used to re-enable TLSv1, it would be good to rename this to reenabled_tlsv1.properties or something like that.", "author": "fjuma", "createdAt": "2021-06-07T20:12:59Z", "path": "testsuite/integration/elytron/pom.xml", "diffHunk": "@@ -51,13 +51,15 @@\n         <jbossas.ts.dir>${jbossas.ts.integ.dir}/..</jbossas.ts.dir>\n         <jbossas.project.dir>${jbossas.ts.dir}/..</jbossas.project.dir>\n         <wildfly.dir>${basedir}/target/${wildfly.instance.name}</wildfly.dir>\n-\n+        <security.properties>${project.basedir}/src/test/resources/disabled_tlsv1.properties</security.properties>", "originalCommit": "b101ce56b7b6a518c250d24caf85b9e5a01a1c95", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NjkzMzIzOQ==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r646933239", "bodyText": "If we could use the single = here to append to the existing properties file instead of fully override, we wouldn't need to specify the security providers in the properties file.", "author": "fjuma", "createdAt": "2021-06-07T20:54:06Z", "path": "testsuite/integration/elytron/pom.xml", "diffHunk": "@@ -281,11 +285,44 @@\n                         <jboss.server.config.file.name>standalone-full.xml</jboss.server.config.file.name>\n                         <jboss.inst>${wildfly.dir}</jboss.inst>\n                         <module.path>${wildfly.dir}/modules</module.path>\n-                        <server.jvm.args>-Dmaven.repo.local=${settings.localRepository} -Djboss.bind.address=${node0} -Djboss.bind.address.management=${node0} ${surefire.system.args} ${jvm.args.ip.server} ${jvm.args.other} ${jvm.args.timeouts} ${extra.server.jvm.args}</server.jvm.args>\n+                        <server.jvm.args>${server.jvm.args}</server.jvm.args>\n                         <node0>${node0}</node0>\n+                        <security.properties>${security.properties}</security.properties>\n                     </systemPropertyVariables>\n-                    <argLine>${surefire.system.args} ${jvm.args.ip.client}</argLine>\n                 </configuration>\n+                <executions>\n+                    <execution>\n+                        <id>default-tests</id>\n+                        <phase>test</phase>\n+                        <goals>\n+                            <goal>test</goal>\n+                        </goals>\n+                        <configuration>\n+                            <skip>false</skip>\n+                            <argLine>${surefire.system.args} ${jvm.args.ip.client}</argLine>\n+                            <excludes>\n+                                <exclude>***/UndertowSSLv2HelloTestCase</exclude>\n+                            </excludes>\n+                        </configuration>\n+                    </execution>\n+                    <execution>\n+                        <id>sslv2-tests</id>\n+                        <phase>test</phase>\n+                        <goals>\n+                            <goal>test</goal>\n+                        </goals>\n+                        <configuration>\n+                            <skip>false</skip>\n+                            <argLine>-Djava.security.properties==${security.properties} ${surefire.system.args} ${jvm.args.ip.client}</argLine>", "originalCommit": "b101ce56b7b6a518c250d24caf85b9e5a01a1c95", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzQ4MDg2NA==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r647480864", "bodyText": "Fixed :)", "author": "SoniaZaldana", "createdAt": "2021-06-08T14:10:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NjkzMzIzOQ=="}], "type": "inlineReview"}, {"oid": "3dc8ba615b66712954719ae3047ef68270cd25e8", "url": "https://github.com/wildfly/wildfly/commit/3dc8ba615b66712954719ae3047ef68270cd25e8", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T14:09:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzQ5Njk2OQ==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r647496969", "bodyText": "I think we can remove this now as it's not used in any tests or in the Arquillian configuration.", "author": "jamezp", "createdAt": "2021-06-08T14:27:11Z", "path": "testsuite/integration/elytron/pom.xml", "diffHunk": "@@ -281,11 +284,44 @@\n                         <jboss.server.config.file.name>standalone-full.xml</jboss.server.config.file.name>\n                         <jboss.inst>${wildfly.dir}</jboss.inst>\n                         <module.path>${wildfly.dir}/modules</module.path>\n-                        <server.jvm.args>-Dmaven.repo.local=${settings.localRepository} -Djboss.bind.address=${node0} -Djboss.bind.address.management=${node0} ${surefire.system.args} ${jvm.args.ip.server} ${jvm.args.other} ${jvm.args.timeouts} ${extra.server.jvm.args}</server.jvm.args>\n+                        <server.jvm.args>${server.jvm.args}</server.jvm.args>\n                         <node0>${node0}</node0>\n+                        <security.properties>${security.properties}</security.properties>", "originalCommit": "3dc8ba615b66712954719ae3047ef68270cd25e8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzUzNTI4Mg==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r647535282", "bodyText": "thanks @jamezp, fixed!", "author": "SoniaZaldana", "createdAt": "2021-06-08T15:06:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzQ5Njk2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzUwMDQ3MA==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r647500470", "bodyText": "This is not critical at all, but there is a TestSuiteEnvironment.isIbmJvm() or TestSuiteEvronment.isJ9Jvm() is case this is supported on OpenJ9.", "author": "jamezp", "createdAt": "2021-06-08T14:30:42Z", "path": "testsuite/integration/elytron/src/test/java/org/wildfly/test/integration/elytron/ssl/UndertowSSLv2HelloTestCase.java", "diffHunk": "@@ -0,0 +1,373 @@\n+/*\n+ * JBoss, Home of Professional Open Source.\n+ * Copyright 2020, Red Hat, Inc., and individual contributors\n+ * as indicated by the @author tags. See the copyright.txt file in the\n+ * distribution for a full listing of individual contributors.\n+ *\n+ * This is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU Lesser General Public License as\n+ * published by the Free Software Foundation; either version 2.1 of\n+ * the License, or (at your option) any later version.\n+ *\n+ * This software is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this software; if not, write to the Free\n+ * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n+ * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n+ */\n+\n+package org.wildfly.test.integration.elytron.ssl;\n+\n+import static java.security.AccessController.doPrivileged;\n+import static org.jboss.as.test.integration.security.common.SSLTruststoreUtil.HTTPS_PORT;\n+\n+import java.io.File;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.security.PrivilegedAction;\n+import java.security.Security;\n+\n+import javax.ws.rs.ProcessingException;\n+import javax.ws.rs.client.Client;\n+import javax.ws.rs.client.ClientBuilder;\n+import javax.ws.rs.core.Response;\n+\n+import org.codehaus.plexus.util.FileUtils;\n+import org.jboss.arquillian.container.test.api.Deployment;\n+import org.jboss.arquillian.container.test.api.RunAsClient;\n+import org.jboss.arquillian.junit.Arquillian;\n+import org.jboss.as.arquillian.api.ServerSetup;\n+import org.jboss.as.controller.client.ModelControllerClient;\n+import org.jboss.as.test.integration.management.util.CLIWrapper;\n+import org.jboss.as.test.integration.security.common.CoreUtils;\n+import org.jboss.as.test.integration.security.common.SecurityTestConstants;\n+import org.jboss.as.test.shared.TestSuiteEnvironment;\n+import org.jboss.shrinkwrap.api.ShrinkWrap;\n+import org.jboss.shrinkwrap.api.asset.StringAsset;\n+import org.jboss.shrinkwrap.api.spec.WebArchive;\n+import org.junit.AfterClass;\n+import org.junit.Assert;\n+import org.junit.AssumptionViolatedException;\n+import org.junit.BeforeClass;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.rules.TestRule;\n+import org.junit.runner.Description;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.model.Statement;\n+import org.wildfly.security.auth.client.AuthenticationContext;\n+import org.wildfly.security.auth.client.ElytronXmlParser;\n+import org.wildfly.security.auth.client.InvalidAuthenticationConfigurationException;\n+import org.wildfly.test.integration.elytron.util.WelcomeContent;\n+import org.wildfly.test.security.common.AbstractElytronSetupTask;\n+import org.wildfly.test.security.common.elytron.ConfigurableElement;\n+import org.wildfly.test.security.common.elytron.CredentialReference;\n+import org.wildfly.test.security.common.elytron.Path;\n+import org.wildfly.test.security.common.elytron.SimpleKeyManager;\n+import org.wildfly.test.security.common.elytron.SimpleKeyStore;\n+import org.wildfly.test.security.common.elytron.SimpleServerSslContext;\n+import org.wildfly.test.security.common.elytron.SimpleTrustManager;\n+\n+/**\n+ * Smoke test for two way SSL connection with Undertow HTTPS listener backed by Elytron\n+ * server-ssl-context\n+ * with need-client-auth=true (client certificate is required) using SSLv2Hello.\n+ *\n+ * In case the client certificate is not trusted or present, the SSL handshake should fail.\n+ *\n+ * Additionally, smoke test for one way SSL connection with Undertow HTTPS listener\n+ * backed by Elytron server-ssl-context.\n+ *\n+ * @author Ondrej Kotek\n+ * @author Sonia Zaldana\n+ */\n+@RunWith(Arquillian.class)\n+@ServerSetup({ UndertowSSLv2HelloTestCase.ElytronSslContextInUndertowSetupTask.class, WelcomeContent.SetupTask.class})\n+@RunAsClient\n+public class UndertowSSLv2HelloTestCase {\n+\n+    private static final String NAME = UndertowTwoWaySslNeedClientAuthTestCase.class.getSimpleName();\n+    private static final File WORK_DIR = new File(\"target\" + File.separatorChar +  NAME);\n+    private static final File SERVER_KEYSTORE_FILE = new File(WORK_DIR, SecurityTestConstants.SERVER_KEYSTORE);\n+    private static final File SERVER_TRUSTSTORE_FILE = new File(WORK_DIR, SecurityTestConstants.SERVER_TRUSTSTORE);\n+    private static final String PASSWORD = SecurityTestConstants.KEYSTORE_PASSWORD;\n+    private static final String SSLV2HELLO_CONTEXT = \"SSLv2HelloContext\";\n+    private static final String DEFAULT_CONTEXT = \"DefaultContext\";\n+    private static final String SSLV2HELLO_CONTEXT_ONE_WAY = \"SSLv2HelloContextOneWay\";\n+    private static final String HTTPS = \"https\";\n+    private static URL securedRootUrl;\n+    public static String disabledAlgorithms;\n+\n+    @ClassRule\n+    public static IbmVerification ibmVerification =\n+            new IbmVerification(System.getProperty(\"java.vendor\").contains(\"IBM\"));", "originalCommit": "3dc8ba615b66712954719ae3047ef68270cd25e8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzUzNTc3Mw==", "url": "https://github.com/wildfly/wildfly/pull/13673#discussion_r647535773", "bodyText": "Added TestSuiteEnvironment.isIbmJvm() instead.", "author": "SoniaZaldana", "createdAt": "2021-06-08T15:07:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NzUwMDQ3MA=="}], "type": "inlineReview"}, {"oid": "96352b3629834af0e8e3d4d5e3f839a4e403ce12", "url": "https://github.com/wildfly/wildfly/commit/96352b3629834af0e8e3d4d5e3f839a4e403ce12", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T15:05:11Z", "type": "forcePushed"}, {"oid": "3712cefcf4a43c2790f8cb2a0baa6d1ca028b473", "url": "https://github.com/wildfly/wildfly/commit/3712cefcf4a43c2790f8cb2a0baa6d1ca028b473", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T15:21:11Z", "type": "forcePushed"}, {"oid": "6f3d9419851a2a080cff21a136e477713b93f848", "url": "https://github.com/wildfly/wildfly/commit/6f3d9419851a2a080cff21a136e477713b93f848", "message": "[WFLY-13916] Elytron server-ssl-context allowed protocols", "committedDate": "2021-06-08T17:41:29Z", "type": "commit"}, {"oid": "c59687d53c9aa5ccc390af612c102ff611488e55", "url": "https://github.com/wildfly/wildfly/commit/c59687d53c9aa5ccc390af612c102ff611488e55", "message": "[WFLY-14835] Add @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T17:41:29Z", "type": "commit"}, {"oid": "50f7d747183edb662647a975fac69dd63dd823f1", "url": "https://github.com/wildfly/wildfly/commit/50f7d747183edb662647a975fac69dd63dd823f1", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-08T17:41:29Z", "type": "forcePushed"}, {"oid": "d23461e57917395f730b8fd84ca5a8f4da322d64", "url": "https://github.com/wildfly/wildfly/commit/d23461e57917395f730b8fd84ca5a8f4da322d64", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-11T14:13:54Z", "type": "commit"}, {"oid": "d23461e57917395f730b8fd84ca5a8f4da322d64", "url": "https://github.com/wildfly/wildfly/commit/d23461e57917395f730b8fd84ca5a8f4da322d64", "message": "[WFLY-14834] Remove @Ignore annotation for UndertowSSLv2HelloTestCase", "committedDate": "2021-06-11T14:13:54Z", "type": "forcePushed"}]}