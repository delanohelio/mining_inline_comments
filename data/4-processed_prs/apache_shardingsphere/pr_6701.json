{"pr_number": 6701, "pr_title": "add ProxyDataSourceContextTest", "pr_createdAt": "2020-08-08T07:10:43Z", "pr_url": "https://github.com/apache/shardingsphere/pull/6701", "timeline": [{"oid": "e761c9455c47c67a8809d24031c4cf25eaa66277", "url": "https://github.com/apache/shardingsphere/commit/e761c9455c47c67a8809d24031c4cf25eaa66277", "message": "add ProxyDataSourceContextTest", "committedDate": "2020-08-08T07:06:45Z", "type": "commit"}, {"oid": "71a220cf5632db4c4e77b06b68c50e8a9b9d2c35", "url": "https://github.com/apache/shardingsphere/commit/71a220cf5632db4c4e77b06b68c50e8a9b9d2c35", "message": "add license", "committedDate": "2020-08-08T08:16:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQxOTkyNg==", "url": "https://github.com/apache/shardingsphere/pull/6701#discussion_r467419926", "bodyText": "Please do not add other dependency if unnecessary, the reason are:\n\nIt is better to use one mock framework\nIf we need add more mock framework, please add the notice and licenses too", "author": "terrymanu", "createdAt": "2020-08-08T09:29:02Z", "path": "shardingsphere-proxy/shardingsphere-proxy-backend/pom.xml", "diffHunk": "@@ -132,5 +132,18 @@\n             <artifactId>postgresql</artifactId>\n             <scope>runtime</scope>\n         </dependency>\n+\n+        <dependency>\n+            <groupId>org.powermock</groupId>\n+            <artifactId>powermock-module-junit4</artifactId>\n+            <version>1.7.4</version>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.powermock</groupId>\n+            <artifactId>powermock-api-mockito2</artifactId>\n+            <version>1.7.4</version>\n+            <scope>test</scope>\n+        </dependency>", "originalCommit": "71a220cf5632db4c4e77b06b68c50e8a9b9d2c35", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c59ce458123a84092da2f24ac1637f7bef3699d9", "url": "https://github.com/apache/shardingsphere/commit/c59ce458123a84092da2f24ac1637f7bef3699d9", "message": "remove powermock dependency", "committedDate": "2020-08-08T11:28:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2NDY2NA==", "url": "https://github.com/apache/shardingsphere/pull/6701#discussion_r467464664", "bodyText": "Please remove useless comment.\nInclude Javadoc, todo and fixme only in the comments.\nFYI: https://shardingsphere.apache.org/community/en/contribute/code-conduct/", "author": "terrymanu", "createdAt": "2020-08-08T13:23:22Z", "path": "shardingsphere-proxy/shardingsphere-proxy-backend/src/test/java/org/apache/shardingsphere/proxy/backend/schema/ProxyDataSourceContextTest.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.shardingsphere.proxy.backend.schema;\n+\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.apache.shardingsphere.infra.database.type.dialect.MySQLDatabaseType;\n+import org.apache.shardingsphere.infra.exception.ShardingSphereException;\n+import org.apache.shardingsphere.kernel.context.schema.DataSourceParameter;\n+import org.apache.shardingsphere.proxy.backend.communication.jdbc.datasource.JDBCRawBackendDataSourceFactory;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import java.lang.reflect.Field;\n+import java.lang.reflect.Modifier;\n+import java.util.HashMap;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+public class ProxyDataSourceContextTest {\n+\n+    @Test\n+    public void assertEmptySchemaDataSources() {\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        ProxyDataSourceContext proxyDataSourceContext = new ProxyDataSourceContext(schemaDataSources);\n+        assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+        assertTrue(proxyDataSourceContext.getDataSourcesMap().isEmpty());\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertWrongSchemaDataSources() {\n+        // schameName -- dataSourceName -- dataSource\n+        DataSourceParameter dataSourceParameter = new DataSourceParameter();\n+        dataSourceParameter.setUrl(\"jdbc11:mysql11:xxx\");\n+        Map<String, DataSourceParameter> dataSourceParameterMap = new LinkedHashMap<>();\n+        dataSourceParameterMap.put(\"order1\", dataSourceParameter);\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        schemaDataSources.put(\"order\", dataSourceParameterMap);\n+        new ProxyDataSourceContext(schemaDataSources);\n+        //assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertThrowByBuild() throws Exception {\n+        // schameName -- dataSourceName -- dataSource", "originalCommit": "c59ce458123a84092da2f24ac1637f7bef3699d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2NDY3NQ==", "url": "https://github.com/apache/shardingsphere/pull/6701#discussion_r467464675", "bodyText": "Please use static import for Mockito", "author": "terrymanu", "createdAt": "2020-08-08T13:23:39Z", "path": "shardingsphere-proxy/shardingsphere-proxy-backend/src/test/java/org/apache/shardingsphere/proxy/backend/schema/ProxyDataSourceContextTest.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.shardingsphere.proxy.backend.schema;\n+\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.apache.shardingsphere.infra.database.type.dialect.MySQLDatabaseType;\n+import org.apache.shardingsphere.infra.exception.ShardingSphereException;\n+import org.apache.shardingsphere.kernel.context.schema.DataSourceParameter;\n+import org.apache.shardingsphere.proxy.backend.communication.jdbc.datasource.JDBCRawBackendDataSourceFactory;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import java.lang.reflect.Field;\n+import java.lang.reflect.Modifier;\n+import java.util.HashMap;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+public class ProxyDataSourceContextTest {\n+\n+    @Test\n+    public void assertEmptySchemaDataSources() {\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        ProxyDataSourceContext proxyDataSourceContext = new ProxyDataSourceContext(schemaDataSources);\n+        assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+        assertTrue(proxyDataSourceContext.getDataSourcesMap().isEmpty());\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertWrongSchemaDataSources() {\n+        // schameName -- dataSourceName -- dataSource\n+        DataSourceParameter dataSourceParameter = new DataSourceParameter();\n+        dataSourceParameter.setUrl(\"jdbc11:mysql11:xxx\");\n+        Map<String, DataSourceParameter> dataSourceParameterMap = new LinkedHashMap<>();\n+        dataSourceParameterMap.put(\"order1\", dataSourceParameter);\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        schemaDataSources.put(\"order\", dataSourceParameterMap);\n+        new ProxyDataSourceContext(schemaDataSources);\n+        //assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertThrowByBuild() throws Exception {\n+        // schameName -- dataSourceName -- dataSource\n+        JDBCRawBackendDataSourceFactory jdbcRawBackendDataSourceFactory = Mockito.mock(JDBCRawBackendDataSourceFactory.class);\n+        Mockito.when(jdbcRawBackendDataSourceFactory.build(Mockito.anyString(), Mockito.any())).thenThrow(new ShardingSphereException(\"\"));", "originalCommit": "c59ce458123a84092da2f24ac1637f7bef3699d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2NDcxOA==", "url": "https://github.com/apache/shardingsphere/pull/6701#discussion_r467464718", "bodyText": "Please use assertThat and InstanceOf to assert", "author": "terrymanu", "createdAt": "2020-08-08T13:24:10Z", "path": "shardingsphere-proxy/shardingsphere-proxy-backend/src/test/java/org/apache/shardingsphere/proxy/backend/schema/ProxyDataSourceContextTest.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.shardingsphere.proxy.backend.schema;\n+\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.apache.shardingsphere.infra.database.type.dialect.MySQLDatabaseType;\n+import org.apache.shardingsphere.infra.exception.ShardingSphereException;\n+import org.apache.shardingsphere.kernel.context.schema.DataSourceParameter;\n+import org.apache.shardingsphere.proxy.backend.communication.jdbc.datasource.JDBCRawBackendDataSourceFactory;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import java.lang.reflect.Field;\n+import java.lang.reflect.Modifier;\n+import java.util.HashMap;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+public class ProxyDataSourceContextTest {\n+\n+    @Test\n+    public void assertEmptySchemaDataSources() {\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        ProxyDataSourceContext proxyDataSourceContext = new ProxyDataSourceContext(schemaDataSources);\n+        assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+        assertTrue(proxyDataSourceContext.getDataSourcesMap().isEmpty());\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertWrongSchemaDataSources() {\n+        // schameName -- dataSourceName -- dataSource\n+        DataSourceParameter dataSourceParameter = new DataSourceParameter();\n+        dataSourceParameter.setUrl(\"jdbc11:mysql11:xxx\");\n+        Map<String, DataSourceParameter> dataSourceParameterMap = new LinkedHashMap<>();\n+        dataSourceParameterMap.put(\"order1\", dataSourceParameter);\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        schemaDataSources.put(\"order\", dataSourceParameterMap);\n+        new ProxyDataSourceContext(schemaDataSources);\n+        //assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertThrowByBuild() throws Exception {\n+        // schameName -- dataSourceName -- dataSource\n+        JDBCRawBackendDataSourceFactory jdbcRawBackendDataSourceFactory = Mockito.mock(JDBCRawBackendDataSourceFactory.class);\n+        Mockito.when(jdbcRawBackendDataSourceFactory.build(Mockito.anyString(), Mockito.any())).thenThrow(new ShardingSphereException(\"\"));\n+        build(jdbcRawBackendDataSourceFactory);\n+        Mockito.reset(jdbcRawBackendDataSourceFactory);\n+    }\n+\n+    @Test\n+    public void assertRightMysqlSchemaDataSources() throws Exception {\n+        // schameName -- dataSourceName -- dataSource\n+        JDBCRawBackendDataSourceFactory jdbcRawBackendDataSourceFactory = Mockito.mock(JDBCRawBackendDataSourceFactory.class);\n+        Mockito.when(jdbcRawBackendDataSourceFactory.build(Mockito.anyString(), Mockito.any())).thenReturn(new HikariDataSource());\n+        ProxyDataSourceContext proxyDataSourceContext = build(jdbcRawBackendDataSourceFactory);\n+        assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);", "originalCommit": "c59ce458123a84092da2f24ac1637f7bef3699d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2NDc1Nw==", "url": "https://github.com/apache/shardingsphere/pull/6701#discussion_r467464757", "bodyText": "Please remove useless blank line", "author": "terrymanu", "createdAt": "2020-08-08T13:24:25Z", "path": "shardingsphere-proxy/shardingsphere-proxy-backend/src/test/java/org/apache/shardingsphere/proxy/backend/schema/ProxyDataSourceContextTest.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.shardingsphere.proxy.backend.schema;\n+\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.apache.shardingsphere.infra.database.type.dialect.MySQLDatabaseType;\n+import org.apache.shardingsphere.infra.exception.ShardingSphereException;\n+import org.apache.shardingsphere.kernel.context.schema.DataSourceParameter;\n+import org.apache.shardingsphere.proxy.backend.communication.jdbc.datasource.JDBCRawBackendDataSourceFactory;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import java.lang.reflect.Field;\n+import java.lang.reflect.Modifier;\n+import java.util.HashMap;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+public class ProxyDataSourceContextTest {\n+\n+    @Test\n+    public void assertEmptySchemaDataSources() {\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        ProxyDataSourceContext proxyDataSourceContext = new ProxyDataSourceContext(schemaDataSources);\n+        assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+        assertTrue(proxyDataSourceContext.getDataSourcesMap().isEmpty());\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertWrongSchemaDataSources() {\n+        // schameName -- dataSourceName -- dataSource\n+        DataSourceParameter dataSourceParameter = new DataSourceParameter();\n+        dataSourceParameter.setUrl(\"jdbc11:mysql11:xxx\");\n+        Map<String, DataSourceParameter> dataSourceParameterMap = new LinkedHashMap<>();\n+        dataSourceParameterMap.put(\"order1\", dataSourceParameter);\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        schemaDataSources.put(\"order\", dataSourceParameterMap);\n+        new ProxyDataSourceContext(schemaDataSources);\n+        //assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertThrowByBuild() throws Exception {\n+        // schameName -- dataSourceName -- dataSource\n+        JDBCRawBackendDataSourceFactory jdbcRawBackendDataSourceFactory = Mockito.mock(JDBCRawBackendDataSourceFactory.class);\n+        Mockito.when(jdbcRawBackendDataSourceFactory.build(Mockito.anyString(), Mockito.any())).thenThrow(new ShardingSphereException(\"\"));\n+        build(jdbcRawBackendDataSourceFactory);\n+        Mockito.reset(jdbcRawBackendDataSourceFactory);\n+    }\n+\n+    @Test\n+    public void assertRightMysqlSchemaDataSources() throws Exception {\n+        // schameName -- dataSourceName -- dataSource\n+        JDBCRawBackendDataSourceFactory jdbcRawBackendDataSourceFactory = Mockito.mock(JDBCRawBackendDataSourceFactory.class);\n+        Mockito.when(jdbcRawBackendDataSourceFactory.build(Mockito.anyString(), Mockito.any())).thenReturn(new HikariDataSource());\n+        ProxyDataSourceContext proxyDataSourceContext = build(jdbcRawBackendDataSourceFactory);\n+        assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+        assertTrue(proxyDataSourceContext.getDataSourcesMap().size() == 1);\n+        Mockito.reset(jdbcRawBackendDataSourceFactory);\n+    }\n+\n+    private ProxyDataSourceContext build(final JDBCRawBackendDataSourceFactory jdbcRawBackendDataSourceFactory) throws Exception {\n+        JDBCRawBackendDataSourceFactory jdbcBackendDataSourceFactory = (JDBCRawBackendDataSourceFactory) JDBCRawBackendDataSourceFactory.getInstance();\n+        Class<?> jdbcBackendDataSourceFactoryClass = jdbcBackendDataSourceFactory.getClass();\n+        Field field = jdbcBackendDataSourceFactoryClass.getDeclaredField(\"INSTANCE\");\n+        Field modifiers = field.getClass().getDeclaredField(\"modifiers\");\n+        modifiers.setAccessible(true);\n+        modifiers.setInt(field, field.getModifiers() & ~Modifier.FINAL);\n+        field.setAccessible(true);\n+        field.set(field, jdbcRawBackendDataSourceFactory);\n+", "originalCommit": "c59ce458123a84092da2f24ac1637f7bef3699d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2NDc4Mg==", "url": "https://github.com/apache/shardingsphere/pull/6701#discussion_r467464782", "bodyText": "Please do not leave the comment codes", "author": "terrymanu", "createdAt": "2020-08-08T13:24:52Z", "path": "shardingsphere-proxy/shardingsphere-proxy-backend/src/test/java/org/apache/shardingsphere/proxy/backend/schema/ProxyDataSourceContextTest.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.shardingsphere.proxy.backend.schema;\n+\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.apache.shardingsphere.infra.database.type.dialect.MySQLDatabaseType;\n+import org.apache.shardingsphere.infra.exception.ShardingSphereException;\n+import org.apache.shardingsphere.kernel.context.schema.DataSourceParameter;\n+import org.apache.shardingsphere.proxy.backend.communication.jdbc.datasource.JDBCRawBackendDataSourceFactory;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import java.lang.reflect.Field;\n+import java.lang.reflect.Modifier;\n+import java.util.HashMap;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+public class ProxyDataSourceContextTest {\n+\n+    @Test\n+    public void assertEmptySchemaDataSources() {\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        ProxyDataSourceContext proxyDataSourceContext = new ProxyDataSourceContext(schemaDataSources);\n+        assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);\n+        assertTrue(proxyDataSourceContext.getDataSourcesMap().isEmpty());\n+    }\n+\n+    @Test(expected = ShardingSphereException.class)\n+    public void assertWrongSchemaDataSources() {\n+        // schameName -- dataSourceName -- dataSource\n+        DataSourceParameter dataSourceParameter = new DataSourceParameter();\n+        dataSourceParameter.setUrl(\"jdbc11:mysql11:xxx\");\n+        Map<String, DataSourceParameter> dataSourceParameterMap = new LinkedHashMap<>();\n+        dataSourceParameterMap.put(\"order1\", dataSourceParameter);\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        schemaDataSources.put(\"order\", dataSourceParameterMap);\n+        new ProxyDataSourceContext(schemaDataSources);\n+        //assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);", "originalCommit": "c59ce458123a84092da2f24ac1637f7bef3699d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2NDgzNw==", "url": "https://github.com/apache/shardingsphere/pull/6701#discussion_r467464837", "bodyText": "Please use assertThat and InstanceOf to assert", "author": "terrymanu", "createdAt": "2020-08-08T13:25:15Z", "path": "shardingsphere-proxy/shardingsphere-proxy-backend/src/test/java/org/apache/shardingsphere/proxy/backend/schema/ProxyDataSourceContextTest.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.shardingsphere.proxy.backend.schema;\n+\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.apache.shardingsphere.infra.database.type.dialect.MySQLDatabaseType;\n+import org.apache.shardingsphere.infra.exception.ShardingSphereException;\n+import org.apache.shardingsphere.kernel.context.schema.DataSourceParameter;\n+import org.apache.shardingsphere.proxy.backend.communication.jdbc.datasource.JDBCRawBackendDataSourceFactory;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import java.lang.reflect.Field;\n+import java.lang.reflect.Modifier;\n+import java.util.HashMap;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+public class ProxyDataSourceContextTest {\n+\n+    @Test\n+    public void assertEmptySchemaDataSources() {\n+        Map<String, Map<String, DataSourceParameter>> schemaDataSources = new HashMap<>();\n+        ProxyDataSourceContext proxyDataSourceContext = new ProxyDataSourceContext(schemaDataSources);\n+        assertTrue(proxyDataSourceContext.getDatabaseType() instanceof MySQLDatabaseType);", "originalCommit": "c59ce458123a84092da2f24ac1637f7bef3699d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ2NDg2OQ==", "url": "https://github.com/apache/shardingsphere/pull/6701#discussion_r467464869", "bodyText": "Please add final if the class is not design for extension", "author": "terrymanu", "createdAt": "2020-08-08T13:25:37Z", "path": "shardingsphere-proxy/shardingsphere-proxy-backend/src/test/java/org/apache/shardingsphere/proxy/backend/schema/ProxyDataSourceContextTest.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.shardingsphere.proxy.backend.schema;\n+\n+import com.zaxxer.hikari.HikariDataSource;\n+import org.apache.shardingsphere.infra.database.type.dialect.MySQLDatabaseType;\n+import org.apache.shardingsphere.infra.exception.ShardingSphereException;\n+import org.apache.shardingsphere.kernel.context.schema.DataSourceParameter;\n+import org.apache.shardingsphere.proxy.backend.communication.jdbc.datasource.JDBCRawBackendDataSourceFactory;\n+import org.junit.Test;\n+import org.mockito.Mockito;\n+\n+import java.lang.reflect.Field;\n+import java.lang.reflect.Modifier;\n+import java.util.HashMap;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n+\n+import static org.junit.Assert.assertTrue;\n+\n+public class ProxyDataSourceContextTest {", "originalCommit": "c59ce458123a84092da2f24ac1637f7bef3699d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "70b4a872d357d2b5ba297a662514a3eb3fc8d99c", "url": "https://github.com/apache/shardingsphere/commit/70b4a872d357d2b5ba297a662514a3eb3fc8d99c", "message": "remove comment, Mockito static import ,use assertThat and InstanceOf to assert, remove useless blank line, add final for class", "committedDate": "2020-08-08T14:26:23Z", "type": "commit"}]}