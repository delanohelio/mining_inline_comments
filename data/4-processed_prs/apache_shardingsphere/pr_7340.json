{"pr_number": 7340, "pr_title": "Fix create table if not exists pre validation error", "pr_createdAt": "2020-09-09T03:47:54Z", "pr_url": "https://github.com/apache/shardingsphere/pull/7340", "timeline": [{"oid": "3ba77b3c146d7833c280ce7da415a500acdf0816", "url": "https://github.com/apache/shardingsphere/commit/3ba77b3c146d7833c280ce7da415a500acdf0816", "message": "Fix create table if not exists pre validation error. ignore validation when use this", "committedDate": "2020-09-09T03:45:27Z", "type": "commit"}, {"oid": "f38ade6046c033e427790f31f349b94268473b76", "url": "https://github.com/apache/shardingsphere/commit/f38ade6046c033e427790f31f349b94268473b76", "message": "fix check style", "committedDate": "2020-09-09T04:13:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM1ODAwMQ==", "url": "https://github.com/apache/shardingsphere/pull/7340#discussion_r485358001", "bodyText": "Do you think null != ctx.notExistClause_() is enough?", "author": "tristaZero", "createdAt": "2020-09-09T06:03:44Z", "path": "shardingsphere-sql-parser/shardingsphere-sql-parser-dialect/shardingsphere-sql-parser-mysql/src/main/java/org/apache/shardingsphere/sql/parser/mysql/visitor/impl/MySQLDDLVisitor.java", "diffHunk": "@@ -166,7 +166,7 @@ public ASTNode visitRenameTableSpecification(final RenameTableSpecificationConte\n     @SuppressWarnings(\"unchecked\")\n     @Override\n     public ASTNode visitCreateTable(final CreateTableContext ctx) {\n-        CreateTableStatement result = new CreateTableStatement((SimpleTableSegment) visit(ctx.tableName()));\n+        CreateTableStatement result = new CreateTableStatement((SimpleTableSegment) visit(ctx.tableName()), null != ctx.notExistClause_().EXISTS());", "originalCommit": "f38ade6046c033e427790f31f349b94268473b76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM2MTE3Nw==", "url": "https://github.com/apache/shardingsphere/pull/7340#discussion_r485361177", "bodyText": "No,  it will return an Empty notExistClause*Context, it's EXISTS() method will return null", "author": "xbkaishui", "createdAt": "2020-09-09T06:12:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM1ODAwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ1MDc1OA==", "url": "https://github.com/apache/shardingsphere/pull/7340#discussion_r485450758", "bodyText": "Have you ever gave it a try? Since the following null != ctx.createDefinitionClause() uses the same method. Is there any difference?", "author": "tristaZero", "createdAt": "2020-09-09T08:56:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM1ODAwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTQ3MTA5Nw==", "url": "https://github.com/apache/shardingsphere/pull/7340#discussion_r485471097", "bodyText": "Yes, I tested and debug it in my local env.", "author": "xbkaishui", "createdAt": "2020-09-09T09:26:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM1ODAwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM1ODg2NQ==", "url": "https://github.com/apache/shardingsphere/pull/7340#discussion_r485358865", "bodyText": "PostgreSQL has the similar SQL as well.", "author": "tristaZero", "createdAt": "2020-09-09T06:06:16Z", "path": "shardingsphere-sql-parser/shardingsphere-sql-parser-dialect/shardingsphere-sql-parser-postgresql/src/main/java/org/apache/shardingsphere/sql/parser/postgresql/visitor/impl/PostgreSQLDDLVisitor.java", "diffHunk": "@@ -96,7 +96,7 @@\n     @SuppressWarnings(\"unchecked\")\n     @Override\n     public ASTNode visitCreateTable(final CreateTableContext ctx) {\n-        CreateTableStatement result = new CreateTableStatement((SimpleTableSegment) visit(ctx.tableName()));\n+        CreateTableStatement result = new CreateTableStatement((SimpleTableSegment) visit(ctx.tableName()), false);", "originalCommit": "f38ade6046c033e427790f31f349b94268473b76", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM2MzAxOQ==", "url": "https://github.com/apache/shardingsphere/pull/7340#discussion_r485363019", "bodyText": "ok will check", "author": "xbkaishui", "createdAt": "2020-09-09T06:17:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM1ODg2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM3NzExMw==", "url": "https://github.com/apache/shardingsphere/pull/7340#discussion_r485377113", "bodyText": "done", "author": "xbkaishui", "createdAt": "2020-09-09T06:49:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM1ODg2NQ=="}], "type": "inlineReview"}, {"oid": "ce071a15fab4a61315ea59a74236579b340d6140", "url": "https://github.com/apache/shardingsphere/commit/ce071a15fab4a61315ea59a74236579b340d6140", "message": "support pg create table not exists", "committedDate": "2020-09-09T06:42:31Z", "type": "commit"}, {"oid": "2ccda97436e47e6ff16c6803b355a6788cb4f74b", "url": "https://github.com/apache/shardingsphere/commit/2ccda97436e47e6ff16c6803b355a6788cb4f74b", "message": "merge master", "committedDate": "2020-09-09T06:48:43Z", "type": "commit"}, {"oid": "c8af6107880ccf6b332bf4b704de0e318230b46f", "url": "https://github.com/apache/shardingsphere/commit/c8af6107880ccf6b332bf4b704de0e318230b46f", "message": "Refactor, move ? from notExistClause_ and existClause_ to the position where they are used", "committedDate": "2020-09-10T03:50:49Z", "type": "commit"}]}