{"pr_number": 8272, "pr_title": "Swagger 2 and OAS 3 parameter edit and Ref rendering support", "pr_createdAt": "2020-02-29T12:30:56Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8272", "timeline": [{"oid": "75c55a58bb685437a5b7fa4ead90a886ee6b5038", "url": "https://github.com/wso2/carbon-apimgt/commit/75c55a58bb685437a5b7fa4ead90a886ee6b5038", "message": "Refactor Add parameter component.", "committedDate": "2020-03-03T09:21:42Z", "type": "commit"}, {"oid": "955785c981246cc75a8e4e577501e5a33d5d62ff", "url": "https://github.com/wso2/carbon-apimgt/commit/955785c981246cc75a8e4e577501e5a33d5d62ff", "message": "Add Edit Parameter action for OAS 2.0 and 3.x\n\n* Enable Parameter Edit.\n* Fix issues in Parameter Add operation.", "committedDate": "2020-03-03T09:21:42Z", "type": "commit"}, {"oid": "af04bf54fbaf4172bf411a7bbaff7b382c89ba12", "url": "https://github.com/wso2/carbon-apimgt/commit/af04bf54fbaf4172bf411a7bbaff7b382c89ba12", "message": "Add i18n for Resource Components.", "committedDate": "2020-03-03T09:21:42Z", "type": "commit"}, {"oid": "3ce2c37fde2c4fb717c71ce172d61a19e868cd2d", "url": "https://github.com/wso2/carbon-apimgt/commit/3ce2c37fde2c4fb717c71ce172d61a19e868cd2d", "message": "Add support for Refs in parameters.", "committedDate": "2020-03-03T09:22:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzAzNDQ2Mw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387034463", "bodyText": "Why we put passed errors into an array ?", "author": "tmkasun", "createdAt": "2020-03-03T13:56:55Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/Resources.jsx", "diffHunk": "@@ -228,18 +250,28 @@ export default function Resources(props) {\n     );\n     /**\n      *\n-     *\n-     * @param {*} response\n-     * @returns\n+     * @param {*} rawSpec The original swagger content.\n+     * @returns {null}\n      */\n     function resolveAndUpdateSpec(rawSpec) {\n-        // return Swagger.resolve({ spec: rawSpec, allowMetaPatches: false }).then(({ spec, errors }) => {\n-        //     const value = spec;\n-        //     delete value.$$normalized;\n-        //     operationsDispatcher({ action: 'init', data: value.paths });\n-        //     setOpenAPISpec(value);\n-        //     setSpecErrors(errors);\n-        // });\n+        /*\n+         * Deep copying the spec.\n+         * Otherwise it will resolved to the original parameter passed (rawSpec) to the validate method.\n+         * We will not alter the provided spec.\n+         */\n+        const specCopy = cloneDeep(rawSpec);\n+        /*\n+        * Used SwaggerParser.validate() because we can get the errors as well.\n+        */\n+        SwaggerParser.validate(specCopy, (err, result) => {\n+            setResolvedSpec(() => {\n+                const errors = err ? [err] : [];", "originalCommit": "3ce2c37fde2c4fb717c71ce172d61a19e868cd2d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzAzNTY4MA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387035680", "bodyText": "Shall we check whether react-intl library provides a hook to inject these into props, AFAIR back then they discussed to provide a react hook instead of this HOC", "author": "tmkasun", "createdAt": "2020-03-03T13:58:45Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/AddOperation.jsx", "diffHunk": "@@ -319,4 +328,4 @@ AddOperation.propTypes = {\n     operationsDispatcher: PropTypes.func.isRequired,\n };\n \n-export default React.memo(AddOperation);\n+export default React.memo(injectIntl(AddOperation));", "originalCommit": "3ce2c37fde2c4fb717c71ce172d61a19e868cd2d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3ODgwNA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387178804", "bodyText": "I think they have included it since react v16.3.\nhttps://github.com/formatjs/react-intl/blob/master/docs/Upgrade-Guide.md#new-useintl-hook-as-an-alternative-of-injectintl-hoc\nWill check.", "author": "menakaj", "createdAt": "2020-03-03T17:29:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzAzNTY4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ3NDcwNg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387474706", "bodyText": "d62db21", "author": "menakaj", "createdAt": "2020-03-04T06:44:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzAzNTY4MA=="}], "type": "inlineReview"}, {"oid": "d62db219d1ca80d6d81986e375db039236ef5da1", "url": "https://github.com/wso2/carbon-apimgt/commit/d62db219d1ca80d6d81986e375db039236ef5da1", "message": "Remove injectIntl and use 'useIntl'", "committedDate": "2020-03-04T06:39:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgyMjEwOA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387822108", "bodyText": "@menakaj Why we need a util function for this conditional ternary operator ? is it to get away with eslint warning ?", "author": "tmkasun", "createdAt": "2020-03-04T17:32:29Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/operationComponents/parameterUtils.js", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied. See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+\n+/**\n+ * Defining the supported data types by the OAS spec versions.\n+ *\n+ * 2.0 : https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#dataTypeFormat\n+ * 3.x :https://swagger.io/docs/specification/data-models/data-types/\n+ * */\n+const supportedDataTypes = {\n+    '2.0': {\n+        body: ['integer', 'number', 'string', 'boolean', 'object'],\n+        formData: ['integer', 'number', 'string', 'boolean', 'file'],\n+        query: ['integer', 'number', 'string', 'boolean'],\n+        path: ['integer', 'number', 'string', 'boolean'],\n+        header: ['integer', 'number', 'string', 'boolean'],\n+    },\n+    '3.x': {\n+        body: ['integer', 'number', 'string', 'boolean', 'object'],\n+        query: ['integer', 'number', 'string', 'boolean'],\n+        path: ['integer', 'number', 'string', 'boolean'],\n+        header: ['integer', 'number', 'string', 'boolean'],\n+        cookie: ['integer', 'number', 'string', 'boolean'],\n+    },\n+};\n+\n+/**\n+ * Util method for checking conditions.\n+ *\n+ * @param {boolean} condition : The condition to be checked\n+ * @param {any} matched : The value to be returned if the condition is true\n+ * @param {any} otherwise : The value to be returned if the condition is false.\n+ * @return {object} If true -> matched, false -> otherwise\n+ * */\n+export function iff(condition, matched, otherwise) {", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgyNTY4Mg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387825682", "bodyText": "Why we check for nextParameter.schema in here and if it's not available directly assign value to nextParameter[action] ? is it because of a difference in Swagger/OAS spec versions", "author": "tmkasun", "createdAt": "2020-03-04T17:38:55Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/operationComponents/EditParameter.jsx", "diffHunk": "@@ -72,13 +77,21 @@ export default function EditParameter(props) {\n      */\n     function parameterActionReducer(currentParameter, paramAction) {\n         const { action, value } = paramAction;\n-        const nextParameter = { ...currentParameter, schema: { ...currentParameter.schema } };\n+        const nextParameter = currentParameter.schema\n+            ? { ...currentParameter, schema: { ...currentParameter.schema } } : { ...currentParameter };\n         switch (action) {\n             case 'description':\n             case 'required':\n                 nextParameter[action] = value;\n                 break;\n-\n+            case 'type':\n+            case 'format':\n+                if (nextParameter.schema) {", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgyNjg3Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387826877", "bodyText": "When do we get parameter properties outside a schema", "author": "tmkasun", "createdAt": "2020-03-04T17:41:07Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/operationComponents/EditParameter.jsx", "diffHunk": "@@ -181,22 +216,50 @@ export default function EditParameter(props) {\n                                     },\n                                 }}\n                             >\n-                                {['number', 'integer'].map((dataType) => (\n+                                {getSupportedDataTypes(version, parameter.in).map((dataType) => (\n                                     <MenuItem value={dataType} dense>\n                                         {capitalizeFirstLetter(dataType)}\n                                     </MenuItem>\n                                 ))}\n                             </Select>\n-                            <FormHelperText>Select schema type</FormHelperText>\n+                            <FormHelperText>\n+                                <FormattedMessage\n+                                    id={'Apis.Details.Resources.components.operationComponents.EditParameter.'\n+                                    + 'select.schema.data.type'}\n+                                    defaultMessage='Select the Schema Type'\n+                                />\n+                            </FormHelperText>\n                         </FormControl>\n                     </Grid>\n                     <Grid item md={6}>\n-                        <FormControl fullWidth margin='dense' variant='outlined' className={classes.formControl}>\n-                            <InputLabel htmlFor='edit-parameter-format'>Format</InputLabel>\n+                        <FormControl\n+                            fullWidth\n+                            margin='dense'\n+                            variant='outlined'\n+                            className={classes.formControl}\n+                            disabled={parameter.schema\n+                                ? iff(\n+                                    parameter.schema.type === 'boolean' || parameter.schema.type === 'object',\n+                                    true,\n+                                    false,\n+                                )\n+                                : iff(", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg0NTY1Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387845657", "bodyText": "in swagger 2.0 the type can be in the root level of the parameter object.", "author": "menakaj", "createdAt": "2020-03-04T18:16:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgyNjg3Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgyOTQ0OA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387829448", "bodyText": "Can we rely on index here , will it be always the same in the raw definition param array index and parsed definition params array index ? what if we find by param name ?", "author": "tmkasun", "createdAt": "2020-03-04T17:45:55Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/operationComponents/ListParameters.jsx", "diffHunk": "@@ -64,106 +67,158 @@ export default function ListParameters(props) {\n                     verb={verb}\n                     editingParameter={editingParameter}\n                     setEditingParameter={setEditingParameter}\n+                    version={specVersion}\n                 />\n             )}\n             <Table className={classes.table} aria-label='parameters list'>\n                 <TableHead>\n                     <TableRow>\n-                        <TableCell>Name</TableCell>\n-                        <TableCell align='left'>Parameter Type</TableCell>\n-                        <TableCell align='left'>Data Type</TableCell>\n-                        <TableCell align='left'>Required</TableCell>\n-                        {!disableUpdate && <TableCell align='left'>Actions</TableCell>}\n+                        <TableCell align='left'>\n+                            <FormattedMessage\n+                                id='Apis.Details.Resources.components.operationComponents.ListParameter.parameter.type'\n+                                defaultMessage='Parameter Type'\n+                            />\n+                        </TableCell>\n+                        <TableCell>\n+                            <FormattedMessage\n+                                id='Apis.Details.Resources.components.operationComponents.ListParameter.parameter.name'\n+                                defaultMessage='Name'\n+                            />\n+                        </TableCell>\n+                        <TableCell align='left'>\n+                            <FormattedMessage\n+                                id='Apis.Details.Resources.components.operationComponents.ListParameter.data.type'\n+                                defaultMessage='Data Type'\n+                            />\n+                        </TableCell>\n+                        <TableCell align='left'>\n+                            <FormattedMessage\n+                                id='Apis.Details.Resources.components.operationComponents.ListParameter.required'\n+                                defaultMessage='Required'\n+                            />\n+                        </TableCell>\n+                        {!disableUpdate && (\n+                            <TableCell align='left'>\n+                                <FormattedMessage\n+                                    id='Apis.Details.Resources.components.operationComponents.ListParameter.actions'\n+                                    defaultMessage='Actions'\n+                                />\n+                            </TableCell>\n+                        )}\n                     </TableRow>\n                 </TableHead>\n                 <TableBody>\n                     {operation.parameters\n-                        && operation.parameters.map((parameter) => (\n-                            <TableRow key={parameter.name}>\n-                                <TableCell align='left'>{parameter.name}</TableCell>\n-                                <TableCell align='left'>{capitalizeFirstLetter(parameter.in)}</TableCell>\n-                                <TableCell align='left'>\n-                                    {capitalizeFirstLetter(parameter.schema ? parameter.schema.type : parameter.type)}\n-                                </TableCell>\n-                                <TableCell align='left'>{parameter.required ? 'Yes' : 'No'}</TableCell>\n-                                {!disableUpdate && (\n+                        && operation.parameters.map((parameter, index) => {\n+                            const isRefParam = isRef(parameter);\n+                            const paramCopy = isRefParam\n+                                ? resolvedSpec.paths[target][verb].parameters[index] : parameter;", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg0NzgwNA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387847804", "bodyText": "Some times, the whole parameter object can be put as a ref. There we cannot find any information.\nparameters:\n- $ref: '#/definitions/query'\n- $ref: '#/definitions/path'", "author": "menakaj", "createdAt": "2020-03-04T18:20:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgyOTQ0OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzMjk1OA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387832958", "bodyText": "I think we are repeating the same thing here, Shall we resolve the requestBody content in prior to the return statement and pass the content array to RequestBody component so that repetitive work like\n<RequestBody\n                                        contentType={contentType}\n                                        content={content}\n                                        operation={operation}\n                                        disableUpdate={disableUpdate}\n                                        hideParameterEdit={hideParameterEdit}\n                                        operationsDispatcher={operationsDispatcher}\n                                        target={target}\n                                        verb={verb}\n                                    />\n\nand\nrequestBody.content).map(\n                            ([contentType, content]) => {\n\ncan be avoided ,\nafter getting the requestBody content either from a $ref or inline , the content structure is same", "author": "tmkasun", "createdAt": "2020-03-04T17:52:23Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/operationComponents/ListParameters.jsx", "diffHunk": "@@ -64,106 +67,158 @@ export default function ListParameters(props) {\n                     verb={verb}\n                     editingParameter={editingParameter}\n                     setEditingParameter={setEditingParameter}\n+                    version={specVersion}\n                 />\n             )}\n             <Table className={classes.table} aria-label='parameters list'>\n                 <TableHead>\n                     <TableRow>\n-                        <TableCell>Name</TableCell>\n-                        <TableCell align='left'>Parameter Type</TableCell>\n-                        <TableCell align='left'>Data Type</TableCell>\n-                        <TableCell align='left'>Required</TableCell>\n-                        {!disableUpdate && <TableCell align='left'>Actions</TableCell>}\n+                        <TableCell align='left'>\n+                            <FormattedMessage\n+                                id='Apis.Details.Resources.components.operationComponents.ListParameter.parameter.type'\n+                                defaultMessage='Parameter Type'\n+                            />\n+                        </TableCell>\n+                        <TableCell>\n+                            <FormattedMessage\n+                                id='Apis.Details.Resources.components.operationComponents.ListParameter.parameter.name'\n+                                defaultMessage='Name'\n+                            />\n+                        </TableCell>\n+                        <TableCell align='left'>\n+                            <FormattedMessage\n+                                id='Apis.Details.Resources.components.operationComponents.ListParameter.data.type'\n+                                defaultMessage='Data Type'\n+                            />\n+                        </TableCell>\n+                        <TableCell align='left'>\n+                            <FormattedMessage\n+                                id='Apis.Details.Resources.components.operationComponents.ListParameter.required'\n+                                defaultMessage='Required'\n+                            />\n+                        </TableCell>\n+                        {!disableUpdate && (\n+                            <TableCell align='left'>\n+                                <FormattedMessage\n+                                    id='Apis.Details.Resources.components.operationComponents.ListParameter.actions'\n+                                    defaultMessage='Actions'\n+                                />\n+                            </TableCell>\n+                        )}\n                     </TableRow>\n                 </TableHead>\n                 <TableBody>\n                     {operation.parameters\n-                        && operation.parameters.map((parameter) => (\n-                            <TableRow key={parameter.name}>\n-                                <TableCell align='left'>{parameter.name}</TableCell>\n-                                <TableCell align='left'>{capitalizeFirstLetter(parameter.in)}</TableCell>\n-                                <TableCell align='left'>\n-                                    {capitalizeFirstLetter(parameter.schema ? parameter.schema.type : parameter.type)}\n-                                </TableCell>\n-                                <TableCell align='left'>{parameter.required ? 'Yes' : 'No'}</TableCell>\n-                                {!disableUpdate && (\n+                        && operation.parameters.map((parameter, index) => {\n+                            const isRefParam = isRef(parameter);\n+                            const paramCopy = isRefParam\n+                                ? resolvedSpec.paths[target][verb].parameters[index] : parameter;\n+                            return (\n+                                <TableRow key={paramCopy.name}>\n+                                    <TableCell align='left'>{capitalizeFirstLetter(paramCopy.in)}</TableCell>\n+                                    <TableCell align='left'>{paramCopy.name}</TableCell>\n                                     <TableCell align='left'>\n-                                        {!hideParameterEdit && (\n-                                            <Tooltip title='Edit'>\n+                                        {capitalizeFirstLetter(paramCopy.schema\n+                                            ? paramCopy.schema.type : paramCopy.type)}\n+                                    </TableCell>\n+                                    <TableCell align='left'>\n+                                        {paramCopy.required\n+                                            ? (\n+                                                <FormattedMessage\n+                                                    id={'Apis.Details.Resources.components.operationComponents'\n+                                                + '.ListParameter.yes'}\n+                                                    defaultMessage='Yes'\n+                                                />\n+                                            )\n+                                            : (\n+                                                <FormattedMessage\n+                                                    id={'Apis.Details.Resources.components.operationComponents'\n+                                                + '.ListParameter.no'}\n+                                                    defaultMessage='No'\n+                                                />\n+                                            )}\n+                                    </TableCell>\n+                                    {!disableUpdate && (\n+                                        <TableCell align='left'>\n+                                            {!isRefParam && (\n+                                                <Tooltip title={(\n+                                                    <FormattedMessage\n+                                                        id={'Apis.Details.Resources.components.operationComponents.'\n+                                                    + 'ListParameter.edit'}\n+                                                        defaultMessage='Edit'\n+                                                    />\n+                                                )}\n+                                                >\n+                                                    <IconButton\n+                                                        onClick={() => setEditingParameter(parameter)}\n+                                                        fontSize='small'\n+                                                    >\n+                                                        <EditIcon fontSize='small' />\n+                                                    </IconButton>\n+                                                </Tooltip>\n+                                            )}\n+                                            <Tooltip title={(\n+                                                <FormattedMessage\n+                                                    id={'Apis.Details.Resources.components.operationComponents'\n+                                                + '.ListParameter.delete'}\n+                                                    defaultMessage='Delete'\n+                                                />\n+                                            )}\n+                                            >\n                                                 <IconButton\n-                                                    onClick={() => setEditingParameter(parameter)}\n+                                                    disabled={disableUpdate}\n+                                                    onClick={() => operationsDispatcher({\n+                                                        action: 'deleteParameter',\n+                                                        data: { target, verb, value: paramCopy },\n+                                                    })}\n                                                     fontSize='small'\n                                                 >\n-                                                    <EditIcon fontSize='small' />\n-                                                </IconButton>\n-                                            </Tooltip>\n-                                        )}\n-                                        <Tooltip title='Delete'>\n-                                            <IconButton\n-                                                disabled={disableUpdate}\n-                                                onClick={() => operationsDispatcher({\n-                                                    action: 'deleteParameter',\n-                                                    data: { target, verb, value: parameter },\n-                                                })}\n-                                                fontSize='small'\n-                                            >\n-                                                <DeleteIcon fontSize='small' />\n-                                            </IconButton>\n-                                        </Tooltip>\n-                                    </TableCell>\n-                                )}\n-                            </TableRow>\n-                        ))}\n-                    {operation.requestBody\n-                        && Object.entries(operation.requestBody.content).map(([contentType, content]) => (\n-                            <TableRow key={contentType}>\n-                                <TableCell>{contentType}</TableCell>\n-                                <TableCell align='left'>Body</TableCell>\n-                                <TableCell align='left'>{content.schema.type}</TableCell>\n-                                <TableCell align='left'>{content.required ? 'Yes' : 'No'}</TableCell>\n-                                {!disableUpdate && (\n-                                    <TableCell align='left'>\n-                                        {!hideParameterEdit && (\n-                                            <Tooltip title='Edit'>\n-                                                <IconButton onClick={() => {}} fontSize='small'>\n-                                                    <EditIcon fontSize='small' />\n+                                                    <DeleteIcon fontSize='small' />\n                                                 </IconButton>\n                                             </Tooltip>\n-                                        )}\n-                                        <Tooltip title='Delete'>\n-                                            <IconButton\n-                                                disabled={disableUpdate}\n-                                                onClick={() => {\n-                                                    operationsDispatcher({\n-                                                        action: 'requestBody',\n-                                                        data: {\n-                                                            target,\n-                                                            verb,\n-                                                            value: {\n-                                                                description: '',\n-                                                                required: false,\n-                                                                content: {},\n-                                                            },\n-                                                        },\n-                                                    });\n-                                                }}\n-                                                fontSize='small'\n-                                            >\n-                                                <DeleteIcon fontSize='small' />\n-                                            </IconButton>\n-                                        </Tooltip>\n-                                    </TableCell>\n-                                )}\n-                            </TableRow>\n-                        ))}\n+                                        </TableCell>\n+                                    )}\n+                                </TableRow>\n+                            );\n+                        })}\n+                    {operation.requestBody && (isRef(operation.requestBody)\n+                        ? Object.entries(resolvedSpec.paths[target][verb].requestBody.content).map(\n+                            ([contentType, content]) => {\n+                                return (\n+                                    <RequestBody\n+                                        contentType={contentType}\n+                                        content={content}\n+                                        operation={operation}\n+                                        disableUpdate={disableUpdate}\n+                                        hideParameterEdit={hideParameterEdit}\n+                                        operationsDispatcher={operationsDispatcher}\n+                                        target={target}\n+                                        verb={verb}\n+                                    />\n+                                );\n+                            },\n+                        ) : Object.entries(operation.requestBody.content).map(([contentType, content]) => {", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzMzYyNw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387833627", "bodyText": "We could get content array in here and do the mapping, otherwise, it looks like this component is just used to reduce the # of lines in its parent \ud83d\ude03", "author": "tmkasun", "createdAt": "2020-03-04T17:53:38Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/operationComponents/RequestBody.jsx", "diffHunk": "@@ -0,0 +1,119 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied. See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+\n+import React from 'react';\n+import PropTypes from 'prop-types';\n+import { FormattedMessage } from 'react-intl';\n+import TableCell from '@material-ui/core/TableCell';\n+import Tooltip from '@material-ui/core/Tooltip';\n+import IconButton from '@material-ui/core/IconButton';\n+import EditIcon from '@material-ui/icons/Edit';\n+import DeleteIcon from '@material-ui/icons/Delete';\n+import TableRow from '@material-ui/core/TableRow';\n+\n+/**\n+ * Component to render the Request b\n+ *\n+ * */\n+function RequestBody(props) {\n+    const {\n+        contentType, content, operation, disableUpdate, hideParameterEdit, operationsDispatcher, target, verb,\n+    } = props;\n+    return (", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzNTAzNQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387835035", "bodyText": "IMO , since parameters always come under an operation, (unless referred) it's better to keep one util file (operations.utils). to keep the util methods, or even one util file for the entire resource page, otherwise future deves will get confused where to put what and where to look for what? WDYT ?", "author": "tmkasun", "createdAt": "2020-03-04T17:56:09Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/operationComponents/parameterUtils.js", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied. See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+\n+/**\n+ * Defining the supported data types by the OAS spec versions.\n+ *\n+ * 2.0 : https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#dataTypeFormat\n+ * 3.x :https://swagger.io/docs/specification/data-models/data-types/\n+ * */\n+const supportedDataTypes = {", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzNTgxNA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387835814", "bodyText": "Yes it will make the utils file bit large, since it contains segregated until methods I think the number of lines in the file would be ok", "author": "tmkasun", "createdAt": "2020-03-04T17:57:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzNTAzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzNjQ3NA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387836474", "bodyText": "are these datatypes case sensitive ?", "author": "tmkasun", "createdAt": "2020-03-04T17:58:45Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/components/operationComponents/parameterUtils.js", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  WSO2 Inc. licenses this file to you under the Apache License,\n+ *  Version 2.0 (the \"License\"); you may not use this file except\n+ *  in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing,\n+ *  software distributed under the License is distributed on an\n+ *  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ *  KIND, either express or implied. See the License for the\n+ *  specific language governing permissions and limitations\n+ *  under the License.\n+ */\n+\n+/**\n+ * Defining the supported data types by the OAS spec versions.\n+ *\n+ * 2.0 : https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#dataTypeFormat\n+ * 3.x :https://swagger.io/docs/specification/data-models/data-types/\n+ * */\n+const supportedDataTypes = {\n+    '2.0': {\n+        body: ['integer', 'number', 'string', 'boolean', 'object'],\n+        formData: ['integer', 'number', 'string', 'boolean', 'file'],\n+        query: ['integer', 'number', 'string', 'boolean'],\n+        path: ['integer', 'number', 'string', 'boolean'],\n+        header: ['integer', 'number', 'string', 'boolean'],\n+    },\n+    '3.x': {\n+        body: ['integer', 'number', 'string', 'boolean', 'object'],\n+        query: ['integer', 'number', 'string', 'boolean'],\n+        path: ['integer', 'number', 'string', 'boolean'],\n+        header: ['integer', 'number', 'string', 'boolean'],\n+        cookie: ['integer', 'number', 'string', 'boolean'],\n+    },\n+};\n+\n+/**\n+ * Util method for checking conditions.\n+ *\n+ * @param {boolean} condition : The condition to be checked\n+ * @param {any} matched : The value to be returned if the condition is true\n+ * @param {any} otherwise : The value to be returned if the condition is false.\n+ * @return {object} If true -> matched, false -> otherwise\n+ * */\n+export function iff(condition, matched, otherwise) {\n+    return condition ? matched : otherwise;\n+}\n+\n+/**\n+ * Method to get the supported data types for the given parameter type.\n+ *\n+ * @param {string} specVersion : The OAS version\n+ * @param {string} paramType : The parameter type.\n+ * @return {array} The list of supported parameters.\n+ * */\n+export function getSupportedDataTypes(specVersion, paramType) {\n+    return paramType ? supportedDataTypes[specVersion === '2.0' ? '2.0' : '3.x'][paramType] : [];\n+}\n+\n+/**\n+ * Get the supported data formats by each data type.\n+ *\n+ * @param {string} dataType: THe data type.\n+ * @return {array} The list of supported data formats.\n+ * */\n+export function getDataFormats(dataType) {\n+    switch (dataType) {", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzODAzMA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387838030", "bodyText": "it is not good to update block scope local variable from a lambda function, why do we need to loop through the object keys ?\nif it's an object then for sure it's not a $ref ?", "author": "tmkasun", "createdAt": "2020-03-04T18:01:40Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/operationUtils.js", "diffHunk": "@@ -200,6 +200,24 @@ function isSelectAll(selectedOperations, operations) {\n     }\n     return true;\n }\n+\n+/**\n+ * Check whether the provided object is a Ref object.\n+ *\n+ * @param {object} content : The object that needs to be checked.\n+ * @return {boolean} true if Ref, false otherwise.\n+ * */\n+function isRef(content) {\n+    let isReference = false;\n+    if (typeof content === 'object') {\n+        Object.keys(content).map((name) => {\n+            isReference = name === '$ref';", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzODE4Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387838187", "bodyText": "no use of this return statement ?\nreturn name;", "author": "tmkasun", "createdAt": "2020-03-04T18:01:58Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/operationUtils.js", "diffHunk": "@@ -200,6 +200,24 @@ function isSelectAll(selectedOperations, operations) {\n     }\n     return true;\n }\n+\n+/**\n+ * Check whether the provided object is a Ref object.\n+ *\n+ * @param {object} content : The object that needs to be checked.\n+ * @return {boolean} true if Ref, false otherwise.\n+ * */\n+function isRef(content) {\n+    let isReference = false;\n+    if (typeof content === 'object') {\n+        Object.keys(content).map((name) => {\n+            isReference = name === '$ref';\n+            return name;", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgzODQ2OQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8272#discussion_r387838469", "bodyText": "can't we just check the passed value to $ref ?", "author": "tmkasun", "createdAt": "2020-03-04T18:02:36Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/components/Apis/Details/Resources/operationUtils.js", "diffHunk": "@@ -200,6 +200,24 @@ function isSelectAll(selectedOperations, operations) {\n     }\n     return true;\n }\n+\n+/**\n+ * Check whether the provided object is a Ref object.\n+ *\n+ * @param {object} content : The object that needs to be checked.\n+ * @return {boolean} true if Ref, false otherwise.\n+ * */\n+function isRef(content) {\n+    let isReference = false;\n+    if (typeof content === 'object') {\n+        Object.keys(content).map((name) => {\n+            isReference = name === '$ref';\n+            return name;\n+        });\n+    }\n+    return isReference;", "originalCommit": "d62db219d1ca80d6d81986e375db039236ef5da1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}