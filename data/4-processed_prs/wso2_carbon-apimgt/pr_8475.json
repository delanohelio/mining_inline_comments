{"pr_number": 8475, "pr_title": "Codegen Migration of Admin REST APIs", "pr_createdAt": "2020-05-07T11:51:03Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8475", "timeline": [{"oid": "ba680cf892368fdb202dfc054fb4fa0e77db9eb0", "url": "https://github.com/wso2/carbon-apimgt/commit/ba680cf892368fdb202dfc054fb4fa0e77db9eb0", "message": "Set-up admin REST APIs with swagger-codegen-maven-plugin", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "e1f1e1ae091f0a52d8586bc2ebca10b3f24a7ec0", "url": "https://github.com/wso2/carbon-apimgt/commit/e1f1e1ae091f0a52d8586bc2ebca10b3f24a7ec0", "message": "Migrate the scopes to swagger spec supported scopes", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "68dbf5be9bd618eb32b70a544d3386ac83414b34", "url": "https://github.com/wso2/carbon-apimgt/commit/68dbf5be9bd618eb32b70a544d3386ac83414b34", "message": "Add ThrottlePolicy changes in yaml and auto-generated DTOs", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "5dd5f99762ae4690a0f0351943fb556d02387f83", "url": "https://github.com/wso2/carbon-apimgt/commit/5dd5f99762ae4690a0f0351943fb556d02387f83", "message": "Add util codes to admin v1 rest API directory", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "4a45efe1bb569d2bfcdc455eed6634f4b4502475", "url": "https://github.com/wso2/carbon-apimgt/commit/4a45efe1bb569d2bfcdc455eed6634f4b4502475", "message": "Enable obtaining admin resource mappings for admin v1 REST API", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "365027b38400b30d595fd85245127f800e57eb38", "url": "https://github.com/wso2/carbon-apimgt/commit/365027b38400b30d595fd85245127f800e57eb38", "message": "Introduce Settings API to the list of admin v1 REST APIs", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "143c5ebad8e63ff23bd53f063b11d6b662df8747", "url": "https://github.com/wso2/carbon-apimgt/commit/143c5ebad8e63ff23bd53f063b11d6b662df8747", "message": "Add implementation codes of admin v1 REST APIs", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "fe555632515637eee5b822702dfcbaa1611b3510", "url": "https://github.com/wso2/carbon-apimgt/commit/fe555632515637eee5b822702dfcbaa1611b3510", "message": "Fix formatting issues and License headers of util codes", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "570a0d1ed80ffaebee3f68cb3bbe17726f238aeb", "url": "https://github.com/wso2/carbon-apimgt/commit/570a0d1ed80ffaebee3f68cb3bbe17726f238aeb", "message": "Add /swagger.yaml resource to the admin v1 REST API", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "7d14720f774adf36b971b70ce14053d123572fe2", "url": "https://github.com/wso2/carbon-apimgt/commit/7d14720f774adf36b971b70ce14053d123572fe2", "message": "Whitelist the admin v1 settings API", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"oid": "44e46c9cd49a64617db203ec5bbe135ab6db325b", "url": "https://github.com/wso2/carbon-apimgt/commit/44e46c9cd49a64617db203ec5bbe135ab6db325b", "message": "Update admin v1 REST API pom.xml version", "committedDate": "2020-05-06T13:01:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE0NzMzMg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r424147332", "bodyText": "Please fix the license header.", "author": "malinthaprasan", "createdAt": "2020-05-13T03:05:40Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/webapp/WEB-INF/web.xml", "diffHunk": "@@ -0,0 +1,51 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ /*\n+  ~  * Copyright (c) 2015, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "originalCommit": "44e46c9cd49a64617db203ec5bbe135ab6db325b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE0NzQ2NQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r424147465", "bodyText": "Add license header", "author": "malinthaprasan", "createdAt": "2020-05-13T03:06:15Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/webapp/WEB-INF/beans.xml", "diffHunk": "@@ -0,0 +1,60 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>", "originalCommit": "44e46c9cd49a64617db203ec5bbe135ab6db325b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDE0NzQ5OA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r424147498", "bodyText": "Please fix the license header.", "author": "malinthaprasan", "createdAt": "2020-05-13T03:06:27Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/webapp/META-INF/webapp-classloading.xml", "diffHunk": "@@ -0,0 +1,35 @@\n+<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n+\n+<!--\n+  ~ Copyright (c) 2015, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.", "originalCommit": "44e46c9cd49a64617db203ec5bbe135ab6db325b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "88668081d0e8996b55ec892b1d5dd5cbbc207a7e", "url": "https://github.com/wso2/carbon-apimgt/commit/88668081d0e8996b55ec892b1d5dd5cbbc207a7e", "message": "Fix License headers of admin v1 webapp files", "committedDate": "2020-05-13T04:23:24Z", "type": "commit"}, {"oid": "c82bd24ad088b49fd41b963c1aa1c878339f6837", "url": "https://github.com/wso2/carbon-apimgt/commit/c82bd24ad088b49fd41b963c1aa1c878339f6837", "message": "Update admin v1 REST API pom.xml version", "committedDate": "2020-05-13T05:14:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDY5NTY4Mg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r554695682", "bodyText": "is this an autogenerated file? if not don't we need a new line eof?", "author": "ruwiniwj", "createdAt": "2021-01-11T04:17:45Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/.swagger-codegen-ignore", "diffHunk": "@@ -0,0 +1,28 @@\n+# Swagger Codegen Ignore\n+# Generated by swagger-codegen https://github.com/swagger-api/swagger-codegen\n+\n+# Use this file to prevent files from being overwritten by the generator.\n+# The patterns follow closely to .gitignore or .dockerignore.\n+\n+# As an example, the C# client generator defines ApiClient.cs.\n+# You can make changes and tell Swagger Codgen to ignore just this file by uncommenting the following line:\n+#ApiClient.cs\n+\n+# You can match any string of characters against a directory, file or extension with a single asterisk (*):\n+#foo/*/qux\n+# The above matches foo/bar/qux and foo/baz/qux, but not foo/bar/baz/qux\n+\n+# You can recursively match patterns against a directory, file or extension with a double asterisk (**):\n+#foo/**/qux\n+# This matches foo/bar/qux, foo/baz/qux, and foo/bar/baz/qux\n+\n+# You can also negate patterns with an exclamation (!).\n+# For example, you can ignore all files in a docs folder with the file extension .md:\n+#docs/*.md\n+# Then explicitly reverse the ignore rule for a single file:\n+#!docs/README.md\n+\n+**/RestApplication.java\n+**/test/**\n+swagger.json\n+pom.xml", "originalCommit": "c82bd24ad088b49fd41b963c1aa1c878339f6837", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTc5MTA3Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r571791077", "bodyText": "This file has been removed in the current master branch.\nhttps://github.com/wso2/carbon-apimgt/tree/master/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1", "author": "hisanhunais", "createdAt": "2021-02-08T05:37:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDY5NTY4Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDgzODczOQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r554838739", "bodyText": "Shall we change 'api' as 'API' and add a space next to ':'?\n\"No API category with the given category ID exists: \"", "author": "Meruja", "createdAt": "2021-01-11T07:31:47Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/v1/impl/ApiCategoriesApiServiceImpl.java", "diffHunk": "@@ -0,0 +1,132 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package org.wso2.carbon.apimgt.rest.api.admin.v1.impl;\n+\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.apache.cxf.jaxrs.ext.MessageContext;\n+import org.wso2.carbon.apimgt.api.APIAdmin;\n+import org.wso2.carbon.apimgt.api.APIManagementException;\n+import org.wso2.carbon.apimgt.api.model.APICategory;\n+import org.wso2.carbon.apimgt.impl.APIAdminImpl;\n+import org.wso2.carbon.apimgt.impl.utils.APIUtil;\n+import org.wso2.carbon.apimgt.rest.api.admin.v1.ApiCategoriesApiService;\n+import org.wso2.carbon.apimgt.rest.api.admin.v1.dto.APICategoryDTO;\n+import org.wso2.carbon.apimgt.rest.api.admin.v1.dto.APICategoryListDTO;\n+import org.wso2.carbon.apimgt.rest.api.admin.v1.utils.mappings.APICategoryMappingUtil;\n+import org.wso2.carbon.apimgt.rest.api.util.RestApiConstants;\n+import org.wso2.carbon.apimgt.rest.api.util.utils.RestApiUtil;\n+import org.wso2.carbon.utils.multitenancy.MultitenantUtils;\n+\n+import java.net.URI;\n+import java.net.URISyntaxException;\n+import java.util.List;\n+import javax.ws.rs.core.Response;\n+\n+public class ApiCategoriesApiServiceImpl implements ApiCategoriesApiService {\n+    private static final Log log = LogFactory.getLog(ApiCategoriesApiServiceImpl.class);\n+\n+    @Override\n+    public Response apiCategoriesGet(MessageContext messageContext) {\n+        try {\n+            APIAdmin apiAdmin = new APIAdminImpl();\n+            String tenantDomain = RestApiUtil.getLoggedInUserTenantDomain();\n+            int tenantID = APIUtil.getTenantIdFromTenantDomain(tenantDomain);\n+            List<APICategory> categoryList = apiAdmin.getAllAPICategoriesOfTenant(tenantID);\n+            APICategoryListDTO categoryListDTO = APICategoryMappingUtil.fromCategoryListToCategoryListDTO(categoryList);\n+            return Response.ok().entity(categoryListDTO).build();\n+        } catch (APIManagementException e) {\n+            String errorMessage = \"Error while retrieving API categories\";\n+            RestApiUtil.handleInternalServerError(errorMessage, e, log);\n+        }\n+        return null;\n+    }\n+\n+    @Override\n+    public Response apiCategoriesPost(APICategoryDTO body, MessageContext messageContext) {\n+        APICategory apiCategory = null;\n+        try {\n+            APIAdmin apiAdmin = new APIAdminImpl();\n+            String userName = RestApiUtil.getLoggedInUsername();\n+            apiCategory = APICategoryMappingUtil.fromCategoryDTOToCategory(body);\n+            APICategoryDTO categoryDTO = APICategoryMappingUtil.\n+                    fromCategoryToCategoryDTO(apiAdmin.addCategory(apiCategory, userName));\n+            URI location = new URI(RestApiConstants.RESOURCE_PATH_CATEGORY + \"/\" + categoryDTO.getId());\n+            return Response.created(location).entity(categoryDTO).build();\n+        } catch (APIManagementException | URISyntaxException e) {\n+            String errorMessage = \"Error while adding new API Category '\" + body.getName() + \"' - \" + e.getMessage();\n+            RestApiUtil.handleInternalServerError(errorMessage, e, log);\n+        }\n+        return null;\n+    }\n+\n+    @Override\n+    public Response apiCategoriesApiCategoryIdPut(String apiCategoryId, APICategoryDTO body,\n+                                                  MessageContext messageContext) {\n+        try {\n+            APIAdmin apiAdmin = new APIAdminImpl();\n+            String userName = RestApiUtil.getLoggedInUsername();\n+            String tenantDomain = MultitenantUtils.getTenantDomain(userName);\n+            int tenantID = APIUtil.getTenantIdFromTenantDomain(tenantDomain);\n+            APICategory apiCategoryToUpdate = APICategoryMappingUtil.fromCategoryDTOToCategory(body);\n+            APICategory apiCategoryOriginal = apiAdmin.getAPICategoryByID(apiCategoryId);\n+            if (apiCategoryOriginal == null) {\n+                String errorMsg = \"No api category with the given category ID exists :\" + apiCategoryId;", "originalCommit": "c82bd24ad088b49fd41b963c1aa1c878339f6837", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTc5MTM1Mw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r571791353", "bodyText": "Fixed with f704b66", "author": "hisanhunais", "createdAt": "2021-02-08T05:38:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDgzODczOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDkyMDA3OQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r554920079", "bodyText": "Shall we remove the wildcard imports?", "author": "Chamindu36", "createdAt": "2021-01-11T09:38:37Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/v1/impl/LabelsApiServiceImpl.java", "diffHunk": "@@ -0,0 +1,134 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package org.wso2.carbon.apimgt.rest.api.admin.v1.impl;\n+\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.apache.cxf.jaxrs.ext.MessageContext;\n+import org.wso2.carbon.apimgt.api.APIAdmin;\n+import org.wso2.carbon.apimgt.api.APIManagementException;\n+import org.wso2.carbon.apimgt.api.model.Label;\n+import org.wso2.carbon.apimgt.impl.APIAdminImpl;\n+import org.wso2.carbon.apimgt.rest.api.admin.v1.*;", "originalCommit": "c82bd24ad088b49fd41b963c1aa1c878339f6837", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTc5MTY2OQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r571791669", "bodyText": "Fixed with 5f80950", "author": "hisanhunais", "createdAt": "2021-02-08T05:39:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDkyMDA3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDkyMTkxNQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r554921915", "bodyText": "Shall we remove the wildcard imports here?", "author": "Chamindu36", "createdAt": "2021-01-11T09:42:03Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/v1/utils/FileBasedApplicationImportExportManager.java", "diffHunk": "@@ -0,0 +1,387 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+\n+package org.wso2.carbon.apimgt.rest.api.admin.v1.utils;\n+\n+import com.google.gson.Gson;\n+import com.google.gson.GsonBuilder;\n+import org.apache.commons.io.FileUtils;\n+import org.apache.commons.io.IOUtils;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.apimgt.api.APIConsumer;\n+import org.wso2.carbon.apimgt.api.APIManagementException;\n+import org.wso2.carbon.apimgt.api.model.Application;\n+import org.wso2.carbon.apimgt.api.model.SubscribedAPI;\n+import org.wso2.carbon.apimgt.impl.APIConstants;\n+\n+import java.io.*;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.DirectoryStream;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.*;\n+import java.util.zip.ZipEntry;\n+import java.util.zip.ZipFile;\n+import java.util.zip.ZipOutputStream;", "originalCommit": "c82bd24ad088b49fd41b963c1aa1c878339f6837", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTc5MTcwNw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8475#discussion_r571791707", "bodyText": "Fixed with 5f80950", "author": "hisanhunais", "createdAt": "2021-02-08T05:39:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDkyMTkxNQ=="}], "type": "inlineReview"}]}