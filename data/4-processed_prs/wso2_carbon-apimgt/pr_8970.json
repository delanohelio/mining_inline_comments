{"pr_number": 8970, "pr_title": "Download Tenant theme feature", "pr_createdAt": "2020-07-13T09:48:55Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8970", "timeline": [{"oid": "5a31bde50dffcbbb042446cdb6c2133046046a28", "url": "https://github.com/wso2/carbon-apimgt/commit/5a31bde50dffcbbb042446cdb6c2133046046a28", "message": "Download Tenant theme feature", "committedDate": "2020-07-13T09:40:37Z", "type": "commit"}, {"oid": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b", "url": "https://github.com/wso2/carbon-apimgt/commit/42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b", "message": "Fix i18n message id", "committedDate": "2020-07-13T09:48:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0NjI0Mw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453546243", "bodyText": "Do we need to initialize the state with an empty string ?", "author": "tmkasun", "createdAt": "2020-07-13T10:16:37Z", "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin/source/src/app/components/TenantTheme/UploadTheme.jsx", "diffHunk": "@@ -94,20 +115,47 @@ const useStyles = makeStyles((theme) => ({\n function UploadTheme() {\n     const classes = useStyles();\n     const [themeFile, setThemeFile] = useState([]);\n+    const [fileName, setFileName] = useState('');", "originalCommit": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU1ODUxMw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453558513", "bodyText": "Fixed with 2d41afa", "author": "kavishkafernando", "createdAt": "2020-07-13T10:39:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0NjI0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0Njk5Mw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453546993", "bodyText": "Why do we need to remove the first character?", "author": "tmkasun", "createdAt": "2020-07-13T10:17:57Z", "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin/source/src/app/components/TenantTheme/UploadTheme.jsx", "diffHunk": "@@ -94,20 +115,47 @@ const useStyles = makeStyles((theme) => ({\n function UploadTheme() {\n     const classes = useStyles();\n     const [themeFile, setThemeFile] = useState([]);\n+    const [fileName, setFileName] = useState('');\n     const [isFileAccepted, setIsFileAccepted] = useState(false);\n-    const [isUplaodUnsuccessful, setIsUploadUnsuccessful] = useState(false);\n-\n+    const [isUploadUnsuccessful, setIsUploadUnsuccessful] = useState(false);\n+    const intl = useIntl();\n+    const restApi = new API();\n \n     const onDrop = (acceptedFile) => {\n         setIsFileAccepted(true);\n         setThemeFile(acceptedFile[0]);\n     };\n \n+    useEffect(() => {\n+        const tenantThemeContent = restApi.exportTenantTheme();\n+        tenantThemeContent.then((response) => {\n+            const tenantFileName = response.headers['content-disposition'].split('filename=')[1];\n+            setFileName(tenantFileName.slice(1, -1));", "originalCommit": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0ODExOA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453548118", "bodyText": "fileName comes as filename=\"test1.com\" so need to remove the \"", "author": "kavishkafernando", "createdAt": "2020-07-13T10:20:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0Njk5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0NzcxNw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453547717", "bodyText": "We can simplify this as\ntenantThemeContent.then(Utils.forceDownload)\n\nno need to create a lambda/arrow function there", "author": "tmkasun", "createdAt": "2020-07-13T10:19:21Z", "path": "features/apimgt/org.wso2.carbon.apimgt.admin.feature/src/main/resources/admin/source/src/app/components/TenantTheme/UploadTheme.jsx", "diffHunk": "@@ -94,20 +115,47 @@ const useStyles = makeStyles((theme) => ({\n function UploadTheme() {\n     const classes = useStyles();\n     const [themeFile, setThemeFile] = useState([]);\n+    const [fileName, setFileName] = useState('');\n     const [isFileAccepted, setIsFileAccepted] = useState(false);\n-    const [isUplaodUnsuccessful, setIsUploadUnsuccessful] = useState(false);\n-\n+    const [isUploadUnsuccessful, setIsUploadUnsuccessful] = useState(false);\n+    const intl = useIntl();\n+    const restApi = new API();\n \n     const onDrop = (acceptedFile) => {\n         setIsFileAccepted(true);\n         setThemeFile(acceptedFile[0]);\n     };\n \n+    useEffect(() => {\n+        const tenantThemeContent = restApi.exportTenantTheme();\n+        tenantThemeContent.then((response) => {\n+            const tenantFileName = response.headers['content-disposition'].split('filename=')[1];\n+            setFileName(tenantFileName.slice(1, -1));\n+        });\n+    }, []);\n+\n+    /**\n+     * Downloads Tenant Theme ZIP file.\n+     *\n+     */\n+    const handleDownloadTenantTheme = () => {\n+        const tenantThemeContent = restApi.exportTenantTheme();\n+        tenantThemeContent.then((response) => {\n+            Utils.forceDownload(response);", "originalCommit": "42a5d0e72dbb8fdfd52f83f045e10e21c71ba42b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU1ODM5MA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8970#discussion_r453558390", "bodyText": "Fixed with 2d41afa", "author": "kavishkafernando", "createdAt": "2020-07-13T10:39:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU0NzcxNw=="}], "type": "inlineReview"}, {"oid": "2d41afa1a879af3a0c1304795811514841563a38", "url": "https://github.com/wso2/carbon-apimgt/commit/2d41afa1a879af3a0c1304795811514841563a38", "message": "Fix comments", "committedDate": "2020-07-13T10:37:04Z", "type": "commit"}, {"oid": "58c149a140c95c60d7c45420b21dd1b0b3bbf164", "url": "https://github.com/wso2/carbon-apimgt/commit/58c149a140c95c60d7c45420b21dd1b0b3bbf164", "message": "Fix comments", "committedDate": "2020-07-13T10:38:41Z", "type": "commit"}]}