{"pr_number": 8791, "pr_title": "Revamping admin REST API bot detection alerts subscription resources", "pr_createdAt": "2020-06-19T11:53:41Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8791", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDY3Mjk4OQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r444672989", "bodyText": "SQLException should not be coming upto REST API level. Shall we check why it is coming here?", "author": "malinthaprasan", "createdAt": "2020-06-24T06:31:01Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/v1/impl/AlertSubscriptionsApiServiceImpl.java", "diffHunk": "@@ -138,6 +163,88 @@ public Response getSubscribedAlertTypes(MessageContext messageContext) {\n         return Response.status(Response.Status.OK).build();\n     }\n \n+    /**\n+     * Retrieve a list of bot detection alert subscriptions\n+     *\n+     * @param messageContext\n+     * @return list of bot detection alert subscriptions\n+     * @throws APIManagementException\n+     */\n+    @Override\n+    public Response getBotDetectionAlertSubscriptions(MessageContext messageContext) throws APIManagementException {\n+\n+        List<BotDetectionData> botDetectionDataList = new APIAdminImpl().retrieveSavedBotDataEmailList();\n+        BotDetectionAlertSubscriptionListDTO listDTO =\n+                BotDetectionMappingUtil.fromAlertSubscriptionListToListDTO(botDetectionDataList);\n+        return Response.ok().entity(listDTO).build();\n+    }\n+\n+    /**\n+     * Subscribe for bot detection alerts\n+     *\n+     * @param body           email to be registered for the subscription\n+     * @param messageContext\n+     * @return alert subscription DTO containin the uuid of the subscription and the registered email\n+     * @throws APIManagementException\n+     */\n+    @Override\n+    public Response subscribeForBotDetectionAlerts(BotDetectionAlertSubscriptionDTO body, MessageContext messageContext)\n+            throws APIManagementException {\n+\n+        String email = body.getEmail();\n+        if (StringUtils.isBlank(email)) {\n+            String propertyName = AlertMgtConstants.BOT_DETECTION_EMAIL_FIELD;\n+            throw new APIManagementException(propertyName + \" property value of payload cannot be blank\",\n+                    ExceptionCodes.from(ExceptionCodes.BLANK_PROPERTY_VALUE, propertyName));\n+        }\n+\n+        try {\n+            APIAdminImpl apiAdmin = new APIAdminImpl();\n+            BotDetectionData alertSubscription =\n+                    apiAdmin.getBotDetectionAlertSubscription(AlertMgtConstants.BOT_DETECTION_EMAIL_FIELD, email);\n+            if (alertSubscription != null) {\n+                RestApiUtil.handleResourceAlreadyExistsError(\n+                        \"Email: \" + email + \" has already been subscribed for bot detection alerts\", log);\n+            }\n+            apiAdmin.addBotDataEmailConfiguration(email);\n+            BotDetectionData newAlertSubscription =\n+                    apiAdmin.getBotDetectionAlertSubscription(AlertMgtConstants.BOT_DETECTION_EMAIL_FIELD, email);\n+            BotDetectionAlertSubscriptionDTO alertSubscriptionDTO =\n+                    BotDetectionMappingUtil.fromAlertSubscriptionToDTO(newAlertSubscription);\n+            return Response.ok(alertSubscriptionDTO).build();\n+        } catch (APIManagementException | SQLException e) {", "originalCommit": "46921b6774123914975873fcc68578215d62e5c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDY3MzYzOA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r444673638", "bodyText": "Also, you don't need to catch APIManagementException, just let it pass. It will give a 500 anyway.\nhttps://github.com/wso2/carbon-apimgt/wiki/Exception-handling-in-REST-APIs", "author": "malinthaprasan", "createdAt": "2020-06-24T06:32:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDY3Mjk4OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3Mjc4OTIxMw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r572789213", "bodyText": "Fixed with 110c564", "author": "hisanhunais", "createdAt": "2021-02-09T10:58:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDY3Mjk4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDY3Mzc3Mg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r444673772", "bodyText": "Same as above", "author": "malinthaprasan", "createdAt": "2020-06-24T06:33:02Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/v1/impl/AlertSubscriptionsApiServiceImpl.java", "diffHunk": "@@ -138,6 +163,88 @@ public Response getSubscribedAlertTypes(MessageContext messageContext) {\n         return Response.status(Response.Status.OK).build();\n     }\n \n+    /**\n+     * Retrieve a list of bot detection alert subscriptions\n+     *\n+     * @param messageContext\n+     * @return list of bot detection alert subscriptions\n+     * @throws APIManagementException\n+     */\n+    @Override\n+    public Response getBotDetectionAlertSubscriptions(MessageContext messageContext) throws APIManagementException {\n+\n+        List<BotDetectionData> botDetectionDataList = new APIAdminImpl().retrieveSavedBotDataEmailList();\n+        BotDetectionAlertSubscriptionListDTO listDTO =\n+                BotDetectionMappingUtil.fromAlertSubscriptionListToListDTO(botDetectionDataList);\n+        return Response.ok().entity(listDTO).build();\n+    }\n+\n+    /**\n+     * Subscribe for bot detection alerts\n+     *\n+     * @param body           email to be registered for the subscription\n+     * @param messageContext\n+     * @return alert subscription DTO containin the uuid of the subscription and the registered email\n+     * @throws APIManagementException\n+     */\n+    @Override\n+    public Response subscribeForBotDetectionAlerts(BotDetectionAlertSubscriptionDTO body, MessageContext messageContext)\n+            throws APIManagementException {\n+\n+        String email = body.getEmail();\n+        if (StringUtils.isBlank(email)) {\n+            String propertyName = AlertMgtConstants.BOT_DETECTION_EMAIL_FIELD;\n+            throw new APIManagementException(propertyName + \" property value of payload cannot be blank\",\n+                    ExceptionCodes.from(ExceptionCodes.BLANK_PROPERTY_VALUE, propertyName));\n+        }\n+\n+        try {\n+            APIAdminImpl apiAdmin = new APIAdminImpl();\n+            BotDetectionData alertSubscription =\n+                    apiAdmin.getBotDetectionAlertSubscription(AlertMgtConstants.BOT_DETECTION_EMAIL_FIELD, email);\n+            if (alertSubscription != null) {\n+                RestApiUtil.handleResourceAlreadyExistsError(\n+                        \"Email: \" + email + \" has already been subscribed for bot detection alerts\", log);\n+            }\n+            apiAdmin.addBotDataEmailConfiguration(email);\n+            BotDetectionData newAlertSubscription =\n+                    apiAdmin.getBotDetectionAlertSubscription(AlertMgtConstants.BOT_DETECTION_EMAIL_FIELD, email);\n+            BotDetectionAlertSubscriptionDTO alertSubscriptionDTO =\n+                    BotDetectionMappingUtil.fromAlertSubscriptionToDTO(newAlertSubscription);\n+            return Response.ok(alertSubscriptionDTO).build();\n+        } catch (APIManagementException | SQLException e) {\n+            String errorMessage = \"Error when subscribing for bot detection alerts with email: \" + email;\n+            RestApiUtil.handleInternalServerError(errorMessage, e, log);\n+        }\n+        return null;\n+    }\n+\n+    /**\n+     * Unsubscribe from bot detection alerts\n+     *\n+     * @param uuid           uuid of the subscription\n+     * @param messageContext\n+     * @return 200 OK response if the subscription is deleted successfully\n+     */\n+    @Override\n+    public Response unsubscribeFromBotDetectionAlerts(String uuid, MessageContext messageContext) {\n+\n+        try {\n+            APIAdminImpl apiAdmin = new APIAdminImpl();\n+            BotDetectionData alertSubscription = apiAdmin.getBotDetectionAlertSubscription(\"uuid\", uuid);\n+            if (alertSubscription == null) {\n+                RestApiUtil.handleResourceNotFoundError(\n+                        \"Bot detection alert subscription with uuid: \" + uuid + \" does not exist.\", log);\n+            }\n+            apiAdmin.deleteBotDataEmailList(uuid);\n+            return Response.ok().build();\n+        } catch (APIManagementException | SQLException e) {\n+            String errorMessage = \"Error when deleting bot detection alert subscription with uuid: \" + uuid;\n+            RestApiUtil.handleInternalServerError(errorMessage, e, log);", "originalCommit": "46921b6774123914975873fcc68578215d62e5c3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3Mjc4OTM1Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r572789357", "bodyText": "Fixed with 110c564", "author": "hisanhunais", "createdAt": "2021-02-09T10:58:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDY3Mzc3Mg=="}], "type": "inlineReview"}, {"oid": "bbfee7fe8340bf75953f7980979101a28a13a8a4", "url": "https://github.com/wso2/carbon-apimgt/commit/bbfee7fe8340bf75953f7980979101a28a13a8a4", "message": "Revamp bot detection subscription related resource definitions", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "a76d01edc334f0dd1cf9dd29c5ee82f6a6a3f173", "url": "https://github.com/wso2/carbon-apimgt/commit/a76d01edc334f0dd1cf9dd29c5ee82f6a6a3f173", "message": "Commit generated changes after building modified admin-api.yaml", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "df01f64f9a33fa644f00029242dab70aadbe4e40", "url": "https://github.com/wso2/carbon-apimgt/commit/df01f64f9a33fa644f00029242dab70aadbe4e40", "message": "Modify bot detection alert subscription related schema names", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "cb8977c0db58e8cb0830438fef2dc55286eb5c7c", "url": "https://github.com/wso2/carbon-apimgt/commit/cb8977c0db58e8cb0830438fef2dc55286eb5c7c", "message": "Add Impl and DAO functionality related to the revamp", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "c6ec27e951e7cbc4e573853027688ab018a9afb4", "url": "https://github.com/wso2/carbon-apimgt/commit/c6ec27e951e7cbc4e573853027688ab018a9afb4", "message": "Implement the resource functionality related to the revamp", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "39f5f79f68e9ebeabb186858c78929792549bd87", "url": "https://github.com/wso2/carbon-apimgt/commit/39f5f79f68e9ebeabb186858c78929792549bd87", "message": "Change the scope of bot detection alert subscription resources", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "5e4e31cb654ed8cc4b1161906e7031e7a195a13b", "url": "https://github.com/wso2/carbon-apimgt/commit/5e4e31cb654ed8cc4b1161906e7031e7a195a13b", "message": "Revamp bot detection alert subscription related ApiMgtDao codes", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "f23a1e3c861b17b1f2b541c6c01f8387d782555f", "url": "https://github.com/wso2/carbon-apimgt/commit/f23a1e3c861b17b1f2b541c6c01f8387d782555f", "message": "Add methods to APIAdmin Interface", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "23053f72cf15e0ba2bcafd70c6c89b84e1c0a1d0", "url": "https://github.com/wso2/carbon-apimgt/commit/23053f72cf15e0ba2bcafd70c6c89b84e1c0a1d0", "message": "Revamp bot detection alert subscription related AdminImpl codes", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "949f33d19c6e0be36eef73b69b79e52830da914f", "url": "https://github.com/wso2/carbon-apimgt/commit/949f33d19c6e0be36eef73b69b79e52830da914f", "message": "Revamp bot detection subscription admin v0.16 REST layer codes", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "110c56498df5d7c1218d97b1dfda9e179aa6fee4", "url": "https://github.com/wso2/carbon-apimgt/commit/110c56498df5d7c1218d97b1dfda9e179aa6fee4", "message": "Add revamped changes to admin v1 REST layer codes", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "a232e105ef4663f946a772aec3fef71d9f2eb7b4", "url": "https://github.com/wso2/carbon-apimgt/commit/a232e105ef4663f946a772aec3fef71d9f2eb7b4", "message": "Revamp bot detection data admin v1 REST API related codes", "committedDate": "2020-06-28T04:44:51Z", "type": "commit"}, {"oid": "a232e105ef4663f946a772aec3fef71d9f2eb7b4", "url": "https://github.com/wso2/carbon-apimgt/commit/a232e105ef4663f946a772aec3fef71d9f2eb7b4", "message": "Revamp bot detection data admin v1 REST API related codes", "committedDate": "2020-06-28T04:44:51Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njc3MzIyNQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r446773225", "bodyText": "extra space", "author": "malinthaprasan", "createdAt": "2020-06-29T05:01:26Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java", "diffHunk": "@@ -425,38 +425,31 @@ public KeyManagerConfigurationDTO getKeyManagerConfigurationByName(String tenant\n         return keyManagerConfiguration;\n     }\n \n-    /**\n-     * configure email list to which the alert needs to be sent\n-     */\n-    public void addBotDataEmailConfiguration(String email) throws APIManagementException, SQLException {\n+    @Override\n+    public void addBotDetectionAlertSubscription(String email) throws APIManagementException {\n \n-        apiMgtDAO.addBotDataEmailConfiguration(email);\n+        apiMgtDAO.addBotDetectionAlertSubscription(email);\n     }\n \n-    /**\n-     * retrieve the configured email list\n-     */\n-    public List<BotDetectionData> retrieveSavedBotDataEmailList() throws APIManagementException {\n+    @Override\n+    public List<BotDetectionData> getBotDetectionAlertSubscriptions() throws APIManagementException {\n \n-        List<BotDetectionData> list;\n-        list = apiMgtDAO.retrieveSavedBotDataEmailList();\n-        return list;\n+        return apiMgtDAO.getBotDetectionAlertSubscriptions();\n     }\n \n-    /**\n-     * remove all configured email list\n-     */\n-    public void deleteBotDataEmailList(String uuid) throws APIManagementException, SQLException {\n+    @Override\n+    public void deleteBotDetectionAlertSubscription(String uuid) throws APIManagementException {\n \n-        apiMgtDAO.deleteBotDataEmailList(uuid);\n+        apiMgtDAO.deleteBotDetectionAlertSubscription(uuid);\n     }\n \n-    /**\n-     * Retrieve all bot detected data\n-     *\n-     * @return list of bot detected data\n-     * @throws APIManagementException\n-     */\n+    @Override\n+    public BotDetectionData getBotDetectionAlertSubscription(String field, String value) throws APIManagementException {\n+", "originalCommit": "a232e105ef4663f946a772aec3fef71d9f2eb7b4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU3MDg3MA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r555570870", "bodyText": "Add description for throws", "author": "rmsamitha", "createdAt": "2021-01-12T07:50:04Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java", "diffHunk": "@@ -14588,69 +14588,86 @@ public void addBotDataEmailConfiguration(String email) throws SQLException, APIM\n             ps.execute();\n             connection.commit();\n         } catch (SQLException e) {\n-            connection.rollback();\n-            handleException(\"Error while save email list.\", e);\n-        } finally {\n-            APIMgtDBUtil.closeAllConnections(ps, connection, rs);\n+            handleException(\"Error while adding bot detection alert subscription\", e);\n         }\n     }\n \n     /**\n-     * retrieve email list which configured for BotDetectedData Api alert\n+     * Retrieve all bot detection alert subscriptions\n+     *\n+     * @throws APIManagementException if an error occurs when retrieving bot detection alert subscriptions\n      */\n-    public List<BotDetectionData> retrieveSavedBotDataEmailList()\n-            throws APIManagementException {\n+    public List<BotDetectionData> getBotDetectionAlertSubscriptions() throws APIManagementException {\n \n-        Connection conn = null;\n-        ResultSet resultSet = null;\n-        PreparedStatement ps = null;\n         List<BotDetectionData> list = new ArrayList<>();\n-\n-        try {\n-            String sqlQuery;\n-            conn = APIMgtDBUtil.getConnection();\n-            sqlQuery = SQLConstants.BotDataConstants.GET_SAVED_ALERT_EMAILS;\n-            ps = conn.prepareStatement(sqlQuery);\n-            resultSet = ps.executeQuery();\n+        String query = SQLConstants.BotDataConstants.GET_SAVED_ALERT_EMAILS;\n+        try (Connection connection = APIMgtDBUtil.getConnection();\n+             PreparedStatement ps = connection.prepareStatement(query)) {\n+            ResultSet resultSet = ps.executeQuery();\n             while (resultSet.next()) {\n                 BotDetectionData botDetectedData = new BotDetectionData();\n                 botDetectedData.setUuid(resultSet.getString(\"UUID\"));\n                 botDetectedData.setEmail(resultSet.getString(\"SUBSCRIBER_ADDRESS\"));\n                 list.add(botDetectedData);\n             }\n         } catch (SQLException e) {\n-            handleException(\"Failed to retrieve saved email types by tenant Name. \", e);\n-        } finally {\n-            APIMgtDBUtil.closeAllConnections(ps, conn, resultSet);\n+            handleException(\"Error while retrieving bot detection alert subscriptions\", e);\n         }\n         return list;\n-\n     }\n \n     /**\n-     * Delete email list from the database by using the tenantDomain\n+     * Delete a bot detection alert subscription\n+     *\n+     * @param uuid uuid of the subscription\n+     * @throws APIManagementException if an error occurs when deleting a bot detection alert subscription\n      */\n-    public void deleteBotDataEmailList(String uuid) throws APIManagementException, SQLException {\n+    public void deleteBotDetectionAlertSubscription(String uuid) throws APIManagementException {\n \n-        Connection connection;\n-        PreparedStatement ps = null;\n-        ResultSet rs = null;\n-        connection = APIMgtDBUtil.getConnection();\n-        connection.setAutoCommit(false);\n-\n-        try {\n+        String query = SQLConstants.BotDataConstants.DELETE_EMAIL_BY_UUID;\n+        try (Connection connection = APIMgtDBUtil.getConnection();\n+             PreparedStatement ps = connection.prepareStatement(query)) {\n             connection.setAutoCommit(false);\n-            String deleteEmail = SQLConstants.BotDataConstants.DELETE_EMAIL_BY_UUID;\n-            ps = connection.prepareStatement(deleteEmail);\n             ps.setString(1, uuid);\n             ps.execute();\n             connection.commit();\n         } catch (SQLException e) {\n-            connection.rollback();\n-            handleException(\"Failed to delete alert email data.\", e);\n-        } finally {\n-            APIMgtDBUtil.closeAllConnections(ps, connection, rs);\n+            handleException(\"Error while deleting bot detection alert subscription\", e);\n+        }\n+    }\n+\n+    /**\n+     * Retrieve a bot detection alert subscription by querying a particular field (uuid or email)\n+     *\n+     * @param field field to be queried to obtain the bot detection alert subscription. Can be uuid or email\n+     * @param value value corresponding to the field (uuid or email value)\n+     * @return if subscription exist, returns the bot detection alert subscription, else returns a null object\n+     * @throws APIManagementException", "originalCommit": "a232e105ef4663f946a772aec3fef71d9f2eb7b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTc5MjUwOA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r571792508", "bodyText": "Fixed with f39ed1e", "author": "hisanhunais", "createdAt": "2021-02-08T05:42:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU3MDg3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU3MjE5Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r555572197", "bodyText": "Add a description or remove the line", "author": "rmsamitha", "createdAt": "2021-01-12T07:52:43Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/v1/impl/AlertSubscriptionsApiServiceImpl.java", "diffHunk": "@@ -138,6 +163,78 @@ public Response getSubscribedAlertTypes(MessageContext messageContext) {\n         return Response.status(Response.Status.OK).build();\n     }\n \n+    /**\n+     * Retrieve a list of bot detection alert subscriptions\n+     *\n+     * @param messageContext\n+     * @return list of bot detection alert subscriptions\n+     * @throws APIManagementException if an error occurs when retrieving bot detection alert subscriptions\n+     */\n+    @Override\n+    public Response getBotDetectionAlertSubscriptions(MessageContext messageContext) throws APIManagementException {\n+\n+        APIAdmin apiAdmin = new APIAdminImpl();\n+        List<BotDetectionData> botDetectionDataList = apiAdmin.getBotDetectionAlertSubscriptions();\n+        BotDetectionAlertSubscriptionListDTO listDTO =\n+                BotDetectionMappingUtil.fromAlertSubscriptionListToListDTO(botDetectionDataList);\n+        return Response.ok().entity(listDTO).build();\n+    }\n+\n+    /**\n+     * Subscribe for bot detection alerts\n+     *\n+     * @param body           email to be registered for the subscription\n+     * @param messageContext", "originalCommit": "a232e105ef4663f946a772aec3fef71d9f2eb7b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTc5MjQ1Mw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r571792453", "bodyText": "Fixed with f39ed1e", "author": "hisanhunais", "createdAt": "2021-02-08T05:42:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU3MjE5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU3OTcyMw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r555579723", "bodyText": "Needs to format. (add spaces in betwee param name and the description so that all the descriptions are aligned on same point). This should be formatted automatically wso2 code formatted. Fix at other places as well", "author": "rmsamitha", "createdAt": "2021-01-12T08:08:32Z", "path": "components/apimgt/org.wso2.carbon.apimgt.api/src/main/java/org/wso2/carbon/apimgt/api/APIAdmin.java", "diffHunk": "@@ -127,6 +128,47 @@ void addMonetizationUsagePublishInfo(MonetizationUsagePublishInfo monetizationUs\n     void updateMonetizationUsagePublishInfo(MonetizationUsagePublishInfo monetizationUsagePublishInfo)\n             throws APIManagementException;\n \n+    /**\n+     * Add a bot detection alert subscription\n+     *\n+     * @param email email to be registered for the subscription\n+     * @throws APIManagementException if an error occurs when adding a bot detection alert subscription\n+     */\n+    void addBotDetectionAlertSubscription(String email) throws APIManagementException;\n+\n+    /**\n+     * Delete a bot detection alert subscription\n+     *\n+     * @param uuid uuid of the subscription\n+     * @throws APIManagementException if an error occurs when deleting a bot detection alert subscription\n+     */\n+    void deleteBotDetectionAlertSubscription(String uuid) throws APIManagementException;\n+\n+    /**\n+     * Retrieve a bot detection alert subscription by querying a particular field (uuid or email)\n+     *\n+     * @param field field to be queried to obtain the bot detection alert subscription. Can be uuid or email\n+     * @param value value corresponding to the field (uuid or email value)\n+     * @return if a subscription exists, returns the bot detection alert subscription, else returns a null object\n+     * @throws APIManagementException if an error occurs when retrieving a bot detection alert subscription", "originalCommit": "a232e105ef4663f946a772aec3fef71d9f2eb7b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MTk3NzIzMA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8791#discussion_r571977230", "bodyText": "The parameter name and description are separated using a single space and formatting this section using the formatter did not make any changes.", "author": "hisanhunais", "createdAt": "2021-02-08T11:35:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU3OTcyMw=="}], "type": "inlineReview"}]}