{"pr_number": 8630, "pr_title": "Add DB script changes related to shared scopes", "pr_createdAt": "2020-06-02T09:30:51Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8630", "timeline": [{"oid": "dbef819741d96f320e9ef7cd7d54fc615f776f4d", "url": "https://github.com/wso2/carbon-apimgt/commit/dbef819741d96f320e9ef7cd7d54fc615f776f4d", "message": "add shared scopes schema changes to mysql script.", "committedDate": "2020-06-01T09:35:11Z", "type": "commit"}, {"oid": "7858264c0f667c30d0039c29d11212f67aaca89a", "url": "https://github.com/wso2/carbon-apimgt/commit/7858264c0f667c30d0039c29d11212f67aaca89a", "message": "add shared scopes schema changes to postgresql script.", "committedDate": "2020-06-01T10:07:27Z", "type": "commit"}, {"oid": "ebdab3e2b325b4c356bce34e4ef68fb5cb57c984", "url": "https://github.com/wso2/carbon-apimgt/commit/ebdab3e2b325b4c356bce34e4ef68fb5cb57c984", "message": "add shared scopes schema changes to mssql script.", "committedDate": "2020-06-01T10:26:14Z", "type": "commit"}, {"oid": "0c65602a83dd99a00ab145895cf93b981f9630d8", "url": "https://github.com/wso2/carbon-apimgt/commit/0c65602a83dd99a00ab145895cf93b981f9630d8", "message": "add shared scopes schema changes to myssql cluster script.", "committedDate": "2020-06-01T10:30:31Z", "type": "commit"}, {"oid": "e3938dde78f505205999046bfaec93572d83219c", "url": "https://github.com/wso2/carbon-apimgt/commit/e3938dde78f505205999046bfaec93572d83219c", "message": "add db2 and oracle scripts for shared scopes.", "committedDate": "2020-06-03T13:11:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3NTg5Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8630#discussion_r434575897", "bodyText": "remove this", "author": "tharindu1st", "createdAt": "2020-06-03T13:42:16Z", "path": "features/apimgt/org.wso2.carbon.apimgt.core.feature/src/main/resources/sql/db2.sql", "diffHunk": "@@ -2018,6 +2017,23 @@ CREATE TABLE AM_API_URL_MAPPING (\n             PRIMARY KEY (URL_MAPPING_ID)\n )/\n \n+CREATE TABLE AM_API_RESOURCE_SCOPE_MAPPING (\n+            SCOPE_NAME VARCHAR(255) NOT NULL,\n+            URL_MAPPING_ID INTEGER NOT NULL,\n+            TENANT_ID INTEGER NOT NULL,\n+            FOREIGN KEY (URL_MAPPING_ID) REFERENCES AM_API_URL_MAPPING(URL_MAPPING_ID) ON DELETE CASCADE,\n+            PRIMARY KEY(SCOPE_NAME, URL_MAPPING_ID)\n+)/\n+\n+CREATE TABLE AM_KM_MGT_APPLICATION (", "originalCommit": "e3938dde78f505205999046bfaec93572d83219c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDYzODUxNQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8630#discussion_r434638515", "bodyText": "done", "author": "dushaniw", "createdAt": "2020-06-03T15:05:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3NTg5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3NjE0MQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8630#discussion_r434576141", "bodyText": "same goes here", "author": "tharindu1st", "createdAt": "2020-06-03T13:42:36Z", "path": "features/apimgt/org.wso2.carbon.apimgt.core.feature/src/main/resources/sql/mssql.sql", "diffHunk": "@@ -1439,6 +1438,27 @@ CREATE TABLE AM_API_URL_MAPPING (\n     PRIMARY KEY (URL_MAPPING_ID)\n );\n \n+IF NOT  EXISTS (SELECT * FROM SYS.OBJECTS WHERE OBJECT_ID = OBJECT_ID(N'[DBO].[AM_API_RESOURCE_SCOPE_MAPPING]') AND TYPE IN (N'U'))\n+\n+CREATE TABLE AM_API_RESOURCE_SCOPE_MAPPING (\n+    SCOPE_NAME VARCHAR(255) NOT NULL,\n+    URL_MAPPING_ID INTEGER NOT NULL,\n+    TENANT_ID INTEGER NOT NULL,\n+    FOREIGN KEY (URL_MAPPING_ID) REFERENCES AM_API_URL_MAPPING(URL_MAPPING_ID) ON DELETE CASCADE,\n+    PRIMARY KEY(SCOPE_NAME, URL_MAPPING_ID)\n+);\n+\n+IF NOT  EXISTS (SELECT * FROM SYS.OBJECTS WHERE OBJECT_ID = OBJECT_ID(N'[DBO].[AM_KM_MGT_APPLICATION]') AND TYPE IN (N'U'))\n+\n+CREATE TABLE AM_KM_MGT_APPLICATION (", "originalCommit": "e3938dde78f505205999046bfaec93572d83219c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDYzODYzMA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8630#discussion_r434638630", "bodyText": "done", "author": "dushaniw", "createdAt": "2020-06-03T15:05:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDU3NjE0MQ=="}], "type": "inlineReview"}, {"oid": "62603d47e6f6a7f6dc79870bd2bceba60449f37d", "url": "https://github.com/wso2/carbon-apimgt/commit/62603d47e6f6a7f6dc79870bd2bceba60449f37d", "message": "remove AM_KM_MGT_APPLICATION", "committedDate": "2020-06-03T15:04:33Z", "type": "commit"}]}