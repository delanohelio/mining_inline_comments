{"pr_number": 9372, "pr_title": "Rest api client for the Service Catalog Operations", "pr_createdAt": "2020-11-09T05:57:19Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/9372", "timeline": [{"oid": "726eaa7af4ad0a223259ba9df832fbb92dda7c6b", "url": "https://github.com/wso2/carbon-apimgt/commit/726eaa7af4ad0a223259ba9df832fbb92dda7c6b", "message": "Add rest API client for service catalog UI", "committedDate": "2020-11-09T05:51:12Z", "type": "commit"}, {"oid": "8435649111f0e9cae13b616031e3addf63256e83", "url": "https://github.com/wso2/carbon-apimgt/commit/8435649111f0e9cae13b616031e3addf63256e83", "message": "Add new service catalog rest api def", "committedDate": "2020-11-09T05:51:13Z", "type": "commit"}, {"oid": "c14543f3236e973449082edf9c19664bc272e7a3", "url": "https://github.com/wso2/carbon-apimgt/commit/c14543f3236e973449082edf9c19664bc272e7a3", "message": "Add service catalog resources for scope validation", "committedDate": "2020-11-09T05:51:13Z", "type": "commit"}, {"oid": "ec189e33d4d27ce124b4abe550f6d727e2c21ec6", "url": "https://github.com/wso2/carbon-apimgt/commit/ec189e33d4d27ce124b4abe550f6d727e2c21ec6", "message": "Remove worker logic for service catalog client", "committedDate": "2020-11-09T05:51:13Z", "type": "commit"}, {"oid": "713567df104c17b4ccde05b91dff31e6e3cfa192", "url": "https://github.com/wso2/carbon-apimgt/commit/713567df104c17b4ccde05b91dff31e6e3cfa192", "message": "Refactor api client for service catalog", "committedDate": "2020-11-09T05:51:13Z", "type": "commit"}, {"oid": "6c9ec38bbaf5d55790b2be309f70f81efce185e6", "url": "https://github.com/wso2/carbon-apimgt/commit/6c9ec38bbaf5d55790b2be309f70f81efce185e6", "message": "Add rest api definitions for service catalog js", "committedDate": "2020-11-09T05:51:13Z", "type": "commit"}, {"oid": "d809218c06408eaf067e64e947bfe95d087ce7ac", "url": "https://github.com/wso2/carbon-apimgt/commit/d809218c06408eaf067e64e947bfe95d087ce7ac", "message": "Add mock responses for the rest api calls", "committedDate": "2020-11-09T05:51:13Z", "type": "commit"}, {"oid": "e63f60600130a8a8acb7c69b9e9b0ac131391528", "url": "https://github.com/wso2/carbon-apimgt/commit/e63f60600130a8a8acb7c69b9e9b0ac131391528", "message": "Add service catalog scopes for auth request", "committedDate": "2020-11-09T05:51:13Z", "type": "commit"}, {"oid": "61362ab348281920d5d15278123e8f2002bf5e78", "url": "https://github.com/wso2/carbon-apimgt/commit/61362ab348281920d5d15278123e8f2002bf5e78", "message": "Change license header", "committedDate": "2020-11-09T05:55:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3NDQwNA==", "url": "https://github.com/wso2/carbon-apimgt/pull/9372#discussion_r522674404", "bodyText": "Shall we combine this check and the below check (if conditions)\nif (clientType === Utils.CONST.API_CLIENT) {\n\nand update the _APIClientMap if there is no client afterward", "author": "tmkasun", "createdAt": "2020-11-13T06:12:08Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/data/APIClientFactory.js", "diffHunk": "@@ -43,22 +45,30 @@ class APIClientFactory {\n      * @param {Object} environment\n      * @returns {APIClient} APIClient object for the environment\n      */\n-    getAPIClient(environment) {\n+    getAPIClient(environment, clientType) {\n         const {\n             label,\n         } = environment;\n         if (label === undefined) {\n             throw new Error('Environment label is undefined, Please provide'\n                 + 'a valid environment object with keys (host,label & loginTokenPath)');\n         }\n-        let apiClient = this._APIClientMap.get(environment.label);\n-\n+        let apiClient;\n+        if (clientType === Utils.CONST.API_CLIENT) {", "originalCommit": "61362ab348281920d5d15278123e8f2002bf5e78", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzM3Mjg5Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/9372#discussion_r523372897", "bodyText": "Fixed with 929acf2", "author": "tharikaGitHub", "createdAt": "2020-11-14T04:13:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3NDQwNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3NTk5Mw==", "url": "https://github.com/wso2/carbon-apimgt/pull/9372#discussion_r522675993", "bodyText": "IMO it's good if we can dynamically generate mock responses from the open API definition. For example, using prism\nThis would be helpful as a temporary solution to this rest API mocking and testing inn the future", "author": "tmkasun", "createdAt": "2020-11-13T06:18:32Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/data/MockResponses.js", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ * WSO2 Inc. licenses this file to you under the Apache License,\n+ * Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+/**\n+  *\n+  * Return sample mocked model data for getSettings\n+  * @export\n+  * @returns {*} Mocked Service Catalog model\n+  */\n+export function getSettings() {\n+    const response = {\n+        scopes: [\n+            'string',\n+        ],\n+    };\n+    return Promise.resolve({ body: response });\n+}\n+\n+/**\n+  *\n+  * Return sample mocked model data for searchServices\n+  * @export\n+  * @returns {*} Mocked Service Catalog model\n+  */\n+export function searchServices() {\n+    const response = {\n+        limit: 0,\n+        offset: 0,\n+        total: 1,\n+        list: [\n+            {\n+                id: '01234567-0123-0123-0123-012345678901',\n+                name: 'Pizzashack-Endpoint',\n+                displayName: 'Pizzashack-Endpoint',\n+                description: 'A Catalog Entry that exposes a REST endpoint',\n+                version: 'v1',\n+                serviceUrl: 'http://localhost/pizzashack',\n+                definitionType: 'OAS3',\n+                securityType: 'BASIC',\n+                mutualSSLEnabled: false,\n+                usage: 1,\n+                createdTime: '2020-02-20T13:57:16.229Z',\n+                lastUpdatedTime: '2020-02-20T13:57:16.229Z',\n+                etag: '32c890312cfadc94a7c1153f65a4f100',\n+            },\n+        ],\n+        pagination: {\n+            offset: 0,\n+            limit: 1,\n+            total: 10,\n+            next: 'string',\n+            previous: 'string',\n+        },\n+    };\n+    return Promise.resolve({ body: response });\n+}\n+\n+/**\n+  *\n+  * Return sample mocked model data for checkServiceExistence\n+  * @export\n+  * @returns {*} Mocked Service Catalog model\n+  */\n+export function checkServiceExistence() {", "originalCommit": "61362ab348281920d5d15278123e8f2002bf5e78", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3NjUwNQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/9372#discussion_r522676505", "bodyText": "Shall we move these methods into a class as static methods, So if in the future if we add a new method to mock we don't need to change/update the import statements", "author": "tmkasun", "createdAt": "2020-11-13T06:20:28Z", "path": "features/apimgt/org.wso2.carbon.apimgt.publisher.feature/src/main/resources/publisher/source/src/app/data/ServiceCatalog.js", "diffHunk": "@@ -0,0 +1,277 @@\n+/**\n+ * Copyright (c) 2020, WSO2 Inc. (http://wso2.com) All Rights Reserved.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+/* eslint-disable */\n+import cloneDeep from 'lodash.clonedeep';\n+import Utils from './Utils';\n+import {\n+    getSettings,\n+    searchServices,\n+    checkServiceExistence,", "originalCommit": "61362ab348281920d5d15278123e8f2002bf5e78", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzM3MjkyNw==", "url": "https://github.com/wso2/carbon-apimgt/pull/9372#discussion_r523372927", "bodyText": "Fixed with 929acf2", "author": "tharikaGitHub", "createdAt": "2020-11-14T04:13:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3NjUwNQ=="}], "type": "inlineReview"}, {"oid": "929acf282539bdf1dd875f64e98ceec5152609c3", "url": "https://github.com/wso2/carbon-apimgt/commit/929acf282539bdf1dd875f64e98ceec5152609c3", "message": "Add review fixes", "committedDate": "2020-11-14T04:11:26Z", "type": "commit"}, {"oid": "018d5210aa1e3abf10db61f8c022bffa4ec91964", "url": "https://github.com/wso2/carbon-apimgt/commit/018d5210aa1e3abf10db61f8c022bffa4ec91964", "message": "Remove search service mock responses", "committedDate": "2020-11-14T04:18:12Z", "type": "commit"}]}