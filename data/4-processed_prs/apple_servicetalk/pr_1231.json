{"pr_number": 1231, "pr_title": "Publisher#flatMapConcatIterable error recovery from Subscriber#onNext\u2026", "pr_createdAt": "2020-11-24T00:53:18Z", "pr_url": "https://github.com/apple/servicetalk/pull/1231", "timeline": [{"oid": "9d5ac3c628a5d8a3680460e021990190e89265ad", "url": "https://github.com/apple/servicetalk/commit/9d5ac3c628a5d8a3680460e021990190e89265ad", "message": "Publisher#flatMapConcatIterable error recovery from Subscriber#onNext throwing\n\nMotivation:\nIf Subscriber#onNext throws in Publisher#flatMapConcatIterable we don't\nreset the currentIterator state if there is no pending requestN demand.\nThis may result in not propagating the error to the downstream\nsubscriber.\n\nModifications:\n- PublisherConcatMapIterable should reset the currentIterator state when\ncatching an exception from Subscriber#onNext\n- PublisherConcatMapIterable should also attempt to close the Iterator\nif an exception is caught from Subscriber methods\n\nResult:\nPublisher#flatMapConcatIterable has more robust exception handling and\nerror propagation.", "committedDate": "2020-11-24T00:47:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTA5MjUwMw==", "url": "https://github.com/apple/servicetalk/pull/1231#discussion_r529092503", "bodyText": "the updated test are in #1229 and depend upon a few core changes (e.g. TestPublisher, TestPublisherSubscriber) so I will defer the testing to that PR with the larger changes.", "author": "Scottmitch", "createdAt": "2020-11-24T00:54:15Z", "path": "servicetalk-concurrent-api/src/test/java/io/servicetalk/concurrent/api/PublisherConcatMapIterableTest.java", "diffHunk": "@@ -315,6 +316,7 @@ public void exceptionFromBufferedOnNextThenOnErrorIsPropagated() {\n         testExceptionFromBufferedOnNextThenTerminalIsPropagated(publisher::onError);\n     }\n \n+    @Ignore(\"fixed in https://github.com/apple/servicetalk/pull/1229\")", "originalCommit": "9d5ac3c628a5d8a3680460e021990190e89265ad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}