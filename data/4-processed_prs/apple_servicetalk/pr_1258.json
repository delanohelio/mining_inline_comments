{"pr_number": 1258, "pr_title": "Github Actions Pull Request Builder", "pr_createdAt": "2020-12-08T23:40:31Z", "pr_url": "https://github.com/apple/servicetalk/pull/1258", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgxNzgxMQ==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539817811", "bodyText": "Because we release using JDK8 we should run quality task on JDK8 as well. Otherwise, there is a risk to fail the release. We observed behavior different for spotbugs on different JDK versions.", "author": "idelpivnitskiy", "createdAt": "2020-12-10T03:29:21Z", "path": ".github/workflows/prb.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# This workflow will build a Java project with Gradle\n+# For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-gradle\n+\n+name: Pull Request Builder\n+\n+on:\n+  pull_request:\n+    branches: [ main ]\n+\n+jobs:\n+  build-jdk8:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: Set up JDK8\n+      uses: actions/setup-java@v1.4.3\n+      with:\n+        java-version: 1.8\n+    - name: Grant execute permission for gradlew\n+      run: chmod +x gradlew\n+    - name: Cache Gradle packages\n+      uses: actions/cache@v2\n+      with:\n+        path: |\n+          ~/.gradle/caches\n+          ~/.gradle/wrapper\n+        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle') }}\n+        restore-keys: ${{ runner.os }}-gradle\n+    - name: Build with Gradle\n+      run: ./gradlew --parallel --max-workers=4 clean test\n+    - name: Publish Test Results\n+      if: ${{ always() }}\n+      uses: scacap/action-surefire-report@v1.0.5\n+      with:\n+        github_token: ${{ secrets.GITHUB_TOKEN }}\n+        report_paths: '**/build/test-results/test/TEST-*.xml'\n+        check_name: JDK8 Test Report\n+\n+  build-jdk11:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: Set up JDK11\n+      uses: actions/setup-java@v1.4.3\n+      with:\n+        java-version: 1.11\n+    - name: Grant execute permission for gradlew\n+      run: chmod +x gradlew\n+    - name: Cache Gradle packages\n+      uses: actions/cache@v2\n+      with:\n+        path: |\n+          ~/.gradle/caches\n+          ~/.gradle/wrapper\n+        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle') }}\n+        restore-keys: ${{ runner.os }}-gradle\n+    - name: Build with Gradle\n+      run: ./gradlew --parallel --max-workers=4 clean test\n+    - name: Publish Test Results\n+      if: ${{ always() }}\n+      uses: scacap/action-surefire-report@v1.0.5\n+      with:\n+        github_token: ${{ secrets.GITHUB_TOKEN }}\n+        report_paths: '**/build/test-results/test/TEST-*.xml'\n+        check_name: JDK11 Test Report\n+\n+  quality-jdk11:", "originalCommit": "12404d1cc358f3e8391640f0eeb3bf73f35e6ff5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgxODQ4Ng==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539818486", "bodyText": "You use name for all other steps, consider using a name here as well", "author": "idelpivnitskiy", "createdAt": "2020-12-10T03:31:16Z", "path": ".github/workflows/prb.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# This workflow will build a Java project with Gradle\n+# For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-gradle\n+\n+name: Pull Request Builder\n+\n+on:\n+  pull_request:\n+    branches: [ main ]\n+\n+jobs:\n+  build-jdk8:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v2", "originalCommit": "12404d1cc358f3e8391640f0eeb3bf73f35e6ff5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyMDc1NQ==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539820755", "bodyText": "Will be nice to try matrix testing: https://github.com/actions/setup-java#matrix-testing\nIf that works in parallel, we can reduce duplication in config file. Will be also great to include the latest JDK15.", "author": "idelpivnitskiy", "createdAt": "2020-12-10T03:37:35Z", "path": ".github/workflows/prb.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# This workflow will build a Java project with Gradle\n+# For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-gradle\n+\n+name: Pull Request Builder\n+\n+on:\n+  pull_request:\n+    branches: [ main ]\n+\n+jobs:\n+  build-jdk8:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: Set up JDK8\n+      uses: actions/setup-java@v1.4.3\n+      with:\n+        java-version: 1.8\n+    - name: Grant execute permission for gradlew\n+      run: chmod +x gradlew\n+    - name: Cache Gradle packages\n+      uses: actions/cache@v2\n+      with:\n+        path: |\n+          ~/.gradle/caches\n+          ~/.gradle/wrapper\n+        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle') }}\n+        restore-keys: ${{ runner.os }}-gradle\n+    - name: Build with Gradle\n+      run: ./gradlew --parallel --max-workers=4 clean test\n+    - name: Publish Test Results\n+      if: ${{ always() }}\n+      uses: scacap/action-surefire-report@v1.0.5\n+      with:\n+        github_token: ${{ secrets.GITHUB_TOKEN }}\n+        report_paths: '**/build/test-results/test/TEST-*.xml'\n+        check_name: JDK8 Test Report\n+\n+  build-jdk11:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: Set up JDK11", "originalCommit": "12404d1cc358f3e8391640f0eeb3bf73f35e6ff5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg0Mzc5MQ==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539843791", "bodyText": "sounds good, let me try this.", "author": "Scottmitch", "createdAt": "2020-12-10T04:52:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyMDc1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyMDg4MA==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539820880", "bodyText": "Consider using v1 to always get the latest version", "author": "idelpivnitskiy", "createdAt": "2020-12-10T03:38:00Z", "path": ".github/workflows/prb.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# This workflow will build a Java project with Gradle\n+# For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-gradle\n+\n+name: Pull Request Builder\n+\n+on:\n+  pull_request:\n+    branches: [ main ]\n+\n+jobs:\n+  build-jdk8:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: Set up JDK8\n+      uses: actions/setup-java@v1.4.3", "originalCommit": "12404d1cc358f3e8391640f0eeb3bf73f35e6ff5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyMzEwMg==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539823102", "bodyText": "Sad that it doesn't print the installed version build number. I believe, 1.8 has the latest version of 1.8.212. Then they switched to 8.0.x pattern. Consider using the major version format (8 and 11) as described here: https://github.com/actions/setup-java#basic", "author": "idelpivnitskiy", "createdAt": "2020-12-10T03:44:58Z", "path": ".github/workflows/prb.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# This workflow will build a Java project with Gradle\n+# For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-gradle\n+\n+name: Pull Request Builder\n+\n+on:\n+  pull_request:\n+    branches: [ main ]\n+\n+jobs:\n+  build-jdk8:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: Set up JDK8\n+      uses: actions/setup-java@v1.4.3\n+      with:\n+        java-version: 1.8", "originalCommit": "12404d1cc358f3e8391640f0eeb3bf73f35e6ff5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyNjEzNg==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539826136", "bodyText": "We can also add a step that executes java -version", "author": "idelpivnitskiy", "createdAt": "2020-12-10T03:54:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyMzEwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg0NDMwMw==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539844303", "bodyText": "adding a print java version step is simple enough", "author": "Scottmitch", "createdAt": "2020-12-10T04:53:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyMzEwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTgyMzU1OA==", "url": "https://github.com/apple/servicetalk/pull/1258#discussion_r539823558", "bodyText": "Consider using v1 to always get the latest minor version", "author": "idelpivnitskiy", "createdAt": "2020-12-10T03:46:31Z", "path": ".github/workflows/prb.yml", "diffHunk": "@@ -0,0 +1,86 @@\n+# This workflow will build a Java project with Gradle\n+# For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-gradle\n+\n+name: Pull Request Builder\n+\n+on:\n+  pull_request:\n+    branches: [ main ]\n+\n+jobs:\n+  build-jdk8:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: Set up JDK8\n+      uses: actions/setup-java@v1.4.3\n+      with:\n+        java-version: 1.8\n+    - name: Grant execute permission for gradlew\n+      run: chmod +x gradlew\n+    - name: Cache Gradle packages\n+      uses: actions/cache@v2\n+      with:\n+        path: |\n+          ~/.gradle/caches\n+          ~/.gradle/wrapper\n+        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle') }}\n+        restore-keys: ${{ runner.os }}-gradle\n+    - name: Build with Gradle\n+      run: ./gradlew --parallel --max-workers=4 clean test\n+    - name: Publish Test Results\n+      if: ${{ always() }}\n+      uses: scacap/action-surefire-report@v1.0.5", "originalCommit": "12404d1cc358f3e8391640f0eeb3bf73f35e6ff5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0906c72b778a78de5853f118e757133e6839f09b", "url": "https://github.com/apple/servicetalk/commit/0906c72b778a78de5853f118e757133e6839f09b", "message": "move CI env", "committedDate": "2020-12-10T05:02:46Z", "type": "forcePushed"}, {"oid": "1b5d1b251f6194b8d0a5cacf0b21ba492b6f522c", "url": "https://github.com/apple/servicetalk/commit/1b5d1b251f6194b8d0a5cacf0b21ba492b6f522c", "message": "Ignore BufferStrategy#sizeOrDurationConcurrent test", "committedDate": "2020-12-10T17:39:10Z", "type": "forcePushed"}, {"oid": "2d62da57d8ecb58f3df056c8e40093891a67c3ed", "url": "https://github.com/apple/servicetalk/commit/2d62da57d8ecb58f3df056c8e40093891a67c3ed", "message": "Ignore BufferStrategy#sizeOrDurationConcurrent test", "committedDate": "2020-12-10T17:42:31Z", "type": "forcePushed"}, {"oid": "4782e8e4467ee18833bea42739fcd7efc1a96bd7", "url": "https://github.com/apple/servicetalk/commit/4782e8e4467ee18833bea42739fcd7efc1a96bd7", "message": "Ignore BufferStrategyTest#sizeOrDurationConcurrent", "committedDate": "2020-12-10T17:50:03Z", "type": "forcePushed"}, {"oid": "c0b8046542ecf0d01295521308c1ea71cd23a5ff", "url": "https://github.com/apple/servicetalk/commit/c0b8046542ecf0d01295521308c1ea71cd23a5ff", "message": "Ignore BufferStrategyTest#sizeOrDurationConcurrent", "committedDate": "2020-12-10T18:21:01Z", "type": "forcePushed"}, {"oid": "fcbc59afcbfb41aa5810f946f7b018f70ef70bc2", "url": "https://github.com/apple/servicetalk/commit/fcbc59afcbfb41aa5810f946f7b018f70ef70bc2", "message": "Github Actions Pull Request Builder", "committedDate": "2020-12-10T18:54:10Z", "type": "commit"}, {"oid": "c2d999c2f1a0ea1eb82ec48d423f9557adf2f936", "url": "https://github.com/apple/servicetalk/commit/c2d999c2f1a0ea1eb82ec48d423f9557adf2f936", "message": "Ignore TcpTransportObserverTest#testConnectionObserverEvents", "committedDate": "2020-12-10T18:54:16Z", "type": "commit"}, {"oid": "c9c666c205112788d0b2a509fe8c0e8c75e30939", "url": "https://github.com/apple/servicetalk/commit/c9c666c205112788d0b2a509fe8c0e8c75e30939", "message": "Ignore StreamObserverTest#maxActiveStreamsViolationError", "committedDate": "2020-12-10T18:54:16Z", "type": "commit"}, {"oid": "e40c0a4eb6ae05a0da5c6ab11b8fe0ea34375063", "url": "https://github.com/apple/servicetalk/commit/e40c0a4eb6ae05a0da5c6ab11b8fe0ea34375063", "message": "Ignore BufferStrategyTest#sizeOrDurationConcurrent", "committedDate": "2020-12-10T18:54:16Z", "type": "commit"}, {"oid": "e40c0a4eb6ae05a0da5c6ab11b8fe0ea34375063", "url": "https://github.com/apple/servicetalk/commit/e40c0a4eb6ae05a0da5c6ab11b8fe0ea34375063", "message": "Ignore BufferStrategyTest#sizeOrDurationConcurrent", "committedDate": "2020-12-10T18:54:16Z", "type": "forcePushed"}]}