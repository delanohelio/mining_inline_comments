{"pr_number": 2051, "pr_title": "Added configuration to embed exception in message instead of using printStackTrace", "pr_createdAt": "2020-11-04T14:59:04Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/2051", "timeline": [{"oid": "d20a47d23187ce5806387d2742beb1531b6d1f0f", "url": "https://github.com/DataDog/dd-trace-java/commit/d20a47d23187ce5806387d2742beb1531b6d1f0f", "message": "Added configuration to embed exception in message", "committedDate": "2020-11-04T14:59:53Z", "type": "commit"}, {"oid": "d20a47d23187ce5806387d2742beb1531b6d1f0f", "url": "https://github.com/DataDog/dd-trace-java/commit/d20a47d23187ce5806387d2742beb1531b6d1f0f", "message": "Added configuration to embed exception in message", "committedDate": "2020-11-04T14:59:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA1NzczNw==", "url": "https://github.com/DataDog/dd-trace-java/pull/2051#discussion_r518057737", "bodyText": "just curious: will this format be compatible with IntelliJ analyse window?", "author": "lb5tr", "createdAt": "2020-11-05T13:40:47Z", "path": "dd-java-agent/agent-logging/src/test/groovy/datadog/trace/logging/simplelogger/SLCompatHelperTest.groovy", "diffHunk": "@@ -97,6 +97,24 @@ class SLCompatHelperTest extends Specification {\n     outputStream.toString() == \"[$thread] ERROR foo - log\\n${NoStackException.getName()}: wrong\\n\"\n   }\n \n+  def \"test logging with an embedded exception in the message\"() {\n+    setup:\n+    def outputStream = new ByteArrayOutputStream()\n+    def printStream = new PrintStream(outputStream, true)\n+    def props = new Properties()\n+    props.setProperty(SLCompatSettings.Keys.EMBED_EXCEPTION, \"true\")\n+    def settings = new SLCompatSettings(props, new Properties(), printStream)\n+    def helper = new SLCompatHelper(\"foo\", settings)\n+    try {\n+      throw new IOException(\"wrong\")\n+    } catch(Exception exception) {\n+      helper.log(LogLevel.ERROR, \"log\", exception)\n+    }\n+\n+    expect:\n+    outputStream.toString() ==~ /^.* ERROR foo - log \\[exception:java\\.io\\.IOException: wrong\\]\\[stack:\\[.*\\]\\]\\n$/", "originalCommit": "d20a47d23187ce5806387d2742beb1531b6d1f0f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODE0MzE0Mg==", "url": "https://github.com/DataDog/dd-trace-java/pull/2051#discussion_r518143142", "bodyText": "good idea! I'll check and in case try to format in a compatible way", "author": "mellon85", "createdAt": "2020-11-05T15:34:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA1NzczNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODY1OTU4Mw==", "url": "https://github.com/DataDog/dd-trace-java/pull/2051#discussion_r518659583", "bodyText": "I had to change the format a bit but it's not compatible, copying anything inside [exception: ... ] will work.", "author": "mellon85", "createdAt": "2020-11-06T10:28:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA1NzczNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNzM0Nw==", "url": "https://github.com/DataDog/dd-trace-java/pull/2051#discussion_r518807347", "bodyText": "If you add a space following exception: and remove the surrounding brackets, would that work?  Seems like simple normalization (without editing the text) would be a useful attribute", "author": "tylerbenson", "createdAt": "2020-11-06T15:01:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA1NzczNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwODExMA==", "url": "https://github.com/DataDog/dd-trace-java/pull/2051#discussion_r518808110", "bodyText": "Oh, looks like maybe you fixed it below...", "author": "tylerbenson", "createdAt": "2020-11-06T15:03:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA1NzczNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTYyNDE5OA==", "url": "https://github.com/DataDog/dd-trace-java/pull/2051#discussion_r519624198", "bodyText": "Yes, it works by just pasting the whole logline, no additional cleaning needed", "author": "mellon85", "createdAt": "2020-11-09T08:20:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA1NzczNw=="}], "type": "inlineReview"}, {"oid": "c298611970f8c1a5e3369940735c67a09f359fdf", "url": "https://github.com/DataDog/dd-trace-java/commit/c298611970f8c1a5e3369940735c67a09f359fdf", "message": "Formatted the stack trace for IntelliJ\n\nChanged the structure of the log to support pasting it in IntelliJ stack\nstrace analyzer", "committedDate": "2020-11-06T12:02:57Z", "type": "commit"}, {"oid": "8c9d7756c007b3144914b1b2ae8fe11fffa388dd", "url": "https://github.com/DataDog/dd-trace-java/commit/8c9d7756c007b3144914b1b2ae8fe11fffa388dd", "message": "Fixed test", "committedDate": "2020-11-06T15:15:54Z", "type": "commit"}]}