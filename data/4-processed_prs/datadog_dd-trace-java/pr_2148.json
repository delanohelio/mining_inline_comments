{"pr_number": 2148, "pr_title": "remove busyspin backoff logic in flaky DDAgentWriterCombinedTest", "pr_createdAt": "2020-12-01T21:17:03Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/2148", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcyODUyMQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/2148#discussion_r533728521", "bodyText": "This makes the writer busy spin until the trace is published iff the queue is full", "author": "richardstartin", "createdAt": "2020-12-01T21:20:19Z", "path": "dd-trace-core/src/test/groovy/datadog/trace/common/writer/DDAgentWriterCombinedTest.groovy", "diffHunk": "@@ -182,6 +184,7 @@ class DDAgentWriterCombinedTest extends DDSpecification {\n     def writer = DDAgentWriter.builder()\n       .agentApi(api)\n       .traceBufferSize(BUFFER_SIZE)\n+      .prioritization(ENSURE_TRACE)", "originalCommit": "9b5dcb7f937c6d13a4fda153a9a8817e406b4002", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "df25e9e3bf65474cac412f81475895e007c32e8f", "url": "https://github.com/DataDog/dd-trace-java/commit/df25e9e3bf65474cac412f81475895e007c32e8f", "message": "remove backoff logic in test default buffer size to speed up test ~70x", "committedDate": "2020-12-01T21:33:04Z", "type": "commit"}, {"oid": "df25e9e3bf65474cac412f81475895e007c32e8f", "url": "https://github.com/DataDog/dd-trace-java/commit/df25e9e3bf65474cac412f81475895e007c32e8f", "message": "remove backoff logic in test default buffer size to speed up test ~70x", "committedDate": "2020-12-01T21:33:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzczNjIyNQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/2148#discussion_r533736225", "bodyText": "Interestingly, this test can now run at what would be one microsecond per trace on my macbook (which still feels like quite a lot)", "author": "richardstartin", "createdAt": "2020-12-01T21:35:07Z", "path": "dd-trace-core/src/test/groovy/datadog/trace/common/writer/DDAgentWriterCombinedTest.groovy", "diffHunk": "@@ -193,11 +194,6 @@ class DDAgentWriterCombinedTest extends DDSpecification {\n     int maxedPayloadTraceCount = ((int) ((mapper.messageBufferSize() - 5) / traceSize))\n     (0..maxedPayloadTraceCount).each {\n       writer.write(minimalTrace)\n-      def start = System.nanoTime()\n-      // (consumer processes a trace in about 20 microseconds", "originalCommit": "df25e9e3bf65474cac412f81475895e007c32e8f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}