{"pr_number": 2102, "pr_title": "Change context store to use Boolean values in servlet instrumentations", "pr_createdAt": "2020-11-20T11:09:27Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/2102", "timeline": [{"oid": "67c0be7598adb8ab1d354d03dd670ec458431b29", "url": "https://github.com/DataDog/dd-trace-java/commit/67c0be7598adb8ab1d354d03dd670ec458431b29", "message": "make it possible to ignore types of HttpServletResponse to avoid need for context store in servlet instrumentation", "committedDate": "2020-11-20T11:24:15Z", "type": "forcePushed"}, {"oid": "07f8683699ef8b87ba367436bca9c890a4f0e14b", "url": "https://github.com/DataDog/dd-trace-java/commit/07f8683699ef8b87ba367436bca9c890a4f0e14b", "message": "make it possible to ignore types of HttpServletResponse to avoid need for context store in servlet instrumentation", "committedDate": "2020-11-20T11:46:05Z", "type": "forcePushed"}, {"oid": "d8ebae49cdddc970c308a6bd462633bcf21b2e09", "url": "https://github.com/DataDog/dd-trace-java/commit/d8ebae49cdddc970c308a6bd462633bcf21b2e09", "message": "more general wrapper detection", "committedDate": "2020-11-20T12:17:00Z", "type": "forcePushed"}, {"oid": "cc46c9553d3f691a8d6cea45a7c2d8d1a52fd4d6", "url": "https://github.com/DataDog/dd-trace-java/commit/cc46c9553d3f691a8d6cea45a7c2d8d1a52fd4d6", "message": "make it possible to ignore types of HttpServletResponse to avoid need for context store in servlet instrumentation", "committedDate": "2020-11-20T12:17:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzcyMjQzNw==", "url": "https://github.com/DataDog/dd-trace-java/pull/2102#discussion_r527722437", "bodyText": "This class name can now be switched to javax.servlet.http.HttpServletResponse", "author": "devinsba", "createdAt": "2020-11-20T14:19:50Z", "path": "dd-java-agent/instrumentation/servlet/request-2/src/main/java/datadog/trace/instrumentation/servlet2/Servlet2Instrumentation.java", "diffHunk": "@@ -53,11 +52,7 @@ public Servlet2Instrumentation() {\n \n   @Override\n   public Map<String, String> contextStore() {\n-    final Map<String, String> contextStores = new HashMap<>();\n-    contextStores.put(\n-        \"javax.servlet.http.HttpServletResponse\", \"javax.servlet.http.HttpServletRequest\");\n-    contextStores.put(\"javax.servlet.ServletResponse\", Integer.class.getName());\n-    return Collections.unmodifiableMap(contextStores);\n+    return Collections.singletonMap(\"javax.servlet.ServletResponse\", Integer.class.getName());", "originalCommit": "cc46c9553d3f691a8d6cea45a7c2d8d1a52fd4d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc1ODExNw==", "url": "https://github.com/DataDog/dd-trace-java/pull/2102#discussion_r527758117", "bodyText": "I changed the way this works since you reviewed so this is still required.", "author": "richardstartin", "createdAt": "2020-11-20T15:13:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzcyMjQzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc1ODgzNw==", "url": "https://github.com/DataDog/dd-trace-java/pull/2102#discussion_r527758837", "bodyText": "\ud83d\udc4d I see that", "author": "devinsba", "createdAt": "2020-11-20T15:15:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzcyMjQzNw=="}], "type": "inlineReview"}, {"oid": "81c884fb49179838d37aea785904742c84a10be7", "url": "https://github.com/DataDog/dd-trace-java/commit/81c884fb49179838d37aea785904742c84a10be7", "message": "inject boolean instead of HttpServletRequest to reduce impact of when field injection fails", "committedDate": "2020-11-20T15:11:53Z", "type": "commit"}, {"oid": "81c884fb49179838d37aea785904742c84a10be7", "url": "https://github.com/DataDog/dd-trace-java/commit/81c884fb49179838d37aea785904742c84a10be7", "message": "inject boolean instead of HttpServletRequest to reduce impact of when field injection fails", "committedDate": "2020-11-20T15:11:53Z", "type": "forcePushed"}]}