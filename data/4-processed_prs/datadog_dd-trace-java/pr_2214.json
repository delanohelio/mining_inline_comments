{"pr_number": 2214, "pr_title": "remove some intrusive tests", "pr_createdAt": "2020-12-16T22:09:30Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/2214", "timeline": [{"oid": "652bb089ec416a949c942834aa00f521642784e8", "url": "https://github.com/DataDog/dd-trace-java/commit/652bb089ec416a949c942834aa00f521642784e8", "message": "remove test reaching into DDSpanContext internals", "committedDate": "2020-12-16T22:03:35Z", "type": "commit"}, {"oid": "189b84626537f8baca363549ae342d8bc0abdaeb", "url": "https://github.com/DataDog/dd-trace-java/commit/189b84626537f8baca363549ae342d8bc0abdaeb", "message": "fix tests reaching into DDAgentApi internals", "committedDate": "2020-12-16T22:08:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDY1OTU1Mw==", "url": "https://github.com/DataDog/dd-trace-java/pull/2214#discussion_r544659553", "bodyText": "I'm tempted to just remove these tests entirely", "author": "richardstartin", "createdAt": "2020-12-16T22:11:20Z", "path": "dd-trace-core/src/test/groovy/datadog/trace/core/CoreTracerTest.groovy", "diffHunk": "@@ -138,11 +138,9 @@ class CoreTracerTest extends DDSpecification {\n \n     when:\n     injectSysConfig(AGENT_UNIX_DOMAIN_SOCKET, uds)", "originalCommit": "189b84626537f8baca363549ae342d8bc0abdaeb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDc2Njc3NQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/2214#discussion_r544766775", "bodyText": "\ud83d\udc4d", "author": "lpriima", "createdAt": "2020-12-17T02:34:38Z", "path": "dd-trace-core/src/main/java/datadog/trace/common/writer/ddagent/DDAgentApi.java", "diffHunk": "@@ -79,7 +79,6 @@\n   private String detectedVersion = null;\n   private boolean agentRunning = false;\n   private boolean agentDiscovered = false;\n-  private boolean usingUnixDomainSockets;", "originalCommit": "189b84626537f8baca363549ae342d8bc0abdaeb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDgwNjg4OA==", "url": "https://github.com/DataDog/dd-trace-java/pull/2214#discussion_r544806888", "bodyText": "DDAgentApi::detectEndpoint still not private and used in other tests after this. It also can be called directly from DDAgentApi ctor. (Maybe after updating more tests in this file which are testing Config in fact).", "author": "lpriima", "createdAt": "2020-12-17T04:39:18Z", "path": "dd-trace-core/src/test/groovy/datadog/trace/core/CoreTracerTest.groovy", "diffHunk": "@@ -190,12 +183,9 @@ class CoreTracerTest extends DDSpecification {\n   def \"verify overriding port\"() {\n     when:\n     injectSysConfig(key, value)\n-    def tracer = CoreTracer.builder().build()\n-    ((DDAgentWriter) tracer.writer).api.detectEndpoint()", "originalCommit": "189b84626537f8baca363549ae342d8bc0abdaeb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDkxNDU2Mw==", "url": "https://github.com/DataDog/dd-trace-java/pull/2214#discussion_r544914563", "bodyText": "Yes, wherever it's used like this, it was replacing some existing use of sendSerializedTraces to the same (side) effect, but there wasn't time to change how the test worked at the time the change was made.", "author": "richardstartin", "createdAt": "2020-12-17T08:53:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDgwNjg4OA=="}], "type": "inlineReview"}]}