{"pr_number": 1325, "pr_title": "Play 2.3 support", "pr_createdAt": "2020-03-18T14:53:24Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/1325", "timeline": [{"oid": "8cc81e743328a6361974134dba77f2cf72c22895", "url": "https://github.com/DataDog/dd-trace-java/commit/8cc81e743328a6361974134dba77f2cf72c22895", "message": "Work so far on netty 3.9", "committedDate": "2020-03-19T20:49:38Z", "type": "forcePushed"}, {"oid": "fb46af9cda14c3d56faca7962b72667b625a5e5f", "url": "https://github.com/DataDog/dd-trace-java/commit/fb46af9cda14c3d56faca7962b72667b625a5e5f", "message": "Work so far", "committedDate": "2020-03-20T10:38:06Z", "type": "forcePushed"}, {"oid": "118054b9cbcf9a0fb0c94705d87c69ba54348c4a", "url": "https://github.com/DataDog/dd-trace-java/commit/118054b9cbcf9a0fb0c94705d87c69ba54348c4a", "message": "Work so far", "committedDate": "2020-03-20T10:46:08Z", "type": "forcePushed"}, {"oid": "5a4ef29e18a6005897b8f8c6598d848f884b9dc7", "url": "https://github.com/DataDog/dd-trace-java/commit/5a4ef29e18a6005897b8f8c6598d848f884b9dc7", "message": "Depend on netty 3.9 instrumentation", "committedDate": "2020-03-20T11:07:25Z", "type": "forcePushed"}, {"oid": "1480962f8defa1341004af24387b6e48794324a4", "url": "https://github.com/DataDog/dd-trace-java/commit/1480962f8defa1341004af24387b6e48794324a4", "message": "Depend on netty 3.9 instrumentation", "committedDate": "2020-03-20T11:09:49Z", "type": "forcePushed"}, {"oid": "a5af460a63687ff771fe7252cb269ac62e7617f5", "url": "https://github.com/DataDog/dd-trace-java/commit/a5af460a63687ff771fe7252cb269ac62e7617f5", "message": "Depend on netty 3.9 instrumentation", "committedDate": "2020-03-20T11:10:49Z", "type": "forcePushed"}, {"oid": "977c1fea56e0ec2e57af1a1516b4b9c40e9951f7", "url": "https://github.com/DataDog/dd-trace-java/commit/977c1fea56e0ec2e57af1a1516b4b9c40e9951f7", "message": "Try to fix client test, not quite", "committedDate": "2020-03-20T14:28:34Z", "type": "forcePushed"}, {"oid": "f274227086b9f43af6052863eead54be2b78094c", "url": "https://github.com/DataDog/dd-trace-java/commit/f274227086b9f43af6052863eead54be2b78094c", "message": "Update to new module name", "committedDate": "2020-03-20T19:14:34Z", "type": "forcePushed"}, {"oid": "80c3660cc6fb163546de57655d47f7e8894632fc", "url": "https://github.com/DataDog/dd-trace-java/commit/80c3660cc6fb163546de57655d47f7e8894632fc", "message": "Fix the latestdeptests", "committedDate": "2020-03-23T18:01:57Z", "type": "forcePushed"}, {"oid": "afdcb92c2e9ac5081cd12140499f7ae0767a078f", "url": "https://github.com/DataDog/dd-trace-java/commit/afdcb92c2e9ac5081cd12140499f7ae0767a078f", "message": "Fix the latestdeptests", "committedDate": "2020-03-23T18:52:33Z", "type": "forcePushed"}, {"oid": "ed830ce96d8cbeeb073f5791e55eb18ef734d068", "url": "https://github.com/DataDog/dd-trace-java/commit/ed830ce96d8cbeeb073f5791e55eb18ef734d068", "message": ":(", "committedDate": "2020-03-23T19:12:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk1MjI3Ng==", "url": "https://github.com/DataDog/dd-trace-java/pull/1325#discussion_r397952276", "bodyText": "Hmmm. This test shouldn\u2019t be passing\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  HttpServerTest.controller(QUERY_PARAM, new ControllerClosureAdapter(Results.Status(ERROR.getStatus).apply(ERROR.getBody)))\n          \n          \n            \n                  HttpServerTest.controller(ERROR, new ControllerClosureAdapter(Results.Status(ERROR.getStatus).apply(ERROR.getBody)))", "author": "devinsba", "createdAt": "2020-03-25T15:36:13Z", "path": "dd-java-agent/instrumentation/play-2.3/src/test/scala/server/SyncServer.scala", "diffHunk": "@@ -0,0 +1,32 @@\n+package server\n+\n+import datadog.trace.agent.test.base.HttpServerTest\n+import datadog.trace.agent.test.base.HttpServerTest.ServerEndpoint._\n+import play.api.mvc.{Action, Handler, Results}\n+import play.api.test.{FakeApplication, TestServer}\n+\n+object SyncServer {\n+  val routes: PartialFunction[(String, String), Handler] = {\n+    case (\"GET\", \"/success\") => Action { request =>\n+      HttpServerTest.controller(SUCCESS, new ControllerClosureAdapter(Results.Status(SUCCESS.getStatus).apply(SUCCESS.getBody)))\n+    }\n+    case (\"GET\", \"/redirect\") => Action { request =>\n+      HttpServerTest.controller(REDIRECT, new ControllerClosureAdapter(Results.Redirect(REDIRECT.getBody, REDIRECT.getStatus)))\n+    }\n+    case (\"GET\", \"/query\") => Action { request =>\n+      HttpServerTest.controller(QUERY_PARAM, new ControllerClosureAdapter(Results.Status(QUERY_PARAM.getStatus).apply(QUERY_PARAM.getBody)))\n+    }\n+    case (\"GET\", \"/error-status\") => Action { request =>\n+      HttpServerTest.controller(QUERY_PARAM, new ControllerClosureAdapter(Results.Status(ERROR.getStatus).apply(ERROR.getBody)))", "originalCommit": "548d450771046ff2bf62039b17cf3a6e38115e99", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAxNDc4Nw==", "url": "https://github.com/DataDog/dd-trace-java/pull/1325#discussion_r398014787", "bodyText": "eh, it only matters for NOT_FOUND", "author": "devinsba", "createdAt": "2020-03-25T16:56:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzk1MjI3Ng=="}], "type": "inlineReview"}, {"oid": "63300bc30a8ae25cb79b3a3b9f178f68492b9c6d", "url": "https://github.com/DataDog/dd-trace-java/commit/63300bc30a8ae25cb79b3a3b9f178f68492b9c6d", "message": "Wrong endpoint", "committedDate": "2020-03-25T17:16:42Z", "type": "forcePushed"}, {"oid": "017a638c2b947dfc479b90cb90c0f5ff0b634288", "url": "https://github.com/DataDog/dd-trace-java/commit/017a638c2b947dfc479b90cb90c0f5ff0b634288", "message": "Wrong endpoint", "committedDate": "2020-03-25T20:31:21Z", "type": "forcePushed"}, {"oid": "73122ea72c563c9ed4b5b0bd604251be766f250b", "url": "https://github.com/DataDog/dd-trace-java/commit/73122ea72c563c9ed4b5b0bd604251be766f250b", "message": "Starting to get tests building", "committedDate": "2020-03-26T14:10:31Z", "type": "commit"}, {"oid": "5cfaf8b2e57403e40399d450f9363872c38727ea", "url": "https://github.com/DataDog/dd-trace-java/commit/5cfaf8b2e57403e40399d450f9363872c38727ea", "message": "Test servers now both work", "committedDate": "2020-03-26T14:10:31Z", "type": "commit"}, {"oid": "d1093a79b8e5d412dcdf51c4116874777dc39e1a", "url": "https://github.com/DataDog/dd-trace-java/commit/d1093a79b8e5d412dcdf51c4116874777dc39e1a", "message": "rename package", "committedDate": "2020-03-26T14:10:31Z", "type": "commit"}, {"oid": "89a0761ab4b0660d24b77abe8f5aaab640503c31", "url": "https://github.com/DataDog/dd-trace-java/commit/89a0761ab4b0660d24b77abe8f5aaab640503c31", "message": "Add typesafe repo and skip bad builds", "committedDate": "2020-03-26T14:10:31Z", "type": "commit"}, {"oid": "485d9cb6c26874663e93171c28bcb72ce182a56b", "url": "https://github.com/DataDog/dd-trace-java/commit/485d9cb6c26874663e93171c28bcb72ce182a56b", "message": "Work so far", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "7f7b7d41cd5c4bdc1bce2f15cd2b63487518b300", "url": "https://github.com/DataDog/dd-trace-java/commit/7f7b7d41cd5c4bdc1bce2f15cd2b63487518b300", "message": "Depend on netty 3.9 instrumentation", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "879d84a162d71b051aed4e64eda5ac3b39850d96", "url": "https://github.com/DataDog/dd-trace-java/commit/879d84a162d71b051aed4e64eda5ac3b39850d96", "message": "Try to fix client test, not quite", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "6fa94ed9ac32ef275a89688a22d0ba33366f0342", "url": "https://github.com/DataDog/dd-trace-java/commit/6fa94ed9ac32ef275a89688a22d0ba33366f0342", "message": "Update to new module name", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "661a8f5a3ecae74f56ae768750f7af7fa31b2e1a", "url": "https://github.com/DataDog/dd-trace-java/commit/661a8f5a3ecae74f56ae768750f7af7fa31b2e1a", "message": "Fix the latestdeptests", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "8dd5993a8fb74c890cc1442f74edd3feed0ff1a3", "url": "https://github.com/DataDog/dd-trace-java/commit/8dd5993a8fb74c890cc1442f74edd3feed0ff1a3", "message": "Fix codenarc", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "d3def8ce2d892ff2a6a49a6e4767c8acfc619e94", "url": "https://github.com/DataDog/dd-trace-java/commit/d3def8ce2d892ff2a6a49a6e4767c8acfc619e94", "message": ":(", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "acba3626dce035df543098252feabca06d8dce14", "url": "https://github.com/DataDog/dd-trace-java/commit/acba3626dce035df543098252feabca06d8dce14", "message": "Missed a static import", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "08e9f8c6e2a1b5d379ca07160b67b6960a783aae", "url": "https://github.com/DataDog/dd-trace-java/commit/08e9f8c6e2a1b5d379ca07160b67b6960a783aae", "message": "Undo star import", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "026072b866806b2acd207bda83f147e2f785b138", "url": "https://github.com/DataDog/dd-trace-java/commit/026072b866806b2acd207bda83f147e2f785b138", "message": "Wrong endpoint", "committedDate": "2020-03-26T14:10:32Z", "type": "commit"}, {"oid": "026072b866806b2acd207bda83f147e2f785b138", "url": "https://github.com/DataDog/dd-trace-java/commit/026072b866806b2acd207bda83f147e2f785b138", "message": "Wrong endpoint", "committedDate": "2020-03-26T14:10:32Z", "type": "forcePushed"}, {"oid": "fbb43840d39ee5385413505e623caf175656e684", "url": "https://github.com/DataDog/dd-trace-java/commit/fbb43840d39ee5385413505e623caf175656e684", "message": "Fix new client tests", "committedDate": "2020-03-26T18:29:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njc0MjgzNA==", "url": "https://github.com/DataDog/dd-trace-java/pull/1325#discussion_r396742834", "bodyText": "just MUZZLE_REPOS = Arrays.asList(central, typesafe) ?", "author": "lpriima", "createdAt": "2020-03-23T20:40:15Z", "path": "buildSrc/src/main/groovy/MuzzlePlugin.groovy", "diffHunk": "@@ -36,7 +37,8 @@ class MuzzlePlugin implements Plugin<Project> {\n   private static final AtomicReference<ClassLoader> TOOLING_LOADER = new AtomicReference<>()\n   static {\n     RemoteRepository central = new RemoteRepository.Builder(\"central\", \"default\", \"https://repo1.maven.org/maven2/\").build()\n-    MUZZLE_REPOS = new ArrayList<RemoteRepository>(Arrays.asList(central))\n+    RemoteRepository typesafe = new RemoteRepository.Builder(\"typesafe\", \"default\", \"https://repo.typesafe.com/typesafe/releases\").build()\n+    MUZZLE_REPOS = new ArrayList<RemoteRepository>(Arrays.asList(central, typesafe))", "originalCommit": "548d450771046ff2bf62039b17cf3a6e38115e99", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}