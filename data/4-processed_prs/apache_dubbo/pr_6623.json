{"pr_number": 6623, "pr_title": "Feat: add life cycle probe in dubbo-qos", "pr_createdAt": "2020-08-18T13:25:26Z", "pr_url": "https://github.com/apache/dubbo/pull/6623", "timeline": [{"oid": "1eb7343932324d958da69d601e3621e100fcf9f9", "url": "https://github.com/apache/dubbo/commit/1eb7343932324d958da69d601e3621e100fcf9f9", "message": "feat: add port modification of MetadataService, add ServiceIntance Metadata fetch interface to MetadataService", "committedDate": "2020-08-10T14:20:07Z", "type": "commit"}, {"oid": "b6c892c89f238618f24793cee106c0453d0be3ca", "url": "https://github.com/apache/dubbo/commit/b6c892c89f238618f24793cee106c0453d0be3ca", "message": "fix: remove unnecessary wrap", "committedDate": "2020-08-10T14:24:27Z", "type": "commit"}, {"oid": "4173a769b7ff43f9bf71bb71d656ea15a2f523a1", "url": "https://github.com/apache/dubbo/commit/4173a769b7ff43f9bf71bb71d656ea15a2f523a1", "message": "style: pretty warn message when port not specified in consumer side", "committedDate": "2020-08-10T14:44:36Z", "type": "commit"}, {"oid": "fa222a2f85f1dce3f4d1aa1b35be293298da8f5c", "url": "https://github.com/apache/dubbo/commit/fa222a2f85f1dce3f4d1aa1b35be293298da8f5c", "message": "fix: remove reconnect method of MetadataService", "committedDate": "2020-08-12T08:44:09Z", "type": "commit"}, {"oid": "b2cf3508271fdc260b293fe5f15600bd6835c2af", "url": "https://github.com/apache/dubbo/commit/b2cf3508271fdc260b293fe5f15600bd6835c2af", "message": "fix: add SUBSCRIBED_SERVICE_NAMES_KEY support", "committedDate": "2020-08-12T11:03:37Z", "type": "commit"}, {"oid": "ee1e58a97f2e3e041bb21f867678d32229af059d", "url": "https://github.com/apache/dubbo/commit/ee1e58a97f2e3e041bb21f867678d32229af059d", "message": "feat: add http code support for qos-http", "committedDate": "2020-08-13T06:26:43Z", "type": "commit"}, {"oid": "71aaee01002a81916937e5afdd42ec9f2131acbb", "url": "https://github.com/apache/dubbo/commit/71aaee01002a81916937e5afdd42ec9f2131acbb", "message": "feat: modify ready to startup indicate", "committedDate": "2020-08-13T06:27:15Z", "type": "commit"}, {"oid": "e0b700e447bd2f1eb2fa52b5b58f3ddea777102a", "url": "https://github.com/apache/dubbo/commit/e0b700e447bd2f1eb2fa52b5b58f3ddea777102a", "message": "Merge branch '3.0-k8s' into 3.0-k8sprobe", "committedDate": "2020-08-13T06:27:25Z", "type": "commit"}, {"oid": "8f27c56a1e566da2dbcafbd2a120496c5dea32e8", "url": "https://github.com/apache/dubbo/commit/8f27c56a1e566da2dbcafbd2a120496c5dea32e8", "message": "Merge branch '3.0-k8s' into 3.0-k8sprobe", "committedDate": "2020-08-18T12:27:49Z", "type": "commit"}, {"oid": "8137b0cbeef88107072442a0eefc84954155c5ef", "url": "https://github.com/apache/dubbo/commit/8137b0cbeef88107072442a0eefc84954155c5ef", "message": "feat: introduce k8s probe", "committedDate": "2020-08-18T12:58:27Z", "type": "commit"}, {"oid": "91d67b7cfc7f75982a3f0b5a3c554daa4635b10a", "url": "https://github.com/apache/dubbo/commit/91d67b7cfc7f75982a3f0b5a3c554daa4635b10a", "message": "feat: polish comment", "committedDate": "2020-08-18T13:21:05Z", "type": "commit"}, {"oid": "89695573b00e74f6b6d9c5ba7329d400b133e85f", "url": "https://github.com/apache/dubbo/commit/89695573b00e74f6b6d9c5ba7329d400b133e85f", "message": "fix: spi file error", "committedDate": "2020-08-21T13:56:46Z", "type": "commit"}, {"oid": "8f28b6b08885e8a580aeaa192173a40e39d04382", "url": "https://github.com/apache/dubbo/commit/8f28b6b08885e8a580aeaa192173a40e39d04382", "message": "fix: spi file error", "committedDate": "2020-08-21T14:04:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODIwODE2OQ==", "url": "https://github.com/apache/dubbo/pull/6623#discussion_r478208169", "bodyText": "I didn't find the definition of this class.", "author": "chickenlj", "createdAt": "2020-08-27T07:18:50Z", "path": "dubbo-plugin/dubbo-qos/src/main/resources/META-INF/dubbo/internal/org.apache.dubbo.qos.probe.ReadinessProbe", "diffHunk": "@@ -0,0 +1,2 @@\n+bootstrap = org.apache.dubbo.qos.probe.impl.BootstrapReadinessProbe", "originalCommit": "8f28b6b08885e8a580aeaa192173a40e39d04382", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODIwODcxNQ==", "url": "https://github.com/apache/dubbo/pull/6623#discussion_r478208715", "bodyText": "I think checking whether ServiceInstance has been registered would be enough.", "author": "chickenlj", "createdAt": "2020-08-27T07:19:54Z", "path": "dubbo-plugin/dubbo-qos/src/main/java/org/apache/dubbo/qos/probe/impl/ProviderReadinessProbe.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.dubbo.qos.probe.impl;\n+\n+import org.apache.dubbo.qos.probe.ReadinessProbe;\n+import org.apache.dubbo.rpc.model.ApplicationModel;\n+import org.apache.dubbo.rpc.model.ProviderModel;\n+import org.apache.dubbo.rpc.model.ServiceRepository;\n+\n+import java.util.Collection;\n+import java.util.List;\n+\n+public class ProviderReadinessProbe implements ReadinessProbe {\n+    private static ServiceRepository serviceRepository = ApplicationModel.getServiceRepository();\n+\n+    @Override\n+    public boolean check() {", "originalCommit": "8f28b6b08885e8a580aeaa192173a40e39d04382", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODIxNDMxOA==", "url": "https://github.com/apache/dubbo/pull/6623#discussion_r478214318", "bodyText": "Readiness probe is used in total life cycle. If readiness probe failed, the endpoint will temporarily be removed from service. ServiceInstance is registered when startup.", "author": "AlbumenJ", "createdAt": "2020-08-27T07:30:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODIwODcxNQ=="}], "type": "inlineReview"}, {"oid": "0c1c6810b905446ceb9d96e89ec838e1d3092a94", "url": "https://github.com/apache/dubbo/commit/0c1c6810b905446ceb9d96e89ec838e1d3092a94", "message": "fix: add activate extension support, fix name error", "committedDate": "2020-08-27T07:57:14Z", "type": "commit"}, {"oid": "f7febff9ecc322d5b09656c6a60a802878f7f5ab", "url": "https://github.com/apache/dubbo/commit/f7febff9ecc322d5b09656c6a60a802878f7f5ab", "message": "fix: add activate extension support", "committedDate": "2020-08-27T09:01:41Z", "type": "commit"}]}