{"pr_number": 52635, "pr_title": "[Docs] Clarify default value for `allow_no_indices`", "pr_createdAt": "2020-02-21T11:32:10Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52635", "timeline": [{"oid": "63d9500066d31e5fd68a52d2df4bbb21958e215f", "url": "https://github.com/elastic/elasticsearch/commit/63d9500066d31e5fd68a52d2df4bbb21958e215f", "message": "[Docs] Clarify default value for `allow_no_indices`\n\nAdd a cliarification that default value is `true`, so no error\nis returned if no index is matched.\n\nFixes: #52534", "committedDate": "2020-02-21T11:30:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU2MDY1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382560659", "bodyText": "I'm afraid that the default value here depends on the API, or is it true for all APIs?", "author": "javanna", "createdAt": "2020-02-21T12:41:42Z", "path": "docs/reference/rest-api/common-parms.asciidoc", "diffHunk": "@@ -42,6 +42,7 @@ tag::allow-no-indices[]\n the request does *not* return an error\n if a wildcard expression\n or `_all` value retrieves only missing or closed indices.\n+Defaults to `true`.", "originalCommit": "63d9500066d31e5fd68a52d2df4bbb21958e215f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU2Njg1OA==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382566858", "bodyText": "I tried some of them like HEAD, _mapping, _forgemerge and they behave the same.", "author": "matriv", "createdAt": "2020-02-21T12:56:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU2MDY1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU3NzkxOQ==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382577919", "bodyText": "The default is API dependant. For example the put mapping api defaults to false.", "author": "martijnvg", "createdAt": "2020-02-21T13:22:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU2MDY1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU4NDY5OQ==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382584699", "bodyText": "I see, should we just add a sentence that the default value depends on the API instead?", "author": "matriv", "createdAt": "2020-02-21T13:38:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU2MDY1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU4NTc5Mw==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382585793", "bodyText": "You can add the default value where the definition is included instead:\ninclude::{docdir}/rest-api/common-parms.asciidoc[tag=allow-no-indices]\n+\nDefaults to `true`.", "author": "jrodewig", "createdAt": "2020-02-21T13:40:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU2MDY1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU5MTI0Mw==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382591243", "bodyText": "@jrodewig ++", "author": "javanna", "createdAt": "2020-02-21T13:52:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU2MDY1OQ=="}], "type": "inlineReview"}, {"oid": "20d0bbf1ca75c5bd67eabdb20e5dc313cfac85e2", "url": "https://github.com/elastic/elasticsearch/commit/20d0bbf1ca75c5bd67eabdb20e5dc313cfac85e2", "message": "add defaults to all doc references", "committedDate": "2020-02-21T17:11:24Z", "type": "commit"}, {"oid": "7ecc1f908d1690e10905b681172d931a941ee595", "url": "https://github.com/elastic/elasticsearch/commit/7ecc1f908d1690e10905b681172d931a941ee595", "message": "fix docs", "committedDate": "2020-02-21T17:27:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0MzQ1MA==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382743450", "bodyText": "I believe this is on the wrong parameter (analyzer).\nHowever, when I tested allow_no_indices on the update by query API, it had no effect on whether an error was returned. Perhaps the parameter should be removed here? nvm. user error. \ud83d\ude04", "author": "jrodewig", "createdAt": "2020-02-21T18:42:38Z", "path": "docs/reference/docs/update-by-query.asciidoc", "diffHunk": "@@ -158,6 +158,8 @@ or omit to search all indices.\n include::{docdir}/rest-api/common-parms.asciidoc[tag=allow-no-indices]\n \n include::{docdir}/rest-api/common-parms.asciidoc[tag=analyzer]\n++\n+Defaults to `true`.", "originalCommit": "7ecc1f908d1690e10905b681172d931a941ee595", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0NzA0MA==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382747040", "bodyText": "localhost:9200/index-2*/_update_by_query?conflicts=proceed&allow_no_indices=false:\n{\n    \"error\": {\n        \"root_cause\": [\n            {\n                \"type\": \"index_not_found_exception\",\n                \"reason\": \"no such index [index-2*]\",\n                \"resource.type\": \"index_or_alias\",\n                \"resource.id\": \"index-2*\",\n                \"index_uuid\": \"_na_\",\n                \"index\": \"index-2*\"\n            }\n        ],\n        \"type\": \"index_not_found_exception\",\n        \"reason\": \"no such index [index-2*]\",\n        \"resource.type\": \"index_or_alias\",\n        \"resource.id\": \"index-2*\",\n        \"index_uuid\": \"_na_\",\n        \"index\": \"index-2*\"\n    },\n    \"status\": 404\n}\n\nlocalhost:9200/index-2*/_update_by_query?conflicts=proceed:\n{\n    \"took\": 0,\n    \"timed_out\": false,\n    \"total\": 0,\n    \"updated\": 0,\n    \"deleted\": 0,\n    \"batches\": 0,\n    \"version_conflicts\": 0,\n    \"noops\": 0,\n    \"retries\": {\n        \"bulk\": 0,\n        \"search\": 0\n    },\n    \"throttled_millis\": 0,\n    \"requests_per_second\": -1.0,\n    \"throttled_until_millis\": 0,\n    \"failures\": []\n}", "author": "matriv", "createdAt": "2020-02-21T18:50:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0MzQ1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0NzM3OQ==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382747379", "bodyText": "Sorry about that. I made a mistake in my test setup.", "author": "jrodewig", "createdAt": "2020-02-21T18:51:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0MzQ1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0ODcxNg==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382748716", "bodyText": "No worries at all, I didn't see your edit in time and tried it once more myself.", "author": "matriv", "createdAt": "2020-02-21T18:53:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0MzQ1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0ODcyMw==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382748723", "bodyText": "However, we should still move the default value to the allow_no_indices parm.", "author": "jrodewig", "createdAt": "2020-02-21T18:53:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0MzQ1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0NDA5NQ==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382744095", "bodyText": "\ud83d\udc4d", "author": "jrodewig", "createdAt": "2020-02-21T18:44:00Z", "path": "docs/reference/indices/alias-exists.asciidoc", "diffHunk": "@@ -36,8 +36,6 @@ include::{docdir}/rest-api/common-parms.asciidoc[tag=index]\n [[alias-exists-api-query-params]]\n ==== {api-query-parms-title}\n \n-include::{docdir}/rest-api/common-parms.asciidoc[tag=allow-no-indices]\n-", "originalCommit": "7ecc1f908d1690e10905b681172d931a941ee595", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0ODE2Nw==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382748167", "bodyText": "I'm not 100% sure.\nThe mechanism is different, but the outcome the same (status 200 or 404).\nIf allow_no_indices=false and no index is matched then we get an exception at the index name resolution phase which is translated to 404.\nIf allow_no_indices=true and no index is matched then no aliases are found and this is again translated to 404.", "author": "matriv", "createdAt": "2020-02-21T18:52:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0NDA5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc1NTY2MQ==", "url": "https://github.com/elastic/elasticsearch/pull/52635#discussion_r382755661", "bodyText": "I think we should probably remove documentation for this parameter. It's not useful to the end user and the outcome will be the same regardless. Thanks for catching this @matriv.", "author": "jrodewig", "createdAt": "2020-02-21T19:09:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc0NDA5NQ=="}], "type": "inlineReview"}, {"oid": "9902b34090f79828165c6b6bf61821d723a83e2d", "url": "https://github.com/elastic/elasticsearch/commit/9902b34090f79828165c6b6bf61821d723a83e2d", "message": "Address comment, add for cluster state api", "committedDate": "2020-02-21T19:22:15Z", "type": "commit"}]}