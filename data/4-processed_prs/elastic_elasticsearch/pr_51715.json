{"pr_number": 51715, "pr_title": "Telemetry data initial implementation", "pr_createdAt": "2020-01-30T23:23:16Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/51715", "timeline": [{"oid": "87eb31be28fbe9c22c274fb3f7192e2127d0d507", "url": "https://github.com/elastic/elasticsearch/commit/87eb31be28fbe9c22c274fb3f7192e2127d0d507", "message": "Initial commit for telemetry data", "committedDate": "2020-01-30T23:17:10Z", "type": "commit"}, {"oid": "b55dc6f0434c1687896a3470a20b5abb2ff75543", "url": "https://github.com/elastic/elasticsearch/commit/b55dc6f0434c1687896a3470a20b5abb2ff75543", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into 49630_impl", "committedDate": "2020-01-30T23:17:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUxMjYzOA==", "url": "https://github.com/elastic/elasticsearch/pull/51715#discussion_r373512638", "bodyText": "This setting already exists in EqlPlugin. Strange that it didn't fail in testing.", "author": "imotov", "createdAt": "2020-01-31T14:41:15Z", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/XPackSettings.java", "diffHunk": "@@ -124,6 +124,9 @@ private XPackSettings() {\n     public static final Setting<Boolean> FIPS_MODE_ENABLED =\n         Setting.boolSetting(\"xpack.security.fips_mode.enabled\", false, Property.NodeScope);\n \n+    /** Setting for enabling or disabling eql. Defaults to true. */\n+    public static final Setting<Boolean> EQL_ENABLED = Setting.boolSetting(\"xpack.eql.enabled\", true, Setting.Property.NodeScope);", "originalCommit": "b55dc6f0434c1687896a3470a20b5abb2ff75543", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc0MDU0OQ==", "url": "https://github.com/elastic/elasticsearch/pull/51715#discussion_r374740549", "bodyText": "@imotov should this setting only exist in EqlPlugin for the moment, and when EQL it's ready to go, move the setting to XPackSettings?", "author": "astefan", "createdAt": "2020-02-04T15:28:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUxMjYzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc0NTY2OQ==", "url": "https://github.com/elastic/elasticsearch/pull/51715#discussion_r374745669", "bodyText": "I think the placement of this setting is not as important as having it in one place only and disabling completely in non-snapshot builds. I don't see any issues with moving it in XPackSettings as long as we disable it there for non-snapshot builds.", "author": "imotov", "createdAt": "2020-02-04T15:36:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUxMjYzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUxMzY2NQ==", "url": "https://github.com/elastic/elasticsearch/pull/51715#discussion_r373513665", "bodyText": "That will probably fail in release build, where we disable EQL", "author": "imotov", "createdAt": "2020-01-31T14:43:09Z", "path": "docs/reference/rest-api/info.asciidoc", "diffHunk": "@@ -119,6 +119,10 @@ Example response:\n          \"available\" : true,\n          \"enabled\" : true\n       },\n+      \"eql\" : {\n+         \"available\" : true,\n+         \"enabled\" : true\n+      },", "originalCommit": "b55dc6f0434c1687896a3470a20b5abb2ff75543", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgzNjE0OA==", "url": "https://github.com/elastic/elasticsearch/pull/51715#discussion_r374836148", "bodyText": "That fails in non-snapshot build with the following error:\norg.elasticsearch.smoketest.DocsClientYamlTestSuiteIT > test {yaml=reference/rest-api/info/line_45} FAILED\n    java.lang.AssertionError: Failure at [reference/rest-api/info:16]: $body didn't match expected value:\n                             $body: \n                               build: \n                                  date: same [2020-02-04T18:01:06.694307Z]\n                                  hash: same [12b24bfa57ae3b282427298cffc735ab9fe5868f]\n                            features: \n                             analytics: \n                               available: same [true]\n                                 enabled: same [true]\n                                   ccr: \n                               available: same [true]\n                                 enabled: same [true]\n                                enrich: \n                               available: same [true]\n                                 enabled: same [true]\n                                   eql: \n                               available: same [true]\n                                 enabled: expected Boolean [true] but was Boolean [false]\n                             flattened: \n                               available: same [true]\n                                 enabled: same [true]\n                        frozen_indices: \n                               available: same [true]\n                                 enabled: same [true]\n                                 graph: \n                               available: same [true]\n                                 enabled: same [true]\n                                   ilm: \n                               available: same [true]\n                                 enabled: same [true]\n                              logstash: \n                               available: same [true]\n                                 enabled: same [true]\n                                    ml: \n                               available: same [true]\n                                 enabled: same [true]\n                            monitoring: \n                               available: same [true]\n                                 enabled: same [true]\n                                rollup: \n                               available: same [true]\n                                 enabled: same [true]\n                              security: \n                               available: same [true]\n                                 enabled: same [false]\n                                   slm: \n                               available: same [true]\n                                 enabled: same [true]\n                               spatial: \n                               available: same [true]\n                                 enabled: same [true]\n                                   sql: \n                               available: same [true]\n                                 enabled: same [true]\n                             transform: \n                               available: same [true]\n                                 enabled: same [true]\n                               vectors: \n                               available: same [true]\n                                 enabled: same [true]\n                           voting_only: \n                               available: same [true]\n                                 enabled: same [true]\n                               watcher: \n                               available: same [true]\n                                 enabled: same [true]\n                             license: \n                 expiry_date_in_millis: same [1583431616962]\n                                  mode: same [trial]\n                                status: same [active]\n                                  type: same [trial]\n                                   uid: same [14927092-6926-43a8-84b9-af6fd185696f]\n                             tagline: same [You know, for X]\n        at __randomizedtesting.SeedInfo.seed([31BF956B0BB813AA:B9EBAAB1A5447E52]:0)\n        at org.elasticsearch.test.rest.yaml.ESClientYamlSuiteTestCase.executeSection(ESClientYamlSuiteTestCase.java:405)\n        at org.elasticsearch.test.rest.yaml.ESClientYamlSuiteTestCase.test(ESClientYamlSuiteTestCase.java:382)\n        at jdk.internal.reflect.GeneratedMethodAccessor11.invoke(Unknown Source)\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1750)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$8.evaluate(RandomizedRunner.java:938)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$9.evaluate(RandomizedRunner.java:974)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$10.evaluate(RandomizedRunner.java:988)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:49)\n        at org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n        at org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:48)\n        at org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\n        at org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:368)\n        at com.carrotsearch.randomizedtesting.ThreadLeakControl.forkTimeoutingTask(ThreadLeakControl.java:817)\n        at com.carrotsearch.randomizedtesting.ThreadLeakControl$3.evaluate(ThreadLeakControl.java:468)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:947)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:832)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:883)\n        at com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:894)\n        at org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:41)\n        at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\n        at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53)\n        at org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\n        at org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\n        at org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54)\n        at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n        at com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:368)\n        at java.base/java.lang.Thread.run(Thread.java:834)", "author": "imotov", "createdAt": "2020-02-04T18:11:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzUxMzY2NQ=="}], "type": "inlineReview"}, {"oid": "9dbc11393a0585426617e9a166c5491a45a82d93", "url": "https://github.com/elastic/elasticsearch/commit/9dbc11393a0585426617e9a166c5491a45a82d93", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into 49630_impl", "committedDate": "2020-02-04T15:41:13Z", "type": "commit"}, {"oid": "c790c85a84183ef3467af94d69dee2d8787038f5", "url": "https://github.com/elastic/elasticsearch/commit/c790c85a84183ef3467af94d69dee2d8787038f5", "message": "Remove EQL_ENABLED setting from EqlPlugin", "committedDate": "2020-02-04T17:40:32Z", "type": "commit"}, {"oid": "77611be9c1c18747ab9d1172f5c365d3bad0706c", "url": "https://github.com/elastic/elasticsearch/commit/77611be9c1c18747ab9d1172f5c365d3bad0706c", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into 49630_impl", "committedDate": "2020-02-04T17:44:41Z", "type": "commit"}, {"oid": "f3ce203b7c498445fb6c83ccf2b5fb3557d508ce", "url": "https://github.com/elastic/elasticsearch/commit/f3ce203b7c498445fb6c83ccf2b5fb3557d508ce", "message": "Revert back the EQL_ENABLED setting to EqlPlugin class", "committedDate": "2020-02-06T15:52:32Z", "type": "commit"}, {"oid": "3dd3671902f0b227e940b4f3196a0b9ad6c9006e", "url": "https://github.com/elastic/elasticsearch/commit/3dd3671902f0b227e940b4f3196a0b9ad6c9006e", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into 49630_impl", "committedDate": "2020-02-06T16:17:54Z", "type": "commit"}, {"oid": "7f1a2edc8255e7a4b8b899e0dab0d944410428a8", "url": "https://github.com/elastic/elasticsearch/commit/7f1a2edc8255e7a4b8b899e0dab0d944410428a8", "message": "Merge branch 'master' into 49630_impl", "committedDate": "2020-02-06T23:36:49Z", "type": "commit"}]}