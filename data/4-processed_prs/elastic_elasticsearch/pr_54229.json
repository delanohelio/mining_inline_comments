{"pr_number": 54229, "pr_title": "Allow keystore add to handle multiple settings", "pr_createdAt": "2020-03-25T20:05:35Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/54229", "timeline": [{"oid": "99c6b22003653ea63ab7cf9bf8a97629407dbde1", "url": "https://github.com/elastic/elasticsearch/commit/99c6b22003653ea63ab7cf9bf8a97629407dbde1", "message": "Allow keystore add to handle multiple settings\n\nToday the keystore add command can only handle adding a single\nsetting/value pair in a single invocation. This incurs the startup costs\nof the JVM many times, which in some environments can be expensive. This\ncommit teaches the add keystore command to accept adding multiple\nsettings in a single invocation.", "committedDate": "2020-03-25T20:02:00Z", "type": "commit"}, {"oid": "e08bca8eeeb3998ace9dd4b40eab9a7385b10ba1", "url": "https://github.com/elastic/elasticsearch/commit/e08bca8eeeb3998ace9dd4b40eab9a7385b10ba1", "message": "Fix checkstyle", "committedDate": "2020-03-25T20:15:31Z", "type": "commit"}, {"oid": "9f66508d42bff2a4c0b462d6778f2d4b13e80902", "url": "https://github.com/elastic/elasticsearch/commit/9f66508d42bff2a4c0b462d6778f2d4b13e80902", "message": "Merge remote-tracking branch 'elastic/master' into keystore-add-multiple-settings", "committedDate": "2020-03-25T20:15:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3MTM2MQ==", "url": "https://github.com/elastic/elasticsearch/pull/54229#discussion_r398171361", "bodyText": "Would it be worth updating the equivalent text in RemoveSettingKeyStoreCommand? It still talks about removing \"a setting\" from the keystore, but it already supports multiple settings.", "author": "pugnascotia", "createdAt": "2020-03-25T21:10:12Z", "path": "distribution/tools/keystore-cli/src/main/java/org/elasticsearch/common/settings/AddStringKeyStoreCommand.java", "diffHunk": "@@ -42,13 +46,13 @@\n     private final OptionSpec<String> arguments;\n \n     AddStringKeyStoreCommand() {\n-        super(\"Add a string setting to the keystore\", false);\n-        this.stdinOption = parser.acceptsAll(Arrays.asList(\"x\", \"stdin\"), \"Read setting value from stdin\");\n+        super(\"Add string settings to the keystore\", false);", "originalCommit": "9f66508d42bff2a4c0b462d6778f2d4b13e80902", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE4MzAzNA==", "url": "https://github.com/elastic/elasticsearch/pull/54229#discussion_r398183034", "bodyText": "I will handle this in a follow up.", "author": "jasontedor", "createdAt": "2020-03-25T21:32:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3MTM2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI5MjI0Mw==", "url": "https://github.com/elastic/elasticsearch/pull/54229#discussion_r398292243", "bodyText": "I opened #54244.", "author": "jasontedor", "createdAt": "2020-03-26T03:06:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3MTM2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3MjA2MA==", "url": "https://github.com/elastic/elasticsearch/pull/54229#discussion_r398172060", "bodyText": "Should we document -x too?", "author": "pugnascotia", "createdAt": "2020-03-25T21:11:30Z", "path": "docs/reference/commands/keystore.asciidoc", "diffHunk": "@@ -70,12 +71,14 @@ protected, you are prompted to enter the current password and the new one. You\n can optionally use an empty string to remove the password. If the keystore is\n not password protected, you can use this command to set a password.\n \n-`remove <setting>`:: Removes a setting from the keystore.\n+`remove <settings>`:: Removes settings from the keystore. Multiple setting\n+names can be specified as arguments to the `add` command.\n \n `-s, --silent`:: Shows minimal output.\n \n-`--stdin`:: When used with the `add` parameter, you can pass the setting value\n-through standard input (stdin). See <<add-string-to-keystore>>.\n+`--stdin`:: When used with the `add` parameter, you can pass the settings values", "originalCommit": "9f66508d42bff2a4c0b462d6778f2d4b13e80902", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3MjQ1Mw==", "url": "https://github.com/elastic/elasticsearch/pull/54229#discussion_r398172453", "bodyText": "I notice we only have -f without --force as well.", "author": "pugnascotia", "createdAt": "2020-03-25T21:12:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3MjA2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE4Mjk1Nw==", "url": "https://github.com/elastic/elasticsearch/pull/54229#discussion_r398182957", "bodyText": "Thanks for noticing these. Since these are orthogonal to this change, I will handle them in a follow up.", "author": "jasontedor", "createdAt": "2020-03-25T21:31:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3MjA2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI5MTIzOQ==", "url": "https://github.com/elastic/elasticsearch/pull/54229#discussion_r398291239", "bodyText": "I opened #54242.", "author": "jasontedor", "createdAt": "2020-03-26T03:02:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3MjA2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI2MDc0OQ==", "url": "https://github.com/elastic/elasticsearch/pull/54229#discussion_r398260749", "bodyText": "the setting -> a setting", "author": "rjernst", "createdAt": "2020-03-26T01:07:34Z", "path": "docs/reference/commands/keystore.asciidoc", "diffHunk": "@@ -40,12 +40,13 @@ keystore, see the setting reference.\n [[elasticsearch-keystore-parameters]]\n === Parameters\n \n-`add <setting>`:: Adds settings to the keystore. By default, you are prompted\n-for the value of the setting. If the keystore is password protected, you are\n-also prompted to enter the password. If the setting already exists in the\n-keystore, you must confirm that you want to overwrite the current value. If the\n-keystore does not exist, you must confirm that you want to create a keystore. To\n-avoid these two confirmation prompts, use the `-f` parameter.\n+`add <settings>`:: Adds settings to the keystore. Multiple setting names can be\n+specified as arguments to the `add` command. By default, you are prompted for\n+the values of the settings. If the keystore is password protected, you are also\n+prompted to enter the password. If the setting already exists in the keystore,", "originalCommit": "9f66508d42bff2a4c0b462d6778f2d4b13e80902", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e822f192379cab2f45b115d6ce91024ac0acf5f3", "url": "https://github.com/elastic/elasticsearch/commit/e822f192379cab2f45b115d6ce91024ac0acf5f3", "message": "Fix docs", "committedDate": "2020-03-26T01:10:31Z", "type": "commit"}]}