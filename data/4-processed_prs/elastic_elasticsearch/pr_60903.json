{"pr_number": 60903, "pr_title": "[DOCS] Move post filter/rescore content to new page", "pr_createdAt": "2020-08-10T14:12:39Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/60903", "timeline": [{"oid": "b96c120a1242b2a4870b374661dd0a458a148ae6", "url": "https://github.com/elastic/elasticsearch/commit/b96c120a1242b2a4870b374661dd0a458a148ae6", "message": "[DOCS] Move post filter/rescore content to new page\n\nMoves post filter and rescored search content to a new `Filter search\nresults` page from the deprecated request body search page.\n\nAdds related redirects and adjusts headings.", "committedDate": "2020-08-10T14:37:26Z", "type": "commit"}, {"oid": "b96c120a1242b2a4870b374661dd0a458a148ae6", "url": "https://github.com/elastic/elasticsearch/commit/b96c120a1242b2a4870b374661dd0a458a148ae6", "message": "[DOCS] Move post filter/rescore content to new page\n\nMoves post filter and rescored search content to a new `Filter search\nresults` page from the deprecated request body search page.\n\nAdds related redirects and adjusts headings.", "committedDate": "2020-08-10T14:37:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMTA4Nw==", "url": "https://github.com/elastic/elasticsearch/pull/60903#discussion_r468011087", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            You can use two methods to filter search results:\n          \n          \n            \n            Use one of the following methods to filter search results:", "author": "lockewritesdocs", "createdAt": "2020-08-10T15:58:13Z", "path": "docs/reference/search/filter-search-results.asciidoc", "diffHunk": "@@ -0,0 +1,18 @@\n+[[filter-search-results]]\n+== Filter search results\n+\n+You can use two methods to filter search results:", "originalCommit": "b96c120a1242b2a4870b374661dd0a458a148ae6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyODE4Mw==", "url": "https://github.com/elastic/elasticsearch/pull/60903#discussion_r468028183", "bodyText": "I'm going to leave this as-is. This suggestion implies that the two methods are mutually exclusive, but that's not the case. You can use a boolean filter and a post filter in the same search.\nThanks for the suggestion tho!", "author": "jrodewig", "createdAt": "2020-08-10T16:26:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMTA4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMTQ4OQ==", "url": "https://github.com/elastic/elasticsearch/pull/60903#discussion_r468011489", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * Use a boolean query with a `filter` query clause. Search requests apply\n          \n          \n            \n            boolean filters to both search hits and <<search-aggregations,aggregations>>.\n          \n          \n            \n            See <<query-dsl-bool-query,boolean query>>.\n          \n          \n            \n            * Use a boolean query with a `filter` query clause. Search requests apply\n          \n          \n            \n            <<query-dsl-bool-query,boolean filters>> to both search hits and <<search-aggregations,aggregations>>.", "author": "lockewritesdocs", "createdAt": "2020-08-10T15:58:54Z", "path": "docs/reference/search/filter-search-results.asciidoc", "diffHunk": "@@ -0,0 +1,18 @@\n+[[filter-search-results]]\n+== Filter search results\n+\n+You can use two methods to filter search results:\n+\n+* Use a boolean query with a `filter` query clause. Search requests apply\n+boolean filters to both search hits and <<search-aggregations,aggregations>>.\n+See <<query-dsl-bool-query,boolean query>>.", "originalCommit": "b96c120a1242b2a4870b374661dd0a458a148ae6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMjE0MA==", "url": "https://github.com/elastic/elasticsearch/pull/60903#discussion_r468012140", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * Use the search API's `post_filter` parameter. Search requests apply post\n          \n          \n            \n            filters only to search hits, not aggregations. See <<post-filter>>.\n          \n          \n            \n            * Use the search API's `post_filter` parameter. Search requests apply \n          \n          \n            \n            <<post-filter,post filters>> only to search hits, not aggregations.", "author": "lockewritesdocs", "createdAt": "2020-08-10T15:59:56Z", "path": "docs/reference/search/filter-search-results.asciidoc", "diffHunk": "@@ -0,0 +1,18 @@\n+[[filter-search-results]]\n+== Filter search results\n+\n+You can use two methods to filter search results:\n+\n+* Use a boolean query with a `filter` query clause. Search requests apply\n+boolean filters to both search hits and <<search-aggregations,aggregations>>.\n+See <<query-dsl-bool-query,boolean query>>.\n+\n+* Use the search API's `post_filter` parameter. Search requests apply post\n+filters only to search hits, not aggregations. See <<post-filter>>.", "originalCommit": "b96c120a1242b2a4870b374661dd0a458a148ae6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMjQxNg==", "url": "https://github.com/elastic/elasticsearch/pull/60903#discussion_r468012416", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If wanted, you can also <<rescore,rescore>> hits after the post filter to\n          \n          \n            \n            improve relevance and reorder results. See <<rescore>>.\n          \n          \n            \n            You can also <<rescore,rescore>> hits after the post filter to\n          \n          \n            \n            improve relevance and reorder results.", "author": "lockewritesdocs", "createdAt": "2020-08-10T16:00:22Z", "path": "docs/reference/search/filter-search-results.asciidoc", "diffHunk": "@@ -0,0 +1,18 @@\n+[[filter-search-results]]\n+== Filter search results\n+\n+You can use two methods to filter search results:\n+\n+* Use a boolean query with a `filter` query clause. Search requests apply\n+boolean filters to both search hits and <<search-aggregations,aggregations>>.\n+See <<query-dsl-bool-query,boolean query>>.\n+\n+* Use the search API's `post_filter` parameter. Search requests apply post\n+filters only to search hits, not aggregations. See <<post-filter>>.\n++\n+If wanted, you can also <<rescore,rescore>> hits after the post filter to\n+improve relevance and reorder results. See <<rescore>>.", "originalCommit": "b96c120a1242b2a4870b374661dd0a458a148ae6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "03cd309f6bea950445965b7d1dab88fd1a18d471", "url": "https://github.com/elastic/elasticsearch/commit/03cd309f6bea950445965b7d1dab88fd1a18d471", "message": "Update docs/reference/search/filter-search-results.asciidoc\n\nCo-authored-by: Adam Locke <adam.locke@elastic.co>", "committedDate": "2020-08-10T16:23:34Z", "type": "commit"}, {"oid": "f5811372eeadca2b400968b59a413959e158327f", "url": "https://github.com/elastic/elasticsearch/commit/f5811372eeadca2b400968b59a413959e158327f", "message": "Update docs/reference/search/filter-search-results.asciidoc\n\nCo-authored-by: Adam Locke <adam.locke@elastic.co>", "committedDate": "2020-08-10T16:23:42Z", "type": "commit"}, {"oid": "fc7d2a8215006ae5f8fc5f58eb1688ba531b67a7", "url": "https://github.com/elastic/elasticsearch/commit/fc7d2a8215006ae5f8fc5f58eb1688ba531b67a7", "message": "Update docs/reference/search/filter-search-results.asciidoc\n\nCo-authored-by: Adam Locke <adam.locke@elastic.co>", "committedDate": "2020-08-10T16:24:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5MTE3OQ==", "url": "https://github.com/elastic/elasticsearch/pull/60903#discussion_r468191179", "bodyText": "I'd put the emphasis more on what the user is trying to accomplish than the mechanics at this level. Something like:\nYou can filter search results by including a filter clause within the query itself, or by applying a post filter. When you include a filter clause in a Boolean query, the filter applies to both the search hits and aggregations. When you use a post filter, the filter only applies to the search hits. Using a post filter enables you calculate aggregations based on a broader result set, and then further narrow the results.", "author": "debadair", "createdAt": "2020-08-10T21:17:32Z", "path": "docs/reference/search/filter-search-results.asciidoc", "diffHunk": "@@ -0,0 +1,18 @@\n+[[filter-search-results]]\n+== Filter search results\n+\n+You can use two methods to filter search results:", "originalCommit": "fc7d2a8215006ae5f8fc5f58eb1688ba531b67a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5NjMzNw==", "url": "https://github.com/elastic/elasticsearch/pull/60903#discussion_r468196337", "bodyText": "This is a bit awkward because the parameter isn't applied, the filter is. Maybe:\nWhen you use the post_filter parameter to filter search results, the search hits are filtered after the aggregations are calculated. A post filter has no impact on the aggregation results.", "author": "debadair", "createdAt": "2020-08-10T21:28:41Z", "path": "docs/reference/search/request/post-filter.asciidoc", "diffHunk": "@@ -1,8 +1,9 @@\n-[[request-body-search-post-filter]]\n-==== Post filter\n+[discrete]\n+[[post-filter]]\n+=== Post filter\n \n-The `post_filter` is applied to the search `hits` at the very end of a search\n-request,  after aggregations have already been calculated. Its purpose is\n+The `post_filter` parameter is applied to the search `hits` at the very end of a search", "originalCommit": "fc7d2a8215006ae5f8fc5f58eb1688ba531b67a7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "98b908b49bdcb89b376979dbca1aa26a2c9b48ac", "url": "https://github.com/elastic/elasticsearch/commit/98b908b49bdcb89b376979dbca1aa26a2c9b48ac", "message": "Address feedback", "committedDate": "2020-08-10T22:05:51Z", "type": "commit"}]}