{"pr_number": 65755, "pr_title": "[ML] Fix snapshot upgrader so that if state is not fully written or parseable the task fails", "pr_createdAt": "2020-12-02T15:18:45Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/65755", "timeline": [{"oid": "ff45fc200a47bcd1acb1d7499f5ff019db01780f", "url": "https://github.com/elastic/elasticsearch/commit/ff45fc200a47bcd1acb1d7499f5ff019db01780f", "message": "[ML] allow snapshot upgrader task to fail if state streamer fails", "committedDate": "2020-12-01T21:11:30Z", "type": "commit"}, {"oid": "d13d3bb2191fb4f75d1334d7d2f397908691cad0", "url": "https://github.com/elastic/elasticsearch/commit/d13d3bb2191fb4f75d1334d7d2f397908691cad0", "message": "attempting to catch flush", "committedDate": "2020-12-02T13:32:15Z", "type": "commit"}, {"oid": "43a423acca69465abd422bda52124bf395a082fd", "url": "https://github.com/elastic/elasticsearch/commit/43a423acca69465abd422bda52124bf395a082fd", "message": "Merge remote-tracking branch 'upstream/master' into test/ml-fix-snapshot-upgrader-it-tests", "committedDate": "2020-12-02T13:32:31Z", "type": "commit"}, {"oid": "c9074c0920cd63ac7cc252d98fdeafd35159cb80", "url": "https://github.com/elastic/elasticsearch/commit/c9074c0920cd63ac7cc252d98fdeafd35159cb80", "message": "updating to handle flush", "committedDate": "2020-12-02T14:09:47Z", "type": "commit"}, {"oid": "468aea5259e824cb80d6c7058a1291e7a5c5da46", "url": "https://github.com/elastic/elasticsearch/commit/468aea5259e824cb80d6c7058a1291e7a5c5da46", "message": "simplify", "committedDate": "2020-12-02T15:15:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTAxMTkyNw==", "url": "https://github.com/elastic/elasticsearch/pull/65755#discussion_r535011927", "bodyText": "I think the old single line version was more readable", "author": "davidkyle", "createdAt": "2020-12-03T09:37:17Z", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/JobModelSnapshotUpgrader.java", "diffHunk": "@@ -97,7 +100,9 @@ void start() {\n             params,\n             autodetectExecutorService,\n             (reason) -> {\n-                setTaskToFailed(reason, ActionListener.wrap(t -> {}, f -> {}));\n+                setTaskToFailed(reason, ActionListener.wrap(t -> {", "originalCommit": "468aea5259e824cb80d6c7058a1291e7a5c5da46", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}