{"pr_number": 57359, "pr_title": "[7.x] Add new circuitbreaker plugin and refactor CircuitBreakerService (#55695)", "pr_createdAt": "2020-05-29T13:38:33Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/57359", "timeline": [{"oid": "2716fb2b44bc63420fb2b2f6484bd561470ebe0b", "url": "https://github.com/elastic/elasticsearch/commit/2716fb2b44bc63420fb2b2f6484bd561470ebe0b", "message": "Add new circuitbreaker plugin and refactor CircuitBreakerService (#55695)\n\nThis commit lays the ground work for plugins supplying their own circuit breakers.\n\nIt adds a new interface: `CircuitBreakerPlugin`.\n\nThis interface provides methods for providing custom child CircuitBreaker objects. There are also facilities for allowing dynamic settings for the custom breakers.\n\nWith the refactor, circuit breakers are no longer replaced on setting changes. Instead, the two mutable settings themselves are `volatile`. Plugins that want to use their custom circuit breaker should keep a reference of their constructed breaker.", "committedDate": "2020-05-29T13:38:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ4ODgyMg==", "url": "https://github.com/elastic/elasticsearch/pull/57359#discussion_r432488822", "bodyText": "@rjernst Should we gather the circuit breaker plugin values here as well?", "author": "benwtrent", "createdAt": "2020-05-29T13:39:37Z", "path": "server/src/main/java/org/elasticsearch/client/transport/TransportClient.java", "diffHunk": "@@ -191,6 +191,7 @@ private static ClientTemplate buildTemplate(Settings providedSettings, Settings\n             modules.add(actionModule);\n \n             CircuitBreakerService circuitBreakerService = Node.createCircuitBreakerService(settingsModule.getSettings(),\n+                Collections.emptyList(),", "originalCommit": "2716fb2b44bc63420fb2b2f6484bd561470ebe0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU4MzU2Nw==", "url": "https://github.com/elastic/elasticsearch/pull/57359#discussion_r432583567", "bodyText": "I'm surprised we even construct the circuit breaker service. We shouldnt need plugins circuit breakers here.", "author": "rjernst", "createdAt": "2020-05-29T16:00:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQ4ODgyMg=="}], "type": "inlineReview"}, {"oid": "5af2f10914b75dc3edaa1f0a5fe7556ad1d43fd4", "url": "https://github.com/elastic/elasticsearch/commit/5af2f10914b75dc3edaa1f0a5fe7556ad1d43fd4", "message": "fixing unused import", "committedDate": "2020-05-29T14:16:22Z", "type": "commit"}, {"oid": "2e382257b0b8265ce2d35183ce9f5b73ee0e4792", "url": "https://github.com/elastic/elasticsearch/commit/2e382257b0b8265ce2d35183ce9f5b73ee0e4792", "message": "Merge branch '7.x' into backport/7.x/pr-55695", "committedDate": "2020-05-29T14:48:22Z", "type": "commit"}]}