{"pr_number": 60033, "pr_title": "DOCS audit attributes for API Key authn", "pr_createdAt": "2020-07-22T07:00:18Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/60033", "timeline": [{"oid": "e23292403cd0d75cbd690ebc07a5eefdc850c118", "url": "https://github.com/elastic/elasticsearch/commit/e23292403cd0d75cbd690ebc07a5eefdc850c118", "message": "Docs docs docs", "committedDate": "2020-07-22T06:55:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODgyOTAzMA==", "url": "https://github.com/elastic/elasticsearch/pull/60033#discussion_r458829030", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              `realm`              ::   The name of the realm that successfully authenticated the user,\n          \n          \n            \n                                        or the special value of `_es_api_key` if authentication is\n          \n          \n            \n                                        performed using an API Key. This is a shorthand attribute\n          \n          \n            \n                                        for the same information that is described by the `user.realm`,\n          \n          \n            \n                                        `user.run_by.realm` and `authentication.type` attributes.\n          \n          \n            \n              `realm`              ::   The name of the realm that successfully authenticated the user.\n          \n          \n            \n                                        If authenticated using an API key, this is the special value of\n          \n          \n            \n                                        `_es_api_key`. This is a shorthand attribute\n          \n          \n            \n                                        for the same information that is described by the `user.realm`,\n          \n          \n            \n                                        `user.run_by.realm` and `authentication.type` attributes.", "author": "jrodewig", "createdAt": "2020-07-22T14:20:41Z", "path": "x-pack/docs/en/security/auditing/event-types.asciidoc", "diffHunk": "@@ -157,16 +157,35 @@ There are a few events that have some more attributes in addition to those\n that have been previously described:\n \n * `authentication_success`:\n-  `realm`              ::   The name of the realm that successfully\n-                            authenticated the user.\n+  `realm`              ::   The name of the realm that successfully authenticated the user,\n+                            or the special value of `_es_api_key` if authentication is\n+                            performed using an API Key. This is a shorthand attribute\n+                            for the same information that is described by the `user.realm`,\n+                            `user.run_by.realm` and `authentication.type` attributes.", "originalCommit": "e23292403cd0d75cbd690ebc07a5eefdc850c118", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODgzMDM3Nw==", "url": "https://github.com/elastic/elasticsearch/pull/60033#discussion_r458830377", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        If authentication is performed using an API Key this attribute\n          \n          \n            \n                                        designates the name of the owner user of the key.\n          \n          \n            \n              `user.realm`         ::   The realm name that the _effective_ user belongs to. If authentication\n          \n          \n            \n                                        is performed using an API Key this attribute designates the realm name\n          \n          \n            \n                                        that the owner of the key belongs to.\n          \n          \n            \n                                        If authenticated using an API key, this is\n          \n          \n            \n                                        the name of the API key owner.\n          \n          \n            \n              `user.realm`         ::   Name of the the realm to which the _effective_ user \n          \n          \n            \n                                        belongs. If authenticated using an API key, this is\n          \n          \n            \n                                        the name of the realm to which the API key owner belongs.", "author": "jrodewig", "createdAt": "2020-07-22T14:22:32Z", "path": "x-pack/docs/en/security/auditing/event-types.asciidoc", "diffHunk": "@@ -157,16 +157,35 @@ There are a few events that have some more attributes in addition to those\n that have been previously described:\n \n * `authentication_success`:\n-  `realm`              ::   The name of the realm that successfully\n-                            authenticated the user.\n+  `realm`              ::   The name of the realm that successfully authenticated the user,\n+                            or the special value of `_es_api_key` if authentication is\n+                            performed using an API Key. This is a shorthand attribute\n+                            for the same information that is described by the `user.realm`,\n+                            `user.run_by.realm` and `authentication.type` attributes.\n   `user.name`          ::   The name of the _effective_ user. This is usually the\n                             same as the _authenticated_ user, but if using the\n                             <<run-as-privilege, run as authorization functionality>>\n                             this instead denotes the name of the  _impersonated_ user.\n+                            If authentication is performed using an API Key this attribute\n+                            designates the name of the owner user of the key.\n+  `user.realm`         ::   The realm name that the _effective_ user belongs to. If authentication\n+                            is performed using an API Key this attribute designates the realm name\n+                            that the owner of the key belongs to.", "originalCommit": "e23292403cd0d75cbd690ebc07a5eefdc850c118", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODgzMzI0Ng==", "url": "https://github.com/elastic/elasticsearch/pull/60033#discussion_r458833246", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              `user.run_by.realm`  ::   This attribute is present only if the request is\n          \n          \n            \n                                        using the <<run-as-privilege, run as authorization functionality>>\n          \n          \n            \n                                        and denotes the name of the realm that the _authenticated_\n          \n          \n            \n                                        (_impersonator_) user belongs to.\n          \n          \n            \n              `authentication.type`::   One of `REALM`, `API_KEY`, `TOKEN`, `ANONYMOUS` or `INTERNAL`.\n          \n          \n            \n              `api_key.id`         ::   This attribute is present only if authentication is performed using an\n          \n          \n            \n                                        API Key, and contains the value for the key id that is returned in response\n          \n          \n            \n                                        to the <<security-api-create-api-key, Create API Key>> call.\n          \n          \n            \n              `api_key.name`       ::   This attribute is present only if authentication is performed using an\n          \n          \n            \n                                        API Key, and contains the value for the key name given in the request\n          \n          \n            \n                                        to <<security-api-create-api-key, Create API Keys>>\n          \n          \n            \n              `user.run_by.realm`  ::   Name of the realm to which the _authenticated_\n          \n          \n            \n                                        (_impersonator_) user belongs.\n          \n          \n            \n                                        This attribute is provided only if the request\n          \n          \n            \n                                        uses the <<run-as-privilege, run as authorization functionality>>.\n          \n          \n            \n              `authentication.type`::   Method used to authenticate the user.\n          \n          \n            \n                                        Possible values are `REALM`, `API_KEY`, `TOKEN`, `ANONYMOUS` or `INTERNAL`.\n          \n          \n            \n              `api_key.id`         ::   API key ID returned by the <<security-api-create-api-key,create API key>> request.\n          \n          \n            \n                                        This attribute is only provided for authentication using an API key.\n          \n          \n            \n              `api_key.name`       ::   API key name provided in the <<security-api-create-api-key,create API key>> request.\n          \n          \n            \n                                        This attribute is only provided for authentication using an API key.", "author": "jrodewig", "createdAt": "2020-07-22T14:26:07Z", "path": "x-pack/docs/en/security/auditing/event-types.asciidoc", "diffHunk": "@@ -157,16 +157,35 @@ There are a few events that have some more attributes in addition to those\n that have been previously described:\n \n * `authentication_success`:\n-  `realm`              ::   The name of the realm that successfully\n-                            authenticated the user.\n+  `realm`              ::   The name of the realm that successfully authenticated the user,\n+                            or the special value of `_es_api_key` if authentication is\n+                            performed using an API Key. This is a shorthand attribute\n+                            for the same information that is described by the `user.realm`,\n+                            `user.run_by.realm` and `authentication.type` attributes.\n   `user.name`          ::   The name of the _effective_ user. This is usually the\n                             same as the _authenticated_ user, but if using the\n                             <<run-as-privilege, run as authorization functionality>>\n                             this instead denotes the name of the  _impersonated_ user.\n+                            If authentication is performed using an API Key this attribute\n+                            designates the name of the owner user of the key.\n+  `user.realm`         ::   The realm name that the _effective_ user belongs to. If authentication\n+                            is performed using an API Key this attribute designates the realm name\n+                            that the owner of the key belongs to.\n   `user.run_by.name`   ::   This attribute is present only if the request is\n                             using the <<run-as-privilege, run as authorization functionality>>\n                             and denotes the name of the  _authenticated_ user, \n                             which is also known as the _impersonator_.\n+  `user.run_by.realm`  ::   This attribute is present only if the request is\n+                            using the <<run-as-privilege, run as authorization functionality>>\n+                            and denotes the name of the realm that the _authenticated_\n+                            (_impersonator_) user belongs to.\n+  `authentication.type`::   One of `REALM`, `API_KEY`, `TOKEN`, `ANONYMOUS` or `INTERNAL`.\n+  `api_key.id`         ::   This attribute is present only if authentication is performed using an\n+                            API Key, and contains the value for the key id that is returned in response\n+                            to the <<security-api-create-api-key, Create API Key>> call.\n+  `api_key.name`       ::   This attribute is present only if authentication is performed using an\n+                            API Key, and contains the value for the key name given in the request\n+                            to <<security-api-create-api-key, Create API Keys>>", "originalCommit": "e23292403cd0d75cbd690ebc07a5eefdc850c118", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODgzNDE5Ng==", "url": "https://github.com/elastic/elasticsearch/pull/60033#discussion_r458834196", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              `user.roles`         ::    The role names of the user as an array. If authentication is\n          \n          \n            \n                                         performed using an API Key this attribute designates the\n          \n          \n            \n                                         role names of the owner user of the key.\n          \n          \n            \n              `user.roles`         ::    The role names of the user as an array. If authenticated\n          \n          \n            \n                                         using an API key, this contains the\n          \n          \n            \n                                         role names of the API key owner.", "author": "jrodewig", "createdAt": "2020-07-22T14:27:24Z", "path": "x-pack/docs/en/security/auditing/event-types.asciidoc", "diffHunk": "@@ -188,13 +207,19 @@ that have been previously described:\n                              action is granted or denied.\n   `user.run_as.realm`  ::    The realm name of that the _impersonated_ user belongs to.\n \n-* `access_granted` or `access_denied`:\n-  `user.roles`         ::    The role names of the user as an array.\n-  `user.name`          ::    The name of the _effective_ user that is being\n-                             authorized or unauthorized. This is usually the _authenticated_\n-                             user, but if using the <<run-as-privilege, run as authorization functionality>>\n+* `access_granted` and `access_denied`:\n+  `user.roles`         ::    The role names of the user as an array. If authentication is\n+                             performed using an API Key this attribute designates the\n+                             role names of the owner user of the key.", "originalCommit": "e23292403cd0d75cbd690ebc07a5eefdc850c118", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODgzNDg0NQ==", "url": "https://github.com/elastic/elasticsearch/pull/60033#discussion_r458834845", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                         If authentication is performed using an API Key this attribute\n          \n          \n            \n                                         designates the name of the owner user of the key.\n          \n          \n            \n                                         If authenticated using an API key, this is\n          \n          \n            \n                                         the name of the API key owner.", "author": "jrodewig", "createdAt": "2020-07-22T14:28:18Z", "path": "x-pack/docs/en/security/auditing/event-types.asciidoc", "diffHunk": "@@ -188,13 +207,19 @@ that have been previously described:\n                              action is granted or denied.\n   `user.run_as.realm`  ::    The realm name of that the _impersonated_ user belongs to.\n \n-* `access_granted` or `access_denied`:\n-  `user.roles`         ::    The role names of the user as an array.\n-  `user.name`          ::    The name of the _effective_ user that is being\n-                             authorized or unauthorized. This is usually the _authenticated_\n-                             user, but if using the <<run-as-privilege, run as authorization functionality>>\n+* `access_granted` and `access_denied`:\n+  `user.roles`         ::    The role names of the user as an array. If authentication is\n+                             performed using an API Key this attribute designates the\n+                             role names of the owner user of the key.\n+  `user.name`          ::    The name of the _effective_ user. This is usually the\n+                             same as the _authenticated_ user, but if using the\n+                             <<run-as-privilege, run as authorization functionality>>\n                              this instead denotes the name of the  _impersonated_ user.\n-  `user.realm`         ::    The realm name that the _effective_ user belongs to.\n+                             If authentication is performed using an API Key this attribute\n+                             designates the name of the owner user of the key.", "originalCommit": "e23292403cd0d75cbd690ebc07a5eefdc850c118", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODgzNTE5MQ==", "url": "https://github.com/elastic/elasticsearch/pull/60033#discussion_r458835191", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              `user.realm`         ::    The realm name that the _effective_ user belongs to. If authentication\n          \n          \n            \n                                         is performed using an API Key this attribute designates the realm name\n          \n          \n            \n                                         that the owner of the key belongs to.\n          \n          \n            \n              `user.realm`         ::   Name of the the realm to which the _effective_ user \n          \n          \n            \n                                        belongs. If authenticated using an API key, this is\n          \n          \n            \n                                        the name of the realm to which the API key owner belongs.", "author": "jrodewig", "createdAt": "2020-07-22T14:28:45Z", "path": "x-pack/docs/en/security/auditing/event-types.asciidoc", "diffHunk": "@@ -188,13 +207,19 @@ that have been previously described:\n                              action is granted or denied.\n   `user.run_as.realm`  ::    The realm name of that the _impersonated_ user belongs to.\n \n-* `access_granted` or `access_denied`:\n-  `user.roles`         ::    The role names of the user as an array.\n-  `user.name`          ::    The name of the _effective_ user that is being\n-                             authorized or unauthorized. This is usually the _authenticated_\n-                             user, but if using the <<run-as-privilege, run as authorization functionality>>\n+* `access_granted` and `access_denied`:\n+  `user.roles`         ::    The role names of the user as an array. If authentication is\n+                             performed using an API Key this attribute designates the\n+                             role names of the owner user of the key.\n+  `user.name`          ::    The name of the _effective_ user. This is usually the\n+                             same as the _authenticated_ user, but if using the\n+                             <<run-as-privilege, run as authorization functionality>>\n                              this instead denotes the name of the  _impersonated_ user.\n-  `user.realm`         ::    The realm name that the _effective_ user belongs to.\n+                             If authentication is performed using an API Key this attribute\n+                             designates the name of the owner user of the key.\n+  `user.realm`         ::    The realm name that the _effective_ user belongs to. If authentication\n+                             is performed using an API Key this attribute designates the realm name\n+                             that the owner of the key belongs to.", "originalCommit": "e23292403cd0d75cbd690ebc07a5eefdc850c118", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODgzNTYyMA==", "url": "https://github.com/elastic/elasticsearch/pull/60033#discussion_r458835620", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              `authentication.type`::    One of `REALM`, `API_KEY`, `TOKEN`, `ANONYMOUS` or `INTERNAL`.\n          \n          \n            \n              `api_key.id`         ::    This attribute is present only if authentication is performed using an\n          \n          \n            \n                                         API Key, and contains the value for the key id that is returned in response\n          \n          \n            \n                                         to the <<security-api-create-api-key, Create API Key>> call.\n          \n          \n            \n              `api_key.name`       ::    This attribute is present only if authentication is performed using an\n          \n          \n            \n                                         API Key, and contains the value for the key name given in the request\n          \n          \n            \n                                         to <<security-api-create-api-key, Create API Keys>>\n          \n          \n            \n              `authentication.type`::   Method used to authenticate the user.\n          \n          \n            \n                                        Possible values are `REALM`, `API_KEY`, `TOKEN`, `ANONYMOUS` or `INTERNAL`.\n          \n          \n            \n              `api_key.id`         ::   API key ID returned by the <<security-api-create-api-key,create API key>> request.\n          \n          \n            \n                                        This attribute is only provided for authentication using an API key.\n          \n          \n            \n              `api_key.name`       ::   API key name provided in the <<security-api-create-api-key,create API key>> request.\n          \n          \n            \n                                        This attribute is only provided for authentication using an API key.", "author": "jrodewig", "createdAt": "2020-07-22T14:29:19Z", "path": "x-pack/docs/en/security/auditing/event-types.asciidoc", "diffHunk": "@@ -203,6 +228,13 @@ that have been previously described:\n                              using the <<run-as-privilege, run as authorization functionality>>\n                              and denotes the name of the realm that the _authenticated_\n                              (_impersonator_) user belongs to.\n+  `authentication.type`::    One of `REALM`, `API_KEY`, `TOKEN`, `ANONYMOUS` or `INTERNAL`.\n+  `api_key.id`         ::    This attribute is present only if authentication is performed using an\n+                             API Key, and contains the value for the key id that is returned in response\n+                             to the <<security-api-create-api-key, Create API Key>> call.\n+  `api_key.name`       ::    This attribute is present only if authentication is performed using an\n+                             API Key, and contains the value for the key name given in the request\n+                             to <<security-api-create-api-key, Create API Keys>>", "originalCommit": "e23292403cd0d75cbd690ebc07a5eefdc850c118", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "27d7e0e77c3d3495001560f372ac33d86efb25e9", "url": "https://github.com/elastic/elasticsearch/commit/27d7e0e77c3d3495001560f372ac33d86efb25e9", "message": "Update x-pack/docs/en/security/auditing/event-types.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-07-23T04:59:45Z", "type": "commit"}, {"oid": "2fd6a737bbb0e7e1dd6fc93a15c8c39e5559e4ba", "url": "https://github.com/elastic/elasticsearch/commit/2fd6a737bbb0e7e1dd6fc93a15c8c39e5559e4ba", "message": "Update x-pack/docs/en/security/auditing/event-types.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-07-23T05:01:03Z", "type": "commit"}, {"oid": "c25f1468e06e9131087c26b812ea62bd975a5f73", "url": "https://github.com/elastic/elasticsearch/commit/c25f1468e06e9131087c26b812ea62bd975a5f73", "message": "Update x-pack/docs/en/security/auditing/event-types.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-07-23T05:02:26Z", "type": "commit"}, {"oid": "66aeb49347ff59fc45f4bb76a7fbbcf4471522d4", "url": "https://github.com/elastic/elasticsearch/commit/66aeb49347ff59fc45f4bb76a7fbbcf4471522d4", "message": "Update x-pack/docs/en/security/auditing/event-types.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-07-23T05:03:17Z", "type": "commit"}, {"oid": "6405af46d3ca23d72d98f32f21504b3062086eb4", "url": "https://github.com/elastic/elasticsearch/commit/6405af46d3ca23d72d98f32f21504b3062086eb4", "message": "Update x-pack/docs/en/security/auditing/event-types.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-07-23T05:03:29Z", "type": "commit"}, {"oid": "8f4b4c1660ea30e0ca2ec6815a5df8e9adfe651e", "url": "https://github.com/elastic/elasticsearch/commit/8f4b4c1660ea30e0ca2ec6815a5df8e9adfe651e", "message": "Update x-pack/docs/en/security/auditing/event-types.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-07-23T05:03:54Z", "type": "commit"}, {"oid": "ec5629dbc93f3b004252888e527fe268270b2845", "url": "https://github.com/elastic/elasticsearch/commit/ec5629dbc93f3b004252888e527fe268270b2845", "message": "Update x-pack/docs/en/security/auditing/event-types.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-07-23T05:04:29Z", "type": "commit"}, {"oid": "cfbca2973d40f26af462e20707ebf22d7dbf865c", "url": "https://github.com/elastic/elasticsearch/commit/cfbca2973d40f26af462e20707ebf22d7dbf865c", "message": "Merge branch 'master' into docs_api_key_audit_fields", "committedDate": "2020-07-23T05:25:03Z", "type": "commit"}]}