{"pr_number": 65184, "pr_title": "[DOCS] Adds UI related limitation to configuring aggs docs", "pr_createdAt": "2020-11-18T10:22:58Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/65184", "timeline": [{"oid": "33dbf577ad336ed6c71f61bd2dacc0e005df53bb", "url": "https://github.com/elastic/elasticsearch/commit/33dbf577ad336ed6c71f61bd2dacc0e005df53bb", "message": "[DOCS] Adds UI related limitation to configuring aggs docs.", "committedDate": "2020-11-18T10:17:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjE2ODA4NA==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r526168084", "bodyText": "This limitation also applies to the anomaly charts in the Anomaly Explorer.", "author": "peteharverson", "createdAt": "2020-11-18T15:17:15Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,10 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model ", "originalCommit": "33dbf577ad336ed6c71f61bd2dacc0e005df53bb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "45369b6abef5169eb0a3ce8da101dda6bbd065d7", "url": "https://github.com/elastic/elasticsearch/commit/45369b6abef5169eb0a3ce8da101dda6bbd065d7", "message": "[DOCS] Addresses feedback.", "committedDate": "2020-11-18T16:03:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjIwODA3OQ==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r526208079", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Viewer** nor the ***Anomaly Explorer** in {kib} can plot and display an anomaly \n          \n          \n            \n            Viewer** nor the **Anomaly Explorer** in {kib} can plot and display an anomaly", "author": "szabosteve", "createdAt": "2020-11-18T16:04:32Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,11 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model \n+plot is not enabled for the {anomaly-job}, then neither the **Single Metric \n+Viewer** nor the ***Anomaly Explorer** in {kib} can plot and display an anomaly ", "originalCommit": "45369b6abef5169eb0a3ce8da101dda6bbd065d7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "669789a4a42ffac3e3b81fc7bb29a7ec14cd36ff", "url": "https://github.com/elastic/elasticsearch/commit/669789a4a42ffac3e3b81fc7bb29a7ec14cd36ff", "message": "Update docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "committedDate": "2020-11-18T16:04:38Z", "type": "commit"}, {"oid": "29a3e9219547f96f2475b48d31d8d487cea353da", "url": "https://github.com/elastic/elasticsearch/commit/29a3e9219547f96f2475b48d31d8d487cea353da", "message": "[DOCS] Addresses feedback.", "committedDate": "2020-11-19T09:14:44Z", "type": "commit"}, {"oid": "a6fb9dc0a480ed686063b1827d67de7770bad8e2", "url": "https://github.com/elastic/elasticsearch/commit/a6fb9dc0a480ed686063b1827d67de7770bad8e2", "message": "[DOCS] Minor changes.", "committedDate": "2020-11-19T09:15:41Z", "type": "commit"}, {"oid": "41f08975e18b1c40b5c75252d76d4f5159944ccb", "url": "https://github.com/elastic/elasticsearch/commit/41f08975e18b1c40b5c75252d76d4f5159944ccb", "message": "[DOCS] Fixes markup.", "committedDate": "2020-11-19T09:17:58Z", "type": "commit"}, {"oid": "9b470041f4b77217ea7576dc13aaf755ea2a47e5", "url": "https://github.com/elastic/elasticsearch/commit/9b470041f4b77217ea7576dc13aaf755ea2a47e5", "message": "[DOCS] Fixes typo.", "committedDate": "2020-11-19T09:20:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjc1ODU5NA==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r526758594", "bodyText": "Sorry, this needs more editing as this issue affects the charts in both the Anomaly Explorer and Single Metric Viewer. I'm not sure how best to phrase this - charts are displayed, but the values plotted in the charts don't match up unless the job bucket span is the same as the interval used for the date_histogram aggregation. For example, here the bucket_span is 30m and the date_histogram aggregation interval is 15m. The result is the data in the chart is twice the actual value:", "author": "peteharverson", "createdAt": "2020-11-19T10:38:10Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,15 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model \n+plot is not enabled for the {anomaly-job}, then neither the **Single Metric \n+Viewer** nor the **Anomaly Explorer** in {kib} can plot and display an anomaly \n+chart for the job. Single Metric Viewer doesn't support configurations where ", "originalCommit": "9b470041f4b77217ea7576dc13aaf755ea2a47e5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "203d748582daf7449d56fc6f7a6b1f04f41498d0", "url": "https://github.com/elastic/elasticsearch/commit/203d748582daf7449d56fc6f7a6b1f04f41498d0", "message": "[DOCS] Makes limitation more accurate.", "committedDate": "2020-11-19T14:50:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzI4NTM2Ng==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527285366", "bodyText": "In case people don't notice the formatting, it might be nice to qualify this:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model \n          \n          \n            \n            If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms` aggs>> and model", "author": "lcawl", "createdAt": "2020-11-20T00:06:01Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,18 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model ", "originalCommit": "203d748582daf7449d56fc6f7a6b1f04f41498d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzI4NjAyNA==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527286024", "bodyText": "IMO we can usually leave out \"then\" in cases like this:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            plot is not enabled for the {anomaly-job}, then neither can the **Single Metric \n          \n          \n            \n            plot is not enabled for the {anomaly-job}, neither the **Single Metric", "author": "lcawl", "createdAt": "2020-11-20T00:08:01Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,18 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model \n+plot is not enabled for the {anomaly-job}, then neither can the **Single Metric ", "originalCommit": "203d748582daf7449d56fc6f7a6b1f04f41498d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzI4NjMyNg==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527286326", "bodyText": "IMO we don't need to point out they're in Kibana here, but am fine with being overruled\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Viewer** nor the **Anomaly Explorer** in {kib} plot and display an anomaly \n          \n          \n            \n            Viewer** nor the **Anomaly Explorer** can plot and display an anomaly", "author": "lcawl", "createdAt": "2020-11-20T00:09:00Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,18 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model \n+plot is not enabled for the {anomaly-job}, then neither can the **Single Metric \n+Viewer** nor the **Anomaly Explorer** in {kib} plot and display an anomaly ", "originalCommit": "203d748582daf7449d56fc6f7a6b1f04f41498d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzI4NjY3OA==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527286678", "bodyText": "Adding missing bold:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            don't match, the values of the chart plotted in both the Single Metric Viewer \n          \n          \n            \n            don't match, the values of the chart plotted in both the **Single Metric Viewer**", "author": "lcawl", "createdAt": "2020-11-20T00:09:56Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,18 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model \n+plot is not enabled for the {anomaly-job}, then neither can the **Single Metric \n+Viewer** nor the **Anomaly Explorer** in {kib} plot and display an anomaly \n+chart for the job.\n+\n+When the aggregation interval of the {dfeed} and the bucket span of the job \n+don't match, the values of the chart plotted in both the Single Metric Viewer ", "originalCommit": "203d748582daf7449d56fc6f7a6b1f04f41498d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzI4ODUyOA==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527288528", "bodyText": "chart for the job.\n\nAs a reader, this makes me wonder whether an error is returned or the charts are just blank. If you think it's not overkill, it might be nice to tell them what they'll experience.", "author": "lcawl", "createdAt": "2020-11-20T00:13:36Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,18 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model \n+plot is not enabled for the {anomaly-job}, then neither can the **Single Metric \n+Viewer** nor the **Anomaly Explorer** in {kib} plot and display an anomaly \n+chart for the job.", "originalCommit": "203d748582daf7449d56fc6f7a6b1f04f41498d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzI4OTMyOA==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527289328", "bodyText": "Since I think it's the the \"values\" (plural) that differ, we should drop the \"s\" here:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            and the Anomaly Explorer differs from the actual values of the job. To avoid \n          \n          \n            \n            and the **Anomaly Explorer** differ from the actual values of the job. To avoid", "author": "lcawl", "createdAt": "2020-11-20T00:14:28Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,18 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms`>> and model \n+plot is not enabled for the {anomaly-job}, then neither can the **Single Metric \n+Viewer** nor the **Anomaly Explorer** in {kib} plot and display an anomaly \n+chart for the job.\n+\n+When the aggregation interval of the {dfeed} and the bucket span of the job \n+don't match, the values of the chart plotted in both the Single Metric Viewer \n+and the Anomaly Explorer differs from the actual values of the job. To avoid ", "originalCommit": "203d748582daf7449d56fc6f7a6b1f04f41498d0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2e3171f22ea21194e6686528eada42aadc32bc5b", "url": "https://github.com/elastic/elasticsearch/commit/2e3171f22ea21194e6686528eada42aadc32bc5b", "message": "Apply suggestions from code review\n\nCo-authored-by: Lisa Cawley <lcawley@elastic.co>", "committedDate": "2020-11-20T08:24:12Z", "type": "commit"}, {"oid": "5567f05de1cae6e8715b1af4a05c5ca01d53f7d2", "url": "https://github.com/elastic/elasticsearch/commit/5567f05de1cae6e8715b1af4a05c5ca01d53f7d2", "message": "[DOCS] Addresses feedback.", "committedDate": "2020-11-20T13:59:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzcyNzEyNA==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527727124", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            chart for the job. In this cases, the charts are blank.\n          \n          \n            \n            chart for the job. In these cases, the charts are blank.", "author": "szabosteve", "createdAt": "2020-11-20T14:27:02Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,18 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms` aggs>> and \n+model plot is not enabled for the {anomaly-job}, neither the **Single Metric \n+Viewer** nor the **Anomaly Explorer** can plot and display an anomaly \n+chart for the job. In this cases, the charts are blank.", "originalCommit": "5567f05de1cae6e8715b1af4a05c5ca01d53f7d2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c7ee66b56a48246a14543ad24dc6b691a1c9a226", "url": "https://github.com/elastic/elasticsearch/commit/c7ee66b56a48246a14543ad24dc6b691a1c9a226", "message": "Update docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "committedDate": "2020-11-20T14:27:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc2OTcyNw==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527769727", "bodyText": "My apologies for another change, for 7.11, in these cases, the charts will not be visible and there will be call outs explaining why.", "author": "qn895", "createdAt": "2020-11-20T15:31:03Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,18 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms` aggs>> and \n+model plot is not enabled for the {anomaly-job}, neither the **Single Metric \n+Viewer** nor the **Anomaly Explorer** can plot and display an anomaly \n+chart for the job. In these cases, the charts are blank.", "originalCommit": "c7ee66b56a48246a14543ad24dc6b691a1c9a226", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc4Mjg4NQ==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527782885", "bodyText": "Modified the text accordingly via 5148e84.", "author": "szabosteve", "createdAt": "2020-11-20T15:50:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc2OTcyNw=="}], "type": "inlineReview"}, {"oid": "a3ec28ca2b66b1c781d3545ee2c5dfe1e491dbcd", "url": "https://github.com/elastic/elasticsearch/commit/a3ec28ca2b66b1c781d3545ee2c5dfe1e491dbcd", "message": "[DOCS] MInor edits.", "committedDate": "2020-11-20T15:47:44Z", "type": "commit"}, {"oid": "5148e843a6eb009a81232af9e6fcdb2d2402b100", "url": "https://github.com/elastic/elasticsearch/commit/5148e843a6eb009a81232af9e6fcdb2d2402b100", "message": "[DOCS] Further edits.", "committedDate": "2020-11-20T15:49:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzgzMjUwMQ==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527832501", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            <<<<<<< HEAD", "author": "szabosteve", "createdAt": "2020-11-20T17:04:25Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,23 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms` aggs>> and \n+model plot is not enabled for the {anomaly-job}, neither the **Single Metric \n+Viewer** nor the **Anomaly Explorer** can plot and display an anomaly \n+<<<<<<< HEAD", "originalCommit": "5148e843a6eb009a81232af9e6fcdb2d2402b100", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzgzMjg0MQ==", "url": "https://github.com/elastic/elasticsearch/pull/65184#discussion_r527832841", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            =======\n          \n          \n            \n            chart for the job. In these cases, the charts are blank.\n          \n          \n            \n            >>>>>>> c7ee66b56a48246a14543ad24dc6b691a1c9a226", "author": "szabosteve", "createdAt": "2020-11-20T17:04:57Z", "path": "docs/reference/ml/anomaly-detection/ml-configuring-aggregations.asciidoc", "diffHunk": "@@ -45,6 +45,23 @@ finer, more granular time buckets, which are ideal for this type of analysis. If\n your detectors use <<ml-count-functions,count>> or <<ml-rare-functions,rare>>\n functions, set the interval to the same value as the bucket span.\n \n+If your <<aggs-dfeeds,{dfeed} uses aggregations with nested `terms` aggs>> and \n+model plot is not enabled for the {anomaly-job}, neither the **Single Metric \n+Viewer** nor the **Anomaly Explorer** can plot and display an anomaly \n+<<<<<<< HEAD\n+chart for the job. In this cases, the charts are not visible and an explanatory \n+message is shown.\n+=======\n+chart for the job. In these cases, the charts are blank.\n+>>>>>>> c7ee66b56a48246a14543ad24dc6b691a1c9a226", "originalCommit": "5148e843a6eb009a81232af9e6fcdb2d2402b100", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "04cb142cdf2cdff95991c4e50f1125bce6366ac0", "url": "https://github.com/elastic/elasticsearch/commit/04cb142cdf2cdff95991c4e50f1125bce6366ac0", "message": "Apply suggestions from code review", "committedDate": "2020-11-20T17:05:08Z", "type": "commit"}]}