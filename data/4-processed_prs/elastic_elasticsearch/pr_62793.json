{"pr_number": 62793, "pr_title": "Avoid using bundled jdk on unsupported platforms", "pr_createdAt": "2020-09-22T20:46:04Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/62793", "timeline": [{"oid": "f9d37e031426c439249b8043f34e10e63a0511a8", "url": "https://github.com/elastic/elasticsearch/commit/f9d37e031426c439249b8043f34e10e63a0511a8", "message": "Avoid using bundled jdk on unsupported platforms\n\nWe use the bundled jdk for unit, integ and packaging tests. Since\nupgrading to jdk 15, centos-6 and oracle enterprise linux 6 have failed\ndue to versions of glibc no longer supported by the jdk. This commit\nadds detection of the old glibc versions to gradle, and utilizes that\nwhen deciding which jdk to use for tests.\n\nrelates #62709\ncloses #62635", "committedDate": "2020-09-22T20:38:33Z", "type": "commit"}, {"oid": "7d0a2d490eb7ffc345c3dc9edabb67bbeb0402f2", "url": "https://github.com/elastic/elasticsearch/commit/7d0a2d490eb7ffc345c3dc9edabb67bbeb0402f2", "message": "spotless", "committedDate": "2020-09-22T20:56:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc2NzE2MQ==", "url": "https://github.com/elastic/elasticsearch/pull/62793#discussion_r493767161", "bodyText": "We should cache this result in a static variable so we don't have to shell out on every build invocation. This is considered safe because a) we're just storing a static reference to a boolean so leaks aren't an issue and b) this is very unlikely to change between build invocations on the same machine.\nWe do the same for findDefaultParallel() so let's follow that pattern.", "author": "mark-vieira", "createdAt": "2020-09-23T17:30:21Z", "path": "buildSrc/src/main/java/org/elasticsearch/gradle/info/GlobalBuildInfoPlugin.java", "diffHunk": "@@ -276,6 +278,28 @@ private static String findJavaHome(String version) {\n         return versionedJavaHome;\n     }\n \n+    private static boolean findIfBundledJdkSupported(Project project) {\n+        if (Os.isFamily(Os.FAMILY_UNIX) == false || Os.isFamily(Os.FAMILY_MAC)) {", "originalCommit": "7d0a2d490eb7ffc345c3dc9edabb67bbeb0402f2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5e26825f14dccedee436309ed06a8a7c21a879ee", "url": "https://github.com/elastic/elasticsearch/commit/5e26825f14dccedee436309ed06a8a7c21a879ee", "message": "address feedback", "committedDate": "2020-09-23T22:00:34Z", "type": "commit"}, {"oid": "c97155a79fac8a593ca7387321251bfa0e3127e6", "url": "https://github.com/elastic/elasticsearch/commit/c97155a79fac8a593ca7387321251bfa0e3127e6", "message": "spotless", "committedDate": "2020-09-23T22:09:54Z", "type": "commit"}, {"oid": "26537272ade9d8e7c4f25132c790acf715791e82", "url": "https://github.com/elastic/elasticsearch/commit/26537272ade9d8e7c4f25132c790acf715791e82", "message": "set JAVA_HOME for test clusters on legacy systems", "committedDate": "2020-09-23T23:09:08Z", "type": "commit"}]}