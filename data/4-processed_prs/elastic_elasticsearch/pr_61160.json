{"pr_number": 61160, "pr_title": "EQL: make endsWith function use a wildcard ES query wherever possible", "pr_createdAt": "2020-08-14T16:20:22Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/61160", "timeline": [{"oid": "cc865f708262c2350c81ee0e0867f2d115c73eda", "url": "https://github.com/elastic/elasticsearch/commit/cc865f708262c2350c81ee0e0867f2d115c73eda", "message": "Make endsWith function use a wildcard ES query wherever possible", "committedDate": "2020-08-14T16:07:48Z", "type": "commit"}, {"oid": "b5baf376caa812c80680a65c434b31a529bd7004", "url": "https://github.com/elastic/elasticsearch/commit/b5baf376caa812c80680a65c434b31a529bd7004", "message": "Properly handle \"wildcard\" field in tests.", "committedDate": "2020-08-17T09:14:44Z", "type": "commit"}, {"oid": "d83baea5315bcfd82696eebf29411c7dfdefb20f", "url": "https://github.com/elastic/elasticsearch/commit/d83baea5315bcfd82696eebf29411c7dfdefb20f", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into 58922_impl", "committedDate": "2020-08-17T09:14:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQzOTMyMw==", "url": "https://github.com/elastic/elasticsearch/pull/61160#discussion_r471439323", "bodyText": "Nice.", "author": "costin", "createdAt": "2020-08-17T12:18:37Z", "path": "x-pack/plugin/eql/src/test/resources/queryfolder_tests.txt", "diffHunk": "@@ -105,13 +105,8 @@ process where cidrMatch(source_address, \"10.0.0.0/8\") != false\n twoFunctionsEqualsBooleanLiterals-caseSensitive\n process where endsWith(process_path, 'x') == true and endsWith(process_path, 'yx') == false\n ;\n-\"bool\":{\"must\":[{\"term\":{\"event.category\":{\"value\":\"process\"\n-\"must\":[{\"script\":{\"script\":{\"source\":\"InternalQlScriptUtils.nullSafeFilter(\n-InternalEqlScriptUtils.endsWith(InternalQlScriptUtils.docValue(doc,params.v0),params.v1,params.v2))\",\"lang\":\"painless\",\n-\"params\":{\"v0\":\"process_path\",\"v1\":\"x\",\"v2\":true}}\n-\"script\":{\"script\":{\"source\":\"InternalQlScriptUtils.nullSafeFilter(InternalQlScriptUtils.not(\n-InternalEqlScriptUtils.endsWith(InternalQlScriptUtils.docValue(doc,params.v0),params.v1,params.v2)))\",\"lang\":\"painless\",\n-\"params\":{\"v0\":\"process_path\",\"v1\":\"yx\",\"v2\":true}}", "originalCommit": "d83baea5315bcfd82696eebf29411c7dfdefb20f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1e0da7b7389824963d0e441b8e483dd7850efea2", "url": "https://github.com/elastic/elasticsearch/commit/1e0da7b7389824963d0e441b8e483dd7850efea2", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into 58922_impl", "committedDate": "2020-08-19T08:39:11Z", "type": "commit"}, {"oid": "94fe38506c5894e6bde2b80220dac02d96be4744", "url": "https://github.com/elastic/elasticsearch/commit/94fe38506c5894e6bde2b80220dac02d96be4744", "message": "Address review", "committedDate": "2020-08-19T08:58:11Z", "type": "commit"}]}