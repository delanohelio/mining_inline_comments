{"pr_number": 54046, "pr_title": "Add SAML IdP plugin for internal use", "pr_createdAt": "2020-03-24T01:21:26Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/54046", "timeline": [{"oid": "3f32f5d79197013f37bd73b3b16617834a64a1be", "url": "https://github.com/elastic/elasticsearch/commit/3f32f5d79197013f37bd73b3b16617834a64a1be", "message": "X-Pack SAML IdP Plugin (#51514)\n\nThis introduces a new sub-plugin to X-Pack that implements the backend\r\nfor a basic IdP built on top of the X-Pack security primitives.\r\n\r\nIn this commit there is a mostly empty plugin implementation and a\r\nclass the implements the minimum necessary to generate a SAML 2.0\r\nauthentication \"Response\".", "committedDate": "2020-01-30T11:00:05Z", "type": "commit"}, {"oid": "aa9e541ed24f0a8da9d23f00f68e06e4156a3b2f", "url": "https://github.com/elastic/elasticsearch/commit/aa9e541ed24f0a8da9d23f00f68e06e4156a3b2f", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-02-03T09:54:28Z", "type": "commit"}, {"oid": "207dce8092a107c26c61a2426e1cc8d1d10bda4f", "url": "https://github.com/elastic/elasticsearch/commit/207dce8092a107c26c61a2426e1cc8d1d10bda4f", "message": "Add IDP Configuration settings and related tests (#51682)", "committedDate": "2020-02-03T11:12:24Z", "type": "commit"}, {"oid": "789b4e49e385ad6ac8acd4e88261720e5e10dcc2", "url": "https://github.com/elastic/elasticsearch/commit/789b4e49e385ad6ac8acd4e88261720e5e10dcc2", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-02-07T06:03:15Z", "type": "commit"}, {"oid": "aac2e432a38f3e23103457cf55fababf5c5e28e5", "url": "https://github.com/elastic/elasticsearch/commit/aac2e432a38f3e23103457cf55fababf5c5e28e5", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-02-11T13:23:53Z", "type": "commit"}, {"oid": "bf2dee1ca9d78ffa1419d29952776b598a8ec051", "url": "https://github.com/elastic/elasticsearch/commit/bf2dee1ca9d78ffa1419d29952776b598a8ec051", "message": "Add signing support to SAML IdP (#51517)\n\nAdds a new \"SamlObjectSigner\" class that can sign messages such as\r\nauthn Response objects", "committedDate": "2020-02-12T00:58:15Z", "type": "commit"}, {"oid": "eb88cdd6cc6169b5a90e5fcc36ed9af693702e4e", "url": "https://github.com/elastic/elasticsearch/commit/eb88cdd6cc6169b5a90e5fcc36ed9af693702e4e", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-02-12T05:12:34Z", "type": "commit"}, {"oid": "726b58771db4a77c1c3c193803e12f809af79867", "url": "https://github.com/elastic/elasticsearch/commit/726b58771db4a77c1c3c193803e12f809af79867", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-02-17T12:12:07Z", "type": "commit"}, {"oid": "4b4393de6b11421866c13cef01edf6dcbd9f9898", "url": "https://github.com/elastic/elasticsearch/commit/4b4393de6b11421866c13cef01edf6dcbd9f9898", "message": "IDP-initiated sso REST handler (#51830)\n\nNecessary rest handler and transport action for consuming an SP\r\nEntityID and producing a SAML response for the authenticating user.\r\nTransportSamlInitiateSingleSignOnAction needs to be adjusted to\r\ntake advantage of the secondary authentication handling logic once\r\nthis is available.", "committedDate": "2020-02-18T06:23:34Z", "type": "commit"}, {"oid": "749c3c47122a40ef860c7343864be99fec32680d", "url": "https://github.com/elastic/elasticsearch/commit/749c3c47122a40ef860c7343864be99fec32680d", "message": "Resolve application privileges to SP access (#52250)\n\nAdds a new UserPrivilegeResolver class that determines whether a user\r\nhas access to a service, and with what groups, based on an application\r\nresource model that represents the service.", "committedDate": "2020-02-18T22:55:48Z", "type": "commit"}, {"oid": "97eed1586fca1a7c2574444b48eb68b2956edaa9", "url": "https://github.com/elastic/elasticsearch/commit/97eed1586fca1a7c2574444b48eb68b2956edaa9", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-02-23T10:39:21Z", "type": "commit"}, {"oid": "c84a9c049388d8106b64dd161bd6435bb62c2a3c", "url": "https://github.com/elastic/elasticsearch/commit/c84a9c049388d8106b64dd161bd6435bb62c2a3c", "message": "Fix compile / merge issue (#52643)\n\nCompilation of the feature-internal-idp branch was broken due to\r\nconflicting merges.", "committedDate": "2020-02-23T12:22:40Z", "type": "commit"}, {"oid": "760b39a64b4d3e8a115ad2272fe11aaa5c69d64f", "url": "https://github.com/elastic/elasticsearch/commit/760b39a64b4d3e8a115ad2272fe11aaa5c69d64f", "message": "Write SAML SP data to a dedicated index (#52401)\n\nThis adds low level classes for reading & writing documents that\r\nmodel a SAML Service Provider in the IdP.\r\n(These classes are not currently used)", "committedDate": "2020-02-24T10:21:49Z", "type": "commit"}, {"oid": "6151bb830c00a3d3bc7f4efabc196655861be3a3", "url": "https://github.com/elastic/elasticsearch/commit/6151bb830c00a3d3bc7f4efabc196655861be3a3", "message": "Automatically install SAML SP index template (#52706)\n\nTriggers the installation of the index template automatically due to\r\ncluster state changes, or before writing a SP doc", "committedDate": "2020-02-26T06:42:53Z", "type": "commit"}, {"oid": "81886168c1121cc9a6358a9b541504506d5edd70", "url": "https://github.com/elastic/elasticsearch/commit/81886168c1121cc9a6358a9b541504506d5edd70", "message": "Update IdP plugin security policy (#52740)\n\nApacheXMLSecurityInitializer (a dependency of OpenSAML) attempts to\r\nset the \"org.apache.xml.security.ignoreLineBreaks\" system property if\r\nit doesn't exist", "committedDate": "2020-02-26T06:48:30Z", "type": "commit"}, {"oid": "eaa2e4f8b7c5a7ea3474463cf3ae5a95c9e21643", "url": "https://github.com/elastic/elasticsearch/commit/eaa2e4f8b7c5a7ea3474463cf3ae5a95c9e21643", "message": "Handle incoming AuthnRequests (#52018)\n\n- Expose an API that consumes (possibly signed) AuthnRequests as\r\ndefined by the HTTP-Redirect binding.\r\n- Process AuthnRequests, validate and parse them into a minimum\r\nset of information to be used for subsequent API calls to get a\r\nSAML Response", "committedDate": "2020-02-26T13:58:43Z", "type": "commit"}, {"oid": "3b22e1e96d2464d087bdb45c3001829d54511251", "url": "https://github.com/elastic/elasticsearch/commit/3b22e1e96d2464d087bdb45c3001829d54511251", "message": "Create SAML Responses for secondary authN (#52805)\n\nCreate the SAML responses for the principal that we should. The\r\ncredentials of this user need to have been passed in the\r\nes-secondary-authorization header.", "committedDate": "2020-02-26T13:59:05Z", "type": "commit"}, {"oid": "bfe6d437233a25600782bfc819d95db0a78e2583", "url": "https://github.com/elastic/elasticsearch/commit/bfe6d437233a25600782bfc819d95db0a78e2583", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-02-28T06:08:56Z", "type": "commit"}, {"oid": "4bc83702c6a6a5a0c37962bc524e86cf843a369b", "url": "https://github.com/elastic/elasticsearch/commit/4bc83702c6a6a5a0c37962bc524e86cf843a369b", "message": "Generate SAML metadata for the Identity Provider (#52415)\n\nThis change adds an API for generating SAML metadata for the\r\nconfigured Identity Provider. All parameters that can contribute\r\nto the metadata, from signing keys to Organization and contact\r\ndetails are all configured in node settings.\r\nThe caller of the API needs to define the SP that will consume this\r\nmetadata as the values included can potentially be different,\r\ndepending on the registered SP configuration and the IDP policy.", "committedDate": "2020-02-28T07:29:20Z", "type": "commit"}, {"oid": "443b8056078924084973337e1be952d57fd66f4c", "url": "https://github.com/elastic/elasticsearch/commit/443b8056078924084973337e1be952d57fd66f4c", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-03-05T00:17:30Z", "type": "commit"}, {"oid": "0cd3ba919ae24b87f171bb643c5e6e41cc5f6f11", "url": "https://github.com/elastic/elasticsearch/commit/0cd3ba919ae24b87f171bb643c5e6e41cc5f6f11", "message": "Add REST endpoint to register a new SAML SP (#52936)\n\nThis change adds a new PUT /_idp/saml/sp/{entity_id} endpoint that\r\nregisters (or updates) a Service Provider in the IDP.", "committedDate": "2020-03-05T03:46:33Z", "type": "commit"}, {"oid": "34c14190a1f51ef6e044df8669022e9585b994e5", "url": "https://github.com/elastic/elasticsearch/commit/34c14190a1f51ef6e044df8669022e9585b994e5", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-03-05T04:48:24Z", "type": "commit"}, {"oid": "a4b7150a0bbd9ca03d5e93bcf3e53d62445587a1", "url": "https://github.com/elastic/elasticsearch/commit/a4b7150a0bbd9ca03d5e93bcf3e53d62445587a1", "message": "Make ServiceProvider lookup asynchronous (#52986)\n\nThis prepares for reading the real Service Provider data from the saml\r\nindex.\r\n\r\nWe intend to support a large number of ServiceProviders within a\r\nsingle cluster, so it is not reasible to keep them all cached in\r\nmemory. Since the read from the underyling index will be asynchronous,\r\nall methods that make use of a service provider also need to be\r\nasychronous.", "committedDate": "2020-03-05T05:14:48Z", "type": "commit"}, {"oid": "2f2853740a65c3ba0ddfe65acd9cb3c671c3c7aa", "url": "https://github.com/elastic/elasticsearch/commit/2f2853740a65c3ba0ddfe65acd9cb3c671c3c7aa", "message": "Resolve runtime SP model from index doc (#52985)\n\nThis change adds a `SamlServiceProviderResolver` that can build a\r\n`SamlServiceProvider` object for a given entity-id, based on the\r\ndocument model stored in `SamlServiceProviderDocument`.\r\n\r\nThis resolver includes a cache that is aware of document versioning\r\n(seqNo, primaryTerm) and avoids JSON parsing and object construction\r\nif the document has not changed since last use.", "committedDate": "2020-03-05T12:40:27Z", "type": "commit"}, {"oid": "0af00f889350805b62c92ab09172483f4e7ac3a5", "url": "https://github.com/elastic/elasticsearch/commit/0af00f889350805b62c92ab09172483f4e7ac3a5", "message": "Refactor SamlIdentityProvider setup (#52990)\n\nThe SamlIdentityProvider / CloudIdp classes had evolved gradually from\r\ntheir initial commit to the point where they no longer were quite the\r\nright fit for the project.\r\n\r\nThis change merges the class and interface, and migrates some of the\r\ninstantiation logic that had been split between the Plugin and the\r\nclass into a separate Builder object.\r\n\r\nWe also move the Contact and Organisation information from the\r\nmetadata builder into the IdentityProvider class so that the class is\r\nself-contained.", "committedDate": "2020-03-05T23:26:28Z", "type": "commit"}, {"oid": "498bb7f8833733136d25191ad5b1e4ab55abdcdb", "url": "https://github.com/elastic/elasticsearch/commit/498bb7f8833733136d25191ad5b1e4ab55abdcdb", "message": "Use optionalVLong (#53149)\n\nUpdates SamlServiceProviderDocument to use the new\r\nread/writeOptionalVLong methods from #53145", "committedDate": "2020-03-09T06:03:56Z", "type": "commit"}, {"oid": "ed3770f8f3b3a4ddc62807bda7a472b843ac8cbd", "url": "https://github.com/elastic/elasticsearch/commit/ed3770f8f3b3a4ddc62807bda7a472b843ac8cbd", "message": "Rename \"groups\" to \"roles\" (#53208)\n\nThe Identity Provider has a feature to release a standard set of\r\nattributes to a Service Provider. One of those attributes is intended\r\nto represent the groups or roles to which the user belongs.\r\n\r\nFrom an Identity Provider point of view, there is no concrete\r\ndefinition of what these attributes represent or should be used for -\r\nthe Service Provider may treat them as \"groups\" (a named collection of\r\nusers) or \"roles\" (a named representation of the user's access\r\nrights).\r\n\r\nTerminology across IdPs varies, but we have decided that within the ES\r\nIdP, we will refer to them as \"roles\". This change replaces any use of\r\nthe term \"groups\" with \"roles\".", "committedDate": "2020-03-09T06:04:25Z", "type": "commit"}, {"oid": "4e38c4ea19f2d5f20ec2f7031e47f3d0aedee2c7", "url": "https://github.com/elastic/elasticsearch/commit/4e38c4ea19f2d5f20ec2f7031e47f3d0aedee2c7", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-03-09T09:25:08Z", "type": "commit"}, {"oid": "1874fc6fd3d9a78d976553464d4867e1daa7cd93", "url": "https://github.com/elastic/elasticsearch/commit/1874fc6fd3d9a78d976553464d4867e1daa7cd93", "message": "Resolve real (indexed) SPs from IdentityProvider (#53211)\n\nThis change hooks the SamlIdentityProvider class up to the\r\nSamlServiceProviderResolver so that we return real registered\r\nservice providers during SSO handling", "committedDate": "2020-03-09T13:06:48Z", "type": "commit"}, {"oid": "82b9e0715f9e69c7d3acd74d2e77f80777b0f5a6", "url": "https://github.com/elastic/elasticsearch/commit/82b9e0715f9e69c7d3acd74d2e77f80777b0f5a6", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-03-10T00:29:26Z", "type": "commit"}, {"oid": "fdf3abf8e9fd58910535ac2a384dbaad091ab855", "url": "https://github.com/elastic/elasticsearch/commit/fdf3abf8e9fd58910535ac2a384dbaad091ab855", "message": "Resolve correct service privileges for user (#53213)\n\nWhen a user SSOs to a service provider, the IdP will provide\r\nattributes to indicate the user's access (roles) in that service.\r\n\r\nThis change connect the component that determines the user's access\r\n(UserPrivilegeResolver) to the action that generates the SAML response\r\n(TransportSamlInitiateSingleSignOnAction).", "committedDate": "2020-03-10T02:14:33Z", "type": "commit"}, {"oid": "6b0afdd070e4464118e8c0ddd02b0f060133f1c6", "url": "https://github.com/elastic/elasticsearch/commit/6b0afdd070e4464118e8c0ddd02b0f060133f1c6", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-03-10T20:39:21Z", "type": "commit"}, {"oid": "00dd338f78b48f4792f5fc14e422a9a0e5b05ea8", "url": "https://github.com/elastic/elasticsearch/commit/00dd338f78b48f4792f5fc14e422a9a0e5b05ea8", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-03-11T10:46:26Z", "type": "commit"}, {"oid": "6a757b414d24494e4765cf0a1c7d3ee064215314", "url": "https://github.com/elastic/elasticsearch/commit/6a757b414d24494e4765cf0a1c7d3ee064215314", "message": "Remove explicit login action and application (#53320)\n\nThis removes the concept of a login action, and instead relies\r\nexclusively on the existence of roles to determine whether a user has\r\naccess to a service resource.\r\n\r\nIt also removes the ability for a service provider to be configured to have a\r\nresource under a custom application name.", "committedDate": "2020-03-11T12:23:41Z", "type": "commit"}, {"oid": "23a01634640a842f443dada1738838bd2ce4ad12", "url": "https://github.com/elastic/elasticsearch/commit/23a01634640a842f443dada1738838bd2ce4ad12", "message": "Add missing parameters to HasPrivileges requests (#53396)\n\nThe request must contain cluster and indices privileges", "committedDate": "2020-03-11T14:02:05Z", "type": "commit"}, {"oid": "9628bc5596ad023d8330820961c3e1cd1ab6fd14", "url": "https://github.com/elastic/elasticsearch/commit/9628bc5596ad023d8330820961c3e1cd1ab6fd14", "message": "Sign SAML responses by default (#53382)\n\nSign all SAML Responses ( the Response Element without signing\r\nthe included Assertion ) that the Idp sends to any SP. To that\r\neffect, make it an error to not set a signing credential when\r\nbuilding a SamlIdentityProvider.", "committedDate": "2020-03-11T15:26:33Z", "type": "commit"}, {"oid": "7b19e6c8e298fb9793ac19fdb364a569d69f9ab7", "url": "https://github.com/elastic/elasticsearch/commit/7b19e6c8e298fb9793ac19fdb364a569d69f9ab7", "message": "Return appropriate error codes (#53371)\n\nWhen we fail to validate an Authentication request because the\r\nrequest is invalid, respond with 400 instead of 500.", "committedDate": "2020-03-11T15:32:37Z", "type": "commit"}, {"oid": "614ffa235711d56c0bc5c90aca5a5aa802c9228a", "url": "https://github.com/elastic/elasticsearch/commit/614ffa235711d56c0bc5c90aca5a5aa802c9228a", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-03-12T04:53:06Z", "type": "commit"}, {"oid": "72b1921431403d6afc7c602184df97f427da3a8c", "url": "https://github.com/elastic/elasticsearch/commit/72b1921431403d6afc7c602184df97f427da3a8c", "message": "Configure SP defaults from YAML settings (#53279)\n\nThis change adds support for reading the SP defaults from the\r\nelasticsearch Settings", "committedDate": "2020-03-12T05:58:50Z", "type": "commit"}, {"oid": "76954183fbcc28ce8433dc8cc11280717e8be0d9", "url": "https://github.com/elastic/elasticsearch/commit/76954183fbcc28ce8433dc8cc11280717e8be0d9", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-03-12T14:29:30Z", "type": "commit"}, {"oid": "c280a9023375929d3315fc151937460c3c28b516", "url": "https://github.com/elastic/elasticsearch/commit/c280a9023375929d3315fc151937460c3c28b516", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-03-13T02:05:09Z", "type": "commit"}, {"oid": "2ab89953785258e85628f0c0da5c7b37eea1f1b7", "url": "https://github.com/elastic/elasticsearch/commit/2ab89953785258e85628f0c0da5c7b37eea1f1b7", "message": "Add endpoint to delete a service provider by ID (#53322)\n\nThis API is a sibling to the existing Put SAML Service Provider API\r\nthat registers a new SP.\r\n\r\nThe implementation is a hard delete.", "committedDate": "2020-03-13T03:27:56Z", "type": "commit"}, {"oid": "bbab4504d7420e7a32c846e725b65fcdf319d10d", "url": "https://github.com/elastic/elasticsearch/commit/bbab4504d7420e7a32c846e725b65fcdf319d10d", "message": "Handle refresh policy for the request to write the SP to the index (#53364)\n\nSet default refresh policy to NONE", "committedDate": "2020-03-13T06:58:28Z", "type": "commit"}, {"oid": "33ce27b795157fc9a90aaa88bd4fbf4be51f27cf", "url": "https://github.com/elastic/elasticsearch/commit/33ce27b795157fc9a90aaa88bd4fbf4be51f27cf", "message": "Handle SamlAuthenticationState between APIs (#53254)\n\nAfter successful validation of an AuthnRequest the caller of the\r\n/validate API needs to call /init to generate the SAML response\r\nthat it can then send to the SP. There is some context that needs\r\nto be carried from the response of the /validate API to the\r\nrequest to the /init API. This context is encapsulated in the\r\nSamlAuthenticationState object that is serialized to a json\r\nobject in the SamlValidateAuthnRequestResponse. This can be\r\ntreated as an opaque blob for the caller of the API that just\r\nneeds to pass it to the subsequent request to the /init API. At\r\nthe same time we enable SAML responses that indicate failure\r\n(as opposed to returning a 4xx) for both the /init API as\r\ndictated by the SAML 2.0 Web Browser SSO profile.\r\n\r\nAdditionally these small adjustments were made:\r\n\r\n- Saml Service Providers must indicate a single NameID format that\r\n  they want to use upon registration, instead of multiple. This is\r\n  used to validate the NameID Policy of the AuthnRequest if it\r\n  exists or to determine the NameID format for the response\r\n  otherwise.\r\n- If no NameID Policy is set in the AuthnRequest and the SP has\r\n  not registered a desired one, an IDP wide default NameID format\r\n  is returned.\r\n- JSON response fomat for the RestSamlInitiateSingleSignOnAction\r\n  has been reviewed as discussed.\r\n- All Rest actions have been moved under the same package", "committedDate": "2020-03-13T07:30:16Z", "type": "commit"}, {"oid": "2f8fb1fe3f0daab82011e8d7ee09e8d519a359fa", "url": "https://github.com/elastic/elasticsearch/commit/2f8fb1fe3f0daab82011e8d7ee09e8d519a359fa", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-03-15T10:19:26Z", "type": "commit"}, {"oid": "1b7bf83aecdaa13f90bca26e4df1f0584e22b512", "url": "https://github.com/elastic/elasticsearch/commit/1b7bf83aecdaa13f90bca26e4df1f0584e22b512", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-03-17T02:32:04Z", "type": "commit"}, {"oid": "3bdf4c7c6e2cbcbfa2f593be5ef21c99cff7ce7d", "url": "https://github.com/elastic/elasticsearch/commit/3bdf4c7c6e2cbcbfa2f593be5ef21c99cff7ce7d", "message": "Add supported NameID Format configuration and generate transient values (#53593)\n\nOnly transient format is supported for now.", "committedDate": "2020-03-17T10:22:58Z", "type": "commit"}, {"oid": "22d11bc86b3d9a3790152d95f8f0fe3d5c8cc141", "url": "https://github.com/elastic/elasticsearch/commit/22d11bc86b3d9a3790152d95f8f0fe3d5c8cc141", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-03-17T16:08:42Z", "type": "commit"}, {"oid": "8d17336332f274440ca7f12e1558cf88805b2b94", "url": "https://github.com/elastic/elasticsearch/commit/8d17336332f274440ca7f12e1558cf88805b2b94", "message": "Add a QA project for identity provider module (#53585)\n\nThis adds a small QA project that starts up a cluster with the IdP\r\nenabled and performs a basic test of registering a service provider.\r\n\r\nIt also fixes a few bugs that were found along the way.", "committedDate": "2020-03-17T23:54:42Z", "type": "commit"}, {"oid": "00affa3f3dcb74b020f4f96a8139780ec1fd324a", "url": "https://github.com/elastic/elasticsearch/commit/00affa3f3dcb74b020f4f96a8139780ec1fd324a", "message": "Populate SAML Response Attribute Values (#53665)\n\nAdd name, email and principal as attributes in the successful\r\nSAML response", "committedDate": "2020-03-18T06:39:30Z", "type": "commit"}, {"oid": "98b3de6d610bb5f8b1b9f2affa878d0ef0c69643", "url": "https://github.com/elastic/elasticsearch/commit/98b3de6d610bb5f8b1b9f2affa878d0ef0c69643", "message": "Merge branch 'feature-internal-idp' of github.com:elastic/elasticsearch into feature-internal-idp", "committedDate": "2020-03-18T06:49:23Z", "type": "commit"}, {"oid": "5f5a24b53a7f7f09f9432b0f8737a681e1736e9e", "url": "https://github.com/elastic/elasticsearch/commit/5f5a24b53a7f7f09f9432b0f8737a681e1736e9e", "message": "License Checks for IDP (#53651)\n\nIdp related functionality should only be available for enterprise\r\nlicenses.", "committedDate": "2020-03-18T08:40:39Z", "type": "commit"}, {"oid": "031bd2e5a4d517e78a385f7259d78c66cabb6dab", "url": "https://github.com/elastic/elasticsearch/commit/031bd2e5a4d517e78a385f7259d78c66cabb6dab", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-03-18T08:41:39Z", "type": "commit"}, {"oid": "a128009d2bd074d9e7670356e2c5893ad94d88e2", "url": "https://github.com/elastic/elasticsearch/commit/a128009d2bd074d9e7670356e2c5893ad94d88e2", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-03-20T12:01:22Z", "type": "commit"}, {"oid": "6bbc23105cfd7e7e59cd09a9aee180881c83c62e", "url": "https://github.com/elastic/elasticsearch/commit/6bbc23105cfd7e7e59cd09a9aee180881c83c62e", "message": "Merge remote-tracking branch 'origin/master' into feature-internal-idp", "committedDate": "2020-03-23T20:51:37Z", "type": "commit"}, {"oid": "3e9744ae4e54e5c2e9a50d76bb0c4cc25309d0ba", "url": "https://github.com/elastic/elasticsearch/commit/3e9744ae4e54e5c2e9a50d76bb0c4cc25309d0ba", "message": "Add Integration tests for the new IDP handlers (#53130)\n\nAdds a base class for IDP related EsIntegTests (IdpIntegTestCase)\r\nand tests for the existing APIs", "committedDate": "2020-03-23T23:02:16Z", "type": "commit"}, {"oid": "2a9887896de455844f0782687239b5ee346916f6", "url": "https://github.com/elastic/elasticsearch/commit/2a9887896de455844f0782687239b5ee346916f6", "message": "Fix IdP signing (#53971)\n\nFixes signing to run with the correct context classloader.\r\nThis in turn requires doPrivileged.", "committedDate": "2020-03-24T01:10:03Z", "type": "commit"}, {"oid": "0af19688bf4e91f6ec70fca687e80d11aee98dba", "url": "https://github.com/elastic/elasticsearch/commit/0af19688bf4e91f6ec70fca687e80d11aee98dba", "message": "Merge branch 'master' into feature-internal-idp", "committedDate": "2020-03-24T01:16:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg3OTAxMQ==", "url": "https://github.com/elastic/elasticsearch/pull/54046#discussion_r396879011", "bodyText": "This is a drive-by comment. I can't find any uses of this? And also, I think that AbstractWireSerializingTestCase provides roughly the same functionality?", "author": "jasontedor", "createdAt": "2020-03-24T03:10:04Z", "path": "test/framework/src/main/java/org/elasticsearch/test/SerializationTestUtils.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.test;\n+\n+import org.elasticsearch.Version;\n+import org.elasticsearch.common.io.stream.InputStreamStreamInput;\n+import org.elasticsearch.common.io.stream.OutputStreamStreamOutput;\n+import org.elasticsearch.common.io.stream.Writeable;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.equalTo;\n+\n+/**\n+ * Utility methods for assisting with testing {@link Writeable} object.\n+ */\n+public class SerializationTestUtils {", "originalCommit": "0af19688bf4e91f6ec70fca687e80d11aee98dba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg5NTIwNg==", "url": "https://github.com/elastic/elasticsearch/pull/54046#discussion_r396895206", "bodyText": "It's used in\n\nidp.action.DeleteSamlServiceProviderRequestTests\nidp.action.PutSamlServiceProviderRequestTests\nidp.saml.sp.SamlServiceProviderDocumentTests\nidp.saml.support.SamlAuthenticationStateTests\n\nYou're right, I can switch those to use the existing methods.\nI was sure we had something like that, but I just couldn't find it, so I figured I must have remembered incorrectly.", "author": "tvernum", "createdAt": "2020-03-24T04:22:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg3OTAxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg5NjE3NQ==", "url": "https://github.com/elastic/elasticsearch/pull/54046#discussion_r396896175", "bodyText": "Strange, the IDE showed me there were not any uses. Either way, thanks for switching over.", "author": "jasontedor", "createdAt": "2020-03-24T04:27:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg3OTAxMQ=="}], "type": "inlineReview"}, {"oid": "070698b9d03e5b452543ed46c237dc2f27838c02", "url": "https://github.com/elastic/elasticsearch/commit/070698b9d03e5b452543ed46c237dc2f27838c02", "message": "Fix test to always have roles (#54048)\n\nThis change fixes a radomised failure in\r\nTransportSamlInitiateSingleSignOnRequestTests\r\n\r\nUnder some seeds (e.g. 856F19C80D0A73B6) the roles array would be\r\nempty, which would mean that the generated SAML response would not\r\ncontain a roles attribute.", "committedDate": "2020-03-24T07:48:50Z", "type": "commit"}, {"oid": "a403ae208102eaabde36e648d57f8312435f734d", "url": "https://github.com/elastic/elasticsearch/commit/a403ae208102eaabde36e648d57f8312435f734d", "message": "Remove SerializationTestUtils (#54052)\n\nThis change replaces the SerializationTestUtils class with methods\r\nfrom ESTestCase", "committedDate": "2020-03-24T08:11:46Z", "type": "commit"}, {"oid": "ab53868f6dcc6fef4631d6e25d1653c6a419ebcc", "url": "https://github.com/elastic/elasticsearch/commit/ab53868f6dcc6fef4631d6e25d1653c6a419ebcc", "message": "Wrap RestorableContextClassLoader with doPrivileged (#54053)\n\nNeeded since RestorableContextClassLoader was moved to core (from\r\nsecurity)", "committedDate": "2020-03-24T12:37:16Z", "type": "commit"}]}