{"pr_number": 66530, "pr_title": "[DOCS] Runtime fields improvements", "pr_createdAt": "2020-12-17T15:16:44Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/66530", "timeline": [{"oid": "e3c939d8ab3482143d073d89feee92659bb44d3c", "url": "https://github.com/elastic/elasticsearch/commit/e3c939d8ab3482143d073d89feee92659bb44d3c", "message": "Changes for dynamic templates.", "committedDate": "2020-12-16T22:07:04Z", "type": "commit"}, {"oid": "e0368fdf5f361350cbc68fc22f0c079b98bf1282", "url": "https://github.com/elastic/elasticsearch/commit/e0368fdf5f361350cbc68fc22f0c079b98bf1282", "message": "Clarifying language around dynamic:true and dynamic:runtime.", "committedDate": "2020-12-17T15:15:52Z", "type": "commit"}, {"oid": "d1a51205f817193bbfddd46c94fa0cc08fac62b3", "url": "https://github.com/elastic/elasticsearch/commit/d1a51205f817193bbfddd46c94fa0cc08fac62b3", "message": "Clarifying edits and some restructuring.", "committedDate": "2020-12-17T23:12:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjYyMjcyNQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r546622725", "bodyText": "do we need to reinforce that it is mapped as a runtime keyword rather than the \"ordinary\" keyword?", "author": "javanna", "createdAt": "2020-12-21T10:18:45Z", "path": "docs/reference/mapping/dynamic/templates.asciidoc", "diffHunk": "@@ -124,18 +128,53 @@ PUT my-index-000001/_doc/1\n <1> The `my_integer` field is mapped as an `integer`.\n <2> The `my_string` field is mapped as a `text`, with a `keyword` <<multi-fields,multi field>>.\n \n+[[match-mapping-runtime-fields]]\n+===== Mapping runtime fields in a dynamic template\n+You can also map runtime fields in a dynamic template. For example, the\n+following request adds a dynamic template named `dayofweek` that maps all\n+incoming `string` fields as `keyword` fields. Although the `runtime` definition\n+is blank, new `string` fields will be mapped as `keyword` fields based on the\n+<<dynamic-field-mapping-types,dynamic mapping rules>> that {es} uses for adding\n+field types to the mapping. Any `string` that doesn't pass date detection or\n+numeric detection is automatically mapped as a `keyword` when `dynamic` is set", "originalCommit": "d1a51205f817193bbfddd46c94fa0cc08fac62b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "581946e713ed8d08269b0e55bc9c77376eab4ad1", "url": "https://github.com/elastic/elasticsearch/commit/581946e713ed8d08269b0e55bc9c77376eab4ad1", "message": "Merge branch 'master' into docs__runtime-fields-improvements", "committedDate": "2021-01-04T15:48:26Z", "type": "commit"}, {"oid": "245a8cab07b92bdc12fab562fc351463cab047a5", "url": "https://github.com/elastic/elasticsearch/commit/245a8cab07b92bdc12fab562fc351463cab047a5", "message": "Overhauling the Mapping page.", "committedDate": "2021-01-04T23:27:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg4MzAxNA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r551883014", "bodyText": "I am trying to understand how explicit mappings would require more storage space compared to dynamic field mappings. It depends I would say, and also around search performance, it may depend.", "author": "javanna", "createdAt": "2021-01-05T11:46:26Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,14 +5,39 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n-\n-* which string fields should be treated as full text fields.\n-* which fields contain numbers, dates, or geolocations.\n-* the <<mapping-date-format,format>> of date values.\n-* custom rules to control the mapping for\n+are stored and indexed. You can choose how and where to map your data. Each\n+method provides different benefits based on where you are in your data journey:\n+\n+* <<dynamic-field-mapping,Dynamic field mappings>> allow you to experiment with\n+and explore data when you\u2019re just getting started. {es} will add new fields\n+automatically, just by indexing a document. You can add fields to the top-level\n+mapping, and to inner <<object,`object`>>  and <<nested,`nested`>> fields.\n+* <<runtime-search-request,Runtime fields in search requests>> are flexible,\n+allowing you to experiment with different mapping options.\n+* <<runtime-mapping-fields,Runtime fields in index mappings>> allow you to make\n+schema changes without reindexing. You can use these fields in conjunction with\n+indexed fields to balance resource usage and performance. Your index will be\n+smaller, but with slower search performance.\n+* <<explicit-mapping,Explicit mappings>> provide the best search performance", "originalCommit": "245a8cab07b92bdc12fab562fc351463cab047a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTk4MTY5Nw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r551981697", "bodyText": "Yes, this is tricky! With dynamic mapping and explicit mapping (with the exception of runtime fields), you're indexing fields. So, either method would increase the index size. I'm trying to separate runtime fields from explicit mapping, though one form of runtime fields is still explicit mapping.\nMaybe this statement should be more like:\n\nExplicit mappings typically provide the best search performance. However, you must reindex your data to modify the mappings, which can be costly.", "author": "lockewritesdocs", "createdAt": "2021-01-05T14:54:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg4MzAxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjA1NzI5MA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r552057290", "bodyText": "I would like to avoid sentences like \"explicit mapping (with the exception of runtime fields)\". runtime fields can be mapped explicitly or dynamically, like any other field. So I find it confusing to refer to explicit mappings with the exception of runtime fields.\nI think that with the introduction of runtime fields a sentence like \"Explicit mappings typically provide the best search performance\" no longer stands. I see what you are trying to do, provide clear messaging to users on the different options they have, but I would try to not make runtime fields an exception. I would focus more on what runtime fields allow users to do compared to ordinary fields, regardless of how they are mapped.", "author": "javanna", "createdAt": "2021-01-05T16:50:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg4MzAxNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg4MzM1Ng==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r551883356", "bodyText": "what;s the difference between explicit mapping and using runtime fields?", "author": "javanna", "createdAt": "2021-01-05T11:47:01Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,14 +5,39 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n-\n-* which string fields should be treated as full text fields.\n-* which fields contain numbers, dates, or geolocations.\n-* the <<mapping-date-format,format>> of date values.\n-* custom rules to control the mapping for\n+are stored and indexed. You can choose how and where to map your data. Each\n+method provides different benefits based on where you are in your data journey:\n+\n+* <<dynamic-field-mapping,Dynamic field mappings>> allow you to experiment with\n+and explore data when you\u2019re just getting started. {es} will add new fields\n+automatically, just by indexing a document. You can add fields to the top-level\n+mapping, and to inner <<object,`object`>>  and <<nested,`nested`>> fields.\n+* <<runtime-search-request,Runtime fields in search requests>> are flexible,\n+allowing you to experiment with different mapping options.\n+* <<runtime-mapping-fields,Runtime fields in index mappings>> allow you to make\n+schema changes without reindexing. You can use these fields in conjunction with\n+indexed fields to balance resource usage and performance. Your index will be\n+smaller, but with slower search performance.\n+* <<explicit-mapping,Explicit mappings>> provide the best search performance\n+but require more storage space, resulting in a larger index.\n+\n+When mapping your data using runtime fields or through explicit mapping, you", "originalCommit": "245a8cab07b92bdc12fab562fc351463cab047a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTk3NzUxMQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r551977511", "bodyText": "Hmm...other than using runtime fields in a search request, I guess that you're explicitly mapping fields on both accounts. That is, you're adding something to the mapping. The difference is that values for one are always stored in _source, while runtime fields can calculate values at query time. Correct?", "author": "lockewritesdocs", "createdAt": "2021-01-05T14:47:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg4MzM1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjAyOTQwMA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r552029400", "bodyText": "yes, to me mappings-wise, there is no difference. only runtime fields are defined in a separate section, but it is still under mappings. So after all you can explicitly map runtime fields or concrete fields, or you can automatically map runtime fields or concrete fields.", "author": "javanna", "createdAt": "2021-01-05T16:06:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg4MzM1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg4NDY5NA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r551884694", "bodyText": "FYI #66911 you will get a conflict on this line when that one gets merged", "author": "javanna", "createdAt": "2021-01-05T11:50:09Z", "path": "docs/reference/mapping/dynamic/field-mapping.asciidoc", "diffHunk": "@@ -2,25 +2,24 @@\n === Dynamic field mapping\n \n When {es} detects a new field in a document, it _dynamically_ adds the field to\n-the type mapping. The <<dynamic,`dynamic`>> parameter controls this behavior.\n+the type mapping by default. The <<dynamic,`dynamic`>> parameter controls this behavior.\n \n-You can disable dynamic mapping, both at the document and at the\n-<<object,`object`>> level. Setting the `dynamic` parameter to\n-`false` ignores new fields, and `strict` rejects the document if {es}\n-encounters an unknown field.\n-\n-When dynamic field mapping is enabled, {es} uses the following rules to\n+You can explicitly instruct {es} to dynamically create fields based on incoming\n+documents by setting the `dynamic` parameter to `true` or `runtime`. When\n+dynamic field mapping is enabled, {es} uses the rules in the following table to\n determine how to map data types for each field.\n \n-NOTE: These are the only <<mapping-types,field data types>> that {es} detects\n-dynamically. All other data types must be mapped explicitly.\n+NOTE: The field data types in the following table are the only\n+<<mapping-types,field data types>> that {es} detects dynamically. You must\n+explicitly map all other data types.\n \n+[[dynamic-field-mapping-types]]\n [cols=\"3\"]\n |===\n h| JSON data type h| `dynamic:true` h| `dynamic:runtime`\n  |`null` 2*| No field added\n  |`true` or `false` 2*| `boolean`\n- |floating point number | `float` | `double`\n+ |`double` | `float` | `double`", "originalCommit": "245a8cab07b92bdc12fab562fc351463cab047a5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1f30c4590dba928b3be7d16ee86a768a71614d64", "url": "https://github.com/elastic/elasticsearch/commit/1f30c4590dba928b3be7d16ee86a768a71614d64", "message": "Incorporating changes from #66911.", "committedDate": "2021-01-05T17:29:24Z", "type": "commit"}, {"oid": "901b78df48d01a59a26dd4b6a0ba2ae1c120983f", "url": "https://github.com/elastic/elasticsearch/commit/901b78df48d01a59a26dd4b6a0ba2ae1c120983f", "message": "Reworking mapping page to focus on dynamic vs. explicit mapping.", "committedDate": "2021-01-05T21:30:45Z", "type": "commit"}, {"oid": "176e3a541db46eb5915159e15239d149fd4b1832", "url": "https://github.com/elastic/elasticsearch/commit/176e3a541db46eb5915159e15239d149fd4b1832", "message": "Merge branch 'master' into docs__runtime-fields-improvements", "committedDate": "2021-01-06T14:10:06Z", "type": "commit"}, {"oid": "a6adf7b786fa6cfea548abf10459d47c1f7215a4", "url": "https://github.com/elastic/elasticsearch/commit/a6adf7b786fa6cfea548abf10459d47c1f7215a4", "message": "Reordering to fix test failure.", "committedDate": "2021-01-06T14:29:22Z", "type": "commit"}, {"oid": "97f98ec3e8a488e1ccbef67fa026ee919d1b2845", "url": "https://github.com/elastic/elasticsearch/commit/97f98ec3e8a488e1ccbef67fa026ee919d1b2845", "message": "Further clarifying mapping page.", "committedDate": "2021-01-06T16:08:55Z", "type": "commit"}, {"oid": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "url": "https://github.com/elastic/elasticsearch/commit/d99eec8f2db97e0031ec152a37cc48a66a834b89", "message": "Reordering sections, adding headings to examples, and other clarifications.", "committedDate": "2021-01-06T21:57:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyMzA1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553523059", "bodyText": "properties should probably be removed as it refers only to concrete fields?", "author": "javanna", "createdAt": "2021-01-07T19:02:00Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,30 +5,54 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n+are stored and indexed.\n \n-* which string fields should be treated as full text fields.\n-* which fields contain numbers, dates, or geolocations.\n-* the <<mapping-date-format,format>> of date values.\n-* custom rules to control the mapping for\n-  <<dynamic-mapping,dynamically added fields>>.\n+Each document is a collection of fields, which each have their own\n+<<mapping-types,data type>>. When mapping your data, you create a mapping\n+definition, which contains a list of fields or `properties` that are pertinent", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyMzg0Mg==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553523842", "bodyText": "one thing that I am not sure is clear is that you can also go for a mixed approach, meaning you map some fields manually, and others dynamically. From this sentence it may seem like you need to decide to go for one or the other approach upfront.", "author": "javanna", "createdAt": "2021-01-07T19:03:28Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,30 +5,54 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n+are stored and indexed.\n \n-* which string fields should be treated as full text fields.\n-* which fields contain numbers, dates, or geolocations.\n-* the <<mapping-date-format,format>> of date values.\n-* custom rules to control the mapping for\n-  <<dynamic-mapping,dynamically added fields>>.\n+Each document is a collection of fields, which each have their own\n+<<mapping-types,data type>>. When mapping your data, you create a mapping\n+definition, which contains a list of fields or `properties` that are pertinent\n+to the document. A mapping definition also includes\n+<<mapping-fields,metadata fields>>, like the `_source` field, which customize\n+how a document's associated metadata is handled.\n+\n+You can choose a _dynamic mapping_ or an _explicit mapping_ to define your data.", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU0NDM4Mg==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553544382", "bodyText": "Yeah, that sentence is limiting. Is this revision precise enough?\n\nUse dynamic mapping and explicit mapping to define your data. Each method\nprovides different benefits based on where you are in your data journey. You\nmight explicitly map specific fields that you want to query frequently, such as\na timestamp, whereas Elasticsearch can add other fields dynamically.", "author": "lockewritesdocs", "createdAt": "2021-01-07T19:38:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyMzg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU1Njk4Nw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553556987", "bodyText": "well, even the timestamp does not need to be mapped if its format is the one that ES supports by default. It is really \"map anything explicitly if the defaults are not good enough, or if you want to have control over which fields get created\"", "author": "javanna", "createdAt": "2021-01-07T19:59:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyMzg0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNDUwOQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553524509", "bodyText": "I would not mention here runtime fields explicitly, as they should be considered just fields. It should not come as a surprise that runtime fields can be both mapped explicitly or dynamically", "author": "javanna", "createdAt": "2021-01-07T19:04:45Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,30 +5,54 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n+are stored and indexed.\n \n-* which string fields should be treated as full text fields.\n-* which fields contain numbers, dates, or geolocations.\n-* the <<mapping-date-format,format>> of date values.\n-* custom rules to control the mapping for\n-  <<dynamic-mapping,dynamically added fields>>.\n+Each document is a collection of fields, which each have their own\n+<<mapping-types,data type>>. When mapping your data, you create a mapping\n+definition, which contains a list of fields or `properties` that are pertinent\n+to the document. A mapping definition also includes\n+<<mapping-fields,metadata fields>>, like the `_source` field, which customize\n+how a document's associated metadata is handled.\n+\n+You can choose a _dynamic mapping_ or an _explicit mapping_ to define your data.\n+Each method provides different benefits based on where you are in your data\n+journey.\n \n-A mapping definition includes metadata fields and fields:\n+NOTE: Before 7.0.0, the mapping definition included a type name.\n+{es} 7.0.0 and later no longer accept a _default_ mapping. See <<removal-of-types>>.\n \n-<<mapping-fields,Metadata fields>>::\n+[discrete]\n+[[mapping-dynamic]]\n+== Dynamic mapping\n+<<dynamic-field-mapping,Dynamic mapping>> allows you to experiment with\n+and explore data when you\u2019re just getting started. {es} adds new fields\n+automatically, just by indexing a document. You can add fields to the top-level\n+mapping, and to inner <<object,`object`>>  and <<nested,`nested`>> fields.\n \n-Metadata fields are used to customize how a document's associated metadata is\n-treated. Examples of metadata fields include the document's\n-<<mapping-index-field,`_index`>>, <<mapping-id-field,`_id`>>, and\n-<<mapping-source-field,`_source`>> fields.\n+You can also dynamically map runtime fields:\n \n-<<mapping-types,Fields>>::\n+* <<match-mapping-runtime-fields,Map runtime fields in a dynamic template>> so\n+that new fields are automatically added to the index mapping as runtime fields.\n+* <<runtime-search-request,Define runtime fields in a search request>> to\n+experiment with different mapping options, and also fix mistakes in your index\n+mapping values by overriding values in the mapping during the search request.", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU1MzkxNg==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553553916", "bodyText": "Agreed, though I'm wondering if we want to mention dynamic templates here.\n\nDynamic mapping allows you to experiment with and explore data when you\u2019re just getting started. Elasticsearch adds new fields automatically, just by indexing a document. You can add fields to the top-level mapping, and to inner object and nested fields.\n\n\nUse dynamic templates to define custom mappings that are applied to dynamically added fields based on the matching condition. You can also map runtime fields in a dynamic template so that new fields are automatically added to the index mapping as runtime fields.", "author": "lockewritesdocs", "createdAt": "2021-01-07T19:53:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNDUwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU1NzYyMg==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553557622", "bodyText": "To me, dynamic templates belong to the dynamic mapping side of things. I am not sure if I would mention them explicitly here.", "author": "javanna", "createdAt": "2021-01-07T20:01:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNDUwOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNDY4MA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553524680", "bodyText": "Here too, I would not mention runtime  fields specifically", "author": "javanna", "createdAt": "2021-01-07T19:05:02Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,30 +5,54 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n+are stored and indexed.\n \n-* which string fields should be treated as full text fields.\n-* which fields contain numbers, dates, or geolocations.\n-* the <<mapping-date-format,format>> of date values.\n-* custom rules to control the mapping for\n-  <<dynamic-mapping,dynamically added fields>>.\n+Each document is a collection of fields, which each have their own\n+<<mapping-types,data type>>. When mapping your data, you create a mapping\n+definition, which contains a list of fields or `properties` that are pertinent\n+to the document. A mapping definition also includes\n+<<mapping-fields,metadata fields>>, like the `_source` field, which customize\n+how a document's associated metadata is handled.\n+\n+You can choose a _dynamic mapping_ or an _explicit mapping_ to define your data.\n+Each method provides different benefits based on where you are in your data\n+journey.\n \n-A mapping definition includes metadata fields and fields:\n+NOTE: Before 7.0.0, the mapping definition included a type name.\n+{es} 7.0.0 and later no longer accept a _default_ mapping. See <<removal-of-types>>.\n \n-<<mapping-fields,Metadata fields>>::\n+[discrete]\n+[[mapping-dynamic]]\n+== Dynamic mapping\n+<<dynamic-field-mapping,Dynamic mapping>> allows you to experiment with\n+and explore data when you\u2019re just getting started. {es} adds new fields\n+automatically, just by indexing a document. You can add fields to the top-level\n+mapping, and to inner <<object,`object`>>  and <<nested,`nested`>> fields.\n \n-Metadata fields are used to customize how a document's associated metadata is\n-treated. Examples of metadata fields include the document's\n-<<mapping-index-field,`_index`>>, <<mapping-id-field,`_id`>>, and\n-<<mapping-source-field,`_source`>> fields.\n+You can also dynamically map runtime fields:\n \n-<<mapping-types,Fields>>::\n+* <<match-mapping-runtime-fields,Map runtime fields in a dynamic template>> so\n+that new fields are automatically added to the index mapping as runtime fields.\n+* <<runtime-search-request,Define runtime fields in a search request>> to\n+experiment with different mapping options, and also fix mistakes in your index\n+mapping values by overriding values in the mapping during the search request.\n \n-A mapping contains a list of fields or `properties` pertinent to the\n-document. Each field has its own <<mapping-types, data type>>.\n+[discrete]\n+[[mapping-explicit]]\n+== Explicit mapping\n+<<explicit-mapping,Explicit mapping>> allows you to precisely choose how to\n+define the mapping definition, such as:\n+\n+* Which string fields should be treated as full text fields.\n+* Which fields contain numbers, dates, or geolocations.\n+* The <<mapping-date-format,format>> of date values.\n+* Custom rules to control the mapping for\n+  <<dynamic-mapping,dynamically added fields>>.\n \n-NOTE: Before 7.0.0, the 'mappings' definition used to include a type name.\n-For more details, please see <<removal-of-types>>.\n+You can <<runtime-mapping-fields,explicitly map runtime fields>>,\n+which allows you to make schema changes without reindexing. You can use runtime\n+fields in conjunction with indexed fields to balance resource usage and\n+performance. Your index will be smaller, but with slower search performance.", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNjQxNQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553526415", "bodyText": "as keyword within the runtime section?", "author": "javanna", "createdAt": "2021-01-07T19:08:17Z", "path": "docs/reference/mapping/dynamic/templates.asciidoc", "diffHunk": "@@ -124,18 +128,55 @@ PUT my-index-000001/_doc/1\n <1> The `my_integer` field is mapped as an `integer`.\n <2> The `my_string` field is mapped as a `text`, with a `keyword` <<multi-fields,multi field>>.\n \n+[[match-mapping-runtime-fields]]\n+===== Mapping runtime fields in a dynamic template\n+You can also map runtime fields in a dynamic template. For example, the\n+following request adds a dynamic template named `dayOfWeek` that maps all\n+incoming `string` fields as `keyword` runtime fields. Although the `runtime`\n+definition is blank, new `string` fields will be mapped as `keyword` runtime\n+fields based on the <<dynamic-field-mapping-types,dynamic mapping rules>> that\n+{es} uses for adding field types to the mapping. Any `string` that doesn't pass\n+date detection or numeric detection is automatically mapped as a `keyword` when", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU1NTgwMA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553555800", "bodyText": "Based on the dynamic mapping rules, a string\u00a0that doesn\u2019t pass\u00a0date\u00a0detection or\u00a0numeric\u00a0detection is mapped as a keyword for runtime fields, correct?", "author": "lockewritesdocs", "createdAt": "2021-01-07T19:57:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNjQxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU1ODIxNg==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553558216", "bodyText": "yes, I was referring to the fact that keyword (as well as other field types) exist both under runtime and properties. So I was wondering if we need to be explicit about which side of things we are talking about", "author": "javanna", "createdAt": "2021-01-07T20:02:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNjQxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU4NjU5MQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553586591", "bodyText": "We can be more explicit and say:\n\nFor example, the following request adds a dynamic template named dayOfWeek that maps all\nincoming string fields as keyword fields in the runtime section of the mapping.", "author": "lockewritesdocs", "createdAt": "2021-01-07T21:04:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNjQxNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTAwMDE5MQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555000191", "bodyText": "++", "author": "javanna", "createdAt": "2021-01-11T12:04:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNjQxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNjc4Ng==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553526786", "bodyText": "Was this on purpose?", "author": "javanna", "createdAt": "2021-01-07T19:09:04Z", "path": "docs/reference/mapping/dynamic-mapping.asciidoc", "diffHunk": "@@ -1,11 +1,11 @@\n [[dynamic-mapping]]\n-== Dynamic Mapping\n+== Dynamic mapping\n \n-One of the most important features of Elasticsearch is that it tries to get\n+One of the most important features of {es} is that it tries to get", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU1NjE1Nw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553556157", "bodyText": "Yes! The {es} variable is rendered as Elasticsearch in the output.", "author": "lockewritesdocs", "createdAt": "2021-01-07T19:57:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNjc4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU1ODQ1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553558459", "bodyText": "For some reason my eyes thought that you removed {es} here. you did the opposite, which is totally fine :)", "author": "javanna", "createdAt": "2021-01-07T20:02:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNjc4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNzU5Mw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553527593", "bodyText": "runtime fields are not mentioned at all, maybe the examples should have a mix of runtime fields and indexed fields? Or should we relegate runtime fields to their own page? I am torn on this", "author": "javanna", "createdAt": "2021-01-07T19:10:45Z", "path": "docs/reference/mapping/explicit-mapping.asciidoc", "diffHunk": "@@ -0,0 +1,148 @@\n+\n+[[explicit-mapping]]\n+== Explicit mapping\n+\n+You know more about your data than {es} can guess, so while dynamic\n+mapping can be useful to get started, at some point you will want to specify\n+your own explicit mappings.\n+\n+You can create field mappings when you <<create-mapping,create an index>> and\n+<<add-field-mapping,add fields to an existing index>>.\n+\n+[discrete]\n+[[create-mapping]]\n+=== Create an index with an explicit mapping", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU4MTYyOQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553581629", "bodyText": "I think that we can explore this distinction in a separate PR. It's a valuable conversation.", "author": "lockewritesdocs", "createdAt": "2021-01-07T20:53:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNzU5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTAwMDMyOQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555000329", "bodyText": "++", "author": "javanna", "createdAt": "2021-01-11T12:04:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyNzU5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyODAyNw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553528027", "bodyText": "doesn't this repeat what we already state above?", "author": "javanna", "createdAt": "2021-01-07T19:11:40Z", "path": "docs/reference/mapping/runtime.asciidoc", "diffHunk": "@@ -44,13 +47,13 @@ smaller and you can more quickly process logs without having to index them.\n \n Runtime fields are especially useful in the following contexts:\n \n-* Adding fields to documents that are already indexed without having to reindex\n+* Add fields to documents that are already indexed without having to reindex\n data\n-* Immediately begin working on a new data stream without fully understanding\n-the data it contains\n-* Shadowing an indexed field with a runtime field to fix a mistake after\n-indexing documents\n-* Defining fields that are only relevant for a particular context (such as a\n+* Start work on a new data stream without fully understanding the data it\n+contains\n+* Override the value of an indexed field with a runtime field to fix a mistake\n+after indexing documents\n+* Define fields that are only relevant for a particular context (such as a", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzU1NzMwMA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553557300", "bodyText": "Pretty much. I think we can remove this entire section now since it's restating what is now in the introduction.", "author": "lockewritesdocs", "createdAt": "2021-01-07T20:00:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyODAyNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzUyODQ1Mw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r553528453", "bodyText": "nit: shall we use a more descriptive name for the field?", "author": "javanna", "createdAt": "2021-01-07T19:12:34Z", "path": "docs/reference/mapping/runtime.asciidoc", "diffHunk": "@@ -195,21 +184,42 @@ GET my-index/_search\n   }\n }\n ----\n-// TEST[continued]\n+//TEST[continued]\n \n Defining a runtime field in a search request uses the same format as defining\n a runtime field in the index mapping. That consistency means you can promote a\n runtime field from a search request to the index mapping by moving the field\n definition from `runtime_mappings` in the search request to the `runtime`\n section of the index mapping.\n \n-[[runtime-shadowing-fields]]\n-=== Shadowing fields\n+[[runtime-fields-scriptless]]\n+==== Define runtime fields without a script\n+You can define a runtime field in the mapping definition without a\n+script. At query time, {es} looks in `_source` for a field with the same name\n+and returns a value if one exists. If a field with the same name doesn\u2019t\n+exist, the response doesn't include any values for that runtime field.\n+\n+[source,console]\n+----\n+PUT my-index/\n+{\n+  \"mappings\": {\n+    \"runtime\": {\n+      \"newField\": {", "originalCommit": "d99eec8f2db97e0031ec152a37cc48a66a834b89", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2323993ff4e0b3909839660bf93d38c086f053a9", "url": "https://github.com/elastic/elasticsearch/commit/2323993ff4e0b3909839660bf93d38c086f053a9", "message": "Incorporating review feedback.", "committedDate": "2021-01-07T21:38:15Z", "type": "commit"}, {"oid": "f692f87cb71f8e2d5e6f658af46dd3989d0d089c", "url": "https://github.com/elastic/elasticsearch/commit/f692f87cb71f8e2d5e6f658af46dd3989d0d089c", "message": "Adding description of  for Painless script.", "committedDate": "2021-01-07T21:53:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTAwMTU4MA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555001580", "bodyText": "I like this idea and how it looks in the docs, runtime fields are mentioned but not emphasized. Maybe I would move it down after the explicit and dynamic mapping explanation, up to you", "author": "javanna", "createdAt": "2021-01-11T12:06:48Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,30 +5,61 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n+are stored and indexed.\n+\n+Each document is a collection of fields, which each have their own\n+<<mapping-types,data type>>. When mapping your data, you create a mapping\n+definition, which contains a list of fields that are pertinent to the document.\n+A mapping definition also includes <<mapping-fields,metadata fields>>, like the\n+`_source` field, which customize how a document's associated metadata is\n+handled.\n+\n+Use _dynamic mapping_ and _explicit mapping_ to define your data. Each method\n+provides different benefits based on where you are in your data journey. For\n+example, explicitly map fields where you don't want to use the defaults, or to\n+gain greater control over which fields are created. You can then allow {es} to\n+add other fields dynamically.\n+\n+NOTE: Before 7.0.0, the mapping definition included a type name.\n+{es} 7.0.0 and later no longer accept a _default_ mapping. See <<removal-of-types>>.\n+\n+.Experiment with mapping options", "originalCommit": "f692f87cb71f8e2d5e6f658af46dd3989d0d089c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTEwNTQwNw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555105407", "bodyText": "I would really stop at the first sentence here. I don't see why mentioning runtime fields explicitly. To me it is implicit that you can map runtime fields dynamically, like any other field, especially through dynamic templates", "author": "javanna", "createdAt": "2021-01-11T14:58:25Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,30 +5,61 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n+are stored and indexed.\n+\n+Each document is a collection of fields, which each have their own\n+<<mapping-types,data type>>. When mapping your data, you create a mapping\n+definition, which contains a list of fields that are pertinent to the document.\n+A mapping definition also includes <<mapping-fields,metadata fields>>, like the\n+`_source` field, which customize how a document's associated metadata is\n+handled.\n+\n+Use _dynamic mapping_ and _explicit mapping_ to define your data. Each method\n+provides different benefits based on where you are in your data journey. For\n+example, explicitly map fields where you don't want to use the defaults, or to\n+gain greater control over which fields are created. You can then allow {es} to\n+add other fields dynamically.\n+\n+NOTE: Before 7.0.0, the mapping definition included a type name.\n+{es} 7.0.0 and later no longer accept a _default_ mapping. See <<removal-of-types>>.\n+\n+.Experiment with mapping options\n+****\n+<<runtime-search-request,Define runtime fields in a search request>> to\n+experiment with different mapping options, and also fix mistakes in your index\n+mapping values by overriding values in the mapping during the search request.\n+****\n \n-* which string fields should be treated as full text fields.\n-* which fields contain numbers, dates, or geolocations.\n-* the <<mapping-date-format,format>> of date values.\n-* custom rules to control the mapping for\n-  <<dynamic-mapping,dynamically added fields>>.\n-\n-A mapping definition includes metadata fields and fields:\n-\n-<<mapping-fields,Metadata fields>>::\n-\n-Metadata fields are used to customize how a document's associated metadata is\n-treated. Examples of metadata fields include the document's\n-<<mapping-index-field,`_index`>>, <<mapping-id-field,`_id`>>, and\n-<<mapping-source-field,`_source`>> fields.\n+[discrete]\n+[[mapping-dynamic]]\n+== Dynamic mapping\n+<<dynamic-field-mapping,Dynamic mapping>> allows you to experiment with\n+and explore data when you\u2019re just getting started. {es} adds new fields\n+automatically, just by indexing a document. You can add fields to the top-level\n+mapping, and to inner <<object,`object`>>  and <<nested,`nested`>> fields.\n \n-<<mapping-types,Fields>>::\n+Use <<dynamic-templates,dynamic templates>> to define custom mappings that are\n+applied to dynamically added fields based on the matching condition. You can", "originalCommit": "f692f87cb71f8e2d5e6f658af46dd3989d0d089c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTE5NjIwMQ==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555196201", "bodyText": "+1 -- I'll remove that second sentence.", "author": "lockewritesdocs", "createdAt": "2021-01-11T16:56:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTEwNTQwNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTEzNjI2Mg==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555136262", "bodyText": "If we want to call out Runtime fields explicitly here, I would replace \"explicitly mapping runtime fields\" with \"Runtime fields\".", "author": "javanna", "createdAt": "2021-01-11T15:41:40Z", "path": "docs/reference/mapping.asciidoc", "diffHunk": "@@ -5,30 +5,61 @@\n --\n \n Mapping is the process of defining how a document, and the fields it contains,\n-are stored and indexed. For instance, use mappings to define:\n+are stored and indexed.\n+\n+Each document is a collection of fields, which each have their own\n+<<mapping-types,data type>>. When mapping your data, you create a mapping\n+definition, which contains a list of fields that are pertinent to the document.\n+A mapping definition also includes <<mapping-fields,metadata fields>>, like the\n+`_source` field, which customize how a document's associated metadata is\n+handled.\n+\n+Use _dynamic mapping_ and _explicit mapping_ to define your data. Each method\n+provides different benefits based on where you are in your data journey. For\n+example, explicitly map fields where you don't want to use the defaults, or to\n+gain greater control over which fields are created. You can then allow {es} to\n+add other fields dynamically.\n+\n+NOTE: Before 7.0.0, the mapping definition included a type name.\n+{es} 7.0.0 and later no longer accept a _default_ mapping. See <<removal-of-types>>.\n+\n+.Experiment with mapping options\n+****\n+<<runtime-search-request,Define runtime fields in a search request>> to\n+experiment with different mapping options, and also fix mistakes in your index\n+mapping values by overriding values in the mapping during the search request.\n+****\n \n-* which string fields should be treated as full text fields.\n-* which fields contain numbers, dates, or geolocations.\n-* the <<mapping-date-format,format>> of date values.\n-* custom rules to control the mapping for\n-  <<dynamic-mapping,dynamically added fields>>.\n-\n-A mapping definition includes metadata fields and fields:\n-\n-<<mapping-fields,Metadata fields>>::\n-\n-Metadata fields are used to customize how a document's associated metadata is\n-treated. Examples of metadata fields include the document's\n-<<mapping-index-field,`_index`>>, <<mapping-id-field,`_id`>>, and\n-<<mapping-source-field,`_source`>> fields.\n+[discrete]\n+[[mapping-dynamic]]\n+== Dynamic mapping\n+<<dynamic-field-mapping,Dynamic mapping>> allows you to experiment with\n+and explore data when you\u2019re just getting started. {es} adds new fields\n+automatically, just by indexing a document. You can add fields to the top-level\n+mapping, and to inner <<object,`object`>>  and <<nested,`nested`>> fields.\n \n-<<mapping-types,Fields>>::\n+Use <<dynamic-templates,dynamic templates>> to define custom mappings that are\n+applied to dynamically added fields based on the matching condition. You can\n+<<match-mapping-runtime-fields,map runtime fields in a dynamic template>>\n+so that new fields are automatically added to the index mapping as runtime\n+fields.\n \n-A mapping contains a list of fields or `properties` pertinent to the\n-document. Each field has its own <<mapping-types, data type>>.\n+[discrete]\n+[[mapping-explicit]]\n+== Explicit mapping\n+<<explicit-mapping,Explicit mapping>> allows you to precisely choose how to\n+define the mapping definition, such as:\n+\n+* Which string fields should be treated as full text fields.\n+* Which fields contain numbers, dates, or geolocations.\n+* The <<mapping-date-format,format>> of date values.\n+* Custom rules to control the mapping for\n+  <<dynamic-mapping,dynamically added fields>>.\n \n-NOTE: Before 7.0.0, the 'mappings' definition used to include a type name.\n-For more details, please see <<removal-of-types>>.\n+<<runtime-mapping-fields,Explicitly mapping runtime fields>> allows you to make", "originalCommit": "f692f87cb71f8e2d5e6f658af46dd3989d0d089c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTE5NjkwNA==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555196904", "bodyText": "Changing to:\n\nUse runtime fields to make schema changes without reindexing.", "author": "lockewritesdocs", "createdAt": "2021-01-11T16:57:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTEzNjI2Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTEzODExMw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555138113", "bodyText": "The mention of dynamic runtime here is out of place. If you use dynamic: runtime, you normally would not need to define runtime fields from dynamic templates. If you use dynamic: true, then it would make sense to define some fields as runtime fields, as they would otherwise be indexed.", "author": "javanna", "createdAt": "2021-01-11T15:44:18Z", "path": "docs/reference/mapping/dynamic/templates.asciidoc", "diffHunk": "@@ -124,18 +128,54 @@ PUT my-index-000001/_doc/1\n <1> The `my_integer` field is mapped as an `integer`.\n <2> The `my_string` field is mapped as a `text`, with a `keyword` <<multi-fields,multi field>>.\n \n+[[match-mapping-runtime-fields]]\n+===== Mapping runtime fields in a dynamic template\n+You can also map runtime fields in a dynamic template. For example, the\n+following request adds a dynamic template named `dayOfWeek` that maps all\n+incoming `string` fields as `keyword` fields in the `runtime` section of the\n+mapping. Although the `runtime` definition is blank, new `string` fields will\n+be mapped as `keyword` runtime fields based on the <<dynamic-field-mapping-types,dynamic mapping rules>> that {es} uses for adding field types to the\n+mapping. Any `string` that doesn't pass date detection or numeric detection is\n+automatically mapped as a `keyword` when `dynamic` is set to `runtime`.", "originalCommit": "f692f87cb71f8e2d5e6f658af46dd3989d0d089c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTIxODUzMw==", "url": "https://github.com/elastic/elasticsearch/pull/66530#discussion_r555218533", "bodyText": "Per our conversation, we'll handle this distinction in an upcoming PR.", "author": "lockewritesdocs", "createdAt": "2021-01-11T17:29:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTEzODExMw=="}], "type": "inlineReview"}]}