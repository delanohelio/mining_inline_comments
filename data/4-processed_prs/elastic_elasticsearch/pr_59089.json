{"pr_number": 59089, "pr_title": "Convert modules to use yamlRestTest", "pr_createdAt": "2020-07-06T17:20:35Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/59089", "timeline": [{"oid": "73aee38d07c9738cb60765750e3a3d9013df438c", "url": "https://github.com/elastic/elasticsearch/commit/73aee38d07c9738cb60765750e3a3d9013df438c", "message": "convert modules to yamlRestTest", "committedDate": "2020-07-06T17:15:54Z", "type": "commit"}, {"oid": "35e7f1ed2277e334ca55cb0bd12c38aa5c3ac5b0", "url": "https://github.com/elastic/elasticsearch/commit/35e7f1ed2277e334ca55cb0bd12c38aa5c3ac5b0", "message": "fix test names or disable integTest to allow testingConventions to pass", "committedDate": "2020-07-06T19:05:28Z", "type": "commit"}, {"oid": "6c1eccf01529f45ce7321fa90b66a2ebd9f6ad51", "url": "https://github.com/elastic/elasticsearch/commit/6c1eccf01529f45ce7321fa90b66a2ebd9f6ad51", "message": "configure restresources for geo", "committedDate": "2020-07-06T19:23:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcxNTg0NA==", "url": "https://github.com/elastic/elasticsearch/pull/59089#discussion_r451715844", "bodyText": "doesn't yaml-rest-test apply the rest-resources plugin?", "author": "mark-vieira", "createdAt": "2020-07-08T17:38:00Z", "path": "modules/aggs-matrix-stats/build.gradle", "diffHunk": "@@ -17,6 +17,7 @@\n  * under the License.\n  */\n apply plugin: 'elasticsearch.rest-resources'\n+apply plugin: 'elasticsearch.yaml-rest-test'", "originalCommit": "6c1eccf01529f45ce7321fa90b66a2ebd9f6ad51", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcyMjQyOQ==", "url": "https://github.com/elastic/elasticsearch/pull/59089#discussion_r451722429", "bodyText": "It does, wasn't sure if we wanted to keep it explicit since most projects are configured in some way or if we should just let it be implicit via the yaml-rest-test.\nI don't have a strong opinion either way.", "author": "jakelandis", "createdAt": "2020-07-08T17:49:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcxNTg0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTgxOTIxMQ==", "url": "https://github.com/elastic/elasticsearch/pull/59089#discussion_r451819211", "bodyText": "I don't think we need to be explicit. We are saying this is a \"yaml test project\", we should assume that plugin will apply any dependencies.", "author": "mark-vieira", "createdAt": "2020-07-08T20:53:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcxNTg0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcxNjI1Ng==", "url": "https://github.com/elastic/elasticsearch/pull/59089#discussion_r451716256", "bodyText": "What's creating this task? Can we structure things somehow such that projects only with yaml tests simply don't have this task at all?", "author": "mark-vieira", "createdAt": "2020-07-08T17:38:44Z", "path": "modules/aggs-matrix-stats/build.gradle", "diffHunk": "@@ -28,3 +29,5 @@ restResources {\n     includeCore '_common', 'indices', 'cluster', 'index', 'search', 'nodes'\n   }\n }\n+\n+integTest.enabled = false", "originalCommit": "6c1eccf01529f45ce7321fa90b66a2ebd9f6ad51", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcyNDgxMA==", "url": "https://github.com/elastic/elasticsearch/pull/59089#discussion_r451724810", "bodyText": "It is the PluginBuildPlugin :(  I can't really remove it or conditionally apply it until we get javaYamlTest (and all internalClusterTest are correctly moved too).\nI should be able to get to that after all of the yamlRestTests are converted.", "author": "jakelandis", "createdAt": "2020-07-08T17:53:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcxNjI1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTcxNjY4Ng==", "url": "https://github.com/elastic/elasticsearch/pull/59089#discussion_r451716686", "bodyText": "let's use file() instead of new File().", "author": "mark-vieira", "createdAt": "2020-07-08T17:39:28Z", "path": "modules/geo/build.gradle", "diffHunk": "@@ -17,12 +17,21 @@\n  * under the License.\n  */\n apply plugin: 'elasticsearch.rest-resources'\n+apply plugin: 'elasticsearch.yaml-rest-test'\n \n esplugin {\n   description 'Placeholder plugin for geospatial features in ES. only registers geo_shape field mapper for now'\n   classname 'org.elasticsearch.geo.GeoPlugin'\n }\n \n+restResources {\n+  restApi {\n+    includeCore '_common', 'indices', 'index', 'search'\n+  }\n+}\n artifacts {\n-  restTests(new File(projectDir, \"src/test/resources/rest-api-spec/test\"))\n+  restTests(new File(projectDir, \"src/yamlRestTest/resources/rest-api-spec/test\"))", "originalCommit": "6c1eccf01529f45ce7321fa90b66a2ebd9f6ad51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "35d04173941c5796e509f2872c1aca8174d456c3", "url": "https://github.com/elastic/elasticsearch/commit/35d04173941c5796e509f2872c1aca8174d456c3", "message": "move test over to internalClusterTest", "committedDate": "2020-07-08T19:29:35Z", "type": "commit"}, {"oid": "5c010bc2de6e4a347cc47bf5b9ca63d648e6f7a6", "url": "https://github.com/elastic/elasticsearch/commit/5c010bc2de6e4a347cc47bf5b9ca63d648e6f7a6", "message": "Merge branch 'master' into yamlRestTest_modules", "committedDate": "2020-07-08T19:30:17Z", "type": "commit"}, {"oid": "3a287c9fb91cb9eeba23e033931ff77fd43dbbb5", "url": "https://github.com/elastic/elasticsearch/commit/3a287c9fb91cb9eeba23e033931ff77fd43dbbb5", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_modules", "committedDate": "2020-07-08T19:34:51Z", "type": "commit"}, {"oid": "3125782c0af1939cc0a6ff05755630b42dbac6d0", "url": "https://github.com/elastic/elasticsearch/commit/3125782c0af1939cc0a6ff05755630b42dbac6d0", "message": "move more over to internalClusterTest", "committedDate": "2020-07-08T21:19:50Z", "type": "commit"}, {"oid": "0c5ecce369470b7c2d846d61c99d5038b614d8b3", "url": "https://github.com/elastic/elasticsearch/commit/0c5ecce369470b7c2d846d61c99d5038b614d8b3", "message": "review changes", "committedDate": "2020-07-11T16:04:17Z", "type": "commit"}, {"oid": "03331186c6c51408e57d5ece44eeef1850ea4ba9", "url": "https://github.com/elastic/elasticsearch/commit/03331186c6c51408e57d5ece44eeef1850ea4ba9", "message": "Merge branch 'master' into yamlRestTest_modules", "committedDate": "2020-07-11T16:26:40Z", "type": "commit"}, {"oid": "01c4cafc5b39f04bea1f35b90f3f39ba0ea77ff7", "url": "https://github.com/elastic/elasticsearch/commit/01c4cafc5b39f04bea1f35b90f3f39ba0ea77ff7", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_modules", "committedDate": "2020-07-13T13:52:55Z", "type": "commit"}, {"oid": "7dcdf8bf7e2596ff84165750c7515ae8d9b7863c", "url": "https://github.com/elastic/elasticsearch/commit/7dcdf8bf7e2596ff84165750c7515ae8d9b7863c", "message": "fix merge conflict", "committedDate": "2020-07-13T15:54:10Z", "type": "commit"}]}