{"pr_number": 59238, "pr_title": "[7.x] [DOCS] Adding get snapshot API docs", "pr_createdAt": "2020-07-08T16:08:20Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/59238", "timeline": [{"oid": "feca2a6a8a3d77a53b539f40c980125c94a958ff", "url": "https://github.com/elastic/elasticsearch/commit/feca2a6a8a3d77a53b539f40c980125c94a958ff", "message": "[DOCS] Adding get snapshot API docs (#59098)\n\n* Adding page for get snapshot API.\r\n\r\n* Adding values for state and cleaning up some other formatting.\r\n\r\n* Adding missing forward slash to GET request.\r\n\r\n* Updating values for start_time and end_time in TESTRESPONSE.\r\n\r\n* Swap \"return\" for \"retrieve\"\r\n\r\n* Swap \"return\" for \"retrieve\" 2\r\n\r\n* Change .snapshot to .response\r\n\r\n* Adding response parameters and incorporating edits from review.\r\n\r\n* Update response example to include repository info\r\n\r\n* Change dash to underscore\r\n\r\n* Add data type for snapshot in response\r\n\r\n* Incorporating review comments and adding missing response definitions.\r\n\r\n* Minor rewording in description.", "committedDate": "2020-07-08T15:52:32Z", "type": "commit"}, {"oid": "39a7b3c076cb90b94e4c8911224ce643205cf2c9", "url": "https://github.com/elastic/elasticsearch/commit/39a7b3c076cb90b94e4c8911224ce643205cf2c9", "message": "Removing multi-snapshot support for 7.x.", "committedDate": "2020-07-08T16:04:36Z", "type": "commit"}, {"oid": "5890f900a33338198c32985edfa68eb6599c0bbd", "url": "https://github.com/elastic/elasticsearch/commit/5890f900a33338198c32985edfa68eb6599c0bbd", "message": "Changing end_time value from build error.", "committedDate": "2020-07-08T16:36:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY4MzUwMw==", "url": "https://github.com/elastic/elasticsearch/pull/59238#discussion_r451683503", "bodyText": "Assuming this response format is correct, you'll need to change $body.responses.0.snapshots.0 to $body.snapshots.0 in these comments.\nFor example:\n// TESTRESPONSE[s/\"uuid\": \"vdRctLCxSketdKb54xw67g\"/\"uuid\": $body.responses.0.snapshots.0.uuid/]\n\nshould become:\n// TESTRESPONSE[s/\"uuid\": \"vdRctLCxSketdKb54xw67g\"/\"uuid\": $body.snapshots.0.uuid/]\n\nThere is no responses property for the CI to navigate through.", "author": "jrodewig", "createdAt": "2020-07-08T16:44:12Z", "path": "docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc", "diffHunk": "@@ -0,0 +1,234 @@\n+[[get-snapshot-api]]\n+=== Get snapshot API\n+++++\n+<titleabbrev>Get snapshot</titleabbrev>\n+++++\n+\n+Retrieves information about one or more snapshots.\n+\n+////\n+[source,console]\n+----\n+PUT /_snapshot/my_repository\n+{\n+  \"type\": \"fs\",\n+  \"settings\": {\n+    \"location\": \"my_backup_location\"\n+  }\n+}\n+\n+PUT /_snapshot/my_repository/my_snapshot?wait_for_completion=true\n+\n+PUT /_snapshot/my_repository/snapshot_2?wait_for_completion=true\n+----\n+// TESTSETUP\n+////\n+\n+[source,console]\n+----\n+GET /_snapshot/my_repository/my_snapshot\n+----\n+\n+[[get-snapshot-api-request]]\n+==== {api-request-title}\n+\n+`GET /_snapshot/<repository>/<snapshot>`\n+\n+[[get-snapshot-api-desc]]\n+==== {api-description-title}\n+\n+Use the get snapshot API to return information about one or more snapshots, including:\n+\n+* Start and end time values\n+* Version of {es} that created the snapshot\n+* List of included indices\n+* Current state of the snapshot\n+* List of failures that occurred during the snapshot\n+\n+[[get-snapshot-api-path-params]]\n+==== {api-path-parms-title}\n+\n+`<repository>`::\n+(Required, string)\n+Snapshot repository name used to limit the request.\n++\n+To get information about all snapshot repositories registered in the\n+cluster, omit this parameter or use `*` or `_all`.\n+\n+`<snapshot>`::\n+(Required, string)\n+Comma-separated list of snapshot names to retrieve. Also accepts wildcards (`*`).\n++\n+* To get information about all snapshots in a registered repository, use a wildcard (`*`) or `_all`.\n+* To get information about any snapshots that are currently running, use `_current`.\n++\n+NOTE: Using `_all` in a request fails if any snapshots are unavailable.\n+Set <<get-snapshot-api-ignore-unavailable,`ignore_unavailable`>> to `true` to return only available snapshots.\n+\n+[role=\"child_attributes\"]\n+[[get-snapshot-api-request-body]]\n+==== {api-request-body-title}\n+\n+[[get-snapshot-api-ignore-unavailable]]\n+`ignore_unavailable`::\n+(Optional, boolean)\n+If `false`, the request returns an error for any snapshots that are unavailable. Defaults to `false`.\n++\n+If `true`, the request ignores snapshots that are unavailable, such as those that are corrupted or temporarily cannot be returned.\n+\n+`verbose`::\n+(Optional, boolean)\n+If `true`, returns all available information about a snapshot. Defaults to `true`.\n++\n+If `false`, omits additional information about the snapshot, such as version information, start and end times, and the number of snapshotted shards.\n+\n+[role=\"child_attributes\"]\n+[[get-snapshot-api-response-body]]\n+==== {api-response-body-title}\n+\n+`snapshot`::\n+(string)\n+Name of the snapshot.\n+\n+`uuid`::\n+(string)\n+Universally unique identifier (UUID) of the snapshot.\n+\n+`version_id`::\n+(int)\n+Build ID of the {es} version used to create the snapshot.\n+\n+`version`::\n+(float)\n+{es} version used to create the snapshot.\n+\n+`indices`::\n+(array)\n+List of indices included in the snapshot.\n+\n+`data_streams`::\n+(array)\n+List of <<data-streams,data streams>> included in the snapshot.\n+\n+`include_global_state`::\n+(boolean)\n+Indicates whether the current cluster state is included in the snapshot.\n+\n+`start_time`::\n+(string)\n+Date timestamp of when the snapshot creation process started.\n+\n+`start_time_in_millis`::\n+(long)\n+The time, in milliseconds, when the snapshot creation process started.\n+\n+`end_time`::\n+(string)\n+Date timestamp of when the snapshot creation process ended.\n+\n+`end_time_in_millis`::\n+(long)\n+The time, in milliseconds, when the snapshot creation process ended.\n+\n+`duration_in_millis`::\n+(long)\n+How long, in milliseconds, it took to create the snapshot.\n+\n+[[get-snapshot-api-response-failures]]\n+`failures`::\n+(array)\n+Lists any failures that occurred when creating the snapshot.\n+\n+`shards`::\n+(object)\n+Contains a count of shards in the snapshot.\n++\n+.Properties of `shards`\n+[%collapsible%open]\n+====\n+`total`::\n+(integer)\n+Total number of shards included in the snapshot.\n+\n+`successful`::\n+(integer)\n+Number of shards that were successfully included in the snapshot.\n+\n+`failed`::\n+(integer)\n+Number of shards that failed to be included in the snapshot.\n+====\n+\n+`state`::\n++\n+--\n+(string)\n+The snapshot `state` can be one of the following values:\n+\n+.Values for `state`\n+[%collapsible%open]\n+====\n+`IN_PROGRESS`::\n+  The snapshot is currently running.\n+\n+`SUCCESS`::\n+  The snapshot finished and all shards were stored successfully.\n+\n+`FAILED`::\n+  The snapshot finished with an error and failed to store any data.\n+\n+`PARTIAL`::\n+  The global cluster state was stored, but data of at least one shard was not stored successfully.\n+  The <<get-snapshot-api-response-failures,`failures`>> section of the response contains more detailed information about shards\n+  that were not processed correctly.\n+====\n+--\n+\n+[[get-snapshot-api-example]]\n+==== {api-examples-title}\n+\n+The following request returns information for `snapshot_2` in the `my_repository` repository.\n+\n+[source,console]\n+----\n+GET /_snapshot/my_repository/snapshot_2\n+----\n+\n+The API returns the following response:\n+\n+[source,console-result]\n+----\n+{\n+  \"snapshots\": [\n+    {\n+      \"snapshot\": \"snapshot_2\",\n+      \"uuid\": \"vdRctLCxSketdKb54xw67g\",\n+      \"version_id\": <version_id>,\n+      \"version\": <version>,\n+      \"indices\": [],\n+      \"data_streams\": [],\n+      \"include_global_state\": true,\n+      \"state\": \"SUCCESS\",\n+      \"start_time\": \"2020-07-06T21:55:18.129Z\",\n+      \"start_time_in_millis\": 1593093628850,\n+      \"end_time\": \"2020-07-06T21:55:18.876Z\",\n+      \"end_time_in_millis\": 1593094752018,\n+      \"duration_in_millis\": 0,\n+      \"failures\": [],\n+      \"shards\": {\n+        \"total\": 0,\n+        \"failed\": 0,\n+        \"successful\": 0\n+      }\n+    }\n+  ]\n+}\n+----\n+// TESTRESPONSE[s/\"uuid\": \"vdRctLCxSketdKb54xw67g\"/\"uuid\": $body.responses.0.snapshots.0.uuid/]", "originalCommit": "5890f900a33338198c32985edfa68eb6599c0bbd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3aa55b20efc4d28e102495f365e29488be49cbad", "url": "https://github.com/elastic/elasticsearch/commit/3aa55b20efc4d28e102495f365e29488be49cbad", "message": "Removing .response from snippet testing.", "committedDate": "2020-07-08T20:13:54Z", "type": "commit"}]}