{"pr_number": 61303, "pr_title": "[DOCS] Prune `Search your data` content", "pr_createdAt": "2020-08-18T22:24:07Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/61303", "timeline": [{"oid": "06d014da7051af2a392ffb776a01c4339f00f3da", "url": "https://github.com/elastic/elasticsearch/commit/06d014da7051af2a392ffb776a01c4339f00f3da", "message": "[DOCS] Fix `Search your data` content\n\nChanges:\n\n* Removes narrative docs for URI search. The `q` param is still documented\non the Search API page: https://www.elastic.co/guide/en/elasticsearch/reference/master/search-search.html#search-api-query-params-q\n* Moves docs for the `indices_boost`, `preference`, and `search_type`\nparams to the Search API page.\n* Adds a `Common search options` section to `Search your data`. This\nsection provides xrefs to search fields, pagination, sorting, and async\nsearch docs.", "committedDate": "2020-08-18T22:22:30Z", "type": "commit"}, {"oid": "e824d1344c583aa16bba858d87a0013c5cbde983", "url": "https://github.com/elastic/elasticsearch/commit/e824d1344c583aa16bba858d87a0013c5cbde983", "message": "fix xref", "committedDate": "2020-08-18T22:32:52Z", "type": "commit"}, {"oid": "9226053ab0f51a5a772fb81bd90495cffb613974", "url": "https://github.com/elastic/elasticsearch/commit/9226053ab0f51a5a772fb81bd90495cffb613974", "message": "fix the fix", "committedDate": "2020-08-18T22:33:24Z", "type": "commit"}, {"oid": "a5d80d7a563d3391ed9ef3413568a5f41c10707d", "url": "https://github.com/elastic/elasticsearch/commit/a5d80d7a563d3391ed9ef3413568a5f41c10707d", "message": "fix formatting", "committedDate": "2020-08-18T22:46:24Z", "type": "commit"}, {"oid": "524b01524f37e26dd5207f9f65469e0d09c56e51", "url": "https://github.com/elastic/elasticsearch/commit/524b01524f37e26dd5207f9f65469e0d09c56e51", "message": "Reword", "committedDate": "2020-08-18T23:26:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ4MTg2MA==", "url": "https://github.com/elastic/elasticsearch/pull/61303#discussion_r473481860", "bodyText": "I think it'd be helpful to move this above \"Search multiple data streams and indices\", since that section is fairly long and it'd be easy to miss this roadmap. It also feels natural to have this roadmap right after you see an example response, since it refers to aspects of the response like hit.hits.", "author": "jtibshirani", "createdAt": "2020-08-20T00:43:31Z", "path": "docs/reference/search/search-your-data.asciidoc", "diffHunk": "@@ -227,9 +177,45 @@ GET /*/_search\n ----\n // TEST[setup:my_index]\n \n-include::request/index-boost.asciidoc[]\n-include::request/preference.asciidoc[]\n-include::request/search-type.asciidoc[]\n+[discrete]\n+[[common-search-options]]\n+=== Common search options", "originalCommit": "524b01524f37e26dd5207f9f65469e0d09c56e51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ4ODY4OQ==", "url": "https://github.com/elastic/elasticsearch/pull/61303#discussion_r473488689", "bodyText": "To me it could be confusing to include 'many shards' since adding shards is usually associated with increased parallelism and not worse search latency.", "author": "jtibshirani", "createdAt": "2020-08-20T00:54:18Z", "path": "docs/reference/search/search-your-data.asciidoc", "diffHunk": "@@ -227,9 +177,45 @@ GET /*/_search\n ----\n // TEST[setup:my_index]\n \n-include::request/index-boost.asciidoc[]\n-include::request/preference.asciidoc[]\n-include::request/search-type.asciidoc[]\n+[discrete]\n+[[common-search-options]]\n+=== Common search options\n+\n+You can use the following options to customize your searches.\n+\n+*Paginate search results* +\n+By default, searches return only the top 10 matching hits. To retrieve\n+more or fewer documents, see <<paginate-search-results>>.\n+\n+*Retrieve selected fields* +\n+The search response's `hit.hits` property includes the full document\n+<<mapping-source-field,`_source`>> for each hit. To retrieve only a subset of\n+the `_source` or other fields, see <<search-fields>>.\n+\n+*Sort search results* +\n+By default, search hits are sorted by `_score`, a <<relevance-scores,relevance\n+score>> that measures how well each document matches the query. To customize the\n+calculation of these scores, use the\n+<<query-dsl-function-score-query,`function_score`>> or\n+<<query-dsl-script-score-query,`script_score`>> query. To sort search hits by\n+other field values, see <<sort-search-results>>.\n+\n+*Run an async search* +\n+{es} searches are designed to run on large volumes of data quickly, often\n+returning results in milliseconds. For this reason, searches are\n+_synchronous_ by default. The search request waits for complete results before\n+returning a response. \n+\n+However, complete results can take longer for searches across:\n+\n+* <<frozen-indices,Frozen indices>>\n+* <<modules-cross-cluster-search,Multiple clusters>>\n+* Many shards", "originalCommit": "524b01524f37e26dd5207f9f65469e0d09c56e51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ5NTE3NA==", "url": "https://github.com/elastic/elasticsearch/pull/61303#discussion_r473495174", "bodyText": "Should we link to the aggregation docs here? I think of aggregations as being equally central to a search request as queries.", "author": "jtibshirani", "createdAt": "2020-08-20T01:04:24Z", "path": "docs/reference/search/search-your-data.asciidoc", "diffHunk": "@@ -24,55 +24,29 @@ a specific number of results.\n [[run-an-es-search]]\n == Run a search\n \n-You can use the <<search-search,search API>> to search data stored in\n-{es} data streams or indices.\n-\n-The API can run two types of searches, depending on how you provide\n-queries:\n-\n-<<run-uri-search,URI searches>>::\n-  Queries are provided through a query parameter. URI searches tend to be\n-  simpler and best suited for testing.\n-\n-<<run-request-body-search,Request body searches>>::\n-  Queries are provided through the JSON body of the API request. These queries\n-  are written in <<query-dsl,Query DSL>>. We recommend using request body\n-  searches in most production use cases.\n-\n-[WARNING]\n-====\n-If you specify a query in both the URI and request body, the search API request\n-runs only the URI query.\n-====\n-\n-[discrete]\n-[[run-uri-search]]\n-=== Run a URI search\n-\n-You can use the search API's <<search-api-query-params-q,`q` query string\n-parameter>> to run a search in the request's URI. The `q` parameter only accepts\n-queries written in Lucene's <<query-string-syntax,query string syntax>>.\n+You can use the <<search-search,search API>> to search data stored in {es} data\n+streams or indices. The API's `query` request body parameter accepts queries", "originalCommit": "524b01524f37e26dd5207f9f65469e0d09c56e51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ5NTQxOQ==", "url": "https://github.com/elastic/elasticsearch/pull/61303#discussion_r473495419", "bodyText": "Should we briefly link to the query DSL and aggregation docs here? It seems like a natural first thing to wonder (\"how do I actually specify the search, beyond the example given above?\")", "author": "jtibshirani", "createdAt": "2020-08-20T01:04:45Z", "path": "docs/reference/search/search-your-data.asciidoc", "diffHunk": "@@ -227,9 +177,45 @@ GET /*/_search\n ----\n // TEST[setup:my_index]\n \n-include::request/index-boost.asciidoc[]\n-include::request/preference.asciidoc[]\n-include::request/search-type.asciidoc[]\n+[discrete]\n+[[common-search-options]]\n+=== Common search options\n+\n+You can use the following options to customize your searches.", "originalCommit": "524b01524f37e26dd5207f9f65469e0d09c56e51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzUwMDU4Mw==", "url": "https://github.com/elastic/elasticsearch/pull/61303#discussion_r473500583", "bodyText": "We can avoid emphasizing function_score since it's deprecated, and we're trying to replace it with script_score.", "author": "jtibshirani", "createdAt": "2020-08-20T01:12:54Z", "path": "docs/reference/search/search-your-data.asciidoc", "diffHunk": "@@ -227,9 +177,45 @@ GET /*/_search\n ----\n // TEST[setup:my_index]\n \n-include::request/index-boost.asciidoc[]\n-include::request/preference.asciidoc[]\n-include::request/search-type.asciidoc[]\n+[discrete]\n+[[common-search-options]]\n+=== Common search options\n+\n+You can use the following options to customize your searches.\n+\n+*Paginate search results* +\n+By default, searches return only the top 10 matching hits. To retrieve\n+more or fewer documents, see <<paginate-search-results>>.\n+\n+*Retrieve selected fields* +\n+The search response's `hit.hits` property includes the full document\n+<<mapping-source-field,`_source`>> for each hit. To retrieve only a subset of\n+the `_source` or other fields, see <<search-fields>>.\n+\n+*Sort search results* +\n+By default, search hits are sorted by `_score`, a <<relevance-scores,relevance\n+score>> that measures how well each document matches the query. To customize the\n+calculation of these scores, use the\n+<<query-dsl-function-score-query,`function_score`>> or", "originalCommit": "524b01524f37e26dd5207f9f65469e0d09c56e51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzUwNzMwMg==", "url": "https://github.com/elastic/elasticsearch/pull/61303#discussion_r473507302", "bodyText": "This is a nice simplification. I think the original page was designed when we also supported a query_and_fetch parameter, and so included extra background.", "author": "jtibshirani", "createdAt": "2020-08-20T01:23:26Z", "path": "docs/reference/search/search.asciidoc", "diffHunk": "@@ -164,7 +207,28 @@ Period to retain the <<scroll-search-context,search context>> for scrolling. See\n By default, this value cannot exceed `1d` (24 hours). You can change\n this limit using the `search.max_keep_alive` cluster-level setting.\n \n-include::{es-repo-dir}/rest-api/common-parms.asciidoc[tag=search_type]\n+[[search-type]]\n+`search_type`::\n+(Optional, string)\n+How {wikipedia}/Tf\u2013idf[distributed term frequencies] are calculated for", "originalCommit": "524b01524f37e26dd5207f9f65469e0d09c56e51", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b3fbd9342059543845abc613bebf15388288bcd5", "url": "https://github.com/elastic/elasticsearch/commit/b3fbd9342059543845abc613bebf15388288bcd5", "message": "Address feedback", "committedDate": "2020-08-20T19:53:07Z", "type": "commit"}, {"oid": "d4f2fbe23c2b3300043a7f328f539b4662df77e5", "url": "https://github.com/elastic/elasticsearch/commit/d4f2fbe23c2b3300043a7f328f539b4662df77e5", "message": "iter", "committedDate": "2020-08-20T20:02:48Z", "type": "commit"}, {"oid": "5e11afd661061eca3e8d3bfa187931a2eca3659d", "url": "https://github.com/elastic/elasticsearch/commit/5e11afd661061eca3e8d3bfa187931a2eca3659d", "message": "add file", "committedDate": "2020-08-20T21:06:31Z", "type": "commit"}, {"oid": "ae7b373ef9d03acaf177b5bf120279b2fc554b7b", "url": "https://github.com/elastic/elasticsearch/commit/ae7b373ef9d03acaf177b5bf120279b2fc554b7b", "message": "iter", "committedDate": "2020-08-20T21:15:48Z", "type": "commit"}, {"oid": "15b56725c3f6b8fee7a24c929e27dfd72324f456", "url": "https://github.com/elastic/elasticsearch/commit/15b56725c3f6b8fee7a24c929e27dfd72324f456", "message": "iter", "committedDate": "2020-08-20T21:37:41Z", "type": "commit"}, {"oid": "ff3c37bfa829fd448b85eb650a1b333e62c20372", "url": "https://github.com/elastic/elasticsearch/commit/ff3c37bfa829fd448b85eb650a1b333e62c20372", "message": "fix tests", "committedDate": "2020-08-20T21:45:13Z", "type": "commit"}, {"oid": "ee57c1baaf3d81e40fcabf4225e479a2f772df19", "url": "https://github.com/elastic/elasticsearch/commit/ee57c1baaf3d81e40fcabf4225e479a2f772df19", "message": "iter", "committedDate": "2020-08-20T22:18:29Z", "type": "commit"}, {"oid": "5cddd7112ac966ab6ade1e288c7eb4bf76dced8e", "url": "https://github.com/elastic/elasticsearch/commit/5cddd7112ac966ab6ade1e288c7eb4bf76dced8e", "message": "grammar fixes", "committedDate": "2020-08-20T23:20:21Z", "type": "commit"}, {"oid": "861ed91c791e5ea7485a1b5f330d29f25f8b9686", "url": "https://github.com/elastic/elasticsearch/commit/861ed91c791e5ea7485a1b5f330d29f25f8b9686", "message": "moar fixes", "committedDate": "2020-08-20T23:24:24Z", "type": "commit"}, {"oid": "d2059e98eaac901f8071fb711351b359a0a4b274", "url": "https://github.com/elastic/elasticsearch/commit/d2059e98eaac901f8071fb711351b359a0a4b274", "message": "add link", "committedDate": "2020-08-20T23:29:23Z", "type": "commit"}, {"oid": "585f38ec66d86233a5b119f6cb00d8127c278e3d", "url": "https://github.com/elastic/elasticsearch/commit/585f38ec66d86233a5b119f6cb00d8127c278e3d", "message": "fixes", "committedDate": "2020-08-21T00:07:11Z", "type": "commit"}, {"oid": "bf6d556fdb8c3a4610fb39c1afab1ae0cd172118", "url": "https://github.com/elastic/elasticsearch/commit/bf6d556fdb8c3a4610fb39c1afab1ae0cd172118", "message": "simplify", "committedDate": "2020-08-21T00:23:31Z", "type": "commit"}, {"oid": "13f72b35cf3bad7e71c3bc1aa5f77b18e4fb53df", "url": "https://github.com/elastic/elasticsearch/commit/13f72b35cf3bad7e71c3bc1aa5f77b18e4fb53df", "message": "More changes based on feedback", "committedDate": "2020-08-21T18:29:53Z", "type": "commit"}, {"oid": "0dc9471c307f8260498279bc89f469af29797252", "url": "https://github.com/elastic/elasticsearch/commit/0dc9471c307f8260498279bc89f469af29797252", "message": "fixes", "committedDate": "2020-08-21T19:49:47Z", "type": "commit"}, {"oid": "2fcc1f82c92d4c1894b8d3f6418fd0f5f90f0acf", "url": "https://github.com/elastic/elasticsearch/commit/2fcc1f82c92d4c1894b8d3f6418fd0f5f90f0acf", "message": "Merge remote-tracking branch 'upstream/master' into docs__common-search-options", "committedDate": "2020-08-21T19:50:32Z", "type": "commit"}, {"oid": "7d7fed1471c43e7a82c5a264df9fe1cd4706cf5e", "url": "https://github.com/elastic/elasticsearch/commit/7d7fed1471c43e7a82c5a264df9fe1cd4706cf5e", "message": "setting fixes", "committedDate": "2020-08-21T19:58:14Z", "type": "commit"}, {"oid": "5f5dda4d5dcde9c122ed07780ff81e99f1dded1e", "url": "https://github.com/elastic/elasticsearch/commit/5f5dda4d5dcde9c122ed07780ff81e99f1dded1e", "message": "fix xref", "committedDate": "2020-08-21T20:39:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDk2Nzk0Mw==", "url": "https://github.com/elastic/elasticsearch/pull/61303#discussion_r474967943", "bodyText": "Small comment, this feels weird as a 'tip' because it's very standard/ obvious that you would want to run aggregations alongside your query?", "author": "jtibshirani", "createdAt": "2020-08-21T21:00:56Z", "path": "docs/reference/search/search-your-data.asciidoc", "diffHunk": "@@ -24,55 +24,35 @@ a specific number of results.\n [[run-an-es-search]]\n == Run a search\n \n-You can use the <<search-search,search API>> to search data stored in\n-{es} data streams or indices.\n-\n-The API can run two types of searches, depending on how you provide\n-queries:\n-\n-<<run-uri-search,URI searches>>::\n-  Queries are provided through a query parameter. URI searches tend to be\n-  simpler and best suited for testing.\n-\n-<<run-request-body-search,Request body searches>>::\n-  Queries are provided through the JSON body of the API request. These queries\n-  are written in <<query-dsl,Query DSL>>. We recommend using request body\n-  searches in most production use cases.\n+You can use the <<search-search,search API>> to search and\n+<<search-aggregations,aggregate>> data stored in {es} data streams or indices.\n+The API's `query` request body parameter accepts queries written in\n+<<query-dsl,Query DSL>>.\n \n-[WARNING]\n-====\n-If you specify a query in both the URI and request body, the search API request\n-runs only the URI query.\n-====\n+TIP: You can also use the search API to run <<search-aggregations,search", "originalCommit": "5f5dda4d5dcde9c122ed07780ff81e99f1dded1e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDk5NDI4Mw==", "url": "https://github.com/elastic/elasticsearch/pull/61303#discussion_r474994283", "bodyText": "Thanks for catching this. This should have been removed in an earlier iteration.", "author": "jrodewig", "createdAt": "2020-08-21T22:22:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDk2Nzk0Mw=="}], "type": "inlineReview"}, {"oid": "ac51287c36835cf5e68ffac808430d69cb996024", "url": "https://github.com/elastic/elasticsearch/commit/ac51287c36835cf5e68ffac808430d69cb996024", "message": "remove tip", "committedDate": "2020-08-21T22:22:09Z", "type": "commit"}, {"oid": "3911f0fe7f584ebb3369335b4ed011f83e24ade0", "url": "https://github.com/elastic/elasticsearch/commit/3911f0fe7f584ebb3369335b4ed011f83e24ade0", "message": "Add timeout snippet", "committedDate": "2020-08-22T19:10:49Z", "type": "commit"}]}