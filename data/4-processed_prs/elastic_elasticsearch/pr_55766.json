{"pr_number": 55766, "pr_title": "Add preserve_original setting in edge ngram token filter", "pr_createdAt": "2020-04-25T09:00:35Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/55766", "timeline": [{"oid": "ba598daac8b287435b3d0bd2bb630c150afa4974", "url": "https://github.com/elastic/elasticsearch/commit/ba598daac8b287435b3d0bd2bb630c150afa4974", "message": "Todo of exposing preserve_original in edge-ngram token filter with doc and new test class", "committedDate": "2020-04-25T09:04:44Z", "type": "commit"}, {"oid": "ba598daac8b287435b3d0bd2bb630c150afa4974", "url": "https://github.com/elastic/elasticsearch/commit/ba598daac8b287435b3d0bd2bb630c150afa4974", "message": "Todo of exposing preserve_original in edge-ngram token filter with doc and new test class", "committedDate": "2020-04-25T09:04:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc5NjgxMQ==", "url": "https://github.com/elastic/elasticsearch/pull/55766#discussion_r415796811", "bodyText": "nit: this seems unused, our checkstyle rules will complain about unused imports, so better to remove it now before running the tests.", "author": "cbuescher", "createdAt": "2020-04-27T13:08:08Z", "path": "modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/EdgeNGramTokenFilterFactoryTests.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.analysis.common;\n+\n+import org.apache.lucene.analysis.Tokenizer;\n+import org.apache.lucene.analysis.core.WhitespaceTokenizer;", "originalCommit": "ba598daac8b287435b3d0bd2bb630c150afa4974", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk1OTIwNg==", "url": "https://github.com/elastic/elasticsearch/pull/55766#discussion_r415959206", "bodyText": "My intelliJ removed unused import wasn't configured for elasticsearch project, enabled it now :)", "author": "amitmbm", "createdAt": "2020-04-27T16:23:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc5NjgxMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc5NzcwNQ==", "url": "https://github.com/elastic/elasticsearch/pull/55766#discussion_r415797705", "bodyText": "nit: wording might be better sth like \"Emits original token then set to true. Defaults to false.", "author": "cbuescher", "createdAt": "2020-04-27T13:09:22Z", "path": "docs/reference/analysis/tokenfilters/edgengram-tokenfilter.asciidoc", "diffHunk": "@@ -173,6 +173,10 @@ See <<analysis-edgengram-tokenfilter-max-gram-limits>>.\n (Optional, integer)\n Minimum character length of a gram. Defaults to `1`.\n \n+`preserve_original`::\n+(Optional, boolean)\n+If set to true then it would also emit the original token. Defaults to `false`.", "originalCommit": "ba598daac8b287435b3d0bd2bb630c150afa4974", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk2MTIyNg==", "url": "https://github.com/elastic/elasticsearch/pull/55766#discussion_r415961226", "bodyText": "changed to Emits original token when set to true. Defaults to false. --> notice changed to when from then in the suggested edit.", "author": "amitmbm", "createdAt": "2020-04-27T16:26:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc5NzcwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgxMDkwMQ==", "url": "https://github.com/elastic/elasticsearch/pull/55766#discussion_r415810901", "bodyText": "nit: we usually don't add @author tags to classes or test classes but rely on the commit history rather than code comments to track authors", "author": "cbuescher", "createdAt": "2020-04-27T13:26:31Z", "path": "modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/EdgeNGramTokenFilterFactoryTests.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.analysis.common;\n+\n+import org.apache.lucene.analysis.Tokenizer;\n+import org.apache.lucene.analysis.core.WhitespaceTokenizer;\n+import org.apache.lucene.analysis.standard.StandardTokenizer;\n+import org.elasticsearch.common.settings.Settings;\n+import org.elasticsearch.env.Environment;\n+import org.elasticsearch.index.analysis.AnalysisTestsHelper;\n+import org.elasticsearch.index.analysis.TokenFilterFactory;\n+import org.elasticsearch.test.ESTestCase;\n+import org.elasticsearch.test.ESTokenStreamTestCase;\n+\n+import java.io.IOException;\n+import java.io.StringReader;\n+\n+/**\n+ * Test class for edge_ngram token filter.\n+ *\n+ * @author Amit Khandelwal", "originalCommit": "ba598daac8b287435b3d0bd2bb630c150afa4974", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk2MTgwNQ==", "url": "https://github.com/elastic/elasticsearch/pull/55766#discussion_r415961805", "bodyText": "Ok, removed it.", "author": "amitmbm", "createdAt": "2020-04-27T16:27:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgxMDkwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgxMTE4Ng==", "url": "https://github.com/elastic/elasticsearch/pull/55766#discussion_r415811186", "bodyText": "nit: maybe add newline befor first test method.", "author": "cbuescher", "createdAt": "2020-04-27T13:26:51Z", "path": "modules/analysis-common/src/test/java/org/elasticsearch/analysis/common/EdgeNGramTokenFilterFactoryTests.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to Elasticsearch under one or more contributor\n+ * license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright\n+ * ownership. Elasticsearch licenses this file to you under\n+ * the Apache License, Version 2.0 (the \"License\"); you may\n+ * not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.elasticsearch.analysis.common;\n+\n+import org.apache.lucene.analysis.Tokenizer;\n+import org.apache.lucene.analysis.core.WhitespaceTokenizer;\n+import org.apache.lucene.analysis.standard.StandardTokenizer;\n+import org.elasticsearch.common.settings.Settings;\n+import org.elasticsearch.env.Environment;\n+import org.elasticsearch.index.analysis.AnalysisTestsHelper;\n+import org.elasticsearch.index.analysis.TokenFilterFactory;\n+import org.elasticsearch.test.ESTestCase;\n+import org.elasticsearch.test.ESTokenStreamTestCase;\n+\n+import java.io.IOException;\n+import java.io.StringReader;\n+\n+/**\n+ * Test class for edge_ngram token filter.\n+ *\n+ * @author Amit Khandelwal\n+ */\n+public class EdgeNGramTokenFilterFactoryTests extends ESTokenStreamTestCase {\n+    public void testDefault() throws IOException {", "originalCommit": "ba598daac8b287435b3d0bd2bb630c150afa4974", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk2MjQxMg==", "url": "https://github.com/elastic/elasticsearch/pull/55766#discussion_r415962412", "bodyText": "Just observed this in so many other test classes and copy-pasted the initial test setup :). nvm removed this.", "author": "amitmbm", "createdAt": "2020-04-27T16:28:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTgxMTE4Ng=="}], "type": "inlineReview"}, {"oid": "106e2e910c182479447e238c70cfd5488dc4fe4e", "url": "https://github.com/elastic/elasticsearch/commit/106e2e910c182479447e238c70cfd5488dc4fe4e", "message": "Addressed minor formatting comments", "committedDate": "2020-04-27T16:29:36Z", "type": "commit"}, {"oid": "b4a8d315c708aac0fe6455297485ea9f9fe710ce", "url": "https://github.com/elastic/elasticsearch/commit/b4a8d315c708aac0fe6455297485ea9f9fe710ce", "message": "Merge branch 'master' into feature/expose-preserve-original-in-edge-ngram-token-filter", "committedDate": "2020-04-27T20:21:32Z", "type": "commit"}]}