{"pr_number": 63169, "pr_title": "EQL: Fix syntax for event type", "pr_createdAt": "2020-10-02T10:30:58Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/63169", "timeline": [{"oid": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d", "url": "https://github.com/elastic/elasticsearch/commit/5d4e15d1bf04b7dee0e7e4b6f455906062155d1d", "message": "EQL: Fix syntax for event type\n\nEvent type is actually a string value for `event.category` which can\ncontain any kind of characters, or start with a digit, which currently\nis not supported, so we introduce the possibility to be able to use the\nusual syntax of `\"` and `?\"` for strings and raw strings.\n\nFixes: #62933", "committedDate": "2020-10-02T10:27:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0NTE3OA==", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498745178", "bodyText": "Should be QUOTED_IDENTIFIER.", "author": "costin", "createdAt": "2020-10-02T10:36:45Z", "path": "x-pack/plugin/eql/src/main/antlr/EqlBase.g4", "diffHunk": "@@ -218,6 +213,15 @@ IDENTIFIER\n     : (LETTER | '_' | '@') (LETTER | DIGIT | '_')*\n     ;\n \n+ESCAPED_IDENTIFIER", "originalCommit": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0NTczOA==", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498745738", "bodyText": "?", "author": "costin", "createdAt": "2020-10-02T10:38:08Z", "path": "x-pack/plugin/eql/src/main/antlr/EqlBase.g4", "diffHunk": "@@ -76,7 +76,7 @@ expression\n \n booleanExpression\n     : NOT booleanExpression                                               #logicalNot\n-    | relationship=IDENTIFIER OF subquery                                 #processCheck\n+    | relationship= OF subquery                                 #processCheck", "originalCommit": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0ODAwNg==", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498748006", "bodyText": "I don't see definition for STRINGIDENTIFIER (should be STRING_IDENTIFIER).", "author": "costin", "createdAt": "2020-10-02T10:43:32Z", "path": "x-pack/plugin/eql/src/main/antlr/EqlBase.g4", "diffHunk": "@@ -218,6 +213,15 @@ IDENTIFIER\n     : (LETTER | '_' | '@') (LETTER | DIGIT | '_')*\n     ;\n \n+ESCAPED_IDENTIFIER\n+    : '`' (~'`')* '`'\n+    ;\n+\n+eventValue\n+    : STRINGIDENTIFIER", "originalCommit": "5d4e15d1bf04b7dee0e7e4b6f455906062155d1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwNDUyMQ==", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498804521", "bodyText": "Sorry for those, just a mixup during merge.", "author": "matriv", "createdAt": "2020-10-02T12:58:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODc0ODAwNg=="}], "type": "inlineReview"}, {"oid": "7090a88dc0bdb7e67ad4861950fa8a426894dba8", "url": "https://github.com/elastic/elasticsearch/commit/7090a88dc0bdb7e67ad4861950fa8a426894dba8", "message": "Merge remote-tracking branch 'upstream/master' into fix-62933", "committedDate": "2020-10-02T12:12:43Z", "type": "commit"}, {"oid": "358bfa4aa65361dd373af4440234e379a8eca217", "url": "https://github.com/elastic/elasticsearch/commit/358bfa4aa65361dd373af4440234e379a8eca217", "message": "add tests", "committedDate": "2020-10-02T12:56:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwNjg2OQ==", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498806869", "bodyText": "does it make sense to use quoted identifier instead or in addition to this?", "author": "rw-access", "createdAt": "2020-10-02T13:02:46Z", "path": "x-pack/plugin/eql/src/main/antlr/EqlBase.g4", "diffHunk": "@@ -221,6 +220,15 @@ IDENTIFIER\n     : (LETTER | '_' | '@') (LETTER | DIGIT | '_')*\n     ;\n \n+QUOTED_IDENTIFIER\n+    : '`' ( ~'`' | '``' )* '`'\n+    ;\n+\n+eventValue\n+    : STRING", "originalCommit": "358bfa4aa65361dd373af4440234e379a8eca217", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwNzg5MQ==", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498807891", "bodyText": "I don't think so, it'a a string value so it should have the semantics of a string literal in case we encounter any non-letter/digit/_ chars there.", "author": "matriv", "createdAt": "2020-10-02T13:04:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgwNjg2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODgzNjUzNg==", "url": "https://github.com/elastic/elasticsearch/pull/63169#discussion_r498836536", "bodyText": "Could you please add one with space with dots as well just to consistent?\nOtherwise LGTM", "author": "costin", "createdAt": "2020-10-02T13:54:35Z", "path": "x-pack/plugin/eql/src/test/resources/queries-supported.eql", "diffHunk": "@@ -687,3 +687,17 @@ process where fake_field != \"*\"\n \n process where not (fake_field : \"*\")\n | head 4;\n+\n+\n+// eventType values\n+\"123\" where process_name == \"svchost.exe\";\n+\n+\"!#$%^&!#$\\\"123*&^%$()\" where process_name == \"svchost.exe\";\n+\n+\"\"\"\"\"!#$%^&!\"\"#$\\\"123*\"\"&^%$()\"\"\"\"\" where process_name == \"svchost.exe\";\n+\n+sequence\n+  [\"!#$134\" where serial_event_id<3] by unique_pid1\n+  [\"\"\"!#@$%12345)(*&%^%#$@\"\"\" where true] by unique_ppid2\n+| tail 1\n+;", "originalCommit": "358bfa4aa65361dd373af4440234e379a8eca217", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ebaec14a526aedb18a8ae1c3db1d75567dbd7cc0", "url": "https://github.com/elastic/elasticsearch/commit/ebaec14a526aedb18a8ae1c3db1d75567dbd7cc0", "message": "add more tests", "committedDate": "2020-10-02T14:01:05Z", "type": "commit"}]}