{"pr_number": 64732, "pr_title": "Remove deprecated _upgrade API", "pr_createdAt": "2020-11-06T16:47:40Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/64732", "timeline": [{"oid": "91b480cfb67989d15a30eb6acf2165965de0cff0", "url": "https://github.com/elastic/elasticsearch/commit/91b480cfb67989d15a30eb6acf2165965de0cff0", "message": "remote deprecated _upgrade API", "committedDate": "2020-11-06T16:41:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NTg3OQ==", "url": "https://github.com/elastic/elasticsearch/pull/64732#discussion_r518875879", "bodyText": "Replaced with a different index action so tasks are still tested", "author": "danhermann", "createdAt": "2020-11-06T16:49:40Z", "path": "server/src/internalClusterTest/java/org/elasticsearch/action/admin/cluster/node/tasks/TasksIT.java", "diffHunk": "@@ -181,19 +181,19 @@ public void testTransportReplicationAllShardsTasks() {\n     }\n \n     public void testTransportBroadcastByNodeTasks() {\n-        registerTaskManagerListeners(UpgradeAction.NAME);  // main task\n-        registerTaskManagerListeners(UpgradeAction.NAME + \"[n]\"); // node level tasks\n+        registerTaskManagerListeners(ForceMergeAction.NAME);  // main task\n+        registerTaskManagerListeners(ForceMergeAction.NAME + \"[n]\"); // node level tasks", "originalCommit": "91b480cfb67989d15a30eb6acf2165965de0cff0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NjQ0OA==", "url": "https://github.com/elastic/elasticsearch/pull/64732#discussion_r518876448", "bodyText": "Did not appear to be called outside of the _upgrade API.", "author": "danhermann", "createdAt": "2020-11-06T16:50:34Z", "path": "server/src/main/java/org/elasticsearch/cluster/metadata/MetadataUpdateSettingsService.java", "diffHunk": "@@ -316,36 +312,4 @@ private static boolean maybeUpdateClusterBlock(String[] actualIndices, ClusterBl\n         }\n         return changed;\n     }\n-\n-\n-    public void upgradeIndexSettings(final UpgradeSettingsClusterStateUpdateRequest request,\n-                                     final ActionListener<AcknowledgedResponse> listener) {", "originalCommit": "91b480cfb67989d15a30eb6acf2165965de0cff0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODg3NjY0MA==", "url": "https://github.com/elastic/elasticsearch/pull/64732#discussion_r518876640", "bodyText": "Did not appear to be called outside of the _upgrade API.", "author": "danhermann", "createdAt": "2020-11-06T16:50:55Z", "path": "server/src/main/java/org/elasticsearch/index/shard/IndexShard.java", "diffHunk": "@@ -1099,28 +1098,6 @@ public void forceMerge(ForceMergeRequest forceMerge) throws IOException {\n             forceMerge.onlyExpungeDeletes(), false, false, forceMerge.forceMergeUUID());\n     }\n \n-    /**\n-     * Upgrades the shard to the current version of Lucene and returns the minimum segment version\n-     */\n-    public org.apache.lucene.util.Version upgrade(UpgradeRequest upgrade) throws IOException {", "originalCommit": "91b480cfb67989d15a30eb6acf2165965de0cff0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "95196e5360bd8451d9cde5c72f78579ed7bc92dc", "url": "https://github.com/elastic/elasticsearch/commit/95196e5360bd8451d9cde5c72f78579ed7bc92dc", "message": "add to breaking changes doc", "committedDate": "2020-11-06T17:14:19Z", "type": "commit"}, {"oid": "cb3ce4bb2ff44ace8567ed248d1e72679aa337ad", "url": "https://github.com/elastic/elasticsearch/commit/cb3ce4bb2ff44ace8567ed248d1e72679aa337ad", "message": "remove references from REST client tests", "committedDate": "2020-11-06T17:15:35Z", "type": "commit"}, {"oid": "e658bcdf183f7787d200c74b798c7bc5d248b757", "url": "https://github.com/elastic/elasticsearch/commit/e658bcdf183f7787d200c74b798c7bc5d248b757", "message": "remove ref from index privilege tests", "committedDate": "2020-11-06T17:55:39Z", "type": "commit"}]}