{"pr_number": 53294, "pr_title": "[ML][Inference] adds new default_field_map field to trained models", "pr_createdAt": "2020-03-09T16:46:42Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/53294", "timeline": [{"oid": "6edfe4bcbd69c96463d99cd8307434a7ddfb9212", "url": "https://github.com/elastic/elasticsearch/commit/6edfe4bcbd69c96463d99cd8307434a7ddfb9212", "message": "[ML][Inference] adds new default_field_mappings config field to trained models", "committedDate": "2020-03-09T16:47:11Z", "type": "commit"}, {"oid": "6edfe4bcbd69c96463d99cd8307434a7ddfb9212", "url": "https://github.com/elastic/elasticsearch/commit/6edfe4bcbd69c96463d99cd8307434a7ddfb9212", "message": "[ML][Inference] adds new default_field_mappings config field to trained models", "committedDate": "2020-03-09T16:47:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg3MzIzMQ==", "url": "https://github.com/elastic/elasticsearch/pull/53294#discussion_r389873231", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (defaultFieldMappings != null) {\n          \n          \n            \n                    if (defaultFieldMappings != null && defaultFieldMappings.isEmpty() == false) {\n          \n      \n    \n    \n  \n\nI prefer not to write empty collections.", "author": "davidkyle", "createdAt": "2020-03-09T18:15:08Z", "path": "client/rest-high-level/src/main/java/org/elasticsearch/client/ml/inference/TrainedModelConfig.java", "diffHunk": "@@ -226,6 +235,9 @@ public XContentBuilder toXContent(XContentBuilder builder, Params params) throws\n         if (licenseLevel != null) {\n             builder.field(LICENSE_LEVEL.getPreferredName(), licenseLevel);\n         }\n+        if (defaultFieldMappings != null) {", "originalCommit": "6edfe4bcbd69c96463d99cd8307434a7ddfb9212", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg3OTAzOA==", "url": "https://github.com/elastic/elasticsearch/pull/53294#discussion_r389879038", "bodyText": "\ud83d\udc4d neat I never thought of building a random map this way", "author": "davidkyle", "createdAt": "2020-03-09T18:25:53Z", "path": "client/rest-high-level/src/test/java/org/elasticsearch/client/ml/inference/TrainedModelConfigTests.java", "diffHunk": "@@ -52,7 +53,11 @@ public static TrainedModelConfig createTestTrainedModelConfig() {\n             randomBoolean() ? null : TrainedModelInputTests.createRandomInput(),\n             randomBoolean() ? null : randomNonNegativeLong(),\n             randomBoolean() ? null : randomNonNegativeLong(),\n-            randomBoolean() ? null : randomFrom(\"platinum\", \"basic\"));\n+            randomBoolean() ? null : randomFrom(\"platinum\", \"basic\"),\n+            randomBoolean() ? null :\n+                Stream.generate(() -> randomAlphaOfLength(10))\n+                    .limit(randomIntBetween(1, 10))\n+                    .collect(Collectors.toMap(Function.identity(), (k) -> randomAlphaOfLength(10))));", "originalCommit": "6edfe4bcbd69c96463d99cd8307434a7ddfb9212", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg5MTI0NQ==", "url": "https://github.com/elastic/elasticsearch/pull/53294#discussion_r389891245", "bodyText": "Should we add a line here about multi fields which is the primary reason for this change?", "author": "davidkyle", "createdAt": "2020-03-09T18:48:10Z", "path": "docs/reference/ml/ml-shared.asciidoc", "diffHunk": "@@ -1506,6 +1506,13 @@ The estimated number of operations to use the trained model.\n `license_level`:::\n (string)\n The license level of the trained model.\n+\n+`default_field_mappings` :::\n+(object)\n+A string to string mapping that contains the default field mappings to use\n+when inferring against the model. Any field mapping described in the", "originalCommit": "6edfe4bcbd69c96463d99cd8307434a7ddfb9212", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg5Nzg1Nw==", "url": "https://github.com/elastic/elasticsearch/pull/53294#discussion_r389897857", "bodyText": "For sure!", "author": "benwtrent", "createdAt": "2020-03-09T19:00:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg5MTI0NQ=="}], "type": "inlineReview"}, {"oid": "96656afa0998e3bd16ba81cd078ce9fce9dfdeef", "url": "https://github.com/elastic/elasticsearch/commit/96656afa0998e3bd16ba81cd078ce9fce9dfdeef", "message": "renaming, addressing PR comments", "committedDate": "2020-03-10T11:50:49Z", "type": "commit"}, {"oid": "56ccc5cc4bdaf6e10427fbac26e29529976ba870", "url": "https://github.com/elastic/elasticsearch/commit/56ccc5cc4bdaf6e10427fbac26e29529976ba870", "message": "Merge branch 'master' into feature/ml-inference-fix-field-type-mapping-confusion", "committedDate": "2020-03-11T15:18:48Z", "type": "commit"}]}