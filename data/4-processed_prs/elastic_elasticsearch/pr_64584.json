{"pr_number": 64584, "pr_title": "Replace more MapperService usages in favour of QueryShardContext", "pr_createdAt": "2020-11-04T12:05:36Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/64584", "timeline": [{"oid": "58e047f0cb0d43c6a56a361aeecb21b3de2bb505", "url": "https://github.com/elastic/elasticsearch/commit/58e047f0cb0d43c6a56a361aeecb21b3de2bb505", "message": "Replace more MapperService usages in favour of QueryShardContext\n\nThis commit replaces most of the leftover direct access to MapperService from SearchContext and FetchContext with accessing QueryShardContext instead, which wraps the MapperService and exposes a subset of its functionality needed when executing the different phases of search", "committedDate": "2020-11-04T11:53:49Z", "type": "commit"}, {"oid": "a95ec701a6d4313c35ff562ea21284329c9faf1a", "url": "https://github.com/elastic/elasticsearch/commit/a95ec701a6d4313c35ff562ea21284329c9faf1a", "message": "remove methods from SearchContext", "committedDate": "2020-11-04T12:03:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI5OTYxMw==", "url": "https://github.com/elastic/elasticsearch/pull/64584#discussion_r517299613", "bodyText": "Can we remove FetchContext#mapperService() as well?", "author": "romseygeek", "createdAt": "2020-11-04T12:11:32Z", "path": "server/src/main/java/org/elasticsearch/search/fetch/FetchContext.java", "diffHunk": "@@ -77,13 +76,6 @@ public MapperService mapperService() {\n         return searchContext.mapperService();\n     }", "originalCommit": "a95ec701a6d4313c35ff562ea21284329c9faf1a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMzMTc3MQ==", "url": "https://github.com/elastic/elasticsearch/pull/64584#discussion_r517331771", "bodyText": "not yet, there is some leftover usage around indexAnalyzer that I did not address. Do you have suggestions on how to get rid of that?", "author": "javanna", "createdAt": "2020-11-04T13:11:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI5OTYxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMzNjI3Ng==", "url": "https://github.com/elastic/elasticsearch/pull/64584#discussion_r517336276", "bodyText": "QueryShardContext has a getIndexAnalyzer() method, you could use that instead I think?", "author": "romseygeek", "createdAt": "2020-11-04T13:19:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI5OTYxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzMzODU1OA==", "url": "https://github.com/elastic/elasticsearch/pull/64584#discussion_r517338558", "bodyText": "yes you are right, it's an easy one to remove, will do that", "author": "javanna", "createdAt": "2020-11-04T13:23:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI5OTYxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzg2NDI4Nw==", "url": "https://github.com/elastic/elasticsearch/pull/64584#discussion_r517864287", "bodyText": "it appears that I forgot to push that one commit to this PR, I opened #64620", "author": "javanna", "createdAt": "2020-11-05T08:20:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI5OTYxMw=="}], "type": "inlineReview"}, {"oid": "413d87174e754dc948255da65abba497ed0f4fbe", "url": "https://github.com/elastic/elasticsearch/commit/413d87174e754dc948255da65abba497ed0f4fbe", "message": "remove keyword mapper ignore above method", "committedDate": "2020-11-04T13:13:49Z", "type": "commit"}]}