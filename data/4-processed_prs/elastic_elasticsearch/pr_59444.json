{"pr_number": 59444, "pr_title": "Convert most OSS plugins from integTest to [yaml | java]RestTest or internalClusterTest", "pr_createdAt": "2020-07-13T17:13:57Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/59444", "timeline": [{"oid": "376db4221908bfb29d5d87d2a6e15a7a0f889ca5", "url": "https://github.com/elastic/elasticsearch/commit/376db4221908bfb29d5d87d2a6e15a7a0f889ca5", "message": "start of migration", "committedDate": "2020-07-11T21:15:27Z", "type": "commit"}, {"oid": "1e56bb3f943612b86956095adbc0370cbd8335a9", "url": "https://github.com/elastic/elasticsearch/commit/1e56bb3f943612b86956095adbc0370cbd8335a9", "message": "fix annoyning bug", "committedDate": "2020-07-11T22:02:58Z", "type": "commit"}, {"oid": "424fd5efd1420c1f88659f047b8999ebed6122c6", "url": "https://github.com/elastic/elasticsearch/commit/424fd5efd1420c1f88659f047b8999ebed6122c6", "message": "more conversion, ignore repository and store for now", "committedDate": "2020-07-13T17:01:15Z", "type": "commit"}, {"oid": "5fd84d2cadc6ebcb4487b2960c5152fe9cd021ed", "url": "https://github.com/elastic/elasticsearch/commit/5fd84d2cadc6ebcb4487b2960c5152fe9cd021ed", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_plugins", "committedDate": "2020-07-13T17:01:40Z", "type": "commit"}, {"oid": "aa96ed806df8d4eb6341580da8b700d8923d2838", "url": "https://github.com/elastic/elasticsearch/commit/aa96ed806df8d4eb6341580da8b700d8923d2838", "message": "remove temporary code", "committedDate": "2020-07-13T17:08:30Z", "type": "commit"}, {"oid": "dfebc85902546bcc643cffb3979ac4541e14c2ed", "url": "https://github.com/elastic/elasticsearch/commit/dfebc85902546bcc643cffb3979ac4541e14c2ed", "message": "remove unecessary todo", "committedDate": "2020-07-13T17:11:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzgwMzYwNA==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r453803604", "bodyText": "this is needed since the yamlRestRest does not have access to that class", "author": "jakelandis", "createdAt": "2020-07-13T17:14:39Z", "path": "plugins/analysis-icu/build.gradle", "diffHunk": "@@ -18,17 +18,19 @@ import de.thetaphi.forbiddenapis.gradle.CheckForbiddenApis\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-apply plugin: 'elasticsearch.rest-resources'\n+apply plugin: 'elasticsearch.yaml-rest-test'\n \n esplugin {\n   description 'The ICU Analysis plugin integrates the Lucene ICU module into Elasticsearch, adding ICU-related analysis components.'\n   classname 'org.elasticsearch.plugin.analysis.icu.AnalysisICUPlugin'\n }\n \n-tasks.withType(CheckForbiddenApis).configureEach {\n-  signatures += [\n-    \"com.ibm.icu.text.Collator#getInstance() @ Don't use default locale, use getInstance(ULocale) instead\"\n-  ]\n+tasks.withType(CheckForbiddenApis).configureEach { task ->\n+  if(task.name.contains(\"YamlRestTest\") == false) {", "originalCommit": "dfebc85902546bcc643cffb3979ac4541e14c2ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTEwMA==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454475100", "bodyText": "Maybe this should be explicit, applying the signature to forbiddanApisMain and forbiddenApisTest, rather than all CheckForbiddenApis tasks? We are likely to continue adding more source sets in the future, so having configuration apply to all source sets would be problematic.", "author": "rjernst", "createdAt": "2020-07-14T16:14:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzgwMzYwNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ0MTM2Nw==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r458441367", "bodyText": "\ud83d\udc4d done 5c75412 (#59444) for the main source set (probably not the extra config noise for the test and internalTestCluster source sets)", "author": "jakelandis", "createdAt": "2020-07-21T23:12:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzgwMzYwNA=="}], "type": "inlineReview"}, {"oid": "2be2c71a68c4ceacdd2be5c90c95da5700f05963", "url": "https://github.com/elastic/elasticsearch/commit/2be2c71a68c4ceacdd2be5c90c95da5700f05963", "message": "remove unecessary todo", "committedDate": "2020-07-13T17:15:38Z", "type": "commit"}, {"oid": "c603b8024dd8a41bdb393adf730ed534030a546d", "url": "https://github.com/elastic/elasticsearch/commit/c603b8024dd8a41bdb393adf730ed534030a546d", "message": "remove rouge plugin defintion", "committedDate": "2020-07-13T17:57:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTM2MA==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454475360", "bodyText": "Why is this being disabled?", "author": "rjernst", "createdAt": "2020-07-14T16:14:46Z", "path": "plugins/analysis-kuromoji/build.gradle", "diffHunk": "@@ -33,6 +33,8 @@ restResources {\n   }\n }\n \n+integTest.enabled = false", "originalCommit": "dfebc85902546bcc643cffb3979ac4541e14c2ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ4MDIxOA==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454480218", "bodyText": "We need a plan for ripping the creation of the integTest task out from the PluginBuildPlugin. Otherwise this is going to be necessary for any plugin project that uses only yaml tests. Or tweak our test conventions logic so it doesn't complain about this scenario.", "author": "mark-vieira", "createdAt": "2020-07-14T16:21:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTM2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDYzMzgyMw==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454633823", "bodyText": "I found a need to implement a javaRestTest as part of converting these plugins, so (without hacks) can't finish my conversion to yamlRestTest .. Between javaRestTest, yamlRestTest, and internalClusterTest there is no need for integTest to exist anymore.  I plan to rip out integTest once all of these are implemented.  It won't take long (but my attention is split among a few things at the moment).", "author": "jakelandis", "createdAt": "2020-07-14T20:45:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTM2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTg0NQ==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454475845", "bodyText": "Ditto. If we need to disable a test, can we have a comment explaining why it is disabled? Someone coming along in the future will have no reason whether this can/should be re-enabled.", "author": "rjernst", "createdAt": "2020-07-14T16:15:28Z", "path": "plugins/analysis-nori/build.gradle", "diffHunk": "@@ -32,6 +32,9 @@ restResources {\n     includeCore '_common', 'indices', 'index', 'search'\n   }\n }\n+\n+integTest.enabled = false", "originalCommit": "dfebc85902546bcc643cffb3979ac4541e14c2ed", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDYzNTIzMA==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r454635230", "bodyText": "This isn't really disabling a test ... it is to avoid the testing conventions from complaining.  I would prefer to tweak the testing conventions instead of a lot of redunant comments. I can do that in a separate PR (and remove these in this PR)", "author": "jakelandis", "createdAt": "2020-07-14T20:47:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ3NTg0NQ=="}], "type": "inlineReview"}, {"oid": "bbc08f93a46cb1a288969190c1becd0bcc0fea24", "url": "https://github.com/elastic/elasticsearch/commit/bbc08f93a46cb1a288969190c1becd0bcc0fea24", "message": "Merge branch 'master' into yamlRestTest_plugins", "committedDate": "2020-07-21T22:38:36Z", "type": "commit"}, {"oid": "a9a34d9fc3b175fef59909e9d7ac4d4da7c1acbf", "url": "https://github.com/elastic/elasticsearch/commit/a9a34d9fc3b175fef59909e9d7ac4d4da7c1acbf", "message": "remove (now) unneccessary integTest.enabled=false", "committedDate": "2020-07-21T22:50:25Z", "type": "commit"}, {"oid": "5c75412f830b1ea938bbfee39b2a20c4bc6f90d8", "url": "https://github.com/elastic/elasticsearch/commit/5c75412f830b1ea938bbfee39b2a20c4bc6f90d8", "message": "fix forbiden API and move test", "committedDate": "2020-07-21T23:10:13Z", "type": "commit"}, {"oid": "2fab21b807cb74ea2a88ded8b61d9fe927400a38", "url": "https://github.com/elastic/elasticsearch/commit/2fab21b807cb74ea2a88ded8b61d9fe927400a38", "message": "more migration", "committedDate": "2020-07-22T15:30:03Z", "type": "commit"}, {"oid": "cc095507ad6171aa18f626939ad1c1002eacd214", "url": "https://github.com/elastic/elasticsearch/commit/cc095507ad6171aa18f626939ad1c1002eacd214", "message": "finish examples", "committedDate": "2020-07-22T16:15:47Z", "type": "commit"}, {"oid": "cd76cf49743da978d4576ef858e164cd14779c01", "url": "https://github.com/elastic/elasticsearch/commit/cd76cf49743da978d4576ef858e164cd14779c01", "message": "more", "committedDate": "2020-07-22T16:28:18Z", "type": "commit"}, {"oid": "4a2d639bec119eafec0a8fe83d72191d372e1f99", "url": "https://github.com/elastic/elasticsearch/commit/4a2d639bec119eafec0a8fe83d72191d372e1f99", "message": "repository-azure", "committedDate": "2020-07-22T16:44:13Z", "type": "commit"}, {"oid": "8682017cb5b923327864e53fe781bd7024b4e870", "url": "https://github.com/elastic/elasticsearch/commit/8682017cb5b923327864e53fe781bd7024b4e870", "message": "repository-gcs", "committedDate": "2020-07-22T17:09:39Z", "type": "commit"}, {"oid": "4a1d8c865159caafb08e44721f3a9682d2fda477", "url": "https://github.com/elastic/elasticsearch/commit/4a1d8c865159caafb08e44721f3a9682d2fda477", "message": "repository-s3", "committedDate": "2020-07-22T18:37:09Z", "type": "commit"}, {"oid": "9414e3dfe7933c4c34716f8cb55f3de68382fd88", "url": "https://github.com/elastic/elasticsearch/commit/9414e3dfe7933c4c34716f8cb55f3de68382fd88", "message": "store-smb", "committedDate": "2020-07-22T18:41:44Z", "type": "commit"}, {"oid": "f2cf390cbe195d078bcd42cfdfa528e2c81f6c50", "url": "https://github.com/elastic/elasticsearch/commit/f2cf390cbe195d078bcd42cfdfa528e2c81f6c50", "message": "transport-nio", "committedDate": "2020-07-22T18:48:53Z", "type": "commit"}, {"oid": "21cc84a4ecb827d78b8979fbf3bf0bc6a7359222", "url": "https://github.com/elastic/elasticsearch/commit/21cc84a4ecb827d78b8979fbf3bf0bc6a7359222", "message": "Revert \"repository-s3\"\n\nThis reverts commit 4a1d8c865159caafb08e44721f3a9682d2fda477.", "committedDate": "2020-07-22T18:59:50Z", "type": "commit"}, {"oid": "ebb6703ccd642ab7505bb86a822b4995fa705a11", "url": "https://github.com/elastic/elasticsearch/commit/ebb6703ccd642ab7505bb86a822b4995fa705a11", "message": "Revert \"repository-gcs\"\n\nThis reverts commit 8682017cb5b923327864e53fe781bd7024b4e870.", "committedDate": "2020-07-22T19:00:02Z", "type": "commit"}, {"oid": "6147473b2d1993acc4a8b13f2b78f9f307b949e4", "url": "https://github.com/elastic/elasticsearch/commit/6147473b2d1993acc4a8b13f2b78f9f307b949e4", "message": "Revert \"repository-azure\"\n\nThis reverts commit 4a2d639bec119eafec0a8fe83d72191d372e1f99.", "committedDate": "2020-07-22T19:00:11Z", "type": "commit"}, {"oid": "05e9421bb846e44c7ff229e329f3946fe8b04615", "url": "https://github.com/elastic/elasticsearch/commit/05e9421bb846e44c7ff229e329f3946fe8b04615", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_plugins", "committedDate": "2020-07-22T19:00:29Z", "type": "commit"}, {"oid": "885c84adb08116efbcbff1b3fc4b619f7887583b", "url": "https://github.com/elastic/elasticsearch/commit/885c84adb08116efbcbff1b3fc4b619f7887583b", "message": "minor", "committedDate": "2020-07-22T19:14:59Z", "type": "commit"}, {"oid": "4ea875a6179de15305825d38e53a20218b6158eb", "url": "https://github.com/elastic/elasticsearch/commit/4ea875a6179de15305825d38e53a20218b6158eb", "message": "manually rollback discovery-* changes", "committedDate": "2020-07-22T19:24:49Z", "type": "commit"}, {"oid": "ea705a55a10d685ec52f7d2675ff2e4a070d45f4", "url": "https://github.com/elastic/elasticsearch/commit/ea705a55a10d685ec52f7d2675ff2e4a070d45f4", "message": "white space change", "committedDate": "2020-07-22T19:28:20Z", "type": "commit"}, {"oid": "c89b5de16f777a00a7be76280565debd6014728f", "url": "https://github.com/elastic/elasticsearch/commit/c89b5de16f777a00a7be76280565debd6014728f", "message": "more nits", "committedDate": "2020-07-22T19:30:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMjU0Mg==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459102542", "bodyText": "What's the purpose of this of this intermediary variable?", "author": "mark-vieira", "createdAt": "2020-07-22T21:46:28Z", "path": "plugins/analysis-icu/build.gradle", "diffHunk": "@@ -18,17 +18,20 @@ import de.thetaphi.forbiddenapis.gradle.CheckForbiddenApis\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-apply plugin: 'elasticsearch.rest-resources'\n+apply plugin: 'elasticsearch.yaml-rest-test'\n+apply plugin: 'elasticsearch.internal-cluster-test'\n \n esplugin {\n   description 'The ICU Analysis plugin integrates the Lucene ICU module into Elasticsearch, adding ICU-related analysis components.'\n   classname 'org.elasticsearch.plugin.analysis.icu.AnalysisICUPlugin'\n }\n \n-tasks.withType(CheckForbiddenApis).configureEach {\n-  signatures += [\n-    \"com.ibm.icu.text.Collator#getInstance() @ Don't use default locale, use getInstance(ULocale) instead\"\n-  ]\n+List<String> forbidden_signatures = new ArrayList<>([", "originalCommit": "c89b5de16f777a00a7be76280565debd6014728f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExMjYxOA==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459112618", "bodyText": "it made sense when i was configuring multiple forbidden[name] ... but now not so much...will fix.", "author": "jakelandis", "createdAt": "2020-07-22T22:11:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMjU0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTY3NTg5Ng==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459675896", "bodyText": "done 849d19d", "author": "jakelandis", "createdAt": "2020-07-23T19:23:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMjU0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMjk1Ng==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459102956", "bodyText": "Is there a reason this needs to be all and not just yamlRestTest? Isn't there just one test cluster in play here?", "author": "mark-vieira", "createdAt": "2020-07-22T21:47:23Z", "path": "plugins/examples/custom-settings/build.gradle", "diffHunk": "@@ -28,7 +27,8 @@ esplugin {\n   noticeFile rootProject.file('NOTICE.txt')\n }\n \n-testClusters.integTest {\n+testClusters.all {", "originalCommit": "c89b5de16f777a00a7be76280565debd6014728f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExMjA2NQ==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459112065", "bodyText": "I figured the best example would be to use all , I think that should be the go-to configuration unless you need task specific config. (given the ease and cache behavior). Not a strong opinion however.", "author": "jakelandis", "createdAt": "2020-07-22T22:09:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMjk1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMzI2MQ==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459103261", "bodyText": "Should be dependsOn sourceSets.javaRestTest.runtimeClasspath.", "author": "mark-vieira", "createdAt": "2020-07-22T21:48:02Z", "path": "plugins/examples/rest-handler/build.gradle", "diffHunk": "@@ -34,21 +34,16 @@ esplugin {\n test.enabled = false\n \n tasks.register(\"exampleFixture\", org.elasticsearch.gradle.test.AntFixture) {\n-  dependsOn testClasses\n-  env 'CLASSPATH', \"${-> project.sourceSets.test.runtimeClasspath.asPath}\"\n+  dependsOn javaRestTestClasses", "originalCommit": "c89b5de16f777a00a7be76280565debd6014728f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTY3NTgwOA==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459675808", "bodyText": "done 849d19d", "author": "jakelandis", "createdAt": "2020-07-23T19:23:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwMzI2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNDM2Ng==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459104366", "bodyText": "Why is this necessary here but not done by default in the java rest test plugin?\nSince this is an example project we should use idiomatic patterns as much as possible. If this is required because of some kind of nasty test implementation we should refactor this.\n@rjernst thoughts? As I understand it a Java REST test should be no different than a YAML one in that the only interactions should be via the REST API, therefore there should be no need for plugin code itself to be on the test classpath.", "author": "mark-vieira", "createdAt": "2020-07-22T21:50:27Z", "path": "plugins/examples/security-authorization-engine/build.gradle", "diffHunk": "@@ -11,19 +12,24 @@ esplugin {\n   noticeFile rootProject.file('NOTICE.txt')\n }\n \n+// let the javaRestTest see the classpath of main\n+GradleUtils.extendSourceSet(project, \"main\", \"javaRestTest\")", "originalCommit": "c89b5de16f777a00a7be76280565debd6014728f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExNTk4NQ==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459115985", "bodyText": "The examples are not exactly idomatic to start with, they could use some updating. In this case the test really does need to see the main classes, which should probably be converted to a ESSingleNodeTestCase or the tests written as pure black box ?  I can log an issue, but probably outside the scope of this change.", "author": "jakelandis", "createdAt": "2020-07-22T22:19:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNDM2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyMTc1Ng==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459121756", "bodyText": "Yeah, I don't like the idea of GradleUtils being used in a plugin example. That's not intended to be \"public\". Worst case if the tests are structure such that they strictly need those classes, we should just extend the source set in the build script explicilty rather than leverage this utility method.", "author": "mark-vieira", "createdAt": "2020-07-22T22:34:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNDM2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTY3NTQ2OQ==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459675469", "bodyText": "For this case I am able to simply add the dependency to the main runtimeClasspath. ef34668\njavaRestTestImplementation project.sourceSets.main.runtimeClasspath", "author": "jakelandis", "createdAt": "2020-07-23T19:22:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNDM2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNDcyNg==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459104726", "bodyText": "I thought we ditched the need for this?", "author": "mark-vieira", "createdAt": "2020-07-22T21:51:12Z", "path": "plugins/transport-nio/build.gradle", "diffHunk": "@@ -19,12 +19,15 @@ import org.elasticsearch.gradle.info.BuildParams\n  * under the License.\n  */\n apply plugin: \"elasticsearch.publish\"\n+apply plugin: 'elasticsearch.internal-cluster-test'\n \n esplugin {\n   description 'The nio transport.'\n   classname 'org.elasticsearch.transport.nio.NioTransportPlugin'\n }\n \n+// integTest have been converted to internalClusterTest \n+integTest.enabled = false", "originalCommit": "c89b5de16f777a00a7be76280565debd6014728f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExMzU3NA==", "url": "https://github.com/elastic/elasticsearch/pull/59444#discussion_r459113574", "bodyText": "This one is special such neither javaRestTest or yamlRestTest is applied here (only internalClusterTest). The auto-disable only works from the java/yamlRestTest application since there are some other projects with existing internalClusterTest and don't want to auto disable integTest for those. These should be pretty rare, and can be deleted once integTest is gone.", "author": "jakelandis", "createdAt": "2020-07-22T22:13:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNDcyNg=="}], "type": "inlineReview"}, {"oid": "849d19db73f47c21baaa3cb591d28521bd9e6294", "url": "https://github.com/elastic/elasticsearch/commit/849d19db73f47c21baaa3cb591d28521bd9e6294", "message": "runtimeClasspath and unecessary variable", "committedDate": "2020-07-23T19:02:29Z", "type": "commit"}, {"oid": "ef3466837535242c2d0c4be28241bde6ff2af951", "url": "https://github.com/elastic/elasticsearch/commit/ef3466837535242c2d0c4be28241bde6ff2af951", "message": "remove GradleUtils from build script", "committedDate": "2020-07-23T19:21:27Z", "type": "commit"}, {"oid": "7b07432091ce83d196016d0c21a30b60cc67e925", "url": "https://github.com/elastic/elasticsearch/commit/7b07432091ce83d196016d0c21a30b60cc67e925", "message": "Merge branch 'master' into yamlRestTest_plugins", "committedDate": "2020-07-27T18:07:54Z", "type": "commit"}, {"oid": "8058400bbf69503f53d9c7292ac740dd6c54e55f", "url": "https://github.com/elastic/elasticsearch/commit/8058400bbf69503f53d9c7292ac740dd6c54e55f", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_plugins", "committedDate": "2020-07-27T21:52:24Z", "type": "commit"}, {"oid": "1832e797a2f0f13f2db652d0ca9cc9a3681a1135", "url": "https://github.com/elastic/elasticsearch/commit/1832e797a2f0f13f2db652d0ca9cc9a3681a1135", "message": "Merge remote-tracking branch 'upstream/master' into yamlRestTest_plugins", "committedDate": "2020-07-28T20:45:49Z", "type": "commit"}]}