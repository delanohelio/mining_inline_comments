{"pr_number": 57806, "pr_title": "[DOCS] Extends geo_shape query docs to explain behavior when data is indexed as array of shapes", "pr_createdAt": "2020-06-08T11:24:57Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/57806", "timeline": [{"oid": "b98ec97e93845560fabd9577250f1b2bd367bd5b", "url": "https://github.com/elastic/elasticsearch/commit/b98ec97e93845560fabd9577250f1b2bd367bd5b", "message": "[DOCS] Extends geo_shape query docs to explain behavior when data is indexed as array of shapes.", "committedDate": "2020-06-08T11:22:55Z", "type": "commit"}, {"oid": "02dcc64e9b5ed9b6b691fb19e42e77ee998dde7c", "url": "https://github.com/elastic/elasticsearch/commit/02dcc64e9b5ed9b6b691fb19e42e77ee998dde7c", "message": "[DOCS] Fixes JSON syntax.", "committedDate": "2020-06-08T11:59:12Z", "type": "commit"}, {"oid": "7f4612b279d055e11341395092746828f2bdacf5", "url": "https://github.com/elastic/elasticsearch/commit/7f4612b279d055e11341395092746828f2bdacf5", "message": "[DOC] Changes method.", "committedDate": "2020-06-08T12:24:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2MDQwNQ==", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436660405", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The following query will find the point using the {es}'s `envelope` GeoJSON \n          \n          \n            \n            The following query will find the point using {es}'s `envelope` GeoJSON", "author": "jrodewig", "createdAt": "2020-06-08T12:37:51Z", "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -49,8 +51,9 @@ POST /example/_doc?refresh\n --------------------------------------------------\n // TESTSETUP\n \n-The following query will find the point using the Elasticsearch's\n-`envelope` GeoJSON extension:\n+\n+The following query will find the point using the {es}'s `envelope` GeoJSON ", "originalCommit": "7f4612b279d055e11341395092746828f2bdacf5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2MDgwMw==", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436660803", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            shapes which are useful to your application and you want to reference this using \n          \n          \n            \n            shapes and you want to reference the list using", "author": "jrodewig", "createdAt": "2020-06-08T12:38:33Z", "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -161,19 +167,19 @@ GET /example_points/_search\n --------------------------------------------------\n // TESTRESPONSE[s/\"took\" : 17/\"took\" : $body.took/]\n \n+\n ==== Pre-Indexed Shape\n \n-The Query also supports using a shape which has already been indexed in\n-another index. This is particularly useful for when\n-you have a pre-defined list of shapes which are useful to your\n-application and you want to reference this using a logical name (for\n-example 'New Zealand') rather than having to provide their coordinates\n-each time. In this situation it is only necessary to provide:\n+The query also supports using a shape which has already been indexed in another \n+index. This is particularly useful for when you have a pre-defined list of \n+shapes which are useful to your application and you want to reference this using ", "originalCommit": "7f4612b279d055e11341395092746828f2bdacf5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2MDg3NA==", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436660874", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            a logical name (for example 'New Zealand') rather than having to provide their \n          \n          \n            \n            a logical name (for example 'New Zealand') rather than having to provide", "author": "jrodewig", "createdAt": "2020-06-08T12:38:42Z", "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -161,19 +167,19 @@ GET /example_points/_search\n --------------------------------------------------\n // TESTRESPONSE[s/\"took\" : 17/\"took\" : $body.took/]\n \n+\n ==== Pre-Indexed Shape\n \n-The Query also supports using a shape which has already been indexed in\n-another index. This is particularly useful for when\n-you have a pre-defined list of shapes which are useful to your\n-application and you want to reference this using a logical name (for\n-example 'New Zealand') rather than having to provide their coordinates\n-each time. In this situation it is only necessary to provide:\n+The query also supports using a shape which has already been indexed in another \n+index. This is particularly useful for when you have a pre-defined list of \n+shapes which are useful to your application and you want to reference this using \n+a logical name (for example 'New Zealand') rather than having to provide their ", "originalCommit": "7f4612b279d055e11341395092746828f2bdacf5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f18a543f41299e45023dd1482aa041bb3ac3d7a0", "url": "https://github.com/elastic/elasticsearch/commit/f18a543f41299e45023dd1482aa041bb3ac3d7a0", "message": "Apply suggestions from code review\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-06-08T12:41:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2NTU2Nw==", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436665567", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            PUT /test/doc1\n          \n          \n            \n            PUT /test/_doc/1", "author": "jrodewig", "createdAt": "2020-06-08T12:46:52Z", "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -251,15 +261,55 @@ querying multiple indexes which might have different mappings. When set to\n `false` (the default value) the query will throw an exception if the field\n is not mapped.\n \n+\n ==== Shape Types supported for Geo-Point\n \n-When searching a field of type `geo_point` the following shape types are not supported:\n+When searching a field of type `geo_point` the following shape types are not \n+supported:\n \n * `POINT`\n * `LINE`\n * `MULTIPOINT`\n * `MULTILINE`\n \n ==== Notes\n-Geo-shape queries on geo-shapes implemented with <<prefix-trees, `PrefixTrees`>> will not be executed if\n-<<query-dsl-allow-expensive-queries, `search.allow_expensive_queries`>> is set to false.\n+\n+* Geo-shape queries on geo-shapes implemented with \n+  <<prefix-trees, `PrefixTrees`>> will not be executed if \n+  <<query-dsl-allow-expensive-queries, `search.allow_expensive_queries`>> is set \n+  to false.\n+\n+\n+* When data is indexed in a `geo_shape` field as an array of shapes, the arrays \n+  are treated as one shape. For this reason, the following requests are \n+  equivalent.\n+\n+[source,console]\n+--------------------------------------------------\n+PUT /test/doc1\n+{\n+  \"location\": [\n+    {\n+      \"coordinates\": [46.25,20.14],\n+      \"type\": \"point\"\n+    },\n+    {\n+      \"coordinates\": [47.49,19.04],\n+      \"type\": \"point\"\n+    }\n+  ]\n+}\n+--------------------------------------------------\n+\n+\n+[source,console]\n+--------------------------------------------------\n+PUT /test/doc1", "originalCommit": "f18a543f41299e45023dd1482aa041bb3ac3d7a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjY2NTU5Mw==", "url": "https://github.com/elastic/elasticsearch/pull/57806#discussion_r436665593", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            PUT /test/doc1\n          \n          \n            \n            PUT /test/_doc/1", "author": "jrodewig", "createdAt": "2020-06-08T12:46:56Z", "path": "docs/reference/query-dsl/geo-shape-query.asciidoc", "diffHunk": "@@ -251,15 +261,55 @@ querying multiple indexes which might have different mappings. When set to\n `false` (the default value) the query will throw an exception if the field\n is not mapped.\n \n+\n ==== Shape Types supported for Geo-Point\n \n-When searching a field of type `geo_point` the following shape types are not supported:\n+When searching a field of type `geo_point` the following shape types are not \n+supported:\n \n * `POINT`\n * `LINE`\n * `MULTIPOINT`\n * `MULTILINE`\n \n ==== Notes\n-Geo-shape queries on geo-shapes implemented with <<prefix-trees, `PrefixTrees`>> will not be executed if\n-<<query-dsl-allow-expensive-queries, `search.allow_expensive_queries`>> is set to false.\n+\n+* Geo-shape queries on geo-shapes implemented with \n+  <<prefix-trees, `PrefixTrees`>> will not be executed if \n+  <<query-dsl-allow-expensive-queries, `search.allow_expensive_queries`>> is set \n+  to false.\n+\n+\n+* When data is indexed in a `geo_shape` field as an array of shapes, the arrays \n+  are treated as one shape. For this reason, the following requests are \n+  equivalent.\n+\n+[source,console]\n+--------------------------------------------------\n+PUT /test/doc1", "originalCommit": "f18a543f41299e45023dd1482aa041bb3ac3d7a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "251b6c0bbbde8aad7e134e2436126928d5f222a8", "url": "https://github.com/elastic/elasticsearch/commit/251b6c0bbbde8aad7e134e2436126928d5f222a8", "message": "Update docs/reference/query-dsl/geo-shape-query.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-06-08T12:49:17Z", "type": "commit"}, {"oid": "a9905e11fb9c86c3b0e47bf10bc5ec8bad6eea76", "url": "https://github.com/elastic/elasticsearch/commit/a9905e11fb9c86c3b0e47bf10bc5ec8bad6eea76", "message": "Update docs/reference/query-dsl/geo-shape-query.asciidoc\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-06-08T12:49:25Z", "type": "commit"}]}