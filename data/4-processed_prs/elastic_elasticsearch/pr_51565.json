{"pr_number": 51565, "pr_title": "Re-enable plugin and upgrade bats tests", "pr_createdAt": "2020-01-28T20:35:47Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/51565", "timeline": [{"oid": "30a0f8ff887df90c9b81e13cf03f87adb5fcc4a9", "url": "https://github.com/elastic/elasticsearch/commit/30a0f8ff887df90c9b81e13cf03f87adb5fcc4a9", "message": "Re-enable plugin and upgrade bats tests\n\nWhile the tests remained in place, the execution of these tests were\nlost when creating the DistroTestPlugin. This commit restores executing\nthem.", "committedDate": "2020-01-28T20:33:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA0NDM5MA==", "url": "https://github.com/elastic/elasticsearch/pull/51565#discussion_r372044390", "bodyText": "Would simply using tasks.withType(BatsTestTask) work just as well here and be slightly less brittle?", "author": "mark-vieira", "createdAt": "2020-01-28T20:42:23Z", "path": "qa/os/build.gradle", "diffHunk": "@@ -58,7 +58,7 @@ tasks.dependenciesInfo.enabled = false\n tasks.thirdPartyAudit.ignoreMissingClasses()\n \n tasks.register('destructivePackagingTest') {\n-  dependsOn 'destructiveDistroTest' \n+  dependsOn 'destructiveDistroTest', 'destructiveBatsTest.plugins', 'destructiveBatsTest.upgrade'", "originalCommit": "30a0f8ff887df90c9b81e13cf03f87adb5fcc4a9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA0Njg4Mg==", "url": "https://github.com/elastic/elasticsearch/pull/51565#discussion_r372046882", "bodyText": "While it would work here, it would not work in the later example because only the destructive test is of type BatsTestTask. The latter is a GradleDistroTestTask, which is a wrapper to call into the VM. Given only these two cases remain, and their time should be limited, I'm not sure it is worth further trying to generify this.", "author": "rjernst", "createdAt": "2020-01-28T20:47:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA0NDM5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjA0NDYxOQ==", "url": "https://github.com/elastic/elasticsearch/pull/51565#discussion_r372044619", "bodyText": "Same comment as above.", "author": "mark-vieira", "createdAt": "2020-01-28T20:42:47Z", "path": "qa/os/build.gradle", "diffHunk": "@@ -67,7 +67,7 @@ processTestResources {\n \n subprojects { Project platformProject ->\n   tasks.register('packagingTest') {\n-    dependsOn 'distroTest', 'batsTest.oss', 'batsTest.default'\n+    dependsOn 'distroTest', 'batsTest.plugins', 'batsTest.upgrade'", "originalCommit": "30a0f8ff887df90c9b81e13cf03f87adb5fcc4a9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0955417021ea0d4c3101ecb92422a252b5b0dbdb", "url": "https://github.com/elastic/elasticsearch/commit/0955417021ea0d4c3101ecb92422a252b5b0dbdb", "message": "fix line length", "committedDate": "2020-01-28T21:13:35Z", "type": "commit"}, {"oid": "41f22f4f7f0f6e107ce1c5e7644837f1e164c6f4", "url": "https://github.com/elastic/elasticsearch/commit/41f22f4f7f0f6e107ce1c5e7644837f1e164c6f4", "message": "auto format...", "committedDate": "2020-01-28T21:35:37Z", "type": "commit"}, {"oid": "a736446417f117155eda28ca4c0afde819b06786", "url": "https://github.com/elastic/elasticsearch/commit/a736446417f117155eda28ca4c0afde819b06786", "message": "Merge branch 'master' into distro_tests41", "committedDate": "2020-01-30T17:47:46Z", "type": "commit"}, {"oid": "4becd897bd77a5ee0bda617f137750f2dd792794", "url": "https://github.com/elastic/elasticsearch/commit/4becd897bd77a5ee0bda617f137750f2dd792794", "message": "Merge branch 'master' into distro_tests41", "committedDate": "2020-01-30T23:17:55Z", "type": "commit"}, {"oid": "5b6195992a678651e028ca9133c1defdfd93d409", "url": "https://github.com/elastic/elasticsearch/commit/5b6195992a678651e028ca9133c1defdfd93d409", "message": "Merge branch 'master' into distro_tests41", "committedDate": "2020-02-10T19:31:07Z", "type": "commit"}, {"oid": "eddf2abfdfb83405de9db229e802be838c2e16a8", "url": "https://github.com/elastic/elasticsearch/commit/eddf2abfdfb83405de9db229e802be838c2e16a8", "message": "debug code...", "committedDate": "2020-02-12T03:17:08Z", "type": "commit"}, {"oid": "f6f91219416e7dd7b392e76ea28a5a1e8e130b4c", "url": "https://github.com/elastic/elasticsearch/commit/f6f91219416e7dd7b392e76ea28a5a1e8e130b4c", "message": "Close stdout/stderr before replacing with logging stream\n\nWe replace the System.out and System.err objects with redirects to our\nlog file, but never ensure they are closed. This commit closes each\nstream just before replacing it.", "committedDate": "2020-02-12T21:15:00Z", "type": "commit"}, {"oid": "82bb8c228cf1f39147d4afc40461355975652923", "url": "https://github.com/elastic/elasticsearch/commit/82bb8c228cf1f39147d4afc40461355975652923", "message": "try another", "committedDate": "2020-02-12T22:07:38Z", "type": "commit"}, {"oid": "d0092e49a8e11f106229d9e49b32d1bf56f2e0e1", "url": "https://github.com/elastic/elasticsearch/commit/d0092e49a8e11f106229d9e49b32d1bf56f2e0e1", "message": "Merge branch 'master' into distro_tests41", "committedDate": "2020-02-12T23:57:27Z", "type": "commit"}, {"oid": "96de98d39a1a382ccc7ae99353a1a695324b9e20", "url": "https://github.com/elastic/elasticsearch/commit/96de98d39a1a382ccc7ae99353a1a695324b9e20", "message": "cleanup", "committedDate": "2020-02-13T00:16:38Z", "type": "commit"}, {"oid": "47b9b9a101394182235aa9e381566b98880bdc74", "url": "https://github.com/elastic/elasticsearch/commit/47b9b9a101394182235aa9e381566b98880bdc74", "message": "Merge branch 'master' into logging6", "committedDate": "2020-02-13T00:16:56Z", "type": "commit"}, {"oid": "fcf7b994cc5412ec6675ee269ff153c986ad3f3a", "url": "https://github.com/elastic/elasticsearch/commit/fcf7b994cc5412ec6675ee269ff153c986ad3f3a", "message": "Merge branch 'master' into distro_tests41", "committedDate": "2020-02-13T00:17:09Z", "type": "commit"}, {"oid": "7f0a5a3aaa84d61c0918d9c4b83607bdf240ed9b", "url": "https://github.com/elastic/elasticsearch/commit/7f0a5a3aaa84d61c0918d9c4b83607bdf240ed9b", "message": "Merge branch 'logging6' into distro_tests41", "committedDate": "2020-02-13T00:17:13Z", "type": "commit"}, {"oid": "e412d9b00c3273e23cec3dc29fb7ae8577b94676", "url": "https://github.com/elastic/elasticsearch/commit/e412d9b00c3273e23cec3dc29fb7ae8577b94676", "message": "test cleanup", "committedDate": "2020-02-13T01:52:49Z", "type": "commit"}, {"oid": "70210eaf26ee0ddbb283b25b29ffe733557509e2", "url": "https://github.com/elastic/elasticsearch/commit/70210eaf26ee0ddbb283b25b29ffe733557509e2", "message": "can't check asm jar", "committedDate": "2020-02-13T19:13:56Z", "type": "commit"}, {"oid": "10000b79adbc762670955d8d42d6a969841d8e3d", "url": "https://github.com/elastic/elasticsearch/commit/10000b79adbc762670955d8d42d6a969841d8e3d", "message": "Merge branch 'master' into distro_tests41", "committedDate": "2020-02-13T20:56:05Z", "type": "commit"}, {"oid": "588608dec2b2306719b23098315ed7956ccf2491", "url": "https://github.com/elastic/elasticsearch/commit/588608dec2b2306719b23098315ed7956ccf2491", "message": "relative path", "committedDate": "2020-02-13T21:00:39Z", "type": "commit"}, {"oid": "739672ad1970501737b8a1955f51c6a9cd5c8503", "url": "https://github.com/elastic/elasticsearch/commit/739672ad1970501737b8a1955f51c6a9cd5c8503", "message": "upgrade debug", "committedDate": "2020-02-15T17:53:07Z", "type": "commit"}, {"oid": "a37950a8cfb28e65faade5e7a296a31c863a9e78", "url": "https://github.com/elastic/elasticsearch/commit/a37950a8cfb28e65faade5e7a296a31c863a9e78", "message": "Merge branch 'master' into distro_tests41", "committedDate": "2020-02-15T18:27:45Z", "type": "commit"}, {"oid": "0532de7ffa8095dbd3e8db623a7650169600849a", "url": "https://github.com/elastic/elasticsearch/commit/0532de7ffa8095dbd3e8db623a7650169600849a", "message": "Merge branch 'master' into distro_tests41", "committedDate": "2020-04-21T03:40:24Z", "type": "commit"}, {"oid": "f28457ce1fbe164c026e17f837beaa62a510e5cb", "url": "https://github.com/elastic/elasticsearch/commit/f28457ce1fbe164c026e17f837beaa62a510e5cb", "message": "Do not daemonize when testing error output in packaging tests\n\nThe packaging tests start elasticsearch in various ways. All of these\ncurrently expect it is started asynchronously, yet some tests expect it\nwill fail to start and want to check the error output. This commit adds\na daemonize flag to the utility methods to start elasticsearch for such\ncases, so that when the start method returns, all the error output\nshould already be available since the process will have exited.\n\nrelates #51716", "committedDate": "2020-05-19T20:33:01Z", "type": "commit"}, {"oid": "d95f2a58cbce90c86978136cdf4a81132911dab8", "url": "https://github.com/elastic/elasticsearch/commit/d95f2a58cbce90c86978136cdf4a81132911dab8", "message": "checkstyle", "committedDate": "2020-05-19T21:22:39Z", "type": "commit"}, {"oid": "06a2b442d451833b1c9b0f086aa3fb978898379e", "url": "https://github.com/elastic/elasticsearch/commit/06a2b442d451833b1c9b0f086aa3fb978898379e", "message": "clear windows log file after test", "committedDate": "2020-05-19T23:42:38Z", "type": "commit"}, {"oid": "a0c11783c10eff327f14104792c634525add9dac", "url": "https://github.com/elastic/elasticsearch/commit/a0c11783c10eff327f14104792c634525add9dac", "message": "spotless", "committedDate": "2020-05-20T00:17:39Z", "type": "commit"}, {"oid": "08d47c08025c0c1afb7ba930dddc9e0afadd054a", "url": "https://github.com/elastic/elasticsearch/commit/08d47c08025c0c1afb7ba930dddc9e0afadd054a", "message": "Merge branch 'distro_tests45' into distro_tests41", "committedDate": "2020-05-20T02:42:37Z", "type": "commit"}]}