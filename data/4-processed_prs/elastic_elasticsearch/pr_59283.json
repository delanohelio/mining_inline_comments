{"pr_number": 59283, "pr_title": "EQL: Give a name to all toml tests and enforce the naming of new tests", "pr_createdAt": "2020-07-09T09:23:56Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/59283", "timeline": [{"oid": "0829ab92859cff1fa46e5602cd7ecb164c7f7da4", "url": "https://github.com/elastic/elasticsearch/commit/0829ab92859cff1fa46e5602cd7ecb164c7f7da4", "message": "Give a name to all toml tests and enforce the naming of new tests", "committedDate": "2020-07-09T09:21:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjEzMDkwMA==", "url": "https://github.com/elastic/elasticsearch/pull/59283#discussion_r452130900", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            name = \"mathcWithCharacterClasses1\"\n          \n          \n            \n            name = \"matchWithCharacterClasses1\"", "author": "matriv", "createdAt": "2020-07-09T10:49:34Z", "path": "x-pack/plugin/eql/qa/common/src/main/resources/additional_test_queries.toml", "diffHunk": "@@ -59,60 +68,72 @@ expected_event_ids  = [5]\n \n \n [[queries]]\n+name = \"concatEquals2\"\n query = 'process where concat(serial_event_id) = \"1\"'\n expected_event_ids  = [1]\n \n [[queries]]\n+name = \"concatWithCondition1\"\n query = 'process where serial_event_id < 5 and concat(process_name, parent_process_name) != null'\n expected_event_ids  = [2, 3]\n \n \n [[queries]]\n+name = \"concatWithCondition2\"\n query = 'process where serial_event_id < 5 and concat(process_name, parent_process_name) == null'\n expected_event_ids  = [1, 4]\n \n \n [[queries]]\n+name = \"concatWithCondition3\"\n query = 'process where serial_event_id < 5 and concat(process_name, null, null) == null'\n expected_event_ids  = [1, 2, 3, 4]\n \n \n [[queries]]\n+name = \"concatWithCondition4\"\n query = 'process where serial_event_id < 5 and concat(parent_process_name, null) == null'\n expected_event_ids  = [1, 2, 3, 4]\n \n \n [[queries]]\n+name = \"numberStringConversion1\"\n query = 'process where string(serial_event_id) = \"1\"'\n expected_event_ids  = [1]\n \n \n [[queries]]\n+name = \"numberStringConversion2\"\n query = 'any where number(string(serial_event_id)) == 17'\n expected_event_ids = [17]\n \n \n [[queries]]\n+name = \"numberStringConversion3\"\n query = 'any where number(string(serial_event_id), null) == 17'\n expected_event_ids = [17]\n \n \n [[queries]]\n+name = \"numberStringConversion4\"\n query = 'any where number(string(serial_event_id), 10) == 17'\n expected_event_ids = [17]\n \n \n [[queries]]\n+name = \"numberStringEquality\"\n query = 'any where number(string(serial_event_id), 13) == number(\"31\", 13)'\n expected_event_ids = [31]\n \n \n [[queries]]\n+name = \"numberStringConversion5\"\n query = 'any where number(string(serial_event_id), 16) == 17'\n expected_event_ids = [11]\n \n \n [[queries]]\n+name = \"mathcWithCharacterClasses1\"", "originalCommit": "0829ab92859cff1fa46e5602cd7ecb164c7f7da4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjEzMTExNw==", "url": "https://github.com/elastic/elasticsearch/pull/59283#discussion_r452131117", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            name = \"mathcWithCharacterClasses2\"\n          \n          \n            \n            name = \"matchWithCharacterClasses2\"", "author": "matriv", "createdAt": "2020-07-09T10:50:02Z", "path": "x-pack/plugin/eql/qa/common/src/main/resources/additional_test_queries.toml", "diffHunk": "@@ -122,12 +143,14 @@ process where match(command_line, ?'.*?net1[ ]+localgroup.*?')\n '''\n \n [[queries]]\n+name = \"matchLiteAdditional\"\n expected_event_ids  = [98]\n query = '''\n process where matchLite(command_line, ?'.*?net1.*?')\n '''\n \n [[queries]]\n+name = \"mathcWithCharacterClasses2\"", "originalCommit": "0829ab92859cff1fa46e5602cd7ecb164c7f7da4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjEzMTgxOA==", "url": "https://github.com/elastic/elasticsearch/pull/59283#discussion_r452131818", "bodyText": "why here is additional and next one is stringCidrMatch ?\nPersonally I would just name them stringCidrMatchX without the Additional.", "author": "matriv", "createdAt": "2020-07-09T10:51:29Z", "path": "x-pack/plugin/eql/qa/common/src/main/resources/additional_test_queries.toml", "diffHunk": "@@ -2,55 +2,64 @@\n # test_queries.toml file in order to keep the original unchanged and easier to sync with the EQL reference implementation tests.\n \n [[queries]]\n+name = \"betweenAdditional1\"\n expected_event_ids = [95]\n query = '''\n file where between(file_path, \"dev\", \".json\", false) == \"\\\\TestLogs\\\\something\"\n '''\n \n [[queries]]\n+name = \"betweenAdditional2\"\n expected_event_ids = [95]\n query = '''\n file where between(file_path, \"dev\", \".json\", true) == \"\\\\TestLogs\\\\something\"\n '''\n \n [[queries]]\n+name = \"cidrMatchAdditional1\"", "originalCommit": "0829ab92859cff1fa46e5602cd7ecb164c7f7da4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjEzMzA1MA==", "url": "https://github.com/elastic/elasticsearch/pull/59283#discussion_r452133050", "bodyText": "I would rename Bys to Keys", "author": "matriv", "createdAt": "2020-07-09T10:54:03Z", "path": "x-pack/plugin/eql/qa/common/src/main/resources/test_queries_unsupported.toml", "diffHunk": "@@ -8,12 +8,8 @@\n # in order to allow at least one round-trip test with the test harness.\n # This will be removed once the EQL implementation is wired and actually supports this query.\n \n-\n-[[queries]]\n-expected_event_ids = []\n-query = 'process where missing_field != null'\n-\n [[queries]]\n+name = \"twoSequencesWithBys\"", "originalCommit": "0829ab92859cff1fa46e5602cd7ecb164c7f7da4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjEzMzIxOA==", "url": "https://github.com/elastic/elasticsearch/pull/59283#discussion_r452133218", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            name = \"simeplTailWithSort\"\n          \n          \n            \n            name = \"simpleTailWithSort\"", "author": "matriv", "createdAt": "2020-07-09T10:54:22Z", "path": "x-pack/plugin/eql/qa/common/src/main/resources/test_queries_unsupported.toml", "diffHunk": "@@ -241,26 +266,30 @@ expected_event_ids  = [78]\n \n \n [[queries]]\n+name = \"simpleTail\"\n query = '''\n file where true\n | tail 3\n '''\n expected_event_ids  = [92, 95, 96]\n \n [[queries]]\n+name = \"twoINs\"\n query = '''\n process where opcode in (1,3) and process_name in (parent_process_name, \"System\")\n '''\n expected_event_ids  = [2, 50, 51]\n \n [[queries]]\n+name = \"twoINsCaseInsensitive\"\n case_insensitive = true\n query = '''\n process where opcode in (1,3) and process_name in (parent_process_name, \"SYSTEM\")\n '''\n expected_event_ids  = [2, 50, 51]\n \n [[queries]]\n+name = \"simeplTailWithSort\"", "originalCommit": "0829ab92859cff1fa46e5602cd7ecb164c7f7da4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8b73cb4e95b3bf2b0837a3025461cf89d41cc1ad", "url": "https://github.com/elastic/elasticsearch/commit/8b73cb4e95b3bf2b0837a3025461cf89d41cc1ad", "message": "Address comments", "committedDate": "2020-07-09T11:01:12Z", "type": "commit"}, {"oid": "440c06c9921cb3242984b5089a4b6e0f000633ff", "url": "https://github.com/elastic/elasticsearch/commit/440c06c9921cb3242984b5089a4b6e0f000633ff", "message": "Merge branch 'master' of https://github.com/elastic/elasticsearch into toml_tests_naming", "committedDate": "2020-07-09T11:01:33Z", "type": "commit"}]}