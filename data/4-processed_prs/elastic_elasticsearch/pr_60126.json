{"pr_number": 60126, "pr_title": "[ML] Audit updates on data frame analytics jobs", "pr_createdAt": "2020-07-23T14:19:32Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/60126", "timeline": [{"oid": "53558ed6a8084ad861fb905f6b85f04239e8ce26", "url": "https://github.com/elastic/elasticsearch/commit/53558ed6a8084ad861fb905f6b85f04239e8ce26", "message": "[ML] Audit updates on data frame analytics jobs\n\nCloses #59652", "committedDate": "2020-07-23T14:16:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAzMTUyNQ==", "url": "https://github.com/elastic/elasticsearch/pull/60126#discussion_r461031525", "bodyText": "A Set here seems like overkill. Just a List and ArrayList would do.\nBut, that is not that big of a deal.", "author": "benwtrent", "createdAt": "2020-07-27T16:54:26Z", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/dataframe/DataFrameAnalyticsConfigUpdate.java", "diffHunk": "@@ -152,6 +154,23 @@ public boolean requiresRestart(DataFrameAnalyticsConfig source) {\n             || (getMaxNumThreads() != null && getMaxNumThreads().equals(source.getMaxNumThreads()) == false);\n     }\n \n+    public Set<String> getUpdatedFields() {", "originalCommit": "53558ed6a8084ad861fb905f6b85f04239e8ce26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTUzOTAxNw==", "url": "https://github.com/elastic/elasticsearch/pull/60126#discussion_r461539017", "bodyText": "I'm using a TreeSet and thus I like it because we get the fields sorted no matter which way they are added in the future.", "author": "dimitris-athanasiou", "createdAt": "2020-07-28T12:26:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAzMTUyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4MTU0Mw==", "url": "https://github.com/elastic/elasticsearch/pull/60126#discussion_r461381543", "bodyText": "If getUpdatedFields returns Set then the matcher should be containsInAnyOrder so that it works regardless of the exact Set implementation.", "author": "przemekwitek", "createdAt": "2020-07-28T07:41:34Z", "path": "x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ml/dataframe/DataFrameAnalyticsConfigUpdateTests.java", "diffHunk": "@@ -197,6 +198,49 @@ public void testCtor_GivenMaxNumberThreadsIsNegative() {\n         assertThat(e.getMessage(), equalTo(\"[max_num_threads] must be a positive integer\"));\n     }\n \n+    public void testGetUpdatedFields_GivenAll() {\n+        DataFrameAnalyticsConfigUpdate update = new DataFrameAnalyticsConfigUpdate.Builder(\"test_job\")\n+            .setDescription(\"new description\")\n+            .setModelMemoryLimit(new ByteSizeValue(1024))\n+            .setAllowLazyStart(true)\n+            .setMaxNumThreads(8)\n+            .build();\n+\n+        assertThat(update.getUpdatedFields(), contains(\"allow_lazy_start\", \"description\", \"max_num_threads\", \"model_memory_limit\"));", "originalCommit": "53558ed6a8084ad861fb905f6b85f04239e8ce26", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTUzOTIzMQ==", "url": "https://github.com/elastic/elasticsearch/pull/60126#discussion_r461539231", "bodyText": "We want the test to fail if the set isn't sorted.", "author": "dimitris-athanasiou", "createdAt": "2020-07-28T12:26:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTM4MTU0Mw=="}], "type": "inlineReview"}]}