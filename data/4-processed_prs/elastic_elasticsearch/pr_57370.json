{"pr_number": 57370, "pr_title": "[DOCS] Clarifying env variable substitution", "pr_createdAt": "2020-05-29T16:45:32Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/57370", "timeline": [{"oid": "5730ead4ec8a502e9714d187af990465f85d041d", "url": "https://github.com/elastic/elasticsearch/commit/5730ead4ec8a502e9714d187af990465f85d041d", "message": "Clarifying environment variable substitution in the ES configuration YAML.", "committedDate": "2020-05-29T16:41:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYzNzExOA==", "url": "https://github.com/elastic/elasticsearch/pull/57370#discussion_r432637118", "bodyText": "Few things here:\n\nBe sure to wrap paragraphs to 80 characters or less.\nI typically replace like with such as for examples, but feel free to ignore that if wanted.\nI think the paragraph is clearer without this sentence:\n\n\nHowever, settings that accept data structures such as lists also accepted comma-separated strings.\n\nIf you decide to keep it, fix the accepted bit.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            When specifying values for environment variables, you can only use strings. More complex data structures like lists are not supported. However, settings that accept data structures such as lists also accepted comma-separated strings. For example, you can specify multiple values for the `${HOSTNAME}` variable from the previous example:\n          \n          \n            \n            You can use comma-separated strings to specify multiple values for environment\n          \n          \n            \n            variables. More complex data structures, such as lists, are not supported.\n          \n          \n            \n            \n          \n          \n            \n            For example, you can specify multiple values for the `${HOSTNAME}` variable:", "author": "jrodewig", "createdAt": "2020-05-29T17:36:19Z", "path": "docs/reference/setup/configuration.asciidoc", "diffHunk": "@@ -71,14 +71,21 @@ path.logs: /var/log/elasticsearch\n \n Environment variables referenced with the `${...}` notation within the\n configuration file will be replaced with the value of the environment\n-variable, for instance:\n+variable. For example:\n \n [source,yaml]\n --------------------------------------------------\n node.name:    ${HOSTNAME}\n network.host: ${ES_NETWORK_HOST}\n --------------------------------------------------\n \n+When specifying values for environment variables, you can only use strings. More complex data structures like lists are not supported. However, settings that accept data structures such as lists also accepted comma-separated strings. For example, you can specify multiple values for the `${HOSTNAME}` variable from the previous example:", "originalCommit": "5730ead4ec8a502e9714d187af990465f85d041d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY1Mzg2Nw==", "url": "https://github.com/elastic/elasticsearch/pull/57370#discussion_r432653867", "bodyText": "I think this is also not quite right: you can't actually use a comma-separated string to specify multiple values for an environment variable, you're specifying a single value which Elasticsearch will split up if it was expecting a list.\n\"More complex data structures like lists are not supported\" isn't really right, we do support lists of strings this way (but nothing else AFAIK).", "author": "DaveCTurner", "createdAt": "2020-05-29T18:09:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYzNzExOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjcyNzE2Nw==", "url": "https://github.com/elastic/elasticsearch/pull/57370#discussion_r432727167", "bodyText": "@DaveCTurner, thank you for the continual feedback. I want to inject clarity in what we're trying to explain! Is this modification closer to what we want to convey?\n\nValues for environment variables must be simple strings. Use a comma-separated string to provide values that Elasticsearch will parse as a list. For example, Elasticsearch will split the following string into a list of values for the ${HOSTNAME} environment variable:\nexport HOSTNAME=\u201chost1,host2\"", "author": "lockewritesdocs", "createdAt": "2020-05-29T20:46:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYzNzExOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYzNzgyMw==", "url": "https://github.com/elastic/elasticsearch/pull/57370#discussion_r432637823", "bodyText": "This should be [source,yaml]. [source,console] snippets get tested by our CI, which would fail here. This is also just a bit of YAML, not a Kibana console snippet.\nYou only need four - characters to denote a snippet. I wouldn't do more than that.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            [source,console]\n          \n          \n            \n            --------------------------------------------------\n          \n          \n            \n            export HOSTNAME=\u201chost1\u201d, \u201chost2\"\n          \n          \n            \n            --------------------------------------------------\n          \n          \n            \n            [source,yaml]\n          \n          \n            \n            ----\n          \n          \n            \n            export HOSTNAME=\u201chost1\u201d, \u201chost2\"\n          \n          \n            \n            ----", "author": "jrodewig", "createdAt": "2020-05-29T17:37:44Z", "path": "docs/reference/setup/configuration.asciidoc", "diffHunk": "@@ -71,14 +71,21 @@ path.logs: /var/log/elasticsearch\n \n Environment variables referenced with the `${...}` notation within the\n configuration file will be replaced with the value of the environment\n-variable, for instance:\n+variable. For example:\n \n [source,yaml]\n --------------------------------------------------\n node.name:    ${HOSTNAME}\n network.host: ${ES_NETWORK_HOST}\n --------------------------------------------------\n \n+When specifying values for environment variables, you can only use strings. More complex data structures like lists are not supported. However, settings that accept data structures such as lists also accepted comma-separated strings. For example, you can specify multiple values for the `${HOSTNAME}` variable from the previous example:\n+\n+[source,console]\n+--------------------------------------------------\n+export HOSTNAME=\u201chost1\u201d, \u201chost2\"\n+--------------------------------------------------", "originalCommit": "5730ead4ec8a502e9714d187af990465f85d041d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "eb8269686d371f3abccf53ad4a44b7ed7e03d998", "url": "https://github.com/elastic/elasticsearch/commit/eb8269686d371f3abccf53ad4a44b7ed7e03d998", "message": "Update code snippet\n\nCo-authored-by: James Rodewig <james.rodewig@elastic.co>", "committedDate": "2020-05-29T17:50:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY1MTE3MQ==", "url": "https://github.com/elastic/elasticsearch/pull/57370#discussion_r432651171", "bodyText": "I don't think this works (in bash at least) because it splits the assignment at the space:\n$ export TEST_ARRAY=\"host1\", \"host2\"\n$ echo $TEST_ARRAY\nhost1,\n\nI also think having two quoted strings is confusing, given that we're trying to construct a single string containing both values separated by a comma. Also we don't permit a space in the string. Suggest this:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            export HOSTNAME=\u201chost1\u201d, \u201chost2\"\n          \n          \n            \n            export HOSTNAME=\u201chost1,host2\"", "author": "DaveCTurner", "createdAt": "2020-05-29T18:04:01Z", "path": "docs/reference/setup/configuration.asciidoc", "diffHunk": "@@ -71,14 +71,21 @@ path.logs: /var/log/elasticsearch\n \n Environment variables referenced with the `${...}` notation within the\n configuration file will be replaced with the value of the environment\n-variable, for instance:\n+variable. For example:\n \n [source,yaml]\n --------------------------------------------------\n node.name:    ${HOSTNAME}\n network.host: ${ES_NETWORK_HOST}\n --------------------------------------------------\n \n+When specifying values for environment variables, you can only use strings. More complex data structures like lists are not supported. However, settings that accept data structures such as lists also accepted comma-separated strings. For example, you can specify multiple values for the `${HOSTNAME}` variable from the previous example:\n+\n+[source,yaml]\n+----\n+export HOSTNAME=\u201chost1\u201d, \u201chost2\"", "originalCommit": "eb8269686d371f3abccf53ad4a44b7ed7e03d998", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6c63f94e38a2dbf0d8d213681708fa524388ffd7", "url": "https://github.com/elastic/elasticsearch/commit/6c63f94e38a2dbf0d8d213681708fa524388ffd7", "message": "Remove extraneous quotes from string example\n\nCo-authored-by: David Turner <david.turner@elastic.co>", "committedDate": "2020-05-29T19:53:53Z", "type": "commit"}, {"oid": "c24300376896434a45be2bb71cad5ac517b6bb25", "url": "https://github.com/elastic/elasticsearch/commit/c24300376896434a45be2bb71cad5ac517b6bb25", "message": "Incorporating review feedback.", "committedDate": "2020-06-05T12:57:50Z", "type": "commit"}]}