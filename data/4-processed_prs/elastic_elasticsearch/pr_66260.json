{"pr_number": 66260, "pr_title": "Allow bootstrap plugins to appear in _cat/plugins", "pr_createdAt": "2020-12-14T15:00:52Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/66260", "timeline": [{"oid": "e4a9ef313354f2eb235c486f65674b8652a28277", "url": "https://github.com/elastic/elasticsearch/commit/e4a9ef313354f2eb235c486f65674b8652a28277", "message": "Allow bootstrap plugins to appear in _cat/plugins\n\nBootstrap plugins are not loaded in the main Elasticsearch process, but\ninstead take effect only when ES is starting. As such, these plugins are\nskipped when ES loads all installed plugins.\n\nAs a result, it was impossible for the plugins _cat API to report\nwhether any bootstrap plugins are installed.\n\nFix this by adjusting how the loading process skips bootstrap plugins,\nand then tweaking the plugins _cat API so that bootstrap plugins can\noptionally be included in the response.", "committedDate": "2020-12-14T14:51:39Z", "type": "commit"}, {"oid": "b4ecb007cf638e12e51862144a33aa6ff0590451", "url": "https://github.com/elastic/elasticsearch/commit/b4ecb007cf638e12e51862144a33aa6ff0590451", "message": "Fix test", "committedDate": "2020-12-14T15:34:35Z", "type": "commit"}, {"oid": "60729f74aa59bcbd02526808ced31cd778431572", "url": "https://github.com/elastic/elasticsearch/commit/60729f74aa59bcbd02526808ced31cd778431572", "message": "Tweak _cat/plugins YAML test to handle output change", "committedDate": "2020-12-14T16:56:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzEwMzcxMg==", "url": "https://github.com/elastic/elasticsearch/pull/66260#discussion_r543103712", "bodyText": "We don't seem to have any unit tests for this class. Would it be possible to add a simple one? The packaging tests added seem to be testing this new flag, but that doesn't seem like the right place, since the flag doesn't directly have anything to do with the quota aware fs plugin, it's just the only example we have so far a bootstrap plugin.", "author": "rjernst", "createdAt": "2020-12-15T07:21:32Z", "path": "server/src/main/java/org/elasticsearch/rest/action/cat/RestPluginsAction.java", "diffHunk": "@@ -106,12 +113,16 @@ private Table buildTable(RestRequest req, ClusterStateResponse state, NodesInfoR\n                 continue;\n             }\n             for (PluginInfo pluginInfo : plugins.getPluginInfos()) {\n+                if (pluginInfo.getType() == PluginType.BOOTSTRAP && includeBootstrapPlugins == false) {", "originalCommit": "60729f74aa59bcbd02526808ced31cd778431572", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDIzNjM3MQ==", "url": "https://github.com/elastic/elasticsearch/pull/66260#discussion_r544236371", "bodyText": "@rjernst I've added unit tests, please take a look.", "author": "pugnascotia", "createdAt": "2020-12-16T11:51:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzEwMzcxMg=="}], "type": "inlineReview"}, {"oid": "e3c72d53c4bceb9408330c1fc4dc1cbcfb97c298", "url": "https://github.com/elastic/elasticsearch/commit/e3c72d53c4bceb9408330c1fc4dc1cbcfb97c298", "message": "Merge remote-tracking branch 'upstream/master' into cat-api-bootstrap-plugins", "committedDate": "2020-12-15T15:14:26Z", "type": "commit"}, {"oid": "dc578a3e98601d7e1a57c9b3d65c9b8a8e576ba0", "url": "https://github.com/elastic/elasticsearch/commit/dc578a3e98601d7e1a57c9b3d65c9b8a8e576ba0", "message": "Add unit tests", "committedDate": "2020-12-16T11:44:39Z", "type": "commit"}, {"oid": "6cfda819a475df06f9352f69decd651f8be124c4", "url": "https://github.com/elastic/elasticsearch/commit/6cfda819a475df06f9352f69decd651f8be124c4", "message": "Simply IT for quota-aware-fs and _cat/plugins", "committedDate": "2020-12-16T11:50:47Z", "type": "commit"}, {"oid": "9641ab6a94fe4edf10f882a32bc4673490efca79", "url": "https://github.com/elastic/elasticsearch/commit/9641ab6a94fe4edf10f882a32bc4673490efca79", "message": "Merge remote-tracking branch 'upstream/master' into cat-api-bootstrap-plugins", "committedDate": "2020-12-16T12:33:42Z", "type": "commit"}]}