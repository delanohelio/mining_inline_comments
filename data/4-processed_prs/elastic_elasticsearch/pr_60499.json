{"pr_number": 60499, "pr_title": "[doc] Improve joda-time migration guide", "pr_createdAt": "2020-07-31T07:44:41Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/60499", "timeline": [{"oid": "0b5ff598f132f6cba030f7e2e298e72e77b2a9ae", "url": "https://github.com/elastic/elasticsearch/commit/0b5ff598f132f6cba030f7e2e298e72e77b2a9ae", "message": "draft", "committedDate": "2020-07-29T13:41:41Z", "type": "commit"}, {"oid": "328a862a16826fe178e749d344de163442e2e857", "url": "https://github.com/elastic/elasticsearch/commit/328a862a16826fe178e749d344de163442e2e857", "message": "[doc] indicate that migration from joda to java is not necessary in 6.8", "committedDate": "2020-07-31T07:31:19Z", "type": "commit"}, {"oid": "2e65fd24f7c9aee2ce3f6e50c6cde0d835982d84", "url": "https://github.com/elastic/elasticsearch/commit/2e65fd24f7c9aee2ce3f6e50c6cde0d835982d84", "message": "Merge branch '7.x' into doc/joda_migration", "committedDate": "2020-07-31T07:53:47Z", "type": "commit"}, {"oid": "fe79f47f3d3b38c2ca37ca291c7cb0be8f470419", "url": "https://github.com/elastic/elasticsearch/commit/fe79f47f3d3b38c2ca37ca291c7cb0be8f470419", "message": "fix", "committedDate": "2020-07-31T08:31:56Z", "type": "commit"}, {"oid": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8", "url": "https://github.com/elastic/elasticsearch/commit/37126fdc2c2eaa00396a9c3c14a055a1c6af99f8", "message": "links", "committedDate": "2020-07-31T11:32:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwODUyNg==", "url": "https://github.com/elastic/elasticsearch/pull/60499#discussion_r473008526", "bodyText": "I don't think the bolding or admon is necessary.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            *You do not need to convert joda-time date formats on indices created in {es} 6.8\n          \n          \n            \n            before upgrading to {es} 7.7 or newer*\n          \n          \n            \n            \n          \n          \n            \n            However you will have to make sure mappings for newly created indices are using\n          \n          \n            \n            java-time patterns.\n          \n          \n            \n            Note: {es} 7.0-7.6 does not work with joda-time patterns. It was fixed in {es} 7.7\n          \n          \n            \n            see: {es-pull}52555[#52555]\n          \n          \n            \n            \n          \n          \n            \n            You need to update your pipelines or templates, because creating new indices with\n          \n          \n            \n            joda-time patterns in mappings is not allowed.\n          \n          \n            \n            <<java-time-migration-update-ingest-pipelines>>\n          \n          \n            \n            <<java-time-migration-update-index-templates>>\n          \n          \n            \n            You do not need to convert joda-time date formats to java time for indices\n          \n          \n            \n            created in {es} 6.8 before upgrading to 7.7 or later versions. However, mappings\n          \n          \n            \n            for indices created in 7.7 and later versions must use java-time formats.\n          \n          \n            \n            \n          \n          \n            \n            To ensure new indices use java-time formats, we recommend you update any ingest\n          \n          \n            \n            pipelines and index templates created in 6.8 to java time before upgrading. See:\n          \n          \n            \n            \n          \n          \n            \n            * <<java-time-migration-update-ingest-pipelines>>\n          \n          \n            \n            * <<java-time-migration-update-index-templates>>\n          \n          \n            \n            \n          \n          \n            \n            Indices created in versions 7.0-7.6 cannot use joda time. This was fixed\n          \n          \n            \n            was in 7.7 with {es-pull}52555[#52555].", "author": "jrodewig", "createdAt": "2020-08-19T12:58:19Z", "path": "docs/reference/migration/migrate_7_0/migrate_to_java_time.asciidoc", "diffHunk": "@@ -5,16 +5,25 @@ With 7.0, {es} switched from joda time to java time for date-related parsing,\n formatting, and calculations. This guide is designed to help you determine\n if your cluster is impacted and, if so, prepare for the upgrade.\n \n+*You do not need to convert joda-time date formats on indices created in {es} 6.8\n+before upgrading to {es} 7.7 or newer*\n+\n+However you will have to make sure mappings for newly created indices are using\n+java-time patterns.\n+Note: {es} 7.0-7.6 does not work with joda-time patterns. It was fixed in {es} 7.7\n+see: {es-pull}52555[#52555]\n+\n+You need to update your pipelines or templates, because creating new indices with\n+joda-time patterns in mappings is not allowed.\n+<<java-time-migration-update-ingest-pipelines>>\n+<<java-time-migration-update-index-templates>>\n+", "originalCommit": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwOTg5OQ==", "url": "https://github.com/elastic/elasticsearch/pull/60499#discussion_r473009899", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            migrated.\n          \n          \n            \n            converted to their java-time equivalents.", "author": "jrodewig", "createdAt": "2020-08-19T13:00:16Z", "path": "docs/reference/migration/migrate_7_0/migrate_to_java_time.asciidoc", "diffHunk": "@@ -51,7 +60,7 @@ or the {kibana-ref}/upgrade-assistant.html[Kibana upgrade assistant].\n [[java-time-migration-incompatible-date-formats]]\n ==== Incompatible date formats\n Custom date formats containing the following joda-time literals should be\n-changed before upgrading.\n+migrated.", "originalCommit": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAwOTkwNQ==", "url": "https://github.com/elastic/elasticsearch/pull/60499#discussion_r473009905", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            You can start using java-time patterns in {es} 6.8 by prefixing java-time\n          \n          \n            \n            date formats with an `8`.\n          \n          \n            \n            To use java time in 6.8, prefix the date format with an `8`.", "author": "jrodewig", "createdAt": "2020-08-19T13:00:16Z", "path": "docs/reference/migration/migrate_7_0/migrate_to_java_time.asciidoc", "diffHunk": "@@ -5,16 +5,25 @@ With 7.0, {es} switched from joda time to java time for date-related parsing,\n formatting, and calculations. This guide is designed to help you determine\n if your cluster is impacted and, if so, prepare for the upgrade.\n \n+*You do not need to convert joda-time date formats on indices created in {es} 6.8\n+before upgrading to {es} 7.7 or newer*\n+\n+However you will have to make sure mappings for newly created indices are using\n+java-time patterns.\n+Note: {es} 7.0-7.6 does not work with joda-time patterns. It was fixed in {es} 7.7\n+see: {es-pull}52555[#52555]\n+\n+You need to update your pipelines or templates, because creating new indices with\n+joda-time patterns in mappings is not allowed.\n+<<java-time-migration-update-ingest-pipelines>>\n+<<java-time-migration-update-index-templates>>\n+\n [discrete]\n [[java-time-convert-date-formats]]\n === Convert date formats\n \n-To upgrade to 7.0, you'll need to convert any joda-time date formats\n-to their java-time equivalents.\n-\n-To help track this effort, you can prefix java-time date formats with an `8`\n- in {es} 6.8 and later versions.\n-\n+You can start using java-time patterns in {es} 6.8 by prefixing java-time\n+date formats with an `8`.", "originalCommit": "37126fdc2c2eaa00396a9c3c14a055a1c6af99f8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "b38e163448032e29de77ddd6fc38885b2bbc05f2", "url": "https://github.com/elastic/elasticsearch/commit/b38e163448032e29de77ddd6fc38885b2bbc05f2", "message": "Apply suggestions from code review\n\nCo-authored-by: James Rodewig <40268737+jrodewig@users.noreply.github.com>", "committedDate": "2020-08-20T12:19:06Z", "type": "commit"}]}