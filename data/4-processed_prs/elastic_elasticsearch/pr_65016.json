{"pr_number": 65016, "pr_title": "Remove shutdown hook permission from hdfs plugin", "pr_createdAt": "2020-11-12T19:02:33Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/65016", "timeline": [{"oid": "ff9a8a51bd374c4461467d7ab78a9858cebed780", "url": "https://github.com/elastic/elasticsearch/commit/ff9a8a51bd374c4461467d7ab78a9858cebed780", "message": "Revert \"Revert \"Remove shutdown hook permission from hdfs plugin (#64899)\"\"\n\nThis reverts commit fef57fb3", "committedDate": "2020-11-12T18:59:55Z", "type": "commit"}, {"oid": "247f5b548ed632ebc8a6f835883eb694b5d6c4a5", "url": "https://github.com/elastic/elasticsearch/commit/247f5b548ed632ebc8a6f835883eb694b5d6c4a5", "message": "Revert \"Revert \"Remove commented out dependency\"\"\n\nThis reverts commit e65c044b", "committedDate": "2020-11-12T18:59:55Z", "type": "commit"}, {"oid": "ef723cb1a4039e9525f2ca2002dee9e47eb7b836", "url": "https://github.com/elastic/elasticsearch/commit/ef723cb1a4039e9525f2ca2002dee9e47eb7b836", "message": "Remove shutdown hook permission from hdfs plugin", "committedDate": "2020-11-12T19:00:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM2NDIxMA==", "url": "https://github.com/elastic/elasticsearch/pull/65016#discussion_r522364210", "bodyText": "Is the dollar correct? We don't want the actual ShutdownHookManager either, not just subclasses", "author": "rjernst", "createdAt": "2020-11-12T19:28:41Z", "path": "plugins/repository-hdfs/hadoop-common/build.gradle", "diffHunk": "@@ -0,0 +1,10 @@\n+apply plugin: 'elasticsearch.java'\n+apply plugin: 'com.github.johnrengelman.shadow'\n+\n+dependencies {\n+  implementation \"org.apache.hadoop:hadoop-common:${project.parent.versions.hadoop2}\"\n+}\n+\n+tasks.named('shadowJar').configure {\n+  exclude 'org/apache/hadoop/util/ShutdownHookManager$*.class'", "originalCommit": "ef723cb1a4039e9525f2ca2002dee9e47eb7b836", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM3MjU1Mw==", "url": "https://github.com/elastic/elasticsearch/pull/65016#discussion_r522372553", "bodyText": "This filtering is done on the \"final\" jar, meaning that would rip out our override class. The ShadowJar copy action looks to avoid duplicate archive entries though so I think it's safe to presume this behavior. If for some reason this would change we'd observe things explode due to those missing inner classes anyhow.", "author": "mark-vieira", "createdAt": "2020-11-12T19:38:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM2NDIxMA=="}], "type": "inlineReview"}]}