{"pr_number": 53314, "pr_title": "Remove the listener thread pool", "pr_createdAt": "2020-03-09T21:11:44Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/53314", "timeline": [{"oid": "6a48dca19f8e4500f23e15d8bd017117facc8711", "url": "https://github.com/elastic/elasticsearch/commit/6a48dca19f8e4500f23e15d8bd017117facc8711", "message": "Remove the listener thread pool\n\nThis commit completes the work to remove the listener thread pool,\nhaving removed all uses of it in the server codebase, and deprecated it\nin 7.x. With this commit, we also remove the infrastructgure to\ndeprecate a fixed thread pool, which was added as part of this work,\nsince it is easy to bring back if needed.", "committedDate": "2020-03-09T21:09:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk4NDI5Ng==", "url": "https://github.com/elastic/elasticsearch/pull/53314#discussion_r389984296", "bodyText": "NIT: is the indent change intended here?", "author": "original-brownbear", "createdAt": "2020-03-09T21:56:41Z", "path": "server/src/main/java/org/elasticsearch/threadpool/FixedExecutorBuilder.java", "diffHunk": "@@ -87,45 +66,16 @@\n      */\n     public FixedExecutorBuilder(final Settings settings, final String name, final int size, final int queueSize, final String prefix,\n                                 final boolean trackEWMA) {\n-        this(settings, name, size, queueSize, prefix, trackEWMA, false);\n-    }\n-\n-    /**\n-     * Construct a fixed executor builder.\n-     *\n-     * @param settings   the node-level settings\n-     * @param name       the name of the executor\n-     * @param size       the fixed number of threads\n-     * @param queueSize  the size of the backing queue, -1 for unbounded\n-     * @param prefix     the prefix for the settings keys\n-     * @param trackEWMA  whether to track the exponentially weighted moving average of the task execution time\n-     * @param deprecated whether or not the thread pool is deprecated\n-     */\n-    public FixedExecutorBuilder(\n-        final Settings settings,\n-        final String name,\n-        final int size,\n-        final int queueSize,\n-        final String prefix,\n-        final boolean trackEWMA,\n-        final boolean deprecated\n-    ) {\n         super(name);\n         final String sizeKey = settingsKey(prefix, \"size\");\n-        final Setting.Property[] properties;\n-        if (deprecated) {\n-            properties = new Setting.Property[]{Setting.Property.NodeScope, Setting.Property.Deprecated};\n-        } else {\n-            properties = new Setting.Property[]{Setting.Property.NodeScope};\n-        }\n         this.sizeSetting =\n-            new Setting<>(\n-                sizeKey,\n-                s -> Integer.toString(size),\n-                s -> Setting.parseInt(s, 1, applyHardSizeLimit(settings, name), sizeKey),\n-                properties);\n+                new Setting<>(", "originalCommit": "6a48dca19f8e4500f23e15d8bd017117facc8711", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk4NTU2Mg==", "url": "https://github.com/elastic/elasticsearch/pull/53314#discussion_r389985562", "bodyText": "So, to deprecate the listener thread pool, I added some temporary infrastructure in this class (see #53266) which changed the indentation here because of my IDE having different settings than when I authored this code a long time ago. \ud83e\udd37\u200d\u2640\nSince after removing this setting this infrastructure isn't needed anymore, I simply reverted the file back to its initial state before #53266, including the original formatting.\nLong live automatic code formatting!", "author": "jasontedor", "createdAt": "2020-03-09T21:59:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk4NDI5Ng=="}], "type": "inlineReview"}]}