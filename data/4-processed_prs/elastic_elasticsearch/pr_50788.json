{"pr_number": 50788, "pr_title": "Fix Snapshot Shard Status Request Deduplication", "pr_createdAt": "2020-01-09T11:26:12Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/50788", "timeline": [{"oid": "9170bd9ffe253ecb52c86eb06b58d91e6b212bb8", "url": "https://github.com/elastic/elasticsearch/commit/9170bd9ffe253ecb52c86eb06b58d91e6b212bb8", "message": "Fix Snapshot Shard Status Request Deduplication\n\nThe request deduplication didn't actually work for these requests\nsince they had no `equals` and `hashCode` so the deduplicator wouldn't\nactually recognize equal requests.", "committedDate": "2020-01-09T11:24:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDc1MjYzMA==", "url": "https://github.com/elastic/elasticsearch/pull/50788#discussion_r364752630", "bodyText": "nit: I think all fields of this class can be final now. Can we also add a test using EqualsHashCodeTestUtils?", "author": "dnhatn", "createdAt": "2020-01-09T14:00:32Z", "path": "server/src/main/java/org/elasticsearch/snapshots/SnapshotShardsService.java", "diffHunk": "@@ -440,6 +441,23 @@ public ShardSnapshotStatus status() {\n         public String toString() {\n             return snapshot + \", shardId [\" + shardId + \"], status [\" + status.state() + \"]\";\n         }\n+\n+        @Override\n+        public boolean equals(final Object o) {\n+            if (this == o) {\n+                return true;\n+            }\n+            if (o == null || getClass() != o.getClass()) {\n+                return false;\n+            }\n+            final UpdateIndexShardSnapshotStatusRequest that = (UpdateIndexShardSnapshotStatusRequest) o;\n+            return snapshot.equals(that.snapshot) && shardId.equals(that.shardId) && status.equals(that.status);", "originalCommit": "9170bd9ffe253ecb52c86eb06b58d91e6b212bb8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg0NTE2OQ==", "url": "https://github.com/elastic/elasticsearch/pull/50788#discussion_r364845169", "bodyText": "Thanks Nhat! How about the tests in e21440d  ? :)", "author": "original-brownbear", "createdAt": "2020-01-09T16:43:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDc1MjYzMA=="}], "type": "inlineReview"}, {"oid": "a9cef862905cd3e49c19a681465f42a1b23c52d1", "url": "https://github.com/elastic/elasticsearch/commit/a9cef862905cd3e49c19a681465f42a1b23c52d1", "message": "Merge remote-tracking branch 'elastic/master' into shard-status-request-dedup", "committedDate": "2020-01-09T16:24:16Z", "type": "commit"}, {"oid": "e21440d4c5b7c404c828e07b1e2b00129cb37be7", "url": "https://github.com/elastic/elasticsearch/commit/e21440d4c5b7c404c828e07b1e2b00129cb37be7", "message": "CR: final fields + test", "committedDate": "2020-01-09T16:42:25Z", "type": "commit"}]}