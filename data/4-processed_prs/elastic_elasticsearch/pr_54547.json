{"pr_number": 54547, "pr_title": "Replace license check isAuthAllowed with isSecurityEnabled", "pr_createdAt": "2020-04-01T00:06:01Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/54547", "timeline": [{"oid": "3a9be849a88f932a5136d8fb745df740a5793653", "url": "https://github.com/elastic/elasticsearch/commit/3a9be849a88f932a5136d8fb745df740a5793653", "message": "Replace license check isAuthAllowed with isSecurityEnabled\n\nThe isAuthAllowed() method for license checking is used by code that\nwants to ensure security is both enabled and available. The enabled\nstate is dynamic and provided by isSecurityEnabled(). But since security\nis available with all license types, an check on the license level is\nnot necessary. Thus, this change replaces isAuthAllowed() with calling\nisSecurityEnabled().", "committedDate": "2020-04-01T00:04:58Z", "type": "commit"}, {"oid": "5555866fc88a235096472f8a791a0ae4a8ed9f45", "url": "https://github.com/elastic/elasticsearch/commit/5555866fc88a235096472f8a791a0ae4a8ed9f45", "message": "actually remove the old method", "committedDate": "2020-04-01T19:47:53Z", "type": "commit"}, {"oid": "5f1f13d55785df4e2b51c385575c55c94399deca", "url": "https://github.com/elastic/elasticsearch/commit/5f1f13d55785df4e2b51c385575c55c94399deca", "message": "Merge branch 'master' into refactor_license7", "committedDate": "2020-04-01T19:59:04Z", "type": "commit"}, {"oid": "b451ef97f28a066811e5b365c69e5235cd67f83b", "url": "https://github.com/elastic/elasticsearch/commit/b451ef97f28a066811e5b365c69e5235cd67f83b", "message": "Merge branch 'master' into refactor_license7", "committedDate": "2020-04-02T19:11:03Z", "type": "commit"}, {"oid": "40da1fbdcc7733d28eaf27e2c1eb5471df479865", "url": "https://github.com/elastic/elasticsearch/commit/40da1fbdcc7733d28eaf27e2c1eb5471df479865", "message": "Merge branch 'master' into refactor_license7", "committedDate": "2020-04-06T22:26:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI0MjU1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/54547#discussion_r405242559", "bodyText": "We briefly chatted about this elsewhere but in this test class security should always be enabled so I think that this should no longer be in a loop over internal state but just go ahead and call enableLicensing(OperationMode.BASIC)", "author": "jaymode", "createdAt": "2020-04-08T03:50:07Z", "path": "x-pack/plugin/security/src/test/java/org/elasticsearch/license/LicensingTests.java", "diffHunk": "@@ -245,7 +245,7 @@ private void disableLicensing() throws Exception {\n         // wait for things to stabilize!\n         assertBusy(() -> {\n             for (XPackLicenseState licenseState : internalCluster().getInstances(XPackLicenseState.class)) {\n-                if (licenseState.isAuthAllowed() == false) {\n+                if (licenseState.isSecurityEnabled() == false) {", "originalCommit": "40da1fbdcc7733d28eaf27e2c1eb5471df479865", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1a9af8e6f72eaebbbbdaf6a45ee072b63a3909f4", "url": "https://github.com/elastic/elasticsearch/commit/1a9af8e6f72eaebbbbdaf6a45ee072b63a3909f4", "message": "remove no longer relevant test", "committedDate": "2020-04-08T06:15:42Z", "type": "commit"}, {"oid": "145ffb85c91dabe99a10251df7fad6ff797fb19d", "url": "https://github.com/elastic/elasticsearch/commit/145ffb85c91dabe99a10251df7fad6ff797fb19d", "message": "Merge branch 'master' into refactor_license7", "committedDate": "2020-04-08T17:07:10Z", "type": "commit"}, {"oid": "81b97044ae8b18ff0dd11f85f9b79908095a0abd", "url": "https://github.com/elastic/elasticsearch/commit/81b97044ae8b18ff0dd11f85f9b79908095a0abd", "message": "remove unused imports", "committedDate": "2020-04-08T17:08:00Z", "type": "commit"}]}