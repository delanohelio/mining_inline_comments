{"pr_number": 58513, "pr_title": "[DOCS] Update snapshot/restore and SLM docs for data streams", "pr_createdAt": "2020-06-24T19:30:19Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/58513", "timeline": [{"oid": "30b1767393fdb7de1744a4863b11b977c4b48332", "url": "https://github.com/elastic/elasticsearch/commit/30b1767393fdb7de1744a4863b11b977c4b48332", "message": "[DOCS] Update snapshot/restore and SLM docs for data streams\n\nUpdates the existing snapshot/restore and SLM docs to make them\naware of data streams.", "committedDate": "2020-06-24T19:28:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTEzMjU2NA==", "url": "https://github.com/elastic/elasticsearch/pull/58513#discussion_r445132564", "bodyText": "Nit: It's either both singular restored-log and .ds-restored-log-000005 or both plural.", "author": "danhermann", "createdAt": "2020-06-24T19:49:47Z", "path": "docs/reference/snapshot-restore/restore-snapshot.asciidoc", "diffHunk": "@@ -29,23 +25,57 @@ A snapshot can be restored using the following command:\n POST /_snapshot/my_backup/snapshot_1/_restore\n -----------------------------------\n \n-By default, all indices in the snapshot are restored, and the cluster state is\n-*not* restored. It's possible to select indices that should be restored as well\n+By default, all data streams and indices in the snapshot are restored, but the cluster state is\n+*not* restored. It's possible to select specific data streams or indices that should be restored as well\n as to allow the global cluster state from being restored by using `indices` and\n-`include_global_state` options in the restore request body. The list of indices\n-supports <<multi-index,multi index syntax>>. The `rename_pattern`\n-and `rename_replacement` options can be also used to rename indices on restore\n+`include_global_state` options in the restore request body. The list\n+supports <<multi-index,multi index syntax>>.\n+\n+[WARNING]\n+====\n+Each data stream requires an associated\n+<<create-a-data-stream-template,composable template>>. The stream uses this\n+template to create new backing indices.\n+\n+When restoring a data stream, ensure a matching template exists for the stream.\n+You can do this using one of the following methods:\n+\n+* Check for existing templates that match the stream. If no matching template\n+  exists, <<create-a-data-stream-template,create one>>.\n+\n+* Restore a global cluster state that includes a matching template for the\n+  stream.\n+\n+If no composable template matches a data stream, the stream cannot\n+<<manually-roll-over-a-data-stream,roll over>> or create new backing indices.\n+====\n+\n+The `rename_pattern`\n+and `rename_replacement` options can be also used to rename data streams and indices on restore\n using regular expression that supports referencing the original text as\n explained\n http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html#appendReplacement(java.lang.StringBuffer,%20java.lang.String)[here].\n+\n+If you rename a restored data stream, its backing indices are also\n+renamed. For example, if you rename the `logs` data stream to `restored-log`,\n+the backing index `.ds-logs-000005` is renamed to `.ds-restored-logs-000005`.", "originalCommit": "30b1767393fdb7de1744a4863b11b977c4b48332", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTE0MjUzNg==", "url": "https://github.com/elastic/elasticsearch/pull/58513#discussion_r445142536", "bodyText": "Thanks for catching this. Fixed.", "author": "jrodewig", "createdAt": "2020-06-24T20:08:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTEzMjU2NA=="}], "type": "inlineReview"}, {"oid": "7c565602c565e21a00920519c3532050618726f8", "url": "https://github.com/elastic/elasticsearch/commit/7c565602c565e21a00920519c3532050618726f8", "message": "Fix typo", "committedDate": "2020-06-24T20:07:48Z", "type": "commit"}, {"oid": "a920cf21c013b471fa3bf6572ba2f9461ca41234", "url": "https://github.com/elastic/elasticsearch/commit/a920cf21c013b471fa3bf6572ba2f9461ca41234", "message": "Swap composable template refs", "committedDate": "2020-06-25T19:27:50Z", "type": "commit"}, {"oid": "933529f85f3f7b4916a036dd73bfda50df29bc7d", "url": "https://github.com/elastic/elasticsearch/commit/933529f85f3f7b4916a036dd73bfda50df29bc7d", "message": "[DOCS] Update ILM restore guidance for data streams", "committedDate": "2020-06-26T14:16:26Z", "type": "commit"}, {"oid": "7f6d51b17ef06a218e3137480ab9e26cb19d0c87", "url": "https://github.com/elastic/elasticsearch/commit/7f6d51b17ef06a218e3137480ab9e26cb19d0c87", "message": "Change multi-index to multi-target", "committedDate": "2020-06-29T19:42:14Z", "type": "commit"}, {"oid": "89b35c9d736653e4628defc3e38c91455085b32b", "url": "https://github.com/elastic/elasticsearch/commit/89b35c9d736653e4628defc3e38c91455085b32b", "message": "s/associated/matching/", "committedDate": "2020-06-30T15:15:42Z", "type": "commit"}, {"oid": "15762dcc4e46ad3af99099fe741dbc7f9da9db63", "url": "https://github.com/elastic/elasticsearch/commit/15762dcc4e46ad3af99099fe741dbc7f9da9db63", "message": "Merge remote-tracking branch 'upstream/master' into docs__snapshot-restore-ds", "committedDate": "2020-06-30T21:10:52Z", "type": "commit"}]}