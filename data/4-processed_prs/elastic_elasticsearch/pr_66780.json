{"pr_number": 66780, "pr_title": "Don't require DocumentMapper as an argument when parsing a document", "pr_createdAt": "2020-12-23T13:06:42Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/66780", "timeline": [{"oid": "5e8ca79c575e32b5ac7dacafb4985fec09bee516", "url": "https://github.com/elastic/elasticsearch/commit/5e8ca79c575e32b5ac7dacafb4985fec09bee516", "message": "Don't require DocumentMapper as an argument when parsing a document\n\nCurrently, an incoming document is parsed through `DocumentMapper#parse`, which in turns calls `DocumentParser#parseDocument` providing `this` among other arguments. As part of the effort to reduce usages of `DocumentMapper` when possible, as it represents the mutable side of mappings (through mappings updates) and involves complexity, we can carry around only the needed components. This does add some required arguments to `DocumentParser#parseDocument` , though it makes dependencies clearer. This change does not affect end consumers as they all go through DocumentMapper anyways, but by not needed to provide DocumentMapper to parseDocument, we may be able to unblock further improvements down the line.\n\nRelates to #66295", "committedDate": "2020-12-23T13:01:32Z", "type": "commit"}, {"oid": "e7fe9a72788334688188fa3a73db4f4b809b573b", "url": "https://github.com/elastic/elasticsearch/commit/e7fe9a72788334688188fa3a73db4f4b809b573b", "message": "iter", "committedDate": "2020-12-23T13:44:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIzNTA5Mw==", "url": "https://github.com/elastic/elasticsearch/pull/66780#discussion_r551235093", "bodyText": "Can you revert the import changes? They'll get changed back next time somebody with different settings edits the file and it just adds noise.", "author": "romseygeek", "createdAt": "2021-01-04T10:33:40Z", "path": "modules/percolator/src/test/java/org/elasticsearch/percolator/CandidateQueryTests.java", "diffHunk": "@@ -19,6 +19,23 @@\n \n package org.elasticsearch.percolator;\n \n+import static org.elasticsearch.common.network.InetAddresses.forString;", "originalCommit": "e7fe9a72788334688188fa3a73db4f4b809b573b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTI0NTk2NQ==", "url": "https://github.com/elastic/elasticsearch/pull/66780#discussion_r551245965", "bodyText": "I am trying to figure out what is going on. I think I configured the formatter based on our formatting file, and since then imports order get automatically adjusted. Not loving it either in projects where we don't yet auto-format files.", "author": "javanna", "createdAt": "2021-01-04T10:54:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIzNTA5Mw=="}], "type": "inlineReview"}, {"oid": "ffe66373468d945e547a5f9ff8e9909bca766139", "url": "https://github.com/elastic/elasticsearch/commit/ffe66373468d945e547a5f9ff8e9909bca766139", "message": "Merge branch 'master' into refactoring/untangle_doc_parser_doc_mapper", "committedDate": "2021-01-04T10:54:44Z", "type": "commit"}, {"oid": "42f0b0978afbe00702a8ea94525e56e456f40920", "url": "https://github.com/elastic/elasticsearch/commit/42f0b0978afbe00702a8ea94525e56e456f40920", "message": "Restore imports order", "committedDate": "2021-01-04T10:59:12Z", "type": "commit"}, {"oid": "bc2acf4a93dcce3dcbd797b71de647a7426a9ee1", "url": "https://github.com/elastic/elasticsearch/commit/bc2acf4a93dcce3dcbd797b71de647a7426a9ee1", "message": "Merge branch 'master' into refactoring/untangle_doc_parser_doc_mapper", "committedDate": "2021-01-04T11:32:23Z", "type": "commit"}]}