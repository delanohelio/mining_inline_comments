{"pr_number": 60447, "pr_title": "Fix SimpleKdcLdapServerTests by overriding java.locale.providers", "pr_createdAt": "2020-07-30T11:38:46Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/60447", "timeline": [{"oid": "f745884a2fd1ea17f7e5f08a80fbca13b40a720c", "url": "https://github.com/elastic/elasticsearch/commit/f745884a2fd1ea17f7e5f08a80fbca13b40a720c", "message": "Fix SimpleKdcLdapServerTests by overriding java.locale.providers\n\nEnsure date digits are always represented as ASCII chars.", "committedDate": "2020-07-30T11:30:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk1ODQ2Mw==", "url": "https://github.com/elastic/elasticsearch/pull/60447#discussion_r462958463", "bodyText": "what would happen with jdk8 ? COMPAT is not known there. as per http://hg.openjdk.java.net/jdk8/jdk8/jdk/file/687fd7c7986d/src/share/classes/sun/util/locale/provider/LocaleProviderAdapter.java#l135 it should throw some exceptions (although when I tried to reproduce it it did not fail)\ncan we make this conditional?\nAlso, do we need SPI there? SPI options is not used in 6.8 by ES as we do not provide IsoCalendarProvider (because SPIs have to be shipped with jre)", "author": "pgomulka", "createdAt": "2020-07-30T12:25:22Z", "path": "x-pack/qa/evil-tests/build.gradle", "diffHunk": "@@ -6,6 +6,7 @@ dependencies {\n }\n \n unitTest {\n+    systemProperty 'java.locale.providers','SPI,COMPAT'", "originalCommit": "f745884a2fd1ea17f7e5f08a80fbca13b40a720c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk2MDgwNA==", "url": "https://github.com/elastic/elasticsearch/pull/60447#discussion_r462960804", "bodyText": "Sorry I forgot that we talked about this. I'll make it conditional for java 9 and later.\nAs for SPI, you are right that it is not needed here, I am adding it here with the attempt to be consistent with:\n\n  \n    \n      elasticsearch/gradle/ide.gradle\n    \n    \n        Lines 74 to 76\n      in\n      0299031\n    \n    \n    \n    \n\n        \n          \n           defaults(JUnit) { \n        \n\n        \n          \n             vmParameters = '-ea -Djava.locale.providers=SPI,COMPAT' \n        \n\n        \n          \n           }", "author": "ywangd", "createdAt": "2020-07-30T12:29:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mjk1ODQ2Mw=="}], "type": "inlineReview"}, {"oid": "2174fd0d7d44fe9cbebe8b46f7505700da99d173", "url": "https://github.com/elastic/elasticsearch/commit/2174fd0d7d44fe9cbebe8b46f7505700da99d173", "message": "Address feedback", "committedDate": "2020-07-30T12:36:50Z", "type": "commit"}, {"oid": "2ecf834cbc1e789ce1e5a4047f7f4e6767355be4", "url": "https://github.com/elastic/elasticsearch/commit/2ecf834cbc1e789ce1e5a4047f7f4e6767355be4", "message": "Checkstyle", "committedDate": "2020-07-30T13:45:16Z", "type": "commit"}]}