{"pr_number": 50573, "pr_title": "Use Void context on parsers where possible", "pr_createdAt": "2020-01-02T20:38:42Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/50573", "timeline": [{"oid": "adc5ce0a9c95b9efb2bb14f1ae8ed370be6b92d6", "url": "https://github.com/elastic/elasticsearch/commit/adc5ce0a9c95b9efb2bb14f1ae8ed370be6b92d6", "message": "Use Void context on parsers where possible\n\n*Most* of our parsing can be done without passing any extra context into\nthe parser that isn't already part of the xcontent stream. While I was\nlooking around at the places that *do* need a context I found a few\nplaces that were declared to need a context but don't actually need it.", "committedDate": "2020-01-02T20:35:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjYyMTU4OA==", "url": "https://github.com/elastic/elasticsearch/pull/50573#discussion_r362621588", "bodyText": "These two changes are required because we can't pass the context that is required for HITS_PARSER down to the throwable or shards parser.", "author": "nik9000", "createdAt": "2020-01-02T20:39:35Z", "path": "modules/reindex/src/main/java/org/elasticsearch/index/reindex/remote/RemoteResponseParsers.java", "diffHunk": "@@ -196,20 +196,20 @@ private RemoteResponseParsers() {}\n                 return new Response(timedOut, failures, totalHits, hits, scroll);\n             });\n     static {\n-        RESPONSE_PARSER.declareObject(optionalConstructorArg(), ThrowableBuilder.PARSER::apply, new ParseField(\"error\"));\n+        RESPONSE_PARSER.declareObject(optionalConstructorArg(), (p, c) -> ThrowableBuilder.PARSER.apply(p, null), new ParseField(\"error\"));\n         RESPONSE_PARSER.declareBoolean(optionalConstructorArg(), new ParseField(\"timed_out\"));\n         RESPONSE_PARSER.declareString(optionalConstructorArg(), new ParseField(\"_scroll_id\"));\n         RESPONSE_PARSER.declareObject(optionalConstructorArg(), HITS_PARSER, new ParseField(\"hits\"));\n-        RESPONSE_PARSER.declareObject(optionalConstructorArg(), SHARDS_PARSER, new ParseField(\"_shards\"));\n+        RESPONSE_PARSER.declareObject(optionalConstructorArg(), (p, c) -> SHARDS_PARSER.apply(p, null), new ParseField(\"_shards\"));", "originalCommit": "adc5ce0a9c95b9efb2bb14f1ae8ed370be6b92d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY3MTc3MA==", "url": "https://github.com/elastic/elasticsearch/pull/50573#discussion_r362671770", "bodyText": "thanks for highlighting this", "author": "talevy", "createdAt": "2020-01-02T23:49:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjYyMTU4OA=="}], "type": "inlineReview"}, {"oid": "643e302e6b73614c429b04191f557ec50358bcbb", "url": "https://github.com/elastic/elasticsearch/commit/643e302e6b73614c429b04191f557ec50358bcbb", "message": "Compiler, you are so good to me.", "committedDate": "2020-01-02T20:54:26Z", "type": "commit"}, {"oid": "94dc371ec9858261b7bb268d2333cca31f192c73", "url": "https://github.com/elastic/elasticsearch/commit/94dc371ec9858261b7bb268d2333cca31f192c73", "message": "And checkstyle", "committedDate": "2020-01-02T21:38:52Z", "type": "commit"}, {"oid": "4cbd77bd935fa2474ff799a46937c5e4aec7b4c7", "url": "https://github.com/elastic/elasticsearch/commit/4cbd77bd935fa2474ff799a46937c5e4aec7b4c7", "message": "Merge branch 'master' into parser_context_fixup", "committedDate": "2020-01-03T16:06:28Z", "type": "commit"}]}