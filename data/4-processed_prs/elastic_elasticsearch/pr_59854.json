{"pr_number": 59854, "pr_title": "Introduce reserved_ml_apm_user kibana privilege", "pr_createdAt": "2020-07-20T11:52:27Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/59854", "timeline": [{"oid": "58cac9d7de24aed90c0b171e3c13dfd1d2e3992d", "url": "https://github.com/elastic/elasticsearch/commit/58cac9d7de24aed90c0b171e3c13dfd1d2e3992d", "message": "introduce reserved_ml_apm_user kibana privilege", "committedDate": "2020-07-20T11:51:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYyOTQwNQ==", "url": "https://github.com/elastic/elasticsearch/pull/59854#discussion_r457629405", "bodyText": "Clarifying question since I'm not familiar with \"reserved\" privileges: I couldn't find reserved_ml_apm_user in elastic/kibana#72266 but I did find ml_apm_user. Is reserved_  an implied prefix somehow?", "author": "sqren", "createdAt": "2020-07-20T19:05:43Z", "path": "x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStore.java", "diffHunk": "@@ -183,7 +183,10 @@\n                             .privileges(\"read\", \"view_index_metadata\").build(),\n                         RoleDescriptor.IndicesPrivileges.builder().indices(\"observability-annotations\")\n                             .privileges(\"read\", \"view_index_metadata\").build()\n-                    }, null, MetadataUtils.DEFAULT_RESERVED_METADATA))\n+                    }, new RoleDescriptor.ApplicationResourcePrivileges[] {\n+                            RoleDescriptor.ApplicationResourcePrivileges.builder()\n+                                .application(\"kibana-*\").resources(\"*\").privileges(\"reserved_ml_apm_user\").build()", "originalCommit": "58cac9d7de24aed90c0b171e3c13dfd1d2e3992d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYzODA2OA==", "url": "https://github.com/elastic/elasticsearch/pull/59854#discussion_r457638068", "bodyText": "Good question. Yes, the reserved_ prefix is generated by Kibana's security plugin when it \"serializes\" our privilege model into Elasticsearch's Application Privilege model:\nhttps://github.com/elastic/kibana/blob/bf04235dae35452061cc7ea3d86d96c19a58206c/x-pack/plugins/security/server/authorization/privilege_serializer.ts#L61", "author": "legrego", "createdAt": "2020-07-20T19:21:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYyOTQwNQ=="}], "type": "inlineReview"}]}