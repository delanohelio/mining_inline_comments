{"pr_number": 52510, "pr_title": "Rename .ml-state index to .ml-state-000001 to support rollover", "pr_createdAt": "2020-02-19T12:07:17Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52510", "timeline": [{"oid": "d617f09a9531fe503bc36bcafe4e5d3e369f0966", "url": "https://github.com/elastic/elasticsearch/commit/d617f09a9531fe503bc36bcafe4e5d3e369f0966", "message": "Create .ml-state-000001 index instead of .ml-state", "committedDate": "2020-02-19T13:10:33Z", "type": "forcePushed"}, {"oid": "c2099728cb881ecc92d000206089cc478e768825", "url": "https://github.com/elastic/elasticsearch/commit/c2099728cb881ecc92d000206089cc478e768825", "message": "Create .ml-state-000001 index instead of .ml-state", "committedDate": "2020-02-19T13:12:41Z", "type": "forcePushed"}, {"oid": "ca1917b01ddf1735dd2a2c88423611fbc1a6cd35", "url": "https://github.com/elastic/elasticsearch/commit/ca1917b01ddf1735dd2a2c88423611fbc1a6cd35", "message": "Create .ml-state-000001 index instead of .ml-state", "committedDate": "2020-02-19T18:25:32Z", "type": "forcePushed"}, {"oid": "1f9eb98a6a6936fd16baaa5e49e5d317abc05714", "url": "https://github.com/elastic/elasticsearch/commit/1f9eb98a6a6936fd16baaa5e49e5d317abc05714", "message": "Create .ml-state-000001 index instead of .ml-state", "committedDate": "2020-02-19T20:42:23Z", "type": "forcePushed"}, {"oid": "b2e6c55c5e378959d49f782474160e913bc08966", "url": "https://github.com/elastic/elasticsearch/commit/b2e6c55c5e378959d49f782474160e913bc08966", "message": "Create .ml-state-000001 index instead of .ml-state", "committedDate": "2020-02-20T12:31:29Z", "type": "forcePushed"}, {"oid": "d23e256b97046f78e1fc5cb30e345314eb54f8a8", "url": "https://github.com/elastic/elasticsearch/commit/d23e256b97046f78e1fc5cb30e345314eb54f8a8", "message": "Create .ml-state-000001 index instead of .ml-state", "committedDate": "2020-02-20T12:38:26Z", "type": "commit"}, {"oid": "d23e256b97046f78e1fc5cb30e345314eb54f8a8", "url": "https://github.com/elastic/elasticsearch/commit/d23e256b97046f78e1fc5cb30e345314eb54f8a8", "message": "Create .ml-state-000001 index instead of .ml-state", "committedDate": "2020-02-20T12:38:26Z", "type": "forcePushed"}, {"oid": "44172d3cbcfcb50f475c99c3b8a175e625090bf8", "url": "https://github.com/elastic/elasticsearch/commit/44172d3cbcfcb50f475c99c3b8a175e625090bf8", "message": "Fix BWC tests", "committedDate": "2020-02-20T13:25:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAyNTU5NA==", "url": "https://github.com/elastic/elasticsearch/pull/52510#discussion_r382025594", "bodyText": "Please can you create this with realistic mappings and settings.  Something like:\n  \"settings\" : {\n    \"index\" : {\n      \"auto_expand_replicas\" : \"0-1\"\n    }\n  },\n  \"mappings\" : {\n    \"_doc\": {\n      \"_meta\": {\n        \"version\": \"7.0.0\"\n      },\n      \"enabled\": false\n    }\n  }", "author": "droberts195", "createdAt": "2020-02-20T14:17:00Z", "path": "x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/old_cluster/30_ml_jobs_crud.yml", "diffHunk": "@@ -1,3 +1,8 @@\n+setup:\n+  - do:\n+      indices.create:\n+        index: .ml-state", "originalCommit": "d2fe800d792aadf5e2b887bd8568517a2148cce4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MDEyOQ==", "url": "https://github.com/elastic/elasticsearch/pull/52510#discussion_r382050129", "bodyText": "Aren't these settings going to be inherited from the template?\nx-pack/plugin/core/src/main/resources/org/elasticsearch/xpack/core/ml/anomalydetection/state_index_template.json\nLet me verify that.", "author": "przemekwitek", "createdAt": "2020-02-20T14:54:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAyNTU5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA1MDY3MA==", "url": "https://github.com/elastic/elasticsearch/pull/52510#discussion_r382050670", "bodyText": "Oh yes, good point", "author": "droberts195", "createdAt": "2020-02-20T14:55:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAyNTU5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjA3MzY3OQ==", "url": "https://github.com/elastic/elasticsearch/pull/52510#discussion_r382073679", "bodyText": "Aren't these settings going to be inherited from the template?\nx-pack/plugin/core/src/main/resources/org/elasticsearch/xpack/core/ml/anomalydetection/state_index_template.json\nLet me verify that.\n\nConfirmed, the settings are picked up from the template.\nNow, I'm going to make these tests pass.", "author": "przemekwitek", "createdAt": "2020-02-20T15:29:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjAyNTU5NA=="}], "type": "inlineReview"}, {"oid": "213ea47c572f12a90e952a1514c7906a4ee8d30e", "url": "https://github.com/elastic/elasticsearch/commit/213ea47c572f12a90e952a1514c7906a4ee8d30e", "message": "Create .ml-state index in the setup phase of BWC tests", "committedDate": "2020-02-20T15:28:17Z", "type": "commit"}, {"oid": "213ea47c572f12a90e952a1514c7906a4ee8d30e", "url": "https://github.com/elastic/elasticsearch/commit/213ea47c572f12a90e952a1514c7906a4ee8d30e", "message": "Create .ml-state index in the setup phase of BWC tests", "committedDate": "2020-02-20T15:28:17Z", "type": "forcePushed"}, {"oid": "98cc582b696ae3517237f683799a47f59b0699d3", "url": "https://github.com/elastic/elasticsearch/commit/98cc582b696ae3517237f683799a47f59b0699d3", "message": "Make index creation idempotent", "committedDate": "2020-02-20T16:14:18Z", "type": "commit"}]}