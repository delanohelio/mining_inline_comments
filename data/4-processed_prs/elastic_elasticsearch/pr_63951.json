{"pr_number": 63951, "pr_title": "Add a test for regex usage to runtime fields", "pr_createdAt": "2020-10-20T17:08:11Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/63951", "timeline": [{"oid": "d80acc0f89f507ef59dd36312a4ab80818424868", "url": "https://github.com/elastic/elasticsearch/commit/d80acc0f89f507ef59dd36312a4ab80818424868", "message": "Add a test for regex usage to runtime fields\n\nNow that we've got regexes enabled by default (#63029) this adds a test\nto runtime fields just to make sure that it works with regexes. It does,\nbut this adds a test to make sure it continues to work.", "committedDate": "2020-10-20T17:07:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODc2MDYwOQ==", "url": "https://github.com/elastic/elasticsearch/pull/63951#discussion_r508760609", "bodyText": "out of curiosity, what happens when matches returns false for a doc? the runtime field wont have any value thats it?", "author": "javanna", "createdAt": "2020-10-20T18:46:00Z", "path": "x-pack/plugin/src/test/resources/rest-api-spec/test/runtime_fields/50_ip.yml", "diffHunk": "@@ -18,18 +18,20 @@ setup:\n                 runtime_type: ip\n                 script:\n                   source: |\n-                    String m = doc[\"message\"].value;\n-                    int end = m.indexOf(\" \");\n-                    emit(m.substring(0, end));\n+                    Matcher m = /([^ ]+) .+/.matcher(doc[\"message\"].value);\n+                    if (m.matches()) {\n+                      emit(m.group(1));\n+                    }", "originalCommit": "d80acc0f89f507ef59dd36312a4ab80818424868", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}