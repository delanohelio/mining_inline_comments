{"pr_number": 52858, "pr_title": "Fix cacheability of repository-hdfs integ tests", "pr_createdAt": "2020-02-27T00:32:35Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52858", "timeline": [{"oid": "a4df64b3b51f6577b8d702a0654d92d6b5c0a176", "url": "https://github.com/elastic/elasticsearch/commit/a4df64b3b51f6577b8d702a0654d92d6b5c0a176", "message": "Fix cacheability of repository-hdfs integ tests\n\nSigned-off-by: Mark Vieira <portugee@gmail.com>", "committedDate": "2020-02-27T00:19:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDg3NTI5Ng==", "url": "https://github.com/elastic/elasticsearch/pull/52858#discussion_r384875296", "bodyText": "not hugely important, but the path here will be \"${workingDir}/ports/ports\" right? Maybe name the file \"hdfsPorts\" or something like that", "author": "rjernst", "createdAt": "2020-02-27T02:05:07Z", "path": "plugins/repository-hdfs/build.gradle", "diffHunk": "@@ -152,20 +152,29 @@ for (String integTestTaskName : ['integTestHa', 'integTestSecure', 'integTestSec\n     runner {\n       onlyIf { BuildParams.inFipsJvm == false }\n       if (integTestTaskName.contains(\"Ha\")) {\n+        Path portsFile\n+        File portsFileDir = file(\"${workingDir}/ports\")\n         if (integTestTaskName.contains(\"Secure\")) {\n-          Path path = buildDir.toPath()\n+          portsFile = buildDir.toPath()\n             .resolve(\"fixtures\")\n             .resolve(\"secureHaHdfsFixture\")\n             .resolve(\"ports\")\n-          nonInputProperties.systemProperty \"test.hdfs-fixture.ports\", path\n         } else {\n-          Path path = buildDir.toPath()\n+          portsFile = buildDir.toPath()\n             .resolve(\"fixtures\")\n             .resolve(\"haHdfsFixture\")\n             .resolve(\"ports\")\n-          nonInputProperties.systemProperty \"test.hdfs-fixture.ports\", path\n         }\n-        classpath += files(\"$buildDir/fixtures\")\n+        nonInputProperties.systemProperty \"test.hdfs-fixture.ports\", file(\"$portsFileDir/ports\")", "originalCommit": "a4df64b3b51f6577b8d702a0654d92d6b5c0a176", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTIwOTQwNw==", "url": "https://github.com/elastic/elasticsearch/pull/52858#discussion_r385209407", "bodyText": "I've renamed this directory hdfsFixture to be most accurate.", "author": "mark-vieira", "createdAt": "2020-02-27T16:09:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDg3NTI5Ng=="}], "type": "inlineReview"}, {"oid": "f138b77593d686878a68311319378d483bcf8d91", "url": "https://github.com/elastic/elasticsearch/commit/f138b77593d686878a68311319378d483bcf8d91", "message": "Use better name for fixture resources dir\n\nSigned-off-by: Mark Vieira <portugee@gmail.com>", "committedDate": "2020-02-27T16:09:15Z", "type": "commit"}]}