{"pr_number": 55071, "pr_title": "[DOCS] EQL: Document `indexOf` function", "pr_createdAt": "2020-04-10T15:35:21Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/55071", "timeline": [{"oid": "c57e11c7b12c8baa06da553156f7c065b08d8021", "url": "https://github.com/elastic/elasticsearch/commit/c57e11c7b12c8baa06da553156f7c065b08d8021", "message": "[DOCS] EQL: Document `indexOf` function", "committedDate": "2020-04-10T15:33:10Z", "type": "commit"}, {"oid": "ff34add2acda85fb6eff6c7316c6f342f52dafa8", "url": "https://github.com/elastic/elasticsearch/commit/ff34add2acda85fb6eff6c7316c6f342f52dafa8", "message": "spacing", "committedDate": "2020-04-14T17:23:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY3NjM4Ng==", "url": "https://github.com/elastic/elasticsearch/pull/55071#discussion_r408676386", "bodyText": "Could you add an example with a negative offset?", "author": "astefan", "createdAt": "2020-04-15T08:39:47Z", "path": "docs/reference/eql/functions.asciidoc", "diffHunk": "@@ -207,6 +208,110 @@ field datatypes:\n *Returns:* boolean or `null`\n ====\n \n+[discrete]\n+[[eql-fn-indexof]]\n+=== `indexOf`\n+\n+Returns the first position of a provided substring in a source string.\n+\n+If an optional start position is provided, this function returns the first\n+occurrence of the substring at or after the start position.\n+\n+[%collapsible]\n+====\n+*Example*\n+[source,eql]\n+----\n+// url.domain = \"subdomain.example.com\"\n+indexOf(url.domain, \".\")        // returns 9\n+indexOf(url.domain, \".\", 9)     // returns 9\n+indexOf(url.domain, \".\", 10)    // returns 17\n+\n+// empty strings\n+indexOf(\"\", \"\")                 // returns 0\n+indexOf(url.domain, \"\")         // returns 0\n+indexOf(url.domain, \"\", 9)      // returns 9\n+indexOf(url.domain, \"\", 10)     // returns 10\n+\n+// missing substrings\n+indexOf(url.domain, \"z\")        // returns null\n+indexOf(url.domain, \"z\", 9)     // returns null\n+\n+// start position is higher than string length\n+indexOf(url.domain, \".\", 30)    // returns null\n+\n+// null handling\n+indexOf(null, \".\", 9)           // returns null\n+indexOf(url.domain, null, 9)    // returns null\n+indexOf(url.domain, \".\", null)  // returns null\n+----\n+\n+*Syntax*\n+[source,txt]\n+----\n+indexOf(<source>, <substring>[, <start_pos>])\n+----\n+\n+*Parameters*\n+\n+`<source>`::\n++\n+--\n+(Required, string or `null`)\n+Source string. If `null`, the function returns `null`.\n+\n+If using a field as the argument, this parameter supports only the following\n+field datatypes:\n+\n+* <<keyword,`keyword`>>\n+* <<constant-keyword,`constant_keyword`>>\n+* <<text,`text`>> field with a <<keyword,`keyword`>> or\n+  <<constant-keyword,`constant_keyword`>> sub-field\n+--\n+\n+`<substring>`::\n++\n+--\n+(Required, string or `null`)\n+Substring to search for.\n+\n+If this argument is `null` or the `<source>` string does not contain this\n+substring, the function returns `null`. Empty strings (`\"\"`) return the\n+`<start_pos>`, which defaults to `0`.\n+\n+If using a field as the argument, this parameter supports only the following\n+field datatypes:\n+\n+* <<keyword,`keyword`>>\n+* <<constant-keyword,`constant_keyword`>>\n+* <<text,`text`>> field with a <<keyword,`keyword`>> or\n+  <<constant-keyword,`constant_keyword`>> sub-field\n+--\n+\n+`<start_pos>`::\n++\n+--\n+(Optional, integer or `null`)\n+Starting position for matching. The function will not return positions before\n+this one. Defaults to `0`.\n+\n+Positions are zero-indexed. Negative offsets are supported.", "originalCommit": "ff34add2acda85fb6eff6c7316c6f342f52dafa8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODkxNDI5Mg==", "url": "https://github.com/elastic/elasticsearch/pull/55071#discussion_r408914292", "bodyText": "Sure thing. Added some examples with db8e027.", "author": "jrodewig", "createdAt": "2020-04-15T15:04:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY3NjM4Ng=="}], "type": "inlineReview"}, {"oid": "db8e02720319fd6d61d9bcfbb00321fa612be58b", "url": "https://github.com/elastic/elasticsearch/commit/db8e02720319fd6d61d9bcfbb00321fa612be58b", "message": "Add negative offset examples", "committedDate": "2020-04-15T15:03:38Z", "type": "commit"}, {"oid": "384617a240ba1b78b32c473b98b5af35e29f2f70", "url": "https://github.com/elastic/elasticsearch/commit/384617a240ba1b78b32c473b98b5af35e29f2f70", "message": "Clarify behavior for negative offsets", "committedDate": "2020-04-15T15:10:06Z", "type": "commit"}, {"oid": "5b8e160d077946e5c6a1c6b43bfbd5f26608b532", "url": "https://github.com/elastic/elasticsearch/commit/5b8e160d077946e5c6a1c6b43bfbd5f26608b532", "message": "Reword", "committedDate": "2020-04-15T15:13:16Z", "type": "commit"}]}