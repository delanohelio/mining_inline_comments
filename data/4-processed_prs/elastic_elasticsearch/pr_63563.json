{"pr_number": 63563, "pr_title": "[DOCS] Adds AUC ROC classification metric to the API examples", "pr_createdAt": "2020-10-12T14:14:19Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/63563", "timeline": [{"oid": "83dfef7c790fc1c012fcc568343a02ff73e42e74", "url": "https://github.com/elastic/elasticsearch/commit/83dfef7c790fc1c012fcc568343a02ff73e42e74", "message": "[DOCS] Adds AUC ROC classification metric to the API examples.", "committedDate": "2020-10-12T14:10:11Z", "type": "commit"}, {"oid": "9027452e7f246fb50707a3180a4c380546063bbb", "url": "https://github.com/elastic/elasticsearch/commit/9027452e7f246fb50707a3180a4c380546063bbb", "message": "[DOCS] Minor edits.", "committedDate": "2020-10-12T14:13:39Z", "type": "commit"}, {"oid": "dbc38085d6cb436b6343fabfea024ab6f035f9b6", "url": "https://github.com/elastic/elasticsearch/commit/dbc38085d6cb436b6343fabfea024ab6f035f9b6", "message": "[DOCS] Adds console-result flag to result snippet.", "committedDate": "2020-10-12T14:18:47Z", "type": "commit"}, {"oid": "50933371d24a2303c989874f2d1cb187aed4831b", "url": "https://github.com/elastic/elasticsearch/commit/50933371d24a2303c989874f2d1cb187aed4831b", "message": "[DOCS] Changes index name.", "committedDate": "2020-10-12T15:04:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczNTU5Mw==", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503735593", "bodyText": "With #63302, doc_count is no longer reported.\nPlease remove.", "author": "przemekwitek", "createdAt": "2020-10-13T07:44:57Z", "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "diffHunk": "@@ -497,3 +497,55 @@ predictions associated with the class.\n <5> The number of cats in the dataset that are incorrectly classified as dogs.\n <6> The number of documents that are classified as a class that is not listed as \n a `predicted_class`.\n+\n+\n+\n+[source,console]\n+--------------------------------------------------\n+POST _ml/data_frame/_evaluate\n+{\n+   \"index\": \"animal_classification\",\n+   \"evaluation\": {\n+      \"classification\": { <1>\n+         \"actual_field\": \"animal_class\", <2>\n+         \"predicted_field\": \"ml.animal_class_prediction\", <3>\n+         \"metrics\": {\n+            \"auc_roc\" : { <4>\n+              \"class_name\": \"dog\" <5>\n+            }\n+         }\n+      }\n+   }\n+}\n+--------------------------------------------------\n+// TEST[skip:TBD]\n+\n+<1> The evaluation type.\n+<2> The field that contains the ground truth value for the actual animal \n+classification. This is required in order to evaluate results.\n+<3> The field that contains the predicted value for animal classification by \n+the {classanalysis}.\n+<4> Specifies the metric for the evaluation.\n+<5> Specifies the class name that is treated as positive during the evaluation, \n+all the other classes are treated as negative.\n+\n+\n+The API returns the following result:\n+\n+[source,console-result]\n+--------------------------------------------------\n+{\n+  \"classification\" : {\n+    \"auc_roc\" : {\n+      \"score\" : 0.8941788639536681, <1>\n+      \"doc_count\" : 4169 <2>", "originalCommit": "50933371d24a2303c989874f2d1cb187aed4831b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3MDM3MQ==", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503770371", "bodyText": "@przemekwitek Done.", "author": "szabosteve", "createdAt": "2020-10-13T08:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzczNTU5Mw=="}], "type": "inlineReview"}, {"oid": "0052c27f2a354e885a24aed1a7173cee645f578f", "url": "https://github.com/elastic/elasticsearch/commit/0052c27f2a354e885a24aed1a7173cee645f578f", "message": "[DOCS] Removes doc_count from example response.", "committedDate": "2020-10-13T08:36:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3MjczNw==", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503772737", "bodyText": "This field is not used by auc_roc so you can remove it (but please double-check that the example is still working, there may be bugs...).", "author": "przemekwitek", "createdAt": "2020-10-13T08:42:17Z", "path": "docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc", "diffHunk": "@@ -497,3 +497,49 @@ predictions associated with the class.\n <5> The number of cats in the dataset that are incorrectly classified as dogs.\n <6> The number of documents that are classified as a class that is not listed as \n a `predicted_class`.\n+\n+\n+\n+[source,console]\n+--------------------------------------------------\n+POST _ml/data_frame/_evaluate\n+{\n+   \"index\": \"animal_classification\",\n+   \"evaluation\": {\n+      \"classification\": { <1>\n+         \"actual_field\": \"animal_class\", <2>\n+         \"predicted_field\": \"ml.animal_class_prediction\", <3>", "originalCommit": "0052c27f2a354e885a24aed1a7173cee645f578f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3NjMxMw==", "url": "https://github.com/elastic/elasticsearch/pull/63563#discussion_r503776313", "bodyText": "I double-checked, it works fine without predicted_field. I removed this line from the call.", "author": "szabosteve", "createdAt": "2020-10-13T08:47:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3MjczNw=="}], "type": "inlineReview"}, {"oid": "ee1b6bd4e645e6ebe47b3ebbc19ec9a37697b743", "url": "https://github.com/elastic/elasticsearch/commit/ee1b6bd4e645e6ebe47b3ebbc19ec9a37697b743", "message": "[DOCS] Removes predicted_field from example API call.", "committedDate": "2020-10-13T08:46:22Z", "type": "commit"}]}