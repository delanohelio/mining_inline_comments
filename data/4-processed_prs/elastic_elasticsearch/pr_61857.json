{"pr_number": 61857, "pr_title": "Run zulu8 fips CI with BCJSSE instead of SunJSSE", "pr_createdAt": "2020-09-02T14:41:49Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/61857", "timeline": [{"oid": "9d61ec45b7b8a9fa55f765df709ec8b4ccab2a0b", "url": "https://github.com/elastic/elasticsearch/commit/9d61ec45b7b8a9fa55f765df709ec8b4ccab2a0b", "message": "Run zulu8 fips CI with BCJSSE\n\nAs we figured out in\nhttps://github.com/elastic/elasticsearch/issues/61316#issuecomment-685482708\nAzul brings back a lot of changes from JDK 11 to their Zulu8 build\nand this means that we can't run this with SunJSSE in FIPS 140 mode.\n\nThis change ensures that we configure Zulu8 JDK JVMs in FIPS 140\nmode, using the bouncy castle JSSE FIPS provider, instead of the\nSunJSSE one ( as we do for the rest of the java 8 JVMs )\n\nResolves: #61316", "committedDate": "2020-09-02T14:38:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5MTg0Ng==", "url": "https://github.com/elastic/elasticsearch/pull/61857#discussion_r482691846", "bodyText": "Can you please open this as a separate change so it goes to master as well? We should probably also name it like \"runtime jvm details\"?", "author": "rjernst", "createdAt": "2020-09-03T04:10:51Z", "path": "buildSrc/src/main/java/org/elasticsearch/gradle/info/BuildParams.java", "diffHunk": "@@ -89,6 +90,10 @@ public static JavaVersion getRuntimeJavaVersion() {\n         return value(runtimeJavaVersion);\n     }\n \n+    public static String getJvmDetails() {", "originalCommit": "9d61ec45b7b8a9fa55f765df709ec8b4ccab2a0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjczNTUzOQ==", "url": "https://github.com/elastic/elasticsearch/pull/61857#discussion_r482735539", "bodyText": "sure thing, makes sense", "author": "jkakavas", "createdAt": "2020-09-03T06:35:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5MTg0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzMzM3Mw==", "url": "https://github.com/elastic/elasticsearch/pull/61857#discussion_r482933373", "bodyText": "#61901", "author": "jkakavas", "createdAt": "2020-09-03T12:18:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5MTg0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5MjE0MA==", "url": "https://github.com/elastic/elasticsearch/pull/61857#discussion_r482692140", "bodyText": "Is the zulu policy the exact same as the java 11, or a mix of our existing java 11 and java 8 policies?", "author": "rjernst", "createdAt": "2020-09-03T04:11:51Z", "path": "gradle/fips.gradle", "diffHunk": "@@ -9,8 +9,9 @@ if (BuildParams.inFipsJvm) {\n   allprojects {\n     File fipsResourcesDir = new File(project.buildDir, 'fips-resources')\n     boolean java8 = BuildParams.runtimeJavaVersion == JavaVersion.VERSION_1_8\n-    File fipsSecurity = new File(fipsResourcesDir, \"fips_java${java8 ? '8' : ''}.security\")\n-    File fipsPolicy = new File(fipsResourcesDir, \"fips_java${java8 ? '8' : ''}.policy\")\n+    boolean zulu8 = java8 && BuildParams.jvmDetails.contains(\"Zulu\")", "originalCommit": "9d61ec45b7b8a9fa55f765df709ec8b4ccab2a0b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjczNjQyMw==", "url": "https://github.com/elastic/elasticsearch/pull/61857#discussion_r482736423", "bodyText": "The zulu policy and properties are the same as the java 11 with regards to the actual settings and policy rules , but with the format that is applicable for JDK8. Maybe fips_java8 and fips_java_zulu8 are not applicable names here, I will change them to reflect the crypto provider that is in use in each case so that this is clearer", "author": "jkakavas", "createdAt": "2020-09-03T06:37:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5MjE0MA=="}], "type": "inlineReview"}, {"oid": "e8ef389728a492a96c4b8d11d121341bb0df6ed5", "url": "https://github.com/elastic/elasticsearch/commit/e8ef389728a492a96c4b8d11d121341bb0df6ed5", "message": "Address feedback\n\nRename security properties and policy files to reflect the security\nprovider and the JDK version for which they provide configuration", "committedDate": "2020-09-03T12:19:56Z", "type": "commit"}, {"oid": "694d9c031fcc6af188da56a3ad8e454cbdc8e0bb", "url": "https://github.com/elastic/elasticsearch/commit/694d9c031fcc6af188da56a3ad8e454cbdc8e0bb", "message": "Merge remote-tracking branch 'origin/7.x' into fix-zulu8-fips", "committedDate": "2020-09-03T12:21:14Z", "type": "commit"}, {"oid": "d5169793cfa6bb9170f0a689cc0d12af65bf67cf", "url": "https://github.com/elastic/elasticsearch/commit/d5169793cfa6bb9170f0a689cc0d12af65bf67cf", "message": "Merge remote-tracking branch 'origin/7.x' into fix-zulu8-fips", "committedDate": "2020-09-04T08:51:12Z", "type": "commit"}, {"oid": "6c8868b6c3fc8a4a4bb8a385499ab60e85942912", "url": "https://github.com/elastic/elasticsearch/commit/6c8868b6c3fc8a4a4bb8a385499ab60e85942912", "message": "Merge changes from master", "committedDate": "2020-09-04T09:58:02Z", "type": "commit"}]}