{"pr_number": 57691, "pr_title": "[DOCS] Fix source-related search API params", "pr_createdAt": "2020-06-04T17:46:47Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/57691", "timeline": [{"oid": "a60f05cae3ddb9552ff73818bb327a4615c80490", "url": "https://github.com/elastic/elasticsearch/commit/a60f05cae3ddb9552ff73818bb327a4615c80490", "message": "[DOCS] Fix source-related search API params", "committedDate": "2020-06-04T17:43:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg1MjQxMQ==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r436852411", "bodyText": "Small comment, maybe we could say \"You can pass _source: true to return both ...\" instead of saying 'specify a value'.", "author": "jtibshirani", "createdAt": "2020-06-08T16:53:53Z", "path": "docs/reference/search/search.asciidoc", "diffHunk": "@@ -208,6 +228,10 @@ purposes.\n (Optional, string) A comma-separated list of stored fields to return as part\n of a hit. If no fields are specified, no stored fields are included in the\n response.\n++\n+If this field is specified, the `_source` parameter defaults to `false`. You can", "originalCommit": "a60f05cae3ddb9552ff73818bb327a4615c80490", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg1NDQzMg==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r436854432", "bodyText": "This could be interpreted as \"if the _source_includes parameter is set, then this parameter is ignored\", whereas in reality they're both considered. You can use _source_includes and _source_excludes in conjunction with each other to filter down the source.", "author": "jtibshirani", "createdAt": "2020-06-08T16:57:23Z", "path": "docs/reference/rest-api/common-parms.asciidoc", "diffHunk": "@@ -846,14 +846,28 @@ end::source[]\n \n tag::source_excludes[]\n `_source_excludes`::\n-(Optional, string) A list of fields to exclude from the returned `_source`\n-field.\n+(Optional, string)\n+A comma-separated list of <<mapping-source-field,source fields>> to exclude from\n+the response.\n++\n+If the `_source` parameter is not `false` and the `_source_includes` query", "originalCommit": "a60f05cae3ddb9552ff73818bb327a4615c80490", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg1NzMxMQ==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r436857311", "bodyText": "To me we should omit the part \"This does not include ...\", since this section is meant to be a simple API reference. That sentence is more of a 'note' or helpful reminder that the document source does not contain these values (which we already mention in the more detailed/ explanatory 'run a search' reference).", "author": "jtibshirani", "createdAt": "2020-06-08T17:02:26Z", "path": "docs/reference/search/search.asciidoc", "diffHunk": "@@ -192,9 +192,29 @@ value cannot be `0`.\n (Optional, string) A comma-separated list of <field>:<direction> pairs.\n \n `_source`::\n-(Optional, boolean)\n-If `true`, the response includes the `_source` of matching documents under\n-`hits`. Defaults to `true`.\n+(Optional)\n+Indicates which <<mapping-source-field,source fields>> are returned for matching\n+documents. These fields are returned in the `hits._source` property of\n+the search response. Defaults to `true`.\n++\n+.Valid values for `_source`\n+[%collapsible%open]\n+====\n+`true`::\n+(boolean)\n+The entire document source is returned. This does not include:", "originalCommit": "a60f05cae3ddb9552ff73818bb327a4615c80490", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg2MjgxNQ==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r436862815", "bodyText": "I think this should be singular 'pattern'. Also, what would you think of combining these two 'wildcard' sections for simplicity?", "author": "jtibshirani", "createdAt": "2020-06-08T17:11:13Z", "path": "docs/reference/search/search.asciidoc", "diffHunk": "@@ -302,6 +327,58 @@ If the <<search-api-scroll-query-param,`scroll` parameter>> is specified, this\n value cannot be `0`.\n --\n \n+`_source`::\n+(Optional)\n+Indicates which <<mapping-source-field,source fields>> are returned for matching\n+documents. These fields are returned in the `hits._source` property of\n+the search response. Defaults to `true`.\n++\n+.Valid values for `_source`\n+[%collapsible%open]\n+====\n+`true`::\n+(boolean)\n+The entire document source is returned. This does not include:\n+* <<multi-fields,multi-fields>>\n+* <<alias,field aliases>>\n+* Values copied using the <<copy-to,`copy_to`>> mapping parameter\n+\n+`false`::\n+(boolean)\n+The document source is not returned.\n+\n+`<wildcard_pattern>`::\n+(string)\n+Wildcard (`*`) patterns containing source fields to return.", "originalCommit": "a60f05cae3ddb9552ff73818bb327a4615c80490", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg2NjAzNw==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r436866037", "bodyText": "A single wildcard pattern is also supported (as with the _source parameter).", "author": "jtibshirani", "createdAt": "2020-06-08T17:16:02Z", "path": "docs/reference/search/search.asciidoc", "diffHunk": "@@ -302,6 +327,58 @@ If the <<search-api-scroll-query-param,`scroll` parameter>> is specified, this\n value cannot be `0`.\n --\n \n+`_source`::\n+(Optional)\n+Indicates which <<mapping-source-field,source fields>> are returned for matching\n+documents. These fields are returned in the `hits._source` property of\n+the search response. Defaults to `true`.\n++\n+.Valid values for `_source`\n+[%collapsible%open]\n+====\n+`true`::\n+(boolean)\n+The entire document source is returned. This does not include:\n+* <<multi-fields,multi-fields>>\n+* <<alias,field aliases>>\n+* Values copied using the <<copy-to,`copy_to`>> mapping parameter\n+\n+`false`::\n+(boolean)\n+The document source is not returned.\n+\n+`<wildcard_pattern>`::\n+(string)\n+Wildcard (`*`) patterns containing source fields to return.\n+\n+`<wildcard_pattern_array>`::\n+(array of strings)\n+Array of wildcard (`*`) patterns containing source fields to return.\n+\n+`<object>`::\n+(object)\n+Object containing a list of source fields to include or exclude.\n++\n+.Properties for `<object>`\n+[%collapsible%open]\n+=====\n+`includes`::\n+(array of strings)\n+Array of wildcard (`*`) patterns containing source fields to return.", "originalCommit": "a60f05cae3ddb9552ff73818bb327a4615c80490", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg2NzIxNw==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r436867217", "bodyText": "For my own knowledge, what does this do?", "author": "jtibshirani", "createdAt": "2020-06-08T17:17:54Z", "path": "docs/reference/search/search.asciidoc", "diffHunk": "@@ -244,6 +268,7 @@ by their respective types in the response. Defaults to `true`.\n (Optional, boolean)\n If `true`, returns document version as part of a hit. Defaults to `false`.\n \n+[role=\"child_attributes\"]", "originalCommit": "a60f05cae3ddb9552ff73818bb327a4615c80490", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU0NDQzNQ==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r437544435", "bodyText": "This adds some CSS styling to better render collapsible sections for nested properties.\nBecause we don't want the styling on all collapsible sections, we have to add this attribute\nso our build attaches the child_attributes CSS class to the section.\nHere's an example of how it looks when rendered:", "author": "jrodewig", "createdAt": "2020-06-09T15:59:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg2NzIxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU1Nzg5NQ==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r437557895", "bodyText": "\ud83d\udc4d thanks!", "author": "jtibshirani", "createdAt": "2020-06-09T16:20:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg2NzIxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg2Nzk1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r436867959", "bodyText": "Similar comment to above, you can use includes and excludes in conjunction with each other.", "author": "jtibshirani", "createdAt": "2020-06-08T17:19:09Z", "path": "docs/reference/search/search.asciidoc", "diffHunk": "@@ -302,6 +327,58 @@ If the <<search-api-scroll-query-param,`scroll` parameter>> is specified, this\n value cannot be `0`.\n --\n \n+`_source`::\n+(Optional)\n+Indicates which <<mapping-source-field,source fields>> are returned for matching\n+documents. These fields are returned in the `hits._source` property of\n+the search response. Defaults to `true`.\n++\n+.Valid values for `_source`\n+[%collapsible%open]\n+====\n+`true`::\n+(boolean)\n+The entire document source is returned. This does not include:\n+* <<multi-fields,multi-fields>>\n+* <<alias,field aliases>>\n+* Values copied using the <<copy-to,`copy_to`>> mapping parameter\n+\n+`false`::\n+(boolean)\n+The document source is not returned.\n+\n+`<wildcard_pattern>`::\n+(string)\n+Wildcard (`*`) patterns containing source fields to return.\n+\n+`<wildcard_pattern_array>`::\n+(array of strings)\n+Array of wildcard (`*`) patterns containing source fields to return.\n+\n+`<object>`::\n+(object)\n+Object containing a list of source fields to include or exclude.\n++\n+.Properties for `<object>`\n+[%collapsible%open]\n+=====\n+`includes`::\n+(array of strings)\n+Array of wildcard (`*`) patterns containing source fields to return.\n++\n+If this property is specified, only source fields that match these patterns are\n+returned. You can exclude fields from this subset using the `excludes` property.\n+\n+`excludes`::\n+(array of strings)\n+Array of wildcard (`*`) pattern containing source fields to exclude from the\n+response.\n++\n+If the `includes` property is not specified, the entire document source is returned,", "originalCommit": "a60f05cae3ddb9552ff73818bb327a4615c80490", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjg2ODM4OQ==", "url": "https://github.com/elastic/elasticsearch/pull/57691#discussion_r436868389", "bodyText": "You can also specify wildcards patterns here.", "author": "jtibshirani", "createdAt": "2020-06-08T17:19:51Z", "path": "docs/reference/search/search.asciidoc", "diffHunk": "@@ -192,9 +192,29 @@ value cannot be `0`.\n (Optional, string) A comma-separated list of <field>:<direction> pairs.\n \n `_source`::\n-(Optional, boolean)\n-If `true`, the response includes the `_source` of matching documents under\n-`hits`. Defaults to `true`.\n+(Optional)\n+Indicates which <<mapping-source-field,source fields>> are returned for matching\n+documents. These fields are returned in the `hits._source` property of\n+the search response. Defaults to `true`.\n++\n+.Valid values for `_source`\n+[%collapsible%open]\n+====\n+`true`::\n+(boolean)\n+The entire document source is returned. This does not include:\n+* <<multi-fields,multi-fields>>\n+* <<alias,field aliases>>\n+* Values copied using the <<copy-to,`copy_to`>> mapping parameter\n+\n+`false`::\n+(boolean)\n+The document source is not returned.\n+\n+`<string>`::\n+(string)\n+Comma-separated list of source fields to return.", "originalCommit": "a60f05cae3ddb9552ff73818bb327a4615c80490", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fe78a0f7fadbdb16043d371d12470d63b8a4e3cd", "url": "https://github.com/elastic/elasticsearch/commit/fe78a0f7fadbdb16043d371d12470d63b8a4e3cd", "message": "Reword `_source_excludes` param", "committedDate": "2020-06-09T15:51:47Z", "type": "commit"}, {"oid": "439f93e749702723eb45661f9029fb6668cefa08", "url": "https://github.com/elastic/elasticsearch/commit/439f93e749702723eb45661f9029fb6668cefa08", "message": "simplify `true` value for `_source`", "committedDate": "2020-06-09T15:53:37Z", "type": "commit"}, {"oid": "66b281e1150e8fc32e811bd5097aeca4d1e6f255", "url": "https://github.com/elastic/elasticsearch/commit/66b281e1150e8fc32e811bd5097aeca4d1e6f255", "message": "note wildcard expressions are supported", "committedDate": "2020-06-09T15:54:59Z", "type": "commit"}, {"oid": "a722ca54c47eadb6fe0773fa72afbacb5ff940bf", "url": "https://github.com/elastic/elasticsearch/commit/a722ca54c47eadb6fe0773fa72afbacb5ff940bf", "message": "reword", "committedDate": "2020-06-09T15:55:43Z", "type": "commit"}, {"oid": "9ec2297a0ac8a4caf09f1c5eb9ca6bb0468ad53f", "url": "https://github.com/elastic/elasticsearch/commit/9ec2297a0ac8a4caf09f1c5eb9ca6bb0468ad53f", "message": "reword stored_fields def", "committedDate": "2020-06-09T15:57:09Z", "type": "commit"}, {"oid": "84248c9425f97ed4f3408ffd4af90940b9e914e5", "url": "https://github.com/elastic/elasticsearch/commit/84248c9425f97ed4f3408ffd4af90940b9e914e5", "message": "simplify wildcard pattern def", "committedDate": "2020-06-09T16:01:26Z", "type": "commit"}, {"oid": "64a01228767f9a8bccea736018c3be899a4b69d5", "url": "https://github.com/elastic/elasticsearch/commit/64a01228767f9a8bccea736018c3be899a4b69d5", "message": "fix up includes/excludes", "committedDate": "2020-06-09T16:06:17Z", "type": "commit"}, {"oid": "51577f7bb3e6f1376fc93a8b2ab088f930f1a2c1", "url": "https://github.com/elastic/elasticsearch/commit/51577f7bb3e6f1376fc93a8b2ab088f930f1a2c1", "message": "simplify source true def", "committedDate": "2020-06-09T16:16:48Z", "type": "commit"}]}