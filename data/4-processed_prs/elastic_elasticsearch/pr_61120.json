{"pr_number": 61120, "pr_title": "Doc: Max field expansions is not a hard limit", "pr_createdAt": "2020-08-13T20:45:01Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/61120", "timeline": [{"oid": "c197c010bd562997788b43e2514e5505ec8eb30e", "url": "https://github.com/elastic/elasticsearch/commit/c197c010bd562997788b43e2514e5505ec8eb30e", "message": "Max field expansions is not a hard limit\n\n>Limiting the number of auto-expanded fieldsedit\r\nExecuting queries that use automatic expansion of fields (e.g. query_string, simple_query_string or multi_match) can have performance issues for indices with a large numbers of fields. To safeguard against this, a hard limit of 1024 fields has been introduced for queries using the \"all fields\" mode (\"default_field\": \"\") or other fieldname expansions (e.g. \"foo\").\r\n\r\nPer https://github.com/elastic/elasticsearch/pull/35284, it looks like we changed this from a hard limit to a soft limit by leveraging `indices.query.bool.max_clause_count` in 7.0 beta1.  We will want to backport this to all 7.x versions.", "committedDate": "2020-08-13T20:43:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI0ODM4MA==", "url": "https://github.com/elastic/elasticsearch/pull/61120#discussion_r472248380", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To safeguard against this, a soft limit of 1024 fields has been introduced for queries\n          \n          \n            \n            using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname expansions (e.g. \"foo*\").\n          \n          \n            \n            This default maximum can be changed with the dynamic cluster setting `indices.query.bool.max_clause_count`.\n          \n          \n            \n            To safeguard against this, a default limit of 1024 fields has been introduced for\n          \n          \n            \n            queries using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname\n          \n          \n            \n            expansions (e.g. \"foo*\"). If needed, you can change this limit using the\n          \n          \n            \n            <<indices-query-bool-max-clause-count,`indices.query.bool.max_clause_count`>>\n          \n          \n            \n            dynamic cluster setting.", "author": "jrodewig", "createdAt": "2020-08-18T14:39:34Z", "path": "docs/reference/migration/migrate_7_0/search.asciidoc", "diffHunk": "@@ -149,8 +149,9 @@ for a particular index with the index setting `index.max_regex_length`.\n \n Executing queries that use automatic expansion of fields (e.g. `query_string`, `simple_query_string`\n or `multi_match`) can have performance issues for indices with a large numbers of fields.\n-To safeguard against this, a hard limit of 1024 fields has been introduced for queries\n+To safeguard against this, a soft limit of 1024 fields has been introduced for queries\n using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname expansions (e.g. \"foo*\").\n+This default maximum can be changed with the dynamic cluster setting `indices.query.bool.max_clause_count`.", "originalCommit": "c197c010bd562997788b43e2514e5505ec8eb30e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f697ce27a55169415a2b8a30db918fadadacb478", "url": "https://github.com/elastic/elasticsearch/commit/f697ce27a55169415a2b8a30db918fadadacb478", "message": "Update docs/reference/migration/migrate_7_0/search.asciidoc", "committedDate": "2020-08-18T14:40:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI1NzQyOA==", "url": "https://github.com/elastic/elasticsearch/pull/61120#discussion_r472257428", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            queries using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname\n          \n          \n            \n            expansions (e.g. \"foo*\"). If needed, you can change this limit using the\n          \n          \n            \n            queries using the \"all fields\" mode (`\"default_field\": \"*\"`) or other fieldname\n          \n          \n            \n            expansions (e.g. `\"foo*\"`). If needed, you can change this limit using the", "author": "jrodewig", "createdAt": "2020-08-18T14:51:12Z", "path": "docs/reference/migration/migrate_7_0/search.asciidoc", "diffHunk": "@@ -149,8 +149,11 @@ for a particular index with the index setting `index.max_regex_length`.\n \n Executing queries that use automatic expansion of fields (e.g. `query_string`, `simple_query_string`\n or `multi_match`) can have performance issues for indices with a large numbers of fields.\n-To safeguard against this, a hard limit of 1024 fields has been introduced for queries\n-using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname expansions (e.g. \"foo*\").\n+To safeguard against this, a default limit of 1024 fields has been introduced for\n+queries using the \"all fields\" mode (\"default_field\": \"*\") or other fieldname\n+expansions (e.g. \"foo*\"). If needed, you can change this limit using the", "originalCommit": "f697ce27a55169415a2b8a30db918fadadacb478", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1eec1c2c4b5f373b7ac075d7306d214340ba7c94", "url": "https://github.com/elastic/elasticsearch/commit/1eec1c2c4b5f373b7ac075d7306d214340ba7c94", "message": "Fix formatting", "committedDate": "2020-08-18T14:51:21Z", "type": "commit"}]}