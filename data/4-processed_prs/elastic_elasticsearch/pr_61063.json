{"pr_number": 61063, "pr_title": "[DOCS] Add admon for built-in index templates", "pr_createdAt": "2020-08-12T19:00:43Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/61063", "timeline": [{"oid": "405804960f5a4e5971733611a9d1795938d53f22", "url": "https://github.com/elastic/elasticsearch/commit/405804960f5a4e5971733611a9d1795938d53f22", "message": "[DOCS] Add admon for built-in index templates\n\nAdds an important admonition for the built-in `metrics-*-*` and `logs-*-*` index\ntemplates.\n\nUpdates several put index template snippets to include a priority.", "committedDate": "2020-08-12T18:59:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ5MjcxOQ==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r469492719", "bodyText": "Minor suggestion:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            non-overlapping index pattern, or assign your templates a `priority` greater\n          \n          \n            \n            than `100`.\n          \n          \n            \n            non-overlapping index pattern, or assign your templates a `priority` greater\n          \n          \n            \n            or lower than `100`.", "author": "dakrone", "createdAt": "2020-08-12T19:33:40Z", "path": "docs/reference/data-streams/set-up-a-data-stream.asciidoc", "diffHunk": "@@ -106,6 +106,15 @@ template for a data stream must specify:\n \n * That the template is used exclusively for data streams.\n \n+* A priority for the template.\n+\n+IMPORTANT: {es} comes with built-in index templates for the `metrics-*-*` and\n+`logs-*-*` index patterns.\n+{ingest-guide}/ingest-management-overview.html[{agent}] uses these templates to\n+create data streams. To avoid accidentally applying these templates, use a\n+non-overlapping index pattern, or assign your templates a `priority` greater\n+than `100`.", "originalCommit": "405804960f5a4e5971733611a9d1795938d53f22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ5MjgyOA==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r469492828", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            non-overlapping index pattern, or assign your templates a `priority` greater\n          \n          \n            \n            than `100`.\n          \n          \n            \n            non-overlapping index pattern, or assign your templates a `priority` greater\n          \n          \n            \n            or lower than `100`.", "author": "dakrone", "createdAt": "2020-08-12T19:33:53Z", "path": "docs/reference/indices/index-templates.asciidoc", "diffHunk": "@@ -20,6 +20,13 @@ specify settings, mappings, and aliases.\n \n If a new data stream or index matches more than one index template, the index template with the highest priority is used.\n \n+IMPORTANT: {es} comes with built-in index templates for the `metrics-*-*` and\n+`logs-*-*` index patterns.\n+{ingest-guide}/ingest-management-overview.html[{agent}] uses these templates to\n+create data streams. To avoid accidentally applying these templates, use a\n+non-overlapping index pattern, or assign your templates a `priority` greater\n+than `100`.", "originalCommit": "405804960f5a4e5971733611a9d1795938d53f22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQ5MjkwOA==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r469492908", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            non-overlapping index pattern, or assign your templates a `priority` greater\n          \n          \n            \n            than `100`.\n          \n          \n            \n            non-overlapping index pattern, or assign your templates a `priority` greater\n          \n          \n            \n            or lower than `100`.", "author": "dakrone", "createdAt": "2020-08-12T19:34:02Z", "path": "docs/reference/indices/put-index-template.asciidoc", "diffHunk": "@@ -83,6 +83,13 @@ include::{docdir}/rest-api/common-parms.asciidoc[tag=master-timeout]\n (Required, array of strings)\n Array of wildcard (`*`) expressions\n used to match the names of data streams and indices during creation.\n++\n+IMPORTANT: {es} comes with built-in index templates for the `metrics-*-*` and\n+`logs-*-*` index patterns.\n+{ingest-guide}/ingest-management-overview.html[{agent}] uses these templates to\n+create data streams. To avoid accidentally applying these templates, use a\n+non-overlapping index pattern, or assign your templates a `priority` greater\n+than `100`.", "originalCommit": "405804960f5a4e5971733611a9d1795938d53f22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "325092ab6f557070646a223e173f8fc182384907", "url": "https://github.com/elastic/elasticsearch/commit/325092ab6f557070646a223e173f8fc182384907", "message": "Apply Lee's suggestions.\n\nCo-authored-by: Lee Hinman <dakrone@users.noreply.github.com>", "committedDate": "2020-08-12T19:37:42Z", "type": "commit"}, {"oid": "0dcc40694f35eb32163605aca2c899f1b81c58d1", "url": "https://github.com/elastic/elasticsearch/commit/0dcc40694f35eb32163605aca2c899f1b81c58d1", "message": "iter", "committedDate": "2020-08-12T19:43:18Z", "type": "commit"}, {"oid": "84c8187d8df65c9da8da622aa172e7b2816da0ef", "url": "https://github.com/elastic/elasticsearch/commit/84c8187d8df65c9da8da622aa172e7b2816da0ef", "message": "Revert \"iter\"\n\nThis reverts commit 0dcc40694f35eb32163605aca2c899f1b81c58d1.", "committedDate": "2020-08-12T19:44:23Z", "type": "commit"}, {"oid": "577a9034c2518b2a81e227d21e85e22f0ec2cf10", "url": "https://github.com/elastic/elasticsearch/commit/577a9034c2518b2a81e227d21e85e22f0ec2cf10", "message": "Add admon to index API docs", "committedDate": "2020-08-12T21:47:42Z", "type": "commit"}, {"oid": "eb2df7df8c21ab828148301b2814a58a47884048", "url": "https://github.com/elastic/elasticsearch/commit/eb2df7df8c21ab828148301b2814a58a47884048", "message": "Bump priority", "committedDate": "2020-08-13T11:37:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI3MTQzOA==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r470271438", "bodyText": "Can a data stream template with an index pattern that overlaps the built-in templates also inadvertently override the built-in templates? For example, if I add a data stream template with the index pattern logs* and give it a higher priority than the built in template (presumably 100?), have I just messed things up for the Elastic Agent's logs data stream?\nAlso, I'm not sure it's obvious that a higher number is in fact a higher priority. I could see someone making the opposite assumption.", "author": "debadair", "createdAt": "2020-08-13T21:56:37Z", "path": "docs/reference/data-streams/set-up-a-data-stream.asciidoc", "diffHunk": "@@ -106,6 +106,15 @@ template for a data stream must specify:\n \n * That the template is used exclusively for data streams.\n \n+* A priority for the template.\n+\n+IMPORTANT: {es} comes with built-in index templates for the `metrics-*-*` and\n+`logs-*-*` index patterns.\n+{ingest-guide}/ingest-management-overview.html[{agent}] uses these templates to\n+create data streams. To avoid accidentally applying these templates, use a", "originalCommit": "eb2df7df8c21ab828148301b2814a58a47884048", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI3NTc5MA==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r470275790", "bodyText": "Can a data stream template with an index pattern that overlaps the built-in templates also inadvertently override the built-in templates? For example, if I add a data stream template with the index pattern logs* and give it a higher priority than the built in template (presumably 100?), have I just messed things up for the Elastic Agent's logs data stream?\n\nYes, if someone put a template in place with a higher priority it would hijack the built-in templates. Fleet does this to override them with more specific templates when it installs its templates", "author": "dakrone", "createdAt": "2020-08-13T22:07:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI3MTQzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDYxODU2Mg==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r470618562", "bodyText": "Added this sentence to address people using Elastic Agent:\n\nIf you use Elastic Agent, assign your index templates a priority lower than 100 to avoid an override of the built-in templates.", "author": "jrodewig", "createdAt": "2020-08-14T13:19:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI3MTQzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI3MTYxNQ==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r470271615", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            {ingest-guide}/ingest-management-overview.html[{agent}] uses these templates to\n          \n          \n            \n            {ingest-guide}/ingest-management-overview.html[{Elastic Agent}] uses these templates to", "author": "debadair", "createdAt": "2020-08-13T21:57:02Z", "path": "docs/reference/data-streams/set-up-a-data-stream.asciidoc", "diffHunk": "@@ -106,6 +106,15 @@ template for a data stream must specify:\n \n * That the template is used exclusively for data streams.\n \n+* A priority for the template.\n+\n+IMPORTANT: {es} comes with built-in index templates for the `metrics-*-*` and\n+`logs-*-*` index patterns.\n+{ingest-guide}/ingest-management-overview.html[{agent}] uses these templates to", "originalCommit": "eb2df7df8c21ab828148301b2814a58a47884048", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDYwNDIwOQ==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r470604209", "bodyText": "The {agent} attribute expands to Elastic Agent already.", "author": "jrodewig", "createdAt": "2020-08-14T12:51:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI3MTYxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDI3MTg3OA==", "url": "https://github.com/elastic/elasticsearch/pull/61063#discussion_r470271878", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            IMPORTANT: {es} comes with built-in index templates for the `metrics-*-*` and\n          \n          \n            \n            IMPORTANT: {es} has built-in index templates for the `metrics-*-*` and", "author": "debadair", "createdAt": "2020-08-13T21:57:45Z", "path": "docs/reference/data-streams/set-up-a-data-stream.asciidoc", "diffHunk": "@@ -106,6 +106,15 @@ template for a data stream must specify:\n \n * That the template is used exclusively for data streams.\n \n+* A priority for the template.\n+\n+IMPORTANT: {es} comes with built-in index templates for the `metrics-*-*` and", "originalCommit": "eb2df7df8c21ab828148301b2814a58a47884048", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9bfbdfdd9d7053751a1caa7c13fa939c3de7d054", "url": "https://github.com/elastic/elasticsearch/commit/9bfbdfdd9d7053751a1caa7c13fa939c3de7d054", "message": "Address feedback", "committedDate": "2020-08-14T13:18:43Z", "type": "commit"}]}