{"pr_number": 55462, "pr_title": "[DOCS] Provides further details on aggregations in datafeeds", "pr_createdAt": "2020-04-20T13:31:44Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/55462", "timeline": [{"oid": "9a6590d1a7ddf463de92cbcc05271e37f4965991", "url": "https://github.com/elastic/elasticsearch/commit/9a6590d1a7ddf463de92cbcc05271e37f4965991", "message": "[DOCS] Provides further details on aggregations in datafeeds.", "committedDate": "2020-04-20T13:24:02Z", "type": "commit"}, {"oid": "5462456d1c3f0cee7835c0cf6e399b50d2778b0d", "url": "https://github.com/elastic/elasticsearch/commit/5462456d1c3f0cee7835c0cf6e399b50d2778b0d", "message": "[DOCS] Fixes section ID.", "committedDate": "2020-04-20T13:41:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU5MDU2Ng==", "url": "https://github.com/elastic/elasticsearch/pull/55462#discussion_r411590566", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            operates on need to mach, otherwise the aggregation doesn't work. For example, \n          \n          \n            \n            operates on need to match, otherwise the aggregation doesn't work. For example,", "author": "lcawl", "createdAt": "2020-04-20T18:17:00Z", "path": "docs/reference/ml/anomaly-detection/aggregations.asciidoc", "diffHunk": "@@ -25,7 +29,14 @@ You must also consider the interval of the date histogram aggregation carefully.\n The bucket span of your {anomaly-job} must be divisible by the value of the\n `calendar_interval` or `fixed_interval` in your aggregation (with no remainder).\n If you specify a `frequency` for your {dfeed}, it must also be divisible by this\n-interval.\n+interval. You cannot feed an {anomaly-job} with a date histogram with an \n+interval measured in months because the length of the month is not fixed. \n+{dfeeds-cap} tolerate weeks or smaller units.\n+\n+IMPORTANT: The name of the aggregation and the name of the field that the agg \n+operates on need to mach, otherwise the aggregation doesn't work. For example, ", "originalCommit": "5462456d1c3f0cee7835c0cf6e399b50d2778b0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU5Mjc2OA==", "url": "https://github.com/elastic/elasticsearch/pull/55462#discussion_r411592768", "bodyText": "<2> In this example, the aggregations have names that match the fields that they ...\n\nIMO rather than repeating these sentences, you could just say something like this:\n\n<2> Likewise, the term aggregation is named airline and its field is also named airline.", "author": "lcawl", "createdAt": "2020-04-20T18:20:47Z", "path": "docs/reference/ml/anomaly-detection/aggregations.asciidoc", "diffHunk": "@@ -107,15 +123,25 @@ PUT _ml/datafeeds/datafeed-farequote\n \n <1> In this example, the aggregations have names that match the fields that they\n operate on. That is to say, the `max` aggregation is named `time` and its\n-field is also `time`. The same is true for the aggregations with the names\n-`airline` and `responsetime`. \n+field also needs to be `time`.\n+<2> In this example, the aggregations have names that match the fields that they", "originalCommit": "5462456d1c3f0cee7835c0cf6e399b50d2778b0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU5MzA2OQ==", "url": "https://github.com/elastic/elasticsearch/pull/55462#discussion_r411593069", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            {dfeeds-cap} support complex nested aggregations, this example uses the \n          \n          \n            \n            {dfeeds-cap} support complex nested aggregations. This example uses the", "author": "lcawl", "createdAt": "2020-04-20T18:21:19Z", "path": "docs/reference/ml/anomaly-detection/aggregations.asciidoc", "diffHunk": "@@ -107,15 +123,25 @@ PUT _ml/datafeeds/datafeed-farequote\n \n <1> In this example, the aggregations have names that match the fields that they\n operate on. That is to say, the `max` aggregation is named `time` and its\n-field is also `time`. The same is true for the aggregations with the names\n-`airline` and `responsetime`. \n+field also needs to be `time`.\n+<2> In this example, the aggregations have names that match the fields that they\n+operate on. That is to say, the `term` aggregation is named `airline` and its\n+field also needs to be `airline`.\n+<3> In this example, the aggregations have names that match the fields that they\n+operate on. That is to say, the `avg` aggregation is named `responsetime` and \n+its field also needs to be `responsetime`.\n+\n+Your {dfeed} can contain multiple aggregations, but only the ones with names \n+that match values in the job configuration are fed to the job.\n \n-IMPORTANT: Your {dfeed} can contain multiple aggregations, but only the ones\n-with names that match values in the job configuration are fed to the job.\n \n-{dfeeds-cap} support complex nested aggregations, this example uses the `derivative`\n-pipeline aggregation to find the first order derivative of the counter\n-`system.network.out.bytes` for each value of the field `beat.name`.\n+[discrete]\n+[[aggs-dfeeds]]\n+==== Nested aggregations in {dfeeds}\n+\n+{dfeeds-cap} support complex nested aggregations, this example uses the ", "originalCommit": "5462456d1c3f0cee7835c0cf6e399b50d2778b0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU5NTc3NQ==", "url": "https://github.com/elastic/elasticsearch/pull/55462#discussion_r411595775", "bodyText": "You cannot feed an anomaly detection job with a date histogram...\n\nThis working seems strange to me.  We don't talk about \"feeding jobs\" elsewhere AFAIK. Could this be changed to something like this?: \"Anomaly detection jobs cannot use date histograms with....\" or \"Data feeds cannot use date historgrams with...\"", "author": "lcawl", "createdAt": "2020-04-20T18:25:41Z", "path": "docs/reference/ml/anomaly-detection/aggregations.asciidoc", "diffHunk": "@@ -25,7 +29,14 @@ You must also consider the interval of the date histogram aggregation carefully.\n The bucket span of your {anomaly-job} must be divisible by the value of the\n `calendar_interval` or `fixed_interval` in your aggregation (with no remainder).\n If you specify a `frequency` for your {dfeed}, it must also be divisible by this\n-interval.\n+interval. You cannot feed an {anomaly-job} with a date histogram with an ", "originalCommit": "5462456d1c3f0cee7835c0cf6e399b50d2778b0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU5NzQ0OA==", "url": "https://github.com/elastic/elasticsearch/pull/55462#discussion_r411597448", "bodyText": "IMPORTANT: The name of the aggregation...\n\nIn general, I try to avoid putting two or more admonition blocks one after another. Sometimes that's solved by combining them into a single admonition with a bulleted list.  In this case, since the second one (the interval tip) seems to carry on subject matter from the second paragraph, I'd suggest putting this first one (important naming info) after the first paragraph.", "author": "lcawl", "createdAt": "2020-04-20T18:28:18Z", "path": "docs/reference/ml/anomaly-detection/aggregations.asciidoc", "diffHunk": "@@ -25,7 +29,14 @@ You must also consider the interval of the date histogram aggregation carefully.\n The bucket span of your {anomaly-job} must be divisible by the value of the\n `calendar_interval` or `fixed_interval` in your aggregation (with no remainder).\n If you specify a `frequency` for your {dfeed}, it must also be divisible by this\n-interval.\n+interval. You cannot feed an {anomaly-job} with a date histogram with an \n+interval measured in months because the length of the month is not fixed. \n+{dfeeds-cap} tolerate weeks or smaller units.\n+\n+IMPORTANT: The name of the aggregation and the name of the field that the agg ", "originalCommit": "5462456d1c3f0cee7835c0cf6e399b50d2778b0d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "363579d1531acc7f3d4343d998ab052e8c141627", "url": "https://github.com/elastic/elasticsearch/commit/363579d1531acc7f3d4343d998ab052e8c141627", "message": "Apply suggestions from code review\n\nCo-Authored-By: Lisa Cawley <lcawley@elastic.co>", "committedDate": "2020-04-21T06:54:29Z", "type": "commit"}, {"oid": "ed2ed7b2c1b1420d8002eb59cdce1bf0ce89a8ef", "url": "https://github.com/elastic/elasticsearch/commit/ed2ed7b2c1b1420d8002eb59cdce1bf0ce89a8ef", "message": "[DOCS] Addresses feedback.", "committedDate": "2020-04-21T07:01:48Z", "type": "commit"}]}