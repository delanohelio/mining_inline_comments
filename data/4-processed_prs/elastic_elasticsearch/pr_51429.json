{"pr_number": 51429, "pr_title": "Fix RareClusterStateIT Cancelling Publication too Early", "pr_createdAt": "2020-01-24T16:02:30Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/51429", "timeline": [{"oid": "68ef47e1160d328f23af12f9a5c2c989604cf50f", "url": "https://github.com/elastic/elasticsearch/commit/68ef47e1160d328f23af12f9a5c2c989604cf50f", "message": "Fix RareClusterStateIT Cancelling Publication too Early\n\nWait for the cluster to have settled down and have the same accepted version on all nodes before\nexecuting and cancelling request so that a slow CS accept on one node doesn't make it fall behind\nand then get sent the full CS because of the diff-version mismatch, breaking the mechanics of this test.\n\nCloses #51308", "committedDate": "2020-01-24T16:01:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDcxMTExNg==", "url": "https://github.com/elastic/elasticsearch/pull/51429#discussion_r370711116", "bodyText": "These busy assert made no sense, we're never resending the requests we're asserting on here, all these do is make a failed test run take an extra 10s.", "author": "original-brownbear", "createdAt": "2020-01-24T16:03:21Z", "path": "server/src/test/java/org/elasticsearch/cluster/coordination/RareClusterStateIT.java", "diffHunk": "@@ -370,11 +376,9 @@ public void testDelayedMappingPropagationOnReplica() throws Exception {\n \n         // Now make sure the indexing request finishes successfully\n         disruption.stopDisrupting();\n-        assertBusy(() -> {", "originalCommit": "68ef47e1160d328f23af12f9a5c2c989604cf50f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}