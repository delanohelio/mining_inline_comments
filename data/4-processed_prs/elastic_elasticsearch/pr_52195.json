{"pr_number": 52195, "pr_title": "[ML] Switch poor categorization audit warning to use status field", "pr_createdAt": "2020-02-11T11:56:02Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52195", "timeline": [{"oid": "5f6078e15f6bef822109ffc7dcee0c4f1ce04895", "url": "https://github.com/elastic/elasticsearch/commit/5f6078e15f6bef822109ffc7dcee0c4f1ce04895", "message": "[ML] Switch poor categorization audit warning to use status field\n\nIn #51146 a rudimentary check for poor categorization was added to\n7.6.\n\nThis change replaces that warning based on a Java-side check with\na new one based on the categorization_status field that the ML C++\nsets.  categorization_status was added in 7.7 and above by #51879,\nso this new warning based on more advanced conditions will also be\nin 7.7 and above.\n\nCloses #50749", "committedDate": "2020-02-11T11:50:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzU5NTkwNw==", "url": "https://github.com/elastic/elasticsearch/pull/52195#discussion_r377595907", "bodyText": "Should we also emit auditor warning if the categorizationStatus is WARN in the first modelSizeStats analyzed?", "author": "przemekwitek", "createdAt": "2020-02-11T12:09:44Z", "path": "x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/output/AutodetectResultProcessor.java", "diffHunk": "@@ -359,6 +341,16 @@ private void notifyModelMemoryStatusChange(ModelSizeStats modelSizeStats) {\n         }\n     }\n \n+    private void notifyCategorizationStatusChange(ModelSizeStats modelSizeStats) {\n+        ModelSizeStats.CategorizationStatus categorizationStatus = modelSizeStats.getCategorizationStatus();\n+        if (categorizationStatus != latestModelSizeStats.getCategorizationStatus()) {", "originalCommit": "5f6078e15f6bef822109ffc7dcee0c4f1ce04895", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzY0MzEyNg==", "url": "https://github.com/elastic/elasticsearch/pull/52195#discussion_r377643126", "bodyText": "Should we also emit auditor warning if the categorizationStatus is WARN in the first modelSizeStats analyzed?\n\nYes, that should work because a default constructed ModelSizeStats will have CategorizationStatus.OK.  But I will add a test to prove it.", "author": "droberts195", "createdAt": "2020-02-11T13:47:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzU5NTkwNw=="}], "type": "inlineReview"}, {"oid": "884edda0e07947b74374470edd1d1909f2d55de9", "url": "https://github.com/elastic/elasticsearch/commit/884edda0e07947b74374470edd1d1909f2d55de9", "message": "Remove stray blank line", "committedDate": "2020-02-11T12:13:46Z", "type": "commit"}, {"oid": "44b52b6f0c7049df4bfec106f30b09d675f215ef", "url": "https://github.com/elastic/elasticsearch/commit/44b52b6f0c7049df4bfec106f30b09d675f215ef", "message": "Add an extra test for an edge case", "committedDate": "2020-02-11T13:59:15Z", "type": "commit"}]}