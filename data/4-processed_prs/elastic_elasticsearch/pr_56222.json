{"pr_number": 56222, "pr_title": "[7.x] Wire up DiversifiedAggregation (#56145)", "pr_createdAt": "2020-05-05T15:38:59Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/56222", "timeline": [{"oid": "7c93062952503ff475836743be654b3c7f1ea69d", "url": "https://github.com/elastic/elasticsearch/commit/7c93062952503ff475836743be654b3c7f1ea69d", "message": "Wire up DiversifiedAggregation (#56145)", "committedDate": "2020-05-05T15:38:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDIwOTkwMg==", "url": "https://github.com/elastic/elasticsearch/pull/56222#discussion_r420209902", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        List.of(CoreValuesSourceType.NUMERIC, CoreValuesSourceType.DATE, CoreValuesSourceType.BOOLEAN),\n          \n          \n            \n                        org.elasticsearch.common.collect.List.of(\n          \n          \n            \n                            CoreValuesSourceType.NUMERIC,\n          \n          \n            \n                            CoreValuesSourceType.DATE,\n          \n          \n            \n                            CoreValuesSourceType.BOOLEAN),", "author": "not-napoleon", "createdAt": "2020-05-05T15:43:16Z", "path": "server/src/main/java/org/elasticsearch/search/aggregations/bucket/sampler/DiversifiedAggregatorFactory.java", "diffHunk": "@@ -27,19 +27,51 @@\n import org.elasticsearch.search.aggregations.InternalAggregation;\n import org.elasticsearch.search.aggregations.NonCollectingAggregator;\n import org.elasticsearch.search.aggregations.bucket.sampler.SamplerAggregator.ExecutionMode;\n+import org.elasticsearch.search.aggregations.support.AggregatorSupplier;\n+import org.elasticsearch.search.aggregations.support.CoreValuesSourceType;\n import org.elasticsearch.search.aggregations.support.ValuesSource;\n-import org.elasticsearch.search.aggregations.support.ValuesSource.Numeric;\n import org.elasticsearch.search.aggregations.support.ValuesSourceAggregatorFactory;\n import org.elasticsearch.search.aggregations.support.ValuesSourceConfig;\n+import org.elasticsearch.search.aggregations.support.ValuesSourceRegistry;\n import org.elasticsearch.search.internal.SearchContext;\n \n import java.io.IOException;\n+import java.util.List;\n import java.util.Map;\n \n-import static org.elasticsearch.search.aggregations.support.AggregationUsageService.OTHER_SUBTYPE;\n-\n public class DiversifiedAggregatorFactory extends ValuesSourceAggregatorFactory {\n \n+    public static void registerAggregators(ValuesSourceRegistry.Builder builder) {\n+        builder.register(DiversifiedAggregationBuilder.NAME,\n+            List.of(CoreValuesSourceType.NUMERIC, CoreValuesSourceType.DATE, CoreValuesSourceType.BOOLEAN),", "originalCommit": "7c93062952503ff475836743be654b3c7f1ea69d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4579163ef50a6b82c99a029974331816a7a5fc98", "url": "https://github.com/elastic/elasticsearch/commit/4579163ef50a6b82c99a029974331816a7a5fc98", "message": "Update server/src/main/java/org/elasticsearch/search/aggregations/bucket/sampler/DiversifiedAggregatorFactory.java", "committedDate": "2020-05-05T15:43:30Z", "type": "commit"}, {"oid": "da86067fe30a783abf9142a7492dbb4d5c9782de", "url": "https://github.com/elastic/elasticsearch/commit/da86067fe30a783abf9142a7492dbb4d5c9782de", "message": "Merge branch '7.x' into backport/7.x/pr-56145", "committedDate": "2020-05-05T15:51:48Z", "type": "commit"}, {"oid": "2608f58efe6ece4f9c08b5a35ed3bb5156923bd4", "url": "https://github.com/elastic/elasticsearch/commit/2608f58efe6ece4f9c08b5a35ed3bb5156923bd4", "message": "remove unused import", "committedDate": "2020-05-05T16:25:07Z", "type": "commit"}]}