{"pr_number": 64550, "pr_title": "[DOCS] Document upgrade process for concurrency control", "pr_createdAt": "2020-11-03T18:22:40Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/64550", "timeline": [{"oid": "4ea29be4836c13e57e16aa4cf1cad9c70858ed50", "url": "https://github.com/elastic/elasticsearch/commit/4ea29be4836c13e57e16aa4cf1cad9c70858ed50", "message": "[DOCS] Document upgrade process for concurrency control", "committedDate": "2020-11-03T18:19:38Z", "type": "commit"}, {"oid": "bb0d7bfd03090c73915108852c81d16730f02cd1", "url": "https://github.com/elastic/elasticsearch/commit/bb0d7bfd03090c73915108852c81d16730f02cd1", "message": "reword", "committedDate": "2020-11-03T18:42:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc0MTAxMQ==", "url": "https://github.com/elastic/elasticsearch/pull/64550#discussion_r518741011", "bodyText": "nit: I wonder if it was a bit clearer what to look for if the response stated that the index was created in a 5.x version?", "author": "henningandersen", "createdAt": "2020-11-06T13:10:49Z", "path": "docs/reference/migration/migrate_7_0/api.asciidoc", "diffHunk": "@@ -22,9 +22,76 @@ while handling a write operation, it may expose a version that will then be reus\n new primary.\n \n Due to that issue, internal versioning can no longer be used and is replaced by a new\n-method based on sequence numbers. See <<optimistic-concurrency-control>> for more details.\n-\n-Note that the `external` versioning type is still fully supported.\n+method based on <<optimistic-concurrency-control,sequence numbers>>. To switch\n+to the new method, follow these steps:\n+\n+. Perform a <<rolling-upgrades,rolling upgrade>> to 6.8.\n+\n+. <<reindex-upgrade,Reindex>> any indices created before 6.0. This ensures\n+documents in those indices have sequence numbers.\n++\n+To get the {es} version in which an index was created, use the\n+<<indices-get-index,get index API>> with the `human` parameter:\n++\n+--\n+.*API Example*\n+[%collapsible]\n+====\n+[source,console]\n+----\n+GET /*?human\n+----\n+// TEST[setup:my_index]\n+\n+The response returns a `settings.index.version.created_string` property for\n+each index:\n+\n+[source,console-response]\n+----\n+{\n+  \"my-index-000001\": {\n+    ...\n+    \"settings\": {\n+      \"index\": {\n+        \"creation_date_string\": \"2099-01-01T00:00:00.000Z\",\n+        \"routing\": {\n+          \"allocation\": {\n+            \"include\": {\n+              \"_tier_preference\": \"data_content\"\n+            }\n+          }\n+        },\n+        \"number_of_shards\": \"1\",\n+        \"provided_name\": \"my-index-000001\",\n+        \"creation_date\": \"4070908800\",\n+        \"number_of_replicas\": \"1\",\n+        \"uuid\": \"c89-MHh8RwKwS1r7Turg2g\",\n+        \"version\": {\n+          \"created_string\": \"6.0.0\",           <1>", "originalCommit": "bb0d7bfd03090c73915108852c81d16730f02cd1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc0MzI2NA==", "url": "https://github.com/elastic/elasticsearch/pull/64550#discussion_r518743264", "bodyText": ":doh: Yes. That would be much clearer. I'll get that fixed up. Thanks for catching that @henningandersen.", "author": "jrodewig", "createdAt": "2020-11-06T13:15:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc0MTAxMQ=="}], "type": "inlineReview"}, {"oid": "5ad3646b6650b6780e13d68596775377598deb6d", "url": "https://github.com/elastic/elasticsearch/commit/5ad3646b6650b6780e13d68596775377598deb6d", "message": "Fix ES version", "committedDate": "2020-11-06T13:32:03Z", "type": "commit"}]}