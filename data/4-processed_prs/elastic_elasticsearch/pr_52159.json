{"pr_number": 52159, "pr_title": "Ignore timeouts with single-node discovery", "pr_createdAt": "2020-02-10T17:44:57Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/52159", "timeline": [{"oid": "94d701d0208d78f2d622b4d695a3293434cbfd01", "url": "https://github.com/elastic/elasticsearch/commit/94d701d0208d78f2d622b4d695a3293434cbfd01", "message": "Ignore timeouts with single-node discovery\n\nToday we use `cluster.join.timeout` to prevent nodes from waiting indefinitely\nif joining a faulty master that is too slow to respond, and\n`cluster.publish.timeout` to allow a faulty master to detect that it is unable\nto publish its cluster state updates in a timely fashion. If these timeouts\noccur then the node restarts the discovery process in an attempt to find a\nhealthier master.\n\nIn the special case of `discovery.type: single-node` there is no point in\nlooking for another healthier master since the single node in the cluster is\nall we've got. This commit suppresses these timeouts and instead lets the node\nwait for joins and publications to succeed no matter how long this might take.", "committedDate": "2020-02-10T16:33:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMTE3Nw==", "url": "https://github.com/elastic/elasticsearch/pull/52159#discussion_r377221177", "bodyText": "NIT: can be private?", "author": "original-brownbear", "createdAt": "2020-02-10T17:54:01Z", "path": "server/src/main/java/org/elasticsearch/cluster/coordination/Coordinator.java", "diffHunk": "@@ -1398,6 +1397,13 @@ public void onFailure(Exception e) {\n             }, EsExecutors.newDirectExecutorService(), transportService.getThreadPool().getThreadContext());\n         }\n \n+        void cancelTimeoutHandlers() {", "originalCommit": "94d701d0208d78f2d622b4d695a3293434cbfd01", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNjk3OQ==", "url": "https://github.com/elastic/elasticsearch/pull/52159#discussion_r377226979", "bodyText": "++ b7e1d8a. I haven't been able to work out how to get IntelliJ to tell me that even when making it private means the compiler generates a package-private wrapper as it does here?", "author": "DaveCTurner", "createdAt": "2020-02-10T18:05:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMTE3Nw=="}], "type": "inlineReview"}, {"oid": "b7e1d8af4f9c6138d6b32b0e432b72c74eb05b41", "url": "https://github.com/elastic/elasticsearch/commit/b7e1d8af4f9c6138d6b32b0e432b72c74eb05b41", "message": "Private", "committedDate": "2020-02-10T17:59:28Z", "type": "commit"}]}