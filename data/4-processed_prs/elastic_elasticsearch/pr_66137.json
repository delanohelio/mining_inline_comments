{"pr_number": 66137, "pr_title": "Adding \"read ingest pipeline\" cluster privilege", "pr_createdAt": "2020-12-09T22:06:14Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/66137", "timeline": [{"oid": "1d38ed96be64df8c508d97ad951d1bcae8652617", "url": "https://github.com/elastic/elasticsearch/commit/1d38ed96be64df8c508d97ad951d1bcae8652617", "message": "Adding \"read ingest pipeline\" cluster privilege\n\nThe new privilege will allow to run ingest tools with minimal\nprivilege to check whether a\npipeline exists, without being able to modify it.\nThis privilege also support simulate pipeline too since it is a readonly\n operation.\n\n Resolve #48028", "committedDate": "2020-12-09T21:54:10Z", "type": "commit"}, {"oid": "90cef0bf62149b1041c168991c97965a0ebcce98", "url": "https://github.com/elastic/elasticsearch/commit/90cef0bf62149b1041c168991c97965a0ebcce98", "message": "Merge branch 'master' into Read_ingest_pipeline", "committedDate": "2020-12-10T09:40:53Z", "type": "commit"}, {"oid": "59f271f7a20ae136e9ea2a6990e17007e956a0ce", "url": "https://github.com/elastic/elasticsearch/commit/59f271f7a20ae136e9ea2a6990e17007e956a0ce", "message": "Adding \"read ingest pipeline\" cluster privilege\n\nFixing tests.\n\n Resolve #48028", "committedDate": "2020-12-10T18:21:26Z", "type": "commit"}, {"oid": "0c793a9784f19c89bfe7c51a115a96a803283b1f", "url": "https://github.com/elastic/elasticsearch/commit/0c793a9784f19c89bfe7c51a115a96a803283b1f", "message": "Adding \"read ingest pipeline\" cluster privilege\n\nFixing tests.\n\n Resolve #48028", "committedDate": "2020-12-13T18:49:15Z", "type": "commit"}, {"oid": "148e9c190f2e7ce5e6cb45bb8e7a7cca6fe8a70b", "url": "https://github.com/elastic/elasticsearch/commit/148e9c190f2e7ce5e6cb45bb8e7a7cca6fe8a70b", "message": "Adding \"read ingest pipeline\" cluster privilege\n\nFixing tests.\n\n Resolve #48028", "committedDate": "2020-12-14T15:19:58Z", "type": "commit"}, {"oid": "72c3a125b92ccdf44a03962aa686d47761476993", "url": "https://github.com/elastic/elasticsearch/commit/72c3a125b92ccdf44a03962aa686d47761476993", "message": "Merge branch 'master' into Read_ingest_pipeline", "committedDate": "2020-12-14T15:21:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQ3OTI0OQ==", "url": "https://github.com/elastic/elasticsearch/pull/66137#discussion_r542479249", "bodyText": "This particular rename won't work flawlessly in a mixed cluster upgrade scenario, because the action is a TransportMasterNodeReadAction.\nSay a non-master node has been upgraded, but the master hasn't yet. If the get pipelines REST request hits the upgraded non-master node, it will forward the transport request to the master node, but it will ask for the renamed action of which master doesn't know about.", "author": "albertzaharovits", "createdAt": "2020-12-14T15:34:53Z", "path": "server/src/main/java/org/elasticsearch/action/ingest/GetPipelineAction.java", "diffHunk": "@@ -24,7 +24,7 @@\n public class GetPipelineAction extends ActionType<GetPipelineResponse> {\n \n     public static final GetPipelineAction INSTANCE = new GetPipelineAction();\n-    public static final String NAME = \"cluster:admin/ingest/pipeline/get\";\n+    public static final String NAME = \"cluster:monitor/ingest/pipeline/get\";", "originalCommit": "72c3a125b92ccdf44a03962aa686d47761476993", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQ4MDc5MQ==", "url": "https://github.com/elastic/elasticsearch/pull/66137#discussion_r542480791", "bodyText": "@albertzaharovits That's what I've just figured out. How do we normally handle such changes?", "author": "BigPandaToo", "createdAt": "2020-12-14T15:36:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQ3OTI0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUwNTEzNg==", "url": "https://github.com/elastic/elasticsearch/pull/66137#discussion_r542505136", "bodyText": "This is a cluster privilege, but it is documented under index privileges.", "author": "albertzaharovits", "createdAt": "2020-12-14T16:06:50Z", "path": "x-pack/docs/en/security/authorization/privileges.asciidoc", "diffHunk": "@@ -288,6 +288,9 @@ clear_scroll, search, suggest, tv).\n `read_cross_cluster`::\n Read-only access to the search action from a <<cross-cluster-configuring,remote cluster>>.\n \n+`read_ingest_pipelines`::\n+Read-only access to ingest pipline (get, simulate).\n+", "originalCommit": "72c3a125b92ccdf44a03962aa686d47761476993", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjcwNjk0OA==", "url": "https://github.com/elastic/elasticsearch/pull/66137#discussion_r542706948", "bodyText": "Fixed", "author": "BigPandaToo", "createdAt": "2020-12-14T19:51:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUwNTEzNg=="}], "type": "inlineReview"}, {"oid": "d9952e242d8fe03959445062f64efda3cc617a13", "url": "https://github.com/elastic/elasticsearch/commit/d9952e242d8fe03959445062f64efda3cc617a13", "message": "Adding \"read ingest pipeline\" cluster privilege\n\nResolving bwc, renaming the action\n\nResolve #48028", "committedDate": "2020-12-14T19:46:09Z", "type": "commit"}, {"oid": "91852258355910b2948c29efa0884224df267af2", "url": "https://github.com/elastic/elasticsearch/commit/91852258355910b2948c29efa0884224df267af2", "message": "Adding \"read ingest pipeline\" cluster privilege\n\nFixing doc\n\nResolve #48028", "committedDate": "2020-12-14T19:50:55Z", "type": "commit"}, {"oid": "2d6635c53bae19abc76a28bc748979440f80db64", "url": "https://github.com/elastic/elasticsearch/commit/2d6635c53bae19abc76a28bc748979440f80db64", "message": "Merge branch 'master' into Read_ingest_pipeline", "committedDate": "2020-12-15T08:22:45Z", "type": "commit"}, {"oid": "b1db485d4496c27620ba3a9f194e5e8920881047", "url": "https://github.com/elastic/elasticsearch/commit/b1db485d4496c27620ba3a9f194e5e8920881047", "message": "Adding \"read ingest pipeline\" cluster privilege\n\nFixing test", "committedDate": "2020-12-15T09:06:48Z", "type": "commit"}, {"oid": "9f9c8e4825335ec4a7aa7cc0f7a491b588404c22", "url": "https://github.com/elastic/elasticsearch/commit/9f9c8e4825335ec4a7aa7cc0f7a491b588404c22", "message": "Adding ingest pipeline privileges test", "committedDate": "2020-12-15T14:55:30Z", "type": "commit"}]}