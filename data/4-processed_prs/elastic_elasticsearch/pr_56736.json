{"pr_number": 56736, "pr_title": "7.x only REST specification fixes", "pr_createdAt": "2020-05-14T02:06:03Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/56736", "timeline": [{"oid": "d8d80e31774969731690dad13c6255258b75d6a0", "url": "https://github.com/elastic/elasticsearch/commit/d8d80e31774969731690dad13c6255258b75d6a0", "message": "7.x only spec fixes", "committedDate": "2020-05-14T01:58:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgzNDMwNg==", "url": "https://github.com/elastic/elasticsearch/pull/56736#discussion_r424834306", "bodyText": "I don't think this should be removed in 7.x. In removing this, it may introduce a breaking change to the client's API and because the major versioning of the clients is in lock step with Elasticsearch, it would be a breaking change to the client's API within a major version.\nTo move forward, we could special case handle an empty string enum option on size for cat.threadpool in the JSON schema.", "author": "russcam", "createdAt": "2020-05-14T02:22:27Z", "path": "rest-api-spec/src/main/resources/rest-api-spec/api/cat.thread_pool.json", "diffHunk": "@@ -36,7 +36,6 @@\n         \"type\":\"enum\",\n         \"description\":\"The multiplier in which to display values\",\n         \"options\":[\n-          \"\",", "originalCommit": "d8d80e31774969731690dad13c6255258b75d6a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgzNDc1NA==", "url": "https://github.com/elastic/elasticsearch/pull/56736#discussion_r424834754", "bodyText": "If it were removed, each client where it would introduce a breaking change would need to specially handle this in their generator", "author": "russcam", "createdAt": "2020-05-14T02:24:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgzNDMwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ1NTUwOA==", "url": "https://github.com/elastic/elasticsearch/pull/56736#discussion_r425455508", "bodyText": "Hmm... i don't see a good way to special case this in the JSON schema. However, if there is a good way I am still a bit hesitant to special case this in the schema. Splippery slope argument about too many special cases and a schema stops being a schema due to special cases ... and a real world concern of readability and keeping 7.x closer inline with master.\nI think that since there exists an API with a \"\" and there is support for it, that \"\" should validate with the schema (but only for 7.x). I added schema support across the board for \"\" in af2780a. This will not be forward ported to master, and since all changes generally go through master first it is pretty unlikely that someone will accidentally try to support \"\" since on master it will fail validation. (note #55736 removed this entirely from master)\nI understand the desire to not break the clients, so I think we can either 1) support \"\" for 7.x, or 2) hard code to ignore this file in the task itself (like we do with _common), or 3) figure out how to special case this in the schema (I will need some assistance with that).\nMy preference is 1 (as in the latest update to this PR) (then 2, then 3)\nthoughts?", "author": "jakelandis", "createdAt": "2020-05-14T22:00:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgzNDMwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzczODkwNg==", "url": "https://github.com/elastic/elasticsearch/pull/56736#discussion_r427738906", "bodyText": "since all changes generally go through master first it is pretty unlikely that someone will accidentally try to support \"\" since on master it will fail validation.\n\nGood point; this sounds like a good argument for not needing to special case \"\" only to cat.threadpool in 7.x since any API changes would be backported from master which would disallow.", "author": "russcam", "createdAt": "2020-05-20T04:47:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgzNDMwNg=="}], "type": "inlineReview"}, {"oid": "8f64dce2392c6e9656f9e88ec0490ecbfc3dff5f", "url": "https://github.com/elastic/elasticsearch/commit/8f64dce2392c6e9656f9e88ec0490ecbfc3dff5f", "message": "Merge remote-tracking branch 'upstream/7.x' into 7.x_spec_fixes", "committedDate": "2020-05-14T21:25:24Z", "type": "commit"}, {"oid": "af2780a5d74d460806b89452677977bd4cbd053e", "url": "https://github.com/elastic/elasticsearch/commit/af2780a5d74d460806b89452677977bd4cbd053e", "message": "add back empty option and make valid via regex", "committedDate": "2020-05-14T21:47:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ1NzY3NQ==", "url": "https://github.com/elastic/elasticsearch/pull/56736#discussion_r425457675", "bodyText": "I hadn't originally back-ported the deprecation to to 7.7, but am on https://github.com/elastic/elasticsearch/pull/56737/files this will help reduce the conflict.", "author": "jakelandis", "createdAt": "2020-05-14T22:06:15Z", "path": "rest-api-spec/src/main/resources/rest-api-spec/api/cat.thread_pool.json", "diffHunk": "@@ -44,7 +44,7 @@\n           \"p\"\n         ],\n         \"deprecated\":{", "originalCommit": "af2780a5d74d460806b89452677977bd4cbd053e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}