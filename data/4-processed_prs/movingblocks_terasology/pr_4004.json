{"pr_number": 4004, "pr_title": "fix: gracefully catch and report errors that happen during game load", "pr_createdAt": "2020-05-30T03:52:06Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/4004", "timeline": [{"oid": "9b7348c02764e1cd4d956a68fa8d408dc247a228", "url": "https://github.com/MovingBlocks/Terasology/commit/9b7348c02764e1cd4d956a68fa8d408dc247a228", "message": "fix: gracefully catch and report errors that happen during game load", "committedDate": "2020-05-30T03:38:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTgyNzI4Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/4004#discussion_r435827286", "bodyText": "If current.getMessage() is a key for a translateable string, you probably \"just\" need to push that through TranslationSystem::translate.\nIn screen layers and widget you'll get it by using @In annotation:\n    @In\n    private TranslationSystem translationSystem;", "author": "skaldarnar", "createdAt": "2020-06-05T10:15:44Z", "path": "engine/src/main/java/org/terasology/engine/modes/StateLoading.java", "diffHunk": "@@ -243,8 +245,17 @@ public void update(float delta) {\n         EngineTime time = (EngineTime) context.get(Time.class);\n         long startTime = time.getRealTimeInMs();\n         while (current != null && time.getRealTimeInMs() - startTime < 20 && !gameEngine.hasPendingState()) {\n-            if (current.step()) {\n-                popStep();\n+            try {\n+                if (current.step()) {\n+                    popStep();\n+                }\n+            } catch (Exception e) {\n+                logger.error(\"Error while loading {}\", current, e);\n+                String errorMessage = String.format(\"Failed to load game. There was an error during %s.\",\n+                        current == null ? \"the last part\" : current.getMessage());", "originalCommit": "9b7348c02764e1cd4d956a68fa8d408dc247a228", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc5NzIyMA==", "url": "https://github.com/MovingBlocks/Terasology/pull/4004#discussion_r437797220", "bodyText": "Okay, I've made it so the part of StateMainMenu that shows these messages will run them through the translation system.", "author": "keturn", "createdAt": "2020-06-10T00:39:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTgyNzI4Ng=="}], "type": "inlineReview"}, {"oid": "17db214b6927b29f7c116aeb20653ab915a69454", "url": "https://github.com/MovingBlocks/Terasology/commit/17db214b6927b29f7c116aeb20653ab915a69454", "message": "Merge remote-tracking branch 'origin/develop' into fix/reportLoadingCrashes", "committedDate": "2020-06-08T16:15:35Z", "type": "commit"}, {"oid": "08a952baaff93cefa4e7e773b6cdbf0c80173d25", "url": "https://github.com/MovingBlocks/Terasology/commit/08a952baaff93cefa4e7e773b6cdbf0c80173d25", "message": "fix(StateLoading): show localized messageOnLoad", "committedDate": "2020-06-08T19:56:19Z", "type": "commit"}]}