{"pr_number": 4089, "pr_title": "feat(FlowLayout): add option for vertical spacing", "pr_createdAt": "2020-07-18T19:09:49Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/4089", "timeline": [{"oid": "467719a99c9e86d410f0029f25128a78ed01e100", "url": "https://github.com/MovingBlocks/Terasology/commit/467719a99c9e86d410f0029f25128a78ed01e100", "message": "feat(FlowLayout): added option to add vertical spacing between inserted items", "committedDate": "2020-07-18T18:42:33Z", "type": "commit"}, {"oid": "1cfa1a03abcdd0ba4c4e505ef99b63cb25479c39", "url": "https://github.com/MovingBlocks/Terasology/commit/1cfa1a03abcdd0ba4c4e505ef99b63cb25479c39", "message": "just code formating", "committedDate": "2020-07-18T18:47:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyMDA1NQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/4089#discussion_r456820055", "bodyText": "This adds a height offset after each element, but I think this should only happen in case there is a \"wrap\", i.e., inside the conditional above.", "author": "skaldarnar", "createdAt": "2020-07-18T19:25:43Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -54,14 +62,15 @@ public void onDraw(Canvas canvas) {\n         int heightOffset = 0;\n         for (UIWidget widget : contents) {\n             Vector2i size = canvas.calculatePreferredSize(widget);\n-            if (filledWidth != 0 && filledWidth + size.x  > canvas.size().x) {\n+            if (filledWidth != 0 && filledWidth + size.x > canvas.size().x) {\n                 heightOffset += filledHeight;\n                 filledWidth = 0;\n                 filledHeight = 0;\n             }\n             canvas.drawWidget(widget, Rect2i.createFromMinAndSize(filledWidth, heightOffset, size.x, size.y));\n             filledWidth += size.x;\n             filledHeight = Math.max(filledHeight, size.y);\n+            heightOffset += verticalSpacing;", "originalCommit": "1cfa1a03abcdd0ba4c4e505ef99b63cb25479c39", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyMTA3Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/4089#discussion_r456821076", "bodyText": "oh indeed, I'll look into adding it only when there is a wrap, and then make a commit for it!", "author": "stefaniamak", "createdAt": "2020-07-18T19:38:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyMDA1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyMDEzNQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/4089#discussion_r456820135", "bodyText": "I think the vertical spacing should be added here, instead:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            heightOffset += filledHeight;\n          \n          \n            \n                            heightOffset += filledHeight;\n          \n          \n            \n                            heightOffset += verticalSpacing;\n          \n      \n    \n    \n  \n\nThis part of the code resets the filled width and height after increasing the height offset, e.g., after wrapping the line.", "author": "skaldarnar", "createdAt": "2020-07-18T19:26:38Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -54,14 +62,15 @@ public void onDraw(Canvas canvas) {\n         int heightOffset = 0;\n         for (UIWidget widget : contents) {\n             Vector2i size = canvas.calculatePreferredSize(widget);\n-            if (filledWidth != 0 && filledWidth + size.x  > canvas.size().x) {\n+            if (filledWidth != 0 && filledWidth + size.x > canvas.size().x) {\n                 heightOffset += filledHeight;", "originalCommit": "1cfa1a03abcdd0ba4c4e505ef99b63cb25479c39", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyMTM3Mw==", "url": "https://github.com/MovingBlocks/Terasology/pull/4089#discussion_r456821373", "bodyText": "I see I see, that seems like it, yes. Placed it in that position at the very start (because the other filledHeight was there, not because I had the wrapping in mind), but among my other changes till I reach the correct solution I changed it. I'll commit the suggestion \ud83d\udc4d", "author": "stefaniamak", "createdAt": "2020-07-18T19:42:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjgyMDEzNQ=="}], "type": "inlineReview"}, {"oid": "4c65364ac8819f4f671316b8cc002b86a0324b10", "url": "https://github.com/MovingBlocks/Terasology/commit/4c65364ac8819f4f671316b8cc002b86a0324b10", "message": "Addition of spacing only within wrapping lines, not within each element\n\nCo-authored-by: Tobias Nett <skaldarnar@googlemail.com>", "committedDate": "2020-07-18T19:43:01Z", "type": "commit"}, {"oid": "f5035508c378a6ae1b400e884e04723b53a88dac", "url": "https://github.com/MovingBlocks/Terasology/commit/f5035508c378a6ae1b400e884e04723b53a88dac", "message": "removed duplicated line", "committedDate": "2020-07-18T19:47:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE1MDM0OQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/4089#discussion_r457150349", "bodyText": "Good point - that's something I missed before \ud83d\udc4d\nI think you can only multiply with the number of elements in the content if you can make sure that there is only one element per row. However, if you make the flow are bigger, you should see that there might be multiple widgets in the same row before the automatic wrapping kicks in.", "author": "skaldarnar", "createdAt": "2020-07-20T07:58:35Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -83,7 +92,7 @@ public Vector2i getPreferredContentSize(Canvas canvas, Vector2i sizeHint) {\n             }\n         }\n         result.x = Math.max(result.x, filledWidth);\n-        result.y += filledHeight;\n+        result.y += filledHeight + verticalSpacing * (contents.size() - 1);", "originalCommit": "f5035508c378a6ae1b400e884e04723b53a88dac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE2MTU3Mw==", "url": "https://github.com/MovingBlocks/Terasology/pull/4089#discussion_r457161573", "bodyText": "Indeed, this is a similar note with the one for adding the spacing in the first place, should have thought about that. I'll look into changing contents.size() - 1 with a variable that counts the rows of the FlowLayout!", "author": "stefaniamak", "createdAt": "2020-07-20T08:14:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE1MDM0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzIwNzA4Mg==", "url": "https://github.com/MovingBlocks/Terasology/pull/4089#discussion_r457207082", "bodyText": "I think it might be enough to just increment result.y by verticalSpacing whenever the spacing is applied to the offset.", "author": "skaldarnar", "createdAt": "2020-07-20T09:14:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE1MDM0OQ=="}], "type": "inlineReview"}, {"oid": "fe82279581ce3c9a061539ddeb48daafabde4c8b", "url": "https://github.com/MovingBlocks/Terasology/commit/fe82279581ce3c9a061539ddeb48daafabde4c8b", "message": "fix: space is added only whenever a wrapping happens", "committedDate": "2020-07-20T18:27:49Z", "type": "commit"}, {"oid": "27e0d6e50e29111ec440fe6246b11559082effcc", "url": "https://github.com/MovingBlocks/Terasology/commit/27e0d6e50e29111ec440fe6246b11559082effcc", "message": "chore: comment corrections", "committedDate": "2020-07-20T18:49:19Z", "type": "commit"}]}