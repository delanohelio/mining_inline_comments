{"pr_number": 3638, "pr_title": "feat(clients/go): require context to send commands", "pr_createdAt": "2020-01-11T14:22:21Z", "pr_url": "https://github.com/camunda-cloud/zeebe/pull/3638", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4MzU4MA==", "url": "https://github.com/camunda-cloud/zeebe/pull/3638#discussion_r365683580", "bodyText": "Would that make it so now we actually get the logs properly?", "author": "npepinpe", "createdAt": "2020-01-13T08:28:18Z", "path": "Jenkinsfile", "diffHunk": "@@ -74,6 +74,13 @@ pipeline {\n                     sh '.ci/scripts/distribution/test-go.sh'\n                 }\n             }\n+\n+            post {", "originalCommit": "f1cf5a07098fb924621a9ac45465ca3216d23376", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcwMjY1Mw==", "url": "https://github.com/camunda-cloud/zeebe/pull/3638#discussion_r365702653", "bodyText": "What you mean by properly? This makes so the results of the go tests are posted as soon as they end instead of when all tests end. This makes it easier and faster to catch problems in the integration tests. Since before we weren't always building the zbctl binary, it happened frequently that it was outdated and some minor thing broke the integration tests. Now, not only we catch them more easily locally (although it's slower to run the IT tests) but if something fails on the CI we see it quicker as well. However, there is still a bug in the output that makes the '+' and '-' signs disappear from diffs, if that's what you meant", "author": "MiguelPires", "createdAt": "2020-01-13T09:22:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4MzU4MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY5NjAyOQ==", "url": "https://github.com/camunda-cloud/zeebe/pull/3638#discussion_r365696029", "bodyText": "Just a small thing, wouldn't it be clearer to have a type here instead of a raw function signature for the retry predicate?", "author": "npepinpe", "createdAt": "2020-01-13T09:04:40Z", "path": "clients/go/pkg/commands/activateJobs_command.go", "diffHunk": "@@ -116,16 +107,14 @@ func (cmd *ActivateJobsCommand) Send() ([]entities.Job, error) {\n \treturn activatedJobs, nil\n }\n \n-func NewActivateJobsCommand(gateway pb.GatewayClient, requestTimeout time.Duration, retryPredicate func(context.Context, error) bool) ActivateJobsCommandStep1 {\n+func NewActivateJobsCommand(gateway pb.GatewayClient, retryPredicate func(context.Context, error) bool) ActivateJobsCommandStep1 {", "originalCommit": "f1cf5a07098fb924621a9ac45465ca3216d23376", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcxMTc3Mw==", "url": "https://github.com/camunda-cloud/zeebe/pull/3638#discussion_r365711773", "bodyText": "Yes! I think we discussed it when the retry logic was introduced but I'm not sure what the argument was. Maybe it was because like this it's clearer what you have to pass to it, rather than if it's just a type retryPredicate. But I agree it should be refactored, I can do it in this issue since you mention it", "author": "MiguelPires", "createdAt": "2020-01-13T09:43:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY5NjAyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY5ODg2Ng==", "url": "https://github.com/camunda-cloud/zeebe/pull/3638#discussion_r365698866", "bodyText": "Is longPollMillis also coming from activateJobs_command_test.go? In this case, shouldn't we use utils.DefaultTestTimeout instead of 5*time.Second when creating the context here as well?", "author": "npepinpe", "createdAt": "2020-01-13T09:12:36Z", "path": "clients/go/pkg/commands/createInstance_command_test.go", "diffHunk": "@@ -372,7 +373,7 @@ func TestCreateWorkflowInstanceWithResultCommand(t *testing.T) {\n \t\tRequest: &pb.CreateWorkflowInstanceRequest{\n \t\t\tWorkflowKey: 123,\n \t\t},\n-\t\tRequestTimeout: utils.DefaultTestTimeoutInMs,\n+\t\tRequestTimeout: longPollMillis,", "originalCommit": "f1cf5a07098fb924621a9ac45465ca3216d23376", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTcxNTkyMA==", "url": "https://github.com/camunda-cloud/zeebe/pull/3638#discussion_r365715920", "bodyText": "Yes, that's a mistake", "author": "MiguelPires", "createdAt": "2020-01-13T09:52:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY5ODg2Ng=="}], "type": "inlineReview"}, {"oid": "c9d415c4e355928313854ea5826a14c51b592061", "url": "https://github.com/camunda-cloud/zeebe/commit/c9d415c4e355928313854ea5826a14c51b592061", "message": "feat(clients/go): require context to send commands\n\nBREAKING CHANGE:\nAdds a context.Context to the #Send() method of every command. The command timeout can only be set in this context\nRenamed package 'containerSuite' to 'containersuite'\nThe long-polling timeout can't be configured manually and is now set as 90% or 10s less than the context timeout.", "committedDate": "2020-01-13T09:56:23Z", "type": "forcePushed"}, {"oid": "86cd812831bef5984e0a239a0dc21ce9398adf33", "url": "https://github.com/camunda-cloud/zeebe/commit/86cd812831bef5984e0a239a0dc21ce9398adf33", "message": "feat(clients/go): require context to send commands\n\nBREAKING CHANGE:\nAdds a context.Context to the #Send() method of every command. The command timeout can only be set in this context\nRenamed package 'containerSuite' to 'containersuite'\nThe long-polling timeout can't be configured manually and is now set as 90% or 10s less than the context timeout.", "committedDate": "2020-01-13T10:20:25Z", "type": "commit"}, {"oid": "86cd812831bef5984e0a239a0dc21ce9398adf33", "url": "https://github.com/camunda-cloud/zeebe/commit/86cd812831bef5984e0a239a0dc21ce9398adf33", "message": "feat(clients/go): require context to send commands\n\nBREAKING CHANGE:\nAdds a context.Context to the #Send() method of every command. The command timeout can only be set in this context\nRenamed package 'containerSuite' to 'containersuite'\nThe long-polling timeout can't be configured manually and is now set as 90% or 10s less than the context timeout.", "committedDate": "2020-01-13T10:20:25Z", "type": "forcePushed"}]}