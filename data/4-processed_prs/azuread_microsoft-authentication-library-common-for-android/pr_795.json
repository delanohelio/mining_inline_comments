{"pr_number": 795, "pr_title": "Add spinner on first page load", "pr_createdAt": "2020-01-29T22:02:39Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/795", "timeline": [{"oid": "8c6cc8e7a21f10c05f4c2ceb735a91b2268c478d", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/8c6cc8e7a21f10c05f4c2ceb735a91b2268c478d", "message": "Add spinner on first page load", "committedDate": "2020-01-29T22:02:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY2ODQyMQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/795#discussion_r372668421", "bodyText": "As a thought, what if this callback also listened for onPageStarted() so that the WebView determines both when to show and dismiss the spinner? Currently there's a bit of action-at-a-distance where onStart() shows and the callback hides.", "author": "iambmelt", "createdAt": "2020-01-29T22:33:19Z", "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/WebViewAuthorizationFragment.java", "diffHunk": "@@ -80,10 +84,18 @@ void extractState(final Bundle state){\n     @Override\n     public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\n         final View view = inflater.inflate(R.layout.common_activity_authentication, container, false);\n+        mProgressBar = view.findViewById(R.id.common_auth_webview_progressbar);\n \n         AzureActiveDirectoryWebViewClient webViewClient = new AzureActiveDirectoryWebViewClient(\n                 getActivity(),\n-                new AuthorizationCompletionCallback(), mRedirectUri);\n+                new AuthorizationCompletionCallback(),\n+                new OnPageLoadedCallback() {", "originalCommit": "8c6cc8e7a21f10c05f4c2ceb735a91b2268c478d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY3MjkwMg==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/795#discussion_r372672902", "bodyText": "I took that out because OAuth2WebViewClient.onPageStarted() is invoked every time a new page is loaded, and we don't want that because the user would see 2 progress bar at the same time (One rendered by the server, and the other by us).", "author": "rpdome", "createdAt": "2020-01-29T22:44:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY2ODQyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY3MzQ4Mw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/795#discussion_r372673483", "bodyText": "Oh yuck. OK, thanks Dome", "author": "iambmelt", "createdAt": "2020-01-29T22:46:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY2ODQyMQ=="}], "type": "inlineReview"}]}