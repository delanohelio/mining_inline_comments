{"pr_number": 1156, "pr_title": "Log an informative error message, when broker redirect_uri is mismatched - Closes #1155", "pr_createdAt": "2020-12-09T23:29:58Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1156", "timeline": [{"oid": "2eb49540a8f9ba5d4208c56fa976c307768c06fc", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2eb49540a8f9ba5d4208c56fa976c307768c06fc", "message": "Closes #1155", "committedDate": "2020-12-09T23:27:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcyNzIzMg==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1156#discussion_r539727232", "bodyText": "nit: Do we need a multiline log statement here?", "author": "AdamBJohnsonx", "createdAt": "2020-12-09T23:32:21Z", "path": "common/src/main/java/com/microsoft/identity/common/internal/broker/BrokerValidator.java", "diffHunk": "@@ -257,7 +256,24 @@ private X509Certificate getSelfSignedCert(final List<X509Certificate> certs)\n     public static boolean isValidBrokerRedirect(@Nullable final String redirectUri,\n                                                 @NonNull final Context context,\n                                                 @NonNull final String packageName) {\n-        return StringUtil.equalsIgnoreCase(redirectUri, getBrokerRedirectUri(context, packageName));\n+        final String methodName = \":isValidBrokerRedirect\";\n+        final String expectedBrokerRedirectUri = getBrokerRedirectUri(context, packageName);\n+        final boolean isValidBrokerRedirect = StringUtil.equalsIgnoreCase(redirectUri, expectedBrokerRedirectUri);\n+\n+        if (!isValidBrokerRedirect) {\n+            Logger.error(\n+                    TAG + methodName,\n+                    \"Broker redirect uri is invalid.\"\n+                            + \"\\n\"\n+                            + \"Expected: \" + expectedBrokerRedirectUri\n+                            + \"\\n\"\n+                            + \"Actual: \" + redirectUri\n+                    ,\n+                    null", "originalCommit": "2eb49540a8f9ba5d4208c56fa976c307768c06fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcyODI5Nw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1156#discussion_r539728297", "bodyText": "Personally I think it's easier to read, but I appreciate this is subjective. Is your suggestion to condense this to a single line or to log this altogether differently?", "author": "iambmelt", "createdAt": "2020-12-09T23:34:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcyNzIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTczNDgxMA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1156#discussion_r539734810", "bodyText": "A single line is best.  If we need to put structure on it, we can do it inside of a line.  (Log injection attacks are a thing.)", "author": "AdamBJohnsonx", "createdAt": "2020-12-09T23:48:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcyNzIzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTc0MDcxMA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1156#discussion_r539740710", "bodyText": "d64813b", "author": "iambmelt", "createdAt": "2020-12-10T00:02:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcyNzIzMg=="}], "type": "inlineReview"}, {"oid": "afb5c4e0ee59fab5f9f5c8b9d72f114acc0c47e8", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/afb5c4e0ee59fab5f9f5c8b9d72f114acc0c47e8", "message": "Merge branch 'dev' into iambmelt/1155", "committedDate": "2020-12-09T23:35:18Z", "type": "commit"}, {"oid": "8aea0a320fac4153a1be00b9f0bde40b69d941fe", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/8aea0a320fac4153a1be00b9f0bde40b69d941fe", "message": "Update changelog", "committedDate": "2020-12-09T23:37:12Z", "type": "commit"}, {"oid": "0ba315d9844276826b443fa641a182e6735785fc", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/0ba315d9844276826b443fa641a182e6735785fc", "message": "Merge branch 'iambmelt/1155' of https://github.com/AzureAD/microsoft-authentication-library-common-for-android into iambmelt/1155", "committedDate": "2020-12-09T23:37:19Z", "type": "commit"}, {"oid": "0092674e3d4be0f5a8792b95bfa565c33fcd554b", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/0092674e3d4be0f5a8792b95bfa565c33fcd554b", "message": "Merge branch 'dev' into iambmelt/1155", "committedDate": "2020-12-09T23:37:55Z", "type": "commit"}, {"oid": "7750fcc23e709526ff61e63173d0aec164cc803e", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/7750fcc23e709526ff61e63173d0aec164cc803e", "message": "Merge error fix", "committedDate": "2020-12-09T23:48:24Z", "type": "commit"}, {"oid": "d64813b138042f882c398ad2899edf21019720f3", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/d64813b138042f882c398ad2899edf21019720f3", "message": "Log redirect_uri output on a single line", "committedDate": "2020-12-09T23:57:06Z", "type": "commit"}, {"oid": "b80c185a05efaee2388b4061e013dd76e3cc8c04", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/b80c185a05efaee2388b4061e013dd76e3cc8c04", "message": "Merge branch 'dev' into iambmelt/1155", "committedDate": "2020-12-10T16:15:21Z", "type": "commit"}]}