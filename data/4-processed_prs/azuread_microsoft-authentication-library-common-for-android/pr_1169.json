{"pr_number": 1169, "pr_title": "Set up CI with Azure Pipelines", "pr_createdAt": "2020-12-21T19:30:47Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169", "timeline": [{"oid": "5112c7caec7dc49d4c8bae5bfed4decf5bca3381", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/5112c7caec7dc49d4c8bae5bfed4decf5bca3381", "message": "Set up CI with Azure Pipelines\n\nTrying out new self-hosted build agent with docker and docker images already installed and pulled. [skip ci]", "committedDate": "2020-12-21T19:30:45Z", "type": "commit"}, {"oid": "fe67b4af5ad1bd5ebea51b5ba081f5819b7f4852", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/fe67b4af5ad1bd5ebea51b5ba081f5819b7f4852", "message": "add script", "committedDate": "2020-12-21T21:54:18Z", "type": "commit"}, {"oid": "460588762ff2023f7f992f53bd6ce5ba2946e7e0", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/460588762ff2023f7f992f53bd6ce5ba2946e7e0", "message": "Update azure-pipelines.yml for Azure Pipelines", "committedDate": "2020-12-21T21:56:55Z", "type": "commit"}, {"oid": "88a91b904ecccd38af9ab2fa2f9b0c15f0bf39cd", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/88a91b904ecccd38af9ab2fa2f9b0c15f0bf39cd", "message": "Updated script", "committedDate": "2020-12-21T22:01:23Z", "type": "commit"}, {"oid": "cc95236bb4924e107f8f83713e759ba29d80b814", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/cc95236bb4924e107f8f83713e759ba29d80b814", "message": "updated script", "committedDate": "2020-12-21T22:07:50Z", "type": "commit"}, {"oid": "a36a94e7c67bd018ab9ad6ec5ce6b38647323bba", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a36a94e7c67bd018ab9ad6ec5ce6b38647323bba", "message": "Updated script", "committedDate": "2020-12-21T22:13:17Z", "type": "commit"}, {"oid": "3e6d705c1f162da270741c3dcedfa5750b16c8ba", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/3e6d705c1f162da270741c3dcedfa5750b16c8ba", "message": "Updated script", "committedDate": "2020-12-21T22:31:30Z", "type": "commit"}, {"oid": "ba554653205395f4fa01361a57587b7eb8028fc3", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ba554653205395f4fa01361a57587b7eb8028fc3", "message": "Updated script", "committedDate": "2020-12-21T23:02:20Z", "type": "commit"}, {"oid": "ffe9e7b254fdfd79bc6ebf5f0202d0166dcaa1c9", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/ffe9e7b254fdfd79bc6ebf5f0202d0166dcaa1c9", "message": "Updating scripts", "committedDate": "2020-12-21T23:29:07Z", "type": "commit"}, {"oid": "a841286330b098d1c7f38550568ee17284ccf7cc", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a841286330b098d1c7f38550568ee17284ccf7cc", "message": "try to fix second checkout error", "committedDate": "2020-12-21T23:49:16Z", "type": "commit"}, {"oid": "29ff3194c86880b8a17deb65fe3a40100deff553", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/29ff3194c86880b8a17deb65fe3a40100deff553", "message": "delete cloned repo from _work folder on build agent", "committedDate": "2020-12-22T02:37:12Z", "type": "commit"}, {"oid": "18d10d95b5b9f1e7894204974376666d0a0a5cf5", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/18d10d95b5b9f1e7894204974376666d0a0a5cf5", "message": "move delete to a cleanup task", "committedDate": "2020-12-22T02:38:13Z", "type": "commit"}, {"oid": "b02c8f4167d969eb64f34fb910e837e6e9a62baa", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/b02c8f4167d969eb64f34fb910e837e6e9a62baa", "message": "trying to change ownership of docker generated files", "committedDate": "2020-12-22T03:33:05Z", "type": "commit"}, {"oid": "e28fdae220617f10788a1323ff1c951e2f5a602f", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/e28fdae220617f10788a1323ff1c951e2f5a602f", "message": "different approach", "committedDate": "2020-12-22T03:50:51Z", "type": "commit"}, {"oid": "2d204805ea1e547d30b6f5e63e48289e2971b1f6", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2d204805ea1e547d30b6f5e63e48289e2971b1f6", "message": "Cleanup and add unit test execution", "committedDate": "2020-12-22T04:20:55Z", "type": "commit"}, {"oid": "04293c3b74b055f190acae3adb129d4cd09858d9", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/04293c3b74b055f190acae3adb129d4cd09858d9", "message": "Formatting and adding debug flag", "committedDate": "2020-12-22T04:34:46Z", "type": "commit"}, {"oid": "07a03e291a551808afa0e8063574110a440d5586", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/07a03e291a551808afa0e8063574110a440d5586", "message": "Switch to info from debug.  Too much output", "committedDate": "2020-12-22T05:00:52Z", "type": "commit"}, {"oid": "bd4a5a93119b522f93777b794abd9dd492d0f384", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/bd4a5a93119b522f93777b794abd9dd492d0f384", "message": "combine commands", "committedDate": "2020-12-22T05:28:06Z", "type": "commit"}, {"oid": "0a81eeff449357033cdd693c8b850c5a581e8e4d", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/0a81eeff449357033cdd693c8b850c5a581e8e4d", "message": "move clean up to separate docker run command", "committedDate": "2020-12-22T05:31:50Z", "type": "commit"}, {"oid": "f6f3c7312a0ad49c64139d06914dcebf876f4fa2", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f6f3c7312a0ad49c64139d06914dcebf876f4fa2", "message": "remove apostrephe", "committedDate": "2020-12-22T05:46:12Z", "type": "commit"}, {"oid": "c14a6ba4cbeb215d1ce995ae5ef6ebefeca71916", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/c14a6ba4cbeb215d1ce995ae5ef6ebefeca71916", "message": "add docker system prune to remove shutdown containers", "committedDate": "2020-12-22T06:44:27Z", "type": "commit"}, {"oid": "39b4c1964994f3e5f46455e451663f428d3c40cc", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/39b4c1964994f3e5f46455e451663f428d3c40cc", "message": "Add workspace clean statement", "committedDate": "2020-12-22T15:12:49Z", "type": "commit"}, {"oid": "24f92427d48164693acee524f9fc3dbcc2e365bf", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/24f92427d48164693acee524f9fc3dbcc2e365bf", "message": "See if workspace clean can work instead of gradle clean inside container", "committedDate": "2020-12-22T15:14:45Z", "type": "commit"}, {"oid": "82ec2049a4436163e48e5930f0b49a5128d1c21f", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/82ec2049a4436163e48e5930f0b49a5128d1c21f", "message": "Put back gradle clean", "committedDate": "2020-12-22T15:28:12Z", "type": "commit"}, {"oid": "10c10f684609f139a3826223ab4ed13cd3bd19a3", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/10c10f684609f139a3826223ab4ed13cd3bd19a3", "message": "removed travis", "committedDate": "2020-12-22T15:46:05Z", "type": "commit"}, {"oid": "4cd3ecd805d06e3967d976eace35fea1c8300b55", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/4cd3ecd805d06e3967d976eace35fea1c8300b55", "message": "removed unit tests", "committedDate": "2020-12-22T15:48:14Z", "type": "commit"}, {"oid": "8604c7fe0106334035884c7e91ee1d18dac75bb9", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/8604c7fe0106334035884c7e91ee1d18dac75bb9", "message": "modified delete workspace command", "committedDate": "2020-12-22T15:55:41Z", "type": "commit"}, {"oid": "1994ac82963e975175543f683b0b9f6a5cce5a6d", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/1994ac82963e975175543f683b0b9f6a5cce5a6d", "message": "put back gradle clean", "committedDate": "2020-12-22T16:06:30Z", "type": "commit"}, {"oid": "e6ffb2740716666282ab1f6912e6ba6d8ac0ac7a", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/e6ffb2740716666282ab1f6912e6ba6d8ac0ac7a", "message": "Change name of pipeline to something more descriptive", "committedDate": "2020-12-22T16:25:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4MTA5MA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547381090", "bodyText": "some reason to do this?  It seems strange.", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T16:40:46Z", "path": "azure-pipelines.yml", "diffHunk": "@@ -0,0 +1,36 @@\n+name: Instrumented Tests\n+trigger:\n+- main\n+\n+\n+pool:\n+ name: DockerBuildAgents\n+\n+workspace:\n+  clean: all\n+steps:\n+- script: |\n+    docker --version\n+    echo =============================================\n+    echo Kill all running containers if existing\n+    echo =============================================\n+    docker container kill $(docker ps -q)\n+    echo =============================================\n+    echo Run unit and instrumented inside docker container\n+    echo =============================================\n+    docker run --privileged --cpus=\"3\" --memory=\"12g\" -v \"$PWD\":/home/gradle/ -w /home/gradle/ authclient.azurecr.io/samples/dbi-instrumented-api30 sh scripts/run-instrumented-tests.sh\n+  displayName: 'Build and test inside docker container'\n+- script: |\n+    echo =============================================\n+    echo Cleaning up build output that is owned by docker user rather than agent user\n+    echo =============================================\n+    docker run --privileged --cpus=\"3\" --memory=\"12g\" -v \"$PWD\":/home/gradle/ -w /home/gradle/ authclient.azurecr.io/samples/dbi-instrumented-api30 gradle clean\n+    echo =============================================\n+    echo prune containers to avoid running out of disk space - shutdown containers still exist on disk\n+    echo =============================================\n+    docker system prune -f\n+    echo =============================================\n+    echo Dump environment variables for build agent\n+    echo =============================================\n+    env", "originalCommit": "e6ffb2740716666282ab1f6912e6ba6d8ac0ac7a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4Mjk4OQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547382989", "bodyText": "Mostly it's for debugging.  In case something unexpected happens.", "author": "shoatman", "createdAt": "2020-12-22T16:44:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4MTA5MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4MjM3Mg==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547382372", "bodyText": "It'd be pretty cool to cache these containers and script their creation.  So when we move to API31, all we need to do is change this number.  Can the API version be a variable?", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T16:43:19Z", "path": "azure-pipelines.yml", "diffHunk": "@@ -0,0 +1,36 @@\n+name: Instrumented Tests\n+trigger:\n+- main\n+\n+\n+pool:\n+ name: DockerBuildAgents\n+\n+workspace:\n+  clean: all\n+steps:\n+- script: |\n+    docker --version\n+    echo =============================================\n+    echo Kill all running containers if existing\n+    echo =============================================\n+    docker container kill $(docker ps -q)\n+    echo =============================================\n+    echo Run unit and instrumented inside docker container\n+    echo =============================================\n+    docker run --privileged --cpus=\"3\" --memory=\"12g\" -v \"$PWD\":/home/gradle/ -w /home/gradle/ authclient.azurecr.io/samples/dbi-instrumented-api30 sh scripts/run-instrumented-tests.sh", "originalCommit": "e6ffb2740716666282ab1f6912e6ba6d8ac0ac7a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4Mzc4NQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547383785", "bodyText": "I'm going to check the handlebars templates for the docker files into android-complete, but yes the docker file generation is template and you can change several different variables to produce a different image including: build tools version, api level, type of image (google_apis, default, etc), abi of image, JDK version, etc....", "author": "shoatman", "createdAt": "2020-12-22T16:46:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4MjM3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4NTAwOQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547385009", "bodyText": "The container image is cached in an azure container registry.  Hence the long image name which is a prefix of the azure container registry service endpoint.", "author": "shoatman", "createdAt": "2020-12-22T16:48:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4MjM3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5MDg0MQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547390841", "bodyText": "I'm fine with the long name. ;-)", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T16:59:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4MjM3Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4Mjg2NQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547382865", "bodyText": "Yeah, if the API version and/or docker target can become variables so we don't need to keep them in sync manually that would help the next person not mess it up.", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T16:44:16Z", "path": "azure-pipelines.yml", "diffHunk": "@@ -0,0 +1,36 @@\n+name: Instrumented Tests\n+trigger:\n+- main\n+\n+\n+pool:\n+ name: DockerBuildAgents\n+\n+workspace:\n+  clean: all\n+steps:\n+- script: |\n+    docker --version\n+    echo =============================================\n+    echo Kill all running containers if existing\n+    echo =============================================\n+    docker container kill $(docker ps -q)\n+    echo =============================================\n+    echo Run unit and instrumented inside docker container\n+    echo =============================================\n+    docker run --privileged --cpus=\"3\" --memory=\"12g\" -v \"$PWD\":/home/gradle/ -w /home/gradle/ authclient.azurecr.io/samples/dbi-instrumented-api30 sh scripts/run-instrumented-tests.sh\n+  displayName: 'Build and test inside docker container'\n+- script: |\n+    echo =============================================\n+    echo Cleaning up build output that is owned by docker user rather than agent user\n+    echo =============================================\n+    docker run --privileged --cpus=\"3\" --memory=\"12g\" -v \"$PWD\":/home/gradle/ -w /home/gradle/ authclient.azurecr.io/samples/dbi-instrumented-api30 gradle clean", "originalCommit": "e6ffb2740716666282ab1f6912e6ba6d8ac0ac7a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4NDY3Mw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547384673", "bodyText": "The images themselves are specific to API versions.  At some point I want to play with a matrix pipeline where the instrumented tests are run against multiple different docker images each with their own api level configuration.", "author": "shoatman", "createdAt": "2020-12-22T16:47:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4Mjg2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4OTY2Nw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547389667", "bodyText": "Main feedback here is \"can we put the long name into a variable in the pipeline setup file so we don't have to repeat it exactly\".", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T16:57:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4Mjg2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4NjIyNQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547386225", "bodyText": "sleep 30 the best we can do?  Maybe something here: https://stackoverflow.com/questions/3634041/detect-when-android-emulator-is-fully-booted or here https://androidstudio.googleblog.com/2019/05/emulator-2907-canary.html ?\nmaybe -no-boot-anim ?\nRegardless, if you're going to sleep, you should print how long you're sleeping for so people watching the output know.", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T16:50:38Z", "path": "scripts/run-instrumented-tests.sh", "diffHunk": "@@ -0,0 +1,13 @@\n+#!/bin/bash\n+echo =============================================\n+echo Starting ADB Daemon\n+echo =============================================\n+adb start-server\n+emulator @test -no-window -no-audio -wipe-data &\n+sleep 30", "originalCommit": "e6ffb2740716666282ab1f6912e6ba6d8ac0ac7a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4NzMzNA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547387334", "bodyText": "It's a headless emulator.  adb wait-for-device was hanging so i added the sleep for now while investigating other alternatives.\nIt's not actually necessary... more a reminder to future engineers....The emulator currently starts in 1-1.5 minutes and gradle is currently looking for depedencies for at least 4 minutes.", "author": "shoatman", "createdAt": "2020-12-22T16:52:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4NjIyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5MjU1Ng==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547392556", "bodyText": "Cool.  I do like scripting that says \"Sleeping for <x> <timeunits> because <reason>\" so that operators reading the term know what's happening.  I'd rather have it be bulletproof so that we can't break it by fixing the build speed (in some better, future world)... what happens if it outruns the emulator, though?", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T17:03:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4NjIyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4ODI0OQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547388249", "bodyText": "Can we make this more prominent, like including it in the banner below with backticks?", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T16:54:46Z", "path": "scripts/run-instrumented-tests.sh", "diffHunk": "@@ -0,0 +1,13 @@\n+#!/bin/bash\n+echo =============================================\n+echo Starting ADB Daemon\n+echo =============================================\n+adb start-server\n+emulator @test -no-window -no-audio -wipe-data &\n+sleep 30\n+gradle -version", "originalCommit": "e6ffb2740716666282ab1f6912e6ba6d8ac0ac7a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4OTYxOQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547389619", "bodyText": "All of the commands or something specific?  I'm fine with making all of this more prominent. :-)", "author": "shoatman", "createdAt": "2020-12-22T16:57:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4ODI0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM5OTI5NA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547399294", "bodyText": "It (the code review tool) doesn't do a good job of this (highlighting the single line I left the comment on), but the Gradle version being run.", "author": "AdamBJohnsonx", "createdAt": "2020-12-22T17:16:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM4ODI0OQ=="}], "type": "inlineReview"}, {"oid": "e9b6b56aba6c64c8983d713d414b92e477c4ce91", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/e9b6b56aba6c64c8983d713d414b92e477c4ce91", "message": "Merge branch 'dev' into azure-pipelines", "committedDate": "2020-12-22T18:27:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ0MDAxMg==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1169#discussion_r547440012", "bodyText": "nit: Run unit and instrumented tests inside docker container", "author": "iamgusain", "createdAt": "2020-12-22T18:35:44Z", "path": "azure-pipelines.yml", "diffHunk": "@@ -0,0 +1,36 @@\n+name: Instrumented Tests\n+trigger:\n+- main\n+\n+\n+pool:\n+ name: DockerBuildAgents\n+\n+workspace:\n+  clean: all\n+steps:\n+- script: |\n+    docker --version\n+    echo =============================================\n+    echo Kill all running containers if existing\n+    echo =============================================\n+    docker container kill $(docker ps -q)\n+    echo =============================================\n+    echo Run unit and instrumented inside docker container", "originalCommit": "e9b6b56aba6c64c8983d713d414b92e477c4ce91", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}