{"pr_number": 4139, "pr_title": "[Feature-4138][Master] dispatch workgroup error add sleep time", "pr_createdAt": "2020-12-01T11:12:28Z", "pr_url": "https://github.com/apache/dolphinscheduler/pull/4139", "timeline": [{"oid": "96b0a3931164f5265140d9317bf88ffee8b85ba1", "url": "https://github.com/apache/dolphinscheduler/commit/96b0a3931164f5265140d9317bf88ffee8b85ba1", "message": "Merge pull request #25 from apache/dev\n\nupdate code from apache", "committedDate": "2020-11-27T09:44:25Z", "type": "commit"}, {"oid": "709c6c8b924bad932c726558bfe61420ed65a60e", "url": "https://github.com/apache/dolphinscheduler/commit/709c6c8b924bad932c726558bfe61420ed65a60e", "message": "Merge pull request #26 from apache/dev\n\nupdate code from apache", "committedDate": "2020-12-01T10:45:10Z", "type": "commit"}, {"oid": "fc94cfd2fd303e72e2bda133200a811d22a9deed", "url": "https://github.com/apache/dolphinscheduler/commit/fc94cfd2fd303e72e2bda133200a811d22a9deed", "message": "When there are tasks with assignment failure and the number of tasks in the current task queue is less than 10, sleep for 1 second", "committedDate": "2020-12-01T11:09:15Z", "type": "commit"}, {"oid": "120b29d1d27d9584fa5a5d61ec213c82552cebd4", "url": "https://github.com/apache/dolphinscheduler/commit/120b29d1d27d9584fa5a5d61ec213c82552cebd4", "message": "When there are tasks with assignment failure and the number of tasks in the current task queue is less than 10, sleep for 1 second", "committedDate": "2020-12-09T04:51:36Z", "type": "commit"}, {"oid": "f48373cc49312c5686fa948908732c7b22609449", "url": "https://github.com/apache/dolphinscheduler/commit/f48373cc49312c5686fa948908732c7b22609449", "message": "fix code smell & code style", "committedDate": "2020-12-09T05:14:13Z", "type": "commit"}, {"oid": "e308595bc0c42f2f14bdf0f4bd73dd139f88117f", "url": "https://github.com/apache/dolphinscheduler/commit/e308595bc0c42f2f14bdf0f4bd73dd139f88117f", "message": "fix code smell & code style", "committedDate": "2020-12-09T05:17:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTA5NzIzNQ==", "url": "https://github.com/apache/dolphinscheduler/pull/4139#discussion_r539097235", "bodyText": "\"taskPriorityQueue.size() <= failedDispatchTasks.size()\" is better.", "author": "lenboo", "createdAt": "2020-12-09T08:18:17Z", "path": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/consumer/TaskPriorityQueueConsumer.java", "diffHunk": "@@ -139,7 +140,13 @@ public void run() {\n                 for (String dispatchFailedTask : failedDispatchTasks) {\n                     taskPriorityQueue.put(dispatchFailedTask);\n                 }\n+                // If there are tasks in a cycle that cannot find the worker group,\n+                // sleep for 1 second\n+                if (!failedDispatchTasks.isEmpty()  && taskPriorityQueue.size() <= fetchTaskNum) {", "originalCommit": "e308595bc0c42f2f14bdf0f4bd73dd139f88117f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTE1MzA1MQ==", "url": "https://github.com/apache/dolphinscheduler/pull/4139#discussion_r539153051", "bodyText": "same.\nBecause the failed failedDispatchTasks queue can only have fetchTaskNum tasks at most", "author": "BoYiZhang", "createdAt": "2020-12-09T09:39:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTA5NzIzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDA1ODU2Ng==", "url": "https://github.com/apache/dolphinscheduler/pull/4139#discussion_r540058566", "bodyText": "it is not same.\nthe situation that do not need sleep. : failedNumber=1; queueSize=2; fetchTaskNumber=3", "author": "lenboo", "createdAt": "2020-12-10T10:36:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTA5NzIzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDA2Mjk5OA==", "url": "https://github.com/apache/dolphinscheduler/pull/4139#discussion_r540062998", "bodyText": "it is not same.\nthe situation that do not need sleep. : failedNumber=1; queueSize=2; fetchTaskNumber=3\n\nIt has been dealt with, but now the main problem is to try many ways. Code coverage has not been able to", "author": "BoYiZhang", "createdAt": "2020-12-10T10:42:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTA5NzIzNQ=="}], "type": "inlineReview"}, {"oid": "d633a7232ecfd24d061c052c5f89fe4c7d64ab33", "url": "https://github.com/apache/dolphinscheduler/commit/d633a7232ecfd24d061c052c5f89fe4c7d64ab33", "message": "fix code smell", "committedDate": "2020-12-09T09:47:35Z", "type": "commit"}, {"oid": "9d9979ddadcbd71d9332cea5520af41e3e0eea9d", "url": "https://github.com/apache/dolphinscheduler/commit/9d9979ddadcbd71d9332cea5520af41e3e0eea9d", "message": "fix code smell", "committedDate": "2020-12-09T10:16:15Z", "type": "commit"}, {"oid": "c72d9d4b2b98601b2eaca857a2d99699a3f51141", "url": "https://github.com/apache/dolphinscheduler/commit/c72d9d4b2b98601b2eaca857a2d99699a3f51141", "message": "update ut", "committedDate": "2020-12-09T13:32:50Z", "type": "commit"}, {"oid": "0deef66f44ad2148b3c1f7d3de020ce35c7ff67c", "url": "https://github.com/apache/dolphinscheduler/commit/0deef66f44ad2148b3c1f7d3de020ce35c7ff67c", "message": "update ut", "committedDate": "2020-12-09T15:30:52Z", "type": "commit"}, {"oid": "5b806cb56dabc382b218c3c656a6f265088b085b", "url": "https://github.com/apache/dolphinscheduler/commit/5b806cb56dabc382b218c3c656a6f265088b085b", "message": "update ut", "committedDate": "2020-12-09T17:22:33Z", "type": "commit"}, {"oid": "8b432dc4067086daef1c95f67052a8ea6eeec9cc", "url": "https://github.com/apache/dolphinscheduler/commit/8b432dc4067086daef1c95f67052a8ea6eeec9cc", "message": "update ut", "committedDate": "2020-12-09T17:52:41Z", "type": "commit"}, {"oid": "41d08c27e10799e2bff9524dbd0e7f8e6e725e99", "url": "https://github.com/apache/dolphinscheduler/commit/41d08c27e10799e2bff9524dbd0e7f8e6e725e99", "message": "update ut", "committedDate": "2020-12-09T17:56:34Z", "type": "commit"}, {"oid": "fc830737737ba8c906f1485df4f270723f2b82a4", "url": "https://github.com/apache/dolphinscheduler/commit/fc830737737ba8c906f1485df4f270723f2b82a4", "message": "update ut", "committedDate": "2020-12-09T18:11:53Z", "type": "commit"}, {"oid": "4ca1e5cc6fe170ad0cada790fde6e0b9c66d5936", "url": "https://github.com/apache/dolphinscheduler/commit/4ca1e5cc6fe170ad0cada790fde6e0b9c66d5936", "message": "update ut", "committedDate": "2020-12-09T18:45:46Z", "type": "commit"}, {"oid": "a9658641abeebed5abd4488d709030718ff9f6a7", "url": "https://github.com/apache/dolphinscheduler/commit/a9658641abeebed5abd4488d709030718ff9f6a7", "message": "update ut", "committedDate": "2020-12-09T18:46:42Z", "type": "commit"}, {"oid": "86ba5a5acd02e35a7bd8177d175ba235545f030d", "url": "https://github.com/apache/dolphinscheduler/commit/86ba5a5acd02e35a7bd8177d175ba235545f030d", "message": "update ut", "committedDate": "2020-12-10T01:09:42Z", "type": "commit"}, {"oid": "e4c6df57f9420b4118596e4a70a6897e363a2cc6", "url": "https://github.com/apache/dolphinscheduler/commit/e4c6df57f9420b4118596e4a70a6897e363a2cc6", "message": "update ut", "committedDate": "2020-12-10T01:14:05Z", "type": "commit"}, {"oid": "971d193dca6348ddfc84cac6d34500952c0ce75f", "url": "https://github.com/apache/dolphinscheduler/commit/971d193dca6348ddfc84cac6d34500952c0ce75f", "message": "update rule", "committedDate": "2020-12-10T10:42:12Z", "type": "commit"}, {"oid": "720c2e89bc348c08f29db75af3ef80d6cba67576", "url": "https://github.com/apache/dolphinscheduler/commit/720c2e89bc348c08f29db75af3ef80d6cba67576", "message": "update rule", "committedDate": "2020-12-11T06:59:16Z", "type": "commit"}]}