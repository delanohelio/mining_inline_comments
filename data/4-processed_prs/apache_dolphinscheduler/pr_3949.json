{"pr_number": 3949, "pr_title": "[Feature-3941][ui] Remove tenant name ", "pr_createdAt": "2020-10-19T12:52:25Z", "pr_url": "https://github.com/apache/dolphinscheduler/pull/3949", "timeline": [{"oid": "09683d4671cb711dc299ad7e2b0165735388a3a0", "url": "https://github.com/apache/dolphinscheduler/commit/09683d4671cb711dc299ad7e2b0165735388a3a0", "message": "Merge remote-tracking branch 'upstream/dev' into HEAD", "committedDate": "2020-10-19T01:44:34Z", "type": "commit"}, {"oid": "43aa25a4a7dc020312e49a82c88149be633a1fdd", "url": "https://github.com/apache/dolphinscheduler/commit/43aa25a4a7dc020312e49a82c88149be633a1fdd", "message": "FeatureUI-3941: Removed Tenant", "committedDate": "2020-10-19T12:43:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU4NDI0MA==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r512584240", "bodyText": "Please remove this method annotation tenantName", "author": "zhuangchong", "createdAt": "2020-10-27T10:44:44Z", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/impl/TenantServiceImpl.java", "diffHunk": "@@ -85,7 +85,6 @@\n     @Transactional(rollbackFor = Exception.class)\n     public Map<String, Object> createTenant(User loginUser,", "originalCommit": "43aa25a4a7dc020312e49a82c88149be633a1fdd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU4NjM1Nw==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r512586357", "bodyText": "Please remove the static variable tenantName", "author": "zhuangchong", "createdAt": "2020-10-27T10:48:12Z", "path": "dolphinscheduler-api/src/test/java/org/apache/dolphinscheduler/api/service/TenantServiceTest.java", "diffHunk": "@@ -83,17 +83,17 @@ public void testCreateTenant() {\n         try {", "originalCommit": "43aa25a4a7dc020312e49a82c88149be633a1fdd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE0OTE2NA==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513149164", "bodyText": "private static final String tenantName = \"TenantServiceTest\";\nThe tenantName variable is not called and can be removed.", "author": "zhuangchong", "createdAt": "2020-10-28T02:54:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjU4NjM1Nw=="}], "type": "inlineReview"}, {"oid": "f66035c8b583370373a7bf20f8e59a9ea1098409", "url": "https://github.com/apache/dolphinscheduler/commit/f66035c8b583370373a7bf20f8e59a9ea1098409", "message": "FeatureUI-3941: Removed tenantName in the suggested pages", "committedDate": "2020-10-27T18:01:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE0NjI1OQ==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513146259", "bodyText": "logger.info(\"login user {}, create tenant, tenantCode: {}, queueId: {}, desc: {}\",\nStringUtils.replaceNRTtoUnderline(loginUser.getUserName()),\nStringUtils.replaceNRTtoUnderline(tenantCode),\nqueueId,\nStringUtils.replaceNRTtoUnderline(description));", "author": "zhuangchong", "createdAt": "2020-10-28T02:43:28Z", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/TenantController.java", "diffHunk": "@@ -90,12 +88,11 @@\n     @ApiException(CREATE_TENANT_ERROR)\n     public Result createTenant(@ApiIgnore @RequestAttribute(value = Constants.SESSION_USER) User loginUser,\n                                @RequestParam(value = \"tenantCode\") String tenantCode,\n-                               @RequestParam(value = \"tenantName\") String tenantName,\n                                @RequestParam(value = \"queueId\") int queueId,\n                                @RequestParam(value = \"description\", required = false) String description) throws Exception {\n-        logger.info(\"login user {}, create tenant, tenantCode: {}, tenantName: {}, queueId: {}, desc: {}\",\n-                loginUser.getUserName(), tenantCode, tenantName, queueId, description);\n-        Map<String, Object> result = tenantService.createTenant(loginUser, tenantCode, tenantName, queueId, description);\n+        logger.info(\"login user {}, create tenant, tenantCode: {}, queueId: {}, desc: {}\",\n+                loginUser.getUserName(), tenantCode, queueId, description);", "originalCommit": "f66035c8b583370373a7bf20f8e59a9ea1098409", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzI5Nzk4Mw==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513297983", "bodyText": "SonarCloud is still producing errors", "author": "IamMujuziMoses", "createdAt": "2020-10-28T09:33:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE0NjI1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE0NjQwNA==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513146404", "bodyText": "logger.info(\"login user {}, updateProcessInstance tenant, tenantCode: {}, queueId: {}, description: {}\",\nStringUtils.replaceNRTtoUnderline(loginUser.getUserName()),\nStringUtils.replaceNRTtoUnderline(tenantCode),\nqueueId,\nStringUtils.replaceNRTtoUnderline(description));", "author": "zhuangchong", "createdAt": "2020-10-28T02:44:05Z", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/TenantController.java", "diffHunk": "@@ -177,12 +172,11 @@ public Result queryTenantlist(@ApiIgnore @RequestAttribute(value = Constants.SES\n     public Result updateTenant(@ApiIgnore @RequestAttribute(value = Constants.SESSION_USER) User loginUser,\n                                @RequestParam(value = \"id\") int id,\n                                @RequestParam(value = \"tenantCode\") String tenantCode,\n-                               @RequestParam(value = \"tenantName\") String tenantName,\n                                @RequestParam(value = \"queueId\") int queueId,\n                                @RequestParam(value = \"description\", required = false) String description) throws Exception {\n-        logger.info(\"login user {}, updateProcessInstance tenant, tenantCode: {}, tenantName: {}, queueId: {}, description: {}\",\n-                loginUser.getUserName(), tenantCode, tenantName, queueId, description);\n-        Map<String, Object> result = tenantService.updateTenant(loginUser, id, tenantCode, tenantName, queueId, description);\n+        logger.info(\"login user {}, updateProcessInstance tenant, tenantCode: {}, queueId: {}, description: {}\",\n+                loginUser.getUserName(), tenantCode, queueId, description);", "originalCommit": "f66035c8b583370373a7bf20f8e59a9ea1098409", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE0OTk5OA==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513149998", "bodyText": "u.update_time,t.tenant_code,u.state,", "author": "zhuangchong", "createdAt": "2020-10-28T02:57:19Z", "path": "dolphinscheduler-dao/src/main/resources/org/apache/dolphinscheduler/dao/mapper/UserMapper.xml", "diffHunk": "@@ -32,7 +32,7 @@\n     </select>\n     <select id=\"queryUserPaging\" resultType=\"org.apache.dolphinscheduler.dao.entity.User\">\n         select u.id,u.user_name,u.user_password,u.user_type,u.email,u.phone,u.tenant_id,u.create_time,\n-        u.update_time,t.tenant_name,u.state,\n+        u.update_time,u.state,", "originalCommit": "f66035c8b583370373a7bf20f8e59a9ea1098409", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE1MDA4OA==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513150088", "bodyText": "select u.*, t.tenant_code,", "author": "zhuangchong", "createdAt": "2020-10-28T02:57:40Z", "path": "dolphinscheduler-dao/src/main/resources/org/apache/dolphinscheduler/dao/mapper/UserMapper.xml", "diffHunk": "@@ -44,7 +44,7 @@\n         order by u.update_time desc\n     </select>\n     <select id=\"queryDetailsById\" resultType=\"org.apache.dolphinscheduler.dao.entity.User\">\n-        select u.*, t.tenant_name,\n+        select u.*,", "originalCommit": "f66035c8b583370373a7bf20f8e59a9ea1098409", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE1MTA3OQ==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513151079", "bodyText": "id: v.id\ncode: v.tenantCode", "author": "zhuangchong", "createdAt": "2020-10-28T03:01:08Z", "path": "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/users/_source/createUser.vue", "diffHunk": "@@ -231,8 +231,7 @@\n             })\n             this.tenantList = _.map(arr, v => {\n               return {\n-                id: v.id,\n-                code: v.tenantName\n+                id: v.id", "originalCommit": "f66035c8b583370373a7bf20f8e59a9ea1098409", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE1MTUwNA==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513151504", "bodyText": "id: -1\ntenantCode: 'default'", "author": "zhuangchong", "createdAt": "2020-10-28T03:02:48Z", "path": "dolphinscheduler-ui/src/js/conf/home/store/security/actions.js", "diffHunk": "@@ -281,8 +281,7 @@ export default {\n       io.get('tenant/list', payload, res => {\n         const list = res.data\n         list.unshift({\n-          id: -1,\n-          tenantName: 'default'\n+          id: -1", "originalCommit": "f66035c8b583370373a7bf20f8e59a9ea1098409", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE1NDc3OA==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513154778", "bodyText": "dolphinscheduler-postgre.sql file also needs to be modified", "author": "zhuangchong", "createdAt": "2020-10-28T03:15:01Z", "path": "sql/dolphinscheduler_mysql.sql", "diffHunk": "@@ -756,7 +756,6 @@ DROP TABLE IF EXISTS `t_ds_tenant`;\n CREATE TABLE `t_ds_tenant` (\n   `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'key',\n   `tenant_code` varchar(64) DEFAULT NULL COMMENT 'tenant code',\n-  `tenant_name` varchar(64) DEFAULT NULL COMMENT 'tenant name',", "originalCommit": "f66035c8b583370373a7bf20f8e59a9ea1098409", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "631c1a306fd95a0c84cfbd575b18e9ee1ae9c7ba", "url": "https://github.com/apache/dolphinscheduler/commit/631c1a306fd95a0c84cfbd575b18e9ee1ae9c7ba", "message": "FeatureUI-3941: Updated the suggested files", "committedDate": "2020-10-28T08:42:47Z", "type": "commit"}, {"oid": "83958d1049e6ae25ed8c3c979c73f7ffc7153a03", "url": "https://github.com/apache/dolphinscheduler/commit/83958d1049e6ae25ed8c3c979c73f7ffc7153a03", "message": "FeatureUI-3941: Updated the TenantController", "committedDate": "2020-10-28T09:14:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzkxNTQyMg==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513915422", "bodyText": "String userReplace = StringUtils.replaceNRTtoUnderline(loginUser.getUserName());\nString tenantCodeReplace = StringUtils.replaceNRTtoUnderline(tenantCode);\nString descReplace = StringUtils.replaceNRTtoUnderline(description);\nlogger.info(\"login user {}, create tenant, tenantCode: {}, queueId: {}, desc: {}\", userReplace, tenantCodeReplace, queueId, descReplace);", "author": "zhuangchong", "createdAt": "2020-10-29T03:24:24Z", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/TenantController.java", "diffHunk": "@@ -90,12 +89,13 @@\n     @ApiException(CREATE_TENANT_ERROR)\n     public Result createTenant(@ApiIgnore @RequestAttribute(value = Constants.SESSION_USER) User loginUser,\n                                @RequestParam(value = \"tenantCode\") String tenantCode,\n-                               @RequestParam(value = \"tenantName\") String tenantName,\n                                @RequestParam(value = \"queueId\") int queueId,\n                                @RequestParam(value = \"description\", required = false) String description) throws Exception {\n-        logger.info(\"login user {}, create tenant, tenantCode: {}, tenantName: {}, queueId: {}, desc: {}\",\n-                loginUser.getUserName(), tenantCode, tenantName, queueId, description);\n-        Map<String, Object> result = tenantService.createTenant(loginUser, tenantCode, tenantName, queueId, description);\n+        logger.info(\"login user {}, create tenant, tenantCode: {}, queueId: {}, desc: {}\",\n+                StringUtils.replaceNRTtoUnderline(loginUser.getUserName()),\n+                StringUtils.replaceNRTtoUnderline(tenantCode), queueId,\n+                StringUtils.replaceNRTtoUnderline(description));", "originalCommit": "83958d1049e6ae25ed8c3c979c73f7ffc7153a03", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzkxNTcxNQ==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r513915715", "bodyText": "String userReplace = StringUtils.replaceNRTtoUnderline(loginUser.getUserName());\nString tenantCodeReplace = StringUtils.replaceNRTtoUnderline(tenantCode);\nString descReplace = StringUtils.replaceNRTtoUnderline(description);\nlogger.info(\"login user {}, create tenant, tenantCode: {}, queueId: {}, desc: {}\", userReplace, tenantCodeReplace, queueId, descReplace);", "author": "zhuangchong", "createdAt": "2020-10-29T03:24:50Z", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/controller/TenantController.java", "diffHunk": "@@ -177,12 +175,13 @@ public Result queryTenantlist(@ApiIgnore @RequestAttribute(value = Constants.SES\n     public Result updateTenant(@ApiIgnore @RequestAttribute(value = Constants.SESSION_USER) User loginUser,\n                                @RequestParam(value = \"id\") int id,\n                                @RequestParam(value = \"tenantCode\") String tenantCode,\n-                               @RequestParam(value = \"tenantName\") String tenantName,\n                                @RequestParam(value = \"queueId\") int queueId,\n                                @RequestParam(value = \"description\", required = false) String description) throws Exception {\n-        logger.info(\"login user {}, updateProcessInstance tenant, tenantCode: {}, tenantName: {}, queueId: {}, description: {}\",\n-                loginUser.getUserName(), tenantCode, tenantName, queueId, description);\n-        Map<String, Object> result = tenantService.updateTenant(loginUser, id, tenantCode, tenantName, queueId, description);\n+        logger.info(\"login user {}, updateProcessInstance tenant, tenantCode: {}, queueId: {}, description: {}\",\n+                StringUtils.replaceNRTtoUnderline(loginUser.getUserName()),\n+                StringUtils.replaceNRTtoUnderline(tenantCode), queueId,\n+                StringUtils.replaceNRTtoUnderline(description));", "originalCommit": "83958d1049e6ae25ed8c3c979c73f7ffc7153a03", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "8439c1ea483dbf5ba1414f3714bacb7125aace85", "url": "https://github.com/apache/dolphinscheduler/commit/8439c1ea483dbf5ba1414f3714bacb7125aace85", "message": "FeatureUI-3941: Updated the TenantController and the pom.xml", "committedDate": "2020-10-29T07:49:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI3ODU4OQ==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r514278589", "bodyText": "updated this error", "author": "dailidong", "createdAt": "2020-10-29T13:57:51Z", "path": "dolphinscheduler-api/src/test/java/org/apache/dolphinscheduler/api/controller/TenantControllerTest.java", "diffHunk": "@@ -165,7 +163,7 @@ public void testDeleteTenantById() throws Exception {\n                 .andExpect(content().contentType(MediaType.APPLICATION_JSON_UTF8))\n                 .andReturn();\n         Result result = JSONUtils.parseObject(mvcResult.getResponse().getContentAsString(), Result.class);\n-        Assert.assertEquals(Status.SUCCESS.getCode(),result.getCode().intValue());\n+        Assert.assertEquals(Status.TENANT_NOT_EXIST.getCode(),result.getCode().intValue());", "originalCommit": "ef393cd52427a78d8706fbbf8568bcae7a9d7c8a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI4OTU4Mw==", "url": "https://github.com/apache/dolphinscheduler/pull/3949#discussion_r514289583", "bodyText": "@dailidong you needed to update the testUpdateTenant also", "author": "IamMujuziMoses", "createdAt": "2020-10-29T14:12:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI3ODU4OQ=="}], "type": "inlineReview"}, {"oid": "183284065ba940378ac950190c96cf9d89854899", "url": "https://github.com/apache/dolphinscheduler/commit/183284065ba940378ac950190c96cf9d89854899", "message": "FeatureUI-3941: Updated the TenantControllerTest", "committedDate": "2020-10-29T16:09:54Z", "type": "commit"}]}