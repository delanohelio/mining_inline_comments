{"pr_number": 1515, "pr_title": "gl-916 add pipeline version to metrics", "pr_createdAt": "2020-05-26T20:02:51Z", "pr_url": "https://github.com/broadinstitute/picard/pull/1515", "timeline": [{"oid": "fad8ced5cf36f420555f8cc0cf64a7c260506736", "url": "https://github.com/broadinstitute/picard/commit/fad8ced5cf36f420555f8cc0cf64a7c260506736", "message": "GL-916 Stubbed out adding PIPELINE_VERSION to arrays metrics.", "committedDate": "2020-05-20T19:32:10Z", "type": "commit"}, {"oid": "a6a829276a0d3cf59cd629ba6d137fa13742c1a9", "url": "https://github.com/broadinstitute/picard/commit/a6a829276a0d3cf59cd629ba6d137fa13742c1a9", "message": "add optional pipeline_version input", "committedDate": "2020-05-22T12:51:01Z", "type": "commit"}, {"oid": "27b511ce267120f26f3add6528dbc1c3d5686235", "url": "https://github.com/broadinstitute/picard/commit/27b511ce267120f26f3add6528dbc1c3d5686235", "message": "pass pipeline_version to accumulator", "committedDate": "2020-05-22T16:08:36Z", "type": "commit"}, {"oid": "bebc49c4299565d4debb9deb5af0dc19a8b94356", "url": "https://github.com/broadinstitute/picard/commit/bebc49c4299565d4debb9deb5af0dc19a8b94356", "message": "add tests", "committedDate": "2020-05-26T19:58:08Z", "type": "commit"}, {"oid": "40d0420d54d9caa53b96f418f2d4bdfc3abc2e30", "url": "https://github.com/broadinstitute/picard/commit/40d0420d54d9caa53b96f418f2d4bdfc3abc2e30", "message": "Merge branch 'master' into np_GL-916_AddPipelineVersionToMetrics", "committedDate": "2020-05-27T00:31:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTIxMTI4Nw==", "url": "https://github.com/broadinstitute/picard/pull/1515#discussion_r431211287", "bodyText": "Given the way this class is used, I don't see why the code in setup() isn't done in the constructor directly.", "author": "pshapiro4broad", "createdAt": "2020-05-27T15:03:09Z", "path": "src/main/java/picard/arrays/ArraysCallingMetricAccumulator.java", "diffHunk": "@@ -76,14 +77,15 @@\n                         detail.P95_GREEN = p95Green;\n                         detail.P95_RED = p95Red;\n                         detail.SCANNER_NAME = scannerName;\n+                        detail.PIPELINE_VERSION = pipelineVersion;\n                         return detail;\n                     }, true);\n \n     ArraysCallingMetricAccumulator(DbSnpBitSetUtil.DbSnpBitSets dbsnp) {\n         this.dbsnp = dbsnp;\n     }\n \n-    public void setup(final VCFHeader vcfHeader) {\n+    public void setup(final VCFHeader vcfHeader, final String pipelineVersion) {", "originalCommit": "40d0420d54d9caa53b96f418f2d4bdfc3abc2e30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzI5MjUxNg==", "url": "https://github.com/broadinstitute/picard/pull/1515#discussion_r433292516", "bodyText": "The code has been rewritten to not pass pipelineVersion to CollectArraysVariantCallingMetrics, so this suggestion isn't germane to the PR (and probably should be done elsewhere).", "author": "gbggrant", "createdAt": "2020-06-01T15:09:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTIxMTI4Nw=="}], "type": "inlineReview"}, {"oid": "9fc935178c93f7fca1530ce7ea4d6295480133be", "url": "https://github.com/broadinstitute/picard/commit/9fc935178c93f7fca1530ce7ea4d6295480133be", "message": "change how we are passing PIPELINE_VERSION to metrics collector", "committedDate": "2020-05-29T12:21:13Z", "type": "commit"}, {"oid": "b57833741081cb071f27d3952df9c88d81ce779e", "url": "https://github.com/broadinstitute/picard/commit/b57833741081cb071f27d3952df9c88d81ce779e", "message": "Merge remote-tracking branch 'origin/np_GL-916_AddPipelineVersionToMetrics' into np_GL-916_AddPipelineVersionToMetrics", "committedDate": "2020-05-29T12:21:34Z", "type": "commit"}, {"oid": "a39eafbdc36d7473b36ef045750dc1d85bb41ecd", "url": "https://github.com/broadinstitute/picard/commit/a39eafbdc36d7473b36ef045750dc1d85bb41ecd", "message": "add pipeline_version to test data", "committedDate": "2020-05-29T17:06:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzI5MjkxOA==", "url": "https://github.com/broadinstitute/picard/pull/1515#discussion_r433292918", "bodyText": "Since this is an optional parameter, we should have one test without pipelineVersion set in the VCF.  It should allow that case.", "author": "gbggrant", "createdAt": "2020-06-01T15:10:38Z", "path": "testdata/picard/arrays/7991775143_R01C01_wo_optional_fields.vcf", "diffHunk": "@@ -179,6 +179,7 @@\n ##p95Green=4251\n ##p95Red=5479\n ##picardVersion=2.20.3-17-g8331bf3-SNAPSHOT\n+##pipelineVersion=foo", "originalCommit": "a39eafbdc36d7473b36ef045750dc1d85bb41ecd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "326769590e97d7e67ef864d920b858f5a2262585", "url": "https://github.com/broadinstitute/picard/commit/326769590e97d7e67ef864d920b858f5a2262585", "message": "add test to allow case when pipeline version is not set in the vcf", "committedDate": "2020-06-01T17:20:20Z", "type": "commit"}, {"oid": "2d4ae986c6f8c686d186207732c052c0e97a84f0", "url": "https://github.com/broadinstitute/picard/commit/2d4ae986c6f8c686d186207732c052c0e97a84f0", "message": "Merge branch 'master' into np_GL-916_AddPipelineVersionToMetrics", "committedDate": "2020-06-01T17:48:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzM5Mjc1OA==", "url": "https://github.com/broadinstitute/picard/pull/1515#discussion_r433392758", "bodyText": "I don\u2019t think you need to update the example. I would either add an example or remove the comment. Adding a TODO should be avoided if possible.", "author": "pshapiro4broad", "createdAt": "2020-06-01T17:52:31Z", "path": "src/main/java/picard/arrays/CollectArraysVariantCallingMetrics.java", "diffHunk": "@@ -43,10 +43,12 @@\n                     \"<h4>Usage example:</h4>\" +\n                     \"<pre>\" +\n                     \"java -jar picard.jar CollectArraysVariantCallingMetrics \\\\<br />\" +\n+                    // TODO - ADD example", "originalCommit": "2d4ae986c6f8c686d186207732c052c0e97a84f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzM5NDE5Nw==", "url": "https://github.com/broadinstitute/picard/pull/1515#discussion_r433394197", "bodyText": "Since PIPELINE_VERSION is already a String you don\u2019t need to call toString\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        lines.add(new VCFHeaderLine(InfiniumVcfFields.PIPELINE_VERSION, PIPELINE_VERSION.toString()));\n          \n          \n            \n                        lines.add(new VCFHeaderLine(InfiniumVcfFields.PIPELINE_VERSION, PIPELINE_VERSION);", "author": "pshapiro4broad", "createdAt": "2020-06-01T17:55:17Z", "path": "src/main/java/picard/arrays/GtcToVcf.java", "diffHunk": "@@ -538,6 +541,9 @@ private VCFHeader createVCFHeader(final Build37ExtendedIlluminaManifest manifest\n         if (EXPECTED_GENDER != null) {\n             lines.add(new VCFHeaderLine(InfiniumVcfFields.EXPECTED_GENDER, EXPECTED_GENDER));\n         }\n+        if (PIPELINE_VERSION != null) {\n+            lines.add(new VCFHeaderLine(InfiniumVcfFields.PIPELINE_VERSION, PIPELINE_VERSION.toString()));", "originalCommit": "2d4ae986c6f8c686d186207732c052c0e97a84f0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2a6f1fca6f09ad0d18d790523a6aea75c079be0f", "url": "https://github.com/broadinstitute/picard/commit/2a6f1fca6f09ad0d18d790523a6aea75c079be0f", "message": "Update src/main/java/picard/arrays/GtcToVcf.java\n\nCo-authored-by: Phil Shapiro <pshapiro@broadinstitute.org>", "committedDate": "2020-06-01T17:58:12Z", "type": "commit"}, {"oid": "7e2a59dd9299b69c4b79cc75b97091dcd8752270", "url": "https://github.com/broadinstitute/picard/commit/7e2a59dd9299b69c4b79cc75b97091dcd8752270", "message": "remove TODO comment", "committedDate": "2020-06-01T18:04:48Z", "type": "commit"}, {"oid": "4b0b18d8613714401c6307663009d1f33b1f06b6", "url": "https://github.com/broadinstitute/picard/commit/4b0b18d8613714401c6307663009d1f33b1f06b6", "message": "add a parenthesis", "committedDate": "2020-06-01T18:11:45Z", "type": "commit"}]}