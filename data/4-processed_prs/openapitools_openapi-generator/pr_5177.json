{"pr_number": 5177, "pr_title": "[Java][okhttp-gson] Use builder api of OkHttpClient to avoid UnsupportedOperationEx", "pr_createdAt": "2020-01-31T12:52:18Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/5177", "timeline": [{"oid": "a4672161158e51488c173ac4673a8c67cd3e6cbf", "url": "https://github.com/OpenAPITools/openapi-generator/commit/a4672161158e51488c173ac4673a8c67cd3e6cbf", "message": "3432 Use builder api of OkHttpClient to avoid UnsupportedOperationEx\n\nThe reason for the UnsupportedOperationException was an invalid access to the interceptors list of OkHttpClient. That list is unmodifiable as stated by the JavaDoc. Instead accessing the list directly, the interceptors should always be passed when building the client by the builder api.", "committedDate": "2020-01-31T09:21:25Z", "type": "commit"}, {"oid": "dca86546ab25d5e04444f492fcd3a06e12e219bf", "url": "https://github.com/OpenAPITools/openapi-generator/commit/dca86546ab25d5e04444f492fcd3a06e12e219bf", "message": "3432 Use builder api of OkHttpClient to avoid UnsupportedOperationEx\n\nThe reason for the UnsupportedOperationException was an invalid access to the interceptors list of OkHttpClient. That list is unmodifiable as stated by the JavaDoc. Instead accessing the list directly, the interceptors should always be passed when building the client by the builder api.", "committedDate": "2020-01-31T15:34:31Z", "type": "commit"}, {"oid": "4096155749fddbf48e1617d8278295a48f306703", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4096155749fddbf48e1617d8278295a48f306703", "message": "Merge branch 'fix_issue_3432' of https://github.com/trohrberg/openapi-generator into fix_issue_3432", "committedDate": "2020-01-31T15:34:53Z", "type": "commit"}, {"oid": "ebaeacb98bd0ff43353be7f3f3e7db14b1aea9ca", "url": "https://github.com/OpenAPITools/openapi-generator/commit/ebaeacb98bd0ff43353be7f3f3e7db14b1aea9ca", "message": "3432 Follow-up fix to make samples compile again", "committedDate": "2020-02-01T11:48:29Z", "type": "commit"}, {"oid": "652f1ac8a9937dc2d91688294f2f433681801527", "url": "https://github.com/OpenAPITools/openapi-generator/commit/652f1ac8a9937dc2d91688294f2f433681801527", "message": "3432 Updated sample implementation for okHttp-Gson-ParcelableModel", "committedDate": "2020-02-01T15:18:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODg3MzAxMg==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5177#discussion_r378873012", "bodyText": "@trohrberg seems like these 2 lines are not indented correctly. I'll file a separate PR to update it after merging this one.", "author": "wing328", "createdAt": "2020-02-13T13:54:26Z", "path": "modules/openapi-generator/src/main/resources/Java/libraries/okhttp-gson/ApiClient.mustache", "diffHunk": "@@ -139,16 +140,25 @@ public class ApiClient {\n     {{/-first}}\n     {{/oauthMethods}}\n     {{/hasOAuthMethods}}\n-    private void init() {\n+    private void initHttpClient() {\n+        initHttpClient(Collections.<Interceptor>emptyList());\n+    }\n+\n+    private void initHttpClient(List<Interceptor> interceptors) {\n         OkHttpClient.Builder builder = new OkHttpClient.Builder();\n         builder.addNetworkInterceptor(getProgressInterceptor());\n-        httpClient = builder.build();\n-\n+        for (Interceptor interceptor: interceptors) {\n+            builder.addInterceptor(interceptor);\n+        }\n         {{#useGzipFeature}}\n-        // Enable gzip request compression\n-        httpClient.interceptors().add(new GzipRequestInterceptor());\n+            // Enable gzip request compression\n+            builder.addInterceptor(new GzipRequestInterceptor());", "originalCommit": "652f1ac8a9937dc2d91688294f2f433681801527", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}