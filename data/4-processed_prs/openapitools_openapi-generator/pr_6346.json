{"pr_number": 6346, "pr_title": "[php-laravel] Upgrade `php-laravel` to 7.x", "pr_createdAt": "2020-05-18T00:43:07Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/6346", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTAxMTI3Mg==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6346#discussion_r439011272", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                \"phpunit/phpunit\": \"^8.5\"\n          \n          \n            \n                \"phpunit/phpunit\": \"^8.5 || ^9.0\"\n          \n      \n    \n    \n  \n\nIt's better to give an option to use latest PHPUnit.", "author": "ybelenko", "createdAt": "2020-06-11T19:12:26Z", "path": "modules/openapi-generator/src/main/resources/php-laravel/composer.mustache", "diffHunk": "@@ -8,59 +8,56 @@\n   \"license\": \"MIT\",\n   \"type\": \"project\",\n   \"require\": {\n-    \"php\": \"^7.1.3\",\n-    \"fideloper/proxy\": \"^4.0\",\n-    \"laravel/framework\": \"5.6.*\",\n-    \"laravel/tinker\": \"^1.0\"\n+    \"php\": \"^7.2.5\",\n+    \"fideloper/proxy\": \"^4.2\",\n+    \"fruitcake/laravel-cors\": \"^1.0\",\n+    \"guzzlehttp/guzzle\": \"^6.3\",\n+    \"laravel/framework\": \"^7.0\",\n+    \"laravel/tinker\": \"^2.0\"\n   },\n   \"require-dev\": {\n-    \"filp/whoops\": \"^2.0\",\n-    \"fzaninotto/faker\": \"^1.4\",\n-    \"mockery/mockery\": \"^1.0\",\n-    \"nunomaduro/collision\": \"^2.0\",\n-    \"phpunit/phpunit\": \"^7.0\",\n-    \"phpspec/phpspec\": \"^4.2\",\n-    \"squizlabs/php_codesniffer\": \"^3.0\"\n-  },\n-  \"autoload\": {\n-    \"classmap\": [\n-      \"database/seeds\",\n-      \"database/migrations\",\n-      \"database/factories\"\n-    ],\n-    \"psr-4\": {\n-      \"App\\\\\": \"app/\",\n-      \"Tests\\\\\": \"tests/\"\n-    }\n-  },\n-  \"autoload-dev\": {\n-    \"psr-4\": {\n-      \"Tests\\\\\": \"tests/\"\n-    }\n-  },\n-  \"extra\": {\n-    \"laravel\": {\n-      \"dont-discover\": [\n-      ]\n-    }\n-  },\n-  \"scripts\": {\n-      \"post-root-package-install\": [\n-      \"@php -r \\\"file_exists('.env') || copy('.env.example', '.env');\\\"\"\n-    ],\n-      \"post-create-project-cmd\": [\n-      \"@php artisan key:generate\"\n-    ],\n-      \"post-autoload-dump\": [\n-      \"Illuminate\\\\Foundation\\\\ComposerScripts::postAutoloadDump\",\n-      \"@php artisan package:discover\"\n-    ]\n+    \"facade/ignition\": \"^2.0\",\n+    \"fzaninotto/faker\": \"^1.9.1\",\n+    \"mockery/mockery\": \"^1.3.1\",\n+    \"nunomaduro/collision\": \"^4.1\",\n+    \"phpunit/phpunit\": \"^8.5\"", "originalCommit": "727bb5439b7241c1488cbb57a90b50e87bb53e9b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU4Njg5NQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6346#discussion_r446586895", "bodyText": "The current version of Laravel only recommends ^8.5, so I wouldn't want to change that.", "author": "dragonmantank", "createdAt": "2020-06-28T01:26:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTAxMTI3Mg=="}], "type": "inlineReview"}, {"oid": "38265c3fa9a80dcd20cac5afeeca01f5a808b318", "url": "https://github.com/OpenAPITools/openapi-generator/commit/38265c3fa9a80dcd20cac5afeeca01f5a808b318", "message": "Update laravel from 5.6 to 7.0", "committedDate": "2020-06-28T00:56:57Z", "type": "commit"}, {"oid": "940660a81d3a20932c2a4d1d665aa3c1ca860667", "url": "https://github.com/OpenAPITools/openapi-generator/commit/940660a81d3a20932c2a4d1d665aa3c1ca860667", "message": "Updated petstore example, removed missing files", "committedDate": "2020-06-28T01:11:39Z", "type": "commit"}, {"oid": "940660a81d3a20932c2a4d1d665aa3c1ca860667", "url": "https://github.com/OpenAPITools/openapi-generator/commit/940660a81d3a20932c2a4d1d665aa3c1ca860667", "message": "Updated petstore example, removed missing files", "committedDate": "2020-06-28T01:11:39Z", "type": "forcePushed"}, {"oid": "0acd9adda05a035142c2c6fc37a5cd0f67ee6a5f", "url": "https://github.com/OpenAPITools/openapi-generator/commit/0acd9adda05a035142c2c6fc37a5cd0f67ee6a5f", "message": "Updated PHP version to match composer.json", "committedDate": "2020-06-28T01:23:36Z", "type": "commit"}, {"oid": "25892a458d7b94a3724e30739f4b9bd28cd3536e", "url": "https://github.com/OpenAPITools/openapi-generator/commit/25892a458d7b94a3724e30739f4b9bd28cd3536e", "message": "Add samples generation config with OAS3 input spec", "committedDate": "2020-06-28T18:51:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4NTkwNQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6346#discussion_r446685905", "bodyText": "I'm checking your PR locally right now.\nGeneration fails with:\nException in thread \"main\" java.lang.RuntimeException: Could not generate supporting file 'SupportingFile:\n\ttemplateFile: storage/framework/testing/.gitignore\n\tfolder: lib/storage/framework/testing\n\tcanOverwrite: true\n\tdestinationFilename: .gitignore\nDid you forget to rename templates gitignore to .gitignore?\nWhat was the purpose of that renaming?", "author": "ybelenko", "createdAt": "2020-06-28T19:02:16Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/PhpLaravelServerCodegen.java", "diffHunk": "@@ -186,27 +191,29 @@ public PhpLaravelServerCodegen() {\n         supportingFiles.add(new SupportingFile(\"config/session.php\", outputFolder + File.separator + \"config\", \"session.php\"));\n         supportingFiles.add(new SupportingFile(\"config/view.php\", outputFolder + File.separator + \"config\", \"view.php\"));\n \n+        // /database/\n+        supportingFiles.add(new SupportingFile(\"database/migrations/2019_08_19_000000_create_failed_jobs_table.php\", outputFolder + File.separator + \"database\" + File.separator + \"migrations\", \"2019_08_19_000000_create_failed_jobs_table.php\"));\n+\n         // /resources/\n-        supportingFiles.add(new SupportingFile(\"resources/assets/js/components/ExampleComponent.vue\", outputFolder + File.separator + \"resources\" + File.separator + \"assets\" + File.separator + \"js\" + File.separator + \"components\", \"ExampleComponent.vue\"));\n-        supportingFiles.add(new SupportingFile(\"resources/assets/js/app.js\", outputFolder + File.separator + \"resources\" + File.separator + \"assets\" + File.separator + \"js\", \"app.js\"));\n-        supportingFiles.add(new SupportingFile(\"resources/assets/js/bootstrap.js\", outputFolder + File.separator + \"resources\" + File.separator + \"assets\" + File.separator + \"js\", \"bootstrap.js\"));\n-        supportingFiles.add(new SupportingFile(\"resources/assets/sass/_variables.scss\", outputFolder + File.separator + \"resources\" + File.separator + \"assets\" + File.separator + \"sass\", \"_variables.scss\"));\n-        supportingFiles.add(new SupportingFile(\"resources/assets/sass/app.scss\", outputFolder + File.separator + \"resources\" + File.separator + \"assets\" + File.separator + \"sass\", \"app.scss\"));\n+        supportingFiles.add(new SupportingFile(\"resources/js/app.js\", outputFolder + File.separator + \"resources\" + File.separator + \"assets\" + File.separator + \"js\", \"app.js\"));\n+        supportingFiles.add(new SupportingFile(\"resources/js/bootstrap.js\", outputFolder + File.separator + \"resources\" + File.separator + \"assets\" + File.separator + \"js\", \"bootstrap.js\"));\n+        supportingFiles.add(new SupportingFile(\"resources/sass/app.scss\", outputFolder + File.separator + \"resources\" + File.separator + \"assets\" + File.separator + \"sass\", \"app.scss\"));\n         supportingFiles.add(new SupportingFile(\"resources/lang/en/auth.php\", outputFolder + File.separator + \"resources\" + File.separator + \"lang\" + File.separator + \"en\", \"auth.php\"));\n         supportingFiles.add(new SupportingFile(\"resources/lang/en/pagination.php\", outputFolder + File.separator + \"resources\" + File.separator + \"lang\" + File.separator + \"en\", \"pagination.php\"));\n         supportingFiles.add(new SupportingFile(\"resources/lang/en/passwords.php\", outputFolder + File.separator + \"resources\" + File.separator + \"lang\" + File.separator + \"en\", \"passwords.php\"));\n         supportingFiles.add(new SupportingFile(\"resources/lang/en/validation.php\", outputFolder + File.separator + \"resources\" + File.separator + \"lang\" + File.separator + \"en\", \"validation.php\"));\n         supportingFiles.add(new SupportingFile(\"resources/views/welcome.blade.php\", outputFolder + File.separator + \"resources\" + File.separator + \"views\", \"welcome.blade.php\"));\n \n         // /storage/\n-        supportingFiles.add(new SupportingFile(\"storage/app/gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"app\", \".gitignore\"));\n-        supportingFiles.add(new SupportingFile(\"storage/app/public/gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"app\" + File.separator + \"public\", \".gitignore\"));\n-        supportingFiles.add(new SupportingFile(\"storage/framework/gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"framework\", \".gitignore\"));\n-        supportingFiles.add(new SupportingFile(\"storage/framework/cache/gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"framework\" + File.separator + \"cache\", \".gitignore\"));\n-        supportingFiles.add(new SupportingFile(\"storage/framework/sessions/gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"framework\" + File.separator + \"sessions\", \".gitignore\"));\n-        supportingFiles.add(new SupportingFile(\"storage/framework/testing/gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"framework\" + File.separator + \"testing\", \".gitignore\"));\n-        supportingFiles.add(new SupportingFile(\"storage/framework/views/gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"framework\" + File.separator + \"views\", \".gitignore\"));\n-        supportingFiles.add(new SupportingFile(\"storage/logs/gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"logs\", \".gitignore\"));\n+        supportingFiles.add(new SupportingFile(\"storage/app/.gitignore\", outputFolder + File.separator + \"storage\" + File.separator + \"app\", \".gitignore\"));", "originalCommit": "0acd9adda05a035142c2c6fc37a5cd0f67ee6a5f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4NzMyNA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6346#discussion_r446687324", "bodyText": "Ah, no, that was a discrepancy between new changes in master and the actual tarball provided by Laravel. Now that I can generate the samples I'll get those cleaned up.", "author": "dragonmantank", "createdAt": "2020-06-28T19:15:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4NTkwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4NzgxMQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6346#discussion_r446687811", "bodyText": "I think gitignore without extension is more safe for template files because it:\n\nDoesn't actually ignore anything while it's template.\nIs visible file on MacOS. (dot extension used for hidden files)", "author": "ybelenko", "createdAt": "2020-06-28T19:20:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4NTkwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4ODU4NQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6346#discussion_r446688585", "bodyText": "No complaints from me, I'm happy to follow the convention. I just had them as .gitignore in the templates to save update time later, but I've got no qualms about keeping them as gitignore.", "author": "dragonmantank", "createdAt": "2020-06-28T19:28:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjY4NTkwNQ=="}], "type": "inlineReview"}, {"oid": "fcec819754579f825c6f84f02fd56864910d88b9", "url": "https://github.com/OpenAPITools/openapi-generator/commit/fcec819754579f825c6f84f02fd56864910d88b9", "message": "Fixed gitignore compile errors, updated to newest petstore example", "committedDate": "2020-06-29T00:47:08Z", "type": "commit"}, {"oid": "fcec819754579f825c6f84f02fd56864910d88b9", "url": "https://github.com/OpenAPITools/openapi-generator/commit/fcec819754579f825c6f84f02fd56864910d88b9", "message": "Fixed gitignore compile errors, updated to newest petstore example", "committedDate": "2020-06-29T00:47:08Z", "type": "forcePushed"}, {"oid": "4229edf5f854f662a6e068397b3dda8bcf3a4bb8", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4229edf5f854f662a6e068397b3dda8bcf3a4bb8", "message": "Fix Circle CI pipe", "committedDate": "2020-06-29T19:29:21Z", "type": "commit"}, {"oid": "10e5272a9d365a615b6930552480235e19e08db2", "url": "https://github.com/OpenAPITools/openapi-generator/commit/10e5272a9d365a615b6930552480235e19e08db2", "message": "Add composer.lock to .gitignore", "committedDate": "2020-06-29T21:10:42Z", "type": "commit"}, {"oid": "de243e661ff39f90da4ad4d365938da3629961d4", "url": "https://github.com/OpenAPITools/openapi-generator/commit/de243e661ff39f90da4ad4d365938da3629961d4", "message": "Fix generator gitignore location", "committedDate": "2020-06-29T21:20:08Z", "type": "commit"}, {"oid": "4e8d379fb6e663fcb1a1ad9b7ab1e9ad57fe28ea", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4e8d379fb6e663fcb1a1ad9b7ab1e9ad57fe28ea", "message": "Add integration tests", "committedDate": "2020-06-29T21:50:27Z", "type": "commit"}, {"oid": "cfd4c27f337925a3330c17313339ca09215d5b7d", "url": "https://github.com/OpenAPITools/openapi-generator/commit/cfd4c27f337925a3330c17313339ca09215d5b7d", "message": "Refresh samples", "committedDate": "2020-06-29T21:54:23Z", "type": "commit"}, {"oid": "46f98ea388128e5c8c51e27b66e5946e350f40bc", "url": "https://github.com/OpenAPITools/openapi-generator/commit/46f98ea388128e5c8c51e27b66e5946e350f40bc", "message": "Change phpunit argument", "committedDate": "2020-06-29T22:29:52Z", "type": "commit"}, {"oid": "c0e9893fb9bb53a7102f917b8d1e251af5000e31", "url": "https://github.com/OpenAPITools/openapi-generator/commit/c0e9893fb9bb53a7102f917b8d1e251af5000e31", "message": "Fix Circle CI again", "committedDate": "2020-06-29T23:19:37Z", "type": "commit"}]}