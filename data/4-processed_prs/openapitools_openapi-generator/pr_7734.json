{"pr_number": 7734, "pr_title": "[Ruby][faraday] fix response streaming", "pr_createdAt": "2020-10-16T15:19:03Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/7734", "timeline": [{"oid": "76bef7b64e79031bad3268f200747000ce9b84cb", "url": "https://github.com/OpenAPITools/openapi-generator/commit/76bef7b64e79031bad3268f200747000ce9b84cb", "message": "test file return", "committedDate": "2020-10-16T03:22:40Z", "type": "commit"}, {"oid": "4e9bad2e543e52a3ce69f7e14b6bffbc24bc4836", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4e9bad2e543e52a3ce69f7e14b6bffbc24bc4836", "message": "fix stream response", "committedDate": "2020-10-16T03:48:34Z", "type": "commit"}, {"oid": "4bc1f50dec41311daf41476c956393f6311dd8e7", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4bc1f50dec41311daf41476c956393f6311dd8e7", "message": "use options", "committedDate": "2020-10-16T04:06:00Z", "type": "commit"}, {"oid": "a0b5cbf0d140f0f0b7ca8720b665e785e60190bb", "url": "https://github.com/OpenAPITools/openapi-generator/commit/a0b5cbf0d140f0f0b7ca8720b665e785e60190bb", "message": "use local var", "committedDate": "2020-10-16T04:25:46Z", "type": "commit"}, {"oid": "73fea9998f960dd9c62a95c55f491ae06d633c88", "url": "https://github.com/OpenAPITools/openapi-generator/commit/73fea9998f960dd9c62a95c55f491ae06d633c88", "message": "fix nil tempfile", "committedDate": "2020-10-16T04:48:22Z", "type": "commit"}, {"oid": "6afcf59ac94bcc6d2c8fe1158af38a51eef1e17d", "url": "https://github.com/OpenAPITools/openapi-generator/commit/6afcf59ac94bcc6d2c8fe1158af38a51eef1e17d", "message": "fix tempfile", "committedDate": "2020-10-16T05:01:10Z", "type": "commit"}, {"oid": "120a77ceb47be20ce6b1d1f3eb45791cfd9e496d", "url": "https://github.com/OpenAPITools/openapi-generator/commit/120a77ceb47be20ce6b1d1f3eb45791cfd9e496d", "message": "fix tempfile", "committedDate": "2020-10-16T05:17:53Z", "type": "commit"}, {"oid": "b53ac83b74e9e96313b4ff4f0fd3dc6d12132351", "url": "https://github.com/OpenAPITools/openapi-generator/commit/b53ac83b74e9e96313b4ff4f0fd3dc6d12132351", "message": "use stream", "committedDate": "2020-10-16T06:14:22Z", "type": "commit"}, {"oid": "4f17abe38ecee5b560c56cc17914cd2648b300b7", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4f17abe38ecee5b560c56cc17914cd2648b300b7", "message": "check content", "committedDate": "2020-10-16T06:46:51Z", "type": "commit"}, {"oid": "f056eb0086ce69622b1a566c0103388c4c597eef", "url": "https://github.com/OpenAPITools/openapi-generator/commit/f056eb0086ce69622b1a566c0103388c4c597eef", "message": "open temp file", "committedDate": "2020-10-16T07:01:23Z", "type": "commit"}, {"oid": "0fe7157d44d435fa4b694fbbfeb9e92f428eb223", "url": "https://github.com/OpenAPITools/openapi-generator/commit/0fe7157d44d435fa4b694fbbfeb9e92f428eb223", "message": "test ruby file download", "committedDate": "2020-10-16T07:31:34Z", "type": "commit"}, {"oid": "c9471a8724f407be666a8626cd6420530fee9808", "url": "https://github.com/OpenAPITools/openapi-generator/commit/c9471a8724f407be666a8626cd6420530fee9808", "message": "fix stream data", "committedDate": "2020-10-16T07:56:17Z", "type": "commit"}, {"oid": "2cf5a925b203a4ef2bedc8f30678ce6c5b04f98b", "url": "https://github.com/OpenAPITools/openapi-generator/commit/2cf5a925b203a4ef2bedc8f30678ce6c5b04f98b", "message": "test faraday", "committedDate": "2020-10-16T07:59:02Z", "type": "commit"}, {"oid": "7ab3a9e1b3523a31db0a7d2348469c719ec57173", "url": "https://github.com/OpenAPITools/openapi-generator/commit/7ab3a9e1b3523a31db0a7d2348469c719ec57173", "message": "catch connection error", "committedDate": "2020-10-16T08:14:59Z", "type": "commit"}, {"oid": "e7d01a643ef1922e1a3f20815ff04167fd11cb44", "url": "https://github.com/OpenAPITools/openapi-generator/commit/e7d01a643ef1922e1a3f20815ff04167fd11cb44", "message": "catch Faraday::ConnectionFailed", "committedDate": "2020-10-16T09:37:35Z", "type": "commit"}, {"oid": "bc9ce49f9a49430e500f15d5da083e3b6b4f891d", "url": "https://github.com/OpenAPITools/openapi-generator/commit/bc9ce49f9a49430e500f15d5da083e3b6b4f891d", "message": "catch all error", "committedDate": "2020-10-16T09:56:16Z", "type": "commit"}, {"oid": "1d78ddec4397a737e78493872e84785a5cf1bb58", "url": "https://github.com/OpenAPITools/openapi-generator/commit/1d78ddec4397a737e78493872e84785a5cf1bb58", "message": "use sream", "committedDate": "2020-10-16T10:22:37Z", "type": "commit"}, {"oid": "1ac331c46bb4fd9725e8d7849a4c9230dea015f3", "url": "https://github.com/OpenAPITools/openapi-generator/commit/1ac331c46bb4fd9725e8d7849a4c9230dea015f3", "message": "refactor", "committedDate": "2020-10-16T10:43:22Z", "type": "commit"}, {"oid": "ea756e68cdeed08da9f269efb82cd570ae42b113", "url": "https://github.com/OpenAPITools/openapi-generator/commit/ea756e68cdeed08da9f269efb82cd570ae42b113", "message": "fi download file in faraday", "committedDate": "2020-10-16T15:15:58Z", "type": "commit"}, {"oid": "30c66607ca8b156903e67ae5fd112d1cfa114770", "url": "https://github.com/OpenAPITools/openapi-generator/commit/30c66607ca8b156903e67ae5fd112d1cfa114770", "message": "local fix", "committedDate": "2020-10-24T02:04:39Z", "type": "commit"}, {"oid": "c0ab41e0ab1e6973215116cc4a21481851aba2f7", "url": "https://github.com/OpenAPITools/openapi-generator/commit/c0ab41e0ab1e6973215116cc4a21481851aba2f7", "message": "fi streaming download", "committedDate": "2020-10-24T02:18:36Z", "type": "commit"}, {"oid": "f69687edd5e964899d362f7587e006917fa50fc3", "url": "https://github.com/OpenAPITools/openapi-generator/commit/f69687edd5e964899d362f7587e006917fa50fc3", "message": "undo changess to spec, test", "committedDate": "2020-10-24T02:58:50Z", "type": "commit"}, {"oid": "f9f08a5b95fcc5a288aab506f2f3011c24d402f8", "url": "https://github.com/OpenAPITools/openapi-generator/commit/f9f08a5b95fcc5a288aab506f2f3011c24d402f8", "message": "undo changes to spec", "committedDate": "2020-10-24T04:04:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTY4ODkyNw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7734#discussion_r511688927", "bodyText": "If you use a block, the file will be closed automatically.\nCan this be used?\nhttps://docs.ruby-lang.org/en/2.0.0/Net/HTTP.html#class-Net::HTTP-label-Streaming+Response+Bodies", "author": "tsuwatch", "createdAt": "2020-10-26T02:18:29Z", "path": "samples/client/petstore/ruby-faraday/lib/petstore/api_client.rb", "diffHunk": "@@ -200,19 +200,22 @@ def download_file(request)\n         @tempfile = tempfile\n       end\n \n+      @stream = []\n+\n       # handle streaming Responses\n       request.options.on_data = Proc.new do |chunk, overall_received_bytes|\n         # puts \"Received #{overall_received_bytes} characters\"\n-        tempfile.write(chunk)\n+        @stream << chunk", "originalCommit": "30c66607ca8b156903e67ae5fd112d1cfa114770", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTY4OTgwNA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7734#discussion_r511689804", "bodyText": "Could be. Previously I got IO error when using tempfile.write(chunk).\nCan you test your suggested fix locally and if it works, can you please file a PR?", "author": "wing328", "createdAt": "2020-10-26T02:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTY4ODkyNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTY5MDQwMQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7734#discussion_r511690401", "bodyText": "I see, I got it.", "author": "tsuwatch", "createdAt": "2020-10-26T02:25:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTY4ODkyNw=="}], "type": "inlineReview"}]}