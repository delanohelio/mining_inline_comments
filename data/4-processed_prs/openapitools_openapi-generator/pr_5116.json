{"pr_number": 5116, "pr_title": "[ci][test] Modifications to static analysis contribution via Tomasbjerre", "pr_createdAt": "2020-01-26T16:27:40Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/5116", "timeline": [{"oid": "4050994e3053a0054fb3328cadef19807a431051", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4050994e3053a0054fb3328cadef19807a431051", "message": "Spotbugs, PMD and Checkstyle #33", "committedDate": "2020-01-25T16:42:45Z", "type": "commit"}, {"oid": "b7c33ec0156a4a6596846fdd54f0cddd3bfe0fee", "url": "https://github.com/OpenAPITools/openapi-generator/commit/b7c33ec0156a4a6596846fdd54f0cddd3bfe0fee", "message": "Reducing Spotbugs effort to min #33\n\n * Also using project.parent.basedir and avoiding relative paths in pom files.\n * Filtering out samples.", "committedDate": "2020-01-25T17:56:57Z", "type": "commit"}, {"oid": "80b0ec69de079b3be0761de0e0bc17cc894cf793", "url": "https://github.com/OpenAPITools/openapi-generator/commit/80b0ec69de079b3be0761de0e0bc17cc894cf793", "message": "Move PMD/Spotbugs to static-analysis profile\n\nThis moves the static-analysis checks to a standalone profile. Core\ncontributors may run static analysis with:\n\n```\nmvn -Pstatic-analysis install\n```\n\nThe analysis is separated from default functionality to reduce impact to\ncommunity contributions. SpotBugs/PMD may add a non-trivial amount of\ntime to builds on some machines.", "committedDate": "2020-01-26T16:13:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAxMzkwMQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5116#discussion_r371013901", "bodyText": "One could argue that the generated code should also be free from issues found by static code analysis. I'm not sure about excluding samples here.\nI can see how users have different code standards and running Checkstyle and PMD is not worth the effort, but I'm not sure it is good to exclude Spotbugs here.", "author": "tomasbjerre", "createdAt": "2020-01-26T16:52:55Z", "path": "spotbugs-exclude.xml", "diffHunk": "@@ -0,0 +1,34 @@\n+<FindBugsFilter>\n+\n+\t<Match>\n+\t\t<Bug pattern=\"RCN_REDUNDANT_NULLCHECK_OF_NONNULL_VALUE\" />\n+\t</Match>\n+\n+\t<Match>\n+\t\t<Bug pattern=\"URF_UNREAD_PUBLIC_OR_PROTECTED_FIELD\" />\n+\t</Match>\n+\n+\t<Match>\n+\t\t<Bug pattern=\"RV_RETURN_VALUE_IGNORED_BAD_PRACTICE\" />\n+\t</Match>\n+\n+\t<Match>\n+\t\t<Bug pattern=\"URF_UNREAD_FIELD\" />\n+\t\t<Or>\n+\t\t\t<And>\n+\t\t\t\t<Class name=\"io.undertow.server.protocol.ajp.AjpRequestParseState\" />\n+\t\t\t\t<Field name=\"dataSize\" />\n+\t\t\t</And>\n+\t\t</Or>\n+\t</Match>\n+\n+\t<!-- For source/class naming, see https://spotbugs.readthedocs.io/en/stable/filter.html#java-element-name-matching -->\n+\t<Match>\n+\t\t<!-- Ignore all source files with samples in path name -->", "originalCommit": "80b0ec69de079b3be0761de0e0bc17cc894cf793", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAxNDI5OA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5116#discussion_r371014298", "bodyText": "Another reason to exclude these here is that I assume most users use custom templates. Analyzing our \"samples\" is therefore very much like analyzing our tests.", "author": "jimschubert", "createdAt": "2020-01-26T16:59:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAxMzkwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAxNDQyOQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5116#discussion_r371014429", "bodyText": "Another concern is that only a very small subset of our samples are Java :\nMaybe we could later work out the pattern to exclude everything but java client and server outputs in the samples directory.", "author": "jimschubert", "createdAt": "2020-01-26T17:00:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAxMzkwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAxMzk2OA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5116#discussion_r371013968", "bodyText": "Now that it does not run by default, perhaps it does not need to be min?", "author": "tomasbjerre", "createdAt": "2020-01-26T16:54:06Z", "path": "pom.xml", "diffHunk": "@@ -470,6 +542,73 @@\n                 </plugins>\n             </build>\n         </profile>\n+        <!-- CI related -->\n+        <profile>\n+            <!-- This profile will run much more in-depth static analysis checks. -->\n+            <id>static-analysis</id>\n+            <properties>\n+                <skipTests>true</skipTests>\n+                <maven.javadoc.skip>true</maven.javadoc.skip>\n+            </properties>\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <groupId>com.github.spotbugs</groupId>\n+                        <artifactId>spotbugs-maven-plugin</artifactId>\n+                        <version>${spotbugs.plugin.version}</version>\n+                        <configuration>\n+                            <failOnError>false</failOnError>\n+                            <!-- https://spotbugs.readthedocs.io/en/stable/effort.html -->\n+                            <effort>min</effort>", "originalCommit": "80b0ec69de079b3be0761de0e0bc17cc894cf793", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAxNDMzMQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5116#discussion_r371014331", "bodyText": "I can evaluate this once it's hooked into the target pipeline.", "author": "jimschubert", "createdAt": "2020-01-26T16:59:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAxMzk2OA=="}], "type": "inlineReview"}]}