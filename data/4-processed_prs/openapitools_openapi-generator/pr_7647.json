{"pr_number": 7647, "pr_title": "[Fix/Dart2] Resolve an exception with status 204 and no body.", "pr_createdAt": "2020-10-11T11:17:39Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/7647", "timeline": [{"oid": "32278ef0e018e97a9b68ff5cd36d8f595dbd650c", "url": "https://github.com/OpenAPITools/openapi-generator/commit/32278ef0e018e97a9b68ff5cd36d8f595dbd650c", "message": "Resolve an exception situation when a remote server returns 204 with no body.", "committedDate": "2020-10-11T11:15:16Z", "type": "commit"}, {"oid": "3dd786749fecfda62a1bea1dd238c6aeb7792941", "url": "https://github.com/OpenAPITools/openapi-generator/commit/3dd786749fecfda62a1bea1dd238c6aeb7792941", "message": "Only return a value when needed.", "committedDate": "2020-10-11T11:25:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkwMzUzNw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r502903537", "bodyText": "lol you like yoga syntax \ud83d\ude06\ncan we put the 204 in a const variable with proper name instead creating a magic number?", "author": "agilob", "createdAt": "2020-10-11T11:35:08Z", "path": "modules/openapi-generator/src/main/resources/dart2/api.mustache", "diffHunk": "@@ -165,7 +165,12 @@ class {{{classname}}} {\n     if (response.statusCode >= 400) {\n       throw ApiException(response.statusCode, _decodeBodyBytes(response));\n     }\n-    if (response.body != null) {\n+\n+    // When a remote server returns no body with a status of 204, we shall not decode it.\n+    // At the time of writing this, `dart:convert` will throw an \"Unexpected end of input\"\n+    // FormatException when trying to decode an empty string.\n+    final responseBody = response.body;\n+    if (responseBody != null && (responseBody.isNotEmpty || 204 != response.statusCode)) {", "originalCommit": "32278ef0e018e97a9b68ff5cd36d8f595dbd650c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkwMzc2NQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r502903765", "bodyText": "or even better, an interface/class with such magic numbers we can refer to in the future\nclass HttpCodes {\nint NO_BODY = 204;\n}\nThat's probably more effort than you were aiming here, but I feel it would be an investment into code quality for future.", "author": "agilob", "createdAt": "2020-10-11T11:37:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkwMzUzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkxOTMxNA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r502919314", "bodyText": "Oops, yes yes I do :) I'll do that.", "author": "noordawod", "createdAt": "2020-10-11T14:00:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkwMzUzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkyMzc1OA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r502923758", "bodyText": "There already exists such a class in http/html package: HttpStatus. Refactoring...", "author": "noordawod", "createdAt": "2020-10-11T14:36:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjkwMzUzNw=="}], "type": "inlineReview"}, {"oid": "d52cdff614cdb66b4fcf80f2d5f905959a60cb42", "url": "https://github.com/OpenAPITools/openapi-generator/commit/d52cdff614cdb66b4fcf80f2d5f905959a60cb42", "message": "Use HttpStatus codes instead of magic numbers.", "committedDate": "2020-10-11T14:42:11Z", "type": "commit"}, {"oid": "6464d7ad43383c42e8b436ea3b41143c54ff4c9a", "url": "https://github.com/OpenAPITools/openapi-generator/commit/6464d7ad43383c42e8b436ea3b41143c54ff4c9a", "message": "Drop checking for a body as it will consume too much memory.", "committedDate": "2020-10-11T15:29:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1MzAyMA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r502953020", "bodyText": "This is getting complex fast", "author": "agilob", "createdAt": "2020-10-11T19:01:12Z", "path": "samples/client/petstore/dart2/petstore_client_lib/lib/api_helper.dart", "diffHunk": "@@ -56,6 +56,6 @@ String parameterToString(dynamic value) {\n String _decodeBodyBytes(Response response) {\n   final contentType = response.headers['content-type'];\n   return contentType != null && contentType.contains('application/json')\n-    ? utf8.decode(response.bodyBytes)", "originalCommit": "6464d7ad43383c42e8b436ea3b41143c54ff4c9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzA0MzI1Ng==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/7647#discussion_r503043256", "bodyText": "Hmm, I checked and it's not what you see above. Now that line shows:\n  ? response.bodyBytes == null ? null : utf8.decode(response.bodyBytes)", "author": "noordawod", "createdAt": "2020-10-12T05:17:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1MzAyMA=="}], "type": "inlineReview"}, {"oid": "2e974a7da05062a87530e217cc347dafddab6cf0", "url": "https://github.com/OpenAPITools/openapi-generator/commit/2e974a7da05062a87530e217cc347dafddab6cf0", "message": "Merge branch 'master' into bugfix/dart2-status-204", "committedDate": "2020-10-12T05:14:28Z", "type": "commit"}, {"oid": "529eea759811ebc25b8077b94f20419e7cd94095", "url": "https://github.com/OpenAPITools/openapi-generator/commit/529eea759811ebc25b8077b94f20419e7cd94095", "message": "Cosmetic changes.", "committedDate": "2020-10-12T06:11:37Z", "type": "commit"}, {"oid": "d4c92d5a1816abd286a76ae71977af42e4fb5ae0", "url": "https://github.com/OpenAPITools/openapi-generator/commit/d4c92d5a1816abd286a76ae71977af42e4fb5ae0", "message": "Merge branch 'master' into bugfix/dart2-status-204", "committedDate": "2020-10-12T19:05:41Z", "type": "commit"}, {"oid": "9a992d7ccbceed25769731fb326f2e6c771707b0", "url": "https://github.com/OpenAPITools/openapi-generator/commit/9a992d7ccbceed25769731fb326f2e6c771707b0", "message": "Merge branch 'master' into bugfix/dart2-status-204", "committedDate": "2020-10-13T06:12:41Z", "type": "commit"}]}