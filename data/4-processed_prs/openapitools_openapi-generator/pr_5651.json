{"pr_number": 5651, "pr_title": "[C++] [Qt5] fixed cpp-client-qt5 HttpRequestWorker requests crashing on timeout", "pr_createdAt": "2020-03-20T19:08:45Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/5651", "timeline": [{"oid": "719de7c7616909294f20dd13239e2521dc703db1", "url": "https://github.com/OpenAPITools/openapi-generator/commit/719de7c7616909294f20dd13239e2521dc703db1", "message": "- fixed cpp-client-qt5 HttpRequestWorker requests crashing on timeout when they have actually NOT timed out (were calling back into a deleted struct).", "committedDate": "2020-03-20T18:55:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkwODUzMw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5651#discussion_r395908533", "bodyText": "I think you might want to set the parent for timeOutTimer", "author": "etherealjoy", "createdAt": "2020-03-20T22:00:09Z", "path": "modules/openapi-generator/src/main/resources/cpp-qt5-client/HttpRequest.cpp.mustache", "diffHunk": "@@ -45,14 +45,15 @@ void {{prefix}}HttpRequestInput::add_file(QString variable_name, QString local_f\n }\n \n {{prefix}}HttpRequestWorker::{{prefix}}HttpRequestWorker(QObject *parent)\n-    : QObject(parent), manager(nullptr), _timeOut(0) {\n+    : QObject(parent), manager(nullptr), timeOutTimer() {", "originalCommit": "719de7c7616909294f20dd13239e2521dc703db1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkwOTA0Mw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5651#discussion_r395909043", "bodyText": "is this needed?", "author": "etherealjoy", "createdAt": "2020-03-20T22:01:55Z", "path": "modules/openapi-generator/src/main/resources/cpp-qt5-client/HttpRequest.cpp.mustache", "diffHunk": "@@ -86,8 +87,11 @@ QByteArray *{{prefix}}HttpRequestWorker::getMultiPartField(const QString &fieldn\n     return nullptr;\n }\n \n-void {{prefix}}HttpRequestWorker::setTimeOut(int timeOut) {\n-    _timeOut = timeOut;\n+void {{prefix}}HttpRequestWorker::setTimeOut(int timeOutMs) {\n+    timeOutTimer.setInterval(timeOutMs);\n+    if(timeOutTimer.interval() == 0) {", "originalCommit": "719de7c7616909294f20dd13239e2521dc703db1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkwOTUyMA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5651#discussion_r395909520", "bodyText": "This is available only on 5.12 and above. Is there a possibility to use a more backward compatible call?", "author": "etherealjoy", "createdAt": "2020-03-20T22:03:28Z", "path": "modules/openapi-generator/src/main/resources/cpp-qt5-client/HttpRequest.cpp.mustache", "diffHunk": "@@ -347,12 +351,14 @@ void {{prefix}}HttpRequestWorker::execute({{prefix}}HttpRequestInput *input) {\n         buffer->setParent(reply);\n #endif\n     }\n-    if (_timeOut > 0) {\n-        QTimer::singleShot(_timeOut, [=]() { on_manager_timeout(reply); });\n+    if (timeOutTimer.interval() > 0) {\n+        timeOutTimer.callOnTimeout([=]() { on_manager_timeout(reply); });", "originalCommit": "719de7c7616909294f20dd13239e2521dc703db1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTkwOTc1MQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5651#discussion_r395909751", "bodyText": "Need to stop the timer here too.", "author": "etherealjoy", "createdAt": "2020-03-20T22:04:24Z", "path": "modules/openapi-generator/src/main/resources/cpp-qt5-client/HttpRequest.cpp.mustache", "diffHunk": "@@ -347,12 +351,14 @@ void {{prefix}}HttpRequestWorker::execute({{prefix}}HttpRequestInput *input) {\n         buffer->setParent(reply);\n #endif\n     }\n-    if (_timeOut > 0) {\n-        QTimer::singleShot(_timeOut, [=]() { on_manager_timeout(reply); });\n+    if (timeOutTimer.interval() > 0) {\n+        timeOutTimer.callOnTimeout([=]() { on_manager_timeout(reply); });\n     }\n }\n \n void {{prefix}}HttpRequestWorker::on_manager_finished(QNetworkReply *reply) {\n+    if(timeOutTimer.interval() > 0)", "originalCommit": "719de7c7616909294f20dd13239e2521dc703db1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "21f7e48c8c20226f8b493b3e6ada3c87949fd3e6", "url": "https://github.com/OpenAPITools/openapi-generator/commit/21f7e48c8c20226f8b493b3e6ada3c87949fd3e6", "message": "#minor fixes after review", "committedDate": "2020-03-23T14:57:40Z", "type": "commit"}, {"oid": "40617d6ee96706c191b0923e6d8f802adbf911fa", "url": "https://github.com/OpenAPITools/openapi-generator/commit/40617d6ee96706c191b0923e6d8f802adbf911fa", "message": "Regenerate changed files", "committedDate": "2020-03-24T12:26:56Z", "type": "commit"}]}