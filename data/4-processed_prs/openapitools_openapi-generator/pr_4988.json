{"pr_number": 4988, "pr_title": "[Python] Conditionally set auth attributes", "pr_createdAt": "2020-01-13T17:48:56Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/4988", "timeline": [{"oid": "b51bb7fcacf5297a7cb644fb660f24d9ac9fc05f", "url": "https://github.com/OpenAPITools/openapi-generator/commit/b51bb7fcacf5297a7cb644fb660f24d9ac9fc05f", "message": "Enhance python API keys", "committedDate": "2020-01-13T17:48:22Z", "type": "commit"}, {"oid": "37f18d90cfdddec4acd245e209b7950c3fba81b6", "url": "https://github.com/OpenAPITools/openapi-generator/commit/37f18d90cfdddec4acd245e209b7950c3fba81b6", "message": "Merge branch 'master' of github.com:CiscoM31/openapi-generator into bugfix/issue3844-2", "committedDate": "2020-01-13T20:04:56Z", "type": "commit"}, {"oid": "f0daf07477ca95820ac4d0d84148d6f6a9af8e52", "url": "https://github.com/OpenAPITools/openapi-generator/commit/f0daf07477ca95820ac4d0d84148d6f6a9af8e52", "message": "Run python scripts under ./bin/openapi3", "committedDate": "2020-01-13T21:19:07Z", "type": "commit"}, {"oid": "80147a4304c4113838dead2ab7632bc01f6457d6", "url": "https://github.com/OpenAPITools/openapi-generator/commit/80147a4304c4113838dead2ab7632bc01f6457d6", "message": "fix unit test issue", "committedDate": "2020-01-14T16:22:14Z", "type": "commit"}, {"oid": "84611382222951a12270b3f14a90b7006b261c60", "url": "https://github.com/OpenAPITools/openapi-generator/commit/84611382222951a12270b3f14a90b7006b261c60", "message": "Merge branch 'master' of github.com:CiscoM31/openapi-generator into bugfix/issue3844-2", "committedDate": "2020-01-14T16:24:44Z", "type": "commit"}, {"oid": "8e7ae1e737c6381a016120b2e2a34dd19825b589", "url": "https://github.com/OpenAPITools/openapi-generator/commit/8e7ae1e737c6381a016120b2e2a34dd19825b589", "message": "Fix unit tests", "committedDate": "2020-01-14T17:27:05Z", "type": "commit"}, {"oid": "4353202f1ad6225ff12d4e7f322b0d19205ad81b", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4353202f1ad6225ff12d4e7f322b0d19205ad81b", "message": "Fix unit tests", "committedDate": "2020-01-14T18:00:00Z", "type": "commit"}, {"oid": "708a76c2df29c119f0b26988e2a1627dd89713ac", "url": "https://github.com/OpenAPITools/openapi-generator/commit/708a76c2df29c119f0b26988e2a1627dd89713ac", "message": "Invoke bin scripts", "committedDate": "2020-01-14T19:10:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5OTQ5Mw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4988#discussion_r371399493", "bodyText": "This change breaks my client using openapi-generator-cli-5.0.0-20200127.021040-34.jar\nWe have api endpoints which allow Any Auth method. This function needs an overhaul, because it simply picks the last configured setting in the array, instead of the one which has actually been specified in the Configuration instance...\nPreserving this line makes the code do the right thing...\nif not auth_setting['value']:\n                continue", "author": "martyzz1", "createdAt": "2020-01-27T18:12:13Z", "path": "modules/openapi-generator/src/main/resources/python/api_client.mustache", "diffHunk": "@@ -520,9 +520,7 @@ class ApiClient(object):\n         for auth in auth_settings:\n             auth_setting = self.configuration.auth_settings().get(auth)\n             if auth_setting:\n-                if not auth_setting['value']:", "originalCommit": "708a76c2df29c119f0b26988e2a1627dd89713ac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQwMDQ4Mw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4988#discussion_r371400483", "bodyText": "This is the error we get without the line:-\n  Traceback (most recent call last):\n  File \"/usr/local/lib/python3.6/unittest/mock.py\", line 1183, in patched\n    return func(*args, **keywargs)\n  File \"/home/circleci/app/snap_usertracking/tests/test_client_api.py\", line 665, in test_post_apikey\n    response = api_instance.user_event(correct_post_data)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/snap_usertracking_api/api/tracking_api.py\", line 287, in user_event\n    **kwargs)  # noqa: E501\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/snap_usertracking_api/api/tracking_api.py\", line 402, in user_event_with_http_info\n    collection_formats=collection_formats)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/snap_usertracking_api/api_client.py\", line 378, in call_api\n    _request_timeout, _host)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/snap_usertracking_api/api_client.py\", line 190, in __call_api\n    _request_timeout=_request_timeout)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/snap_usertracking_api/api_client.py\", line 422, in request\n    body=body)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/snap_usertracking_api/rest.py\", line 313, in POST\n    body=body)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/snap_usertracking_api/rest.py\", line 170, in request\n    headers=headers)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/urllib3/request.py\", line 80, in request\n    method, url, fields=fields, headers=headers, **urlopen_kw\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/urllib3/request.py\", line 171, in request_encode_body\n    return self.urlopen(method, url, **extra_kw)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/urllib3/poolmanager.py\", line 330, in urlopen\n    response = conn.urlopen(method, u.request_uri, **kw)\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/urllib3/connectionpool.py\", line 672, in urlopen\n    chunked=chunked,\n  File \"/home/circleci/app/venv/lib/python3.6/site-packages/urllib3/connectionpool.py\", line 387, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File \"/usr/local/lib/python3.6/http/client.py\", line 1262, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File \"/usr/local/lib/python3.6/http/client.py\", line 1303, in _send_request\n    self.putheader(hdr, value)\n  File \"/usr/local/lib/python3.6/http/client.py\", line 1239, in putheader\n    if _is_illegal_header_value(values[i]):\nTypeError: expected string or bytes-like object", "author": "martyzz1", "createdAt": "2020-01-27T18:14:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5OTQ5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQwMzc4Mg==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4988#discussion_r371403782", "bodyText": "We have api endpoints which allow Any Auth method.\n\nCan you clarify a bit what you mean by \"Any\" auth?\nAlso, to help me understand better, in your case, which security scheme has an auth_setting item with 'value' set to None? Sorry unfortunately it's hard to map the line numbers from the stack trace because that code is generated and line numbers can change depending on the OAS spec.\nIn the new configuration.mustache, the auth_settings are added only when the corresponding parameters have been set in the Configuration class. So there should not be an item in the auth_settings unless your client has configured it.\nNote that previously, auth_settings() was unconditionally returning an array of items, even if the items in the array had no matching config parameters in \"Configuration\".", "author": "sebastien-rosset", "createdAt": "2020-01-27T18:21:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5OTQ5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTUzNjE5OQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4988#discussion_r371536199", "bodyText": "ahh, I have a custom configuration.mustache but based on an older version.... I'll try updating it and see if that works...", "author": "martyzz1", "createdAt": "2020-01-27T23:16:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5OTQ5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTU1NjcwOQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/4988#discussion_r371556709", "bodyText": "ahh, I have a custom configuration.mustache but based on an older version.... I'll try updating it and see if that works...\n\nI see. Let me know how it goes.", "author": "sebastien-rosset", "createdAt": "2020-01-28T00:28:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5OTQ5Mw=="}], "type": "inlineReview"}]}