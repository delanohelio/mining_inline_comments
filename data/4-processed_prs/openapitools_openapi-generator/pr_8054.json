{"pr_number": 8054, "pr_title": "Stackoverflow in toExampleValue() for python client", "pr_createdAt": "2020-11-30T21:30:29Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/8054", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNDE5NA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/8054#discussion_r533024194", "bodyText": "Your update is breaking these samples.\n\nClient\nAnimalFarm\nXmlItem\n... and others\n\nCan you update your code so these work correctly?", "author": "spacether", "createdAt": "2020-12-01T02:03:15Z", "path": "samples/client/petstore/python/docs/FakeApi.md", "diffHunk": "@@ -175,55 +173,7 @@ configuration = petstore_api.Configuration(\n with petstore_api.ApiClient() as api_client:\n     # Create an instance of the API class\n     api_instance = fake_api.FakeApi(api_client)\n-    xml_item = XmlItem(\n-        attribute_string=\"string\",\n-        attribute_number=1.234,\n-        attribute_integer=-2,\n-        attribute_boolean=True,\n-        wrapped_array=[\n-            1,\n-        ],\n-        name_string=\"string\",\n-        name_number=1.234,\n-        name_integer=-2,\n-        name_boolean=True,\n-        name_array=[\n-            1,\n-        ],\n-        name_wrapped_array=[\n-            1,\n-        ],\n-        prefix_string=\"string\",\n-        prefix_number=1.234,\n-        prefix_integer=-2,\n-        prefix_boolean=True,\n-        prefix_array=[\n-            1,\n-        ],\n-        prefix_wrapped_array=[\n-            1,\n-        ],\n-        namespace_string=\"string\",\n-        namespace_number=1.234,\n-        namespace_integer=-2,\n-        namespace_boolean=True,\n-        namespace_array=[\n-            1,\n-        ],\n-        namespace_wrapped_array=[\n-            1,\n-        ],\n-        prefix_ns_string=\"string\",\n-        prefix_ns_number=1.234,\n-        prefix_ns_integer=-2,\n-        prefix_ns_boolean=True,\n-        prefix_ns_array=[\n-            1,\n-        ],\n-        prefix_ns_wrapped_array=[\n-            1,\n-        ],\n-    ) # XmlItem | XmlItem Body\n+    xml_item = XmlItem(XmlItem) # XmlItem | XmlItem Body", "originalCommit": "cacc4d62ee6333d6b419d6ef25600e9876205da6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNTA0OQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/8054#discussion_r533025049", "bodyText": "Shouldn't we only add a model when we have finished generating its sample?\nWhat are our recursive base cases here for cycles?\nHow about naming them seenModels because we have not finished processing it yet.", "author": "spacether", "createdAt": "2020-12-01T02:06:13Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/PythonClientCodegen.java", "diffHunk": "@@ -948,6 +949,18 @@ private String toExampleValueRecursive(String modelName, Schema schema, Object o\n         if (objExample != null) {\n             example = objExample.toString();\n         }\n+\n+        // check for recursive model\n+        if (processedModels.contains(modelName)) {\n+            // have already processed this model\n+            // this happens when you have recursive or circular models\n+            return fullPrefix + modelName + closeChars;\n+        } else if(modelName != null && !modelName.isEmpty()){\n+            // if the model is non-null and non-empty, add it to the set\n+            processedModels.add(modelName);", "originalCommit": "cacc4d62ee6333d6b419d6ef25600e9876205da6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNjIxMg==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/8054#discussion_r533026212", "bodyText": "I'll go back and take a look at this again, thanks.  I didn't realize that the 'ran /bin/utils/ensure-up-to-date' was required and didn't pick up on the fact that my examples had changed that.", "author": "fbl100", "createdAt": "2020-12-01T02:10:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNTA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTc4MDkwNQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/8054#discussion_r541780905", "bodyText": "@spacether Got a CircleCI build error that I'm having  a hard time interpreting.  Do you mind taking a look and providing pointers for how to reproduce locally?", "author": "fbl100", "createdAt": "2020-12-12T21:08:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNTA0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjkxNTQ2Ng==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/8054#discussion_r542915466", "bodyText": "That error is unrelated. We. can ignore it.", "author": "spacether", "createdAt": "2020-12-14T23:15:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzAyNTA0OQ=="}], "type": "inlineReview"}, {"oid": "47da5e52f334f4110b23dd1cd8bfa3341d311ef2", "url": "https://github.com/OpenAPITools/openapi-generator/commit/47da5e52f334f4110b23dd1cd8bfa3341d311ef2", "message": "Fixes issue 8052: Stackoverflow in toExampleValue() for python client\n\nAdded a Set<String> in toExampleValueRecursive() to keep track of which models we have\ngenerated to avoid an infinite recursion for recursive models.  An example of a recursive\nmodel would be a GeoJson GeometryCollection.", "committedDate": "2020-12-11T19:49:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjkxNDQyMQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/8054#discussion_r542914421", "bodyText": "null is invalid in Python. Can you update this value? If the list is not explicitly nullable, then the example value should be [] (empty list). If it is nullable, then the example value can be None.", "author": "spacether", "createdAt": "2020-12-14T23:12:54Z", "path": "modules/openapi-generator/src/test/resources/3_0/issue_8052_recursive_model_expected_value.txt", "diffHunk": "@@ -0,0 +1,9 @@\n+GeoJsonGeometry(\n+        type=\"GeometryCollection\",\n+        geometries=[\n+            GeoJsonGeometry(\n+                type=\"GeometryCollection\",\n+                geometries=null,", "originalCommit": "47da5e52f334f4110b23dd1cd8bfa3341d311ef2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0cd251d923e73b5e5c6f4a9185781c28601b9032", "url": "https://github.com/OpenAPITools/openapi-generator/commit/0cd251d923e73b5e5c6f4a9185781c28601b9032", "message": "Fixes issue 8052: Stackoverflow in toExampleValue() for python client\n\nAdded a Set<String> in toExampleValueRecursive() to keep track of which models we have\ngenerated to avoid an infinite recursion for recursive models.  An example of a recursive\nmodel would be a GeoJson GeometryCollection.", "committedDate": "2020-12-18T14:40:19Z", "type": "forcePushed"}, {"oid": "63ac823cc8dbda3cf0d6da8d65f79b8930349975", "url": "https://github.com/OpenAPITools/openapi-generator/commit/63ac823cc8dbda3cf0d6da8d65f79b8930349975", "message": "Fixes issue 8052: Stackoverflow in toExampleValue() for python client\n\nAdded a Set<String> in toExampleValueRecursive() to keep track of which models we have\ngenerated to avoid an infinite recursion for recursive models.  An example of a recursive\nmodel would be a GeoJson GeometryCollection.", "committedDate": "2020-12-24T15:49:50Z", "type": "forcePushed"}, {"oid": "3206b2b1a9e67b124b71f570d4279d1ac6fc3bda", "url": "https://github.com/OpenAPITools/openapi-generator/commit/3206b2b1a9e67b124b71f570d4279d1ac6fc3bda", "message": "Fixes issue 8052: Stackoverflow in toExampleValue() for python client\n\nAdded a Set<String> in toExampleValueRecursive() to keep track of which models we have\ngenerated to avoid an infinite recursion for recursive models.  An example of a recursive\nmodel would be a GeoJson GeometryCollection.", "committedDate": "2020-12-28T13:50:31Z", "type": "commit"}, {"oid": "3206b2b1a9e67b124b71f570d4279d1ac6fc3bda", "url": "https://github.com/OpenAPITools/openapi-generator/commit/3206b2b1a9e67b124b71f570d4279d1ac6fc3bda", "message": "Fixes issue 8052: Stackoverflow in toExampleValue() for python client\n\nAdded a Set<String> in toExampleValueRecursive() to keep track of which models we have\ngenerated to avoid an infinite recursion for recursive models.  An example of a recursive\nmodel would be a GeoJson GeometryCollection.", "committedDate": "2020-12-28T13:50:31Z", "type": "forcePushed"}]}