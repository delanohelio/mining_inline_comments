{"pr_number": 5643, "pr_title": "[bug][html2] Fix visibility of body/response schemas", "pr_createdAt": "2020-03-20T11:01:50Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/5643", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYxMzYyMQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5643#discussion_r404613621", "bodyText": "I wonder if you can share a minimal spec to reproduce the issue fixed by this change?", "author": "wing328", "createdAt": "2020-04-07T08:02:27Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/DefaultCodegen.java", "diffHunk": "@@ -5482,13 +5482,20 @@ public CodegenParameter fromRequestBody(RequestBody body, Set<String> imports, S\n             setParameterNullable(codegenParameter, codegenProperty);\n         }\n \n+        addJsonSchemaForBodyRequestInCaseItsNotPresent(codegenParameter, body);\n+\n         // set the parameter's example value\n         // should be overridden by lang codegen\n         setParameterExampleValue(codegenParameter, body);\n \n         return codegenParameter;\n     }\n \n+    private void addJsonSchemaForBodyRequestInCaseItsNotPresent(CodegenParameter codegenParameter, RequestBody body){\n+        if(codegenParameter.jsonSchema == null)\n+            codegenParameter.jsonSchema = Json.pretty(body);", "originalCommit": "bf2636d67883a8e0ccf088bea9d20027fd12f65d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDkwMTMzNQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5643#discussion_r410901335", "bodyText": "I commented on my phone, and this was attached at the PR level rather than response here. I'm duplicating my response here in case you didn't see it.\nThis affects every spec. You can see the current samples, none of which display body parameter information.", "author": "jimschubert", "createdAt": "2020-04-19T13:09:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYxMzYyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzExODM2Mw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5643#discussion_r407118363", "bodyText": "This does not cover array type, e.g.:\nschema:\n  type: array\n  items:\n    ref: '#/components/schemas/Pet'\nSo I had to add one more if statement:\n...\n} else if (schema.type === 'array' && schema.items != null && schema.items.$ref != null) {\n    schema.items = defsParser.$refs.get(schema.items.$ref);\n} else {\n    // line 450\n}", "author": "astoialtsev", "createdAt": "2020-04-11T22:34:51Z", "path": "modules/openapi-generator/src/main/resources/htmlDocs2/index.mustache", "diffHunk": "@@ -416,7 +441,10 @@\n                                     <script>\n                                       $(document).ready(function() {\n                                         var schemaWrapper = {{{jsonSchema}}};\n-                                        var schema = schemaWrapper.schema;\n+                                        var schema = findNode('schema',schemaWrapper).schema;\n+                                        if (!schema) {\n+                                            schema = schemaWrapper.schema;\n+                                        }\n                                         if (schema.$ref != null) {\n                                           schema = defsParser.$refs.get(schema.$ref);\n                                         } else {", "originalCommit": "bf2636d67883a8e0ccf088bea9d20027fd12f65d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDgyMjE3Nw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5643#discussion_r410822177", "bodyText": "You're totally right. I tested it on two different versions of the OpenApi generator and on the older one there was no issue with arrays, so I didn't cover it up, but that's a great change.", "author": "degath", "createdAt": "2020-04-19T05:35:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzExODM2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDkwMTgyNA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5643#discussion_r410901824", "bodyText": "I've applied the suggested fix to this branch.", "author": "jimschubert", "createdAt": "2020-04-19T13:10:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzExODM2Mw=="}], "type": "inlineReview"}, {"oid": "d8790d92773e2888795ca03a93ba1bc957c616a5", "url": "https://github.com/OpenAPITools/openapi-generator/commit/d8790d92773e2888795ca03a93ba1bc957c616a5", "message": "1441 fix visibility of body/response schemas", "committedDate": "2020-04-19T05:26:50Z", "type": "commit"}, {"oid": "d8790d92773e2888795ca03a93ba1bc957c616a5", "url": "https://github.com/OpenAPITools/openapi-generator/commit/d8790d92773e2888795ca03a93ba1bc957c616a5", "message": "1441 fix visibility of body/response schemas", "committedDate": "2020-04-19T05:26:50Z", "type": "forcePushed"}, {"oid": "949dfd6e5bace1df69d55ac7516171321fa891f6", "url": "https://github.com/OpenAPITools/openapi-generator/commit/949dfd6e5bace1df69d55ac7516171321fa891f6", "message": "Remove non-project files", "committedDate": "2020-04-19T12:41:57Z", "type": "commit"}, {"oid": "452029fd71c884d84791295b0a0e9dcee26f7fdf", "url": "https://github.com/OpenAPITools/openapi-generator/commit/452029fd71c884d84791295b0a0e9dcee26f7fdf", "message": "[html] Handle schemas with array items", "committedDate": "2020-04-19T12:44:55Z", "type": "commit"}, {"oid": "d7f66c2ad4e35d13f736be684c3da121488398e7", "url": "https://github.com/OpenAPITools/openapi-generator/commit/d7f66c2ad4e35d13f736be684c3da121488398e7", "message": "[html2] Point to template directory in bin script", "committedDate": "2020-04-19T12:48:40Z", "type": "commit"}, {"oid": "f7681cab12e4daf02fa61ba7e149aebb12091c94", "url": "https://github.com/OpenAPITools/openapi-generator/commit/f7681cab12e4daf02fa61ba7e149aebb12091c94", "message": "[html2] Regenerate sample", "committedDate": "2020-04-19T12:49:53Z", "type": "commit"}]}