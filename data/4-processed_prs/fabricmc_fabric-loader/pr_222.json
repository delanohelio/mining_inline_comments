{"pr_number": 222, "pr_title": "Generate javadocs for loader", "pr_createdAt": "2020-04-07T09:40:09Z", "pr_url": "https://github.com/FabricMC/fabric-loader/pull/222", "timeline": [{"oid": "61b2c73bd27525bdca5fc94bfd9a1cf55bfb24e5", "url": "https://github.com/FabricMC/fabric-loader/commit/61b2c73bd27525bdca5fc94bfd9a1cf55bfb24e5", "message": "Generate javadocs for loader\n\nSigned-off-by: liach <liach@users.noreply.github.com>", "committedDate": "2020-04-07T09:38:19Z", "type": "commit"}, {"oid": "335c43ca4b596e27ea92fcb9629e717055abf569", "url": "https://github.com/FabricMC/fabric-loader/commit/335c43ca4b596e27ea92fcb9629e717055abf569", "message": "Add jd for all exposed classes", "committedDate": "2020-04-17T20:34:33Z", "type": "commit"}, {"oid": "232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "url": "https://github.com/FabricMC/fabric-loader/commit/232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "message": "use readme as overview if pandoc generates one readme html", "committedDate": "2020-04-17T20:40:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzE2MQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737161", "bodyText": "Should we use fat jd like api here?", "author": "modmuss50", "createdAt": "2020-04-18T19:01:13Z", "path": "build.gradle", "diffHunk": "@@ -131,6 +131,37 @@ task sourcesJar(type: Jar, dependsOn: classes) {\n \tfrom sourceSets.main.allSource\n }\n \n+javadoc {\n+\toptions {\n+\t\tif (file(\"README.html\").exists()) {\n+\t\t\toverview = \"README.html\"\n+\t\t}\n+\t\tsource = \"8\"\n+\t\tencoding = 'UTF-8'\n+\t\tcharSet = 'UTF-8'\n+\t\tmemberLevel = JavadocMemberLevel.PACKAGE\n+\t\tlinks(\n+\t\t\t\t'https://asm.ow2.io/javadoc/',\n+\t\t\t\t'https://docs.oracle.com/javase/8/docs/api/',\n+\t\t\t\t'https://logging.apache.org/log4j/2.x/log4j-api/apidocs/'\n+\t\t)\n+\t\t// Disable the crazy super-strict doclint tool in Java 8\n+\t\taddStringOption('Xdoclint:none', '-quiet')\n+\t}\n+\tsource sourceSets.main.allJava.srcDirs\n+\tclasspath = sourceSets.main.compileClasspath + sourceSets.main.output // compile impl stuff for dep as well\n+\tinclude(\"**/api/**\")\n+\t// workaround as one of the api stuff use that package\n+\tfailOnError false\n+}\n+\n+task javadocJar(type: Jar) {\n+\tdependsOn javadoc\n+\tfrom javadoc.destinationDir\n+\tclassifier = 'javadoc'", "originalCommit": "232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzI2Mg==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737262", "bodyText": "Fat jd for api is because api has individual modules (in those cases, individual modules' docs are preferred). Fabric Loader is single-module, and this javadoc is not across module, so no need for \"fat\".", "author": "liach", "createdAt": "2020-04-18T19:02:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzE2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzIzMw==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737233", "bodyText": "This might not be the right place for this, as it can be diffrent for diffrent langs", "author": "modmuss50", "createdAt": "2020-04-18T19:01:45Z", "path": "src/main/java/net/fabricmc/api/ClientModInitializer.java", "diffHunk": "@@ -16,7 +16,29 @@\n \n package net.fabricmc.api;\n \n+/**\n+ * A mod initializer ran only on {@link EnvType#CLIENT}.\n+ *\n+ * <p>This entrypoint is suitable for setting up client-specific logic, such as rendering\n+ * or integrated server tweaks.</p>\n+ *\n+ * <p>In {@code fabric.mod.json}, the entrypoint is defined as:\n+ * <pre><blockquote>\n+ *     \"entrypoints\": {\n+ *         \"client\": [\n+ *             &lt;a list of string referring to your client mod initializers&gt;", "originalCommit": "232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzU5NQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737595", "bodyText": "should make it entrypoint list notation instead, I guess?", "author": "liach", "createdAt": "2020-04-18T19:04:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzIzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczOTU3Mw==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410739573", "bodyText": "People can just look at the docs on getEntrypointContainers, I think.", "author": "liach", "createdAt": "2020-04-18T19:20:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzIzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzMzMA==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737330", "bodyText": "this doesnt seem great, no idea why they need the launcher meta json here.", "author": "modmuss50", "createdAt": "2020-04-18T19:02:41Z", "path": "src/main/java/net/fabricmc/api/EnvType.java", "diffHunk": "@@ -16,7 +16,35 @@\n \n package net.fabricmc.api;\n \n+/**\n+ * Represents a type of environment.\n+ *\n+ * <p>A type of environment is a jar file in a <i>Minecraft</i> version's json file's {@code download}\n+ * subsection, including the {@code client.jar} and the {@code server.jar}.</p>\n+ *\n+ * @see Environment\n+ * @see EnvironmentInterface\n+ * @see <a href=\"https://launchermeta.mojang.com/mc/game/version_manifest.json\">A list of <i>Minecraft</i>\n+ * version's json files</a>\n+ */", "originalCommit": "232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzUxMw==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737513", "bodyText": "Just a reference for people for json so they can actually see the client/server sections in downloads section.", "author": "liach", "createdAt": "2020-04-18T19:03:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzMzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDc0MzQxOQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410743419", "bodyText": "Removed the launchermeta link.", "author": "liach", "createdAt": "2020-04-18T19:56:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzMzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzg0Ng==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737846", "bodyText": "This isnt quite right I dont think, as its based on the implimentation", "author": "modmuss50", "createdAt": "2020-04-18T19:06:13Z", "path": "src/main/java/net/fabricmc/loader/api/LanguageAdapter.java", "diffHunk": "@@ -16,6 +16,87 @@\n \n package net.fabricmc.loader.api;\n \n+/**\n+ * Creates instances of objects from custom notations.\n+ *\n+ * <p>It enables obtaining of other JVM languages' objects with custom instantiation logic.</p>\n+ *\n+ * <p>A language adapter is defined as so in {@code fabric.mod.json}:\n+ * <pre><blockquote>\n+ *   \"languageAdapter\": {\n+ *     \"&lt;a key&gt;\": \"&lt;the binary name of the language adapter class&gt;\"\n+ *   }\n+ * </blockquote></pre>\n+ * Multiple keys can be present in the {@code languageAdapter} section.</p>\n+ *\n+ * <p>In the declaration, the language adapter is referred by its <a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-13.html#jls-13.1\">binary name</a>,\n+ * such as {@code \"mypackage.MyClass$Inner\"}. It must have a no-argument public constructor for the Loader to instantiate.</p>", "originalCommit": "232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzk4MQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737981", "bodyText": "\ud83e\udd14 well, this is the technical name of the \"dot format\"", "author": "liach", "createdAt": "2020-04-18T19:07:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzg0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODA0Ng==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410738046", "bodyText": "no, the 2nd bit about the constructor", "author": "modmuss50", "createdAt": "2020-04-18T19:07:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzg0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODU5OA==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410738598", "bodyText": "Hmm, no? \n  \n    \n      fabric-loader/src/main/java/net/fabricmc/loader/FabricLoader.java\n    \n    \n         Line 347\n      in\n      9f6b859\n    \n    \n    \n    \n\n        \n          \n           adapterMap.put(laEntry.getKey(), (LanguageAdapter) Class.forName(laEntry.getValue(), true, FabricLauncherBase.getLauncher().getTargetClassLoader()).getDeclaredConstructor().newInstance()); \n        \n    \n  \n\n\nHere loader is explicitly requiring calling the constructor", "author": "liach", "createdAt": "2020-04-18T19:12:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzg0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczNzkyNA==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410737924", "bodyText": "I dont get everyone obession with using enums for singletons, lets not use it as an example.", "author": "modmuss50", "createdAt": "2020-04-18T19:06:52Z", "path": "src/main/java/net/fabricmc/loader/api/LanguageAdapter.java", "diffHunk": "@@ -16,6 +16,87 @@\n \n package net.fabricmc.loader.api;\n \n+/**\n+ * Creates instances of objects from custom notations.\n+ *\n+ * <p>It enables obtaining of other JVM languages' objects with custom instantiation logic.</p>\n+ *\n+ * <p>A language adapter is defined as so in {@code fabric.mod.json}:\n+ * <pre><blockquote>\n+ *   \"languageAdapter\": {\n+ *     \"&lt;a key&gt;\": \"&lt;the binary name of the language adapter class&gt;\"\n+ *   }\n+ * </blockquote></pre>\n+ * Multiple keys can be present in the {@code languageAdapter} section.</p>\n+ *\n+ * <p>In the declaration, the language adapter is referred by its <a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-13.html#jls-13.1\">binary name</a>,\n+ * such as {@code \"mypackage.MyClass$Inner\"}. It must have a no-argument public constructor for the Loader to instantiate.</p>\n+ *\n+ * <p>The {@code default} language adapter from Fabric Loader can accepet {@code value} as follows:\n+ * <ul>\n+ *   <li>A fully qualified reference to a class, in <a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-13.html#jls-13.1\">\n+ *   binary name</a>, such as {@code package.MyClass$Inner}, where the class has a public no-argument constructor\n+ *   and {@code type} is assignable from the class.\n+ *\n+ *   <p>An example of an entrypoint class\n+ *   <pre><blockquote>\n+ *     package net.fabricmc.example;\n+ *     import net.fabricmc.api.ModInitializer;\n+ *     public class ExampleMod implements ModInitializer {\n+ *       {@literal @}Override\n+ *       public void onInitialize() {}\n+ *     }\n+ *   </blockquote></pre>\n+ *   You would declare {@code \"net.fabricmc.example.ExampleMod\"}.</p>\n+ *\n+ *   <p>For each entrypoint reference, a new instance of the class is created.\n+ * \t If this class implements two separate entrypoints, there will be two distinct\n+ * \t instances of this class in two entrypoint containers.</p>\n+ * \t </li>\n+ *\n+ *   <li>A fully qualified reference to a class in binary name followed by {@code ::} and a\n+ *   field name. The field must be static, and {@code type} must be assignable from\n+ *   the field's class.\n+ *\n+ *   <p>An example of an entrypoint field\n+ *   <pre><blockquote>\n+ *     package net.fabricmc.example;\n+ *     import net.fabricmc.api.ModInitializer;\n+ *     public enum ExampleMod implements ModInitializer {\n+ *       INSTANCE;", "originalCommit": "232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODE5Nw==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410738197", "bodyText": "are you sure? I have a feeling its /", "author": "modmuss50", "createdAt": "2020-04-18T19:08:35Z", "path": "src/main/java/net/fabricmc/loader/api/MappingResolver.java", "diffHunk": "@@ -21,63 +21,67 @@\n /**\n  * Helper class for performing mapping resolution.\n  *\n- * Note: The target namespace (the one being mapped to) for mapping (or the\n+ * <p><strong>Note</strong>: The target namespace (the one being mapped to) for mapping (or the\n  * source one for unmapping) is always implied to be the one Loader is\n- * currently operating in.\n+ * currently operating in.</p>\n+ *\n+ * <p>All the {@code className} used in this resolver are in <a href=\"https://docs.oracle.com/javase/specs/jls/se8/html/jls-13.html#jls-13.1\">binary names</a>,\n+ * such as {@code \"mypackage.MyClass$Inner\"}.</p>", "originalCommit": "232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODczOQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410738739", "bodyText": "I think it is / as always used in mappings, but the old doc says it is dot format (see changeset below)", "author": "liach", "createdAt": "2020-04-18T19:13:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODE5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDc0MDM1Nw==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410740357", "bodyText": "fabric-loader/src/main/java/net/fabricmc/loader/FabricMappingResolver.java\n    \n    \n        Lines 106 to 108\n      in\n      9f6b859\n    \n    \n    \n    \n\n        \n          \n           if (className.indexOf('/') >= 0) { \n        \n\n        \n          \n           \tthrow new IllegalArgumentException(\"Class names must be provided in dot format: \" + className); \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nWell it does take binary/dot format, rip (java's own Class.forName uses binary/dot format)", "author": "liach", "createdAt": "2020-04-18T19:27:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODE5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODQxNw==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410738417", "bodyText": "I think this fails to load with theses. Not sure if theses really need to say what loader does?", "author": "modmuss50", "createdAt": "2020-04-18T19:11:03Z", "path": "src/main/java/net/fabricmc/loader/api/metadata/ModMetadata.java", "diffHunk": "@@ -16,52 +16,129 @@\n \n package net.fabricmc.loader.api.metadata;\n \n-import com.google.gson.JsonElement;\n-import net.fabricmc.loader.api.Version;\n-\n import java.util.Collection;\n import java.util.Optional;\n \n+import com.google.gson.JsonElement;\n+\n+import net.fabricmc.loader.api.Version;\n+\n+/**\n+ * The metadata of a mod.\n+ */\n public interface ModMetadata {\n+\t/**\n+\t * Returns the type of the mod.\n+\t *\n+\t * <p>The types may be {@code fabric} or {@code builtin} by default.</p>\n+\t *\n+\t * @return the type of the mod\n+\t */\n \tString getType();\n \n \t// When adding getters, follow the order as presented on the wiki.\n \t// No defaults.\n \n+\t/**\n+\t * Returns the mod's ID.\n+\t *\n+\t * <p>A mod's id must have only lowercase letters, digits, {@code -}, or {@code _}.</p>\n+\t *\n+\t * @return the mod's ID.\n+\t */\n \tString getId();\n+\n+\t/**\n+\t * Returns the mod's version.\n+\t */\n \tVersion getVersion();\n \n+\t/**\n+\t * Returns the mod's required dependencies, without which the Loader will terminate loading.\n+\t */\n \tCollection<ModDependency> getDepends();\n+\n+\t/**\n+\t * Returns the mod's recommended dependencies, without which the Loader will emit a warning.\n+\t */\n \tCollection<ModDependency> getRecommends();\n+\n+\t/**\n+\t * Returns the mod's suggested dependencies.\n+\t */\n \tCollection<ModDependency> getSuggests();\n+\n+\t/**\n+\t * Returns the mod's conflicts, with which the Loader will terminate loading.\n+\t */\n \tCollection<ModDependency> getConflicts();\n+\n+\t/**\n+\t * Returns the mod's conflicts, with which the Loader will emit a warning.", "originalCommit": "232c70b731d472ed59f759b4c6ff4d37f3c9fc41", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODg5Ng==", "url": "https://github.com/FabricMC/fabric-loader/pull/222#discussion_r410738896", "bodyText": "https://fabricmc.net/wiki/documentation:fabric_mod_json?s[]=conflicts\nProbably should say what loader does here.", "author": "liach", "createdAt": "2020-04-18T19:14:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDczODQxNw=="}], "type": "inlineReview"}, {"oid": "7120b64cf7312529771d32b66da15dcc8eb772bd", "url": "https://github.com/FabricMC/fabric-loader/commit/7120b64cf7312529771d32b66da15dcc8eb772bd", "message": "Javadoc fixes as suggested by modmuss\n\nSigned-off-by: liach <liach@users.noreply.github.com>", "committedDate": "2020-04-18T19:29:11Z", "type": "commit"}]}