{"pr_number": 299, "pr_title": "Add FabricLoader#getLaunchArguments(sanitize)", "pr_createdAt": "2020-08-22T17:26:21Z", "pr_url": "https://github.com/FabricMC/fabric-loader/pull/299", "timeline": [{"oid": "beeef6b41366424a7ab8a17f97a7d111671260a0", "url": "https://github.com/FabricMC/fabric-loader/commit/beeef6b41366424a7ab8a17f97a7d111671260a0", "message": "Add FabricLoader#getLaunchArguments(sanitize)", "committedDate": "2020-08-22T17:24:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTExMjg2NA==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r475112864", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Get the launch arguments\n          \n          \n            \n            \t * Gets the command line arguments used to launch the game.", "author": "shartte", "createdAt": "2020-08-22T17:35:27Z", "path": "src/main/java/net/fabricmc/loader/api/FabricLoader.java", "diffHunk": "@@ -183,4 +183,11 @@ static FabricLoader getInstance() {\n \n \t@Deprecated\n \tFile getConfigDirectory();\n+\n+\t/**\n+\t * Get the launch arguments", "originalCommit": "beeef6b41366424a7ab8a17f97a7d111671260a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTExMjk0NQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r475112945", "bodyText": "Thanks!", "author": "TheBrokenRail", "createdAt": "2020-08-22T17:36:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTExMjg2NA=="}], "type": "inlineReview"}, {"oid": "7d92392258650b35a0e72f4ab5b2de51bded3f9f", "url": "https://github.com/FabricMC/fabric-loader/commit/7d92392258650b35a0e72f4ab5b2de51bded3f9f", "message": "Imporve JavaDoc\n\nCo-authored-by: shartte <shartte@users.noreply.github.com>", "committedDate": "2020-08-22T17:36:12Z", "type": "commit"}, {"oid": "1d6aa9f62b4f377ba46b93c727a1b5753072856f", "url": "https://github.com/FabricMC/fabric-loader/commit/1d6aa9f62b4f377ba46b93c727a1b5753072856f", "message": "Add Overload", "committedDate": "2020-08-22T19:52:22Z", "type": "commit"}, {"oid": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "url": "https://github.com/FabricMC/fabric-loader/commit/b5afa6d6831635dd421bada68266423ce3fb6ef8", "message": "Improve JavaDoc", "committedDate": "2020-08-22T20:05:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1NTAwNg==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490455006", "bodyText": "I'd probably mention that this does not return any sensitive information.", "author": "i509VCB", "createdAt": "2020-09-17T18:02:44Z", "path": "src/main/java/net/fabricmc/loader/api/FabricLoader.java", "diffHunk": "@@ -183,4 +183,18 @@ static FabricLoader getInstance() {\n \n \t@Deprecated\n \tFile getConfigDirectory();\n+\n+\t/**\n+\t * Gets the command line arguments used to launch the game. If this is printed for debugging, make sure {@code sanitize} is {@code true}.\n+\t * @param sanitize Whether to remove sensitive information\n+\t * @return the launch arguments\n+\t */\n+\tString[] getLaunchArguments(boolean sanitize);\n+\n+\t/**\n+\t * @see FabricLoader#getLaunchArguments(boolean)\n+\t */\n+\tdefault String[] getLaunchArguments() {", "originalCommit": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI2OTMyMQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r492269321", "bodyText": "Done!", "author": "TheBrokenRail", "createdAt": "2020-09-21T18:40:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1NTAwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1NzQ1MQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490457451", "bodyText": "Hmm, I'd like to ask is the accessToken the only compromising info we want to sanitize?\nMultimc for example actually omits your username, uuid and user type in logs alongside your accessToken like this:\n--username  --version MultiMC5 --gameDir /home/i509vcb/.local/share/multimc/instances/1.16.2 - FABRIC/.minecraft --assetsDir /home/i509vcb/.local/share/multimc/assets --assetIndex 1.16 --uuid --accessToken  --userType  --versionType release", "author": "i509VCB", "createdAt": "2020-09-17T18:06:54Z", "path": "src/main/java/net/fabricmc/loader/game/MinecraftGameProvider.java", "diffHunk": "@@ -158,6 +159,31 @@ public void acceptArguments(String... argStrs) {\n \t\tFabricLauncherBase.processArgumentMap(arguments, envType);\n \t}\n \n+\t@Override\n+\tpublic String[] getLaunchArguments(boolean sanitize) {\n+\t\tif (arguments != null) {\n+\t\t\tList<String> list = new ArrayList<>(Arrays.asList(arguments.toArray()));\n+\t\t\tif (sanitize) {\n+\t\t\t\tint remove = 0;\n+\t\t\t\tIterator<String> iterator = list.iterator();\n+\t\t\t\twhile (iterator.hasNext()) {\n+\t\t\t\t\tString next = iterator.next();\n+\t\t\t\t\tif (\"--accessToken\".equals(next)) {", "originalCommit": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI2NzEwNA==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r492267104", "bodyText": "I wouldn't consider the username or UUID sensitive information personally. The UUID is given out to anyone you are on a server with, as well as stored in plain text on your hard drive, and the username is already logged on startup and can be changed. What does user type do?", "author": "TheBrokenRail", "createdAt": "2020-09-21T18:35:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1NzQ1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI0ODAxMQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r494248011", "bodyText": "MC logs/dumps the other information quite happily, I think of this sanitizing as a security feature, not a privacy one.", "author": "sfPlayer1", "createdAt": "2020-09-24T11:44:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1NzQ1MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1OTc0Mw==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490459743", "bodyText": "Obviously anyone could call this with false as the parameter and run into the sunset with your access token.\nDo we want to print a stacktrace when someone calls this so we can see who wanted to access the unsanitized arguments?", "author": "i509VCB", "createdAt": "2020-09-17T18:11:12Z", "path": "src/main/java/net/fabricmc/loader/api/FabricLoader.java", "diffHunk": "@@ -183,4 +183,18 @@ static FabricLoader getInstance() {\n \n \t@Deprecated\n \tFile getConfigDirectory();\n+\n+\t/**\n+\t * Gets the command line arguments used to launch the game. If this is printed for debugging, make sure {@code sanitize} is {@code true}.\n+\t * @param sanitize Whether to remove sensitive information\n+\t * @return the launch arguments\n+\t */\n+\tString[] getLaunchArguments(boolean sanitize);", "originalCommit": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ4NTk4Ng==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490485986", "bodyText": "is that really needed? I think it's just log spam.\nBesides, it wouldn't be difficult for malicious mods to bypass this entire thing anyway.", "author": "UpcraftLP", "createdAt": "2020-09-17T18:58:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1OTc0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDUwMDQwNA==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490500404", "bodyText": "Well I do see your point there, it's probably a bit spammy tbf", "author": "i509VCB", "createdAt": "2020-09-17T19:23:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1OTc0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI0NDQyOQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r494244429", "bodyText": "The arg is really just to remind people of the dangers involved, aiming at accidental leaks. We can't fundamentally avoid illegitimate disclosure, whether this exists or not, so it should be fine without extra logic that'd at most provide a false sense of security.", "author": "sfPlayer1", "createdAt": "2020-09-24T11:40:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ1OTc0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MDkzOA==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490460938", "bodyText": "Empty line before opening this if statement. Ideally we want to keep this close to fabric api codestyle but we have a lot to do in loader before we pull over checkstyle.", "author": "i509VCB", "createdAt": "2020-09-17T18:13:18Z", "path": "src/main/java/net/fabricmc/loader/game/MinecraftGameProvider.java", "diffHunk": "@@ -158,6 +159,31 @@ public void acceptArguments(String... argStrs) {\n \t\tFabricLauncherBase.processArgumentMap(arguments, envType);\n \t}\n \n+\t@Override\n+\tpublic String[] getLaunchArguments(boolean sanitize) {\n+\t\tif (arguments != null) {\n+\t\t\tList<String> list = new ArrayList<>(Arrays.asList(arguments.toArray()));\n+\t\t\tif (sanitize) {", "originalCommit": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI2OTQ1MQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r492269451", "bodyText": "Done!", "author": "TheBrokenRail", "createdAt": "2020-09-21T18:40:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MDkzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MTAyNg==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490461026", "bodyText": "Empty line before while here", "author": "i509VCB", "createdAt": "2020-09-17T18:13:30Z", "path": "src/main/java/net/fabricmc/loader/game/MinecraftGameProvider.java", "diffHunk": "@@ -158,6 +159,31 @@ public void acceptArguments(String... argStrs) {\n \t\tFabricLauncherBase.processArgumentMap(arguments, envType);\n \t}\n \n+\t@Override\n+\tpublic String[] getLaunchArguments(boolean sanitize) {\n+\t\tif (arguments != null) {\n+\t\t\tList<String> list = new ArrayList<>(Arrays.asList(arguments.toArray()));\n+\t\t\tif (sanitize) {\n+\t\t\t\tint remove = 0;\n+\t\t\t\tIterator<String> iterator = list.iterator();\n+\t\t\t\twhile (iterator.hasNext()) {", "originalCommit": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI2OTUyNA==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r492269524", "bodyText": "Done!", "author": "TheBrokenRail", "createdAt": "2020-09-21T18:40:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MTAyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MTA5OA==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490461098", "bodyText": "Empty line before if", "author": "i509VCB", "createdAt": "2020-09-17T18:13:39Z", "path": "src/main/java/net/fabricmc/loader/game/MinecraftGameProvider.java", "diffHunk": "@@ -158,6 +159,31 @@ public void acceptArguments(String... argStrs) {\n \t\tFabricLauncherBase.processArgumentMap(arguments, envType);\n \t}\n \n+\t@Override\n+\tpublic String[] getLaunchArguments(boolean sanitize) {\n+\t\tif (arguments != null) {\n+\t\t\tList<String> list = new ArrayList<>(Arrays.asList(arguments.toArray()));\n+\t\t\tif (sanitize) {\n+\t\t\t\tint remove = 0;\n+\t\t\t\tIterator<String> iterator = list.iterator();\n+\t\t\t\twhile (iterator.hasNext()) {\n+\t\t\t\t\tString next = iterator.next();\n+\t\t\t\t\tif (\"--accessToken\".equals(next)) {", "originalCommit": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI2OTg3MQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r492269871", "bodyText": "Done!", "author": "TheBrokenRail", "createdAt": "2020-09-21T18:41:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MTA5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MTI2NA==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490461264", "bodyText": "empty line before return", "author": "i509VCB", "createdAt": "2020-09-17T18:13:59Z", "path": "src/main/java/net/fabricmc/loader/game/MinecraftGameProvider.java", "diffHunk": "@@ -158,6 +159,31 @@ public void acceptArguments(String... argStrs) {\n \t\tFabricLauncherBase.processArgumentMap(arguments, envType);\n \t}\n \n+\t@Override\n+\tpublic String[] getLaunchArguments(boolean sanitize) {\n+\t\tif (arguments != null) {\n+\t\t\tList<String> list = new ArrayList<>(Arrays.asList(arguments.toArray()));\n+\t\t\tif (sanitize) {\n+\t\t\t\tint remove = 0;\n+\t\t\t\tIterator<String> iterator = list.iterator();\n+\t\t\t\twhile (iterator.hasNext()) {\n+\t\t\t\t\tString next = iterator.next();\n+\t\t\t\t\tif (\"--accessToken\".equals(next)) {\n+\t\t\t\t\t\tremove = 2;\n+\t\t\t\t\t}\n+\n+\t\t\t\t\tif (remove > 0) {\n+\t\t\t\t\t\titerator.remove();\n+\t\t\t\t\t\tremove--;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\treturn list.toArray(new String[0]);", "originalCommit": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI3MDMyOA==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r492270328", "bodyText": "Done!", "author": "TheBrokenRail", "createdAt": "2020-09-21T18:41:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MTI2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MTUxMQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r490461511", "bodyText": "you can drop the else here and just return the empty string array at the bottom of the method.", "author": "i509VCB", "createdAt": "2020-09-17T18:14:23Z", "path": "src/main/java/net/fabricmc/loader/game/MinecraftGameProvider.java", "diffHunk": "@@ -158,6 +159,31 @@ public void acceptArguments(String... argStrs) {\n \t\tFabricLauncherBase.processArgumentMap(arguments, envType);\n \t}\n \n+\t@Override\n+\tpublic String[] getLaunchArguments(boolean sanitize) {\n+\t\tif (arguments != null) {\n+\t\t\tList<String> list = new ArrayList<>(Arrays.asList(arguments.toArray()));\n+\t\t\tif (sanitize) {\n+\t\t\t\tint remove = 0;\n+\t\t\t\tIterator<String> iterator = list.iterator();\n+\t\t\t\twhile (iterator.hasNext()) {\n+\t\t\t\t\tString next = iterator.next();\n+\t\t\t\t\tif (\"--accessToken\".equals(next)) {\n+\t\t\t\t\t\tremove = 2;\n+\t\t\t\t\t}\n+\n+\t\t\t\t\tif (remove > 0) {\n+\t\t\t\t\t\titerator.remove();\n+\t\t\t\t\t\tremove--;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\treturn list.toArray(new String[0]);\n+\t\t} else {", "originalCommit": "b5afa6d6831635dd421bada68266423ce3fb6ef8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjI2OTk4MQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r492269981", "bodyText": "Done!", "author": "TheBrokenRail", "createdAt": "2020-09-21T18:41:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ2MTUxMQ=="}], "type": "inlineReview"}, {"oid": "4ef4730523cb864e8109f664c1dc8e551d0f50be", "url": "https://github.com/FabricMC/fabric-loader/commit/4ef4730523cb864e8109f664c1dc8e551d0f50be", "message": "Fix Up JavaDoc And Code Style", "committedDate": "2020-09-21T18:39:54Z", "type": "commit"}, {"oid": "021d9dcfe6dfc1eeb0058a7d1e5838e244085adb", "url": "https://github.com/FabricMC/fabric-loader/commit/021d9dcfe6dfc1eeb0058a7d1e5838e244085adb", "message": "Fix While", "committedDate": "2020-09-21T18:41:01Z", "type": "commit"}, {"oid": "103ecd28f1687801d653fbb80ca083a78aeab7bd", "url": "https://github.com/FabricMC/fabric-loader/commit/103ecd28f1687801d653fbb80ca083a78aeab7bd", "message": "Add Empty Line Before Return", "committedDate": "2020-09-21T18:41:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI0NTczMQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r494245731", "bodyText": "I'd remove this override, this is a niche API where allowing the caller to omit an arg doesn't provide any significant convenience benefit. It does however clutter the already large FabricLoader interface quite a bit more.", "author": "sfPlayer1", "createdAt": "2020-09-24T11:42:41Z", "path": "src/main/java/net/fabricmc/loader/api/FabricLoader.java", "diffHunk": "@@ -183,4 +183,20 @@ static FabricLoader getInstance() {\n \n \t@Deprecated\n \tFile getConfigDirectory();\n+\n+\t/**\n+\t * Gets the command line arguments used to launch the game. If this is printed for debugging, make sure {@code sanitize} is {@code true}.\n+\t * @param sanitize Whether to remove sensitive information\n+\t * @return the launch arguments\n+\t */\n+\tString[] getLaunchArguments(boolean sanitize);\n+\n+\t/**\n+\t * @see FabricLoader#getLaunchArguments(boolean)\n+\t * <p>\n+\t * Does not contain any sensitive information.\n+\t */\n+\tdefault String[] getLaunchArguments() {", "originalCommit": "103ecd28f1687801d653fbb80ca083a78aeab7bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMwMjQ4Nw==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r494302487", "bodyText": "This was suggested here: #299 (comment)", "author": "TheBrokenRail", "createdAt": "2020-09-24T13:09:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI0NTczMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMwMzE4MQ==", "url": "https://github.com/FabricMC/fabric-loader/pull/299#discussion_r494303181", "bodyText": "I know, not happy with the suggestion.", "author": "sfPlayer1", "createdAt": "2020-09-24T13:10:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDI0NTczMQ=="}], "type": "inlineReview"}, {"oid": "f3e5e1422e719bb525eba2f7012656615fb1cd5f", "url": "https://github.com/FabricMC/fabric-loader/commit/f3e5e1422e719bb525eba2f7012656615fb1cd5f", "message": "Remove Unnecessary Overload", "committedDate": "2020-09-24T13:23:15Z", "type": "commit"}]}