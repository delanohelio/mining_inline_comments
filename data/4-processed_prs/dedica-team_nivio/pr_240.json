{"pr_number": 240, "pr_title": "Readme for docker, dependency update, JDK13 support", "pr_createdAt": "2020-08-30T17:21:52Z", "pr_url": "https://github.com/dedica-team/nivio/pull/240", "timeline": [{"oid": "fe7cd1bdf6312dd79bd1ad6080f96645a255de87", "url": "https://github.com/dedica-team/nivio/commit/fe7cd1bdf6312dd79bd1ad6080f96645a255de87", "message": "Adapted dependencies in pom.xml (newer versions of cqengine, kubernetes-client and kubernetes-server-mock) to reduce warnings in build.\nResolved error for Java 13 due to generic type resolution by a library used by cqengine that caused the build to fail due to failing tests.\nStarted adapting readme.md for windows docker support.", "committedDate": "2020-08-30T17:01:31Z", "type": "commit"}, {"oid": "6657f769513286d2e5acca5de2c6a81a3253b89a", "url": "https://github.com/dedica-team/nivio/commit/6657f769513286d2e5acca5de2c6a81a3253b89a", "message": "testing pipeline support for JDK 11 and 13", "committedDate": "2020-08-30T17:29:43Z", "type": "commit"}, {"oid": "0afab19eb163e2ac7127d96cad2298cd8fead607", "url": "https://github.com/dedica-team/nivio/commit/0afab19eb163e2ac7127d96cad2298cd8fead607", "message": "testing pipeline support for JDK 11 and 13", "committedDate": "2020-08-30T17:32:58Z", "type": "commit"}, {"oid": "ba6db89064d0a3a84a640cf3ed9d297507471a38", "url": "https://github.com/dedica-team/nivio/commit/ba6db89064d0a3a84a640cf3ed9d297507471a38", "message": "updated readme with a double slash for the SEED path and commented on it", "committedDate": "2020-08-30T18:04:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTc5OTI0Mw==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r479799243", "bodyText": "Without the double slashes, on a GitBash console, this caused nivio to believe the SEED is e.g. C:/Users/User/AppData/Local/Temp/nivio/inout.yml.", "author": "mfbieber", "createdAt": "2020-08-30T18:09:33Z", "path": "readme.md", "diffHunk": "@@ -58,10 +58,13 @@ Clone nivio, build and run a Docker image:\n       git clone https://github.com/dedica-team/nivio.git && cd nivio\n       mvn clean package\n       docker build -t nivio:latest .\n-      docker run -e SEED=/tmp/nivio/inout.yml --mount type=bind,source=\"C:\\<your>\\<path>\\<to>\\nivio\\src\\test\\resources\\example\",target=/tmp/nivio -p 8080:8080 nivio:latest\n+      docker run -e SEED=//tmp/nivio/inout.yml --mount type=bind,source=\"C:\\<your>\\<path>\\<to>\\nivio\\src\\test\\resources\\example\",target=/tmp/nivio -p 8080:8080 nivio:latest\n       \n    then open http://localhost:8080\n    \n+   (Note: the double slashes at the beginning of the path for the SEED environment variable work as a fix to make MSYS/MinGW consoles\n+   *not* translate the `/tmp` path to a local DOS path. This is safe to use with the PowerShell. Further reading: https://stackoverflow.com/a/14189687/10000398)\n+   ", "originalCommit": "ba6db89064d0a3a84a640cf3ed9d297507471a38", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE5ODQxOQ==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r480198419", "bodyText": "\ud83d\udc4d", "author": "bonndan", "createdAt": "2020-08-31T15:14:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTc5OTI0Mw=="}], "type": "inlineReview"}, {"oid": "9003d7f7ac5392918ccd3b3d0bf73d5482ae3834", "url": "https://github.com/dedica-team/nivio/commit/9003d7f7ac5392918ccd3b3d0bf73d5482ae3834", "message": "Merge branch 'develop' into issue-138-and-java-13-support\n\n# Conflicts:\n#\tsrc/main/java/de/bonndan/nivio/model/LandscapeItems.java", "committedDate": "2020-09-05T18:54:42Z", "type": "commit"}, {"oid": "87f25af5ad191eb84cccba10e90d6b0abf5282d7", "url": "https://github.com/dedica-team/nivio/commit/87f25af5ad191eb84cccba10e90d6b0abf5282d7", "message": "updating manual in frontend and docker-compose.yml files", "committedDate": "2020-09-05T19:16:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk3OTY5Mg==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r483979692", "bodyText": "By this, we could use this docker-compose.yml for both the demo and the seed config as described in the manual. @bonndan: were these docker-compose.yml files even intended for this purpose?", "author": "mfbieber", "createdAt": "2020-09-05T19:18:13Z", "path": "src/test/docker-compose.yml", "diffHunk": "@@ -9,9 +9,10 @@ services:\n       - 9229:9229\n \n   nivio:\n-    image: bonndan/nivio:latest\n+    image: dedica/nivio:latest\n     environment:\n-      DEMO: 1\n+      DEMO: ${DEMO}\n+      SEED: ${SEED}", "originalCommit": "87f25af5ad191eb84cccba10e90d6b0abf5282d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk4MDE0OA==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r483980148", "bodyText": "No, you have found an ancient relict. However, it could work that way. Using both seed and demo is now supported.", "author": "bonndan", "createdAt": "2020-09-05T19:24:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk3OTY5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk4MDQ1Mw==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r483980453", "bodyText": "Okay, so we could leave it like that?\nAnd on line 6 we are referencing to the image  bonndan/dld4e-headless:latest in this docker-compose.yml. This is your private Docker Hub user, right? Do you intend on keeping that image there?", "author": "mfbieber", "createdAt": "2020-09-05T19:28:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk3OTY5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDAyODc5MQ==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r484028791", "bodyText": "OMG I was not aware the documentation is so outdated. Sorry for the confusion. I have pushed some cleanups.", "author": "bonndan", "createdAt": "2020-09-06T06:31:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk3OTY5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk4MDMxMA==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r483980310", "bodyText": "Were those docker-compose.yml files intended for these purposes?", "author": "mfbieber", "createdAt": "2020-09-05T19:26:21Z", "path": "docs/source/install.rst", "diffHunk": "@@ -26,16 +26,15 @@ Set SERVER_CONTEXT_PATH and NIVIO_BASEURL env vars to the path if nivio won't be\n Demo mode\n ---------\n \n-In the demo mode Nivio loads sample data for demonstration purposes. Run\n+In the demo mode Nivio loads sample data for demonstration purposes. From the `nivio/src/test` directory, run\n \n .. code-block:: bash\n \n     DEMO=1 docker-compose up\n \n then point your browser to http://localhost:8080/render/nivio:example/graph.png\n \n-There is also a demo project \"nivio-demo\" in the repository, which starts an nginx to simulate a remote server.\n-\n+There is also a demo project \"nivio-demo\" in the repository under `nivio/nivio-demo`, which starts an nginx to simulate a remote server.", "originalCommit": "87f25af5ad191eb84cccba10e90d6b0abf5282d7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDAyODg5OQ==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r484028899", "bodyText": "I've deleted the docker-compose file under src/test and referenced the one under nivio-demo", "author": "bonndan", "createdAt": "2020-09-06T06:33:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk4MDMxMA=="}], "type": "inlineReview"}, {"oid": "bcf2d7887963d47b9f477c97552291d32ef9b6d0", "url": "https://github.com/dedica-team/nivio/commit/bcf2d7887963d47b9f477c97552291d32ef9b6d0", "message": "java 13 support on ItemIndex", "committedDate": "2020-09-05T19:34:51Z", "type": "commit"}, {"oid": "32f3d08eea3fb024d2f3280dd4d2284e511c5523", "url": "https://github.com/dedica-team/nivio/commit/32f3d08eea3fb024d2f3280dd4d2284e511c5523", "message": "[#138] updated docs", "committedDate": "2020-09-06T06:18:24Z", "type": "commit"}, {"oid": "b6777f23c6bbdfe4370c6edccf165ef817ce5d54", "url": "https://github.com/dedica-team/nivio/commit/b6777f23c6bbdfe4370c6edccf165ef817ce5d54", "message": "[#138] updated docs", "committedDate": "2020-09-06T06:29:28Z", "type": "commit"}, {"oid": "eee0a3fafacabca684261864819f609ba3684b7e", "url": "https://github.com/dedica-team/nivio/commit/eee0a3fafacabca684261864819f609ba3684b7e", "message": "provide environment variables in demo docker-compose.yml", "committedDate": "2020-09-06T20:02:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDEwODUyOQ==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r484108529", "bodyText": "To make the examples in the manual work right out of the box, we should declare the environment variables. If they are not provided, they default to an empty string. This should be no problem for our backend, right?", "author": "mfbieber", "createdAt": "2020-09-06T20:04:03Z", "path": "nivio-demo/docker-compose.yml", "diffHunk": "@@ -11,7 +11,9 @@ services:\n \n   nivio:\n     image: dedica/nivio:latest\n-    #environment:\n+    environment:\n+      SEED: ${SEED}\n+      DEMO: ${DEMO}\n       # enable DEMO to have a preloaded landscape\n       # DEMO: 1\n       # SEED also loads data, but uses the sources from the webserver", "originalCommit": "eee0a3fafacabca684261864819f609ba3684b7e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDExMTQ5OA==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r484111498", "bodyText": "If neither SEED nor DEMO is given, nivio starts without loading any configuration. Theoretically one could push a config via rest api, but I'm not sure this is still working. Empty strings should be equal to absent vars. So yes, we should give examples.", "author": "bonndan", "createdAt": "2020-09-06T20:37:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDEwODUyOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDEwODcxMQ==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r484108711", "bodyText": "Reading this, I still don't understand 100% how this simulates a remote server. So it simulates a remote server for the seed files? (We should write that out clearly.)\nIs this the reason why my attempts to use that docker-compose.yml with a local file don't really work?", "author": "mfbieber", "createdAt": "2020-09-06T20:06:02Z", "path": "docs/source/install.rst", "diffHunk": "@@ -44,16 +39,7 @@ Nivio expects a seed configuration at start time (unless you want to run the dem\n \n then point your browser to the GUI at http://localhost:8080 or the API at http://localhost:8080/api/.\n \n-Behind a proxy\n---------------\n-\n-If you deploy nivio to run under a different path than root (\"/\"), make sure to set the environment variables\n-SERVER_CONTEXT_PATH and NIVIO_BASEURL to the path.\n-\n-.. code-block:: bash\n-\n-   SERVER_SERVLET_CONTEXT_PATH: /my-landscape\n-   NIVIO_BASEURL: https://foo.com/my-landscape/\n+There is a demo project \"nivio-demo\" in the repository under `nivio/nivio-demo`, which starts an nginx to simulate a remote server.", "originalCommit": "b6777f23c6bbdfe4370c6edccf165ef817ce5d54", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDExMjAzNw==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r484112037", "bodyText": "I've pushed another version of the file. The demo is meant to simulate nivio running in a docker container without mounting files directly into it, and using nginx to serve configs instead.\nIf you have any better ideas, let me know.", "author": "bonndan", "createdAt": "2020-09-06T20:43:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDEwODcxMQ=="}], "type": "inlineReview"}, {"oid": "8ba7a4cb870f816190d9ee96e949fc8e61a0fa50", "url": "https://github.com/dedica-team/nivio/commit/8ba7a4cb870f816190d9ee96e949fc8e61a0fa50", "message": "[#138] updated docs", "committedDate": "2020-09-06T20:41:46Z", "type": "commit"}, {"oid": "4cf644b4a4fb36731822266a8819d308dd4b55ec", "url": "https://github.com/dedica-team/nivio/commit/4cf644b4a4fb36731822266a8819d308dd4b55ec", "message": "Merge remote-tracking branch 'origin/issue-138-and-java-13-support' into issue-138-and-java-13-support", "committedDate": "2020-09-06T20:43:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDExNDE2MA==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r484114160", "bodyText": "Alright, thanks. But now the docker-compose.yml does not have any environment variables set and when I run it, I see no landscapes in the UI. Do we still need to update the docker-compose.yml?", "author": "mfbieber", "createdAt": "2020-09-06T21:09:00Z", "path": "docs/source/install.rst", "diffHunk": "@@ -7,19 +7,30 @@ The Docker image is about 350MB and can be started with:\n \n .. code-block:: bash\n \n-    docker run -e DEMO=1 dedica/nivio\n+    docker run dedica/nivio\n \n Demo mode\n ---------\n \n-In the demo mode Nivio loads sample data for demonstration purposes. From the `./nivio-demo` directory, run\n+.. code-block:: bash\n+\n+    docker run -e DEMO=1 dedica/nivio\n+\n+In the demo mode Nivio loads sample data for demonstration purposes.\n+\n+\n+There is a demo in the directory `./nivio-demo` which starts an nginx to serve all example configs from the project and\n+starts nivio as docker container.\n+\n+From the directory, run", "originalCommit": "4cf644b4a4fb36731822266a8819d308dd4b55ec", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "880d163dfa6ec952bc5fa70ab346f50cda9c4d5b", "url": "https://github.com/dedica-team/nivio/commit/880d163dfa6ec952bc5fa70ab346f50cda9c4d5b", "message": "adapted docker-compose.yml to work with nginx and with volumes, adapted manual to describe this options", "committedDate": "2020-09-13T14:14:22Z", "type": "commit"}, {"oid": "9ea84eb1a0893ae0ab58545fff159c983093bfe1", "url": "https://github.com/dedica-team/nivio/commit/9ea84eb1a0893ae0ab58545fff159c983093bfe1", "message": "Merge branch 'develop' into issue-138-and-java-13-support", "committedDate": "2020-09-13T14:15:36Z", "type": "commit"}, {"oid": "23ebd635ae124d0f354047148a51c9b574c902de", "url": "https://github.com/dedica-team/nivio/commit/23ebd635ae124d0f354047148a51c9b574c902de", "message": "seed is not working with folders", "committedDate": "2020-09-13T14:25:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzUzNjI1Mg==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r487536252", "bodyText": "Providing a folder as a seed results in:\nnivio_1      | 2020-09-13 14:24:23.492 ERROR 1 --- [TaskExecutor-14] de.bonndan.nivio.input.FileFetcher       : Failed to read file /demo\nnivio_1      |\nnivio_1      | java.io.IOException: Is a directory\n...", "author": "mfbieber", "createdAt": "2020-09-13T14:27:31Z", "path": "docs/source/install.rst", "diffHunk": "@@ -58,11 +58,11 @@ bind to the corresponding folder, e.g:\n        ports:\n          - 8080:8080\n \n-Then you can point to a specific file or folder with the *SEED* environment variable:\n+Then you can point to a specific file with the *SEED* environment variable:\n \n .. code-block:: bash\n \n-    SEED=/my/files/here docker-compose up\n+    SEED=/my/files/here/file.yml docker-compose up", "originalCommit": "23ebd635ae124d0f354047148a51c9b574c902de", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzUzNjQ2OA==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r487536468", "bodyText": "All options work on my machine now. The nginx and nivio are in the same docker network (a default one), the nginx server must be called from the inside on port 80, before we had the port on the host (3000).", "author": "mfbieber", "createdAt": "2020-09-13T14:29:21Z", "path": "nivio-demo/docker-compose.yml", "diffHunk": "@@ -12,12 +12,21 @@ services:\n   nivio:\n     image: dedica/nivio:latest\n     environment:\n+      # to provide the environment variables from the command line\n       SEED: ${SEED}\n       DEMO: ${DEMO}\n+\n       # enable DEMO to have a preloaded landscape\n       # DEMO: 1\n+\n       # SEED also loads data, but uses the sources from the webserver\n-      # SEED: http://localhost:3000/example_env.yml\n-    ports: \n-      - 8080:8080\n+      # SEED: http://webserver:80/example_env.yml\n \n+      # SEED to load data from a local file, enable also volumes\n+      # SEED: /demo/dedica.yml\n+    # volumes:\n+      # - type: bind\n+        # source: ../src/test/resources/example\n+        # target: /demo\n+    ports:\n+      - 8080:8080", "originalCommit": "880d163dfa6ec952bc5fa70ab346f50cda9c4d5b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU2MTY5OA==", "url": "https://github.com/dedica-team/nivio/pull/240#discussion_r487561698", "bodyText": "\ud83d\udc4d", "author": "bonndan", "createdAt": "2020-09-13T18:33:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzUzNjQ2OA=="}], "type": "inlineReview"}]}