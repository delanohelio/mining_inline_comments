{"pr_number": 9865, "pr_title": "CMTS-140: MetadataKeys and ValueProviders should preserver order of v\u2026", "pr_createdAt": "2020-12-17T17:16:05Z", "pr_url": "https://github.com/mulesoft/mule/pull/9865", "timeline": [{"oid": "75f827662a0a0ef802a8d006d6990bbb48b6f522", "url": "https://github.com/mulesoft/mule/commit/75f827662a0a0ef802a8d006d6990bbb48b6f522", "message": "CMTS-140: MetadataKeys and ValueProviders should preserver order of values from connector's resolver", "committedDate": "2020-12-17T17:12:29Z", "type": "commit"}, {"oid": "f2ab598ad17fd9425d279ee45169c8a9b5f01ab8", "url": "https://github.com/mulesoft/mule/commit/f2ab598ad17fd9425d279ee45169c8a9b5f01ab8", "message": "Self review", "committedDate": "2020-12-17T17:15:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYzMzA2MQ==", "url": "https://github.com/mulesoft/mule/pull/9865#discussion_r545633061", "bodyText": "I don't think this is correct. Yes, once the LinkedHashSet is created, the order will be preserved, but if the ValueProvider returns a plain HashSet, results will be in a different order every time.\nShouldn't we sort the results from the valueSet too? Just in case the VP does not return an ordered set?\nMaybe this is like this by design and we want to keep the order of the results only if the VP wants them in order. Otherwise, we do not care.", "author": "lucianoRM", "createdAt": "2020-12-18T08:02:32Z", "path": "modules/extensions-support/src/main/java/org/mule/runtime/module/extension/internal/value/ValueProviderMediator.java", "diffHunk": "@@ -156,7 +159,7 @@ public ValueProviderMediator(T containerModel, Supplier<MuleContext> muleContext\n     return valueSet.stream()\n         .map(option -> cloneAndEnrichValue(option, parameters))\n         .map(ValueBuilder::build)\n-        .collect(toSet());\n+        .collect(toCollection(LinkedHashSet::new));", "originalCommit": "f2ab598ad17fd9425d279ee45169c8a9b5f01ab8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc2NTYxMQ==", "url": "https://github.com/mulesoft/mule/pull/9865#discussion_r545765611", "bodyText": "Exactly, that's the case. As an initial support with the current API we would like to preserve the order but that only happens if the resolver/provider has returned a sorted set. If not, it is exactly as it is right now, order is not warrantied therefore each call to the resolver/provider would return different orders because it doesn't matter.", "author": "gsfernandes", "createdAt": "2020-12-18T11:14:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTYzMzA2MQ=="}], "type": "inlineReview"}]}