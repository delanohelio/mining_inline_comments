{"pr_number": 9532, "pr_title": "MULE-18871: Fix flaky test org.mule.test.module.extension.source.HeisenbergMessageSourceTestCase.sourceRestartedWithDynamicConfig", "pr_createdAt": "2020-10-08T21:02:58Z", "pr_url": "https://github.com/mulesoft/mule/pull/9532", "timeline": [{"oid": "99e865ba14c8332d94c5924ee2e88e967c8829d2", "url": "https://github.com/mulesoft/mule/commit/99e865ba14c8332d94c5924ee2e88e967c8829d2", "message": "MULE-18871: Fix flaky test org.mule.test.module.extension.source.HeisenbergMessageSourceTestCase.sourceRestartedWithDynamicConfig", "committedDate": "2020-10-08T21:00:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDEwOTc2NQ==", "url": "https://github.com/mulesoft/mule/pull/9532#discussion_r504109765", "bodyText": "return flow.getLifecycleState().isStopped();", "author": "eze210", "createdAt": "2020-10-13T16:49:13Z", "path": "modules/extensions-spring-support/src/test/java/org/mule/test/module/extension/source/HeisenbergMessageSourceTestCase.java", "diffHunk": "@@ -331,6 +332,20 @@ protected void stopFlow(String flowName) throws Exception {\n     flow.stop();\n   }\n \n+  protected void requestFlowToStopAndWait(String flowName) throws Exception {\n+    stopFlow(flowName);\n+    checkFlowIsStopped(flowName);\n+  }\n+\n+  protected void checkFlowIsStopped(String flowName) throws Exception {\n+    flow = (Flow) getFlowConstruct(flowName);\n+    check(FLOW_STOP_TIMEOUT, POLL_DELAY_MILLIS,\n+          () -> {\n+            assertThat(\"The flow did not stop in a reasonable amount of time\", flow.getLifecycleState().isStopped(), is(true));", "originalCommit": "99e865ba14c8332d94c5924ee2e88e967c8829d2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDEwOTk1OA==", "url": "https://github.com/mulesoft/mule/pull/9532#discussion_r504109958", "bodyText": "And move the error message to the probe description", "author": "eze210", "createdAt": "2020-10-13T16:49:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDEwOTc2NQ=="}], "type": "inlineReview"}, {"oid": "9892c9ce2fa0f1d09629d019bad7b6e1b37037cd", "url": "https://github.com/mulesoft/mule/commit/9892c9ce2fa0f1d09629d019bad7b6e1b37037cd", "message": "MULE-18871: Fix flaky test org.mule.test.module.extension.source.HeisenbergMessageSourceTestCase.sourceRestartedWithDynamicConfig", "committedDate": "2020-10-13T17:53:36Z", "type": "commit"}, {"oid": "cd2b8260597fe28a65d1fc28ff4302f0a96fddb6", "url": "https://github.com/mulesoft/mule/commit/cd2b8260597fe28a65d1fc28ff4302f0a96fddb6", "message": "MULE-18871: Fix flaky test org.mule.test.module.extension.source.HeisenbergMessageSourceTestCase.sourceRestartedWithDynamicConfig", "committedDate": "2020-10-13T19:26:41Z", "type": "commit"}]}