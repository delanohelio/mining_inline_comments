{"pr_number": 3289, "pr_title": "GH-3283: HTTP Inbound handle SpEL errors", "pr_createdAt": "2020-05-22T20:30:57Z", "pr_url": "https://github.com/spring-projects/spring-integration/pull/3289", "timeline": [{"oid": "1b52d28ed5082145f840bcbd058e9745f7e1ef38", "url": "https://github.com/spring-projects/spring-integration/commit/1b52d28ed5082145f840bcbd058e9745f7e1ef38", "message": "GH-3283: HTTP Inbound handle SpEL errors\n\nFixes https://github.com/spring-projects/spring-integration/issues/3283\n\n* Process all the request message preparation exceptions\nin the provided error channel to let target application\nto make a decision about an appropriate HTTP status instead of\ndefault 500 Server Error", "committedDate": "2020-05-22T20:30:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQyMzU2OA==", "url": "https://github.com/spring-projects/spring-integration/pull/3289#discussion_r431423568", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Also starting with version 5.4, the request message preparation error is send to the provided error channel.\n          \n          \n            \n            A decision about throwing an appropriate exception should be done over there in error flow.\n          \n          \n            \n            Previously those error were always be thrown to the HTTP response as 500 status, but in some cases it is just about a wrong request params, so status 400 should be thrown instead.\n          \n          \n            \n            See `ResponseStatusException` for more information.\n          \n          \n            \n            The `ErrorMessage` sent to this error channel contains an original exception as a payload for analysis.\n          \n          \n            \n            Also starting with version 5.4, an error that is encountered while preparing the request message is sent to the error channel (if provided).\n          \n          \n            \n            A decision about throwing an appropriate exception should be done in the error flow by examining the exception.\n          \n          \n            \n            Previously, any exceptions were simply thrown, causing an HTTP 500 server error response status, but in some cases the problem can be caused by incorrect request params, so a `ResponseStatusException` with a 4xx client error status should be thrown instead.\n          \n          \n            \n            See `ResponseStatusException` for more information.\n          \n          \n            \n            The `ErrorMessage` sent to this error channel contains the original exception as the payload for analysis.", "author": "garyrussell", "createdAt": "2020-05-27T20:30:54Z", "path": "src/reference/asciidoc/http.adoc", "diffHunk": "@@ -431,6 +431,12 @@ If the error flow times out after a main flow timeout, `500 Internal Server Erro\n NOTE: Previously, the default status code for a timeout was `200 OK`.\n To restore that behavior, set `reply-timeout-status-code-expression=\"200\"`.\n \n+Also starting with version 5.4, the request message preparation error is send to the provided error channel.\n+A decision about throwing an appropriate exception should be done over there in error flow.\n+Previously those error were always be thrown to the HTTP response as 500 status, but in some cases it is just about a wrong request params, so status 400 should be thrown instead.\n+See `ResponseStatusException` for more information.\n+The `ErrorMessage` sent to this error channel contains an original exception as a payload for analysis.\n+", "originalCommit": "1b52d28ed5082145f840bcbd058e9745f7e1ef38", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a4c4cb604f66b3a4c55d94a0f136af8c281aa0c2", "url": "https://github.com/spring-projects/spring-integration/commit/a4c4cb604f66b3a4c55d94a0f136af8c281aa0c2", "message": "* Rephrase `ResponseStatusException` doc in the http.adoc\n\nCo-authored-by: Gary Russell <grussell@vmware.com>", "committedDate": "2020-05-27T23:02:37Z", "type": "commit"}]}