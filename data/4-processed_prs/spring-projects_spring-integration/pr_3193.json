{"pr_number": 3193, "pr_title": "GH-3192: pub-sub DSL for broker-backed channels", "pr_createdAt": "2020-02-24T20:19:38Z", "pr_url": "https://github.com/spring-projects/spring-integration/pull/3193", "timeline": [{"oid": "3518a68fab8e181692ebae6d435e964af4920c44", "url": "https://github.com/spring-projects/spring-integration/commit/3518a68fab8e181692ebae6d435e964af4920c44", "message": "GH-3192: pub-sub DSL for broker-backed channels\n\nFixes https://github.com/spring-projects/spring-integration/issues/3192\n\n* Introduce a `BroadcastCapableChannel` abstract to indicate those `SubscribableChannel`\nimplementations which can provide a pub-sub functionality\n* Implement a `BroadcastCapableChannel` in broker-baked channels with pub-sub option\n* Introduce a `BaseIntegrationFlowDefinition.publishSubscribeChannel()` based\non the `BroadcastCapableChannel` and `BroadcastPublishSubscribeSpec` to let to\nconfigure sub-flow subscribers in fluent manner", "committedDate": "2020-02-24T20:19:21Z", "type": "commit"}, {"oid": "1c16c9c8e6c4e676d1bcd8a469b39f767e7e7a3d", "url": "https://github.com/spring-projects/spring-integration/commit/1c16c9c8e6c4e676d1bcd8a469b39f767e7e7a3d", "message": "* Add some JavaDocs and document new feature", "committedDate": "2020-02-24T21:28:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDAxMzI5Nw==", "url": "https://github.com/spring-projects/spring-integration/pull/3193#discussion_r384013297", "bodyText": "Shouldn't we show the cast here? Or is your intention to fix the TODO in JmsTests?", "author": "garyrussell", "createdAt": "2020-02-25T17:18:14Z", "path": "src/reference/asciidoc/dsl.adoc", "diffHunk": "@@ -742,6 +742,32 @@ public IntegrationFlow subscribersFlow() {\n You can achieve the same result with separate `IntegrationFlow` `@Bean` definitions, but we hope you find the sub-flow style of logic composition useful.\n We find that it results in shorter (and so more readable) code.\n \n+Starting with version 5.3, a `BroadcastCapableChannel`-based `publishSubscribeChannel()` implementation is provided to configure sub-flow subscribers on the broker-backed message channels.\n+For example we now can configure several subscribers as sub-flows on the `Jms.publishSubscribeChannel()`:\n+\n+====\n+[source,java]\n+----\n+@Bean\n+public BroadcastCapableChannel jmsPublishSubscribeChannel() {\n+    return Jms.publishSubscribeChannel(jmsConnectionFactory())", "originalCommit": "1c16c9c8e6c4e676d1bcd8a469b39f767e7e7a3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDAyNTg1NQ==", "url": "https://github.com/spring-projects/spring-integration/pull/3193#discussion_r384025855", "bodyText": "Yeah... I thought about that, but that is going to be kinda breaking change for the current 5.3 which should be compatible with the current Spring Cloud which will support both 5.2 and 5.3.\nOk. I'll show the cast and we will remove in the next version when generics will be resolved properly.", "author": "artembilan", "createdAt": "2020-02-25T17:39:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDAxMzI5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDAxMzY2NA==", "url": "https://github.com/spring-projects/spring-integration/pull/3193#discussion_r384013664", "bodyText": "Remove the - on broker-backed ....", "author": "garyrussell", "createdAt": "2020-02-25T17:18:50Z", "path": "src/reference/asciidoc/dsl.adoc", "diffHunk": "@@ -742,6 +742,32 @@ public IntegrationFlow subscribersFlow() {\n You can achieve the same result with separate `IntegrationFlow` `@Bean` definitions, but we hope you find the sub-flow style of logic composition useful.\n We find that it results in shorter (and so more readable) code.\n \n+Starting with version 5.3, a `BroadcastCapableChannel`-based `publishSubscribeChannel()` implementation is provided to configure sub-flow subscribers on the broker-backed message channels.", "originalCommit": "1c16c9c8e6c4e676d1bcd8a469b39f767e7e7a3d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2c246950502de45d77304db27a0497dce630fc69", "url": "https://github.com/spring-projects/spring-integration/commit/2c246950502de45d77304db27a0497dce630fc69", "message": "* Show the channel bean definition in the doc\n* Fix typo", "committedDate": "2020-02-25T17:41:25Z", "type": "commit"}]}