{"pr_number": 3191, "pr_title": "GH-3180: Add encoding-mode to WS outbound gateway", "pr_createdAt": "2020-02-20T21:58:57Z", "pr_url": "https://github.com/spring-projects/spring-integration/pull/3191", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc4MDM2OQ==", "url": "https://github.com/spring-projects/spring-integration/pull/3191#discussion_r382780369", "bodyText": "Wow - looks like this was a bug! Looks like this should always have been encoded.", "author": "garyrussell", "createdAt": "2020-02-21T20:03:23Z", "path": "spring-integration-ws/src/test/java/org/springframework/integration/ws/config/UriVariableTests.java", "diffHunk": "@@ -134,7 +131,7 @@ public void testHttpUriVariables() {\n \t\tassertThatExceptionOfType(MessagingException.class)\n \t\t\t\t.isThrownBy(() -> this.inputHttp.send(message))\n \t\t\t\t.withCauseInstanceOf(WebServiceIOException.class); // offline\n-\t\tassertThat(uri.get()).isEqualTo(\"http://localhost/spring-integration?param=test1%20&%20test2\");\n+\t\tassertThat(uri.get()).isEqualTo(\"http://localhost/spring-integration?param=test1%20%26%20test2\");", "originalCommit": "c3d00a44d32e5e0164c6489f20ec73fdb72887fe", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc4MTAxOA==", "url": "https://github.com/spring-projects/spring-integration/pull/3191#discussion_r382781018", "bodyText": "s/Same/The same/", "author": "garyrussell", "createdAt": "2020-02-21T20:04:55Z", "path": "src/reference/asciidoc/http.adoc", "diffHunk": "@@ -724,7 +724,7 @@ If you wish to partially encode some of the URL, use an `expression` within a `<\n ====\n \n With Java DSL this option can be controlled by the `BaseHttpMessageHandlerSpec.encodingMode()` option.\n-Same configuration applies for similar outbound components in the <<./webflux.adoc/[webflux,WebFlux module>>.\n+Same configuration applies for similar outbound components in the <<./webflux.adoc#webflux,WebFlux module>> and <<./ws.adoc#ws,Web Services module>>.", "originalCommit": "c3d00a44d32e5e0164c6489f20ec73fdb72887fe", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc4MTE5NQ==", "url": "https://github.com/spring-projects/spring-integration/pull/3191#discussion_r382781195", "bodyText": "s/Same/The same/", "author": "garyrussell", "createdAt": "2020-02-21T20:05:24Z", "path": "src/reference/asciidoc/whats-new.adoc", "diffHunk": "@@ -68,9 +68,11 @@ See <<./amqp.adoc#amqp-inbound-channel-adapter,AMQP Inbound Channel Adapter>>\n The `encodeUri` property on the `AbstractHttpRequestExecutingMessageHandler` has been deprecated in favor of newly introduced `encodingMode`.\n See `DefaultUriBuilderFactory.EncodingMode` JavaDocs and <<./http.adoc#http-uri-encoding,Controlling URI Encoding>> for more information.\n This also affects `WebFluxRequestExecutingMessageHandler`, respective Java DSL and XML configuration.\n+Same option is added into an `AbstractWebServiceOutboundGateway`.", "originalCommit": "c3d00a44d32e5e0164c6489f20ec73fdb72887fe", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjc4MTg0MQ==", "url": "https://github.com/spring-projects/spring-integration/pull/3191#discussion_r382781841", "bodyText": "provides an provide an ??\nShould be just \"provides an `en ...\"", "author": "garyrussell", "createdAt": "2020-02-21T20:07:01Z", "path": "src/reference/asciidoc/ws.adoc", "diffHunk": "@@ -305,22 +305,22 @@ If you supply a `DestinationProvider`, variable substitution is not supported an\n \n By default, the URL string is encoded (see https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/util/UriComponentsBuilder.html[`UriComponentsBuilder`]) to the URI object before sending the request.\n In some scenarios with a non-standard URI, it is undesirable to perform the encoding.\n-Since version 4.1, the `<ws:outbound-gateway/>` element provides an `encode-uri` attribute.\n-To disable encoding the URL, set this attribute `false` (it defaults to `true`).\n+The `<ws:outbound-gateway/>` element provides an provide an `encoding-mode` attribute.", "originalCommit": "c3d00a44d32e5e0164c6489f20ec73fdb72887fe", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c2c266eeb5a595ff18ccefb5c5bfe334b7f19d5b", "url": "https://github.com/spring-projects/spring-integration/commit/c2c266eeb5a595ff18ccefb5c5bfe334b7f19d5b", "message": "GH-3180: Add encoding-mode to WS outbound gateway\n\nFixes https://github.com/spring-projects/spring-integration/issues/3180\n\n* Deprecate `encode-uri` in favor of newly introduced `encoding-mode`\n* Add new property to XML and DSL configurations\n* Fix tests according a new behavior\n* Document the feature\n* Fix docs for deprecated `encode-uri`\n* Mention also WS from `http.adoc`", "committedDate": "2020-02-21T20:16:22Z", "type": "commit"}, {"oid": "af78facb0dff061143d2c50d66be33d308700ff9", "url": "https://github.com/spring-projects/spring-integration/commit/af78facb0dff061143d2c50d66be33d308700ff9", "message": "* Fix typos in docs", "committedDate": "2020-02-21T20:18:03Z", "type": "commit"}, {"oid": "af78facb0dff061143d2c50d66be33d308700ff9", "url": "https://github.com/spring-projects/spring-integration/commit/af78facb0dff061143d2c50d66be33d308700ff9", "message": "* Fix typos in docs", "committedDate": "2020-02-21T20:18:03Z", "type": "forcePushed"}]}