{"pr_number": 11740, "pr_title": "[BEAM-8019] Prevent Dataflow from starting multiple containers for the same image", "pr_createdAt": "2020-05-18T19:08:16Z", "pr_url": "https://github.com/apache/beam/pull/11740", "timeline": [{"oid": "b4d17c11f3411e35e6bb558ca593d41c39839cce", "url": "https://github.com/apache/beam/commit/b4d17c11f3411e35e6bb558ca593d41c39839cce", "message": "Prevent Dataflow from starting multiple containers for the same image", "committedDate": "2020-05-18T19:05:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY0NjU4OA==", "url": "https://github.com/apache/beam/pull/11740#discussion_r427646588", "bodyText": "Perhaps also add a comment that currently dataflow stages all dependencies to all environments?", "author": "robertwb", "createdAt": "2020-05-19T22:57:55Z", "path": "sdks/python/apache_beam/runners/dataflow/internal/apiclient.py", "diffHunk": "@@ -310,15 +312,15 @@ def __init__(\n         environment_payload = proto_utils.parse_Bytes(\n             environment.payload, beam_runner_api_pb2.DockerPayload)\n         container_image_url = environment_payload.container_image\n-        if container_image_url == pipeline_sdk_container_image:\n-          # This was already added\n+        if container_image_url in already_added_containers:\n+          # Do not add the pipeline environment again.", "originalCommit": "b4d17c11f3411e35e6bb558ca593d41c39839cce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzc1NTUwMA==", "url": "https://github.com/apache/beam/pull/11740#discussion_r427755500", "bodyText": "Sent #11757.", "author": "chamikaramj", "createdAt": "2020-05-20T05:48:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY0NjU4OA=="}], "type": "inlineReview"}]}