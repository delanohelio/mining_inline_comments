{"pr_number": 12216, "pr_title": "For Java container, generate license report only for container modules", "pr_createdAt": "2020-07-10T14:13:49Z", "pr_url": "https://github.com/apache/beam/pull/12216", "timeline": [{"oid": "2cdd9c268de2636a4769c9dcbe0f582f40573fe9", "url": "https://github.com/apache/beam/commit/2cdd9c268de2636a4769c9dcbe0f582f40573fe9", "message": "Re-enable checker in Samza job server\n\nThis module passes checker, because it has no source. This was previously\nblocked by issues with other build infra.", "committedDate": "2020-07-10T14:37:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjg4NjkxOQ==", "url": "https://github.com/apache/beam/pull/12216#discussion_r452886919", "bodyText": "@mxm @chamikaramj  incidentally, is this Kafka dep in the core Java harness still required?", "author": "kennknowles", "createdAt": "2020-07-10T14:41:20Z", "path": "sdks/java/container/build.gradle", "diffHunk": "@@ -77,7 +77,9 @@ golang {\n import com.github.jk1.license.render.*\n licenseReport {\n   outputDir = 'java_third_party_licenses'\n-  projects = [project.rootProject] + project.rootProject.subprojects\n+  projects = [project,\n+              project.rootProject.findProject(':sdks:java:harness'),\n+              project.rootProject.findProject(':sdks:java:io:kafka')]", "originalCommit": "2cdd9c268de2636a4769c9dcbe0f582f40573fe9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk5MjU1Mg==", "url": "https://github.com/apache/beam/pull/12216#discussion_r452992552", "bodyText": "I think this can be removed now that Kafka dependencies are included in \"sdks:java:io:expansion-service\" which is used and staged by the kafka x-lang wrapper. But have to run some tests to confirm.", "author": "chamikaramj", "createdAt": "2020-07-10T18:00:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjg4NjkxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk3NDQxMw==", "url": "https://github.com/apache/beam/pull/12216#discussion_r452974413", "bodyText": "Does this change include all dependencies installed in container? If so, it looks good for now.\nThis list should evolve if more dependencies are added to container, so we need to make it clear somewhere for developers who add new dependencies to container.\nA minor update to release guide is needed. There is a step to check if all licenses are added by checking the number of licenses. Now we expect to see roughly 1400 dependencies. With this change, I think the number is reduced? Then the guide should be updated with a new number or find a better way to check if all expected licenses are included.", "author": "Hannah-Jiang", "createdAt": "2020-07-10T17:22:52Z", "path": "sdks/java/container/build.gradle", "diffHunk": "@@ -77,7 +77,9 @@ golang {\n import com.github.jk1.license.render.*\n licenseReport {\n   outputDir = 'java_third_party_licenses'\n-  projects = [project.rootProject] + project.rootProject.subprojects\n+  projects = [project,\n+              project.rootProject.findProject(':sdks:java:harness'),\n+              project.rootProject.findProject(':sdks:java:io:kafka')]", "originalCommit": "2cdd9c268de2636a4769c9dcbe0f582f40573fe9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk3ODE3MA==", "url": "https://github.com/apache/beam/pull/12216#discussion_r452978170", "bodyText": "Hmmm. When I ran :sdks:java:container:generateLicenseReport before this PR I got 50 dependencies. After this PR I got 55. See the diff in the description. It mostly added new deps. The ones removed were:\n\nchecker-qual-3.4.1.jar: this is compileOnly so we don't need it... but it should be in the configuration I chose...\nhadoop-apache2-3.2.0-1.jar: I hope this is not in the container!\nicu4j-58.2.jar: I don't know\nobjenesis-2.6.jar: I don't know\nwoodstox-core-asl-4.4.1.jar: I don't know\n\nBut it sounds like there's another problem because I should be able to repro and get 1400 licenses at head.", "author": "kennknowles", "createdAt": "2020-07-10T17:30:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk3NDQxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk4MDgzNQ==", "url": "https://github.com/apache/beam/pull/12216#discussion_r452980835", "bodyText": "I see. I need to run the wrapper script to further process the output of this command. I expect it will be monotonic (more output from generateLicenseReport --> more licenses in the end) but I will double check and do a full diff of the larger output.", "author": "kennknowles", "createdAt": "2020-07-10T17:36:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk3NDQxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk5MzMwMQ==", "url": "https://github.com/apache/beam/pull/12216#discussion_r452993301", "bodyText": "Yep, need to run pullLicenses task with  --docker-pull-licenses options. generateLicenseReport task pulls licenses from jars. If licenses are not distributed within jar, they are ignored. pullLicenses task pulls those missing licenses, so will have more licenses. But I don't think the gap should be 50 vs 1400.", "author": "Hannah-Jiang", "createdAt": "2020-07-10T18:02:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk3NDQxMw=="}], "type": "inlineReview"}, {"oid": "be8bc5728d38879a6cb7badd1bc15ee4156187e9", "url": "https://github.com/apache/beam/commit/be8bc5728d38879a6cb7badd1bc15ee4156187e9", "message": "Fix deps for Java container license report", "committedDate": "2020-07-13T17:36:49Z", "type": "commit"}, {"oid": "5b9336d76d26f430474af775f5fbe140b4d7d7bb", "url": "https://github.com/apache/beam/commit/5b9336d76d26f430474af775f5fbe140b4d7d7bb", "message": "Re-enable checker in Samza job server\n\nThis module passes checker, because it has no source. This was previously\nblocked by issues with other build infra.", "committedDate": "2020-07-13T17:36:49Z", "type": "commit"}, {"oid": "5b9336d76d26f430474af775f5fbe140b4d7d7bb", "url": "https://github.com/apache/beam/commit/5b9336d76d26f430474af775f5fbe140b4d7d7bb", "message": "Re-enable checker in Samza job server\n\nThis module passes checker, because it has no source. This was previously\nblocked by issues with other build infra.", "committedDate": "2020-07-13T17:36:49Z", "type": "forcePushed"}]}