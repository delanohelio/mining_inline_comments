{"pr_number": 12760, "pr_title": "[BEAM-10861] Adds URNs and payloads to PubSub transforms to allow runner-native overrides", "pr_createdAt": "2020-09-02T16:48:01Z", "pr_url": "https://github.com/apache/beam/pull/12760", "timeline": [{"oid": "03771266a8d83ac24564a8fb39d5e694f6111342", "url": "https://github.com/apache/beam/commit/03771266a8d83ac24564a8fb39d5e694f6111342", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides", "committedDate": "2020-09-08T17:39:26Z", "type": "forcePushed"}, {"oid": "9dd622c90e44b903c5aea4210bd84c60b52572e9", "url": "https://github.com/apache/beam/commit/9dd622c90e44b903c5aea4210bd84c60b52572e9", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides", "committedDate": "2020-09-08T17:49:42Z", "type": "forcePushed"}, {"oid": "c131ca0a1f762685de0c5254d4392ca794aea95a", "url": "https://github.com/apache/beam/commit/c131ca0a1f762685de0c5254d4392ca794aea95a", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides", "committedDate": "2020-09-10T00:13:20Z", "type": "commit"}, {"oid": "c131ca0a1f762685de0c5254d4392ca794aea95a", "url": "https://github.com/apache/beam/commit/c131ca0a1f762685de0c5254d4392ca794aea95a", "message": "Adds URNs and payloads to PubSub transforms to allow runner-native overrides", "committedDate": "2020-09-10T00:13:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMzMjY3Nw==", "url": "https://github.com/apache/beam/pull/12760#discussion_r487332677", "bodyText": "Just curious why we use string not bytes for serialized fn.", "author": "boyuanzz", "createdAt": "2020-09-11T23:32:25Z", "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -650,6 +656,54 @@ message WriteFilesPayload {\n   map<string, SideInput> side_inputs = 5;\n }\n \n+// Payload used by Google Cloud Pub/Sub read transform.\n+// This can be used by runners that wish to override Beam Pub/Sub read transform\n+// with a native implementation.\n+message PubSubReadPayload {\n+\n+  // Topic to read from. Exactly one of topic or subscription should be set.\n+  string topic = 1;\n+\n+  // Subscription to read from. Exactly one of topic or subscription should be set.\n+  string subscription = 2;\n+\n+  // Attribute that provides element timestamps.\n+  string timestamp_attribute = 3;\n+\n+  // Attribute to be used for uniquely identifying messages.\n+  string id_attribute = 4;\n+\n+  // If true, reads Pub/Sub payload as well as attributes. If false, reads only the payload.\n+  bool with_attributes = 5;\n+\n+  // Parse function for attibutes.\n+  string serialized_attribute_fn = 6;\n+}\n+\n+// Payload used by Google Cloud Pub/Sub write transform.\n+// This can be used by runners that wish to override Beam Pub/Sub write transform\n+// with a native implementation.\n+message PubSubWritePayload {\n+\n+  // Topic to write to.\n+  string topic = 1;\n+\n+  // Attribute that provides element timestamps.\n+  string timestamp_attribute = 2;\n+\n+  // Attribute that uniquely identify messages.\n+  string id_attribute = 3;\n+\n+  // If true, writes Pub/Sub payload as well as attributes. If false, reads only the payload.\n+  bool with_attributes = 4;\n+\n+  // Parse function for attributes.\n+  string serialized_attribute_fn = 5;", "originalCommit": "c131ca0a1f762685de0c5254d4392ca794aea95a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1NDI0Nw==", "url": "https://github.com/apache/beam/pull/12760#discussion_r487354247", "bodyText": "This is to be provided as JSON serialized bytes. Slightly updated the documentation.\nThis is to be compatible with Dataflow implementation which is the only runner that will perform a native override of PubSub transforms.", "author": "chamikaramj", "createdAt": "2020-09-12T02:07:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzMzMjY3Nw=="}], "type": "inlineReview"}, {"oid": "72058e49a00eb85caf0fe2301d353c6fd2708db4", "url": "https://github.com/apache/beam/commit/72058e49a00eb85caf0fe2301d353c6fd2708db4", "message": "Documentation update", "committedDate": "2020-09-12T02:06:43Z", "type": "commit"}]}