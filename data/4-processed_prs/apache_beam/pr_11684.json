{"pr_number": 11684, "pr_title": "[BEAM-9622] Add Python SqlTransform test that joins tagged PCollections", "pr_createdAt": "2020-05-12T18:35:21Z", "pr_url": "https://github.com/apache/beam/pull/11684", "timeline": [{"oid": "2b2d299f06f4309a651d79678b866c6655494859", "url": "https://github.com/apache/beam/commit/2b2d299f06f4309a651d79678b866c6655494859", "message": "Add test that joins tagged pcollections", "committedDate": "2020-05-12T18:30:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA1ODI3MQ==", "url": "https://github.com/apache/beam/pull/11684#discussion_r424058271", "bodyText": "Could we choose names that don't require so much quoting? (Or is that part of the test?)", "author": "robertwb", "createdAt": "2020-05-12T21:58:44Z", "path": "sdks/python/apache_beam/transforms/sql_test.py", "diffHunk": "@@ -111,6 +114,27 @@ def test_agg(self):\n               FROM PCOLLECTION GROUP BY `str`\"\"\"))\n       assert_that(out, equal_to([(\"foo\", 3, 3, 2), (\"bar\", 4, 8, 1.414)]))\n \n+  def test_tagged_join(self):\n+    with TestPipeline() as p:\n+      enrich = (\n+          p | \"Create enrich\" >> beam.Create(\n+              [Enrich(1, \"a\"), Enrich(2, \"b\"), Enrich(26, \"z\")]))\n+      rows = (\n+          p | \"Create rows\" >> beam.Create([\n+              SimpleRow(1, \"foo\", 3.14),\n+              SimpleRow(26, \"bar\", 1.11),\n+              SimpleRow(1, \"baz\", 2.34)\n+          ]))\n+      out = ({\n+          'rows': rows, 'enrich': enrich\n+      }\n+             | SqlTransform(\n+                 \"\"\"\n+              SELECT\n+                `rows`.`int` AS `int`, `enrich`.`metadata` AS `metadata`", "originalCommit": "2b2d299f06f4309a651d79678b866c6655494859", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA4NDA0OQ==", "url": "https://github.com/apache/beam/pull/11684#discussion_r424084049", "bodyText": "Ha yeah I got a little backtick happy. Renamed \"rows\" to \"simple\" so it doesn't need to be wrapped and removed some other unnecessary backticks.", "author": "TheNeuralBit", "createdAt": "2020-05-12T23:07:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDA1ODI3MQ=="}], "type": "inlineReview"}, {"oid": "4327721d78fb960077e82a92338da7d3bfd3bf94", "url": "https://github.com/apache/beam/commit/4327721d78fb960077e82a92338da7d3bfd3bf94", "message": "remove unnecessary backticks", "committedDate": "2020-05-12T23:06:02Z", "type": "commit"}]}