{"pr_number": 11951, "pr_title": "[BEAM-8828] Added BigQueryTableProvider WriteDisposition configuration", "pr_createdAt": "2020-06-08T20:31:07Z", "pr_url": "https://github.com/apache/beam/pull/11951", "timeline": [{"oid": "aef9cee6db5e04218d8f3d42146c71800ff9a36e", "url": "https://github.com/apache/beam/commit/aef9cee6db5e04218d8f3d42146c71800ff9a36e", "message": "[BEAM-8828] Added BigQueryTableProvider WriteDisposition configuration", "committedDate": "2020-06-08T19:44:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjk4NDU1MQ==", "url": "https://github.com/apache/beam/pull/11951#discussion_r436984551", "bodyText": "Could you add a test like this for EMPTY and TRUNCATE as well?", "author": "TheNeuralBit", "createdAt": "2020-06-08T20:34:38Z", "path": "sdks/java/extensions/sql/src/test/java/org/apache/beam/sdk/extensions/sql/meta/provider/bigquery/BigQueryTableProviderTest.java", "diffHunk": "@@ -91,6 +94,16 @@ public void testSelectExportMethod() {\n     assertEquals(Method.EXPORT, sqlTable.method);\n   }\n \n+  @Test\n+  public void testSelectWriteDispositionMethod() {\n+    Table table =\n+            fakeTableWithProperties(\n+                    \"hello\", \"{ \" + WRITE_DISPOSITION_PROPERTY + \": \" + \"\\\"\" + WriteDisposition.WRITE_APPEND.toString() + \"\\\" }\");\n+    BigQueryTable sqlTable = (BigQueryTable) provider.buildBeamSqlTable(table);\n+\n+    assertEquals(WriteDisposition.WRITE_APPEND, sqlTable.writeDisposition);\n+  }\n+", "originalCommit": "aef9cee6db5e04218d8f3d42146c71800ff9a36e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1bbadd69c84f253a974fdb8dbaf1035c74b7a7b2", "url": "https://github.com/apache/beam/commit/1bbadd69c84f253a974fdb8dbaf1035c74b7a7b2", "message": "Added BigQueryTable WriteDisposition unit and integration tests", "committedDate": "2020-06-09T19:52:26Z", "type": "commit"}]}