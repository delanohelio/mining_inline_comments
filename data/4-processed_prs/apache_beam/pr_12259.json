{"pr_number": 12259, "pr_title": "[BEAM-9561] Run Pandas tests on Beam.", "pr_createdAt": "2020-07-15T00:35:21Z", "pr_url": "https://github.com/apache/beam/pull/12259", "timeline": [{"oid": "235c905a420daa2b8a00797f871be1991236cea5", "url": "https://github.com/apache/beam/commit/235c905a420daa2b8a00797f871be1991236cea5", "message": "Ignore NameErrors right after WontImplementErrors.", "committedDate": "2020-07-15T00:33:22Z", "type": "commit"}, {"oid": "5538d9e73d94cf30a87b9a4cd78a426b7a6b2d86", "url": "https://github.com/apache/beam/commit/5538d9e73d94cf30a87b9a4cd78a426b7a6b2d86", "message": "Add doctest skipping framework.", "committedDate": "2020-07-15T00:33:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3MzIxMg==", "url": "https://github.com/apache/beam/pull/12259#discussion_r456073212", "bodyText": "Should we support regex matching here, or is that overkill?", "author": "ibzib", "createdAt": "2020-07-16T20:56:53Z", "path": "sdks/python/apache_beam/dataframe/doctests.py", "diffHunk": "@@ -240,13 +256,31 @@ class BeamDataframeDoctestRunner(doctest.DocTestRunner):\n   \"\"\"A Doctest runner suitable for replacing the `pd` module with one backed\n   by beam.\n   \"\"\"\n-  def __init__(self, env, use_beam=True, **kwargs):\n+  def __init__(self, env, use_beam=True, skip=None, **kwargs):\n     self._test_env = env\n+\n+    def to_callable(cond):\n+      if cond == '*':", "originalCommit": "b646a6e1f3a06a5d978515d385092e464ab3f6ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0MzY4NA==", "url": "https://github.com/apache/beam/pull/12259#discussion_r456143684", "bodyText": "I started out supporting regex, but realized it'd be painful to have to escape things like parentheses, brackets, dots, etc. in code snippets. (This is internal, so we could always add this later. Some ideas I've had would be to special case \"/regex-here/\" or pass through callables to allow re.compile(\"regex\").match.", "author": "robertwb", "createdAt": "2020-07-17T00:01:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3MzIxMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3NDc5NQ==", "url": "https://github.com/apache/beam/pull/12259#discussion_r456074795", "bodyText": "Why should running one line successfully reset _seen_wont_implement?", "author": "ibzib", "createdAt": "2020-07-16T21:00:04Z", "path": "sdks/python/apache_beam/dataframe/doctests_test.py", "diffHunk": "@@ -63,6 +63,20 @@\n ignored result\n '''\n \n+ERROR_RAISING_NAME_ERROR_TESTS = '''\n+>>> import apache_beam\n+>>> raise apache_beam.dataframe.frame_base.WontImplementError('anything')\n+ignored exception\n+>>> raise NameError\n+ignored exception\n+>>> undefined_name\n+ignored exception\n+>>> 2 + 2", "originalCommit": "b646a6e1f3a06a5d978515d385092e464ab3f6ce", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0Mzg3Nw==", "url": "https://github.com/apache/beam/pull/12259#discussion_r456143877", "bodyText": "I don't want to ignore the whole rest of the docstring, which often has other examples.", "author": "robertwb", "createdAt": "2020-07-17T00:01:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3NDc5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE2MDU1OA==", "url": "https://github.com/apache/beam/pull/12259#discussion_r456160558", "bodyText": "That sounds fine. If we encounter an issue like this example simulates, I assume we can always manually add the test to the skip map.", "author": "ibzib", "createdAt": "2020-07-17T01:02:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA3NDc5NQ=="}], "type": "inlineReview"}, {"oid": "e324b5cd94988021ed8def741e2ac54e094ec7f3", "url": "https://github.com/apache/beam/commit/e324b5cd94988021ed8def741e2ac54e094ec7f3", "message": "Add tests for all Pandas DataFrame and Series tests.\n\nCurrently all tests are skipped, but we can unskip them as we validate\nthe Beam implementations.", "committedDate": "2020-07-17T16:33:52Z", "type": "commit"}, {"oid": "e324b5cd94988021ed8def741e2ac54e094ec7f3", "url": "https://github.com/apache/beam/commit/e324b5cd94988021ed8def741e2ac54e094ec7f3", "message": "Add tests for all Pandas DataFrame and Series tests.\n\nCurrently all tests are skipped, but we can unskip them as we validate\nthe Beam implementations.", "committedDate": "2020-07-17T16:33:52Z", "type": "forcePushed"}]}