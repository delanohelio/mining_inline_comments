{"pr_number": 13260, "pr_title": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.", "pr_createdAt": "2020-11-04T17:50:23Z", "pr_url": "https://github.com/apache/beam/pull/13260", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzU0OTgwNg==", "url": "https://github.com/apache/beam/pull/13260#discussion_r517549806", "bodyText": "We may want to keep this task and replace fnApiPipelineOptions with runnerV2PipelineOptionsto help people inspect pipeline options when they want to run single test.", "author": "boyuanzz", "createdAt": "2020-11-04T18:32:49Z", "path": "runners/google-cloud-dataflow-java/build.gradle", "diffHunk": "@@ -275,19 +266,6 @@ afterEvaluate {\n   }\n }\n \n-task printFnApiPipelineOptions {", "originalCommit": "77d8b4719fc1a168770dbc00fd27cf80aafb4d6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzYyNzQxNw==", "url": "https://github.com/apache/beam/pull/13260#discussion_r517627417", "bodyText": "Do people use this? I don't understand how since it dependsOn buildAndPushDockerContainer which actually builds an ephemeral container image, uploads it to gcr, then deletes it:\n> Task :runners:google-cloud-dataflow-java:printRunnerV2PipelineOptions\nTo run a Dataflow job with runner V2, add the following pipeline options to your command-line:\n--runner=TestDataflowRunner --project=apache-beam-testing --region=us-central1 --tempRoot=gs://temp-storage-for-validates-runner-tests --workerHarnessContainerImage=us.gcr.io/apache-beam-testing/java-postcommit-it/java:20201104192242 --experiments=beam_fn_api,use_unified_worker\n\n> Task :runners:google-cloud-dataflow-java:cleanUpDockerImages\nUntagged: us.gcr.io/apache-beam-testing/java-postcommit-it/java:20201104192242\nUntagged: us.gcr.io/apache-beam-testing/java-postcommit-it/java@sha256:19baebd7dc6a9c1db7e99b230dc306effc4b9ec61e7d8203166c2bc80145e883\nDigests:\n- us.gcr.io/apache-beam-testing/java-postcommit-it/java@sha256:19baebd7dc6a9c1db7e99b230dc306effc4b9ec61e7d8203166c2bc80145e883\n  Associated tags:\n - 20201104192242\nTags:\n- us.gcr.io/apache-beam-testing/java-postcommit-it/java:20201104192242\nDeleted [us.gcr.io/apache-beam-testing/java-postcommit-it/java:20201104192242].\nDeleted [us.gcr.io/apache-beam-testing/java-postcommit-it/java@sha256:19baebd7dc6a9c1db7e99b230dc306effc4b9ec61e7d8203166c2bc80145e883].\n\nDeprecated Gradle features were used in this build, making it incompatible with Gradle 7.0.\nUse '--warning-mode all' to show the individual deprecation warnings.\nSee https://docs.gradle.org/6.6.1/userguide/command_line_interface.html#sec:command_line_warnings", "author": "tysonjh", "createdAt": "2020-11-04T20:58:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzU0OTgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY4MTk3OQ==", "url": "https://github.com/apache/beam/pull/13260#discussion_r517681979", "bodyText": "I'm not sure whether we have folks use it. It's helpful to show all options we are using to launch such a test. But it seems like a bug to clean up the docker image.", "author": "boyuanzz", "createdAt": "2020-11-04T23:01:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzU0OTgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTAyMzU0OQ==", "url": "https://github.com/apache/beam/pull/13260#discussion_r519023549", "bodyText": "Without cleaning it up we'll end up with an ever-growing list of them and unfortunately I don't see a way to set TTL on objects in gcr. Maybe we could not bother with that if we had a perioid cleanup, which gcloud seems to support, but I haven't investigated on this a lot.\nI most often use jenkins to find out how a job is executed.", "author": "tysonjh", "createdAt": "2020-11-06T21:51:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzU0OTgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA1NTI5Mg==", "url": "https://github.com/apache/beam/pull/13260#discussion_r519055292", "bodyText": "I added it back and refactored a bit so users could print the options, then later delete the image manually (and I printed the delete commands to the terminal).", "author": "tysonjh", "createdAt": "2020-11-06T23:33:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzU0OTgwNg=="}], "type": "inlineReview"}, {"oid": "484b0c2d399ea66d94ea711ecae238f7c63c0f7a", "url": "https://github.com/apache/beam/commit/484b0c2d399ea66d94ea711ecae238f7c63c0f7a", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.", "committedDate": "2020-11-04T20:59:33Z", "type": "forcePushed"}, {"oid": "ecbb29a37b75b3eb28755e270b103de4898e6c9c", "url": "https://github.com/apache/beam/commit/ecbb29a37b75b3eb28755e270b103de4898e6c9c", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.\n\nAlso add the runner v2 tests to postcommits.", "committedDate": "2020-11-04T22:17:35Z", "type": "forcePushed"}, {"oid": "1f34358b9ab8e9599ca1b18511a971141fe24140", "url": "https://github.com/apache/beam/commit/1f34358b9ab8e9599ca1b18511a971141fe24140", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.\n\nAlso add the runner v2 tests to postcommits.", "committedDate": "2020-11-04T22:25:33Z", "type": "forcePushed"}, {"oid": "23513606e77a63b8cff43aba60f11e7ccfa8933c", "url": "https://github.com/apache/beam/commit/23513606e77a63b8cff43aba60f11e7ccfa8933c", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.\n\nAlso add the runner v2 tests to postcommits.", "committedDate": "2020-11-06T22:53:16Z", "type": "forcePushed"}, {"oid": "40f5ad19137d21647ab003f311942eb68c14cc22", "url": "https://github.com/apache/beam/commit/40f5ad19137d21647ab003f311942eb68c14cc22", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.", "committedDate": "2020-11-06T23:27:03Z", "type": "forcePushed"}, {"oid": "4fe954729da32a0d3b1f0d3bc839d7006941e3df", "url": "https://github.com/apache/beam/commit/4fe954729da32a0d3b1f0d3bc839d7006941e3df", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.", "committedDate": "2020-11-09T17:30:02Z", "type": "forcePushed"}, {"oid": "76f56e8b0486597cd5e42a2deaa977212b74f8e9", "url": "https://github.com/apache/beam/commit/76f56e8b0486597cd5e42a2deaa977212b74f8e9", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.", "committedDate": "2020-11-09T17:34:03Z", "type": "forcePushed"}, {"oid": "28409f9c5dc75d58ab9379649fc785f6d8035a59", "url": "https://github.com/apache/beam/commit/28409f9c5dc75d58ab9379649fc785f6d8035a59", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.", "committedDate": "2020-11-09T17:34:24Z", "type": "commit"}, {"oid": "28409f9c5dc75d58ab9379649fc785f6d8035a59", "url": "https://github.com/apache/beam/commit/28409f9c5dc75d58ab9379649fc785f6d8035a59", "message": "[BEAM-11192] Replace Java FnApi test tasks with Runner V2.\n\nThe FnApi tests are no longer needed since the JRH is exercised\nthrough Python xlang portability tests. The configuration can be\nrepurposed for runner v2 testing.", "committedDate": "2020-11-09T17:34:24Z", "type": "forcePushed"}]}