{"pr_number": 12394, "pr_title": "[BEAM-7390] Add latest code snippets", "pr_createdAt": "2020-07-28T17:32:33Z", "pr_url": "https://github.com/apache/beam/pull/12394", "timeline": [{"oid": "11ff60d4687a9eb3f094147629f1ecf81c4626f6", "url": "https://github.com/apache/beam/commit/11ff60d4687a9eb3f094147629f1ecf81c4626f6", "message": "[BEAM-7390] Add latest code snippets", "committedDate": "2020-07-28T17:31:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk0NTQ2Mw==", "url": "https://github.com/apache/beam/pull/12394#discussion_r461945463", "bodyText": "Outside of the diff, but this is incorrect\n\"Randomly takes some number of elements in a collection.\"", "author": "rosetn", "createdAt": "2020-07-28T23:13:14Z", "path": "website/www/site/content/en/documentation/transforms/python/aggregation/latest.md", "diffHunk": "@@ -14,10 +14,61 @@ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n -->\n+\n # Latest\n \n+{{< localstorage language language-py >}}\n+\n+{{< button-pydoc path=\"apache_beam.transforms.combiners\" class=\"Latest\" >}}\n+\n+Gets the element with the latest timestamp.\n+\n ## Examples\n-See [BEAM-7390](https://issues.apache.org/jira/browse/BEAM-7390) for updates. \n+\n+In the following examples, we create a pipeline with a `PCollection` of produce with a timestamp for their harvest date.\n+\n+We use `Latest` to get the element with the latest timestamp from the `PCollection`.\n+\n+### Example 1: Latest element globally\n+\n+We use `Latest.Globally()` to get the element with the latest timestamp in the entire `PCollection`.\n+\n+{{< highlight py >}}\n+{{< code_sample \"sdks/python/apache_beam/examples/snippets/transforms/aggregation/latest.py\" latest_globally >}}\n+{{< /highlight >}}\n+\n+{{< paragraph class=\"notebook-skip\" >}}\n+Output:\n+{{< /paragraph >}}\n+\n+{{< highlight class=\"notebook-skip\" >}}\n+{{< code_sample \"sdks/python/apache_beam/examples/snippets/transforms/aggregation/latest_test.py\" latest_element >}}\n+{{< /highlight >}}\n+\n+{{< buttons-code-snippet\n+  py=\"sdks/python/apache_beam/examples/snippets/transforms/aggregation/latest.py\" >}}\n+\n+### Example 2: Latest elements for each key\n+\n+We use `Latest.PerKey()` to get the elements with the latest timestamp for each key in a `PCollection` of key-values.\n+\n+{{< highlight py >}}\n+{{< code_sample \"sdks/python/apache_beam/examples/snippets/transforms/aggregation/latest.py\" latest_per_key >}}\n+{{< /highlight >}}\n+\n+{{< paragraph class=\"notebook-skip\" >}}\n+Output:\n+{{< /paragraph >}}\n+\n+{{< highlight class=\"notebook-skip\" >}}\n+{{< code_sample \"sdks/python/apache_beam/examples/snippets/transforms/aggregation/latest_test.py\" latest_elements_per_key >}}\n+{{< /highlight >}}\n+\n+{{< buttons-code-snippet\n+  py=\"sdks/python/apache_beam/examples/snippets/transforms/aggregation/latest.py\" >}}\n \n ## Related transforms \n-* [Sample](/documentation/transforms/python/aggregation/sample) to combine elements. takes samples of the elements in a collection.\n\\ No newline at end of file\n+\n+* [Sample](/documentation/transforms/python/aggregation/sample) to combine elements. takes samples of the elements in a collection.", "originalCommit": "11ff60d4687a9eb3f094147629f1ecf81c4626f6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjQ1NzU0OQ==", "url": "https://github.com/apache/beam/pull/12394#discussion_r462457549", "bodyText": "Thanks for catching this, changing", "author": "davidcavazos", "createdAt": "2020-07-29T17:13:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk0NTQ2Mw=="}], "type": "inlineReview"}, {"oid": "4026ca030d15a4de13cc6179bcd661c4748c99a9", "url": "https://github.com/apache/beam/commit/4026ca030d15a4de13cc6179bcd661c4748c99a9", "message": "Updated related description", "committedDate": "2020-07-29T17:16:21Z", "type": "commit"}]}