{"pr_number": 12413, "pr_title": "[BEAM-10603] Add max count to utils.to_element_list", "pr_createdAt": "2020-07-29T18:03:11Z", "pr_url": "https://github.com/apache/beam/pull/12413", "timeline": [{"oid": "edec3fb90e43eaf1be0755a00d8ffbc3c127b124", "url": "https://github.com/apache/beam/commit/edec3fb90e43eaf1be0755a00d8ffbc3c127b124", "message": "Add max count to utils.to_element_list\n\nChange-Id: I9a2fbf1532b3d22a612e7a09f4f1fb2b9635c40b", "committedDate": "2020-08-04T22:10:14Z", "type": "forcePushed"}, {"oid": "ec897d3d24c4fb502cfb3691b5f344c87b01aa8a", "url": "https://github.com/apache/beam/commit/ec897d3d24c4fb502cfb3691b5f344c87b01aa8a", "message": "Add max count to utils.to_element_list\n\nChange-Id: I9a2fbf1532b3d22a612e7a09f4f1fb2b9635c40b", "committedDate": "2020-08-04T22:27:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY1NzIwMQ==", "url": "https://github.com/apache/beam/pull/12413#discussion_r466657201", "bodyText": "nit: this else is not necessary since the flow ends with continue.", "author": "davidyan74", "createdAt": "2020-08-06T20:07:10Z", "path": "sdks/python/apache_beam/runners/interactive/utils.py", "diffHunk": "@@ -27,30 +27,46 @@\n import pandas as pd\n \n from apache_beam.portability.api.beam_runner_api_pb2 import TestStreamPayload\n+from apache_beam.testing.test_stream import WindowedValueHolder\n \n \n def to_element_list(\n     reader,  # type: Generator[Union[TestStreamPayload.Event, WindowedValueHolder]]\n     coder,  # type: Coder\n-    include_window_info  # type: bool\n+    include_window_info,  # type: bool\n+    n=None  # type: int\n ):\n   # type: (...) -> List[WindowedValue]\n \n   \"\"\"Returns an iterator that properly decodes the elements from the reader.\n   \"\"\"\n \n-  for e in reader:\n-    if isinstance(e, TestStreamPayload.Event):\n-      if (e.HasField('watermark_event') or e.HasField('processing_time_event')):\n-        continue\n+  # Defining a generator like this makes it easier to limit the count of\n+  # elements read. Otherwise, the count limit would need to be duplicated.\n+  def elements():\n+    for e in reader:\n+      if isinstance(e, TestStreamPayload.Event):\n+        if (e.HasField('watermark_event') or\n+            e.HasField('processing_time_event')):\n+          continue\n+        else:", "originalCommit": "ec897d3d24c4fb502cfb3691b5f344c87b01aa8a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzI0NzE4Mg==", "url": "https://github.com/apache/beam/pull/12413#discussion_r467247182", "bodyText": "Done", "author": "rohdesamuel", "createdAt": "2020-08-07T20:11:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY1NzIwMQ=="}], "type": "inlineReview"}, {"oid": "19c8d6fed91ab35297355b7aad39c95c19b21f83", "url": "https://github.com/apache/beam/commit/19c8d6fed91ab35297355b7aad39c95c19b21f83", "message": "Add max count to utils.to_element_list\n\nChange-Id: I9a2fbf1532b3d22a612e7a09f4f1fb2b9635c40b", "committedDate": "2020-08-07T20:10:39Z", "type": "commit"}, {"oid": "19c8d6fed91ab35297355b7aad39c95c19b21f83", "url": "https://github.com/apache/beam/commit/19c8d6fed91ab35297355b7aad39c95c19b21f83", "message": "Add max count to utils.to_element_list\n\nChange-Id: I9a2fbf1532b3d22a612e7a09f4f1fb2b9635c40b", "committedDate": "2020-08-07T20:10:39Z", "type": "forcePushed"}]}