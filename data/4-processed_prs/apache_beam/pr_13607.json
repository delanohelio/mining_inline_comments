{"pr_number": 13607, "pr_title": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "pr_createdAt": "2020-12-23T10:15:43Z", "pr_url": "https://github.com/apache/beam/pull/13607", "timeline": [{"oid": "b7ef8192a09481a7800f661701969f44bb9516af", "url": "https://github.com/apache/beam/commit/b7ef8192a09481a7800f661701969f44bb9516af", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2020-12-23T21:33:53Z", "type": "forcePushed"}, {"oid": "784298a685f6cfe0a2ba7e62b309d5bc91ec22bc", "url": "https://github.com/apache/beam/commit/784298a685f6cfe0a2ba7e62b309d5bc91ec22bc", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2020-12-24T03:52:56Z", "type": "forcePushed"}, {"oid": "4625dd9551d371f9e95803383d37893693074fdb", "url": "https://github.com/apache/beam/commit/4625dd9551d371f9e95803383d37893693074fdb", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2020-12-24T08:29:44Z", "type": "forcePushed"}, {"oid": "33026fe48e650846c75f63c2f11047d9da9439c6", "url": "https://github.com/apache/beam/commit/33026fe48e650846c75f63c2f11047d9da9439c6", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2020-12-24T10:07:40Z", "type": "forcePushed"}, {"oid": "033478d4446dc1a04fc77b5c543dced7b61b0849", "url": "https://github.com/apache/beam/commit/033478d4446dc1a04fc77b5c543dced7b61b0849", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2020-12-25T00:28:18Z", "type": "forcePushed"}, {"oid": "0a0f7ed830246506c17c8f60fe42d798658c6d3f", "url": "https://github.com/apache/beam/commit/0a0f7ed830246506c17c8f60fe42d798658c6d3f", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2021-01-09T04:18:27Z", "type": "forcePushed"}, {"oid": "eaef31d19e9d3b99a85b49bcd594c91895d42106", "url": "https://github.com/apache/beam/commit/eaef31d19e9d3b99a85b49bcd594c91895d42106", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2021-02-04T09:45:54Z", "type": "forcePushed"}, {"oid": "06e06168643c6108ff44955ca3e8e3db56dc6469", "url": "https://github.com/apache/beam/commit/06e06168643c6108ff44955ca3e8e3db56dc6469", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2021-02-04T18:54:34Z", "type": "commit"}, {"oid": "06e06168643c6108ff44955ca3e8e3db56dc6469", "url": "https://github.com/apache/beam/commit/06e06168643c6108ff44955ca3e8e3db56dc6469", "message": "[BEAM-11520] Stage extra PyPI dependencies with generated requirements", "committedDate": "2021-02-04T18:54:34Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDExNjUzOQ==", "url": "https://github.com/apache/beam/pull/13607#discussion_r574116539", "bodyText": "Also fail for unknown type URNs ?", "author": "chamikaramj", "createdAt": "2021-02-10T22:16:13Z", "path": "sdks/python/apache_beam/runners/portability/stager.py", "diffHunk": "@@ -114,10 +117,48 @@ def get_sdk_package_name():\n         Returns the PyPI package name to be staged.\"\"\"\n     return names.BEAM_PACKAGE_NAME\n \n+  @staticmethod\n+  def _create_file_stage_to_artifact(local_path, staged_name):\n+    return beam_runner_api_pb2.ArtifactInformation(\n+        type_urn=common_urns.artifact_types.FILE.urn,\n+        type_payload=beam_runner_api_pb2.ArtifactFilePayload(\n+            path=local_path).SerializeToString(),\n+        role_urn=common_urns.artifact_roles.STAGING_TO.urn,\n+        role_payload=beam_runner_api_pb2.ArtifactStagingToRolePayload(\n+            staged_name=staged_name).SerializeToString())\n+\n+  @staticmethod\n+  def _create_file_pip_requirements_artifact(local_path):\n+    return beam_runner_api_pb2.ArtifactInformation(\n+        type_urn=common_urns.artifact_types.FILE.urn,\n+        type_payload=beam_runner_api_pb2.ArtifactFilePayload(\n+            path=local_path).SerializeToString(),\n+        role_urn=common_urns.artifact_roles.PIP_REQUIREMENTS_FILE.urn)\n+\n+  @staticmethod\n+  def extract_staging_tuple_iter(\n+      artifacts: List[beam_runner_api_pb2.ArtifactInformation]):\n+    for artifact in artifacts:\n+      if artifact.type_urn == common_urns.artifact_types.FILE.urn:", "originalCommit": "06e06168643c6108ff44955ca3e8e3db56dc6469", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTQ3NTM3Mw==", "url": "https://github.com/apache/beam/pull/13607#discussion_r575475373", "bodyText": "Done.", "author": "ihji", "createdAt": "2021-02-12T19:34:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDExNjUzOQ=="}], "type": "inlineReview"}, {"oid": "0397c5158b0d291ef4dcdce74c11630bc8b72ee8", "url": "https://github.com/apache/beam/commit/0397c5158b0d291ef4dcdce74c11630bc8b72ee8", "message": "raise exception for non-file type artifacts", "committedDate": "2021-02-12T19:33:11Z", "type": "commit"}]}