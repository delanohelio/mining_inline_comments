{"pr_number": 11936, "pr_title": "[BEAM-9679] Add CombinePerKey to Core Transforms Go Katas", "pr_createdAt": "2020-06-05T18:22:18Z", "pr_url": "https://github.com/apache/beam/pull/11936", "timeline": [{"oid": "a6ab9eb0f77ff69ff6647ff8c1cb1f1302995410", "url": "https://github.com/apache/beam/commit/a6ab9eb0f77ff69ff6647ff8c1cb1f1302995410", "message": "Add CombinePerKey to Core Transforms Go Katas", "committedDate": "2020-06-05T18:17:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAxNDczOA==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437014738", "bodyText": "Space between Per and Key please. \"PerKey\" isn't anything at all, but we're describing that we're combining values per key. here and throughout.", "author": "lostluck", "createdAt": "2020-06-08T21:35:07Z", "path": "learning/katas/go/Core Transforms/Combine/Combine PerKey/task.md", "diffHunk": "@@ -0,0 +1,47 @@\n+<!--\n+  ~  Licensed to the Apache Software Foundation (ASF) under one\n+  ~  or more contributor license agreements.  See the NOTICE file\n+  ~  distributed with this work for additional information\n+  ~  regarding copyright ownership.  The ASF licenses this file\n+  ~  to you under the Apache License, Version 2.0 (the\n+  ~  \"License\"); you may not use this file except in compliance\n+  ~  with the License.  You may obtain a copy of the License at\n+  ~\n+  ~      http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~  Unless required by applicable law or agreed to in writing, software\n+  ~  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~  See the License for the specific language governing permissions and\n+  ~  limitations under the License.\n+  -->\n+\n+# Combine - Combine PerKey", "originalCommit": "a6ab9eb0f77ff69ff6647ff8c1cb1f1302995410", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA1NDcwMQ==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437054701", "bodyText": "It's this way in both the Java and Python task descriptions.  I don't mind deviating so perhaps just \"Combine per key\" as the header?", "author": "damondouglas", "createdAt": "2020-06-08T23:25:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAxNDczOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4NzIyOA==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437487228", "bodyText": "The Combine PerKey is taken from the Java SDK and the Beam programming guide. Maybe for Go we can use CombinePerKey as per the SDK?", "author": "henryken", "createdAt": "2020-06-09T14:54:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAxNDczOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyNjM5NQ==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437026395", "bodyText": "There are no \"subclasses\" in Go.", "author": "lostluck", "createdAt": "2020-06-08T22:03:03Z", "path": "learning/katas/go/Core Transforms/Combine/Combine PerKey/task.md", "diffHunk": "@@ -0,0 +1,47 @@\n+<!--\n+  ~  Licensed to the Apache Software Foundation (ASF) under one\n+  ~  or more contributor license agreements.  See the NOTICE file\n+  ~  distributed with this work for additional information\n+  ~  regarding copyright ownership.  The ASF licenses this file\n+  ~  to you under the Apache License, Version 2.0 (the\n+  ~  \"License\"); you may not use this file except in compliance\n+  ~  with the License.  You may obtain a copy of the License at\n+  ~\n+  ~      http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~  Unless required by applicable law or agreed to in writing, software\n+  ~  distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~  See the License for the specific language governing permissions and\n+  ~  limitations under the License.\n+  -->\n+\n+# Combine - Combine PerKey\n+\n+After creating a keyed PCollection (for example, by using a GroupByKey transform), a common pattern \n+is to combine the collection of values associated with each key into a single, merged value. This \n+pattern of a GroupByKey followed by merging the collection of values is equivalent to Combine \n+PerKey transform. The combine function you supply to Combine PerKey must be an associative \n+reduction function or a subclass of CombineFn.", "originalCommit": "a6ab9eb0f77ff69ff6647ff8c1cb1f1302995410", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzA1NjAyOQ==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437056029", "bodyText": "Apologies, I missed that.  Would it be clear if we just remove \"or a subclass of CombineFn\" such that the full sentence reads:  \"The combine function you supply to beam.CombinePerKey must be an associative reduction function\"?", "author": "damondouglas", "createdAt": "2020-06-08T23:30:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyNjM5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4OTYzMQ==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437489631", "bodyText": "I took most of the task descriptions from the Beam programming guide. This kind of revision would be a good start to be adopted for the actual Go guide.", "author": "henryken", "createdAt": "2020-06-09T14:57:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzAyNjM5NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ5MjcxMg==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437492712", "bodyText": "Would score1, score2 be better than left, right?", "author": "henryken", "createdAt": "2020-06-09T15:01:11Z", "path": "learning/katas/go/Core Transforms/Combine/Combine PerKey/pkg/task/task.go", "diffHunk": "@@ -0,0 +1,30 @@\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//    http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package task\n+\n+import \"github.com/apache/beam/sdks/go/pkg/beam\"\n+\n+const (\n+\tPlayer1 = \"Player 1\"\n+\tPlayer2 = \"Player 2\"\n+\tPlayer3 = \"Player 3\"\n+)\n+\n+func ApplyTransform(s beam.Scope, input beam.PCollection) beam.PCollection {\n+\treturn beam.CombinePerKey(s, func(left, right int) int {", "originalCommit": "a6ab9eb0f77ff69ff6647ff8c1cb1f1302995410", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ5MzU3Ng==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437493576", "bodyText": "I'm not familiar with the Go SDK.\nIs this not possible by using a simple beam.Create?", "author": "henryken", "createdAt": "2020-06-09T15:02:20Z", "path": "learning/katas/go/Core Transforms/Combine/Combine PerKey/cmd/main.go", "diffHunk": "@@ -0,0 +1,49 @@\n+// Licensed to the Apache Software Foundation (ASF) under one or more\n+// contributor license agreements.  See the NOTICE file distributed with\n+// this work for additional information regarding copyright ownership.\n+// The ASF licenses this file to You under the Apache License, Version 2.0\n+// (the \"License\"); you may not use this file except in compliance with\n+// the License.  You may obtain a copy of the License at\n+//\n+//    http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package main\n+\n+import (\n+\t\"combine_perkey/pkg/task\"\n+\t\"context\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/log\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/x/beamx\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/x/debug\"\n+)\n+\n+func main() {\n+\tctx := context.Background()\n+\n+\tp, s := beam.NewPipelineWithRoot()\n+\n+\tinput := beam.ParDo(s, func(_ []byte, emit func(string, int)){", "originalCommit": "a6ab9eb0f77ff69ff6647ff8c1cb1f1302995410", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzUxOTMxNA==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437519314", "bodyText": "KV's can't be created directly in the Go SDK at this time.  They need to be emitted from a DoFn like this.", "author": "lostluck", "createdAt": "2020-06-09T15:25:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ5MzU3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzUyNTQxMA==", "url": "https://github.com/apache/beam/pull/11936#discussion_r437525410", "bodyText": "Noted. Thanks.", "author": "henryken", "createdAt": "2020-06-09T15:33:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ5MzU3Ng=="}], "type": "inlineReview"}, {"oid": "0963724086828f3dc1bc55792a0f08ace41f95b0", "url": "https://github.com/apache/beam/commit/0963724086828f3dc1bc55792a0f08ace41f95b0", "message": "Edit task description wording", "committedDate": "2020-06-09T19:34:21Z", "type": "commit"}, {"oid": "03f2ff052eb24c4774702dfbb49eff2d0c9b72c0", "url": "https://github.com/apache/beam/commit/03f2ff052eb24c4774702dfbb49eff2d0c9b72c0", "message": "Update stepik course files", "committedDate": "2020-06-10T21:21:53Z", "type": "commit"}]}