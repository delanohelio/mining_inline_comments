{"pr_number": 10593, "pr_title": "[BEAM-7746] Add typing for try_split", "pr_createdAt": "2020-01-15T00:12:38Z", "pr_url": "https://github.com/apache/beam/pull/10593", "timeline": [{"oid": "f5b7754722cd7a50296bcbdd19d1e3471698a606", "url": "https://github.com/apache/beam/commit/f5b7754722cd7a50296bcbdd19d1e3471698a606", "message": "[BEAM-7746] Add typing for try_split", "committedDate": "2020-01-15T00:24:10Z", "type": "forcePushed"}, {"oid": "cafbbf518affbc0b0f7a5c9064099dc96edf7051", "url": "https://github.com/apache/beam/commit/cafbbf518affbc0b0f7a5c9064099dc96edf7051", "message": "[BEAM-7746] Add typing for try_split", "committedDate": "2020-01-15T01:39:40Z", "type": "forcePushed"}, {"oid": "6abebd91acd26fdb377ae3fd6d1e80ee102d1559", "url": "https://github.com/apache/beam/commit/6abebd91acd26fdb377ae3fd6d1e80ee102d1559", "message": "[BEAM-7746] Add typing for try_split", "committedDate": "2020-01-15T17:49:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3NDI1OQ==", "url": "https://github.com/apache/beam/pull/10593#discussion_r367174259", "bodyText": "Feels like it's time to make a named tuple here...", "author": "robertwb", "createdAt": "2020-01-16T00:18:47Z", "path": "sdks/python/apache_beam/runners/common.py", "diffHunk": "@@ -61,6 +61,9 @@\n   from apache_beam.transforms import sideinputs\n   from apache_beam.transforms.core import TimerSpec\n \n+SplitResultType = Tuple[", "originalCommit": "6abebd91acd26fdb377ae3fd6d1e80ee102d1559", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE4NTU0Mw==", "url": "https://github.com/apache/beam/pull/10593#discussion_r367185543", "bodyText": "I agree it would help a bit.  I searched around for places where we access individual elements of this tuple, and there aren't many cases. Here's the one I found:\n  def bundle_application(self,\n                         op,  # type: operations.DoOperation\n                         primary  # type: common.SplitResultType\n                        ):\n    ((element_and_restriction, output_watermark),\n     _) = primary\n    return self.construct_bundle_application(\n        op, output_watermark, element_and_restriction)\nWhat name would you give to each item?\nSplitResult = NamedTuple(\n    'SplitResult', [\n        ('???', Tuple[WindowedValue, Optional[Timestamp]]), \n        ('???', Optional[Timestamp])\n    ])", "author": "chadrik", "createdAt": "2020-01-16T01:04:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3NDI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg0NDEyNA==", "url": "https://github.com/apache/beam/pull/10593#discussion_r369844124", "bodyText": "Maybe WatermarkedElement and CallbackTimestamp? Talking to @boyuanzz this code is actively being developed, so it might make sense to hold off a bit. In particular, the splits are not entirely symmetric (e.g. a primary only ever has the WindowedValue, while the Residual is more properly a Tuple[WindowedValue, Optiona[Timestamp], Optional[Timestamp]].", "author": "robertwb", "createdAt": "2020-01-22T22:38:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3NDI1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3NjAyMQ==", "url": "https://github.com/apache/beam/pull/10593#discussion_r367176021", "bodyText": "Some named tuples, or even a named type, could help for Optional[Tuple[operations.DoOperation, common.SplitResultType]]", "author": "robertwb", "createdAt": "2020-01-16T00:25:27Z", "path": "sdks/python/apache_beam/runners/worker/bundle_processor.py", "diffHunk": "@@ -205,16 +205,17 @@ def process_encoded(self, encoded_windowed_values):\n       self.output(decoded_value)\n \n   def try_split(self, fraction_of_remainder, total_buffer_size):\n+    # type: (...) -> Optional[Tuple[int, Optional[Tuple[operations.DoOperation, common.SplitResultType]], Optional[Tuple[operations.DoOperation, common.SplitResultType]], int]]", "originalCommit": "6abebd91acd26fdb377ae3fd6d1e80ee102d1559", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "892d2d28ebeac5c21d255179336a4fbba3cfbcc0", "url": "https://github.com/apache/beam/commit/892d2d28ebeac5c21d255179336a4fbba3cfbcc0", "message": "[BEAM-7746] Add typing for try_split", "committedDate": "2020-01-17T03:59:15Z", "type": "forcePushed"}, {"oid": "60e60b2906e1cc336757040c15490b9b014ab850", "url": "https://github.com/apache/beam/commit/60e60b2906e1cc336757040c15490b9b014ab850", "message": "[BEAM-7746] Add typing for try_split", "committedDate": "2020-02-06T19:51:55Z", "type": "forcePushed"}, {"oid": "a2451d437d4357e40c204d863fb74b159df910de", "url": "https://github.com/apache/beam/commit/a2451d437d4357e40c204d863fb74b159df910de", "message": "[BEAM-7746] Add typing for try_split", "committedDate": "2020-02-07T00:19:46Z", "type": "commit"}, {"oid": "a2451d437d4357e40c204d863fb74b159df910de", "url": "https://github.com/apache/beam/commit/a2451d437d4357e40c204d863fb74b159df910de", "message": "[BEAM-7746] Add typing for try_split", "committedDate": "2020-02-07T00:19:46Z", "type": "forcePushed"}]}