{"pr_number": 12527, "pr_title": "[BEAM-10672] Added Python Combine load tests for streaming on Dataflow", "pr_createdAt": "2020-08-11T08:09:12Z", "pr_url": "https://github.com/apache/beam/pull/12527", "timeline": [{"oid": "3843e2790feac707a678bba2bae3d8ac28822406", "url": "https://github.com/apache/beam/commit/3843e2790feac707a678bba2bae3d8ac28822406", "message": "[BEAM-10672] Added streaming option to combine test", "committedDate": "2020-08-11T08:06:58Z", "type": "commit"}, {"oid": "7ecc60c0adbea3168b223c3aa0b0c31d91eb48cc", "url": "https://github.com/apache/beam/commit/7ecc60c0adbea3168b223c3aa0b0c31d91eb48cc", "message": "[BEAM-10672] Added experimental dataflow param", "committedDate": "2020-08-11T08:07:08Z", "type": "commit"}, {"oid": "64b95e97643bb6a8b62d2e582f321b2fbd22e067", "url": "https://github.com/apache/beam/commit/64b95e97643bb6a8b62d2e582f321b2fbd22e067", "message": "[BEAM-10672] Spottless Apply", "committedDate": "2020-08-11T08:13:57Z", "type": "commit"}, {"oid": "2d04acabb83cf37ce348cdeee864b5301df4e0d5", "url": "https://github.com/apache/beam/commit/2d04acabb83cf37ce348cdeee864b5301df4e0d5", "message": "[BEAM-10672] Updated streaming commands", "committedDate": "2020-08-11T08:17:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY3MTM2MA==", "url": "https://github.com/apache/beam/pull/12527#discussion_r468671360", "bodyText": "Could you add a space before and after \"!=\" operator? That should make it look a little bit prettier.", "author": "kamilwu", "createdAt": "2020-08-11T15:30:34Z", "path": ".test-infra/jenkins/job_LoadTests_Combine_Python.groovy", "diffHunk": "@@ -93,15 +93,23 @@ def loadTestConfigurations = { datasetName ->\n         top_count            : 20,\n       ]\n     ],\n-  ].each { test -> test.pipelineOptions.putAll(additionalPipelineArgs) }\n+  ]\n+  .each { test -> test.pipelineOptions.putAll(additionalPipelineArgs) }\n+  .each{ test -> (jobType!='streaming') ?: addStreamingOptions(test) }", "originalCommit": "2d04acabb83cf37ce348cdeee864b5301df4e0d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcyNTI2NA==", "url": "https://github.com/apache/beam/pull/12527#discussion_r468725264", "bodyText": "Sure, thanks :)", "author": "kkucharc", "createdAt": "2020-08-11T16:53:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY3MTM2MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY3MjAyMg==", "url": "https://github.com/apache/beam/pull/12527#discussion_r468672022", "bodyText": "Please add a newline at end of file", "author": "kamilwu", "createdAt": "2020-08-11T15:31:35Z", "path": ".test-infra/jenkins/job_LoadTests_Combine_Python.groovy", "diffHunk": "@@ -113,13 +121,31 @@ PhraseTriggeringPostCommitBuilder.postCommitJob(\n     this\n     ) {\n       additionalPipelineArgs = [:]\n-      batchLoadTestJob(delegate, CommonTestProperties.TriggeringContext.PR)\n+      loadTestJob(delegate, CommonTestProperties.TriggeringContext.PR, \"batch\")\n     }\n \n CronJobBuilder.cronJob('beam_LoadTests_Python_Combine_Dataflow_Batch', 'H 15 * * *', this) {\n   additionalPipelineArgs = [\n     influx_db_name: InfluxDBCredentialsHelper.InfluxDBDatabaseName,\n     influx_hostname: InfluxDBCredentialsHelper.InfluxDBHostname,\n   ]\n-  batchLoadTestJob(delegate, CommonTestProperties.TriggeringContext.POST_COMMIT)\n+  loadTestJob(delegate, CommonTestProperties.TriggeringContext.POST_COMMIT, \"batch\")\n }\n+\n+PhraseTriggeringPostCommitBuilder.postCommitJob(\n+    'beam_LoadTests_Python_Combine_Dataflow_Streaming',\n+    'Run Python Load Tests Combine Dataflow Streaming',\n+    'Load Tests Python Combine Dataflow Streaming suite',\n+    this\n+    ) {\n+      additionalPipelineArgs = [:]\n+      loadTestJob(delegate, CommonTestProperties.TriggeringContext.PR, \"streaming\")\n+    }\n+\n+CronJobBuilder.cronJob('beam_LoadTests_Python_Combine_Dataflow_Streaming', 'H 15 * * *', this) {\n+  additionalPipelineArgs = [\n+    influx_db_name: InfluxDBCredentialsHelper.InfluxDBDatabaseName,\n+    influx_hostname: InfluxDBCredentialsHelper.InfluxDBHostname,\n+  ]\n+  loadTestJob(delegate, CommonTestProperties.TriggeringContext.POST_COMMIT, \"streaming\")\n+}", "originalCommit": "2d04acabb83cf37ce348cdeee864b5301df4e0d5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcyNTM4Mg==", "url": "https://github.com/apache/beam/pull/12527#discussion_r468725382", "bodyText": "Sure, thanks a lot :)", "author": "kkucharc", "createdAt": "2020-08-11T16:53:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY3MjAyMg=="}], "type": "inlineReview"}, {"oid": "505edf554ba4f8a7d54c8766bb1d60cfe059e39e", "url": "https://github.com/apache/beam/commit/505edf554ba4f8a7d54c8766bb1d60cfe059e39e", "message": "[BEAM-10672] Fixes after review in combine python load test", "committedDate": "2020-08-13T15:05:44Z", "type": "commit"}, {"oid": "504c6b7ebcba7152a7e5f1df1132828d2019461b", "url": "https://github.com/apache/beam/commit/504c6b7ebcba7152a7e5f1df1132828d2019461b", "message": "[BEAM-10672] Changed jobType variable into mode to declare if it is streaming or batch job", "committedDate": "2020-08-17T09:49:49Z", "type": "commit"}]}