{"pr_number": 10908, "pr_title": "[BEAM-9339] Declare capabilities for Python SDK.", "pr_createdAt": "2020-02-20T00:22:52Z", "pr_url": "https://github.com/apache/beam/pull/10908", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTY4ODE1NA==", "url": "https://github.com/apache/beam/pull/10908#discussion_r381688154", "bodyText": "nit: should we add a reference to clarify what old/new metrics are ?", "author": "chamikaramj", "createdAt": "2020-02-20T02:43:10Z", "path": "model/pipeline/src/main/proto/beam_runner_api.proto", "diffHunk": "@@ -1209,6 +1209,30 @@ message ExternalPayload {\n   map<string, string> params = 2;  // Arbitrary extra parameters to pass\n }\n \n+// These URNs are used to indicate capabilities of environments that cannot\n+// simply be expressed as a component (such as a Coder or PTransform) that this\n+// environment understands.\n+message StandardProtocols {\n+  enum Enum {\n+    // Indicates suport for progress reporting via the legacy metric APIs.\n+    LEGACY_PROGRESS_REPORTING = 0 [(beam_urn) = \"beam:protocol:progress_reporting:v0\"];\n+\n+    // Indicates suport for progress reporting via the new metric APIs.", "originalCommit": "06f4de4201fc4fde3c8d8f94329b12dbb5e5e3b9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjIxMDcyMA==", "url": "https://github.com/apache/beam/pull/10908#discussion_r382210720", "bodyText": "Good point. Done.", "author": "robertwb", "createdAt": "2020-02-20T19:28:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTY4ODE1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTY5MDM1MQ==", "url": "https://github.com/apache/beam/pull/10908#discussion_r381690351", "bodyText": "Probably test for every expected capability here ? And also force failure if the test has not been updated to reflect a new capability ?\nThe test can be updated as the list of capabilities are updated.", "author": "chamikaramj", "createdAt": "2020-02-20T02:47:28Z", "path": "sdks/python/apache_beam/transforms/environments_test.py", "diffHunk": "@@ -53,10 +63,14 @@ def test_environment_encoding(self):\n                             state_cache_size=0, data_buffer_time_limit_ms=0),\n                         SubprocessSDKEnvironment(command_string=u'fo\u00f6')):\n       context = pipeline_context.PipelineContext()\n-      self.assertEqual(\n-          environment,\n-          Environment.from_runner_api(\n-              environment.to_runner_api(context), context))\n+      proto = environment.to_runner_api(context)\n+      reconstructed = Environment.from_runner_api(proto, context)\n+      self.assertEqual(environment, reconstructed)\n+      self.assertEqual(proto, reconstructed.to_runner_api(context))\n+\n+  def test_sdk_capabilities(self):\n+    sdk_capabilities = environments.python_sdk_capabilities()\n+    self.assertIn(common_urns.coders.LENGTH_PREFIX.urn, sdk_capabilities)", "originalCommit": "06f4de4201fc4fde3c8d8f94329b12dbb5e5e3b9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "71e2d5d38c7f8b2c44fdf8980f6ce9a3e21db32a", "url": "https://github.com/apache/beam/commit/71e2d5d38c7f8b2c44fdf8980f6ce9a3e21db32a", "message": "Add standard protocol capabilities to protos.", "committedDate": "2020-02-20T19:28:45Z", "type": "commit"}, {"oid": "130867167e9447cf8ee9481fe155d93acdd1a74b", "url": "https://github.com/apache/beam/commit/130867167e9447cf8ee9481fe155d93acdd1a74b", "message": "[BEAM-9339] Declare capabilities for Python SDK.", "committedDate": "2020-02-20T19:28:45Z", "type": "forcePushed"}, {"oid": "783dfc6fe06fd521c85f17668923b514233393ca", "url": "https://github.com/apache/beam/commit/783dfc6fe06fd521c85f17668923b514233393ca", "message": "[BEAM-9339] Declare capabilities for Python SDK.", "committedDate": "2020-02-21T18:05:13Z", "type": "forcePushed"}, {"oid": "4be0a857acb43e1e8cfc7ea348e6fc3ca225ea13", "url": "https://github.com/apache/beam/commit/4be0a857acb43e1e8cfc7ea348e6fc3ca225ea13", "message": "[BEAM-9339] Declare capabilities for Python SDK.", "committedDate": "2020-02-21T20:58:22Z", "type": "commit"}, {"oid": "4be0a857acb43e1e8cfc7ea348e6fc3ca225ea13", "url": "https://github.com/apache/beam/commit/4be0a857acb43e1e8cfc7ea348e6fc3ca225ea13", "message": "[BEAM-9339] Declare capabilities for Python SDK.", "committedDate": "2020-02-21T20:58:22Z", "type": "forcePushed"}]}