{"pr_number": 13073, "pr_title": "[BEAM-11055] Update log4j to version 2.14.1", "pr_createdAt": "2020-10-12T07:31:02Z", "pr_url": "https://github.com/apache/beam/pull/13073", "timeline": [{"oid": "3f385bddf5ecd04f8b2eb97746ee53843cf6c3cc", "url": "https://github.com/apache/beam/commit/3f385bddf5ecd04f8b2eb97746ee53843cf6c3cc", "message": "[BEAM-11055] Update log4j to version 2.13.3", "committedDate": "2020-10-12T08:38:20Z", "type": "forcePushed"}, {"oid": "241631090470271e2a75c9e46bf806d265983117", "url": "https://github.com/apache/beam/commit/241631090470271e2a75c9e46bf806d265983117", "message": "[BEAM-11055] Update log4j to version 2.13.3", "committedDate": "2020-10-13T19:04:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE5MjEzMA==", "url": "https://github.com/apache/beam/pull/13073#discussion_r504192130", "bodyText": "This one and the next one are only sorting stuff to make it more easy to find the refs.", "author": "iemejia", "createdAt": "2020-10-13T19:07:40Z", "path": "buildSrc/src/main/groovy/org/apache/beam/gradle/GrpcVendoring_1_26_0.groovy", "diffHunk": "@@ -23,53 +23,54 @@ package org.apache.beam.gradle\n  */\n class GrpcVendoring_1_26_0 {\n \n-  static def guava_version = \"26.0-jre\"", "originalCommit": "241631090470271e2a75c9e46bf806d265983117", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE5Mjc5NQ==", "url": "https://github.com/apache/beam/pull/13073#discussion_r504192795", "bodyText": "Notice that vendored grpc dependencies can have different versions so they don't depend on Beam main module file, so versions are defined independently.", "author": "iemejia", "createdAt": "2020-10-13T19:08:52Z", "path": "buildSrc/src/main/groovy/org/apache/beam/gradle/GrpcVendoring_1_26_0.groovy", "diffHunk": "@@ -23,53 +23,54 @@ package org.apache.beam.gradle\n  */\n class GrpcVendoring_1_26_0 {\n \n-  static def guava_version = \"26.0-jre\"\n-  static def protobuf_version = \"3.11.0\"\n+  static def alpn_api_version = \"1.1.2.v20150522\"\n+  static def bouncycastle_version = \"1.54\"\n+  static def compress_lzf_version = \"1.0.3\"\n+  static def conscrypt_version = \"1.3.0\"\n+  static def google_auth_version = \"0.18.0\"\n   static def grpc_version = \"1.26.0\"\n   static def gson_version = \"2.8.6\"\n+  static def guava_version = \"26.0-jre\"\n+  static def jboss_marshalling_version = \"1.4.11.Final\"\n+  static def jboss_modules_version = \"1.1.0.Beta1\"\n+  static def jzlib_version = \"1.1.3\"\n+  static def log4j_version = \"2.13.3\"", "originalCommit": "241631090470271e2a75c9e46bf806d265983117", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "88baac36e66fa162b35a8f1f640fe192aceed435", "url": "https://github.com/apache/beam/commit/88baac36e66fa162b35a8f1f640fe192aceed435", "message": "[BEAM-11055] Update log4j to version 2.13.3", "committedDate": "2020-10-13T19:11:52Z", "type": "forcePushed"}, {"oid": "c46bed5c842f1158b433106962fa022f7d721870", "url": "https://github.com/apache/beam/commit/c46bed5c842f1158b433106962fa022f7d721870", "message": "[BEAM-11055] Update log4j to version 2.13.3", "committedDate": "2020-10-14T08:17:06Z", "type": "forcePushed"}, {"oid": "342b7e9ac26c36fc5a8146e9f6c6ee193a123204", "url": "https://github.com/apache/beam/commit/342b7e9ac26c36fc5a8146e9f6c6ee193a123204", "message": "[BEAM-11055] Update log4j to version 2.13.3", "committedDate": "2020-10-14T13:08:38Z", "type": "forcePushed"}, {"oid": "b62612d7b6a6785dcafed522d2dcf35942b2250e", "url": "https://github.com/apache/beam/commit/b62612d7b6a6785dcafed522d2dcf35942b2250e", "message": "[BEAM-11055] Update log4j to version 2.13.3", "committedDate": "2020-10-19T09:07:41Z", "type": "forcePushed"}, {"oid": "d0c620eee5e5f39033237d3ba7d1cfee98a91835", "url": "https://github.com/apache/beam/commit/d0c620eee5e5f39033237d3ba7d1cfee98a91835", "message": "[BEAM-11055] Update log4j to version 2.13.3", "committedDate": "2020-11-04T15:48:08Z", "type": "forcePushed"}, {"oid": "512c4320f22e8212df2099737e5ddc721d3dae6f", "url": "https://github.com/apache/beam/commit/512c4320f22e8212df2099737e5ddc721d3dae6f", "message": "[BEAM-11055] Update log4j to version 2.13.3", "committedDate": "2020-11-10T09:22:12Z", "type": "forcePushed"}, {"oid": "c65b034ea8cb26f724a78ba43f80191485ad2ed8", "url": "https://github.com/apache/beam/commit/c65b034ea8cb26f724a78ba43f80191485ad2ed8", "message": "[BEAM-11055] Update log4j to version 2.14.0", "committedDate": "2020-11-12T14:35:13Z", "type": "forcePushed"}, {"oid": "25df3a2d4a653fb001741dfec682dfe0b0ad1d88", "url": "https://github.com/apache/beam/commit/25df3a2d4a653fb001741dfec682dfe0b0ad1d88", "message": "[BEAM-11055] Update log4j to version 2.14.1", "committedDate": "2021-04-27T09:41:42Z", "type": "forcePushed"}, {"oid": "195809057c643fb3d6de0b764da42596e7b6ac4c", "url": "https://github.com/apache/beam/commit/195809057c643fb3d6de0b764da42596e7b6ac4c", "message": "[BEAM-11055] Update log4j to version 2.14.1", "committedDate": "2021-04-27T12:36:33Z", "type": "forcePushed"}, {"oid": "5f829185676cb7765b8df86161aae046feb197e2", "url": "https://github.com/apache/beam/commit/5f829185676cb7765b8df86161aae046feb197e2", "message": "[BEAM-11055] Update log4j to version 2.14.1", "committedDate": "2021-04-27T16:53:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTQxOTkwOQ==", "url": "https://github.com/apache/beam/pull/13073#discussion_r621419909", "bodyText": "Somehow I had to redefine this here to make it work, bad to have this repeated but it is the only workaround I could find.", "author": "iemejia", "createdAt": "2021-04-27T17:04:42Z", "path": "sdks/java/io/hcatalog/build.gradle", "diffHunk": "@@ -41,6 +41,17 @@ test {\n   ignoreFailures true\n }\n \n+configurations.testRuntimeClasspath {\n+  resolutionStrategy {\n+    def log4j_version = \"2.4.1\"", "originalCommit": "5f829185676cb7765b8df86161aae046feb197e2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNzcyNDI0MA==", "url": "https://github.com/apache/beam/pull/13073#discussion_r627724240", "bodyText": "Should this be 2.14.1 ?", "author": "aaltay", "createdAt": "2021-05-06T19:57:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTQxOTkwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNzk4NjQ3NQ==", "url": "https://github.com/apache/beam/pull/13073#discussion_r627986475", "bodyText": "Arghh what a silly mistake, my excuses I opened #14751 to upgrade this dep to the minimum compatible version with Hive dependencies, wondering if we should also cherry-pick it for the release. Thanks for noticing @aaltay !", "author": "iemejia", "createdAt": "2021-05-07T07:23:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTQxOTkwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNzk5MTU0Mg==", "url": "https://github.com/apache/beam/pull/13073#discussion_r627991542", "bodyText": "It is a pity we cannot move to the latest log4j version because of Hive's HCatalog dependency constraints. The bad part is that this will still trigger security analysis tools warnings, but I have no idea of how to workaround this apart of doing a full upgrade of  Hive to the latest but that does not seem to be so simple either, for ref BEAM-9351.", "author": "iemejia", "createdAt": "2021-05-07T07:32:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTQxOTkwOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODU5OTA2Mw==", "url": "https://github.com/apache/beam/pull/13073#discussion_r628599063", "bodyText": "Thank you @iemejia. I do not have an opinion about cherry picking to the release or not. If it helps, I am not aware of any user issues or bug reports. I noticed this coincidentally.", "author": "aaltay", "createdAt": "2021-05-07T23:07:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMTQxOTkwOQ=="}], "type": "inlineReview"}, {"oid": "8a24eb8f3c65299a3f0dfb1bfa4a055ddc8dda5c", "url": "https://github.com/apache/beam/commit/8a24eb8f3c65299a3f0dfb1bfa4a055ddc8dda5c", "message": "[BEAM-11055] Update log4j to version 2.14.1", "committedDate": "2021-04-28T07:13:28Z", "type": "commit"}, {"oid": "8a24eb8f3c65299a3f0dfb1bfa4a055ddc8dda5c", "url": "https://github.com/apache/beam/commit/8a24eb8f3c65299a3f0dfb1bfa4a055ddc8dda5c", "message": "[BEAM-11055] Update log4j to version 2.14.1", "committedDate": "2021-04-28T07:13:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyOTY3NzgwOA==", "url": "https://github.com/apache/beam/pull/13073#discussion_r629677808", "bodyText": "I think this is no longer necessary with the change to library in BeamModulePlugin.groovy. applyJavaNature does this for all dependencies in library: \n  \n    \n      beam/buildSrc/src/main/groovy/org/apache/beam/gradle/BeamModulePlugin.groovy\n    \n    \n        Lines 1537 to 1544\n      in\n      3c9807b\n    \n    \n    \n    \n\n        \n          \n           if (config.getName() != \"errorprone\" && !inDependencyUpdates) { \n        \n\n        \n          \n             config.resolutionStrategy { \n        \n\n        \n          \n               // Filtering versionless coordinates that depend on BOM. Beam project needs to set the \n        \n\n        \n          \n               // versions for only handful libraries when building the project (BEAM-9542). \n        \n\n        \n          \n               def librariesWithVersion = project.library.java.values().findAll { it.split(':').size() > 2 } \n        \n\n        \n          \n               force librariesWithVersion \n        \n\n        \n          \n             } \n        \n\n        \n          \n           }", "author": "TheNeuralBit", "createdAt": "2021-05-10T20:56:13Z", "path": "sdks/java/io/elasticsearch-tests/elasticsearch-tests-5/build.gradle", "diffHunk": "@@ -32,15 +32,14 @@ test {\n   systemProperty \"tests.security.manager\", \"false\"\n }\n \n-def log4j_version = \"2.6.2\"\n def elastic_search_version = \"5.6.3\"\n \n configurations.all {\n   resolutionStrategy {\n     // Make sure the log4j versions for api and core match instead of taking the default\n     // Gradle rule of using the latest.\n-    force \"org.apache.logging.log4j:log4j-api:$log4j_version\"\n-    force \"org.apache.logging.log4j:log4j-core:$log4j_version\"\n+    force library.java.log4j_api\n+    force library.java.log4j_core", "originalCommit": "8a24eb8f3c65299a3f0dfb1bfa4a055ddc8dda5c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}