{"pr_number": 12676, "pr_title": "set_index is not index preserving", "pr_createdAt": "2020-08-24T23:46:47Z", "pr_url": "https://github.com/apache/beam/pull/12676", "timeline": [{"oid": "cb0c06bc676ff207030a1e48294b726774844727", "url": "https://github.com/apache/beam/commit/cb0c06bc676ff207030a1e48294b726774844727", "message": "set_index is not index preserving", "committedDate": "2020-08-22T18:27:26Z", "type": "commit"}, {"oid": "3deba24d690d8910a30b76f4d8281fd268d18528", "url": "https://github.com/apache/beam/commit/3deba24d690d8910a30b76f4d8281fd268d18528", "message": "test", "committedDate": "2020-08-24T23:44:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTk3MzM1NA==", "url": "https://github.com/apache/beam/pull/12676#discussion_r475973354", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      'aggregate',\n          \n          \n            \n                      'set_index',", "author": "TheNeuralBit", "createdAt": "2020-08-24T23:50:06Z", "path": "sdks/python/apache_beam/dataframe/frames.py", "diffHunk": "@@ -261,15 +261,21 @@ def __setitem__(self, key, value):\n     else:\n       raise NotImplementedError(key)\n \n+  @frame_base.args_to_kwargs(pd.DataFrame)\n+  @frame_base.populate_defaults(pd.DataFrame)\n+  @frame_base.maybe_inplace\n   def set_index(self, keys, **kwargs):\n     if isinstance(keys, str):\n       keys = [keys]\n     if not set(keys).issubset(self._expr.proxy().columns):\n       raise NotImplementedError(keys)\n-    return self._elementwise(\n-        lambda df: df.set_index(keys, **kwargs),\n-        'set_index',\n-        inplace=kwargs.get('inplace', False))\n+    return frame_base.DeferredFrame.wrap(\n+      expressions.ComputedExpression(\n+          'aggregate',", "originalCommit": "3deba24d690d8910a30b76f4d8281fd268d18528", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cd8d8f264e1967430b0f24b60acb4bc9e1827bf2", "url": "https://github.com/apache/beam/commit/cd8d8f264e1967430b0f24b60acb4bc9e1827bf2", "message": "yapf", "committedDate": "2020-08-25T19:13:22Z", "type": "commit"}, {"oid": "85de8b25e9f3602e8921be23bcd6a10b85304029", "url": "https://github.com/apache/beam/commit/85de8b25e9f3602e8921be23bcd6a10b85304029", "message": "Update sdks/python/apache_beam/dataframe/frames.py\n\nCo-authored-by: Brian Hulette <hulettbh@gmail.com>", "committedDate": "2020-08-25T19:14:08Z", "type": "commit"}]}