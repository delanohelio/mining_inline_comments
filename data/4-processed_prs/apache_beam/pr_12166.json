{"pr_number": 12166, "pr_title": "[BEAM-10404] Cancel queued/running GitHub Action builds on second push to PR", "pr_createdAt": "2020-07-02T12:38:17Z", "pr_url": "https://github.com/apache/beam/pull/12166", "timeline": [{"oid": "18679c1c207f6a832ee5ddd4d21c42f9d4ca99bd", "url": "https://github.com/apache/beam/commit/18679c1c207f6a832ee5ddd4d21c42f9d4ca99bd", "message": "[BEAM-10404] Cancel queued/running GitHub Action builds on second push to PR", "committedDate": "2020-07-02T12:36:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU1OTM3NQ==", "url": "https://github.com/apache/beam/pull/12166#discussion_r450559375", "bodyText": "When does a 'push' event and a 'pull_request' event happen?\nAFAIK, no tests are running before a PR is created.", "author": "aaltay", "createdAt": "2020-07-07T01:19:57Z", "path": ".github/workflows/cancel.yml", "diffHunk": "@@ -16,7 +16,7 @@\n # under the License.\n \n name: Cancel\n-on: [push]\n+on: [push, pull_request]", "originalCommit": "18679c1c207f6a832ee5ddd4d21c42f9d4ca99bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDcwMjk3Mw==", "url": "https://github.com/apache/beam/pull/12166#discussion_r450702973", "bodyText": "In relation to : https://github.com/apache/beam/blob/master/.github/workflows/build_wheels.yml#L21\nPush: when new commits are pushed to the specified branches. e.g. new merge commit on master appear. So it is possible to run rests without PR.\nPull request: when PR to specified branch is created and then again when new commits appear in the PR.\nIt is not critical since PR builds do not delete/upload anything to the GCS (push builds do), but I think it would be convenient to decrease queue by introducing such a small change.", "author": "TobKed", "createdAt": "2020-07-07T08:41:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU1OTM3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA2MzA5Mw==", "url": "https://github.com/apache/beam/pull/12166#discussion_r451063093", "bodyText": "e.g. new merge commit on master appear. So it is possible to run rests without PR.\n\nI do not understand how/when this would happen. Because we do not allow direct pushes to master. And if it is already in master a PR would not be helpful. Maybe this example applies to release branches?\nOverall, I am fine with the change. It is ok to cancel tests when a new PR is created.", "author": "aaltay", "createdAt": "2020-07-07T18:30:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU1OTM3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjI5NzAzMw==", "url": "https://github.com/apache/beam/pull/12166#discussion_r452297033", "bodyText": "I wasn't aware that direct push to master is not allowed however merge commits which appear on master also trigger push event:\nHere you can check filtered wheels builds for push event on master:\nhttps://github.com/apache/beam/actions?query=event%3Apush+branch%3Amaster+workflow%3A%22Build+python+wheels%22\nand example of push events similar on the release branch release-2.23.0:\nhttps://github.com/apache/beam/actions?query=event%3Apush+branch%3Arelease-2.23.0\nIn comparison here are \"pull request\" events triggered on the various branches:\nhttps://github.com/apache/beam/actions?query=event%3Apull_request", "author": "TobKed", "createdAt": "2020-07-09T15:19:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU1OTM3NQ=="}], "type": "inlineReview"}]}