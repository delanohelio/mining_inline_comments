{"pr_number": 10596, "pr_title": "[BEAM-9122] Add uses_keyed_state step property in python dataflow run\u2026", "pr_createdAt": "2020-01-15T02:02:36Z", "pr_url": "https://github.com/apache/beam/pull/10596", "timeline": [{"oid": "e213de285aaf8dcde385873407b6c3ea5ac2cf89", "url": "https://github.com/apache/beam/commit/e213de285aaf8dcde385873407b6c3ea5ac2cf89", "message": "[BEAM-9122] Add uses_keyed_state step property in python dataflow runner run_ParDo", "committedDate": "2020-01-15T02:02:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0MTkzMA==", "url": "https://github.com/apache/beam/pull/10596#discussion_r367141930", "bodyText": "This will be only needed for streaming pipelines.", "author": "angoenka", "createdAt": "2020-01-15T22:30:26Z", "path": "sdks/python/apache_beam/runners/dataflow/dataflow_runner.py", "diffHunk": "@@ -950,6 +950,10 @@ def run_ParDo(self, transform_node, options):\n       step.add_property(PropertyNames.RESTRICTION_ENCODING,\n                         self._get_cloud_encoding(restriction_coder))\n \n+    from apache_beam.runners.common import DoFnSignature\n+    if DoFnSignature(transform.dofn).is_stateful_dofn():", "originalCommit": "e213de285aaf8dcde385873407b6c3ea5ac2cf89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0ODgyNw==", "url": "https://github.com/apache/beam/pull/10596#discussion_r367148827", "bodyText": "should we distinguish streaming pipelines from batch here?", "author": "y1chi", "createdAt": "2020-01-15T22:49:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0MTkzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Nzc1NDA0NA==", "url": "https://github.com/apache/beam/pull/10596#discussion_r367754044", "bodyText": "Yes, java side we do the same.\n\n  \n    \n      beam/runners/google-cloud-dataflow-java/src/main/java/org/apache/beam/runners/dataflow/DataflowPipelineTranslator.java\n    \n    \n         Line 1260\n      in\n      2fd785d\n    \n    \n    \n    \n\n        \n          \n           stepContext.addInput(PropertyNames.USES_KEYED_STATE, \"true\");", "author": "angoenka", "createdAt": "2020-01-17T03:26:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0MTkzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA5Nzk4Ng==", "url": "https://github.com/apache/beam/pull/10596#discussion_r368097986", "bodyText": "I see, done.", "author": "y1chi", "createdAt": "2020-01-17T19:24:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0MTkzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0MjQ2Ng==", "url": "https://github.com/apache/beam/pull/10596#discussion_r367142466", "bodyText": "Lets import it at the top of the file.", "author": "angoenka", "createdAt": "2020-01-15T22:31:55Z", "path": "sdks/python/apache_beam/runners/dataflow/dataflow_runner.py", "diffHunk": "@@ -950,6 +950,10 @@ def run_ParDo(self, transform_node, options):\n       step.add_property(PropertyNames.RESTRICTION_ENCODING,\n                         self._get_cloud_encoding(restriction_coder))\n \n+    from apache_beam.runners.common import DoFnSignature", "originalCommit": "e213de285aaf8dcde385873407b6c3ea5ac2cf89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzIwNzA2MA==", "url": "https://github.com/apache/beam/pull/10596#discussion_r367207060", "bodyText": "done.", "author": "y1chi", "createdAt": "2020-01-16T02:44:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE0MjQ2Ng=="}], "type": "inlineReview"}, {"oid": "46a5dc206b5f12cdc887582e187652ede1473007", "url": "https://github.com/apache/beam/commit/46a5dc206b5f12cdc887582e187652ede1473007", "message": "fixup", "committedDate": "2020-01-15T23:36:55Z", "type": "commit"}, {"oid": "b1487c32551719502e701b98b13723e4a3c0aead", "url": "https://github.com/apache/beam/commit/b1487c32551719502e701b98b13723e4a3c0aead", "message": "Add streaming option checking", "committedDate": "2020-01-17T23:18:17Z", "type": "commit"}, {"oid": "b1487c32551719502e701b98b13723e4a3c0aead", "url": "https://github.com/apache/beam/commit/b1487c32551719502e701b98b13723e4a3c0aead", "message": "Add streaming option checking", "committedDate": "2020-01-17T23:18:17Z", "type": "forcePushed"}]}