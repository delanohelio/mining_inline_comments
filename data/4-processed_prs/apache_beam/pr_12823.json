{"pr_number": 12823, "pr_title": "[BEAM-10882]  Update Snowflake docs", "pr_createdAt": "2020-09-11T08:51:55Z", "pr_url": "https://github.com/apache/beam/pull/12823", "timeline": [{"oid": "9d7d41199dd4a6c74f8e87f3cae281b4c9c34b63", "url": "https://github.com/apache/beam/commit/9d7d41199dd4a6c74f8e87f3cae281b4c9c34b63", "message": "Added Snowflake I/O connector documentation, to reflect current master state.", "committedDate": "2020-09-03T13:44:27Z", "type": "commit"}, {"oid": "715c556a03d98645ed960f1bec8f664ebef3dd58", "url": "https://github.com/apache/beam/commit/715c556a03d98645ed960f1bec8f664ebef3dd58", "message": "Update website/www/site/content/en/documentation/io/built-in/snowflake.md\n\nCo-authored-by: Piotr Szuberski <piotr.szuberski@polidea.com>", "committedDate": "2020-09-08T12:30:43Z", "type": "commit"}, {"oid": "a4acfe75ab8036560bf1b11962e9d1bfbdad98cd", "url": "https://github.com/apache/beam/commit/a4acfe75ab8036560bf1b11962e9d1bfbdad98cd", "message": "website(snowflake): docs improvments", "committedDate": "2020-09-10T06:40:34Z", "type": "commit"}, {"oid": "25d4abedefca9fe1816717ea1f62c84dbb60a4de", "url": "https://github.com/apache/beam/commit/25d4abedefca9fe1816717ea1f62c84dbb60a4de", "message": "docs(snowflake): small improvements", "committedDate": "2020-09-11T05:54:41Z", "type": "commit"}, {"oid": "e3d9c16f223c79763e99bea6b8ca06082e79eae9", "url": "https://github.com/apache/beam/commit/e3d9c16f223c79763e99bea6b8ca06082e79eae9", "message": "docs(snowflake): remove whitespaces", "committedDate": "2020-09-11T08:58:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc0NTkzNQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r488745935", "bodyText": "I wonder if this should be called 'Using SnowflakeIO in Python SDK' - what do you think? Users may not care if it's cross-lang, but rather that it works in their language of choice. Thoughts?", "author": "pabloem", "createdAt": "2020-09-15T15:10:05Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,206 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Cross Language", "originalCommit": "e3d9c16f223c79763e99bea6b8ca06082e79eae9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc3NjU3MA==", "url": "https://github.com/apache/beam/pull/12823#discussion_r488776570", "bodyText": "+1\nIt's worth having a note somewhere like \"SnowflakeIO in Python can only be used on runners that support cross-language transforms\". I'm wary of listing specific runners here since it will get out of date. It seems we should have a central location that lists runners that support cross-language, seems like a good thing to have on the compatibility matrix.", "author": "TheNeuralBit", "createdAt": "2020-09-15T15:51:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc0NTkzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTQ2MDEwNQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r489460105", "bodyText": "I changed to Using SnowflakeIO in Python SDK' and updated a little intro.\nAbout the second, maybe lets create an issue for this?", "author": "purbanow", "createdAt": "2020-09-16T13:59:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc0NTkzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjU0MDUwMQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r492540501", "bodyText": "@pabloem @TheNeuralBit WDYT?", "author": "purbanow", "createdAt": "2020-09-22T07:56:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc0NTkzNQ=="}], "type": "inlineReview"}, {"oid": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "url": "https://github.com/apache/beam/commit/181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "message": "docs(snowflake): small improvments", "committedDate": "2020-09-16T13:59:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwNzg2Ng==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493907866", "bodyText": "Have you considered using Beam Schemas and Rows here instead of having users provide a CSV mapper? If the SnowflakeIO Read transform produces a PCollection with a schema, then on the Python side we will generate a class that lets users access each field by attribute.", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:32:50Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkyMTI2OQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493921269", "bodyText": "Similarly on the WriteToSnowflake side we can inspect user types and infer a schema from it", "author": "TheNeuralBit", "createdAt": "2020-09-23T22:03:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwNzg2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc5MTA1OQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494791059", "bodyText": "I think it was considered but at the time of writing this connector Rows and Schemas were not well known and the csv + user mapper were already implemented. It would definitely be a nice feature to be done in the future.", "author": "piotr-szuberski", "createdAt": "2020-09-25T07:10:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwNzg2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjI3ODIyNw==", "url": "https://github.com/apache/beam/pull/12823#discussion_r496278227", "bodyText": "+1, thanks", "author": "TheNeuralBit", "createdAt": "2020-09-28T22:50:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwNzg2Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwODE3MQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493908171", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n          \n          \n            \n            - `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/current/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n          \n      \n    \n    \n  \n\nAll of the javadoc and pydoc links should refer to current instead of a specific version number", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:33:31Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc2NDU1Ng==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494764556", "bodyText": "Good to know that! Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:01:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwODE3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwODI0Mg==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493908242", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n          \n          \n            \n            One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/current/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:33:44Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc2NDU3Mw==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494764573", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:01:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwODI0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwOTgzNw==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493909837", "bodyText": "This is optional right? In other cross-language transforms we will download the appropriate expansion service jar and start it for you if a URL isn't specified.", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:37:29Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service`: specifies URL of expansion service.", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc2ODQ3Ng==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494768476", "bodyText": "Of course it is. Done for both read and write.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:13:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwOTgzNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwOTk0NQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493909945", "bodyText": "nit: please make sure only the argument names are code formatted when you are referencing two different args, e.g.:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - `table or query` Specifies a Snowflake table name or custom SQL query\n          \n          \n            \n            - `table` or `query` Specifies a Snowflake table name or custom SQL query", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:37:44Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc3MDMwNQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494770305", "bodyText": "Done for this and the rest of such cases.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:18:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwOTk0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxMDM2MQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493910361", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - `role`: specifies Snowflake role. If not specified then the user's default will be used.\n          \n          \n            \n            - `role` specifies Snowflake role. If not specified the user's default will be used.", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:38:45Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service`: specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combinations of valid parameters for authentication:\n+- `username and password` Specifies username and password for username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc3MDY4Mg==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494770682", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:19:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxMDM2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxMDQxOQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493910419", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.\n          \n          \n            \n            - `warehouse` specifies Snowflake warehouse name. If not specified the user's default will be used.", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:38:53Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service`: specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combinations of valid parameters for authentication:\n+- `username and password` Specifies username and password for username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.\n+\n+- `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc3MDcwNg==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494770706", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:19:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxMDQxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxMTU5OQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493911599", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            {{< highlight >}}\n          \n          \n            \n            {{< highlight py >}}\n          \n      \n    \n    \n  \n\nPlease specify py or java in all the relevant code blocks so that syntax is properly highlighted", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:41:25Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service`: specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combinations of valid parameters for authentication:\n+- `username and password` Specifies username and password for username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.\n+\n+- `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.\n+\n+### Writing to Snowflake\n+One of the functions of SnowflakeIO is writing to Snowflake tables. This transformation enables you to finish the Beam pipeline with an output operation that sends the user's [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) to your Snowflake database.\n+#### General usage\n+{{< highlight >}}", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc3OTU5MA==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494779590", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:43:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxMTU5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNDc1Mg==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493914752", "bodyText": "This page shouldn't state Flink is the only runner the supports cross-language, instead please refer users to https://beam.apache.org/roadmap/connectors-multi-sdk/#cross-language-transforms-api-and-expansion-service for information about which runners support it.", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:48:27Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc4MTk0OQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494781949", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:48:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNDc1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNTE3Ng==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493915176", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            ### Set up\n          \n          \n            \n            Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n          \n      \n    \n    \n  \n\nI don't think this is necessary", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:49:30Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc4MjMzOA==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494782338", "bodyText": "Yeah, it used to be when the expansion services weren't picked up automatically. Removed.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:49:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNTE3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNjMzNA==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493916334", "bodyText": "These exampels can drop the pipeline options and instead just focus on applying the transform to the pipeline, e.g.:\n(p | <SOURCE>\n   | WriteToSnowflake(...)", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:52:06Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service`: specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combinations of valid parameters for authentication:\n+- `username and password` Specifies username and password for username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.\n+\n+- `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.\n+\n+### Writing to Snowflake\n+One of the functions of SnowflakeIO is writing to Snowflake tables. This transformation enables you to finish the Beam pipeline with an output operation that sends the user's [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) to your Snowflake database.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | <SOURCE OF DATA>\n+       | WriteToSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           create_disposition=<CREATE DISPOSITION>,\n+           write_disposition=<WRITE DISPOSITION>,\n+           table_schema=<SNOWFLAKE TABLE SCHEMA>,\n+           user_data_mapper=<USER DATA MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc4MzE0NQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494783145", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:51:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNjMzNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNjc0Nw==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493916747", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                       table=<SNOWFALKE TABLE>,\n          \n          \n            \n                       table=<SNOWFLAKE TABLE>,", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:53:01Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service`: specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combinations of valid parameters for authentication:\n+- `username and password` Specifies username and password for username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.\n+\n+- `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.\n+\n+### Writing to Snowflake\n+One of the functions of SnowflakeIO is writing to Snowflake tables. This transformation enables you to finish the Beam pipeline with an output operation that sends the user's [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) to your Snowflake database.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | <SOURCE OF DATA>\n+       | WriteToSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           create_disposition=<CREATE DISPOSITION>,\n+           write_disposition=<WRITE DISPOSITION>,\n+           table_schema=<SNOWFLAKE TABLE SCHEMA>,\n+           user_data_mapper=<USER DATA MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc4NDA1Mw==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494784053", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:54:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNjc0Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNjgzOA==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493916838", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                       table=<SNOWFALKE TABLE>,\n          \n          \n            \n                       table=<SNOWFLAKE TABLE>,", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:53:17Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc4NDEwMw==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494784103", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T06:54:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxNjgzOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxODE5Nw==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493918197", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            - `table_schema` When the create_disposition parameter is set to CREATE_IF_NEEDED, the table_schema  parameter  enables specifying the schema for the created target table. A table schema is as JSON with the following structure:\n          \n          \n            \n            - `table_schema` When the `create_disposition` parameter is set to CREATE_IF_NEEDED, the table_schema  parameter  enables specifying the schema for the created target table. A table schema is a JSON array with the following structure:", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:56:03Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service`: specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combinations of valid parameters for authentication:\n+- `username and password` Specifies username and password for username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.\n+\n+- `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.\n+\n+### Writing to Snowflake\n+One of the functions of SnowflakeIO is writing to Snowflake tables. This transformation enables you to finish the Beam pipeline with an output operation that sends the user's [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) to your Snowflake database.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | <SOURCE OF DATA>\n+       | WriteToSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           create_disposition=<CREATE DISPOSITION>,\n+           write_disposition=<WRITE DISPOSITION>,\n+           table_schema=<SNOWFLAKE TABLE SCHEMA>,\n+           user_data_mapper=<USER DATA MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+#### Required parameters\n+\n+- `server_name` Full Snowflake server name with account, zone and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Path to Google Cloud Storage bucket ended with slash. Bucket will be used to save CSV files which will end up in Snowflake. Those CSV files will be saved under \u201cstaging_bucket_name\u201d path.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `user_data_mapper` Specifies a function which  maps data from a PCollection to an array of String values before the write operation saves the data to temporary .csv files.\n+Example:\n+{{< highlight >}}\n+def user_data_mapper(user):\n+    return [user.name, str(user.age)]\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service` Specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combination of valid parameters for authentication:\n+\n+- `username and password` Specifies username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.\n+\n+- `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.\n+\n+- `create_disposition` Defines the behaviour of the write operation if the target table does not exist. The following values are supported:\n+  - CREATE_IF_NEEDED - default behaviour. The write operation checks whether the specified target table exists; if it does not, the write operation attempts to create the table Specify the schema for the target table using the table_schema parameter.\n+  - CREATE_NEVER -  The write operation fails if the target table does not exist.\n+\n+- `write_disposition` Defines the write behaviour based on the table where data will be written to. The following values are supported:\n+  - APPEND - Default behaviour. Written data is added to the existing rows in the table,\n+  - EMPTY - The target table must be empty;  otherwise, the write operation fails,\n+  - TRUNCATE - The write operation deletes all rows from the target table before writing to it.\n+\n+- `table_schema` When the create_disposition parameter is set to CREATE_IF_NEEDED, the table_schema  parameter  enables specifying the schema for the created target table. A table schema is as JSON with the following structure:", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxODQ4OQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493918489", "bodyText": "Is there documentation we can refer to about how all of these types are encoded in CSV?", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:56:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxODE5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc4ODA0MQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494788041", "bodyText": "Done. I added a link to https://docs.snowflake.com/en/sql-reference/data-types.html", "author": "piotr-szuberski", "createdAt": "2020-09-25T07:03:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxODE5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxOTQ0MQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493919441", "bodyText": "Does the fact that all of these have \"nullable\":false indicate nulls aren't supported? This could be more concise if you just include the \"dataType\" object, e.g.:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            {\"dataType\":{\"type\":\"varchar\",\"length\":100},\"name\":\"\",\"nullable\":false}]\n          \n          \n            \n            {\"type\":\"varchar\",\"length\":100}", "author": "TheNeuralBit", "createdAt": "2020-09-23T21:59:08Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -362,3 +635,208 @@ static SnowflakeIO.CsvMapper<GenericRecord> getCsvMapper() {\n            };\n }\n {{< /highlight >}}\n+## Using SnowflakeIO in Python SDK\n+### Intro\n+Snowflake cross-language implementation is supporting both reading and writing operations for Python programming language, thanks to\n+cross-language which is part of [Portability Framework Roadmap](https://beam.apache.org/roadmap/portability/) which aims to provide full interoperability\n+across the Beam ecosystem. From a developer perspective it means the possibility of combining transforms written in different languages(Java/Python/Go).\n+\n+Currently, cross-language is supporting only [Apache Flink](https://flink.apache.org/) as a runner in a stable manner but plans are to support all runners.\n+For more information about cross-language please see [multi sdk efforts](https://beam.apache.org/roadmap/connectors-multi-sdk/)\n+and [Beam on top of Flink](https://flink.apache.org/ecosystem/2020/02/22/apache-beam-how-beam-runs-on-top-of-flink.html) articles.\n+\n+### Set up\n+Please see [Apache Beam with Flink runner](https://beam.apache.org/documentation/runners/flink/) for a setup.\n+\n+### Reading from Snowflake\n+One of the functions of SnowflakeIO is reading Snowflake tables - either full tables via table name or custom data via query. Output of the read transform is a [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) of user-defined data type.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | ReadFromSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           csv_mapper=<CSV MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+\n+#### Required parameters\n+- `server_name` Full Snowflake server name with an account, zone, and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Name of the Google Cloud Storage bucket. Bucket will be used as a temporary location for storing CSV files. Those temporary directories will be named `sf_copy_csv_DATE_TIME_RANDOMSUFFIX` and they will be removed automatically once Read operation finishes.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `csv_mapper` Specifies a function which must translate user-defined object to array of strings. SnowflakeIO uses a [COPY INTO <location>](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-location.html) statement to move data from a Snowflake table to Google Cloud Storage as CSV files. These files are then downloaded via [FileIO](https://beam.apache.org/releases/javadoc/2.3.0/index.html?org/apache/beam/sdk/io/FileIO.html) and processed line by line. Each line is split into an array of Strings using the [OpenCSV](http://opencsv.sourceforge.net/) library. The csv_mapper function job is to give the user the possibility to convert the array of Strings to a user-defined type, ie. GenericRecord for Avro or Parquet files, or custom objects.\n+Example:\n+{{< highlight >}}\n+def csv_mapper(strings_array):\n+    return User(strings_array[0], int(strings_array[1])))\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service`: specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combinations of valid parameters for authentication:\n+- `username and password` Specifies username and password for username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.\n+\n+- `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.\n+\n+### Writing to Snowflake\n+One of the functions of SnowflakeIO is writing to Snowflake tables. This transformation enables you to finish the Beam pipeline with an output operation that sends the user's [PCollection](https://beam.apache.org/releases/pydoc/2.20.0/apache_beam.pvalue.html#apache_beam.pvalue.PCollection) to your Snowflake database.\n+#### General usage\n+{{< highlight >}}\n+OPTIONS = [\n+   \"--runner=FlinkRunner\",\n+   \"--flink_version=1.10\",\n+   \"--flink_master=localhost:8081\",\n+   \"--environment_type=LOOPBACK\"\n+]\n+\n+with TestPipeline(options=PipelineOptions(OPTIONS)) as p:\n+   (p\n+       | <SOURCE OF DATA>\n+       | WriteToSnowflake(\n+           server_name=<SNOWFLAKE SERVER NAME>,\n+           username=<SNOWFLAKE USERNAME>,\n+           password=<SNOWFLAKE PASSWORD>,\n+           o_auth_token=<OAUTH TOKEN>,\n+           private_key_path=<PATH TO P8 FILE>,\n+           raw_private_key=<PRIVATE_KEY>\n+           private_key_passphrase=<PASSWORD FOR KEY>,\n+           schema=<SNOWFLAKE SCHEMA>,\n+           database=<SNOWFLAKE DATABASE>,\n+           staging_bucket_name=<GCS BUCKET NAME>,\n+           storage_integration_name=<SNOWFLAKE STORAGE INTEGRATION NAME>,\n+           create_disposition=<CREATE DISPOSITION>,\n+           write_disposition=<WRITE DISPOSITION>,\n+           table_schema=<SNOWFLAKE TABLE SCHEMA>,\n+           user_data_mapper=<USER DATA MAPPER FUNCTION>,\n+           table=<SNOWFALKE TABLE>,\n+           query=<IF NOT TABLE THEN QUERY>,\n+           role=<SNOWFLAKE ROLE>,\n+           warehouse=<SNOWFLAKE WAREHOUSE>,\n+           expansion_service=<EXPANSION SERVICE ADDRESS>))\n+{{< /highlight >}}\n+#### Required parameters\n+\n+- `server_name` Full Snowflake server name with account, zone and domain.\n+\n+- `schema` Name of the Snowflake schema in the database to use.\n+\n+- `database` Name of the Snowflake database to use.\n+\n+- `staging_bucket_name` Path to Google Cloud Storage bucket ended with slash. Bucket will be used to save CSV files which will end up in Snowflake. Those CSV files will be saved under \u201cstaging_bucket_name\u201d path.\n+\n+- `storage_integration_name` Is the name of a Snowflake storage integration object created according to [Snowflake documentation](https://docs.snowflake.net/manuals/sql-reference/sql/create-storage-integration.html).\n+\n+- `user_data_mapper` Specifies a function which  maps data from a PCollection to an array of String values before the write operation saves the data to temporary .csv files.\n+Example:\n+{{< highlight >}}\n+def user_data_mapper(user):\n+    return [user.name, str(user.age)]\n+{{< /highlight >}}\n+\n+- `table or query` Specifies a Snowflake table name or custom SQL query\n+\n+- `expansion_service` Specifies URL of expansion service.\n+\n+#### Authentication parameters\n+It\u2019s required to pass one of the following combination of valid parameters for authentication:\n+\n+- `username and password` Specifies username/password authentication method.\n+\n+- `private_key_path and private_key_passphrase` Specifies a path to private key and passphrase for key/pair authentication method.\n+\n+- `raw_private_key and private_key_passphrase` Specifies a private key and passphrase for key/pair authentication method.\n+\n+- `o_auth_token` Specifies access token for OAuth authentication method.\n+\n+#### Additional parameters\n+- `role`: specifies Snowflake role. If not specified then the user's default will be used.\n+\n+- `warehouse`: specifies Snowflake warehouse name. If not specified then the user's default will be used.\n+\n+- `create_disposition` Defines the behaviour of the write operation if the target table does not exist. The following values are supported:\n+  - CREATE_IF_NEEDED - default behaviour. The write operation checks whether the specified target table exists; if it does not, the write operation attempts to create the table Specify the schema for the target table using the table_schema parameter.\n+  - CREATE_NEVER -  The write operation fails if the target table does not exist.\n+\n+- `write_disposition` Defines the write behaviour based on the table where data will be written to. The following values are supported:\n+  - APPEND - Default behaviour. Written data is added to the existing rows in the table,\n+  - EMPTY - The target table must be empty;  otherwise, the write operation fails,\n+  - TRUNCATE - The write operation deletes all rows from the target table before writing to it.\n+\n+- `table_schema` When the create_disposition parameter is set to CREATE_IF_NEEDED, the table_schema  parameter  enables specifying the schema for the created target table. A table schema is as JSON with the following structure:\n+{{< highlight >}}\n+{\"schema\":[\n+    {\n+      \"dataType\":{\"type\":\"<COLUMN DATA TYPE>\"},\n+      \"name\":\"<COLUMN  NAME> \",\n+      \"nullable\": <NULLABLE>\n+    },\n+        ...\n+  ]}\n+{{< /highlight >}}\n+All supported data types:\n+{{< highlight >}}\n+{\"dataType\":{\"type\":\"date\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"datetime\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"time\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"timestamp\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"timestamp_ltz\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"timestamp_ntz\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"timestamp_tz\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"boolean\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"decimal\",\"precision\":38,\"scale\":1},\"name\":\"\",\"nullable\":true},\n+{\"dataType\":{\"type\":\"double\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"float\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"integer\",\"precision\":38,\"scale\":0},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"number\",\"precision\":38,\"scale\":1},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"numeric\",\"precision\":40,\"scale\":2},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"real\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"array\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"object\"},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"variant\"},\"name\":\"\",\"nullable\":true},\n+{\"dataType\":{\"type\":\"binary\",\"size\":null},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"char\",\"length\":1},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"string\",\"length\":null},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"text\",\"length\":null},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"varbinary\",\"size\":null},\"name\":\"\",\"nullable\":false},\n+{\"dataType\":{\"type\":\"varchar\",\"length\":100},\"name\":\"\",\"nullable\":false}]", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc4ODM5Mg==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494788392", "bodyText": "I agree. I found 2 of nullables to be true but the overall json schema is written above so just the dataType json object will be sufficient and much clearer.", "author": "piotr-szuberski", "createdAt": "2020-09-25T07:04:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkxOTQ0MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkyMDA1Mg==", "url": "https://github.com/apache/beam/pull/12823#discussion_r493920052", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              - Limit of rows written to each file staged file\n          \n          \n            \n              - Limit of rows written to each staged file", "author": "TheNeuralBit", "createdAt": "2020-09-23T22:00:37Z", "path": "website/www/site/content/en/documentation/io/built-in/snowflake.md", "diffHunk": "@@ -204,14 +370,121 @@ Then:\n **Note**:\n SnowflakeIO uses COPY statements behind the scenes to write (using [COPY to table](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-table.html)). StagingBucketName will be used to save CSV files which will end up in Snowflake. Those CSV files will be saved under the \u201cstagingBucketName\u201d path.\n \n+**Optional** for batching:\n+- `.withQuotationMark()`\n+  - Default value: `\u2018` (single quotation mark).\n+  - Accepts String with one character. It will surround all text (String) fields saved to CSV. It should be one of the accepted characters by [Snowflake\u2019s](https://docs.snowflake.com/en/sql-reference/sql/create-file-format.html) [FIELD_OPTIONALLY_ENCLOSED_BY](https://docs.snowflake.com/en/sql-reference/sql/create-file-format.html) parameter (double quotation mark, single quotation mark or none).\n+  - Example: `.withQuotationMark(\"'\")`\n+### Streaming write  (from unbounded source)\n+It is required to create a [SnowPipe](https://docs.snowflake.com/en/user-guide/data-load-snowpipe.html) in the Snowflake console. SnowPipe should use the same integration and the same bucket as specified by .withStagingBucketName and .withStorageIntegrationName methods. The write operation might look as follows:\n+{{< highlight java >}}\n+data.apply(\n+   SnowflakeIO.<type>write()\n+      .withStagingBucketName(\"BUCKET NAME\")\n+      .withStorageIntegrationName(\"STORAGE INTEGRATION NAME\")\n+      .withDataSourceConfiguration(dc)\n+      .withUserDataMapper(mapper)\n+      .withSnowPipe(\"MY_SNOW_PIPE\")\n+      .withFlushTimeLimit(Duration.millis(time))\n+      .withFlushRowLimit(rowsNumber)\n+      .withShardsNumber(shardsNumber)\n+)\n+{{< /highlight >}}\n+#### Parameters\n+**Required** for streaming:\n+\n+- ` .withDataSourceConfiguration()`\n+  - Accepts a DatasourceConfiguration object.\n+\n+- `.toTable()`\n+  - Accepts the target Snowflake table name.\n+  - Example: `.toTable(\"MY_TABLE)`\n+\n+- `.withStagingBucketName()`\n+  - Accepts a cloud bucket path ended with slash.\n+  - Example: `.withStagingBucketName(\"gs://mybucket/my/dir/\")`\n+\n+- `.withStorageIntegrationName()`\n+  - Accepts a name of a Snowflake storage integration object created according to Snowflake documentationt.\n+  - Example:\n+{{< highlight >}}\n+CREATE OR REPLACE STORAGE INTEGRATION test_integration\n+TYPE = EXTERNAL_STAGE\n+STORAGE_PROVIDER = GCS\n+ENABLED = TRUE\n+STORAGE_ALLOWED_LOCATIONS = ('gcs://bucket/');\n+{{< /highlight >}}\n+Then:\n+{{< highlight >}}\n+.withStorageIntegrationName(test_integration)\n+{{< /highlight >}}\n+\n+- `.withSnowPipe()`\n+  - Accepts the target SnowPipe name. `.withSnowPipe()` accepts the exact name of snowpipe.\n+Example:\n+{{< highlight >}}\n+CREATE OR REPLACE PIPE test_database.public.test_gcs_pipe\n+AS COPY INTO stream_table from @streamstage;\n+{{< /highlight >}}\n+\n+   - Then:\n+{{< highlight >}}\n+.withSnowPipe(test_gcs_pipe)\n+{{< /highlight >}}\n+\n+**Note**: this is important to provide **schema** and **database** names.\n+- `.withUserDataMapper()`\n+  - Accepts the [UserDataMapper](https://beam.apache.org/documentation/io/built-in/snowflake/#userdatamapper-function) function that will map a user's PCollection to an array of String values `(String[]).`\n+\n+**Note**:\n+\n+SnowflakeIO uses COPY statements behind the scenes to write (using [COPY to table](https://docs.snowflake.net/manuals/sql-reference/sql/copy-into-table.html)). StagingBucketName will be used to save CSV files which will end up in Snowflake. Those CSV files will be saved under the \u201cstagingBucketName\u201d path.\n+\n+**Optional** for streaming:\n+- `.withFlushTimeLimit()`\n+  - Default value: 30 seconds\n+  - Accepts Duration objects with the specified time after each the streaming write will be repeated\n+  - Example: `.withFlushTimeLimit(Duration.millis(180000))`\n+\n+- `.withFlushRowLimit()`\n+  - Default value: 10,000 rows\n+  - Limit of rows written to each file staged file", "originalCommit": "181aff39cc5ae0b927efe212bd7a5fd5b182e6cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDc4ODg5MQ==", "url": "https://github.com/apache/beam/pull/12823#discussion_r494788891", "bodyText": "Done.", "author": "piotr-szuberski", "createdAt": "2020-09-25T07:05:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkyMDA1Mg=="}], "type": "inlineReview"}, {"oid": "acc1f7e690736b3f9c6a4715a5a1fef1fcd7c3e6", "url": "https://github.com/apache/beam/commit/acc1f7e690736b3f9c6a4715a5a1fef1fcd7c3e6", "message": "Fixes after TheNeuralBit review", "committedDate": "2020-09-25T07:15:27Z", "type": "commit"}, {"oid": "f76604781b209ec06b0b0c5d034ba27057842cc2", "url": "https://github.com/apache/beam/commit/f76604781b209ec06b0b0c5d034ba27057842cc2", "message": "2 more fixed version -> current", "committedDate": "2020-09-25T07:18:28Z", "type": "commit"}]}