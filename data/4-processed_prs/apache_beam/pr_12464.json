{"pr_number": 12464, "pr_title": "[BEAM-10637] fix: test stream service start/stop", "pr_createdAt": "2020-08-04T18:52:50Z", "pr_url": "https://github.com/apache/beam/pull/12464", "timeline": [{"oid": "973f316e7a97bda12dcc4592ddbccfcccb00c5ad", "url": "https://github.com/apache/beam/commit/973f316e7a97bda12dcc4592ddbccfcccb00c5ad", "message": "[BEAM-10637] fix: test stream service start/stop\n\nFixed the start/stop logic so that a controller:\n\n1. can only be started/stopped once;\n2. can only be stopped when is started while never stopped before;\n3. does not hang indefinitely but noop for redundant or invalid start/stop calls.", "committedDate": "2020-08-04T18:55:22Z", "type": "commit"}, {"oid": "973f316e7a97bda12dcc4592ddbccfcccb00c5ad", "url": "https://github.com/apache/beam/commit/973f316e7a97bda12dcc4592ddbccfcccb00c5ad", "message": "[BEAM-10637] fix: test stream service start/stop\n\nFixed the start/stop logic so that a controller:\n\n1. can only be started/stopped once;\n2. can only be stopped when is started while never stopped before;\n3. does not hang indefinitely but noop for redundant or invalid start/stop calls.", "committedDate": "2020-08-04T18:55:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMzMzg4NQ==", "url": "https://github.com/apache/beam/pull/12464#discussion_r465333885", "bodyText": "Write this in a format similar to start():\nif self._server_started and not self._server_stopped:\nor change start to similar format as\nif self._server_started or self._server_stopped:\n    return", "author": "aaltay", "createdAt": "2020-08-04T21:13:41Z", "path": "sdks/python/apache_beam/testing/test_stream_service.py", "diffHunk": "@@ -50,9 +52,17 @@ def __init__(self, reader, endpoint=None, exception_handler=None):\n       self._exception_handler = lambda _: False\n \n   def start(self):\n-    self._server.start()\n+    # A server can only be started if never started and never stopped before.\n+    if not self._server_started and not self._server_stopped:\n+      self._server_started = True\n+      self._server.start()\n \n   def stop(self):\n+    # A server can only be stopped if already started and never stopped before.\n+    if not self._server_started or self._server_stopped:", "originalCommit": "973f316e7a97bda12dcc4592ddbccfcccb00c5ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTM1MzE5NQ==", "url": "https://github.com/apache/beam/pull/12464#discussion_r465353195", "bodyText": "Thanks! Formatted it.", "author": "KevinGG", "createdAt": "2020-08-04T21:57:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMzMzg4NQ=="}], "type": "inlineReview"}, {"oid": "12684dbc222b8bcc1303703cc6d8f0e74856ef55", "url": "https://github.com/apache/beam/commit/12684dbc222b8bcc1303703cc6d8f0e74856ef55", "message": "Normalize the if statements in a consistent way.", "committedDate": "2020-08-04T21:56:18Z", "type": "commit"}]}