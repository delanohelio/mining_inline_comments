{"pr_number": 11221, "pr_title": "[BEAM-9614] Add base SDK version to environment capabilities for Python, Java and initial value for Go", "pr_createdAt": "2020-03-25T17:39:00Z", "pr_url": "https://github.com/apache/beam/pull/11221", "timeline": [{"oid": "d872287454f6bb3734b47a414afe0a0c20e3210a", "url": "https://github.com/apache/beam/commit/d872287454f6bb3734b47a414afe0a0c20e3210a", "message": "Add base SDK version to environment capabilities for Python and Java.\n\nGo doesn't seem to meaningfully provide this information yet\n(always using latest unless manually specified).", "committedDate": "2020-03-25T17:36:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY1NDY2Mw==", "url": "https://github.com/apache/beam/pull/11221#discussion_r398654663", "bodyText": "What about going with \"beam:sdk:version:\" + ReleaseInfo.getReleaseInfo().getSdkVersion() and \"beam:sdk:language:java\"?\nAny detection we do about container image paths should likely be done from the container manifest itself.\nWe could add beam:sdk:language:go to the Go SDK.", "author": "lukecwik", "createdAt": "2020-03-26T15:16:53Z", "path": "runners/core-construction-java/src/main/java/org/apache/beam/runners/core/construction/Environments.java", "diffHunk": "@@ -239,6 +239,7 @@ public static Environment createProcessEnvironment(\n     capabilities.addAll(ModelCoders.urns());\n     capabilities.add(BeamUrns.getUrn(StandardProtocols.Enum.MULTI_CORE_BUNDLE_PROCESSING));\n     capabilities.add(BeamUrns.getUrn(StandardProtocols.Enum.PROGRESS_REPORTING));\n+    capabilities.add(\"beam:version:sdk_base:\" + JAVA_SDK_HARNESS_CONTAINER_URL);", "originalCommit": "d872287454f6bb3734b47a414afe0a0c20e3210a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODczNTk3OQ==", "url": "https://github.com/apache/beam/pull/11221#discussion_r398735979", "bodyText": "I did this because the languages might be versioned as well (as they are in Python, and may be in Java). This version may not align precisely with the version used during construction, but the default container should always be compatible with it to whatever level of granularity our containers are build. I also don't think we should be encourage any branching on beam:sdk:version. However, if you feel strongly we could split these out.\nAdding a generic marker for go.", "author": "robertwb", "createdAt": "2020-03-26T16:59:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY1NDY2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODc3NDczOQ==", "url": "https://github.com/apache/beam/pull/11221#discussion_r398774739", "bodyText": "The language version is an interesting point and brings up an issue where you could be using the same base container but the user submitting the pipeline is using a different version.\nI just feel as though people will attempt to \"parse\" the language and version out of the container URL but if it comes to that we can always add more capabilities and remove existing ones.", "author": "lukecwik", "createdAt": "2020-03-26T17:53:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY1NDY2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgxNzQ0Ng==", "url": "https://github.com/apache/beam/pull/11221#discussion_r398817446", "bodyText": "Yeah, we can't rule out people trying to parse these, but at least then they'll know they're on shaky ground. And as you say, these aren't terribly sticky. (I hope we never have to use them.)", "author": "robertwb", "createdAt": "2020-03-26T18:56:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY1NDY2Mw=="}], "type": "inlineReview"}, {"oid": "822fdee2da4ecd7eb36d437c0231873cc98624a3", "url": "https://github.com/apache/beam/commit/822fdee2da4ecd7eb36d437c0231873cc98624a3", "message": "[BEAM-9614] Add SDK id for go.", "committedDate": "2020-03-26T17:04:14Z", "type": "commit"}]}