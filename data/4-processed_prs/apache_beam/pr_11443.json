{"pr_number": 11443, "pr_title": "[BEAM-9775] Add Go support for SDF StandardRequirements.", "pr_createdAt": "2020-04-17T03:42:23Z", "pr_url": "https://github.com/apache/beam/pull/11443", "timeline": [{"oid": "cd36274c4a5893722898b25935af731a3c1417b0", "url": "https://github.com/apache/beam/commit/cd36274c4a5893722898b25935af731a3c1417b0", "message": "[BEAM-9775] Add Go support for SDF StandardRequirements.\n\nThis fills in just the SDF requirement for pipelines (defined in\nbeam_runner_api.proto). The way it's implemented should be pretty\nsimple to expand for future requirements too.", "committedDate": "2020-04-17T03:40:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM4NjU5OA==", "url": "https://github.com/apache/beam/pull/11443#discussion_r410386598", "bodyText": "While this is testing the Marshal it's not validating that the Requirements are populated as expected. Consider checking the new change in the resulting proto, if not the length like the other tests.", "author": "lostluck", "createdAt": "2020-04-17T18:05:42Z", "path": "sdks/go/pkg/beam/core/runtime/graphx/translate_test.go", "diffHunk": "@@ -87,29 +89,38 @@ func TestMarshal(t *testing.T) {\n \t\tname                     string\n \t\tmakeGraph                func(t *testing.T, g *graph.Graph)\n \t\tedges, transforms, roots int\n+\t\trequirements             []string\n \t}{\n \t\t{\n \t\t\tname: \"ParDo\",\n \t\t\tmakeGraph: func(t *testing.T, g *graph.Graph) {\n-\t\t\t\taddDoFn(t, g, pickFn, g.Root(), []*graph.Node{newIntInput(g)}, []*coder.Coder{intCoder(), intCoder()})\n+\t\t\t\taddDoFn(t, g, pickFn, g.Root(), []*graph.Node{newIntInput(g)}, []*coder.Coder{intCoder(), intCoder()}, nil)\n \t\t\t},\n \t\t\tedges:      1,\n \t\t\ttransforms: 1,\n \t\t\troots:      1,\n \t\t}, {\n \t\t\tname: \"ScopedParDo\",\n \t\t\tmakeGraph: func(t *testing.T, g *graph.Graph) {\n-\t\t\t\taddDoFn(t, g, pickFn, g.NewScope(g.Root(), \"sub\"), []*graph.Node{newIntInput(g)}, []*coder.Coder{intCoder(), intCoder()})\n+\t\t\t\taddDoFn(t, g, pickFn, g.NewScope(g.Root(), \"sub\"), []*graph.Node{newIntInput(g)}, []*coder.Coder{intCoder(), intCoder()}, nil)\n \t\t\t},\n \t\t\tedges:      1,\n \t\t\ttransforms: 2,\n \t\t\troots:      1,\n+\t\t}, {\n+\t\t\tname: \"SplittableParDo\",", "originalCommit": "cd36274c4a5893722898b25935af731a3c1417b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQxNTk1OA==", "url": "https://github.com/apache/beam/pull/11443#discussion_r410415958", "bodyText": "Whoops. That was the plan, but I forgot to actually add the validation. >_<", "author": "youngoli", "createdAt": "2020-04-17T19:04:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM4NjU5OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQwMjY5OQ==", "url": "https://github.com/apache/beam/pull/11443#discussion_r410402699", "bodyText": "This doesn't look like a necessary change, and groups the standard library imports with the rest of them. Consider reverting this change.", "author": "lostluck", "createdAt": "2020-04-17T18:37:27Z", "path": "sdks/go/pkg/beam/pardo.go", "diffHunk": "@@ -17,10 +17,9 @@ package beam\n \n import (\n \t\"fmt\"\n+\t\"github.com/apache/beam/sdks/go/pkg/beam/core/graph\"", "originalCommit": "cd36274c4a5893722898b25935af731a3c1417b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQxNzMzMQ==", "url": "https://github.com/apache/beam/pull/11443#discussion_r410417331", "bodyText": "This shouldn't have been here, just forgot to erase some changes. Reverting it.", "author": "youngoli", "createdAt": "2020-04-17T19:07:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQwMjY5OQ=="}], "type": "inlineReview"}, {"oid": "3bce12be0629a9d74e30953a675a38bc41d90e9f", "url": "https://github.com/apache/beam/commit/3bce12be0629a9d74e30953a675a38bc41d90e9f", "message": "[BEAM-9775] fixup", "committedDate": "2020-04-17T20:35:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUwMzY4OQ==", "url": "https://github.com/apache/beam/pull/11443#discussion_r410503689", "bodyText": "Since order doesn't matter for the results, but in the future the SDK might add more than this requirement, consider adding a transformer to sort the slices for the equals check.\nhttps://godoc.corp.google.com/pkg/google3/third_party/golang/cmp/cmp#example_Option_sortedSlice", "author": "lostluck", "createdAt": "2020-04-17T22:45:16Z", "path": "sdks/go/pkg/beam/core/runtime/graphx/translate_test.go", "diffHunk": "@@ -157,8 +170,34 @@ func TestMarshal(t *testing.T) {\n \t\t\tif got, want := len(p.GetRootTransformIds()), test.roots; got != want {\n \t\t\t\tt.Errorf(\"got %d roots, want %d : %v\", got, want, proto.MarshalTextString(p))\n \t\t\t}\n+\t\t\tif got, want := p.GetRequirements(), test.requirements; !cmp.Equal(got, want) {", "originalCommit": "3bce12be0629a9d74e30953a675a38bc41d90e9f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUxNzQzMw==", "url": "https://github.com/apache/beam/pull/11443#discussion_r410517433", "bodyText": "Done.", "author": "youngoli", "createdAt": "2020-04-17T23:47:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDUwMzY4OQ=="}], "type": "inlineReview"}, {"oid": "58d04ffa2f269ee2636f18d6a3510b0ac4dad58e", "url": "https://github.com/apache/beam/commit/58d04ffa2f269ee2636f18d6a3510b0ac4dad58e", "message": "[BEAM-9775] fixup2", "committedDate": "2020-04-17T23:46:58Z", "type": "commit"}]}