{"pr_number": 13287, "pr_title": "[BEAM-8876] Run hadoop tests with different versions and enable HadoopFormatIT test on Postcommit", "pr_createdAt": "2020-11-09T21:30:14Z", "pr_url": "https://github.com/apache/beam/pull/13287", "timeline": [{"oid": "6557a8e54f3651d3ff8b2ae5a0e027a8c07b5c62", "url": "https://github.com/apache/beam/commit/6557a8e54f3651d3ff8b2ae5a0e027a8c07b5c62", "message": "[BEAM-8876] Run hadoop tests with different versions and enable HadoopFormatIT test on Postcommit", "committedDate": "2020-11-09T21:33:26Z", "type": "forcePushed"}, {"oid": "5522be9250e52eba82428ecc7263d54cca733032", "url": "https://github.com/apache/beam/commit/5522be9250e52eba82428ecc7263d54cca733032", "message": "[BEAM-8876] Run hadoop tests with different versions and enable HadoopFormatIT test in Java Postcommit", "committedDate": "2020-11-10T18:32:05Z", "type": "forcePushed"}, {"oid": "cd54e51a157e20487b3faf9775cddba3ac39359c", "url": "https://github.com/apache/beam/commit/cd54e51a157e20487b3faf9775cddba3ac39359c", "message": "[BEAM-8876] Run hadoop tests with different versions and enable HadoopFormatIT test in Java Postcommit", "committedDate": "2020-11-12T08:47:32Z", "type": "forcePushed"}, {"oid": "fb23d3f37079c5afbb55c72ec4a7c321050c674d", "url": "https://github.com/apache/beam/commit/fb23d3f37079c5afbb55c72ec4a7c321050c674d", "message": "[BEAM-8876] Run hadoop tests with different versions and enable HadoopFormatIT test in Java Postcommit", "committedDate": "2020-11-14T05:00:37Z", "type": "commit"}, {"oid": "fb23d3f37079c5afbb55c72ec4a7c321050c674d", "url": "https://github.com/apache/beam/commit/fb23d3f37079c5afbb55c72ec4a7c321050c674d", "message": "[BEAM-8876] Run hadoop tests with different versions and enable HadoopFormatIT test in Java Postcommit", "committedDate": "2020-11-14T05:00:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDA0NjQ3Mg==", "url": "https://github.com/apache/beam/pull/13287#discussion_r524046472", "bodyText": "Better \ud83d\udc4d", "author": "iemejia", "createdAt": "2020-11-16T09:50:55Z", "path": "runners/spark/build.gradle", "diffHunk": "@@ -41,10 +42,15 @@ evaluationDependsOn(\":runners:core-java\")\n \n configurations {\n   validatesRunner\n-  hadoopVersion285\n }\n \n-def hadoop_285_version = '2.8.5'\n+def hadoopVersions = [", "originalCommit": "fb23d3f37079c5afbb55c72ec4a7c321050c674d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDA5OTY3Mw==", "url": "https://github.com/apache/beam/pull/13287#discussion_r524099673", "bodyText": "Are we API compatible to even include here \"3.2.1\"? Does it pass? if so we can maybe include it in a subsequent PR (just thinking out loud for this and the other Hadoop modules)", "author": "iemejia", "createdAt": "2020-11-16T10:38:43Z", "path": "sdks/java/io/hadoop-common/build.gradle", "diffHunk": "@@ -16,17 +16,21 @@\n  * limitations under the License.\n  */\n \n+import java.util.stream.Collectors\n+\n plugins { id 'org.apache.beam.module' }\n applyJavaNature(automaticModuleName: 'org.apache.beam.sdk.io.hadoop.common')\n \n description = \"Apache Beam :: SDKs :: Java :: IO :: Hadoop Common\"\n ext.summary = \"Library to add shared Hadoop classes among Beam IOs.\"\n \n-configurations {\n-  hadoopVersion285\n-}\n+def hadoopVersions = [\n+    \"285\": \"2.8.5\",\n+    \"292\": \"2.9.2\",\n+    \"2101\": \"2.10.1\",", "originalCommit": "fb23d3f37079c5afbb55c72ec4a7c321050c674d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDEyOTIyNQ==", "url": "https://github.com/apache/beam/pull/13287#discussion_r524129225", "bodyText": "I also was thinking if we could define this globally so we don't have this copy pasted everywhere as well as the hadoopVersions chunk, but my gradle fu is not so high to purpose a way to do it. I mean also if there is not some way to create something like \n  \n    \n      beam/buildSrc/src/main/groovy/org/apache/beam/gradle/BeamModulePlugin.groovy\n    \n    \n         Line 728\n      in\n      fb23d3f\n    \n    \n    \n    \n\n        \n          \n           project.ext.applyJavaNature = { \n        \n    \n  \n\n that can be configurable only at each module level, to have less repeated code.", "author": "iemejia", "createdAt": "2020-11-16T11:05:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDA5OTY3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI1MzM5Ng==", "url": "https://github.com/apache/beam/pull/13287#discussion_r524253396", "bodyText": "I have the same issue - I tried to add some global constant like project.ext.applyHadoopVersions() to BeamModulePlugin but I don't get the Gradle's keikaku how to do such thing.\nAbout 3.2.1 - there are Jira tasks for it so I wanted to do it in another PR (as this one already is about 2 things at once - IT test and version testing). I'm not sure whether every module passes the tests. I'll do that right after this is merged.", "author": "piotr-szuberski", "createdAt": "2020-11-16T13:06:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDA5OTY3Mw=="}], "type": "inlineReview"}]}