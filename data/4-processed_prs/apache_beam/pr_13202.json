{"pr_number": 13202, "pr_title": "[BEAM-11196] Set parent of fused stages to the lowest common ancestor", "pr_createdAt": "2020-10-27T00:42:38Z", "pr_url": "https://github.com/apache/beam/pull/13202", "timeline": [{"oid": "146e9d095260e1afc5732f3b680fd4a8bbbb4d37", "url": "https://github.com/apache/beam/commit/146e9d095260e1afc5732f3b680fd4a8bbbb4d37", "message": "Set parent of fused stages to the lowest common ancestor", "committedDate": "2020-10-27T00:38:13Z", "type": "commit"}, {"oid": "5058e5790ce0b819735af7a4c51a045e97c6065e", "url": "https://github.com/apache/beam/commit/5058e5790ce0b819735af7a4c51a045e97c6065e", "message": "Ensure parent is always a string", "committedDate": "2020-10-27T19:47:40Z", "type": "commit"}, {"oid": "8e07b1c62762a291c22cd0c5212c629eaa463a60", "url": "https://github.com/apache/beam/commit/8e07b1c62762a291c22cd0c5212c629eaa463a60", "message": "Lint", "committedDate": "2020-10-27T20:48:44Z", "type": "commit"}, {"oid": "db669637a79de855af6bc474b7a3ce44264a3529", "url": "https://github.com/apache/beam/commit/db669637a79de855af6bc474b7a3ce44264a3529", "message": "Fix bug", "committedDate": "2020-11-03T02:06:36Z", "type": "commit"}, {"oid": "78d853708643d107bc15539409237d5326fc148e", "url": "https://github.com/apache/beam/commit/78d853708643d107bc15539409237d5326fc148e", "message": "lint", "committedDate": "2020-11-03T15:20:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzUwNDkzOQ==", "url": "https://github.com/apache/beam/pull/13202#discussion_r517504939", "bodyText": "Consider following for easier readability:\n  parents = {\n      child_id: parent_id\n      for parent_id, parent in context.components.transforms.items()\n      for child_id in parent.subtransforms\n  }", "author": "tvalentyn", "createdAt": "2020-11-04T17:17:37Z", "path": "sdks/python/apache_beam/runners/portability/fn_api_runner/translations.py", "diffHunk": "@@ -1166,6 +1173,36 @@ def unlifted_stages(stage):\n       yield stage\n \n \n+def _lowest_common_ancestor(a, b, context):\n+  # type: (str, str, TransformContext) -> Optional[str]\n+\n+  '''Returns the name of the lowest common ancestor of the two named stages.\n+\n+  The provided context is used to compute ancestors of stages. Note that stages\n+  are considered to be ancestors of themselves.\n+  '''\n+  assert a != b\n+\n+  parents = {", "originalCommit": "78d853708643d107bc15539409237d5326fc148e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzczNjY2Mw==", "url": "https://github.com/apache/beam/pull/13202#discussion_r517736663", "bodyText": "Yeah, this is an issue with yapf.", "author": "robertwb", "createdAt": "2020-11-05T01:56:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzUwNDkzOQ=="}], "type": "inlineReview"}, {"oid": "6348adc9d4dfd8e7445d88ce707095207347f30c", "url": "https://github.com/apache/beam/commit/6348adc9d4dfd8e7445d88ce707095207347f30c", "message": "yapf, memoize", "committedDate": "2020-11-05T02:02:49Z", "type": "commit"}]}