{"pr_number": 13286, "pr_title": "[BEAM-9561] Run pandas doctests in parallel.", "pr_createdAt": "2020-11-09T19:00:35Z", "pr_url": "https://github.com/apache/beam/pull/13286", "timeline": [{"oid": "01cffc5aa9fb7c380259aa0da957000df594ad26", "url": "https://github.com/apache/beam/commit/01cffc5aa9fb7c380259aa0da957000df594ad26", "message": "[BEAM-9561] Run pandas doctests in parallel.", "committedDate": "2020-11-09T18:59:41Z", "type": "commit"}, {"oid": "2acf5b1987f4dc03825df96b40f44a8845e5dbac", "url": "https://github.com/apache/beam/commit/2acf5b1987f4dc03825df96b40f44a8845e5dbac", "message": "Make lint happy.", "committedDate": "2020-11-09T20:06:59Z", "type": "commit"}, {"oid": "e4e8dc9bba4710653484b576739f3df21b3791cf", "url": "https://github.com/apache/beam/commit/e4e8dc9bba4710653484b576739f3df21b3791cf", "message": "yapf", "committedDate": "2020-11-11T01:01:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk3OTMwOA==", "url": "https://github.com/apache/beam/pull/13286#discussion_r520979308", "bodyText": "nit: add a help string indicating the default is 0, which will use the cpu count", "author": "TheNeuralBit", "createdAt": "2020-11-11T01:06:37Z", "path": "sdks/python/apache_beam/dataframe/pandas_docs_test.py", "diffHunk": "@@ -33,10 +39,15 @@\n PANDAS_DIR = os.path.expanduser(\"~/.apache_beam/cache/pandas-\" + PANDAS_VERSION)\n PANDAS_DOCS_SOURCE = os.path.join(PANDAS_DIR, 'doc', 'source')\n \n+parallelism = None\n+\n \n def main():\n-  # Not available for Python 2.\n-  import urllib.request\n+  parser = argparse.ArgumentParser()\n+  parser.add_argument('-p', '--parallel', type=int, default=0)", "originalCommit": "e4e8dc9bba4710653484b576739f3df21b3791cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU4NTU1Mw==", "url": "https://github.com/apache/beam/pull/13286#discussion_r521585553", "bodyText": "Done.", "author": "robertwb", "createdAt": "2020-11-11T19:22:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk3OTMwOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk4MzU5OA==", "url": "https://github.com/apache/beam/pull/13286#discussion_r520983598", "bodyText": "Is this needed because parallelism is used in run_tests? Instead of branching on parallelism inside run_tests could we just make a different method for the parallel vs single-threaded cases?", "author": "TheNeuralBit", "createdAt": "2020-11-11T01:12:55Z", "path": "sdks/python/apache_beam/dataframe/pandas_docs_test.py", "diffHunk": "@@ -74,22 +85,56 @@ def main():\n         if any(filter in path for filter in filters):\n           paths.append(path)\n \n+  # Using a global here is a bit hacky, but avoids pickling issues when used\n+  # with multiprocessing.\n+  global parallelism", "originalCommit": "e4e8dc9bba4710653484b576739f3df21b3791cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTU4NTUzMQ==", "url": "https://github.com/apache/beam/pull/13286#discussion_r521585531", "bodyText": "Sure.", "author": "robertwb", "createdAt": "2020-11-11T19:22:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk4MzU5OA=="}], "type": "inlineReview"}, {"oid": "784e532eb8b3aa867704e70d00533f69675e5172", "url": "https://github.com/apache/beam/commit/784e532eb8b3aa867704e70d00533f69675e5172", "message": "Arg docs, cleanup parallelism flag, order tests by size.", "committedDate": "2020-11-11T19:21:56Z", "type": "commit"}]}