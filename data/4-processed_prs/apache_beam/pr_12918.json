{"pr_number": 12918, "pr_title": "BEAM-10910: Validate the BigQuery table name before creating one", "pr_createdAt": "2020-09-23T18:17:21Z", "pr_url": "https://github.com/apache/beam/pull/12918", "timeline": [{"oid": "4925c957f0a7b422667f81a95410db7bb387029b", "url": "https://github.com/apache/beam/commit/4925c957f0a7b422667f81a95410db7bb387029b", "message": "BEAM-10910: Validate the BigQuery table name before creating one", "committedDate": "2020-09-23T18:08:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUwMTgwNg==", "url": "https://github.com/apache/beam/pull/12918#discussion_r494501806", "bodyText": "I wonder if this should exist under retry.py. Thoughts?", "author": "pabloem", "createdAt": "2020-09-24T17:48:57Z", "path": "sdks/python/apache_beam/io/gcp/bigquery_tools.py", "diffHunk": "@@ -131,6 +131,12 @@ def get_hashable_destination(destination):\n     return destination\n \n \n+def no_retry_on_invalid_input(exn):\n+  if isinstance(exn, ValueError):\n+    return False\n+  return retry.retry_on_server_errors_and_timeout_filter(exn)", "originalCommit": "4925c957f0a7b422667f81a95410db7bb387029b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUwMTk4NA==", "url": "https://github.com/apache/beam/pull/12918#discussion_r494501984", "bodyText": "(I mean that whole function)", "author": "pabloem", "createdAt": "2020-09-24T17:49:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUwMTgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU1NDg0OA==", "url": "https://github.com/apache/beam/pull/12918#discussion_r494554848", "bodyText": "Yeah, I was thinking the same. Looking at the source of retry.py, it would fit right in (maybe with a better name?). I'm fine with moving it there.", "author": "milancermak", "createdAt": "2020-09-24T19:17:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUwMTgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU3NTIwNQ==", "url": "https://github.com/apache/beam/pull/12918#discussion_r494575205", "bodyText": "I was also thinking a positive logical name (e.g. retry_on_xyz unlike no_retry_on_...) rather than a negative - but I'm not sure what it could be... I can think of retry_if_valid_input_.... or something like that.", "author": "pabloem", "createdAt": "2020-09-24T19:56:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUwMTgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDU5MjI0Ng==", "url": "https://github.com/apache/beam/pull/12918#discussion_r494592246", "bodyText": "I changed it to retry_if_valid_input_but_server_error_and_timeout_filter in the latest commit. What do you think?", "author": "milancermak", "createdAt": "2020-09-24T20:30:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDUwMTgwNg=="}], "type": "inlineReview"}, {"oid": "8ec126f701a3c3ca24e6e19b4f92dc596c0c8a50", "url": "https://github.com/apache/beam/commit/8ec126f701a3c3ca24e6e19b4f92dc596c0c8a50", "message": "Fixes formatting", "committedDate": "2020-09-24T19:13:37Z", "type": "commit"}, {"oid": "d469f878212e1f327be6956fb8212e982cb7c868", "url": "https://github.com/apache/beam/commit/d469f878212e1f327be6956fb8212e982cb7c868", "message": "Renaming and moving the retry function to utils.retry", "committedDate": "2020-09-24T20:28:12Z", "type": "commit"}, {"oid": "34c8a13bef969ba25078aa4896d6404be56289e4", "url": "https://github.com/apache/beam/commit/34c8a13bef969ba25078aa4896d6404be56289e4", "message": "Fix", "committedDate": "2020-09-24T20:48:35Z", "type": "commit"}, {"oid": "ad5157aec1359c9ecb0d7059f912cc8077d805d0", "url": "https://github.com/apache/beam/commit/ad5157aec1359c9ecb0d7059f912cc8077d805d0", "message": "Removing now unnecessary qualifier", "committedDate": "2020-09-24T22:24:13Z", "type": "commit"}]}