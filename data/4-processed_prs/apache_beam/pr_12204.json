{"pr_number": 12204, "pr_title": "[BEAM-10431] Add missing step name in graphite metrics sink messages.", "pr_createdAt": "2020-07-09T09:36:47Z", "pr_url": "https://github.com/apache/beam/pull/12204", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE4ODc0MA==", "url": "https://github.com/apache/beam/pull/12204#discussion_r452188740", "bodyText": "What is a reason for this and all other similar changes (like n1 -> n1.s1)?", "author": "aromanenko-dev", "createdAt": "2020-07-09T12:43:21Z", "path": "runners/extensions-java/metrics/src/test/java/org/apache/beam/runners/extensions/metrics/MetricsGraphiteSinkTest.java", "diffHunk": "@@ -69,20 +69,20 @@ public void testWriteMetricsWithCommittedSupported() throws Exception {\n     countDownLatch.await();\n     String join = String.join(\"\\n\", graphiteServer.getMessages());\n     String regexpr =\n-        \"beam.counter.ns1.n1.committed.value 10 [0-9]+\\\\n\"\n-            + \"beam.counter.ns1.n1.attempted.value 20 [0-9]+\\\\n\"\n-            + \"beam.gauge.ns1.n3.committed.value 100 [0-9]+\\\\n\"\n-            + \"beam.gauge.ns1.n3.attempted.value 120 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.committed.min 5 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.attempted.min 3 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.committed.max 8 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.attempted.max 9 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.committed.count 2 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.attempted.count 4 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.committed.sum 10 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.attempted.sum 25 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.committed.mean 5.0 [0-9]+\\\\n\"\n-            + \"beam.distribution.ns1.n2.attempted.mean 6.25 [0-9]+\";\n+        \"beam.counter.ns1.n1.s1.committed.value 10 [0-9]+\\\\n\"", "originalCommit": "7cd3d7d8aae33d40b6c9251e174e6d116ad56e0a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjIzOTA2OQ==", "url": "https://github.com/apache/beam/pull/12204#discussion_r452239069", "bodyText": "s1 is the step that declares the counter, s2 the step that declares distribution and s3 is the step that declares gauge.\nAll the point of this PR is to add missing step names in the graphite sink message format. So we need to update the test as well to expect the step names in the output.", "author": "echauchot", "createdAt": "2020-07-09T13:59:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE4ODc0MA=="}], "type": "inlineReview"}, {"oid": "e9f4268c6643c769662da7440b0b325574fc0b34", "url": "https://github.com/apache/beam/commit/e9f4268c6643c769662da7440b0b325574fc0b34", "message": "[BEAM-10431] Add missing step name in graphite metrics sink messages.", "committedDate": "2020-07-09T13:55:27Z", "type": "commit"}, {"oid": "e9f4268c6643c769662da7440b0b325574fc0b34", "url": "https://github.com/apache/beam/commit/e9f4268c6643c769662da7440b0b325574fc0b34", "message": "[BEAM-10431] Add missing step name in graphite metrics sink messages.", "committedDate": "2020-07-09T13:55:27Z", "type": "forcePushed"}]}