{"pr_number": 12534, "pr_title": "[BEAM-9547] Implement some methods for deferred Series.", "pr_createdAt": "2020-08-11T19:39:30Z", "pr_url": "https://github.com/apache/beam/pull/12534", "timeline": [{"oid": "b7f44ff17dbacc6a4b4843d7ae0003d1f1b9444b", "url": "https://github.com/apache/beam/commit/b7f44ff17dbacc6a4b4843d7ae0003d1f1b9444b", "message": "[BEAM-9547] Implement some methods for deferred Series.\n\nNow less than 50% of the pandas doctests are skipped.", "committedDate": "2020-08-11T19:34:43Z", "type": "commit"}, {"oid": "b0dc9be295bb472e224c870cf5fedb62e60d8400", "url": "https://github.com/apache/beam/commit/b0dc9be295bb472e224c870cf5fedb62e60d8400", "message": "lint", "committedDate": "2020-08-13T00:34:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNTk3NQ==", "url": "https://github.com/apache/beam/pull/12534#discussion_r470205975", "bodyText": "Only tangentially related to this PR, but I realized the docstring for ComputedExpression is slightly incorrect: \n  \n    \n      beam/sdks/python/apache_beam/dataframe/expressions.py\n    \n    \n         Line 202\n      in\n      a098130\n    \n    \n    \n    \n\n        \n          \n                 requires_partition_by_index: Whether this expression requires its", "author": "ibzib", "createdAt": "2020-08-13T19:46:31Z", "path": "sdks/python/apache_beam/dataframe/frames.py", "diffHunk": "@@ -29,9 +29,46 @@ def __array__(self, dtype=None):\n     raise frame_base.WontImplementError(\n         'Conversion to a non-deferred a numpy array.')\n \n+  astype = frame_base._elementwise_method('astype')\n+\n+  between = frame_base._elementwise_method('between')\n+\n+  @frame_base.args_to_kwargs(pd.Series)\n+  @frame_base.populate_defaults(pd.Series)\n+  @frame_base.maybe_inplace\n+  def dropna(self, **kwargs):\n+    return frame_base.DeferredFrame.wrap(\n+        expressions.ComputedExpression(\n+            'dropna',\n+            lambda df: df.dropna(**kwargs), [self._expr],\n+            preserves_partition_by=partitionings.Singleton(),\n+            requires_partition_by=partitionings.Nothing()))", "originalCommit": "b0dc9be295bb472e224c870cf5fedb62e60d8400", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMxMTgyNA==", "url": "https://github.com/apache/beam/pull/12534#discussion_r470311824", "bodyText": "Ah, yeah, that wasn't updated when the arguments chagned. Fixed.", "author": "robertwb", "createdAt": "2020-08-13T23:59:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNTk3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMxMjk5NA==", "url": "https://github.com/apache/beam/pull/12534#discussion_r470312994", "bodyText": "Thanks!", "author": "ibzib", "createdAt": "2020-08-14T00:04:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNTk3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNzU5OQ==", "url": "https://github.com/apache/beam/pull/12534#discussion_r470207599", "bodyText": "What is \"doctest issue\" referring to? Is it worth filing a JIRA?", "author": "ibzib", "createdAt": "2020-08-13T19:49:49Z", "path": "sdks/python/apache_beam/dataframe/pandas_doctests_test.py", "diffHunk": "@@ -156,19 +157,14 @@ def test_series_tests(self):\n             'pandas.core.series.Series.repeat': ['*'],\n             'pandas.core.series.Series.replace': ['*'],\n             'pandas.core.series.Series.reset_index': ['*'],\n-            'pandas.core.series.Series.round': ['*'],\n-            'pandas.core.series.Series.searchsorted': ['*'],\n-            'pandas.core.series.Series.shift': ['*'],\n+            'pandas.core.series.Series.searchsorted': ['*'],  # doctest issue", "originalCommit": "b0dc9be295bb472e224c870cf5fedb62e60d8400", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMxMjE4OA==", "url": "https://github.com/apache/beam/pull/12534#discussion_r470312188", "bodyText": "I haven't dug into this too much, but it seems to be an issue in the underlying doctest parsing code. I've narrowed it down and added a better comment.", "author": "robertwb", "createdAt": "2020-08-14T00:01:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDIwNzU5OQ=="}], "type": "inlineReview"}, {"oid": "bb5e07e787773a5082d695457e339f1a2186bf37", "url": "https://github.com/apache/beam/commit/bb5e07e787773a5082d695457e339f1a2186bf37", "message": "Merge branch 'master' into dataframes-series", "committedDate": "2020-08-13T23:52:06Z", "type": "commit"}, {"oid": "288e1819e237149bfeb6792d9808a85dc025631a", "url": "https://github.com/apache/beam/commit/288e1819e237149bfeb6792d9808a85dc025631a", "message": "fix docstring, narrow doctest skipping", "committedDate": "2020-08-13T23:59:10Z", "type": "commit"}, {"oid": "6aa2368974dee9610da430ee88c3b172e5fbd21b", "url": "https://github.com/apache/beam/commit/6aa2368974dee9610da430ee88c3b172e5fbd21b", "message": "typo", "committedDate": "2020-08-14T00:00:43Z", "type": "commit"}]}