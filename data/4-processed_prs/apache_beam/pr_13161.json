{"pr_number": 13161, "pr_title": "fix: Fix split() logic for PubsubLiteIO", "pr_createdAt": "2020-10-21T18:08:42Z", "pr_url": "https://github.com/apache/beam/pull/13161", "timeline": [{"oid": "8cc104ceef2dc449cb28d5ecd0638091c9f5599b", "url": "https://github.com/apache/beam/commit/8cc104ceef2dc449cb28d5ecd0638091c9f5599b", "message": "fix: Fix split() logic for PubsubliteIO to split to `desiredNumSplits` groups instead of groups of size `desiredNumSplits`", "committedDate": "2020-10-21T18:07:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY1MjAzNQ==", "url": "https://github.com/apache/beam/pull/13161#discussion_r509652035", "bodyText": "We can use min(desiredNumSplits, subscriberOptions.partitions().length()) as the actual nums of split.", "author": "boyuanzz", "createdAt": "2020-10-21T20:13:41Z", "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/pubsublite/PubsubLiteUnboundedSource.java", "diffHunk": "@@ -53,9 +53,17 @@\n   @Override\n   public List<? extends UnboundedSource<SequencedMessage, OffsetCheckpointMark>> split(\n       int desiredNumSplits, PipelineOptions options) {\n+    ArrayList<ArrayList<Partition>> partitionPartitions = new ArrayList<>(desiredNumSplits);", "originalCommit": "8cc104ceef2dc449cb28d5ecd0638091c9f5599b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU3ODQ4MA==", "url": "https://github.com/apache/beam/pull/13161#discussion_r522578480", "bodyText": "Done.", "author": "dpcollins-google", "createdAt": "2020-11-13T02:52:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY1MjAzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY2MjI4MA==", "url": "https://github.com/apache/beam/pull/13161#discussion_r509662280", "bodyText": "We can use for (int index = 0 ; index < length; index++) to get ride of counter.", "author": "boyuanzz", "createdAt": "2020-10-21T20:21:08Z", "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/pubsublite/PubsubLiteUnboundedSource.java", "diffHunk": "@@ -53,9 +53,17 @@\n   @Override\n   public List<? extends UnboundedSource<SequencedMessage, OffsetCheckpointMark>> split(\n       int desiredNumSplits, PipelineOptions options) {\n+    ArrayList<ArrayList<Partition>> partitionPartitions = new ArrayList<>(desiredNumSplits);\n+    for (int i = 0; i < desiredNumSplits; i++) {\n+      partitionPartitions.add(new ArrayList<>());\n+    }\n+    int counter = 0;\n+    for (Partition partition : subscriberOptions.partitions()) {", "originalCommit": "8cc104ceef2dc449cb28d5ecd0638091c9f5599b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU3ODU3Nw==", "url": "https://github.com/apache/beam/pull/13161#discussion_r522578577", "bodyText": "No, you can't: subscriberOptions.partitions() is a Set.", "author": "dpcollins-google", "createdAt": "2020-11-13T02:52:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY2MjI4MA=="}], "type": "inlineReview"}, {"oid": "c2b8c24f23404f47485b395c35e630018604e32a", "url": "https://github.com/apache/beam/commit/c2b8c24f23404f47485b395c35e630018604e32a", "message": "fix: Fix nit", "committedDate": "2020-11-13T02:52:10Z", "type": "commit"}, {"oid": "4a378bff7442c6e8b3dbf881036e358958208eb5", "url": "https://github.com/apache/beam/commit/4a378bff7442c6e8b3dbf881036e358958208eb5", "message": "fix: run spotless", "committedDate": "2020-11-13T02:57:53Z", "type": "commit"}]}