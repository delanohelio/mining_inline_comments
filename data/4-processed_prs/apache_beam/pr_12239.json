{"pr_number": 12239, "pr_title": "[BEAM-9980] dataflow test-suite tasks tied with Python versions configurable", "pr_createdAt": "2020-07-13T17:24:39Z", "pr_url": "https://github.com/apache/beam/pull/12239", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI5NTkxMw==", "url": "https://github.com/apache/beam/pull/12239#discussion_r458295913", "bodyText": "I am not sure I understand which suites we include in this postcommit suite and how we select which version are high priority.", "author": "tvalentyn", "createdAt": "2020-07-21T18:15:05Z", "path": "build.gradle", "diffHunk": "@@ -243,13 +241,16 @@ task pythonFormatterPreCommit() {\n   dependsOn 'sdks:python:test-suites:tox:py38:formatter'\n }\n \n+task pythonPostCommit() {", "originalCommit": "53e5b7746dca97939487f1cf73b1c927a55ac3a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUwNzA1MQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r460507051", "bodyText": "This task pythonPostCommit aims to trigger tasks whose python versions defined in gradle.properties, which should not to be triggered by PostCommit tasks with versions like python2PostCommit.\nWe must reconsider this task configuration when introducing high/low priority.\nDid I answer your comment?", "author": "lazylynx", "createdAt": "2020-07-26T10:05:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI5NTkxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkwOTQzMA==", "url": "https://github.com/apache/beam/pull/12239#discussion_r463909430", "bodyText": "(missed this comment) I think I understand what you mean.\nLet's consider a contributor who is adding a new test or test suite that needs to run in postcommit (after PR is merged). How would they configure their suite? Looking at this file it may not be obvious, for example hdfs test suite is added in PostCommit and Py38 PostCommit but MongoDBIO suite is only defined in PostCommit.\nHow can we make the configuration more straightforward?\nWe should also consider what guidance we can give contributors when to create a new jenkins job and when to add to add to existing postcommit jobs. For example we have a separate job for MongoDB IO, but do not for HDFS, probably because both tests were added by different people and the configuration was not easy to figure out.", "author": "tvalentyn", "createdAt": "2020-08-01T02:29:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI5NTkxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkxMDczNw==", "url": "https://github.com/apache/beam/pull/12239#discussion_r463910737", "bodyText": "I think adding a new Jenkins job in this PR might add more confusion until we clarify how to reconcile this suite with other postcommit suites.\nHow about we keep the test suites in the jenkins jobs where they are defined right now, but make the python versions configurable in the gradle.properties file? This would allow us to merge most of these changes faster, including the refactoring to use suites definitions from common.gradle.\nLater we can reconsider the shapes of Jenkins job when we define High Priortity/Low priority versions.", "author": "tvalentyn", "createdAt": "2020-08-01T02:39:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI5NTkxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDUzMjAwNQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r464532005", "bodyText": "Thank you for detail description.\nIt did not occur to me.", "author": "lazylynx", "createdAt": "2020-08-03T16:43:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI5NTkxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM1MTY0NQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r460351645", "bodyText": "This is a great reduction of  chaos in our test configurations! This would be super helpful for Python 2 deprecation.", "author": "tvalentyn", "createdAt": "2020-07-25T02:10:53Z", "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,39 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites", "originalCommit": "53e5b7746dca97939487f1cf73b1c927a55ac3a5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "4001d5b211b8a483f98c7e3b4c5025da8aaab914", "url": "https://github.com/apache/beam/commit/4001d5b211b8a483f98c7e3b4c5025da8aaab914", "message": "[BEAM-9980] update portable test-suites to switch python versions using in tests", "committedDate": "2020-07-30T15:06:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg5MDA5Ng==", "url": "https://github.com/apache/beam/pull/12239#discussion_r463890096", "bodyText": "Can enablePythonPerformanceTest() be moved to common.gradle as well?", "author": "tvalentyn", "createdAt": "2020-07-31T23:52:07Z", "path": "sdks/python/test-suites/dataflow/py37/build.gradle", "diffHunk": "@@ -20,10 +20,6 @@ apply plugin: org.apache.beam.gradle.BeamModulePlugin\n applyPythonNature()\n enablePythonPerformanceTest()", "originalCommit": "7daa16c59ef13763ff08a3b4d5898eecaed40a84", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDUzNDY1NQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r464534655", "bodyText": "Moved.\nAnd addPortableWordCountTasks() in portable test-suites is also moved to common.gradle, which is invoked at every build.gradle under py* dirs in the test-suites.", "author": "lazylynx", "createdAt": "2020-08-03T16:48:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg5MDA5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkwODUyMQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r463908521", "bodyText": "Note that this is a load test, and we also have integration test suite: \n  \n    \n      beam/.test-infra/jenkins/job_PostCommit_Python_MongoDBIO_IT.groovy\n    \n    \n         Line 35\n      in\n      d971ba1\n    \n    \n    \n    \n\n        \n          \n           tasks(':sdks:python:test-suites:direct:py35:mongodbioIT')", "author": "tvalentyn", "createdAt": "2020-08-01T02:21:59Z", "path": ".test-infra/jenkins/job_PostCommit_Python_MongoDBIO_Load_Test.groovy", "diffHunk": "@@ -51,7 +51,7 @@ job(jobName) {\n       rootBuildScriptDir(common.checkoutDir)\n       common.setGradleSwitches(delegate)\n       switches(\"-Popts=\\'${common.mapToArgString(pipelineOptions)}\\'\")\n-      tasks(\":sdks:python:test-suites:dataflow:py35:mongodbioIT\")\n+      tasks(\":sdks:python:test-suites:dataflow:mongodbioIT\")", "originalCommit": "7daa16c59ef13763ff08a3b4d5898eecaed40a84", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkxMTU5NQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r463911595", "bodyText": "I think for a reader getListProperty name might be confusing  and they would have to look up the implementation. We could consider the name getVersionsAsList or use getProperty('dataflow_precommit_it_task_py_versions').split(',').each directly.", "author": "tvalentyn", "createdAt": "2020-08-01T02:47:31Z", "path": "sdks/python/test-suites/dataflow/build.gradle", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: org.apache.beam.gradle.BeamModulePlugin\n+applyPythonNature()\n+\n+dependencies {\n+  distTarBall project(path: \":sdks:python\", configuration: \"distTarBall\")\n+}\n+\n+task preCommitIT {\n+  getListProperty('dataflow_precommit_it_task_py_versions').each {", "originalCommit": "4001d5b211b8a483f98c7e3b4c5025da8aaab914", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDUzNjA3MQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r464536071", "bodyText": "Quite so. I use getVersionsAsList instead of getListProperty.", "author": "lazylynx", "createdAt": "2020-08-03T16:51:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzkxMTU5NQ=="}], "type": "inlineReview"}, {"oid": "81b3b07952231659f9ac5840925b9cc563507cd0", "url": "https://github.com/apache/beam/commit/81b3b07952231659f9ac5840925b9cc563507cd0", "message": "[BEAM-9980] add groovy functions for python versions", "committedDate": "2020-08-03T15:31:25Z", "type": "commit"}, {"oid": "e1f69d72b577aacef2e8ac905298f494723210cc", "url": "https://github.com/apache/beam/commit/e1f69d72b577aacef2e8ac905298f494723210cc", "message": "[BEAM-9980] update dataflow test-suites to switch python versions using in tests", "committedDate": "2020-08-03T16:16:00Z", "type": "commit"}, {"oid": "0f9aadb69a2a273627cbc96e2387dc34bc424d81", "url": "https://github.com/apache/beam/commit/0f9aadb69a2a273627cbc96e2387dc34bc424d81", "message": "[BEAM-9980] update portable test-suites to switch python versions using in tests", "committedDate": "2020-08-03T16:20:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAxMjMwMQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r466012301", "bodyText": "why do we need build.gradle in addition to common.grade?", "author": "tvalentyn", "createdAt": "2020-08-05T21:23:27Z", "path": "sdks/python/test-suites/dataflow/build.gradle", "diffHunk": "@@ -0,0 +1,50 @@\n+/*", "originalCommit": "e1f69d72b577aacef2e8ac905298f494723210cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAxNTI3OQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r466015279", "bodyText": "Nevermind, I see that they both serve a different purpose.", "author": "tvalentyn", "createdAt": "2020-08-05T21:29:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAxMjMwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAxNjk0Ng==", "url": "https://github.com/apache/beam/pull/12239#discussion_r466016946", "bodyText": "It seems that we need to make changes to the top-level suite definitions, e.g. : \n  \n    \n      beam/build.gradle\n    \n    \n         Line 216\n      in\n      ba38027\n    \n    \n    \n    \n\n        \n          \n           task pythonPreCommit() { \n        \n    \n  \n\n\nto point to /test-suites//build.gradle files.", "author": "tvalentyn", "createdAt": "2020-08-05T21:33:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAxMjMwMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjUzMTgyNg==", "url": "https://github.com/apache/beam/pull/12239#discussion_r466531826", "bodyText": "I've rollbacked too much.\nMade top level build.gradle tasks depend on test-suites ones AMAP.", "author": "lazylynx", "createdAt": "2020-08-06T16:21:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAxMjMwMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0Njc0NQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r467346745", "bodyText": "We can remove this comment.", "author": "tvalentyn", "createdAt": "2020-08-08T01:50:00Z", "path": "build.gradle", "diffHunk": "@@ -220,13 +220,12 @@ task pythonPreCommit() {\n   dependsOn \":sdks:python:test-suites:tox:py36:preCommitPy36\"\n   dependsOn \":sdks:python:test-suites:tox:py37:preCommitPy37\"\n   dependsOn \":sdks:python:test-suites:tox:py38:preCommitPy38\"\n-  dependsOn \":sdks:python:test-suites:dataflow:py2:preCommitIT\"\n-  dependsOn \":sdks:python:test-suites:dataflow:py2:preCommitIT_V2\"\n-  dependsOn \":sdks:python:test-suites:dataflow:py37:preCommitIT\"\n-  dependsOn \":sdks:python:test-suites:dataflow:py37:preCommitIT_V2\"\n-  // We don't include Py35, Py36 precommit ITs to reduce quota footprint.\n-  // We can reconsider if we ever see an issue that these suites would\n-  // have caught. Note that the same tests will still run in postcommit.\n+  dependsOn \":sdks:python:test-suites:dataflow:preCommitIT\"\n+  dependsOn \":sdks:python:test-suites:dataflow:preCommitIT_V2\"\n+  // We don't include all supported Python versions precommit ITs to", "originalCommit": "099ceddd70854bbca003fe00bc85a992ffa1e158", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0OTc5OQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r467349799", "bodyText": "OK, removed.", "author": "lazylynx", "createdAt": "2020-08-08T02:21:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0Njc0NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0ODI3MQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r467348271", "bodyText": "I'm not sure I follow this change - this is currently still a python2 PostCommit suite, so it should include py2 only tests.\nHowever you could convert the targets that are not version-specific, such as\ntask portablePythonPreCommit() \ntask pythonSparkPostCommit() \n\nto point to portable/build.gradle", "author": "tvalentyn", "createdAt": "2020-08-08T02:05:37Z", "path": "build.gradle", "diffHunk": "@@ -248,9 +247,9 @@ task pythonFormatterPreCommit() {\n \n task python2PostCommit() {\n   dependsOn \":sdks:python:test-suites:portable:py2:crossLanguagePythonJavaKafkaIOFlink\"\n-  dependsOn \":sdks:python:test-suites:portable:py2:crossLanguageTests\"\n+  dependsOn \":sdks:python:test-suites:portable:crossLanguageTests\"", "originalCommit": "099ceddd70854bbca003fe00bc85a992ffa1e158", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0OTc2NQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r467349765", "bodyText": "restored crossLanguageTests and directRunnerIT to py2 only.", "author": "lazylynx", "createdAt": "2020-08-08T02:21:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0ODI3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM1MjgyMw==", "url": "https://github.com/apache/beam/pull/12239#discussion_r467352823", "bodyText": "Let's modify https://github.com/apache/beam/blob/master/.test-infra/jenkins/job_PostCommit_Python_MongoDBIO_IT.groovy as well to point to direct/build.gradle.\nAlso, it seems like there is a duplication in MongoDBIO suites. I think we can remove the separate jenkins Job for MongoDB IO and include it into the direct runner suites in a separate change.\nAlso we can add version specifiers for MongoDB performance tests in another change.", "author": "tvalentyn", "createdAt": "2020-08-08T02:57:40Z", "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5\n+dataflow_chicago_taxi_example_task_py_versions=2.7\n+\n+# direct test-suites\n+hdfs_integration_test_task_py_versions=2.7,3.8\n+direct_mongodbio_it_task_py_versions=2.7,3.5", "originalCommit": "a3146e6e5f72d4d1590f33c8cec24bc2845d3ccc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzg3OTY4NQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r467879685", "bodyText": "Updated beam_PostCommit_Python_MongoDBIO_IT.groovy\n\nI think we can remove the separate jenkins Job for MongoDB IO and include it into the direct runner suites in a separate change.\n\nYou mean job_PostCommit_Python_MongoDBIO_IT and job_PostCommit_Python_MongoDBIO_Load_Test are to be moved to direct runner suites? @tvalentyn", "author": "lazylynx", "createdAt": "2020-08-10T12:49:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM1MjgyMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI5MDU0Mg==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468290542", "bodyText": "I think MongoDB IO can run with Direct runner postcommit, similar to HDFS IO. job_PostCommit_Python_MongoDBIO_Load_Test can be a separate job, for which we control the version in settings.gradle.", "author": "tvalentyn", "createdAt": "2020-08-11T02:29:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM1MjgyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI5ODExNg==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468298116", "bodyText": "it looks like portable test suite configurations currently don't not have any effect, because the tasks from portable/build.gradle are not referenced in any groovy files or top-level tasks.  let's not add these configs and not add /portable/build.gradle in this change, and make those changes once we are ready to switch to using tasks from portable/build.gradle.\nIn current form, configs in portable section make an illusion that they control the versions of suites being used, but they currently don't.", "author": "tvalentyn", "createdAt": "2020-08-11T02:58:22Z", "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5\n+dataflow_chicago_taxi_example_task_py_versions=2.7\n+\n+# direct test-suites\n+hdfs_integration_test_task_py_versions=2.7,3.8\n+direct_mongodbio_it_task_py_versions=2.7,3.5\n+direct_runner_it_task_py_versions=2.7\n+\n+# portable test-suites\n+cross_language_task_py_versions=2.7", "originalCommit": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwMTEwMw==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468301103", "bodyText": "I don't think we have a dataflow MongoDB suite - I only see a direct runner suite.", "author": "tvalentyn", "createdAt": "2020-08-11T03:10:25Z", "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5", "originalCommit": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTM4ODAxMQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r469388011", "bodyText": "dataflow MongoDB suite is used here:\nhttps://github.com/apache/beam/blob/master/.test-infra/jenkins/job_PostCommit_Python_MongoDBIO_Load_Test.groovy#L54", "author": "lazylynx", "createdAt": "2020-08-12T16:28:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwMTEwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQwNjU4Nw==", "url": "https://github.com/apache/beam/pull/12239#discussion_r469406587", "bodyText": "I see, thanks for correction. Then we could keep this setting, but, add it together with the changes in Groovy file.", "author": "tvalentyn", "createdAt": "2020-08-12T16:59:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwMTEwMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwMzc5OQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468303799", "bodyText": "Does this configuration have any effect?", "author": "tvalentyn", "createdAt": "2020-08-11T03:22:11Z", "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5\n+dataflow_chicago_taxi_example_task_py_versions=2.7", "originalCommit": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwMzg0Nw==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468303847", "bodyText": "Does this configuration have any effect?", "author": "tvalentyn", "createdAt": "2020-08-11T03:22:23Z", "path": "sdks/python/test-suites/gradle.properties", "diffHunk": "@@ -0,0 +1,38 @@\n+################################################################################\n+#  Licensed to the Apache Software Foundation (ASF) under one\n+#  or more contributor license agreements.  See the NOTICE file\n+#  distributed with this work for additional information\n+#  regarding copyright ownership.  The ASF licenses this file\n+#  to you under the Apache License, Version 2.0 (the\n+#  \"License\"); you may not use this file except in compliance\n+#  with the License.  You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+#  Unless required by applicable law or agreed to in writing, software\n+#  distributed under the License is distributed on an \"AS IS\" BASIS,\n+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+#  See the License for the specific language governing permissions and\n+# limitations under the License.\n+################################################################################\n+\n+# Following properties define which Python versions be used when the tests running.\n+# Versions must be indicated major and minor versions connected with period.\n+# And if you want to use multiple versions, concat them with comma and no whitespace.\n+\n+# dataflow test-suites\n+dataflow_precommit_it_task_py_versions=2.7,3.7\n+dataflow_mongodbio_it_task_py_versions=3.5\n+dataflow_chicago_taxi_example_task_py_versions=2.7\n+\n+# direct test-suites\n+hdfs_integration_test_task_py_versions=2.7,3.8", "originalCommit": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNDIxNg==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468304216", "bodyText": "This task appears to be unused.", "author": "tvalentyn", "createdAt": "2020-08-11T03:24:06Z", "path": "sdks/python/test-suites/direct/build.gradle", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+plugins { id 'org.apache.beam.module' }\n+applyPythonNature()\n+\n+task directRunnerIT {", "originalCommit": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNDI0Mw==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468304243", "bodyText": "This task appears to be unused.", "author": "tvalentyn", "createdAt": "2020-08-11T03:24:17Z", "path": "sdks/python/test-suites/direct/build.gradle", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+plugins { id 'org.apache.beam.module' }\n+applyPythonNature()\n+\n+task directRunnerIT {\n+  getVersionsAsList('direct_runner_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:direct:py${getVersionSuffix(it)}:directRunnerIT\")\n+  }\n+}\n+\n+task hdfsIntegrationTest {", "originalCommit": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNTA4NQ==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468305085", "bodyText": "Please also take a look at other build.gradle files, let's only add new tasks when we connect them with top-level test tasks or groovy files that trigger test suites.", "author": "tvalentyn", "createdAt": "2020-08-11T03:27:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNDI0Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwNDM2OA==", "url": "https://github.com/apache/beam/pull/12239#discussion_r468304368", "bodyText": "This task appears to be unused", "author": "tvalentyn", "createdAt": "2020-08-11T03:24:47Z", "path": "sdks/python/test-suites/dataflow/build.gradle", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * License); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an AS IS BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+apply plugin: org.apache.beam.gradle.BeamModulePlugin\n+applyPythonNature()\n+\n+dependencies {\n+  distTarBall project(path: \":sdks:python\", configuration: \"distTarBall\")\n+}\n+\n+task preCommitIT {\n+  getVersionsAsList('dataflow_precommit_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:preCommitIT_batch\")\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:preCommitIT_streaming\")\n+  }\n+}\n+\n+task preCommitIT_V2{\n+  getVersionsAsList('dataflow_precommit_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:preCommitIT_batch_V2\")\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:preCommitIT_streaming_V2\")\n+  }\n+}\n+\n+task mongodbioIT {\n+  getVersionsAsList('dataflow_mongodbio_it_task_py_versions').each {\n+    dependsOn.add(\":sdks:python:test-suites:dataflow:py${getVersionSuffix(it)}:mongodbioIT\")\n+  }\n+}\n+\n+task chicagoTaxiExample {", "originalCommit": "0a89a2593c494cfc8dc5fc0d6f54b28c65f371ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dd7dda28a5bb85f6e73f47a0e3898db11a97ef0e", "url": "https://github.com/apache/beam/commit/dd7dda28a5bb85f6e73f47a0e3898db11a97ef0e", "message": "[BEAM-9980] version switchable dataflow tasks to be invoked", "committedDate": "2020-08-12T16:52:17Z", "type": "commit"}, {"oid": "e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a", "url": "https://github.com/apache/beam/commit/e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a", "message": "[BEAM-9980] :sdks:python:test-suites:dataflow included in settings.gradle", "committedDate": "2020-08-12T16:54:11Z", "type": "commit"}, {"oid": "e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a", "url": "https://github.com/apache/beam/commit/e665cc23cb9938328aa6ee6e96fc1fd5c3e7f62a", "message": "[BEAM-9980] :sdks:python:test-suites:dataflow included in settings.gradle", "committedDate": "2020-08-12T16:54:11Z", "type": "forcePushed"}]}