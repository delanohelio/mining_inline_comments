{"pr_number": 12260, "pr_title": "[BEAM-10486] Update OffsetRestrictionTracker to honor failed claim attempt marking the claim as done when checkpointing.", "pr_createdAt": "2020-07-15T02:02:01Z", "pr_url": "https://github.com/apache/beam/pull/12260", "timeline": [{"oid": "f2b35a45bc7032c691ff43f4e7b50afa9b6fd883", "url": "https://github.com/apache/beam/commit/f2b35a45bc7032c691ff43f4e7b50afa9b6fd883", "message": "[BEAM-10486] Update OffsetRestrictionTracker to honor failed claim attempt marking the claim as done when checkpointing.\n\nAlso fix check_done being implicitly done for empty ranges.", "committedDate": "2020-07-15T01:59:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NTY2Nw==", "url": "https://github.com/apache/beam/pull/12260#discussion_r454785667", "bodyText": "self._last_claim_attempt could be None.  You may want to have self._range.start != self._range.stop and (self._last_claim_attemp is None or self._last_claim_attempt < self._range.stop - 1)", "author": "boyuanzz", "createdAt": "2020-07-15T04:35:26Z", "path": "sdks/python/apache_beam/io/restriction_trackers.py", "diffHunk": "@@ -92,7 +92,8 @@ def __init__(self, offset_range):\n     self._checkpointed = False\n \n   def check_done(self):\n-    if self._last_claim_attempt < self._range.stop - 1:\n+    if (self._range.start != self._range.stop and\n+        self._last_claim_attempt < self._range.stop - 1):", "originalCommit": "f2b35a45bc7032c691ff43f4e7b50afa9b6fd883", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc5ODcxMA==", "url": "https://github.com/apache/beam/pull/12260#discussion_r454798710", "bodyText": "Good point", "author": "lukecwik", "createdAt": "2020-07-15T05:21:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NTY2Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDgwMzU0Ng==", "url": "https://github.com/apache/beam/pull/12260#discussion_r454803546", "bodyText": "Fixed", "author": "lukecwik", "createdAt": "2020-07-15T05:38:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDc4NTY2Nw=="}], "type": "inlineReview"}, {"oid": "3452e9b29e1ee3fd05e9d70c4c4322f5ab8d56f6", "url": "https://github.com/apache/beam/commit/3452e9b29e1ee3fd05e9d70c4c4322f5ab8d56f6", "message": "fixup! Address PR comments", "committedDate": "2020-07-15T05:34:59Z", "type": "commit"}]}