{"pr_number": 11836, "pr_title": "Adding ServiceBusManagementClient and builder.", "pr_createdAt": "2020-06-05T22:16:46Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/11836", "timeline": [{"oid": "5691712e214052cfeb7140cad6ac86c638ec1a2d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5691712e214052cfeb7140cad6ac86c638ec1a2d", "message": "Adding public clients.", "committedDate": "2020-06-05T20:45:11Z", "type": "commit"}, {"oid": "9261853cf8c100b2405a51ddcf3210272055a3da", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9261853cf8c100b2405a51ddcf3210272055a3da", "message": "Adding builder and runtime info", "committedDate": "2020-06-05T22:15:43Z", "type": "commit"}, {"oid": "0a4768346cbf073d6a95171ccf1502cdc4c4af88", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0a4768346cbf073d6a95171ccf1502cdc4c4af88", "message": "Add tests for sync client", "committedDate": "2020-06-05T23:00:23Z", "type": "commit"}, {"oid": "18b662099f243fe9d8fe1dec908a8adfb660b8ca", "url": "https://github.com/Azure/azure-sdk-for-java/commit/18b662099f243fe9d8fe1dec908a8adfb660b8ca", "message": "Making policy constructor public.", "committedDate": "2020-06-05T23:05:34Z", "type": "commit"}, {"oid": "cfb2d50c717903d673dd86ca697e033e52b7bc2c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cfb2d50c717903d673dd86ca697e033e52b7bc2c", "message": "Making classes final.", "committedDate": "2020-06-05T23:05:53Z", "type": "commit"}, {"oid": "173d4e72a9a539eb51aa386077108c6ed087c0d5", "url": "https://github.com/Azure/azure-sdk-for-java/commit/173d4e72a9a539eb51aa386077108c6ed087c0d5", "message": "Adding async client tests.", "committedDate": "2020-06-06T00:08:56Z", "type": "commit"}, {"oid": "83f7b733c448c3643f992f5c85f7b684e9555945", "url": "https://github.com/Azure/azure-sdk-for-java/commit/83f7b733c448c3643f992f5c85f7b684e9555945", "message": "Adding null check for empty body feeds.", "committedDate": "2020-06-06T00:09:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE4OTc4Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11836#discussion_r436189782", "bodyText": "Deletes a queue with matching {@code queueName}.", "author": "hemanttanwar", "createdAt": "2020-06-05T22:20:12Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusManagementClient.java", "diffHunk": "@@ -0,0 +1,202 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.core.annotation.ReturnType;\n+import com.azure.core.annotation.ServiceClient;\n+import com.azure.core.annotation.ServiceMethod;\n+import com.azure.core.http.rest.PagedFlux;\n+import com.azure.core.http.rest.PagedIterable;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.util.Context;\n+import com.azure.messaging.servicebus.models.QueueDescription;\n+import com.azure.messaging.servicebus.models.QueueRuntimeInfo;\n+\n+import java.util.Objects;\n+\n+/**\n+ * A <b>synchronous</b> client for managing a Service Bus namespace.\n+ *\n+ * @see ServiceBusManagementAsyncClient ServiceBusManagementAsyncClient for an asynchronous client.\n+ */\n+@ServiceClient(builder = ServiceBusManagementClientBuilder.class)\n+public class ServiceBusManagementClient {\n+    private final ServiceBusManagementAsyncClient asyncClient;\n+\n+    /**\n+     * Creates a new instance with the given client.\n+     *\n+     * @param asyncClient Asynchronous client to perform management calls through.\n+     */\n+    ServiceBusManagementClient(ServiceBusManagementAsyncClient asyncClient) {\n+        this.asyncClient = Objects.requireNonNull(asyncClient, \"'asyncClient' cannot be null.\");\n+    }\n+\n+    /**\n+     * Creates a queue the {@link QueueDescription}.\n+     *\n+     * @param queue Information about the queue to create.\n+     *\n+     * @return The created queue.\n+     * @throws NullPointerException if {@code queue} is null.\n+     * @throws IllegalArgumentException if {@link QueueDescription#getName() queue.getName()} is null or an empty\n+     *     string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public QueueDescription createQueue(QueueDescription queue) {\n+        return asyncClient.createQueue(queue).block();\n+    }\n+\n+    /**\n+     * Creates a queue and returns the created queue in addition to the HTTP response.\n+     *\n+     * @param queue The queue to create.\n+     * @param context Additional context that is passed through the HTTP pipeline during the service call.\n+     *\n+     * @return The created queue in addition to the HTTP response.\n+     * @throws NullPointerException if {@code queue} is null.\n+     * @throws IllegalArgumentException if {@link QueueDescription#getName() queue.getName()} is null or an empty\n+     *     string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Response<QueueDescription> createQueueWithResponse(QueueDescription queue, Context context) {\n+        return asyncClient.createQueueWithResponse(queue, context).block();\n+    }\n+\n+    /**\n+     * Deletes a queue the matching {@code queueName}.", "originalCommit": "9261853cf8c100b2405a51ddcf3210272055a3da", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIxMjQ0OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11836#discussion_r436212448", "bodyText": "Package-private method  : I have never seen that writing in java doc, it is evident from the fact that there is no qualifier.\nI am fine with this but it is not usual.", "author": "hemanttanwar", "createdAt": "2020-06-06T00:09:15Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusManagementAsyncClient.java", "diffHunk": "@@ -0,0 +1,619 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.core.annotation.ReturnType;\n+import com.azure.core.annotation.ServiceClient;\n+import com.azure.core.annotation.ServiceMethod;\n+import com.azure.core.http.HttpHeaders;\n+import com.azure.core.http.HttpRequest;\n+import com.azure.core.http.rest.PagedFlux;\n+import com.azure.core.http.rest.PagedResponse;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.http.rest.SimpleResponse;\n+import com.azure.core.util.Context;\n+import com.azure.core.util.IterableStream;\n+import com.azure.core.util.logging.ClientLogger;\n+import com.azure.messaging.servicebus.implementation.QueuesImpl;\n+import com.azure.messaging.servicebus.implementation.ServiceBusManagementClientImpl;\n+import com.azure.messaging.servicebus.implementation.ServiceBusManagementSerializer;\n+import com.azure.messaging.servicebus.implementation.models.CreateQueueBody;\n+import com.azure.messaging.servicebus.implementation.models.CreateQueueBodyContent;\n+import com.azure.messaging.servicebus.implementation.models.QueueDescriptionFeed;\n+import com.azure.messaging.servicebus.implementation.models.ResponseLink;\n+import com.azure.messaging.servicebus.models.QueueDescription;\n+import com.azure.messaging.servicebus.models.QueueRuntimeInfo;\n+import reactor.core.Exceptions;\n+import reactor.core.publisher.Mono;\n+\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLDecoder;\n+import java.nio.charset.StandardCharsets;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.Objects;\n+import java.util.Optional;\n+import java.util.stream.Collectors;\n+\n+import static com.azure.core.util.FluxUtil.monoError;\n+import static com.azure.core.util.FluxUtil.withContext;\n+import static com.azure.core.util.tracing.Tracer.AZ_TRACING_NAMESPACE_KEY;\n+\n+/**\n+ * An <b>asynchronous</b> client for managing a Service Bus namespace.\n+ *\n+ * @see ServiceBusManagementClient ServiceBusManagementClient for a synchronous client.\n+ */\n+@ServiceClient(builder = ServiceBusManagementClientBuilder.class, isAsync = true)\n+public final class ServiceBusManagementAsyncClient {\n+    // See https://docs.microsoft.com/azure/azure-resource-manager/management/azure-services-resource-providers\n+    // for more information on Azure resource provider namespaces.\n+    private static final String SERVICE_BUS_TRACING_NAMESPACE_VALUE = \"Microsoft.ServiceBus\";\n+    // Name of the entity type when listing queues.\n+    private static final String QUEUES_ENTITY_TYPE = \"queues\";\n+    private static final int NUMBER_OF_ELEMENTS = 10;\n+\n+    private final ServiceBusManagementClientImpl managementClient;\n+    private final QueuesImpl queuesClient;\n+    private final ClientLogger logger = new ClientLogger(ServiceBusManagementAsyncClient.class);\n+    private final ServiceBusManagementSerializer serializer;\n+\n+    /**\n+     * Creates a new instance with the given management client and serializer.\n+     *\n+     * @param managementClient Client to make management calls.\n+     * @param serializer Serializer to deserialize ATOM XML responses.\n+     */\n+    ServiceBusManagementAsyncClient(ServiceBusManagementClientImpl managementClient,\n+        ServiceBusManagementSerializer serializer) {\n+        this.managementClient = Objects.requireNonNull(managementClient, \"'managementClient' cannot be null.\");\n+        this.queuesClient = managementClient.getQueues();\n+        this.serializer = serializer;\n+    }\n+\n+    /**\n+     * Creates a queue the {@link QueueDescription}.\n+     *\n+     * @param queue Information about the queue to create.\n+     *\n+     * @return A Mono that completes with information about the created queue.\n+     * @throws NullPointerException if {@code queue} is null.\n+     * @throws IllegalArgumentException if {@link QueueDescription#getName() queue.getName()} is null or an empty\n+     *     string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<QueueDescription> createQueue(QueueDescription queue) {\n+        return createQueueWithResponse(queue).map(Response::getValue);\n+    }\n+\n+    /**\n+     * Creates a queue and returns the created queue in addition to the HTTP response.\n+     *\n+     * @param queue The queue to create.\n+     *\n+     * @return A Mono that returns the created queue in addition to the HTTP response.\n+     * @throws NullPointerException if {@code queue} is null.\n+     * @throws IllegalArgumentException if {@link QueueDescription#getName() queue.getName()} is null or an empty\n+     *     string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Response<QueueDescription>> createQueueWithResponse(QueueDescription queue) {\n+        return withContext(context -> createQueueWithResponse(queue, context));\n+    }\n+\n+    /**\n+     * Deletes a queue the matching {@code queueName}.\n+     *\n+     * @param queueName Name of queue to delete.\n+     *\n+     * @return A Mono that completes when the queue is deleted.\n+     * @throws NullPointerException if {@code queueName} is null.\n+     * @throws IllegalArgumentException if {@code queueName} is an empty string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Void> deleteQueue(String queueName) {\n+        return deleteQueueWithResponse(queueName).then();\n+    }\n+\n+    /**\n+     * Deletes a queue the matching {@code queueName} and returns the HTTP response.\n+     *\n+     * @param queueName Name of queue to delete.\n+     *\n+     * @return A Mono that completes when the queue is deleted and returns the HTTP response.\n+     * @throws NullPointerException if {@code queueName} is null.\n+     * @throws IllegalArgumentException if {@code queueName} is an empty string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Response<Void>> deleteQueueWithResponse(String queueName) {\n+        return withContext(context -> deleteQueueWithResponse(queueName, context));\n+    }\n+\n+    /**\n+     * Gets information about the queue.\n+     *\n+     * @param queueName Name of queue to get information about.\n+     *\n+     * @return A Mono that completes with information about the queue.\n+     * @throws NullPointerException if {@code queueName} is null or an empty string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<QueueDescription> getQueue(String queueName) {\n+        return getQueueWithResponse(queueName).map(Response::getValue);\n+    }\n+\n+    /**\n+     * Gets information about the queue along with its HTTP response.\n+     *\n+     * @param queueName Name of queue to get information about.\n+     *\n+     * @return A Mono that completes with information about the queue and the associated HTTP response.\n+     * @throws NullPointerException if {@code queueName} is null or an empty string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Response<QueueDescription>> getQueueWithResponse(String queueName) {\n+        return withContext(context -> getQueueWithResponse(queueName, context));\n+    }\n+\n+    /**\n+     * Gets runtime information about the queue.\n+     *\n+     * @param queueName Name of queue to get information about.\n+     *\n+     * @return A Mono that completes with runtime information about the queue.\n+     * @throws NullPointerException if {@code queueName} is null or an empty string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<QueueRuntimeInfo> getQueueRuntimeInfo(String queueName) {\n+        return getQueueWithResponse(queueName).map(response -> new QueueRuntimeInfo(response.getValue()));\n+    }\n+\n+    /**\n+     * Gets runtime information about the queue along with its HTTP response.\n+     *\n+     * @param queueName Name of queue to get information about.\n+     *\n+     * @return A Mono that completes with runtime information about the queue and the associated HTTP response.\n+     * @throws NullPointerException if {@code queueName} is null or an empty string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Response<QueueRuntimeInfo>> getQueueRuntimeInfoWithResponse(String queueName) {\n+        return withContext(context -> getQueueRuntimeInfoWithResponse(queueName, context));\n+    }\n+\n+    /**\n+     * Fetches all the queues in the Service Bus namespace.\n+     *\n+     * @return A Flux of {@link QueueDescription queues} in the Service Bus namespace.\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PagedFlux<QueueDescription> listQueues() {\n+        return new PagedFlux<>(\n+            () -> withContext(context -> listQueuesFirstPage(context)),\n+            token -> withContext(context -> listQueuesNextPage(token, context)));\n+    }\n+\n+    /**\n+     * Creates a queue the {@link QueueDescription}.\n+     *\n+     * @param queue Information about the queue to create.\n+     *\n+     * @return A Mono that completes with information about the created queue.\n+     * @throws NullPointerException if {@code queue} is null.\n+     * @throws IllegalArgumentException if {@link QueueDescription#getName() queue.getName()} is null or an empty\n+     *     string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<QueueDescription> updateQueue(QueueDescription queue) {\n+        return updateQueueWithResponse(queue).map(Response::getValue);\n+    }\n+\n+    /**\n+     * Creates a queue and returns the created queue in addition to the HTTP response.\n+     *\n+     * @param queue The queue to create.\n+     *\n+     * @return A Mono that returns the created queue in addition to the HTTP response.\n+     * @throws NullPointerException if {@code queue} is null.\n+     * @throws IllegalArgumentException if {@link QueueDescription#getName() queue.getName()} is null or an empty\n+     *     string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public Mono<Response<QueueDescription>> updateQueueWithResponse(QueueDescription queue) {\n+        return withContext(context -> updateQueueWithResponse(queue, context));\n+    }\n+\n+    /**\n+     * Package-private method that creates a queue with its context.\n+     *\n+     * @param queue Queue to create.\n+     * @param context Context to pass into request.\n+     *\n+     * @return A Mono that completes with the created {@link QueueDescription}.\n+     */\n+    Mono<Response<QueueDescription>> createQueueWithResponse(QueueDescription queue, Context context) {\n+        if (queue == null) {\n+            return monoError(logger, new NullPointerException(\"'queue' cannot be null\"));\n+        } else if (queue.getName() == null || queue.getName().isEmpty()) {\n+            return monoError(logger, new IllegalArgumentException(\"'queue.getName' cannot be null or empty.\"));\n+        } else if (context == null) {\n+            return monoError(logger, new NullPointerException(\"'context' cannot be null.\"));\n+        }\n+\n+        final CreateQueueBodyContent content = new CreateQueueBodyContent()\n+            .setType(\"application/xml\")\n+            .setQueueDescription(queue);\n+        final CreateQueueBody createEntity = new CreateQueueBody()\n+            .setContent(content);\n+\n+        context.addData(AZ_TRACING_NAMESPACE_KEY, SERVICE_BUS_TRACING_NAMESPACE_VALUE);\n+\n+        try {\n+            return queuesClient.putWithResponseAsync(queue.getName(), createEntity, null, context)\n+                .map(response -> deserializeQueue(response, queue.getName()));\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Package-private method that deletes a queue with its context.\n+     *\n+     * @param queueName Name of queue to delete.\n+     * @param context Context to pass into request.\n+     *\n+     * @return A Mono that completes with the created {@link QueueDescription}.\n+     */\n+    Mono<Response<Void>> deleteQueueWithResponse(String queueName, Context context) {\n+        if (queueName == null) {\n+            return monoError(logger, new NullPointerException(\"'queueName' cannot be null\"));\n+        } else if (queueName.isEmpty()) {\n+            return monoError(logger, new IllegalArgumentException(\"'queueName' cannot be empty.\"));\n+        } else if (context == null) {\n+            return monoError(logger, new NullPointerException(\"'context' cannot be null.\"));\n+        }\n+\n+        context.addData(AZ_TRACING_NAMESPACE_KEY, SERVICE_BUS_TRACING_NAMESPACE_VALUE);\n+\n+        try {\n+            return queuesClient.deleteWithResponseAsync(queueName, context)\n+                .map(response -> {\n+                    return new SimpleResponse<>(response.getRequest(), response.getStatusCode(),\n+                        response.getHeaders(), null);\n+                });\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Package-private method that gets a queue with its context.", "originalCommit": "cfb2d50c717903d673dd86ca697e033e52b7bc2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIxMjkyMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11836#discussion_r436212921", "bodyText": "queueDescription  as  arg name will be more appropriate ?", "author": "hemanttanwar", "createdAt": "2020-06-06T00:12:21Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusManagementClient.java", "diffHunk": "@@ -0,0 +1,202 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.core.annotation.ReturnType;\n+import com.azure.core.annotation.ServiceClient;\n+import com.azure.core.annotation.ServiceMethod;\n+import com.azure.core.http.rest.PagedFlux;\n+import com.azure.core.http.rest.PagedIterable;\n+import com.azure.core.http.rest.Response;\n+import com.azure.core.util.Context;\n+import com.azure.messaging.servicebus.models.QueueDescription;\n+import com.azure.messaging.servicebus.models.QueueRuntimeInfo;\n+\n+import java.util.Objects;\n+\n+/**\n+ * A <b>synchronous</b> client for managing a Service Bus namespace.\n+ *\n+ * @see ServiceBusManagementAsyncClient ServiceBusManagementAsyncClient for an asynchronous client.\n+ */\n+@ServiceClient(builder = ServiceBusManagementClientBuilder.class)\n+public final class ServiceBusManagementClient {\n+    private final ServiceBusManagementAsyncClient asyncClient;\n+\n+    /**\n+     * Creates a new instance with the given client.\n+     *\n+     * @param asyncClient Asynchronous client to perform management calls through.\n+     */\n+    ServiceBusManagementClient(ServiceBusManagementAsyncClient asyncClient) {\n+        this.asyncClient = Objects.requireNonNull(asyncClient, \"'asyncClient' cannot be null.\");\n+    }\n+\n+    /**\n+     * Creates a queue the {@link QueueDescription}.\n+     *\n+     * @param queue Information about the queue to create.\n+     *\n+     * @return The created queue.\n+     * @throws NullPointerException if {@code queue} is null.\n+     * @throws IllegalArgumentException if {@link QueueDescription#getName() queue.getName()} is null or an empty\n+     *     string.\n+     */\n+    @ServiceMethod(returns = ReturnType.SINGLE)\n+    public QueueDescription createQueue(QueueDescription queue) {\n+        return asyncClient.createQueue(queue).block();", "originalCommit": "cfb2d50c717903d673dd86ca697e033e52b7bc2c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIzNDUzNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11836#discussion_r436234535", "bodyText": "Went with .NET's parameter name.", "author": "conniey", "createdAt": "2020-06-06T03:49:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIxMjkyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjIxMzE4Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11836#discussion_r436213182", "bodyText": "Should we check for endpoint could be null and throw NPE ?", "author": "hemanttanwar", "createdAt": "2020-06-06T00:14:15Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusManagementClientBuilder.java", "diffHunk": "@@ -0,0 +1,326 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.messaging.servicebus;\n+\n+import com.azure.core.amqp.implementation.ConnectionStringProperties;\n+import com.azure.core.annotation.ServiceClientBuilder;\n+import com.azure.core.credential.TokenCredential;\n+import com.azure.core.exception.AzureException;\n+import com.azure.core.http.HttpClient;\n+import com.azure.core.http.HttpPipeline;\n+import com.azure.core.http.HttpPipelineBuilder;\n+import com.azure.core.http.policy.AddDatePolicy;\n+import com.azure.core.http.policy.AddHeadersFromContextPolicy;\n+import com.azure.core.http.policy.HttpLogDetailLevel;\n+import com.azure.core.http.policy.HttpLogOptions;\n+import com.azure.core.http.policy.HttpLoggingPolicy;\n+import com.azure.core.http.policy.HttpPipelinePolicy;\n+import com.azure.core.http.policy.HttpPolicyProviders;\n+import com.azure.core.http.policy.RequestIdPolicy;\n+import com.azure.core.http.policy.RetryPolicy;\n+import com.azure.core.http.policy.UserAgentPolicy;\n+import com.azure.core.util.Configuration;\n+import com.azure.core.util.CoreUtils;\n+import com.azure.core.util.logging.ClientLogger;\n+import com.azure.messaging.servicebus.implementation.ServiceBusConstants;\n+import com.azure.messaging.servicebus.implementation.ServiceBusManagementClientImpl;\n+import com.azure.messaging.servicebus.implementation.ServiceBusManagementClientImplBuilder;\n+import com.azure.messaging.servicebus.implementation.ServiceBusManagementSerializer;\n+import com.azure.messaging.servicebus.implementation.ServiceBusSharedKeyCredential;\n+import com.azure.messaging.servicebus.implementation.ServiceBusTokenCredentialHttpPolicy;\n+\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Objects;\n+\n+/**\n+ * This class provides a fluent builder API to help aid the configuration and instantiation of {@link\n+ * ServiceBusManagementClient} and {@link ServiceBusManagementAsyncClient}. Call {@link #buildClient() buildClient} and\n+ * {@link #buildAsyncClient() buildAsyncClient} respectively to construct an instance of the desired client.\n+ *\n+ * @see ServiceBusManagementClient\n+ * @see ServiceBusManagementAsyncClient\n+ */\n+@ServiceClientBuilder(serviceClients = {ServiceBusManagementClient.class, ServiceBusManagementAsyncClient.class})\n+public class ServiceBusManagementClientBuilder {\n+    // We only allow one service version because the ATOM API was brought forward for legacy reasons.\n+    private static final String API_VERSION = \"2017-04\";\n+    private final ClientLogger logger = new ClientLogger(ServiceBusManagementClientBuilder.class);\n+    private final ServiceBusManagementSerializer serializer = new ServiceBusManagementSerializer();\n+    private final List<HttpPipelinePolicy> policies = new ArrayList<>();\n+    private final Map<String, String> properties =\n+        CoreUtils.getProperties(\"azure-messaging-servicebus.properties\");\n+\n+    private Configuration configuration;\n+\n+    // Endpoint of the Service Bus resource. It will be the fully-qualified domain name of the Service Bus namespace.\n+    private String endpoint;\n+    private HttpClient httpClient;\n+    private HttpLogOptions httpLogOptions = new HttpLogOptions();\n+    private HttpPipeline pipeline;\n+    private HttpPipelinePolicy retryPolicy;\n+    private TokenCredential tokenCredential;\n+\n+    /**\n+     * Constructs a builder with the default parameters.\n+     */\n+    public ServiceBusManagementClientBuilder() {\n+    }\n+\n+    /**\n+     * Creates a {@link ServiceBusManagementAsyncClient} based on options set in the builder. Every time {@code\n+     * buildAsyncClient} is invoked, a new instance of the client is created.\n+     *\n+     * <p>If {@link #pipeline(HttpPipeline) pipeline} is set, then the {@code pipeline} and\n+     * {@link #endpoint(String) endpoint} are used to create the {@link ServiceBusManagementAsyncClient client}. All\n+     * other builder settings are ignored.</p>\n+     *\n+     * @return A {@link ServiceBusManagementAsyncClient} with the options set in the builder.\n+     * @throws NullPointerException if {@code endpoint} has not been set. This is automatically set when {@link\n+     *     #connectionString(String) connectionString} is set. Or, explicitly through {@link #endpoint(String)}.\n+     * @throws IllegalStateException If {@link #connectionString(String) connectionString} has not been set.\n+     */\n+    public ServiceBusManagementAsyncClient buildAsyncClient() {\n+        if (endpoint == null) {\n+            throw new NullPointerException(\"'endpoint' cannot be null.\");\n+        }\n+\n+        final HttpPipeline httpPipeline = buildPipeline();\n+        final ServiceBusManagementClientImpl client = new ServiceBusManagementClientImplBuilder()\n+            .pipeline(httpPipeline)\n+            .serializer(serializer)\n+            .endpoint(endpoint)\n+            .apiVersion(API_VERSION)\n+            .buildClient();\n+\n+        return new ServiceBusManagementAsyncClient(client, serializer);\n+    }\n+\n+    /**\n+     * Creates a {@link ServiceBusManagementClient} based on options set in the builder. Every time {@code\n+     * buildAsyncClient} is invoked, a new instance of the client is created.\n+     *\n+     * <p>If {@link #pipeline(HttpPipeline) pipeline} is set, then the {@code pipeline} and\n+     * {@link #endpoint(String) endpoint} are used to create the {@link ServiceBusManagementClient client}. All other\n+     * builder settings are ignored.</p>\n+     *\n+     * @return A {@link ServiceBusManagementClient} with the options set in the builder.\n+     * @throws NullPointerException if {@code endpoint} has not been set. This is automatically set when {@link\n+     *     #connectionString(String) connectionString} is set. Or it can be set explicitly through {@link\n+     *     #endpoint(String)}.\n+     * @throws IllegalStateException If {@link #connectionString(String) connectionString} has not been set.\n+     */\n+    public ServiceBusManagementClient buildClient() {\n+        return new ServiceBusManagementClient(buildAsyncClient());\n+    }\n+\n+    /**\n+     * Adds a policy to the set of existing policies that are executed after required policies.\n+     *\n+     * @param policy The retry policy for service requests.\n+     *\n+     * @return The updated {@link ServiceBusManagementClientBuilder} object.\n+     * @throws NullPointerException If {@code policy} is {@code null}.\n+     */\n+    public ServiceBusManagementClientBuilder addPolicy(HttpPipelinePolicy policy) {\n+        Objects.requireNonNull(policy);\n+        policies.add(policy);\n+        return this;\n+    }\n+\n+    /**\n+     * Sets the service endpoint for the Service Bus namespace.\n+     *\n+     * @param endpoint The URL of the Service Bus namespace.\n+     *\n+     * @return The updated {@link ServiceBusManagementClientBuilder} object.\n+     * @throws IllegalArgumentException if {@code endpoint} is null or it cannot be parsed into a valid URL.\n+     */\n+    public ServiceBusManagementClientBuilder endpoint(String endpoint) {\n+        try {", "originalCommit": "cfb2d50c717903d673dd86ca697e033e52b7bc2c", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "30086a370cad54556241940b0bbc8b2dac2e2bfe", "url": "https://github.com/Azure/azure-sdk-for-java/commit/30086a370cad54556241940b0bbc8b2dac2e2bfe", "message": "Update methods to check endpoint and not use JDK 11 features.", "committedDate": "2020-06-06T03:53:59Z", "type": "commit"}, {"oid": "82fc18cccd84e982947ba832d5fee6247bb735c1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/82fc18cccd84e982947ba832d5fee6247bb735c1", "message": "Regenerating AuthorizationRule.", "committedDate": "2020-06-06T03:59:31Z", "type": "commit"}, {"oid": "c370f3de3389cbe8215e58efc45184904ace7702", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c370f3de3389cbe8215e58efc45184904ace7702", "message": "Remove JDK 10 call.", "committedDate": "2020-06-06T04:20:04Z", "type": "commit"}, {"oid": "d07e17c3aaa46a5df55bc2e8b5d22c21709c54ce", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d07e17c3aaa46a5df55bc2e8b5d22c21709c54ce", "message": "Adding test.", "committedDate": "2020-06-06T04:42:03Z", "type": "commit"}, {"oid": "a8e80022033d69e2ccc956103532a0e59d88ef68", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a8e80022033d69e2ccc956103532a0e59d88ef68", "message": "Fixing encoding bug.", "committedDate": "2020-06-06T07:24:54Z", "type": "commit"}, {"oid": "018262711a3ddaccb21f02f2f46adb71f6b46408", "url": "https://github.com/Azure/azure-sdk-for-java/commit/018262711a3ddaccb21f02f2f46adb71f6b46408", "message": "Fixing test for azure-core SerializerEncodingTests.", "committedDate": "2020-06-06T07:27:59Z", "type": "commit"}, {"oid": "0be7e011d7f2d7cbffdebfb9da4c598a305c3820", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0be7e011d7f2d7cbffdebfb9da4c598a305c3820", "message": "Adding documentation.", "committedDate": "2020-06-06T07:31:44Z", "type": "commit"}, {"oid": "021e7eea58122b25621d633c60217562276c57e7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/021e7eea58122b25621d633c60217562276c57e7", "message": "Fix error mapping.", "committedDate": "2020-06-06T07:36:33Z", "type": "commit"}, {"oid": "4c3f58eee2d2693e0fd5d24a57578e4d160b66b4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4c3f58eee2d2693e0fd5d24a57578e4d160b66b4", "message": "Remove unneeded new line", "committedDate": "2020-06-06T07:38:03Z", "type": "commit"}, {"oid": "a1c95e736fd809eee4cb75f62093cbffa1aa0b8a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a1c95e736fd809eee4cb75f62093cbffa1aa0b8a", "message": "Fix checkstyle issues.", "committedDate": "2020-06-06T07:56:10Z", "type": "commit"}, {"oid": "0f7df897d10ecad2dac5b09ee1f46192d209bc9a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0f7df897d10ecad2dac5b09ee1f46192d209bc9a", "message": "Fix spotbugs", "committedDate": "2020-06-06T07:59:57Z", "type": "commit"}, {"oid": "f47245713dc6f0ee8b8ab78a68f6eece5c6d228a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f47245713dc6f0ee8b8ab78a68f6eece5c6d228a", "message": "Add session records", "committedDate": "2020-06-06T20:10:31Z", "type": "commit"}]}