{"pr_number": 7121, "pr_title": "connectionString() method should throw IllegalArgurmentException", "pr_createdAt": "2020-01-04T01:39:12Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/7121", "timeline": [{"oid": "15051f07682e635a9a30a51c64227a61fe9418b0", "url": "https://github.com/Azure/azure-sdk-for-java/commit/15051f07682e635a9a30a51c64227a61fe9418b0", "message": "throw IllegalArgException", "committedDate": "2020-01-04T01:32:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzM5Nzk2Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7121#discussion_r363397966", "bodyText": "According to the design spec, null should throw NullPointerException and isEmpty should throw IllegalArgumentException. I'd split this into two steps.\nhttps://azure.github.io/azure-sdk/java_implementation.html#java-errors-system-errors", "author": "conniey", "createdAt": "2020-01-06T17:31:41Z", "path": "sdk/appconfiguration/azure-data-appconfiguration/src/main/java/com/azure/data/appconfiguration/ConfigurationClientBuilder.java", "diffHunk": "@@ -239,25 +239,26 @@ public ConfigurationClientBuilder endpoint(String endpoint) {\n      * @param connectionString Connection string in the format \"endpoint={endpoint_value};id={id_value};\n      * secret={secret_value}\"\n      * @return The updated ConfigurationClientBuilder object.\n-     * @throws NullPointerException If {@code credential} is {@code null}.\n+     * @throws IllegalArgumentException if {@code connectionString} is null or an empty string. Or the secret is\n+     * invalid and cannot instantiate HMAC-SHA256 MAC algorithm.\n      */\n     public ConfigurationClientBuilder connectionString(String connectionString) {\n-        Objects.requireNonNull(connectionString);\n+        if (CoreUtils.isNullOrEmpty(connectionString)) {", "originalCommit": "15051f07682e635a9a30a51c64227a61fe9418b0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "34c113d4b9aa1d71467b9731b7f54194df711720", "url": "https://github.com/Azure/azure-sdk-for-java/commit/34c113d4b9aa1d71467b9731b7f54194df711720", "message": "split null pointer exception and illegal argument exception", "committedDate": "2020-01-06T17:37:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwMzAyMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7121#discussion_r363403020", "bodyText": "No change required in this PR.\nDo our Checkstyle rules need to be updated to catch this missing case? It looks like the IllegalArgumentException has been getting thrown for a while but never documented, we have a Checkstyle rule that should failed PR validation due to this.", "author": "alzimmermsft", "createdAt": "2020-01-06T17:45:21Z", "path": "sdk/appconfiguration/azure-data-appconfiguration/src/main/java/com/azure/data/appconfiguration/ConfigurationClientBuilder.java", "diffHunk": "@@ -239,25 +239,29 @@ public ConfigurationClientBuilder endpoint(String endpoint) {\n      * @param connectionString Connection string in the format \"endpoint={endpoint_value};id={id_value};\n      * secret={secret_value}\"\n      * @return The updated ConfigurationClientBuilder object.\n-     * @throws NullPointerException If {@code credential} is {@code null}.\n+     * @throws NullPointerException If {@code connectionString} is {@code null}.\n+     * @throws IllegalArgumentException if {@code connectionString} is an empty string. Or the secret is invalid and", "originalCommit": "34c113d4b9aa1d71467b9731b7f54194df711720", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQzNTY3MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7121#discussion_r363435670", "bodyText": "created an issue to investigate it: #7147", "author": "mssfang", "createdAt": "2020-01-06T19:05:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwMzAyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwMzA3MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7121#discussion_r363403071", "bodyText": "You can replace this with connectionString.isEmpty(). No need to do another null check in CoreUtils.", "author": "conniey", "createdAt": "2020-01-06T17:45:28Z", "path": "sdk/appconfiguration/azure-data-appconfiguration/src/main/java/com/azure/data/appconfiguration/ConfigurationClientBuilder.java", "diffHunk": "@@ -239,25 +239,29 @@ public ConfigurationClientBuilder endpoint(String endpoint) {\n      * @param connectionString Connection string in the format \"endpoint={endpoint_value};id={id_value};\n      * secret={secret_value}\"\n      * @return The updated ConfigurationClientBuilder object.\n-     * @throws NullPointerException If {@code credential} is {@code null}.\n+     * @throws NullPointerException If {@code connectionString} is {@code null}.\n+     * @throws IllegalArgumentException if {@code connectionString} is an empty string. Or the secret is invalid and\n+     * cannot instantiate HMAC-SHA256 MAC algorithm.\n      */\n     public ConfigurationClientBuilder connectionString(String connectionString) {\n-        Objects.requireNonNull(connectionString);\n+        Objects.requireNonNull(connectionString, \"'connectionString' cannot be null.\");\n+\n+        if (CoreUtils.isNullOrEmpty(connectionString)) {", "originalCommit": "34c113d4b9aa1d71467b9731b7f54194df711720", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwNDE5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7121#discussion_r363404194", "bodyText": "Should this @throws statement be this?\n@throws IllegalArgumentException If {@code connectionString} is an empty string, the {@code connectionString} secret is invalid, or the HMAC-SHA256 MAC algorithm cannot be instantiated.\nMainly the second sentence is an issue since it isn't an and between an invalid secret and instantiating the algorithm but an or.", "author": "alzimmermsft", "createdAt": "2020-01-06T17:48:18Z", "path": "sdk/appconfiguration/azure-data-appconfiguration/src/main/java/com/azure/data/appconfiguration/ConfigurationClientBuilder.java", "diffHunk": "@@ -239,25 +239,29 @@ public ConfigurationClientBuilder endpoint(String endpoint) {\n      * @param connectionString Connection string in the format \"endpoint={endpoint_value};id={id_value};\n      * secret={secret_value}\"\n      * @return The updated ConfigurationClientBuilder object.\n-     * @throws NullPointerException If {@code credential} is {@code null}.\n+     * @throws NullPointerException If {@code connectionString} is {@code null}.\n+     * @throws IllegalArgumentException if {@code connectionString} is an empty string. Or the secret is invalid and\n+     * cannot instantiate HMAC-SHA256 MAC algorithm.", "originalCommit": "34c113d4b9aa1d71467b9731b7f54194df711720", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ade8a07b911381cb09e1d21464662b54dd7be0d6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ade8a07b911381cb09e1d21464662b54dd7be0d6", "message": "use isEmpty() instead", "committedDate": "2020-01-06T17:48:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQwNDU2Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/7121#discussion_r363404567", "bodyText": "Should we add in that the secret contained within the connection string is invalid? Right now this is too vague and being thrown from a black box scenario for anyone consuming this SDK.", "author": "alzimmermsft", "createdAt": "2020-01-06T17:49:15Z", "path": "sdk/appconfiguration/azure-data-appconfiguration/src/main/java/com/azure/data/appconfiguration/ConfigurationClientBuilder.java", "diffHunk": "@@ -239,25 +239,29 @@ public ConfigurationClientBuilder endpoint(String endpoint) {\n      * @param connectionString Connection string in the format \"endpoint={endpoint_value};id={id_value};\n      * secret={secret_value}\"\n      * @return The updated ConfigurationClientBuilder object.\n-     * @throws NullPointerException If {@code credential} is {@code null}.\n+     * @throws NullPointerException If {@code connectionString} is {@code null}.\n+     * @throws IllegalArgumentException if {@code connectionString} is an empty string. Or the secret is invalid and\n+     * cannot instantiate HMAC-SHA256 MAC algorithm.\n      */\n     public ConfigurationClientBuilder connectionString(String connectionString) {\n-        Objects.requireNonNull(connectionString);\n+        Objects.requireNonNull(connectionString, \"'connectionString' cannot be null.\");\n+\n+        if (CoreUtils.isNullOrEmpty(connectionString)) {\n+            throw logger.logExceptionAsError(\n+                new IllegalArgumentException(\"'connectionString' cannot be an empty string.\"));\n+        }\n \n         try {\n             this.credential = new ConfigurationClientCredentials(connectionString);\n         } catch (InvalidKeyException err) {\n             throw logger.logExceptionAsError(new IllegalArgumentException(\n-                    \"The secret is invalid and cannot instantiate the HMAC-SHA256 algorithm.\", err));\n+                \"The secret is invalid and cannot instantiate the HMAC-SHA256 algorithm.\", err));", "originalCommit": "34c113d4b9aa1d71467b9731b7f54194df711720", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "fef3833f61d0d525d98e1eb63addce110e15cb8d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/fef3833f61d0d525d98e1eb63addce110e15cb8d", "message": "wording", "committedDate": "2020-01-06T17:55:50Z", "type": "commit"}]}