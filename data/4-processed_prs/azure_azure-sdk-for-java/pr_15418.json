{"pr_number": 15418, "pr_title": "update aad endpoints in readmes", "pr_createdAt": "2020-09-21T08:30:56Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/15418", "timeline": [{"oid": "ad0c293261de873434ff19bac74bfd9c9a564e13", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ad0c293261de873434ff19bac74bfd9c9a564e13", "message": "update aad endpoints in readmes", "committedDate": "2020-09-21T08:29:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg4OTQ0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491889446", "bodyText": "Why update azure-oauth-provider to azure? the provider name is azure-oauth-provider here, see L77", "author": "zhoufenqin", "createdAt": "2020-09-21T09:03:30Z", "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md", "diffHunk": "@@ -80,10 +80,10 @@ spring.security.oauth2.client.registration.azure.redirect-uri-template={baseUrl}\n spring.security.oauth2.client.registration.azure.client-authentication-method=basic\n spring.security.oauth2.client.registration.azure.authorization-grant-type=authorization_code\n \n-spring.security.oauth2.client.provider.azure-oauth-provider.authorization-uri=https://login.microsoftonline.com/common/oauth2/authorize\n-spring.security.oauth2.client.provider.azure-oauth-provider.token-uri=https://login.microsoftonline.com/common/oauth2/token\n-spring.security.oauth2.client.provider.azure-oauth-provider.user-info-uri=https://login.microsoftonline.com/common/openid/userinfo\n-spring.security.oauth2.client.provider.azure-oauth-provider.jwk-set-uri=https://login.microsoftonline.com/common/discovery/keys\n+spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/common/oauth2/v2.0/authorize", "originalCommit": "ad0c293261de873434ff19bac74bfd9c9a564e13", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg4OTk5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491889994", "bodyText": "I think there is an error here, spring.security.oauth2.client.registration.azure.redirect-uri-template should update to spring.security.oauth2.client.registration.azure.redirect-uri\nand do we need to add profile in spring.security.oauth2.client.registration.azure.scope?", "author": "zhoufenqin", "createdAt": "2020-09-21T09:04:31Z", "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md", "diffHunk": "@@ -80,10 +80,10 @@ spring.security.oauth2.client.registration.azure.redirect-uri-template={baseUrl}\n spring.security.oauth2.client.registration.azure.client-authentication-method=basic", "originalCommit": "ad0c293261de873434ff19bac74bfd9c9a564e13", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTkxODIzNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491918234", "bodyText": "yes, the profile needs to be updated too.", "author": "yiliuTo", "createdAt": "2020-09-21T09:50:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg4OTk5NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg5MDI3NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491890274", "bodyText": "same above", "author": "zhoufenqin", "createdAt": "2020-09-21T09:05:00Z", "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md", "diffHunk": "@@ -97,10 +97,10 @@ In this auto-configuration, by [default](https://github.com/Azure/azure-sdk-for-\n \n Configure endpoints with specific tenant-id by replacing `common` in your application.properties file:\n ```properties\n-spring.security.oauth2.client.provider.azure-oauth-provider.authorization-uri=https://login.microsoftonline.com/{your-tenant-id}/oauth2/authorize\n-spring.security.oauth2.client.provider.azure-oauth-provider.token-uri=https://login.microsoftonline.com/{your-tenant-id}/oauth2/token\n-spring.security.oauth2.client.provider.azure-oauth-provider.user-info-uri=https://login.microsoftonline.com/{your-tenant-id}/openid/userinfo\n-spring.security.oauth2.client.provider.azure-oauth-provider.jwk-set-uri=https://login.microsoftonline.com/{your-tenant-id}/discovery/keys\n+spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/common/oauth2/v2.0/authorize", "originalCommit": "ad0c293261de873434ff19bac74bfd9c9a564e13", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg5MTYxOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491891618", "bodyText": "Here I think we don't need to update {your-tenant-id} to common, see the description above. L90-93", "author": "zhoufenqin", "createdAt": "2020-09-21T09:07:22Z", "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend/README.md", "diffHunk": "@@ -92,10 +92,10 @@ In this auto-configuration, by [default](https://github.com/Azure/azure-sdk-for-\n \n Configure endpoints with specific tenant-id by replacing `common` in your application.properties file:\n ```properties\n-spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/{your-tenant-id}/oauth2/authorize\n-spring.security.oauth2.client.provider.azure.token-uri=https://login.microsoftonline.com/{your-tenant-id}/oauth2/token\n-spring.security.oauth2.client.provider.azure.user-info-uri=https://login.microsoftonline.com/{your-tenant-id}/openid/userinfo\n-spring.security.oauth2.client.provider.azure.jwk-set-uri=https://login.microsoftonline.com/{your-tenant-id}/discovery/keys\n+spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/common/oauth2/v2.0/authorize\n+spring.security.oauth2.client.provider.azure.token-uri=https://login.microsoftonline.com/common/oauth2/v2.0/token\n+spring.security.oauth2.client.provider.azure.user-info-uri=https://graph.microsoft.com/oidc/userinfo\n+spring.security.oauth2.client.provider.azure.jwk-set-uri=https://login.microsoftonline.com/common/discovery/v2.0/keys\n ```", "originalCommit": "ad0c293261de873434ff19bac74bfd9c9a564e13", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2645fe0ebc75d51005f167708c2b307b4b80d7a6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2645fe0ebc75d51005f167708c2b307b4b80d7a6", "message": "update property in readme from redirect-uri-template to redirect-uri", "committedDate": "2020-09-21T09:49:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk0Mzg5OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r491943898", "bodyText": "Do we need to show the v1 usage here @saragluna", "author": "zhoufenqin", "createdAt": "2020-09-21T10:37:40Z", "path": "sdk/spring/azure-spring-boot-starter-active-directory/README.md", "diffHunk": "@@ -199,12 +199,13 @@ azure.activedirectory.environment=cn-v2-graph\n Please refer to [azure-spring-boot-sample-active-directory-backend-v2](https://github.com/Azure/azure-sdk-for-java/blob/master/sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md) to see a sample configured to use the Microsoft Graph API.\n \n ### Using Microsoft identity platform endpoints\n-If you want to use v2 version endpoints to do authorization and authentication, please pay attention to the attributes of claims, because there are some attributes exists in v1 version id-token by default but not in v2 version id-token, if you have to get that attribute, please make sure to add it into your scope.\n-There is the doc [Difference between v1 and v2](https://docs.microsoft.com/azure/active-directory/develop/azure-ad-endpoint-comparison), For example, the name attribute doesn't exist in v2 token, if you want it, you need add `profile` to your scope, like this:\n-```properties\n-spring.security.oauth2.client.registration.azure.scope=openid, https://graph.microsoft.com/user.read, profile\n+This starter uses v2 version endpoints to do authorization and authentication by default. To use v1.0, please specify the following endpoints in properties.\n+```\n+spring.security.oauth2.client.provider.azure.authorization-uri=https://login.microsoftonline.com/common/oauth2/authorize\n+spring.security.oauth2.client.provider.azure.token-uri=https://login.microsoftonline.com/common/oauth2/token\n+spring.security.oauth2.client.provider.azure.user-info-uri=https://login.microsoftonline.com/common/openid/userinfo\n+spring.security.oauth2.client.provider.azure.jwk-set-uri=https://login.microsoftonline.com/common/discovery/keys\n ```", "originalCommit": "2645fe0ebc75d51005f167708c2b307b4b80d7a6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQzMjYzMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r492432633", "bodyText": "I suppose so, in case there are some users using v1 endpoints still.", "author": "yiliuTo", "createdAt": "2020-09-22T01:33:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk0Mzg5OA=="}], "type": "inlineReview"}, {"oid": "e697c3e71787b13951b1239f2eabcd8845b3314d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e697c3e71787b13951b1239f2eabcd8845b3314d", "message": "add section for replace endpoints of v1", "committedDate": "2020-09-21T12:15:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQzNDY2Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r492434667", "bodyText": "We already used azure-oauth-provider, to keep same style, should we use azure-client instead of azure here?\nRefs: https://docs.spring.io/spring-boot/docs/2.3.4.RELEASE/reference/html/spring-boot-features.html#boot-features-security-oauth2-client\nOr rename all azure-oauth-provider to azure.", "author": "chenrujun", "createdAt": "2020-09-22T01:43:05Z", "path": "sdk/spring/azure-spring-boot-samples/azure-spring-boot-sample-active-directory-backend-v2/README.md", "diffHunk": "@@ -75,15 +75,15 @@ spring.security.oauth2.client.registration.azure.client-id=xxxxxx-your-client-id\n spring.security.oauth2.client.registration.azure.client-secret=xxxxxx-your-client-secret-xxxxxx\n spring.security.oauth2.client.registration.azure.client-name=Azure\n spring.security.oauth2.client.registration.azure.provider=azure-oauth-provider\n-spring.security.oauth2.client.registration.azure.scope=openid, https://graph.microsoft.com/user.read\n-spring.security.oauth2.client.registration.azure.redirect-uri-template={baseUrl}/login/oauth2/code/{registrationId}\n+spring.security.oauth2.client.registration.azure.scope=openid, https://graph.microsoft.com/user.read, profile\n+spring.security.oauth2.client.registration.azure.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}", "originalCommit": "2645fe0ebc75d51005f167708c2b307b4b80d7a6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQzOTA0MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15418#discussion_r492439040", "bodyText": "I think both can make sense, let me replace azure to azure-oauth-client.", "author": "yiliuTo", "createdAt": "2020-09-22T02:03:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQzNDY2Nw=="}], "type": "inlineReview"}, {"oid": "5e60bc5516500ac37fb84a6cc0bb37f7bf08fe04", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5e60bc5516500ac37fb84a6cc0bb37f7bf08fe04", "message": "replace OAuth2ClientProperties name from azure to azure-oauth-client", "committedDate": "2020-09-22T02:04:46Z", "type": "commit"}]}