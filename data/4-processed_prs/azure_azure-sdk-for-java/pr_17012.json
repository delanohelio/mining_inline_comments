{"pr_number": 17012, "pr_title": "Sort artifact by order in docindex", "pr_createdAt": "2020-10-30T16:15:26Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/17012", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIzMzk0Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515233947", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                foreach ($serviceMapping in $tocContent.getEnumerator() | Sort Value | Sort Key) {\n          \n          \n            \n                    $artifact = $serviceMapping.Key\n          \n          \n            \n                    $serviceName = $serviceMapping.Value\n          \n          \n            \n                foreach ($artifact in ($tocContent.Keys | Sort-Object)) {\n          \n          \n            \n                    $serviceName = $tocContent[$artifact]\n          \n      \n    \n    \n  \n\nThis will sort all the packages but which cause them to be sorted on the individual service name.", "author": "weshaggard", "createdAt": "2020-10-30T16:46:37Z", "path": "eng/docgeneration/Generate-DocIndex.ps1", "diffHunk": "@@ -109,7 +109,7 @@ function GenerateDocfxTocContent([Hashtable]$tocContent, [String]$lang) {\n     New-Item -Path $YmlPath -Name \"toc.yml\" -Force\n     $visitedService = @{}\n     # Sort and display toc service name by alphabetical order.\n-    foreach ($serviceMapping in $tocContent.getEnumerator() | Sort Value) {\n+    foreach ($serviceMapping in $tocContent.getEnumerator() | Sort Value | Sort Key) {\n         $artifact = $serviceMapping.Key\n         $serviceName = $serviceMapping.Value", "originalCommit": "d1d5786feb0a8c8b9283833382c71ba7cd8cc55e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI0Mjc4NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515242784", "bodyText": "Right, toc.yml did not sort service name in the suggessted code.\nWe sort service name and write to toc.yml first, then we write the artifact into sdk.md file. So the best way is to sort the hashtable by value first and then sort by key.", "author": "sima-zhu", "createdAt": "2020-10-30T17:00:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIzMzk0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI0Mjg5MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515242890", "bodyText": "Actually if we depend on this to sort the service names as well we might want something closer to what you had.\nforeach ($serviceMapping in ($tocContent | Sort-Object Value, Key)) {", "author": "weshaggard", "createdAt": "2020-10-30T17:00:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIzMzk0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI0OTI2OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515249269", "bodyText": "Done with the change.", "author": "sima-zhu", "createdAt": "2020-10-30T17:10:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTIzMzk0Nw=="}], "type": "inlineReview"}, {"oid": "822bd370c23ca30a80625e7b5a2e98aacddcbc8e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/822bd370c23ca30a80625e7b5a2e98aacddcbc8e", "message": "Sort artifact by order for githubio", "committedDate": "2020-10-30T17:10:22Z", "type": "forcePushed"}, {"oid": "0525d51a62802ebb6bd508af557aaed9e941b277", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0525d51a62802ebb6bd508af557aaed9e941b277", "message": "Sort artifact by order for githubio", "committedDate": "2020-10-30T17:12:25Z", "type": "forcePushed"}, {"oid": "c8adb39838609b6ead92fc124ddb0c983d9cc703", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c8adb39838609b6ead92fc124ddb0c983d9cc703", "message": "Sort artifact by order for githubio", "committedDate": "2020-10-30T17:13:49Z", "type": "commit"}, {"oid": "c8adb39838609b6ead92fc124ddb0c983d9cc703", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c8adb39838609b6ead92fc124ddb0c983d9cc703", "message": "Sort artifact by order for githubio", "committedDate": "2020-10-30T17:13:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3MTEwMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515271103", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                foreach ($serviceMapping in ($tocContent.GetEnumerator() | Sort-Object Value, Key)) {\n          \n          \n            \n                foreach ($serviceMapping in ($tocContent | Sort-Object Value, Key)) {\n          \n      \n    \n    \n  \n\nI don't believe the explicit call to GetEnumerator() is needed.", "author": "weshaggard", "createdAt": "2020-10-30T17:38:56Z", "path": "eng/docgeneration/Generate-DocIndex.ps1", "diffHunk": "@@ -100,16 +100,16 @@ function GenerateDocfxTocContent([Hashtable]$tocContent, [String]$lang) {\n     LogDebug \"Initializing Default DocFx Site...\"\n     & $($DocFx) init -q -o \"${DocOutDir}\"\n     # The line below is used for testing in local\n-    # docfx init -q -o \"${DocOutDir}\"\n+    #docfx init -q -o \"${DocOutDir}\"\n     LogDebug \"Copying template and configuration...\"\n     New-Item -Path \"${DocOutDir}\" -Name \"templates\" -ItemType \"directory\" -Force\n     Copy-Item \"${DocGenDir}/templates/*\" -Destination \"${DocOutDir}/templates\" -Force -Recurse\n     Copy-Item \"${DocGenDir}/docfx.json\" -Destination \"${DocOutDir}/\" -Force\n     $YmlPath = \"${DocOutDir}/api\"\n     New-Item -Path $YmlPath -Name \"toc.yml\" -Force\n     $visitedService = @{}\n-    # Sort and display toc service name by alphabetical order.\n-    foreach ($serviceMapping in $tocContent.getEnumerator() | Sort Value) {\n+    # Sort and display toc service name by alphabetical order, and then sort artifact by order.\n+    foreach ($serviceMapping in ($tocContent.GetEnumerator() | Sort-Object Value, Key)) {", "originalCommit": "c8adb39838609b6ead92fc124ddb0c983d9cc703", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3MjAzOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515272039", "bodyText": "I tried in local. It is not working if not put getEnumerator(). Not sort in the right way, also not able to get the right $serviceMaping", "author": "sima-zhu", "createdAt": "2020-10-30T17:40:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3MTEwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3MjQ4Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515272486", "bodyText": "https://docs.microsoft.com/en-us/dotnet/api/system.collections.hashtable.getenumerator?view=netcore-3.1", "author": "sima-zhu", "createdAt": "2020-10-30T17:41:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3MTEwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3MjkzMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515272931", "bodyText": "It returns iterable objects", "author": "sima-zhu", "createdAt": "2020-10-30T17:42:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3MTEwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQwMjMwMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17012#discussion_r515402300", "bodyText": "OK I just double checked locally and your are correct. The normal iterator for hashtable is a little strange I guess that is why I usually just iterator over the Keys. However what you have here does work from my local testing so I'm good with it. It does allow for us to sort on both Key and Value.", "author": "weshaggard", "createdAt": "2020-10-30T22:03:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI3MTEwMw=="}], "type": "inlineReview"}]}