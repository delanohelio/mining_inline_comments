{"pr_number": 12524, "pr_title": "Update advanced samples for searching a specific field information", "pr_createdAt": "2020-06-26T03:19:04Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/12524", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk0Nzk1Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r445947953", "bodyText": "nit: weird formatting here", "author": "kristapratico", "createdAt": "2020-06-26T03:23:58Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/AdvancedDiffLabeledUnlabeledDataAsync.java", "diffHunk": "@@ -79,21 +89,36 @@ public static void main(String[] args) throws IOException {\n                 }\n             });\n \n-        //  The main difference is found in the labels of its fields\n-        // The form recognized with a labeled model will have the labels it was trained with,\n-        // the unlabeled one will be denoted with indices\n         System.out.println(\"--------Recognizing forms with labeled custom model--------\");\n+        // With a form recognized by a model trained with labels, the `formField.getName()` key will be its label\n+        // given during\n+        // training\n+        // `value` will contain the typed field value and `valueText` will contain information about the field value", "originalCommit": "1870b7fa96975fa889a9719e7b0c652aeb8e2690", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjAwMDM3Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r446000372", "bodyText": "Could be the diff mode, \n  \n    \n      azure-sdk-for-java/sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/AdvancedDiffLabeledUnlabeledDataAsync.java\n    \n    \n         Line 94\n      in\n      4364c78\n    \n    \n    \n    \n\n        \n          \n           // given during training", "author": "samvaity", "createdAt": "2020-06-26T06:52:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk0Nzk1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI0MDgxMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r446240810", "bodyText": "Weird! Okay ignore me :)", "author": "kristapratico", "createdAt": "2020-06-26T15:05:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk0Nzk1Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk0ODAzMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r445948031", "bodyText": "same here", "author": "kristapratico", "createdAt": "2020-06-26T03:24:22Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/AdvancedDiffLabeledUnlabeledDataAsync.java", "diffHunk": "@@ -112,23 +137,36 @@ public static void main(String[] args) throws IOException {\n             unLabeledForm.getFields().forEach((label, formField) -> {\n                 final StringBuilder boundingBoxStr = new StringBuilder();\n                 if (formField.getValueText().getBoundingBox() != null) {\n-                    formField.getValueText().getBoundingBox().getPoints().forEach(point ->\n-                        boundingBoxStr.append(String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())));\n+                    formField.getValueText().getBoundingBox().getPoints().stream().map(point ->\n+                        String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())).forEach(boundingBoxStr::append);\n                 }\n \n                 final StringBuilder boundingBoxLabelStr = new StringBuilder();\n                 if (formField.getLabelText() != null && formField.getLabelText().getBoundingBox() != null) {\n-                    formField.getLabelText().getBoundingBox().getPoints().forEach(point ->\n-                        boundingBoxLabelStr.append(String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())));\n+                    formField.getLabelText().getBoundingBox().getPoints().stream().map(point ->\n+                        String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())).forEach(boundingBoxStr::append);\n                 }\n                 System.out.printf(\"Field %s has label %s  within bounding box %s with a confidence score \"\n                         + \"of %.2f.%n\",\n                     label, formField.getLabelText().getText(), boundingBoxLabelStr, formField.getConfidence());\n \n-                System.out.printf(\"Field %s has value %s based on %s within bounding box %s with a confidence score \"\n-                        + \"of %.2f.%n\",\n+                System.out.printf(\"Field %s has value %s based on %s within bounding box %s with a confidence \"\n+                        + \"score of %.2f.%n\",\n                     label, formField.getFieldValue(), formField.getValueText().getText(), boundingBoxStr,\n                     formField.getConfidence());\n+\n+                // Find the value of a specific unlabeled field. The specific key \"Vendor Name:\" provided in the\n+                // example\n+                // will only be found if sample training forms used", "originalCommit": "1870b7fa96975fa889a9719e7b0c652aeb8e2690", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk0ODQzMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r445948430", "bodyText": "Just FYI in case you didn't see... Mariana is going to check with Ted to see if we can get the aka.ms link working - the redirection seems to be making the training fail.", "author": "kristapratico", "createdAt": "2020-06-26T03:26:29Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/AdvancedDiffLabeledUnlabeledData.java", "diffHunk": "@@ -17,6 +18,14 @@\n /**\n  * Sample to show the differences in output that arise when RecognizeCustomForms\n  * is called with custom models trained with labeled and unlabeled data.\n+ * For this sample, you can use the training forms found in https://aka.ms/azsdk/formrecognizer/docs/trainingdocs for", "originalCommit": "1870b7fa96975fa889a9719e7b0c652aeb8e2690", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk5NzE1OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r445997159", "bodyText": "yeah, looked at the other PR comments, will wait until this is figured out.", "author": "samvaity", "createdAt": "2020-06-26T06:44:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk0ODQzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI1NTM4NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r446255385", "bodyText": "We are good to go with the link. Ted fixed it :)", "author": "maririos", "createdAt": "2020-06-26T15:31:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk0ODQzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzEzMjM4OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r447132388", "bodyText": "I know.. sorry, I spoke too soon :(", "author": "maririos", "createdAt": "2020-06-29T17:23:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTk0ODQzMA=="}], "type": "inlineReview"}, {"oid": "31406c1efe0bf2e3848802b6ac3c6c2bb1cb81b4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/31406c1efe0bf2e3848802b6ac3c6c2bb1cb81b4", "message": "Checkstyle", "committedDate": "2020-06-26T22:59:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzEzMjE4Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r447132183", "bodyText": "remove?", "author": "maririos", "createdAt": "2020-06-29T17:23:33Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/AdvancedDiffLabeledUnlabeledDataAsync.java", "diffHunk": "@@ -112,23 +137,37 @@ public static void main(String[] args) throws IOException {\n             unLabeledForm.getFields().forEach((label, formField) -> {\n                 final StringBuilder boundingBoxStr = new StringBuilder();\n                 if (formField.getValueText().getBoundingBox() != null) {\n-                    formField.getValueText().getBoundingBox().getPoints().forEach(point ->\n-                        boundingBoxStr.append(String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())));\n+                    formField.getValueText().getBoundingBox().getPoints().stream().map(point ->\n+                        String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())).forEach(boundingBoxStr::append);\n                 }\n \n                 final StringBuilder boundingBoxLabelStr = new StringBuilder();\n                 if (formField.getLabelText() != null && formField.getLabelText().getBoundingBox() != null) {\n-                    formField.getLabelText().getBoundingBox().getPoints().forEach(point ->\n-                        boundingBoxLabelStr.append(String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())));\n+                    formField.getLabelText().getBoundingBox().getPoints().stream().map(point ->\n+                        String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())).forEach(boundingBoxStr::append);\n                 }\n                 System.out.printf(\"Field %s has label %s  within bounding box %s with a confidence score \"\n                         + \"of %.2f.%n\",\n                     label, formField.getLabelText().getText(), boundingBoxLabelStr, formField.getConfidence());\n \n-                System.out.printf(\"Field %s has value %s based on %s within bounding box %s with a confidence score \"\n-                        + \"of %.2f.%n\",\n+                System.out.printf(\"Field %s has value %s based on %s within bounding box %s with a confidence \"\n+                        + \"score of %.2f.%n\",\n                     label, formField.getFieldValue(), formField.getValueText().getText(), boundingBoxStr,\n                     formField.getConfidence());\n+\n+                // Find the value of a specific unlabeled field. The specific key \"Vendor Name:\" provided in the\n+                // example will only be found if sample training forms used\n+                unLabeledForm.getFields().entrySet()\n+                    .stream()\n+                    //filter by label text\n+                    .filter(formFieldEntry -> \"Vendor Name:\".equals(formFieldEntry.getValue().getLabelText().getText()))\n+                    .findAny()\n+                    .ifPresent(formFieldEntry ->\n+                        System.out.printf(\"The Vendor name is: %s%n\", formFieldEntry.getValue()));\n+                    // @since 9\n+                    // .ifPresentOrElse(\n+                    //     formFieldEntry -> System.out.printf(\"The Vendor name is: %s%n\", formFieldEntry.getValue()),", "originalCommit": "4217ac1cad071c81fcef897dc1484ed150a8022a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE0NTI3NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r447145274", "bodyText": "I think with Java samples we want to start showing the easier way of doing things which are usually with higher versions of the Java language. But since our support needs to be catered to atleast Java 8 we show the Java 8 way and the other way is commented.", "author": "samvaity", "createdAt": "2020-06-29T17:46:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzEzMjE4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE1MTg1NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r447151854", "bodyText": "ohhh and does  @since 9 signals that? or should there be a comment with that info?", "author": "maririos", "createdAt": "2020-06-29T17:57:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzEzMjE4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE1MzcxNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r447153715", "bodyText": "yes,  that's a common Javadoc that signals the Java version info.", "author": "samvaity", "createdAt": "2020-06-29T18:00:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzEzMjE4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzEzMjk2MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12524#discussion_r447132961", "bodyText": "same here ... not sure", "author": "maririos", "createdAt": "2020-06-29T17:24:51Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/AdvancedDiffLabeledUnlabeledData.java", "diffHunk": "@@ -36,51 +44,68 @@ public static void main(String[] args) throws IOException {\n             .buildClient();\n \n         File analyzeFile = new File(\"../formrecognizer/azure-ai-formrecognizer/src/samples/java/sample-forms/\"\n-            + \"forms/Invoice_6.pdf\");\n+            + \"forms/Form_1.jpg\");\n \n         List<RecognizedForm> formsWithLabeledModel =\n             client.beginRecognizeCustomForms(\n                 new RecognizeCustomFormsOptions(new FileInputStream(analyzeFile), analyzeFile.length(),\n-                \"{labeled_model_Id}\").setFormContentType(FormContentType.APPLICATION_PDF)\n+                    \"{labeled_model_Id}\").setFormContentType(FormContentType.APPLICATION_PDF)\n                     .setIncludeTextContent(true).setPollInterval(Duration.ofSeconds(5))).getFinalResult();\n         List<RecognizedForm> formsWithUnlabeledModel =\n-            client.beginRecognizeCustomForms(new FileInputStream(analyzeFile), analyzeFile.length(), \"{unlabeled_model_Id}\",\n-                    FormContentType.APPLICATION_PDF).getFinalResult();\n+            client.beginRecognizeCustomForms(new FileInputStream(analyzeFile), analyzeFile.length(),\n+                \"{unlabeled_model_Id}\",\n+                FormContentType.APPLICATION_PDF).getFinalResult();\n \n-        //  The main difference is found in the labels of its fields\n-        // The form recognized with a labeled model will have the labels it was trained with,\n-        // the unlabeled one will be denoted with indices\n         System.out.println(\"--------Recognizing forms with labeled custom model--------\");\n \n-        // With a form recognized by a model trained with labels, this 'name' key will be its\n-        // training-time label, otherwise it will be denoted by numeric indices.\n-        // Label data is not returned for model trained with labels.\n+        // With a form recognized by a model trained with labels, the `formField.getName()` key will be its label given\n+        // during training\n+        // `value` will contain the typed field value and `valueText` will contain information about the field value\n+        // `labelText` is not populated for a model trained with labels as this was the given label used to extract\n+        // the key\n         formsWithLabeledModel.forEach(labeledForm -> labeledForm.getFields().forEach((label, formField) -> {\n             final StringBuilder boundingBoxStr = new StringBuilder();\n             if (formField.getValueText().getBoundingBox() != null) {\n-                formField.getValueText().getBoundingBox().getPoints().forEach(point ->\n-                    boundingBoxStr.append(String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())));\n+                formField.getValueText().getBoundingBox().getPoints().stream().map(point ->\n+                    String.format(\"[%.2f, %.2f]\", point.getX(), point.getY())).forEach(boundingBoxStr::append);\n             }\n             System.out.printf(\"Field %s has value %s based on %s within bounding box %s with a confidence score \"\n                     + \"of %.2f.%n\",\n                 label, formField.getFieldValue(), formField.getValueText().getText(), boundingBoxStr,\n                 formField.getConfidence());\n+\n+            // Find the value of a specific labeled field.\n+            System.out.println(\"Value for a specific labeled field using the training-time label:\");\n+            labeledForm.getFields().entrySet()\n+                .stream()\n+                .filter(formFieldEntry -> \"MerchantName\".equals(formFieldEntry.getKey())) // filter by form field key\n+                .findAny()\n+                .ifPresent(formFieldEntry ->\n+                    System.out.printf(\"The Merchant name is: %s%n\", formFieldEntry.getValue()));\n+                // @since 9\n+                // .ifPresentOrElse(", "originalCommit": "4217ac1cad071c81fcef897dc1484ed150a8022a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7b3c8a8bdbc08d5b1b2d1bf3140df068c94c75cf", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7b3c8a8bdbc08d5b1b2d1bf3140df068c94c75cf", "message": "update advanced samples for finding field information", "committedDate": "2020-07-01T20:18:19Z", "type": "commit"}, {"oid": "47b6f0a6ba99df9979ba806fd22376cc4e9e8ec2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/47b6f0a6ba99df9979ba806fd22376cc4e9e8ec2", "message": "formatting update", "committedDate": "2020-07-01T20:18:29Z", "type": "commit"}, {"oid": "7e9b41b1a6660a5530fa986fbae25abfe700f8ea", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7e9b41b1a6660a5530fa986fbae25abfe700f8ea", "message": "Checkstyle", "committedDate": "2020-07-01T20:18:30Z", "type": "commit"}, {"oid": "aabbcb846aaa8b083a50c350162edf98dec749d2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/aabbcb846aaa8b083a50c350162edf98dec749d2", "message": "comment java 9 statements", "committedDate": "2020-07-01T20:18:31Z", "type": "commit"}, {"oid": "5b10e1df912c111e816b113d1a57f99f56cf31b4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5b10e1df912c111e816b113d1a57f99f56cf31b4", "message": "add tarining files to repo", "committedDate": "2020-07-01T20:19:49Z", "type": "commit"}, {"oid": "5b10e1df912c111e816b113d1a57f99f56cf31b4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5b10e1df912c111e816b113d1a57f99f56cf31b4", "message": "add tarining files to repo", "committedDate": "2020-07-01T20:19:49Z", "type": "forcePushed"}]}