{"pr_number": 14660, "pr_title": "Initial test framework", "pr_createdAt": "2020-08-31T20:00:30Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14660", "timeline": [{"oid": "b2e5a2ab53adb944c8485b5e865ef39bf0503a75", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b2e5a2ab53adb944c8485b5e865ef39bf0503a75", "message": "Initial test framework", "committedDate": "2020-08-31T19:58:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM2NzM3NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480367374", "bodyText": "This is required to make sure no one checks in their encrypted environment variables.\nThere is an identical rule for .NET repo", "author": "azabbasi", "createdAt": "2020-08-31T20:01:16Z", "path": ".gitignore", "diffHunk": "@@ -9,6 +9,9 @@ temp/\n # Spring\n **/*packageOutputDirectory*\n \n+# Sensitive files", "originalCommit": "b2e5a2ab53adb944c8485b5e865ef39bf0503a75", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM2OTUzMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480369531", "bodyText": "Do you really want to add this to the root of the repo?", "author": "drwill-ms", "createdAt": "2020-08-31T20:05:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM2NzM3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM2OTczOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480369739", "bodyText": "I guess so if you are copying what was done in the net repo", "author": "drwill-ms", "createdAt": "2020-08-31T20:06:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM2NzM3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQyMjg5Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480422893", "bodyText": "yes :)", "author": "azabbasi", "createdAt": "2020-08-31T22:00:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM2NzM3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MDExOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480370118", "bodyText": "space between () and {?", "author": "drwill-ms", "createdAt": "2020-08-31T20:06:52Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/test/java/com/azure/digitaltwins/core/DigitalTwinsTestBase.java", "diffHunk": "@@ -0,0 +1,90 @@\n+package com.azure.digitaltwins.core;\n+\n+import com.azure.core.http.policy.HttpLogDetailLevel;\n+import com.azure.core.http.policy.HttpLogOptions;\n+import com.azure.core.http.policy.HttpPipelinePolicy;\n+import com.azure.core.test.TestBase;\n+import com.azure.core.test.TestMode;\n+import com.azure.core.util.Configuration;\n+import com.azure.core.util.logging.ClientLogger;\n+import com.azure.identity.ClientSecretCredentialBuilder;\n+\n+import java.util.Locale;\n+\n+public class DigitalTwinsTestBase extends TestBase\n+{\n+    protected static final String TENANT_ID = Configuration.getGlobalConfiguration()\n+        .get(\"TENANT_ID\", \"tenantId\");\n+\n+    protected static final String CLIENT_SECRET = Configuration.getGlobalConfiguration()\n+        .get(\"CLIENT_SECRET\", \"clientSecret\");\n+\n+    protected static final String CLIENT_ID = Configuration.getGlobalConfiguration()\n+        .get(\"CLIENT_ID\", \"clientId\");\n+\n+    protected static final String DIGITALTWINS_URL = Configuration.getGlobalConfiguration()\n+        .get(\"DIGITALTWINS_URL\", \"https://playback.api.wus2.digitaltwins.azure.net\");\n+\n+    protected DigitalTwinsClientBuilder getDigitalTwinsClientBuilder(){", "originalCommit": "b2e5a2ab53adb944c8485b5e865ef39bf0503a75", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MDMxNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480370316", "bodyText": "space between if and (?", "author": "drwill-ms", "createdAt": "2020-08-31T20:07:17Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/test/java/com/azure/digitaltwins/core/DigitalTwinsTestBase.java", "diffHunk": "@@ -0,0 +1,90 @@\n+package com.azure.digitaltwins.core;\n+\n+import com.azure.core.http.policy.HttpLogDetailLevel;\n+import com.azure.core.http.policy.HttpLogOptions;\n+import com.azure.core.http.policy.HttpPipelinePolicy;\n+import com.azure.core.test.TestBase;\n+import com.azure.core.test.TestMode;\n+import com.azure.core.util.Configuration;\n+import com.azure.core.util.logging.ClientLogger;\n+import com.azure.identity.ClientSecretCredentialBuilder;\n+\n+import java.util.Locale;\n+\n+public class DigitalTwinsTestBase extends TestBase\n+{\n+    protected static final String TENANT_ID = Configuration.getGlobalConfiguration()\n+        .get(\"TENANT_ID\", \"tenantId\");\n+\n+    protected static final String CLIENT_SECRET = Configuration.getGlobalConfiguration()\n+        .get(\"CLIENT_SECRET\", \"clientSecret\");\n+\n+    protected static final String CLIENT_ID = Configuration.getGlobalConfiguration()\n+        .get(\"CLIENT_ID\", \"clientId\");\n+\n+    protected static final String DIGITALTWINS_URL = Configuration.getGlobalConfiguration()\n+        .get(\"DIGITALTWINS_URL\", \"https://playback.api.wus2.digitaltwins.azure.net\");\n+\n+    protected DigitalTwinsClientBuilder getDigitalTwinsClientBuilder(){\n+        DigitalTwinsClientBuilder builder = new DigitalTwinsClientBuilder()\n+            .endpoint(DIGITALTWINS_URL)\n+            .tokenCredential(new ClientSecretCredentialBuilder()\n+                .tenantId(TENANT_ID)\n+                .clientId(CLIENT_ID)\n+                .clientSecret(CLIENT_SECRET)\n+                .build());\n+\n+        if(interceptorManager.isPlaybackMode()){", "originalCommit": "b2e5a2ab53adb944c8485b5e865ef39bf0503a75", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MDU1OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480370559", "bodyText": "nice!", "author": "abhipsaMisra", "createdAt": "2020-08-31T20:07:46Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/test/java/com/azure/digitaltwins/core/DigitalTwinsTestBase.java", "diffHunk": "@@ -0,0 +1,90 @@\n+package com.azure.digitaltwins.core;\n+\n+import com.azure.core.http.policy.HttpLogDetailLevel;\n+import com.azure.core.http.policy.HttpLogOptions;\n+import com.azure.core.http.policy.HttpPipelinePolicy;\n+import com.azure.core.test.TestBase;\n+import com.azure.core.test.TestMode;\n+import com.azure.core.util.Configuration;\n+import com.azure.core.util.logging.ClientLogger;\n+import com.azure.identity.ClientSecretCredentialBuilder;\n+\n+import java.util.Locale;\n+\n+public class DigitalTwinsTestBase extends TestBase\n+{\n+    protected static final String TENANT_ID = Configuration.getGlobalConfiguration()\n+        .get(\"TENANT_ID\", \"tenantId\");\n+\n+    protected static final String CLIENT_SECRET = Configuration.getGlobalConfiguration()\n+        .get(\"CLIENT_SECRET\", \"clientSecret\");\n+\n+    protected static final String CLIENT_ID = Configuration.getGlobalConfiguration()\n+        .get(\"CLIENT_ID\", \"clientId\");\n+\n+    protected static final String DIGITALTWINS_URL = Configuration.getGlobalConfiguration()\n+        .get(\"DIGITALTWINS_URL\", \"https://playback.api.wus2.digitaltwins.azure.net\");\n+\n+    protected DigitalTwinsClientBuilder getDigitalTwinsClientBuilder(){\n+        DigitalTwinsClientBuilder builder = new DigitalTwinsClientBuilder()\n+            .endpoint(DIGITALTWINS_URL)\n+            .tokenCredential(new ClientSecretCredentialBuilder()\n+                .tenantId(TENANT_ID)\n+                .clientId(CLIENT_ID)\n+                .clientSecret(CLIENT_SECRET)\n+                .build());\n+\n+        if(interceptorManager.isPlaybackMode()){\n+            builder.httpClient(interceptorManager.getPlaybackClient());\n+            return builder;\n+        }\n+\n+        // TODO: investigate whether or not we need to add a retry policy.\n+\n+        // If it is record mode, we add record mode policies to the builder.\n+        // There is no isRecordMode method on interceptorManger.\n+        if(!interceptorManager.isLiveMode()){\n+            builder.addPolicy(interceptorManager.getRecordPolicy());\n+        }\n+\n+        return builder;\n+    }\n+\n+    protected DigitalTwinsClientBuilder getDigitalTwinsClientBuilder(HttpPipelinePolicy... policies){", "originalCommit": "b2e5a2ab53adb944c8485b5e865ef39bf0503a75", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MDc3OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480370779", "bodyText": "what are these values?", "author": "drwill-ms", "createdAt": "2020-08-31T20:08:17Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/test/prerequisite/manifest.json", "diffHunk": "@@ -0,0 +1,9 @@\n+[{\n+    \"resourceAppId\": \"0b07f429-9f4b-4714-9392-cc5e8e80c8b0\",", "originalCommit": "b2e5a2ab53adb944c8485b5e865ef39bf0503a75", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MjE5MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480372191", "bodyText": "this the the dataplane APP ID for ADT", "author": "azabbasi", "createdAt": "2020-08-31T20:11:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MDc3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MzM3OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480373379", "bodyText": "Why not use the human readable one: https://digitaltwins.azure.net?", "author": "drwill-ms", "createdAt": "2020-08-31T20:13:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MDc3OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ1Mzc0OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480453748", "bodyText": "we no longer need this anyways, removing.", "author": "azabbasi", "createdAt": "2020-08-31T22:56:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDM3MDc3OQ=="}], "type": "inlineReview"}, {"oid": "36a7af93e0e92dde02ea995b8adef9c10c1a68bb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/36a7af93e0e92dde02ea995b8adef9c10c1a68bb", "message": "move test prerequisites to resoruces.", "committedDate": "2020-08-31T20:08:58Z", "type": "commit"}, {"oid": "75670a936a48054d746097e8cbd37132bb0dd389", "url": "https://github.com/Azure/azure-sdk-for-java/commit/75670a936a48054d746097e8cbd37132bb0dd389", "message": "Update DigitalTwinsTestBase.java", "committedDate": "2020-08-31T20:12:31Z", "type": "commit"}, {"oid": "dceb128707abc31b4045c5598537516906f88371", "url": "https://github.com/Azure/azure-sdk-for-java/commit/dceb128707abc31b4045c5598537516906f88371", "message": "Add session recordings", "committedDate": "2020-08-31T20:33:12Z", "type": "commit"}, {"oid": "b0cd1b7f51180929a2f2f6a2e4e849c09cc5cdde", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b0cd1b7f51180929a2f2f6a2e4e849c09cc5cdde", "message": "Update DigitalTwinsTestBase.java", "committedDate": "2020-08-31T21:59:26Z", "type": "commit"}, {"oid": "599ca590ebdb9a48f4413cef89908e4ac05d0056", "url": "https://github.com/Azure/azure-sdk-for-java/commit/599ca590ebdb9a48f4413cef89908e4ac05d0056", "message": "lower the code coverage", "committedDate": "2020-08-31T22:20:28Z", "type": "commit"}, {"oid": "bceb38dd109b1fc321930ef0b4ad8e1336f71641", "url": "https://github.com/Azure/azure-sdk-for-java/commit/bceb38dd109b1fc321930ef0b4ad8e1336f71641", "message": "remove manifest file as we now use arm templates to deploy resources and manage permissions.", "committedDate": "2020-08-31T22:56:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ3MTQ2OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14660#discussion_r480471469", "bodyText": "\ud83d\udc4d", "author": "bikamani", "createdAt": "2020-08-31T23:28:43Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/pom.xml", "diffHunk": "@@ -15,28 +15,65 @@\n     <artifactId>azure-digitaltwins-core</artifactId>\n     <version>1.0.0-beta.1</version> <!-- {x-version-update;com.azure:azure-digitaltwins-core;current} -->\n \n+  <properties>\n+    <!-- These are the code coverage settings that should eventually be removed to inherit them from the parent pom file. for the time being we have a very low code coverage so we are dropping it to a very low setting -->", "originalCommit": "bceb38dd109b1fc321930ef0b4ad8e1336f71641", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}