{"pr_number": 10738, "pr_title": "Rename apiKey() to credential() in FormRecognizer and TextAnalytics ClientBuilder", "pr_createdAt": "2020-05-05T22:42:24Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/10738", "timeline": [{"oid": "032be60f9a0977810b7212085554e202d9dcc133", "url": "https://github.com/Azure/azure-sdk-for-java/commit/032be60f9a0977810b7212085554e202d9dcc133", "message": "apiKey --> credential()", "committedDate": "2020-05-05T22:40:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5NzUxOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420497518", "bodyText": "Why are the tests removed?", "author": "sima-zhu", "createdAt": "2020-05-06T01:19:31Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/test/java/com/azure/ai/textanalytics/TextAnalyticsClientBuilderUnitTest.java", "diffHunk": "@@ -47,33 +47,11 @@ public void invalidProtocol() {\n         });\n     }\n \n-    /**\n-     * Test for null API key\n-     */\n-    @Test", "originalCommit": "032be60f9a0977810b7212085554e202d9dcc133", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU0MDMxNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420540315", "bodyText": "Now that we have two overloads for the credential in the builder, it cannot resolve at compile time to pass in null object.", "author": "samvaity", "createdAt": "2020-05-06T04:35:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5NzUxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDkyOTUyMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420929522", "bodyText": "assigning the null value to a type value, such as AzureKeyCredential credential = null, and replace null value with credential will resolve it. `=", "author": "mssfang", "createdAt": "2020-05-06T16:33:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5NzUxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDkzMzk3OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420933978", "bodyText": "You can also do cast in API.\n.credential((AzureKeyCredential) null)", "author": "sima-zhu", "createdAt": "2020-05-06T16:40:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5NzUxOA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5OTU3Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420499573", "bodyText": "Search is validating apiKeyCredential.getKey empty or null case.", "author": "sima-zhu", "createdAt": "2020-05-06T01:28:01Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerClientBuilder.java", "diffHunk": "@@ -219,14 +219,14 @@ public FormRecognizerClientBuilder endpoint(String endpoint) {\n     }\n \n     /**\n-     * Sets the credential to use when authenticating HTTP requests for this FormRecognizerClientBuilder.\n+     * Sets the {@link AzureKeyCredential} to use when authenticating HTTP requests for this FormRecognizerClientBuilder.\n      *\n-     * @param apiKeyCredential API key credential\n+     * @param apiKeyCredential {@link AzureKeyCredential} API key credential\n      *\n      * @return The updated FormRecognizerClientBuilder object.\n      * @throws NullPointerException If {@code apiKeyCredential} is {@code null}\n      */\n-    public FormRecognizerClientBuilder apiKey(AzureKeyCredential apiKeyCredential) {\n+    public FormRecognizerClientBuilder credential(AzureKeyCredential apiKeyCredential) {\n         this.credential = Objects.requireNonNull(apiKeyCredential, \"'apiKeyCredential' cannot be null.\");", "originalCommit": "032be60f9a0977810b7212085554e202d9dcc133", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDUwMDMzMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420500331", "bodyText": "Moreover, if the credential is required, we can move the validation up to buildClient()", "author": "sima-zhu", "createdAt": "2020-05-06T01:30:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5OTU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU0MTExNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420541114", "bodyText": "It does have that here - https://github.com/Azure/azure-sdk-for-java/blob/master/sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerClientBuilder.java#L181", "author": "samvaity", "createdAt": "2020-05-06T04:39:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5OTU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDkzMzM4MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420933381", "bodyText": "public SearchServiceClientBuilder credential(AzureKeyCredential keyCredential) {\n        if (keyCredential == null) {\n            throw logger.logExceptionAsError(new NullPointerException(\"'keyCredential' cannot be null.\"));\n        }\n        if (CoreUtils.isNullOrEmpty(keyCredential.getKey())) {\n            throw logger.logExceptionAsError(\n                new IllegalArgumentException(\"'keyCredential' cannot have a null or empty API key.\"));\n        }\n        this.keyCredential = keyCredential;\n        return this;\n    }\n\nHere is how search do validation for your reference.", "author": "sima-zhu", "createdAt": "2020-05-06T16:39:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5OTU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk1NTU4MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420955580", "bodyText": "@sima-zhu Could this\n\nif (keyCredential == null) {\nthrow logger.logExceptionAsError(new NullPointerException(\"'keyCredential' cannot be null.\"));\n}\n\nbe replaced with\n\n   this.credential = Objects.requireNonNull(keyCredential, \"'keyCredential' cannot be null.\");\n\n\nAnd also for the rest of the code, I see that we are already doing the empty checks here and here. It would be redundant?", "author": "samvaity", "createdAt": "2020-05-06T17:13:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDQ5OTU3Mw=="}], "type": "inlineReview"}, {"oid": "0c4b66376ece87f771a63e51bb2caf4c9db5f5bd", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0c4b66376ece87f771a63e51bb2caf4c9db5f5bd", "message": "Update checkstyle", "committedDate": "2020-05-06T04:48:08Z", "type": "commit"}, {"oid": "060d8d7f2d978df2c099839918de5693a49189f5", "url": "https://github.com/Azure/azure-sdk-for-java/commit/060d8d7f2d978df2c099839918de5693a49189f5", "message": "Add back the tests", "committedDate": "2020-05-06T17:23:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk2Njc3Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420966777", "bodyText": "Method name should be renamed too.", "author": "srnagar", "createdAt": "2020-05-06T17:31:02Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/test/java/com/azure/ai/formrecognizer/FormRecognizerClientBuilderUnitTest.java", "diffHunk": "@@ -54,7 +54,7 @@ public void invalidProtocol() {\n     public void nullApiKey() {", "originalCommit": "060d8d7f2d978df2c099839918de5693a49189f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk2ODA4MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420968081", "bodyText": "Update the name of the class to RotateAzureKeyCredential", "author": "srnagar", "createdAt": "2020-05-06T17:33:14Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/samples/java/com/azure/ai/textanalytics/RotateApiKey.java", "diffHunk": "@@ -19,7 +19,7 @@\n     public static void main(String[] args) {\n         AzureKeyCredential credential = new AzureKeyCredential(\"{api_key}\");\n         TextAnalyticsClient client = new TextAnalyticsClientBuilder()\n-            .apiKey(credential)\n+            .credential(credential)", "originalCommit": "060d8d7f2d978df2c099839918de5693a49189f5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk2OTA4OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r420969089", "bodyText": "Use azure_key_credential instead of api_key everywhere to be consistent with terminology.", "author": "srnagar", "createdAt": "2020-05-06T17:34:40Z", "path": "sdk/textanalytics/azure-ai-textanalytics/src/samples/java/com/azure/ai/textanalytics/TextAnalyticsAsyncClientJavaDocCodeSnippets.java", "diffHunk": "@@ -33,7 +33,7 @@\n     public TextAnalyticsAsyncClient createTextAnalyticsAsyncClient() {\n         // BEGIN: com.azure.ai.textanalytics.TextAnalyticsAsyncClient.instantiation\n         TextAnalyticsAsyncClient textAnalyticsAsyncClient = new TextAnalyticsClientBuilder()\n-            .apiKey(new AzureKeyCredential(\"{api_key}\"))\n+            .credential(new AzureKeyCredential(\"{api_key}\"))", "originalCommit": "060d8d7f2d978df2c099839918de5693a49189f5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTAwNzQzNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10738#discussion_r421007434", "bodyText": "updated to say key as that is what it is called in Portal.", "author": "samvaity", "createdAt": "2020-05-06T18:35:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk2OTA4OQ=="}], "type": "inlineReview"}, {"oid": "92c37fc46c0567966315543ee09395afdce0cfa6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/92c37fc46c0567966315543ee09395afdce0cfa6", "message": "update method names", "committedDate": "2020-05-06T18:12:10Z", "type": "commit"}, {"oid": "8914f356393ecdefa978cc75a33fcb5d64ec9d5c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8914f356393ecdefa978cc75a33fcb5d64ec9d5c", "message": "api_key -> key", "committedDate": "2020-05-06T18:39:41Z", "type": "commit"}, {"oid": "8914f356393ecdefa978cc75a33fcb5d64ec9d5c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8914f356393ecdefa978cc75a33fcb5d64ec9d5c", "message": "api_key -> key", "committedDate": "2020-05-06T18:39:41Z", "type": "forcePushed"}]}