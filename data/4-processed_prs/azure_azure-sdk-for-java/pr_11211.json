{"pr_number": 11211, "pr_title": "Override bad java11 selection", "pr_createdAt": "2020-05-15T19:38:41Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/11211", "timeline": [{"oid": "3e668dbb844cb86f1971feeacaf41219a8215e02", "url": "https://github.com/Azure/azure-sdk-for-java/commit/3e668dbb844cb86f1971feeacaf41219a8215e02", "message": "override bad java11 selection", "committedDate": "2020-05-15T19:38:03Z", "type": "commit"}, {"oid": "29d8394d5b23d9143514ffb8f8916b44856c2b9c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/29d8394d5b23d9143514ffb8f8916b44856c2b9c", "message": "corrections for ensuring that java11 runs appropriately", "committedDate": "2020-05-15T20:05:30Z", "type": "commit"}, {"oid": "481a3e115fd213ad6a12dd16c4bb9597dbe4b02b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/481a3e115fd213ad6a12dd16c4bb9597dbe4b02b", "message": "more setting of java11 on windows builds.", "committedDate": "2020-05-15T20:14:35Z", "type": "commit"}, {"oid": "6fd8eafb5aa45eb9f9eabdaa549191fd43f940f7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6fd8eafb5aa45eb9f9eabdaa549191fd43f940f7", "message": "add java version fix to smoke tests", "committedDate": "2020-05-15T20:18:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAzMTY2NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11211#discussion_r426031665", "bodyText": "To reduce duplication and the number of lines we have to touch I suggest defaulting the VMAgent parameter to $(OSVmImage) in the template so we don't have to pass it in explicitly in all our usages.", "author": "weshaggard", "createdAt": "2020-05-15T20:28:56Z", "path": "common/smoke-tests/smoke-test.yml", "diffHunk": "@@ -80,6 +80,10 @@ jobs:\n \n \n     steps:\n+      - template: /eng/pipelines/templates/steps/update-version-fix.yml\n+        parameters:", "originalCommit": "6fd8eafb5aa45eb9f9eabdaa549191fd43f940f7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "67fbdb198d78bf60f2eee1f2c8cdc8fe65d27a69", "url": "https://github.com/Azure/azure-sdk-for-java/commit/67fbdb198d78bf60f2eee1f2c8cdc8fe65d27a69", "message": "use safe defaults, use dictionary syntax", "committedDate": "2020-05-15T20:39:53Z", "type": "commit"}, {"oid": "640d716fa9d627d6ffe80421a5dc0617d8957f0b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/640d716fa9d627d6ffe80421a5dc0617d8957f0b", "message": "quotes for VMAgent", "committedDate": "2020-05-15T20:50:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA0MTExNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11211#discussion_r426041115", "bodyText": "I believe this needs to be eq('${{parameters.VMAgent}}','windows-2019'))", "author": "weshaggard", "createdAt": "2020-05-15T20:52:26Z", "path": "eng/pipelines/templates/steps/update-version-fix.yml", "diffHunk": "@@ -0,0 +1,10 @@\n+parameters:\n+  VMAgent: variables['OSVmImage']\n+\n+steps:\n+  - pwsh: |\n+      $java11Installs = Get-ChildItem -Path 'C:\\Program Files\\Java' -Filter '*azure-jdk_11*' | Sort-Object -Property Name -Descending | Select-Object -First 1\n+      $latestJava11Install = $java11Installs.FullName;\n+      Write-Host \"##vso[task.setvariable variable=JAVA_HOME_11_X64]$latestJava11Install\"\n+    displayName: Resolve bad selection of Java11 instead of Java13\n+    condition: and(succeeded(), eq(${{parameters.VMAgent}},'windows-2019'))", "originalCommit": "640d716fa9d627d6ffe80421a5dc0617d8957f0b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2f90988fc618a742d5d90cf38c53f751e6861056", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2f90988fc618a742d5d90cf38c53f751e6861056", "message": "a friendlier condition for checking the vm image", "committedDate": "2020-05-15T21:05:23Z", "type": "commit"}]}