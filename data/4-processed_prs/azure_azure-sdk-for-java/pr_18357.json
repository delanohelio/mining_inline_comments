{"pr_number": 18357, "pr_title": "update aad changelog and readme", "pr_createdAt": "2020-12-25T08:57:53Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/18357", "timeline": [{"oid": "4c0f0b3f698aa8fb55935a5324bb9af4587e8f8a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4c0f0b3f698aa8fb55935a5324bb9af4587e8f8a", "message": "update aad changelog and readme", "committedDate": "2020-12-25T08:56:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODgzODM1OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r548838359", "bodyText": "Here and below introduction related with webapi will be udpated by @backwind1233", "author": "yiliuTo", "createdAt": "2020-12-25T09:01:24Z", "path": "sdk/spring/azure-spring-boot-starter-active-directory/README.md", "diffHunk": "@@ -27,16 +27,21 @@ With Spring Starter for Azure Active Directory, now you can get started quickly\n [//]: # \"{x-version-update-end}\"\n \n ## Key concepts\n-This package provides 2 ways to integrate with Spring Security and authenticate with Azure Active Directory.\n+This package provides 2 ways to integrate with Spring Security and authenticate with Azure Active Directory, which are designed for scenarios of web application and resource server.\n \n-The authorization flow is composed of 3 phrases:\n+The authorization flow for web application includes:\n+* Login with credentials by self-defined `azure` client registration and trigger **authorization code flow**. Application gets user's consent for all configured scopes except on-demand resources' scopes, and acquires an access token only for scopes of `openid, profile, offline_access, https://graph.microsoft.com/User.Read`.\n+* When other resources are visited, associated clients will be loaded to trigger **refresh token flow** for authorization, and acquire an access token for configured scopes of that resource.\n+* When on-demand resources are visited, associated clients will be loaded and trigger **authorization code flow** like the `azure` client.\n+\n+The authorization flow for resource server:", "originalCommit": "4c0f0b3f698aa8fb55935a5324bb9af4587e8f8a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTM2MjgwMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549362802", "bodyText": "@backwind1233 will we create a separate PR for this?", "author": "saragluna", "createdAt": "2020-12-28T14:15:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODgzODM1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU0NDI0Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549544243", "bodyText": "@saragluna  I think so", "author": "backwind1233", "createdAt": "2020-12-29T02:18:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODgzODM1OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE3OTI5MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549179290", "bodyText": "The way this starter uses to load users' membership, Delete get", "author": "chenrujun", "createdAt": "2020-12-28T00:07:44Z", "path": "sdk/spring/azure-spring-boot-starter-active-directory/README.md", "diffHunk": "@@ -27,16 +27,21 @@ With Spring Starter for Azure Active Directory, now you can get started quickly\n [//]: # \"{x-version-update-end}\"\n \n ## Key concepts\n-This package provides 2 ways to integrate with Spring Security and authenticate with Azure Active Directory.\n+This package provides 2 ways to integrate with Spring Security and authenticate with Azure Active Directory, which are designed for scenarios of web application and resource server.\n \n-The authorization flow is composed of 3 phrases:\n+The authorization flow for web application includes:\n+* Login with credentials by self-defined `azure` client registration and trigger **authorization code flow**. Application gets user's consent for all configured scopes except on-demand resources' scopes, and acquires an access token only for scopes of `openid, profile, offline_access, https://graph.microsoft.com/User.Read`.\n+* When other resources are visited, associated clients will be loaded to trigger **refresh token flow** for authorization, and acquire an access token for configured scopes of that resource.\n+* When on-demand resources are visited, associated clients will be loaded and trigger **authorization code flow** like the `azure` client.\n+\n+The authorization flow for resource server:\n * Login with credentials and validate id_token from Azure AD \n * Get On-Behalf-Of token and membership info from Azure AD Graph API\n * Evaluate the permission based on membership info to grant or deny access\n \n ### Group membership\n-The way to get group relationship depends on the graph api used, the default to get membership is the direct group of the user. \n-To get all transitive relationships, the following configuration is required:\n+The way this starter uses to load get users' membership depends on the configured membership URI. By default, the starter uses `https://graph.microsoft.com/v1.0/me/memberOf` to get direct membership of current user. ", "originalCommit": "4c0f0b3f698aa8fb55935a5324bb9af4587e8f8a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e690ddb22fe4a5881bee8fce1b928ed56e7b11aa", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e690ddb22fe4a5881bee8fce1b928ed56e7b11aa", "message": "add deprecated properties of aad starter", "committedDate": "2020-12-28T02:21:16Z", "type": "commit"}, {"oid": "19431180ac78db213b9447229d76b5023d25d27e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/19431180ac78db213b9447229d76b5023d25d27e", "message": "Merge branch 'master' into update-aad-changelog", "committedDate": "2020-12-28T02:43:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIzMzkwMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549233902", "bodyText": "redirect-uri-template. Same to other items.", "author": "chenrujun", "createdAt": "2020-12-28T06:45:04Z", "path": "sdk/spring/azure-spring-boot-starter-active-directory/CHANGELOG.md", "diffHunk": "@@ -5,16 +5,39 @@\n - Change group id from `com.microsoft.azure` to `com.azure.spring`.\n - Change artifact id from `azure-active-directory-spring-boot-starter` to `azure-spring-boot-starter-active-directory`.\n - Deprecate `AADAppRoleStatelessAuthenticationFilter` and `AADAuthenticationFilter`.\n+- Deprecate following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```\n+    spring.security.oauth2.client.provider.azure.*\n+    spring.security.oauth2.client.registration.azure.*\n+    azure.activedirectory.environment\n+    azure.activedirectory.user-group.key\n+    azure.activedirectory.user-group.value\n+    azure.activedirectory.user-group.object-id-key\n+    ```\n+- Stop support of Azure Active Directory Endpoints.\n \n ### New Features\n-- Support consent multiple client-registration when login.\n-- Support on-demand client-registration.\n-- Support the use of `@RegisteredOAuth2AuthorizedClient` to get `OAuth2AuthorizedClient`.\n-- Support to obtain the claim in access token, such as `scp`, `roles` etc, to carry out permission control.\n-- Support on-behalf-of flow when the `azure-spring-boot-starter-active-directory` used in resource-server.\n-- Provide some AAD specific token validation, such as audience validation, issuer validation.\n-- Expose a flag in the `AzureOAuth2AuthenticatedPrincipal` to tell which account type is being used, work account or personal account.\n-\n+- Support consent of multiple client registrations during user login.\n+- Support on-demand client registrations.\n+- Support the use of `@RegisteredOAuth2AuthorizedClient` annotation to get `OAuth2AuthorizedClient`.\n+- Support access control through users' membership information.\n+- Support on-behalf-of flow in the resource server.\n+- Provide AAD specific token validation of audience validation and issuer validation.\n+- Expose a flag `isPersonalAccount` in `AzureOAuth2AuthenticatedPrincipal` to specify the account type in use: work account or personal account.\n+- Enable loading transitive membership information from Microsoft Graph API.\n+- Enable following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```yaml\n+    # Redirect URI of authorization server\n+    azure.activedirectory.redirectUriTemplate", "originalCommit": "19431180ac78db213b9447229d76b5023d25d27e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIzNDIwNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549234205", "bodyText": "@backwind1233 , if it's used in resource-server, related dependency should be added.", "author": "chenrujun", "createdAt": "2020-12-28T06:46:20Z", "path": "sdk/spring/azure-spring-boot-starter-active-directory/README.md", "diffHunk": "@@ -16,27 +16,38 @@ With Spring Starter for Azure Active Directory, now you can get started quickly\n * **Create a client secret key for the application**: Go to API ACCESS - Keys to create a secret key (`client-secret`).\n \n ### Include the package\n+To use this starter in an web application, please add following packages:\n+\n [//]: # \"{x-version-update-start;com.azure.spring:azure-spring-boot-starter-active-directory;current}\"\n ```xml\n <dependency>\n     <groupId>com.azure.spring</groupId>\n     <artifactId>azure-spring-boot-starter-active-directory</artifactId>\n     <version>3.0.0-beta.1</version>\n </dependency>\n+<dependency>\n+  <groupId>org.springframework.security</groupId>\n+  <artifactId>spring-security-oauth2-client</artifactId>\n+</dependency>", "originalCommit": "19431180ac78db213b9447229d76b5023d25d27e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIzNDUwNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549234506", "bodyText": "Same here.", "author": "chenrujun", "createdAt": "2020-12-28T06:47:36Z", "path": "sdk/spring/azure-spring-boot-starter/CHANGELOG.md", "diffHunk": "@@ -1,7 +1,42 @@\n # Release History\n \n ## 3.0.0-beta.2 (Unreleased)\n+### Breaking Changes\n+- Deprecate `AADAppRoleStatelessAuthenticationFilter` and `AADAuthenticationFilter`.\n+- Change artifact id from `azure-active-directory-spring-boot-starter` to `azure-spring-boot-starter-active-directory`.\n+- Deprecate following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```\n+    spring.security.oauth2.client.provider.azure.*\n+    spring.security.oauth2.client.registration.azure.*\n+    azure.activedirectory.environment\n+    azure.activedirectory.user-group.key\n+    azure.activedirectory.user-group.value\n+    azure.activedirectory.user-group.object-id-key\n+    ```\n+- Stop support of Azure Active Directory Endpoints.\n \n+### New Features\n+- Support consent of multiple client registrations during user login.\n+- Support on-demand client registrations.\n+- Support the use of `@RegisteredOAuth2AuthorizedClient` annotation to get `OAuth2AuthorizedClient`.\n+- Support access control through users' membership information.\n+- Support on-behalf-of flow in the resource server.\n+- Provide AAD specific token validation methods of audience validation and issuer validation.\n+- Expose a flag `isPersonalAccount` in `AzureOAuth2AuthenticatedPrincipal` to specify the account type in use: work account or personal account.\n+- Enable loading transitive membership information from Microsoft Graph API.\n+- Enable following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```yaml\n+    # Redirect URI of authorization server\n+    azure.activedirectory.redirectUriTemplate", "originalCommit": "19431180ac78db213b9447229d76b5023d25d27e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIzNDU1NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549234554", "bodyText": "Same here.", "author": "chenrujun", "createdAt": "2020-12-28T06:47:53Z", "path": "sdk/spring/azure-spring-boot/CHANGELOG.md", "diffHunk": "@@ -3,17 +3,40 @@\n ## 3.0.0-beta.2 (Unreleased)\n ### Breaking Changes\n - Deprecate `AADAppRoleStatelessAuthenticationFilter` and `AADAuthenticationFilter`.\n-- Support the setting of post logout redirect uri \n+- Change artifact id from `azure-active-directory-spring-boot-starter` to `azure-spring-boot-starter-active-directory`.\n+- Deprecate following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```\n+    spring.security.oauth2.client.provider.azure.*\n+    spring.security.oauth2.client.registration.azure.*\n+    azure.activedirectory.environment\n+    azure.activedirectory.user-group.key\n+    azure.activedirectory.user-group.value\n+    azure.activedirectory.user-group.object-id-key\n+    ```\n+- Stop support of Azure Active Directory Endpoints.\n \n ### New Features\n-- Support consent multiple client-registration when login.\n-- Support on-demand client-registration.\n-- Support the use of `@RegisteredOAuth2AuthorizedClient` to get `OAuth2AuthorizedClient`.\n-- Support to obtain the claim in access token, such as `scp`, `roles` etc, to carry out permission control.\n-- Support on-behalf-of flow when the `azure-spring-boot-starter-active-directory` used in resource-server.\n-- Provide some AAD specific token validation, such as audience validation, issuer validation.\n-- Expose a flag in the `AzureOAuth2AuthenticatedPrincipal` to tell which account type is being used, work account or personal account.\n-\n+- Support consent of multiple client registrations during user login.\n+- Support on-demand client registrations.\n+- Support the use of `@RegisteredOAuth2AuthorizedClient` annotation to get `OAuth2AuthorizedClient`.\n+- Support access control through users' membership information.\n+- Support on-behalf-of flow in the resource server.\n+- Provide AAD specific token validation methods of audience validation and issuer validation.\n+- Expose a flag `isPersonalAccount` in `AzureOAuth2AuthenticatedPrincipal` to specify the account type in use: work account or personal account.\n+- Enable loading transitive membership information from Microsoft Graph API.\n+- Enable following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```yaml\n+    # Redirect URI of authorization server\n+    azure.activedirectory.redirectUriTemplate", "originalCommit": "19431180ac78db213b9447229d76b5023d25d27e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "aa67fab78553bf0654509ccedaa55e4ec02ef87b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/aa67fab78553bf0654509ccedaa55e4ec02ef87b", "message": "rename properties", "committedDate": "2020-12-28T06:56:58Z", "type": "commit"}, {"oid": "1a23ccd44062e3ac59bedce8cfe6162ccf04cf6f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1a23ccd44062e3ac59bedce8cfe6162ccf04cf6f", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into update-aad-changelog", "committedDate": "2020-12-28T07:04:15Z", "type": "commit"}, {"oid": "509a46449ba8f20bd687fccdc359cc162f2acfe3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/509a46449ba8f20bd687fccdc359cc162f2acfe3", "message": "rename authorization-server-uri to base-uri", "committedDate": "2020-12-28T07:06:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIzOTA4NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549239085", "bodyText": "I believe AzureOAuth2AuthenticatedPrincipal  has been renamed.", "author": "saragluna", "createdAt": "2020-12-28T07:08:26Z", "path": "sdk/spring/azure-spring-boot-starter-active-directory/CHANGELOG.md", "diffHunk": "@@ -5,16 +5,39 @@\n - Change group id from `com.microsoft.azure` to `com.azure.spring`.\n - Change artifact id from `azure-active-directory-spring-boot-starter` to `azure-spring-boot-starter-active-directory`.\n - Deprecate `AADAppRoleStatelessAuthenticationFilter` and `AADAuthenticationFilter`.\n+- Deprecate following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```\n+    spring.security.oauth2.client.provider.azure.*\n+    spring.security.oauth2.client.registration.azure.*\n+    azure.activedirectory.environment\n+    azure.activedirectory.user-group.key\n+    azure.activedirectory.user-group.value\n+    azure.activedirectory.user-group.object-id-key\n+    ```\n+- Stop support of Azure Active Directory Endpoints.\n \n ### New Features\n-- Support consent multiple client-registration when login.\n-- Support on-demand client-registration.\n-- Support the use of `@RegisteredOAuth2AuthorizedClient` to get `OAuth2AuthorizedClient`.\n-- Support to obtain the claim in access token, such as `scp`, `roles` etc, to carry out permission control.\n-- Support on-behalf-of flow when the `azure-spring-boot-starter-active-directory` used in resource-server.\n-- Provide some AAD specific token validation, such as audience validation, issuer validation.\n-- Expose a flag in the `AzureOAuth2AuthenticatedPrincipal` to tell which account type is being used, work account or personal account.\n-\n+- Support consent of multiple client registrations during user login.\n+- Support on-demand client registrations.\n+- Support the use of `@RegisteredOAuth2AuthorizedClient` annotation to get `OAuth2AuthorizedClient`.\n+- Support access control through users' membership information.\n+- Support on-behalf-of flow in the resource server.\n+- Provide AAD specific token validation of audience validation and issuer validation.\n+- Expose a flag `isPersonalAccount` in `AzureOAuth2AuthenticatedPrincipal` to specify the account type in use: work account or personal account.", "originalCommit": "509a46449ba8f20bd687fccdc359cc162f2acfe3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTI0MTU2OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549241568", "bodyText": "Thanks, I have updated them now", "author": "yiliuTo", "createdAt": "2020-12-28T07:19:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIzOTA4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIzOTQ3MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549239470", "bodyText": "Same here.", "author": "saragluna", "createdAt": "2020-12-28T07:10:13Z", "path": "sdk/spring/azure-spring-boot-starter/CHANGELOG.md", "diffHunk": "@@ -1,7 +1,42 @@\n # Release History\n \n ## 3.0.0-beta.2 (Unreleased)\n+### Breaking Changes\n+- Deprecate `AADAppRoleStatelessAuthenticationFilter` and `AADAuthenticationFilter`.\n+- Change artifact id from `azure-active-directory-spring-boot-starter` to `azure-spring-boot-starter-active-directory`.\n+- Deprecate following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```\n+    spring.security.oauth2.client.provider.azure.*\n+    spring.security.oauth2.client.registration.azure.*\n+    azure.activedirectory.environment\n+    azure.activedirectory.user-group.key\n+    azure.activedirectory.user-group.value\n+    azure.activedirectory.user-group.object-id-key\n+    ```\n+- Stop support of Azure Active Directory Endpoints.\n \n+### New Features\n+- Support consent of multiple client registrations during user login.\n+- Support on-demand client registrations.\n+- Support the use of `@RegisteredOAuth2AuthorizedClient` annotation to get `OAuth2AuthorizedClient`.\n+- Support access control through users' membership information.\n+- Support on-behalf-of flow in the resource server.\n+- Provide AAD specific token validation methods of audience validation and issuer validation.\n+- Expose a flag `isPersonalAccount` in `AzureOAuth2AuthenticatedPrincipal` to specify the account type in use: work account or personal account.", "originalCommit": "509a46449ba8f20bd687fccdc359cc162f2acfe3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIzOTUyMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549239522", "bodyText": "Same here.", "author": "saragluna", "createdAt": "2020-12-28T07:10:28Z", "path": "sdk/spring/azure-spring-boot/CHANGELOG.md", "diffHunk": "@@ -3,17 +3,40 @@\n ## 3.0.0-beta.2 (Unreleased)\n ### Breaking Changes\n - Deprecate `AADAppRoleStatelessAuthenticationFilter` and `AADAuthenticationFilter`.\n-- Support the setting of post logout redirect uri \n+- Change artifact id from `azure-active-directory-spring-boot-starter` to `azure-spring-boot-starter-active-directory`.\n+- Deprecate following `azure-spring-boot-starter-active-directory` configuration properties:\n+    ```\n+    spring.security.oauth2.client.provider.azure.*\n+    spring.security.oauth2.client.registration.azure.*\n+    azure.activedirectory.environment\n+    azure.activedirectory.user-group.key\n+    azure.activedirectory.user-group.value\n+    azure.activedirectory.user-group.object-id-key\n+    ```\n+- Stop support of Azure Active Directory Endpoints.\n \n ### New Features\n-- Support consent multiple client-registration when login.\n-- Support on-demand client-registration.\n-- Support the use of `@RegisteredOAuth2AuthorizedClient` to get `OAuth2AuthorizedClient`.\n-- Support to obtain the claim in access token, such as `scp`, `roles` etc, to carry out permission control.\n-- Support on-behalf-of flow when the `azure-spring-boot-starter-active-directory` used in resource-server.\n-- Provide some AAD specific token validation, such as audience validation, issuer validation.\n-- Expose a flag in the `AzureOAuth2AuthenticatedPrincipal` to tell which account type is being used, work account or personal account.\n-\n+- Support consent of multiple client registrations during user login.\n+- Support on-demand client registrations.\n+- Support the use of `@RegisteredOAuth2AuthorizedClient` annotation to get `OAuth2AuthorizedClient`.\n+- Support access control through users' membership information.\n+- Support on-behalf-of flow in the resource server.\n+- Provide AAD specific token validation methods of audience validation and issuer validation.\n+- Expose a flag `isPersonalAccount` in `AzureOAuth2AuthenticatedPrincipal` to specify the account type in use: work account or personal account.", "originalCommit": "509a46449ba8f20bd687fccdc359cc162f2acfe3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2259d05643a52806f942522c8753b084fe5d1ea3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2259d05643a52806f942522c8753b084fe5d1ea3", "message": "update renamed class of AADOAuth2AuthenticatedPrincipal", "committedDate": "2020-12-28T07:18:43Z", "type": "commit"}, {"oid": "13cb9f91e071ec42ec2c1cfe9057181d4d9a5e0d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/13cb9f91e071ec42ec2c1cfe9057181d4d9a5e0d", "message": "add introduction of aad properties in readme", "committedDate": "2020-12-28T08:43:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTM2MzU2Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549363562", "bodyText": "Is it only me or does anyone else find this list of properties hard to read?", "author": "saragluna", "createdAt": "2020-12-28T14:18:07Z", "path": "sdk/spring/azure-spring-boot-starter-active-directory/README.md", "diffHunk": "@@ -16,34 +16,76 @@ With Spring Starter for Azure Active Directory, now you can get started quickly\n * **Create a client secret key for the application**: Go to API ACCESS - Keys to create a secret key (`client-secret`).\n \n ### Include the package\n+To use this starter in an web application, please add following packages:\n+\n [//]: # \"{x-version-update-start;com.azure.spring:azure-spring-boot-starter-active-directory;current}\"\n ```xml\n <dependency>\n     <groupId>com.azure.spring</groupId>\n     <artifactId>azure-spring-boot-starter-active-directory</artifactId>\n     <version>3.0.0-beta.1</version>\n </dependency>\n+<dependency>\n+    <groupId>org.springframework.security</groupId>\n+    <artifactId>spring-security-oauth2-client</artifactId>\n+</dependency>\n ```\n [//]: # \"{x-version-update-end}\"\n \n ## Key concepts\n-This package provides 2 ways to integrate with Spring Security and authenticate with Azure Active Directory.\n+This package provides 2 ways to integrate with Spring Security and authenticate with Azure Active Directory, which are designed for scenarios of web application and resource server.\n \n-The authorization flow is composed of 3 phrases:\n+The authorization flow for web application includes:\n+* Login with credentials by self-defined `azure` client registration and trigger **authorization code flow**. Application gets user's consent for all configured scopes except on-demand resources' scopes, and acquires an access token only for scopes of `openid, profile, offline_access, https://graph.microsoft.com/User.Read`.\n+* When other resources are visited, associated clients will be loaded to trigger **refresh token flow** for authorization, and acquire an access token for configured scopes of that resource.\n+* When on-demand resources are visited, associated clients will be loaded and trigger **authorization code flow** like the `azure` client.\n+\n+The authorization flow for resource server:\n * Login with credentials and validate id_token from Azure AD \n * Get On-Behalf-Of token and membership info from Azure AD Graph API\n * Evaluate the permission based on membership info to grant or deny access\n \n-### Group membership\n-The way to get group relationship depends on the graph api used, the default to get membership is the direct group of the user. \n-To get all transitive relationships, the following configuration is required:\n-\n-```yaml\n-azure:\n-  activedirectory:\n-    graph-membership-uri: https://graph.microsoft.com/v1.0/me/transitiveMemberOf\n-``` \n-\n+### Configurable properties\n+This starter provides following properties to be customized:\n+* azure.activedirectory.client-id:   ", "originalCommit": "13cb9f91e071ec42ec2c1cfe9057181d4d9a5e0d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUzOTc0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549539746", "bodyText": "How about convert this to a table?", "author": "chenrujun", "createdAt": "2020-12-29T01:50:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTM2MzU2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU0Mzk2Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549543962", "bodyText": "what about we using properties format like:\n# Registered application ID in Azure AD.\nazure.activedirectory.client-id=", "author": "yiliuTo", "createdAt": "2020-12-29T02:17:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTM2MzU2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU3MzUwMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/18357#discussion_r549573502", "bodyText": "I'll vote for the table.", "author": "saragluna", "createdAt": "2020-12-29T05:29:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTM2MzU2Mg=="}], "type": "inlineReview"}]}