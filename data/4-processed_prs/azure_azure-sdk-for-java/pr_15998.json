{"pr_number": 15998, "pr_title": "Communication - Added Phone Number Administration Create Search LRO", "pr_createdAt": "2020-10-06T18:21:58Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/15998", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUyOTU2NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500529564", "bodyText": "I thought we concluded that we would support cancellation -- which in turn would be the sync cancelSearch", "author": "ankitarorabit", "createdAt": "2020-10-06T19:01:31Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +765,68 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param lroDuration The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration lroDuration) {\n+        final Duration interval = lroDuration != null ? lroDuration : DEFAULT_POLL_INTERVAL;\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(interval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            (activationResponse, pollingContext) -> Mono.error(new RuntimeException(\"Cancellation is not supported\")),", "originalCommit": "5d33fc71c06d5d235068b074868b562966f8ea72", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "message": "Added create search LRO", "committedDate": "2020-10-06T19:02:26Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUzNDY4NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500534685", "bodyText": "nit: we can use DESCRIPTION_FOR_SEARCH and likewise for Name, will look cleaner", "author": "ankitarorabit", "createdAt": "2020-10-06T19:11:02Z", "path": "sdk/communication/azure-communication-administration/src/test/java/com/azure/communication/administration/PhoneNumberAsyncClientIntegrationTest.java", "diffHunk": "@@ -449,6 +452,29 @@ public void releasePhoneNumbersWithResponse() {\n             .verifyComplete();\n     }\n \n+    @Test()\n+    public void beginCreateSearch() {\n+        List<String> phonePlanIds = new ArrayList<>();\n+        phonePlanIds.add(\"27b53eec-8ff4-4070-8900-fbeaabfd158a\");\n+\n+        CreateSearchOptions createSearchOptions = new CreateSearchOptions();\n+        createSearchOptions\n+            .setAreaCode(AREA_CODE_FOR_SEARCH)\n+            .setDescription(\"testsearch20200014\")", "originalCommit": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUzNDg2NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500534865", "bodyText": "Can we read this from env variables?", "author": "ankitarorabit", "createdAt": "2020-10-06T19:11:21Z", "path": "sdk/communication/azure-communication-administration/src/test/java/com/azure/communication/administration/PhoneNumberAsyncClientIntegrationTest.java", "diffHunk": "@@ -449,6 +452,29 @@ public void releasePhoneNumbersWithResponse() {\n             .verifyComplete();\n     }\n \n+    @Test()\n+    public void beginCreateSearch() {\n+        List<String> phonePlanIds = new ArrayList<>();\n+        phonePlanIds.add(\"27b53eec-8ff4-4070-8900-fbeaabfd158a\");", "originalCommit": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUzNTE4NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500535185", "bodyText": "You might want to poll sooner then that?", "author": "ankitarorabit", "createdAt": "2020-10-06T19:11:57Z", "path": "sdk/communication/azure-communication-administration/src/test/java/com/azure/communication/administration/PhoneNumberAsyncClientIntegrationTest.java", "diffHunk": "@@ -449,6 +452,29 @@ public void releasePhoneNumbersWithResponse() {\n             .verifyComplete();\n     }\n \n+    @Test()\n+    public void beginCreateSearch() {\n+        List<String> phonePlanIds = new ArrayList<>();\n+        phonePlanIds.add(\"27b53eec-8ff4-4070-8900-fbeaabfd158a\");\n+\n+        CreateSearchOptions createSearchOptions = new CreateSearchOptions();\n+        createSearchOptions\n+            .setAreaCode(AREA_CODE_FOR_SEARCH)\n+            .setDescription(\"testsearch20200014\")\n+            .setDisplayName(\"testsearch20200014\")\n+            .setPhonePlanIds(phonePlanIds)\n+            .setQuantity(2);\n+\n+        Duration duration = Duration.ofSeconds(5);", "originalCommit": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUzOTY4MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500539680", "bodyText": "This checks one path of functionality.. (Create and Validate Response).. but shouldn't we also test that the developer can poll and get the status? Another scenario would be the cancel itself?", "author": "ankitarorabit", "createdAt": "2020-10-06T19:20:08Z", "path": "sdk/communication/azure-communication-administration/src/test/java/com/azure/communication/administration/PhoneNumberAsyncClientIntegrationTest.java", "diffHunk": "@@ -449,6 +452,29 @@ public void releasePhoneNumbersWithResponse() {\n             .verifyComplete();\n     }\n \n+    @Test()\n+    public void beginCreateSearch() {\n+        List<String> phonePlanIds = new ArrayList<>();\n+        phonePlanIds.add(\"27b53eec-8ff4-4070-8900-fbeaabfd158a\");\n+\n+        CreateSearchOptions createSearchOptions = new CreateSearchOptions();\n+        createSearchOptions\n+            .setAreaCode(AREA_CODE_FOR_SEARCH)\n+            .setDescription(\"testsearch20200014\")\n+            .setDisplayName(\"testsearch20200014\")\n+            .setPhonePlanIds(phonePlanIds)\n+            .setQuantity(2);\n+\n+        Duration duration = Duration.ofSeconds(5);\n+        PhoneNumberAsyncClient client = this.getClient();\n+        PollerFlux<PhoneNumberSearch, PhoneNumberSearch> res = client.beginCreateSearch(createSearchOptions, duration);\n+        SyncPoller<PhoneNumberSearch, PhoneNumberSearch> sync = res.getSyncPoller();\n+        sync.waitForCompletion();\n+        PhoneNumberSearch testResult = sync.getFinalResult();", "originalCommit": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDU0MzY3MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500543671", "bodyText": "This doesn't seen right, doesn't it mean that the poll happens every 60s so if the caller doesn't specify a poll duration, it will take this long for their method to complete? Could you check what is the typical default duration and do we need to have a default at all? Maybe this should be required?", "author": "ankitarorabit", "createdAt": "2020-10-06T19:27:34Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -53,6 +60,7 @@\n @ServiceClient(builder = PhoneNumberClientBuilder.class, isAsync = true)\n public final class PhoneNumberAsyncClient {\n     private final ClientLogger logger = new ClientLogger(PhoneNumberAsyncClient.class);\n+    private static final Duration DEFAULT_POLL_INTERVAL = Duration.ofSeconds(60);", "originalCommit": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDU3MTQ2Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500571462", "bodyText": "I made it a required parameter now so we shouldn't have this problem anymore \ud83d\udc4d", "author": "jbeauregardb", "createdAt": "2020-10-06T20:19:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDU0MzY3MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDU0NDA5OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500544098", "bodyText": "Check for non-null needed here?", "author": "ankitarorabit", "createdAt": "2020-10-06T19:28:19Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +765,73 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param lroDuration The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration lroDuration) {", "originalCommit": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDU0NzQ0NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500547444", "bodyText": "How is this going to work.. if you just assign the searchId to a new PhoneNumberSearch object? Shouldn't you do something - getSearchById(createSearchResponse.getSearchId())?", "author": "ankitarorabit", "createdAt": "2020-10-06T19:34:41Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +765,73 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param lroDuration The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration lroDuration) {\n+        final Duration interval = lroDuration != null ? lroDuration : DEFAULT_POLL_INTERVAL;\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(interval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            (activationResponse, pollingContext) -> Mono.error(new RuntimeException(\"Cancellation is not supported\")),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PhoneNumberSearch>> createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse ->\n+            {\n+                String searchId = createSearchResponse.getSearchId();\n+                PhoneNumberSearch phoneNumberSearch = new PhoneNumberSearch().setSearchId(searchId);", "originalCommit": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDU0ODE2OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500548169", "bodyText": "Can we clean this up a bit, get the status in a variable and set do the same this for Expired, cancelled, etc..", "author": "ankitarorabit", "createdAt": "2020-10-06T19:36:02Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +765,73 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param lroDuration The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration lroDuration) {\n+        final Duration interval = lroDuration != null ? lroDuration : DEFAULT_POLL_INTERVAL;\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(interval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            (activationResponse, pollingContext) -> Mono.error(new RuntimeException(\"Cancellation is not supported\")),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PhoneNumberSearch>> createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse ->\n+            {\n+                String searchId = createSearchResponse.getSearchId();\n+                PhoneNumberSearch phoneNumberSearch = new PhoneNumberSearch().setSearchId(searchId);\n+                return Mono.just(phoneNumberSearch);\n+            });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PollResponse<PhoneNumberSearch>>> createSearchPollOperation() {\n+        return pollingContext ->\n+            getSearchById(pollingContext.getActivationResponse().getValue().getSearchId())\n+                .flatMap(getSearchResponse -> {\n+                    if (getSearchResponse.getStatus().equals(SearchStatus.SUCCESS)) {\n+                        return Mono.just(new PollResponse<>(", "originalCommit": "7f328f0c786af25fbcbd059ef1c65ab26058bf1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3MzgwOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500673809", "bodyText": "I see this is still not fixed", "author": "ankitarorabit", "createdAt": "2020-10-07T00:44:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDU0ODE2OQ=="}], "type": "inlineReview"}, {"oid": "7e7c6d3ff0d72ac1b9c82d93c9515990bf1d91cc", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7e7c6d3ff0d72ac1b9c82d93c9515990bf1d91cc", "message": "Addressed PR comments", "committedDate": "2020-10-06T22:26:00Z", "type": "forcePushed"}, {"oid": "f18bf71da44e2d3e89f569c4faa7eb4bf046a188", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f18bf71da44e2d3e89f569c4faa7eb4bf046a188", "message": "Addressed PR comments", "committedDate": "2020-10-06T22:46:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3MzE0MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500673140", "bodyText": "Sorry I should have mentioned it in the previous review iteration but this style of specifying parameters in different lines is quite confusing, did you see this as a standard somewhere? Shouldn't this be better --\nprivate Function<PollingContext, Mono>\ncreateSearchActivationOperation(CreateSearchOptions options) {", "author": "ankitarorabit", "createdAt": "2020-10-07T00:41:40Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,83 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration pollInterval) {\n+        Objects.requireNonNull(options, \"'options' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(pollInterval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            cancelSearchOperation(),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PhoneNumberSearch>> createSearchActivationOperation(CreateSearchOptions options) {", "originalCommit": "f18bf71da44e2d3e89f569c4faa7eb4bf046a188", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3NDI3Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r500674277", "bodyText": "Can't we do something like pollingContext.getLatestResponse().. this is pretty much getting the searchId and querying the sync status api", "author": "ankitarorabit", "createdAt": "2020-10-07T00:46:00Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,83 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration pollInterval) {\n+        Objects.requireNonNull(options, \"'options' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(pollInterval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            cancelSearchOperation(),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PhoneNumberSearch>> createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse -> {\n+                String searchId = createSearchResponse.getSearchId();\n+                Mono<PhoneNumberSearch> phoneNumberSearch = getSearchById(searchId);\n+                return phoneNumberSearch;\n+            });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PollResponse<PhoneNumberSearch>>> createSearchPollOperation() {\n+        return pollingContext ->\n+            getSearchById(pollingContext.getActivationResponse().getValue().getSearchId())", "originalCommit": "f18bf71da44e2d3e89f569c4faa7eb4bf046a188", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTEzMTc1Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501131752", "bodyText": "The activation response has the search id I'm trying to create, so to poll on the status on that number, I need to get that searchId from the activation operation. The getLatestResponse() function just returns the latest from the polling operation, so at that moment, getLatestResponse() doesn't have anything", "author": "jbeauregardb", "createdAt": "2020-10-07T16:03:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3NDI3Nw=="}], "type": "inlineReview"}, {"oid": "396c715e8da2ef8d212f37cb673e806b0d33eada", "url": "https://github.com/Azure/azure-sdk-for-java/commit/396c715e8da2ef8d212f37cb673e806b0d33eada", "message": "Addressed Ankit's comments", "committedDate": "2020-10-07T16:26:22Z", "type": "forcePushed"}, {"oid": "8104031a50db719e2f6bb67892798adc55acf5a0", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8104031a50db719e2f6bb67892798adc55acf5a0", "message": "Addressed Ankit's comments", "committedDate": "2020-10-07T16:35:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3NTAwNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501175005", "bodyText": "From design standpoint, I am thinking that our poll result type should be SearchStatus instead of PhoneNumberSearch.. so then this declaration should change to --\npublic PollerFlux<SearchStatus, PhoneNumberSearch> beginCreateSearch", "author": "ankitarorabit", "createdAt": "2020-10-07T17:08:59Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,84 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(", "originalCommit": "8104031a50db719e2f6bb67892798adc55acf5a0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3Njg2Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501176867", "bodyText": "The only thing about this is that we we wouldn't have a searchId to look for in the polling operation because we would be returning a SearchStatus, that doesn't have a searchId as a property", "author": "jbeauregardb", "createdAt": "2020-10-07T17:12:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3NTAwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3NzYxOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501177619", "bodyText": "And also, our polling operation would have to return a SearchStatus and that wouldn't help in the fetchResultOperation, that just takes the final response from the polling operation and returns it.", "author": "jbeauregardb", "createdAt": "2020-10-07T17:13:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3NTAwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3NTc3Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501175777", "bodyText": "So if change the polling type as per my other comment, the return type would just change to Mono.just(SearchStatus.Cancelled) ..", "author": "ankitarorabit", "createdAt": "2020-10-07T17:10:12Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,84 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration pollInterval) {\n+        Objects.requireNonNull(options, \"'options' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(pollInterval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            cancelSearchOperation(),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, Mono<PhoneNumberSearch>> \n+        createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse -> {\n+                String searchId = createSearchResponse.getSearchId();\n+                Mono<PhoneNumberSearch> phoneNumberSearch = getSearchById(searchId);\n+                return phoneNumberSearch;\n+            });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PollResponse<PhoneNumberSearch>>> createSearchPollOperation() {\n+        return pollingContext ->\n+            getSearchById(pollingContext.getActivationResponse().getValue().getSearchId())\n+                .flatMap(getSearchResponse -> {\n+                    SearchStatus status = getSearchResponse.getStatus();\n+                    if (status.equals(SearchStatus.SUCCESS)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.EXPIRED)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.CANCELLED)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.RESERVED)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.ERROR)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.FAILED, getSearchResponse));\n+                    }\n+                    return Mono.just(new PollResponse<>(LongRunningOperationStatus.IN_PROGRESS, getSearchResponse));\n+                });\n+    }\n+\n+    private BiFunction<PollingContext<PhoneNumberSearch>,\n+        PollResponse<PhoneNumberSearch>, Mono<PhoneNumberSearch>> \n+        cancelSearchOperation() {\n+        return (pollingContext, firstResponse) -> {\n+            cancelSearch(pollingContext.getActivationResponse().getValue().getSearchId());\n+            return Mono.just(new PhoneNumberSearch());", "originalCommit": "8104031a50db719e2f6bb67892798adc55acf5a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTE3NzYzNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501177634", "bodyText": "You would probably have to change this as well since the pollingContext ill not have the result anymore", "author": "ankitarorabit", "createdAt": "2020-10-07T17:13:15Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,84 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration pollInterval) {\n+        Objects.requireNonNull(options, \"'options' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(pollInterval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            cancelSearchOperation(),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, Mono<PhoneNumberSearch>> \n+        createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse -> {\n+                String searchId = createSearchResponse.getSearchId();\n+                Mono<PhoneNumberSearch> phoneNumberSearch = getSearchById(searchId);\n+                return phoneNumberSearch;\n+            });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PollResponse<PhoneNumberSearch>>> createSearchPollOperation() {\n+        return pollingContext ->\n+            getSearchById(pollingContext.getActivationResponse().getValue().getSearchId())\n+                .flatMap(getSearchResponse -> {\n+                    SearchStatus status = getSearchResponse.getStatus();\n+                    if (status.equals(SearchStatus.SUCCESS)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.EXPIRED)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.CANCELLED)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.RESERVED)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.ERROR)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.FAILED, getSearchResponse));\n+                    }\n+                    return Mono.just(new PollResponse<>(LongRunningOperationStatus.IN_PROGRESS, getSearchResponse));\n+                });\n+    }\n+\n+    private BiFunction<PollingContext<PhoneNumberSearch>,\n+        PollResponse<PhoneNumberSearch>, Mono<PhoneNumberSearch>> \n+        cancelSearchOperation() {\n+        return (pollingContext, firstResponse) -> {\n+            cancelSearch(pollingContext.getActivationResponse().getValue().getSearchId());\n+            return Mono.just(new PhoneNumberSearch());\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>,\n+        Mono<PhoneNumberSearch>> createSearchFetchResultOperation() {\n+        return pollingContext -> {\n+            return Mono.just(pollingContext.getLatestResponse().getValue());", "originalCommit": "8104031a50db719e2f6bb67892798adc55acf5a0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4MTU0Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501281543", "bodyText": "nit: can you fix formatting..\nprivate Function<PollingContext, Mono<PollResponse>>\ncreateSearchPollOperation()", "author": "ankitarorabit", "createdAt": "2020-10-07T20:13:13Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,75 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration pollInterval) {\n+        Objects.requireNonNull(options, \"'options' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(pollInterval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            cancelSearchOperation(),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, Mono<PhoneNumberSearch>> \n+        createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse -> {\n+                String searchId = createSearchResponse.getSearchId();\n+                Mono<PhoneNumberSearch> phoneNumberSearch = getSearchById(searchId);\n+                return phoneNumberSearch;\n+            });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PollResponse<PhoneNumberSearch>>> createSearchPollOperation() {", "originalCommit": "e3af350d3fd8f0eb11ef650358f7d8cd38854c04", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4MjEyNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501282127", "bodyText": "nit: can you format the tabs\nif (status.equals(SearchStatus.SUCCESS) ||\nstatus.equals(SearchStatus.EXPIRED) ||\nstatus.equals(SearchStatus.CANCELLED) ||\nstatus.equals(SearchStatus.RESERVED)) {", "author": "ankitarorabit", "createdAt": "2020-10-07T20:14:17Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,75 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration pollInterval) {\n+        Objects.requireNonNull(options, \"'options' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(pollInterval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            cancelSearchOperation(),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, Mono<PhoneNumberSearch>> \n+        createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse -> {\n+                String searchId = createSearchResponse.getSearchId();\n+                Mono<PhoneNumberSearch> phoneNumberSearch = getSearchById(searchId);\n+                return phoneNumberSearch;\n+            });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PollResponse<PhoneNumberSearch>>> createSearchPollOperation() {\n+        return pollingContext ->\n+            getSearchById(pollingContext.getLatestResponse().getValue().getSearchId())\n+                .flatMap(getSearchResponse -> {\n+                    SearchStatus status = getSearchResponse.getStatus();\n+                    if (status.equals(SearchStatus.SUCCESS) || \n+                    status.equals(SearchStatus.EXPIRED) || \n+                    status.equals(SearchStatus.CANCELLED) || \n+                    status.equals(SearchStatus.RESERVED)) {", "originalCommit": "e3af350d3fd8f0eb11ef650358f7d8cd38854c04", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4MjY3Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501282676", "bodyText": "I don't think we should get SUCCESS in here, because that is after purchaseSearch.. but I don;t kow what is the right thing to do in that case..", "author": "ankitarorabit", "createdAt": "2020-10-07T20:15:17Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,75 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration pollInterval) {\n+        Objects.requireNonNull(options, \"'options' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(pollInterval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            cancelSearchOperation(),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, Mono<PhoneNumberSearch>> \n+        createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse -> {\n+                String searchId = createSearchResponse.getSearchId();\n+                Mono<PhoneNumberSearch> phoneNumberSearch = getSearchById(searchId);\n+                return phoneNumberSearch;\n+            });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PollResponse<PhoneNumberSearch>>> createSearchPollOperation() {\n+        return pollingContext ->\n+            getSearchById(pollingContext.getLatestResponse().getValue().getSearchId())\n+                .flatMap(getSearchResponse -> {\n+                    SearchStatus status = getSearchResponse.getStatus();\n+                    if (status.equals(SearchStatus.SUCCESS) || ", "originalCommit": "e3af350d3fd8f0eb11ef650358f7d8cd38854c04", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI5MDI2OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501290269", "bodyText": "Let me ask the team about this \ud83d\udc4d", "author": "jbeauregardb", "createdAt": "2020-10-07T20:29:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4MjY3Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4Mjg3MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501282870", "bodyText": "nit: space between arguments", "author": "ankitarorabit", "createdAt": "2020-10-07T20:15:43Z", "path": "sdk/communication/azure-communication-administration/src/main/java/com/azure/communication/administration/PhoneNumberAsyncClient.java", "diffHunk": "@@ -757,4 +764,75 @@\n             return monoError(logger, ex);\n         }\n     }\n+\n+    /**\n+     * Initiates a search and returns a {@link PhoneNumberSearch} usable by other functions\n+     * This function returns a Long Running Operation poller that allows you to \n+     * wait indefinitely until the operation is complete.\n+     * \n+     * @param options A {@link CreateSearchOptions} with the search options\n+     * @param pollInterval The time our long running operation will keep on polling \n+     * until it gets a result from the server\n+     * @return A {@link PollerFlux} object with the search result\n+     */\n+    @ServiceMethod(returns = ReturnType.COLLECTION)\n+    public PollerFlux<PhoneNumberSearch, PhoneNumberSearch> beginCreateSearch(\n+        CreateSearchOptions options, Duration pollInterval) {\n+        Objects.requireNonNull(options, \"'options' cannot be null.\");\n+        Objects.requireNonNull(pollInterval, \"'pollInterval' cannot be null.\");\n+        return new PollerFlux<PhoneNumberSearch, PhoneNumberSearch>(pollInterval,\n+            createSearchActivationOperation(options),\n+            createSearchPollOperation(),\n+            cancelSearchOperation(),\n+            createSearchFetchResultOperation());\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, Mono<PhoneNumberSearch>> \n+        createSearchActivationOperation(CreateSearchOptions options) {\n+        return (pollingContext) -> {\n+            Mono<PhoneNumberSearch> response = createSearch(options).flatMap(createSearchResponse -> {\n+                String searchId = createSearchResponse.getSearchId();\n+                Mono<PhoneNumberSearch> phoneNumberSearch = getSearchById(searchId);\n+                return phoneNumberSearch;\n+            });\n+            return response;\n+        };\n+    }\n+\n+    private Function<PollingContext<PhoneNumberSearch>, \n+        Mono<PollResponse<PhoneNumberSearch>>> createSearchPollOperation() {\n+        return pollingContext ->\n+            getSearchById(pollingContext.getLatestResponse().getValue().getSearchId())\n+                .flatMap(getSearchResponse -> {\n+                    SearchStatus status = getSearchResponse.getStatus();\n+                    if (status.equals(SearchStatus.SUCCESS) || \n+                    status.equals(SearchStatus.EXPIRED) || \n+                    status.equals(SearchStatus.CANCELLED) || \n+                    status.equals(SearchStatus.RESERVED)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.SUCCESSFULLY_COMPLETED, getSearchResponse));\n+                    }\n+                    if (status.equals(SearchStatus.ERROR)) {\n+                        return Mono.just(new PollResponse<>(\n+                        LongRunningOperationStatus.FAILED, getSearchResponse));\n+                    }\n+                    return Mono.just(new PollResponse<>(LongRunningOperationStatus.IN_PROGRESS, getSearchResponse));\n+                });\n+    }\n+\n+    private BiFunction<PollingContext<PhoneNumberSearch>,\n+        PollResponse<PhoneNumberSearch>,Mono<PhoneNumberSearch>> ", "originalCommit": "e3af350d3fd8f0eb11ef650358f7d8cd38854c04", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4MzQ5OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501283499", "bodyText": "why not just do a .getSyncPoller right here?", "author": "ankitarorabit", "createdAt": "2020-10-07T20:16:58Z", "path": "sdk/communication/azure-communication-administration/src/test/java/com/azure/communication/administration/PhoneNumberAsyncClientIntegrationTest.java", "diffHunk": "@@ -449,6 +452,29 @@ public void releasePhoneNumbersWithResponse() {\n             .verifyComplete();\n     }\n \n+    @Test()\n+    public void beginCreateSearch() {\n+        List<String> phonePlanIds = new ArrayList<>();\n+        phonePlanIds.add(PHONE_PLAN_ID);\n+\n+        CreateSearchOptions createSearchOptions = new CreateSearchOptions();\n+        createSearchOptions\n+            .setAreaCode(AREA_CODE_FOR_SEARCH)\n+            .setDescription(SEARCH_OPTIONS_DESCRIPTION)\n+            .setDisplayName(SEARCH_OPTIONS_NAME)\n+            .setPhonePlanIds(phonePlanIds)\n+            .setQuantity(2);\n+\n+        Duration duration = Duration.ofSeconds(1);\n+        PhoneNumberAsyncClient client = this.getClient();\n+        PollerFlux<PhoneNumberSearch, PhoneNumberSearch> res = client.beginCreateSearch(createSearchOptions, duration);", "originalCommit": "e3af350d3fd8f0eb11ef650358f7d8cd38854c04", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "29a7635d08d98c2b02068c25d099c810ffc66e71", "url": "https://github.com/Azure/azure-sdk-for-java/commit/29a7635d08d98c2b02068c25d099c810ffc66e71", "message": "Cleaned poll operation", "committedDate": "2020-10-07T20:25:32Z", "type": "forcePushed"}, {"oid": "faae145a6b80f3dae615e8e4f46ba6bd50681f32", "url": "https://github.com/Azure/azure-sdk-for-java/commit/faae145a6b80f3dae615e8e4f46ba6bd50681f32", "message": "Removed SUCCESS as a terminal state", "committedDate": "2020-10-07T20:37:15Z", "type": "forcePushed"}, {"oid": "40e4e0671960a0c17547f94c3e459078b5ff0d88", "url": "https://github.com/Azure/azure-sdk-for-java/commit/40e4e0671960a0c17547f94c3e459078b5ff0d88", "message": "Removed SUCCESS as a terminal state", "committedDate": "2020-10-07T23:06:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM2ODE5MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15998#discussion_r501368191", "bodyText": "If you call \"getSyncPoller\", your test is sync. Might as well call the sync client version and move this test to the sync client test file instead.\nFor testing async version, you might want to test subscribe function of PollerFux with callback.", "author": "JianpingChen", "createdAt": "2020-10-07T23:33:28Z", "path": "sdk/communication/azure-communication-administration/src/test/java/com/azure/communication/administration/PhoneNumberAsyncClientIntegrationTest.java", "diffHunk": "@@ -463,6 +465,29 @@ public void releasePhoneNumbersWithResponse() {\n             .verifyComplete();\n     }\n \n+    @Test()\n+    public void beginCreateSearch() {\n+        List<String> phonePlanIds = new ArrayList<>();\n+        phonePlanIds.add(PHONE_PLAN_ID);\n+\n+        CreateSearchOptions createSearchOptions = new CreateSearchOptions();\n+        createSearchOptions\n+            .setAreaCode(AREA_CODE_FOR_SEARCH)\n+            .setDescription(SEARCH_OPTIONS_DESCRIPTION)\n+            .setDisplayName(SEARCH_OPTIONS_NAME)\n+            .setPhonePlanIds(phonePlanIds)\n+            .setQuantity(2);\n+\n+        Duration duration = Duration.ofSeconds(1);\n+        PhoneNumberAsyncClient client = this.getClient();\n+        SyncPoller<PhoneNumberSearch, PhoneNumberSearch> res = \n+            client.beginCreateSearch(createSearchOptions, duration).getSyncPoller();", "originalCommit": "40e4e0671960a0c17547f94c3e459078b5ff0d88", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9eb7fd72d17f48f28aec1b00599504018aa3aec0", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9eb7fd72d17f48f28aec1b00599504018aa3aec0", "message": "Added create search LRO", "committedDate": "2020-10-08T20:29:56Z", "type": "commit"}, {"oid": "eb895c3b428e0e6544ec0df1d9515a28d0fae502", "url": "https://github.com/Azure/azure-sdk-for-java/commit/eb895c3b428e0e6544ec0df1d9515a28d0fae502", "message": "Addressed PR comments", "committedDate": "2020-10-08T20:29:57Z", "type": "commit"}, {"oid": "e5b1bee022b028e035f32f931625305651239e16", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e5b1bee022b028e035f32f931625305651239e16", "message": "Addressed Ankit's comments", "committedDate": "2020-10-08T20:29:57Z", "type": "commit"}, {"oid": "e93f26e9a2b03b11e72a155eb68ac9fab8dc1b70", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e93f26e9a2b03b11e72a155eb68ac9fab8dc1b70", "message": "Cleaned poll operation", "committedDate": "2020-10-08T20:29:58Z", "type": "commit"}, {"oid": "4808beeba5b9fa59ef77b64828959f96b3cfd176", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4808beeba5b9fa59ef77b64828959f96b3cfd176", "message": "Removed SUCCESS as a terminal state", "committedDate": "2020-10-08T20:29:59Z", "type": "commit"}, {"oid": "e759547b73cbf07174c8af5f21fecbf9d6ad6742", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e759547b73cbf07174c8af5f21fecbf9d6ad6742", "message": "Test redone to use async responses", "committedDate": "2020-10-08T20:29:59Z", "type": "forcePushed"}, {"oid": "6176e0a9689e15a2545ac9dc775df4f5c3156903", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6176e0a9689e15a2545ac9dc775df4f5c3156903", "message": "Test redone to use async responses", "committedDate": "2020-10-08T20:33:19Z", "type": "commit"}, {"oid": "6176e0a9689e15a2545ac9dc775df4f5c3156903", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6176e0a9689e15a2545ac9dc775df4f5c3156903", "message": "Test redone to use async responses", "committedDate": "2020-10-08T20:33:19Z", "type": "forcePushed"}]}