{"pr_number": 15834, "pr_title": "Add support for verify peer.", "pr_createdAt": "2020-09-30T18:45:50Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/15834", "timeline": [{"oid": "d81216c4f048e07ac02bd3518c7e22fff8a36766", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d81216c4f048e07ac02bd3518c7e22fff8a36766", "message": "Adding StrictTlsContext and StrictTlsContextSpi.", "committedDate": "2020-09-29T06:47:34Z", "type": "commit"}, {"oid": "e7bc97496647646c673755f97447ce4f07673628", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e7bc97496647646c673755f97447ce4f07673628", "message": "Add overloads to ConnectionHandler and WebSocketsConnectionHandler to verify peer.", "committedDate": "2020-09-29T06:47:45Z", "type": "commit"}, {"oid": "cf94fe285909d09499b3a153593da642e724dafe", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cf94fe285909d09499b3a153593da642e724dafe", "message": "Fixing broken build from new constructor.", "committedDate": "2020-09-29T06:58:21Z", "type": "commit"}, {"oid": "04e099cf27045606b38bbae29838919b2323ed55", "url": "https://github.com/Azure/azure-sdk-for-java/commit/04e099cf27045606b38bbae29838919b2323ed55", "message": "Removing MockReactorHandlerProvider and fixing test breaks.", "committedDate": "2020-09-30T05:27:17Z", "type": "commit"}, {"oid": "0da1a9ff42c196ff585fe8095a66af04787eab27", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0da1a9ff42c196ff585fe8095a66af04787eab27", "message": "Adding tests for StrictTlsContextSpi.", "committedDate": "2020-09-30T09:07:44Z", "type": "commit"}, {"oid": "36806f647cfd9ff978d585dc794bfb70ce6bc56c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/36806f647cfd9ff978d585dc794bfb70ce6bc56c", "message": "Ensure ClientOptions is not null.", "committedDate": "2020-09-30T17:30:35Z", "type": "commit"}, {"oid": "db87f3d74576b0cb60f503caf77dd85b6de3ee04", "url": "https://github.com/Azure/azure-sdk-for-java/commit/db87f3d74576b0cb60f503caf77dd85b6de3ee04", "message": "Fix build break in event hubs.", "committedDate": "2020-09-30T17:43:15Z", "type": "commit"}, {"oid": "2063e7eed7d69a36dc27a1dde2033de96cb8a8fb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2063e7eed7d69a36dc27a1dde2033de96cb8a8fb", "message": "Fixing test breaks in EventHubs.", "committedDate": "2020-09-30T18:10:44Z", "type": "commit"}, {"oid": "608e8e827dd71b94ce7c795c111d2f3f4894efde", "url": "https://github.com/Azure/azure-sdk-for-java/commit/608e8e827dd71b94ce7c795c111d2f3f4894efde", "message": "Fix Event Hubs.", "committedDate": "2020-09-30T18:40:52Z", "type": "commit"}, {"oid": "cd21f71257d05c41e6f002e3bc5f0fafbefed9c5", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cd21f71257d05c41e6f002e3bc5f0fafbefed9c5", "message": "Adding support for Service Bus.", "committedDate": "2020-09-30T18:42:21Z", "type": "commit"}, {"oid": "c55c866a368cfe92edb56261b2b1d8c8cb8d1e7b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c55c866a368cfe92edb56261b2b1d8c8cb8d1e7b", "message": "Fix test failures.", "committedDate": "2020-09-30T19:13:07Z", "type": "commit"}, {"oid": "0ba8e4912ff118ffe836886d32fecb30c12f50e2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0ba8e4912ff118ffe836886d32fecb30c12f50e2", "message": "Fix checkstyle error", "committedDate": "2020-09-30T19:37:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc2NTU5Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15834#discussion_r497765597", "bodyText": "nit: fix formatting", "author": "srnagar", "createdAt": "2020-09-30T19:59:13Z", "path": "sdk/core/azure-core-amqp/src/main/java/com/azure/core/amqp/implementation/ConnectionOptions.java", "diffHunk": "@@ -26,10 +27,13 @@\n     private final String fullyQualifiedNamespace;\n     private final CbsAuthorizationType authorizationType;\n     private final ClientOptions clientOptions;\n+    private final SslDomain.VerifyMode verifyMode;\n \n     public ConnectionOptions(String fullyQualifiedNamespace, TokenCredential tokenCredential,\n             CbsAuthorizationType authorizationType, AmqpTransportType transport, AmqpRetryOptions retryOptions,\n-            ProxyOptions proxyOptions, Scheduler scheduler, ClientOptions clientOptions) {\n+            ProxyOptions proxyOptions, Scheduler scheduler, ClientOptions clientOptions,\n+        SslDomain.VerifyMode verifyMode) {", "originalCommit": "c55c866a368cfe92edb56261b2b1d8c8cb8d1e7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODA2NzQ2MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15834#discussion_r498067461", "bodyText": "oof. Good catch.", "author": "conniey", "createdAt": "2020-10-01T08:22:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Nzc2NTU5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODA1NDk4NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15834#discussion_r498054985", "bodyText": "Do we plan of supporting any other mode apart from VERIFY_PEER_NAME?", "author": "srnagar", "createdAt": "2020-10-01T08:00:10Z", "path": "sdk/eventhubs/azure-messaging-eventhubs/src/main/java/com/azure/messaging/eventhubs/EventHubClientBuilder.java", "diffHunk": "@@ -630,8 +645,10 @@ private ConnectionOptions getConnectionOptions() {\n             ? CbsAuthorizationType.SHARED_ACCESS_SIGNATURE\n             : CbsAuthorizationType.JSON_WEB_TOKEN;\n \n+        final ClientOptions options = clientOptions != null ? clientOptions : new ClientOptions();\n+\n         return new ConnectionOptions(fullyQualifiedNamespace, credentials, authorizationType, transport, retryOptions,\n-            proxyOptions, scheduler, null);\n+            proxyOptions, scheduler, options, SslDomain.VerifyMode.VERIFY_PEER_NAME);", "originalCommit": "c55c866a368cfe92edb56261b2b1d8c8cb8d1e7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODA2NzM5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15834#discussion_r498067394", "bodyText": "In Service Bus, they had additional configuration via environment variables. It's not a feature we ever discussed.", "author": "conniey", "createdAt": "2020-10-01T08:22:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODA1NDk4NQ=="}], "type": "inlineReview"}, {"oid": "b7ece9e6ee8cdf9f98a890104d0031de7882f09a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b7ece9e6ee8cdf9f98a890104d0031de7882f09a", "message": "Fixing formatting.", "committedDate": "2020-10-01T18:44:03Z", "type": "commit"}, {"oid": "e7789d1e51a8a55ffb4fc13ea7188182408d681b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e7789d1e51a8a55ffb4fc13ea7188182408d681b", "message": "Replacing deprecated with verifyNoInteractions.", "committedDate": "2020-10-01T18:53:31Z", "type": "commit"}, {"oid": "ea4389486f479d3df4b24e890d69a9e6efbb80fb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ea4389486f479d3df4b24e890d69a9e6efbb80fb", "message": "Adding package-private verification mode for testing.", "committedDate": "2020-10-01T18:58:47Z", "type": "commit"}, {"oid": "257402e7d5e639c78791e6d7cca88cdf9053d56a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/257402e7d5e639c78791e6d7cca88cdf9053d56a", "message": "Fixing Proxy Send test because we do not self-sign certs", "committedDate": "2020-10-01T21:56:35Z", "type": "commit"}, {"oid": "f476bf3623ce87903175394f187a2a1585449e4c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f476bf3623ce87903175394f187a2a1585449e4c", "message": "Remove unused import", "committedDate": "2020-10-01T22:51:52Z", "type": "commit"}]}