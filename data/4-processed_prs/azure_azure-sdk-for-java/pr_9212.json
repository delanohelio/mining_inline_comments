{"pr_number": 9212, "pr_title": "DO NOT MERGE | Cosmos 4.X | Address memory leak in Direct TCP transport client", "pr_createdAt": "2020-03-19T00:44:41Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/9212", "timeline": [{"oid": "84a37ab329525ae52d7c1adc6e7ba3c33625c5c7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/84a37ab329525ae52d7c1adc6e7ba3c33625c5c7", "message": "Port from v4", "committedDate": "2019-11-07T04:36:56Z", "type": "commit"}, {"oid": "d218925e1dff21266697a27e4271d34dfcc3b6a7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d218925e1dff21266697a27e4271d34dfcc3b6a7", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2019-11-08T01:46:09Z", "type": "commit"}, {"oid": "11cbbf37bf63bf50e94f67fe30300ac39c72ed4f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/11cbbf37bf63bf50e94f67fe30300ac39c72ed4f", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java", "committedDate": "2019-11-08T03:20:35Z", "type": "commit"}, {"oid": "05c7e0551ffb6fd1ed80c15d1068cb32e734007e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/05c7e0551ffb6fd1ed80c15d1068cb32e734007e", "message": "Corrected package misspelling in log4j.properties and removed System.exit from Main.java", "committedDate": "2019-11-09T00:07:30Z", "type": "commit"}, {"oid": "8dfa3dbf03ae2addeddcb34ffc67c362670a164c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8dfa3dbf03ae2addeddcb34ffc67c362670a164c", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java", "committedDate": "2019-11-09T00:07:47Z", "type": "commit"}, {"oid": "e6e71f5e6b292cac17b6a9687d04ad858f02a8a1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e6e71f5e6b292cac17b6a9687d04ad858f02a8a1", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2019-11-09T18:42:20Z", "type": "commit"}, {"oid": "e082d817a13d64ed57e5243cbc1da5b4ef0ab58e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e082d817a13d64ed57e5243cbc1da5b4ef0ab58e", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java", "committedDate": "2019-11-17T00:51:11Z", "type": "commit"}, {"oid": "069c822e997087f384cf1a1864e7efec331e69f8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/069c822e997087f384cf1a1864e7efec331e69f8", "message": "Merge branch 'master' of github.com:David-Noble-at-work/azure-sdk-for-java", "committedDate": "2019-11-23T22:36:47Z", "type": "commit"}, {"oid": "3ead1cca230e56b61e5376e73bd1481f7a7b81e6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/3ead1cca230e56b61e5376e73bd1481f7a7b81e6", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2019-12-03T18:58:37Z", "type": "commit"}, {"oid": "669ba8b28ed6ae321fda445e0e167ff027cc6481", "url": "https://github.com/Azure/azure-sdk-for-java/commit/669ba8b28ed6ae321fda445e0e167ff027cc6481", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2019-12-04T19:34:26Z", "type": "commit"}, {"oid": "735f57269d45a3497a66d47d594b7efac88179ff", "url": "https://github.com/Azure/azure-sdk-for-java/commit/735f57269d45a3497a66d47d594b7efac88179ff", "message": "Responded to code review comments", "committedDate": "2019-12-04T19:36:31Z", "type": "commit"}, {"oid": "6db330d843c4cdbb80b90c6f734f69a59afb9183", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6db330d843c4cdbb80b90c6f734f69a59afb9183", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2020-01-04T00:31:23Z", "type": "commit"}, {"oid": "48855b55564f6f216ee6a156f7a64ff5991ee2e6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/48855b55564f6f216ee6a156f7a64ff5991ee2e6", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2020-01-04T02:07:38Z", "type": "commit"}, {"oid": "2367f50dd69e8f4d1ba123c3b42ad4388caeaa66", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2367f50dd69e8f4d1ba123c3b42ad4388caeaa66", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2020-01-17T20:51:14Z", "type": "commit"}, {"oid": "fb9cac0c12e21f09e3c45580bf324bef7733b8c1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/fb9cac0c12e21f09e3c45580bf324bef7733b8c1", "message": "Updated sdk/cosmos/README.md with info on using system properties to modify default Direct TCP options", "committedDate": "2020-01-23T01:18:46Z", "type": "commit"}, {"oid": "1dd708ef9e753607040a6bb1f2b69c863dda8a0a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1dd708ef9e753607040a6bb1f2b69c863dda8a0a", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2020-01-23T01:21:11Z", "type": "commit"}, {"oid": "203507a249705593b04dec3e36566537d15da4e2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/203507a249705593b04dec3e36566537d15da4e2", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2020-03-16T00:12:48Z", "type": "commit"}, {"oid": "368b10f9893cdf49e95545e8ae4ec5ff03450f60", "url": "https://github.com/Azure/azure-sdk-for-java/commit/368b10f9893cdf49e95545e8ae4ec5ff03450f60", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java", "committedDate": "2020-03-16T17:10:04Z", "type": "commit"}, {"oid": "f7544aa31e210fe20d9939c26b17c9dbb4d7d72f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f7544aa31e210fe20d9939c26b17c9dbb4d7d72f", "message": "Ported memory leak from v2.6.X and bumped version number.", "committedDate": "2020-03-17T01:24:39Z", "type": "commit"}, {"oid": "4cd3a139255f258d20b3c56ce9d00462add02b2b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4cd3a139255f258d20b3c56ce9d00462add02b2b", "message": "Removed a file that was mistakenly committed", "committedDate": "2020-03-18T01:32:58Z", "type": "commit"}, {"oid": "8f58a9c7b813cc0f1d39071c8dd64e667681e2ec", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8f58a9c7b813cc0f1d39071c8dd64e667681e2ec", "message": "Space adjustments for readability", "committedDate": "2020-03-18T05:41:03Z", "type": "commit"}, {"oid": "49baa6abd3e5ee01571b05c776ef43ff6efe7620", "url": "https://github.com/Azure/azure-sdk-for-java/commit/49baa6abd3e5ee01571b05c776ef43ff6efe7620", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into issue/cosmos-4.X/direct-tcp/memory-leak", "committedDate": "2020-03-19T00:30:26Z", "type": "commit"}, {"oid": "c89928a0e347e7aae125566eedfe3807a3530740", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c89928a0e347e7aae125566eedfe3807a3530740", "message": "Merge branch 'master' into issue/cosmos-4.X/direct-tcp/memory-leak", "committedDate": "2020-03-30T19:54:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ1NDAxNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9212#discussion_r400454015", "bodyText": "why are we adding Readme file as part of this file?\nDis this come as part of merging v3 branch to v4?", "author": "moderakh", "createdAt": "2020-03-30T19:53:07Z", "path": "sdk/cosmos/README.md", "diffHunk": "@@ -0,0 +1,295 @@\n+\ufeff# Java SDK for SQL API of Azure Cosmos DB", "originalCommit": "49baa6abd3e5ee01571b05c776ef43ff6efe7620", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ1ODgzMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9212#discussion_r400458830", "bodyText": "I think so too. There are more changes on pom.xml files. I am planning to fix it now.", "author": "kushagraThapar", "createdAt": "2020-03-30T20:02:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ1NDAxNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ1NDE2Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9212#discussion_r400454167", "bodyText": "v3 version. this is v4 repo.", "author": "moderakh", "createdAt": "2020-03-30T19:53:23Z", "path": "sdk/cosmos/README.md", "diffHunk": "@@ -0,0 +1,295 @@\n+\ufeff# Java SDK for SQL API of Azure Cosmos DB\n+\n+[![Maven Central](https://img.shields.io/maven-central/v/com.microsoft.azure/azure-cosmos.svg)](https://search.maven.org/artifact/com.microsoft.azure/azure-cosmos)\n+[![Known Vulnerabilities](https://snyk.io/test/github/Azure/azure-cosmosdb-java/badge.svg?targetFile=sdk%2Fpom.xml)](https://snyk.io/test/github/Azure/azure-cosmosdb-java?targetFile=sdk%2Fpom.xml)\n+\n+<!--[![Coverage Status](https://img.shields.io/codecov/c/github/Azure/azure-cosmos-java.svg)](https://codecov.io/gh/Azure/azure-cosmosdb-java)\n+![](https://img.shields.io/github/issues/azure/azure-cosmosdb-java.svg)\n+ -->\n+\n+<!-- TOC depthFrom:2 depthTo:2 withLinks:1 updateOnSave:1 orderedList:0 -->\n+\n+- [Consuming the official Microsoft Azure Cosmos DB Java SDK](#consuming-the-official-microsoft-azure-cosmos-db-java-sdk)\n+- [Prerequisites](#prerequisites)\n+- [API Documentation](#api-documentation)\n+- [Usage Code Sample](#usage-code-sample)\n+- [Guide for Prod](#guide-for-prod)\n+- [FAQ](#faq)\n+- [Release changes](#release-changes)\n+- [Contribution and Feedback](#contribution-and-feedback)\n+- [License](#license)\n+\n+<!-- /TOC -->\n+\n+## Example\n+\n+See the complete code for the above sample in [`HelloWorldDemo.java`](./microsoft-azure-cosmos-examples/src/main/java/com/azure/data/cosmos/examples/HelloWorldDemo.java)\n+\n+```java\n+import com.azure.data.cosmos.*;\n+import reactor.core.publisher.Mono;\n+\n+import java.io.IOException;\n+\n+// ...\n+\n+    // Create a new CosmosClient via the builder\n+    // It only requires endpoint and key, but other useful settings are available\n+    CosmosClient client = CosmosClient.builder()\n+        .endpoint(\"<YOUR ENDPOINT HERE>\")\n+        .key(\"<YOUR KEY HERE>\")\n+        .build();\n+\n+    // Get a reference to the container\n+    // This will create (or read) a database and its container.\n+    CosmosContainer container = client.createDatabaseIfNotExists(\"contoso-travel\")\n+        // TIP: Our APIs are Reactor Core based, so try to chain your calls\n+        .flatMap(response -> response.database()\n+                .createContainerIfNotExists(\"passengers\", \"/id\"))\n+        .flatMap(response -> Mono.just(response.container()))\n+        .block(); // Blocking for demo purposes (avoid doing this in production unless you must)\n+\n+    // Create an item\n+    container.createItem(new Passenger(\"carla.davis@outlook.com\", \"Carla Davis\", \"SEA\", \"IND\"))\n+        .flatMap(response -> {\n+            System.out.println(\"Created item: \" + response.properties().toJson());\n+            // Read that item\n+            return response.item().read();\n+        })\n+        .flatMap(response -> {\n+            System.out.println(\"Read item: \" + response.properties().toJson());\n+            // Replace that item\n+            try {\n+                Passenger p = response.properties().getObject(Passenger.class);\n+                p.setDestination(\"SFO\");\n+                return response.item().replace(p);\n+            } catch (IOException e) {\n+                System.err.println(e);\n+                return Mono.error(e);\n+            }\n+        })\n+        // delete that item\n+        .flatMap(response -> response.item().delete())\n+        .block(); // Blocking for demo purposes (avoid doing this in production unless you must)\n+// ...\n+```\n+\n+We have a get started sample app available [here](https://github.com/Azure-Samples/azure-cosmos-db-sql-api-async-java-getting-started).\n+\n+Also We have more examples in form of standalone unit tests in [examples project](examples/src/test/java/com/microsoft/azure/cosmosdb/rx/examples).\n+\n+## Consuming the official Microsoft Azure Cosmos DB Java SDK\n+\n+This project provides a SDK library in Java for interacting with [SQL API](https://docs.microsoft.com/en-us/azure/cosmos-db/sql-api-sql-query) of [Azure Cosmos DB\n+Database Service](https://azure.microsoft.com/en-us/services/cosmos-db/). This project also includes samples, tools, and utilities.\n+\n+Jar dependency binary information for maven and gradle can be found here at [maven](https://mvnrepository.com/artifact/com.microsoft.azure/azure-cosmos).\n+\n+For example, using maven, you can add the following dependency to your maven pom file:\n+\n+[//]: # ({x-version-update-start;com.microsoft.azure:azure-cosmos;current})\n+```xml\n+<dependency>\n+  <groupId>com.microsoft.azure</groupId>\n+  <artifactId>azure-cosmos</artifactId>\n+  <version>3.6.0</version>", "originalCommit": "49baa6abd3e5ee01571b05c776ef43ff6efe7620", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ1NDg0MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9212#discussion_r400454840", "bodyText": "This is an automated process for release version bump.\nalso we haven't released 4.0.1-beta.2 I think.\nhttps://mvnrepository.com/artifact/com.azure/azure-cosmos", "author": "moderakh", "createdAt": "2020-03-30T19:54:33Z", "path": "sdk/cosmos/azure-cosmos-benchmark/pom.xml", "diffHunk": "@@ -14,7 +14,7 @@ Licensed under the MIT License.\n \n   <groupId>com.azure</groupId>\n   <artifactId>azure-cosmos-benchmark</artifactId>\n-  <version>4.0.1-beta.1</version> <!-- {x-version-update;com.azure:azure-cosmos-benchmark;current} -->\n+  <version>4.0.1-beta.3</version> <!-- {x-version-update;com.azure:azure-cosmos-benchmark;current} -->", "originalCommit": "49baa6abd3e5ee01571b05c776ef43ff6efe7620", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5dede58c2b88fe6e575862b66a39fa9cab647e0a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5dede58c2b88fe6e575862b66a39fa9cab647e0a", "message": "Fixed version issues, and removed readme from parent folder", "committedDate": "2020-03-30T20:35:24Z", "type": "commit"}, {"oid": "ccee4c0237f438c8fe31676d98e655c016c32266", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ccee4c0237f438c8fe31676d98e655c016c32266", "message": "Fixed benchmark and examples version", "committedDate": "2020-03-30T20:38:39Z", "type": "commit"}]}