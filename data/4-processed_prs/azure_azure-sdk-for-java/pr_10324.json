{"pr_number": 10324, "pr_title": "Resource: fix spotbugs", "pr_createdAt": "2020-04-17T10:01:29Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/10324", "timeline": [{"oid": "db2b107fe9f9a9ad388bd484f6901540f08de070", "url": "https://github.com/Azure/azure-sdk-for-java/commit/db2b107fe9f9a9ad388bd484f6901540f08de070", "message": "fix: spotbugs error", "committedDate": "2020-04-17T08:45:27Z", "type": "commit"}, {"oid": "39cc3b00fc14d705168c1c68a93d4f9dcc372f66", "url": "https://github.com/Azure/azure-sdk-for-java/commit/39cc3b00fc14d705168c1c68a93d4f9dcc372f66", "message": "feat: suppress incorrect spotbugs", "committedDate": "2020-04-17T09:55:20Z", "type": "commit"}, {"oid": "5810f30086c93a1431deeae7f0a10f890b0012d6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5810f30086c93a1431deeae7f0a10f890b0012d6", "message": "fix: checkstyle", "committedDate": "2020-04-17T09:55:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE1MTQ3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r410151475", "bodyText": "Any reason we pick this beta version? The latest is 4.0.2.", "author": "xseeseesee", "createdAt": "2020-04-17T11:03:05Z", "path": "sdk/management/pom.xml", "diffHunk": "@@ -91,6 +91,12 @@\n                 <artifactId>azure-storage-blob</artifactId>\n                 <version>12.4.0</version>\n             </dependency>\n+            <dependency>\n+                <groupId>com.github.spotbugs</groupId>\n+                <artifactId>spotbugs-annotations</artifactId>\n+                <version>4.0.0-beta3</version>", "originalCommit": "5810f30086c93a1431deeae7f0a10f890b0012d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA0ODI4OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411048288", "bodyText": "This is aligned with the plugin version. https://github.com/azure/azure-sdk-for-java/blob/5810f30086c93a1431deeae7f0a10f890b0012d6/sdk/management/pom.xml#L221, I'm not sure if these should be aligned or not. Maybe we could discuss about.", "author": "ChenTanyi", "createdAt": "2020-04-20T02:06:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE1MTQ3NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA2MTU1Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411061556", "bodyText": "I've change it to latest version", "author": "ChenTanyi", "createdAt": "2020-04-20T02:58:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE1MTQ3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0NjI3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r410546275", "bodyText": "Maybe we should change the name of clone method. Maybe newBuilder. (Because I didn't really want a Cloneable when adding that method.)", "author": "weidongxu-microsoft", "createdAt": "2020-04-18T01:46:51Z", "path": "sdk/resources/mgmt/src/main/java/com/azure/management/RestClientBuilder.java", "diffHunk": "@@ -29,7 +29,7 @@\n  * A rest client builder.\n  */\n @ServiceClientBuilder(serviceClients = RestClient.class)\n-public final class RestClientBuilder {\n+public final class RestClientBuilder implements Cloneable {", "originalCommit": "5810f30086c93a1431deeae7f0a10f890b0012d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA2MTU5Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411061596", "bodyText": "done", "author": "ChenTanyi", "createdAt": "2020-04-20T02:59:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0NjI3NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0NjU5Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r410546596", "bodyText": "There should be a same class in core. May be we can remove this later.", "author": "weidongxu-microsoft", "createdAt": "2020-04-18T01:47:34Z", "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/fluentcore/arm/ExpandableStringEnum.java", "diffHunk": "@@ -15,36 +16,34 @@\n  * @param <T> a specific expandable enum type\n  */\n public abstract class ExpandableStringEnum<T extends ExpandableStringEnum<T>> {", "originalCommit": "5810f30086c93a1431deeae7f0a10f890b0012d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA2MTYzNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411061635", "bodyText": "removed", "author": "ChenTanyi", "createdAt": "2020-04-20T02:59:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0NjU5Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0NzU4NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r410547585", "bodyText": "Please detail on what happens here. transient should not be used lightly.", "author": "weidongxu-microsoft", "createdAt": "2020-04-18T01:49:46Z", "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/fluentcore/arm/collection/implementation/CreatableResourcesImpl.java", "diffHunk": "@@ -79,12 +79,12 @@ protected CreatableResourcesImpl() {\n      *\n      * @param <ResourceT> the type of the resources in the batch.\n      */\n-    private class CreatedResourcesImpl<ResourceT extends Indexable>\n+    private static class CreatedResourcesImpl<ResourceT extends Indexable>\n             extends HashMap<String, ResourceT>\n             implements CreatedResources<ResourceT> {\n-        private final ClientLogger logger = new ClientLogger(this.getClass());\n+        private final transient ClientLogger logger = new ClientLogger(this.getClass());", "originalCommit": "5810f30086c93a1431deeae7f0a10f890b0012d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA0ODgxMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411048812", "bodyText": "The spotbugs said the CreatableResourcesImpl has two variable that cannot be serialized. After my search, it seems add transient can fix it.", "author": "ChenTanyi", "createdAt": "2020-04-20T02:08:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0NzU4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA1NjQzNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411056435", "bodyText": "Could you see if it is possible to convert the class to composition (use a HashMap var, instead of extends HashMap, then delegate other Map method to that var)? This way we should be able to get rid of Serializable interface.\nCurrently I didn't see the place that need the Serializable. Correct me if I am wrong.", "author": "weidongxu-microsoft", "createdAt": "2020-04-20T02:39:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0NzU4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTExODE1NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411118154", "bodyText": "Changed extends to private var. Done", "author": "ChenTanyi", "createdAt": "2020-04-20T06:13:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0NzU4NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0Nzk1Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r410547952", "bodyText": "why parent()? maybe only delete this line?", "author": "weidongxu-microsoft", "createdAt": "2020-04-18T01:50:42Z", "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/fluentcore/arm/collection/implementation/IndependentChildrenImpl.java", "diffHunk": "@@ -81,7 +79,7 @@ public T getById(String id) {\n     @Override\n     public Mono<T> getByIdAsync(String id) {\n         ResourceId resourceId = ResourceId.fromString(id);\n-        if (resourceId == null) {\n+        if (resourceId.parent() == null) {", "originalCommit": "5810f30086c93a1431deeae7f0a10f890b0012d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA0OTEyMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411049122", "bodyText": "Since the next line has resourceId.parent().name(), so I add parent() in it. Is it better not to check this NPE?", "author": "ChenTanyi", "createdAt": "2020-04-20T02:10:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0Nzk1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0ODU2MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r410548561", "bodyText": "What error message associates with this?", "author": "weidongxu-microsoft", "createdAt": "2020-04-18T01:52:04Z", "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/fluentcore/arm/models/implementation/IndependentChildImpl.java", "diffHunk": "@@ -68,6 +68,10 @@ public String resourceGroupName() {\n         }\n     }\n \n+    protected String parentName() {", "originalCommit": "5810f30086c93a1431deeae7f0a10f890b0012d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA0OTQ4NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411049484", "bodyText": "The error message is we could not expose a protected / public variable that hasn't been used. So I add this function to use the variable.", "author": "ChenTanyi", "createdAt": "2020-04-20T02:11:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDU0ODU2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA0NTAxMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411045010", "bodyText": "Currently the norm in sdk is to add it to suppression\n  <Match>\n    <Class name=\"~com\\.microsoft\\.azure\\.keyvault\\.requests\\.\\w+Request\"/>\n    <Bug pattern=\"BC_UNCONFIRMED_CAST_OF_RETURN_VALUE\"/>\n  </Match>\n\nWe could keep the annotation, and see what to do after more services get checked.", "author": "weidongxu-microsoft", "createdAt": "2020-04-20T01:53:13Z", "path": "sdk/resources/mgmt/src/main/java/com/azure/management/resources/fluentcore/dag/TaskGroup.java", "diffHunk": "@@ -337,6 +339,7 @@ public void addPostRunDependentTaskGroup(TaskGroup dependentTaskGroup) {\n     /**\n      * @return list with current task entries in this task group\n      */\n+    @SuppressFBWarnings(value = \"BC_UNCONFIRMED_CAST_OF_RETURN_VALUE\", justification = \"Incorrect spot bugs\")", "originalCommit": "5810f30086c93a1431deeae7f0a10f890b0012d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA0OTg1Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10324#discussion_r411049857", "bodyText": "Agree, if much more services meet such an error spotbugs, we could add it to suppression.", "author": "ChenTanyi", "createdAt": "2020-04-20T02:12:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA0NTAxMA=="}], "type": "inlineReview"}, {"oid": "7f784f84e8e4fd34da4fade984c48f107d7af85e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7f784f84e8e4fd34da4fade984c48f107d7af85e", "message": "feat: change clone name in rest client builder", "committedDate": "2020-04-20T02:23:56Z", "type": "commit"}, {"oid": "0583a691ac15bc511d930e2c81800f42a804b2a7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0583a691ac15bc511d930e2c81800f42a804b2a7", "message": "feat: remove arm expand enum string", "committedDate": "2020-04-20T02:36:19Z", "type": "commit"}, {"oid": "cb06a5879c4b360d0b0aa062dbc5d9124f6d0545", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cb06a5879c4b360d0b0aa062dbc5d9124f6d0545", "message": "fix: change spotbugs annotation to latest", "committedDate": "2020-04-20T02:36:54Z", "type": "commit"}, {"oid": "7590c80af686e649d17b0e0f4bbe86ec03560e67", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7590c80af686e649d17b0e0f4bbe86ec03560e67", "message": "feat: remove CreatableResourcesImpl extends hashmap", "committedDate": "2020-04-20T06:02:12Z", "type": "commit"}, {"oid": "7ddd1a3c26f3124e0d78a15ab6607b969f81b81e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7ddd1a3c26f3124e0d78a15ab6607b969f81b81e", "message": "fix: revapi error for non public api", "committedDate": "2020-04-20T06:13:01Z", "type": "commit"}]}