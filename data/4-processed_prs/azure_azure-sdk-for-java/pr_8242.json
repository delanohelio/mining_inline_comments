{"pr_number": 8242, "pr_title": "POM Restructuring Phase #1", "pr_createdAt": "2020-02-18T00:54:42Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/8242", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc2Nzg4Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r380767887", "bodyText": "/CC @weshaggard\nThe reason this was changed to pom.client.xml was to ensure that when core built everything else built. Swapping this back to just the list of core libraries is going to revert that and we're probably going to want to have whatever the \"build everything for client\" equivalent is going to be.", "author": "JimSuplizio", "createdAt": "2020-02-18T16:00:40Z", "path": "sdk/core/pom.service.xml", "diffHunk": "@@ -9,6 +9,13 @@\n   <packaging>pom</packaging>\n   <version>1.0.0</version><!-- Need not change for every release-->\n   <modules>\n-    <module>../../pom.client.xml</module>\n+    <module>azure-core</module>", "originalCommit": "45e23b43d36aec6ff39e19d7e0b94768d79f3252", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg3Mzc3NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r380873774", "bodyText": "Correct. We needed a way to have the core pipeline build and test everything that depended on core. If you can come up with another clever way to do that we can switch otherwise I'd keep this the way it is.", "author": "weshaggard", "createdAt": "2020-02-18T19:04:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc2Nzg4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTAyMTQ1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r381021458", "bodyText": "Yeah so I created this PR knowing this problem wasn't solved with the hope that it would spur some conversation about the issues created by the way we have this setup and other approaches that we could possibly take.", "author": "mitchdenny", "createdAt": "2020-02-19T00:54:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc2Nzg4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDY2MjIwNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r390662206", "bodyText": "Coming back to this. The way to make this build process the downstream dependents is to use the -amd switch.", "author": "mitchdenny", "createdAt": "2020-03-10T23:09:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDc2Nzg4Nw=="}], "type": "inlineReview"}, {"oid": "996cd58fef834350ee89f4ad34b26a27811eb243", "url": "https://github.com/Azure/azure-sdk-for-java/commit/996cd58fef834350ee89f4ad34b26a27811eb243", "message": "Removed commented out modules section.", "committedDate": "2020-03-10T23:20:15Z", "type": "forcePushed"}, {"oid": "31fe55b3d9845f4c2fc13016b313b637cb38144e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/31fe55b3d9845f4c2fc13016b313b637cb38144e", "message": "Pulling all track 1 and track 2 modules into the root POM model.", "committedDate": "2020-03-12T01:42:34Z", "type": "forcePushed"}, {"oid": "807c45b666f87954ed57476e8c1b2fe16e9ff674", "url": "https://github.com/Azure/azure-sdk-for-java/commit/807c45b666f87954ed57476e8c1b2fe16e9ff674", "message": "Fix version.", "committedDate": "2020-03-16T01:43:36Z", "type": "forcePushed"}, {"oid": "9e78c24c4f9c7ab75ffcc2226e7bdfc54d65626a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9e78c24c4f9c7ab75ffcc2226e7bdfc54d65626a", "message": "Fix log analytics build.", "committedDate": "2020-03-16T02:28:44Z", "type": "forcePushed"}, {"oid": "5bb79d2c38feeb13d029165cf023661f56e4209f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5bb79d2c38feeb13d029165cf023661f56e4209f", "message": "Fix up app config.", "committedDate": "2020-03-18T00:26:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM1MzY0MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394353640", "bodyText": "Instead of just commenting these out we should probably remove them. The same would apply to the module list commented out in pom.management.xml below.", "author": "JimSuplizio", "createdAt": "2020-03-18T13:41:33Z", "path": "pom.data.xml", "diffHunk": "@@ -602,6 +602,7 @@\n     </profile>\n   </profiles>\n \n+  <!--", "originalCommit": "5bb79d2c38feeb13d029165cf023661f56e4209f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5NDE5NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394694195", "bodyText": "There's an open question about the need for the additional test module entries but that only really a concern, for me, until it's understood why they're necessary. If the situation arises where someone is adding a new library and/or area and a similar issue pops up, needing a dependency where seemingly we shouldn't, I'd like to be able to explain why it's necessary.\n\nThis is a side effect of the -amd approach I was trying to use. I'll go through the PR and remove the ones that are unnecessary now that I don't need to force the dependency graph into a particular shape.\nI'll also remove the commented out secitons.", "author": "mitchdenny", "createdAt": "2020-03-18T23:22:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM1MzY0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5NDY3NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394694674", "bodyText": "Wait ... I need to live those modules in there for some tooling that still depends on them being there. I'll do that instead. Glad you mentioned it.", "author": "mitchdenny", "createdAt": "2020-03-18T23:23:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM1MzY0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTAzNzQ3OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r395037478", "bodyText": "This is a side effect of the -amd approach\nI recognize that but is this something we can predict? What's the pattern that causes us to need the extra entry and is it something we can effectively document/communicate with the Java team so everyone knows the deal and is on the same page?", "author": "JimSuplizio", "createdAt": "2020-03-19T13:48:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM1MzY0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTMxMjg2MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r395312860", "bodyText": "The most likely culprits are going to be things like identity, storage, perf-test-core. Hard to predict where it'll crop up because its a function of the dependencies that individual libraries take. I think it might happen more as we introduce new services that take dependencies on fundamental libraries like identity and storage.", "author": "mitchdenny", "createdAt": "2020-03-19T20:52:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM1MzY0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM2MTY2NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394361664", "bodyText": "This should just be azure-search-service and not azure-search-service-parent. None of the other service artifacts have -parent in their names.", "author": "JimSuplizio", "createdAt": "2020-03-18T13:52:58Z", "path": "sdk/search/pom.xml", "diffHunk": "@@ -5,10 +5,10 @@\n          xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n   <modelVersion>4.0.0</modelVersion>\n   <groupId>com.azure</groupId>\n-  <artifactId>azure-core-service</artifactId>\n+  <artifactId>azure-search-service-parent</artifactId>", "originalCommit": "5bb79d2c38feeb13d029165cf023661f56e4209f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5NTk1NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394695954", "bodyText": "Fixed.", "author": "mitchdenny", "createdAt": "2020-03-18T23:26:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM2MTY2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM3MDU4Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394370586", "bodyText": "In regards to azure-sdk-all being renamed to azure-root-aggregate, there are things that need to get updated here. You removed a version tag which means this particular artifact is one being tracked in version_client.txt and this needs to get changed to azure-root-aggregate and the tag should be\n<!-- {x-version-update;com.azure:azure-root-aggregate;current} -->\nAlso, azure-sdk-all is being referenced in the set_versions.py script, specifically in the items_we_should_not_update array. This will need to be changed to azure-root-aggregate.", "author": "JimSuplizio", "createdAt": "2020-03-18T14:05:29Z", "path": "pom.xml", "diffHunk": "@@ -4,281 +4,25 @@\n          xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n   <modelVersion>4.0.0</modelVersion>\n   <groupId>com.azure</groupId>\n-  <artifactId>azure-sdk-all</artifactId>\n+  <artifactId>azure-root-aggregate</artifactId>\n   <packaging>pom</packaging>\n-  <version>1.0.0</version> <!-- {x-version-update;com.azure:azure-sdk-all;current} -->\n-\n-  <name>Microsoft Azure SDK for Java - All Modules</name>\n-  <description>Aggregated POM for Microsoft Azure SDK for Java</description>\n-  <url>https://github.com/Azure/azure-sdk-for-java</url>\n-  <organization>\n-    <name>Microsoft Corporation</name>\n-    <url>http://microsoft.com</url>\n-  </organization>\n-\n-  <parent>\n-    <groupId>com.azure</groupId>\n-    <artifactId>azure-sdk-parent</artifactId>\n-    <version>1.6.0</version> <!-- {x-version-update;com.azure:azure-sdk-parent;current} -->\n-    <relativePath>./parent/pom.xml</relativePath>\n-  </parent>\n-\n-  <licenses>\n-    <license>\n-      <name>The MIT License (MIT)</name>\n-      <url>http://opensource.org/licenses/MIT</url>\n-      <distribution>repo</distribution>\n-    </license>\n-  </licenses>\n-\n-  <developers>\n-    <developer>\n-      <id>microsoft</id>\n-      <name>Microsoft Corporation</name>\n-    </developer>\n-  </developers>\n-\n-  <issueManagement>\n-    <system>GitHub</system>\n-    <url>${issues.url}</url>\n-  </issueManagement>\n-\n-  <scm>\n-    <url>https://github.com/Azure/azure-sdk-for-java</url>\n-    <connection>scm:git:https://github.com/Azure/azure-sdk-for-java.git</connection>\n-    <developerConnection></developerConnection>\n-    <tag>HEAD</tag>\n-  </scm>\n-\n-  <properties>\n-    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n-    <packageOutputDirectory>${project.build.directory}</packageOutputDirectory>\n-    <legal>\n-      <![CDATA[[INFO] Any downloads listed may be third party software.  Microsoft grants you no rights for third party software.]]></legal>\n-    <testMode>playback</testMode>\n-    <playbackServerPort>11080</playbackServerPort>\n-    <alternativePlaybackServerPort>11081</alternativePlaybackServerPort>\n-\n-    <site.url>https://azuresdkartifacts.blob.core.windows.net/azure-sdk-for-java</site.url>\n-    <issues.url>https://github.com/Azure/azure-sdk-for-java/issues</issues.url>\n-  </properties>\n-\n-  <build>\n-    <plugins>\n-      <!-- This plugin scans checkstyle issues in the code -->\n-      <plugin>\n-        <groupId>org.apache.maven.plugins</groupId>\n-        <artifactId>maven-checkstyle-plugin</artifactId>\n-        <version>3.1.0</version> <!-- {x-version-update;org.apache.maven.plugins:maven-checkstyle-plugin;external_dependency} -->\n-        <dependencies>\n-          <dependency>\n-            <groupId>com.azure</groupId>\n-            <artifactId>sdk-build-tools</artifactId>\n-            <version>1.0.0</version> <!-- {x-version-update;com.azure:sdk-build-tools;external_dependency} -->\n-          </dependency>\n-          <dependency>\n-            <groupId>com.puppycrawl.tools</groupId>\n-            <artifactId>checkstyle</artifactId>\n-            <version>8.29</version> <!-- {x-version-update;com.puppycrawl.tools:checkstyle;external_dependency} -->\n-          </dependency>\n-        </dependencies>\n-        <configuration>\n-          <configLocation>checkstyle/checkstyle.xml</configLocation>\n-          <suppressionsLocation>checkstyle/checkstyle-suppressions.xml</suppressionsLocation>\n-          <headerLocation>checkstyle/java.header</headerLocation>\n-          <propertyExpansion>samedir=</propertyExpansion>\n-          <encoding>UTF-8</encoding>\n-          <consoleOutput>true</consoleOutput>\n-          <includeTestSourceDirectory>true</includeTestSourceDirectory>\n-          <linkXRef>true</linkXRef>\n-\n-          <!-- TODO soon - enable these failure modes -->\n-          <failsOnError>false</failsOnError>\n-          <failOnViolation>false</failOnViolation>\n-        </configuration>\n-        <executions>\n-          <execution>\n-            <phase>verify</phase>\n-            <goals>\n-              <goal>check</goal>\n-            </goals>\n-          </execution>\n-        </executions>\n-      </plugin>\n-      \n-      <!-- Configure the jar plugin -->\n-      <plugin>\n-        <groupId>org.apache.maven.plugins</groupId>\n-        <artifactId>maven-jar-plugin</artifactId>\n-        <version>3.1.2</version> <!-- {x-version-update;org.apache.maven.plugins:maven-jar-plugin;external_dependency} -->\n-        <configuration>\n-          <outputDirectory>${packageOutputDirectory}</outputDirectory>\n-        </configuration>\n-      </plugin>\n-\n-      <!-- Configure the javadoc plugin -->\n-      <plugin>\n-        <groupId>org.apache.maven.plugins</groupId>\n-        <artifactId>maven-javadoc-plugin</artifactId>\n-        <version>3.1.1</version> <!-- {x-version-update;org.apache.maven.plugins:maven-javadoc-plugin;external_dependency} -->\n-        <executions>\n-          <execution>\n-            <id>attach-javadocs</id>\n-            <goals>\n-              <goal>jar</goal>\n-            </goals>\n-            <configuration>\n-              <jarOutputDirectory>${packageOutputDirectory}</jarOutputDirectory>\n-            </configuration>\n-          </execution>\n-        </executions>\n-      </plugin>\n-\n-      <!-- Configure the source plugin -->\n-      <plugin>\n-        <groupId>org.apache.maven.plugins</groupId>\n-        <artifactId>maven-source-plugin</artifactId>\n-        <version>3.0.1</version> <!-- {x-version-update;org.apache.maven.plugins:maven-source-plugin;external_dependency} -->\n-        <executions>\n-          <execution>\n-            <id>attach-sources</id>\n-            <goals>\n-              <goal>jar</goal>\n-            </goals>\n-            <configuration>\n-              <outputDirectory>${packageOutputDirectory}</outputDirectory>\n-            </configuration>\n-          </execution>\n-        </executions>\n-      </plugin>\n-\n-      <!-- Copy the pom file to output -->\n-      <plugin>\n-        <groupId>org.apache.maven.plugins</groupId>\n-        <artifactId>maven-antrun-plugin</artifactId>\n-        <version>1.8</version> <!-- {x-version-update;org.apache.maven.plugins:maven-antrun-plugin;external_dependency} -->\n-        <executions>\n-          <execution>\n-            <id>copy</id>\n-            <phase>package</phase>\n-            <configuration>\n-              <target>\n-                <copy file=\"${project.pomFile}\" tofile=\"${packageOutputDirectory}/${project.build.finalName}.pom\"/>\n-              </target>\n-            </configuration>\n-            <goals>\n-              <goal>run</goal>\n-            </goals>\n-          </execution>\n-        </executions>\n-      </plugin>\n-\n-      <!-- Allows the sample sources to be built during test-compile phase. -->\n-      <plugin>\n-        <groupId>org.codehaus.mojo</groupId>\n-        <artifactId>build-helper-maven-plugin</artifactId>\n-        <version>3.0.0</version> <!-- {x-version-update;org.codehaus.mojo:build-helper-maven-plugin;external_dependency} -->\n-      </plugin>\n-    </plugins>\n-  </build>\n-\n-  <profiles>\n-    <!--\n-     By default we build against our baseline, Java 8, but we also want to ensure compatibility\n-     against the latest Java LTS release, currently Java 11. We therefore have two profiles:\n-       * The default 'java8', which will perform a build using Java 8 as its target.\n-       * The non-default 'java-lts' profile, which will build against the current LTS release.\n-   -->\n-    <profile>\n-      <id>java8</id>\n-      <activation>\n-        <activeByDefault>true</activeByDefault>\n-        <property>\n-          <name>!java-lts</name>\n-        </property>\n-      </activation>\n-      <build>\n-        <plugins>\n-          <plugin>\n-            <groupId>org.apache.maven.plugins</groupId>\n-            <artifactId>maven-compiler-plugin</artifactId>\n-            <version>3.8.1</version> <!-- {x-version-update;org.apache.maven.plugins:maven-compiler-plugin;external_dependency} -->\n-            <configuration>\n-              <source>1.8</source>\n-              <target>1.8</target>\n-              <showWarnings>true</showWarnings>\n-              <showDeprecation>true</showDeprecation>\n-              <compilerArgument>-Xlint:all</compilerArgument>\n-            </configuration>\n-          </plugin>\n-        </plugins>\n-      </build>\n-    </profile>\n-\n-    <profile>\n-      <id>java-lts</id>\n-      <activation>\n-        <property>\n-          <name>java-lts</name>\n-        </property>\n-      </activation>\n-      <build>\n-        <plugins>\n-          <plugin>\n-            <groupId>org.apache.maven.plugins</groupId>\n-            <artifactId>maven-compiler-plugin</artifactId>\n-            <version>3.8.1</version> <!-- {x-version-update;org.apache.maven.plugins:maven-compiler-plugin;external_dependency} -->\n-            <configuration>\n-              <source>11</source>\n-              <target>11</target>\n-              <showWarnings>true</showWarnings>\n-              <showDeprecation>true</showDeprecation>\n-              <compilerArgument>-Xlint:all</compilerArgument>\n-            </configuration>\n-          </plugin>\n-        </plugins>\n-      </build>\n-    </profile>\n-\n-    <!-- Customise the javadoc plugin to not include module directories in links. We don't\n-         currently use modules, so search results were being directed to an 'undefined'\n-         directory (for an 'undefined' module). This no-module-directories flag fixes\n-         this, but it is only required for JDK 9+ -->\n-    <profile>\n-      <id>javadoc-no-modules-fix</id>\n-      <activation>\n-        <jdk>[9,)</jdk>\n-      </activation>\n-      <build>\n-        <plugins>\n-          <plugin>\n-            <groupId>org.apache.maven.plugins</groupId>\n-            <artifactId>maven-javadoc-plugin</artifactId>\n-            <version>3.1.1</version> <!-- {x-version-update;org.apache.maven.plugins:maven-javadoc-plugin;external_dependency} -->\n-            <configuration>\n-              <additionalJOption>--no-module-directories</additionalJOption>\n-            </configuration>\n-          </plugin>\n-        </plugins>\n-      </build>\n-    </profile>\n-\n-    <profile>\n-      <id>template-module</id>\n-      <activation>\n-        <property>\n-          <name>include-template</name>\n-        </property>\n-      </activation>\n-      <modules>\n-        <module>./sdk/template/azure-sdk-template</module>\n-      </modules>\n-    </profile>\n-  </profiles>\n-\n+  <version>1.0.0</version><!-- Need not change for every release-->", "originalCommit": "5bb79d2c38feeb13d029165cf023661f56e4209f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5NjM4MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394696380", "bodyText": "I changed it back to what it was, the name wasn't important to me when I started doing this I basically did a CTRL-A, DEL on the file and started again and that is just the name I came back with.", "author": "mitchdenny", "createdAt": "2020-03-18T23:27:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM3MDU4Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM3NzIyMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394377221", "bodyText": "I'm curious as to why this particular dependency was necessary. What was the scenario you were running into when this wasn't there. I know that azure-storage-blob was a direct dependency of azure-messaging-eventhubs-checkpointstore-blob and I'm curious how this was getting pulled in here? Was it something that previously should have been a dependency that somehow wasn't?", "author": "JimSuplizio", "createdAt": "2020-03-18T14:14:23Z", "path": "sdk/eventhubs/azure-messaging-eventhubs/pom.xml", "diffHunk": "@@ -58,6 +58,12 @@\n       <version>1.1.0</version> <!-- {x-version-update;com.azure:azure-core-test;dependency} -->\n       <scope>test</scope>\n     </dependency>\n+    <dependency> <!-- HACK: Adding this here to work around a limitation with the -amd switch in Maven. -->", "originalCommit": "5bb79d2c38feeb13d029165cf023661f56e4209f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcyNjMzOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394726338", "bodyText": "It was to work around a problem with the way that the -amd switch works on Maven. Given a project (e.g. com.azure:azure-storage-blob) it resolves that it needs to build its dependants (e.g. com.azure:azure-messaging-eventhubs) but doesn't then resolve their dependencies. So you end up with projects in the graph not being added to the build list.\nGraphically:\nhttps://miro.com/app/board/o9J_kulp0yo=/", "author": "mitchdenny", "createdAt": "2020-03-19T00:48:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM3NzIyMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM5OTUzMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394399533", "bodyText": "Similar to the question above, why was this necessary here? This is already direct dependency of azure-storage-perf declared storage\\perf-test\\pom.xml", "author": "JimSuplizio", "createdAt": "2020-03-18T14:43:18Z", "path": "sdk/storage/azure-storage-common/pom.xml", "diffHunk": "@@ -70,6 +70,12 @@\n       <version>1.1.0</version> <!-- {x-version-update;com.azure:azure-core-test;dependency} -->\n       <scope>test</scope>\n     </dependency>\n+    <dependency>\n+      <groupId>com.azure</groupId>\n+      <artifactId>perf-test-core</artifactId>\n+      <version>1.0.0-beta.1</version> <!-- {x-version-update;com.azure:perf-test-core;dependency} -->", "originalCommit": "5bb79d2c38feeb13d029165cf023661f56e4209f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY5NjkxMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394696911", "bodyText": "This was to work around the -amd switch issue. Will remove in an update to the PR.", "author": "mitchdenny", "createdAt": "2020-03-18T23:29:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDM5OTUzMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDU3NzMzMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394577333", "bodyText": "nit: add new empty line", "author": "conniey", "createdAt": "2020-03-18T19:06:05Z", "path": "eng/pipelines/templates/steps/generate-project-list.yml", "diffHunk": "@@ -0,0 +1,18 @@\n+# This job template uses the artifact list in the ci.yml file\n+# to generate a variable at build time that can be passed into\n+# the Maven -pl command-line switch to constrain what subset of\n+# projects are targetted based on the artifacts this pipeline\n+# produces. The -am and -amd switches are then applied as\n+# appropriate to constrain the full graph that is built depending\n+# on whether we are doing a recorded test play back or a full live\n+# test.\n+\n+steps:\n+- pwsh: |\n+    Write-Host \"##vso[task.setvariable variable=ProjectList;]\"\n+  displayName: Initialize project list variable\n+\n+- ${{each artifact in parameters.Artifacts }}:\n+  - pwsh: |\n+      Write-Host \"##vso[task.setvariable variable=ProjectList;]$(ProjectList),${{artifact.groupId}}:${{artifact.name}}\"\n+    displayName: Append ${{artifact.groupId}}:${{artifact.name}} to project list", "originalCommit": "5bb79d2c38feeb13d029165cf023661f56e4209f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcyMzAwMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394723003", "bodyText": "nit: I don't think the comment at the end of the line is needed any longer.", "author": "weshaggard", "createdAt": "2020-03-19T00:35:38Z", "path": "eng/pipelines/templates/jobs/archetype-sdk-client.yml", "diffHunk": "@@ -102,12 +102,16 @@ jobs:\n           BuildSHA: $(Build.SourceVersion)\n           RepoId: 'Azure/azure-sdk-for-java'\n \n+      - template: ../steps/generate-project-list.yml\n+        parameters:\n+          Artifacts: ${{parameters.Artifacts}}\n+\n       - task: Maven@3\n         displayName: 'Build and Package'\n         inputs:\n-          mavenPomFile: sdk/${{parameters.ServiceDirectory}}/pom.service.xml\n+          mavenPomFile: pom.xml\n           goals: 'package'\n-          options: '$(DefaultOptions) \"-DpackageOutputDirectory=$(Build.ArtifactStagingDirectory)\" -DskipTests -Dgenerate-overview' # We include template-module so we ensure it always builds in CI", "originalCommit": "5bb79d2c38feeb13d029165cf023661f56e4209f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcyMzkxMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394723913", "bodyText": "nit: end of line comment can be deleted.", "author": "weshaggard", "createdAt": "2020-03-19T00:38:49Z", "path": "eng/pipelines/templates/jobs/archetype-sdk-data.yml", "diffHunk": "@@ -90,12 +90,16 @@ jobs:\n           BuildSHA: $(Build.SourceVersion)\n           RepoId: 'Azure/azure-sdk-for-java'\n \n+      - template: ../steps/generate-project-list.yml\n+        parameters:\n+          Artifacts: ${{parameters.Artifacts}}\n+  \n       - task: Maven@3\n         displayName: 'Build and Package'\n         inputs:\n-          mavenPomFile: sdk/${{parameters.ServiceDirectory}}/pom.service.xml\n+          mavenPomFile: pom.xml\n           goals: 'package'\n-          options: '$(DefaultOptions) \"-DpackageOutputDirectory=$(Build.ArtifactStagingDirectory)\" -DskipTests -Dgenerate-overview' # We include template-module so we ensure it always builds in CI", "originalCommit": "5bb79d2c38feeb13d029165cf023661f56e4209f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d037752f3627bcc7f881b951fe75da76cff79a4e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d037752f3627bcc7f881b951fe75da76cff79a4e", "message": "Remove modules from parent.", "committedDate": "2020-03-19T00:52:18Z", "type": "commit"}, {"oid": "315ab6116deff3a910fa8e5f8a86dc6a1f5c0923", "url": "https://github.com/Azure/azure-sdk-for-java/commit/315ab6116deff3a910fa8e5f8a86dc6a1f5c0923", "message": "Add specific core modules.", "committedDate": "2020-03-19T00:52:19Z", "type": "commit"}, {"oid": "84ae1c306e35cad6e8de6310a5dd933b9b28e273", "url": "https://github.com/Azure/azure-sdk-for-java/commit/84ae1c306e35cad6e8de6310a5dd933b9b28e273", "message": "Remove management package from list of packages to build.", "committedDate": "2020-03-19T00:52:19Z", "type": "commit"}, {"oid": "e09a991effd3af88934b5d78a8e9b60511276e21", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e09a991effd3af88934b5d78a8e9b60511276e21", "message": "Swap to building against root pom.xml.", "committedDate": "2020-03-19T00:52:19Z", "type": "commit"}, {"oid": "6806b54393f3cf851eed52e0e2b42d950cdc71b4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6806b54393f3cf851eed52e0e2b42d950cdc71b4", "message": "Removed commented out modules section.", "committedDate": "2020-03-19T00:52:19Z", "type": "commit"}, {"oid": "7d9a579daf29fcc7814635f1e523f37a50dbc4b6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7d9a579daf29fcc7814635f1e523f37a50dbc4b6", "message": "Remove perf stress module from module list.", "committedDate": "2020-03-19T00:52:19Z", "type": "commit"}, {"oid": "422b853d1900013e4ffe48c9ede86c7c9f8b7a87", "url": "https://github.com/Azure/azure-sdk-for-java/commit/422b853d1900013e4ffe48c9ede86c7c9f8b7a87", "message": "First attempt at a project list hack.", "committedDate": "2020-03-19T00:52:19Z", "type": "commit"}, {"oid": "47a06c2ff6deece953fe605ef1d474bb64c0641d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/47a06c2ff6deece953fe605ef1d474bb64c0641d", "message": "COntinue project list hack.", "committedDate": "2020-03-19T00:52:20Z", "type": "commit"}, {"oid": "eb1a81d0bd1c5d9efd1d16728433140db204efa4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/eb1a81d0bd1c5d9efd1d16728433140db204efa4", "message": "Extract steps into a template.", "committedDate": "2020-03-19T00:52:20Z", "type": "commit"}, {"oid": "2b8061fad4d65d95c23ec4cd33e743ac4775444f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2b8061fad4d65d95c23ec4cd33e743ac4775444f", "message": "Tweak quotes.", "committedDate": "2020-03-19T00:52:20Z", "type": "commit"}, {"oid": "06f4d870501121a263e95cba93ffa942dd20d9f2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/06f4d870501121a263e95cba93ffa942dd20d9f2", "message": "Changes to make analyze use project list.", "committedDate": "2020-03-19T00:52:20Z", "type": "commit"}, {"oid": "de8a204d741003ee987bc6622359d7016b8a3129", "url": "https://github.com/Azure/azure-sdk-for-java/commit/de8a204d741003ee987bc6622359d7016b8a3129", "message": "Add project list to test jobs.", "committedDate": "2020-03-19T00:52:21Z", "type": "commit"}, {"oid": "5e2245bb2dc4c0243f32280593b5f9596c93b671", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5e2245bb2dc4c0243f32280593b5f9596c93b671", "message": "Add install step which builds dependencies ahead of running tests.", "committedDate": "2020-03-19T00:52:21Z", "type": "commit"}, {"oid": "cc255ef8ad18030773803f18f1f496160c1db39f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cc255ef8ad18030773803f18f1f496160c1db39f", "message": "Fix indentation.", "committedDate": "2020-03-19T00:52:21Z", "type": "commit"}, {"oid": "034491e9fbc7139e0880b7af2f0b0f2eed8aa4ad", "url": "https://github.com/Azure/azure-sdk-for-java/commit/034491e9fbc7139e0880b7af2f0b0f2eed8aa4ad", "message": "Bringing identity and appconfiguration into scope.", "committedDate": "2020-03-19T00:52:21Z", "type": "commit"}, {"oid": "cec7573da19a4b06abae83f03063b10c6517918c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cec7573da19a4b06abae83f03063b10c6517918c", "message": "Pulling all track 1 and track 2 modules into the root POM model.", "committedDate": "2020-03-19T00:52:22Z", "type": "commit"}, {"oid": "7bb0d389311076bf85db9a4c79bc8122e0795466", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7bb0d389311076bf85db9a4c79bc8122e0795466", "message": "Removed appinsights dir from root POM.", "committedDate": "2020-03-19T00:52:22Z", "type": "commit"}, {"oid": "47629980635d757087b6c332940844eeefdd30e2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/47629980635d757087b6c332940844eeefdd30e2", "message": "Tweaks to data plane template.", "committedDate": "2020-03-19T00:52:22Z", "type": "commit"}, {"oid": "eff4e5a9f1dec13b6bec613d3cb6a16070db6a33", "url": "https://github.com/Azure/azure-sdk-for-java/commit/eff4e5a9f1dec13b6bec613d3cb6a16070db6a33", "message": "Try adding azure-storage-perf to artifact list.", "committedDate": "2020-03-19T00:52:22Z", "type": "commit"}, {"oid": "2f3747add318ad036ae785ee7c930e849e220b8b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2f3747add318ad036ae785ee7c930e849e220b8b", "message": "Make perf core a dependency of blob (HACK!).", "committedDate": "2020-03-19T00:52:23Z", "type": "commit"}, {"oid": "d103219d55997da1edd74f9a1c3e2bcb118fb8cf", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d103219d55997da1edd74f9a1c3e2bcb118fb8cf", "message": "Added dependency tags to perf-test-core and moved to storage common.", "committedDate": "2020-03-19T00:52:23Z", "type": "commit"}, {"oid": "2670b8b50664aac4c2835942d74475b7ae6bd4c5", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2670b8b50664aac4c2835942d74475b7ae6bd4c5", "message": "HACK: Adding storage blob as a test dependency of azure-messaging-eventhubs.", "committedDate": "2020-03-19T00:52:23Z", "type": "commit"}, {"oid": "3599c95a6464689f4451790f2e85fa7e371ca213", "url": "https://github.com/Azure/azure-sdk-for-java/commit/3599c95a6464689f4451790f2e85fa7e371ca213", "message": "Fix version.", "committedDate": "2020-03-19T00:52:23Z", "type": "commit"}, {"oid": "91195a16e2b3296a81469b9df317bd8a706739ef", "url": "https://github.com/Azure/azure-sdk-for-java/commit/91195a16e2b3296a81469b9df317bd8a706739ef", "message": "Fix log analytics build.", "committedDate": "2020-03-19T00:52:23Z", "type": "commit"}, {"oid": "a2c0aea014cbad1dc993be3c9be9a7cb55b8d7ed", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a2c0aea014cbad1dc993be3c9be9a7cb55b8d7ed", "message": "Remove -amd switch.", "committedDate": "2020-03-19T00:52:24Z", "type": "commit"}, {"oid": "6705c09e5698da64516804e66afa1a569894fb9e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6705c09e5698da64516804e66afa1a569894fb9e", "message": "Extra -amd switch removal.", "committedDate": "2020-03-19T00:52:24Z", "type": "commit"}, {"oid": "5a1c586cd6453e3c523443f61d2a0c31b24dea20", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5a1c586cd6453e3c523443f61d2a0c31b24dea20", "message": "Removed CG manifest creation. Default behavior should work.", "committedDate": "2020-03-19T00:52:24Z", "type": "commit"}, {"oid": "66b1d52fbf61e33ecb42ed8b5d483a28d9b58cf7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/66b1d52fbf61e33ecb42ed8b5d483a28d9b58cf7", "message": "Tweak test template for Cosmos.", "committedDate": "2020-03-19T00:52:25Z", "type": "commit"}, {"oid": "686baeeb46de1883c9869b3b773cd379a5ff1de7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/686baeeb46de1883c9869b3b773cd379a5ff1de7", "message": "Fix up app config.", "committedDate": "2020-03-19T00:52:25Z", "type": "commit"}, {"oid": "42aeeb349d0a62f5db36ddb3ba4cdb86a5351657", "url": "https://github.com/Azure/azure-sdk-for-java/commit/42aeeb349d0a62f5db36ddb3ba4cdb86a5351657", "message": "Respond to PR feedback.", "committedDate": "2020-03-19T00:52:25Z", "type": "commit"}, {"oid": "42aeeb349d0a62f5db36ddb3ba4cdb86a5351657", "url": "https://github.com/Azure/azure-sdk-for-java/commit/42aeeb349d0a62f5db36ddb3ba4cdb86a5351657", "message": "Respond to PR feedback.", "committedDate": "2020-03-19T00:52:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDczMjU3Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394732577", "bodyText": "British spelling of targeted? :)", "author": "joshfree", "createdAt": "2020-03-19T01:07:39Z", "path": "eng/pipelines/templates/steps/generate-project-list.yml", "diffHunk": "@@ -0,0 +1,18 @@\n+# This job template uses the artifact list in the ci.yml file\n+# to generate a variable at build time that can be passed into\n+# the Maven -pl command-line switch to constrain what subset of\n+# projects are targetted based on the artifacts this pipeline", "originalCommit": "42aeeb349d0a62f5db36ddb3ba4cdb86a5351657", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDczMzY4Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8242#discussion_r394733687", "bodyText": "I am a subject of the crown guvna", "author": "mitchdenny", "createdAt": "2020-03-19T01:09:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDczMjU3Nw=="}], "type": "inlineReview"}]}