{"pr_number": 13808, "pr_title": "add eventhub integration test", "pr_createdAt": "2020-08-05T08:09:06Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/13808", "timeline": [{"oid": "f2f61ccec36e3477b57d5abf914bc306108229f0", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f2f61ccec36e3477b57d5abf914bc306108229f0", "message": "add eventhub integration test", "committedDate": "2020-08-05T08:05:41Z", "type": "commit"}, {"oid": "784a9974be9b3fc5ae078d853b77e3dbd2bcc4ff", "url": "https://github.com/Azure/azure-sdk-for-java/commit/784a9974be9b3fc5ae078d853b77e3dbd2bcc4ff", "message": "modify pom verify versions", "committedDate": "2020-08-05T08:54:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjEwNzIxMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13808#discussion_r466107212", "bodyText": "We don't need this gitignore file since there's already one in the project.", "author": "saragluna", "createdAt": "2020-08-06T02:23:25Z", "path": "sdk/spring/azure-spring-cloud-test-eventhubs/.gitignore", "diffHunk": "@@ -0,0 +1,33 @@\n+HELP.md", "originalCommit": "784a9974be9b3fc5ae078d853b77e3dbd2bcc4ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE0OTU1Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13808#discussion_r466149553", "bodyText": "We can't do integration this way, this is the integration test for EventHub client, not for Spring Cloud Stream Binder.", "author": "saragluna", "createdAt": "2020-08-06T05:10:08Z", "path": "sdk/spring/azure-spring-cloud-test-eventhubs/src/test/java/com/microsoft/azure/eventhubs/EventhubIntegrationTests.java", "diffHunk": "@@ -0,0 +1,45 @@\n+package com.microsoft.azure.eventhubs;\n+\n+import com.azure.core.util.IterableStream;\n+import com.azure.messaging.eventhubs.EventHubClientBuilder;\n+import com.azure.messaging.eventhubs.EventHubConsumerClient;\n+import com.azure.messaging.eventhubs.models.EventPosition;\n+import com.azure.messaging.eventhubs.models.PartitionEvent;\n+import org.junit.jupiter.api.Test;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.boot.test.context.SpringBootTest;\n+import org.springframework.cloud.stream.annotation.EnableBinding;\n+import org.springframework.cloud.stream.messaging.Source;\n+import org.springframework.messaging.support.GenericMessage;\n+\n+import static com.azure.messaging.eventhubs.EventHubClientBuilder.DEFAULT_CONSUMER_GROUP_NAME;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+@EnableBinding(Source.class)\n+@SpringBootTest\n+class EventhubIntegrationTests {\n+\n+    private static final String MESSAGE = \"Azure Spring Cloud EventHub Test\";\n+\n+    @Value(\"${spring.cloud.azure.eventhub.connection-string}\")\n+    private String connectionString;\n+\n+    @Value(\"${spring.cloud.stream.bindings.input.destination}\")\n+    private String eventHubName;\n+\n+    @Test\n+    void integrationTest(@Autowired Source source) {\n+        source.output().send(new GenericMessage<>(MESSAGE));\n+\n+        EventHubConsumerClient consumerClient = new EventHubClientBuilder()", "originalCommit": "784a9974be9b3fc5ae078d853b77e3dbd2bcc4ff", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f572c0ca1ca8b10ee93b4d9e42c9f0c1f9dd3259", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f572c0ca1ca8b10ee93b4d9e42c9f0c1f9dd3259", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-06T05:15:56Z", "type": "commit"}, {"oid": "ce2aa9532e571b7f00f8eedb1f39f871b0dc60b4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ce2aa9532e571b7f00f8eedb1f39f871b0dc60b4", "message": "modify integration test", "committedDate": "2020-08-10T06:01:33Z", "type": "commit"}, {"oid": "47a75c553c4a7f14f009e906156fe29c71ea055d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/47a75c553c4a7f14f009e906156fe29c71ea055d", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-10T06:02:16Z", "type": "commit"}, {"oid": "e586a00e8155c083b326162487a9469887ba8d6c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e586a00e8155c083b326162487a9469887ba8d6c", "message": "modify pom version", "committedDate": "2020-08-10T06:33:49Z", "type": "commit"}, {"oid": "172651932a0484f23e4b5a63dac26d0947625b1e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/172651932a0484f23e4b5a63dac26d0947625b1e", "message": "Modified according to Checkstyle", "committedDate": "2020-08-10T07:28:54Z", "type": "commit"}, {"oid": "e7676247c5776d4b48664de12acb665f60b5353a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e7676247c5776d4b48664de12acb665f60b5353a", "message": "Modified according to Checkstyle", "committedDate": "2020-08-10T08:21:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzc1NTEzMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13808#discussion_r467755131", "bodyText": "This gitignore is not necessary.", "author": "chenrujun", "createdAt": "2020-08-10T08:26:35Z", "path": "sdk/spring/azure-spring-cloud-test-eventhubs/.gitignore", "diffHunk": "@@ -0,0 +1,32 @@\n+target/", "originalCommit": "e7676247c5776d4b48664de12acb665f60b5353a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzc1NTQ0NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13808#discussion_r467755445", "bodyText": "Integration test should ends with IT?", "author": "chenrujun", "createdAt": "2020-08-10T08:27:16Z", "path": "sdk/spring/azure-spring-cloud-test-eventhubs/src/test/java/com/microsoft/azure/eventhubs/EventHubIntegrationTests.java", "diffHunk": "@@ -0,0 +1,31 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.microsoft.azure.eventhubs;\n+\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.Test;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.boot.test.context.SpringBootTest;\n+import org.springframework.cloud.stream.annotation.EnableBinding;\n+import org.springframework.cloud.stream.messaging.Source;\n+import org.springframework.messaging.support.GenericMessage;\n+\n+@EnableBinding(Source.class)\n+@SpringBootTest\n+class EventHubIntegrationTests {", "originalCommit": "e7676247c5776d4b48664de12acb665f60b5353a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e6d5ae3be63c13086bd86b4404d5083ce44bf937", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e6d5ae3be63c13086bd86b4404d5083ce44bf937", "message": "Delete .gitgnore file", "committedDate": "2020-08-10T08:34:46Z", "type": "commit"}, {"oid": "e4a0a41722475ff55dbbcb13944ee9d7f769ab19", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e4a0a41722475ff55dbbcb13944ee9d7f769ab19", "message": "Rename EventHubIntegrationTests.java to EventHubIT.java", "committedDate": "2020-08-10T08:36:09Z", "type": "commit"}, {"oid": "9fb5200a357f5eb54fc01b0de6069a86d07fb970", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9fb5200a357f5eb54fc01b0de6069a86d07fb970", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-10T08:36:42Z", "type": "commit"}, {"oid": "53d7f2f3cc44cbf116f9d1d6ad8c194b59fcffc4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/53d7f2f3cc44cbf116f9d1d6ad8c194b59fcffc4", "message": "update", "committedDate": "2020-08-11T02:27:07Z", "type": "commit"}, {"oid": "2ac2b2b8947ffc27c3a9fd55ab751278c164e737", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2ac2b2b8947ffc27c3a9fd55ab751278c164e737", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-11T03:29:42Z", "type": "commit"}, {"oid": "04f0490a27f9e7b45740f0cbae9a2e188af094d1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/04f0490a27f9e7b45740f0cbae9a2e188af094d1", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-11T08:50:08Z", "type": "commit"}, {"oid": "aa9d0d7d1d56ed209ea5ef04f09432744e8a4d78", "url": "https://github.com/Azure/azure-sdk-for-java/commit/aa9d0d7d1d56ed209ea5ef04f09432744e8a4d78", "message": "Modified according to Checkstyle", "committedDate": "2020-08-11T08:52:33Z", "type": "commit"}, {"oid": "dd77741cc2e34112e4595973c3c1b03f0f0fdb69", "url": "https://github.com/Azure/azure-sdk-for-java/commit/dd77741cc2e34112e4595973c3c1b03f0f0fdb69", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-12T03:50:27Z", "type": "commit"}, {"oid": "e35d77cad32478722d52bd432bd0cdcee3dc6450", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e35d77cad32478722d52bd432bd0cdcee3dc6450", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-12T10:12:43Z", "type": "commit"}, {"oid": "c84410e7bb46acddcc5b1d5a55ce9c6098ce140d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c84410e7bb46acddcc5b1d5a55ce9c6098ce140d", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-12T10:43:33Z", "type": "commit"}, {"oid": "716ba5ebc90fdc9039fe53f5b977c462553db1dc", "url": "https://github.com/Azure/azure-sdk-for-java/commit/716ba5ebc90fdc9039fe53f5b977c462553db1dc", "message": "Modify resource-test.json: limit the length of Stroage account name", "committedDate": "2020-08-12T10:59:11Z", "type": "commit"}, {"oid": "a0746c5323ff6d5f98d47a1dbac06c68299427e8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a0746c5323ff6d5f98d47a1dbac06c68299427e8", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-13T08:55:03Z", "type": "commit"}, {"oid": "62603ac7593bca6b0e056348ef6a1de625b260dc", "url": "https://github.com/Azure/azure-sdk-for-java/commit/62603ac7593bca6b0e056348ef6a1de625b260dc", "message": "modify pom.xml test.yml", "committedDate": "2020-08-13T09:24:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg0NTA5MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13808#discussion_r469845091", "bodyText": "please also make sure we've removed it from the external_dependency.txt file", "author": "saragluna", "createdAt": "2020-08-13T10:10:43Z", "path": "sdk/spring/azure-spring-cloud-test-eventhubs/pom.xml", "diffHunk": "@@ -27,7 +27,7 @@\n     <dependency>\n       <groupId>com.microsoft.azure</groupId>\n       <artifactId>spring-cloud-azure-eventhubs-stream-binder</artifactId>\n-      <version>1.2.7</version> <!-- {x-version-update;com.microsoft.azure:spring-cloud-azure-eventhubs-stream-binder;external_dependency} -->", "originalCommit": "62603ac7593bca6b0e056348ef6a1de625b260dc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0c2c1e2e5313303797e5e15242a020bd405e906e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0c2c1e2e5313303797e5e15242a020bd405e906e", "message": "Remove spring-cloud-azure-eventhubs-stream-binder from external_dependencies.txt", "committedDate": "2020-08-13T11:06:40Z", "type": "commit"}, {"oid": "0788f35f3726223d2e1db8c3875a97e54412aa6e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0788f35f3726223d2e1db8c3875a97e54412aa6e", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-13T11:07:56Z", "type": "commit"}, {"oid": "8032b4409c3a4b4f9aa1efcd5a623519d2097be0", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8032b4409c3a4b4f9aa1efcd5a623519d2097be0", "message": "Merge branch 'dev' of github.com:lu-cheng/azure-sdk-for-java into dev", "committedDate": "2020-08-13T11:10:00Z", "type": "commit"}]}