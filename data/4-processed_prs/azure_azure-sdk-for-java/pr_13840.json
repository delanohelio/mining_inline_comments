{"pr_number": 13840, "pr_title": "Remove JavaBeans for getter and setter method", "pr_createdAt": "2020-08-06T18:40:46Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/13840", "timeline": [{"oid": "5b0310bce1b3164b0cb1faf57c6d8d49b3bb50c9", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5b0310bce1b3164b0cb1faf57c6d8d49b3bb50c9", "message": "Remove JavaBeans for getter and setter method", "committedDate": "2020-08-06T18:39:17Z", "type": "commit"}, {"oid": "bab268e5db8049f1c20556268ec119455e4493cf", "url": "https://github.com/Azure/azure-sdk-for-java/commit/bab268e5db8049f1c20556268ec119455e4493cf", "message": "Made changes to test more cases", "committedDate": "2020-08-06T18:44:16Z", "type": "commit"}, {"oid": "a20086c7e8040da7132ba4090cbfeafc5c77458f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a20086c7e8040da7132ba4090cbfeafc5c77458f", "message": "Fix linting", "committedDate": "2020-08-06T19:57:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5ODg2OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13840#discussion_r466698869", "bodyText": "Regex should be \"^get|^set\". Current regex will replace isPreset to ``isPre`.\njshell> System.out.println(\"isPreset\".replaceFirst(\"^get|set\", \"\"))\nisPre", "author": "srnagar", "createdAt": "2020-08-06T21:34:48Z", "path": "sdk/core/azure-core-serializer-json-jackson/src/main/java/com/azure/core/serializer/json/jackson/JacksonJsonSerializer.java", "diffHunk": "@@ -93,16 +95,28 @@ public String convertMemberName(Member member) {\n \n         if (member instanceof Method) {\n             Method m = (Method) member;\n+            String methodNameWithoutJavaBeans = removePrefix(m.getName());\n             if (m.isAnnotationPresent(JsonIgnore.class)) {\n                 return null;\n             }\n             if (m.isAnnotationPresent(JsonProperty.class)) {\n                 String propertyName = m.getDeclaredAnnotation(JsonProperty.class).value();\n-                return CoreUtils.isNullOrEmpty(propertyName) ? m.getName() : propertyName;\n+                return CoreUtils.isNullOrEmpty(propertyName) ? methodNameWithoutJavaBeans : propertyName;\n             }\n-            return member.getName();\n+            return methodNameWithoutJavaBeans;\n         }\n \n         return null;\n     }\n+\n+    private String removePrefix(String methodName) {\n+        if (methodName == null || !(methodName.contains(\"get\") || methodName.contains(\"set\"))) {\n+            return methodName;\n+        }\n+        String noPrefix = methodName.replaceFirst(\"^get|set\", \"\");", "originalCommit": "a20086c7e8040da7132ba4090cbfeafc5c77458f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc0NTc0OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13840#discussion_r466745748", "bodyText": "Use BeanUtil in jackson lib to do the check", "author": "sima-zhu", "createdAt": "2020-08-06T23:53:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5ODg2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5OTM3OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13840#discussion_r466699378", "bodyText": "Add some tests where the property name also contains get and set.", "author": "srnagar", "createdAt": "2020-08-06T21:35:53Z", "path": "sdk/core/azure-core-serializer-json-jackson/src/test/java/com/azure/core/serializer/json/jackson/JacksonPropertyNameTests.java", "diffHunk": "@@ -98,10 +97,35 @@ public void testPropertyNameOnMethodName() throws NoSuchMethodException {\n             public String getHotelName() {\n                 return hotelName;\n             }\n+            public void setHotelName(String hotelName) {\n+                this.hotelName = hotelName;\n+            }\n         }\n \n-        Method m = LocalHotel.class.getDeclaredMethod(\"getHotelName\");\n-        assertEquals(\"getHotelName\", serializer.convertMemberName(m));\n+        Method getterM = LocalHotel.class.getDeclaredMethod(\"getHotelName\");\n+        assertEquals(\"hotelName\", serializer.convertMemberName(getterM));\n+        Method setterM = LocalHotel.class.getDeclaredMethod(\"setHotelName\", String.class);\n+        assertEquals(\"hotelName\", serializer.convertMemberName(setterM));\n+    }\n+\n+    @Test\n+    public void testPropertyNameOnMethodNameWithoutGetSet() throws NoSuchMethodException {\n+        class LocalHotel {\n+            String hotelName;\n+\n+            public String hotelName1() {\n+                return hotelName;\n+            }\n+\n+            public void hotelName2(String hotelName) {\n+                this.hotelName = hotelName;\n+            }\n+        }\n+\n+        Method getterM = LocalHotel.class.getDeclaredMethod(\"hotelName1\");", "originalCommit": "a20086c7e8040da7132ba4090cbfeafc5c77458f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Njc0NTg0Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13840#discussion_r466745847", "bodyText": "More test coverage now", "author": "sima-zhu", "createdAt": "2020-08-06T23:53:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY5OTM3OA=="}], "type": "inlineReview"}, {"oid": "024ae40c210ff642a5c6ed436bef3a990bc0a68b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/024ae40c210ff642a5c6ed436bef3a990bc0a68b", "message": "Leverage beans util", "committedDate": "2020-08-06T22:41:40Z", "type": "commit"}, {"oid": "466d14d0f399585c9670d09ab5071cffc89bc79e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/466d14d0f399585c9670d09ab5071cffc89bc79e", "message": "remove extra testing", "committedDate": "2020-08-06T22:43:29Z", "type": "commit"}, {"oid": "f1b7c9b66be1475eb791a3312f6089416ec15130", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f1b7c9b66be1475eb791a3312f6089416ec15130", "message": "do not use name transformation for setter", "committedDate": "2020-08-06T23:34:10Z", "type": "commit"}, {"oid": "9202f00145ae7d586f118e803f23e9e38c009254", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9202f00145ae7d586f118e803f23e9e38c009254", "message": "Fixed a test", "committedDate": "2020-08-06T23:39:17Z", "type": "commit"}, {"oid": "b3ead9c3a98104f7fdbde8c7ece4c0f96d703103", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b3ead9c3a98104f7fdbde8c7ece4c0f96d703103", "message": "Fixed failed tests", "committedDate": "2020-08-06T23:44:39Z", "type": "commit"}, {"oid": "b2fb3bb0811bad91f4aba409b3331d6106f04a78", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b2fb3bb0811bad91f4aba409b3331d6106f04a78", "message": "Added more test cases", "committedDate": "2020-08-06T23:51:22Z", "type": "commit"}]}