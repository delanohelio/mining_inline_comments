{"pr_number": 10644, "pr_title": "Change accept headers for search service", "pr_createdAt": "2020-04-30T19:31:20Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/10644", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI1MDkyNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10644#discussion_r418250926", "bodyText": "Isn't there a way to perform this by mutating the Swagger instead of the generated file?", "author": "alzimmermsft", "createdAt": "2020-04-30T19:51:19Z", "path": "sdk/search/azure-search-documents/swagger/readme.md", "diffHunk": "@@ -121,10 +123,25 @@ directive:\n       where: $\n       transform: >-\n           return $\n-          .replace(/(\\@HostParam\\(\\\"indexName\\\"\\) String indexName)/g, \"$1\\, @HeaderParam\\(\\\"accept\\\"\\) String accept\")\n-          .replace(/(this.client.getIndexName\\(\\),)/g, \"$1 accept,\")\n+          .replace(/(\\@QueryParam\\(\\\"api\\-version\\\"\\) String apiVersion)/g, \"$1\\, @HeaderParam\\(\\\"accept\\\"\\) String accept\")\n+          .replace(/(this\\.client\\.getApiVersion\\(\\)\\,)/g, \"$1 accept,\")\n           .replace(/(public Mono\\<(.*)\\) \\{)/g, \"$1\\n\\t\\tfinal String accept \\= \\\"application\\/json\\;odata\\.metadata\\=none\\\"\\;\\n\")\n \n+    # Change service resource impl to take Accept header parameter", "originalCommit": "1e65e96dbf54eafe84350fa2b8876da8739a367c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI3MTM0MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10644#discussion_r418271340", "bodyText": "The autorest.core version we used do not support the change. Update to latest autorest.core one works well, but break other transformers. I think we still need to switch latest autorest.core. I dont think it can deliver this release.", "author": "sima-zhu", "createdAt": "2020-04-30T20:31:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI1MDkyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI3NDk0MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10644#discussion_r418274941", "bodyText": "I believe this could be added as a transform like\n\"parameters\": [\n  {\n    \"name\": \"Accept\",\n    \"in\": \"headers\",\n    \"required\": true,\n    \"type\": \"string\",\n    \"enum\": [\n      \"application/json;odata.metadata=minimal\"\n    ]\n  }\n]", "author": "alzimmermsft", "createdAt": "2020-04-30T20:38:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI1MDkyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI3NjIxNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10644#discussion_r418276215", "bodyText": "Does it add to parameters? Or replace to accept?", "author": "sima-zhu", "createdAt": "2020-04-30T20:40:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI1MDkyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI3ODMxOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10644#discussion_r418278319", "bodyText": "I will have a try. Basically,\nparameters.push does not work", "author": "sima-zhu", "createdAt": "2020-04-30T20:45:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI1MDkyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI4MTExOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10644#discussion_r418281118", "bodyText": "It did not work. Jianghao has pull the json after swagger.\nSomehow autorest.core did not generate the right parameters for modeler to parse. That's the main reason. For .NET, I guess they use latest autorest.core version, which generate the right code for Java too. Unfortunately, other transformers get a mess if using the latest.", "author": "sima-zhu", "createdAt": "2020-04-30T20:50:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI1MDkyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI4NTkyMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10644#discussion_r418285923", "bodyText": "Can circle back on this in the future since this is internal code, no need to hold up this change which is needed.", "author": "alzimmermsft", "createdAt": "2020-04-30T21:00:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODI1MDkyNg=="}], "type": "inlineReview"}, {"oid": "9141914fdd4526de6444e9af7e1545195308dd76", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9141914fdd4526de6444e9af7e1545195308dd76", "message": "Merge mainline changes", "committedDate": "2020-04-30T21:48:27Z", "type": "commit"}, {"oid": "79572e019e02ae9af9d1f1a93e0c0530093c6dd9", "url": "https://github.com/Azure/azure-sdk-for-java/commit/79572e019e02ae9af9d1f1a93e0c0530093c6dd9", "message": "Introduce new swagger changes", "committedDate": "2020-04-30T21:49:04Z", "type": "commit"}, {"oid": "79572e019e02ae9af9d1f1a93e0c0530093c6dd9", "url": "https://github.com/Azure/azure-sdk-for-java/commit/79572e019e02ae9af9d1f1a93e0c0530093c6dd9", "message": "Introduce new swagger changes", "committedDate": "2020-04-30T21:49:04Z", "type": "forcePushed"}, {"oid": "316ad8e8a9c17b9123ca3524b4fd6419063b6e4d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/316ad8e8a9c17b9123ca3524b4fd6419063b6e4d", "message": "fixed boolean field", "committedDate": "2020-04-30T22:20:21Z", "type": "commit"}, {"oid": "33b3c6a054e507e3a0a0c37a83dc7c3e9252b55a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/33b3c6a054e507e3a0a0c37a83dc7c3e9252b55a", "message": "Update readme.md", "committedDate": "2020-04-30T23:32:51Z", "type": "commit"}]}