{"pr_number": 10419, "pr_title": "POM-only release pipeline", "pr_createdAt": "2020-04-22T03:07:14Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/10419", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk4Nzg1Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r412987857", "bodyText": "Should this be commented out or removed?", "author": "JimSuplizio", "createdAt": "2020-04-22T13:35:37Z", "path": "eng/scripts/Publish-MavenPackages.ps1", "diffHunk": "@@ -261,7 +266,7 @@ foreach ($packageDetail in $packageDetails) {\n \n   if ($RepositoryUrl -like \"https://pkgs.dev.azure.com/azure-sdk/public/*\") {\n     Write-Information \"GPG Signing and deploying package in one step to: $RepositoryUrl\"\n-    mvn gpg:sign-and-deploy-file \"--batch-mode\" \"$pomOption\" \"$fileOption\" \"$javadocOption\" \"$sourcesOption\" \"$filesOption\" $classifiersOption \"$typesOption\" \"-Durl=$RepositoryUrl\" \"$gpgexeOption\" \"-DrepositoryId=target-repo\" \"-Drepo.password=$RepositoryPassword\" \"--settings=$PSScriptRoot\\..\\maven.publish.settings.xml\"\n+    # mvn gpg:sign-and-deploy-file \"--batch-mode\" \"$pomOption\" \"$fileOption\" \"$javadocOption\" \"$sourcesOption\" \"$filesOption\" $classifiersOption \"$typesOption\" \"-Durl=$RepositoryUrl\" \"$gpgexeOption\" \"-DrepositoryId=target-repo\" \"-Drepo.password=$RepositoryPassword\" \"--settings=$PSScriptRoot\\..\\maven.publish.settings.xml\"", "originalCommit": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM5MzEyMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r413393121", "bodyText": "A yes .. that was a safety mechanism I put in whilst testing, will take that out. Thanks for spotting that I thought I got them all.", "author": "mitchdenny", "createdAt": "2020-04-22T23:08:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk4Nzg1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk4ODg2MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r412988861", "bodyText": "@mitchdenny please do not remove these comments from the pom file. These are the responsibility of the Cosmos team to remove before GA and I want them kept here.", "author": "JimSuplizio", "createdAt": "2020-04-22T13:36:52Z", "path": "sdk/parents/azure-client-sdk-parent/pom.xml", "diffHunk": "@@ -1468,8 +1468,8 @@\n     <module>../../core/azure-core-test</module>\n     <module>../../core/azure-core-tracing-opentelemetry</module>\n     <module>../../cosmos/azure-cosmos</module>\n-    <module>../../cosmos/azure-cosmos-benchmark</module> <!-- CosmosSkip - Benchmark will go away, this is temporary -->\n-    <module>../../cosmos/azure-cosmos-examples</module> <!-- CosmosSkip - Examples will go away, this is temporary -->\n+    <module>../../cosmos/azure-cosmos-benchmark</module>\n+    <module>../../cosmos/azure-cosmos-examples</module> ", "originalCommit": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM5NTM0MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r413395341", "bodyText": "Put them back in, although for the most part the module list in the parent POMs can be completely deleted (unless we have a script somewhere that is still depending on them). They aren't considered at all for the build itself anymore. Only the sdk/cosmos/pom.xml defines the modules that are used in the Cosmos build.", "author": "mitchdenny", "createdAt": "2020-04-22T23:14:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk4ODg2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk5MTc2Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r412991762", "bodyText": "I'm under the impression that this is mainly for management track right now so why isn't that artifact listed here? In theory, we're done releasing client and data parent poms and have been for months.", "author": "JimSuplizio", "createdAt": "2020-04-22T13:40:18Z", "path": "sdk/parents/ci.yml", "diffHunk": "@@ -31,11 +31,18 @@ pr:\n   paths:\n     include:\n       - sdk/parents/\n-\n+  \n stages:\n-  - stage: Placeholder\n-    jobs:\n-      - job: Placeholder\n-        steps:\n-          - script: |\n-              echo Hello, world!\n+  - template: ../../eng/pipelines/templates/stages/archetype-sdk-pom-only.yml", "originalCommit": "af8b3802ee235e891d1543e2ea0ad3fda8110b5d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM5NDI0MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r413394240", "bodyText": "There is a challenge with management plane right now, specifically it is pointing to an old parent POM which has a distribution management section. As part of this PR I remove the distribution management section from azure-sdk-parent since it gets in the road (and is kinda pointless anyway in our context).\nI think there are some changes coming that will result in the parent POMs being updated (I think @alzimmermsft  was working on something recently).", "author": "mitchdenny", "createdAt": "2020-04-22T23:11:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk5MTc2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM5NDM2MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r413394361", "bodyText": "... oh and this same pipeline will also be used by BOM deployments.", "author": "mitchdenny", "createdAt": "2020-04-22T23:11:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk5MTc2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzM0NDY2NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r417344664", "bodyText": "To be 100% clear: the client and data parent poms should really not need to be released ever again. The only parent pom that we know we're guaranteed to have to release at some point and time in the future is azure-arm-parent which management's parent. That should definitely be one of the artifacts listed below.", "author": "JimSuplizio", "createdAt": "2020-04-29T14:09:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjk5MTc2Mg=="}], "type": "inlineReview"}, {"oid": "3f9e0a56d76c6285a109d4c886d1812db55f84e8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/3f9e0a56d76c6285a109d4c886d1812db55f84e8", "message": "Revising POM-only pipeline.", "committedDate": "2020-04-26T23:15:53Z", "type": "commit"}, {"oid": "5a8454bd7ec023fefefe0b168bb1bc1ecb3bfd1e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5a8454bd7ec023fefefe0b168bb1bc1ecb3bfd1e", "message": "Updated templates to use.", "committedDate": "2020-04-26T23:15:54Z", "type": "commit"}, {"oid": "da95dce86d4aa0a2c2c9c0cd3552f4de5696f0b7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/da95dce86d4aa0a2c2c9c0cd3552f4de5696f0b7", "message": "Tweak escaping.", "committedDate": "2020-04-26T23:15:54Z", "type": "commit"}, {"oid": "699de8e2b47596d1d790fcf27387a0e971bb87a1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/699de8e2b47596d1d790fcf27387a0e971bb87a1", "message": "Fix parent name in ci.yml.", "committedDate": "2020-04-26T23:15:54Z", "type": "commit"}, {"oid": "02a58905640db94054bec87735c6b88370b89f79", "url": "https://github.com/Azure/azure-sdk-for-java/commit/02a58905640db94054bec87735c6b88370b89f79", "message": "Try installing to a known location.", "committedDate": "2020-04-26T23:15:54Z", "type": "commit"}, {"oid": "99238e334cc280c944cb3c71e1ab14d871e29f6a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/99238e334cc280c944cb3c71e1ab14d871e29f6a", "message": "Skip GPG signing at build time.", "committedDate": "2020-04-26T23:15:54Z", "type": "commit"}, {"oid": "1eb31a20be9496586c8bd300cbb099c995703b73", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1eb31a20be9496586c8bd300cbb099c995703b73", "message": "HACK: install build tools.", "committedDate": "2020-04-26T23:15:54Z", "type": "commit"}, {"oid": "c172612d5f8c745cc6d6ee2a489e6565a92ce5cf", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c172612d5f8c745cc6d6ee2a489e6565a92ce5cf", "message": "Added xml suffix.", "committedDate": "2020-04-26T23:15:54Z", "type": "commit"}, {"oid": "c36ec77786c237168b65cfe859680a90c9416f19", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c36ec77786c237168b65cfe859680a90c9416f19", "message": "Point deployment repository to staging directory.", "committedDate": "2020-04-26T23:15:55Z", "type": "commit"}, {"oid": "0da8a9b7c7724f4845b2877c411fd00e3f240993", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0da8a9b7c7724f4845b2877c411fd00e3f240993", "message": "Fix merge issue.", "committedDate": "2020-04-26T23:15:55Z", "type": "commit"}, {"oid": "96d3fbef6bcca351f901f5dc54e94140c77dc088", "url": "https://github.com/Azure/azure-sdk-for-java/commit/96d3fbef6bcca351f901f5dc54e94140c77dc088", "message": "Removed distribution management section.", "committedDate": "2020-04-26T23:15:55Z", "type": "commit"}, {"oid": "428f8f2034707f838876f532d98bc41d1ca600b6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/428f8f2034707f838876f532d98bc41d1ca600b6", "message": "Remove arm parent from artifact list because parent version block.", "committedDate": "2020-04-26T23:15:55Z", "type": "commit"}, {"oid": "1ee3e3c49c0d770bf4e6cf1141af24a141bd62fe", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1ee3e3c49c0d770bf4e6cf1141af24a141bd62fe", "message": "Modify boms service directory to use new pipeline.", "committedDate": "2020-04-26T23:15:55Z", "type": "commit"}, {"oid": "bc2279031cad09a87db85c85140ca50b7442b6ec", "url": "https://github.com/Azure/azure-sdk-for-java/commit/bc2279031cad09a87db85c85140ca50b7442b6ec", "message": "Temporarily comment out some destructive publishing logic.", "committedDate": "2020-04-26T23:15:55Z", "type": "commit"}, {"oid": "f3dd2065c280213d3d517ca9bfbef29d6907b71d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f3dd2065c280213d3d517ca9bfbef29d6907b71d", "message": "Comment out more parts of the pipeline for safety.", "committedDate": "2020-04-26T23:15:56Z", "type": "commit"}, {"oid": "30a88fdccde52e31414c40d4f1d6149a40ec746f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/30a88fdccde52e31414c40d4f1d6149a40ec746f", "message": "Add POM to the actual file list.", "committedDate": "2020-04-26T23:15:56Z", "type": "commit"}, {"oid": "0749d05894dff764c1e7e5291ecd3b6c579a11a8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0749d05894dff764c1e7e5291ecd3b6c579a11a8", "message": "Trying to get POM properly attached.", "committedDate": "2020-04-26T23:15:56Z", "type": "commit"}, {"oid": "d4aa736d9487baca483e503b49f54df0d8205090", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d4aa736d9487baca483e503b49f54df0d8205090", "message": "Fixed typo.", "committedDate": "2020-04-26T23:15:56Z", "type": "commit"}, {"oid": "1a16eef4c2d0d0e8502da129de2f906a8d9cac54", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1a16eef4c2d0d0e8502da129de2f906a8d9cac54", "message": "Fixed some more typos.", "committedDate": "2020-04-26T23:15:56Z", "type": "commit"}, {"oid": "36546169db82ebfc4af2b8f039d15afa4582cbb9", "url": "https://github.com/Azure/azure-sdk-for-java/commit/36546169db82ebfc4af2b8f039d15afa4582cbb9", "message": "Should fix deployments ... I hope.", "committedDate": "2020-04-26T23:15:56Z", "type": "commit"}, {"oid": "0f35c43a2a5029c2d21503acf1c639ea2ab2cbf3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0f35c43a2a5029c2d21503acf1c639ea2ab2cbf3", "message": "POM releases should now work end-to-end.", "committedDate": "2020-04-26T23:15:56Z", "type": "commit"}, {"oid": "2946db4c83639ebc25a53d0314656da277411b02", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2946db4c83639ebc25a53d0314656da277411b02", "message": "Respond to PR feedback.", "committedDate": "2020-04-26T23:15:57Z", "type": "commit"}, {"oid": "2946db4c83639ebc25a53d0314656da277411b02", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2946db4c83639ebc25a53d0314656da277411b02", "message": "Respond to PR feedback.", "committedDate": "2020-04-26T23:15:57Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzM0MDYyMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r417340623", "bodyText": "nit: This change is neither correct nor necessary, please undo the changes to this file and remove from this PR.", "author": "JimSuplizio", "createdAt": "2020-04-29T14:04:28Z", "path": "sdk/parents/azure-client-sdk-parent/pom.xml", "diffHunk": "@@ -1470,7 +1470,7 @@\n     <module>../../core/azure-core-tracing-opentelemetry</module>\n     <module>../../cosmos/azure-cosmos</module>\n     <module>../../cosmos/azure-cosmos-benchmark</module> <!-- CosmosSkip - Benchmark will go away, this is temporary -->\n-    <module>../../cosmos/azure-cosmos-examples</module> <!-- CosmosSkip - Examples will go away, this is temporary -->\n+    <module>../../cosmos/azure-cosmos-examples</module> <!-- CosmosSkip - Benchmark will go away, this is temporary -->", "originalCommit": "2946db4c83639ebc25a53d0314656da277411b02", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzY1OTM2Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/10419#discussion_r417659362", "bodyText": "Ah cut and paste error. I had originally removed those module lines altogether but put them back in at your request but didn't adjust the comment.", "author": "mitchdenny", "createdAt": "2020-04-29T22:54:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzM0MDYyMw=="}], "type": "inlineReview"}, {"oid": "be68690c000be04f5527cd645bf6509bb77dcfe4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/be68690c000be04f5527cd645bf6509bb77dcfe4", "message": "Fix cut and paste issue from revert.", "committedDate": "2020-04-29T23:05:01Z", "type": "commit"}]}