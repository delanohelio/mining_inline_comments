{"pr_number": 3284, "pr_title": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support", "pr_createdAt": "2020-06-09T02:54:42Z", "pr_url": "https://github.com/apache/storm/pull/3284", "timeline": [{"oid": "c5f1246b0859eb0da4f5282f63a9e681f4b74fda", "url": "https://github.com/apache/storm/commit/c5f1246b0859eb0da4f5282f63a9e681f4b74fda", "message": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support", "committedDate": "2020-06-09T03:03:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNjM1Nw==", "url": "https://github.com/apache/storm/pull/3284#discussion_r437626357", "bodyText": "Does this method (or its variant getAllPids) need to be in the ResourceIsolationInterface?", "author": "bipinprasad", "createdAt": "2020-06-09T18:15:26Z", "path": "storm-server/src/main/java/org/apache/storm/container/cgroup/CgroupManager.java", "diffHunk": "@@ -305,8 +302,7 @@ private void prefixNumaPinning(List<String> command, String numaId) {\n         return newCommand;\n     }\n \n-    @Override\n-    public Set<Long> getRunningPids(String workerId) throws IOException {\n+    private Set<Long> getRunningPids(String workerId) throws IOException {", "originalCommit": "c5f1246b0859eb0da4f5282f63a9e681f4b74fda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY0NDQxMA==", "url": "https://github.com/apache/storm/pull/3284#discussion_r437644410", "bodyText": "There might be different ways of killing processes for a worker, depending on the implementation, docker, runc. So this method is not general enough to be placed in the interface", "author": "Ethanlm", "createdAt": "2020-06-09T18:46:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyNjM1Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyODQ2Mw==", "url": "https://github.com/apache/storm/pull/3284#discussion_r437628463", "bodyText": "instead of assert (which will not be active at runtime), do we want to raise an IllegalArgumentException here? If resourceIsolationManager is null, then there will be NPE anyway elsewhere.", "author": "bipinprasad", "createdAt": "2020-06-09T18:19:08Z", "path": "storm-server/src/main/java/org/apache/storm/daemon/supervisor/BasicContainer.java", "diffHunk": "@@ -130,14 +130,15 @@ public BasicContainer(ContainerType type, Map<String, Object> conf, String super\n         super(type, conf, supervisorId, supervisorPort, port, assignment,\n             resourceIsolationManager, workerId, topoConf, ops, metricsRegistry, containerMemoryTracker);\n         assert (localState != null);\n+        assert (resourceIsolationManager != null);", "originalCommit": "c5f1246b0859eb0da4f5282f63a9e681f4b74fda", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzY0NTU0OQ==", "url": "https://github.com/apache/storm/pull/3284#discussion_r437645549", "bodyText": "This will not really happen since resourceIsolationManager has default value and will be always initialized. assert is just used at development phase to avoid errors. We can continue our discussion on assert at the other pr (#3274), but I can remove this line if you prefer.", "author": "Ethanlm", "createdAt": "2020-06-09T18:48:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyODQ2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzc1MDMzMw==", "url": "https://github.com/apache/storm/pull/3284#discussion_r437750333", "bodyText": "We can continue assert discussion elsewhere. But my preference is not to add this.", "author": "bipinprasad", "createdAt": "2020-06-09T22:09:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzYyODQ2Mw=="}], "type": "inlineReview"}, {"oid": "14b762ac5190939af038612c1160936b45cefcdf", "url": "https://github.com/apache/storm/commit/14b762ac5190939af038612c1160936b45cefcdf", "message": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support", "committedDate": "2020-06-09T21:47:15Z", "type": "commit"}, {"oid": "14b762ac5190939af038612c1160936b45cefcdf", "url": "https://github.com/apache/storm/commit/14b762ac5190939af038612c1160936b45cefcdf", "message": "[STORM-3271] Refactor ResourceIsolationInterface in preparation for container support", "committedDate": "2020-06-09T21:47:15Z", "type": "forcePushed"}]}