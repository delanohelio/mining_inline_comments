{"pr_number": 3289, "pr_title": "[STORM-3654] remove executor id from JCQueue receive-queue name", "pr_createdAt": "2020-06-22T14:38:48Z", "pr_url": "https://github.com/apache/storm/pull/3289", "timeline": [{"oid": "1be1307ff5931c41057ea2a2ae7a8f8369bb0564", "url": "https://github.com/apache/storm/commit/1be1307ff5931c41057ea2a2ae7a8f8369bb0564", "message": "[STORM-3654] remove executor id from JCQueue receive-queue name", "committedDate": "2020-06-22T15:11:26Z", "type": "forcePushed"}, {"oid": "9d73a8633757d2b8a021d4eb6080338bb281f8ec", "url": "https://github.com/apache/storm/commit/9d73a8633757d2b8a021d4eb6080338bb281f8ec", "message": "[STORM-3654] remove executor id from JCQueue receive-queue name", "committedDate": "2020-06-22T15:12:01Z", "type": "forcePushed"}, {"oid": "4c2df9b605d2f2661bd9dab6c479bf6f096a8197", "url": "https://github.com/apache/storm/commit/4c2df9b605d2f2661bd9dab6c479bf6f096a8197", "message": "[STORM-3654] remove executor id from JCQueue receive-queue name", "committedDate": "2020-06-22T15:12:38Z", "type": "forcePushed"}, {"oid": "36e3bb71a90230be326e6d8cb938ced94d3cb352", "url": "https://github.com/apache/storm/commit/36e3bb71a90230be326e6d8cb938ced94d3cb352", "message": "[STORM-3654] remove executor id from JCQueue receive-queue name", "committedDate": "2020-06-22T15:33:27Z", "type": "commit"}, {"oid": "36e3bb71a90230be326e6d8cb938ced94d3cb352", "url": "https://github.com/apache/storm/commit/36e3bb71a90230be326e6d8cb938ced94d3cb352", "message": "[STORM-3654] remove executor id from JCQueue receive-queue name", "committedDate": "2020-06-22T15:33:27Z", "type": "forcePushed"}, {"oid": "3af181c7402a0a1cf8a67bfc0525a12938b2a91c", "url": "https://github.com/apache/storm/commit/3af181c7402a0a1cf8a67bfc0525a12938b2a91c", "message": "use metricNamePrefix instead of owner to prevent adding more fields", "committedDate": "2020-06-24T18:46:15Z", "type": "forcePushed"}, {"oid": "1dc2747867b7189db2b5f779acb82dd5c71ec495", "url": "https://github.com/apache/storm/commit/1dc2747867b7189db2b5f779acb82dd5c71ec495", "message": "use metricNamePrefix instead of owner to prevent adding more fields", "committedDate": "2020-06-24T19:51:17Z", "type": "commit"}, {"oid": "1dc2747867b7189db2b5f779acb82dd5c71ec495", "url": "https://github.com/apache/storm/commit/1dc2747867b7189db2b5f779acb82dd5c71ec495", "message": "use metricNamePrefix instead of owner to prevent adding more fields", "committedDate": "2020-06-24T19:51:17Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcyMzU3Mw==", "url": "https://github.com/apache/storm/pull/3289#discussion_r445723573", "bodyText": "why is this null (Although I guess it doesn't matter)", "author": "Ethanlm", "createdAt": "2020-06-25T17:32:14Z", "path": "examples/storm-perf/src/main/java/org/apache/storm/perf/queuetest/JCQueuePerfTest.java", "diffHunk": "@@ -72,7 +72,7 @@ private static void producerFwdConsumer(int prodBatchSz) {\n \n \n     private static void oneProducer1Consumer(int prodBatchSz) {\n-        JCQueue q1 = new JCQueue(\"q1\", 50_000, 0, prodBatchSz, new WaitStrategyPark(100), \"test\", \"test\",\n+        JCQueue q1 = new JCQueue(\"q1\", null, 50_000, 0, prodBatchSz, new WaitStrategyPark(100), \"test\", \"test\",", "originalCommit": "1dc2747867b7189db2b5f779acb82dd5c71ec495", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcyNzAyNA==", "url": "https://github.com/apache/storm/pull/3289#discussion_r445727024", "bodyText": "Since JCQueueMetrics takes metricNamePrefix now, I think it is better to change  the variable name in JCQueueMetrics from queueName to metricNamePrefix to avoid confusion.\nhttps://github.com/apache/storm/blob/master/storm-client/src/jvm/org/apache/storm/utils/JCQueueMetrics.java#L35", "author": "Ethanlm", "createdAt": "2020-06-25T17:38:27Z", "path": "storm-client/src/jvm/org/apache/storm/utils/JCQueue.java", "diffHunk": "@@ -44,15 +44,16 @@\n     private final IWaitStrategy backPressureWaitStrategy;\n     private final String queueName;\n \n-    public JCQueue(String queueName, int size, int overflowLimit, int producerBatchSz, IWaitStrategy backPressureWaitStrategy,\n-                   String topologyId, String componentId, List<Integer> taskIds, int port, StormMetricRegistry metricRegistry) {\n+    public JCQueue(String queueName, String metricNamePrefix, int size, int overflowLimit, int producerBatchSz,\n+                   IWaitStrategy backPressureWaitStrategy, String topologyId, String componentId, List<Integer> taskIds,\n+                   int port, StormMetricRegistry metricRegistry) {\n         this.queueName = queueName;\n         this.overflowLimit = overflowLimit;\n         this.recvQueue = new MpscArrayQueue<>(size);\n         this.overflowQ = new MpscUnboundedArrayQueue<>(size);\n \n         for (Integer taskId : taskIds) {\n-            this.jcqMetrics.add(new JCQueueMetrics(queueName, topologyId, componentId, taskId, port,\n+            this.jcqMetrics.add(new JCQueueMetrics(metricNamePrefix, topologyId, componentId, taskId, port,", "originalCommit": "1dc2747867b7189db2b5f779acb82dd5c71ec495", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcyNzQzNw==", "url": "https://github.com/apache/storm/pull/3289#discussion_r445727437", "bodyText": "is it better to use name instead of null?", "author": "Ethanlm", "createdAt": "2020-06-25T17:39:14Z", "path": "storm-client/test/jvm/org/apache/storm/utils/JCQueueBackpressureTest.java", "diffHunk": "@@ -22,7 +22,7 @@\n public class JCQueueBackpressureTest {\n     \n     private static JCQueue createQueue(String name, int queueSize) {\n-        return new JCQueue(name, queueSize, 0, 1, new WaitStrategyPark(0), \"test\", \"test\", Collections.singletonList(1000), 1000, new StormMetricRegistry());\n+        return new JCQueue(name, null, queueSize, 0, 1, new WaitStrategyPark(0), \"test\", \"test\", Collections.singletonList(1000), 1000, new StormMetricRegistry());", "originalCommit": "1dc2747867b7189db2b5f779acb82dd5c71ec495", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTcyNzU0MQ==", "url": "https://github.com/apache/storm/pull/3289#discussion_r445727541", "bodyText": "is it better to use name instead of null?", "author": "Ethanlm", "createdAt": "2020-06-25T17:39:24Z", "path": "storm-client/test/jvm/org/apache/storm/utils/JCQueueTest.java", "diffHunk": "@@ -157,7 +157,7 @@ private JCQueue createQueue(String name, int queueSize) {\n     }\n \n     private JCQueue createQueue(String name, int batchSize, int queueSize) {\n-        return new JCQueue(name, queueSize, 0, batchSize, waitStrategy, \"test\", \"test\", Collections.singletonList(1000), 1000, new StormMetricRegistry());\n+        return new JCQueue(name, null, queueSize, 0, batchSize, waitStrategy, \"test\", \"test\", Collections.singletonList(1000), 1000, new StormMetricRegistry());", "originalCommit": "1dc2747867b7189db2b5f779acb82dd5c71ec495", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "417d2c0a3d7abc7863ead95fc5c66181782fa4f1", "url": "https://github.com/apache/storm/commit/417d2c0a3d7abc7863ead95fc5c66181782fa4f1", "message": "address comments", "committedDate": "2020-06-29T06:16:09Z", "type": "commit"}]}