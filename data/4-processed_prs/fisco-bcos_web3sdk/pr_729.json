{"pr_number": 729, "pr_title": "add CallResult to ContractCallException", "pr_createdAt": "2020-12-23T03:32:46Z", "pr_url": "https://github.com/FISCO-BCOS/web3sdk/pull/729", "timeline": [{"oid": "47f3b6581d0322e1a74b06fc86d8df9c383b9a66", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/47f3b6581d0322e1a74b06fc86d8df9c383b9a66", "message": "add CallResult to ContractCallException", "committedDate": "2020-12-23T03:27:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzYyMDU4Nw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/729#discussion_r547620587", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.30.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-12-23T03:33:12Z", "path": "src/main/java/org/fisco/bcos/web3j/protocol/channel/ChannelEthereumService.java", "diffHunk": "@@ -92,20 +92,29 @@ public ChannelEthereumService() {\n                     }\n \n                     if (StatusCode.RevertInstruction.equals(callResult.getStatus())) {\n-                        throw new ContractCallException(\n-                                \"The execution of the contract rolled back\"\n-                                        + (revertMessage.getValue1()\n-                                                ? \", \" + revertMessage.getValue2()\n-                                                : \"\")\n-                                        + \".\");\n+                        ContractCallException contractCallException =\n+                                new ContractCallException(\n+                                        \"The execution of the contract rolled back\"\n+                                                + (revertMessage.getValue1()", "originalCommit": "47f3b6581d0322e1a74b06fc86d8df9c383b9a66", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzYyMDU4OA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/729#discussion_r547620588", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.30.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-12-23T03:33:13Z", "path": "src/main/java/org/fisco/bcos/web3j/protocol/channel/ChannelEthereumService.java", "diffHunk": "@@ -92,20 +92,29 @@ public ChannelEthereumService() {\n                     }\n \n                     if (StatusCode.RevertInstruction.equals(callResult.getStatus())) {\n-                        throw new ContractCallException(\n-                                \"The execution of the contract rolled back\"\n-                                        + (revertMessage.getValue1()\n-                                                ? \", \" + revertMessage.getValue2()\n-                                                : \"\")\n-                                        + \".\");\n+                        ContractCallException contractCallException =\n+                                new ContractCallException(\n+                                        \"The execution of the contract rolled back\"\n+                                                + (revertMessage.getValue1()\n+                                                        ? \", \" + revertMessage.getValue2()", "originalCommit": "47f3b6581d0322e1a74b06fc86d8df9c383b9a66", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzYyMDU4OQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/729#discussion_r547620589", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.30.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-12-23T03:33:13Z", "path": "src/main/java/org/fisco/bcos/web3j/protocol/channel/ChannelEthereumService.java", "diffHunk": "@@ -92,20 +92,29 @@ public ChannelEthereumService() {\n                     }\n \n                     if (StatusCode.RevertInstruction.equals(callResult.getStatus())) {\n-                        throw new ContractCallException(\n-                                \"The execution of the contract rolled back\"\n-                                        + (revertMessage.getValue1()\n-                                                ? \", \" + revertMessage.getValue2()\n-                                                : \"\")\n-                                        + \".\");\n+                        ContractCallException contractCallException =\n+                                new ContractCallException(\n+                                        \"The execution of the contract rolled back\"\n+                                                + (revertMessage.getValue1()\n+                                                        ? \", \" + revertMessage.getValue2()\n+                                                        : \"\")\n+                                                + \".\");\n+                        contractCallException.setCallOutput(callResult);\n+                        throw contractCallException;\n                     }\n                     if (StatusCode.CallAddressError.equals(callResult.getStatus())) {\n-                        throw new ContractCallException(\"The contract address is incorrect.\");\n+                        ContractCallException contractCallException =\n+                                new ContractCallException(\"The contract address is incorrect.\");\n+                        contractCallException.setCallOutput(callResult);\n+                        throw contractCallException;\n                     }\n \n                     if (!StatusCode.Success.equals(callResult.getStatus())) {\n-                        throw new ContractCallException(\n-                                StatusCode.getStatusMessage(callResult.getStatus()));\n+                        ContractCallException contractCallException =\n+                                new ContractCallException(\n+                                        StatusCode.getStatusMessage(callResult.getStatus()));", "originalCommit": "47f3b6581d0322e1a74b06fc86d8df9c383b9a66", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e5aa0b528c15035aa314bcfac686dd1de1e7d69c", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/e5aa0b528c15035aa314bcfac686dd1de1e7d69c", "message": "add support for jdk15", "committedDate": "2020-12-23T06:13:25Z", "type": "commit"}]}