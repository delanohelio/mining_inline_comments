{"pr_number": 602, "pr_title": "Release 2.1.4", "pr_createdAt": "2020-06-10T01:40:47Z", "pr_url": "https://github.com/FISCO-BCOS/web3sdk/pull/602", "timeline": [{"oid": "482291482eef78cc6d71445c4ddbf45f198aab4c", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/482291482eef78cc6d71445c4ddbf45f198aab4c", "message": "add ECCEncrpyt/ECCDecrypt (#543)\n\n* add encrypt/decrypt/verify method for ECKeyPair.\r\n\r\n* update ECDSA encrpyt/decrypt\r\n\r\n* add ECCEcrypt/ECCDecrpyt\r\n\r\n* fix ECCEncrpyt bug.", "committedDate": "2020-06-10T01:31:42Z", "type": "commit"}, {"oid": "a0cebbebdf0506870d568797e3904bc207862a47", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/a0cebbebdf0506870d568797e3904bc207862a47", "message": "update ChangLog release_node (#544)", "committedDate": "2020-06-10T01:33:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg4MA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812880", "bodyText": "[Misspell] \"encrpyt\" is a misspelling of \"encrypt\" (view)\n\n\n\n\nRule\nCorrect\nIncorrect\n\n\n\n\nencrypt\nencrypt\nencrpyt\n\n\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:29Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestWithPem() throws Exception {\n+        ApplicationContext context =\n+                new ClassPathXmlApplicationContext(\n+                        \"classpath:applicationContext-keystore-sample.xml\");\n+        // test p12\n+        P12Manager p12 = context.getBean(P12Manager.class);\n+\n+        ECKeyPair ecKeyPair = p12.getECKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void verifyECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+        String message = \"verify test\";\n+        ECDSASignature signature = ecKeyPair.sign(message.getBytes());\n+        boolean verify = ecKeyPair.verify(message.getBytes(), signature);\n+\n+        assertEquals(verify, true);\n+    }\n+\n+    @Test\n+    public void verifyECKeyPairTestEmptyString() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+        String message = \"\";\n+        ECDSASignature signature = ecKeyPair.sign(message.getBytes());\n+        boolean verify = ecKeyPair.verify(message.getBytes(), signature);\n+\n+        assertEquals(verify, true);\n+    }\n+\n+    @Test\n+    public void verifyECKeyPairTestWithPem() throws Exception {\n+        ApplicationContext context =\n+                new ClassPathXmlApplicationContext(\n+                        \"classpath:applicationContext-keystore-sample.xml\");\n+        // test p12\n+        P12Manager p12 = context.getBean(P12Manager.class);\n+\n+        ECKeyPair ecKeyPair = p12.getECKeyPair();\n+\n+        String message = \"ecc encrpyt test\";", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg4Mg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812882", "bodyText": "[PMD Java] Avoid unused private fields such as 'logger'. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nUnusedPrivateField\nBest Practices\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_bestpractices.html#unusedprivatefield\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:29Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/ECKeyPair.java", "diffHunk": "@@ -3,16 +3,23 @@\n import java.math.BigInteger;\n import java.security.KeyPair;\n import java.util.Arrays;\n+import java.util.Objects;\n import org.bouncycastle.crypto.digests.SHA256Digest;\n import org.bouncycastle.crypto.params.ECPrivateKeyParameters;\n+import org.bouncycastle.crypto.params.ECPublicKeyParameters;\n import org.bouncycastle.crypto.signers.ECDSASigner;\n import org.bouncycastle.crypto.signers.HMacDSAKCalculator;\n import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;\n import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;\n import org.fisco.bcos.web3j.utils.Numeric;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n \n /** Elliptic Curve SECP-256k1 generated key pair. */\n public class ECKeyPair {\n+\n+    private static final Logger logger = LoggerFactory.getLogger(ECKeyPair.class);", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg4NA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812884", "bodyText": "[PMD Java] Found non-transient, non-static member. Please mark as transient or provide accessors. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBeanMembersShouldSerialize\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:30Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCDecrypt.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.NoSuchProviderException;\n+import java.security.spec.ECPrivateKeySpec;\n+import javax.crypto.BadPaddingException;\n+import javax.crypto.Cipher;\n+import javax.crypto.IllegalBlockSizeException;\n+import javax.crypto.NoSuchPaddingException;\n+import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;\n+import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+\n+/** ECC decrypt utils */\n+public class ECCDecrypt {\n+\n+    private final BigInteger priKey;\n+    private final BCECPrivateKey bCECPrivateKey;", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg4OQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812889", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:30Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCDecrypt.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.NoSuchProviderException;\n+import java.security.spec.ECPrivateKeySpec;\n+import javax.crypto.BadPaddingException;\n+import javax.crypto.Cipher;\n+import javax.crypto.IllegalBlockSizeException;\n+import javax.crypto.NoSuchPaddingException;\n+import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;\n+import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+\n+/** ECC decrypt utils */\n+public class ECCDecrypt {\n+\n+    private final BigInteger priKey;\n+    private final BCECPrivateKey bCECPrivateKey;\n+\n+    public ECCDecrypt(BigInteger privateKey) {\n+        this.priKey = privateKey;\n+        this.bCECPrivateKey = createBCECPrivateKey(privateKey);\n+    }\n+\n+    public BigInteger getPriKey() {\n+        return priKey;\n+    }\n+\n+    public BCECPrivateKey getbCECPrivateKey() {\n+        return bCECPrivateKey;\n+    }\n+\n+    /**\n+     * create BCECPrivateKey from privateKey\n+     *\n+     * @param privateKey\n+     * @return\n+     */\n+    private BCECPrivateKey createBCECPrivateKey(BigInteger privateKey) {\n+        // Handle secret key\n+        ECPrivateKeySpec secretKeySpec =\n+                new ECPrivateKeySpec(privateKey, ECCParams.ecNamedCurveSpec);\n+        BCECPrivateKey bcecPrivateKey =\n+                new BCECPrivateKey(\"ECDSA\", secretKeySpec, BouncyCastleProvider.CONFIGURATION);\n+        return bcecPrivateKey;\n+    }\n+\n+    /**\n+     * Decrypt the data which encryt by ECC\n+     *\n+     * @param data\n+     * @return\n+     * @throws NoSuchPaddingException\n+     * @throws NoSuchAlgorithmException\n+     * @throws NoSuchProviderException\n+     * @throws InvalidAlgorithmParameterException\n+     * @throws InvalidKeyException\n+     * @throws BadPaddingException\n+     * @throws IllegalBlockSizeException\n+     */\n+    public byte[] decrypt(byte[] data)\n+            throws NoSuchPaddingException, NoSuchAlgorithmException, NoSuchProviderException,\n+                    InvalidAlgorithmParameterException, InvalidKeyException, BadPaddingException,\n+                    IllegalBlockSizeException {\n+\n+        Cipher cipher = Cipher.getInstance(\"ECIES\", \"BC\");\n+        cipher.init(Cipher.DECRYPT_MODE, getbCECPrivateKey(), ECCParams.IES_PARAMS);", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg5MQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812891", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:30Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCDecrypt.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.NoSuchProviderException;\n+import java.security.spec.ECPrivateKeySpec;\n+import javax.crypto.BadPaddingException;\n+import javax.crypto.Cipher;\n+import javax.crypto.IllegalBlockSizeException;\n+import javax.crypto.NoSuchPaddingException;\n+import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;\n+import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+\n+/** ECC decrypt utils */\n+public class ECCDecrypt {\n+\n+    private final BigInteger priKey;\n+    private final BCECPrivateKey bCECPrivateKey;\n+\n+    public ECCDecrypt(BigInteger privateKey) {\n+        this.priKey = privateKey;\n+        this.bCECPrivateKey = createBCECPrivateKey(privateKey);\n+    }\n+\n+    public BigInteger getPriKey() {\n+        return priKey;\n+    }\n+\n+    public BCECPrivateKey getbCECPrivateKey() {\n+        return bCECPrivateKey;\n+    }\n+\n+    /**\n+     * create BCECPrivateKey from privateKey\n+     *\n+     * @param privateKey\n+     * @return\n+     */\n+    private BCECPrivateKey createBCECPrivateKey(BigInteger privateKey) {\n+        // Handle secret key\n+        ECPrivateKeySpec secretKeySpec =\n+                new ECPrivateKeySpec(privateKey, ECCParams.ecNamedCurveSpec);\n+        BCECPrivateKey bcecPrivateKey =\n+                new BCECPrivateKey(\"ECDSA\", secretKeySpec, BouncyCastleProvider.CONFIGURATION);\n+        return bcecPrivateKey;\n+    }\n+\n+    /**\n+     * Decrypt the data which encryt by ECC\n+     *\n+     * @param data\n+     * @return\n+     * @throws NoSuchPaddingException\n+     * @throws NoSuchAlgorithmException\n+     * @throws NoSuchProviderException\n+     * @throws InvalidAlgorithmParameterException\n+     * @throws InvalidKeyException\n+     * @throws BadPaddingException\n+     * @throws IllegalBlockSizeException\n+     */\n+    public byte[] decrypt(byte[] data)\n+            throws NoSuchPaddingException, NoSuchAlgorithmException, NoSuchProviderException,\n+                    InvalidAlgorithmParameterException, InvalidKeyException, BadPaddingException,\n+                    IllegalBlockSizeException {\n+\n+        Cipher cipher = Cipher.getInstance(\"ECIES\", \"BC\");\n+        cipher.init(Cipher.DECRYPT_MODE, getbCECPrivateKey(), ECCParams.IES_PARAMS);\n+\n+        return cipher.doFinal(data);", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg5Mw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812893", "bodyText": "[PMD Java] Found non-transient, non-static member. Please mark as transient or provide accessors. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBeanMembersShouldSerialize\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:30Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCEncrypt.java", "diffHunk": "@@ -0,0 +1,101 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.NoSuchProviderException;\n+import javax.crypto.BadPaddingException;\n+import javax.crypto.Cipher;\n+import javax.crypto.IllegalBlockSizeException;\n+import javax.crypto.NoSuchPaddingException;\n+import org.bouncycastle.crypto.params.ECDomainParameters;\n+import org.bouncycastle.crypto.params.ECPublicKeyParameters;\n+import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;\n+import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Curve;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Point;\n+import org.fisco.bcos.web3j.crypto.Keys;\n+import org.fisco.bcos.web3j.utils.Numeric;\n+\n+/** ECC encrpt utils */\n+public class ECCEncrypt {\n+\n+    private final BigInteger pubKey;\n+    private final BCECPublicKey bCECPublicKey;", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg5NQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812895", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:31Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCEncrypt.java", "diffHunk": "@@ -0,0 +1,101 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.NoSuchProviderException;\n+import javax.crypto.BadPaddingException;\n+import javax.crypto.Cipher;\n+import javax.crypto.IllegalBlockSizeException;\n+import javax.crypto.NoSuchPaddingException;\n+import org.bouncycastle.crypto.params.ECDomainParameters;\n+import org.bouncycastle.crypto.params.ECPublicKeyParameters;\n+import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;\n+import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Curve;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Point;\n+import org.fisco.bcos.web3j.crypto.Keys;\n+import org.fisco.bcos.web3j.utils.Numeric;\n+\n+/** ECC encrpt utils */\n+public class ECCEncrypt {\n+\n+    private final BigInteger pubKey;\n+    private final BCECPublicKey bCECPublicKey;\n+\n+    public ECCEncrypt(BigInteger pubKey) {\n+        this.pubKey = pubKey;\n+        this.bCECPublicKey = createBCECPublicKey(pubKey);\n+    }\n+\n+    public BigInteger getPubKey() {\n+        return pubKey;\n+    }\n+\n+    public BCECPublicKey getbCECPublicKey() {\n+        return bCECPublicKey;\n+    }\n+\n+    /**\n+     * create BCECPublicKey from publicKey and privateKey\n+     *\n+     * @param publicKey\n+     * @return\n+     */\n+    private BCECPublicKey createBCECPublicKey(BigInteger publicKey) {\n+        // Handle public key.\n+        String publicKeyValue =\n+                Numeric.toHexStringNoPrefixZeroPadded(publicKey, Keys.PUBLIC_KEY_LENGTH_IN_HEX);\n+        String prePublicKeyStr = publicKeyValue.substring(0, 64);", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg5Nw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812897", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:31Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCEncrypt.java", "diffHunk": "@@ -0,0 +1,101 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.NoSuchProviderException;\n+import javax.crypto.BadPaddingException;\n+import javax.crypto.Cipher;\n+import javax.crypto.IllegalBlockSizeException;\n+import javax.crypto.NoSuchPaddingException;\n+import org.bouncycastle.crypto.params.ECDomainParameters;\n+import org.bouncycastle.crypto.params.ECPublicKeyParameters;\n+import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;\n+import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Curve;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Point;\n+import org.fisco.bcos.web3j.crypto.Keys;\n+import org.fisco.bcos.web3j.utils.Numeric;\n+\n+/** ECC encrpt utils */\n+public class ECCEncrypt {\n+\n+    private final BigInteger pubKey;\n+    private final BCECPublicKey bCECPublicKey;\n+\n+    public ECCEncrypt(BigInteger pubKey) {\n+        this.pubKey = pubKey;\n+        this.bCECPublicKey = createBCECPublicKey(pubKey);\n+    }\n+\n+    public BigInteger getPubKey() {\n+        return pubKey;\n+    }\n+\n+    public BCECPublicKey getbCECPublicKey() {\n+        return bCECPublicKey;\n+    }\n+\n+    /**\n+     * create BCECPublicKey from publicKey and privateKey\n+     *\n+     * @param publicKey\n+     * @return\n+     */\n+    private BCECPublicKey createBCECPublicKey(BigInteger publicKey) {\n+        // Handle public key.\n+        String publicKeyValue =\n+                Numeric.toHexStringNoPrefixZeroPadded(publicKey, Keys.PUBLIC_KEY_LENGTH_IN_HEX);\n+        String prePublicKeyStr = publicKeyValue.substring(0, 64);\n+        String postPublicKeyStr = publicKeyValue.substring(64);", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjg5OQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812899", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:31Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCEncrypt.java", "diffHunk": "@@ -0,0 +1,101 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.NoSuchProviderException;\n+import javax.crypto.BadPaddingException;\n+import javax.crypto.Cipher;\n+import javax.crypto.IllegalBlockSizeException;\n+import javax.crypto.NoSuchPaddingException;\n+import org.bouncycastle.crypto.params.ECDomainParameters;\n+import org.bouncycastle.crypto.params.ECPublicKeyParameters;\n+import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;\n+import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Curve;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Point;\n+import org.fisco.bcos.web3j.crypto.Keys;\n+import org.fisco.bcos.web3j.utils.Numeric;\n+\n+/** ECC encrpt utils */\n+public class ECCEncrypt {\n+\n+    private final BigInteger pubKey;\n+    private final BCECPublicKey bCECPublicKey;\n+\n+    public ECCEncrypt(BigInteger pubKey) {\n+        this.pubKey = pubKey;\n+        this.bCECPublicKey = createBCECPublicKey(pubKey);\n+    }\n+\n+    public BigInteger getPubKey() {\n+        return pubKey;\n+    }\n+\n+    public BCECPublicKey getbCECPublicKey() {\n+        return bCECPublicKey;\n+    }\n+\n+    /**\n+     * create BCECPublicKey from publicKey and privateKey\n+     *\n+     * @param publicKey\n+     * @return\n+     */\n+    private BCECPublicKey createBCECPublicKey(BigInteger publicKey) {\n+        // Handle public key.\n+        String publicKeyValue =\n+                Numeric.toHexStringNoPrefixZeroPadded(publicKey, Keys.PUBLIC_KEY_LENGTH_IN_HEX);\n+        String prePublicKeyStr = publicKeyValue.substring(0, 64);\n+        String postPublicKeyStr = publicKeyValue.substring(64);\n+        SecP256K1Curve secP256K1Curve = new SecP256K1Curve();\n+        SecP256K1Point secP256K1Point =\n+                (SecP256K1Point)\n+                        secP256K1Curve.createPoint(\n+                                new BigInteger(prePublicKeyStr, 16),\n+                                new BigInteger(postPublicKeyStr, 16));\n+        SecP256K1Point secP256K1PointG =\n+                (SecP256K1Point)\n+                        secP256K1Curve.createPoint(ECCParams.POINTG_PRE, ECCParams.POINTG_POST);\n+\n+        ECDomainParameters domainParameters =\n+                new ECDomainParameters(secP256K1Curve, secP256K1PointG, ECCParams.FACTOR_N);\n+        ECPublicKeyParameters publicKeyParameters =\n+                new ECPublicKeyParameters(secP256K1Point, domainParameters);\n+\n+        BCECPublicKey bcecPublicKey =\n+                new BCECPublicKey(\n+                        \"ECDSA\",\n+                        publicKeyParameters,\n+                        ECCParams.ecNamedCurveSpec,\n+                        BouncyCastleProvider.CONFIGURATION);\n+\n+        return bcecPublicKey;\n+    }\n+\n+    /**\n+     * Encrypt the data with ECC algorithm\n+     *\n+     * @param data\n+     * @return\n+     * @throws NoSuchPaddingException\n+     * @throws NoSuchAlgorithmException\n+     * @throws NoSuchProviderException\n+     * @throws BadPaddingException\n+     * @throws IllegalBlockSizeException\n+     * @throws InvalidAlgorithmParameterException\n+     * @throws InvalidKeyException\n+     */\n+    public byte[] encrypt(byte[] data)\n+            throws NoSuchPaddingException, NoSuchAlgorithmException, NoSuchProviderException,\n+                    BadPaddingException, IllegalBlockSizeException,\n+                    InvalidAlgorithmParameterException, InvalidKeyException {\n+\n+        // Encrypt data.\n+        Cipher cipher = Cipher.getInstance(\" ECIES\", \"BC\");\n+        cipher.init(Cipher.ENCRYPT_MODE, getbCECPublicKey(), ECCParams.IES_PARAMS);", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkwMA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812900", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:31Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCEncrypt.java", "diffHunk": "@@ -0,0 +1,101 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.InvalidAlgorithmParameterException;\n+import java.security.InvalidKeyException;\n+import java.security.NoSuchAlgorithmException;\n+import java.security.NoSuchProviderException;\n+import javax.crypto.BadPaddingException;\n+import javax.crypto.Cipher;\n+import javax.crypto.IllegalBlockSizeException;\n+import javax.crypto.NoSuchPaddingException;\n+import org.bouncycastle.crypto.params.ECDomainParameters;\n+import org.bouncycastle.crypto.params.ECPublicKeyParameters;\n+import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;\n+import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Curve;\n+import org.bouncycastle.math.ec.custom.sec.SecP256K1Point;\n+import org.fisco.bcos.web3j.crypto.Keys;\n+import org.fisco.bcos.web3j.utils.Numeric;\n+\n+/** ECC encrpt utils */\n+public class ECCEncrypt {\n+\n+    private final BigInteger pubKey;\n+    private final BCECPublicKey bCECPublicKey;\n+\n+    public ECCEncrypt(BigInteger pubKey) {\n+        this.pubKey = pubKey;\n+        this.bCECPublicKey = createBCECPublicKey(pubKey);\n+    }\n+\n+    public BigInteger getPubKey() {\n+        return pubKey;\n+    }\n+\n+    public BCECPublicKey getbCECPublicKey() {\n+        return bCECPublicKey;\n+    }\n+\n+    /**\n+     * create BCECPublicKey from publicKey and privateKey\n+     *\n+     * @param publicKey\n+     * @return\n+     */\n+    private BCECPublicKey createBCECPublicKey(BigInteger publicKey) {\n+        // Handle public key.\n+        String publicKeyValue =\n+                Numeric.toHexStringNoPrefixZeroPadded(publicKey, Keys.PUBLIC_KEY_LENGTH_IN_HEX);\n+        String prePublicKeyStr = publicKeyValue.substring(0, 64);\n+        String postPublicKeyStr = publicKeyValue.substring(64);\n+        SecP256K1Curve secP256K1Curve = new SecP256K1Curve();\n+        SecP256K1Point secP256K1Point =\n+                (SecP256K1Point)\n+                        secP256K1Curve.createPoint(\n+                                new BigInteger(prePublicKeyStr, 16),\n+                                new BigInteger(postPublicKeyStr, 16));\n+        SecP256K1Point secP256K1PointG =\n+                (SecP256K1Point)\n+                        secP256K1Curve.createPoint(ECCParams.POINTG_PRE, ECCParams.POINTG_POST);\n+\n+        ECDomainParameters domainParameters =\n+                new ECDomainParameters(secP256K1Curve, secP256K1PointG, ECCParams.FACTOR_N);\n+        ECPublicKeyParameters publicKeyParameters =\n+                new ECPublicKeyParameters(secP256K1Point, domainParameters);\n+\n+        BCECPublicKey bcecPublicKey =\n+                new BCECPublicKey(\n+                        \"ECDSA\",\n+                        publicKeyParameters,\n+                        ECCParams.ecNamedCurveSpec,\n+                        BouncyCastleProvider.CONFIGURATION);\n+\n+        return bcecPublicKey;\n+    }\n+\n+    /**\n+     * Encrypt the data with ECC algorithm\n+     *\n+     * @param data\n+     * @return\n+     * @throws NoSuchPaddingException\n+     * @throws NoSuchAlgorithmException\n+     * @throws NoSuchProviderException\n+     * @throws BadPaddingException\n+     * @throws IllegalBlockSizeException\n+     * @throws InvalidAlgorithmParameterException\n+     * @throws InvalidKeyException\n+     */\n+    public byte[] encrypt(byte[] data)\n+            throws NoSuchPaddingException, NoSuchAlgorithmException, NoSuchProviderException,\n+                    BadPaddingException, IllegalBlockSizeException,\n+                    InvalidAlgorithmParameterException, InvalidKeyException {\n+\n+        // Encrypt data.\n+        Cipher cipher = Cipher.getInstance(\" ECIES\", \"BC\");\n+        cipher.init(Cipher.ENCRYPT_MODE, getbCECPublicKey(), ECCParams.IES_PARAMS);\n+\n+        return cipher.doFinal(data);", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkwMQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812901", "bodyText": "[PMD Java] Dont create instances of already existing BigInteger and BigDecimal (ZERO, ONE, TEN) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBigIntegerInstantiation\nPerformance\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_performance.html#bigintegerinstantiation\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:31Z", "path": "src/main/java/org/fisco/bcos/web3j/crypto/tool/ECCParams.java", "diffHunk": "@@ -0,0 +1,28 @@\n+package org.fisco.bcos.web3j.crypto.tool;\n+\n+import java.math.BigInteger;\n+import java.security.spec.ECFieldFp;\n+import java.security.spec.ECPoint;\n+import java.security.spec.EllipticCurve;\n+import org.bouncycastle.jce.spec.ECNamedCurveSpec;\n+import org.bouncycastle.jce.spec.IESParameterSpec;\n+\n+public final class ECCParams {\n+\n+    // ECDSA secp256k1 algorithm constants\n+    public static final BigInteger POINTG_PRE =\n+            new BigInteger(\"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798\", 16);\n+    public static final BigInteger POINTG_POST =\n+            new BigInteger(\"483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8\", 16);\n+    public static final BigInteger FACTOR_N =\n+            new BigInteger(\"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141\", 16);\n+    public static final BigInteger FIELD_P =\n+            new BigInteger(\"fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f\", 16);\n+    public static final EllipticCurve ellipticCurve =\n+            new EllipticCurve(new ECFieldFp(FIELD_P), new BigInteger(\"0\"), new BigInteger(\"7\"));", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkwMw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812903", "bodyText": "[PMD Java] A method/constructor should not explicitly throw java.lang.Exception (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nSignatureDeclareThrowsException\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#signaturedeclarethrowsexception\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:32Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkwNg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812906", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:32Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkwNw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812907", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:32Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkwOA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812908", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:32Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkwOQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812909", "bodyText": "[PMD Java] The String literal \"utf-8\" appears 6 times in this file; the first occurrence is on line 23 (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidDuplicateLiterals\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_errorprone.html#avoidduplicateliterals\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:32Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkxMQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812911", "bodyText": "[PMD Java] JUnit assertions should include a message (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nJUnitAssertionsShouldIncludeMessage\nBest Practices\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_bestpractices.html#junitassertionsshouldincludemessage\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:32Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkxMg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812912", "bodyText": "[PMD Java] A method/constructor should not explicitly throw java.lang.Exception (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nSignatureDeclareThrowsException\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#signaturedeclarethrowsexception\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:33Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkxNQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812915", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:33Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkxNg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812916", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:33Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkxOA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812918", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:33Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkxOQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812919", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:33Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkyMA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812920", "bodyText": "[PMD Java] JUnit assertions should include a message (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nJUnitAssertionsShouldIncludeMessage\nBest Practices\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_bestpractices.html#junitassertionsshouldincludemessage\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:33Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkyMg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812922", "bodyText": "[PMD Java] A method/constructor should not explicitly throw java.lang.Exception (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nSignatureDeclareThrowsException\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#signaturedeclarethrowsexception\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:34Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestWithPem() throws Exception {", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkyNA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812924", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:34Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestWithPem() throws Exception {\n+        ApplicationContext context =\n+                new ClassPathXmlApplicationContext(\n+                        \"classpath:applicationContext-keystore-sample.xml\");\n+        // test p12\n+        P12Manager p12 = context.getBean(P12Manager.class);\n+\n+        ECKeyPair ecKeyPair = p12.getECKeyPair();", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkyNQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812925", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:34Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestWithPem() throws Exception {\n+        ApplicationContext context =\n+                new ClassPathXmlApplicationContext(\n+                        \"classpath:applicationContext-keystore-sample.xml\");\n+        // test p12\n+        P12Manager p12 = context.getBean(P12Manager.class);\n+\n+        ECKeyPair ecKeyPair = p12.getECKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkyNg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812926", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:34Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestWithPem() throws Exception {\n+        ApplicationContext context =\n+                new ClassPathXmlApplicationContext(\n+                        \"classpath:applicationContext-keystore-sample.xml\");\n+        // test p12\n+        P12Manager p12 = context.getBean(P12Manager.class);\n+\n+        ECKeyPair ecKeyPair = p12.getECKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkyOA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812928", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:34Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestWithPem() throws Exception {\n+        ApplicationContext context =\n+                new ClassPathXmlApplicationContext(\n+                        \"classpath:applicationContext-keystore-sample.xml\");\n+        // test p12\n+        P12Manager p12 = context.getBean(P12Manager.class);\n+\n+        ECKeyPair ecKeyPair = p12.getECKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkyOQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812929", "bodyText": "[PMD Java] JUnit assertions should include a message (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nJUnitAssertionsShouldIncludeMessage\nBest Practices\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_bestpractices.html#junitassertionsshouldincludemessage\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:35Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestWithPem() throws Exception {\n+        ApplicationContext context =\n+                new ClassPathXmlApplicationContext(\n+                        \"classpath:applicationContext-keystore-sample.xml\");\n+        // test p12\n+        P12Manager p12 = context.getBean(P12Manager.class);\n+\n+        ECKeyPair ecKeyPair = p12.getECKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzgxMjkzMg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/602#discussion_r437812932", "bodyText": "[PMD Java] A method/constructor should not explicitly throw java.lang.Exception (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nSignatureDeclareThrowsException\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.23.0/pmd_rules_java_design.html#signaturedeclarethrowsexception\n\nYou can close this issue if no need to fix it. Learn more.", "author": "sider", "createdAt": "2020-06-10T01:41:35Z", "path": "src/test/java/org/fisco/bcos/web3j/crypto/ECKeyPairTest.java", "diffHunk": "@@ -0,0 +1,154 @@\n+package org.fisco.bcos.web3j.crypto;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import org.fisco.bcos.channel.client.P12Manager;\n+import org.fisco.bcos.web3j.crypto.gm.GenCredential;\n+import org.fisco.bcos.web3j.crypto.tool.ECCDecrypt;\n+import org.fisco.bcos.web3j.crypto.tool.ECCEncrypt;\n+import org.junit.Test;\n+import org.springframework.context.ApplicationContext;\n+import org.springframework.context.support.ClassPathXmlApplicationContext;\n+\n+public class ECKeyPairTest {\n+\n+    @Test\n+    public void encryptECKeyPairTest() throws Exception {\n+        ECKeyPair ecKeyPair = Keys.createEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"ecc encrypt test\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        String decrpptMessage = new String(decryptData, \"utf-8\");\n+        assertEquals(message, decrpptMessage);\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestEmptyString() throws Exception {\n+        Credentials credentials = GenCredential.create();\n+        ECKeyPair ecKeyPair = credentials.getEcKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void encryptECKeyPairTestWithPem() throws Exception {\n+        ApplicationContext context =\n+                new ClassPathXmlApplicationContext(\n+                        \"classpath:applicationContext-keystore-sample.xml\");\n+        // test p12\n+        P12Manager p12 = context.getBean(P12Manager.class);\n+\n+        ECKeyPair ecKeyPair = p12.getECKeyPair();\n+\n+        ECCEncrypt encrypt = new ECCEncrypt(ecKeyPair.getPublicKey());\n+        ECCDecrypt decrypt = new ECCDecrypt(ecKeyPair.getPrivateKey());\n+\n+        String message = \"\";\n+        byte[] encryptData = encrypt.encrypt(message.getBytes(\"utf-8\"));\n+        byte[] decryptData = decrypt.decrypt(encryptData);\n+\n+        assertEquals(message, new String(decryptData, \"utf-8\"));\n+    }\n+\n+    @Test\n+    public void verifyECKeyPairTest() throws Exception {", "originalCommit": "a0cebbebdf0506870d568797e3904bc207862a47", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}